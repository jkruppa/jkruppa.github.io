# Deskriptive Statistik

Wir nutzen die deskriptive Statistik um Zahlen zusammenzufassen. [Eigentlich *schätzen* wir die **Parameter einer Verteilung**. Aber das kommt nochmal später genauer, wenn wir wissen was Verteilungen sind..]{.aside} Wichtig ist zu wissen, dass wir *mehrere Zahlen* durch meist eine oder zwei Zahlen beschreiben wollen.

```{r }
#| echo: false
#| warning: false

pacman::p_load(tidyverse, readxl, knitr, kableExtra)

data_tbl <- read_excel("data/flea_dog_cat.xlsx")
y_dog <- data_tbl %>% 
  filter(animal == "dog") %>% 
  pull(jump_length)
## y_dog <- c(5.2, 4.9, 12.1, 8.2, 5.6, 9.1, 7.4) 
```

Nehmen wir nun das Beispiel von den Sprungweiten von Hundeflöhen. Wir messen sieben Sprungweiten von sieben Hundeflöhen und messen dabei folgende Werte in \[cm\]: `r pander::p(y_dog, wrap = "", copula = " und ")`. Wir schreiben nun y als einen Vektor in der Form

$$
y = \{`r str_c(y_dog, collapse = ", ")`\}.
$$

In R würde der Vektor wie etwas anders aussehen.

```{r }
y <- c(5.7, 8.9, 11.8, 8.2, 5.6, 9.1, 7.6) 
```

Wir wollen nun die Zahlen in $y$ beschrieben und durch wenige andere Zahlen zusammenfassen. Einige der statistischen Maßzahlen sind dir vermutlich schon bekannt, andere eher neu.

::: callout-note
## Parametrik versus Nicht-Parametrik

Wenn wir einen Zahlenvektor wie durch $y = \{`r str_c(y_dog, collapse = ", ")`\}$ beschrieben zusammenfassen wollen, haben wir zwei Möglichkeiten.

1)  Die **parametrische Variante** indem wir *mit den Zahlen* rechnen und deskriptive Maßzahlen wie Mittelwert, Varianz und Standardabweichung berechnen. Diese Maßzahlen kommen aber in den Zahlen nicht vor.
2)  Die **nicht-parametrische** Variante indem wir die Zahlen in Ränge umwandeln, also sortieren, und *mit den Rängen* der Zahlen rechnen. Die deskriptiven Maßzahlen wären dann Median, Quantile und Quartile.
:::

## Mittelwert

Der Mittelwert einer Zahlenreihe beschreibt den Schwerpunkt der Zahlen. Der Mittelwert wird auch als Lageparameter benannt. [Der **Mittelwert** und der **Median** sind zwei Lageparameter einer Verteilung. Beide beschreiben die Stelle, wo die Verteilungskurve am höchsten ist.]{.aside} Wir schreiben den Mittelwert mit einem Strich über den Vektor, der die Zahlen enthält. Im folgenden ist die Formel für den Mittelwert der Sprungweite in \[cm\] der Hunde gezeigt. Der Mittelwert ist in dem Sinne eine künstliche Zahl, da der Mittlwert häufig nicht in den beobachteten Zahlen vorkommt.

::: column-margin
![](images/angel_01.png){fig-align="center" width="50%"}

Wir werden immer mal wieder **Formeln vereinfachen**. Zum Beispiel nur $\sum$ schreiben anstatt $\sum_i^n$, wenn wir einen Vektor aufsummieren und uns die Indizes sparen...
:::

$$
\bar{y} = \sum_{i=1}^{n}\cfrac{x_i}{n} =
\cfrac{`r str_c(y, collapse = " + ")`}{`r length(y)`} =
`r round(mean(y),2)`
$$

Im Durchschnitt oder im Mittel springen Hundeflöhe `r round(mean(y),2)` cm weit.

In der @fig-index-drawn wollen wir die Formel nochmal visualisieren. Vielleicht fällt dir dann der Zusammenhang von dem Index $i$ und der gesamten Fallzahl $n$ leichter.

![Zusamenhang zwischen $y$ sowie dem Index $i$ in der Formel für den Mittelwert.](images/index-drawn.png){#fig-index-drawn fig-align="center" width="100%"}

In R können wir den Mittelwert einfach mit der Funktion `mean()` berechnen. Wir wollen dann den Mittelwert noch auf die zweite Kommastelle runden. Das machen wir dann mit der Funktion `round()`.

```{r }
y %>% mean %>% round(2)
```

Wir erhalten das gleiche Ergebnis wie oben in unserer händischen Rechnung. Die Hundeflöhe springen im Mittel `r round(mean(y),2)` cm weit.

Der Mittelwert ist eine bedeutende Maßzahl der Normalverteilung. Daher merken wir uns hier schon mal, dass wir den Mittelwert brauchen werden. Auch wenn wir darüber nachdenken ob sich zwei Gruppen unterscheiden, so nutzen wir hierzu den Mitelwert. Unterscheiden sich die *mittleren* Sprungweiten in \[cm\] von Hunde- und Katzenflöhen?

## Spannweite

Die *Spannweite* erlaubt uns zu überprüfen was die kleinste Zahl und die größte Zahl ist. Also uns das Minimum und das Maximum einer Zahlenreihe anzuschauen. Auf den ersten Blick mag das nicht so sinnig sein, aber wenn wir uns hunderte von Beobachtungen anschauen, wollen wir wissen, ob wir nicht einen Fehler bei Eintragen der Daten gemacht haben. Wir wissen eigentlich, dass z.B keine negativen Zuwachsraten auftreten können.

[Die Spannweite dient dazu in einem Datensatz zu übersprüfen ob die **Spalte**, oder auch **Variable** genannt, den richtigen Zahlenraum aufweist. Das machen wir durch die Funktion `range()`.]{.aside}

$$
y_{range} = y_{max} - y_{min} = 12.1 - 4.9 = 7.2
$$ Die Hundeflöhe springen in einer Spannweite von 7.2 cm. Das kommt einem *normal* vor. Die Spannweite ist nicht übertrieben groß. Der minimale Wert ist 4.9 und der maximale Wert it 12.1 und somit sind beide Zahlen in Ordnung. Keine der beiden Zahlen ist übertrieben groß oder gar negativ.

In R können wir die Spannweite mit `range()` wie folgt berechnen. Wir erhalten den minmialen udn maximalen Wert.

```{r }
range(y) 
```

Wir merken uns, dass die Spannweite eine Maßzahl für die Validität der Daten ist. Hat das Experiment geklappt oder kamen da nur komische Zahlen bei raus, die wir so in der Realität nicht erwarten würden. Zum Beispiel negative Sprungweiten, weil wir einmalauf das Minuszeichen gekommen sind.

## Varianz

Bis jetzt können wirmit dem Mittelwert $\bar{y}$ die Lage oder den Mittelpunkt unserer Zahlenreihe beschreiben. Uns fehlt damit aber die Information über die Streuung der Zahlen. Sind die Zahlen alle eher gleich oder sehr verschieden? Liegen die Zahlen daher alle bei dem Mittelwert oder sind die Zahlen weit um den Mittelwert gestreut.

Die Streuung der Zahlen um den Mittelwert beschreibt die Varianz oder auch $s^2$. Wir berechnen die Varianz indem wir von jeder Zahl den Mittelwert aller Zahlen abziehen und dann das Ergebnis quadrieren. Das machen wir für alle Zahlen und addieren dann die Summe auf. Wir erhalten die *Quadratsumme* von $y$.

[**Abweichungsquadrate** sind ein wichtiges Konzept in der Statistik. Wenn wir wissen wollen, wie groß eine Abweichung von einer Zahl zu einer anderen ist, dann nutzen wir immer das Quadrat der Abweichung und bilden die Quadratsumme..]{.aside}

$$
s^2 = \sum_{i=1}^n\cfrac{(y_i - \bar{y})^2}{n-1} = \cfrac{(5.7 -
8.13)^2 + ... + (7.6 - 8.13)^2}{7-1} = 4.6
$$

Die Varianz berschreibt also die Streuung der Zahlen *im Quadrat* um den Mittelwert. Das heißt in unserem Beispiel, dass die Sprungweite eine Varianz von 4.6 cm$^2$ hat. Wir können Quadratzentimeter schlecht interpretieren. Deshalb führen wir gleich die Wuzel der Varianz ein: die Standardabweichung.

In R lässt sich die Varianz einfach durch die Funktion `var()` berechnen.

```{r }
y %>% var %>% round(2) 
```

Wir benötigen die Varianz häufig nur als Zwischenschritt um die Standardabweichung zu berechnen. Das Konzept der Abweichungsquadrate benötigen wir aber in der Varianzanalyse (ANOVA) und für die Beschreibung einer Normalverteilung.

## Standardabweichung

Die *Standardabweichugn* ist die Wurzel der Varianz. Wo die Varianz die Abweichung der Sprungweite in \[cm$^2$\] beschreibt, beschreibt die Standardabweichung die Streung der Sprungweite in \[cm\].

$$
s = \sqrt{s^2} = \sqrt{4.6} = 2.14
$$ [Wir schreiben immer den Mittelwert plusminus die Standardabweichung. Also immer $\bar{y} \pm s$.]{.aside}

Wir können also schreiben, dass die Flöhe im Mittel 8.13 $\pm$ 2.14cm weit springen. Somit haben wir die Lage und die Streuung der Zahlenreihe $y$ der Sprungweite in \[cm\] mit zwei Zahlen beschrieben.

In R können wir die Standardabweichung einfach mit der Funktion `sd()` berechnen.

```{r }
y %>% sd %>% round(2) 
```

## Mittelwert und Varianz - eine Herleitung

Was ist der Mitelwert und die Varianz genau? Schauen wir uns das einmal in @fig-mean-drawn an. Die graue Linie oder Grade beschreibt den Mittelwert der fünf Beobachtungen. Die fünf Beobachtungen sind als blaue Punkt dargestellt. Auf der x-Achse ist nur der Index des Punktes. Das heißt $y_1$ ist der erste Punkte, das der Index $i$ gleich 1 ist.

![Die graue Linie beschreibt den Mittelwert der genau so durch die blauen Punkte geht, dass die Abstände der Punkte oberhalb und unterhalb zu Null aufaddieren. Die Linie liegt in der Mitte der Punkte. Die quadrierten Abstände sind die Varainz der blauen Punkte. Auf der x-Achse ist der Index des Punktes eingetragen.](images/mean-drawn.png){#fig-mean-drawn fig-align="center" width="100%"}

Wenn wir die Summe der Abweichungen von $y_1$ bis $y_5$ zu dem Mittelwert bilden, so wird diese Summe 0 sein. Der Mittelwert liegt genau in der Mitte der Punkte. In unserem Beispiel ist der Mittelwert $\bar{y} = 5.8$. Wi können jetzt die Abstände wie in der folgenden Tabelle berechnen.

::: column-page
| Index $i$ |  y  | $\boldsymbol{\epsilon}$ | $\boldsymbol{y_i - \bar{y}}$ |        Wert        |
|:---------:|:---:|:-----------------------:|:----------------------------:|:------------------:|
|     1     |  5  |      $\epsilon_1$       |       $y_1 - \bar{y}$        |  $5 - 5.8 = -0.8$  |
|     2     |  7  |      $\epsilon_2$       |       $y_2 - \bar{y}$        |  $7 - 5.8 = 1.2$   |
|     3     |  6  |      $\epsilon_3$       |       $y_3 - \bar{y}$        |  $6 - 5.8 = 0.2$   |
|     4     | 4.5 |      $\epsilon_4$       |       $y_4 - \bar{y}$        | $4.5 - 5.8 = -1.3$ |
|     5     | 6.5 |      $\epsilon_5$       |       $y_5 - \bar{y}$        | $6.5 - 5.8 = 0.7$  |
:::

```{r}
#| echo: false
val_vec <- c(5,7,6,4.5,6.5)
epsilon_vec <- c(-0.8, 1.2, 0.2, -1.3, 0.7)
```

Wir nennen die Abstände $y_i - \bar{y}$ nach dem griechischen Buchstaben Epsilon $\epsilon$. Das $\epsilon$ soll an das $e$ von *Error* erinnern. So meint dann *Error* eben auch Abweichung. Ja, es gibt hier viele Worte für das gleiche Konzept.

Wir berechnen einen Mittelwert von den Epsilons mit $\bar{\epsilon} = `r mean(epsilon_vec)`$. Ein Mittelwert nahe Null bzw. von Null wundert uns nicht. Wir haben die Gerade ja so gebaut, das nach oben und unten die gleichen Abstände sind. Die Varianz $s^2$ der $y$ ist $s_y^2 = `r var(val_vec)`$ und die Varianz von $\epsilon$ ist $s_{\epsilon}^2 = `r var(epsilon_vec)`$. In beiden Fällen ist die Zahl gleich. Wir können uns merken, dass die Epsilons einen Mittelwert von 0 haben und eine Varianz von $s_y^2$.

[Wir schreiben auch, dass die Residuen genannt $\epsilon$ normalverteilt sind mit $\mathcal{N}(0, s_y^2)$.]{.aside}

## Standardfehler oder Standard Error (SE)

Wenn wir den Mittelwert der Sprungweiten berichten dann gehört die Standardabweichung der Sprungweiten mit als beschreibendes Maß dazu. Wir berichten keinen Mittelwert ohne Standardabweichung.

Nun ist es aber so, dass der Mittelwert und die Standardabweichung von der Fallzahl abhängen. Je mehr Fallzahl bzw. Beoabchtungen wir haben, desto genauer wird der Mittelwert sein. Oder anders ausgedrückt $\bar{y}$ wird sich $\mu_y$ annähern. Das gleiche gilt auch für die Standardabweichung $s_y$, die sich $\sigma_y$ mit steigender Fallzahl annähert.

Aus diesem Grund brauchen wir noch einen Fehler bzw. eine Maßzahl für die Streuung, die unabhängig von der Fallzahl ist. Wir skalieren also die Standardabweichung mit der Fallzahl indem wir die Standardbweichung durch die Wurzel der Fallzahl teilen.

$$
SE = \cfrac{s}{\sqrt{n}} = \cfrac{2.14}{2.65} = 0.81
$$

Wir müssten ein Paket in R laden um den Standardfehler zu berechnen. Das Laden von zusätzlichen Paketen wollen wir hier aber vermeiden; wir können den Standardfehler auch einfach selber berechnen.

```{r }
se <- sd(y)/sqrt(length(y))
se %>% round(2)
```

Wir erhalten einen Standardfehler von 0.81. Diese Zahl ist in dem Sinne nicht zu interpretieren, da wir hier nur Experimente losgelöst von deren Fallzahl miteinander vergleichen können. Auf der anderen Seite können wir ohne die berichtete Fallzahl nicht vom Standardfehler auf die Standardabweichung schließen.

[Wir berichten den **Standardfehler** immer zusammen mit der Fallazhl, so dass die Standardabweichung berechnet werden kann.]{.aside}

Wir benötigen den Standardfehler eigentlich nicht zum Berichten von Ergebnissen. Der Standardfehler ist nicht als Zahl interpretierbar und somit eine reine statistische Größe. @tbl-comp-stand-sem zeigt die Zusammenfassung und den Vergleich von Standardabweichung und Standardfehler.

| Standardabweichung                                                           | Standardfehler                                                               |
|------------------------------------------------------------------------------|------------------------------------------------------------------------------|
| ... ist eine Aussage über die Streuung der erhobenen Werte einer Stichprobe. | ... ist eine Aussage über die Genauigkeit des Mittelwertes einer Stichprobe. |
| ... hängt von der biologischen Variabilität ab.                              | ... abhängig von der Messgenauigkeit                                         |
| ... ist ein beschreibendes Maß.                                              | ... ist ein statistisches Maß.                                               |
| ... ist nur wenig durch die Größe der Stichprobe beineinflussbar.            | ... steht im direkten Verhältnis zur Größe der Stichprobe.                   |

: Zusammenfassung und Vergleich von Standardabweichung und Standardfehler {#tbl-comp-stand-sem}

::: column-margin
Der Standardfehler oder Standard Error (SE) oder Standard Error of the Mean (SEM) wird uns wieder beim statistischen Testen und dem t-Test begegnen.

$$
T_{calc} = \cfrac{\bar{y_1} - \bar{y_2}}{s_p \cdot \sqrt{\tfrac{2}{n}}} \approx \cfrac{\bar{y_1} - \bar{y_2}}{SEM}
$$

Der Nenner beim t-Test kann als Standardfehler gesehen werden. Wir benötigen den Standardfehler also im Kontext des statistischen Testen als eine statististische Maßzahl.
:::

## Median

$$
4.9,  5.2,  5.6,  \underbrace{7.4,}_{Median}  8.2,  9.1, 12.1
$$

```{r }
median(y) 
```

## Quartile

$$
4.9,  \underbrace{5.2,}_{1st\ Quartile}  5.6,  7.4,  8.2,  9.1, 12.1
$$

$$
4.9,  5.2,  5.6,  7.4,  8.2,  \underbrace{9.1,}_{3rd\ Quartile} 12.1
$$

```{r }
quantile(y, probs = c(0.25, 0.5, 0.75)) 
```

Warum unterscheiden sich die händisch berechneten Quartile von den Quartilen aus R? Es gibt verschiedene Arten der Berechnung. In der Klausur nutzen wir die Art und Weise wie die händische Berechnung hier beschrieben ist. Später in der Anwendung nehmen wir die Werte, die R ausgibt. Die Abweichungen sind so maginal, dass wir diese Abweichungen in der praktischen Anwendung ignorieren wollen.

## Interquartilesabstand (IQR)

$$
IQR = \mbox{3rd Quartile} - \mbox{1st Quartile} = 9.1 - 5.2 = 3.9
$$

## Zusammenfassen von Daten per Faktor

```{r }
data_tbl %>%
  gather(key = "animal", value = "jump_length") %>%
  mutate(animal = as_factor(animal)) %>%
  group_by(animal) %>%
  summarise(mean(jump_length),
            sd(jump_length))


```

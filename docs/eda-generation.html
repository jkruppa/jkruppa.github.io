<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>21&nbsp; Generierung von Daten – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-tests-preface-theory.html" rel="next">
<link href="./eda-transform.html" rel="prev">
<link href="./cover2026_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="21&nbsp; Generierung von Daten – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2026.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./eda-preface.html">Explorative Datenanalyse</a></li><li class="breadcrumb-item"><a href="./eda-generation.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Generierung von Daten</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-generation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Generierung von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der U-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Chi-Quadrat-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mediator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Mediatoranalyse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-marginal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Marginal effect models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">84</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#allgemeiner-hintergrund" id="toc-allgemeiner-hintergrund" class="nav-link active" data-scroll-target="#allgemeiner-hintergrund"><span class="header-section-number">21.1</span> Allgemeiner Hintergrund</a></li>
  <li><a href="#theoretischer-hintergrund" id="toc-theoretischer-hintergrund" class="nav-link" data-scroll-target="#theoretischer-hintergrund"><span class="header-section-number">21.2</span> Theoretischer Hintergrund</a></li>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">21.3</span> Genutzte R Pakete</a></li>
  <li><a href="#r-paket-simstudy" id="toc-r-paket-simstudy" class="nav-link" data-scroll-target="#r-paket-simstudy"><span class="header-section-number">21.4</span> R Paket <code>{simstudy}</code></a></li>
  <li><a href="#gängige-messwerte" id="toc-gängige-messwerte" class="nav-link" data-scroll-target="#gängige-messwerte"><span class="header-section-number">21.5</span> Gängige Messwerte</a>
  <ul class="collapse">
  <li><a href="#normalverteilt" id="toc-normalverteilt" class="nav-link" data-scroll-target="#normalverteilt"><span class="header-section-number">21.5.1</span> Normalverteilt</a></li>
  <li><a href="#possionverteilt" id="toc-possionverteilt" class="nav-link" data-scroll-target="#possionverteilt"><span class="header-section-number">21.5.2</span> Possionverteilt</a></li>
  <li><a href="#ordinalverteilt" id="toc-ordinalverteilt" class="nav-link" data-scroll-target="#ordinalverteilt"><span class="header-section-number">21.5.3</span> Ordinalverteilt</a></li>
  <li><a href="#binomialverteilt" id="toc-binomialverteilt" class="nav-link" data-scroll-target="#binomialverteilt"><span class="header-section-number">21.5.4</span> Binomialverteilt</a></li>
  </ul></li>
  <li><a href="#komplexere-messwerte" id="toc-komplexere-messwerte" class="nav-link" data-scroll-target="#komplexere-messwerte"><span class="header-section-number">21.6</span> Komplexere Messwerte</a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/eda-generation.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/eda-generation.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./eda-preface.html">Explorative Datenanalyse</a></li><li class="breadcrumb-item"><a href="./eda-generation.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Generierung von Daten</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-eda-gen-data" class="quarto-section-identifier"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Generierung von Daten</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 24. September 2025 um 13:13:38</em></p>
<blockquote class="blockquote">
<p><em>“Je größer die Insel des Wissens, desto größer der Strand der Verzweiflung.” — unbekannt</em></p>
</blockquote>
<p>In diesem Kapitel geht es um die Erstellung von zufälligen Daten. Oder anderherum, wir wollen uns künstliche Daten (eng. <em>artificial data</em> oder eng. <em>synthetic data</em>) generieren. Warum machen wir das? Eine Frage, die sich vermutlich kein Statistiker oder Date Scientist stellen würde, ist es doch Teil der wissenschaftlichen Arbeit simulierte Daten zu erstellen. Auf diesen simulierten Daten werden dann die neuen entwickelten Algorithmen getestet. Für Menschen außerhalb der Data Science mag es seltsam erscheinen, dass wir uns einfach Daten erschaffen können. Diese synthetischen Daten kommen dann aber den biologischen Daten manchmal recht Nahe. Daher kannst auch du dir deine Daten theoretisch einfach selber bauen, nachdem du dieses Kapitel gelesen hast.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<blockquote class="blockquote">
<p><em>“With great power comes great responsibility.” — Uncle Ben to Peter Parker in Spiderman</em></p>
</blockquote>
<p>Keine Daten für die Abschlussarbeit erschaffen. Auch wenn die Daten mal nicht so passen, wie du dir das aus einem Experiment erhofft hast, ist es nicht erlaubt sich einfach die Daten selber zu simulieren. Simulierte Daten haben keinen wissenschaftlichen Wert abseits der Validierung von neuen Algorithmen.</p>
<p>Was du aber machen <em>kannst</em>, ist deine experimentellen Daten schon mal im Design vorbauen um deine Analyse in R vorzurechnen. Wenn du dann aus deinem Experiment die echten Daten vorliegen hast, kannst du dann schneller die Analysen rechnen. Du hast dann ja schon alles einmal geübt und vorgearbeitet.</p>
</div>
</div>
<p>Daher nutzen wir diesen Kapitel auch anders. Wir erschaffen uns ja Daten um Algorithmen zu verstehen. Wenn wir wissen wie die Daten aufgebaut sind, dann können wir auch besser verstehen was uns ein Modell oder ein statistischer Test wiedergibt. Dafür brauchen wir dann die synthetischen Daten. Eine andere Möglichkeit ist, dass du einmal ausprobieren möchtest, wie eine potenzielle Analyse ablaufen würde. Dann macht es auch Sinn einmal über künstliche Daten nachzudenken. Ich komme dann immer mal wieder auf dieses Kapitel zurück, wenn ich in anderen Kapiteln mal künstliche Daten brauche. Wir schauen uns verschiedene Wege künstliche Daten zu erschaffen einmal an und es geht auch in Excel relativ einfach.</p>
<section id="allgemeiner-hintergrund" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="allgemeiner-hintergrund"><span class="header-section-number">21.1</span> Allgemeiner Hintergrund</h2>
<blockquote class="blockquote">
<p><em>“We test our framework both on synthetic data, as the only source of ground truth on which we can objectively assess the performance of our algorithms, as well as on real data to demonstrate its real-world practicability.” — <span class="citation" data-cites="jackson2009intelligent">Jackson et al. (<a href="#ref-jackson2009intelligent" role="doc-biblioref">2009</a>)</span></em></p>
</blockquote>
<p>Wenn wir Daten generieren wollen, dann müssen wir auch wissen, was wir genieren wollen. Dafür müssen wir dann verstehen, wovon wir sprechen. Da wir es bei der Datengenerierung auch immer mit statistischen Modellen zu tun haben, müssen wir auch die Fachsprache der statistischen Modellierung nutzen. Dann wollen wir verstehen, was wir eigentlich simulieren. Klar, wir simulieren Daten, aber was brauchen wir dafür an statistischen Maßzahlen? Ich betrachte dann nochmal die Einschränkungen dieses Kapitels, denn wir können natürlich hier nicht alles simulieren, was möglich ist. Faktisch konzentrieren wir uns hier auf häufige Datenstrukturen in den Agrawissenschaften. Dann zeige stelle ich dir nochmal kurz die zwei R Pakete vor, die wir dann hier nutzen können.</p>
<section id="sprachlicher-hintergrund" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="sprachlicher-hintergrund">Sprachlicher Hintergrund</h4>
<blockquote class="blockquote">
<p><em>“In statistics courses taught by statisticians we don’t use independent variable because we use independent on to mean stochastic independence. Instead we say predictor or covariate (either). And, similarly, we don’t say”dependent variable” either. We say response.” — <a href="https://www.reddit.com/r/AskStatistics/comments/qt1hvu/comment/hkigiks/?utm_source=share&amp;utm_medium=web3x&amp;utm_name=web3xcss&amp;utm_term=1&amp;utm_content=share_button">User berf auf r/AskStatistics</a></em></p>
</blockquote>
<p>Wenn wir uns mit dem statistischen Modellieren beschäftigen wollen, dann brauchen wir auch Worte um über das Thema reden zu können. Statistik wird in vielen Bereichen der Wissenschaft verwendet und in jedem Bereich nennen wir dann auch Dinge anders, die eigentlich gleich sind. Daher werde ich mir es hier herausnehmen und auch die Dinge so benennen, wie ich sie für didaktisch sinnvoll finde. Wir wollen hier was verstehen und lernen, somit brauchen wir auch eine klare Sprache.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/personal_opinion.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/personal_opinion.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>“Jeder nennt in der Statistik sein Y und X wie er möchte. Da ich hier nicht nur von Y und X schreiben will, führe ich eben die Worte ein, die ich nutzen will. Damit sind die Worte dann auch richtig, da der Kontext definiert ist. Andere mögen es dann anders machen. Ich mache es eben dann so. Danke.” — Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.</em></p>
</blockquote>
</div>
</div>
</div>
<p>In dem folgenden Kasten erkläre ich nochmal den Gebrauch meiner Begriffe im statistischen Modellieren als Grundlage für die Generierung von Daten. Es ist wichtig, dass wir hier uns klar verstehen. Zum einen ist es angenehmer auch mal ein Wort für ein Symbol zu schreiben. Auf der anderen Seite möchte ich aber auch, dass du dann das Wort richtig einem Konzept im statistischen Modellieren zuordnen kannst. Deshalb einmal hier meine persönliche und didaktische Zusammenstellung meiner Wort im statistischen Modellieren. Du kannst dann immer zu dem Kasten zurückgehen, wenn wir mal ein Wort nicht mehr ganz klar ist. Die fetten Begriffe sind die üblichen in den folgenden Kapiteln. Die anderen Worte werden immer mal wieder in der Literatur genutzt.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Worte und Bedeutungen im statistischen Modellieren
</div>
</div>
<div class="callout-body-container callout-body">
<blockquote class="blockquote">
<p><em>“Die Grenzen meiner Sprache bedeuten die Grenzen meiner Welt.” — Ludwig Wittgenstein</em></p>
</blockquote>
<p>Hier kommt einmal die Tabelle mit den wichtigsten Begriffen im statistischen Modellieren und wie ich die Worte benutzen werde. Damit wir uns verstehen und du was lernen kannst. In anderen Büchern und Quellen findest du teilweise die Worte in einem anderen Sinnzusammenhang. Das ist gut so dort. Bei mir ist es anders.</p>
<div id="tbl-namen-regression" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="14, 10, 38, 38">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-namen-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;21.1— Zusammenfassende Tabelle des Sprachgebrauchs in meinem statistischen Modellieren. Die <em>fett</em> hervorgehobenen Bezeichnungen werden hier genutzt. (<em>LHS</em> = left hand side, <em>RHS</em> = right hand side)
</figcaption>
<div aria-describedby="tbl-namen-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 38%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Symbol</th>
<th>Deutsch</th>
<th>Englisch</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>LHS</em></td>
<td style="text-align: center;"><span class="math inline">\(Y\)</span> / <span class="math inline">\(y\)</span></td>
<td><strong>Messwert</strong> / Endpunkt / Outcome / Abhängige Variable</td>
<td>response / outcome / endpoint / dependent variable</td>
</tr>
<tr class="even">
<td><em>RHS</em></td>
<td style="text-align: center;"><span class="math inline">\(X\)</span> / <span class="math inline">\(x\)</span></td>
<td><strong>Einflussvariable</strong> / Erklärende Variable / Fester Effekt / Unabhängige Variable</td>
<td>risk factor / explanatory / fixed effect / independent variable</td>
</tr>
<tr class="odd">
<td><em>RHS</em></td>
<td style="text-align: center;"><span class="math inline">\(Z\)</span> / <span class="math inline">\(z\)</span></td>
<td><strong>Zufälliger Effekt</strong></td>
<td>random effect</td>
</tr>
<tr class="even">
<td><span class="math inline">\(X\)</span> ist kontinuierlich</td>
<td style="text-align: center;"><span class="math inline">\(c_1\)</span></td>
<td><strong>Kovariate</strong> 1</td>
<td>covariate 1</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(X\)</span> ist kategorial</td>
<td style="text-align: center;"><span class="math inline">\(f_A\)</span></td>
<td><strong>Faktor</strong> <span class="math inline">\(A\)</span> mit Level <span class="math inline">\(A.1\)</span> bis <span class="math inline">\(A.j\)</span></td>
<td>factor <span class="math inline">\(A\)</span> with levels <span class="math inline">\(A.1\)</span> to <span class="math inline">\(A.j\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Am Ende möchte ich nochmal darauf hinweisen, dass wirklich häufig von der abhängigen Variable (eng. <em>dependent variable</em>) als Messwert und unabhängigen Variablen (eng. <em>independent variable</em>) für die Einflussvariablen gesprochen wird. Aus meiner Erfahrung bringt die Begriffe jeder ununterbrochen durcheinander. Deshalb einfach nicht diese Worte nutzen.</p>
<div id="fig-sprache-gif" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sprache-gif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling/dependent_independent.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;21.1— Am Ende läuft es dann doch auf sowas raus…"><img src="stat-modeling/dependent_independent.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sprache-gif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.1— Am Ende läuft es dann doch auf sowas raus…
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="effekt-streuung-und-fallzahl" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="effekt-streuung-und-fallzahl">Effekt, Streuung und Fallzahl</h4>
<p>Was brauchen wir um Daten zu generieren? Wir brauchen einen Effekt, eine Streuung der generierten Daten um den Mittelwert sowie die Fallzahl als Anzahl an Beobachtungen. Dann müssen wir noch entscheiden aus welcher Verteilung unsere Daten kommen sollen. In dem folgenden Venndiagramm habe ich dir nochmal den Dreiklang der drei statistischen Eigenschaften für die Generierung von Daten zusammengefasst. Wir müssen uns also klar werden, welchen Effekt wir simulieren wollen, welche Streuung in den Daten vorliegen soll und natürlich wie viele Beobachtungen wir in den generierten Daten vorfinden wollen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gen-data-venn" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gen-data-venn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-gen-data-venn-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;21.2— Was wird benötigt um Daten zu generieren? Der Effekt beschreibt den Unterschied zwischen Gruppen oder spezieller den Mittelwert in einer Normalverteilung. Die Streuung beschreibt die Unsicherheit in den Daten oder eben die Standardabweichung. Über die Fallzahl wird definiert wie viele Beobachtungen erstellt werden sollen. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-gen-data-venn-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gen-data-venn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.2— Was wird benötigt um Daten zu generieren? Der Effekt beschreibt den Unterschied zwischen Gruppen oder spezieller den Mittelwert in einer Normalverteilung. Die Streuung beschreibt die Unsicherheit in den Daten oder eben die Standardabweichung. Über die Fallzahl wird definiert wie viele Beobachtungen erstellt werden sollen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir machen wir das jetzt praktisch in R. Dazu haben wir verschiedene Möglichkeiten, wir beginnen hier einmal mit der simpelsten Form. Mit der Funktion <code>rnorm()</code> können wir uns zufällige Daten aus einer theoretischen Normalverteilung ziehen. Es gibt natürlich noch viel mehr <code>r*</code>-Funktionen für die Generierung von Daten. Die Seite <a href="https://www.stat.umn.edu/geyer/old/5101/rlook.html">Probability Distributions in R</a> zeigt nochmal einen großen Überblick. Im <a href="eda-distribution.html">Kapitel zu den Verteilungen</a> findest du dann auch nochmal mehr Informationen zu den einzelnen Funktionen.</p>
<p>Fangen wir aber einmal mit der einfachen Funktion für die Normalverteilung an. Hier genieren wir uns also einmal fünf Beobachtungen aus einer Normalverteilung. Wir brauchen dafür die Fallzahl (<code>n</code>), die wir generieren wollen. Dann den Mittelwert der theoretischen Verteilung (<code>mean</code>) sowie die Streuung (<code>sd</code>). Dann erhalten wir fünf Zahlen, die in der Gesamtheit den vorgestellten Zahlen entsprechen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.75  0.02  0.77 -1.17  0.39</code></pre>
</div>
</div>
<p>Wenn wir jetzt den Mittelwert der fünf Zahlen berechnen, dann erhalten wir aber gar nicht einen Mittelwert von <span class="math inline">\(0\)</span> und auch nicht eine Standardabweichung von <span class="math inline">\(1\)</span> wieder. Wie kann das sein? Häufig stolperst du hier ein wenig. Wieso Daten generieren, wenn die Daten dann nicht die Eigenschaften haben, die wir wollen? Hier kommt die Grundgesamtheit und die Stichprobe ins Spiel. In der Grundgesamtheit hast du einen Mittelwert von <span class="math inline">\(2\)</span> und eine Standardabweichung von <span class="math inline">\(1\)</span> vorliegen. Du ziehst aber nur eine kleine Stichprobe wie ich dir einmal in der folgenden Abbildung zeige. Zwar liegt der theoretische Mittelwert auf der Null, aber die Mittelwerte der einzelnen Simulationen können stark variieren.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gen-data-normal" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gen-data-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-gen-data-normal-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;21.3— Visualisierung der Abweichung des beobachteten Mittelwerts von dem theoretischen Mittelwert der Normalverteilung. Fünf Simulationen mit je fünf Beobachtungen wurden durchgeführt und jeweils der Mittelwert berechnet. Die Beobachtungen wurde aus einer Standardnormalverteilung mit \mathcal{N}(0, 1) gezogen. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-gen-data-normal-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gen-data-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.3— Visualisierung der Abweichung des beobachteten Mittelwerts von dem theoretischen Mittelwert der Normalverteilung. Fünf Simulationen mit je fünf Beobachtungen wurden durchgeführt und jeweils der Mittelwert berechnet. Die Beobachtungen wurde aus einer Standardnormalverteilung mit <span class="math inline">\(\mathcal{N}(0, 1)\)</span> gezogen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Der Zusammenhang wird dir vielleicht dann nochmal in der folgenden Abbildung klarer. Ich habe hier einmal eine kleine Simulation laufen lassen. Dabei habe ich immer Daten aus einer Standardnormalverteilung mit einem Mittelwert von <span class="math inline">\(0\)</span> und einer Standardabweichung von <span class="math inline">\(1\)</span> generiert. Was ich dabei geändert habe ist die Fallzahl. Wenn ich nur zwei Beobachtungen generiere, dann finde ich eine große Breite an beobachteten Mittelwerten. Wenn ich die Fallzahl erhöhe, dann komme ich immer näher an den erwarteten Mittelwert in meinen beobachteten Daten heran. Bei eintausend Beobachtungen habe ich faktisch kaum noch eine Abweichung vorliegen. Hier siehst du eben, es kommt auch stark auf die Fallzahl an. Wenn du dir zu wenig Beobachtungen anschaust, dann wirst du nicht immer den theoretischen Mittelwert oder Effekt in den generierten Daten wiederfinden.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gen-data-mean-sim" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gen-data-mean-sim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-gen-data-mean-sim-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Abbildung&nbsp;21.4— Zusammenhang zwischen der simulierten Anzahl an Beobachtungen und dem beobachteten Mittelwert zu dem theoretischen Mittelwert der Verteilung aus der die Beobachtungen generiert wurden. Die Beobachtungen wurde aus einer Standardnormalverteilung mit \mathcal{N}(0, 1) gezogen. Es wurden 1000 Simulationen durchgeführt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-gen-data-mean-sim-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="720"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gen-data-mean-sim-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.4— Zusammenhang zwischen der simulierten Anzahl an Beobachtungen und dem beobachteten Mittelwert zu dem theoretischen Mittelwert der Verteilung aus der die Beobachtungen generiert wurden. Die Beobachtungen wurde aus einer Standardnormalverteilung mit <span class="math inline">\(\mathcal{N}(0, 1)\)</span> gezogen. Es wurden 1000 Simulationen durchgeführt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="welche-möglichkeiten-gibt-es-eigentlich" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="welche-möglichkeiten-gibt-es-eigentlich">Welche Möglichkeiten gibt es eigentlich?</h4>
<p>Wenn wir Daten generieren wollen, dann haben wir im Prinzip zwei Möglichkeiten. Wir bauen uns die Daten selber per Hand in Excel oder aber nutzen die entsprechenden R Pakete. Ich stelle hier die zwei größeren R Pakete vor sowie die Lösungen per Hand in Excel. Wir haben natürlich auch die Möglichkeit die Daten in R ohne Pakete zu erstellen. Das macht in einem einfacheren Setting auch mehr Sinn.</p>
<ul>
<li>Das <a href="https://cran.r-project.org/web/packages/simstudy/vignettes/simstudy.html">R Paket <code>{simstudy}</code></a> liefert eigentlich alles was wir brauchen, wenn die Daten komplizierter werden. Insbesondere wenn wir keinen normalverteilten Messwert vorliegen haben oder aber abhängige Einflussvariablen. Wenn ich größere Datensätze generiere, dann nutze ich gerne dieses Paket. Hier gibt es aber die Einschränkung, dass sich faktorielle Experimente nicht gut darstellen lassen. In diesem Fall ist die händische Erstellung manchmal einfacher.</li>
<li>Das <a href="https://cran.r-project.org/web/packages/simdata/vignettes/Demo.html">R Paket <code>{simdata}</code></a> hat den Vorteil große, komplexe Korrelationsstrukturen abzubilden. Wir können hier Netzwerkeffekte gut darstellen und dann auch in einen Datensatz übersetzen. Auch Transformationen von Daten lassen sich hier gut integrieren. Hier liegt aber nicht der Fokus auf einem faktoriellen Design mit Gruppeneffekten.</li>
<li>Wir schauen uns natürlich auch Excel an. Hier haben wir natürlich gleich die Möglichkeit uns die Daten dort zu bauen, wo wir die erhobenen Messwerte dann später nach dem durchgeführten Experiment auch abspeichern. Deshalb zeige ich auch hier einmal wie wir dann die Daten händisch aufbauen.</li>
</ul>
<p>Abschließend muss ich noch erwähnen, dass faktorielle Designs, die wir dann häufig in den Agrarwissenschaften finden, wir am besten dann händisch in R zusammenbauen. Wir nutzen dann die Funktionen, die es schon in R gibt und erstellen uns dann selber den Datensatz. Das ist im Prinzip so ähnlich wie in Excel nur das wir etwas besser nachvollziehbare Wege haben.</p>
</section>
</section>
<section id="theoretischer-hintergrund" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="theoretischer-hintergrund"><span class="header-section-number">21.2</span> Theoretischer Hintergrund</h2>
<p>Neben dem allgemeinen Hintergrund können wir natürlich auch etwas tiefer in die Materie einsteigen. Zum einen müssten wir überlegen, welche Effekte es eigentlich gibt. Wir wollen ja Daten generieren, die nicht gleich sind. Daher wollen wir etwas bauen, wo wir auch einen Effekt sehen. Zwar ist es auch interessant sich Daten zu generieren wo die Nullhypothese wahr ist und nichts passiert, aber das ist eher nicht der Fokus der praktischen Arbeit. Wenn wir ein Experiment machen, dann wollen wir eigentlich auch einen Effekt oder Unterschied in den Gruppen oder allgemeiner den Daten sehen.</p>
<section id="welche-effekte-gibt-es" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="welche-effekte-gibt-es">Welche Effekte gibt es?</h4>
<p>Wenn wir also Wissen, dass wir einen Effekt <span class="math inline">\(\Delta\)</span>, eine Streuung <span class="math inline">\(s\)</span> und Fallzahl <span class="math inline">\(n\)</span> definieren müssen um uns zufällige Daten zu generieren, was sind denn dann die Effekte? Die Streuung und die Fallzahl sind ja relativ einfach zu verstehen. Die Fallzahl legen wir fest und es ist eben die Anzahl an Beobachtungen, die wir generieren wollen. Im Prinzip also die Anzahl an Zeilen in unserem Datensatz. Die Streuung ist schon etwas schwerer zu fassen, ist aber am Ende nichts anderes als die Varianz in den Daten. Also zum Beispiel bei einer Normalverteilung, wie stark streuen meine Beobachtungen um den Mittelwert. Die Effekt sind schon etwas schwerer zu greifen, da wir hier erst mal definieren müssen, welche Effekte es gibt. Grob gesprochen gibt es im Rahmen der Generierung von Daten zwei Effekte von Bedeutung. Entweder sind wir an einer Mittelwertsdifferenz interessiert oder aber an einem Anteil.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Mittelwertsdifferenz</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Anteilsverhältnis</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Die Mittelwertsdifferenz wird sehr häufig als Effektschätzer genutzt, wenn wir Daten erstellen wollen. Du kennst die Mittelwertsdifferenz schon aus der Darstellung der Mittelwerte von Gruppen anhand des Barplots. Hier können wir als Effekt entweder auf den absoluten Mittelwertsunterschied hinaus wollen oder aber die relative Veränderung angeben. Im Rahmen der Simulation nutzen wir die absolute Differenz sehr viel häufiger. In der folgenden Abbildung habe ich dir einmal für zwei Gruppen in einem Faktor einen Barplot sowie die Mittelwertsdifferenz mit Dotplots dargestellt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gen-data-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gen-data-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-gen-data-03-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Abbildung&nbsp;21.5— Darstellung eines einfaktoriellen Datensatzes mit zwei Gruppen und unterschiedlichen Mittelwerten bei gleicher Varianz für einen normalverteilten Messwert. Der Effekt ist hier die Mittelwertsdifferenz. (A) Säulendiagramm (eng. barplot) (B) Dotplot mit absoluter und relativer Differenz zwischen den beiden Gruppen. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-gen-data-03-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="720"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gen-data-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.5— Darstellung eines einfaktoriellen Datensatzes mit zwei Gruppen und unterschiedlichen Mittelwerten bei gleicher Varianz für einen normalverteilten Messwert. Der Effekt ist hier die Mittelwertsdifferenz. <strong>(A)</strong> Säulendiagramm (eng. <em>barplot</em>) <strong>(B)</strong> Dotplot mit absoluter und relativer Differenz zwischen den beiden Gruppen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Eine andere Möglichkeit sind die Anteile. Hier fragen wir, wie häufig tritt ein Ereignis in der Population auf? Daher ist die Pflanze krank? Oder aber, liegen wir im Zielbereich? Wir sind hier an einem Anteilsverhältnis interessiert. Anteile werden in unserem Kontext eigentlich immer mit ja (1) oder nein (0) kodiert. Wenn wir also zwei Gruppen haben, die gesunden und die kranken Pflanzen, dann können wir die Anteile an gesunden und kranken Pflanzen auf zwei Arten berechnen. Entweder sind wir an dem Anteil von den kranken Pflanzen an allen Pflanzen interessiert, dann rechnen wir ein Verhältnis. Wenn wir aber den Anteil von kranken Pflanzen an gesunden Pflanzen wollen, dann berechnen wir die Chance. In der folgenden Abbildung habe ich dir den Zusammenhang nochmal dargestellt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gen-data-rr-or-intro" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gen-data-rr-or-intro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-gen-data-rr-or-intro-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Abbildung&nbsp;21.6— Visualisierung zweier Effektschätzer für Anteile an einem gestapelten Säulendiagramm (eng. stacked barplot) für einen Faktor mit einer Gruppe A.1. (A) Das Verhältnis (eng. ratio) beschreibt den Anteil der blauen Beobachtungen an allen Beobachtungen. Daher ein Art mittleres Verhältnis. (B) Die Chance (eng. odd) beschreibt den Anteil von blauen zu orangen Beobachtungen. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-gen-data-rr-or-intro-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1008"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gen-data-rr-or-intro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.6— Visualisierung zweier Effektschätzer für Anteile an einem gestapelten Säulendiagramm (eng. <em>stacked barplot</em>) für einen Faktor mit einer Gruppe <span class="math inline">\(A.1\)</span>. <strong>(A)</strong> Das Verhältnis (eng. <em>ratio</em>) beschreibt den Anteil der blauen Beobachtungen an allen Beobachtungen. Daher ein Art mittleres Verhältnis. <strong>(B)</strong> Die Chance (eng. <em>odd</em>) beschreibt den Anteil von blauen zu orangen Beobachtungen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Etwas wilder wird es jetzt, wenn wir die Effekte zwischen zwei Gruppen mit Anteilen berechnen wollen. Hier nutzen wir dann nicht die Differenz sondern ebenfalls den Anteil. Daher haben wir es hier mit einem Anteil von einem Anteil zu tun. Daher berechnen wir hier dann das Risikoverhältnis (eng. <em>risk ratio</em>) oder aber das Chancenverhältnis (eng. <em>odds ratio</em>). Als reine Formel ist es dann meistens verwirrender, deshalb hier einmal als Abbildung visualisiert. In dem <a href="stat-tests-effect.html">Kapitel zu den Effektschätzern</a> kannst du noch mehr lesen und dein Wissen vertiefen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gen-data-rr-or" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gen-data-rr-or-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-gen-data-rr-or-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Abbildung&nbsp;21.7— Visualisierung zweier Effektschätzer für Anteilsverhältnisse an zwei gestapelten Säulendiagramm (eng. stacked barplot) für einem Faktor mit zwei Gruppen A.1 und A.2. (A) Das Risikoverhältnis (eng. risk ratio) beschreibt den Anteil der blauen Beobachtungen an allen Beobachtungen im Verhältnis der beiden Gruppen. (B) Das Chancenverhältnis (eng. odds ratio) beschreibt den Anteil von blauen zu orangen Beobachtungen im Verhältnis der beiden Gruppen. Der Doppelbruch kann dann entsprechend umgeformt werden. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-gen-data-rr-or-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1008"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gen-data-rr-or-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.7— Visualisierung zweier Effektschätzer für Anteilsverhältnisse an zwei gestapelten Säulendiagramm (eng. <em>stacked barplot</em>) für einem Faktor mit zwei Gruppen <span class="math inline">\(A.1\)</span> und <span class="math inline">\(A.2\)</span>. <strong>(A)</strong> Das Risikoverhältnis (eng. <em>risk ratio</em>) beschreibt den Anteil der blauen Beobachtungen an allen Beobachtungen im Verhältnis der beiden Gruppen. <strong>(B)</strong> Das Chancenverhältnis (eng. <em>odds ratio</em>) beschreibt den Anteil von blauen zu orangen Beobachtungen im Verhältnis der beiden Gruppen. Der Doppelbruch kann dann entsprechend umgeformt werden. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Was nehmen wir hier mit?</p>
<ul>
<li>Die Mittelwertsdifferenz ist zu gebrauchen, wenn wir von einem normalverteilten Messwert ausgehen. Oder aber, wenn wir mit den mittleren Effekt leben können. Wir wollen also die mittlere Anzahl an Blattläusen anstatt die Anzahl vergleichen. Oder aber die mittlere Infektionsrate anstatt den Anteil der kranken Pflanzen.</li>
<li>Anteilsverhätnisse nutzen wir, wenn wir einen Messwert vorliegen haben, der nicht normalverteilt ist und wir über die Anteile von Gruppen in unserem Messwert sprechen wollen. Daher wir wollen über den Anteil in den Boniturnotenstufen reden oder aber den Anteil an kranken Pflanzen modellieren.</li>
</ul>
<p>Häufig reicht erstmal eine Genierung mit dem Mittelwert und der Mittelwertsdifferenz. Wir können uns vielen Fragstellungen erst mal mit einem Mittel annäheren und dann später nochmal differenzierter Auswerten. Beachte immer, das es hier ja um die Erstellung von künstlichen Daten geht, die selten die Komplexizität echter Daten abbilden können. Daher habe ich hier auch den Fokus auf der Normalverteilung und der Generierung von mittleren Differenzen.</p>
</section>
<section id="effekt-und-streuung" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="effekt-und-streuung">Effekt und Streuung</h4>
<p>Jetzt müssen wir noch den Zusammenhang zwischen Effekt und Streuung verstehen. Je höher deine Fallzahl ist, desto eher wirst du in den genierten Daten deine voreingestellten Effekte wiederfinden. Es gibt aber noch die Variable der Streuung. Wenn du eine Streuung mit ins Spiel bringst, dann werden natürlich auch deine Effekte wiederum verzerrt. Bei einer Streuung erhälst du nicht deine voreingestellten Werte genau so wieder. Das ist manchmal etwas verwirrend, aber auch häufig der Grund warum wir nicht nur einen Datensatz simulieren sondern viele, die wir dann eben mitteln. Das hat aber keine Relevanz, wenn du deine Daten generierst um deine Analysepipeline zu testen. Wir schauen uns jetzt einmal den Fall eines faktoriellen und eines kovariaten Designs an.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Faktorielles Design</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Kovariates Design</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>In dem folgenden Beispiel habe ich ein einfaktorielles Design mit nur zwei Leveln gewählt. Wir sehen recht gut, das wir bei keinem Effekt keinen Mittelwertsunterschied vorliegen haben. Ich habe hier eine Mittelwertsdifferenz von <span class="math inline">\(+3\)</span> voreingestellt. Wenn wir dann auch keine Streuung vorliegen haben, dann liegen alle Beobachtungen auf dem Mittelwert als ein Punkt. Wenn wir dann Streuung vorliegen haben, dann spreizen die Punkte auf dem Faktorlevel. Durch die Streuung können wir dann auch nicht mehr exakt die voreingestellten Effekte wiederfinden. Je kleiner die Fallzahl, desto größer ist dann die Abweichung von den voreingestellten Effekten.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gen-data-square-fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gen-data-square-fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-gen-data-square-fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Abbildung&nbsp;21.8— Darstellung eines absoluten und relativen Effekt in einem einfaktoriellen Design mit zwei Leveln A.1 und A.2 als Gruppen. Der Effekt ist die absolute oder relative Mittelwertsdifferenz. Pro Gruppe wurden sechs Beobachtungen erhoben. Ohne Streuung geht die Grade direkt durch die Mittelwerte der Gruppen. (A) Kein Effekt und keine Streuung. Die absolute Mittelwertsdifferenz ist 0 und die relative Mittelwertsdifferenz ist x1 als Faktor. (B) Effekt und keine Streuung. Die absolute Mittelwertsdifferenz ist +3 und die relative Mittelwertsdifferenz ist x1.5 als Faktor. (C) Kein Effekt und Streuung. Die absolute Mittelwertsdifferenz ist -0.5 und die relative Mittelwertsdifferenz ist x0.93 als Faktor.(D) Effekt und Streuung. Die absolute Mittelwertsdifferenz ist +2.7 und die relative Mittelwertsdifferenz ist x1.4 als Faktor. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-gen-data-square-fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gen-data-square-fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.8— Darstellung eines absoluten und relativen Effekt in einem einfaktoriellen Design mit zwei Leveln <span class="math inline">\(A.1\)</span> und <span class="math inline">\(A.2\)</span> als Gruppen. Der Effekt ist die absolute oder relative Mittelwertsdifferenz. Pro Gruppe wurden sechs Beobachtungen erhoben. Ohne Streuung geht die Grade direkt durch die Mittelwerte der Gruppen. <strong>(A)</strong> Kein Effekt und keine Streuung. Die absolute Mittelwertsdifferenz ist 0 und die relative Mittelwertsdifferenz ist x1 als Faktor. <strong>(B)</strong> Effekt und keine Streuung. Die absolute Mittelwertsdifferenz ist +3 und die relative Mittelwertsdifferenz ist x1.5 als Faktor. <strong>(C)</strong> Kein Effekt und Streuung. Die absolute Mittelwertsdifferenz ist -0.5 und die relative Mittelwertsdifferenz ist x0.93 als Faktor.<strong>(D)</strong> Effekt und Streuung. Die absolute Mittelwertsdifferenz ist +2.7 und die relative Mittelwertsdifferenz ist x1.4 als Faktor. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Haben wir ein kovariates Design vorliegen, dann wollen wir ja die Steigung in der Graden als Effekt einstellen. Ich habe hier eine Steigung von <span class="math inline">\(+1.5\)</span> und einen Intercept von <span class="math inline">\(3\)</span> voreingestellt. Wir brauchen immer etwas Streuung, sonst kann der Algorithmus keine Grade berechnen. Daher hier auch bei keiner Streuung ein winziger Wert, den wir dann eben auch in der Steigung wiederfinden. Ohne Streuung erhalten wir auch die voreingestellten Werte für die Steigung wieder. Haben wir keinen Effekt der Kovariaten auf den Messwert, dann haben wir auch keine Steigung. Sobald wir Streuung ins Spiel bringen, haben wir auch eine mehr oder minder starke Abweichung in den Daten. Insbesondere bei keinem Effekt und dann noch Streuung kann man schnell denken, dass wir doch was in den Daten hätten.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gen-data-square-cov" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gen-data-square-cov-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-gen-data-square-cov-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Abbildung&nbsp;21.9— Darstellung eines Effekts als Steigung in einem kovariaten Design. Der Effekt der Steigung ist mit \beta_1 gleich +1.5 und der Intercept ist mit \beta_0 gleich 3 voreingestellt. Durch die Streuung mit der geringen Fallzahl von sechs Beobachtungen kann Steigung nicht immer erreicht werden. (A) Kein Effekt und keine Streuung. Die Steigung ist faktisch 0 und der Intercept 3. (B) Effekt und keine Streuung. Dei Steigung ist 1.5 und der Intercept ist 3. (C) Kein Effekt und moderate Streuung. Durch die Streuung entsteht eine leichte negative Steigung und eine Abweichung vom Intercept. (D) Effekt und moderate Streuung. Die Steigung und der Intercept werden durch die Streuung verzerrt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-gen-data-square-cov-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gen-data-square-cov-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.9— Darstellung eines Effekts als Steigung in einem kovariaten Design. Der Effekt der Steigung ist mit <span class="math inline">\(\beta_1\)</span> gleich +1.5 und der Intercept ist mit <span class="math inline">\(\beta_0\)</span> gleich 3 voreingestellt. Durch die Streuung mit der geringen Fallzahl von sechs Beobachtungen kann Steigung nicht immer erreicht werden. <strong>(A)</strong> Kein Effekt und keine Streuung. Die Steigung ist faktisch 0 und der Intercept 3. <strong>(B)</strong> Effekt und keine Streuung. Dei Steigung ist 1.5 und der Intercept ist 3. <strong>(C)</strong> Kein Effekt und moderate Streuung. Durch die Streuung entsteht eine leichte negative Steigung und eine Abweichung vom Intercept. <strong>(D)</strong> Effekt und moderate Streuung. Die Steigung und der Intercept werden durch die Streuung verzerrt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="einschränkungen-bei-der-generierung" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einschränkungen-bei-der-generierung">Einschränkungen bei der Generierung</h4>
<p>Wenn wir über die Simulation von Daten sprechen, dann kommen wir nicht darum herum einmal über die schrecklich nette Familie der Verteilungen zu sprechen. Wir haben ja nicht nur auf der rechten Seite der Tilde unsere Einflussvariablen, die entweder Faktoren oder Kovariaten sind, sondern auch die Messwerte, die wir simulieren wollen. Diese Messwerte gehören aber einer Verteilungsfamilie an. Zwar ist die Normalverteilung (eng. <em>gaussian</em>) sehr häufig aber können wir mit der Normalverteilung nicht alle Messwerte abbilden. Daher brauchen wir auch die anderen Verteilungen. Daher hier einmal die Übersicht für dich. Das R Paket <code>{simstudy}</code> hat eine <a href="https://kgoldfeld.github.io/simstudy/articles/simstudy.html#distributions">Vielzahl an Verteilungen implementiert</a> auf die wir hier nicht tiefer eingehen werden.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gen-data-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gen-data-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-gen-data-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Abbildung&nbsp;21.10— Erweiterte Darstellung der statistischen Modellierung. Die Messwerte Y folgen einer Verteilung. Die Einflussvariablen liegen kontinuierlich als Kovariaten oder aber kategorial als Faktoren vor. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-gen-data-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gen-data-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.10— Erweiterte Darstellung der statistischen Modellierung. Die Messwerte <span class="math inline">\(Y\)</span> folgen einer Verteilung. Die Einflussvariablen liegen kontinuierlich als Kovariaten oder aber kategorial als Faktoren vor. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir konzentrieren uns hier nur auf einen kleinen Teil der möglichen Simulationen und Datengenerierungen. Das hat neben der vielen möglichen Verteilungen auch den Grund, dass wir usn hier ja nicht mit der algorithmischen Modellentwicklung in der Statistik beschäftigen wollen. Wir wollen ja nicht neue Algorithmen bauen und diese dann auf Daten evaluieren. Daher konzentrieren wir uns hier auf wenige Verteilungen, die dann aber das abbilden, was wir häufig brauchen. Wenn du mehr über Verteilungen wissen willst, dann ist die Shiny App <a href="https://ben18785.shinyapps.io/distribution-zoo/">The distribution zoo</a> einen Besuch wert. Als Literatur kann ich dir nur <span class="citation" data-cites="dormann2013parametrische">Dormann (<a href="#ref-dormann2013parametrische" role="doc-biblioref">2013</a>)</span> empfehlen, der sehr detailliert für Einsteiger auf Verteilungen eingeht.</p>
<ul>
<li>Die <strong>Normalverteilung</strong> erlaubt uns das Frischegewicht, Trockengewicht oder aber Chlorophyllgehalt zu simulieren. Also im Prinzip die Messwerte, die wir hauptsächlich in einem agrawissenschaftlichen Umfeld erheben.</li>
<li>Die <strong>Possionverteilung</strong> erlaubt uns alles was wir Zählen zu simulieren. Also im Prinzip alle Anzahlen von Schädlingen oder aber Blütenstände sowie Blättern. Wir zählen hier eben etwas.</li>
<li>Die <strong>Ordinalverteilung</strong> ist dafür gut, wenn wir Noten simulieren wollen. Daher brauchen wir die Ordinalverteilung um unsere Boniturnoten zu generieren. Prinzipiell aber auch die Antwortverteilungen in einem Fragebogen.</li>
<li>Die <strong>Binomialverteilung</strong> ist die Verteilung, die wir nutzen, wenn wir nur zwei mögliche Messwerte haben. Also im prinzip gesunde Beobachtung oder kranke Beobachtung. Wir haben nur zwei Ausprägungen in dem Messwert vorliegen.</li>
</ul>
<p>Neben den vorgestellten Verteilungen schauen wir uns dann noch die Simulation von <strong>pseudo Zeitreihen</strong> an. Wir haben hier dann verschiedene Messwerte über einen zeitlichen Verlauf vorliegen. Teilweise dann in einer etwas wirren Form, da wir eventuell keinen linearen Zusammenhang mehr vorliegen haben. Daher müssen wir dann hier etwas mehr schauen, dass wir die Daten gut simuliert kriegen.</p>
<p>Dann mache ich hier noch die Einschränkung, dass ich prinzipiell alles unter der Annahme der Varianzhomogenität generiere. Daher addiere ich über alle Faktorkombinationen oder Gruppen immer den gleichen Fehler auf. Im Prinzip kannst du natürlich auch für einzelne Faktorkombinationen dann einen anderen Fehler addieren und dir dafür einen Vektor mit unterschiedlichen Fehlertermen bauen, aber darauf gehe ich nur einmal kurz bei dem einfakoriellen Design ein. Und dann noch die Ergänzung, dass wir uns immer nur balancierte Designs erstellen. Das heißt wir haben keine fehlenden Werte in unseren Daten und die Gruppen in unseren Faktoren haben auch immer die gleiche Fallzahl.</p>
</section>
<section id="selbst-gebaute-verteilungen" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="selbst-gebaute-verteilungen">Selbst gebaute Verteilungen</h4>
<p>Am Ende möchte ich noch auf eine andere Art der Simulation von Daten eingehen. Wir können uns auch eine wilde Verteilung selber bauen und dann aus dieser wilden Verteilung dann unsere Beobachtungen ziehen. In dem Tutorium <a href="https://lindeloev.github.io/tests-as-linear/simulations/simulate_wilcoxon.html">Wilcoxon is (almost) a one-sample t-test on signed ranks</a> wird einmal gezeigt wie wir das machen könnten. Wir bauen uns dazu erst mal eine Verteilung, die aus drei Verteilungen besteht. Wir haben hier aber ein paar Einschränkungen. Zum einen ist unsere Verteilung um die Null angeordnet. Das macht es einfacher verschiedene Verteilungen miteinander zu verbinden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>null_dist_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>), </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">exp</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>)), </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">runif</span>(<span class="dv">10000</span>, <span class="at">min=</span><span class="sc">-</span><span class="dv">3</span>, <span class="at">max=</span><span class="sc">-</span><span class="dv">2</span>)),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">"null"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann siehst du hier einmal die Verteilung dargestellt. Wenn wir nur aus dieser Verteilung Beobachtungen ziehen, dann haben wir natürlich einen Effekt zwischen potenziellen Gruppen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gen-data-own-dist" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gen-data-own-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-gen-data-own-dist-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Abbildung&nbsp;21.11— Selbstgebaute Verteilung mit einem Plateu und einem steilen Peak. Die Messwerte sind auch negative, da alle ursprünglichen drei Verteilungen um die Null zentriert sind. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-gen-data-own-dist-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gen-data-own-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.11— Selbstgebaute Verteilung mit einem Plateu und einem steilen Peak. Die Messwerte sind auch negative, da alle ursprünglichen drei Verteilungen um die Null zentriert sind. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wenn wir jetzt noch einen Effekt haben wollen, dann können wir natürlich die beiden Gruppen nicht aus der gleichen Verteilung ziehen. Daher können wir uns auch noch eine Alternative Verteilung bauen indem wir einfach die Messwerte um einen fixen Effekt erhöhen. Hier wähle einen Effekt von <span class="math inline">\(+2\)</span>. Du kannst natürlich auch die Nullverteilung erstmal aus dem negativen herausschieben und dann nochmal einen Effekt addieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>eff_dist_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>), </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">exp</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>)), </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">runif</span>(<span class="dv">10000</span>, <span class="at">min=</span><span class="sc">-</span><span class="dv">3</span>, <span class="at">max=</span><span class="sc">-</span><span class="dv">2</span>)),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">"alt"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> y <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(null_dist_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung siehst du dann einmal wie sich die beiden Verteilungen mit den unterschiedlichen Effekten ergeben. Bitte beachte, dass die Alternative erst mal neu generiert wurde und nicht die verschobene Nullhypothese ist. Daher hat die Alternative natürlich auch eine andere Verteilung als die Nullhypothese.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gen-data-own-dist-eff" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gen-data-own-dist-eff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-gen-data-own-dist-eff-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Abbildung&nbsp;21.12— Selbstgebaute Verteilung mit einem Plateu und einem steilen Peak für die Nullhypothese und die Alternativehypothese verschoben um den Effekt von +2. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-gen-data-own-dist-eff-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gen-data-own-dist-eff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.12— Selbstgebaute Verteilung mit einem Plateu und einem steilen Peak für die Nullhypothese und die Alternativehypothese verschoben um den Effekt von <span class="math inline">\(+2\)</span>. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Für die Generierung deiner Daten würdest du dann mit <code>slice_sample()</code> dir dann die gewünschten Anzahlen aus den beiden Verteilungen rausziehen. Hier hilft die tolle Funktion <code>group_by()</code>, die dir dann alles in einem Abwasch macht. Ich will hier pro Gruppe dann nur drei zufällig ausgewählte Beobachtungen haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>eff_dist_tbl <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
# Groups:   type [2]
       y type 
   &lt;dbl&gt; &lt;chr&gt;
1 -0.794 alt  
2  2.86  alt  
3  2.83  alt  
4 -0.697 null 
5  6.27  null 
6 -1.13  null </code></pre>
</div>
</div>
<p>Bei den selbstgebauten Verteilungen ist die Effektzuweisung aber überhaupt nicht einfach und ab zwei Gruppen wird es wirklich nicht mehr schön. Daher zeige ich dir hier nur die Idee, in der Anwendung zeige ich dir etwas robustere Varianten, die einfacher zu bedienen sind. Wenn es aber wirklich mal was wirres sein soll, dann ist diese Art der Verteilungserstellung wirklich eine Möglichkeit um auf künstliche Daten zu kommen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die Genierung von Daten
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir immer geht natürlich mehr als ich hier Vorstellen kann. Du findest im Folgenden Tutorien, die mich hier in dem Kapitel inspiriert haben. Ich habe mich ja in diesem Kapitel auf die Durchführbarkeit in R und die allgemeine Verständlichkeit konzentriert.</p>
<ul>
<li>Einen guten Überblick liefert Brad Duthie in seinem Tutorium <a href="https://stirlingcodingclub.github.io/simulating_data/index.html">Creating simulated data sets in R</a>. Hier kannst du dich dann nochmal in die Grundlagen einlesen.</li>
<li>Auch Excel kann künstliche Daten generieren. Dafür schaue ich dann immer in die <a href="https://support.microsoft.com/de-de/office/statistische-funktionen-referenz-624dac86-a375-4435-bc25-76d659719ffd">statistischen Funktionen (Referenz)</a> Seite nach. Die Seite ist leider etwas schwer zu lesen.</li>
<li><a href="https://aosmith.rbind.io/2018/08/29/getting-started-simulating-data/">Getting started simulating data in R: some helpful functions and how to use them</a> gibt nochmal einen guten Überblick über die Standardfunktionen in R um sich schnell Daten zu generieren.</li>
<li><a href="https://ben18785.shinyapps.io/distribution-zoo/">The distribution zoo</a> sowie <a href="https://www.stat.umn.edu/geyer/old/5101/rlook.html">Probability Distributions in R</a> oder aber auch <a href="https://dk81.github.io/dkmathstats_site/rvisual-cont-prob-dists.html">Plotting Continuous Probability Distributions In R With ggplot2</a> gben nochmal einen Einblick in die Verteilungen. Dabei würde ich den Distribution Zoo als Shiny App erstmal vorziehen. Die anderen beiden Quelle liefern nochmal mehr mathematischen Hintergrund.</li>
</ul>
</div>
</div>
</section>
</section>
<section id="genutzte-r-pakete" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">21.3</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, simstudy, simdata, modelr, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>               ggpmisc, janitor, emmeans, correlation,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>               data.table, ordinal, marginaleffects, conflicted)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20250820</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(ggplot2<span class="sc">::</span>annotate)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="r-paket-simstudy" class="level2" data-number="21.4">
<h2 data-number="21.4" class="anchored" data-anchor-id="r-paket-simstudy"><span class="header-section-number">21.4</span> R Paket <code>{simstudy}</code></h2>
<p>Der Fokus in diesem Kapitel liegt auf dem <a href="https://cran.r-project.org/web/packages/simstudy/vignettes/simstudy.html">R Paket <code>{simstudy}</code></a> und deren Funktionen. Wir werden in dem Abschnitt zu der Normalverteilung nochmal auf die Standardfunktionen in R eingehen und die Daten etwas mehr händisch genierieren. Wennn die Verteilungen aber komplizierter werden, dann wird es auch mit dem Standard schwerer. So ist die Poissonverteilung, die Ordinalverteilung und auch die Binomialverteilung in einem mehrfaktoriellen Design schon nicht mehr schön selber zu bauen. Insbesondere wenn die Einflussvariablen noch untereinander miteinander in Beziehung stehen.</p>
<p>In der folgenden Tabelle siehst du einmal die drei Variablen für das Alter, das Geschlecht und die Sprungweite von Katzenflöhen. Wir sagen, dass der Effekt des Alters immer fix <span class="math inline">\(10\)</span> ist. Das Geschlecht des Flohs hängt hier absurderweise vom Alter ab. Die Sprungweite ist dann eine Funktion des Alters und des Geschlechts. Dabei haben nicht alle Verteilungen eine Varianz wie die Normalverteilung. Deshalb haben wir hier auch Null in der Varianz bei den anderen Verteilungen stehen.</p>
<div id="tbl-glossar-regression" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="15, 40, 15, 15, 15">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-glossar-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;21.2— Beispielhafte Tabelle einer Datendefinition der Effekte der Variablen in <code>{simstudy}</code>. Jede Zeile beschreibt eine Variable in dem Datensatz und deren mathematischen Zusammenhang oder den Effekt untereinander. Dazu kommt noch die Varianz und die entsprechende Verteilung der Variable.
</figcaption>
<div aria-describedby="tbl-glossar-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 40%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">varname</th>
<th style="text-align: left;">formula</th>
<th style="text-align: left;">variance</th>
<th style="text-align: left;">dist</th>
<th style="text-align: left;">link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">normal</td>
<td style="text-align: left;">identity</td>
</tr>
<tr class="even">
<td style="text-align: left;">female</td>
<td style="text-align: left;">-2 + age * 0.1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">binary</td>
<td style="text-align: left;">logit</td>
</tr>
<tr class="odd">
<td style="text-align: left;">jump_length</td>
<td style="text-align: left;">1.5 - 0.2 * age + 0.5 * female</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">poisson</td>
<td style="text-align: left;">log</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Dann können wir die obige Tabelle auch einmal in <code>{simstudy}</code> nachbauen. Wir müssen dazu die Funktion <code>defData()</code> nutzen und dann immer erweitern. Dabei ist natürlich die Ordnung wichtig, da wir erst Variablen erschaffen müssen bevor wir mit den Variablen weiterrechnen können. Das verlangt etwas Übung und auch ein gewissen Gefühl für die Datenerstellung. Mir ist es am Anfang auch etwas schwerer gefallen, aber diese Art der Genierung hat echte Vorteile, wenn die Daten komplexer werden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"age"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">formula =</span> <span class="dv">10</span>, <span class="at">variance =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"female"</span>, <span class="at">dist =</span> <span class="st">"binary"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">formula =</span> <span class="st">"-2 + age * 0.1"</span>, <span class="at">link =</span> <span class="st">"logit"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"jump_length"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">formula =</span> <span class="st">"1.5 - 0.2 * age + 0.5 * female"</span>, <span class="at">link =</span> <span class="st">"log"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir schon die Funktion <code>genData()</code> nutzen um uns dann entsprechend viele Beobachtungen mit der entsprechenden Datendefinition zu erschaffen. Hier habe ich einmal fünf Beobachtungen gewäht, später nutze ich dann eher eintausend Beobachtungen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="at">n =</span> <span class="dv">5</span>, def)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>dt</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Key: &lt;id&gt;
      id       age female jump_length
   &lt;int&gt;     &lt;num&gt;  &lt;int&gt;       &lt;int&gt;
1:     1 11.647845      0           0
2:     2 12.958943      0           1
3:     3  7.439934      0           1
4:     4 10.127518      1           0
5:     5  8.237693      0           0</code></pre>
</div>
</div>
<p>Manchmal ist es so, dass wir einem bestehenden Datensatz mit Vairablen eine Definition hinzufügen wollen. Das ist insbesondere bei Faktorenrastern der Fall. Dort bauen wir uns ja erst alle Faktorkombinationen und wollen dann nochmal den Messwert berechnen. Dafür können wir dann die Funktion <code>defDataAdd()</code> nutzen, die auch Variablennamen akzeptiert, die nicht noch nicht definiert wurden. Hier bauen wir uns eine binäre Sprungweite zusammen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"jump_length_bin"</span>, <span class="at">formula =</span> <span class="st">"-2 + 0.5*age + 0.5*female"</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dist =</span> <span class="st">"binary"</span>, <span class="at">link =</span> <span class="st">"logit"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Da wir bis jetzt nur die Defintion haben, müssen wir noch die Daten mit der Datendefinition zusammenbringen. Die Funktion <code>addColumn()</code> verbindet einen bestehenden Datensatz mit einer neuen Definition und erschafft dann die neue Variable. Wir werden dieses Vorgehen dann häufiger bei den faktoriellen Daten nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addColumns</span>(def, dt)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Key: &lt;id&gt;
      id       age female jump_length jump_length_bin
   &lt;int&gt;     &lt;num&gt;  &lt;int&gt;       &lt;int&gt;           &lt;int&gt;
1:     1 11.647845      0           0               1
2:     2 12.958943      0           1               1
3:     3  7.439934      0           1               0
4:     4 10.127518      1           0               1
5:     5  8.237693      0           0               1</code></pre>
</div>
</div>
<p>Wenn dich die Datengenerierugn und das Drumrum interessiert, dann kannst du auch auf dem Blog <a href="https://www.rdatagen.net/">ouR data generation – meditations on data generating processes, R, and statistics</a>, welches die Themen rund um das R Paket <code>{simstudy}</code> aufgreift einmal weiterlesen. Leider muss man sich mühsam durch die Chronik klicken, da es keine Sortierung nach Schlagworten oder ein Inhaltsverzeichnis gibt. Dafür ist da die eine oder andere spannende Idee darunter. Wenn ich was gefunden habe, habe ich es weiter unten in den Abschnitten verlinkt.</p>
</section>
<section id="gängige-messwerte" class="level2" data-number="21.5">
<h2 data-number="21.5" class="anchored" data-anchor-id="gängige-messwerte"><span class="header-section-number">21.5</span> Gängige Messwerte</h2>
<p>Im Folgenden wollen wir uns für die gängigen Verterilungsfamilien einmal die Generierung von Daten anschauen. Dabei bleibe ich länger bei der Normalverteilung und zeige dort einmal verschiedene Wege um auf künstliche Daten zu kommen. Dabei liegt auch hier der Fokus mehr auf dem faktoriellen Design, da wir es hier meistens mit etwas komplizierteren Generierungen zu tun bekommen. Nach der Normalverteilung gehe ich dann auf die Poissonverteilung und klassische Verteilung für Zähldaten ein. Dann kommt noch die ordinale und binomiale Verteilung dran. Dann haben wir die häufigsten Verteilungen besprochen. Mehr findet sich dann auch in der Vingette zu dem <a href="https://cran.r-project.org/web/packages/simstudy/vignettes/simstudy.html">R Paket <code>{simstudy}</code></a>.</p>
<section id="normalverteilt" class="level3" data-number="21.5.1">
<h3 data-number="21.5.1" class="anchored" data-anchor-id="normalverteilt"><span class="header-section-number">21.5.1</span> Normalverteilt</h3>
<p>Beginnen wir mit der wichtigsten Art der Simulation von Messwerten. Wir fangen mit der Normalverteilung an. Das heißt, dass unser Messwert <span class="math inline">\(y\)</span> normalverteilt ist und wir unsere Messwerte aus mehreren Normalverteilungen zusammenbauen. Jede der Faktoren oder Kovariaten ist normalverteilt und hat damit immer einen Mittelwert und eine Varianz als Streuung. Das macht es dann auch für uns einfacher einmal die Grundlagen zu verstehen. Am Ende kannst du dir auch mittlere Noten oder eine mittlere Anzahl generieren und dann eben etwas stärker Runden. Dazu mehr dann in den folgenden Verteilungen.</p>
</section>
<section id="faktorielles-design-1" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="faktorielles-design-1">Faktorielles Design</h3>
<p>Ein faktorielles Design heißt nichts anderes als das du einen Faktor mit Leveln vorliegen hast. Häufig ist dieser Faktor dann deine Behandlung und deine Level sind dann die Stufen der Behandlung. Wenn du nur zwei Behandlungen vorliegen hast, dann rechnest du dann später einen Zweigruppenvergleich wie eben den t-Test. Wenn du mehr als zwei Gruppen vorliegen hast, wirst du dann eine einfaktorielle ANOVA nutzen und den entsprechenden Post-hoc Test. Weil zwei Gruppen eben so schön einfach sind, fangen wir hier damit einmal an. An den zwei Gruppen kannst du dann immer schön die Grundlagen nachvollziehen.</p>
<section id="einfaktoriell-f_a-mit-2-leveln" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktoriell-f_a-mit-2-leveln">Einfaktoriell <span class="math inline">\(f_A\)</span> mit 2 Leveln</h4>
<p>Beginnen wir also einmal mit dem einfaktoriellen Design mit nur zwei Gruppen. In der folgenden schematischen Darstellung ist einmal das Modell dargestellt. Wir haben einen Messwert und einen Faktor, der aus zwei Gruppen besteht. Das Modell ist sehr simple und soll uns nur helfen einmal die Simulation von Daten in R zu verstehen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-f1lvl2-theo" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-f1lvl2-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-f1lvl2-theo-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Abbildung&nbsp;21.13— Schemantisches simples Modell mit einem Messwert Y und einer kategorialen Einflussvariablen als Faktor f_A mit zwei Leveln dargestellt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-f1lvl2-theo-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-f1lvl2-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.13— Schemantisches simples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_A\)</span> mit zwei Leveln dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir haben jetzt unzählige Möglichkeiten die Daten zu generieren. Ich zeige hier einmal die zwei einfacheren Methoden. Einmal können wir die Daten getrennt in einem <code>tibble()</code> erstellen. Hierbei ist es wichtig, dass wir ein balanciertes Design vorliegen haben. Dann bauen wir uns das Long-Format über <code>gather()</code>. Wir schauen uns immer Gruppen mit gleicher Fallzahl an. Dann können wir auch die Spalten getrennt zusammenbauen und am Ende alles einmal aufaddieren. Wir haben hier einen Effekt von einer Mittelwertsdifferenz von <span class="math inline">\(+3\)</span> vorliegen bei keiner Streuung.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Getrennt</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Additiv</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Wenn wir wenig Gruppen haben, dann ist die getrennte Erstellung in einem <code>tibble()</code> sehr übersichtlich. Wir stellen ja den Effekt jeweils in den einzelnen Gruppen separat ein.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="fl">0.001</span>),</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"2"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">6</span>, <span class="at">sd =</span> <span class="fl">0.001</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"f_a"</span>, <span class="at">value =</span> <span class="st">"y"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Im additiven Zusammenbauen nutzen wir viele Funktionen um uns die Spalten mit den Faktoren, Effekten und Fehler aufzubauen. Am Ende addieren wir die Spalten zum Messwert auf.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">f_a =</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>)),</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">eff_a =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>), <span class="at">each =</span> <span class="dv">5</span>),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">error =</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(f_a), <span class="dv">0</span>, <span class="fl">0.001</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> eff_a <span class="sc">+</span> error)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01_small.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="images/angel_01_small.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>Das additive Zusammenbauen funktioniert hier nur in dieser Form so gut, da wir einen normalverteilten Messwert haben. In anderen Verteilungen können wir nicht einfach den Fehler addieren. Das hängt hier mit der Symmetrie der Normalverteilung um den Mittelwert zusammen.</em></p>
</blockquote>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Dann rechnen wir einfach einmal einen schnellen t-Test und schauen, ob wir die Differenz wieder erhalten. Wir sehen, dass wir die gleichen Mittelwerte wiedergeben bekommen und natürlich auch einen signifikanten Unterschied. Die Streuung ist ja super klein.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(y <span class="sc">~</span> f_a, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  y by f_a
t = -4231.5, df = 7.0551, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0
95 percent confidence interval:
 -3.001890 -2.998542
sample estimates:
mean in group 1 mean in group 2 
       2.999996        6.000212 </code></pre>
</div>
</div>
<p>Wir können uns den Zusammenhang auch als eine simple lineare Regression darstellen lassen. Da ich die Streuung sehr gering eingestellt habe, können wir auch die Koeffizienten exakt so wieder erhalten. In der folgenden linearen Regression siehst du einmal wie die Mittelwertsdifferenz wieder der eingestellten Differenz entspricht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a, fac1_tbl) <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        f_a2 
          3           3 </code></pre>
</div>
</div>
<p>In der folgenden Abbildung ist der Zusammenhang nochmal graphisch dargestellt. Wir haben den Mittelwert der ersten Gruppe als Intercept im Modell und die Steigung der Graden als Mittelwertsdifferenz. Wir sehen hier also nochmal den Zusammenhang zwischen der Datengenerierung und der linearen Regression.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-fa-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-fa-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-model-in-R-fa-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Abbildung&nbsp;21.14— Darstellung der einfaktoriellen Simulation mit zwei Gruppen. Der Intercept stellt den Mittelwert der ersten Gruppe dar. Die Mittelwertsdifferenz ist die Steigung der Graden. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-model-in-R-fa-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-fa-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.14— Darstellung der einfaktoriellen Simulation mit zwei Gruppen. Der Intercept stellt den Mittelwert der ersten Gruppe dar. Die Mittelwertsdifferenz ist die Steigung der Graden. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Manchmal wollen wir uns auch Daten erstellen, die nicht die gleiche Varianz in allen Gruppen haben. In diesem Fall hilft am meisten die getrennte Erstellung. Wir nehmen dann einfach in jeder Gruppe eine andere Varianz und lassen dann die Daten erstellen. In dem folgenden Kasten siehst du nochmal ein Beispiel für die Generierung von Daten mit Varianzheterogenität. Ob wir das brauchen hängt dann davon ab, was du mit den simulierten Daten ausprobieren möchtest.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Varianzheterogeniät zwischen den Gruppen
</div>
</div>
<div class="callout-body-container callout-body">
<p>In der getrennten Erstellung von Daten können wir dann für jede Gruppe eine eigene Varianz festlegen. Hier habe ich in der einen Gruppe eine Standardabweichung von <span class="math inline">\(5\)</span> und in der anderen Gruppe eine Standardabweichung von <span class="math inline">\(1\)</span> angenommen. Ich brauche diese Art der Erstellung für den Welch t-Test oder aber in <code>{emmeans}</code> und dem multiplen Testen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"2"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">6</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"f_a"</span>, <span class="at">value =</span> <span class="st">"y"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</section>
<section id="einfaktoriell-f_a-mit-2-leveln-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktoriell-f_a-mit-2-leveln-1">Einfaktoriell <span class="math inline">\(f_A\)</span> mit &gt;2 Leveln</h4>
<p>Kommen wir jetzt zu den etwas spannenderen Teil. Wir haben jetzt ein faktorielles Design mit einem Faktor und drei Leveln vorliegen. Ich habe dir einmal das Modell in der folgenden Abbildung einmal schematisch dargestellt. Wir würden hier also Daten bauen, die wir dann mit einer einfaktoriellen ANOVA oder aber dann mit einem Post-hoc Test wie <code>{emmeans}</code> auswerten würden. Der Messwert hier folgt daher einer Normalverteilung.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-f1lvl3-theo" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-f1lvl3-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-f1lvl3-theo-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Abbildung&nbsp;21.15— Schemantisches simples Modell mit einem Messwert Y und einer kategorialen Einflussvariablen als Faktor f_A mit drei Leveln dargestellt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-f1lvl3-theo-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-f1lvl3-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.15— Schemantisches simples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_A\)</span> mit drei Leveln dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir können die Daten einmal getrennt bauen und hätten dann auch einfach die Möglichkeit die Varianzen auch unterschiedlich zu machen. Beachte immer, dass ich hier extrem geringe Varianzen mit <span class="math inline">\(0.001\)</span> eingestellt habe um dann bei der geringen Fallzahl auch auf die voreingestellten Effekte zu kommen. Du kannst dir das Modell auch additiv bauen, dann wird es aber etwas komplexer und der Fehler ist dann homogen, wenn du nicht den Fehlervektor nochmal aufbrechen willst. Dann zeige ich dir die Generation der Daten auch nochmal in Excel.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true"><code>tibble()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Excel</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<section id="getrennt-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="getrennt-1">Getrennt</h4>
<p>Wenn wir wenig Gruppen haben, dann ist die getrennte Erstellung in einem <code>tibble()</code> sehr übersichtlich. Wir stellen ja den Effekt jeweils in den einzelnen Gruppen separat ein. Wir bauen hier alles um die Mittelwerte auf.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">2</span>, <span class="fl">0.001</span>),</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"2"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="fl">0.001</span>),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"3"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="fl">0.001</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"f_a"</span>, <span class="at">value =</span> <span class="st">"y"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="additiv-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="additiv-1">Additiv</h4>
<p>Im additiven Zusammenbauen nutzen wir viele Funktionen um uns die Spalten mit den Faktoren, Effekten und Fehler aufzubauen. Am Ende addieren wir die Spalten zum Messwert auf. Hier sind natürlich heterogene Varianzen schwerer darzustellen, da wir den Fehler für jedes Level einzeln generieren müssten. Auch hier wähle ich die Mittelwerte zuerst.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">f_a =</span> <span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>)),</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">eff_a =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">4</span>), <span class="at">each =</span> <span class="dv">5</span>),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">error =</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(f_a), <span class="dv">0</span>, <span class="fl">0.001</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> eff_a <span class="sc">+</span> error)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="effekt" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="effekt">Effekt</h4>
<p>Jetzt können wir aber das Ganze auch von der Effektseite aufziehen. Wir legen also fest, wie stark sich die Mittelwerte unterscheiden sollen anstatt die Mittelwerte selber. Daher eben der Effekt als Ausgangspunkt für unsere Datengenerierung. Als erstes bauen wir uns aber einmal den Datensatz nur für den Faktor. Die Spalte <code>rep</code> gibt an wie viele Wiederholungen wir pro Level haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">as_factor</span>(f_a))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann nutzen wir den Faktor um eine Dummykodierung zuerstellen. Mit der Dummykodierung können wir dann den Leveln des Faktors die Effekte zuordnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fac1_mat <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_matrix</span>(<span class="sc">~</span> f_a) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt brauchen wir die Effekte. Wir haben hier den Mittelwert der ersten Gruppe in den Intercept und dann die Effekte danach. Daher hat das zweite Level einen um 4 höheren Mittelwert. Das dritte Level ist dann nur um 2 größer als der Intercept.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>eff_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">intercept =</span> <span class="dv">2</span>, </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">f_a2 =</span> <span class="dv">4</span>, <span class="at">f_a3 =</span> <span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann kombinieren wir die Modellmatrix mit den Information wo der Effekt angewendet werden soll mit dem Vektor der Effekte. Wir erhalten dann unsere Messwerte in dem Vektor <code>y_raw</code>. Hier sind natürlich pro Faktor die Werte immer gleich. Wir haben ja noch keine Streuung hinzugefügt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>y_vec <span class="ot">&lt;-</span> fac1_mat <span class="sc">%*%</span> eff_vec</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Am Ende erhalten wir dann die echten generierten Messwerte indem wir zu unserem Messwert noch einen Fehler addieren. Ich nehme hier einen sehr kleinen Fehler, damit wir die Effekt auch gleich wiedersehen. Sonst müsste ich eine sehr hohe Fallzahl simulieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> y_vec <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(y_vec), <span class="dv">0</span>, <span class="fl">0.001</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Welche der drei Varianten du dann nutzt hängt davon ab, wozu du die generierten Datem brauchst. Jede Variante zeigt eben nochmal anders wie Daten entstehen.</p>
</section>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Erstellung von Daten in Excel ist nicht für die <em>wissenschaftliche</em> Bewertung von Algorithmen sinnvoll und angebracht. Wir nutzen hier Excel um recht einfach uns zufällig Daten zu erstellen. Wir nutzen dann die künstlichen Exceldaten um unsere Analyse für unsere echten experimentelle Daten zu üben. Auch ist die vereinfachte Erstellung von künstlichen Daten in Excel hilfreich um die zugrundeliegende Konzepte nochmal zu verstehen.</p>
</div>
</div>
<p>In der folgenden Datei findest du dann einmal die Generierung der einfaktoriellen Daten in Excel. Hier müssen wir dann das additive Zusammenbauen nutzen. Deshalb ist die Datei etwas größer. Am Ende brauchen wir die Spalte <code>Faktor A</code> und die Spalte <code>Messwert</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>excel_fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/data_generation_excel.xlsx"</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sheet =</span> <span class="st">"einfaktoriell"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">faktor_a =</span> <span class="fu">as_factor</span>(faktor_a))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung habe ich dir einmal normalverteilte Messwerte in Excel aus einem einfaktoriellen Design generiert. Zuerst legen wir den allgemeinen Intercept fest, dann noch die Effekte der einzelnen Gruppen. Am Ende brauchen wir noch den Fehler oder die Streuung mit der Funktion <code>NORMINV()</code>. Hier habe ich eine Standardabweichung von <span class="math inline">\(2\)</span> voreingestellt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gen-data-fac1-excel" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gen-data-fac1-excel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-gen-data-fac1-excel-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Abbildung&nbsp;21.16— Annotierte Generierung von einfaktoriellen Daten mit drei Gruppen in Excel. Der Fehler wird durch die Funktion NORMINV() in Excel abgebildet. Der normalverteilte Messwert addiert sich aus den Spalten B:D auf. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-gen-data-fac1-excel-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gen-data-fac1-excel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.16— Annotierte Generierung von einfaktoriellen Daten mit drei Gruppen in Excel. Der Fehler wird durch die Funktion <code>NORMINV()</code> in Excel abgebildet. Der normalverteilte Messwert addiert sich aus den Spalten <code>B:D</code> auf. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Dann schauen wir einmal, ob wir dann die Mittelwerte und die entsprechenden Differenzen auch in <code>{emmeans}</code> wiederfinden. Die Funktion <code>pwpm()</code> gibt uns auf der Diagonalen die Mittelwerte wieder und dann die Differenzen in der unteren Hälfte der Matrix. Damit haben wir dann auch alle Informationen auf einmal zusammen. Die Mittelwerte sind die voreingestellten und die Effekte sind ebenfalls richtig.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a, fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> f_a) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         1        2        3
1 [1.9999]   &lt;.0001   &lt;.0001
2  -3.9997 [5.9996]   &lt;.0001
3  -1.9995   2.0001 [3.9994]

Row and column labels: f_a
Upper triangle: P values   adjust = "tukey"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
</div>
<p>Wir können uns dann das Modell auch nochmal in dem linearen Kontext anschauen. Hier haben wir dann aber zwei Möglichkeiten die Referenz des Intercepts zu setzen. In der klassischen Kodierung setzen wir den Intercept auf den Mittelwert des ersten LEvels oder eben der ersten Gruppe. Wir nennen diese Kodierung dann <em>Treatment coding</em>. Dafür müssen wir nichts machen, dass ist die Standardeinstellung. Wir können aber auch das <em>Effect coding</em> wählen, dann liegt der Intercept auf dem globalen Mittelwert. Was ja eher der Interpretation der ANOVA entspricht. Es gibt natürlich noch weitere Kodierungen, wie du im Tutorial <a href="https://stats.oarc.ucla.edu/r/library/r-library-contrast-coding-systems-for-categorical-variables/">R Library Contrast Coding Systems for categorical variables</a> nachlesen kannst.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Treatment coding (default)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Effect coding</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Der Standard in der linearen Modellierung von Faktoren ist das <em>Treatment coding</em> mit <code>contr.treatment</code> in der Funktion <code>lm()</code>. Wir müssen da auch eigentlich nichts ändern, aber ich habe es hier einmal angeben damit du siehst, wo du die Kodierung ändern musst. Jeder Faktor muss einzeln geändert werden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a, fac1_tbl, <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">f_a =</span> <span class="st">"contr.treatment"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        f_a2        f_a3 
          2           4           2 </code></pre>
</div>
</div>
<p>Wir erhalten dann aber die zu erwartenden Koeffizienten wieder. Der Mittelwert der ersten Gruppe ist der Intercept. Die Koeffizienten sind die Änderungen der anderen Level zum Intercept. Ich habe dir den Zusammenhang nochmal in der folgenden Abbildung dargestellt. Wir sehen hier sehr schön, dass eben das erste Level <span class="math inline">\(A.1\)</span> den Intercept ausmacht. Die Änderungen als Mittelwertsdifferenzen zum Intercept sind die Koeffizienten in dem linearen Modell.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-fa-21" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-fa-21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-model-in-R-fa-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Abbildung&nbsp;21.17— Darstellung des Treatment coding in einem linearen Modell. Der Intercept ist der Mittelwert des ersten Levels des Faktors. Die Koeffizienten des Modells beschreiben die Mittelwertsdifferenz zum Intercept in den anderen Leveln. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-model-in-R-fa-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-fa-21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.17— Darstellung des <em>Treatment coding</em> in einem linearen Modell. Der Intercept ist der Mittelwert des ersten Levels des Faktors. Die Koeffizienten des Modells beschreiben die Mittelwertsdifferenz zum Intercept in den anderen Leveln. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Das <em>Effect coding</em> können wir mit der Option <code>contr.sum</code> in der Funktion <code>lm()</code> nutzen. Wir müssen dies für jeden einzelnen Faktor einstellen. Ein Mischmasch würde ich stark vermeiden wollen. Wir haben dann als Intercept das globale Mittel des Messwerts über alle Gruppen. Die Koeffizienten sind dann die Mittelwertsdifferenzen zum globalen Mittel. Das letzte Level fehlt und lässt sich aus den vorherigen Leveln berechnen, da die Summe der Koeffizienten Null sein muss. In unserem Fall wäre die Mittelwertsdifferenz dann auch <span class="math inline">\(0\)</span>, da sich die beiden vorherigen Level schon auf Null aufaddieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a, fac1_tbl, <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">f_a =</span> <span class="st">"contr.sum"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        f_a1        f_a2 
          4          -2           2 </code></pre>
</div>
</div>
<p>Der Zusammenhang wird dann in der folgenden Darstellung nochmal klarer. Wir haben hier den globalen Mittelwert von <span class="math inline">\(4\)</span> über alle Gruppen. Die Koeffizienten sind jetzt die Abweichung der lokalen Mittelwerte zu dem globalen Mittel. Eigentlich wie wir es auch aus einer einfaktoriellen ANOVA erwarten würden.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-fa-22" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-fa-22-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-model-in-R-fa-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Abbildung&nbsp;21.18— Darstellung des Effect coding in einem linearen Modell. Der Intercept ist der globale Mittelwert über alle Gruppen. Die Koeffizienten des Modells beschreiben die Mittelwertsdifferenz zum globalen Mittelwert in den anderen Leveln. Das letzte Level fehlt und lässt sich aus den vorherigen Leveln berechnen, da die Summe der Koeffizienten Null sein muss. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-model-in-R-fa-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-fa-22-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.18— Darstellung des <em>Effect coding</em> in einem linearen Modell. Der Intercept ist der globale Mittelwert über alle Gruppen. Die Koeffizienten des Modells beschreiben die Mittelwertsdifferenz zum globalen Mittelwert in den anderen Leveln. Das letzte Level fehlt und lässt sich aus den vorherigen Leveln berechnen, da die Summe der Koeffizienten Null sein muss. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="zweifaktoriell-ohne-interaktion-f_a-f_b" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktoriell-ohne-interaktion-f_a-f_b">Zweifaktoriell ohne Interaktion <span class="math inline">\(f_A + f_B\)</span></h4>
<p>Sehr häufig haben wir aber mehrfaktorielle Designs vorliegen. Selten betrachten wir nur einen Faktor. Daher habe ich jetzt einmal ein zweifaktorielles Design in der folgenden schematischen Darstellung mitgebracht. Wir haben hier zwei Faktoren. Der Hauptfaktor <span class="math inline">\(f_A\)</span> hat drei Level und der zweite Faktor <span class="math inline">\(f_B\)</span> hat zwei Level. Der Messwert ist weiterhin normalverteilt. Jetzt müssen wir uns gleich etwas strecken um die Daten zusammenzubauen. Wir haben aber keine Interaktion zwischen den Faktoren vorliegen. Das schauen wir uns dann gleich nochmal getrennt an.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-f2nointer-theo" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-f2nointer-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-f2nointer-theo-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Abbildung&nbsp;21.19— Schemantisches simples Modell mit einem Messwert Y und einer kategorialen Einflussvariablen als Faktor f_A mit drei Leveln sowie einer kategorialen Einflussvariablen als Faktor f_B mit zwei Leveln dargestellt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-f2nointer-theo-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-f2nointer-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.19— Schemantisches simples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_A\)</span> mit drei Leveln sowie einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_B\)</span> mit zwei Leveln dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Da wir keine Interaktion vorliegen haben und auch Varianzhomogenität kann ich mir die Daten wie folgt bauen. Zuerst baue ich mir alle Faktorenkombinationen mit fünf Wiederholungen pro Kombination mit der Funktion <code>expand_grid()</code> dann kann ich mir den Messwert bauen indem ich immer den gleichen Effekt für jedes Level aufaddieren. Wir haben hier ja keine Interaktion vorliegen. Die Effekte steigen linear an. Darüber hinaus habe ich auch keine Streuung eingestellt, da mit wir bei der kleinen Fallzahl auch gleich unsere Effekte wiedersehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fac2_nointer_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">f_b =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span> <span class="sc">*</span> f_a <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>             <span class="dv">3</span> <span class="sc">*</span> f_b <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="fl">0.001</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">as_factor</span>(f_a),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">as_factor</span>(f_b))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann schauen wir einmal, ob wir dann die Mittelwerte und die entsprechenden Differenzen auch in <code>{emmeans}</code> wiederfinden. Die Funktion <code>pwpm()</code> gibt uns auf der Diagonalen die Mittelwerte wieder und dann die Differenzen in der unteren Hälfte der Matrix. Damit haben wir dann auch alle Informationen auf einmal zusammen. Das wird dann doch recht groß und dann teilweise etwas unübersichtlich. Schaue gleich mal in der unteren Abbildung, da wird vermutlich alles etwas klarer.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> f_b, fac2_nointer_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> f_a <span class="sc">*</span> f_b)  <span class="sc">|&gt;</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          1 1       2 1       3 1       1 2       2 2       3 2
1 1 [ 7.0004]    &lt;.0001    &lt;.0001    &lt;.0001    &lt;.0001    &lt;.0001
2 1  -1.99988 [ 9.0003]    &lt;.0001    &lt;.0001    &lt;.0001    &lt;.0001
3 1  -3.99969  -1.99981 [11.0001]    &lt;.0001    &lt;.0001    &lt;.0001
1 2  -3.00000  -1.00012   0.99969 [10.0004]    &lt;.0001    &lt;.0001
2 2  -4.99988  -3.00000  -1.00019  -1.99988 [12.0003]    &lt;.0001
3 2  -6.99969  -4.99981  -3.00000  -3.99969  -1.99981 [14.0001]

Row and column labels: f_a:f_b
Upper triangle: P values   adjust = "tukey"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
</div>
<p>Da wir es hier auch wieder mit einem linearen Modell zu tun haben, können wir uns die Sachlage auch einmal mit den Koeffizienten des linearen Modells anschauen. Wir haben hier einen linearen Anstieg in unserem ersten Faktor und einen Unterschied von <span class="math inline">\(3\)</span> in unserem zweiten Faktor. Der Intercept ist dabei die Faktorkombination <span class="math inline">\(A.1.B.1\)</span> als niedrigste Levelkombination. Wir schauen uns hier nur das <em>Treatment coding</em> an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> f_b, fac2_nointer_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        f_a2        f_a3        f_b2 
          7           2           4           3 </code></pre>
</div>
</div>
<p>In der folgenden Abbildung siehst du dann einmal den Zusammenhang und die Koeffizienten visualisiert. Der Intercept liegt auf der Faktorkombination <span class="math inline">\(A.1.B.1\)</span>. Die Level von <span class="math inline">\(B.2\)</span> sind parallel um den Koeffizienten von <span class="math inline">\(B.2\)</span> verschoben. Der Anstieg ist aber immer noch <span class="math inline">\(+2\)</span> da wir ja hier keine Interaktion vorliegen haben. Über den Faktor <span class="math inline">\(A\)</span> verhält sich der Faktor <span class="math inline">\(B\)</span> gleich. Hätten wir eine Interaktion vorliegen, dann würden wir keinen parallelen Verlauf sehen. In der Praxis beobachten wir solche Daten eher selten sondern sehen immer eine leichte Interaktion. Insbesondere da wir hier ja keine Streuung in den Daten vorliegen haben.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-f2nointer" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-f2nointer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-f2nointer-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Abbildung&nbsp;21.20— Darstellung des zweifaktoriellen Modells ohne Interaktion für die beiden Faktoren A und B. Die Mittelwerte des Faktors B.2 sind um den Koeffizienten des Levels verschoben. Die Graden verlaufen parallel, da keine Interaktion vorliegt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-f2nointer-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-f2nointer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.20— Darstellung des zweifaktoriellen Modells ohne Interaktion für die beiden Faktoren <span class="math inline">\(A\)</span> und <span class="math inline">\(B\)</span>. Die Mittelwerte des Faktors <span class="math inline">\(B.2\)</span> sind um den Koeffizienten des Levels verschoben. Die Graden verlaufen parallel, da keine Interaktion vorliegt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweifaktoriell-mit-interaktion-f_a-f_b-f_a-times-f_b" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktoriell-mit-interaktion-f_a-f_b-f_a-times-f_b">Zweifaktoriell mit Interaktion <span class="math inline">\(f_A + f_B + f_A \times f_B\)</span></h4>
<p>Selten betrachten wir nur einen Faktor sondern eben zwei Faktoren. Daher habe ich jetzt einmal ein zweifaktorielles Design in der folgenden schematischen Darstellung mitgebracht. Wir haben hier zwei Faktoren. Der Hauptfaktor <span class="math inline">\(f_A\)</span> hat drei Level und der zweite Faktor <span class="math inline">\(f_B\)</span> hat zwei Level. Der Messwert ist weiterhin normalverteilt. Jetzt müssen wir uns gleich etwas strecken um die Daten zusammenzubauen. Wir haben nun nämlich endlich eine Interaktion zwischen den beiden Faktoren vorliegen. Der Faktor <span class="math inline">\(f_B\)</span> verhält sich nicht gleich in allen Leveln des Faktors <span class="math inline">\(f_A\)</span>. Die Graden laufen nicht parallel.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-f2inter-theo" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-f2inter-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-f2inter-theo-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Abbildung&nbsp;21.21— Schemantisches simples Modell mit einem Messwert Y und einer kategorialen Einflussvariablen als Faktor f_A mit drei Leveln sowie einer kategorialen Einflussvariablen als Faktor f_B mit zwei Leveln und deren Interaktion f_A \times f_B dargestellt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-f2inter-theo-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-f2inter-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.21— Schemantisches simples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_A\)</span> mit drei Leveln sowie einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_B\)</span> mit zwei Leveln und deren Interaktion <span class="math inline">\(f_A \times f_B\)</span> dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>In den beiden folgenden Tabs zeige ich dir einmal wie du die Daten für ein zweifaktorielles Design mit Interaktion in einem <code>tibble()</code> sowie in Excel zusammenbaust. In Excel ist es etwas übersichtlicher, da du ja dort die einzelnen Spalten händisch anlegst. Zum Verstehen vielleicht etwas besser als in R. Dennoch ist die Erstellung in R stabiler und nicht so fehleranfällig. Für mal eben zum probieren reicht natürlich wie immer auch Excel super aus.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true"><code>tibble()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Excel</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Wenn wir mit Interaktionen einen Datensatz bauen, dann müssen wir den Datensatz über die Effekte aufbauen. Wir legen also fest, wie stark sich die Mitterlwerte unterscheiden sollen anstatt die Mittelwerte selber. Daher eben der Effekt als Ausgangspunkt für unsere Datengenerierung. Als erstes bauen wir uns aber einmal den Datensatz nur für die Faktoren. Die Spalte <code>rep</code> gibt an wie viele Wiederholungen wir pro Level haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">f_b =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">as_factor</span>(f_a),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">as_factor</span>(f_b))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann nutzen wir die Faktoren um eine Dummykodierung zuerstellen. Mit der Dummykodierung können wir dann die Level der Faktor und der Interaktion die Effekte zuordnen. Das ist hier super wichtig, da wir sonst kaum die Interaktion modellieren können.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>fac2_mat <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_matrix</span>(<span class="sc">~</span> f_a <span class="sc">*</span> f_b) <span class="sc">|&gt;</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt brauchen wir die Effekte für die Faktoren und die Interaktion. Wir haben hier den Mittelwert der ersten Gruppe aus dem Faktor <span class="math inline">\(f_A\)</span> und dem ersten Level im Faktor <span class="math inline">\(f_B\)</span> in den Intercept. Danach kommen dann die Effekte der anderen Level plus die Interaktion. Ich schreibe hier die Effekte der Interaktion mit dem <code>x</code> zwischen den Namen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>eff_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">intercept =</span> <span class="dv">7</span>, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">f_a2 =</span> <span class="dv">2</span>, <span class="at">f_a3 =</span> <span class="dv">4</span>, <span class="at">f_b2 =</span> <span class="dv">3</span>, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">f_a2xf_b2 =</span> <span class="dv">0</span>, <span class="at">f_a3xf_b2 =</span> <span class="sc">-</span><span class="dv">6</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann kombinieren wir die Modellmatrix mit den Information wo der Effekt angewendet werden soll mit dem Vektor der Effekte. Wir erhalten dann unsere Messwerte in dem Vektor <code>y_raw</code>. Hier sind natürlich pro Faktorkombination die Werte immer gleich. Wir haben ja noch keine Streuung hinzugefügt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>y_raw <span class="ot">&lt;-</span> fac2_mat <span class="sc">%*%</span> eff_vec</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Am Ende erhalten wir dann die echten generierten Messwerte indem wir zu unserem Messwert noch einen Fehler addieren. Ich nehme hier einen sehr kleinen Fehler, damit wir die Effekt auch gleich wiedersehen. Sonst müsste ich eine sehr hohe Fallzahl simulieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>fac2_inter_tbl <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> y_raw <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(y_raw), <span class="dv">0</span>, <span class="fl">0.001</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wenn du jetzt noch Varianzheterogenität haben möchtest, dann müsstest du dir einen Vektor mit den verschiedenen Aufrufen der Funktion <code>rnorm()</code> für die jeweiligen Faktorkombinationen bauen. Hier wären es dann bei sechs Faktorkombinationen eben sechsmal <code>rnorm()</code> mit jeweils fünf Beobachtungen als Anzahl der Wiederholungen und dann eben einer eigenen Streuung.</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Erstellung von Daten in Excel ist nicht für die <em>wissenschaftliche</em> Bewertung von Algorithmen sinnvoll und angebracht. Wir nutzen hier Excel um recht einfach uns zufällig Daten zu erstellen. Wir nutzen dann die künstlichen Exceldaten um unsere Analyse für unsere echten experimentelle Daten zu üben. Auch ist die vereinfachte Erstellung von künstlichen Daten in Excel hilfreich um die zugrundeliegende Konzepte nochmal zu verstehen.</p>
</div>
</div>
<p>In der folgenden Datei findest du dann einmal die Generierung der zweifaktoriellen Daten mit Interaktion in Excel. Hier müssen wir dann das additive Zusammenbauen nutzen, da wir keine Matrizen in Excel muliplizieren wollen. Deshalb ist die Datei etwas größer. Am Ende brauchen wir die Spalte <code>Faktor A</code> und die Spalte <code>Faktor B</code> sowie die Spalte <code>Messwert</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>excel_fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/data_generation_excel.xlsx"</span>,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sheet =</span> <span class="st">"zweifaktoriell"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">faktor_a =</span> <span class="fu">as_factor</span>(faktor_a),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">faktor_b =</span> <span class="fu">as_factor</span>(faktor_b))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung habe ich dir einmal normalverteilte Messwerte in Excel aus einem zweifaktoriellen Design mit Interaktion generiert. Zuerst legen wir den allgemeinen Intercept fest, dann noch die Effekte der einzelnen Gruppen sowie der Interaktion. Am Ende brauchen wir noch den Fehler oder die Streuung mit der Funktion <code>NORMINV()</code>. Hier habe ich eine Standardabweichung von <span class="math inline">\(2\)</span> voreingestellt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gen-data-fac2-excel" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gen-data-fac2-excel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-gen-data-fac2-excel-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Abbildung&nbsp;21.22— Annotierte Generierung von zweifaktoriellen Daten mit Interaktion in Excel. Der Fehler wird durch die Funktion NORMINV() in Excel abgebildet. Der normalverteilte Messwert addiert sich aus den Spalten C:G auf. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-gen-data-fac2-excel-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gen-data-fac2-excel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.22— Annotierte Generierung von zweifaktoriellen Daten mit Interaktion in Excel. Der Fehler wird durch die Funktion <code>NORMINV()</code> in Excel abgebildet. Der normalverteilte Messwert addiert sich aus den Spalten <code>C:G</code> auf. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Zahlen kommen jetzt nicht perfekt hin, da ich hier mit einer Standardabweichung von 2 eine recht hohe Streuung gewählt habe. Darüber hinaus habe ich dann auch sehr wenige Beobachtungen gebaut. Deshalb passt der Intercept nicht ganz, den der Intercept müsste eigentlich 10 sein und nicht 9. Daher stimmen dann auch die anderen Effekt nicht perfekt. Aber so ist das dann manchmal mit künstlichen Daten</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(messwert <span class="sc">~</span> faktor_a <span class="sc">*</span> faktor_b, <span class="at">data =</span> excel_fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        (Intercept)           faktor_a2           faktor_a3           faktor_b2 
                  9                   5                   2                   2 
faktor_a2:faktor_b2 faktor_a3:faktor_b2 
                 -4                  -6 </code></pre>
</div>
</div>
<p>Diese Generierung in Excel eigentlich sich sehr gut um dir selber Daten zu bauen, wenn du schonmal testen wilst wie die Analyse laufen würde bevor du eigentlich echte Daten aus deinem Experiment erhoben hast. Hier kommt es ja nicht auf die perfekten Effekte an. Hauptsache es sind Daten, die nicht alle gleich sind und du nichts siehst. Daher kann ich dir diesen Weg der Datengenerierung zum Testen deines R Codes nur empfehlen.</p>
</div>
</div>
</div>
<p>Fangen wir mit der Überprüfung an und schauen dafür erst mal in eine zweifaktorielle ANOVA mit Interaktion. Wir wollen hier natürlich, dass alle Faktoren signifikant sind und ebenfalls die Interaktion. So haben wir ja die Daten oben auch gebaut.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> f_b <span class="sc">+</span> f_a<span class="sc">:</span>f_b, fac2_inter_tbl) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq  F value Pr(&gt;F)    
f_a          2  20.00  10.001  9217080 &lt;2e-16 ***
f_b          1   7.50   7.498  6910404 &lt;2e-16 ***
f_a:f_b      2  60.01  30.004 27651951 &lt;2e-16 ***
Residuals   24   0.00   0.000                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Das passt soweit, wir haben alles so wie wir es wollen. Leider sehen wir nicht die direkten Mittelwerte in einer ANOVA, daher hier nochmal <code>emmeans()</code> um uns die Mittelwerte wiedergeben zu lassen. Auch hier sehen wir, eine Menge Zahlen, aber soweit passen die Werte. Wir brauche in der Faktorkombination <span class="math inline">\(A.1.B.1\)</span> einen Mittelwert von 7, da diese Gruppe ja unser Intercept ist. Das passt soweit. Die anderen Mittelwerte berechnen sich dann aus den obigen Effketen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> f_b <span class="sc">+</span> f_a<span class="sc">:</span>f_b, fac2_inter_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> f_a <span class="sc">*</span> f_b) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> f_a f_b  emmean       SE df lower.CL upper.CL
 1   1    7.0001 0.000466 24   6.9992   7.0011
 2   1    8.9999 0.000466 24   8.9990   9.0009
 3   1   11.0003 0.000466 24  10.9993  11.0012
 1   2    9.9998 0.000466 24   9.9989  10.0008
 2   2   12.0003 0.000466 24  11.9993  12.0013
 3   2    7.9999 0.000466 24   7.9989   8.0008

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Dann schauen wir nochmal die Koeffizienten eines linearen Modells an um dann nochmal die Effekte zu sehen. Das ist natürlich alles etwas doppelt, aber es ist auch eine Übung zu verstehen woher die Zahlen kommen. Hier also einmal die Effekte und die Interaktionen für unser zweifaktorielles Design. Bitte beachte, dass sich natürlich das niedrigste Level des Faktors <span class="math inline">\(f_A\)</span> und des Faktors <span class="math inline">\(f_B\)</span> im Intercept vereinen. Ja, das ist manchmal echt nicht so einfach.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> f_b <span class="sc">+</span> f_a<span class="sc">:</span>f_b, fac2_inter_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        f_a2        f_a3        f_b2   f_a2:f_b2   f_a3:f_b2 
          7           2           4           3           0          -6 </code></pre>
</div>
</div>
<p>In der folgenden Abbildung siehst du einmal die Interaktion in der Faktorkombination <span class="math inline">\(A.3.B2\)</span>. Hier haben wir einen Effekt von -6 vorliegen. Durch die Interaktion fällt der Mittelwert weit nach unten. Weiter als er eigentlich sein sollte, wenn wir einen linearen Anstieg über den Faktor <span class="math inline">\(f_A\)</span> erwarten würden. Wir haben eben nicht eine klassische Verschiebung der Graden durch den Faktor <span class="math inline">\(f_B\)</span> sondern gegeben durch die Interaktion schneiden sich die Graden.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-f2inter" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-f2inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-f2inter-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Abbildung&nbsp;21.23— Darstellung des zweifaktoriellen Modells mit Interaktion für die beiden Faktoren A und B. Die Mittelwerte des Faktors B.2 sind um den Koeffizienten des Levels verschoben. Danach wird der Effek der Interaktion addiert. Die Graden verlaufen daher nicht parallel, da eine Interaktion vorliegt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-f2inter-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-f2inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.23— Darstellung des zweifaktoriellen Modells mit Interaktion für die beiden Faktoren <span class="math inline">\(A\)</span> und <span class="math inline">\(B\)</span>. Die Mittelwerte des Faktors <span class="math inline">\(B.2\)</span> sind um den Koeffizienten des Levels verschoben. Danach wird der Effek der Interaktion addiert. Die Graden verlaufen daher nicht parallel, da eine Interaktion vorliegt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir haben uns jetzt einmal durch das faktorielle Design durchgearbeitet. Das war jetzt auch bei einem normalverteilten Messwert relativ einfach. Wenn wir dann noch eine andere Verteilung im Messwert vorliegen haben, dann wird die Sache noch etwas komplizierter. In den folgenden Abschnitten gehe ich dann nicht für jede Verteilung auf alle Kombinationen ein, sondern nutze immer die wichtigsten faktoriellen Designs, wie eben die zweifaktoriellen mit und ohne Interaktion. Die einfaktoriellen Designs mit mehr als zwei Leveln dienen eher der Veranschaulichung und werden in der Praxis kaum genutzt.</p>
</section>
</section>
<section id="kovariates-design-1" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="kovariates-design-1">Kovariates Design</h3>
<p>Etwas seltener kommt der Fall vor, dass wir uns nur eine Kovariate anschauen wollen. In diesem Fall haben wir ja eine numerische, kontinuierliche Einflussvariable sowie einen normalverteilten Messwert vorliegen. Wir sind jetzt an der Steigung der Graden durch die Punktewolke interessiert. Daher stellen wir uns hier als Effekt eine Steigung ein und schauen, ob wir diese Steigung wiederfinden. Da wir natürlich auch einen Intercept für die Gradengleichung brauchen, müssen wir diesen auch definieren. Der Intercept ist aber meistens nicht von so großer praktischer Bedeutung.</p>
<section id="einkovariat-c_1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einkovariat-c_1">Einkovariat <span class="math inline">\(c_1\)</span></h4>
<p>In der folgenden schematischen Darstellung ahbe ich dir einmal einkovariates Modell mitgebracht. Wir haben auf der linken Seite einen kontinuierlichen, normalverteilten Messwert und auf der rechten Seite der Tilde eine kontinuierliche Einflussvariable als Kovariate vorliegen. Wir wollen jetzt die Daten in diesem Kontext generieren.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-c1-theo" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-c1-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-c1-theo-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="Abbildung&nbsp;21.24— Schemantisches simples Modell mit einem Messwert Y und einer kontinuierlichen Einflussvariable als Kovariate c_1 dargestellt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-c1-theo-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-c1-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.24— Schemantisches simples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und einer kontinuierlichen Einflussvariable als Kovariate <span class="math inline">\(c_1\)</span> dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wenn wir eine normalverteilte Kovariate haben, dann können wir erstmal die Kovariate erschaffen. Dafür nutzen wir dann die Funktion <code>rnorm()</code>. Dann müssen wir noch unseren Messwert mit der Gradengleichung festlegen. Ich zeige hier einmal die Variante mit dem linearen Zusammenhang und habe dann auch noch einen quadratischen mit der Helferfunktion <code>I()</code> ergänzt. Wie du dann möchtest, kannst du auch noch andere nicht lineare Zusammenhänge ergänzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>cov1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y_lin =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> c_1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="fl">0.001</span>),</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y_square =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.1</span> <span class="sc">*</span> c_1 <span class="sc">+</span> <span class="fu">I</span>(<span class="fl">1.5</span><span class="sc">*</span>c_1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="fl">0.001</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"power"</span>, <span class="at">value =</span> <span class="st">"y"</span>, y_lin<span class="sc">:</span>y_square)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung zeige ich dir einmal die Ergebnisse der Simulation. Da ich auch hier die Streuung faktisch ausgestellt habe, liegen die Punkte perfekt auf der Gradengleichung wie ich das will. Die lineare Gleichung hat noch einen Keoffizienten für den quadratischen Anteil, der ist hier ab faktisch Null. Wir können hier also sehr gut Zusammenhänge darstellen und dann schauen, ob wir die Koeffizienten dann in der linearen oder nicht-linearen Regression wiederfinden.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-c1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-c1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-c1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Abbildung&nbsp;21.25— Darstellung einer linearen und einer quadratischen Simulation mit einer normalverteilten Kovariaten sowie einem normalverteilten Messwert. Der quadratische Term existeriert im linearen Modell nicht und der Koeffizient für x^2 ist daher fast Null. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-c1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-c1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.25— Darstellung einer linearen und einer quadratischen Simulation mit einer normalverteilten Kovariaten sowie einem normalverteilten Messwert. Der quadratische Term existeriert im linearen Modell nicht und der Koeffizient für <span class="math inline">\(x^2\)</span> ist daher fast Null. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweikovariat-unabhängig-c_1-c_2" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweikovariat-unabhängig-c_1-c_2">Zweikovariat unabhängig <span class="math inline">\(c_1 + c_2\)</span></h4>
<p>Wenn wir mehrere Kovariaten simulieren wollen, dann erweitern wir das Modell einfach um eine weitere Kovariate. Im simpelsten Fall sind die beiden Kovariaten voneinander unabhängig, daher kommen aus zwei verschiedenen Normalverteilungen und haben damit nichts miteinander zu tun. Daher sind die Werte der Kovariaten untereinander nicht korreliert oder sonst wie voneinander abhängig.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-c2-theo" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-c2-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-c2-theo-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Abbildung&nbsp;21.26— Schemantisches multiples Modell mit einem Messwert Y und zwei kontinuierlichen Einflussvariablen als Kovariate c_1 und Kovariate c_2 dargestellt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-c2-theo-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-c2-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.26— Schemantisches multiples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und zwei kontinuierlichen Einflussvariablen als Kovariate <span class="math inline">\(c_1\)</span> und Kovariate <span class="math inline">\(c_2\)</span> dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Hier bauen wir uns zwei voneinander unabhängige Kovariaten. Die beiden Kovariaten entstammen aus unterschiedlichen Normalverteilungen und sind somit untereinander nicht korreliert. Dann legen wir einmal den Intercept fest und ergänzen noch die Steigungen als Effekte für die Kovariaten. Am Ende ergänze ich dann noch einen winzigen Fehler damit das Modell auch gerechnet werden kann.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>cov2_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">c_2 =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span> <span class="sc">*</span> c_1 <span class="sc">+</span> </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">2</span> <span class="sc">*</span> c_2 <span class="sc">+</span> </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann nutze ich die Funktion <code>correlation()</code> aus dem R Paket <code>{correlation}</code> um mir einmal die Korrelation zwischend den beiden Kovariaten wiedergeben zu lassen. Wir sehen hier, die beiden Kovariaten sind nicht miteinander korreliert. Der Korrelationskoeffizient liegt eher bei Null und ist nicht signifikant.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>cov2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlation</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Correlation Matrix (pearson-method)

Parameter1 | Parameter2 |     r |        95% CI |  t(8) |     p
---------------------------------------------------------------
c_1        |        c_2 | -0.34 | [-0.80, 0.37] | -1.01 | 0.340

p-value adjustment method: Holm (1979)
Observations: 10</code></pre>
</div>
</div>
<p>Dann schauen wir nochmal auf die Koeffizientend es Modells, ob wir auch unsere Effekte wiederfinden. Das sieht soweit gut aus. Wir haben die eingestellten Steigungen in den Koeffizienten wiedergefunden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> c_2, cov2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         c_1         c_2 
          2           1           2 </code></pre>
</div>
</div>
<p>Ich erstelle hier keine Abbildung in einem 3D Scatterplot, da mir das zu viel Aufwand ist und wir sehr wenig auf den 3D Scatterplots sinnvoll interpretieren können. Wir schauen uns auch selten zweikovariate Modelle in einer Abbildung an, sondern bewerten eben die Koeffizienten und andere statistsiche Maßzahlen für die Güte der Modellierung. Hier soll es dann reichen. Mehr dazu dann in den <a href="https://jkruppa.github.io/stat-linear-reg-preface.html">Kapiteln zu den Grundlagen des statistsichen Modellierens</a>.</p>
</section>
<section id="multikovariat-abhängig-c_1-c_2-c_3" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="multikovariat-abhängig-c_1-c_2-c_3">Multikovariat abhängig <span class="math inline">\(c_1 + c_2 + c_3\)</span></h4>
<p>Jetzt kommen wir zu einem etwas nischigen Thema, nämlich der Tatsache, dass wir korrelierte Kovariaten vorliegen haben. Deshalb nehmen wir auch gleich drei Korvariaten. Das ist natürlich in der Statistik ein Problem, wie wir es auch im <a href="stat-modeling-basic.html">Kapitel zu der multiplen Regression</a> nachlesen können. Mit Statistik meine ich, dass wir dann eben ein paar Probleme bei der Modellierung haben. Da gehe ich hier aber nicht tiefer drauf ein. Solche Daten zu generieren ist dann daher eher selten von Interesse in einem praktischen Kontext. Entweder liegen die Kovariaten korre,iert vor oder eben nicht. Wenn wir natürlich Algorithmen entwicklen wollen, dann ist das schon ein wichtiges Theme, wenn die Kovariaten nicht unabhängig voneinander sind.</p>
<p>Wir nutzen jetzt im Folgenden einmal das R Paket <code>{simstudy}</code> da die Genierung von korrelierten Daten mit einem Paket einfacher ist als alles per Hand zu machen. Es geht auch alles per Hand in einem <code>tibble</code> mit <code>{mvtnorm}</code> aber das machen wir hier jetzt nicht, da es viel zu kompliziert ist. Ich kann es nur empfehlen, wenn du dich mit dem Simulieren von Daten beschäftigen willst. Dann müsstest du dich auch nochmal mit dem Tutorium <a href="https://stats.stackexchange.com/questions/18082/how-would-you-explain-the-difference-between-correlation-and-covariance">How would you explain the difference between correlation and covariance?</a> beschäftigen, da wir in <code>{mvtnorm}</code> mit Kovarianzen beschäftigen.</p>
<p>Damit wären wir auch gleich beim großen Vorteil von <code>{simstudy}</code>. Wir können nämlich direkt eine Korrelationsmatrix einpflegen und müssen nicht über die Kovarianz als schwierigeres Konzept gehen. Die Kovarianz festlegen ist nämlich nicht ganz so einfach. Die Korrelation vorher festzulegen aber schon. Was wir dann auch in der Vingette <a href="https://kgoldfeld.github.io/simstudy/articles/correlated.html">Correlated Data</a> nachlesen können. Im folgenden habe ich dir einmal eine Korrlationsmatrix für die drei Kovariaten <span class="math inline">\(c_1\)</span> bis <span class="math inline">\(c_3\)</span> mitgebracht. Die Korrelationsmatrix muss symmetrisch sein. Je höher die absolute Korrelation desto stärker ist der Zusammenhang.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>cor_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.7</span>, <span class="fl">0.2</span>, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="fl">0.8</span>, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>, <span class="st">"c_3"</span>), <span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>, <span class="st">"c_3"</span>)))</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>cor_mat</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    c_1 c_2 c_3
c_1 1.0 0.7 0.2
c_2 0.7 1.0 0.8
c_3 0.2 0.8 1.0</code></pre>
</div>
</div>
<p>Dann können wir die Funktion <code>genCorData()</code> nutzen um uns korreltierte Kovariaten zu erstellen. Ich habe hier einmal eintausend Beobachtungen gewählt. Dann müssen wir noch den Mittelwert in allen Kovariaten festlegen sowie die Streuung. Wir nehmen dann die Korrelationsmatrix mit in die Funktion und benennen noch die Kovariaten entsprechend. Wir erstellen uns dann den Messwert separat mit den gewollten Effekten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>cov2_dependent_dt <span class="ot">&lt;-</span> <span class="fu">genCorData</span>(<span class="dv">1000</span>, <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">3</span>), <span class="at">sigma =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">corMatrix =</span> cor_mat,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">cnames =</span> <span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>, <span class="st">"c_3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> c_1 <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> c_2 <span class="sc">+</span> <span class="fl">2.5</span> <span class="sc">*</span> c_3 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Im Folgenden siehst du dann einmal die Datentabelle der eintausend Beobachtungen. Wir haben die ID Spalte und dann die drei Kovariaten gefolgt von dem Messwert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>cov2_dependent_dt</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Key: &lt;id&gt;
         id      c_1       c_2       c_3        y
      &lt;int&gt;    &lt;num&gt;     &lt;num&gt;     &lt;num&gt;    &lt;num&gt;
   1:     1 6.396581 14.050618  3.067163 47.36484
   2:     2 4.139633 13.254738  6.046905 49.83687
   3:     3 3.428215  8.120047 -3.039935 15.78313
   4:     4 3.062534 11.051392  5.231867 41.77626
   5:     5 1.878001 10.890102  5.654227 40.73364
  ---                                            
 996:   996 4.459314 12.990747  4.349280 45.54327
 997:   997 4.217033 12.806682  3.063211 41.59494
 998:   998 3.619132 11.552059  3.209882 38.55683
 999:   999 3.964356 12.338354  2.840538 39.72552
1000:  1000 3.955933 12.639828  2.007950 38.23297</code></pre>
</div>
</div>
<p>In den rohen Daten ist die Korrelation faktisch nicht zu sehen. Dafür müssen wir uns dann einmal die Korrelation berechnen lassen. Wie wir dann im Folgenden einmal sehen, passt es sehr gut. Wir erhalten die Korrelationen wieder, die wir auch eingestellt haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(cov2_dependent_dt, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>, <span class="st">"c_3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">redundant =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Correlation Matrix (pearson-method)

Parameter |     c_1 |     c_2 |     c_3
---------------------------------------
c_1       |         | 0.72*** | 0.21***
c_2       | 0.72*** |         | 0.79***
c_3       | 0.21*** | 0.79*** |        

p-value adjustment method: Holm (1979)</code></pre>
</div>
</div>
<p>Am Ende nochmal schauen, ob wir auch die Effekte wiederbekommen, die wir eingestellt haben. Auch hier sieht es sehr gut aus. Hier muss ich natürlich erwähnen, dass die Effekte groß sind die Fallzahl riesig und auch die Streuung in den Daten gering. Daher klappt hier auch alles so schön.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> c_2 <span class="sc">+</span> c_3, <span class="at">data =</span> cov2_dependent_dt)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ c_1 + c_2 + c_3, data = cov2_dependent_dt)

Coefficients:
(Intercept)          c_1          c_2          c_3  
      1.999        1.500        2.000        2.500  </code></pre>
</div>
</div>
<p>Dann haben wir auch unsere Effekte in dem Modell wiedergefunden. Es gibt verschiedene Korrelationsstrukturen, die wir auch in <code>{simstudy}</code> berücksichtigen können. Eine weitere Möglichkeit sind natürlich auch Zeitreihen in denen wir eine Abhängigkeit vorliegen haben. Aber auch hier reicht es meist, wenn der Trend einigermaßen stimmt. Dazu dann aber mehr in dem Abschnitt zu Zeitreihen.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/personal_opinion.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="images/personal_opinion.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>“Brauchen wir eine Generierung von korrelierten Kovariaten? Ich würde mal sagen in der allgmeinen Anwendung und Auswertung reicht es, wenn wir die Daten einfach unkorreliert generieren und dann darauf die Algorithmen laufen lassen. Aber ich selber brauche es manchmal für Beispieldaten. Daher gibt es diesen Abschnitt wirklich.” — Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.</em></p>
</blockquote>
</div>
</div>
</div>
</section>
<section id="mischung-von-normalverteilungen" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="mischung-von-normalverteilungen">Mischung von Normalverteilungen</h4>
<p>Wenn wir eine etwas komplexere Verteilung des Messwerts vorliegen haben wollen, dann lohnt sich auch einmal eine gemischte Normalverteilung zu bauen. Wir haben dann nicht eine Normalverteilung vorliegen sondern eine sehr bergige. Die bergige Normalverteilung besteht dann aber aus verschiedenen anderen Normalverteilungen, die wir dann übereinanderlegen. So können wir dann auch zweigipfelige oder wie in diesem Fall dreigipfelige Verteilungen bauen. Wir nutzen hier das R Paket <code>{simstudy}</code> und generieren uns erstmal drei Normalverteilungen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>mix_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y_1"</span>, <span class="at">formula =</span> <span class="dv">1</span>, <span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>mix_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(mix_def, <span class="at">varname =</span> <span class="st">"y_2"</span>, <span class="at">formula =</span> <span class="dv">5</span>, <span class="at">variance =</span> <span class="dv">4</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>mix_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(mix_def, <span class="at">varname =</span> <span class="st">"y_3"</span>, <span class="at">formula =</span> <span class="dv">9</span>, <span class="at">variance =</span> <span class="dv">1</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die drei Normalverteilungen, die wir gerade generiert haben <span class="math inline">\(y_1\)</span> bis <span class="math inline">\(y_3\)</span>, mischen wir jetzt einmal nach festen Anteilen miteinander. Dafür nutzen wir die folgende Schreibweise in <code>{simstudy}</code>. Die Schreibweise ist erstmal etwas ungewohnt. Wir wollen 30% der Werte von <span class="math inline">\(y_1\)</span> also schreiben wir <code>y_1 | 0.3</code>. Dann noch 40% der Werte von <span class="math inline">\(y_2\)</span> mit <code>y_2 | 0.4</code> sowie 30% der Werte von <span class="math inline">\(y_3\)</span> mit <code>y_3 | 0.3</code>. Wir nennen dann die Spalte <code>y_null</code>. Wir haben hier dann die Nullverteilung erstellt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>mix_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(mix_def, <span class="at">varname =</span> <span class="st">"y_null"</span>, </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">formula =</span> <span class="st">"y_1 | 0.3 + y_2 | 0.4 + y_3 | 0.3"</span>, </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dist =</span> <span class="st">"mixture"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ich generiere mir dann eintausend Beobachtungen, damit wir am Ende auch was sehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>mix_null_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">1000</span>, mix_def)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann kannst du dir in der folgenden Abbildung einmal anschauen, wie die drei einzelnen Normalverteilungen aussehen und wie sich dann die Kombination durch die Addierung ergibt. Wir nennen diese Verteilung jetzt unsere Nullverteilung, da wir ja noch eine andere Verteilung benötigen um einen Effekt darzustellen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-mixed-normal" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-mixed-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-mixed-normal-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Abbildung&nbsp;21.27— Gemischte Normalverteilung in einem Densityplot. (A) Die drei einzelnen Normalverteilungen. (B) Die gemischte Normalverteilung. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-mixed-normal-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-mixed-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.27— Gemischte Normalverteilung in einem Densityplot. <strong>(A)</strong> Die drei einzelnen Normalverteilungen. <strong>(B)</strong> Die gemischte Normalverteilung. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt möchte ich noch eine Alternative darstellen. Wir haben ja noch eine Gruppe mit Effekt. Daher adddiere ich einfach <span class="math inline">\(+2\)</span> auf die Nullverteilung auf und generiere mir neue Werte. Achtung, ich verschiebe hier nicht einfach die Nullverteilung sondern generiere mir neue Zahlen mit einem um <span class="math inline">\(+2\)</span> erhöhten kombinierten Mittelwert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>mixed_alt_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y_alt"</span>, <span class="at">formula =</span> <span class="st">"y_null + 2"</span>, <span class="at">variance =</span> <span class="dv">1</span>,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">dist =</span> <span class="st">"normal"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann müssen wir noch die beiden Verteilungen miteinander kombinieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>mix_null_alt_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(mixed_alt_def, mix_null_dt)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung siehst du nochmal die beiden Vereilungen der beiden Gruppen. Wir haben eine Gruppe, die der Nullverteilung folgt und einmal eine Verteilung für die Alternative. Wenn du noch mehr Gruppen haben wollen würdest, dann musst du entsprechend mehr Verteilungen verschieben.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-mixed-null-alt" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-mixed-null-alt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-mixed-null-alt-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Abbildung&nbsp;21.28— Gemischte Normalverteilung in einem Densityplot. (A) Nullverteilung. (B) Alternativeverteilung mit einem Effekt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-mixed-null-alt-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-mixed-null-alt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.28— Gemischte Normalverteilung in einem Densityplot. <strong>(A)</strong> Nullverteilung. <strong>(B)</strong> Alternativeverteilung mit einem Effekt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Dann wollen wir natürlich auch noch zufällige Zahlen genieren. Wir ziehen jetzt jeweils drei Beobachtungen aus den beiden Verteilungen. Wenn wir natürlich eine sehr komplexe Verteilung in der Grundgesamtheit haben, dann wird diese natürlich durch sehr kleine Stichproben kaum repräsentiert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>mix_null_alt_dt <span class="sc">|&gt;</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(y_null<span class="sc">:</span>y_alt) <span class="sc">|&gt;</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(y_null<span class="sc">:</span>y_alt) <span class="sc">|&gt;</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
# Groups:   name [2]
  name   value
  &lt;chr&gt;  &lt;dbl&gt;
1 y_alt   4.23
2 y_alt   9.89
3 y_alt   9.20
4 y_null  8.51
5 y_null  9.30
6 y_null  6.51</code></pre>
</div>
</div>
<p>Auch hier ist die Frage, wozu brauchen wir das? Vermutlich nicht im praktischen Alltag, aber in der Testung von Algorithmen mag eine mehrgipflige Verteilung schon von Interesse sein. Wir haben ja hier mehrere Normalverteilungen, die sich aufaddieren. Jede dieser Normalverteilungen könnte eine unentdeckte Subpopulation sein, die eben dann eine andere Verteilung des Frischegewichts hat. Ich vermute aber, dass die Anwendungsfälle eher selten sind.</p>
</section>
</section>
<section id="possionverteilt" class="level3" data-number="21.5.2">
<h3 data-number="21.5.2" class="anchored" data-anchor-id="possionverteilt"><span class="header-section-number">21.5.2</span> Possionverteilt</h3>
<p>Nachdem wir vieles einmal mit einer Normalverteilung durchprobiert haben, kommen wir jetzt einmal zu einer anderen Verteilung. Wir fangen mit der Poissonverteilung an, da die Poissonverteilung der Normalverteilung gar nicht so unähnlich ist. Wir nutzen die Poissonverteilung wenn wir Zähldaten abbilden wollen. Daher ist die Poissonverteilung immer ganzzahlig oder diskret. Wenn wir was zählen, dann haben wir auch immer positive Werte einschließlich der Nullzählungen vorliegen. Mit dem Wissen können wir dann anfangen unsere Zähldaten in einer Poissonverteilung zu generieren. Wir generieren jetzt unsere Daten mit dem R Paket <code>{simstudy}</code>, da wir hier es dann sehr viel einfacher haben als händisch in R.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Normalverteilung und Runden
</div>
</div>
<div class="callout-body-container callout-body">
<p>Gleich vorweg, es gibt auch eine einfachere Möglichkeit sich die Zähldaten zu genierieren. Du kannst auch eine Normalverteilung nehmen und dann einfach runden. Dann hast du zwar eine leichte Abweichung, aber für das Ausprobieren für Analysen macht es fast keinen Unterschied.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11 11 10 11 11</code></pre>
</div>
</div>
<p>Die Abweichungen sind tolerable wie <span class="citation" data-cites="kruppa2016simulation">Kruppa et al. (<a href="#ref-kruppa2016simulation" role="doc-biblioref">2016</a>)</span> gezeigt hat. Wenn du dann noch darauf achtest, dass du keine negativen Werte simulierst, dann ist alles soweit in Ordnung. Ich würde alle negativen Werte aus einer Normalverteilung dann auf Null setzen. Das simuliert eine Poissonverteilung am Besten.</p>
</div>
</div>
<p>Gegenüber der Normalverteilung müssen wir jetzt einige Anpassungen vornehmen. Im Folgenden müssen wir die Fallzahl erhöhen, da die Poissonverteilung keine eigenen Parameter für die Varianz hat. Die Streuung ist nämlich eien Funktion des Mittelwerts. Je größer der Mittelwert, desto größer die Varianz. Daher kann ich keine sehr kleine Streuung einstellen um auch bei kleinen Fallzahlen meine Effekte oder Mittelwerte wiederzuerhalten. Ich nutze daher hier immer um die eintausend Beobachtungen, damit wir hier auch stabile Effekte wiedergegeben bekommen.</p>
</section>
<section id="faktorielles-design-2" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="faktorielles-design-2">Faktorielles Design</h3>
<p>Beginnen wir mit einem faktoriellen Design. Wir schauen uns jetzt einmal einen Faktor mit mehr als zwei Leveln an sowie zwei Faktoren mit einmal drei Leveln und einmal zwei Leveln. Dann nehmen wir noch die Interaktion mit hinzu. Wenn wir uns mit dem faktoriellen Design beschäftigen dann generieren wir zuerst das Faktorenraster und ergänzen dann den Messwert aus der Poissonverteilung. Das ist jetzt hier der etwas größere Unterschied zu den normalverteilten Messwerten. Wir brauchen hier immer unser Raster und dann ergänzen wir unseren Messwert mit dem R Paket <code>{simstudy}</code>. Prinzipiell geht es auch für das einfaktorielle Design einfacher über <code>rpois()</code>, aber wir üben ja hier auch für die komplexeren Modelle.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Das R Paket <code>{simstudy}</code> nutzt als Speicherung der Daten nicht ein <code>tibble</code> sondern das R Paket <code>{data.table}</code>. Um unsere <code>tibble</code> dann umzuformen nutze ich die Funktion <code>as.data.table()</code>. Der Rest bleibt aber faktisch gleich.</p>
</div>
</div>
<p>Wir beginnne gleich mit einem einfaktoriellen Design mit mehr als 2 Leveln. Ich schaue hier mir mal einen Faktor mit drei Gruppen an. Der simple Fall mit nur zwei Gruppen ist eher selten und deshalb überspringe ich auch den Zweigruppenfall. Im Prinzip kannst du dir dann den Zweigruppenfall in <code>rpois()</code> schnell selber bauen.</p>
<section id="einfaktoriell-f_a-mit-2-leveln-2" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktoriell-f_a-mit-2-leveln-2">Einfaktoriell <span class="math inline">\(f_A\)</span> mit &gt;2 Leveln</h4>
<p>Wenn wir ein einfaktorielles Design vorliegen haben, dann brauchen wir einen Faktor mit drei Leveln sowie eine Anzahl an Beobachtungen pro Level. In den folgenden Tabs zeige ich dir dann einmal wie wir die Daten in <code>{simstudy}</code> generieren können. Das ist hier dann eher eine Fingerübung und etwas umständlich. Das geht natürlich für so einen einfachen Fall mit einem Faktor schneller mit der Funktion <code>rpois()</code> wo wir dann schneller die Daten erstellen können. Am Ende gehe ich nochmal auf Excel ein.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true"><code>{simstudy}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false"><code>rpois()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Excel</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>Wir bauen uns hier erstmal das Datenraster für den Faktor auf, da wir dann das Raster mit dem R Paket <code>{simstdy}</code> erweitern und mit einem poissonverteilten Messwert ergänzen. Das heißt, wir nutzen die Funktion <code>expand_grid()</code> um uns für die drei Level jeweils eintausend Beobachtungen oder Wiederholungen zu erstellen. Da wir gleich mit <code>{simstudy}</code> weiterarbeiten brauche ich das Datenraster als ein <code>data.table</code> Objekt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>fac1_dt <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns auch schon einmal den Datensatz anschauen, wo wir eben nur das Datenraster für die Faktoren enthalten haben. Wir haben dreitausend Beobachtungen jeweils eintausend Beobachtungen pro Level des Faktors.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>fac1_dt</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        f_a   rep
      &lt;int&gt; &lt;int&gt;
   1:     1     1
   2:     1     2
   3:     1     3
   4:     1     4
   5:     1     5
  ---            
2996:     3   996
2997:     3   997
2998:     3   998
2999:     3   999
3000:     3  1000</code></pre>
</div>
</div>
<p>Jetzt brauchen wir noch die Definition für unseren poissonverteilten Messwert in <code>{simstudy}</code>. Dafür benennen wir dann den Messwert mit <code>y</code> und geben noch die Formel an. Jedes Level hat einen Effekt von <span class="math inline">\(+4\)</span>. Dann noch die Verteilung angeben, damit wir hier auch aus der Possionverteilung ziehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>y_pois_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">formula =</span> <span class="st">"0 + 4*f_a"</span>,</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dist =</span> <span class="st">"poisson"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt bringen wir unser Datenraster mit unserer Datendefinition zusammen. Wir erhalten dann einen neuen Datensatz mit unserem poissonverteilten Messwert. Am Ende möchte ich dann noch die Spalte <code>f_a</code> als Faktor mutieren und die Level umbenennen. Dann sind wir auch schon fertig.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>fac1_pois_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(y_pois_def, fac1_dt) <span class="sc">|&gt;</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"A."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung siehst du einmal die dreitausend generierten Beobachtungen pro Gruppe. Wir sehen hier einmal den Intercept bei Null sowie den Effekt von <span class="math inline">\(+4\)</span> in jedem Level des Faktors. Die Varianz steigt mit dem Mittelwert an. Die Poissonverteilung ist eine schiefe Verteilung bei einem geringen Mittelwert. Je größer der Mittelwert wird, desto ähnlicher wird die Poissonverteilung einer Normalverteilung.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-fac1-pois" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-fac1-pois-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-fac1-pois-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32" title="Abbildung&nbsp;21.29— Boxplot der einfaktoriellen Poissondaten mit einem Intercept \beta_0 von 0 sowie den Effekten von +4 pro Faktorlevel. Die Gruppenmittelwerte sind mit dargestellt. Insgesamt wurden n = 1000 Beobachtungen pro Gruppe generiert. Mit stiegendem Mittelwert steigt auch die Varianz in der Possionverteilung. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-fac1-pois-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-fac1-pois-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.29— Boxplot der einfaktoriellen Poissondaten mit einem Intercept <span class="math inline">\(\beta_0\)</span> von 0 sowie den Effekten von <span class="math inline">\(+4\)</span> pro Faktorlevel. Die Gruppenmittelwerte sind mit dargestellt. Insgesamt wurden <span class="math inline">\(n = 1000\)</span> Beobachtungen pro Gruppe generiert. Mit stiegendem Mittelwert steigt auch die Varianz in der Possionverteilung. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>In dem einfaktoriellen Fall können wir uns auch die Daten einmal mit der Funktion <code>rpois()</code> erstellen. Wir brauchen hier einmal die Fallzahl sowie den Mittelwert als <code>lambda</code>. Wir können in einer Poissonverteilung keine Streuung angeben, da die Streuung eine Funktion des Mittelwerts ist. Je größer der Mittelwert desto größer die Streuung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">lambda =</span> <span class="dv">2</span>),</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">"2"</span> <span class="ot">=</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">lambda =</span> <span class="dv">8</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"f_a"</span>, <span class="at">value =</span> <span class="st">"y"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  f_a       y
  &lt;chr&gt; &lt;int&gt;
1 1         1
2 1         2
3 1         2
4 2         7
5 2         9
6 2        12</code></pre>
</div>
</div>
<p>In diesem Fall ist eben sehr einfach sich die Daten zu bauen. Meiner Meinung nach reicht so eine simple Art auch vollkommen aus, wenn wir die Daten nur zum Ausprobieren brauchen und nicht unbedingt gerundete Normalverteilungsdaten wollen.</p>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>In Excel können wir uns keine Zuafallszahlen aus einer Poissonverteilung generieren lassen. Daher nutzen wir hier auch <code>NORMINV()</code> und runden dann die Ergebnisse ganzahlig. Wenn wir negative Werte haben sollten, dann müssen wir diese Werte dann auf Null setzen.</p>
</div>
</div>
</div>
</section>
<section id="zweifaktoriell-ohne-interaktion-f_a-f_b-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktoriell-ohne-interaktion-f_a-f_b-1">Zweifaktoriell ohne Interaktion <span class="math inline">\(f_A + f_B\)</span></h4>
<p>Jetzt kommen wir zu den etwas interessanteren Design mit dem zweifakotriellen Experiment ohne Interaktion. Wir haben jetzt hier zwei Faktoren <span class="math inline">\(f_A\)</span> und <span class="math inline">\(f_B\)</span> mit jeweils drei oder zwei Leveln vorliegen. Die beiden Faktoren sind untereinander unabhängig, daher haben wir hier keine Interaktion vorliegen. Wir wollen jetzt einmal eintausend poissonverteilte Messwerte generieren. Dafür nutze ich wie immer einmal das R Paket <code>{simstudy}</code> sowie den Weg über die Funktion <code>rpois()</code>. In Excel können wir keine Poissondaten erschaffen. Hier müssen wir dann die Daten aus einer Normalverteilung entsprechend runden.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true"><code>{simstudy}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false"><code>rpois()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Excel</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>Wir bauen uns hier erstmal das Datenraster für die beiden Faktoren auf, da wir dann das Raster mit dem R Paket <code>{simstdy}</code> erweitern und mit einem poissonverteilten Messwert ergänzen. Das heißt, wir nutzen die Funktion <code>expand_grid()</code> um uns für die drei Level in der Kombination der anderen zwei Level jeweils eintausend Beobachtungen oder Wiederholungen zu erstellen. Da wir gleich mit <code>{simstudy}</code> weiterarbeiten brauche ich das Datenraster als ein <code>data.table</code> Objekt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>fac2_dt <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">f_b =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns auch schon einmal den Datensatz anschauen, wo wir eben nur das Datenraster für die Faktoren enthalten haben. Wir haben sechstausend Beobachtungen jeweils eintausend Beobachtungen pro Faktorkombination der beiden Faktoren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>fac2_dt</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        f_a   f_b   rep
      &lt;int&gt; &lt;int&gt; &lt;int&gt;
   1:     1     1     1
   2:     1     1     2
   3:     1     1     3
   4:     1     1     4
   5:     1     1     5
  ---                  
5996:     3     2   996
5997:     3     2   997
5998:     3     2   998
5999:     3     2   999
6000:     3     2  1000</code></pre>
</div>
</div>
<p>Jetzt brauchen wir noch die Definition für unseren poissonverteilten Messwert in <code>{simstudy}</code>. Dafür benennen wir dann den Messwert mit <code>y</code> und geben noch die Formel an. Jedes Level des Faktors <span class="math inline">\(f_A\)</span> hat einen Effekt von <span class="math inline">\(+2\)</span> und jedes Level des Faktors <span class="math inline">\(f_B\)</span> hat einen Effekt von <span class="math inline">\(+6\)</span>. Da wir hier nur zwei Level vorliegen haben, unterschieden sich die beiden Level <span class="math inline">\(B.1\)</span> und <span class="math inline">\(B.2\)</span> einfach um sechs Einheiten. Dann noch die Verteilung angeben, damit wir hier auch aus der Possionverteilung ziehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>y_pois_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">formula =</span> <span class="st">"0 + 2*f_a + 6*f_b"</span>,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dist =</span> <span class="st">"poisson"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt bringen wir unser Datenraster mit unserer Datendefinition zusammen. Wir erhalten dann einen neuen Datensatz mit unserem poissonverteilten Messwert. Am Ende möchte ich dann noch die Spalte <code>f_a</code> und <code>f_b</code> als Faktoren mutieren und die Level umbenennen. Dann sind wir auch schon fertig.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>fac2_pois_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(y_pois_def, fac2_dt) <span class="sc">|&gt;</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"A."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)),</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">factor</span>(f_b, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"B."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung siehst du einmal die sechstausend generierten Beobachtungen pro Gruppe. Wir sehen hier einmal den Intercept bei Null sowie den Effekt von <span class="math inline">\(+4\)</span> in jedem Level des Faktors <span class="math inline">\(f_A\)</span> sowie die Verschiebung in dem Faktor <span class="math inline">\(f_B\)</span>. Die Varianz steigt mit dem Mittelwert an. Die Poissonverteilung ist eine schiefe Verteilung bei einem geringen Mittelwert. Je größer der Mittelwert wird, desto ähnlicher wird die Poissonverteilung einer Normalverteilung.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-fac2-nointer-pois" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-fac2-nointer-pois-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-fac2-nointer-pois-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33" title="Abbildung&nbsp;21.30— Boxplot der zweifaktoriellen Poissondaten mit einem Intercept \beta_0 von 0 sowie den Effekten von +2 pro Faktorlevel von Faktor f_A sowie von +6 pro Faktorlevel von Faktor f_B. Da keine interaktion vorliegt, sind sind die Level B.2 um den festen Wert des Effekts verschoben. Die Gruppenmittelwerte sind mit dargestellt. Insgesamt wurden n = 1000 Beobachtungen pro Gruppe generiert. Mit stiegendem Mittelwert steigt auch die Varianz in der Possionverteilung. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-fac2-nointer-pois-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-fac2-nointer-pois-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.30— Boxplot der zweifaktoriellen Poissondaten mit einem Intercept <span class="math inline">\(\beta_0\)</span> von 0 sowie den Effekten von <span class="math inline">\(+2\)</span> pro Faktorlevel von Faktor <span class="math inline">\(f_A\)</span> sowie von <span class="math inline">\(+6\)</span> pro Faktorlevel von Faktor <span class="math inline">\(f_B\)</span>. Da keine interaktion vorliegt, sind sind die Level <span class="math inline">\(B.2\)</span> um den festen Wert des Effekts verschoben. Die Gruppenmittelwerte sind mit dargestellt. Insgesamt wurden <span class="math inline">\(n = 1000\)</span> Beobachtungen pro Gruppe generiert. Mit stiegendem Mittelwert steigt auch die Varianz in der Possionverteilung. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>In dem zweifaktoriellen Fall können wir uns auch die Daten auch einmal mit der Funktion <code>rpois()</code> erstellen. Wir brauchen hier einmal die Fallzahl sowie den Mittelwert als <code>lambda</code>. Wir können in einer Poissonverteilung keine Streuung angeben, da die Streuung eine Funktion des Mittelwerts ist. Je größer der Mittelwert desto größer die Streuung. Hier bauen wir uns aber erst den Vektor der Effekte und stecken dann diesen in die Funktion <code>rpois()</code>. Das ist etwas anders als bei der Normalverteilung. Wir haben ja hier keinen symmetrischen Fehlerterm, den wir aufaddieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>fac2_nointer_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">f_b =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y_eff =</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">2</span> <span class="sc">*</span> f_a <span class="sc">+</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">6</span> <span class="sc">*</span> f_b,</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">rpois</span>(<span class="fu">length</span>(y_eff), <span class="at">lambda =</span> y_eff)) <span class="sc">|&gt;</span> </span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">as_factor</span>(f_a),</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">as_factor</span>(f_b))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann schauen wir uns nochmal an, ob wir auch die Mittelwerte und Mediane wiedererhalten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>fac2_nointer_tbl <span class="sc">|&gt;</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(f_a, f_b) <span class="sc">|&gt;</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">round</span>(<span class="fu">mean</span>(y)), <span class="fu">median</span>(y))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'f_a'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
# Groups:   f_a [3]
  f_a   f_b   `round(mean(y))` `median(y)`
  &lt;fct&gt; &lt;fct&gt;            &lt;dbl&gt;       &lt;dbl&gt;
1 1     1                    8           8
2 1     2                   14          14
3 2     1                   10          10
4 2     2                   16          16
5 3     1                   12          12
6 3     2                   18          18</code></pre>
</div>
</div>
<p>In diesem Fall ist schon nicht mehr so einfach sich die Daten zu bauen. Meiner Meinung nach solltest du dann spätenstens hier einmal zu <code>{simstudy}</code> überwechseln. Die Funktionalität von dem R Paket ist da wirklich besser, als sich das selber in einem <code>tibble</code> zusammenzubauen.</p>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>In Excel können wir uns keine Zuafallszahlen aus einer Poissonverteilung generieren lassen. Daher nutzen wir hier auch <code>NORMINV()</code> und runden dann die Ergebnisse ganzahlig. Wenn wir negative Werte haben sollten, dann müssen wir diese Werte dann auf Null setzen. Bei zwei Faktoren hört hier schon etwas der Spaß auf, da wir ja alle Fakotrkombinationen dann einzeln anlegen müssen.</p>
</div>
</div>
</div>
</section>
<section id="zweifaktoriell-mit-interaktion-f_a-f_b-f_a-times-f_b-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktoriell-mit-interaktion-f_a-f_b-f_a-times-f_b-1">Zweifaktoriell mit Interaktion <span class="math inline">\(f_A + f_B + f_A \times f_B\)</span></h4>
<p>Für den zweifaktoriellen Fall mit Interaktion haben wir jetzt hier zwei Faktoren <span class="math inline">\(f_A\)</span> und <span class="math inline">\(f_B\)</span> mit jeweils drei oder zwei Leveln vorliegen. Ich gehe diesmal nur nochauf auf das R Paket <code>{simstdy}</code> ein, da es händisch und in Excel jhier nicht mehr funktioniert. Wenn du es händisch machen möchtest, dann kannst du dir natürlich für alle Faktorkombinationen die Effekte zusammenbauen und dann <code>rpois()</code> für die Zufallszahlen nutzen. Ich empfinde daran aber keinen Gewinn mehr.</p>
<p>Wir bauen uns hier erstmal das Datenraster wie schon vorab für die beiden Faktoren auf, da wir dann das Raster mit dem R Paket <code>{simstdy}</code> erweitern und mit einem poissonverteilten Messwert ergänzen. Das heißt, wir nutzen die Funktion <code>expand_grid()</code> um uns für die drei Level in der Kombination der anderen zwei Level jeweils eintausend Beobachtungen oder Wiederholungen zu erstellen. Da wir gleich mit <code>{simstudy}</code> weiterarbeiten brauche ich das Datenraster als ein <code>data.table</code> Objekt. Soweit ist alles gleich. Wir bauen uns die Interalktion jetzt anders.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">f_b =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">as_factor</span>(f_a),</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">as_factor</span>(f_b))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt gehen wir aber noch einen Schritt weiter und bauen das Datenraster als Dummykodierung. Somit steht jetzt jede Spalte dafür, ob ein Effekt dann entsprechend für die Beobachtung berücksichtigt wird. Hier können wir dann auch die Interaktion in den jeweiligen Faktorkombinationen <span class="math inline">\(A.2.B.2\)</span> und <span class="math inline">\(A.3.B.2\)</span> richtig modellieren. Es ist aber immer noch nicht einfach, das kann ich unterschreiben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>fac2_model_dt <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_matrix</span>(<span class="sc">~</span> f_a <span class="sc">*</span> f_b) <span class="sc">|&gt;</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns auch schon einmal die Modellmatrix für den Datensatz anschauen, wo wir eben die Faktoren und die Interaktion enthalten haben. Wir haben sechstausend Beobachtungen jeweils eintausend Beobachtungen pro Faktorkombination der beiden Faktoren. In den Faktorkombinationen sind dann auch die Interaktionen enthalten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>fac2_model_dt</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      intercept  f_a2  f_a3  f_b2 f_a2_f_b2 f_a3_f_b2
          &lt;num&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt;     &lt;num&gt;     &lt;num&gt;
   1:         1     0     0     0         0         0
   2:         1     0     0     0         0         0
   3:         1     0     0     0         0         0
   4:         1     0     0     0         0         0
   5:         1     0     0     0         0         0
  ---                                                
5996:         1     0     1     1         0         1
5997:         1     0     1     1         0         1
5998:         1     0     1     1         0         1
5999:         1     0     1     1         0         1
6000:         1     0     1     1         0         1</code></pre>
</div>
</div>
<p>Jetzt müssen wir für jede Spalte den Effekt definieren. Daher haben wir dann sechs Effekte. Einmal einen für den Intercept und dann für die jeweiligen Faktorlevel. Hier müssen wir dann aber die Multiplikation mit selber einrechnen. Daher ist der Effekt des <span class="math inline">\(f_A\)</span> zwar <span class="math inline">\(+2\)</span>, aber müssen wir dann schon bei <span class="math inline">\(A.3\)</span> eben <span class="math inline">\(+2+2 = +4\)</span> rechnen. Es ist wirklich etwas anstrengend. Dann kommen noch die beiden Terme für die Interaktion.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>y_pois_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y"</span>, </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">formula =</span> <span class="st">"5 * intercept + 2 * f_a2 + 4 * f_a3 + </span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="st">                         3 * f_b2 + 0 * f_a2_f_b2 + -6 * f_a3_f_b2"</span>,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dist =</span> <span class="st">"poisson"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt bringen wir unser Datenraster mit unserer Datendefinition zusammen. Wir erhalten dann einen neuen Datensatz mit unserem poissonverteilten Messwert. Am Ende möchte ich dann noch die Spalte <code>f_a</code> und <code>f_b</code> auswählen sowie als Faktoren mutieren und die Level umbenennen. Dann sind wir auch schon fertig.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>fac2_pois_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(y_pois_def, fac2_model_dt) <span class="sc">|&gt;</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(f_a, f_b, y)  <span class="sc">|&gt;</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"A."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)),</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">factor</span>(f_b, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"B."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Am Ende musst du dir das alles einmal in der Abbildung anschauen. Hier siehst du dann auch gut die Interaktion im letzten Level vom Faktor <span class="math inline">\(f_A\)</span>. Wir haben dort in der Faktorkombination <span class="math inline">\(A.3.A.2\)</span> nicht einen Mittelwert von 12 sondern von 6 vorliegen. Hier dreht sich der immer positive Effekt des Faktors <span class="math inline">\(f_B\)</span> einmal ins Negative um. Die Erstellung ist ohne einen Visualisierung wirklich schwer nachzuvollziehen und zu überprüfen. Am Ende musst du dann immer schauen, ob du dann die Effekte bei einer großen Fallzahl wiederfindest und dur dann einen kleineren Datensatz für dich bauen. Die Implementierung einer Interaktion ist eben nicht ganz so einfach, wenn es um die Generierung von faktoriellen Experimenten geht.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-fac2-inter-pois" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-fac2-inter-pois-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-fac2-inter-pois-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="Abbildung&nbsp;21.31— Boxplot der zweifaktoriellen Poissondaten mit einem Intercept \beta_0 von 0 sowie den Effekten von +2 pro Faktorlevel von Faktor f_A sowie von +3 pro Faktorlevel von Faktor f_B. Da eine interaktion vorliegt, sind sind die Level B.2 um den festen Wert des Effekts verschoben. Es liegt eine Interaktion im Level A.3 vor. Der Effekt in f_B ist gedreht. Die Gruppenmittelwerte sind mit dargestellt. Insgesamt wurden n = 1000 Beobachtungen pro Gruppe generiert. Mit stiegendem Mittelwert steigt auch die Varianz in der Possionverteilung. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-fac2-inter-pois-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-fac2-inter-pois-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.31— Boxplot der zweifaktoriellen Poissondaten mit einem Intercept <span class="math inline">\(\beta_0\)</span> von 0 sowie den Effekten von <span class="math inline">\(+2\)</span> pro Faktorlevel von Faktor <span class="math inline">\(f_A\)</span> sowie von <span class="math inline">\(+3\)</span> pro Faktorlevel von Faktor <span class="math inline">\(f_B\)</span>. Da eine interaktion vorliegt, sind sind die Level <span class="math inline">\(B.2\)</span> um den festen Wert des Effekts verschoben. Es liegt eine Interaktion im Level <span class="math inline">\(A.3\)</span> vor. Der Effekt in <span class="math inline">\(f_B\)</span> ist gedreht. Die Gruppenmittelwerte sind mit dargestellt. Insgesamt wurden <span class="math inline">\(n = 1000\)</span> Beobachtungen pro Gruppe generiert. Mit stiegendem Mittelwert steigt auch die Varianz in der Possionverteilung. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/personal_opinion.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="images/personal_opinion.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>“Brauchen wir eine Generierung von zweifaktoriellen Experimenten aus einer Poissonverteilung mit Interaktion wirklich? Diese Frage kann man sich auch hier stellen. Ich selber baue mir gerne die Interaktion dann händisch in Excel oder aber Runde mir eine Normalverteilung. Das reicht im Kontext der Lehre und zum Testen vollkommen aus. Ich hatte aber Spaß zu verstehen, wie die Interaktion entsteht und wie ich die Interaktion nachbauen kann. Dafür hat es sich gelohnt.” — Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.</em></p>
</blockquote>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Datenraster in <code>{simstudy}</code> für Faktoren
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nachdem ich hier schon sehr weit war mit der Funktion <code>expand_grid()</code> habe ich Abends dann noch per Zufall den Blogeintrag <a href="https://www.rdatagen.net/post/testing-many-interventions-in-a-single-experiment/">Testing multiple interventions in a single experiment</a> gelesen. Wir können also auch ein faktorielles Design auch in <code>{simstudy}</code> bauen. Hätte mich dann auch etwas gewundert wenn es dann doch nicht ginge. Es ist immer eine Frage des Nestings oder der Schachtelung, also wie wollen wir die beiden Faktoren jeweils ineinander verschränkt wissen. Wir können die Funktion <code>genMultiFac()</code> nutzen um uns mehrere Faktoren zu erschaffen. Wir können dabei auch gleich die Spaltennamen setzen und sagen, wie oft eine Faktorkombination wiederholt werden soll.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>fac2_dt <span class="ot">&lt;-</span> <span class="fu">genMultiFac</span>(<span class="at">each =</span> <span class="dv">5</span>, <span class="at">nFactors =</span> <span class="dv">2</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>), </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">colNames =</span> <span class="fu">c</span>(<span class="st">"f_a"</span>, <span class="st">"f_b"</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann einmal die Daten anschauen. Ich zeige die hier als <code>tibble</code> damit nicht so viel ausgegeben wird. In der Standardimplementierung des <code>data.table</code> kriegen wir immer einen sehr langen Ausdruck.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>fac2_dt <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 3
      id   f_a   f_b
   &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1     1     1     1
 2     2     1     1
 3     3     1     1
 4     4     1     1
 5     5     1     1
 6     6     2     1
 7     7     2     1
 8     8     2     1
 9     9     2     1
10    10     2     1
# ℹ 20 more rows</code></pre>
</div>
</div>
<p>Jetzt brauchen wir noch die Definition für unseren poissonverteilten Messwert in <code>{simstudy}</code>. Das ist das Gleiche wie schon bevor. Hier muss ich definieren, wie die Effekte der beiden Faktoren sind. Auch hier gilt, das Ganze ist dann ohne Interaktion gebaut. Theoretisch könnest du noch einen globalen Interaktionseffekt mit <code>3 * f_a * _f_b</code> hinzufügen, aber dann wäre der Effekt der Interaktion multiplikativ eben <span class="math inline">\(+3\)</span> über die Level der Faktoren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>y_pois_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y"</span>, </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">formula =</span> <span class="st">"-2 + 2*f_a + 6*f_b"</span>,</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dist =</span> <span class="st">"poisson"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt bringen wir unser Datenraster mit unserer Datendefinition zusammen. Wir erhalten dann einen neuen Datensatz mit unserem poissonverteilten Messwert. Am Ende möchte ich dann noch die Spalte <code>f_a</code> und <code>f_b</code> als Faktoren mutieren und die Level umbenennen. Dann sind wir auch schon fertig.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">addColumns</span>(y_pois_def, fac2_dt) <span class="sc">|&gt;</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"A."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)),</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">factor</span>(f_b, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"B."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 4
      id f_a   f_b       y
   &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;int&gt;
 1     1 A.1   B.1       6
 2     2 A.1   B.1       2
 3     3 A.1   B.1       7
 4     4 A.1   B.1       5
 5     5 A.1   B.1       8
 6     6 A.2   B.1       8
 7     7 A.2   B.1       7
 8     8 A.2   B.1       6
 9     9 A.2   B.1      11
10    10 A.2   B.1      11
# ℹ 20 more rows</code></pre>
</div>
</div>
<p>Wir haben auch noch die Möglichkeit die Faktoren mit der Funktion <code>genFactor()</code> zu modifizieren, aber dann können wir wieder nicht mit den Leveln rechnen. Dann lohnt sich die Sache eigentlich nicht. Für mich hat die <code>expand_grid()</code> Variante mehr Charme. Die Variante ist einfach und schnell.</p>
</div>
</div>
</section>
<section id="zero-inflated-poisson" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zero-inflated-poisson">Zero-inflated Poisson</h4>
<p>Wenn wir mit der Poissonverteilung arbeiten, dann haben wir manchmal den Fall vorliegen, dass wir eine zero-inflated Poissonverteilung (deu. <em>Null-inflationiert</em>, nicht gebräuchlich) vorliegen haben. Wir haben also noch mehr Nullen in dem Messwert als wir in einer normalen Poissonverteilung erwarten würden. Wir können eine solche Poissonverteilung dann ebenfalls mit <code>{simstudy}</code> bauen. Wir nutzen dazu das Tutorium <a href="https://www.rdatagen.net/post/adding-mixture-distributions-to-simstudy/">Adding a “mixture” distribution to the <code>{simstudy}</code> package</a>, welches und gut hilft einmal aus zwei Verteilungen eine Verteilung mit sehr vielen Nullen zu bauen.</p>
<p>Was heißt jetzt zwei Verteilungen? Wir bauen uns erstmal eine Poissonverteilung, die faktisch nur aus Nullen besteht. Die Poissonverteilung hat den Mittelwert von <span class="math inline">\(\lambda\)</span> gleich <span class="math inline">\(0\)</span>. Wir nennen diese Verteilung dann <code>y_0</code>. Dann bauen wir uns noch eine klassische Poissonverteilung mit einem <span class="math inline">\(\lambda\)</span> von <span class="math inline">\(2\)</span> zusammen. Das können wir erstmal machen. Weiter unten zeige ich dir dann auch noch wie du dir einen Effekt mit einem einfaktoriellen Design als Beispiel baust.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>zeroinf_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y_0"</span>, <span class="at">formula =</span> <span class="dv">0</span>, <span class="at">dist =</span> <span class="st">"nonrandom"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">formula =</span> <span class="dv">2</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt kommt der Teil wo wir die beiden Verteilungen miteinander mischen. Wir nehmen <span class="math inline">\(20%\)</span> der Werte der <code>y_0</code> Verteilung und wir nehmen <span class="math inline">\(80%\)</span> der Werte der <code>y</code> Verteilung. Das machen wir etwas umständlich über den Strich <code>|</code>. Wir sagen hier welche Anteile der beiden Verteilungen wir dann wollen. Am Ende benennen wir noch den Messwert neu.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>zeroinf_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(zeroinf_def, <span class="at">varname =</span> <span class="st">"y_zeroinf"</span>, <span class="at">formula =</span> <span class="st">"y_0 | .2 + y | .8"</span>, </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">dist =</span> <span class="st">"mixture"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir schon eintausend Beobachtungen erstellen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>zeroinf_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">1000</span>, zeroinf_def)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbidlung siesht du dann einmal die Histogramme der normalen Poissonverteilung sowie der zero-inflated Poissonverteilung. Wir haben hier als Unterschied eben den klaren Exzess an Nullen in der inflationierten Poissonverteilung. Das sieht man nicht unbedingt so gut, aber wir haben eben doch einiges mehr an Nullen als es nach der klassischen Verteilung sein sollte.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-poisson-zeroinf" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-poisson-zeroinf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-poisson-zeroinf-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36" title="Abbildung&nbsp;21.32— Histogramme von Zähldaten, die einer Poissonverteilung folgen. (A) Klassische Poissonverteilung. (B) Zero-inflated Poissonverteilung mit mehr Nullen. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-poisson-zeroinf-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-poisson-zeroinf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.32— Histogramme von Zähldaten, die einer Poissonverteilung folgen. <strong>(A)</strong> Klassische Poissonverteilung. <strong>(B)</strong> Zero-inflated Poissonverteilung mit mehr Nullen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wenn wir das ganze jetzt mit einem Behandlungsfaktor generieren wollen, dann müssen wir uns erstmal das Datenraster bauen. Wir nutzen dann das Raster um uns die Daten zu generieren und zu wissen wie viele Level mit Wiederholungen wir vorliegen haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>fac1_dt <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Zu unser Poissonverteilung mit den Mittelwert von Null kommt dann noch die klassische Poissonverteiung mit dem Effekt des Faktors. Hier hat jedes Faktorlevel einen Effekt von <span class="math inline">\(+4\)</span> und wir nehmen einen Intercept von Null an. Dann mische ich noch die Verteilungen im Verhältnis von 1:3, daher 25% kommen aus der Poissonverteilung <code>y_0</code> und 75% aus der Poissonverteilung mit Effekt. Damit haben wir dann die Datendefinition zusammen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>zeroinf_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y_0"</span>, <span class="at">formula =</span> <span class="dv">0</span>, <span class="at">dist =</span> <span class="st">"nonrandom"</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>zeroinf_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(zeroinf_def, <span class="at">varname =</span> <span class="st">"y"</span>, </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">formula =</span> <span class="st">"0 + 4*f_a"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>zeroinf_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(zeroinf_def, <span class="at">varname =</span> <span class="st">"y_zeroinf"</span>, </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">formula =</span> <span class="st">"y_0 | .25 + y | .75"</span>, <span class="at">dist =</span> <span class="st">"mixture"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt bringen wir unser Datenraster mit unserer Datendefinition zusammen. Wir erhalten dann einen neuen Datensatz mit unserem poissonverteilten Messwert. Das ist etwas anders als eben, aber hier müssen wir ja auch zwei Dinge zusammenbringen. Eben haben wir nur die Daten aus einer Datendefinition generiert. Am Ende möchte ich dann noch die Spalte <code>f_a</code> als Faktor mutieren und die Level umbenennen. Dann sind wir auch schon fertig.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>fac1_zeroinf_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(zeroinf_def, fac1_dt) <span class="sc">|&gt;</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"A."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann schauen wir uns einmal die beiden Verteilungen im Vergleich in der folgenden Abbildung einmal an. Ich habe hier einmal den Violinplot gewählt, da kannst du dann besser den Fuß in der zero-inflated Poissonverteilung erkennen. Wir sehen dann aber auch, dass der Mittelwert nach unten gezogen wird. Auch der Median, als grau dargestellt, wird nach unten gezogen und entspricht dann nicht den vorgegeben Werten. Durch die Zeroinflation haben wir dann einen nicht mehr ganz sauberen Bezug zwischen den voreingestellten und den sich ergebenden Effekten.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-fac1-pois-zeroinflated" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-fac1-pois-zeroinflated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-fac1-pois-zeroinflated-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37" title="Abbildung&nbsp;21.33— Violinplot von einfaktoriellen Experimenten von Zähldaten, die einer Poissonverteilung folgen. Weiß sind die Mittelwerte und grau die Mediane dargestellt. (A) Klassische Poissonverteilung. (B) Zero-inflated Poissonverteilung mit mehr Nullen zu erkennen an den Füßen der Violinplots. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-fac1-pois-zeroinflated-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-fac1-pois-zeroinflated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.33— Violinplot von einfaktoriellen Experimenten von Zähldaten, die einer Poissonverteilung folgen. Weiß sind die Mittelwerte und grau die Mediane dargestellt. <strong>(A)</strong> Klassische Poissonverteilung. <strong>(B)</strong> Zero-inflated Poissonverteilung mit mehr Nullen zu erkennen an den Füßen der Violinplots. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="kovariates-design-2" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="kovariates-design-2">Kovariates Design</h3>
<p>Im Folgenden nutze ich das einkovariate und zweikovariate Design nochmal um etwas mit dem R Paket <code>{simstudy}</code> zu üben und die Funktionen zu zeigen. Am Ende nutzen wir eher selten ein kovariates Design in den Agrarwissenschaften, wenn es um ein poissonverteilten Messwert geht, aber zur Vollständigkeit gehört auch dieser Abschnitt mit dazu. Wir können hier verschiedene Modelle rechnen, ich nutze hier gleich die Gaussian Regression um auf meine Effekte zu kommen. Dann habe ich auch gleich die voreingestellten Mittelwerte wiedergegeben. Ein poissonverteilten Messwert analysieren wir ja eigentlich mit einer Poissonregression, aber dort erhalten wir dann als Effekte eben nicht die Steigung so direkt wieder sondern eben dann das Risk Ratio. Mehr dazu dann wie immer im entsprechenden <a href="eda-distribution.html#sec-poisson">Kapitel zu der Poissonregression</a>, wenn dich mehr zum Thema interessiert.</p>
<section id="einkovariat-c_1-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einkovariat-c_1-1">Einkovariat <span class="math inline">\(c_1\)</span></h4>
<p>Das Ziel der einkovariaten Datengenierung ist einfach. Wir haben eine normalverteilte Kovariate vorliegen und wollen einen Effekt für die Kovariate im poissonverteilten Messwert generieren. Bei einer Kovariate ist dann der Effekt auch gleichbedeutend mit der Steigung einer Graden durch die Punktewolke im Scatterplot. Ich nutze hier jetzt einmal sehr viel mehr Beobachtungen um dann auch auf die voreingestellten Effekte im Modell rauszukommen. Als erstes baue ich mir eine normalverteilte Kovariate mit einem Mittelwert von <span class="math inline">\(7\)</span> und einer Streuung von <span class="math inline">\(3\)</span> zusammen. Dann kann ich mir meinen Messwert in der folgenden Definition zusammenbauen. Hier habe ich dann einen Intercept von <span class="math inline">\(10\)</span> und einen Effekt von <span class="math inline">\(2\)</span> als Steigung vorliegen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>cov1_pois_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"c_1"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, <span class="at">formula =</span> <span class="st">"6"</span>,</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">variance =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>, <span class="at">formula =</span> <span class="st">"10 + 2 * c_1"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann kann ich mir auch schon die eintausend Beobachtungen einmal generieren. Da ich hier keinn Faktoren vorliegen habe, brauche ich auch kein Datenraster für die Erstellung der Daten. Wir modellieren hier nicht in der gleichen Weise mit Effektschätzern unsere Daten wie wir dann in einer Poissonregression zurückkriegen würden. Das ist aber ein Preis, den wir aus Gründen der Einfachheit bezahlen wollen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>cov1_pois_tbl <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">1000</span>, cov1_pois_def)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns auch schon das Ergebnis der Datengenerierung in der folgenden Abbildung einmal anschauen. Hier wird dann auch sehr schön deutlich, dass wir durch den poissonverteilten Messwert Banden in dem Scatterplot sehen. Wir haben ja hier nur ganzzahlige Werte für die Messwert vorliegen. Bei einer so hohen Fallzahl an Beobachtungen erhalten wir dann auch unseren voreingestellten Effekte wieder. Hier müssen wir dann ein wenig aufpassen, wie wir denn die Daten analysieren wollen. Eine Poissonregression mit einem Risikoverhältnis als Effekt ist nicht das Gleiche wie eine Gaussianregression.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-c1-pois" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-c1-pois-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-c1-pois-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38" title="Abbildung&nbsp;21.34— Darstellung einer linearen Simulation mit einer normalverteilten Kovariaten sowie einem poissonverteilten Messwert. Einmal ist die Regressiongleichung für den linearen Gaussian Zusammenhang sowie für die Poissonregression dargestellt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-c1-pois-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-c1-pois-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.34— Darstellung einer linearen Simulation mit einer normalverteilten Kovariaten sowie einem poissonverteilten Messwert. Einmal ist die Regressiongleichung für den linearen Gaussian Zusammenhang sowie für die Poissonregression dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir können dann auch nochmal ein GLM rechnen und sehen, dass wir bei einer so hohen Fallzahl dann auch in einem GLM die passenden Effekte ungefähr herausbekommen. Ich nutze hier die Funktion <code>parameters()</code> aus dem gleichnamigen R Paket damit ich die Schätzer noch wieder zurücktransformieren kann. Auch hier findest du dann mehr in dem <a href="eda-distribution.html#sec-poisson">Kapitel zu der Poissonregression</a>. Ich fitte hier erstmal die passende Poissonregression.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>pois_c1_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> c_1, <span class="at">data =</span> cov1_pois_tbl, <span class="at">family =</span> poisson)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Danns schauen wir uns einmal die Koeffizienten der Poissonregression an. Wir sind hier hauptsächlich am Inzidenzratenverhältnis (eng <em>Incidence Rate Ratio</em>, abk. <em>IRR</em>) interessiert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>pois_c1_fit <span class="sc">|&gt;</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  parameters<span class="sc">::</span><span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   |   IRR |       SE |         95% CI |      z |      p
-----------------------------------------------------------------
(Intercept) | 12.96 |     0.33 | [12.34, 13.61] | 102.06 | &lt; .001
c 1         |  1.09 | 4.21e-03 | [ 1.08,  1.10] |  22.46 | &lt; .001</code></pre>
</div>
</div>
<p>Was sehen wir hier als Effekte? Wir rechnen hier das Inzidenzratenverhältnis aus. Das Inzidenzratenverhältnis beschreibt die multiplikative Änderung der erwarteten Rate, wenn sich die Kovariate um eine Einheit ändert. Das heißt hier in unserem Fall, dass wenn wir die Kovariate <span class="math inline">\(c_1\)</span> um eine Einheit erhöhen, dass unser Messwert um den Faktor <span class="math inline">\(1.09\)</span> ansteigt. Leider siehst du auch, dass wir es hier nicht mit einer linearen Modellierung zu tun haben. Daher kann ich dir das Inzidenzratenverhältnis einmal zwischen zwei Punkten mit <span class="math inline">\(c_1 = 6\)</span> und <span class="math inline">\(c_1 = 7\)</span> berechnen. Das Problem ist hier wirklich, dass wir es mit einem Faktor zu tun haben. Mehr dazu nochmal weiter unten im Kasten zu den Effekten in der Poissonregression und die Vingette <a href="https://kgoldfeld.github.io/simstudy/articles/logisticCoefs.html">Targeted logistic model coefficients</a> geht das Problem in <code>{simstudy}</code> nochmal an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>pois_c1_fit <span class="sc">|&gt;</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>)), <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2 
21.80644 23.78146 </code></pre>
</div>
</div>
<p>Jetzt können wir auch den Faktor zwischen den beiden Messwerten berechnen. Wie ändert sich also Multiplikativ der Messwert von <span class="math inline">\(c_1 = 6\)</span> zu <span class="math inline">\(c_1 = 7\)</span>? Dafür teilen wir dann die beiden Messwerte durcheinander und erhalten dann faktisch unser Inzidenzratenverhältnis aus dem obigen Modell.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fl">23.86757</span> <span class="sc">/</span> <span class="fl">21.72900</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.09842</code></pre>
</div>
</div>
<p>Jetzt können wir uns das Leben auch etwas einfacher machen und einmal die <a href="stat-modeling-marginal.html">Marginal effect models</a> mit dem R Paket <code>{marginaleffects}</code> nutzen um uns den Faktor zwischen den beiden Kovariatenwerten berechnen zu lassen. Das ist manchmal etwas schneller und auch einfacher durchzuführen. Darüber hinaus können wir eben dann nicht nur zwei Werte eingeben, sondern haben auch noch andere Möglichkeiten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(pois_c1_fit, <span class="at">comparison =</span> <span class="st">"ratio"</span>,</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">variables =</span> <span class="fu">list</span>(<span class="st">"c_1"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 Estimate Std. Error   z Pr(&gt;|z|)   S 2.5 % 97.5 %
     1.09    0.00421 259   &lt;0.001 Inf  1.08    1.1

Term: c_1
Type: response
Comparison: mean(7) / mean(6)</code></pre>
</div>
</div>
<p>Mehr zu den Möglichkeiten dann auch in der Vingette <a href="https://marginaleffects.com/chapters/comparisons.html#change-in-numeric-predictors">Change in numeric predictors</a> auf der Hilfeseite dem R Paket <code>{marginaleffects}</code>. Bei denen heißt dann die numerische Einflussvaraiable dann <em>numeric predictor</em>. Je nachdem wo man dann weiterliest ändern sich dann leider auch immer wieder die Begrifflichkeiten.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ein Wort zum Effekt in der Poissonregression
</div>
</div>
<div class="callout-body-container callout-body">
<p>In der Poissonregression kriegen wir als Effektschätzer das Risk Ratio wiedergegeben. Das ist also nicht ein absoluter Wert, wie die Steigung, sondern ein Faktor um den sich die Messwerte unterschieden. Wenn wir die Einheit der Kovariate von 0 auf 1 erhöhen, dann würden wir vom Messwert von 10 auf 12 springen. Das würde einen Faktor von <span class="math inline">\(12/10 = 1.2\)</span> ausmachen. Wenn wir jetzt aber unsere Kovariate von 1 auf 2 erhöhen, dann haben wir einen Messwert von 12 auf 14. Jetzt haben wir aber einen Faktor von <span class="math inline">\(14/12 = 1.17\)</span> vorliegen. Der Faktor sinkt mit dem Anstieg der Kovariate. Da der absolute Anstieg immer weniger Anteil am Messwert ausmacht. Ich zeige dir den Zusammenhang einmal in der folgenden Abbildung. Mit jedem Sprung wird der Faktor kleiner. Am Ende ist dann das Risk Ratio aus einer Poissonregression mehr oder minder das Mittel über alle Sprünge. Wirklich linear ist dann der Zusammenhang nur auf der Linkskala. Hier hilft dann die Lektüre von <span class="citation" data-cites="dormann2013parametrische">Dormann (<a href="#ref-dormann2013parametrische" role="doc-biblioref">2013</a>)</span> oder aber das <a href="eda-distribution.html#sec-poisson">Kapitel zu der Poissonregression</a> weiter. Die Vingette <a href="https://kgoldfeld.github.io/simstudy/articles/logisticCoefs.html">Targeted logistic model coefficients</a> geht das Problem in <code>{simstudy}</code> nochmal an.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-c1-pois-eff" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-c1-pois-eff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-c1-pois-eff-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39" title="Abbildung&nbsp;21.35— Darstellung des abnehmenden Risk Ratio über den Anstieg der Kovariate. Mit dem Anstieg der Kovariate nimmt der absolute Anstieg von +2 immer weniger Anteil an dem Messwert. Der Faktor des Anstiegs wird von \times1.2 zu \times1.07 immer kleiner. Das Risk Ratio (abk. RR) aus einer Poissonregression ist mehr oder minder der mittlere Faktor. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-c1-pois-eff-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-c1-pois-eff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.35— Darstellung des abnehmenden Risk Ratio über den Anstieg der Kovariate. Mit dem Anstieg der Kovariate nimmt der absolute Anstieg von <span class="math inline">\(+2\)</span> immer weniger Anteil an dem Messwert. Der Faktor des Anstiegs wird von <span class="math inline">\(\times1.2\)</span> zu <span class="math inline">\(\times1.07\)</span> immer kleiner. Das Risk Ratio (abk. <em>RR</em>) aus einer Poissonregression ist mehr oder minder der mittlere Faktor. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="zweikovariat-unabhängig-c_1-c_2-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweikovariat-unabhängig-c_1-c_2-1">Zweikovariat unabhängig <span class="math inline">\(c_1 + c_2\)</span></h4>
<p>Wir können natürlich auch mehrere Kovariaten vorliegen haben. Ich zeige hier dann einmal zwei Kovariaten, die einmal einer Normalverteilung und einmal einer Poissonverteilung entstammen. Wir müssen ja nicht nur normalverteilte Kovariaten vorliegen haben. Dann baue ich mir noch meinen poissonverteilten Messwert zusammen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>cov2_pois_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"c_1"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, <span class="at">formula =</span> <span class="st">"10"</span>,</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">variance =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"c_2"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>, <span class="at">formula =</span> <span class="st">"5"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>, <span class="at">formula =</span> <span class="st">"8 + 2 * c_1 + 1 * c_2"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann generiere ich mir auch schon meine zehntausend Beobachtungen. Ich werde das Ergebnis der Generierung nicht visualiseren, daher können wir hier auch einmal mit mehr Beobachtungen arbeiten und haben dann auch etwas genauere Schätzer der Effekte in den Modellen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>cov2_pois_tbl <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">10000</span>, cov2_pois_def)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Hier einmal das lineare Modell, dort sehen wir dann ob wir auch unsere eingestellten Effekte direkt wiedererhalten. Das ist natürlich jetzt nur so semi hilfreich, da wir ja auch schauen müssen wie denn die Werte in einem GLM aussehen würden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> c_2, <span class="at">data =</span> cov2_pois_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         c_1         c_2 
       7.58        2.02        1.04 </code></pre>
</div>
</div>
<p>Dafür passen wir einmal eine Poissonregression an und nutzen gleich einmal das Modell um uns die Inzidenzratenverhältnisse (eng <em>Incidence Rate Ratio</em>, abk. <em>IRR</em>) für die beiden Kovariaten berechnen zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>pois_c2_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> c_2, <span class="at">data =</span> cov2_pois_tbl, <span class="at">family =</span> poisson)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir können hier uns entweder die Koeffizienten einmal direkt über die Funktion <code>model_parameters()</code> wiedergeben lassen oder aber dann gleich einmal in der Funktionalität des R Pakets <code>{marginaleffects}</code>. Wir sehen hier, dass wir jeweils einen positiven Effekt haben. Mit steigenden Kovariaten erhöhen sich auch die Messwerte.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>pois_c2_fit <span class="sc">|&gt;</span> </span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  parameters<span class="sc">::</span><span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   |   IRR |       SE |         95% CI |      z |      p
-----------------------------------------------------------------
(Intercept) | 15.24 |     0.20 | [14.85, 15.64] | 206.38 | &lt; .001
c 1         |  1.06 | 1.31e-03 | [ 1.06,  1.07] |  49.55 | &lt; .001
c 2         |  1.03 | 7.93e-04 | [ 1.03,  1.03] |  40.19 | &lt; .001</code></pre>
</div>
</div>
<p>Dam Ende dann nochmal die multiplikative Änderung als Inzidenzratenverhältnis für die beiden Kovariaten an zwei definierten Werten für die jeweiligen Kovariaten. Wir sehen dann auch hier das es dann eben auch auf die Werte ankommt, die wir uns anssehen wollen. Wir können eben nicht so einfach die Steigung wieder als Risk Ratio sehen. Aber das ist eben dann auch der Unterschied zwischen einem absoluten Effekt wie der Steigung und dem Risk Ratio also Faktor. Damit werden wir leben müssen. Die Vingette <a href="https://kgoldfeld.github.io/simstudy/articles/logisticCoefs.html">Targeted logistic model coefficients</a> geht das Problem in <code>{simstudy}</code> nochmal an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(pois_c2_fit, <span class="at">comparison =</span> <span class="st">"ratio"</span>,</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">variables =</span> <span class="fu">list</span>(<span class="st">"c_1"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">11</span>),</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"c_2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 Term            Contrast Estimate Std. Error    z Pr(&gt;|z|)   S 2.5 % 97.5 %
  c_1 mean(11) / mean(10)     1.06   0.001310  811   &lt;0.001 Inf  1.06   1.07
  c_2 mean(6) / mean(5)       1.03   0.000793 1301   &lt;0.001 Inf  1.03   1.03

Type: response</code></pre>
</div>
</div>
</section>
<section id="multikovariat-abhängig-c_1-c_2-c_3-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="multikovariat-abhängig-c_1-c_2-c_3-1">Multikovariat abhängig <span class="math inline">\(c_1 + c_2 + c_3\)</span></h4>
<p>Eine multivariate Poissonverteilung ist nicht einfach zu bauen. Jedenfalls um so viel schwerer, dass eine gerundete multivariate Normalverteilung mit Korrelationsstruktur viel einfacher zu erstellen ist. Die Funktionalität in <code>{simstudy}</code> erlaubt auch multivariate korrelierte Poissondaten zu erstellen. Die Vingette <a href="https://kgoldfeld.github.io/simstudy/articles/correlated.html#correlated-data-additional-distributions">Correlated data: additional distributions</a> hilft hierbei. Ich zeige hier einmal die Variante der Poissonverteilung mit drei Kovariaten und einer konstanten Korrelation zwischen den Kovariaten von 0.3 als <em>compound symmetry (cs)</em> Korrelationsmatrix.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>cov2_dependent_dt <span class="ot">&lt;-</span> <span class="fu">genCorGen</span>(<span class="dv">1000</span>, <span class="at">nvars =</span> <span class="dv">3</span>, <span class="at">params1 =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>), <span class="at">dist =</span> <span class="st">"poisson"</span>, </span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">rho =</span> <span class="fl">0.3</span>, <span class="at">corstr =</span> <span class="st">"cs"</span>, <span class="at">wide =</span> <span class="cn">TRUE</span>,</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">cnames =</span> <span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>, <span class="st">"c_3"</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Im Folgenden siehst du dann einmal die Datentabelle der eintausend Beobachtungen. Wir haben die ID Spalte und dann die drei Kovariaten gefolgt von dem Messwert. Die beobachtete Korrelation ist dann 0.3 zwischen den Kovariaten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>cov2_dependent_dt</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Key: &lt;id&gt;
         id   c_1   c_2   c_3
      &lt;int&gt; &lt;num&gt; &lt;num&gt; &lt;num&gt;
   1:     1    15     8    20
   2:     2     7    17    13
   3:     3     9    13    16
   4:     4     8     9    16
   5:     5     8    12    17
  ---                        
 996:   996     6     8     3
 997:   997     4     8     6
 998:   998     7     6    13
 999:   999     6     8    11
1000:  1000    10     8    11</code></pre>
</div>
</div>
<p>In den rohen Daten ist die Korrelation faktisch nicht zu sehen. Jedenfalls kann ich sowas nicht erkennen. Dafür müssen wir uns dann einmal die Korrelation berechnen lassen. Wie wir dann im Folgenden einmal sehen, passt es sehr gut. Wir erhalten die Korrelationen wieder, die wir auch eingestellt haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(cov2_dependent_dt, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>, <span class="st">"c_3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">redundant =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Correlation Matrix (pearson-method)

Parameter |     c_1 |     c_2 |     c_3
---------------------------------------
c_1       |         | 0.30*** | 0.29***
c_2       | 0.30*** |         | 0.31***
c_3       | 0.29*** | 0.31*** |        

p-value adjustment method: Holm (1979)</code></pre>
</div>
</div>
<p>Wir können jetzt mit den korrelierten Kovariaten uns nochmal neue Messwerte erstellen. Hierbei bitte bachten, dass multiple Modelle Probleme kriegen, wenn die Kovariaten zu stark miteinander korreliert sind. Dazu dann aber mehr in dem <a href="stat-modeling-basic.html">Kapitel zu der multiplen Regression</a>.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/personal_opinion.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40"><img src="images/personal_opinion.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>“Brauchen wir das? Ein klares Jein. Ich finde korrelierte Daten eher sinnvoll in Zeitreihen und dann auch gerne mit einer auto-regressive Korrelationsstruktur. Ansonsten ist es sicherlich in der Theorie spannend, solche Daten zu erstellen.” — Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.</em></p>
</blockquote>
</div>
</div>
</div>
</section>
</section>
<section id="ordinalverteilt" class="level3" data-number="21.5.3">
<h3 data-number="21.5.3" class="anchored" data-anchor-id="ordinalverteilt"><span class="header-section-number">21.5.3</span> Ordinalverteilt</h3>
<p>Was sind ordinalverteilte Messwerte? Wir können diese Art von Messwerten einmal als Antwortmöglichkeiten bei einem Fragebogen oder aber bei der Bonitur beobachten. Bei Fragebögen haben wir dann meistens drei bis fünf Antwortkategorien, die dann eben auch geordnet sind. Alle Kategorien haben dabei den gleichen Abstand. Bei der Bonitur haben wir häufig eine fünf- bis neunstufige Likertskala vorliegen, wobei die Neun immer die stärkste Ausprägung beschreibt. Wenn du nur zwei Antwortmöglichkeiten vorliegen hast, dann bist du im binären Fall, das machen wir dann weiter unten nochmal. Das R Paket <code>{simstudy}</code> hat mit der Vingette <a href="https://kgoldfeld.github.io/simstudy/articles/ordinal.html">Ordinal Categorical Data</a> eine Hilfeseite, die dir einmal beschreibt, wie wir ordinale Messwerte erstellen. Neben dem R Paket gibt es auch noch andere Möglichkeiten. Wir haben in dem Blogeintrag <a href="https://www.rdatagen.net/post/can-empirical-mean-and-variance-data-inform-simulation-of-ordinal-response-variables/">A refined brute force method to inform simulation of ordinal response data</a> auch nochmal eine andere Sicht der Dinge. Hier simulieren wir aus mittlren Noten udn einer Standardabweichung dann die entsprechenden Daten.</p>
<p>Am Ende kannst du dir vorstellen, dass wir als Messwert wiederum einen Faktor vorliegen haben und eigentlich keinen numerischen Messwert. Wir wollen hier aber einmal verstehen, wie sich so ordinale Messwerte zusammensetzen. In den Agrarwissenschaften wird gerne eine 9er Likert Skala verwendet. Wir haben also ein Merkmal wie Blattfäule oder Befall und benoten nun mit einem 9er Notensystem. Das Problem ist nun, dass wir bei neun Noten natürlich auch jeder Ausprägung eine Wahrscheinlichkeit zuordnen müssen. Da werden dann die einzlenen Wahrscheinlichketen sehr klein. Darüber hinaus ist dann vermutlich eine Verschiebung der Noten zwischen den Gruppen auch sehr klein. Alles nicht so einfach. Am Ende ist das Verständnis der Datengenierung auch immer sehr hilfreich bei der Auswertung im <a href="stat-modeling-multinom.html">Kapitel zur Multinomialen / Ordinalen Regression</a>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Um jetzt irgendwas zu sehen, brauchen wir wirklich viele Fallzahlen. Wenn du später nur fünf Beobachtungen pro Gruppe hast, dann wird es sehr schwer die vorengestellten Gruppenwahrscheinlichkeiten wiederzufinden. Deshalb kann es sein, dass es beser ist, dir die Daten einfach per Hand selber in Excel zu bauen.</p>
</div>
</div>
</section>
<section id="faktorielles-design-3" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="faktorielles-design-3">Faktorielles Design</h3>
<p>Für die ordinalverteilten Daten nutzen wir jetzt hier hauptsächtlich das faktorielle Design. Wir nutzen hier dabei aber auch nur ein reduziertes Design zum Einstieg. Das hat den Grund, dass die Erstellung schon kompliziert genug ist und wir bei kleinen Fallzahlen später dann kaum noch was wieder erkennen. Daher wir stellen zwar Effekte ein, wollen aber nur so wenige Beobachtungen haben, dass wir die Effekte gar nicht wiedersehen. Dann können wir uns die Zahlen auch händisch in Excel zusammentippen. <span class="citation" data-cites="gambarota2024ordinal">Gambarota &amp; Altoè (<a href="#ref-gambarota2024ordinal" role="doc-biblioref">2024</a>)</span> geht in seiner Arbeit <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/ijop.13243">Ordinal regression models made easy: A tutorial on parameter interpretation, data simulation and power analysis</a> nochmal auf das faktorielle Design ein und zeigt auch, wie wir komplexere Modelle simulieren können.</p>
<section id="einfaktoriell-f_a-mit-2-leveln-3" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktoriell-f_a-mit-2-leveln-3">Einfaktoriell <span class="math inline">\(f_A\)</span> mit 2 Leveln</h4>
<p>Wir beginnen mit dem einfaktoriellen Modell mit zwei Leveln. Wir nutzen wieder das simple Modell um einmal die Herausforderungen zu verstehen. Wir haben es nämlich bei einem ordinalen Messwert mit etwas komplizierteren Daten zu tun. Beginnen wir mit einem ordinalen Messwert mit fünf Kategorien. Wir haben hier also eine Frage vorliegen mit fünf Antwortmöglichkeiten. Die Antwortmöglichkeiten sind <em>trifft gar nicht zu</em>, <em>trifft nicht zu</em>, <em>weder noch</em>, <em>trifft zu</em> und <em>trifft voll zu</em>. Jetzt kommt der eigentlich Twist. Wir haben diese Antwortmöglichkeiten ja in unterschiedlichen Häufigkeiten vorliegen. Wir haben also 100 Personen befragt und diese 100 Personen haben jeweils eine der Antwortmöglichkeiten auf die Frage geantwortet. Damit erhalten wir dann folgende hypothetische Verteilung der Antworten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>null_prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span> <span class="ot">=</span> <span class="fl">0.1</span>, </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"trifft nicht zu"</span> <span class="ot">=</span> <span class="fl">0.2</span>, </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"weder noch"</span> <span class="ot">=</span> <span class="fl">0.4</span>, </span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"trifft zu"</span> <span class="ot">=</span> <span class="fl">0.2</span>, </span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">"trifft voll zu"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir können hier nicht einfach einen Effekt aufaddieren um eien zweite Gruppe zu erschaffen. Wir können nicht die Wahrscheinlichkeiten einfach um <span class="math inline">\(+0.1\)</span> erhöhen, dann hätten wir ja in der Summe <span class="math inline">\(5 \times 0.1 = +0.5\)</span> erhöht. Wir brauchen aber eine Wahrschinlichkeit von Eins in Summe. Daher müssen wir von einigen Antwortmöglichkeiten etwas abziehen und bei anderen etwas aufaddieren. Die Änderungen müssen sich ja dann zu Null aufaddieren, wie du im folgenden Beispiel für eine alternative Gruppe siehst.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>alt_prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span> <span class="ot">=</span> <span class="fl">0.1</span> <span class="sc">-</span> <span class="fl">0.05</span>, </span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"trifft nicht zu"</span> <span class="ot">=</span> <span class="fl">0.2</span> <span class="sc">-</span> <span class="fl">0.1</span>, </span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"weder noch"</span> <span class="ot">=</span> <span class="fl">0.4</span> <span class="sc">-</span> <span class="fl">0.1</span>, </span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"trifft zu"</span> <span class="ot">=</span> <span class="fl">0.2</span> <span class="sc">+</span> <span class="fl">0.2</span>, </span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"trifft voll zu"</span> <span class="ot">=</span> <span class="fl">0.1</span> <span class="sc">+</span> <span class="fl">0.05</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir einmal für die beiden Gruppen dann die fünf Antwortmöglichkeiten mit den jeweiligen Wahrscheinlichkeiten erschaffen. Beachte, dass wir die Namen der Wahrscheinlichkeitsvektoren nicht mitschleifen und dann in der Genierung verlieren. Daher müssen wir dann den Messwert nochmal wieder als Faktor mutieren. Für die Darstellung ist es dann aber mit einem numerischen Messwert einfacher.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>ord_fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"A.1"</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> null_prob),</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"A.2"</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> alt_prob))  <span class="sc">|&gt;</span> </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"f_a"</span>, <span class="at">value =</span> <span class="st">"y"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y_fct =</span> <span class="fu">factor</span>(y, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span>, <span class="st">"trifft nicht zu"</span>, <span class="st">"weder noch"</span>,</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"trifft zu"</span>, <span class="st">"trifft voll zu"</span>)))</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>ord_fac1_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 200 × 3
   f_a       y y_fct              
   &lt;chr&gt; &lt;int&gt; &lt;fct&gt;              
 1 A.1       3 weder noch         
 2 A.1       3 weder noch         
 3 A.1       1 trifft gar nicht zu
 4 A.1       4 trifft zu          
 5 A.1       3 weder noch         
 6 A.1       1 trifft gar nicht zu
 7 A.1       3 weder noch         
 8 A.1       3 weder noch         
 9 A.1       2 trifft nicht zu    
10 A.1       5 trifft voll zu     
# ℹ 190 more rows</code></pre>
</div>
</div>
<p>Dann können wir uns einmal die Verteilungen der Antwortmöglichkeiten in den beiden Gruppen mit je einhundert Beobachtungen anschauen. Wie du siehst, sind die beiden Verteilungen ineinander verschoben. Dabei hat die zweite Gruppe mehr Antworten bei <em>trifft zu</em> und <em>trifft voll zu</em>. Daher muss die Anzahl der Antworten bei den negativen Antworten kleiner sein. Wie du dir vorstellen kannst, haben wir hier nicht so viel Raum um Veränderungen zu erreichen und dabei irgendiwe noch eine Verteilung zu sehen. Wenn sich alles auf einer Seite zusammenballt, dann haben wir auch schon fast keine Varianz mehr.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-ordinal-theo-sample" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-ordinal-theo-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-ordinal-theo-sample-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-41" title="Abbildung&nbsp;21.36— Histogramm der Verteilung der Antwortmöglichkeiten in einem einfaktoriellen Design mit zwei Gruppen. Die Häufigkeit der Antworten ist in den beiden Gruppen verschoben. Da die Summe der Antwortwahrscheinlichkeiten Eins sein muss und die Summe der Verschiebungen Null sein muss, ist die Verschiebung nicht trivial. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-ordinal-theo-sample-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-ordinal-theo-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.36— Histogramm der Verteilung der Antwortmöglichkeiten in einem einfaktoriellen Design mit zwei Gruppen. Die Häufigkeit der Antworten ist in den beiden Gruppen verschoben. Da die Summe der Antwortwahrscheinlichkeiten Eins sein muss und die Summe der Verschiebungen Null sein muss, ist die Verschiebung nicht trivial. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt ist es natürlich super nervig einen Vektor zu bauen, der die Verschiebungen der Antwortwahrscheinlichkeiten beschreibt. Insbesondere wenn wir viele Antwortmöglichkeiten oder Notenausprägungen haben. Dann wird es sehr schwierig und sehr kleinteilig. Daher ist eine Idee eine latente Variable zu generieren, die wir verschieben können und uns über einen Umweg dann die Wahrscheinlichkeiten für die Antwortmöglichkeiten wiedergibt. Das ist die Lösung in <code>{simstudy}</code>.</p>
<p>In der folgenden Abbildung habe ich dir einmal das Prinzip visualisiert. Unsere Antwortwahrscheinlichkeiten sind die Flächen unter der Kurve. Damit wir hier alles etwas besser sehen, habe ich mich auf vier Antwortmöglichkeiten beschränkt. Wir können jetzt die z-Werte auf der x-Achse verschieben und damit ändern sich auch die Flächen zwischen den z-Werten. Da die Flächen die Antwortwahrscheinlichkeiten sind, können wir hier einen Wert ändern und erhalten neue Wahrscheinlicheiten wieder. Dabei ist zu beachten, das die Verschiebung für alle Antworten in die gleiche Richtung und um den gleichen Effekt erfolgt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-ordinal-theo" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-ordinal-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-ordinal-theo-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42" title="Abbildung&nbsp;21.37— Darstellung der Idee der latenten Variable zur Generierung von ordnialen Daten. Die Fläche unter der Kurve stellt die Antwortwahrscheinlichkeit für vier Antworten dar. Wenn der z-Wert verschoben wird, dann ändert sich auch die Fläche und damit auch die Antwortwahrscheinlichkeiten. (A) Antwortverteilung für die Gruppe A.1 (B) Verschobene Antwortverteilung um +0.7 für die Gruppe A.2. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-ordinal-theo-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-ordinal-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.37— Darstellung der Idee der latenten Variable zur Generierung von ordnialen Daten. Die Fläche unter der Kurve stellt die Antwortwahrscheinlichkeit für vier Antworten dar. Wenn der z-Wert verschoben wird, dann ändert sich auch die Fläche und damit auch die Antwortwahrscheinlichkeiten. <strong>(A)</strong> Antwortverteilung für die Gruppe <span class="math inline">\(A.1\)</span> <strong>(B)</strong> Verschobene Antwortverteilung um <span class="math inline">\(+0.7\)</span> für die Gruppe <span class="math inline">\(A.2\)</span>. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Natürlich ist das etwas zu schön um wahr zu sein. Wir haben hier eine ziemlich strenge Annahme getroffen. Durch die Verschiebung durch ein festes <span class="math inline">\(z\)</span> gleich <span class="math inline">\(+0.7\)</span> haben wir die Annahme an ein proportionales Wahrscheinlichkeitsmodell getroffen. Wir verschieben eben alle Antwortmöglichkeiten gleichmäßig um den gleichen Wert nach rechts. Die Richtung und auch die Effektstärke ist für alle Antwortmöglichkeiten gleich.</p>
<dl>
<dt>Proportionales Wahrscheinlichkeitsmodell</dt>
<dd>
<p>Was will und das Proportionales Wahrscheinlichkeitsmodell (eng. <em>proportional odds model</em>) sagen? Wenn wir die Wahrscheinlichkeiten der Antworten verschieben, dann verschieben wir in die gleiche Richtung und um den gleichen Wert. Alle Antwortwahrscheinlichkeiten verhalten sich gleich und dementsprechend proportional.</p>
</dd>
</dl>
<p>Wir können jetzt in <code>{simstudy}</code> beide Varianten durchführen. Wir können also einmal davon ausgehen, dass wir den gleichen Effekt in die gleiche Richtung für alle Antwortwahrscheinlichkeiten vorliegen haben. Wir rechnen dann mit der <em>Proportional odds</em> Annahme. Wir können aber auch den Fall vorliegen haben, dass wir die Antwortwahrscheinlichkeiten individuell verschieben. Dann haben wir die Annahme der <em>Non-proportional odds</em> getroffen. Ich zeige dir dann weiter unten einmal die Durchführung in <code>{simstudy}</code> und wie wir dann die zufälligen ordinalen Werte erhalten.</p>
<p>Wir wollen aber erstmal damit anfangen ein Nullmmodell zu bauen. Daran können wir dann nochmal besser die latente Variable <span class="math inline">\(z\)</span> verstehen. Später ist es eigentlich nur eine kleine Anpassung zwischen <em>proportional odds</em> und <em>non-proportional odds</em>. Als erstes brauchen wir daher wieder einmal unser Klassenwahrscheinlichkeiten für unser Nullmodell oder eben wie wahrscheinlich tritt eine der Antwortkategorien auf. Später können wir dann noch einen Effekt zu dieses Nullmodell hinzufügen. Um die Sache etwas zu vereinfachen habe ich hier nur vier Antwortmöglichkeiten gewählt und die entsprechenden Wahrscheinlichkeiten festgelegt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>null_prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span> <span class="ot">=</span> <span class="fl">0.31</span>, </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"trifft nicht zu"</span> <span class="ot">=</span> <span class="fl">0.29</span>, </span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>               <span class="st">"trifft zu"</span> <span class="ot">=</span> <span class="fl">0.2</span>, </span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">"trifft voll zu"</span> <span class="ot">=</span> <span class="fl">0.2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt brauchen wir noch unsere latente Variable <span class="math inline">\(z\)</span> um unseren Wahrscheinlichkeiten in feste Werte zu übersetzen. In der folgenden Abbildung siehst du dann einmal den Logit der Wahrscheinlichkeiten. Der Logit beschreibt die Wahrscheinlichkeiten als logarithmierte Chancen. Das klingt jetzt etwas wild, aber wir transformieren im Prinzip die Flächen so, dass wir dann die Wahrscheinlichkeiten der Antwortzugehörigkeit auch durch die x-Werte beschreiben können.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-ordinal-theo-sample-anno" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-ordinal-theo-sample-anno-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-ordinal-theo-sample-anno-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43" title="Abbildung&nbsp;21.38— Zusammenhang zwischen der latenten Variable z als logit und der Antwortwahrscheinlichkeiten. Die Flächen als Wahrscheinlichkeiten werden durch den Logit auf der x-Achse dargestellt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-ordinal-theo-sample-anno-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-ordinal-theo-sample-anno-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.38— Zusammenhang zwischen der latenten Variable <span class="math inline">\(z\)</span> als logit und der Antwortwahrscheinlichkeiten. Die Flächen als Wahrscheinlichkeiten werden durch den Logit auf der x-Achse dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Was ist die Logitfunktion einmal mathematisch? In der folgenden Formel siehst du einmal den Zusammenhang. Der Logit einer Wahrscheinlichkeit <span class="math inline">\(Pr\)</span> ist das logarithmierte Chancenverhältnis. Damit können wir Wahrscheinlichkeiten in feste Werte überstetzen, die wir dann durch Addition oder Subtraktion verschieben können. Auf der x-Achse können wir ja schieben, die Flächen ändern sich dann automatisch.</p>
<p><span class="math display">\[
\text{logit}(Pr) = log\left(\cfrac{Pr}{1-Pr}\right)
\]</span></p>
<p>In dem Fall der ordinalen Messwerte ist es nochmal einen kleinen Schritt komplizierter, da wir immer die kummulierten Wahrscheinlichkeiten für die latente Variable brauchen. In den folgenden Tabs siehst du dann einmal den Weg um die drei Grenzwerte aus der obigen Abbildung zu berechnen. Wir haben vier Antwortmöglichkieten mit vier Wahrscheinlichkeiten, also brauchen wir dann drei Grenzwerte als latente Variable.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true"><em>trifft gar nicht zu</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false"><em>trifft nicht zu</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false"><em>trifft zu</em></a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p><span class="math display">\[
log \left(\cfrac{Pr(A.1 \leq  1)}{Pr(A.1 &gt; 1)} | A.1 \right) = log \left(\cfrac{Pr(0.31)}{Pr(1-0.31)}\right) = -0.80
\]</span></p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p><span class="math display">\[
log \left(\cfrac{Pr(A.1 \leq  2)}{Pr(A.1 &gt; 2)} | A.1 \right) = log \left(\cfrac{Pr(0.31 + 0.29)}{Pr(1-0.31-0.29)}\right) = 0.4
\]</span></p>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<p><span class="math display">\[
log \left(\cfrac{Pr(A.1 \leq  3)}{Pr(A.1 &gt; 3)} | A.1 \right) = log \left(\cfrac{Pr(0.31 + 0.29 + 0.20)}{Pr(1-0.31-0.29-0.20)} \right) = 1.38 \approx 1.4
\]</span></p>
</div>
</div>
</div>
<p>Natürlich gibt es auch hier eine Implementierung in R. Leider sind die Namen der Funktionen nicht so eingängig wie es sein könnte. Oder andersherum, die R Entwickler wollten keine Doppelungen. Manchmal machen aber Doppelungen Sinn, da wir dann die Namen im Kontext besser zuordnen können. Der Blogeintrag <a href="https://ro-che.info/articles/2018-08-11-logit-logistic-r">logit() and logistic() functions in R</a> geht da nochnmal genauer drauf ein. Hier können wir dann einmal die Wahrscheinlichkeiten aufsummieren und dann die <code>qlogis()</code> Funktion als Logitfunktion nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qlogis</span>(<span class="fu">cumsum</span>(null_prob))[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>trifft gar nicht zu     trifft nicht zu           trifft zu 
              -0.80                0.41                1.39 </code></pre>
</div>
</div>
<p>Wir sehen, dass es passt. Die sich ergebenden Werte sind die gleichen Werte, die wir auch schon oben in der Abbildung auf der x-Achse haben. Es ist also etwas von hinten durch die Brust, aber am Ende haben wir verstanden, woher die Werte jeweils kommen.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Der <span class="math inline">\(\text{logit}()\)</span> und die Umkehrfunktion <span class="math inline">\(\text{invlogit}()\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Und wie kommen wir wieder zurück? Was ist also die Umkehrfunktion einer <span class="math inline">\(\text{logit}()\)</span>-Funktion? Das ist die <span class="math inline">\(\text{logistic}()\)</span>-Funktion oder aber eben die <span class="math inline">\(\text{invlogit}()\)</span>-Funktion für <em>inverted</em>. In unserem Fall können wir hier die Funktion <code>plogis()</code> nutzen. Wir erhalten dann die aufsummierten Wahrscheinlichkeiten. Da wir nur die Wahrscheinlichkeiten zwischen den Grenzen erhalten, müssen wir noch die Null und die Eins ergänzen. Dann rechnen wir noch die Differenz aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">plogis</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.8</span>, <span class="fl">0.4</span>, <span class="fl">1.4</span>)), <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">diff</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.31 0.29 0.20 0.20</code></pre>
</div>
</div>
<p>Wie wir sehen, kommen dann die Antwortwahrscheinlichkeiten unseres Nullmodells wieder heraus. Das klappt ja super. Solange ich nicht die Funktion gefunden habe, die mir in R intern die Wahrscheinlichkeiten aus Logits ausrechnet, schreibe ich mir die Funktion hier einmal selber.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>logodds_to_prob <span class="ot">&lt;-</span> \(logodds) {</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">plogis</span>(logodds), <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">diff</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">unname</span>()</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Und dann einmal testen, ob die Funktion auch funktioniert. Dafür können wir dann einfach den Vektor der Logitwerte in die Funktion stecken und uns die Wahrscheinlichkeiten wiedergeben lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logodds_to_prob</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.8</span>, <span class="fl">0.4</span>, <span class="fl">1.4</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.31 0.29 0.20 0.20</code></pre>
</div>
</div>
<p>Wunderbar, dann können wir die Funktion hier auch weiter verwenden. Ich nutze gleich mal die Funktion um uns die Antwortwahrscheinlichkeiten nach der Addierung eines Effekts zu berechnen.</p>
</div>
</div>
<p>Jetzt können wir uns auch schon unsere Daten in <code>{simstudy}</code> erstellen. Wir rechnen dann mit der <em>Proportional odds</em> Annahme in dem ersten Tab. Wir können aber auch den Fall vorliegen haben, dass wir die Antwortwahrscheinlichkeiten individuell verschieben. Dann haben wir die Annahme der <em>Non-proportional odds</em> getroffen. Ich würde aus Gründen der Einfachheit immer die <em>Proportional odds</em> Annahme wählen. Hier siehst du dann gleich wie sich die latente Variable <span class="math inline">\(z\)</span> als Logit dann über einen Effekt verschiebt.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true"><em>Proportional odds</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false"><em>Non-proportional odds</em></a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>Jetzt können wir uns die Daten bauen. Hier kommt ein wichtiges Achtung. Wir müssen immer mit einem <span class="math inline">\((-1)\cdot z\)</span> in der Datengenierung rechnen. Da wir in unserem Beispiel die latente Variable um <span class="math inline">\(+0.7\)</span> verschieben wollen, tragen wir in die Formel unten ein <span class="math inline">\(-0.7\)</span> ein. Ja, das ist etwas nervig, hat aber mit dem Logit und dem Algorithmus dahinter zu tun. Wir leben damit und bauen uns entsprechend die Daten. Der Faktor ist hier einfaktoriell mit zwei Leveln. Das mache ich über <code>1:1</code>. Wir spezifizieren hier das Verhältnis der beiden Gruppen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>ord_fac1_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"f_a"</span>, <span class="at">formula =</span> <span class="st">"1;1"</span>, <span class="at">dist =</span> <span class="st">"trtAssign"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"z"</span>, <span class="at">formula =</span> <span class="st">"-0.7*f_a"</span>, <span class="at">dist =</span> <span class="st">"nonrandom"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann bauen wir uns einmal ganz viele Beobachtungen. Später ziehe ich dann zufällig ein kleineres Set an Beobachtungen für unsere simulierten Daten. Bis jetzt haben wir aber nur die latente Avriable und die Gruppen definiert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>ord_fac1_pre_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">25000</span>, ord_fac1_def) <span class="sc">|&gt;</span> </span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A.1"</span>, <span class="st">"A.2"</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt ergänzen wir noch die ordinalen Messwerte als Spalte <code>antwort</code>. Dafür müssen wir jetzt sagen, was die latente Variable mit <code>adjVar</code> ist. Dann noch die Antwortwahrscheinlichkeiten ergänzen und schon können wir uns die Daten erstellen. Ich erstetze dann noch die Level des ordinalen Messwert mit den Antwortkategorien.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>ord_fac1_dt <span class="ot">&lt;-</span> <span class="fu">genOrdCat</span>(ord_fac1_pre_dt, <span class="at">adjVar =</span> <span class="st">"z"</span>, null_prob, <span class="at">catVar =</span> <span class="st">"antwort"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">antwort =</span> <span class="fu">factor</span>(antwort, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span>, <span class="st">"trifft nicht zu"</span>,</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">"trifft zu"</span>, <span class="st">"trifft voll zu"</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt können wir uns für jede Gruppe jeweils fünf Beobachtungen ziehen. Auch hier machen so wenige Beobachtungen kaum Sinn. So ist aber die Ausgabe schön klein und du kannst dann später mehr Beobachtungen ziehen. Dafür dann einfach die <code>5</code> mit einer höhren Zahl versehen und mehr Beobachtungen generieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>ord_fac1_dt <span class="sc">|&gt;</span> </span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(f_a) <span class="sc">|&gt;</span> </span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">5</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
# Groups:   f_a [2]
      id f_a       z antwort            
   &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;fct&gt;              
 1 20108 A.1     0   trifft zu          
 2 20399 A.1     0   trifft gar nicht zu
 3 17044 A.1     0   trifft nicht zu    
 4 16156 A.1     0   trifft gar nicht zu
 5 22539 A.1     0   trifft gar nicht zu
 6  6490 A.2    -0.7 trifft nicht zu    
 7 17412 A.2    -0.7 trifft gar nicht zu
 8 19404 A.2    -0.7 trifft zu          
 9 12519 A.2    -0.7 trifft gar nicht zu
10  5976 A.2    -0.7 trifft nicht zu    </code></pre>
</div>
</div>
<p>Dann schauen wir nochmal, ob wir dann auch die Werte für die Logits auf der x-Achse für das Nullmmodell im Level <span class="math inline">\(A.1\)</span> wiederfinden. Der Weg ist etwas kompliziert, aber dafür funktioniert er gut. Da wir hier ein <code>{data.table}</code> Objekt vorliegen haben, können wir in den eckigen Klammern etwas mehr Voodoo betreiben. Wir kriegen jetzt die drei Grenzwerte für die vier Antwortmöglichkeiten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>logOdds_A1 <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(<span class="fu">cumsum</span>(ord_fac1_dt[f_a <span class="sc">==</span> <span class="st">"A.1"</span>, <span class="fu">prop.table</span>(<span class="fu">table</span>(antwort))]))[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>logOdds_A1 <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>trifft gar nicht zu     trifft nicht zu           trifft zu 
              -0.79                0.40                1.40 </code></pre>
</div>
</div>
<p>Dann noch schauen, ob die Logits dann auch in den Wahrscheinlichkeiten stimmen. Also kriegen wir die Nullmodell wahrscheinlichkeiten wieder? Anscheinend klappt das auch gut. Die Wahrscheinlichkeiten weichen etwas ab, da wir ja auch hier mit generierten Daten arbeiten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logodds_to_prob</span>(logOdds_A1)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.31 0.28 0.20 0.20</code></pre>
</div>
</div>
<p>Wir haben dann ja die einen Effekt von <span class="math inline">\(+0.7\)</span> für die latente Variable <span class="math inline">\(z\)</span> eingestellt und damit auch die Logits verschoben. Das kommt auch ungefähr hin. Auch hier kriegen wir dann die drei Grenzwerte für die vier Antwortmöglichkeiten wiedergegeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>logOdds_A2 <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(<span class="fu">cumsum</span>(ord_fac1_dt[f_a <span class="sc">==</span> <span class="st">"A.2"</span>, <span class="fu">prop.table</span>(<span class="fu">table</span>(antwort))]))[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>logOdds_A2 <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>trifft gar nicht zu     trifft nicht zu           trifft zu 
              -0.10                1.09                2.09 </code></pre>
</div>
</div>
<p>Jetzt wird es spannend, da wir uns jetzt einmal anschauen können welche Wahrscheinlichkeiten für die Antwortkategorien entstehen, wenn wir um <span class="math inline">\(z+0.7\)</span> verschieben. Wir ändern ja nicht die Wahrscheinlichkeiten für die Antwortmöglichkeiten direkt sondern eben den Logit.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logodds_to_prob</span>(logOdds_A2)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.48 0.27 0.14 0.11</code></pre>
</div>
</div>
<p>Am Ende summiert sich alles auf Eins auf und wir haben eben eine Änderung in den Wahrscheinlichkeiten. Die Gruppen verschieben sich und wir haben dann eben auch andere Wahrscheinlichkeiten für die Antworten. Jetzt kannst du spielen, wie stark du den Effekt möchtest.</p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<p>Jetzt können wir alles nochmal so bauen, dass wir keinen konstanten Shift von <span class="math inline">\(+0.7\)</span> auf der Logitskala haben, sondern eben einen Shift für jede Antwortkategorie. Mehr dazu dann auch im Blogeintrag <a href="https://www.rdatagen.net/post/2022-01-25-simstudy-update-ordinal-data-without-the-proportionality-assumption/">simstudy update: ordinal data generation that violates proportionality</a>. Wir brauchen dann wieder unser einfaktorielles Design mit der latenten Variable. Wir geben hier dann keinen Shift an, da wir ja gleich individuelle Shifts in der Antwortkategorien haben wollen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>ord_fac1_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"f_a"</span>, <span class="at">formula =</span> <span class="st">"1;1"</span>, <span class="at">dist =</span> <span class="st">"trtAssign"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"z"</span>, <span class="at">formula =</span> <span class="st">"0"</span>, <span class="at">dist =</span> <span class="st">"nonrandom"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann einmal die Daten mit der latenten Variable genieren. Aktuell brauchen wir die latente Variable <span class="math inline">\(z\)</span> nur als einen Platzhalter.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>ord_fac1_pre_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">25000</span>, ord_fac1_def) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann legen wir die individuellen Shifts für die Antwortkategorien fest. Hier ist nochmal wichtig, dass der letzte Wert eine Null ist. Wir verschieben ja nur drei Grenzwerte für die vier Antwortkategorien. Die Funktionen brauchen aber einen entsprechend langen Vektor.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>shift_z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.0</span>, <span class="sc">-</span><span class="fl">1.7</span>, <span class="dv">0</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns auch schon die Daten zusammenbauen und nutzen die Option <code>npAdj</code> um unsere individuellen Verschiebungen in den <span class="math inline">\(z\)</span>-Werten anzugeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>ord_fac1_nonprop_dt <span class="ot">&lt;-</span> <span class="fu">genOrdCat</span>(ord_fac1_pre_dt, <span class="at">baseprobs =</span> null_prob, <span class="at">adjVar =</span> <span class="st">"z"</span>,</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">catVar =</span> <span class="st">"antwort"</span>, <span class="at">npVar =</span> <span class="st">"f_a"</span>, <span class="at">npAdj =</span> shift_z) <span class="sc">|&gt;</span> </span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">antwort =</span> <span class="fu">factor</span>(antwort, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span>, <span class="st">"trifft nicht zu"</span>,</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">"trifft zu"</span>, <span class="st">"trifft voll zu"</span>)),</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A.1"</span>, <span class="st">"A.2"</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir können dann wie schon in dem ersten Tab einmal unsere kleinere Stichprobe aus den Daten hier ziehen. Am Ende ist die Frage, ob wir sowas überhaupt brauchen, wenn wir uns Spieldaten für die Analyse erstellen wollen. Es ist sehr schwer auf dem Logit die Verschiebungen nachzuvollziehen. Daher würde ich es bei den <em>Proportional odds</em> belassen. Es ist aber eine nette Fingerübung für das Verständnis. Die Verschiebung um einen festen Wert in den Antwortkategorien ist auch eine starke Annahme.</p>
</div>
</div>
</div>
<p>Dann stellt sich noch die Frage, ob wir denn auch die voreingestellten Parameter wieder aus einer ordinalen Regression herausbekommen. Dafür nutzen wir die folgende Formel. Dabei ist wichtig, dass wir eben hier auch das Minus sehen, was wir oben bei der Erstellung der Daten beachten mussten. Der Effekt ist ja die Verschiebung um <span class="math inline">\(+0.7\)</span> durch die latente Variable. Wir sehen dann aber hier den Schätzer <span class="math inline">\(\beta\)</span> für den Effekt mit einem Minuszeichen versehen. So ist eben der Algorithmus und die Modellierung. Wir wollen hier in der Formel den Effekt für das zweite Level <span class="math inline">\(A.2\)</span> bestimmen. Wir haben vier Antwortkategorien, also erhalten wir dann drei Grenzwerte <span class="math inline">\(i\)</span> aus dem ordinalen Modell zurück.</p>
<p><span class="math display">\[
log \left(\cfrac{Pr(Antwort \leq  i)}{Pr(Antwort &gt; i)} | f_A \right) = \alpha_i - \beta*I(f_A=A.2)  \ , \ i \in \{1, 2, 3\}
\]</span></p>
<p>Wir nutzen jetzt gleich die Funktion <code>clm()</code> aus dem R Paket <code>{ordinal}</code> für die Analyse der Daten. In diesem Zusammenhang möchte ich nochmal auf die Arbeit von <span class="citation" data-cites="gambarota2024ordinal">Gambarota &amp; Altoè (<a href="#ref-gambarota2024ordinal" role="doc-biblioref">2024</a>)</span> mit dem Titel <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/ijop.13243">Ordinal regression models made easy: A tutorial on parameter interpretation, data simulation and power analysis</a> verweisen. Hier geht es ja erstmal nur kurz darum zu schauen, ob wir die voreingestellten Werte auch wiederfinden. Die ordinale Regression hat ja noch ihr eigenes Kapitel. Wir bauen uns also das Modell wie folgt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>clmFit <span class="ot">&lt;-</span> <span class="fu">clm</span>(antwort <span class="sc">~</span> f_a, <span class="at">data =</span> ord_fac1_dt)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns auch schon die Zusammenfassung des Modells angeben lassen. Ich nutze hier nur die <code>coef()</code> Funktion, da ich nicht an p-Werten oder anderem interessiert bin. Dafür würde dann die <code>summary()</code> gebraucht. Da wir ja auf den vollen Daten rechnen, kommt hier auch was passendes raus. Aber auch hier haben wir dann eine leichte Abweichung, was eben dann auch bei generierten Daten vorkommen kann.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>clm_coef <span class="ot">&lt;-</span> clmFit <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>clm_coef </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>trifft gar nicht zu|trifft nicht zu           trifft nicht zu|trifft zu 
                              -0.79                                0.40 
           trifft zu|trifft voll zu                              f_aA.2 
                               1.40                               -0.69 </code></pre>
</div>
</div>
<p>Damit ist der z-Wert mit <span class="math inline">\((-1) \cdot -0.69 \approx +0.7\)</span> gut getroffen. Die Antwortwahrscheinlichkeiten sind auf dem Logit eben um 0.7 verschoben. Dann erhalten wir noch die Grenzwerte wieder, die wir dann auch nochmal in die entsprechenden Wahrscheinlichkeiten der Antworten umrechnen können. Hier brauchen wir dann natürlich nur die ersten drei Werte der Koeffizienten auswählen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logodds_to_prob</span>(clm_coef[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.31 0.29 0.20 0.20</code></pre>
</div>
</div>
<p>Passt doch alles super. Wir erhalten die voreingestellten Wahrscheinlichkeiten unseres Nullmodells wieder. Dann noch die Verschiebung durch den z-Wert auch korrekt wiedergegeben. Damit haben wir dann die Grundlagen gut verstanden. Wir können jetzt nochmal etwas komplexere Modelle angehen.</p>
</section>
<section id="einfaktoriell-f_a-mit-2-leveln-4" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktoriell-f_a-mit-2-leveln-4">Einfaktoriell <span class="math inline">\(f_A\)</span> mit &gt;2 Leveln</h4>
<p>Wenn du jetzt mehr Levle oder Gruppen in deinen Faktor simulieren willst, dann kannst du einfach in der Option <code>formula</code> mehr Gruppen durch das Semikolon <code>;</code> getrennt erschaffen. Wenn du immer eine <code>1</code> schreibst, dann haben alle die gleiche Gruppengröße. Je mehr Faktoren du hast, desto kleiner sollte natürlich der Effekt der latenten Variable sein.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>ord_fac1_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"f_a"</span>, <span class="at">formula =</span> <span class="st">"1;1;1"</span>, <span class="at">dist =</span> <span class="st">"trtAssign"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"z"</span>, <span class="at">formula =</span> <span class="st">"-0.7*f_a"</span>, <span class="at">dist =</span> <span class="st">"nonrandom"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann brauchen wir wieder die Daten einmal aus denen wir dann gleich die Stichprobe ziehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>ord_fac1_pre_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">25000</span>, ord_fac1_def)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Im Folgenden musst du nur einmal darauf achten, dass du dann auch mehr Level hast und dann eben auch mehr Labels vergeben musst. Hier habe ich ja dann drei Level also muss ich auch drei Level vergeben. Ich übernehme hier einmal die Antwortwahrscheinlichkeiten <code>null_prob</code> aus der obigen Erstellung der Daten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>ord_fac1_dt <span class="ot">&lt;-</span> <span class="fu">genOrdCat</span>(ord_fac1_pre_dt, <span class="at">adjVar =</span> <span class="st">"z"</span>, null_prob, <span class="at">catVar =</span> <span class="st">"antwort"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">antwort =</span> <span class="fu">factor</span>(antwort, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span>, <span class="st">"trifft nicht zu"</span>,</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">"trifft zu"</span>, <span class="st">"trifft voll zu"</span>)),</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A.1"</span>, <span class="st">"A.2"</span>, <span class="st">"A.3"</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns wieder die Stichprobe ziehen. Damit hier die Ausgabe nicht so groß ist, habe ich dann nur drei Beobachtungen pro Gruppe gezogen. Das macht natürlich nur begrenz Sinn. Wie du auch schon siehst, kommen dann kaum Antwortmöglichkeiten vor.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>ord_fac1_dt <span class="sc">|&gt;</span> </span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(f_a) <span class="sc">|&gt;</span> </span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
# Groups:   f_a [3]
     id f_a       z antwort            
  &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;fct&gt;              
1 22520 A.1    -0.7 trifft nicht zu    
2 11135 A.1    -0.7 trifft nicht zu    
3 23279 A.1    -0.7 trifft nicht zu    
4 16935 A.2    -1.4 trifft gar nicht zu
5 13301 A.2    -1.4 trifft gar nicht zu
6 16797 A.2    -1.4 trifft voll zu     
7 18126 A.3    -2.1 trifft nicht zu    
8  4947 A.3    -2.1 trifft gar nicht zu
9 15494 A.3    -2.1 trifft gar nicht zu</code></pre>
</div>
</div>
<p>Somit haben wir dann auch die Möglichkeit mehr Gruppen zu simulieren. Hier musst du dann immer schauen, dass der Effekt nicht zu groß wird. Sonst schiebst du den letzten Faktor zu weit nach rechts in der Verteilung und es bleibt keine Fläche mehr als Wahrscheinlichkeit übrig. Das ist immer so eien Sache bei den ordinalen Messwerten. Wir sind eben beschränkt in beide Seiten.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Oder doch die Binomialverteilung?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Eine weitere Möglichkeit sich ordinale Messdaten zu generieren ist die Binomialverteilung. Hier können wir auswählen, wie viele Ausprägungen wir in dem Messwert haben wollen. Hierbei ist aber anzumerken, dass wir die Varianz nicht steuern können. Wir legen mehr oder minder den Mittelwert fest und dann ergibt sich der Rest. Also was ist die mittlere Note und dann streuen die Werte mit einem fixen Wert um den Mittelwert. Wir bauen uns hier auch erstmal wieder unser Faktorenraster um es dann mit den binomiaen Daten zu ergänzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>fac1_dt <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Hier kommt dann die Besonderheit. Wir legen mit der Option <code>variance</code> die Anzahl an Ausprägungen in unserem Messwert fest. Wir wollen hier neuen Noten simulieren, also legen wir den Wert der Varianz auf acht, da wir mit der Null beginnen zu zählen. Wir haben dann einen Effekt von <span class="math inline">\(+0.2\)</span> in dem Faktor vorliegen. Der Effekt muss zwischen <span class="math inline">\(0\)</span> und <span class="math inline">\(1\)</span> liegen oder andersherum, am Ende dürfen keien Werte größer als Eins in der <code>formula</code> entstehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>y_binom_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"bonitur"</span>, <span class="at">formula =</span> <span class="st">"0 + 0.2 * f_a"</span>,</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dist =</span> <span class="st">"binomial"</span>, <span class="at">variance =</span> <span class="dv">8</span>, <span class="at">link =</span> <span class="st">"identity"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann ergänzen wir einmal den Faktorenraster um die Datendefinition und erhöhen einmal die Bonitur um einen Wert, damit wir dann die Noten auch von Null bis Neun vorliegen haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>binom_fac1_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(y_binom_def, fac1_dt) <span class="sc">|&gt;</span> </span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bonitur =</span> bonitur <span class="sc">+</span> <span class="dv">1</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns die Daten auch einmal als Tabelle anschauen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>binom_fac1_dt <span class="sc">|&gt;</span> </span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(f_a, bonitur) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> f_a   1   2   3   4   5   6   7  8  9
   1 178 339 271 144  59   8   0  1  0
   2  15  85 204 306 213 130  39  7  1
   3   0   2  36 127 236 268 217 95 19</code></pre>
</div>
</div>
<p>Wir sehen hier also ganz gut, wie sich die Noten um eine mittlere Note gruppieren und dann eben streuen. Wir können die Streuung nicht anpassen, so dass hier eventuell nicht das rauskommt, was wir möchten. Eine Alternative ist es aber allemal und daher hier einmal erwähnt.</p>
</div>
</div>
</section>
</section>
<section id="mehrfaktorielles-design" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="mehrfaktorielles-design">Mehrfaktorielles Design</h3>
<p>Ich lasse hier auch einmal das mehrfaktorielle Design offen. Zwar liegt mit <span class="citation" data-cites="gambarota2024ordinal">Gambarota &amp; Altoè (<a href="#ref-gambarota2024ordinal" role="doc-biblioref">2024</a>)</span> und der Arbeit <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/ijop.13243">Ordinal regression models made easy: A tutorial on parameter interpretation, data simulation and power analysis</a> R Code vor, den du nutzen kannst um auch komplexere ordinale Daten zu modellieren, aber ist der R Code nur über <a href="https://github.com/shared-research/ordinalsim">GitHub | <code>{ordinalsim}</code></a> zu erreichen. Das Laden ist aber etwas komplizierter und am Ende ist die Frage, ob wir das auch wollen. Du kannst dir gerne die Arbeit anschauen. Wir machen hier einmal für das Erste Schluss.</p>
</section>
<section id="kovariates-design-3" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="kovariates-design-3">Kovariates Design</h3>
<p>Machen wir es kurz, wir betrachten hier nicht ein kovariates Design mit einem ordinalen Messwert. Das ergibt für mich keinen wirklichen Sinn. Theoretisch könnten wir eine Kovariate messen und dann schauen, wie sich der ordinale Messwert ändert, aber das würde ich dann eher als Gaussian linear Regression modellieren. Wir nehmen also einfach die mittleren Noten. Das würde dann reichen. Hier jetzt noch für Kovariaten die ordinale Messwerte zu generieren ist zu wild.</p>
</section>
<section id="binomialverteilt" class="level3" data-number="21.5.4">
<h3 data-number="21.5.4" class="anchored" data-anchor-id="binomialverteilt"><span class="header-section-number">21.5.4</span> Binomialverteilt</h3>
<p>Kommen wir am Ende noch zu einem binären Messwert oder auch <span class="math inline">\(0/1\)</span>-Daten. Binäre Messwerte sind Messwerte, die nur zwei Gruppen beinhalten. Daher ist die Pflanze gesund (<span class="math inline">\(y = 0\)</span>) oder krank (<span class="math inline">\(y = 1\)</span>). Wir haben also keine kontinuierlichen Messwerte vorliegen sondern eben nur zwei Kategorien. Wir nennen es dann auch gerne zwei Klassen und damit wäre auch schonmal erklärt, warum wir binäre Daten in der Klassifikation im <a href="https://jkruppa.github.io/classification-preface.html">Kapitel zum maschinellen Lernen</a> nutzen. Gerne werden daher auch <span class="math inline">\(0/1\)</span>-Daten generell als Daten für die Prädiktion benutzt. Das ist aber nicht generell der Fall. In den Humanwissenschaften haben wir es fast nur mit <span class="math inline">\(0/1\)</span>-Messwerten für die gesunden und kranken Patienten zu tun und daher nutzen wir dort auch gerne die logistische Regression für die Analyse der Daten. In den Agrarwissenschaften ist der binäre Messwert eher selten, da wir wirklich eine Menge an Beobachtungen brauchen um sinnvoll mit einem binären Messwert rechnen zu können. Da wir bei solch einem Messwert auch gerne an Anteile denken können, fragen wir uns dann schnell, wie viel Prozent der Beobachtungen sind krank? Wenn wir da nicht in die höheren zweistelligen Fallzahlen kommen, dann ist ja eine Beobachtung gleich sehr viele Prozentpunkte “wert”. Das macht dann meistens wenig Sinn tiefer zu analysieren.</p>
<p>Die Erstellung von binären Messwerten ist recht mühselig. Zum einen liegt es daran, dass wir ja immer die Anteile an den Einsen vorgeben. Daher sind wir auch in dem Zahlenraum <span class="math inline">\([0;1]\)</span> beschränkt. Die Effekt müssen dann entsprechend klein sein, wenn du viele Level im Faktor hast. Der Vorteil ist aber, dass ich keien Lust habe hundert oder mehr Beobachtungen pro Gruppe mit Null und Eins in Excel zu versehen. Das geht dann hier sehr viel schneller. Da die logistsiche Regression als Analysemethode so eine große Bedeutung in den Humanwissenschaften hat, ist <code>{simstudy}</code> sehr um diesen Messwert mit Beispielen gesegnet, wie ich im folgenden Kasten nochmal erwähne.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die Genierung von binären Daten
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Folgenden beiden Tutorien helfen nochmal bei der Erstellung von binären Daten. Am Ende ist es immer etwas schwierig Daten mit Effekt in einem 0/1 Raum zu erschaffen. Hier mögest du dann noch mehr Inspiration finden.</p>
<ul>
<li><a href="https://www.rdatagen.net/post/2024-07-02-generating-binary-data-by-specifying-relative-risk/">Generating binary data by specifying the relative risk, with simulations</a> hier gehen wir nochmal auf das relative Risiko ein. Ein häufiger Effektschätzer in der Epidemiologie und den Humanwissenschaften.</li>
<li><a href="https://kgoldfeld.github.io/simstudy/articles/logisticCoefs.html">Targeted logistic model coefficients</a> geht nochmal auf das Problem der transformierten Effekt auf der log-Skala ein. Wir können die Daten auf verschiedene Weise mit Effekten versehen und daher gibt es auch etwas mehr zu Lesen.</li>
</ul>
</div>
</div>
<p>Beginnen wollen wir wieder mit einem einfaktoriellen Design mit drei Leveln. Im Prinzip können wir auch nur zwei Level nehmen oder mehr, aber wir haben hier schon eine Menge Text produziert, da lohnt isch dann etwas mehr Kürze. Danach schauen wir uns dann noch den Fall mit einer Kovariaten an, dort können wir dann noch etwas zum Logit und der logistischen Funktion lernen. Die mehrfaktoriellen Fälle lasse ich hier einmal außenvor, dass würde alles noch mehr verkomplizieren. Meistens ist es nämlich das Problem, dass wir nicht in dem Bereich von Null bis Eins in der Formula durch die Effekte bleiben. Dann haben wir auf einmal sehr viele fehlende Werte in unseren binären Messwert. Die Lösung wäre dann alles auf dem Logit zu modellieren, aber das hat dann den nachteil der einfacheren Interpretierbarkeit. Dazu dann aber geich mehr.</p>
<section id="einfaktoriell-f_a-mit-2-leveln-5" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktoriell-f_a-mit-2-leveln-5">Einfaktoriell <span class="math inline">\(f_A\)</span> mit &gt;2 Leveln</h4>
<p>Wir wollen uns hier zwei Wege anschauen uns binäre Messwerte zu erschaffen. Zum einen können wir die Binäreverteilung nutzen. Eigentlich ist die Binäreverteilung nur ein Spezialfall der Binomialverteilung, so dass wir uns dann auch noch gleich die Implementierung in der Binomialverteilung anschauen. Zuerst brauchen wir wieder unser Faktorengrid an dem wir dann die Datendefinition kleben können. Damit wir hier überhaupt etwas sehen, nutze ich wieder zehntausend Beobachtungen pro Faktorlevel.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>fac1_dt <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir die Daten schon auf zwei Wegen zusammenbauen. Dabei würde ich hier einmal die Binäreverteilung vorziehen, denn diese Verteilung macht exakt das was wir wollen. Die Binomialeverteilung ist dann einfach nochmal hier, damit ich auch diese später mal wiederfinde.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Binäreverteilung</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Binomialverteilung</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<p>Im Folgenden bauen wir uns einmal die binären Messwerte. Hierbei ist wichtig, dass wir uns auf dem Identitylink bewegen. Das heißt, wir definieren einen Intercept als Wahrscheinlichkeit eine Eins zu beobachten und dann den Effekt als Änderung der Wahrscheinlichkeit eine Eins zu beobachten. Daher ist alles was in der <code>formula</code>-Option steht der Anteil an Einsen in den entsprechenden Leveln des Faktors. Hier ist es dann noch wichtig, dass die <code>formula</code>-Option am Ende immer im Interval <span class="math inline">\([0;1]\)</span> bleibt. Wenn du also drei Faktorlevel hast, die alle einen Effekt von <span class="math inline">\(+0.4\)</span> haben sollen, dann eght es nicht. Denn dann wären wir auch mit einem intercept von Null bei dem dritten Level über Eins. Daher müssen die Effekte bei mehr Leveln auch immer kleiner werden. Wir können hier auch andere Linkfunktionen wählen, dazu dann aber mehr bei der Kovariatensimulation.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>y_binary_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">formula =</span> <span class="st">"0.2 + 0.2*f_a"</span>,</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dist =</span> <span class="st">"binary"</span>, <span class="at">link =</span> <span class="st">"identity"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann bringen wir einmal das Faktorengrid mit der Datendefinition zusammen und generieren uns die entsprechenden Daten mit den binären Messwerten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>binary_fac1_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(y_binary_def, fac1_dt)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann schauen wir uns einmal das Ergebnis als Tabelle an. Wir haben in dem ersten Level des Anteil an Einsen des Intercepts, nämlich <span class="math inline">\(0.2\)</span> oder 20% plus den Effekt des ersten Levels mit <span class="math inline">\(+0.2\)</span>. Dann haben wir als Effekt ja auch <span class="math inline">\(+0.2\)</span> also immer 20% mehr für jedes Faktorlevel. Bei der hohen Anzahl an Beobachtungen stimmt das auch so sehr gut.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>binary_fac1_dt <span class="sc">|&gt;</span> </span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(f_a, y) <span class="sc">|&gt;</span> </span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>(<span class="st">"row"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> f_a   0   1
   1 0.6 0.4
   2 0.4 0.6
   3 0.2 0.8</code></pre>
</div>
</div>
<p>Dann könnten wir wieder unsere Stichprobe aus den riesigen Daten wie schon bei der ordinalverteilten Daten ziehen und damit weiterechnen. Ich würde hier aber immer mit Stichproben nahe Hundert für jede Gruppe rechnen wollen. Bei drei Leveln sollte ich also auch gut dreihundert Beobachtungen in meiner Studie haben. So große Stichproben sind dann in den Agrarwissenschaften eher selten.</p>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p>Eine andere Möglichkeit einen binären Messwert zu erschaffen ist die Binomialverteilung mit einer Varianz von Eins. Damit haben wir dann den Spezialfall der Binärenverteilung vorliegen. Der Weg ist der Gleiche, daher hier nur einmal skizziert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>y_binom_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"infected"</span>, <span class="at">formula =</span> <span class="st">"0 + 0.2 * f_a"</span>,</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dist =</span> <span class="st">"binomial"</span>, <span class="at">variance =</span> <span class="dv">1</span>, <span class="at">link =</span> <span class="st">"identity"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann bringen wir das Faktorenraster mit der Datendefinition zusammen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>binom_fac1_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(y_binom_def, fac1_dt)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns die Daten auch einmal als Tabelle anschauen. Auch hier sehen wir dann schön, dass wir die Effekte wiederfinden, die wir eingestellt haben. Hier ist der Intercept dann mal <span class="math inline">\(0%\)</span> und die Anzahl an Einsen in jedem Level entspricht dem kumulativen Effekt der Level von <span class="math inline">\(+0.2\)</span> für jedes Level.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>binom_fac1_dt <span class="sc">|&gt;</span> </span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(f_a, infected) <span class="sc">|&gt;</span> </span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>(<span class="st">"row"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> f_a    0    1
   1 0.79 0.21
   2 0.59 0.41
   3 0.40 0.60</code></pre>
</div>
</div>
<p>Hier sehen wir dann aber leichte Rundungsabweichungen durch die etwas geringe Anzahl an Beobachtungen. Wenn wir noch mehr Beobachtungen einstellen, dann wird auch die geringe Abweichung verschwinden.</p>
</div>
</div>
</div>
<p>Das war es jetzt auch schon für das faktorielle Design. Wenn du ein zweifaktorielles Design brauchst, dann wird es eben schon sehr viel schwieriger mit den kleinen Effekten damit du in dem Interval <span class="math inline">\([0;1]\)</span> bleibst. Da mache ich dann immer eine Simulation mit der Normalverteilung und versuche mir dann einen Grenzwert so zu bauen, dass ich zwei Gruppen erhalte. Mehr dazu dann am Ende des Abschnitts nochmal in dem Kasten zu der Generierung von binären Messwerten mit der Normalverteilung.</p>
</section>
</section>
<section id="kovariates-design-4" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="kovariates-design-4">Kovariates Design</h3>
<p>Kommen wir nun zu dem kovariaten Design, wo wir dann nochmal etwas genauer auf die Erstellung der binären Daten eingehen können. Wenn unsere Einflussvariable numerisch ist, dann haben wir etwas mehr Möglichkeiten unsere Daten darzustellen und zu verstehen, was dort eigentlich passiert. Wir haben ja jetzt auf der x-Achse nicht nur Kategorien sondern eben eine Kovariate. Das macht dann alles etwas einfacher. Hier können wir dann auf zwei Arten nochmal nachvollziehen, wie wir die Daten bauen. Wir haben die Möglichkeit den <em>identity</em>-Link zu wählen. Dann erstellen wir alles mit untransformierten Wahrscheinlichkeiten. Wir sagen, dass wir durch die Kovariate als Effekt <span class="math inline">\(+0.05\)</span> haben wollen und für jede Einheit der Kovariate stiegt die Wahrscheinlichkeit für ein Ereignis (<span class="math inline">\(y =1\)</span>) um 5% an. Das ist super zu verstehen. Wir können aber auch die Effekte auf dem <em>logit</em>-Link angeben. Dann generieren wir nicht mehr so einfach zu verstehende Effekte. Mehr dazu dann im zweiten Tab.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true"><code>link = "idenity"</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false"><code>link = "logit"</code></a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>Am einfachsten machen wir es uns, wenn wir direkt auf den Wahrscheinlichkeiten die Daten generieren. Daher nehmen wir hier einmal eine normalverteilte Kovariate an und wollen dann mit der Kovariate den binären Messwert generieren. Dabei haben wir einen Mittelwert von Null für die Kovariate angenommen. Der Effekt kann jetzt direkt als Wahrscheinlichkeit interpretiert werden. Daher haben wir als Intercept 50% Wahrscheinlichkeit eine Eins in dem Messwert zu beobachten. Je Einheit Kovariate steigt die Wahrscheinlichkeit dann um <span class="math inline">\(+0.15\)</span> an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>cov1_binary_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"c_1"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, <span class="at">formula =</span> <span class="st">"0"</span>,</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">variance =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">formula =</span> <span class="st">"0.5 + 0.15*c_1"</span>,</span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">dist =</span> <span class="st">"binary"</span>, <span class="at">link =</span> <span class="st">"identity"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann bauen wir uns einmal die Daten damit wir gleich einmal in der Abbildung schauen können, wie sich die Messwerte dann verteilen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>cov1_binary_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">1000</span>, cov1_binary_def)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung können wir uns einmal die Daten und die entsprechenden Effekte anschauen. Die Grade entspricht einer linearen Regression durch die Punktewolke. Wir sehen hier sehr schön, dass wir die voreingestellten Werte aus unserer Simulation wiederfinden. Dafür haben wir hier aber den Nachteil, dass die Grade über die Null und Eins hinausschießen kann. Jetzt können wir natürlich auch sagen, dass wir ja eigentlich eine logistische Regression rechnen würden. Das machen wir auch gleich mal.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-binomial-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-binomial-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-binomial-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44" title="Abbildung&nbsp;21.39— Scatterplot der Kovariate und den binären Messwert. Die Regressionsgleichung ist ergänzt und entspricht den voreingestellten Werten. Die Modellierung erfolgt hier über eine lineare Regression. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-binomial-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-binomial-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.39— Scatterplot der Kovariate und den binären Messwert. Die Regressionsgleichung ist ergänzt und entspricht den voreingestellten Werten. Die Modellierung erfolgt hier über eine lineare Regression. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir können uns auch einmal die Modellanpassung mit einer logistischen Regression anschauen. Dafür müsse wir dann erstmal die logistische Regression mit der Funktion <code>glm()</code> rechnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>log_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> c_1, cov1_binary_dt, <span class="at">family =</span> binomial)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt können wir die Ergebnisse der Regression direkt einmal in die Punktewolke abbilden. Der große Vorteil ist, dass wir die Grade jetzt dank der logistsichen Transformation innerhalb der Modellierung der logistischen Regression jetzt zwischen Null und Eins bleibt. Dafür haben wir jetzt aber nicht direkt die <em>logistischen</em> Effekte modelliert. Deshalb bietet sich im anderen Tab noch die Generierung mit logistischen Effekten an.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-binomial-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-binomial-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-binomial-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-45" title="Abbildung&nbsp;21.40— Scatterplot der Kovariate und den binären Messwert. Die Modellierung erfolgt hier über eine logistische Regression. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-binomial-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-binomial-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.40— Scatterplot der Kovariate und den binären Messwert. Die Modellierung erfolgt hier über eine logistische Regression. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<p>Es ist natürlich etwas blöd, wenn wir die Daten auf der Basis einer linearen Regression abbilden und dann über die logistische Regression auswerten wollen. Da wäre es ja besser, wenn wir direkt auf der logistischen Transformation unseren Messwert generieren. Hier gibt es auch die Vingette <a href="https://blogs.sas.com/content/iml/2023/01/16/simulate-logistic-intercept.html">Simulate data from a logistic regression model: How the intercept parameter affects the probability of the event</a>, die etwas genauer auf das Problem eingeht. Am Ende wählen wir hier die Option <code>link = "logit"</code> um unsere Messwerte mit dem Effekt auf dem Logit zu generieren. Das macht die Interpretation um einiges schwerer bis unmöglich. Wir müssen hier dann also rumprobieren, bis alles passt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>cov1_binary_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"c_1"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, <span class="at">formula =</span> <span class="st">"0"</span>,</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">variance =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">formula =</span> <span class="st">"0 + 1.5*c_1"</span>,</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">dist =</span> <span class="st">"binary"</span>, <span class="at">link =</span> <span class="st">"logit"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir auch einmal die Daten generieren und uns anschauen, wie sich die Messwerte ergeben. Ich generiere hier einmal richtig viele Beobachtungen, damit wir auch gleich was sehen und nicht zu viel Rauschen in den Daten haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>cov1_binary_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">100000</span>, cov1_binary_def)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Der folgende Gedankengang ist eher etwas wild, aber er hilft vielleicht sich die Sachlage nochmal zu veranschaulichen. Rein statistisch gesehen überfahren wir hier einen statistischen Engel, aber so richtig. Mir hat es aber nochmal geholfen eine Idee dafür zu entwicklen, was diese logistische Transfomation sein soll und wie diese stattfindet. Wir können jetzt einmal die Kovariate <span class="math inline">\(c_1\)</span> in zehn gleichmäßige Stücke oder Intervalle teilen. Für jedes dieser Intervalle berechnen wir dann den Anteil an Einsen und addieren einen kleinen Fehler drauf. Am Ende können wir dann die logistische Transformation rechnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>cov1_binary_logit_dt <span class="ot">&lt;-</span> cov1_binary_dt <span class="sc">|&gt;</span> </span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c_1_bin =</span> <span class="fu">cut</span>(c_1, <span class="at">breaks =</span> <span class="dv">10</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(c_1_bin) <span class="sc">|&gt;</span> </span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_y =</span> <span class="fu">round</span>(<span class="fu">mean</span>(y), <span class="dv">2</span>) <span class="sc">+</span> <span class="fl">0.001</span>) <span class="sc">|&gt;</span> </span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_y =</span> <span class="fu">ifelse</span>(mean_y <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="fl">0.999</span>, mean_y), </span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">((.+),.*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, c_1_bin)),</span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper =</span> <span class="fu">as.numeric</span>( <span class="fu">sub</span>(<span class="st">"[^,]*,([^]]*)</span><span class="sc">\\</span><span class="st">]"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, c_1_bin)),</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">mid =</span> (lower <span class="sc">+</span> upper)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">logistic =</span> <span class="fu">plogis</span>(mean_y))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung siehst du einmal das Ergebnis. Wir haben hier die logistsiche Transformation von den Wahrscheinlichkeiten eine Eins zu beobachten einmal für das Beispiel einer Kovariate dargestellt. So ergibt sich dann auch die charakteristische S-Kurve der logistischen Regression.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-binomial-theo" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-binomial-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-binomial-theo-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-46" title="Abbildung&nbsp;21.41— Logistische Transformation für die Wahrscheinlichkeit eine Eins zu beobachten pro Intervall der Kovariate. Es ergibt sich eine klassiche S-Kurve. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-binomial-theo-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-binomial-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.41— Logistische Transformation für die Wahrscheinlichkeit eine Eins zu beobachten pro Intervall der Kovariate. Es ergibt sich eine klassiche S-Kurve. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Dann hier nochmal die Abbildung für die normale Regression mit der Annahme der Normalverteilung. In diesem Fall schießt die Gerade über das Intervall hinaus. Wir haben damit dann auch Werte kleiner als Null und größer als Eins vorhergesagt. Die Gradengleichung ist dann aber hier auf dem <em>Identity</em>-Link wie in dem vorherigen Tab.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-binomial-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-binomial-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-binomial-03-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-47" title="Abbildung&nbsp;21.42— Scatterplot der Kovariate und den binären Messwert. Die Regressionsgleichung ist ergänzt und entspricht den voreingestellten Werten. Die Modellierung erfolgt hier über eine lineare Regression. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-binomial-03-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-binomial-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.42— Scatterplot der Kovariate und den binären Messwert. Die Regressionsgleichung ist ergänzt und entspricht den voreingestellten Werten. Die Modellierung erfolgt hier über eine lineare Regression. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir können uns auch einmal die Modellanpassung mit einer logistischen Regression anschauen. Dann erhalten wir auch die echte S-Kurve wiedergeben und nicht unsere obige Annäherung. Dafür müsse wir dann erstmal die logistische Regression mit der Funktion <code>glm()</code> rechnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>log_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> c_1, cov1_binary_dt, <span class="at">family =</span> binomial)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt können wir die Ergebnisse der Regression direkt einmal in die Punktewolke abbilden. Der große Vorteil ist, dass wir die Grade jetzt dank der logistsichen Transformation innerhalb der Modellierung der logistischen Regression jetzt zwischen Null und Eins bleibt. Dafür haben wir jetzt aber nicht direkt die <em>logistischen</em> Effekte modelliert. Somit haben wir uns beides einmal angeschaut. Was das bessere ist, hängt immer von deiner Fragestellung ab.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-binomial-04" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-binomial-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-binomial-04-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-48" title="Abbildung&nbsp;21.43— Scatterplot der Kovariate und den binären Messwert. Die Modellierung erfolgt hier über eine logistische Regression. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-binomial-04-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-binomial-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.43— Scatterplot der Kovariate und den binären Messwert. Die Modellierung erfolgt hier über eine logistische Regression. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Zum Abschluss dieses Abschnitts möchte ich nochmal einen kleinen Exkurs über die logistsiche Regression geben. Es ist vielleicht hilfreich sich nochmal mit der Thematik zu beschäftigen. Ich würde aber komplexere kovariate Modelle nicht mehr simulieren, dass wird sehr schnell sehr unübersichtlich. Wenn du die Modelle für die Erstellung neuer Algorithmen brauchst, dann sind wir hier auch nicht ganz richtig. Dafür musst du dann tiefer in <code>{simstudy}</code> einsteigen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exkurs: <em>logit</em> und <em>logistic</em> Transformation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wenn wir uns mir der ordinalen oder aber logistischen Regression beschäftigen dann kommen wir nicht um die <code>logit()</code> und <code>logistic()</code> Funktionen herum. Beide Funktionen haben als Idee die begrenzten Wahrscheinlichkeiten in dem Zahlenraum <span class="math inline">\([0;1]\)</span> auf <span class="math inline">\([-Inf;+Inf]\)</span> zu transformieren. Hier bietet sich dann eben die <code>logit()</code> und <code>logistic()</code> Funktionen dafür an. Wie immer gibt es eine Reihe an nützlichen Tutorien, die ich hier mal kurz zusammenstelle. Vieles von dem hier passt dann auch eher in das <a href="stat-modeling-logistic.html">Kapitel zur logistischen Regression</a> rein.</p>
<ul>
<li>Das Tutorium zur <a href="https://ro-che.info/articles/2018-08-11-logit-logistic-r">logit() and logistic() functions in R</a> liefert nochmal den Zusammehang zwischen den beiden Transformationen und wie die Funktionen in R heißen.</li>
<li>In dem Artikel <a href="https://numiqo.com/tutorial/logistic-regression">Logistic Regression</a> wird nochmal erklärt, wie die Grundlagen der logistischen Regression lauten. Sehr ausführlich gemacht.</li>
<li>Manchmal möchte man dann doch die logistische Regression per Hand rechnen. Dann hilft das Tutorium zu <a href="https://maximilianrohde.com/posts/logistic-regresstion-by-hand/">Logistic regression (by hand)</a></li>
<li>Noch etwas umfangreicher ist das Tutorium <a href="https://towardsdatascience.com/logistic-regression-explained-from-scratch-visually-mathematically-and-programmatically-eb83520fdf9a/">Logistic Regression Explained from Scratch (Visually, Mathematically and Programmatically)</a>.</li>
</ul>
<p>Wir wollen uns jetzt nochmal die beiden Transformationen in den beiden folgenden Tabs nochmal hier anschauen. Damit hast du dann eine Idee, was die beiden Funktionen machen. Im Prinzip verwandelt die <em>logit</em>-Funktion Zahlen im begrenzten Wahrscheinlichkeitsraum <span class="math inline">\([0;1]\)</span> in einen faktisch unendlichen Zahlenraum.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true"><em>logit</em> mit <code>qlogis()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false"><em>logistic</em> oder <em>invlogit</em> mit <code>plogis()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<p>Der Logit einer Wahrscheinlichkeit <span class="math inline">\(Pr\)</span> ist durch folgende Formel gegeben.</p>
<p><span class="math display">\[
\text{logit}(Pr) = log\left(\cfrac{Pr}{1-Pr}\right)
\]</span></p>
<p>Wir können den Logit in R mit der Funktion <code>plogis()</code> bestimmen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qlogis</span>(<span class="fl">0.6</span>) <span class="co"># logit</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4054651</code></pre>
</div>
</div>
<p>Manchmal ist das aber etwas wirr, deshalb hier nochmal die Funktion ausgeschrieben, wie wir die Funktion oben in der mathematischen Formel sehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>logit <span class="ot">&lt;-</span> \(x) <span class="fu">log</span>(x <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> x))</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">logit</span>(<span class="fl">0.6</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4054651</code></pre>
</div>
</div>
<p>In der folgenden Abbildung siehst du einmal die Transformation von Wahrscheinlichkeitswerten in den Logit.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-binomial-logit-theo" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-binomial-logit-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-binomial-logit-theo-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-49" title="Abbildung&nbsp;21.44— Die logit-Funktion transformiert eine Wahrscheinlichkeit auf der x-Achse in einen unbegrenzten Zahlenraum auf der y-Achse. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-binomial-logit-theo-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-binomial-logit-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.44— Die <em>logit</em>-Funktion transformiert eine Wahrscheinlichkeit auf der x-Achse in einen unbegrenzten Zahlenraum auf der y-Achse. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<p>Die logistsiche Funktion ist durch folgende Formel gegeben. Dabei handelt es sich um die Umkehrfunktion der Logit-Funktion.</p>
<p><span class="math display">\[
\text{logistic}(z) = \cfrac{1}{1 + e^{-z}}
\]</span></p>
<p>Wir können den Logit in R mit der Funktion <code>qlogis()</code> bestimmen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(<span class="fl">0.4054651</span>) <span class="co"># logistic</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6</code></pre>
</div>
</div>
<p>Manchmal ist das aber etwas wirr, deshalb hier nochmal die Funktion ausgeschrieben, wie wir die Funktion oben in der mathematischen Formel sehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>invlogit <span class="ot">&lt;-</span> \(z) <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>z))</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invlogit</span>(<span class="fl">0.4054651</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6</code></pre>
</div>
</div>
<p>In der folgenden Abbildung siehst du einmal die Rücktransformation von Logitwerten in Wahrscheinlichkeitswerte.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-gen-binomial-logistic-theo" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-gen-binomial-logistic-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-generation_files/figure-html/fig-eda-gen-binomial-logistic-theo-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-50" title="Abbildung&nbsp;21.45— Die logistic-Funktion transformiert eine unbegrenzte Zahl auf der x-Achse in eine begrenzte Wahrscheinlichkeit auf der y-Achse. Die Umkehrfunktion der logit-Funktion oder eben auch Inverse genannt. [Zum Vergrößern anklicken]"><img src="eda-generation_files/figure-html/fig-eda-gen-binomial-logistic-theo-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-gen-binomial-logistic-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;21.45— Die <em>logistic</em>-Funktion transformiert eine unbegrenzte Zahl auf der x-Achse in eine begrenzte Wahrscheinlichkeit auf der y-Achse. Die Umkehrfunktion der <em>logit</em>-Funktion oder eben auch Inverse genannt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Was bleibt dann noch am Ende übrig? Wir könnten uns das Leben auch einfacher machen und die binären Daten über kontinuierliche, normalverteilte Daten generieren. Das habe ich einmal in dem folgenden Kasten gemacht. Manchmal ist die Dichotomisierung eine gute Möglichkeit um binäre Daten zu erhalten.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Oder doch die Normalverteilung?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir können natürlich auch die Dtane erstmal mit einer Normalverteilung erschaffen und uns dann einen wie auch immer gearteten Grenzwert ausdenken bei dem wir dann entscheiden, dass alle Werte unter dem Grenzwert dann Null sind und alle über dem Grenzwert zu Eins werden. Teilweise ist es vermutlich die bessere Idee, wenn du sehr viele Einflussvariablen vorliegen hast. Hier nutze ich dann die Funktion <code>ifelse()</code> um mir einen Grenzwert von 2 zu setzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>binom_norm_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fl">1.2</span> <span class="sc">*</span> c_1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y_bin =</span> <span class="fu">ifelse</span>(y <span class="sc">&gt;=</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns auch einmal anschauen, wie sich unser binärer Messwert dann verteilt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>binom_norm_tbl <span class="sc">|&gt;</span> </span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(y_bin) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> y_bin  n percent
     0 68    0.68
     1 32    0.32</code></pre>
</div>
</div>
<p>Besonders wenn du dann viele Einflussvariablen hast, macht es Sinn einmal mit Grenzwerten zu spielen, so dass du am Ende auch balancierte binäre Messwerte hast. Am Ende macht es ja keinen Sinn nur Messwerte zu produzieren die alle Eins oder alle Null sind.</p>
</div>
</div>
</section>
</section>
<section id="komplexere-messwerte" class="level2" data-number="21.6">
<h2 data-number="21.6" class="anchored" data-anchor-id="komplexere-messwerte"><span class="header-section-number">21.6</span> Komplexere Messwerte</h2>
<p>Am Ende gibt es natürlich noch komplexere statitische Modell, die wir dann mit künstlichen Daten versehen können. Das R Paket <code>{simstudy}</code> hat ja hier eine große Auswahl an Möglichkeiten. Wie immer gilt aber, warum willst du dir die Daten generieren? Die genierung hat ja an sich keinen Selbstzweck. Es macht Sinn sich künstliche Daten zu generieren, wenn wir die Algorithmen besser verstehen wollen. Wenn du dann aber so tief in der Thematik der Algorithmen und Methoden bist, dann übersteigt meist dein Interesse hier meine Fähigkeiten allgemeiner über das Thema zu schreiben. Deshalb hier nochmal eine lockere Linksammlung für die komplexeren Modelle.</p>
<section id="überlebenszeiten" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="überlebenszeiten">Überlebenszeiten</h3>
<p>Wenn es um Überlebenszeotdaten geht dann hilft die Vingette <a href="https://kgoldfeld.github.io/simstudy/articles/survival.html">Survival Data</a> vom R Paket <code>{simstudy}</code> weiter. Dort wird nochmal auf die speziellen Anforderungen einer Überlebenszeitanalyse (eng. <em>time to event</em>) eingegangen. Wir haben in einer Überlebenszeitanalyse eben auch einen Messwert vorliegen, der aus zwei Komponenten besteht. Wir brauchen einmal die Information, ob ein Ereignis eingetreten ist oder nicht. Damit haben wir einen binären Messwert. Darüber hinaus wollen wir noch wissen, wie lange es bis zum Ereignis gedauert hat. Das ist eher ein poissonverteilter Messwert. Es sind eben die Anzahl an Tagen oder allgemeiner die vergangene Zeit bis zum Ereignis. Das zusammen macht die Sachlage nicht einfacher. Aktuell nutze ich keine Überlebenszeitanalysen in meinen Vorlesungen und daher bleibt dieses Abschnitt auch erstmal offen.</p>
</section>
<section id="zeitreihen" class="level3 unnumbered unlisted">
<h3 class="unnumbered unlisted anchored" data-anchor-id="zeitreihen">Zeitreihen</h3>
<p>Wenn wir noch weiter über Zeitreihen sprechen, dann können wir verschiedene Dinge meinen. Wir haben eine Kovariate als Zeit vorliegen oder aber wir messen an bestimmten Zeitpunkten. Ein Zeitpunkt ist vermutlich eher ein Faktor. Messen wir viele Zeitpunkte, dann könnte der Zeitpunkt auch wieder eine Kovariate sein. Auf jeden Fall haben die Zeitpunkte untereinander etwas miteinander zu tun. Oder anders gesprochen, die Zeitpunkte sind untereinander korreliert. Je weiter die Zeitpunkte auseinanderliegen, desto geringer ist die Korrelation. Die folgenden Vingetten des R Paketes <code>{simstudy}</code> beschäftigen sich mit diesen Fragen.</p>
<ul>
<li>Die Vingette zu den <a href="https://kgoldfeld.github.io/simstudy/articles/longitudinal.html">Longitudinal Data</a> ist im Prinzip ein guter Einstieg, wenn du längere Zeitreihen vorliegen hast. Was lang ist, hängt wiederum von Betrachter ab. Aber es geht eher um mehrere Wochen bis Monate.</li>
<li>Die Vingette <a href="https://kgoldfeld.github.io/simstudy/articles/correlated.html">Correlated Data</a> beschreibt eher die korrelierten Zeitpunkte als Faktoren. Hier musst du aber mal schauen, ob nicht die Vingette zu <a href="https://kgoldfeld.github.io/simstudy/articles/corelationmat.html">Correlation Matrices</a> besser geeignet ist.</li>
<li>Wenn es komplizieter wird, dann können wir auch ordinale Messwerte mit der Vingette <a href="https://kgoldfeld.github.io/simstudy/articles/ordinal.html#correlated-multivariate-ordinal-data">Correlated multivariate ordinal data</a> erstellen. Hier wird es dann aber sehr komplex, wenn es dann noch um Effekte geht.</li>
</ul>
<p>Am Ende sind alle Beispiele der Vingetten eher linear vom Verlauf über die Zeit. Wenn es wilder sein soll, also wir eher eine Kurve beobachten wollen, dann brauchen wir die folgende Vingette.</p>
<ul>
<li>Die Vingette <a href="https://kgoldfeld.github.io/simstudy/articles/spline.html">Spline Data</a> stellt im Prinzip nicht lineare Zusammenhänge dar. Wenn du also Daten brauchst, die Kurvenverläufe darstellen dann wird dir hier weitergeholfen. Es wird dann aber schnell sehr komplex, so dass du hier dann einiges an Zeit brauchen wirst um die Daten gut zu simulieren.</li>
</ul>
</section>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-dormann2013parametrische" class="csl-entry" role="listitem">
Dormann, C. F. (2013). <em>Parametrische Statistik</em>. Springer.
</div>
<div id="ref-gambarota2024ordinal" class="csl-entry" role="listitem">
Gambarota, F., &amp; Altoè, G. (2024). Ordinal regression models made easy: A tutorial on parameter interpretation, data simulation and power analysis. <em>International Journal of Psychology</em>, <em>59</em>(6), 1263–1292.
</div>
<div id="ref-jackson2009intelligent" class="csl-entry" role="listitem">
Jackson, C., Murphy, R. F., &amp; Kovacevic, J. (2009). Intelligent acquisition and learning of fluorescence microscope data models. <em>IEEE Transactions on Image Processing</em>, <em>18</em>(9), 2071–2084.
</div>
<div id="ref-kruppa2016simulation" class="csl-entry" role="listitem">
Kruppa, J., Kramer, F., Beißbarth, T., &amp; Jung, K. (2016). A simulation framework for correlated count data of features subsets in high-throughput sequencing or proteomics experiments. <em>Statistical applications in genetics and molecular biology</em>, <em>15</em>(5), 401–414.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./eda-transform.html" class="pagination-link" aria-label="Transformieren von Daten">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-tests-preface-theory.html" class="pagination-link" aria-label="Testen von Hypothesen">
        <span class="nav-page-text">Testen von Hypothesen</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb208" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, see, modelr, ggforce,</span></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a><span class="in">               latex2exp, patchwork, parsnip, ggdag, ggimage, ggpmisc,</span></span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a><span class="in">               conflicted)</span></span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(ggplot2::annotate)</span></span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(20250701)</span></span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a><span class="in">theme_modeling &lt;- function() {</span></span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(panel.grid.minor = element_blank(),</span></span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.background = element_rect(fill = "white", color = NA),</span></span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.title = element_text(size = 16, face = "bold"),</span></span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.subtitle = element_text(size = 12, face = "italic"),</span></span>
<span id="cb208-18"><a href="#cb208-18" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.caption = element_text(face = "italic"),</span></span>
<span id="cb208-19"><a href="#cb208-19" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.title = element_text(size = 12, face = "bold"),</span></span>
<span id="cb208-20"><a href="#cb208-20" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.text = element_text(size = 12),</span></span>
<span id="cb208-21"><a href="#cb208-21" aria-hidden="true" tabindex="-1"></a><span class="in">          legend.title = element_text(face = "bold"),</span></span>
<span id="cb208-22"><a href="#cb208-22" aria-hidden="true" tabindex="-1"></a><span class="in">          strip.text = element_text(face = "bold"),</span></span>
<span id="cb208-23"><a href="#cb208-23" aria-hidden="true" tabindex="-1"></a><span class="in">          strip.background = element_rect(fill = "grey80", color = NA))</span></span>
<span id="cb208-24"><a href="#cb208-24" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb208-25"><a href="#cb208-25" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-26"><a href="#cb208-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-29"><a href="#cb208-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-30"><a href="#cb208-30" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb208-31"><a href="#cb208-31" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-32"><a href="#cb208-32" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb208-33"><a href="#cb208-33" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-34"><a href="#cb208-34" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-35"><a href="#cb208-35" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sim-mean-samplesize</span></span>
<span id="cb208-36"><a href="#cb208-36" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"simulation/sim-gen-data-mean.R"</span>)</span>
<span id="cb208-37"><a href="#cb208-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-38"><a href="#cb208-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-41"><a href="#cb208-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-42"><a href="#cb208-42" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-43"><a href="#cb208-43" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-44"><a href="#cb208-44" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-45"><a href="#cb208-45" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"images/R/stat-modeling-R.R"</span>)</span>
<span id="cb208-46"><a href="#cb208-46" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"images/R/eda-generation.R"</span>)</span>
<span id="cb208-47"><a href="#cb208-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-48"><a href="#cb208-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-49"><a href="#cb208-49" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generierung von Daten {#sec-eda-gen-data}</span></span>
<span id="cb208-50"><a href="#cb208-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-51"><a href="#cb208-51" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("eda-generation.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb208-52"><a href="#cb208-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-53"><a href="#cb208-53" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Je größer die Insel des Wissens, desto größer der Strand der Verzweiflung." --- unbekannt*</span></span>
<span id="cb208-54"><a href="#cb208-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-55"><a href="#cb208-55" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel geht es um die Erstellung von zufälligen Daten. Oder anderherum, wir wollen uns künstliche Daten (eng. *artificial data* oder eng. *synthetic data*) generieren. Warum machen wir das? Eine Frage, die sich vermutlich kein Statistiker oder Date Scientist stellen würde, ist es doch Teil der wissenschaftlichen Arbeit simulierte Daten zu erstellen. Auf diesen simulierten Daten werden dann die neuen entwickelten Algorithmen getestet. Für Menschen außerhalb der Data Science mag es seltsam erscheinen, dass wir uns einfach Daten erschaffen können. Diese synthetischen Daten kommen dann aber den biologischen Daten manchmal recht Nahe. Daher kannst auch du dir deine Daten theoretisch einfach selber bauen, nachdem du dieses Kapitel gelesen hast.</span>
<span id="cb208-56"><a href="#cb208-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-57"><a href="#cb208-57" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb208-58"><a href="#cb208-58" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb208-59"><a href="#cb208-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-60"><a href="#cb208-60" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"With great power comes great responsibility." --- Uncle Ben to Peter Parker in Spiderman*</span></span>
<span id="cb208-61"><a href="#cb208-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-62"><a href="#cb208-62" aria-hidden="true" tabindex="-1"></a>Keine Daten für die Abschlussarbeit erschaffen. Auch wenn die Daten mal nicht so passen, wie du dir das aus einem Experiment erhofft hast, ist es nicht erlaubt sich einfach die Daten selber zu simulieren. Simulierte Daten haben keinen wissenschaftlichen Wert abseits der Validierung von neuen Algorithmen.</span>
<span id="cb208-63"><a href="#cb208-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-64"><a href="#cb208-64" aria-hidden="true" tabindex="-1"></a>Was du aber machen *kannst*, ist deine experimentellen Daten schon mal im Design vorbauen um deine Analyse in R vorzurechnen. Wenn du dann aus deinem Experiment die echten Daten vorliegen hast, kannst du dann schneller die Analysen rechnen. Du hast dann ja schon alles einmal geübt und vorgearbeitet.</span>
<span id="cb208-65"><a href="#cb208-65" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-66"><a href="#cb208-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-67"><a href="#cb208-67" aria-hidden="true" tabindex="-1"></a>Daher nutzen wir diesen Kapitel auch anders. Wir erschaffen uns ja Daten um Algorithmen zu verstehen. Wenn wir wissen wie die Daten aufgebaut sind, dann können wir auch besser verstehen was uns ein Modell oder ein statistischer Test wiedergibt. Dafür brauchen wir dann die synthetischen Daten. Eine andere Möglichkeit ist, dass du einmal ausprobieren möchtest, wie eine potenzielle Analyse ablaufen würde. Dann macht es auch Sinn einmal über künstliche Daten nachzudenken. Ich komme dann immer mal wieder auf dieses Kapitel zurück, wenn ich in anderen Kapiteln mal künstliche Daten brauche. Wir schauen uns verschiedene Wege künstliche Daten zu erschaffen einmal an und es geht auch in Excel relativ einfach.</span>
<span id="cb208-68"><a href="#cb208-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-69"><a href="#cb208-69" aria-hidden="true" tabindex="-1"></a><span class="fu">## Allgemeiner Hintergrund</span></span>
<span id="cb208-70"><a href="#cb208-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-71"><a href="#cb208-71" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"We test our framework both on synthetic data, as the only source of ground truth on which we can objectively assess the performance of our algorithms, as well as on real data to demonstrate its real-world practicability." --- @jackson2009intelligent*</span></span>
<span id="cb208-72"><a href="#cb208-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-73"><a href="#cb208-73" aria-hidden="true" tabindex="-1"></a>Wenn wir Daten generieren wollen, dann müssen wir auch wissen, was wir genieren wollen. Dafür müssen wir dann verstehen, wovon wir sprechen. Da wir es bei der Datengenerierung auch immer mit statistischen Modellen zu tun haben, müssen wir auch die Fachsprache der statistischen Modellierung nutzen. Dann wollen wir verstehen, was wir eigentlich simulieren. Klar, wir simulieren Daten, aber was brauchen wir dafür an statistischen Maßzahlen? Ich betrachte dann nochmal die Einschränkungen dieses Kapitels, denn wir können natürlich hier nicht alles simulieren, was möglich ist. Faktisch konzentrieren wir uns hier auf häufige Datenstrukturen in den Agrawissenschaften. Dann zeige stelle ich dir nochmal kurz die zwei R Pakete vor, die wir dann hier nutzen können.</span>
<span id="cb208-74"><a href="#cb208-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-75"><a href="#cb208-75" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Sprachlicher Hintergrund {.unnumbered .unlisted}</span></span>
<span id="cb208-76"><a href="#cb208-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-77"><a href="#cb208-77" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"In statistics courses taught by statisticians we don't use independent variable because we use independent on to mean stochastic independence. Instead we say predictor or covariate (either). And, similarly, we don't say "dependent variable" either. We say response." --- [User berf auf r/AskStatistics](https://www.reddit.com/r/AskStatistics/comments/qt1hvu/comment/hkigiks/?utm_source=share&amp;utm_medium=web3x&amp;utm_name=web3xcss&amp;utm_term=1&amp;utm_content=share_button)*</span></span>
<span id="cb208-78"><a href="#cb208-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-79"><a href="#cb208-79" aria-hidden="true" tabindex="-1"></a>Wenn wir uns mit dem statistischen Modellieren beschäftigen wollen, dann brauchen wir auch Worte um über das Thema reden zu können. Statistik wird in vielen Bereichen der Wissenschaft verwendet und in jedem Bereich nennen wir dann auch Dinge anders, die eigentlich gleich sind. Daher werde ich mir es hier herausnehmen und auch die Dinge so benennen, wie ich sie für didaktisch sinnvoll finde. Wir wollen hier was verstehen und lernen, somit brauchen wir auch eine klare Sprache.</span>
<span id="cb208-80"><a href="#cb208-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-81"><a href="#cb208-81" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb208-82"><a href="#cb208-82" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/personal_opinion.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb208-83"><a href="#cb208-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-84"><a href="#cb208-84" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Jeder nennt in der Statistik sein Y und X wie er möchte. Da ich hier nicht nur von Y und X schreiben will, führe ich eben die Worte ein, die ich nutzen will. Damit sind die Worte dann auch richtig, da der Kontext definiert ist. Andere mögen es dann anders machen. Ich mache es eben dann so. Danke." --- Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.*</span></span>
<span id="cb208-85"><a href="#cb208-85" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb208-86"><a href="#cb208-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-87"><a href="#cb208-87" aria-hidden="true" tabindex="-1"></a>In dem folgenden Kasten erkläre ich nochmal den Gebrauch meiner Begriffe im statistischen Modellieren als Grundlage für die Generierung von Daten. Es ist wichtig, dass wir hier uns klar verstehen. Zum einen ist es angenehmer auch mal ein Wort für ein Symbol zu schreiben. Auf der anderen Seite möchte ich aber auch, dass du dann das Wort richtig einem Konzept im statistischen Modellieren zuordnen kannst. Deshalb einmal hier meine persönliche und didaktische Zusammenstellung meiner Wort im statistischen Modellieren. Du kannst dann immer zu dem Kasten zurückgehen, wenn wir mal ein Wort nicht mehr ganz klar ist. Die fetten Begriffe sind die üblichen in den folgenden Kapiteln. Die anderen Worte werden immer mal wieder in der Literatur genutzt.</span>
<span id="cb208-88"><a href="#cb208-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-89"><a href="#cb208-89" aria-hidden="true" tabindex="-1"></a>{{&lt; include stat-modeling/stat-modeling-callout-words.qmd &gt;}}</span>
<span id="cb208-90"><a href="#cb208-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-91"><a href="#cb208-91" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Effekt, Streuung und Fallzahl {.unnumbered .unlisted}</span></span>
<span id="cb208-92"><a href="#cb208-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-93"><a href="#cb208-93" aria-hidden="true" tabindex="-1"></a>Was brauchen wir um Daten zu generieren? Wir brauchen einen Effekt, eine Streuung der generierten Daten um den Mittelwert sowie die Fallzahl als Anzahl an Beobachtungen. Dann müssen wir noch entscheiden aus welcher Verteilung unsere Daten kommen sollen. In dem folgenden Venndiagramm habe ich dir nochmal den Dreiklang der drei statistischen Eigenschaften für die Generierung von Daten zusammengefasst. Wir müssen uns also klar werden, welchen Effekt wir simulieren wollen, welche Streuung in den Daten vorliegen soll und natürlich wie viele Beobachtungen wir in den generierten Daten vorfinden wollen.</span>
<span id="cb208-94"><a href="#cb208-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-97"><a href="#cb208-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-98"><a href="#cb208-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-99"><a href="#cb208-99" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-100"><a href="#cb208-100" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-101"><a href="#cb208-101" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-102"><a href="#cb208-102" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb208-103"><a href="#cb208-103" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-104"><a href="#cb208-104" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Was wird benötigt um Daten zu generieren? Der Effekt beschreibt den Unterschied zwischen Gruppen oder spezieller den Mittelwert in einer Normalverteilung. Die Streuung beschreibt die Unsicherheit in den Daten oder eben die Standardabweichung. Über die Fallzahl wird definiert wie viele Beobachtungen erstellt werden sollen. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-105"><a href="#cb208-105" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gen-data-venn</span></span>
<span id="cb208-106"><a href="#cb208-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-107"><a href="#cb208-107" aria-hidden="true" tabindex="-1"></a>p_venn_gen</span>
<span id="cb208-108"><a href="#cb208-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-109"><a href="#cb208-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-110"><a href="#cb208-110" aria-hidden="true" tabindex="-1"></a>Wir machen wir das jetzt praktisch in R. Dazu haben wir verschiedene Möglichkeiten, wir beginnen hier einmal mit der simpelsten Form. Mit der Funktion <span class="in">`rnorm()`</span> können wir uns zufällige Daten aus einer theoretischen Normalverteilung ziehen. Es gibt natürlich noch viel mehr <span class="in">`r*`</span>-Funktionen für die Generierung von Daten. Die Seite <span class="co">[</span><span class="ot">Probability Distributions in R</span><span class="co">](https://www.stat.umn.edu/geyer/old/5101/rlook.html)</span> zeigt nochmal einen großen Überblick. Im <span class="co">[</span><span class="ot">Kapitel zu den Verteilungen</span><span class="co">](#sec-distribution)</span> findest du dann auch nochmal mehr Informationen zu den einzelnen Funktionen.</span>
<span id="cb208-111"><a href="#cb208-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-112"><a href="#cb208-112" aria-hidden="true" tabindex="-1"></a>Fangen wir aber einmal mit der einfachen Funktion für die Normalverteilung an. Hier genieren wir uns also einmal fünf Beobachtungen aus einer Normalverteilung. Wir brauchen dafür die Fallzahl (<span class="in">`n`</span>), die wir generieren wollen. Dann den Mittelwert der theoretischen Verteilung (<span class="in">`mean`</span>) sowie die Streuung (<span class="in">`sd`</span>). Dann erhalten wir fünf Zahlen, die in der Gesamtheit den vorgestellten Zahlen entsprechen.</span>
<span id="cb208-113"><a href="#cb208-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-116"><a href="#cb208-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-117"><a href="#cb208-117" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-118"><a href="#cb208-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-119"><a href="#cb208-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-120"><a href="#cb208-120" aria-hidden="true" tabindex="-1"></a>Wenn wir jetzt den Mittelwert der fünf Zahlen berechnen, dann erhalten wir aber gar nicht einen Mittelwert von $0$ und auch nicht eine Standardabweichung von $1$ wieder. Wie kann das sein? Häufig stolperst du hier ein wenig. Wieso Daten generieren, wenn die Daten dann nicht die Eigenschaften haben, die wir wollen? Hier kommt die Grundgesamtheit und die Stichprobe ins Spiel. In der Grundgesamtheit hast du einen Mittelwert von $2$ und eine Standardabweichung von $1$ vorliegen. Du ziehst aber nur eine kleine Stichprobe wie ich dir einmal in der folgenden Abbildung zeige. Zwar liegt der theoretische Mittelwert auf der Null, aber die Mittelwerte der einzelnen Simulationen können stark variieren.</span>
<span id="cb208-121"><a href="#cb208-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-124"><a href="#cb208-124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-125"><a href="#cb208-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-126"><a href="#cb208-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-127"><a href="#cb208-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-128"><a href="#cb208-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-129"><a href="#cb208-129" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-130"><a href="#cb208-130" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-131"><a href="#cb208-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Abweichung des beobachteten Mittelwerts von dem theoretischen Mittelwert der Normalverteilung. Fünf Simulationen mit je fünf Beobachtungen wurden durchgeführt und jeweils der Mittelwert berechnet. Die Beobachtungen wurde aus einer Standardnormalverteilung mit $\\mathcal{N}(0, 1)$ gezogen. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-132"><a href="#cb208-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gen-data-normal</span></span>
<span id="cb208-133"><a href="#cb208-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-134"><a href="#cb208-134" aria-hidden="true" tabindex="-1"></a>p_theo_observed</span>
<span id="cb208-135"><a href="#cb208-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-136"><a href="#cb208-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-137"><a href="#cb208-137" aria-hidden="true" tabindex="-1"></a>Der Zusammenhang wird dir vielleicht dann nochmal in der folgenden Abbildung klarer. Ich habe hier einmal eine kleine Simulation laufen lassen. Dabei habe ich immer Daten aus einer Standardnormalverteilung mit einem Mittelwert von $0$ und einer Standardabweichung von $1$ generiert. Was ich dabei geändert habe ist die Fallzahl. Wenn ich nur zwei Beobachtungen generiere, dann finde ich eine große Breite an beobachteten Mittelwerten. Wenn ich die Fallzahl erhöhe, dann komme ich immer näher an den erwarteten Mittelwert in meinen beobachteten Daten heran. Bei eintausend Beobachtungen habe ich faktisch kaum noch eine Abweichung vorliegen. Hier siehst du eben, es kommt auch stark auf die Fallzahl an. Wenn du dir zu wenig Beobachtungen anschaust, dann wirst du nicht immer den theoretischen Mittelwert oder Effekt in den generierten Daten wiederfinden.</span>
<span id="cb208-138"><a href="#cb208-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-141"><a href="#cb208-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-142"><a href="#cb208-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-143"><a href="#cb208-143" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-144"><a href="#cb208-144" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-145"><a href="#cb208-145" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-146"><a href="#cb208-146" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-147"><a href="#cb208-147" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7.5</span></span>
<span id="cb208-148"><a href="#cb208-148" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Zusammenhang zwischen der simulierten Anzahl an Beobachtungen und dem beobachteten Mittelwert zu dem theoretischen Mittelwert der Verteilung aus der die Beobachtungen generiert wurden. Die Beobachtungen wurde aus einer Standardnormalverteilung mit $\\mathcal{N}(0, 1)$ gezogen. Es wurden 1000 Simulationen durchgeführt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-149"><a href="#cb208-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gen-data-mean-sim</span></span>
<span id="cb208-150"><a href="#cb208-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-151"><a href="#cb208-151" aria-hidden="true" tabindex="-1"></a>p1_mean <span class="sc">+</span> p2_mean <span class="sc">+</span></span>
<span id="cb208-152"><a href="#cb208-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb208-153"><a href="#cb208-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb208-154"><a href="#cb208-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb208-155"><a href="#cb208-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-156"><a href="#cb208-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-157"><a href="#cb208-157" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Welche Möglichkeiten gibt es eigentlich? {.unnumbered .unlisted}</span></span>
<span id="cb208-158"><a href="#cb208-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-159"><a href="#cb208-159" aria-hidden="true" tabindex="-1"></a>Wenn wir Daten generieren wollen, dann haben wir im Prinzip zwei Möglichkeiten. Wir bauen uns die Daten selber per Hand in Excel oder aber nutzen die entsprechenden R Pakete. Ich stelle hier die zwei größeren R Pakete vor sowie die Lösungen per Hand in Excel. Wir haben natürlich auch die Möglichkeit die Daten in R ohne Pakete zu erstellen. Das macht in einem einfacheren Setting auch mehr Sinn.</span>
<span id="cb208-160"><a href="#cb208-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-161"><a href="#cb208-161" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das <span class="co">[</span><span class="ot">R Paket `{simstudy}`</span><span class="co">](https://cran.r-project.org/web/packages/simstudy/vignettes/simstudy.html)</span> liefert eigentlich alles was wir brauchen, wenn die Daten komplizierter werden. Insbesondere wenn wir keinen normalverteilten Messwert vorliegen haben oder aber abhängige Einflussvariablen. Wenn ich größere Datensätze generiere, dann nutze ich gerne dieses Paket. Hier gibt es aber die Einschränkung, dass sich faktorielle Experimente nicht gut darstellen lassen. In diesem Fall ist die händische Erstellung manchmal einfacher.</span>
<span id="cb208-162"><a href="#cb208-162" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das <span class="co">[</span><span class="ot">R Paket `{simdata}`</span><span class="co">](https://cran.r-project.org/web/packages/simdata/vignettes/Demo.html)</span> hat den Vorteil große, komplexe Korrelationsstrukturen abzubilden. Wir können hier Netzwerkeffekte gut darstellen und dann auch in einen Datensatz übersetzen. Auch Transformationen von Daten lassen sich hier gut integrieren. Hier liegt aber nicht der Fokus auf einem faktoriellen Design mit Gruppeneffekten.</span>
<span id="cb208-163"><a href="#cb208-163" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wir schauen uns natürlich auch Excel an. Hier haben wir natürlich gleich die Möglichkeit uns die Daten dort zu bauen, wo wir die erhobenen Messwerte dann später nach dem durchgeführten Experiment auch abspeichern. Deshalb zeige ich auch hier einmal wie wir dann die Daten händisch aufbauen.</span>
<span id="cb208-164"><a href="#cb208-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-165"><a href="#cb208-165" aria-hidden="true" tabindex="-1"></a>Abschließend muss ich noch erwähnen, dass faktorielle Designs, die wir dann häufig in den Agrarwissenschaften finden, wir am besten dann händisch in R zusammenbauen. Wir nutzen dann die Funktionen, die es schon in R gibt und erstellen uns dann selber den Datensatz. Das ist im Prinzip so ähnlich wie in Excel nur das wir etwas besser nachvollziehbare Wege haben.</span>
<span id="cb208-166"><a href="#cb208-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-167"><a href="#cb208-167" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretischer Hintergrund</span></span>
<span id="cb208-168"><a href="#cb208-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-169"><a href="#cb208-169" aria-hidden="true" tabindex="-1"></a>Neben dem allgemeinen Hintergrund können wir natürlich auch etwas tiefer in die Materie einsteigen. Zum einen müssten wir überlegen, welche Effekte es eigentlich gibt. Wir wollen ja Daten generieren, die nicht gleich sind. Daher wollen wir etwas bauen, wo wir auch einen Effekt sehen. Zwar ist es auch interessant sich Daten zu generieren wo die Nullhypothese wahr ist und nichts passiert, aber das ist eher nicht der Fokus der praktischen Arbeit. Wenn wir ein Experiment machen, dann wollen wir eigentlich auch einen Effekt oder Unterschied in den Gruppen oder allgemeiner den Daten sehen.</span>
<span id="cb208-170"><a href="#cb208-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-171"><a href="#cb208-171" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Welche Effekte gibt es? {.unnumbered .unlisted}</span></span>
<span id="cb208-172"><a href="#cb208-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-173"><a href="#cb208-173" aria-hidden="true" tabindex="-1"></a>Wenn wir also Wissen, dass wir einen Effekt $\Delta$, eine Streuung $s$ und Fallzahl $n$ definieren müssen um uns zufällige Daten zu generieren, was sind denn dann die Effekte? Die Streuung und die Fallzahl sind ja relativ einfach zu verstehen. Die Fallzahl legen wir fest und es ist eben die Anzahl an Beobachtungen, die wir generieren wollen. Im Prinzip also die Anzahl an Zeilen in unserem Datensatz. Die Streuung ist schon etwas schwerer zu fassen, ist aber am Ende nichts anderes als die Varianz in den Daten. Also zum Beispiel bei einer Normalverteilung, wie stark streuen meine Beobachtungen um den Mittelwert. Die Effekt sind schon etwas schwerer zu greifen, da wir hier erst mal definieren müssen, welche Effekte es gibt. Grob gesprochen gibt es im Rahmen der Generierung von Daten zwei Effekte von Bedeutung. Entweder sind wir an einer Mittelwertsdifferenz interessiert oder aber an einem Anteil.</span>
<span id="cb208-174"><a href="#cb208-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-175"><a href="#cb208-175" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb208-176"><a href="#cb208-176" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mittelwertsdifferenz</span></span>
<span id="cb208-177"><a href="#cb208-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-178"><a href="#cb208-178" aria-hidden="true" tabindex="-1"></a>Die Mittelwertsdifferenz wird sehr häufig als Effektschätzer genutzt, wenn wir Daten erstellen wollen. Du kennst die Mittelwertsdifferenz schon aus der Darstellung der Mittelwerte von Gruppen anhand des Barplots. Hier können wir als Effekt entweder auf den absoluten Mittelwertsunterschied hinaus wollen oder aber die relative Veränderung angeben. Im Rahmen der Simulation nutzen wir die absolute Differenz sehr viel häufiger. In der folgenden Abbildung habe ich dir einmal für zwei Gruppen in einem Faktor einen Barplot sowie die Mittelwertsdifferenz mit Dotplots dargestellt.</span>
<span id="cb208-179"><a href="#cb208-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-182"><a href="#cb208-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-183"><a href="#cb208-183" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-184"><a href="#cb208-184" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-185"><a href="#cb208-185" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-186"><a href="#cb208-186" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-187"><a href="#cb208-187" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-188"><a href="#cb208-188" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7.5</span></span>
<span id="cb208-189"><a href="#cb208-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung eines einfaktoriellen Datensatzes  mit zwei Gruppen und unterschiedlichen Mittelwerten bei gleicher Varianz für einen normalverteilten Messwert. Der Effekt ist hier die Mittelwertsdifferenz. **(A)** Säulendiagramm (eng. *barplot*) **(B)** Dotplot mit absoluter und relativer Differenz zwischen den beiden Gruppen. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-190"><a href="#cb208-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gen-data-03</span></span>
<span id="cb208-191"><a href="#cb208-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-192"><a href="#cb208-192" aria-hidden="true" tabindex="-1"></a>p_barplot_intro <span class="sc">+</span> p_effect_intro <span class="sc">+</span> </span>
<span id="cb208-193"><a href="#cb208-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb208-194"><a href="#cb208-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb208-195"><a href="#cb208-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb208-196"><a href="#cb208-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-197"><a href="#cb208-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-198"><a href="#cb208-198" aria-hidden="true" tabindex="-1"></a><span class="fu">## Anteilsverhältnis</span></span>
<span id="cb208-199"><a href="#cb208-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-200"><a href="#cb208-200" aria-hidden="true" tabindex="-1"></a>Eine andere Möglichkeit sind die Anteile. Hier fragen wir, wie häufig tritt ein Ereignis in der Population auf? Daher ist die Pflanze krank? Oder aber, liegen wir im Zielbereich? Wir sind hier an einem Anteilsverhältnis interessiert. Anteile werden in unserem Kontext eigentlich immer mit ja (1) oder nein (0) kodiert. Wenn wir also zwei Gruppen haben, die gesunden und die kranken Pflanzen, dann können wir die Anteile an gesunden und kranken Pflanzen auf zwei Arten berechnen. Entweder sind wir an dem Anteil von den kranken Pflanzen an allen Pflanzen interessiert, dann rechnen wir ein Verhältnis. Wenn wir aber den Anteil von kranken Pflanzen an gesunden Pflanzen wollen, dann berechnen wir die Chance. In der folgenden Abbildung habe ich dir den Zusammenhang nochmal dargestellt.</span>
<span id="cb208-201"><a href="#cb208-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-204"><a href="#cb208-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-205"><a href="#cb208-205" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-206"><a href="#cb208-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-207"><a href="#cb208-207" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-208"><a href="#cb208-208" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-209"><a href="#cb208-209" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb208-210"><a href="#cb208-210" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10.5</span></span>
<span id="cb208-211"><a href="#cb208-211" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung zweier Effektschätzer für Anteile an einem gestapelten Säulendiagramm (eng. *stacked barplot*) für einen Faktor mit einer Gruppe $A.1$. **(A)** Das Verhältnis (eng. *ratio*) beschreibt den Anteil der blauen Beobachtungen an allen Beobachtungen. Daher ein Art mittleres Verhältnis. **(B)** Die Chance (eng. *odd*) beschreibt den Anteil von blauen zu orangen Beobachtungen. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-212"><a href="#cb208-212" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gen-data-rr-or-intro</span></span>
<span id="cb208-213"><a href="#cb208-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-214"><a href="#cb208-214" aria-hidden="true" tabindex="-1"></a>p_rr_intro <span class="sc">+</span> p_or_intro <span class="sc">+</span></span>
<span id="cb208-215"><a href="#cb208-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb208-216"><a href="#cb208-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb208-217"><a href="#cb208-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb208-218"><a href="#cb208-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-219"><a href="#cb208-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-220"><a href="#cb208-220" aria-hidden="true" tabindex="-1"></a>Etwas wilder wird es jetzt, wenn wir die Effekte zwischen zwei Gruppen mit Anteilen berechnen wollen. Hier nutzen wir dann nicht die Differenz sondern ebenfalls den Anteil. Daher haben wir es hier mit einem Anteil von einem Anteil zu tun. Daher berechnen wir hier dann das Risikoverhältnis (eng. *risk ratio*) oder aber das Chancenverhältnis (eng. *odds ratio*). Als reine Formel ist es dann meistens verwirrender, deshalb hier einmal als Abbildung visualisiert. In dem <span class="co">[</span><span class="ot">Kapitel zu den Effektschätzern</span><span class="co">](#sec-effect)</span> kannst du noch mehr lesen und dein Wissen vertiefen.</span>
<span id="cb208-221"><a href="#cb208-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-224"><a href="#cb208-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-225"><a href="#cb208-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-226"><a href="#cb208-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-227"><a href="#cb208-227" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-228"><a href="#cb208-228" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-229"><a href="#cb208-229" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb208-230"><a href="#cb208-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10.5</span></span>
<span id="cb208-231"><a href="#cb208-231" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung zweier Effektschätzer für Anteilsverhältnisse an zwei gestapelten Säulendiagramm (eng. *stacked barplot*) für einem Faktor mit zwei Gruppen $A.1$ und $A.2$. **(A)** Das Risikoverhältnis (eng. *risk ratio*) beschreibt den Anteil der blauen Beobachtungen an allen Beobachtungen im Verhältnis der beiden Gruppen. **(B)** Das Chancenverhältnis (eng. *odds ratio*) beschreibt den Anteil von blauen zu orangen Beobachtungen im Verhältnis der beiden Gruppen. Der Doppelbruch kann dann entsprechend umgeformt werden. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-232"><a href="#cb208-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gen-data-rr-or</span></span>
<span id="cb208-233"><a href="#cb208-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-234"><a href="#cb208-234" aria-hidden="true" tabindex="-1"></a>p_rr <span class="sc">+</span> p_or <span class="sc">+</span></span>
<span id="cb208-235"><a href="#cb208-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb208-236"><a href="#cb208-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb208-237"><a href="#cb208-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb208-238"><a href="#cb208-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-239"><a href="#cb208-239" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-240"><a href="#cb208-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-241"><a href="#cb208-241" aria-hidden="true" tabindex="-1"></a>Was nehmen wir hier mit?</span>
<span id="cb208-242"><a href="#cb208-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-243"><a href="#cb208-243" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Mittelwertsdifferenz ist zu gebrauchen, wenn wir von einem normalverteilten Messwert ausgehen. Oder aber, wenn wir mit den mittleren Effekt leben können. Wir wollen also die mittlere Anzahl an Blattläusen anstatt die Anzahl vergleichen. Oder aber die mittlere Infektionsrate anstatt den Anteil der kranken Pflanzen.</span>
<span id="cb208-244"><a href="#cb208-244" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Anteilsverhätnisse nutzen wir, wenn wir einen Messwert vorliegen haben, der nicht normalverteilt ist und wir über die Anteile von Gruppen in unserem Messwert sprechen wollen. Daher wir wollen über den Anteil in den Boniturnotenstufen reden oder aber den Anteil an kranken Pflanzen modellieren.</span>
<span id="cb208-245"><a href="#cb208-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-246"><a href="#cb208-246" aria-hidden="true" tabindex="-1"></a>Häufig reicht erstmal eine Genierung mit dem Mittelwert und der Mittelwertsdifferenz. Wir können uns vielen Fragstellungen erst mal mit einem Mittel annäheren und dann später nochmal differenzierter Auswerten. Beachte immer, das es hier ja um die Erstellung von künstlichen Daten geht, die selten die Komplexizität echter Daten abbilden können. Daher habe ich hier auch den Fokus auf der Normalverteilung und der Generierung von mittleren Differenzen.</span>
<span id="cb208-247"><a href="#cb208-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-248"><a href="#cb208-248" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Effekt und Streuung {.unnumbered .unlisted}</span></span>
<span id="cb208-249"><a href="#cb208-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-250"><a href="#cb208-250" aria-hidden="true" tabindex="-1"></a>Jetzt müssen wir noch den Zusammenhang zwischen Effekt und Streuung verstehen. Je höher deine Fallzahl ist, desto eher wirst du in den genierten Daten deine voreingestellten Effekte wiederfinden. Es gibt aber noch die Variable der Streuung. Wenn du eine Streuung mit ins Spiel bringst, dann werden natürlich auch deine Effekte wiederum verzerrt. Bei einer Streuung erhälst du nicht deine voreingestellten Werte genau so wieder. Das ist manchmal etwas verwirrend, aber auch häufig der Grund warum wir nicht nur einen Datensatz simulieren sondern viele, die wir dann eben mitteln. Das hat aber keine Relevanz, wenn du deine Daten generierst um deine Analysepipeline zu testen. Wir schauen uns jetzt einmal den Fall eines faktoriellen und eines kovariaten Designs an.</span>
<span id="cb208-251"><a href="#cb208-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-252"><a href="#cb208-252" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb208-253"><a href="#cb208-253" aria-hidden="true" tabindex="-1"></a><span class="fu">## Faktorielles Design</span></span>
<span id="cb208-254"><a href="#cb208-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-255"><a href="#cb208-255" aria-hidden="true" tabindex="-1"></a>In dem folgenden Beispiel habe ich ein einfaktorielles Design mit nur zwei Leveln gewählt. Wir sehen recht gut, das wir bei keinem Effekt keinen Mittelwertsunterschied vorliegen haben. Ich habe hier eine Mittelwertsdifferenz von $+3$ voreingestellt. Wenn wir dann auch keine Streuung vorliegen haben, dann liegen alle Beobachtungen auf dem Mittelwert als ein Punkt. Wenn wir dann Streuung vorliegen haben, dann spreizen die Punkte auf dem Faktorlevel. Durch die Streuung können wir dann auch nicht mehr exakt die voreingestellten Effekte wiederfinden. Je kleiner die Fallzahl, desto größer ist dann die Abweichung von den voreingestellten Effekten.</span>
<span id="cb208-256"><a href="#cb208-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-259"><a href="#cb208-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-260"><a href="#cb208-260" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-261"><a href="#cb208-261" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-262"><a href="#cb208-262" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-263"><a href="#cb208-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-264"><a href="#cb208-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb208-265"><a href="#cb208-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb208-266"><a href="#cb208-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung eines absoluten und relativen Effekt in einem einfaktoriellen Design mit zwei Leveln $A.1$ und $A.2$ als Gruppen. Der Effekt ist die absolute oder relative Mittelwertsdifferenz. Pro Gruppe wurden sechs Beobachtungen erhoben. Ohne Streuung geht die Grade direkt durch die Mittelwerte der Gruppen. **(A)** Kein Effekt und keine Streuung. Die absolute Mittelwertsdifferenz ist 0 und die relative Mittelwertsdifferenz ist x1 als Faktor. **(B)** Effekt und keine Streuung. Die absolute Mittelwertsdifferenz ist +3 und die relative Mittelwertsdifferenz ist x1.5 als Faktor.  **(C)** Kein Effekt und Streuung. Die absolute Mittelwertsdifferenz ist -0.5 und die relative Mittelwertsdifferenz ist x0.93 als Faktor.**(D)** Effekt und Streuung. Die absolute Mittelwertsdifferenz ist +2.7 und die relative Mittelwertsdifferenz ist x1.4 als Faktor. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-267"><a href="#cb208-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gen-data-square-fac</span></span>
<span id="cb208-268"><a href="#cb208-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-269"><a href="#cb208-269" aria-hidden="true" tabindex="-1"></a>p1_square_fac <span class="sc">+</span> p2_square_fac <span class="sc">+</span> p3_square_fac <span class="sc">+</span> p4_square_fac <span class="sc">+</span></span>
<span id="cb208-270"><a href="#cb208-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb208-271"><a href="#cb208-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb208-272"><a href="#cb208-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb208-273"><a href="#cb208-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-274"><a href="#cb208-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-275"><a href="#cb208-275" aria-hidden="true" tabindex="-1"></a><span class="fu">## Kovariates Design</span></span>
<span id="cb208-276"><a href="#cb208-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-277"><a href="#cb208-277" aria-hidden="true" tabindex="-1"></a>Haben wir ein kovariates Design vorliegen, dann wollen wir ja die Steigung in der Graden als Effekt einstellen. Ich habe hier eine Steigung von $+1.5$ und einen Intercept von $3$ voreingestellt. Wir brauchen immer etwas Streuung, sonst kann der Algorithmus keine Grade berechnen. Daher hier auch bei keiner Streuung ein winziger Wert, den wir dann eben auch in der Steigung wiederfinden. Ohne Streuung erhalten wir auch die voreingestellten Werte für die Steigung wieder. Haben wir keinen Effekt der Kovariaten auf den Messwert, dann haben wir auch keine Steigung. Sobald wir Streuung ins Spiel bringen, haben wir auch eine mehr oder minder starke Abweichung in den Daten. Insbesondere bei keinem Effekt und dann noch Streuung kann man schnell denken, dass wir doch was in den Daten hätten.</span>
<span id="cb208-278"><a href="#cb208-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-281"><a href="#cb208-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-282"><a href="#cb208-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-283"><a href="#cb208-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-284"><a href="#cb208-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-285"><a href="#cb208-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-286"><a href="#cb208-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb208-287"><a href="#cb208-287" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb208-288"><a href="#cb208-288" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung eines Effekts als Steigung in einem kovariaten Design. Der Effekt der Steigung ist mit $\\beta_1$ gleich +1.5 und der Intercept ist mit $\\beta_0$ gleich 3 voreingestellt. Durch die Streuung mit der geringen Fallzahl von sechs Beobachtungen kann Steigung nicht immer erreicht werden. **(A)** Kein Effekt und keine Streuung. Die Steigung ist faktisch 0 und der Intercept 3. **(B)** Effekt und keine Streuung. Dei Steigung ist 1.5 und der Intercept ist 3. **(C)** Kein Effekt und moderate Streuung. Durch die Streuung entsteht eine leichte negative Steigung und eine Abweichung vom Intercept. **(D)** Effekt und moderate Streuung. Die Steigung und der Intercept werden durch die Streuung verzerrt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-289"><a href="#cb208-289" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gen-data-square-cov</span></span>
<span id="cb208-290"><a href="#cb208-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-291"><a href="#cb208-291" aria-hidden="true" tabindex="-1"></a>p1_square_cov <span class="sc">+</span> p2_square_cov <span class="sc">+</span> p3_square_cov <span class="sc">+</span> p4_square_cov <span class="sc">+</span></span>
<span id="cb208-292"><a href="#cb208-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb208-293"><a href="#cb208-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb208-294"><a href="#cb208-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb208-295"><a href="#cb208-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-296"><a href="#cb208-296" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-297"><a href="#cb208-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-298"><a href="#cb208-298" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einschränkungen bei der Generierung {.unnumbered .unlisted}</span></span>
<span id="cb208-299"><a href="#cb208-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-300"><a href="#cb208-300" aria-hidden="true" tabindex="-1"></a>Wenn wir über die Simulation von Daten sprechen, dann kommen wir nicht darum herum einmal über die schrecklich nette Familie der Verteilungen zu sprechen. Wir haben ja nicht nur auf der rechten Seite der Tilde unsere Einflussvariablen, die entweder Faktoren oder Kovariaten sind, sondern auch die Messwerte, die wir simulieren wollen. Diese Messwerte gehören aber einer Verteilungsfamilie an. Zwar ist die Normalverteilung (eng. *gaussian*) sehr häufig aber können wir mit der Normalverteilung nicht alle Messwerte abbilden. Daher brauchen wir auch die anderen Verteilungen. Daher hier einmal die Übersicht für dich. Das R Paket <span class="in">`{simstudy}`</span> hat eine <span class="co">[</span><span class="ot">Vielzahl an Verteilungen implementiert</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/simstudy.html#distributions)</span> auf die wir hier nicht tiefer eingehen werden.</span>
<span id="cb208-301"><a href="#cb208-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-304"><a href="#cb208-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-305"><a href="#cb208-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-306"><a href="#cb208-306" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-307"><a href="#cb208-307" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-308"><a href="#cb208-308" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-309"><a href="#cb208-309" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.7</span></span>
<span id="cb208-310"><a href="#cb208-310" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-311"><a href="#cb208-311" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Erweiterte Darstellung der statistischen Modellierung. Die Messwerte $Y$ folgen einer Verteilung. Die Einflussvariablen liegen kontinuierlich als Kovariaten oder aber kategorial als Faktoren vor. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-312"><a href="#cb208-312" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gen-data-02</span></span>
<span id="cb208-313"><a href="#cb208-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-314"><a href="#cb208-314" aria-hidden="true" tabindex="-1"></a>p_lhs_rhs_detail</span>
<span id="cb208-315"><a href="#cb208-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-316"><a href="#cb208-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-317"><a href="#cb208-317" aria-hidden="true" tabindex="-1"></a>Wir konzentrieren uns hier nur auf einen kleinen Teil der möglichen Simulationen und Datengenerierungen. Das hat neben der vielen möglichen Verteilungen auch den Grund, dass wir usn hier ja nicht mit der algorithmischen Modellentwicklung in der Statistik beschäftigen wollen. Wir wollen ja nicht neue Algorithmen bauen und diese dann auf Daten evaluieren. Daher konzentrieren wir uns hier auf wenige Verteilungen, die dann aber das abbilden, was wir häufig brauchen. Wenn du mehr über Verteilungen wissen willst, dann ist die Shiny App <span class="co">[</span><span class="ot">The distribution zoo</span><span class="co">](https://ben18785.shinyapps.io/distribution-zoo/)</span> einen Besuch wert. Als Literatur kann ich dir nur @dormann2013parametrische empfehlen, der sehr detailliert für Einsteiger auf Verteilungen eingeht.</span>
<span id="cb208-318"><a href="#cb208-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-319"><a href="#cb208-319" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die **Normalverteilung** erlaubt uns das Frischegewicht, Trockengewicht oder aber Chlorophyllgehalt zu simulieren. Also im Prinzip die Messwerte, die wir hauptsächlich in einem agrawissenschaftlichen Umfeld erheben.</span>
<span id="cb208-320"><a href="#cb208-320" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die **Possionverteilung** erlaubt uns alles was wir Zählen zu simulieren. Also im Prinzip alle Anzahlen von Schädlingen oder aber Blütenstände sowie Blättern. Wir zählen hier eben etwas.</span>
<span id="cb208-321"><a href="#cb208-321" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die **Ordinalverteilung** ist dafür gut, wenn wir Noten simulieren wollen. Daher brauchen wir die Ordinalverteilung um unsere Boniturnoten zu generieren. Prinzipiell aber auch die Antwortverteilungen in einem Fragebogen.</span>
<span id="cb208-322"><a href="#cb208-322" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die **Binomialverteilung** ist die Verteilung, die wir nutzen, wenn wir nur zwei mögliche Messwerte haben. Also im prinzip gesunde Beobachtung oder kranke Beobachtung. Wir haben nur zwei Ausprägungen in dem Messwert vorliegen.</span>
<span id="cb208-323"><a href="#cb208-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-324"><a href="#cb208-324" aria-hidden="true" tabindex="-1"></a>Neben den vorgestellten Verteilungen schauen wir uns dann noch die Simulation von **pseudo Zeitreihen** an. Wir haben hier dann verschiedene Messwerte über einen zeitlichen Verlauf vorliegen. Teilweise dann in einer etwas wirren Form, da wir eventuell keinen linearen Zusammenhang mehr vorliegen haben. Daher müssen wir dann hier etwas mehr schauen, dass wir die Daten gut simuliert kriegen.</span>
<span id="cb208-325"><a href="#cb208-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-326"><a href="#cb208-326" aria-hidden="true" tabindex="-1"></a>Dann mache ich hier noch die Einschränkung, dass ich prinzipiell alles unter der Annahme der Varianzhomogenität generiere. Daher addiere ich über alle Faktorkombinationen oder Gruppen immer den gleichen Fehler auf. Im Prinzip kannst du natürlich auch für einzelne Faktorkombinationen dann einen anderen Fehler addieren und dir dafür einen Vektor mit unterschiedlichen Fehlertermen bauen, aber darauf gehe ich nur einmal kurz bei dem einfakoriellen Design ein. Und dann noch die Ergänzung, dass wir uns immer nur balancierte Designs erstellen. Das heißt wir haben keine fehlenden Werte in unseren Daten und die Gruppen in unseren Faktoren haben auch immer die gleiche Fallzahl.</span>
<span id="cb208-327"><a href="#cb208-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-328"><a href="#cb208-328" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Selbst gebaute Verteilungen {.unnumbered .unlisted}</span></span>
<span id="cb208-329"><a href="#cb208-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-330"><a href="#cb208-330" aria-hidden="true" tabindex="-1"></a>Am Ende möchte ich noch auf eine andere Art der Simulation von Daten eingehen. Wir können uns auch eine wilde Verteilung selber bauen und dann aus dieser wilden Verteilung dann unsere Beobachtungen ziehen. In dem Tutorium <span class="co">[</span><span class="ot">Wilcoxon is (almost) a one-sample t-test on signed ranks</span><span class="co">](https://lindeloev.github.io/tests-as-linear/simulations/simulate_wilcoxon.html)</span> wird einmal gezeigt wie wir das machen könnten. Wir bauen uns dazu erst mal eine Verteilung, die aus drei Verteilungen besteht. Wir haben hier aber ein paar Einschränkungen. Zum einen ist unsere Verteilung um die Null angeordnet. Das macht es einfacher verschiedene Verteilungen miteinander zu verbinden.</span>
<span id="cb208-331"><a href="#cb208-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-334"><a href="#cb208-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-335"><a href="#cb208-335" aria-hidden="true" tabindex="-1"></a>null_dist_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>), </span>
<span id="cb208-336"><a href="#cb208-336" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">exp</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>)), </span>
<span id="cb208-337"><a href="#cb208-337" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">runif</span>(<span class="dv">10000</span>, <span class="at">min=</span><span class="sc">-</span><span class="dv">3</span>, <span class="at">max=</span><span class="sc">-</span><span class="dv">2</span>)),</span>
<span id="cb208-338"><a href="#cb208-338" aria-hidden="true" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">"null"</span>)</span>
<span id="cb208-339"><a href="#cb208-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-340"><a href="#cb208-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-341"><a href="#cb208-341" aria-hidden="true" tabindex="-1"></a>Dann siehst du hier einmal die Verteilung dargestellt. Wenn wir nur aus dieser Verteilung Beobachtungen ziehen, dann haben wir natürlich einen Effekt zwischen potenziellen Gruppen.</span>
<span id="cb208-342"><a href="#cb208-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-345"><a href="#cb208-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-346"><a href="#cb208-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-347"><a href="#cb208-347" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-348"><a href="#cb208-348" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-349"><a href="#cb208-349" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-350"><a href="#cb208-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb208-351"><a href="#cb208-351" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-352"><a href="#cb208-352" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Selbstgebaute Verteilung mit einem Plateu und einem steilen Peak. Die Messwerte sind auch negative, da alle ursprünglichen drei Verteilungen um die Null zentriert sind. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-353"><a href="#cb208-353" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gen-data-own-dist</span></span>
<span id="cb208-354"><a href="#cb208-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-355"><a href="#cb208-355" aria-hidden="true" tabindex="-1"></a>null_dist_tbl <span class="sc">|&gt;</span> </span>
<span id="cb208-356"><a href="#cb208-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(y)) <span class="sc">+</span></span>
<span id="cb208-357"><a href="#cb208-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-358"><a href="#cb208-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">200</span>, <span class="at">fill =</span> <span class="st">"#56B4E9"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb208-359"><a href="#cb208-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb208-360"><a href="#cb208-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Messwert (y)"</span>, <span class="at">y =</span> <span class="st">"Anzahl"</span>)</span>
<span id="cb208-361"><a href="#cb208-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-362"><a href="#cb208-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-363"><a href="#cb208-363" aria-hidden="true" tabindex="-1"></a>Wenn wir jetzt noch einen Effekt haben wollen, dann können wir natürlich die beiden Gruppen nicht aus der gleichen Verteilung ziehen. Daher können wir uns auch noch eine Alternative Verteilung bauen indem wir einfach die Messwerte um einen fixen Effekt erhöhen. Hier wähle einen Effekt von $+2$. Du kannst natürlich auch die Nullverteilung erstmal aus dem negativen herausschieben und dann nochmal einen Effekt addieren.</span>
<span id="cb208-364"><a href="#cb208-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-367"><a href="#cb208-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-368"><a href="#cb208-368" aria-hidden="true" tabindex="-1"></a>eff_dist_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>), </span>
<span id="cb208-369"><a href="#cb208-369" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">exp</span>(<span class="fu">rnorm</span>(<span class="dv">10000</span>)), </span>
<span id="cb208-370"><a href="#cb208-370" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">runif</span>(<span class="dv">10000</span>, <span class="at">min=</span><span class="sc">-</span><span class="dv">3</span>, <span class="at">max=</span><span class="sc">-</span><span class="dv">2</span>)),</span>
<span id="cb208-371"><a href="#cb208-371" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">"alt"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-372"><a href="#cb208-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> y <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-373"><a href="#cb208-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(null_dist_tbl)</span>
<span id="cb208-374"><a href="#cb208-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-375"><a href="#cb208-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-376"><a href="#cb208-376" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du dann einmal wie sich die beiden Verteilungen mit den unterschiedlichen Effekten ergeben. Bitte beachte, dass die Alternative erst mal neu generiert wurde und nicht die verschobene Nullhypothese ist. Daher hat die Alternative natürlich auch eine andere Verteilung als die Nullhypothese.</span>
<span id="cb208-377"><a href="#cb208-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-380"><a href="#cb208-380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-381"><a href="#cb208-381" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-382"><a href="#cb208-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-383"><a href="#cb208-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-384"><a href="#cb208-384" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-385"><a href="#cb208-385" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-386"><a href="#cb208-386" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-387"><a href="#cb208-387" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Selbstgebaute Verteilung mit einem Plateu und einem steilen Peak für die Nullhypothese und die Alternativehypothese verschoben um den Effekt von $+2$. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-388"><a href="#cb208-388" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gen-data-own-dist-eff</span></span>
<span id="cb208-389"><a href="#cb208-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-390"><a href="#cb208-390" aria-hidden="true" tabindex="-1"></a>eff_dist_tbl <span class="sc">|&gt;</span> </span>
<span id="cb208-391"><a href="#cb208-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(y, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb208-392"><a href="#cb208-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-393"><a href="#cb208-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">200</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb208-394"><a href="#cb208-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb208-395"><a href="#cb208-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Messwert (y)"</span>, <span class="at">y =</span> <span class="st">"Anzahl"</span>) <span class="sc">+</span></span>
<span id="cb208-396"><a href="#cb208-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Effekt"</span>, <span class="st">"Null"</span>)) <span class="sc">+</span></span>
<span id="cb208-397"><a href="#cb208-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb208-398"><a href="#cb208-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-399"><a href="#cb208-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-400"><a href="#cb208-400" aria-hidden="true" tabindex="-1"></a>Für die Generierung deiner Daten würdest du dann mit <span class="in">`slice_sample()`</span> dir dann die gewünschten Anzahlen aus den beiden Verteilungen rausziehen. Hier hilft die tolle Funktion <span class="in">`group_by()`</span>, die dir dann alles in einem Abwasch macht. Ich will hier pro Gruppe dann nur drei zufällig ausgewählte Beobachtungen haben.</span>
<span id="cb208-401"><a href="#cb208-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-404"><a href="#cb208-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-405"><a href="#cb208-405" aria-hidden="true" tabindex="-1"></a>eff_dist_tbl <span class="sc">|&gt;</span> </span>
<span id="cb208-406"><a href="#cb208-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">|&gt;</span> </span>
<span id="cb208-407"><a href="#cb208-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb208-408"><a href="#cb208-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-409"><a href="#cb208-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-410"><a href="#cb208-410" aria-hidden="true" tabindex="-1"></a>Bei den selbstgebauten Verteilungen ist die Effektzuweisung aber überhaupt nicht einfach und ab zwei Gruppen wird es wirklich nicht mehr schön. Daher zeige ich dir hier nur die Idee, in der Anwendung zeige ich dir etwas robustere Varianten, die einfacher zu bedienen sind. Wenn es aber wirklich mal was wirres sein soll, dann ist diese Art der Verteilungserstellung wirklich eine Möglichkeit um auf künstliche Daten zu kommen.</span>
<span id="cb208-411"><a href="#cb208-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-412"><a href="#cb208-412" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb208-413"><a href="#cb208-413" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Tutorien für die Genierung von Daten</span></span>
<span id="cb208-414"><a href="#cb208-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-415"><a href="#cb208-415" aria-hidden="true" tabindex="-1"></a>Wir immer geht natürlich mehr als ich hier Vorstellen kann. Du findest im Folgenden Tutorien, die mich hier in dem Kapitel inspiriert haben. Ich habe mich ja in diesem Kapitel auf die Durchführbarkeit in R und die allgemeine Verständlichkeit konzentriert.</span>
<span id="cb208-416"><a href="#cb208-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-417"><a href="#cb208-417" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Einen guten Überblick liefert Brad Duthie in seinem Tutorium <span class="co">[</span><span class="ot">Creating simulated data sets in R</span><span class="co">](https://stirlingcodingclub.github.io/simulating_data/index.html)</span>. Hier kannst du dich dann nochmal in die Grundlagen einlesen.</span>
<span id="cb208-418"><a href="#cb208-418" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Auch Excel kann künstliche Daten generieren. Dafür schaue ich dann immer in die <span class="co">[</span><span class="ot">statistischen Funktionen (Referenz)</span><span class="co">](https://support.microsoft.com/de-de/office/statistische-funktionen-referenz-624dac86-a375-4435-bc25-76d659719ffd)</span> Seite nach. Die Seite ist leider etwas schwer zu lesen.</span>
<span id="cb208-419"><a href="#cb208-419" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Getting started simulating data in R: some helpful functions and how to use them</span><span class="co">](https://aosmith.rbind.io/2018/08/29/getting-started-simulating-data/)</span> gibt nochmal einen guten Überblick über die Standardfunktionen in R um sich schnell Daten zu generieren.</span>
<span id="cb208-420"><a href="#cb208-420" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">The distribution zoo</span><span class="co">](https://ben18785.shinyapps.io/distribution-zoo/)</span> sowie <span class="co">[</span><span class="ot">Probability Distributions in R</span><span class="co">](https://www.stat.umn.edu/geyer/old/5101/rlook.html)</span> oder aber auch <span class="co">[</span><span class="ot">Plotting Continuous Probability Distributions In R With ggplot2</span><span class="co">](https://dk81.github.io/dkmathstats_site/rvisual-cont-prob-dists.html)</span> gben nochmal einen Einblick in die Verteilungen. Dabei würde ich den Distribution Zoo als Shiny App erstmal vorziehen. Die anderen beiden Quelle liefern nochmal mehr mathematischen Hintergrund.</span>
<span id="cb208-421"><a href="#cb208-421" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-422"><a href="#cb208-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-423"><a href="#cb208-423" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb208-424"><a href="#cb208-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-425"><a href="#cb208-425" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb208-426"><a href="#cb208-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-427"><a href="#cb208-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb208-428"><a href="#cb208-428" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb208-429"><a href="#cb208-429" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, simstudy, simdata, modelr, </span></span>
<span id="cb208-430"><a href="#cb208-430" aria-hidden="true" tabindex="-1"></a><span class="in">               ggpmisc, janitor, emmeans, correlation,</span></span>
<span id="cb208-431"><a href="#cb208-431" aria-hidden="true" tabindex="-1"></a><span class="in">               data.table, ordinal, marginaleffects, conflicted)</span></span>
<span id="cb208-432"><a href="#cb208-432" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(20250820)</span></span>
<span id="cb208-433"><a href="#cb208-433" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(ggplot2::annotate)</span></span>
<span id="cb208-434"><a href="#cb208-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-435"><a href="#cb208-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-436"><a href="#cb208-436" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb208-437"><a href="#cb208-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-438"><a href="#cb208-438" aria-hidden="true" tabindex="-1"></a><span class="fu">## R Paket `{simstudy}`</span></span>
<span id="cb208-439"><a href="#cb208-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-440"><a href="#cb208-440" aria-hidden="true" tabindex="-1"></a>Der Fokus in diesem Kapitel liegt auf dem <span class="co">[</span><span class="ot">R Paket `{simstudy}`</span><span class="co">](https://cran.r-project.org/web/packages/simstudy/vignettes/simstudy.html)</span> und deren Funktionen. Wir werden in dem Abschnitt zu der Normalverteilung nochmal auf die Standardfunktionen in R eingehen und die Daten etwas mehr händisch genierieren. Wennn die Verteilungen aber komplizierter werden, dann wird es auch mit dem Standard schwerer. So ist die Poissonverteilung, die Ordinalverteilung und auch die Binomialverteilung in einem mehrfaktoriellen Design schon nicht mehr schön selber zu bauen. Insbesondere wenn die Einflussvariablen noch untereinander miteinander in Beziehung stehen.</span>
<span id="cb208-441"><a href="#cb208-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-442"><a href="#cb208-442" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle siehst du einmal die drei Variablen für das Alter, das Geschlecht und die Sprungweite von Katzenflöhen. Wir sagen, dass der Effekt des Alters immer fix $10$ ist. Das Geschlecht des Flohs hängt hier absurderweise vom Alter ab. Die Sprungweite ist dann eine Funktion des Alters und des Geschlechts. Dabei haben nicht alle Verteilungen eine Varianz wie die Normalverteilung. Deshalb haben wir hier auch Null in der Varianz bei den anderen Verteilungen stehen.</span>
<span id="cb208-443"><a href="#cb208-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-444"><a href="#cb208-444" aria-hidden="true" tabindex="-1"></a>| varname     | formula                          | variance | dist    | link     |</span>
<span id="cb208-445"><a href="#cb208-445" aria-hidden="true" tabindex="-1"></a>|:------------|:---------------------------------|:---------|:--------|:---------|</span>
<span id="cb208-446"><a href="#cb208-446" aria-hidden="true" tabindex="-1"></a>| age         | 10                               | 2        | normal  | identity |</span>
<span id="cb208-447"><a href="#cb208-447" aria-hidden="true" tabindex="-1"></a>| female      | -2 + age <span class="sc">\*</span> 0.1                  | 0        | binary  | logit    |</span>
<span id="cb208-448"><a href="#cb208-448" aria-hidden="true" tabindex="-1"></a>| jump_length | 1.5 - 0.2 <span class="sc">\*</span> age + 0.5 <span class="sc">\*</span> female | 0        | poisson | log      |</span>
<span id="cb208-449"><a href="#cb208-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-450"><a href="#cb208-450" aria-hidden="true" tabindex="-1"></a>: Beispielhafte Tabelle einer Datendefinition der Effekte der Variablen in <span class="in">`{simstudy}`</span>. Jede Zeile beschreibt eine Variable in dem Datensatz und deren mathematischen Zusammenhang oder den Effekt untereinander. Dazu kommt noch die Varianz und die entsprechende Verteilung der Variable. {#tbl-glossar-regression tbl-colwidths="15, 40, 15, 15, 15"}</span>
<span id="cb208-451"><a href="#cb208-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-452"><a href="#cb208-452" aria-hidden="true" tabindex="-1"></a>Dann können wir die obige Tabelle auch einmal in <span class="in">`{simstudy}`</span> nachbauen. Wir müssen dazu die Funktion <span class="in">`defData()`</span> nutzen und dann immer erweitern. Dabei ist natürlich die Ordnung wichtig, da wir erst Variablen erschaffen müssen bevor wir mit den Variablen weiterrechnen können. Das verlangt etwas Übung und auch ein gewissen Gefühl für die Datenerstellung. Mir ist es am Anfang auch etwas schwerer gefallen, aber diese Art der Genierung hat echte Vorteile, wenn die Daten komplexer werden.</span>
<span id="cb208-453"><a href="#cb208-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-456"><a href="#cb208-456" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-457"><a href="#cb208-457" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> </span>
<span id="cb208-458"><a href="#cb208-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"age"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, </span>
<span id="cb208-459"><a href="#cb208-459" aria-hidden="true" tabindex="-1"></a>          <span class="at">formula =</span> <span class="dv">10</span>, <span class="at">variance =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-460"><a href="#cb208-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"female"</span>, <span class="at">dist =</span> <span class="st">"binary"</span>,</span>
<span id="cb208-461"><a href="#cb208-461" aria-hidden="true" tabindex="-1"></a>          <span class="at">formula =</span> <span class="st">"-2 + age * 0.1"</span>, <span class="at">link =</span> <span class="st">"logit"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-462"><a href="#cb208-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"jump_length"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>,</span>
<span id="cb208-463"><a href="#cb208-463" aria-hidden="true" tabindex="-1"></a>          <span class="at">formula =</span> <span class="st">"1.5 - 0.2 * age + 0.5 * female"</span>, <span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb208-464"><a href="#cb208-464" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-465"><a href="#cb208-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-466"><a href="#cb208-466" aria-hidden="true" tabindex="-1"></a>Dann können wir schon die Funktion <span class="in">`genData()`</span> nutzen um uns dann entsprechend viele Beobachtungen mit der entsprechenden Datendefinition zu erschaffen. Hier habe ich einmal fünf Beobachtungen gewäht, später nutze ich dann eher eintausend Beobachtungen.</span>
<span id="cb208-467"><a href="#cb208-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-470"><a href="#cb208-470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-471"><a href="#cb208-471" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="at">n =</span> <span class="dv">5</span>, def)</span>
<span id="cb208-472"><a href="#cb208-472" aria-hidden="true" tabindex="-1"></a>dt</span>
<span id="cb208-473"><a href="#cb208-473" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-474"><a href="#cb208-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-475"><a href="#cb208-475" aria-hidden="true" tabindex="-1"></a>Manchmal ist es so, dass wir einem bestehenden Datensatz mit Vairablen eine Definition hinzufügen wollen. Das ist insbesondere bei Faktorenrastern der Fall. Dort bauen wir uns ja erst alle Faktorkombinationen und wollen dann nochmal den Messwert berechnen. Dafür können wir dann die Funktion <span class="in">`defDataAdd()`</span> nutzen, die auch Variablennamen akzeptiert, die nicht noch nicht definiert wurden. Hier bauen wir uns eine binäre Sprungweite zusammen.</span>
<span id="cb208-476"><a href="#cb208-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-479"><a href="#cb208-479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-480"><a href="#cb208-480" aria-hidden="true" tabindex="-1"></a>def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"jump_length_bin"</span>, <span class="at">formula =</span> <span class="st">"-2 + 0.5*age + 0.5*female"</span>,</span>
<span id="cb208-481"><a href="#cb208-481" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dist =</span> <span class="st">"binary"</span>, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb208-482"><a href="#cb208-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-483"><a href="#cb208-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-484"><a href="#cb208-484" aria-hidden="true" tabindex="-1"></a>Da wir bis jetzt nur die Defintion haben, müssen wir noch die Daten mit der Datendefinition zusammenbringen. Die Funktion <span class="in">`addColumn()`</span> verbindet einen bestehenden Datensatz mit einer neuen Definition und erschafft dann die neue Variable. Wir werden dieses Vorgehen dann häufiger bei den faktoriellen Daten nutzen.</span>
<span id="cb208-485"><a href="#cb208-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-488"><a href="#cb208-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-489"><a href="#cb208-489" aria-hidden="true" tabindex="-1"></a><span class="fu">addColumns</span>(def, dt)</span>
<span id="cb208-490"><a href="#cb208-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-491"><a href="#cb208-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-492"><a href="#cb208-492" aria-hidden="true" tabindex="-1"></a>Wenn dich die Datengenerierugn und das Drumrum interessiert, dann kannst du auch auf dem Blog <span class="co">[</span><span class="ot">ouR data generation -- meditations on data generating processes, R, and statistics</span><span class="co">](https://www.rdatagen.net/)</span>, welches die Themen rund um das R Paket <span class="in">`{simstudy}`</span> aufgreift einmal weiterlesen. Leider muss man sich mühsam durch die Chronik klicken, da es keine Sortierung nach Schlagworten oder ein Inhaltsverzeichnis gibt. Dafür ist da die eine oder andere spannende Idee darunter. Wenn ich was gefunden habe, habe ich es weiter unten in den Abschnitten verlinkt.</span>
<span id="cb208-493"><a href="#cb208-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-494"><a href="#cb208-494" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gängige Messwerte</span></span>
<span id="cb208-495"><a href="#cb208-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-496"><a href="#cb208-496" aria-hidden="true" tabindex="-1"></a>Im Folgenden wollen wir uns für die gängigen Verterilungsfamilien einmal die Generierung von Daten anschauen. Dabei bleibe ich länger bei der Normalverteilung und zeige dort einmal verschiedene Wege um auf künstliche Daten zu kommen. Dabei liegt auch hier der Fokus mehr auf dem faktoriellen Design, da wir es hier meistens mit etwas komplizierteren Generierungen zu tun bekommen. Nach der Normalverteilung gehe ich dann auf die Poissonverteilung und klassische Verteilung für Zähldaten ein. Dann kommt noch die ordinale und binomiale Verteilung dran. Dann haben wir die häufigsten Verteilungen besprochen. Mehr findet sich dann auch in der Vingette zu dem <span class="co">[</span><span class="ot">R Paket `{simstudy}`</span><span class="co">](https://cran.r-project.org/web/packages/simstudy/vignettes/simstudy.html)</span>.</span>
<span id="cb208-497"><a href="#cb208-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-498"><a href="#cb208-498" aria-hidden="true" tabindex="-1"></a><span class="fu">### Normalverteilt</span></span>
<span id="cb208-499"><a href="#cb208-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-500"><a href="#cb208-500" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit der wichtigsten Art der Simulation von Messwerten. Wir fangen mit der Normalverteilung an. Das heißt, dass unser Messwert $y$ normalverteilt ist und wir unsere Messwerte aus mehreren Normalverteilungen zusammenbauen. Jede der Faktoren oder Kovariaten ist normalverteilt und hat damit immer einen Mittelwert und eine Varianz als Streuung. Das macht es dann auch für uns einfacher einmal die Grundlagen zu verstehen. Am Ende kannst du dir auch mittlere Noten oder eine mittlere Anzahl generieren und dann eben etwas stärker Runden. Dazu mehr dann in den folgenden Verteilungen.</span>
<span id="cb208-501"><a href="#cb208-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-502"><a href="#cb208-502" aria-hidden="true" tabindex="-1"></a><span class="fu">### Faktorielles Design {.unnumbered .unlisted}</span></span>
<span id="cb208-503"><a href="#cb208-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-504"><a href="#cb208-504" aria-hidden="true" tabindex="-1"></a>Ein faktorielles Design heißt nichts anderes als das du einen Faktor mit Leveln vorliegen hast. Häufig ist dieser Faktor dann deine Behandlung und deine Level sind dann die Stufen der Behandlung. Wenn du nur zwei Behandlungen vorliegen hast, dann rechnest du dann später einen Zweigruppenvergleich wie eben den t-Test. Wenn du mehr als zwei Gruppen vorliegen hast, wirst du dann eine einfaktorielle ANOVA nutzen und den entsprechenden Post-hoc Test. Weil zwei Gruppen eben so schön einfach sind, fangen wir hier damit einmal an. An den zwei Gruppen kannst du dann immer schön die Grundlagen nachvollziehen.</span>
<span id="cb208-505"><a href="#cb208-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-506"><a href="#cb208-506" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktoriell $f_A$ mit 2 Leveln {.unnumbered .unlisted}</span></span>
<span id="cb208-507"><a href="#cb208-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-508"><a href="#cb208-508" aria-hidden="true" tabindex="-1"></a>Beginnen wir also einmal mit dem einfaktoriellen Design mit nur zwei Gruppen. In der folgenden schematischen Darstellung ist einmal das Modell dargestellt. Wir haben einen Messwert und einen Faktor, der aus zwei Gruppen besteht. Das Modell ist sehr simple und soll uns nur helfen einmal die Simulation von Daten in R zu verstehen.</span>
<span id="cb208-509"><a href="#cb208-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-512"><a href="#cb208-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-513"><a href="#cb208-513" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-514"><a href="#cb208-514" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-515"><a href="#cb208-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-516"><a href="#cb208-516" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-517"><a href="#cb208-517" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb208-518"><a href="#cb208-518" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-519"><a href="#cb208-519" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches simples Modell mit einem Messwert $Y$ und einer kategorialen Einflussvariablen als Faktor $f_A$ mit zwei Leveln dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-520"><a href="#cb208-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-f1lvl2-theo</span></span>
<span id="cb208-521"><a href="#cb208-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-522"><a href="#cb208-522" aria-hidden="true" tabindex="-1"></a>p_1fac_2lvl_model</span>
<span id="cb208-523"><a href="#cb208-523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-524"><a href="#cb208-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-525"><a href="#cb208-525" aria-hidden="true" tabindex="-1"></a>Wir haben jetzt unzählige Möglichkeiten die Daten zu generieren. Ich zeige hier einmal die zwei einfacheren Methoden. Einmal können wir die Daten getrennt in einem <span class="in">`tibble()`</span> erstellen. Hierbei ist es wichtig, dass wir ein balanciertes Design vorliegen haben. Dann bauen wir uns das Long-Format über <span class="in">`gather()`</span>. Wir schauen uns immer Gruppen mit gleicher Fallzahl an. Dann können wir auch die Spalten getrennt zusammenbauen und am Ende alles einmal aufaddieren. Wir haben hier einen Effekt von einer Mittelwertsdifferenz von $+3$ vorliegen bei keiner Streuung.</span>
<span id="cb208-526"><a href="#cb208-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-527"><a href="#cb208-527" aria-hidden="true" tabindex="-1"></a>:::: panel-tabset</span>
<span id="cb208-528"><a href="#cb208-528" aria-hidden="true" tabindex="-1"></a><span class="fu">## Getrennt</span></span>
<span id="cb208-529"><a href="#cb208-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-530"><a href="#cb208-530" aria-hidden="true" tabindex="-1"></a>Wenn wir wenig Gruppen haben, dann ist die getrennte Erstellung in einem <span class="in">`tibble()`</span> sehr übersichtlich. Wir stellen ja den Effekt jeweils in den einzelnen Gruppen separat ein.</span>
<span id="cb208-531"><a href="#cb208-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-534"><a href="#cb208-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-535"><a href="#cb208-535" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="fl">0.001</span>),</span>
<span id="cb208-536"><a href="#cb208-536" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"2"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">6</span>, <span class="at">sd =</span> <span class="fl">0.001</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb208-537"><a href="#cb208-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"f_a"</span>, <span class="at">value =</span> <span class="st">"y"</span>)</span>
<span id="cb208-538"><a href="#cb208-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-539"><a href="#cb208-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-540"><a href="#cb208-540" aria-hidden="true" tabindex="-1"></a><span class="fu">## Additiv</span></span>
<span id="cb208-541"><a href="#cb208-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-542"><a href="#cb208-542" aria-hidden="true" tabindex="-1"></a>Im additiven Zusammenbauen nutzen wir viele Funktionen um uns die Spalten mit den Faktoren, Effekten und Fehler aufzubauen. Am Ende addieren wir die Spalten zum Messwert auf.</span>
<span id="cb208-543"><a href="#cb208-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-546"><a href="#cb208-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-547"><a href="#cb208-547" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">f_a =</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>)),</span>
<span id="cb208-548"><a href="#cb208-548" aria-hidden="true" tabindex="-1"></a>                   <span class="at">eff_a =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>), <span class="at">each =</span> <span class="dv">5</span>),</span>
<span id="cb208-549"><a href="#cb208-549" aria-hidden="true" tabindex="-1"></a>                   <span class="at">error =</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(f_a), <span class="dv">0</span>, <span class="fl">0.001</span>),</span>
<span id="cb208-550"><a href="#cb208-550" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> eff_a <span class="sc">+</span> error)</span>
<span id="cb208-551"><a href="#cb208-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-552"><a href="#cb208-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-553"><a href="#cb208-553" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb208-554"><a href="#cb208-554" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01_small.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb208-555"><a href="#cb208-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-556"><a href="#cb208-556" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *Das additive Zusammenbauen funktioniert hier nur in dieser Form so gut, da wir einen normalverteilten Messwert haben. In anderen Verteilungen können wir nicht einfach den Fehler addieren. Das hängt hier mit der Symmetrie der Normalverteilung um den Mittelwert zusammen.*</span></span>
<span id="cb208-557"><a href="#cb208-557" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb208-558"><a href="#cb208-558" aria-hidden="true" tabindex="-1"></a><span class="at">::::</span></span>
<span id="cb208-559"><a href="#cb208-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-560"><a href="#cb208-560" aria-hidden="true" tabindex="-1"></a>Dann rechnen wir einfach einmal einen schnellen t-Test und schauen, ob wir die Differenz wieder erhalten. Wir sehen, dass wir die gleichen Mittelwerte wiedergeben bekommen und natürlich auch einen signifikanten Unterschied. Die Streuung ist ja super klein.</span>
<span id="cb208-561"><a href="#cb208-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-564"><a href="#cb208-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-565"><a href="#cb208-565" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(y <span class="sc">~</span> f_a, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb208-566"><a href="#cb208-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-567"><a href="#cb208-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-568"><a href="#cb208-568" aria-hidden="true" tabindex="-1"></a>Wir können uns den Zusammenhang auch als eine simple lineare Regression darstellen lassen. Da ich die Streuung sehr gering eingestellt habe, können wir auch die Koeffizienten exakt so wieder erhalten. In der folgenden linearen Regression siehst du einmal wie die Mittelwertsdifferenz wieder der eingestellten Differenz entspricht.</span>
<span id="cb208-569"><a href="#cb208-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-572"><a href="#cb208-572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-573"><a href="#cb208-573" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a, fac1_tbl) <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-574"><a href="#cb208-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-575"><a href="#cb208-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-576"><a href="#cb208-576" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung ist der Zusammenhang nochmal graphisch dargestellt. Wir haben den Mittelwert der ersten Gruppe als Intercept im Modell und die Steigung der Graden als Mittelwertsdifferenz. Wir sehen hier also nochmal den Zusammenhang zwischen der Datengenerierung und der linearen Regression.</span>
<span id="cb208-577"><a href="#cb208-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-580"><a href="#cb208-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-581"><a href="#cb208-581" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-582"><a href="#cb208-582" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-583"><a href="#cb208-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-584"><a href="#cb208-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-585"><a href="#cb208-585" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-586"><a href="#cb208-586" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb208-587"><a href="#cb208-587" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung der einfaktoriellen Simulation mit zwei Gruppen. Der Intercept stellt den Mittelwert der ersten Gruppe dar. Die Mittelwertsdifferenz ist die Steigung der Graden. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-588"><a href="#cb208-588" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-fa-1</span></span>
<span id="cb208-589"><a href="#cb208-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-590"><a href="#cb208-590" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fac1_tbl, <span class="fu">aes</span>(f_a, y)) <span class="sc">+</span></span>
<span id="cb208-591"><a href="#cb208-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-592"><a href="#cb208-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-593"><a href="#cb208-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-594"><a href="#cb208-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">3</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-595"><a href="#cb208-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#E69F00"</span>) <span class="sc">+</span></span>
<span id="cb208-596"><a href="#cb208-596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb208-597"><a href="#cb208-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, </span>
<span id="cb208-598"><a href="#cb208-598" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y..)), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb208-599"><a href="#cb208-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A.1"</span>, <span class="st">"A.2"</span>, <span class="st">"A.3"</span>)) <span class="sc">+</span></span>
<span id="cb208-600"><a href="#cb208-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Einfaktorielle Simulation mit 2 Leveln"</span>,</span>
<span id="cb208-601"><a href="#cb208-601" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Intercept ist der Mittelwert von Gruppe A.1"</span>,</span>
<span id="cb208-602"><a href="#cb208-602" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Faktor A"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>)</span>
<span id="cb208-603"><a href="#cb208-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-604"><a href="#cb208-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-605"><a href="#cb208-605" aria-hidden="true" tabindex="-1"></a>Manchmal wollen wir uns auch Daten erstellen, die nicht die gleiche Varianz in allen Gruppen haben. In diesem Fall hilft am meisten die getrennte Erstellung. Wir nehmen dann einfach in jeder Gruppe eine andere Varianz und lassen dann die Daten erstellen. In dem folgenden Kasten siehst du nochmal ein Beispiel für die Generierung von Daten mit Varianzheterogenität. Ob wir das brauchen hängt dann davon ab, was du mit den simulierten Daten ausprobieren möchtest.</span>
<span id="cb208-606"><a href="#cb208-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-607"><a href="#cb208-607" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb208-608"><a href="#cb208-608" aria-hidden="true" tabindex="-1"></a><span class="fu">## Varianzheterogeniät zwischen den Gruppen</span></span>
<span id="cb208-609"><a href="#cb208-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-610"><a href="#cb208-610" aria-hidden="true" tabindex="-1"></a>In der getrennten Erstellung von Daten können wir dann für jede Gruppe eine eigene Varianz festlegen. Hier habe ich in der einen Gruppe eine Standardabweichung von $5$ und in der anderen Gruppe eine Standardabweichung von $1$ angenommen. Ich brauche diese Art der Erstellung für den Welch t-Test oder aber in <span class="in">`{emmeans}`</span> und dem multiplen Testen.</span>
<span id="cb208-611"><a href="#cb208-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-614"><a href="#cb208-614" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-615"><a href="#cb208-615" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb208-616"><a href="#cb208-616" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">5</span>),</span>
<span id="cb208-617"><a href="#cb208-617" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"2"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">6</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb208-618"><a href="#cb208-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"f_a"</span>, <span class="at">value =</span> <span class="st">"y"</span>)</span>
<span id="cb208-619"><a href="#cb208-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-620"><a href="#cb208-620" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-621"><a href="#cb208-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-622"><a href="#cb208-622" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktoriell $f_A$ mit \&gt;2 Leveln {.unnumbered .unlisted}</span></span>
<span id="cb208-623"><a href="#cb208-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-624"><a href="#cb208-624" aria-hidden="true" tabindex="-1"></a>Kommen wir jetzt zu den etwas spannenderen Teil. Wir haben jetzt ein faktorielles Design mit einem Faktor und drei Leveln vorliegen. Ich habe dir einmal das Modell in der folgenden Abbildung einmal schematisch dargestellt. Wir würden hier also Daten bauen, die wir dann mit einer einfaktoriellen ANOVA oder aber dann mit einem Post-hoc Test wie <span class="in">`{emmeans}`</span> auswerten würden. Der Messwert hier folgt daher einer Normalverteilung.</span>
<span id="cb208-625"><a href="#cb208-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-628"><a href="#cb208-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-629"><a href="#cb208-629" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-630"><a href="#cb208-630" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-631"><a href="#cb208-631" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-632"><a href="#cb208-632" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-633"><a href="#cb208-633" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb208-634"><a href="#cb208-634" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-635"><a href="#cb208-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches simples Modell mit einem Messwert $Y$ und einer kategorialen Einflussvariablen als Faktor $f_A$ mit drei Leveln dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-636"><a href="#cb208-636" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-f1lvl3-theo</span></span>
<span id="cb208-637"><a href="#cb208-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-638"><a href="#cb208-638" aria-hidden="true" tabindex="-1"></a>p_1fac_3lvl_model</span>
<span id="cb208-639"><a href="#cb208-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-640"><a href="#cb208-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-641"><a href="#cb208-641" aria-hidden="true" tabindex="-1"></a>Wir können die Daten einmal getrennt bauen und hätten dann auch einfach die Möglichkeit die Varianzen auch unterschiedlich zu machen. Beachte immer, dass ich hier extrem geringe Varianzen mit $0.001$ eingestellt habe um dann bei der geringen Fallzahl auch auf die voreingestellten Effekte zu kommen. Du kannst dir das Modell auch additiv bauen, dann wird es aber etwas komplexer und der Fehler ist dann homogen, wenn du nicht den Fehlervektor nochmal aufbrechen willst. Dann zeige ich dir die Generation der Daten auch nochmal in Excel.</span>
<span id="cb208-642"><a href="#cb208-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-643"><a href="#cb208-643" aria-hidden="true" tabindex="-1"></a>:::: panel-tabset</span>
<span id="cb208-644"><a href="#cb208-644" aria-hidden="true" tabindex="-1"></a><span class="fu">## `tibble()`</span></span>
<span id="cb208-645"><a href="#cb208-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-646"><a href="#cb208-646" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Getrennt {.unnumbered .unlisted}</span></span>
<span id="cb208-647"><a href="#cb208-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-648"><a href="#cb208-648" aria-hidden="true" tabindex="-1"></a>Wenn wir wenig Gruppen haben, dann ist die getrennte Erstellung in einem <span class="in">`tibble()`</span> sehr übersichtlich. Wir stellen ja den Effekt jeweils in den einzelnen Gruppen separat ein. Wir bauen hier alles um die Mittelwerte auf.</span>
<span id="cb208-649"><a href="#cb208-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-652"><a href="#cb208-652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-653"><a href="#cb208-653" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">2</span>, <span class="fl">0.001</span>),</span>
<span id="cb208-654"><a href="#cb208-654" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"2"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="fl">0.001</span>),</span>
<span id="cb208-655"><a href="#cb208-655" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"3"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="fl">0.001</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb208-656"><a href="#cb208-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"f_a"</span>, <span class="at">value =</span> <span class="st">"y"</span>)</span>
<span id="cb208-657"><a href="#cb208-657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-658"><a href="#cb208-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-659"><a href="#cb208-659" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Additiv {.unnumbered .unlisted}</span></span>
<span id="cb208-660"><a href="#cb208-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-661"><a href="#cb208-661" aria-hidden="true" tabindex="-1"></a>Im additiven Zusammenbauen nutzen wir viele Funktionen um uns die Spalten mit den Faktoren, Effekten und Fehler aufzubauen. Am Ende addieren wir die Spalten zum Messwert auf. Hier sind natürlich heterogene Varianzen schwerer darzustellen, da wir den Fehler für jedes Level einzeln generieren müssten. Auch hier wähle ich die Mittelwerte zuerst.</span>
<span id="cb208-662"><a href="#cb208-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-665"><a href="#cb208-665" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-666"><a href="#cb208-666" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">f_a =</span> <span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>)),</span>
<span id="cb208-667"><a href="#cb208-667" aria-hidden="true" tabindex="-1"></a>                   <span class="at">eff_a =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">4</span>), <span class="at">each =</span> <span class="dv">5</span>),</span>
<span id="cb208-668"><a href="#cb208-668" aria-hidden="true" tabindex="-1"></a>                   <span class="at">error =</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(f_a), <span class="dv">0</span>, <span class="fl">0.001</span>),</span>
<span id="cb208-669"><a href="#cb208-669" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> eff_a <span class="sc">+</span> error)</span>
<span id="cb208-670"><a href="#cb208-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-671"><a href="#cb208-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-672"><a href="#cb208-672" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Effekt {.unnumbered .unlisted}</span></span>
<span id="cb208-673"><a href="#cb208-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-674"><a href="#cb208-674" aria-hidden="true" tabindex="-1"></a>Jetzt können wir aber das Ganze auch von der Effektseite aufziehen. Wir legen also fest, wie stark sich die Mittelwerte unterscheiden sollen anstatt die Mittelwerte selber. Daher eben der Effekt als Ausgangspunkt für unsere Datengenerierung. Als erstes bauen wir uns aber einmal den Datensatz nur für den Faktor. Die Spalte <span class="in">`rep`</span> gibt an wie viele Wiederholungen wir pro Level haben.</span>
<span id="cb208-675"><a href="#cb208-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-678"><a href="#cb208-678" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-679"><a href="#cb208-679" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-680"><a href="#cb208-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">as_factor</span>(f_a))</span>
<span id="cb208-681"><a href="#cb208-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-682"><a href="#cb208-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-683"><a href="#cb208-683" aria-hidden="true" tabindex="-1"></a>Dann nutzen wir den Faktor um eine Dummykodierung zuerstellen. Mit der Dummykodierung können wir dann den Leveln des Faktors die Effekte zuordnen.</span>
<span id="cb208-684"><a href="#cb208-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-687"><a href="#cb208-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-688"><a href="#cb208-688" aria-hidden="true" tabindex="-1"></a>fac1_mat <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb208-689"><a href="#cb208-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_matrix</span>(<span class="sc">~</span> f_a) <span class="sc">|&gt;</span> </span>
<span id="cb208-690"><a href="#cb208-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb208-691"><a href="#cb208-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-692"><a href="#cb208-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-693"><a href="#cb208-693" aria-hidden="true" tabindex="-1"></a>Jetzt brauchen wir die Effekte. Wir haben hier den Mittelwert der ersten Gruppe in den Intercept und dann die Effekte danach. Daher hat das zweite Level einen um 4 höheren Mittelwert. Das dritte Level ist dann nur um 2 größer als der Intercept.</span>
<span id="cb208-694"><a href="#cb208-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-697"><a href="#cb208-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-698"><a href="#cb208-698" aria-hidden="true" tabindex="-1"></a>eff_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">intercept =</span> <span class="dv">2</span>, </span>
<span id="cb208-699"><a href="#cb208-699" aria-hidden="true" tabindex="-1"></a>             <span class="at">f_a2 =</span> <span class="dv">4</span>, <span class="at">f_a3 =</span> <span class="dv">2</span>)</span>
<span id="cb208-700"><a href="#cb208-700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-701"><a href="#cb208-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-702"><a href="#cb208-702" aria-hidden="true" tabindex="-1"></a>Dann kombinieren wir die Modellmatrix mit den Information wo der Effekt angewendet werden soll mit dem Vektor der Effekte. Wir erhalten dann unsere Messwerte in dem Vektor <span class="in">`y_raw`</span>. Hier sind natürlich pro Faktor die Werte immer gleich. Wir haben ja noch keine Streuung hinzugefügt.</span>
<span id="cb208-703"><a href="#cb208-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-706"><a href="#cb208-706" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-707"><a href="#cb208-707" aria-hidden="true" tabindex="-1"></a>y_vec <span class="ot">&lt;-</span> fac1_mat <span class="sc">%*%</span> eff_vec</span>
<span id="cb208-708"><a href="#cb208-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-709"><a href="#cb208-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-710"><a href="#cb208-710" aria-hidden="true" tabindex="-1"></a>Am Ende erhalten wir dann die echten generierten Messwerte indem wir zu unserem Messwert noch einen Fehler addieren. Ich nehme hier einen sehr kleinen Fehler, damit wir die Effekt auch gleich wiedersehen. Sonst müsste ich eine sehr hohe Fallzahl simulieren.</span>
<span id="cb208-711"><a href="#cb208-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-714"><a href="#cb208-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-715"><a href="#cb208-715" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb208-716"><a href="#cb208-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> y_vec <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(y_vec), <span class="dv">0</span>, <span class="fl">0.001</span>))</span>
<span id="cb208-717"><a href="#cb208-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-718"><a href="#cb208-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-719"><a href="#cb208-719" aria-hidden="true" tabindex="-1"></a>Welche der drei Varianten du dann nutzt hängt davon ab, wozu du die generierten Datem brauchst. Jede Variante zeigt eben nochmal anders wie Daten entstehen.</span>
<span id="cb208-720"><a href="#cb208-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-721"><a href="#cb208-721" aria-hidden="true" tabindex="-1"></a><span class="fu">## Excel</span></span>
<span id="cb208-722"><a href="#cb208-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-723"><a href="#cb208-723" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb208-724"><a href="#cb208-724" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb208-725"><a href="#cb208-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-726"><a href="#cb208-726" aria-hidden="true" tabindex="-1"></a>Die Erstellung von Daten in Excel ist nicht für die *wissenschaftliche* Bewertung von Algorithmen sinnvoll und angebracht. Wir nutzen hier Excel um recht einfach uns zufällig Daten zu erstellen. Wir nutzen dann die künstlichen Exceldaten um unsere Analyse für unsere echten experimentelle Daten zu üben. Auch ist die vereinfachte Erstellung von künstlichen Daten in Excel hilfreich um die zugrundeliegende Konzepte nochmal zu verstehen.</span>
<span id="cb208-727"><a href="#cb208-727" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-728"><a href="#cb208-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-729"><a href="#cb208-729" aria-hidden="true" tabindex="-1"></a>In der folgenden Datei findest du dann einmal die Generierung der einfaktoriellen Daten in Excel. Hier müssen wir dann das additive Zusammenbauen nutzen. Deshalb ist die Datei etwas größer. Am Ende brauchen wir die Spalte <span class="in">`Faktor A`</span> und die Spalte <span class="in">`Messwert`</span>.</span>
<span id="cb208-730"><a href="#cb208-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-733"><a href="#cb208-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-734"><a href="#cb208-734" aria-hidden="true" tabindex="-1"></a>excel_fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/data_generation_excel.xlsx"</span>,</span>
<span id="cb208-735"><a href="#cb208-735" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sheet =</span> <span class="st">"einfaktoriell"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-736"><a href="#cb208-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb208-737"><a href="#cb208-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">faktor_a =</span> <span class="fu">as_factor</span>(faktor_a))</span>
<span id="cb208-738"><a href="#cb208-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-739"><a href="#cb208-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-740"><a href="#cb208-740" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung habe ich dir einmal normalverteilte Messwerte in Excel aus einem einfaktoriellen Design generiert. Zuerst legen wir den allgemeinen Intercept fest, dann noch die Effekte der einzelnen Gruppen. Am Ende brauchen wir noch den Fehler oder die Streuung mit der Funktion <span class="in">`NORMINV()`</span>. Hier habe ich eine Standardabweichung von $2$ voreingestellt.</span>
<span id="cb208-741"><a href="#cb208-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-744"><a href="#cb208-744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-745"><a href="#cb208-745" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-746"><a href="#cb208-746" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-747"><a href="#cb208-747" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-748"><a href="#cb208-748" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-749"><a href="#cb208-749" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb208-750"><a href="#cb208-750" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb208-751"><a href="#cb208-751" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Annotierte Generierung von einfaktoriellen Daten mit drei Gruppen in Excel. Der Fehler wird durch die Funktion `NORMINV()` in Excel abgebildet. Der normalverteilte Messwert addiert sich aus den Spalten `B:D` auf. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-752"><a href="#cb208-752" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gen-data-fac1-excel</span></span>
<span id="cb208-753"><a href="#cb208-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-754"><a href="#cb208-754" aria-hidden="true" tabindex="-1"></a>p_fac1_excel</span>
<span id="cb208-755"><a href="#cb208-755" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-756"><a href="#cb208-756" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb208-757"><a href="#cb208-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-758"><a href="#cb208-758" aria-hidden="true" tabindex="-1"></a>Dann schauen wir einmal, ob wir dann die Mittelwerte und die entsprechenden Differenzen auch in <span class="in">`{emmeans}`</span> wiederfinden. Die Funktion <span class="in">`pwpm()`</span> gibt uns auf der Diagonalen die Mittelwerte wieder und dann die Differenzen in der unteren Hälfte der Matrix. Damit haben wir dann auch alle Informationen auf einmal zusammen. Die Mittelwerte sind die voreingestellten und die Effekte sind ebenfalls richtig.</span>
<span id="cb208-759"><a href="#cb208-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-762"><a href="#cb208-762" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-763"><a href="#cb208-763" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a, fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb208-764"><a href="#cb208-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> f_a) <span class="sc">|&gt;</span> </span>
<span id="cb208-765"><a href="#cb208-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>() </span>
<span id="cb208-766"><a href="#cb208-766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-767"><a href="#cb208-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-768"><a href="#cb208-768" aria-hidden="true" tabindex="-1"></a>Wir können uns dann das Modell auch nochmal in dem linearen Kontext anschauen. Hier haben wir dann aber zwei Möglichkeiten die Referenz des Intercepts zu setzen. In der klassischen Kodierung setzen wir den Intercept auf den Mittelwert des ersten LEvels oder eben der ersten Gruppe. Wir nennen diese Kodierung dann *Treatment coding*. Dafür müssen wir nichts machen, dass ist die Standardeinstellung. Wir können aber auch das *Effect coding* wählen, dann liegt der Intercept auf dem globalen Mittelwert. Was ja eher der Interpretation der ANOVA entspricht. Es gibt natürlich noch weitere Kodierungen, wie du im Tutorial <span class="co">[</span><span class="ot">R Library Contrast Coding Systems for categorical variables</span><span class="co">](https://stats.oarc.ucla.edu/r/library/r-library-contrast-coding-systems-for-categorical-variables/)</span> nachlesen kannst.</span>
<span id="cb208-769"><a href="#cb208-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-770"><a href="#cb208-770" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb208-771"><a href="#cb208-771" aria-hidden="true" tabindex="-1"></a><span class="fu">## Treatment coding (default)</span></span>
<span id="cb208-772"><a href="#cb208-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-773"><a href="#cb208-773" aria-hidden="true" tabindex="-1"></a>Der Standard in der linearen Modellierung von Faktoren ist das *Treatment coding* mit <span class="in">`contr.treatment`</span> in der Funktion <span class="in">`lm()`</span>. Wir müssen da auch eigentlich nichts ändern, aber ich habe es hier einmal angeben damit du siehst, wo du die Kodierung ändern musst. Jeder Faktor muss einzeln geändert werden.</span>
<span id="cb208-774"><a href="#cb208-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-777"><a href="#cb208-777" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-778"><a href="#cb208-778" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a, fac1_tbl, <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">f_a =</span> <span class="st">"contr.treatment"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb208-779"><a href="#cb208-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-780"><a href="#cb208-780" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-781"><a href="#cb208-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-782"><a href="#cb208-782" aria-hidden="true" tabindex="-1"></a>Wir erhalten dann aber die zu erwartenden Koeffizienten wieder. Der Mittelwert der ersten Gruppe ist der Intercept. Die Koeffizienten sind die Änderungen der anderen Level zum Intercept. Ich habe dir den Zusammenhang nochmal in der folgenden Abbildung dargestellt. Wir sehen hier sehr schön, dass eben das erste Level $A.1$ den Intercept ausmacht. Die Änderungen als Mittelwertsdifferenzen zum Intercept sind die Koeffizienten in dem linearen Modell.</span>
<span id="cb208-783"><a href="#cb208-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-786"><a href="#cb208-786" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-787"><a href="#cb208-787" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-788"><a href="#cb208-788" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-789"><a href="#cb208-789" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-790"><a href="#cb208-790" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-791"><a href="#cb208-791" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-792"><a href="#cb208-792" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb208-793"><a href="#cb208-793" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung des *Treatment coding* in einem linearen Modell. Der Intercept ist der Mittelwert des ersten Levels des Faktors. Die Koeffizienten des Modells beschreiben die Mittelwertsdifferenz zum Intercept in den anderen Leveln. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-794"><a href="#cb208-794" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-fa-21</span></span>
<span id="cb208-795"><a href="#cb208-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-796"><a href="#cb208-796" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fac1_tbl, <span class="fu">aes</span>(f_a, y)) <span class="sc">+</span></span>
<span id="cb208-797"><a href="#cb208-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-798"><a href="#cb208-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-799"><a href="#cb208-799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-800"><a href="#cb208-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">2</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-801"><a href="#cb208-801" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb208-802"><a href="#cb208-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, </span>
<span id="cb208-803"><a href="#cb208-803" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y..)), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb208-804"><a href="#cb208-804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A.1"</span>, <span class="st">"A.2"</span>, <span class="st">"A.3"</span>)) <span class="sc">+</span></span>
<span id="cb208-805"><a href="#cb208-805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Treatment coding"</span>,</span>
<span id="cb208-806"><a href="#cb208-806" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Intercept ist der Mittelwert von Gruppe A.1"</span>,</span>
<span id="cb208-807"><a href="#cb208-807" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Faktor A"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>)</span>
<span id="cb208-808"><a href="#cb208-808" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-809"><a href="#cb208-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-810"><a href="#cb208-810" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effect coding</span></span>
<span id="cb208-811"><a href="#cb208-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-812"><a href="#cb208-812" aria-hidden="true" tabindex="-1"></a>Das *Effect coding* können wir mit der Option <span class="in">`contr.sum`</span> in der Funktion <span class="in">`lm()`</span> nutzen. Wir müssen dies für jeden einzelnen Faktor einstellen. Ein Mischmasch würde ich stark vermeiden wollen. Wir haben dann als Intercept das globale Mittel des Messwerts über alle Gruppen. Die Koeffizienten sind dann die Mittelwertsdifferenzen zum globalen Mittel. Das letzte Level fehlt und lässt sich aus den vorherigen Leveln berechnen, da die Summe der Koeffizienten Null sein muss. In unserem Fall wäre die Mittelwertsdifferenz dann auch $0$, da sich die beiden vorherigen Level schon auf Null aufaddieren.</span>
<span id="cb208-813"><a href="#cb208-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-816"><a href="#cb208-816" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-817"><a href="#cb208-817" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a, fac1_tbl, <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">f_a =</span> <span class="st">"contr.sum"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb208-818"><a href="#cb208-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-819"><a href="#cb208-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-820"><a href="#cb208-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-821"><a href="#cb208-821" aria-hidden="true" tabindex="-1"></a>Der Zusammenhang wird dann in der folgenden Darstellung nochmal klarer. Wir haben hier den globalen Mittelwert von $4$ über alle Gruppen. Die Koeffizienten sind jetzt die Abweichung der lokalen Mittelwerte zu dem globalen Mittel. Eigentlich wie wir es auch aus einer einfaktoriellen ANOVA erwarten würden.</span>
<span id="cb208-822"><a href="#cb208-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-825"><a href="#cb208-825" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-826"><a href="#cb208-826" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-827"><a href="#cb208-827" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-828"><a href="#cb208-828" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-829"><a href="#cb208-829" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-830"><a href="#cb208-830" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-831"><a href="#cb208-831" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb208-832"><a href="#cb208-832" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung des *Effect coding* in einem linearen Modell. Der Intercept ist der globale Mittelwert über alle Gruppen. Die Koeffizienten des Modells beschreiben die Mittelwertsdifferenz zum globalen Mittelwert in den anderen Leveln. Das letzte Level fehlt und lässt sich aus den vorherigen Leveln berechnen, da die Summe der Koeffizienten Null sein muss. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-833"><a href="#cb208-833" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-fa-22</span></span>
<span id="cb208-834"><a href="#cb208-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-835"><a href="#cb208-835" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fac1_tbl, <span class="fu">aes</span>(f_a, y)) <span class="sc">+</span></span>
<span id="cb208-836"><a href="#cb208-836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-837"><a href="#cb208-837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-838"><a href="#cb208-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-839"><a href="#cb208-839" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-840"><a href="#cb208-840" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb208-841"><a href="#cb208-841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, </span>
<span id="cb208-842"><a href="#cb208-842" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y..)), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb208-843"><a href="#cb208-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A.1"</span>, <span class="st">"A.2"</span>, <span class="st">"A.3"</span>)) <span class="sc">+</span></span>
<span id="cb208-844"><a href="#cb208-844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Effect coding"</span>,</span>
<span id="cb208-845"><a href="#cb208-845" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Intercept ist der globale Mittelwert"</span>,</span>
<span id="cb208-846"><a href="#cb208-846" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Faktor A"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>)</span>
<span id="cb208-847"><a href="#cb208-847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-848"><a href="#cb208-848" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-849"><a href="#cb208-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-850"><a href="#cb208-850" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktoriell ohne Interaktion $f_A + f_B$ {.unnumbered .unlisted}</span></span>
<span id="cb208-851"><a href="#cb208-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-852"><a href="#cb208-852" aria-hidden="true" tabindex="-1"></a>Sehr häufig haben wir aber mehrfaktorielle Designs vorliegen. Selten betrachten wir nur einen Faktor. Daher habe ich jetzt einmal ein zweifaktorielles Design in der folgenden schematischen Darstellung mitgebracht. Wir haben hier zwei Faktoren. Der Hauptfaktor $f_A$ hat drei Level und der zweite Faktor $f_B$ hat zwei Level. Der Messwert ist weiterhin normalverteilt. Jetzt müssen wir uns gleich etwas strecken um die Daten zusammenzubauen. Wir haben aber keine Interaktion zwischen den Faktoren vorliegen. Das schauen wir uns dann gleich nochmal getrennt an.</span>
<span id="cb208-853"><a href="#cb208-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-856"><a href="#cb208-856" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-857"><a href="#cb208-857" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-858"><a href="#cb208-858" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-859"><a href="#cb208-859" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-860"><a href="#cb208-860" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-861"><a href="#cb208-861" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb208-862"><a href="#cb208-862" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-863"><a href="#cb208-863" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches simples Modell mit einem Messwert $Y$ und einer kategorialen Einflussvariablen als Faktor $f_A$ mit drei Leveln sowie einer kategorialen Einflussvariablen als Faktor $f_B$ mit zwei Leveln dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-864"><a href="#cb208-864" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-f2nointer-theo</span></span>
<span id="cb208-865"><a href="#cb208-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-866"><a href="#cb208-866" aria-hidden="true" tabindex="-1"></a>p_2fac_nointer_model <span class="sc">+</span></span>
<span id="cb208-867"><a href="#cb208-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>) </span>
<span id="cb208-868"><a href="#cb208-868" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-869"><a href="#cb208-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-870"><a href="#cb208-870" aria-hidden="true" tabindex="-1"></a>Da wir keine Interaktion vorliegen haben und auch Varianzhomogenität kann ich mir die Daten wie folgt bauen. Zuerst baue ich mir alle Faktorenkombinationen mit fünf Wiederholungen pro Kombination mit der Funktion <span class="in">`expand_grid()`</span> dann kann ich mir den Messwert bauen indem ich immer den gleichen Effekt für jedes Level aufaddieren. Wir haben hier ja keine Interaktion vorliegen. Die Effekte steigen linear an. Darüber hinaus habe ich auch keine Streuung eingestellt, da mit wir bei der kleinen Fallzahl auch gleich unsere Effekte wiedersehen.</span>
<span id="cb208-871"><a href="#cb208-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-874"><a href="#cb208-874" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-875"><a href="#cb208-875" aria-hidden="true" tabindex="-1"></a>fac2_nointer_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb208-876"><a href="#cb208-876" aria-hidden="true" tabindex="-1"></a>                                <span class="at">f_b =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb208-877"><a href="#cb208-877" aria-hidden="true" tabindex="-1"></a>                                <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-878"><a href="#cb208-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb208-879"><a href="#cb208-879" aria-hidden="true" tabindex="-1"></a>             <span class="dv">2</span> <span class="sc">*</span> f_a <span class="sc">+</span></span>
<span id="cb208-880"><a href="#cb208-880" aria-hidden="true" tabindex="-1"></a>             <span class="dv">3</span> <span class="sc">*</span> f_b <span class="sc">+</span></span>
<span id="cb208-881"><a href="#cb208-881" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="fl">0.001</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb208-882"><a href="#cb208-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">as_factor</span>(f_a),</span>
<span id="cb208-883"><a href="#cb208-883" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">as_factor</span>(f_b))</span>
<span id="cb208-884"><a href="#cb208-884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-885"><a href="#cb208-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-886"><a href="#cb208-886" aria-hidden="true" tabindex="-1"></a>Dann schauen wir einmal, ob wir dann die Mittelwerte und die entsprechenden Differenzen auch in <span class="in">`{emmeans}`</span> wiederfinden. Die Funktion <span class="in">`pwpm()`</span> gibt uns auf der Diagonalen die Mittelwerte wieder und dann die Differenzen in der unteren Hälfte der Matrix. Damit haben wir dann auch alle Informationen auf einmal zusammen. Das wird dann doch recht groß und dann teilweise etwas unübersichtlich. Schaue gleich mal in der unteren Abbildung, da wird vermutlich alles etwas klarer.</span>
<span id="cb208-887"><a href="#cb208-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-890"><a href="#cb208-890" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-891"><a href="#cb208-891" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> f_b, fac2_nointer_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb208-892"><a href="#cb208-892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> f_a <span class="sc">*</span> f_b)  <span class="sc">|&gt;</span> </span>
<span id="cb208-893"><a href="#cb208-893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>() </span>
<span id="cb208-894"><a href="#cb208-894" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-895"><a href="#cb208-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-896"><a href="#cb208-896" aria-hidden="true" tabindex="-1"></a>Da wir es hier auch wieder mit einem linearen Modell zu tun haben, können wir uns die Sachlage auch einmal mit den Koeffizienten des linearen Modells anschauen. Wir haben hier einen linearen Anstieg in unserem ersten Faktor und einen Unterschied von $3$ in unserem zweiten Faktor. Der Intercept ist dabei die Faktorkombination $A.1.B.1$ als niedrigste Levelkombination. Wir schauen uns hier nur das *Treatment coding* an.</span>
<span id="cb208-897"><a href="#cb208-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-900"><a href="#cb208-900" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-901"><a href="#cb208-901" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> f_b, fac2_nointer_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb208-902"><a href="#cb208-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-903"><a href="#cb208-903" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-904"><a href="#cb208-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-905"><a href="#cb208-905" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du dann einmal den Zusammenhang und die Koeffizienten visualisiert. Der Intercept liegt auf der Faktorkombination $A.1.B.1$. Die Level von $B.2$ sind parallel um den Koeffizienten von $B.2$ verschoben. Der Anstieg ist aber immer noch $+2$ da wir ja hier keine Interaktion vorliegen haben. Über den Faktor $A$ verhält sich der Faktor $B$ gleich. Hätten wir eine Interaktion vorliegen, dann würden wir keinen parallelen Verlauf sehen. In der Praxis beobachten wir solche Daten eher selten sondern sehen immer eine leichte Interaktion. Insbesondere da wir hier ja keine Streuung in den Daten vorliegen haben.</span>
<span id="cb208-906"><a href="#cb208-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-909"><a href="#cb208-909" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-910"><a href="#cb208-910" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-911"><a href="#cb208-911" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-912"><a href="#cb208-912" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-913"><a href="#cb208-913" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-914"><a href="#cb208-914" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb208-915"><a href="#cb208-915" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb208-916"><a href="#cb208-916" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung des zweifaktoriellen Modells ohne Interaktion für die beiden Faktoren $A$ und $B$. Die Mittelwerte des Faktors $B.2$ sind um den Koeffizienten des Levels verschoben. Die Graden verlaufen parallel, da keine Interaktion vorliegt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-917"><a href="#cb208-917" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-f2nointer</span></span>
<span id="cb208-918"><a href="#cb208-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-919"><a href="#cb208-919" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fac2_nointer_tbl, <span class="fu">aes</span>(f_a, y, <span class="at">color =</span> f_b)) <span class="sc">+</span></span>
<span id="cb208-920"><a href="#cb208-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-921"><a href="#cb208-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-922"><a href="#cb208-922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-923"><a href="#cb208-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">7</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-924"><a href="#cb208-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">8</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"#56B4E9"</span>) <span class="sc">+</span></span>
<span id="cb208-925"><a href="#cb208-925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">5</span>, <span class="at">slope =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"#E69F00"</span>) <span class="sc">+</span></span>
<span id="cb208-926"><a href="#cb208-926" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb208-927"><a href="#cb208-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, </span>
<span id="cb208-928"><a href="#cb208-928" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y..)), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb208-929"><a href="#cb208-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A.1"</span>, <span class="st">"A.2"</span>, <span class="st">"A.3"</span>)) <span class="sc">+</span></span>
<span id="cb208-930"><a href="#cb208-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Zweifaktorielle Simulation"</span>,</span>
<span id="cb208-931"><a href="#cb208-931" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Intercept ist der Mittelwert von Gruppe A.1"</span>,</span>
<span id="cb208-932"><a href="#cb208-932" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Faktor A"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>, <span class="at">color =</span> <span class="st">"Faktor B"</span>) <span class="sc">+</span></span>
<span id="cb208-933"><a href="#cb208-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">"B.1"</span>, <span class="st">"B.2"</span>)) <span class="sc">+</span></span>
<span id="cb208-934"><a href="#cb208-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb208-935"><a href="#cb208-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb208-936"><a href="#cb208-936" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-937"><a href="#cb208-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-938"><a href="#cb208-938" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktoriell mit Interaktion $f_A + f_B + f_A \times f_B$ {.unnumbered .unlisted}</span></span>
<span id="cb208-939"><a href="#cb208-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-940"><a href="#cb208-940" aria-hidden="true" tabindex="-1"></a>Selten betrachten wir nur einen Faktor sondern eben zwei Faktoren. Daher habe ich jetzt einmal ein zweifaktorielles Design in der folgenden schematischen Darstellung mitgebracht. Wir haben hier zwei Faktoren. Der Hauptfaktor $f_A$ hat drei Level und der zweite Faktor $f_B$ hat zwei Level. Der Messwert ist weiterhin normalverteilt. Jetzt müssen wir uns gleich etwas strecken um die Daten zusammenzubauen. Wir haben nun nämlich endlich eine Interaktion zwischen den beiden Faktoren vorliegen. Der Faktor $f_B$ verhält sich nicht gleich in allen Leveln des Faktors $f_A$. Die Graden laufen nicht parallel.</span>
<span id="cb208-941"><a href="#cb208-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-944"><a href="#cb208-944" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-945"><a href="#cb208-945" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-946"><a href="#cb208-946" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-947"><a href="#cb208-947" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-948"><a href="#cb208-948" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-949"><a href="#cb208-949" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb208-950"><a href="#cb208-950" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-951"><a href="#cb208-951" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches simples Modell mit einem Messwert $Y$ und einer kategorialen Einflussvariablen als Faktor $f_A$ mit drei Leveln sowie einer kategorialen Einflussvariablen als Faktor $f_B$ mit zwei Leveln und deren Interaktion $f_A \\times f_B$ dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-952"><a href="#cb208-952" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-f2inter-theo</span></span>
<span id="cb208-953"><a href="#cb208-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-954"><a href="#cb208-954" aria-hidden="true" tabindex="-1"></a>p_2fac_model <span class="sc">+</span></span>
<span id="cb208-955"><a href="#cb208-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>) </span>
<span id="cb208-956"><a href="#cb208-956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-957"><a href="#cb208-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-958"><a href="#cb208-958" aria-hidden="true" tabindex="-1"></a>In den beiden folgenden Tabs zeige ich dir einmal wie du die Daten für ein zweifaktorielles Design mit Interaktion in einem <span class="in">`tibble()`</span> sowie in Excel zusammenbaust. In Excel ist es etwas übersichtlicher, da du ja dort die einzelnen Spalten händisch anlegst. Zum Verstehen vielleicht etwas besser als in R. Dennoch ist die Erstellung in R stabiler und nicht so fehleranfällig. Für mal eben zum probieren reicht natürlich wie immer auch Excel super aus.</span>
<span id="cb208-959"><a href="#cb208-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-960"><a href="#cb208-960" aria-hidden="true" tabindex="-1"></a>:::: panel-tabset</span>
<span id="cb208-961"><a href="#cb208-961" aria-hidden="true" tabindex="-1"></a><span class="fu">## `tibble()`</span></span>
<span id="cb208-962"><a href="#cb208-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-963"><a href="#cb208-963" aria-hidden="true" tabindex="-1"></a>Wenn wir mit Interaktionen einen Datensatz bauen, dann müssen wir den Datensatz über die Effekte aufbauen. Wir legen also fest, wie stark sich die Mitterlwerte unterscheiden sollen anstatt die Mittelwerte selber. Daher eben der Effekt als Ausgangspunkt für unsere Datengenerierung. Als erstes bauen wir uns aber einmal den Datensatz nur für die Faktoren. Die Spalte <span class="in">`rep`</span> gibt an wie viele Wiederholungen wir pro Level haben.</span>
<span id="cb208-964"><a href="#cb208-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-967"><a href="#cb208-967" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-968"><a href="#cb208-968" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">f_b =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-969"><a href="#cb208-969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">as_factor</span>(f_a),</span>
<span id="cb208-970"><a href="#cb208-970" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">as_factor</span>(f_b))</span>
<span id="cb208-971"><a href="#cb208-971" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-972"><a href="#cb208-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-973"><a href="#cb208-973" aria-hidden="true" tabindex="-1"></a>Dann nutzen wir die Faktoren um eine Dummykodierung zuerstellen. Mit der Dummykodierung können wir dann die Level der Faktor und der Interaktion die Effekte zuordnen. Das ist hier super wichtig, da wir sonst kaum die Interaktion modellieren können.</span>
<span id="cb208-974"><a href="#cb208-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-977"><a href="#cb208-977" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-978"><a href="#cb208-978" aria-hidden="true" tabindex="-1"></a>fac2_mat <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb208-979"><a href="#cb208-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_matrix</span>(<span class="sc">~</span> f_a <span class="sc">*</span> f_b) <span class="sc">|&gt;</span> </span>
<span id="cb208-980"><a href="#cb208-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb208-981"><a href="#cb208-981" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-982"><a href="#cb208-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-983"><a href="#cb208-983" aria-hidden="true" tabindex="-1"></a>Jetzt brauchen wir die Effekte für die Faktoren und die Interaktion. Wir haben hier den Mittelwert der ersten Gruppe aus dem Faktor $f_A$ und dem ersten Level im Faktor $f_B$ in den Intercept. Danach kommen dann die Effekte der anderen Level plus die Interaktion. Ich schreibe hier die Effekte der Interaktion mit dem <span class="in">`x`</span> zwischen den Namen.</span>
<span id="cb208-984"><a href="#cb208-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-987"><a href="#cb208-987" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-988"><a href="#cb208-988" aria-hidden="true" tabindex="-1"></a>eff_vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">intercept =</span> <span class="dv">7</span>, </span>
<span id="cb208-989"><a href="#cb208-989" aria-hidden="true" tabindex="-1"></a>             <span class="at">f_a2 =</span> <span class="dv">2</span>, <span class="at">f_a3 =</span> <span class="dv">4</span>, <span class="at">f_b2 =</span> <span class="dv">3</span>, </span>
<span id="cb208-990"><a href="#cb208-990" aria-hidden="true" tabindex="-1"></a>             <span class="at">f_a2xf_b2 =</span> <span class="dv">0</span>, <span class="at">f_a3xf_b2 =</span> <span class="sc">-</span><span class="dv">6</span>)</span>
<span id="cb208-991"><a href="#cb208-991" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-992"><a href="#cb208-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-993"><a href="#cb208-993" aria-hidden="true" tabindex="-1"></a>Dann kombinieren wir die Modellmatrix mit den Information wo der Effekt angewendet werden soll mit dem Vektor der Effekte. Wir erhalten dann unsere Messwerte in dem Vektor <span class="in">`y_raw`</span>. Hier sind natürlich pro Faktorkombination die Werte immer gleich. Wir haben ja noch keine Streuung hinzugefügt.</span>
<span id="cb208-994"><a href="#cb208-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-997"><a href="#cb208-997" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-998"><a href="#cb208-998" aria-hidden="true" tabindex="-1"></a>y_raw <span class="ot">&lt;-</span> fac2_mat <span class="sc">%*%</span> eff_vec</span>
<span id="cb208-999"><a href="#cb208-999" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1000"><a href="#cb208-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1001"><a href="#cb208-1001" aria-hidden="true" tabindex="-1"></a>Am Ende erhalten wir dann die echten generierten Messwerte indem wir zu unserem Messwert noch einen Fehler addieren. Ich nehme hier einen sehr kleinen Fehler, damit wir die Effekt auch gleich wiedersehen. Sonst müsste ich eine sehr hohe Fallzahl simulieren.</span>
<span id="cb208-1002"><a href="#cb208-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1005"><a href="#cb208-1005" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1006"><a href="#cb208-1006" aria-hidden="true" tabindex="-1"></a>fac2_inter_tbl <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb208-1007"><a href="#cb208-1007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> y_raw <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(y_raw), <span class="dv">0</span>, <span class="fl">0.001</span>))</span>
<span id="cb208-1008"><a href="#cb208-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1009"><a href="#cb208-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1010"><a href="#cb208-1010" aria-hidden="true" tabindex="-1"></a>Wenn du jetzt noch Varianzheterogenität haben möchtest, dann müsstest du dir einen Vektor mit den verschiedenen Aufrufen der Funktion <span class="in">`rnorm()`</span> für die jeweiligen Faktorkombinationen bauen. Hier wären es dann bei sechs Faktorkombinationen eben sechsmal <span class="in">`rnorm()`</span> mit jeweils fünf Beobachtungen als Anzahl der Wiederholungen und dann eben einer eigenen Streuung.</span>
<span id="cb208-1011"><a href="#cb208-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1012"><a href="#cb208-1012" aria-hidden="true" tabindex="-1"></a><span class="fu">## Excel</span></span>
<span id="cb208-1013"><a href="#cb208-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1014"><a href="#cb208-1014" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb208-1015"><a href="#cb208-1015" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb208-1016"><a href="#cb208-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1017"><a href="#cb208-1017" aria-hidden="true" tabindex="-1"></a>Die Erstellung von Daten in Excel ist nicht für die *wissenschaftliche* Bewertung von Algorithmen sinnvoll und angebracht. Wir nutzen hier Excel um recht einfach uns zufällig Daten zu erstellen. Wir nutzen dann die künstlichen Exceldaten um unsere Analyse für unsere echten experimentelle Daten zu üben. Auch ist die vereinfachte Erstellung von künstlichen Daten in Excel hilfreich um die zugrundeliegende Konzepte nochmal zu verstehen.</span>
<span id="cb208-1018"><a href="#cb208-1018" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-1019"><a href="#cb208-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1020"><a href="#cb208-1020" aria-hidden="true" tabindex="-1"></a>In der folgenden Datei findest du dann einmal die Generierung der zweifaktoriellen Daten mit Interaktion in Excel. Hier müssen wir dann das additive Zusammenbauen nutzen, da wir keine Matrizen in Excel muliplizieren wollen. Deshalb ist die Datei etwas größer. Am Ende brauchen wir die Spalte <span class="in">`Faktor A`</span> und die Spalte <span class="in">`Faktor B`</span> sowie die Spalte <span class="in">`Messwert`</span>.</span>
<span id="cb208-1021"><a href="#cb208-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1024"><a href="#cb208-1024" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1025"><a href="#cb208-1025" aria-hidden="true" tabindex="-1"></a>excel_fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/data_generation_excel.xlsx"</span>,</span>
<span id="cb208-1026"><a href="#cb208-1026" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sheet =</span> <span class="st">"zweifaktoriell"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-1027"><a href="#cb208-1027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb208-1028"><a href="#cb208-1028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">faktor_a =</span> <span class="fu">as_factor</span>(faktor_a),</span>
<span id="cb208-1029"><a href="#cb208-1029" aria-hidden="true" tabindex="-1"></a>         <span class="at">faktor_b =</span> <span class="fu">as_factor</span>(faktor_b))</span>
<span id="cb208-1030"><a href="#cb208-1030" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1031"><a href="#cb208-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1032"><a href="#cb208-1032" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung habe ich dir einmal normalverteilte Messwerte in Excel aus einem zweifaktoriellen Design mit Interaktion generiert. Zuerst legen wir den allgemeinen Intercept fest, dann noch die Effekte der einzelnen Gruppen sowie der Interaktion. Am Ende brauchen wir noch den Fehler oder die Streuung mit der Funktion <span class="in">`NORMINV()`</span>. Hier habe ich eine Standardabweichung von $2$ voreingestellt.</span>
<span id="cb208-1033"><a href="#cb208-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1036"><a href="#cb208-1036" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1037"><a href="#cb208-1037" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1038"><a href="#cb208-1038" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-1039"><a href="#cb208-1039" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-1040"><a href="#cb208-1040" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-1041"><a href="#cb208-1041" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb208-1042"><a href="#cb208-1042" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb208-1043"><a href="#cb208-1043" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Annotierte Generierung von zweifaktoriellen Daten mit Interaktion in Excel. Der Fehler wird durch die Funktion `NORMINV()` in Excel abgebildet. Der normalverteilte Messwert addiert sich aus den Spalten `C:G` auf. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-1044"><a href="#cb208-1044" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gen-data-fac2-excel</span></span>
<span id="cb208-1045"><a href="#cb208-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1046"><a href="#cb208-1046" aria-hidden="true" tabindex="-1"></a>p_fac2_excel</span>
<span id="cb208-1047"><a href="#cb208-1047" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1048"><a href="#cb208-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1049"><a href="#cb208-1049" aria-hidden="true" tabindex="-1"></a>Die Zahlen kommen jetzt nicht perfekt hin, da ich hier mit einer Standardabweichung von 2 eine recht hohe Streuung gewählt habe. Darüber hinaus habe ich dann auch sehr wenige Beobachtungen gebaut. Deshalb passt der Intercept nicht ganz, den der Intercept müsste eigentlich 10 sein und nicht 9. Daher stimmen dann auch die anderen Effekt nicht perfekt. Aber so ist das dann manchmal mit künstlichen Daten</span>
<span id="cb208-1050"><a href="#cb208-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1053"><a href="#cb208-1053" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1054"><a href="#cb208-1054" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(messwert <span class="sc">~</span> faktor_a <span class="sc">*</span> faktor_b, <span class="at">data =</span> excel_fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb208-1055"><a href="#cb208-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>()</span>
<span id="cb208-1056"><a href="#cb208-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1057"><a href="#cb208-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1058"><a href="#cb208-1058" aria-hidden="true" tabindex="-1"></a>Diese Generierung in Excel eigentlich sich sehr gut um dir selber Daten zu bauen, wenn du schonmal testen wilst wie die Analyse laufen würde bevor du eigentlich echte Daten aus deinem Experiment erhoben hast. Hier kommt es ja nicht auf die perfekten Effekte an. Hauptsache es sind Daten, die nicht alle gleich sind und du nichts siehst. Daher kann ich dir diesen Weg der Datengenerierung zum Testen deines R Codes nur empfehlen.</span>
<span id="cb208-1059"><a href="#cb208-1059" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb208-1060"><a href="#cb208-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1061"><a href="#cb208-1061" aria-hidden="true" tabindex="-1"></a>Fangen wir mit der Überprüfung an und schauen dafür erst mal in eine zweifaktorielle ANOVA mit Interaktion. Wir wollen hier natürlich, dass alle Faktoren signifikant sind und ebenfalls die Interaktion. So haben wir ja die Daten oben auch gebaut.</span>
<span id="cb208-1062"><a href="#cb208-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1065"><a href="#cb208-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1066"><a href="#cb208-1066" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> f_b <span class="sc">+</span> f_a<span class="sc">:</span>f_b, fac2_inter_tbl) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb208-1067"><a href="#cb208-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1068"><a href="#cb208-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1069"><a href="#cb208-1069" aria-hidden="true" tabindex="-1"></a>Das passt soweit, wir haben alles so wie wir es wollen. Leider sehen wir nicht die direkten Mittelwerte in einer ANOVA, daher hier nochmal <span class="in">`emmeans()`</span> um uns die Mittelwerte wiedergeben zu lassen. Auch hier sehen wir, eine Menge Zahlen, aber soweit passen die Werte. Wir brauche in der Faktorkombination $A.1.B.1$ einen Mittelwert von 7, da diese Gruppe ja unser Intercept ist. Das passt soweit. Die anderen Mittelwerte berechnen sich dann aus den obigen Effketen.</span>
<span id="cb208-1070"><a href="#cb208-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1073"><a href="#cb208-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1074"><a href="#cb208-1074" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> f_b <span class="sc">+</span> f_a<span class="sc">:</span>f_b, fac2_inter_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb208-1075"><a href="#cb208-1075" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> f_a <span class="sc">*</span> f_b) </span>
<span id="cb208-1076"><a href="#cb208-1076" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1077"><a href="#cb208-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1078"><a href="#cb208-1078" aria-hidden="true" tabindex="-1"></a>Dann schauen wir nochmal die Koeffizienten eines linearen Modells an um dann nochmal die Effekte zu sehen. Das ist natürlich alles etwas doppelt, aber es ist auch eine Übung zu verstehen woher die Zahlen kommen. Hier also einmal die Effekte und die Interaktionen für unser zweifaktorielles Design. Bitte beachte, dass sich natürlich das niedrigste Level des Faktors $f_A$ und des Faktors $f_B$ im Intercept vereinen. Ja, das ist manchmal echt nicht so einfach.</span>
<span id="cb208-1079"><a href="#cb208-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1082"><a href="#cb208-1082" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1083"><a href="#cb208-1083" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> f_b <span class="sc">+</span> f_a<span class="sc">:</span>f_b, fac2_inter_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb208-1084"><a href="#cb208-1084" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-1085"><a href="#cb208-1085" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1086"><a href="#cb208-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1087"><a href="#cb208-1087" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du einmal die Interaktion in der Faktorkombination $A.3.B2$. Hier haben wir einen Effekt von -6 vorliegen. Durch die Interaktion fällt der Mittelwert weit nach unten. Weiter als er eigentlich sein sollte, wenn wir einen linearen Anstieg über den Faktor $f_A$ erwarten würden. Wir haben eben nicht eine klassische Verschiebung der Graden durch den Faktor $f_B$ sondern gegeben durch die Interaktion schneiden sich die Graden.</span>
<span id="cb208-1088"><a href="#cb208-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1091"><a href="#cb208-1091" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1092"><a href="#cb208-1092" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1093"><a href="#cb208-1093" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-1094"><a href="#cb208-1094" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-1095"><a href="#cb208-1095" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-1096"><a href="#cb208-1096" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb208-1097"><a href="#cb208-1097" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb208-1098"><a href="#cb208-1098" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung des zweifaktoriellen Modells mit Interaktion für die beiden Faktoren $A$ und $B$. Die Mittelwerte des Faktors $B.2$ sind um den Koeffizienten des Levels verschoben. Danach wird der Effek der Interaktion addiert. Die Graden verlaufen daher nicht parallel, da eine Interaktion vorliegt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-1099"><a href="#cb208-1099" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-f2inter</span></span>
<span id="cb208-1100"><a href="#cb208-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1101"><a href="#cb208-1101" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fac2_inter_tbl, <span class="fu">aes</span>(f_a, y, <span class="at">color =</span> f_b, <span class="at">group =</span> f_b)) <span class="sc">+</span></span>
<span id="cb208-1102"><a href="#cb208-1102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-1103"><a href="#cb208-1103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-1104"><a href="#cb208-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-1105"><a href="#cb208-1105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">7</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-1106"><a href="#cb208-1106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb208-1107"><a href="#cb208-1107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb208-1108"><a href="#cb208-1108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, </span>
<span id="cb208-1109"><a href="#cb208-1109" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y..)), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb208-1110"><a href="#cb208-1110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A.1"</span>, <span class="st">"A.2"</span>, <span class="st">"A.3"</span>)) <span class="sc">+</span></span>
<span id="cb208-1111"><a href="#cb208-1111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Zweifaktorielle Simulation"</span>,</span>
<span id="cb208-1112"><a href="#cb208-1112" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Intercept ist der Mittelwert von Gruppe A.1"</span>,</span>
<span id="cb208-1113"><a href="#cb208-1113" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Faktor A"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>, <span class="at">color =</span> <span class="st">"Faktor B"</span>) <span class="sc">+</span></span>
<span id="cb208-1114"><a href="#cb208-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">"B.1"</span>, <span class="st">"B.2"</span>)) <span class="sc">+</span></span>
<span id="cb208-1115"><a href="#cb208-1115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb208-1116"><a href="#cb208-1116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb208-1117"><a href="#cb208-1117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1118"><a href="#cb208-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1119"><a href="#cb208-1119" aria-hidden="true" tabindex="-1"></a>Wir haben uns jetzt einmal durch das faktorielle Design durchgearbeitet. Das war jetzt auch bei einem normalverteilten Messwert relativ einfach. Wenn wir dann noch eine andere Verteilung im Messwert vorliegen haben, dann wird die Sache noch etwas komplizierter. In den folgenden Abschnitten gehe ich dann nicht für jede Verteilung auf alle Kombinationen ein, sondern nutze immer die wichtigsten faktoriellen Designs, wie eben die zweifaktoriellen mit und ohne Interaktion. Die einfaktoriellen Designs mit mehr als zwei Leveln dienen eher der Veranschaulichung und werden in der Praxis kaum genutzt.</span>
<span id="cb208-1120"><a href="#cb208-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1121"><a href="#cb208-1121" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kovariates Design {.unnumbered .unlisted}</span></span>
<span id="cb208-1122"><a href="#cb208-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1123"><a href="#cb208-1123" aria-hidden="true" tabindex="-1"></a>Etwas seltener kommt der Fall vor, dass wir uns nur eine Kovariate anschauen wollen. In diesem Fall haben wir ja eine numerische, kontinuierliche Einflussvariable sowie einen normalverteilten Messwert vorliegen. Wir sind jetzt an der Steigung der Graden durch die Punktewolke interessiert. Daher stellen wir uns hier als Effekt eine Steigung ein und schauen, ob wir diese Steigung wiederfinden. Da wir natürlich auch einen Intercept für die Gradengleichung brauchen, müssen wir diesen auch definieren. Der Intercept ist aber meistens nicht von so großer praktischer Bedeutung.</span>
<span id="cb208-1124"><a href="#cb208-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1125"><a href="#cb208-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einkovariat $c_1$ {.unnumbered .unlisted}</span></span>
<span id="cb208-1126"><a href="#cb208-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1127"><a href="#cb208-1127" aria-hidden="true" tabindex="-1"></a>In der folgenden schematischen Darstellung ahbe ich dir einmal einkovariates Modell mitgebracht. Wir haben auf der linken Seite einen kontinuierlichen, normalverteilten Messwert und auf der rechten Seite der Tilde eine kontinuierliche Einflussvariable als Kovariate vorliegen. Wir wollen jetzt die Daten in diesem Kontext generieren.</span>
<span id="cb208-1128"><a href="#cb208-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1131"><a href="#cb208-1131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1132"><a href="#cb208-1132" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1133"><a href="#cb208-1133" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-1134"><a href="#cb208-1134" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-1135"><a href="#cb208-1135" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-1136"><a href="#cb208-1136" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb208-1137"><a href="#cb208-1137" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-1138"><a href="#cb208-1138" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches simples Modell mit einem Messwert $Y$ und einer kontinuierlichen Einflussvariable als Kovariate $c_1$ dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-1139"><a href="#cb208-1139" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-c1-theo</span></span>
<span id="cb208-1140"><a href="#cb208-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1141"><a href="#cb208-1141" aria-hidden="true" tabindex="-1"></a>p_1cov_model </span>
<span id="cb208-1142"><a href="#cb208-1142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1143"><a href="#cb208-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1144"><a href="#cb208-1144" aria-hidden="true" tabindex="-1"></a>Wenn wir eine normalverteilte Kovariate haben, dann können wir erstmal die Kovariate erschaffen. Dafür nutzen wir dann die Funktion <span class="in">`rnorm()`</span>. Dann müssen wir noch unseren Messwert mit der Gradengleichung festlegen. Ich zeige hier einmal die Variante mit dem linearen Zusammenhang und habe dann auch noch einen quadratischen mit der Helferfunktion <span class="in">`I()`</span> ergänzt. Wie du dann möchtest, kannst du auch noch andere nicht lineare Zusammenhänge ergänzen.</span>
<span id="cb208-1145"><a href="#cb208-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1148"><a href="#cb208-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1149"><a href="#cb208-1149" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1150"><a href="#cb208-1150" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-1151"><a href="#cb208-1151" aria-hidden="true" tabindex="-1"></a>cov1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb208-1152"><a href="#cb208-1152" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y_lin =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> c_1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="fl">0.001</span>),</span>
<span id="cb208-1153"><a href="#cb208-1153" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y_square =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.1</span> <span class="sc">*</span> c_1 <span class="sc">+</span> <span class="fu">I</span>(<span class="fl">1.5</span><span class="sc">*</span>c_1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="fl">0.001</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb208-1154"><a href="#cb208-1154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"power"</span>, <span class="at">value =</span> <span class="st">"y"</span>, y_lin<span class="sc">:</span>y_square)</span>
<span id="cb208-1155"><a href="#cb208-1155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1156"><a href="#cb208-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1157"><a href="#cb208-1157" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung zeige ich dir einmal die Ergebnisse der Simulation. Da ich auch hier die Streuung faktisch ausgestellt habe, liegen die Punkte perfekt auf der Gradengleichung wie ich das will. Die lineare Gleichung hat noch einen Keoffizienten für den quadratischen Anteil, der ist hier ab faktisch Null. Wir können hier also sehr gut Zusammenhänge darstellen und dann schauen, ob wir die Koeffizienten dann in der linearen oder nicht-linearen Regression wiederfinden.</span>
<span id="cb208-1158"><a href="#cb208-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1161"><a href="#cb208-1161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1162"><a href="#cb208-1162" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1163"><a href="#cb208-1163" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-1164"><a href="#cb208-1164" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-1165"><a href="#cb208-1165" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-1166"><a href="#cb208-1166" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb208-1167"><a href="#cb208-1167" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb208-1168"><a href="#cb208-1168" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung einer linearen und einer quadratischen Simulation mit einer normalverteilten Kovariaten sowie einem normalverteilten Messwert. Der quadratische Term existeriert im linearen Modell nicht und der Koeffizient für $x^2$ ist daher fast Null. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-1169"><a href="#cb208-1169" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-c1</span></span>
<span id="cb208-1170"><a href="#cb208-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1171"><a href="#cb208-1171" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cov1_tbl, <span class="fu">aes</span>(c_1, y, <span class="at">color =</span> power)) <span class="sc">+</span></span>
<span id="cb208-1172"><a href="#cb208-1172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-1173"><a href="#cb208-1173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-1174"><a href="#cb208-1174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-1175"><a href="#cb208-1175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb208-1176"><a href="#cb208-1176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb208-1177"><a href="#cb208-1177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="st">"eq"</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>),</span>
<span id="cb208-1178"><a href="#cb208-1178" aria-hidden="true" tabindex="-1"></a>               <span class="at">vstep =</span> <span class="fl">0.07</span>) <span class="sc">+</span></span>
<span id="cb208-1179"><a href="#cb208-1179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb208-1180"><a href="#cb208-1180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)) <span class="sc">+</span>  </span>
<span id="cb208-1181"><a href="#cb208-1181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Einkovariate Simulation"</span>,</span>
<span id="cb208-1182"><a href="#cb208-1182" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Intercept ist der y-Achsenabschnitt"</span>,</span>
<span id="cb208-1183"><a href="#cb208-1183" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Covariate 1"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb208-1184"><a href="#cb208-1184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"linear"</span>, <span class="st">"quadratisch"</span>)) <span class="sc">+</span></span>
<span id="cb208-1185"><a href="#cb208-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb208-1186"><a href="#cb208-1186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1187"><a href="#cb208-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1188"><a href="#cb208-1188" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweikovariat unabhängig $c_1 + c_2$ {.unnumbered .unlisted}</span></span>
<span id="cb208-1189"><a href="#cb208-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1190"><a href="#cb208-1190" aria-hidden="true" tabindex="-1"></a>Wenn wir mehrere Kovariaten simulieren wollen, dann erweitern wir das Modell einfach um eine weitere Kovariate. Im simpelsten Fall sind die beiden Kovariaten voneinander unabhängig, daher kommen aus zwei verschiedenen Normalverteilungen und haben damit nichts miteinander zu tun. Daher sind die Werte der Kovariaten untereinander nicht korreliert oder sonst wie voneinander abhängig.</span>
<span id="cb208-1191"><a href="#cb208-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1194"><a href="#cb208-1194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1195"><a href="#cb208-1195" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1196"><a href="#cb208-1196" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-1197"><a href="#cb208-1197" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-1198"><a href="#cb208-1198" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-1199"><a href="#cb208-1199" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb208-1200"><a href="#cb208-1200" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-1201"><a href="#cb208-1201" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches multiples Modell mit einem Messwert $Y$ und zwei kontinuierlichen Einflussvariablen als Kovariate $c_1$ und Kovariate $c_2$ dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-1202"><a href="#cb208-1202" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-c2-theo</span></span>
<span id="cb208-1203"><a href="#cb208-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1204"><a href="#cb208-1204" aria-hidden="true" tabindex="-1"></a>p_2cov_model</span>
<span id="cb208-1205"><a href="#cb208-1205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1206"><a href="#cb208-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1207"><a href="#cb208-1207" aria-hidden="true" tabindex="-1"></a>Hier bauen wir uns zwei voneinander unabhängige Kovariaten. Die beiden Kovariaten entstammen aus unterschiedlichen Normalverteilungen und sind somit untereinander nicht korreliert. Dann legen wir einmal den Intercept fest und ergänzen noch die Steigungen als Effekte für die Kovariaten. Am Ende ergänze ich dann noch einen winzigen Fehler damit das Modell auch gerechnet werden kann.</span>
<span id="cb208-1208"><a href="#cb208-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1211"><a href="#cb208-1211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1212"><a href="#cb208-1212" aria-hidden="true" tabindex="-1"></a>cov2_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb208-1213"><a href="#cb208-1213" aria-hidden="true" tabindex="-1"></a>                   <span class="at">c_2 =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb208-1214"><a href="#cb208-1214" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb208-1215"><a href="#cb208-1215" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span> <span class="sc">*</span> c_1 <span class="sc">+</span> </span>
<span id="cb208-1216"><a href="#cb208-1216" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">2</span> <span class="sc">*</span> c_2 <span class="sc">+</span> </span>
<span id="cb208-1217"><a href="#cb208-1217" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span>
<span id="cb208-1218"><a href="#cb208-1218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1219"><a href="#cb208-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1220"><a href="#cb208-1220" aria-hidden="true" tabindex="-1"></a>Dann nutze ich die Funktion <span class="in">`correlation()`</span> aus dem R Paket <span class="in">`{correlation}`</span> um mir einmal die Korrelation zwischend den beiden Kovariaten wiedergeben zu lassen. Wir sehen hier, die beiden Kovariaten sind nicht miteinander korreliert. Der Korrelationskoeffizient liegt eher bei Null und ist nicht signifikant.</span>
<span id="cb208-1221"><a href="#cb208-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1224"><a href="#cb208-1224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1225"><a href="#cb208-1225" aria-hidden="true" tabindex="-1"></a>cov2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb208-1226"><a href="#cb208-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlation</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>))</span>
<span id="cb208-1227"><a href="#cb208-1227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1228"><a href="#cb208-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1229"><a href="#cb208-1229" aria-hidden="true" tabindex="-1"></a>Dann schauen wir nochmal auf die Koeffizientend es Modells, ob wir auch unsere Effekte wiederfinden. Das sieht soweit gut aus. Wir haben die eingestellten Steigungen in den Koeffizienten wiedergefunden.</span>
<span id="cb208-1230"><a href="#cb208-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1233"><a href="#cb208-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1234"><a href="#cb208-1234" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> c_2, cov2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb208-1235"><a href="#cb208-1235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-1236"><a href="#cb208-1236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1237"><a href="#cb208-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1238"><a href="#cb208-1238" aria-hidden="true" tabindex="-1"></a>Ich erstelle hier keine Abbildung in einem 3D Scatterplot, da mir das zu viel Aufwand ist und wir sehr wenig auf den 3D Scatterplots sinnvoll interpretieren können. Wir schauen uns auch selten zweikovariate Modelle in einer Abbildung an, sondern bewerten eben die Koeffizienten und andere statistsiche Maßzahlen für die Güte der Modellierung. Hier soll es dann reichen. Mehr dazu dann in den <span class="co">[</span><span class="ot">Kapiteln zu den Grundlagen des statistsichen Modellierens</span><span class="co">](https://jkruppa.github.io/stat-linear-reg-preface.html)</span>.</span>
<span id="cb208-1239"><a href="#cb208-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1240"><a href="#cb208-1240" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Multikovariat abhängig $c_1 + c_2 + c_3$ {.unnumbered .unlisted}</span></span>
<span id="cb208-1241"><a href="#cb208-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1242"><a href="#cb208-1242" aria-hidden="true" tabindex="-1"></a>Jetzt kommen wir zu einem etwas nischigen Thema, nämlich der Tatsache, dass wir korrelierte Kovariaten vorliegen haben. Deshalb nehmen wir auch gleich drei Korvariaten. Das ist natürlich in der Statistik ein Problem, wie wir es auch im <span class="co">[</span><span class="ot">Kapitel zu der multiplen Regression</span><span class="co">](#sec-mult-reg-basic)</span> nachlesen können. Mit Statistik meine ich, dass wir dann eben ein paar Probleme bei der Modellierung haben. Da gehe ich hier aber nicht tiefer drauf ein. Solche Daten zu generieren ist dann daher eher selten von Interesse in einem praktischen Kontext. Entweder liegen die Kovariaten korre,iert vor oder eben nicht. Wenn wir natürlich Algorithmen entwicklen wollen, dann ist das schon ein wichtiges Theme, wenn die Kovariaten nicht unabhängig voneinander sind.</span>
<span id="cb208-1243"><a href="#cb208-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1244"><a href="#cb208-1244" aria-hidden="true" tabindex="-1"></a>Wir nutzen jetzt im Folgenden einmal das R Paket <span class="in">`{simstudy}`</span> da die Genierung von korrelierten Daten mit einem Paket einfacher ist als alles per Hand zu machen. Es geht auch alles per Hand in einem <span class="in">`tibble`</span> mit <span class="in">`{mvtnorm}`</span> aber das machen wir hier jetzt nicht, da es viel zu kompliziert ist. Ich kann es nur empfehlen, wenn du dich mit dem Simulieren von Daten beschäftigen willst. Dann müsstest du dich auch nochmal mit dem Tutorium <span class="co">[</span><span class="ot">How would you explain the difference between correlation and covariance?</span><span class="co">](https://stats.stackexchange.com/questions/18082/how-would-you-explain-the-difference-between-correlation-and-covariance)</span> beschäftigen, da wir in <span class="in">`{mvtnorm}`</span> mit Kovarianzen beschäftigen.</span>
<span id="cb208-1245"><a href="#cb208-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1246"><a href="#cb208-1246" aria-hidden="true" tabindex="-1"></a>Damit wären wir auch gleich beim großen Vorteil von <span class="in">`{simstudy}`</span>. Wir können nämlich direkt eine Korrelationsmatrix einpflegen und müssen nicht über die Kovarianz als schwierigeres Konzept gehen. Die Kovarianz festlegen ist nämlich nicht ganz so einfach. Die Korrelation vorher festzulegen aber schon. Was wir dann auch in der Vingette <span class="co">[</span><span class="ot">Correlated Data</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/correlated.html)</span> nachlesen können. Im folgenden habe ich dir einmal eine Korrlationsmatrix für die drei Kovariaten $c_1$ bis $c_3$ mitgebracht. Die Korrelationsmatrix muss symmetrisch sein. Je höher die absolute Korrelation desto stärker ist der Zusammenhang.</span>
<span id="cb208-1247"><a href="#cb208-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1250"><a href="#cb208-1250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1251"><a href="#cb208-1251" aria-hidden="true" tabindex="-1"></a>cor_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.7</span>, <span class="fl">0.2</span>, </span>
<span id="cb208-1252"><a href="#cb208-1252" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">0.7</span>, <span class="dv">1</span>, <span class="fl">0.8</span>, </span>
<span id="cb208-1253"><a href="#cb208-1253" aria-hidden="true" tabindex="-1"></a>                    <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb208-1254"><a href="#cb208-1254" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>, <span class="st">"c_3"</span>), <span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>, <span class="st">"c_3"</span>)))</span>
<span id="cb208-1255"><a href="#cb208-1255" aria-hidden="true" tabindex="-1"></a>cor_mat</span>
<span id="cb208-1256"><a href="#cb208-1256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1257"><a href="#cb208-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1258"><a href="#cb208-1258" aria-hidden="true" tabindex="-1"></a>Dann können wir die Funktion <span class="in">`genCorData()`</span> nutzen um uns korreltierte Kovariaten zu erstellen. Ich habe hier einmal eintausend Beobachtungen gewählt. Dann müssen wir noch den Mittelwert in allen Kovariaten festlegen sowie die Streuung. Wir nehmen dann die Korrelationsmatrix mit in die Funktion und benennen noch die Kovariaten entsprechend. Wir erstellen uns dann den Messwert separat mit den gewollten Effekten.</span>
<span id="cb208-1259"><a href="#cb208-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1262"><a href="#cb208-1262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1263"><a href="#cb208-1263" aria-hidden="true" tabindex="-1"></a>cov2_dependent_dt <span class="ot">&lt;-</span> <span class="fu">genCorData</span>(<span class="dv">1000</span>, <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">12</span>, <span class="dv">3</span>), <span class="at">sigma =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb208-1264"><a href="#cb208-1264" aria-hidden="true" tabindex="-1"></a>                                <span class="at">corMatrix =</span> cor_mat,</span>
<span id="cb208-1265"><a href="#cb208-1265" aria-hidden="true" tabindex="-1"></a>                                <span class="at">cnames =</span> <span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>, <span class="st">"c_3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb208-1266"><a href="#cb208-1266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> c_1 <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> c_2 <span class="sc">+</span> <span class="fl">2.5</span> <span class="sc">*</span> c_3 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span>
<span id="cb208-1267"><a href="#cb208-1267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1268"><a href="#cb208-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1269"><a href="#cb208-1269" aria-hidden="true" tabindex="-1"></a>Im Folgenden siehst du dann einmal die Datentabelle der eintausend Beobachtungen. Wir haben die ID Spalte und dann die drei Kovariaten gefolgt von dem Messwert.</span>
<span id="cb208-1270"><a href="#cb208-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1273"><a href="#cb208-1273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1274"><a href="#cb208-1274" aria-hidden="true" tabindex="-1"></a>cov2_dependent_dt</span>
<span id="cb208-1275"><a href="#cb208-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1276"><a href="#cb208-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1277"><a href="#cb208-1277" aria-hidden="true" tabindex="-1"></a>In den rohen Daten ist die Korrelation faktisch nicht zu sehen. Dafür müssen wir uns dann einmal die Korrelation berechnen lassen. Wie wir dann im Folgenden einmal sehen, passt es sehr gut. Wir erhalten die Korrelationen wieder, die wir auch eingestellt haben.</span>
<span id="cb208-1278"><a href="#cb208-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1281"><a href="#cb208-1281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1282"><a href="#cb208-1282" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(cov2_dependent_dt, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>, <span class="st">"c_3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb208-1283"><a href="#cb208-1283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">redundant =</span> <span class="cn">TRUE</span>)</span>
<span id="cb208-1284"><a href="#cb208-1284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1285"><a href="#cb208-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1286"><a href="#cb208-1286" aria-hidden="true" tabindex="-1"></a>Am Ende nochmal schauen, ob wir auch die Effekte wiederbekommen, die wir eingestellt haben. Auch hier sieht es sehr gut aus. Hier muss ich natürlich erwähnen, dass die Effekte groß sind die Fallzahl riesig und auch die Streuung in den Daten gering. Daher klappt hier auch alles so schön.</span>
<span id="cb208-1287"><a href="#cb208-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1290"><a href="#cb208-1290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1291"><a href="#cb208-1291" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> c_2 <span class="sc">+</span> c_3, <span class="at">data =</span> cov2_dependent_dt)</span>
<span id="cb208-1292"><a href="#cb208-1292" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1293"><a href="#cb208-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1294"><a href="#cb208-1294" aria-hidden="true" tabindex="-1"></a>Dann haben wir auch unsere Effekte in dem Modell wiedergefunden. Es gibt verschiedene Korrelationsstrukturen, die wir auch in <span class="in">`{simstudy}`</span> berücksichtigen können. Eine weitere Möglichkeit sind natürlich auch Zeitreihen in denen wir eine Abhängigkeit vorliegen haben. Aber auch hier reicht es meist, wenn der Trend einigermaßen stimmt. Dazu dann aber mehr in dem Abschnitt zu Zeitreihen.</span>
<span id="cb208-1295"><a href="#cb208-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1296"><a href="#cb208-1296" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb208-1297"><a href="#cb208-1297" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/personal_opinion.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb208-1298"><a href="#cb208-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1299"><a href="#cb208-1299" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Brauchen wir eine Generierung von korrelierten Kovariaten? Ich würde mal sagen in der allgmeinen Anwendung und Auswertung reicht es, wenn wir die Daten einfach unkorreliert generieren und dann darauf die Algorithmen laufen lassen. Aber ich selber brauche es manchmal für Beispieldaten. Daher gibt es diesen Abschnitt wirklich." --- Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.*</span></span>
<span id="cb208-1300"><a href="#cb208-1300" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb208-1301"><a href="#cb208-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1302"><a href="#cb208-1302" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mischung von Normalverteilungen {.unnumbered .unlisted}</span></span>
<span id="cb208-1303"><a href="#cb208-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1304"><a href="#cb208-1304" aria-hidden="true" tabindex="-1"></a>Wenn wir eine etwas komplexere Verteilung des Messwerts vorliegen haben wollen, dann lohnt sich auch einmal eine gemischte Normalverteilung zu bauen. Wir haben dann nicht eine Normalverteilung vorliegen sondern eine sehr bergige. Die bergige Normalverteilung besteht dann aber aus verschiedenen anderen Normalverteilungen, die wir dann übereinanderlegen. So können wir dann auch zweigipfelige oder wie in diesem Fall dreigipfelige Verteilungen bauen. Wir nutzen hier das R Paket <span class="in">`{simstudy}`</span> und generieren uns erstmal drei Normalverteilungen.</span>
<span id="cb208-1305"><a href="#cb208-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1308"><a href="#cb208-1308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1309"><a href="#cb208-1309" aria-hidden="true" tabindex="-1"></a>mix_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y_1"</span>, <span class="at">formula =</span> <span class="dv">1</span>, <span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb208-1310"><a href="#cb208-1310" aria-hidden="true" tabindex="-1"></a>mix_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(mix_def, <span class="at">varname =</span> <span class="st">"y_2"</span>, <span class="at">formula =</span> <span class="dv">5</span>, <span class="at">variance =</span> <span class="dv">4</span>)</span>
<span id="cb208-1311"><a href="#cb208-1311" aria-hidden="true" tabindex="-1"></a>mix_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(mix_def, <span class="at">varname =</span> <span class="st">"y_3"</span>, <span class="at">formula =</span> <span class="dv">9</span>, <span class="at">variance =</span> <span class="dv">1</span>)</span>
<span id="cb208-1312"><a href="#cb208-1312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1313"><a href="#cb208-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1314"><a href="#cb208-1314" aria-hidden="true" tabindex="-1"></a>Die drei Normalverteilungen, die wir gerade generiert haben $y_1$ bis $y_3$, mischen wir jetzt einmal nach festen Anteilen miteinander. Dafür nutzen wir die folgende Schreibweise in <span class="in">`{simstudy}`</span>. Die Schreibweise ist erstmal etwas ungewohnt. Wir wollen 30% der Werte von $y_1$ also schreiben wir <span class="in">`y_1 | 0.3`</span>. Dann noch 40% der Werte von $y_2$ mit <span class="in">`y_2 | 0.4`</span> sowie 30% der Werte von $y_3$ mit <span class="in">`y_3 | 0.3`</span>. Wir nennen dann die Spalte <span class="in">`y_null`</span>. Wir haben hier dann die Nullverteilung erstellt.</span>
<span id="cb208-1315"><a href="#cb208-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1318"><a href="#cb208-1318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1319"><a href="#cb208-1319" aria-hidden="true" tabindex="-1"></a>mix_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(mix_def, <span class="at">varname =</span> <span class="st">"y_null"</span>, </span>
<span id="cb208-1320"><a href="#cb208-1320" aria-hidden="true" tabindex="-1"></a>                   <span class="at">formula =</span> <span class="st">"y_1 | 0.3 + y_2 | 0.4 + y_3 | 0.3"</span>, </span>
<span id="cb208-1321"><a href="#cb208-1321" aria-hidden="true" tabindex="-1"></a>                   <span class="at">dist =</span> <span class="st">"mixture"</span>)</span>
<span id="cb208-1322"><a href="#cb208-1322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1323"><a href="#cb208-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1324"><a href="#cb208-1324" aria-hidden="true" tabindex="-1"></a>Ich generiere mir dann eintausend Beobachtungen, damit wir am Ende auch was sehen.</span>
<span id="cb208-1325"><a href="#cb208-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1328"><a href="#cb208-1328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1329"><a href="#cb208-1329" aria-hidden="true" tabindex="-1"></a>mix_null_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">1000</span>, mix_def)</span>
<span id="cb208-1330"><a href="#cb208-1330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1331"><a href="#cb208-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1332"><a href="#cb208-1332" aria-hidden="true" tabindex="-1"></a>Dann kannst du dir in der folgenden Abbildung einmal anschauen, wie die drei einzelnen Normalverteilungen aussehen und wie sich dann die Kombination durch die Addierung ergibt. Wir nennen diese Verteilung jetzt unsere Nullverteilung, da wir ja noch eine andere Verteilung benötigen um einen Effekt darzustellen.</span>
<span id="cb208-1333"><a href="#cb208-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1336"><a href="#cb208-1336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1337"><a href="#cb208-1337" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1338"><a href="#cb208-1338" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-1339"><a href="#cb208-1339" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-1340"><a href="#cb208-1340" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-1341"><a href="#cb208-1341" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-1342"><a href="#cb208-1342" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb208-1343"><a href="#cb208-1343" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Gemischte Normalverteilung in einem Densityplot. **(A)** Die drei einzelnen Normalverteilungen. **(B)** Die gemischte Normalverteilung. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-1344"><a href="#cb208-1344" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-mixed-normal</span></span>
<span id="cb208-1345"><a href="#cb208-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1346"><a href="#cb208-1346" aria-hidden="true" tabindex="-1"></a>p1_mixed_normal <span class="ot">&lt;-</span> mix_null_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-1347"><a href="#cb208-1347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> y_null)) <span class="sc">+</span></span>
<span id="cb208-1348"><a href="#cb208-1348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-1349"><a href="#cb208-1349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"#F5C710"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb208-1350"><a href="#cb208-1350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb208-1351"><a href="#cb208-1351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Kombinierte Messwerte (Y)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">fill =</span> <span class="st">""</span>)</span>
<span id="cb208-1352"><a href="#cb208-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1353"><a href="#cb208-1353" aria-hidden="true" tabindex="-1"></a>p2_mixed_normal <span class="ot">&lt;-</span> mix_null_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-1354"><a href="#cb208-1354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(y_1<span class="sc">:</span>y_3) <span class="sc">|&gt;</span> </span>
<span id="cb208-1355"><a href="#cb208-1355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> name)) <span class="sc">+</span></span>
<span id="cb208-1356"><a href="#cb208-1356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-1357"><a href="#cb208-1357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb208-1358"><a href="#cb208-1358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb208-1359"><a href="#cb208-1359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb208-1360"><a href="#cb208-1360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb208-1361"><a href="#cb208-1361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Individuelle Messwerte (Y)"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>, <span class="at">fill =</span> <span class="st">""</span>)</span>
<span id="cb208-1362"><a href="#cb208-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1363"><a href="#cb208-1363" aria-hidden="true" tabindex="-1"></a>p2_mixed_normal <span class="sc">+</span> p1_mixed_normal <span class="sc">+</span></span>
<span id="cb208-1364"><a href="#cb208-1364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb208-1365"><a href="#cb208-1365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb208-1366"><a href="#cb208-1366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb208-1367"><a href="#cb208-1367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1368"><a href="#cb208-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1369"><a href="#cb208-1369" aria-hidden="true" tabindex="-1"></a>Jetzt möchte ich noch eine Alternative darstellen. Wir haben ja noch eine Gruppe mit Effekt. Daher adddiere ich einfach $+2$ auf die Nullverteilung auf und generiere mir neue Werte. Achtung, ich verschiebe hier nicht einfach die Nullverteilung sondern generiere mir neue Zahlen mit einem um $+2$ erhöhten kombinierten Mittelwert.</span>
<span id="cb208-1370"><a href="#cb208-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1373"><a href="#cb208-1373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1374"><a href="#cb208-1374" aria-hidden="true" tabindex="-1"></a>mixed_alt_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y_alt"</span>, <span class="at">formula =</span> <span class="st">"y_null + 2"</span>, <span class="at">variance =</span> <span class="dv">1</span>,</span>
<span id="cb208-1375"><a href="#cb208-1375" aria-hidden="true" tabindex="-1"></a>                            <span class="at">dist =</span> <span class="st">"normal"</span>)</span>
<span id="cb208-1376"><a href="#cb208-1376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1377"><a href="#cb208-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1378"><a href="#cb208-1378" aria-hidden="true" tabindex="-1"></a>Dann müssen wir noch die beiden Verteilungen miteinander kombinieren.</span>
<span id="cb208-1379"><a href="#cb208-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1382"><a href="#cb208-1382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1383"><a href="#cb208-1383" aria-hidden="true" tabindex="-1"></a>mix_null_alt_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(mixed_alt_def, mix_null_dt)</span>
<span id="cb208-1384"><a href="#cb208-1384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1385"><a href="#cb208-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1386"><a href="#cb208-1386" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du nochmal die beiden Vereilungen der beiden Gruppen. Wir haben eine Gruppe, die der Nullverteilung folgt und einmal eine Verteilung für die Alternative. Wenn du noch mehr Gruppen haben wollen würdest, dann musst du entsprechend mehr Verteilungen verschieben.</span>
<span id="cb208-1387"><a href="#cb208-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1390"><a href="#cb208-1390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1391"><a href="#cb208-1391" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1392"><a href="#cb208-1392" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-1393"><a href="#cb208-1393" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-1394"><a href="#cb208-1394" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-1395"><a href="#cb208-1395" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-1396"><a href="#cb208-1396" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb208-1397"><a href="#cb208-1397" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Gemischte Normalverteilung in einem Densityplot. **(A)** Nullverteilung. **(B)** Alternativeverteilung mit einem Effekt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-1398"><a href="#cb208-1398" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-mixed-null-alt</span></span>
<span id="cb208-1399"><a href="#cb208-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1400"><a href="#cb208-1400" aria-hidden="true" tabindex="-1"></a>p1_mixed_null_normal <span class="ot">&lt;-</span> mix_null_alt_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-1401"><a href="#cb208-1401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> y_null)) <span class="sc">+</span></span>
<span id="cb208-1402"><a href="#cb208-1402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-1403"><a href="#cb208-1403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"#F5C710"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb208-1404"><a href="#cb208-1404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">13</span>) <span class="sc">+</span></span>
<span id="cb208-1405"><a href="#cb208-1405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Messwert (Y)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb208-1406"><a href="#cb208-1406" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Nullverteilung"</span>) <span class="sc">+</span></span>
<span id="cb208-1407"><a href="#cb208-1407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb208-1408"><a href="#cb208-1408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">5</span>)</span>
<span id="cb208-1409"><a href="#cb208-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1410"><a href="#cb208-1410" aria-hidden="true" tabindex="-1"></a>p2_mixed_alt_normal <span class="ot">&lt;-</span> mix_null_alt_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-1411"><a href="#cb208-1411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> y_alt)) <span class="sc">+</span></span>
<span id="cb208-1412"><a href="#cb208-1412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-1413"><a href="#cb208-1413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"#009E73"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb208-1414"><a href="#cb208-1414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb208-1415"><a href="#cb208-1415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Messwert (Y)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">fill =</span> <span class="st">""</span>,</span>
<span id="cb208-1416"><a href="#cb208-1416" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Alternativeverteilung"</span>) <span class="sc">+</span></span>
<span id="cb208-1417"><a href="#cb208-1417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">7</span>), <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb208-1418"><a href="#cb208-1418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">5</span>), <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">linetype =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb208-1419"><a href="#cb208-1419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="st">"5+2"</span>))</span>
<span id="cb208-1420"><a href="#cb208-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1421"><a href="#cb208-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1422"><a href="#cb208-1422" aria-hidden="true" tabindex="-1"></a>p1_mixed_null_normal <span class="sc">+</span> p2_mixed_alt_normal <span class="sc">+</span></span>
<span id="cb208-1423"><a href="#cb208-1423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb208-1424"><a href="#cb208-1424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb208-1425"><a href="#cb208-1425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>)) </span>
<span id="cb208-1426"><a href="#cb208-1426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1427"><a href="#cb208-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1428"><a href="#cb208-1428" aria-hidden="true" tabindex="-1"></a>Dann wollen wir natürlich auch noch zufällige Zahlen genieren. Wir ziehen jetzt jeweils drei Beobachtungen aus den beiden Verteilungen. Wenn wir natürlich eine sehr komplexe Verteilung in der Grundgesamtheit haben, dann wird diese natürlich durch sehr kleine Stichproben kaum repräsentiert.</span>
<span id="cb208-1429"><a href="#cb208-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1432"><a href="#cb208-1432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1433"><a href="#cb208-1433" aria-hidden="true" tabindex="-1"></a>mix_null_alt_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-1434"><a href="#cb208-1434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(y_null<span class="sc">:</span>y_alt) <span class="sc">|&gt;</span> </span>
<span id="cb208-1435"><a href="#cb208-1435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(y_null<span class="sc">:</span>y_alt) <span class="sc">|&gt;</span> </span>
<span id="cb208-1436"><a href="#cb208-1436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span> </span>
<span id="cb208-1437"><a href="#cb208-1437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb208-1438"><a href="#cb208-1438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1439"><a href="#cb208-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1440"><a href="#cb208-1440" aria-hidden="true" tabindex="-1"></a>Auch hier ist die Frage, wozu brauchen wir das? Vermutlich nicht im praktischen Alltag, aber in der Testung von Algorithmen mag eine mehrgipflige Verteilung schon von Interesse sein. Wir haben ja hier mehrere Normalverteilungen, die sich aufaddieren. Jede dieser Normalverteilungen könnte eine unentdeckte Subpopulation sein, die eben dann eine andere Verteilung des Frischegewichts hat. Ich vermute aber, dass die Anwendungsfälle eher selten sind.</span>
<span id="cb208-1441"><a href="#cb208-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1442"><a href="#cb208-1442" aria-hidden="true" tabindex="-1"></a><span class="fu">### Possionverteilt</span></span>
<span id="cb208-1443"><a href="#cb208-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1444"><a href="#cb208-1444" aria-hidden="true" tabindex="-1"></a>Nachdem wir vieles einmal mit einer Normalverteilung durchprobiert haben, kommen wir jetzt einmal zu einer anderen Verteilung. Wir fangen mit der Poissonverteilung an, da die Poissonverteilung der Normalverteilung gar nicht so unähnlich ist. Wir nutzen die Poissonverteilung wenn wir Zähldaten abbilden wollen. Daher ist die Poissonverteilung immer ganzzahlig oder diskret. Wenn wir was zählen, dann haben wir auch immer positive Werte einschließlich der Nullzählungen vorliegen. Mit dem Wissen können wir dann anfangen unsere Zähldaten in einer Poissonverteilung zu generieren. Wir generieren jetzt unsere Daten mit dem R Paket <span class="in">`{simstudy}`</span>, da wir hier es dann sehr viel einfacher haben als händisch in R.</span>
<span id="cb208-1445"><a href="#cb208-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1446"><a href="#cb208-1446" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb208-1447"><a href="#cb208-1447" aria-hidden="true" tabindex="-1"></a><span class="fu">## Normalverteilung und Runden</span></span>
<span id="cb208-1448"><a href="#cb208-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1449"><a href="#cb208-1449" aria-hidden="true" tabindex="-1"></a>Gleich vorweg, es gibt auch eine einfachere Möglichkeit sich die Zähldaten zu genierieren. Du kannst auch eine Normalverteilung nehmen und dann einfach runden. Dann hast du zwar eine leichte Abweichung, aber für das Ausprobieren für Analysen macht es fast keinen Unterschied.</span>
<span id="cb208-1450"><a href="#cb208-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1453"><a href="#cb208-1453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1454"><a href="#cb208-1454" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>()</span>
<span id="cb208-1455"><a href="#cb208-1455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1456"><a href="#cb208-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1457"><a href="#cb208-1457" aria-hidden="true" tabindex="-1"></a>Die Abweichungen sind tolerable wie @kruppa2016simulation gezeigt hat. Wenn du dann noch darauf achtest, dass du keine negativen Werte simulierst, dann ist alles soweit in Ordnung. Ich würde alle negativen Werte aus einer Normalverteilung dann auf Null setzen. Das simuliert eine Poissonverteilung am Besten.</span>
<span id="cb208-1458"><a href="#cb208-1458" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-1459"><a href="#cb208-1459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1460"><a href="#cb208-1460" aria-hidden="true" tabindex="-1"></a>Gegenüber der Normalverteilung müssen wir jetzt einige Anpassungen vornehmen. Im Folgenden müssen wir die Fallzahl erhöhen, da die Poissonverteilung keine eigenen Parameter für die Varianz hat. Die Streuung ist nämlich eien Funktion des Mittelwerts. Je größer der Mittelwert, desto größer die Varianz. Daher kann ich keine sehr kleine Streuung einstellen um auch bei kleinen Fallzahlen meine Effekte oder Mittelwerte wiederzuerhalten. Ich nutze daher hier immer um die eintausend Beobachtungen, damit wir hier auch stabile Effekte wiedergegeben bekommen.</span>
<span id="cb208-1461"><a href="#cb208-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1462"><a href="#cb208-1462" aria-hidden="true" tabindex="-1"></a><span class="fu">### Faktorielles Design {.unnumbered .unlisted}</span></span>
<span id="cb208-1463"><a href="#cb208-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1464"><a href="#cb208-1464" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit einem faktoriellen Design. Wir schauen uns jetzt einmal einen Faktor mit mehr als zwei Leveln an sowie zwei Faktoren mit einmal drei Leveln und einmal zwei Leveln. Dann nehmen wir noch die Interaktion mit hinzu. Wenn wir uns mit dem faktoriellen Design beschäftigen dann generieren wir zuerst das Faktorenraster und ergänzen dann den Messwert aus der Poissonverteilung. Das ist jetzt hier der etwas größere Unterschied zu den normalverteilten Messwerten. Wir brauchen hier immer unser Raster und dann ergänzen wir unseren Messwert mit dem R Paket <span class="in">`{simstudy}`</span>. Prinzipiell geht es auch für das einfaktorielle Design einfacher über <span class="in">`rpois()`</span>, aber wir üben ja hier auch für die komplexeren Modelle.</span>
<span id="cb208-1465"><a href="#cb208-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1466"><a href="#cb208-1466" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb208-1467"><a href="#cb208-1467" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb208-1468"><a href="#cb208-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1469"><a href="#cb208-1469" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{simstudy}`</span> nutzt als Speicherung der Daten nicht ein <span class="in">`tibble`</span> sondern das R Paket <span class="in">`{data.table}`</span>. Um unsere <span class="in">`tibble`</span> dann umzuformen nutze ich die Funktion <span class="in">`as.data.table()`</span>. Der Rest bleibt aber faktisch gleich.</span>
<span id="cb208-1470"><a href="#cb208-1470" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-1471"><a href="#cb208-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1472"><a href="#cb208-1472" aria-hidden="true" tabindex="-1"></a>Wir beginnne gleich mit einem einfaktoriellen Design mit mehr als 2 Leveln. Ich schaue hier mir mal einen Faktor mit drei Gruppen an. Der simple Fall mit nur zwei Gruppen ist eher selten und deshalb überspringe ich auch den Zweigruppenfall. Im Prinzip kannst du dir dann den Zweigruppenfall in <span class="in">`rpois()`</span> schnell selber bauen.</span>
<span id="cb208-1473"><a href="#cb208-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1474"><a href="#cb208-1474" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktoriell $f_A$ mit \&gt;2 Leveln {.unnumbered .unlisted}</span></span>
<span id="cb208-1475"><a href="#cb208-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1476"><a href="#cb208-1476" aria-hidden="true" tabindex="-1"></a>Wenn wir ein einfaktorielles Design vorliegen haben, dann brauchen wir einen Faktor mit drei Leveln sowie eine Anzahl an Beobachtungen pro Level. In den folgenden Tabs zeige ich dir dann einmal wie wir die Daten in <span class="in">`{simstudy}`</span> generieren können. Das ist hier dann eher eine Fingerübung und etwas umständlich. Das geht natürlich für so einen einfachen Fall mit einem Faktor schneller mit der Funktion <span class="in">`rpois()`</span> wo wir dann schneller die Daten erstellen können. Am Ende gehe ich nochmal auf Excel ein.</span>
<span id="cb208-1477"><a href="#cb208-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1478"><a href="#cb208-1478" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb208-1479"><a href="#cb208-1479" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{simstudy}`</span></span>
<span id="cb208-1480"><a href="#cb208-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1481"><a href="#cb208-1481" aria-hidden="true" tabindex="-1"></a>Wir bauen uns hier erstmal das Datenraster für den Faktor auf, da wir dann das Raster mit dem R Paket <span class="in">`{simstdy}`</span> erweitern und mit einem poissonverteilten Messwert ergänzen. Das heißt, wir nutzen die Funktion <span class="in">`expand_grid()`</span> um uns für die drei Level jeweils eintausend Beobachtungen oder Wiederholungen zu erstellen. Da wir gleich mit <span class="in">`{simstudy}`</span> weiterarbeiten brauche ich das Datenraster als ein <span class="in">`data.table`</span> Objekt.</span>
<span id="cb208-1482"><a href="#cb208-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1485"><a href="#cb208-1485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1486"><a href="#cb208-1486" aria-hidden="true" tabindex="-1"></a>fac1_dt <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb208-1487"><a href="#cb208-1487" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-1488"><a href="#cb208-1488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span>
<span id="cb208-1489"><a href="#cb208-1489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1490"><a href="#cb208-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1491"><a href="#cb208-1491" aria-hidden="true" tabindex="-1"></a>Dann können wir uns auch schon einmal den Datensatz anschauen, wo wir eben nur das Datenraster für die Faktoren enthalten haben. Wir haben dreitausend Beobachtungen jeweils eintausend Beobachtungen pro Level des Faktors.</span>
<span id="cb208-1492"><a href="#cb208-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1495"><a href="#cb208-1495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1496"><a href="#cb208-1496" aria-hidden="true" tabindex="-1"></a>fac1_dt</span>
<span id="cb208-1497"><a href="#cb208-1497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1498"><a href="#cb208-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1499"><a href="#cb208-1499" aria-hidden="true" tabindex="-1"></a>Jetzt brauchen wir noch die Definition für unseren poissonverteilten Messwert in <span class="in">`{simstudy}`</span>. Dafür benennen wir dann den Messwert mit <span class="in">`y`</span> und geben noch die Formel an. Jedes Level hat einen Effekt von $+4$. Dann noch die Verteilung angeben, damit wir hier auch aus der Possionverteilung ziehen.</span>
<span id="cb208-1500"><a href="#cb208-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1503"><a href="#cb208-1503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1504"><a href="#cb208-1504" aria-hidden="true" tabindex="-1"></a>y_pois_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">formula =</span> <span class="st">"0 + 4*f_a"</span>,</span>
<span id="cb208-1505"><a href="#cb208-1505" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dist =</span> <span class="st">"poisson"</span>)</span>
<span id="cb208-1506"><a href="#cb208-1506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1507"><a href="#cb208-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1508"><a href="#cb208-1508" aria-hidden="true" tabindex="-1"></a>Jetzt bringen wir unser Datenraster mit unserer Datendefinition zusammen. Wir erhalten dann einen neuen Datensatz mit unserem poissonverteilten Messwert. Am Ende möchte ich dann noch die Spalte <span class="in">`f_a`</span> als Faktor mutieren und die Level umbenennen. Dann sind wir auch schon fertig.</span>
<span id="cb208-1509"><a href="#cb208-1509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1512"><a href="#cb208-1512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1513"><a href="#cb208-1513" aria-hidden="true" tabindex="-1"></a>fac1_pois_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(y_pois_def, fac1_dt) <span class="sc">|&gt;</span></span>
<span id="cb208-1514"><a href="#cb208-1514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"A."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))) </span>
<span id="cb208-1515"><a href="#cb208-1515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1516"><a href="#cb208-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1517"><a href="#cb208-1517" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du einmal die dreitausend generierten Beobachtungen pro Gruppe. Wir sehen hier einmal den Intercept bei Null sowie den Effekt von $+4$ in jedem Level des Faktors. Die Varianz steigt mit dem Mittelwert an. Die Poissonverteilung ist eine schiefe Verteilung bei einem geringen Mittelwert. Je größer der Mittelwert wird, desto ähnlicher wird die Poissonverteilung einer Normalverteilung.</span>
<span id="cb208-1518"><a href="#cb208-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1521"><a href="#cb208-1521" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1522"><a href="#cb208-1522" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1523"><a href="#cb208-1523" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-1524"><a href="#cb208-1524" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-1525"><a href="#cb208-1525" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-1526"><a href="#cb208-1526" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-1527"><a href="#cb208-1527" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb208-1528"><a href="#cb208-1528" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Boxplot der einfaktoriellen Poissondaten mit einem Intercept $\\beta_0$ von 0 sowie den Effekten von $+4$ pro Faktorlevel. Die Gruppenmittelwerte sind mit dargestellt. Insgesamt wurden $n = 1000$ Beobachtungen pro Gruppe generiert. Mit stiegendem Mittelwert steigt auch die Varianz in der Possionverteilung. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-1529"><a href="#cb208-1529" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-fac1-pois</span></span>
<span id="cb208-1530"><a href="#cb208-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1531"><a href="#cb208-1531" aria-hidden="true" tabindex="-1"></a>fac1_pois_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-1532"><a href="#cb208-1532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> f_a, <span class="at">y =</span> y, <span class="at">fill =</span> f_a)) <span class="sc">+</span></span>
<span id="cb208-1533"><a href="#cb208-1533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-1534"><a href="#cb208-1534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb208-1535"><a href="#cb208-1535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb208-1536"><a href="#cb208-1536" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y.., <span class="dv">0</span>)), </span>
<span id="cb208-1537"><a href="#cb208-1537" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fl">0.2</span>),</span>
<span id="cb208-1538"><a href="#cb208-1538" aria-hidden="true" tabindex="-1"></a>               <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb208-1539"><a href="#cb208-1539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-1540"><a href="#cb208-1540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb208-1541"><a href="#cb208-1541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb208-1542"><a href="#cb208-1542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Faktor A"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>)</span>
<span id="cb208-1543"><a href="#cb208-1543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1544"><a href="#cb208-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1545"><a href="#cb208-1545" aria-hidden="true" tabindex="-1"></a><span class="fu">## `rpois()`</span></span>
<span id="cb208-1546"><a href="#cb208-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1547"><a href="#cb208-1547" aria-hidden="true" tabindex="-1"></a>In dem einfaktoriellen Fall können wir uns auch die Daten einmal mit der Funktion <span class="in">`rpois()`</span> erstellen. Wir brauchen hier einmal die Fallzahl sowie den Mittelwert als <span class="in">`lambda`</span>. Wir können in einer Poissonverteilung keine Streuung angeben, da die Streuung eine Funktion des Mittelwerts ist. Je größer der Mittelwert desto größer die Streuung.</span>
<span id="cb208-1548"><a href="#cb208-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1551"><a href="#cb208-1551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1552"><a href="#cb208-1552" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="st">"1"</span> <span class="ot">=</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">lambda =</span> <span class="dv">2</span>),</span>
<span id="cb208-1553"><a href="#cb208-1553" aria-hidden="true" tabindex="-1"></a>       <span class="st">"2"</span> <span class="ot">=</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">lambda =</span> <span class="dv">8</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb208-1554"><a href="#cb208-1554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"f_a"</span>, <span class="at">value =</span> <span class="st">"y"</span>)</span>
<span id="cb208-1555"><a href="#cb208-1555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1556"><a href="#cb208-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1557"><a href="#cb208-1557" aria-hidden="true" tabindex="-1"></a>In diesem Fall ist eben sehr einfach sich die Daten zu bauen. Meiner Meinung nach reicht so eine simple Art auch vollkommen aus, wenn wir die Daten nur zum Ausprobieren brauchen und nicht unbedingt gerundete Normalverteilungsdaten wollen.</span>
<span id="cb208-1558"><a href="#cb208-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1559"><a href="#cb208-1559" aria-hidden="true" tabindex="-1"></a><span class="fu">## Excel</span></span>
<span id="cb208-1560"><a href="#cb208-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1561"><a href="#cb208-1561" aria-hidden="true" tabindex="-1"></a>In Excel können wir uns keine Zuafallszahlen aus einer Poissonverteilung generieren lassen. Daher nutzen wir hier auch <span class="in">`NORMINV()`</span> und runden dann die Ergebnisse ganzahlig. Wenn wir negative Werte haben sollten, dann müssen wir diese Werte dann auf Null setzen.</span>
<span id="cb208-1562"><a href="#cb208-1562" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-1563"><a href="#cb208-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1564"><a href="#cb208-1564" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktoriell ohne Interaktion $f_A + f_B$ {.unnumbered .unlisted}</span></span>
<span id="cb208-1565"><a href="#cb208-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1566"><a href="#cb208-1566" aria-hidden="true" tabindex="-1"></a>Jetzt kommen wir zu den etwas interessanteren Design mit dem zweifakotriellen Experiment ohne Interaktion. Wir haben jetzt hier zwei Faktoren $f_A$ und $f_B$ mit jeweils drei oder zwei Leveln vorliegen. Die beiden Faktoren sind untereinander unabhängig, daher haben wir hier keine Interaktion vorliegen. Wir wollen jetzt einmal eintausend poissonverteilte Messwerte generieren. Dafür nutze ich wie immer einmal das R Paket <span class="in">`{simstudy}`</span> sowie den Weg über die Funktion <span class="in">`rpois()`</span>. In Excel können wir keine Poissondaten erschaffen. Hier müssen wir dann die Daten aus einer Normalverteilung entsprechend runden.</span>
<span id="cb208-1567"><a href="#cb208-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1568"><a href="#cb208-1568" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb208-1569"><a href="#cb208-1569" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{simstudy}`</span></span>
<span id="cb208-1570"><a href="#cb208-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1571"><a href="#cb208-1571" aria-hidden="true" tabindex="-1"></a>Wir bauen uns hier erstmal das Datenraster für die beiden Faktoren auf, da wir dann das Raster mit dem R Paket <span class="in">`{simstdy}`</span> erweitern und mit einem poissonverteilten Messwert ergänzen. Das heißt, wir nutzen die Funktion <span class="in">`expand_grid()`</span> um uns für die drei Level in der Kombination der anderen zwei Level jeweils eintausend Beobachtungen oder Wiederholungen zu erstellen. Da wir gleich mit <span class="in">`{simstudy}`</span> weiterarbeiten brauche ich das Datenraster als ein <span class="in">`data.table`</span> Objekt.</span>
<span id="cb208-1572"><a href="#cb208-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1575"><a href="#cb208-1575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1576"><a href="#cb208-1576" aria-hidden="true" tabindex="-1"></a>fac2_dt <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb208-1577"><a href="#cb208-1577" aria-hidden="true" tabindex="-1"></a>                       <span class="at">f_b =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb208-1578"><a href="#cb208-1578" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-1579"><a href="#cb208-1579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span>
<span id="cb208-1580"><a href="#cb208-1580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1581"><a href="#cb208-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1582"><a href="#cb208-1582" aria-hidden="true" tabindex="-1"></a>Dann können wir uns auch schon einmal den Datensatz anschauen, wo wir eben nur das Datenraster für die Faktoren enthalten haben. Wir haben sechstausend Beobachtungen jeweils eintausend Beobachtungen pro Faktorkombination der beiden Faktoren.</span>
<span id="cb208-1583"><a href="#cb208-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1586"><a href="#cb208-1586" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1587"><a href="#cb208-1587" aria-hidden="true" tabindex="-1"></a>fac2_dt</span>
<span id="cb208-1588"><a href="#cb208-1588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1589"><a href="#cb208-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1590"><a href="#cb208-1590" aria-hidden="true" tabindex="-1"></a>Jetzt brauchen wir noch die Definition für unseren poissonverteilten Messwert in <span class="in">`{simstudy}`</span>. Dafür benennen wir dann den Messwert mit <span class="in">`y`</span> und geben noch die Formel an. Jedes Level des Faktors $f_A$ hat einen Effekt von $+2$ und jedes Level des Faktors $f_B$ hat einen Effekt von $+6$. Da wir hier nur zwei Level vorliegen haben, unterschieden sich die beiden Level $B.1$ und $B.2$ einfach um sechs Einheiten. Dann noch die Verteilung angeben, damit wir hier auch aus der Possionverteilung ziehen.</span>
<span id="cb208-1591"><a href="#cb208-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1594"><a href="#cb208-1594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1595"><a href="#cb208-1595" aria-hidden="true" tabindex="-1"></a>y_pois_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">formula =</span> <span class="st">"0 + 2*f_a + 6*f_b"</span>,</span>
<span id="cb208-1596"><a href="#cb208-1596" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dist =</span> <span class="st">"poisson"</span>)</span>
<span id="cb208-1597"><a href="#cb208-1597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1598"><a href="#cb208-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1599"><a href="#cb208-1599" aria-hidden="true" tabindex="-1"></a>Jetzt bringen wir unser Datenraster mit unserer Datendefinition zusammen. Wir erhalten dann einen neuen Datensatz mit unserem poissonverteilten Messwert. Am Ende möchte ich dann noch die Spalte <span class="in">`f_a`</span> und <span class="in">`f_b`</span> als Faktoren mutieren und die Level umbenennen. Dann sind wir auch schon fertig.</span>
<span id="cb208-1600"><a href="#cb208-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1603"><a href="#cb208-1603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1604"><a href="#cb208-1604" aria-hidden="true" tabindex="-1"></a>fac2_pois_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(y_pois_def, fac2_dt) <span class="sc">|&gt;</span></span>
<span id="cb208-1605"><a href="#cb208-1605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"A."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)),</span>
<span id="cb208-1606"><a href="#cb208-1606" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">factor</span>(f_b, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"B."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)))</span>
<span id="cb208-1607"><a href="#cb208-1607" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1608"><a href="#cb208-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1609"><a href="#cb208-1609" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du einmal die sechstausend generierten Beobachtungen pro Gruppe. Wir sehen hier einmal den Intercept bei Null sowie den Effekt von $+4$ in jedem Level des Faktors $f_A$ sowie die Verschiebung in dem Faktor $f_B$. Die Varianz steigt mit dem Mittelwert an. Die Poissonverteilung ist eine schiefe Verteilung bei einem geringen Mittelwert. Je größer der Mittelwert wird, desto ähnlicher wird die Poissonverteilung einer Normalverteilung.</span>
<span id="cb208-1610"><a href="#cb208-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1613"><a href="#cb208-1613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1614"><a href="#cb208-1614" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1615"><a href="#cb208-1615" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-1616"><a href="#cb208-1616" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-1617"><a href="#cb208-1617" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-1618"><a href="#cb208-1618" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-1619"><a href="#cb208-1619" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb208-1620"><a href="#cb208-1620" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Boxplot der zweifaktoriellen Poissondaten mit einem Intercept $\\beta_0$ von 0 sowie den Effekten von $+2$ pro Faktorlevel von Faktor $f_A$ sowie von $+6$ pro Faktorlevel von Faktor $f_B$. Da keine interaktion vorliegt, sind sind die Level $B.2$ um den festen Wert des Effekts verschoben. Die Gruppenmittelwerte sind mit dargestellt. Insgesamt wurden $n = 1000$ Beobachtungen pro Gruppe generiert. Mit stiegendem Mittelwert steigt auch die Varianz in der Possionverteilung. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-1621"><a href="#cb208-1621" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-fac2-nointer-pois</span></span>
<span id="cb208-1622"><a href="#cb208-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1623"><a href="#cb208-1623" aria-hidden="true" tabindex="-1"></a>fac2_pois_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-1624"><a href="#cb208-1624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> f_a, <span class="at">y =</span> y, <span class="at">fill =</span> f_b)) <span class="sc">+</span></span>
<span id="cb208-1625"><a href="#cb208-1625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-1626"><a href="#cb208-1626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-1627"><a href="#cb208-1627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb208-1628"><a href="#cb208-1628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb208-1629"><a href="#cb208-1629" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y.., <span class="dv">0</span>)), </span>
<span id="cb208-1630"><a href="#cb208-1630" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>)),</span>
<span id="cb208-1631"><a href="#cb208-1631" aria-hidden="true" tabindex="-1"></a>               <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb208-1632"><a href="#cb208-1632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb208-1633"><a href="#cb208-1633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb208-1634"><a href="#cb208-1634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Faktor A"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>, <span class="at">fill =</span> <span class="st">"Faktor B"</span>)</span>
<span id="cb208-1635"><a href="#cb208-1635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1636"><a href="#cb208-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1637"><a href="#cb208-1637" aria-hidden="true" tabindex="-1"></a><span class="fu">## `rpois()`</span></span>
<span id="cb208-1638"><a href="#cb208-1638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1639"><a href="#cb208-1639" aria-hidden="true" tabindex="-1"></a>In dem zweifaktoriellen Fall können wir uns auch die Daten auch einmal mit der Funktion <span class="in">`rpois()`</span> erstellen. Wir brauchen hier einmal die Fallzahl sowie den Mittelwert als <span class="in">`lambda`</span>. Wir können in einer Poissonverteilung keine Streuung angeben, da die Streuung eine Funktion des Mittelwerts ist. Je größer der Mittelwert desto größer die Streuung. Hier bauen wir uns aber erst den Vektor der Effekte und stecken dann diesen in die Funktion <span class="in">`rpois()`</span>. Das ist etwas anders als bei der Normalverteilung. Wir haben ja hier keinen symmetrischen Fehlerterm, den wir aufaddieren.</span>
<span id="cb208-1640"><a href="#cb208-1640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1643"><a href="#cb208-1643" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1644"><a href="#cb208-1644" aria-hidden="true" tabindex="-1"></a>fac2_nointer_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb208-1645"><a href="#cb208-1645" aria-hidden="true" tabindex="-1"></a>                                <span class="at">f_b =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb208-1646"><a href="#cb208-1646" aria-hidden="true" tabindex="-1"></a>                                <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-1647"><a href="#cb208-1647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y_eff =</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb208-1648"><a href="#cb208-1648" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">2</span> <span class="sc">*</span> f_a <span class="sc">+</span></span>
<span id="cb208-1649"><a href="#cb208-1649" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">6</span> <span class="sc">*</span> f_b,</span>
<span id="cb208-1650"><a href="#cb208-1650" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">rpois</span>(<span class="fu">length</span>(y_eff), <span class="at">lambda =</span> y_eff)) <span class="sc">|&gt;</span> </span>
<span id="cb208-1651"><a href="#cb208-1651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">as_factor</span>(f_a),</span>
<span id="cb208-1652"><a href="#cb208-1652" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">as_factor</span>(f_b))</span>
<span id="cb208-1653"><a href="#cb208-1653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1654"><a href="#cb208-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1655"><a href="#cb208-1655" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns nochmal an, ob wir auch die Mittelwerte und Mediane wiedererhalten.</span>
<span id="cb208-1656"><a href="#cb208-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1659"><a href="#cb208-1659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1660"><a href="#cb208-1660" aria-hidden="true" tabindex="-1"></a>fac2_nointer_tbl <span class="sc">|&gt;</span> </span>
<span id="cb208-1661"><a href="#cb208-1661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(f_a, f_b) <span class="sc">|&gt;</span> </span>
<span id="cb208-1662"><a href="#cb208-1662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">round</span>(<span class="fu">mean</span>(y)), <span class="fu">median</span>(y))</span>
<span id="cb208-1663"><a href="#cb208-1663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1664"><a href="#cb208-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1665"><a href="#cb208-1665" aria-hidden="true" tabindex="-1"></a>In diesem Fall ist schon nicht mehr so einfach sich die Daten zu bauen. Meiner Meinung nach solltest du dann spätenstens hier einmal zu <span class="in">`{simstudy}`</span> überwechseln. Die Funktionalität von dem R Paket ist da wirklich besser, als sich das selber in einem <span class="in">`tibble`</span> zusammenzubauen.</span>
<span id="cb208-1666"><a href="#cb208-1666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1667"><a href="#cb208-1667" aria-hidden="true" tabindex="-1"></a><span class="fu">## Excel</span></span>
<span id="cb208-1668"><a href="#cb208-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1669"><a href="#cb208-1669" aria-hidden="true" tabindex="-1"></a>In Excel können wir uns keine Zuafallszahlen aus einer Poissonverteilung generieren lassen. Daher nutzen wir hier auch <span class="in">`NORMINV()`</span> und runden dann die Ergebnisse ganzahlig. Wenn wir negative Werte haben sollten, dann müssen wir diese Werte dann auf Null setzen. Bei zwei Faktoren hört hier schon etwas der Spaß auf, da wir ja alle Fakotrkombinationen dann einzeln anlegen müssen.</span>
<span id="cb208-1670"><a href="#cb208-1670" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-1671"><a href="#cb208-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1672"><a href="#cb208-1672" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktoriell mit Interaktion $f_A + f_B + f_A \times f_B$ {.unnumbered .unlisted}</span></span>
<span id="cb208-1673"><a href="#cb208-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1674"><a href="#cb208-1674" aria-hidden="true" tabindex="-1"></a>Für den zweifaktoriellen Fall mit Interaktion haben wir jetzt hier zwei Faktoren $f_A$ und $f_B$ mit jeweils drei oder zwei Leveln vorliegen. Ich gehe diesmal nur nochauf auf das R Paket <span class="in">`{simstdy}`</span> ein, da es händisch und in Excel jhier nicht mehr funktioniert. Wenn du es händisch machen möchtest, dann kannst du dir natürlich für alle Faktorkombinationen die Effekte zusammenbauen und dann <span class="in">`rpois()`</span> für die Zufallszahlen nutzen. Ich empfinde daran aber keinen Gewinn mehr.</span>
<span id="cb208-1675"><a href="#cb208-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1676"><a href="#cb208-1676" aria-hidden="true" tabindex="-1"></a>Wir bauen uns hier erstmal das Datenraster wie schon vorab für die beiden Faktoren auf, da wir dann das Raster mit dem R Paket <span class="in">`{simstdy}`</span> erweitern und mit einem poissonverteilten Messwert ergänzen. Das heißt, wir nutzen die Funktion <span class="in">`expand_grid()`</span> um uns für die drei Level in der Kombination der anderen zwei Level jeweils eintausend Beobachtungen oder Wiederholungen zu erstellen. Da wir gleich mit <span class="in">`{simstudy}`</span> weiterarbeiten brauche ich das Datenraster als ein <span class="in">`data.table`</span> Objekt. Soweit ist alles gleich. Wir bauen uns die Interalktion jetzt anders.</span>
<span id="cb208-1677"><a href="#cb208-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1680"><a href="#cb208-1680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1681"><a href="#cb208-1681" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">f_b =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-1682"><a href="#cb208-1682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">as_factor</span>(f_a),</span>
<span id="cb208-1683"><a href="#cb208-1683" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">as_factor</span>(f_b))</span>
<span id="cb208-1684"><a href="#cb208-1684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1685"><a href="#cb208-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1686"><a href="#cb208-1686" aria-hidden="true" tabindex="-1"></a>Jetzt gehen wir aber noch einen Schritt weiter und bauen das Datenraster als Dummykodierung. Somit steht jetzt jede Spalte dafür, ob ein Effekt dann entsprechend für die Beobachtung berücksichtigt wird. Hier können wir dann auch die Interaktion in den jeweiligen Faktorkombinationen $A.2.B.2$ und $A.3.B.2$ richtig modellieren. Es ist aber immer noch nicht einfach, das kann ich unterschreiben.</span>
<span id="cb208-1687"><a href="#cb208-1687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1690"><a href="#cb208-1690" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1691"><a href="#cb208-1691" aria-hidden="true" tabindex="-1"></a>fac2_model_dt <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb208-1692"><a href="#cb208-1692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_matrix</span>(<span class="sc">~</span> f_a <span class="sc">*</span> f_b) <span class="sc">|&gt;</span> </span>
<span id="cb208-1693"><a href="#cb208-1693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb208-1694"><a href="#cb208-1694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span>
<span id="cb208-1695"><a href="#cb208-1695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1696"><a href="#cb208-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1697"><a href="#cb208-1697" aria-hidden="true" tabindex="-1"></a>Dann können wir uns auch schon einmal die Modellmatrix für den Datensatz anschauen, wo wir eben die Faktoren und die Interaktion enthalten haben. Wir haben sechstausend Beobachtungen jeweils eintausend Beobachtungen pro Faktorkombination der beiden Faktoren. In den Faktorkombinationen sind dann auch die Interaktionen enthalten.</span>
<span id="cb208-1698"><a href="#cb208-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1701"><a href="#cb208-1701" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1702"><a href="#cb208-1702" aria-hidden="true" tabindex="-1"></a>fac2_model_dt</span>
<span id="cb208-1703"><a href="#cb208-1703" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1704"><a href="#cb208-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1705"><a href="#cb208-1705" aria-hidden="true" tabindex="-1"></a>Jetzt müssen wir für jede Spalte den Effekt definieren. Daher haben wir dann sechs Effekte. Einmal einen für den Intercept und dann für die jeweiligen Faktorlevel. Hier müssen wir dann aber die Multiplikation mit selber einrechnen. Daher ist der Effekt des $f_A$ zwar $+2$, aber müssen wir dann schon bei $A.3$ eben $+2+2 = +4$ rechnen. Es ist wirklich etwas anstrengend. Dann kommen noch die beiden Terme für die Interaktion.</span>
<span id="cb208-1706"><a href="#cb208-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1709"><a href="#cb208-1709" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1710"><a href="#cb208-1710" aria-hidden="true" tabindex="-1"></a>y_pois_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y"</span>, </span>
<span id="cb208-1711"><a href="#cb208-1711" aria-hidden="true" tabindex="-1"></a>                         <span class="at">formula =</span> <span class="st">"5 * intercept + 2 * f_a2 + 4 * f_a3 + </span></span>
<span id="cb208-1712"><a href="#cb208-1712" aria-hidden="true" tabindex="-1"></a><span class="st">                         3 * f_b2 + 0 * f_a2_f_b2 + -6 * f_a3_f_b2"</span>,</span>
<span id="cb208-1713"><a href="#cb208-1713" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dist =</span> <span class="st">"poisson"</span>)</span>
<span id="cb208-1714"><a href="#cb208-1714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1715"><a href="#cb208-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1716"><a href="#cb208-1716" aria-hidden="true" tabindex="-1"></a>Jetzt bringen wir unser Datenraster mit unserer Datendefinition zusammen. Wir erhalten dann einen neuen Datensatz mit unserem poissonverteilten Messwert. Am Ende möchte ich dann noch die Spalte <span class="in">`f_a`</span> und <span class="in">`f_b`</span> auswählen sowie als Faktoren mutieren und die Level umbenennen. Dann sind wir auch schon fertig.</span>
<span id="cb208-1717"><a href="#cb208-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1720"><a href="#cb208-1720" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1721"><a href="#cb208-1721" aria-hidden="true" tabindex="-1"></a>fac2_pois_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(y_pois_def, fac2_model_dt) <span class="sc">|&gt;</span></span>
<span id="cb208-1722"><a href="#cb208-1722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb208-1723"><a href="#cb208-1723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(f_a, f_b, y)  <span class="sc">|&gt;</span></span>
<span id="cb208-1724"><a href="#cb208-1724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"A."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)),</span>
<span id="cb208-1725"><a href="#cb208-1725" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">factor</span>(f_b, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"B."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)))</span>
<span id="cb208-1726"><a href="#cb208-1726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1727"><a href="#cb208-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1728"><a href="#cb208-1728" aria-hidden="true" tabindex="-1"></a>Am Ende musst du dir das alles einmal in der Abbildung anschauen. Hier siehst du dann auch gut die Interaktion im letzten Level vom Faktor $f_A$. Wir haben dort in der Faktorkombination $A.3.A.2$ nicht einen Mittelwert von 12 sondern von 6 vorliegen. Hier dreht sich der immer positive Effekt des Faktors $f_B$ einmal ins Negative um. Die Erstellung ist ohne einen Visualisierung wirklich schwer nachzuvollziehen und zu überprüfen. Am Ende musst du dann immer schauen, ob du dann die Effekte bei einer großen Fallzahl wiederfindest und dur dann einen kleineren Datensatz für dich bauen. Die Implementierung einer Interaktion ist eben nicht ganz so einfach, wenn es um die Generierung von faktoriellen Experimenten geht.</span>
<span id="cb208-1729"><a href="#cb208-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1732"><a href="#cb208-1732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1733"><a href="#cb208-1733" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1734"><a href="#cb208-1734" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-1735"><a href="#cb208-1735" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-1736"><a href="#cb208-1736" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-1737"><a href="#cb208-1737" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-1738"><a href="#cb208-1738" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb208-1739"><a href="#cb208-1739" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Boxplot der zweifaktoriellen Poissondaten mit einem Intercept $\\beta_0$ von 0 sowie den Effekten von $+2$ pro Faktorlevel von Faktor $f_A$ sowie von $+3$ pro Faktorlevel von Faktor $f_B$. Da eine interaktion vorliegt, sind sind die Level $B.2$ um den festen Wert des Effekts verschoben. Es liegt eine Interaktion im Level $A.3$ vor. Der Effekt in $f_B$ ist gedreht. Die Gruppenmittelwerte sind mit dargestellt. Insgesamt wurden $n = 1000$ Beobachtungen pro Gruppe generiert. Mit stiegendem Mittelwert steigt auch die Varianz in der Possionverteilung. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-1740"><a href="#cb208-1740" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-fac2-inter-pois</span></span>
<span id="cb208-1741"><a href="#cb208-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1742"><a href="#cb208-1742" aria-hidden="true" tabindex="-1"></a>fac2_pois_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-1743"><a href="#cb208-1743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> f_a, <span class="at">y =</span> y, <span class="at">fill =</span> f_b)) <span class="sc">+</span></span>
<span id="cb208-1744"><a href="#cb208-1744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-1745"><a href="#cb208-1745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">5</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-1746"><a href="#cb208-1746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb208-1747"><a href="#cb208-1747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb208-1748"><a href="#cb208-1748" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y.., <span class="dv">0</span>)), </span>
<span id="cb208-1749"><a href="#cb208-1749" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>)),</span>
<span id="cb208-1750"><a href="#cb208-1750" aria-hidden="true" tabindex="-1"></a>               <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb208-1751"><a href="#cb208-1751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fl">3.2</span>, <span class="at">y =</span> <span class="dv">12</span>, <span class="at">label =</span> <span class="st">"12"</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb208-1752"><a href="#cb208-1752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">3.3</span>, <span class="at">y =</span> <span class="dv">12</span>, <span class="at">xend =</span> <span class="fl">3.3</span>, <span class="at">yend =</span> <span class="dv">6</span>),</span>
<span id="cb208-1753"><a href="#cb208-1753" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.01</span>, <span class="st">"npc"</span>), <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb208-1754"><a href="#cb208-1754" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.4</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb208-1755"><a href="#cb208-1755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb208-1756"><a href="#cb208-1756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb208-1757"><a href="#cb208-1757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Faktor A"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>, <span class="at">fill =</span> <span class="st">"Faktor B"</span>)</span>
<span id="cb208-1758"><a href="#cb208-1758" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1759"><a href="#cb208-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1760"><a href="#cb208-1760" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb208-1761"><a href="#cb208-1761" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/personal_opinion.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb208-1762"><a href="#cb208-1762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1763"><a href="#cb208-1763" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Brauchen wir eine Generierung von zweifaktoriellen Experimenten aus einer Poissonverteilung mit Interaktion wirklich? Diese Frage kann man sich auch hier stellen. Ich selber baue mir gerne die Interaktion dann händisch in Excel oder aber Runde mir eine Normalverteilung. Das reicht im Kontext der Lehre und zum Testen vollkommen aus. Ich hatte aber Spaß zu verstehen, wie die Interaktion entsteht und wie ich die Interaktion nachbauen kann. Dafür hat es sich gelohnt." --- Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.*</span></span>
<span id="cb208-1764"><a href="#cb208-1764" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb208-1765"><a href="#cb208-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1766"><a href="#cb208-1766" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb208-1767"><a href="#cb208-1767" aria-hidden="true" tabindex="-1"></a><span class="fu">## Datenraster in `{simstudy}` für Faktoren</span></span>
<span id="cb208-1768"><a href="#cb208-1768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1769"><a href="#cb208-1769" aria-hidden="true" tabindex="-1"></a>Nachdem ich hier schon sehr weit war mit der Funktion <span class="in">`expand_grid()`</span> habe ich Abends dann noch per Zufall den Blogeintrag <span class="co">[</span><span class="ot">Testing multiple interventions in a single experiment</span><span class="co">](https://www.rdatagen.net/post/testing-many-interventions-in-a-single-experiment/)</span> gelesen. Wir können also auch ein faktorielles Design auch in <span class="in">`{simstudy}`</span> bauen. Hätte mich dann auch etwas gewundert wenn es dann doch nicht ginge. Es ist immer eine Frage des Nestings oder der Schachtelung, also wie wollen wir die beiden Faktoren jeweils ineinander verschränkt wissen. Wir können die Funktion <span class="in">`genMultiFac()`</span> nutzen um uns mehrere Faktoren zu erschaffen. Wir können dabei auch gleich die Spaltennamen setzen und sagen, wie oft eine Faktorkombination wiederholt werden soll.</span>
<span id="cb208-1770"><a href="#cb208-1770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1773"><a href="#cb208-1773" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1774"><a href="#cb208-1774" aria-hidden="true" tabindex="-1"></a>fac2_dt <span class="ot">&lt;-</span> <span class="fu">genMultiFac</span>(<span class="at">each =</span> <span class="dv">5</span>, <span class="at">nFactors =</span> <span class="dv">2</span>, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>), </span>
<span id="cb208-1775"><a href="#cb208-1775" aria-hidden="true" tabindex="-1"></a>                       <span class="at">colNames =</span> <span class="fu">c</span>(<span class="st">"f_a"</span>, <span class="st">"f_b"</span>)) </span>
<span id="cb208-1776"><a href="#cb208-1776" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1777"><a href="#cb208-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1778"><a href="#cb208-1778" aria-hidden="true" tabindex="-1"></a>Dann einmal die Daten anschauen. Ich zeige die hier als <span class="in">`tibble`</span> damit nicht so viel ausgegeben wird. In der Standardimplementierung des <span class="in">`data.table`</span> kriegen wir immer einen sehr langen Ausdruck.</span>
<span id="cb208-1779"><a href="#cb208-1779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1782"><a href="#cb208-1782" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1783"><a href="#cb208-1783" aria-hidden="true" tabindex="-1"></a>fac2_dt <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb208-1784"><a href="#cb208-1784" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1785"><a href="#cb208-1785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1786"><a href="#cb208-1786" aria-hidden="true" tabindex="-1"></a>Jetzt brauchen wir noch die Definition für unseren poissonverteilten Messwert in <span class="in">`{simstudy}`</span>. Das ist das Gleiche wie schon bevor. Hier muss ich definieren, wie die Effekte der beiden Faktoren sind. Auch hier gilt, das Ganze ist dann ohne Interaktion gebaut. Theoretisch könnest du noch einen globalen Interaktionseffekt mit <span class="in">`3 * f_a * _f_b`</span> hinzufügen, aber dann wäre der Effekt der Interaktion multiplikativ eben $+3$ über die Level der Faktoren.</span>
<span id="cb208-1787"><a href="#cb208-1787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1790"><a href="#cb208-1790" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1791"><a href="#cb208-1791" aria-hidden="true" tabindex="-1"></a>y_pois_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y"</span>, </span>
<span id="cb208-1792"><a href="#cb208-1792" aria-hidden="true" tabindex="-1"></a>                         <span class="at">formula =</span> <span class="st">"-2 + 2*f_a + 6*f_b"</span>,</span>
<span id="cb208-1793"><a href="#cb208-1793" aria-hidden="true" tabindex="-1"></a>                         <span class="at">dist =</span> <span class="st">"poisson"</span>)</span>
<span id="cb208-1794"><a href="#cb208-1794" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1795"><a href="#cb208-1795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1796"><a href="#cb208-1796" aria-hidden="true" tabindex="-1"></a>Jetzt bringen wir unser Datenraster mit unserer Datendefinition zusammen. Wir erhalten dann einen neuen Datensatz mit unserem poissonverteilten Messwert. Am Ende möchte ich dann noch die Spalte <span class="in">`f_a`</span> und <span class="in">`f_b`</span> als Faktoren mutieren und die Level umbenennen. Dann sind wir auch schon fertig.</span>
<span id="cb208-1797"><a href="#cb208-1797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1800"><a href="#cb208-1800" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1801"><a href="#cb208-1801" aria-hidden="true" tabindex="-1"></a><span class="fu">addColumns</span>(y_pois_def, fac2_dt) <span class="sc">|&gt;</span></span>
<span id="cb208-1802"><a href="#cb208-1802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"A."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)),</span>
<span id="cb208-1803"><a href="#cb208-1803" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_b =</span> <span class="fu">factor</span>(f_b, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"B."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb208-1804"><a href="#cb208-1804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb208-1805"><a href="#cb208-1805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1806"><a href="#cb208-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1807"><a href="#cb208-1807" aria-hidden="true" tabindex="-1"></a>Wir haben auch noch die Möglichkeit die Faktoren mit der Funktion <span class="in">`genFactor()`</span> zu modifizieren, aber dann können wir wieder nicht mit den Leveln rechnen. Dann lohnt sich die Sache eigentlich nicht. Für mich hat die <span class="in">`expand_grid()`</span> Variante mehr Charme. Die Variante ist einfach und schnell.</span>
<span id="cb208-1808"><a href="#cb208-1808" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-1809"><a href="#cb208-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1810"><a href="#cb208-1810" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zero-inflated Poisson {.unnumbered .unlisted}</span></span>
<span id="cb208-1811"><a href="#cb208-1811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1812"><a href="#cb208-1812" aria-hidden="true" tabindex="-1"></a>Wenn wir mit der Poissonverteilung arbeiten, dann haben wir manchmal den Fall vorliegen, dass wir eine zero-inflated Poissonverteilung (deu. *Null-inflationiert*, nicht gebräuchlich) vorliegen haben. Wir haben also noch mehr Nullen in dem Messwert als wir in einer normalen Poissonverteilung erwarten würden. Wir können eine solche Poissonverteilung dann ebenfalls mit <span class="in">`{simstudy}`</span> bauen. Wir nutzen dazu das Tutorium <span class="co">[</span><span class="ot">Adding a "mixture" distribution to the `{simstudy}` package</span><span class="co">](https://www.rdatagen.net/post/adding-mixture-distributions-to-simstudy/)</span>, welches und gut hilft einmal aus zwei Verteilungen eine Verteilung mit sehr vielen Nullen zu bauen.</span>
<span id="cb208-1813"><a href="#cb208-1813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1814"><a href="#cb208-1814" aria-hidden="true" tabindex="-1"></a>Was heißt jetzt zwei Verteilungen? Wir bauen uns erstmal eine Poissonverteilung, die faktisch nur aus Nullen besteht. Die Poissonverteilung hat den Mittelwert von $\lambda$ gleich $0$. Wir nennen diese Verteilung dann <span class="in">`y_0`</span>. Dann bauen wir uns noch eine klassische Poissonverteilung mit einem $\lambda$ von $2$ zusammen. Das können wir erstmal machen. Weiter unten zeige ich dir dann auch noch wie du dir einen Effekt mit einem einfaktoriellen Design als Beispiel baust.</span>
<span id="cb208-1815"><a href="#cb208-1815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1818"><a href="#cb208-1818" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1819"><a href="#cb208-1819" aria-hidden="true" tabindex="-1"></a>zeroinf_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y_0"</span>, <span class="at">formula =</span> <span class="dv">0</span>, <span class="at">dist =</span> <span class="st">"nonrandom"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-1820"><a href="#cb208-1820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">formula =</span> <span class="dv">2</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>)</span>
<span id="cb208-1821"><a href="#cb208-1821" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1822"><a href="#cb208-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1823"><a href="#cb208-1823" aria-hidden="true" tabindex="-1"></a>Jetzt kommt der Teil wo wir die beiden Verteilungen miteinander mischen. Wir nehmen $20%$ der Werte der <span class="in">`y_0`</span> Verteilung und wir nehmen $80%$ der Werte der <span class="in">`y`</span> Verteilung. Das machen wir etwas umständlich über den Strich <span class="in">`|`</span>. Wir sagen hier welche Anteile der beiden Verteilungen wir dann wollen. Am Ende benennen wir noch den Messwert neu.</span>
<span id="cb208-1824"><a href="#cb208-1824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1827"><a href="#cb208-1827" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1828"><a href="#cb208-1828" aria-hidden="true" tabindex="-1"></a>zeroinf_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(zeroinf_def, <span class="at">varname =</span> <span class="st">"y_zeroinf"</span>, <span class="at">formula =</span> <span class="st">"y_0 | .2 + y | .8"</span>, </span>
<span id="cb208-1829"><a href="#cb208-1829" aria-hidden="true" tabindex="-1"></a>                       <span class="at">dist =</span> <span class="st">"mixture"</span>)</span>
<span id="cb208-1830"><a href="#cb208-1830" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1831"><a href="#cb208-1831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1832"><a href="#cb208-1832" aria-hidden="true" tabindex="-1"></a>Dann können wir schon eintausend Beobachtungen erstellen.</span>
<span id="cb208-1833"><a href="#cb208-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1836"><a href="#cb208-1836" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1837"><a href="#cb208-1837" aria-hidden="true" tabindex="-1"></a>zeroinf_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">1000</span>, zeroinf_def)</span>
<span id="cb208-1838"><a href="#cb208-1838" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1839"><a href="#cb208-1839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1840"><a href="#cb208-1840" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbidlung siesht du dann einmal die Histogramme der normalen Poissonverteilung sowie der zero-inflated Poissonverteilung. Wir haben hier als Unterschied eben den klaren Exzess an Nullen in der inflationierten Poissonverteilung. Das sieht man nicht unbedingt so gut, aber wir haben eben doch einiges mehr an Nullen als es nach der klassischen Verteilung sein sollte.</span>
<span id="cb208-1841"><a href="#cb208-1841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1844"><a href="#cb208-1844" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1845"><a href="#cb208-1845" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1846"><a href="#cb208-1846" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-1847"><a href="#cb208-1847" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-1848"><a href="#cb208-1848" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-1849"><a href="#cb208-1849" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-1850"><a href="#cb208-1850" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb208-1851"><a href="#cb208-1851" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Histogramme von Zähldaten, die einer Poissonverteilung folgen. **(A)** Klassische Poissonverteilung. **(B)** Zero-inflated Poissonverteilung mit mehr Nullen. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-1852"><a href="#cb208-1852" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-poisson-zeroinf</span></span>
<span id="cb208-1853"><a href="#cb208-1853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1854"><a href="#cb208-1854" aria-hidden="true" tabindex="-1"></a>p1_zeroinf <span class="ot">&lt;-</span> zeroinf_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-1855"><a href="#cb208-1855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> y)) <span class="sc">+</span></span>
<span id="cb208-1856"><a href="#cb208-1856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-1857"><a href="#cb208-1857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"#F5C710"</span>) <span class="sc">+</span></span>
<span id="cb208-1858"><a href="#cb208-1858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Messwert (Y)"</span>, <span class="at">y =</span> <span class="st">"Anzahl"</span>,</span>
<span id="cb208-1859"><a href="#cb208-1859" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Poissonverteilung"</span>) <span class="sc">+</span></span>
<span id="cb208-1860"><a href="#cb208-1860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb208-1861"><a href="#cb208-1861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">310</span>)</span>
<span id="cb208-1862"><a href="#cb208-1862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1863"><a href="#cb208-1863" aria-hidden="true" tabindex="-1"></a>p2_zeroinf <span class="ot">&lt;-</span> </span>
<span id="cb208-1864"><a href="#cb208-1864" aria-hidden="true" tabindex="-1"></a>  zeroinf_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-1865"><a href="#cb208-1865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> y_zeroinf)) <span class="sc">+</span></span>
<span id="cb208-1866"><a href="#cb208-1866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-1867"><a href="#cb208-1867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"#56B4E9"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb208-1868"><a href="#cb208-1868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Messwert (Y)"</span>, <span class="at">y =</span> <span class="st">"Anzahl"</span>,</span>
<span id="cb208-1869"><a href="#cb208-1869" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Zero-inflated Poissonverteilung"</span>) <span class="sc">+</span>  </span>
<span id="cb208-1870"><a href="#cb208-1870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">300</span>, <span class="at">label =</span> <span class="st">"Zero-inflated"</span>, </span>
<span id="cb208-1871"><a href="#cb208-1871" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">"gray75"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb208-1872"><a href="#cb208-1872" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb208-1873"><a href="#cb208-1873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.4</span>, <span class="at">y =</span> <span class="dv">300</span>, <span class="at">xend =</span> <span class="fl">0.2</span>, <span class="at">yend =</span> <span class="dv">275</span>),</span>
<span id="cb208-1874"><a href="#cb208-1874" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.01</span>, <span class="st">"npc"</span>), <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb208-1875"><a href="#cb208-1875" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb208-1876"><a href="#cb208-1876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb208-1877"><a href="#cb208-1877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">310</span>)</span>
<span id="cb208-1878"><a href="#cb208-1878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1879"><a href="#cb208-1879" aria-hidden="true" tabindex="-1"></a>p1_zeroinf <span class="sc">+</span> p2_zeroinf <span class="sc">+</span></span>
<span id="cb208-1880"><a href="#cb208-1880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb208-1881"><a href="#cb208-1881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb208-1882"><a href="#cb208-1882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb208-1883"><a href="#cb208-1883" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1884"><a href="#cb208-1884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1885"><a href="#cb208-1885" aria-hidden="true" tabindex="-1"></a>Wenn wir das ganze jetzt mit einem Behandlungsfaktor generieren wollen, dann müssen wir uns erstmal das Datenraster bauen. Wir nutzen dann das Raster um uns die Daten zu generieren und zu wissen wie viele Level mit Wiederholungen wir vorliegen haben.</span>
<span id="cb208-1886"><a href="#cb208-1886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1889"><a href="#cb208-1889" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1890"><a href="#cb208-1890" aria-hidden="true" tabindex="-1"></a>fac1_dt <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb208-1891"><a href="#cb208-1891" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-1892"><a href="#cb208-1892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span>
<span id="cb208-1893"><a href="#cb208-1893" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1894"><a href="#cb208-1894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1895"><a href="#cb208-1895" aria-hidden="true" tabindex="-1"></a>Zu unser Poissonverteilung mit den Mittelwert von Null kommt dann noch die klassische Poissonverteiung mit dem Effekt des Faktors. Hier hat jedes Faktorlevel einen Effekt von $+4$ und wir nehmen einen Intercept von Null an. Dann mische ich noch die Verteilungen im Verhältnis von 1:3, daher 25% kommen aus der Poissonverteilung <span class="in">`y_0`</span> und 75% aus der Poissonverteilung mit Effekt. Damit haben wir dann die Datendefinition zusammen.</span>
<span id="cb208-1896"><a href="#cb208-1896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1899"><a href="#cb208-1899" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1900"><a href="#cb208-1900" aria-hidden="true" tabindex="-1"></a>zeroinf_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y_0"</span>, <span class="at">formula =</span> <span class="dv">0</span>, <span class="at">dist =</span> <span class="st">"nonrandom"</span>)</span>
<span id="cb208-1901"><a href="#cb208-1901" aria-hidden="true" tabindex="-1"></a>zeroinf_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(zeroinf_def, <span class="at">varname =</span> <span class="st">"y"</span>, </span>
<span id="cb208-1902"><a href="#cb208-1902" aria-hidden="true" tabindex="-1"></a>                          <span class="at">formula =</span> <span class="st">"0 + 4*f_a"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>)</span>
<span id="cb208-1903"><a href="#cb208-1903" aria-hidden="true" tabindex="-1"></a>zeroinf_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(zeroinf_def, <span class="at">varname =</span> <span class="st">"y_zeroinf"</span>, </span>
<span id="cb208-1904"><a href="#cb208-1904" aria-hidden="true" tabindex="-1"></a>                          <span class="at">formula =</span> <span class="st">"y_0 | .25 + y | .75"</span>, <span class="at">dist =</span> <span class="st">"mixture"</span>)</span>
<span id="cb208-1905"><a href="#cb208-1905" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1906"><a href="#cb208-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1907"><a href="#cb208-1907" aria-hidden="true" tabindex="-1"></a>Jetzt bringen wir unser Datenraster mit unserer Datendefinition zusammen. Wir erhalten dann einen neuen Datensatz mit unserem poissonverteilten Messwert. Das ist etwas anders als eben, aber hier müssen wir ja auch zwei Dinge zusammenbringen. Eben haben wir nur die Daten aus einer Datendefinition generiert. Am Ende möchte ich dann noch die Spalte <span class="in">`f_a`</span> als Faktor mutieren und die Level umbenennen. Dann sind wir auch schon fertig.</span>
<span id="cb208-1908"><a href="#cb208-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1911"><a href="#cb208-1911" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1912"><a href="#cb208-1912" aria-hidden="true" tabindex="-1"></a>fac1_zeroinf_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(zeroinf_def, fac1_dt) <span class="sc">|&gt;</span></span>
<span id="cb208-1913"><a href="#cb208-1913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">str_c</span>(<span class="st">"A."</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>))) </span>
<span id="cb208-1914"><a href="#cb208-1914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1915"><a href="#cb208-1915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1916"><a href="#cb208-1916" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns einmal die beiden Verteilungen im Vergleich in der folgenden Abbildung einmal an. Ich habe hier einmal den Violinplot gewählt, da kannst du dann besser den Fuß in der zero-inflated Poissonverteilung erkennen. Wir sehen dann aber auch, dass der Mittelwert nach unten gezogen wird. Auch der Median, als grau dargestellt, wird nach unten gezogen und entspricht dann nicht den vorgegeben Werten. Durch die Zeroinflation haben wir dann einen nicht mehr ganz sauberen Bezug zwischen den voreingestellten und den sich ergebenden Effekten.</span>
<span id="cb208-1917"><a href="#cb208-1917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1920"><a href="#cb208-1920" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1921"><a href="#cb208-1921" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1922"><a href="#cb208-1922" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-1923"><a href="#cb208-1923" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-1924"><a href="#cb208-1924" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-1925"><a href="#cb208-1925" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-1926"><a href="#cb208-1926" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb208-1927"><a href="#cb208-1927" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Violinplot von einfaktoriellen Experimenten von Zähldaten, die einer Poissonverteilung folgen. Weiß sind die Mittelwerte und grau die Mediane dargestellt. **(A)** Klassische Poissonverteilung. **(B)** Zero-inflated Poissonverteilung mit mehr Nullen zu erkennen an den Füßen der Violinplots. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-1928"><a href="#cb208-1928" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-fac1-pois-zeroinflated</span></span>
<span id="cb208-1929"><a href="#cb208-1929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1930"><a href="#cb208-1930" aria-hidden="true" tabindex="-1"></a>p1_zeroinf_fac1 <span class="ot">&lt;-</span> fac1_zeroinf_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-1931"><a href="#cb208-1931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> f_a, <span class="at">y =</span> y, <span class="at">fill =</span> f_a)) <span class="sc">+</span></span>
<span id="cb208-1932"><a href="#cb208-1932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-1933"><a href="#cb208-1933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">width =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb208-1934"><a href="#cb208-1934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, </span>
<span id="cb208-1935"><a href="#cb208-1935" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y.., <span class="dv">0</span>)), </span>
<span id="cb208-1936"><a href="#cb208-1936" aria-hidden="true" tabindex="-1"></a>               <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb208-1937"><a href="#cb208-1937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-1938"><a href="#cb208-1938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb208-1939"><a href="#cb208-1939" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb208-1940"><a href="#cb208-1940" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Faktor A"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>,</span>
<span id="cb208-1941"><a href="#cb208-1941" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Poissonverteilung"</span>)</span>
<span id="cb208-1942"><a href="#cb208-1942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1943"><a href="#cb208-1943" aria-hidden="true" tabindex="-1"></a>p2_zeroinf_fac1 <span class="ot">&lt;-</span> fac1_zeroinf_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-1944"><a href="#cb208-1944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> f_a, <span class="at">y =</span> y_zeroinf, <span class="at">fill =</span> f_a)) <span class="sc">+</span></span>
<span id="cb208-1945"><a href="#cb208-1945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-1946"><a href="#cb208-1946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb208-1947"><a href="#cb208-1947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, </span>
<span id="cb208-1948"><a href="#cb208-1948" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y.., <span class="dv">0</span>)), </span>
<span id="cb208-1949"><a href="#cb208-1949" aria-hidden="true" tabindex="-1"></a>               <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb208-1950"><a href="#cb208-1950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"median"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, </span>
<span id="cb208-1951"><a href="#cb208-1951" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y.., <span class="dv">0</span>)), </span>
<span id="cb208-1952"><a href="#cb208-1952" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fl">0.2</span>), </span>
<span id="cb208-1953"><a href="#cb208-1953" aria-hidden="true" tabindex="-1"></a>               <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">"gray70"</span>) <span class="sc">+</span></span>
<span id="cb208-1954"><a href="#cb208-1954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-1955"><a href="#cb208-1955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb208-1956"><a href="#cb208-1956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb208-1957"><a href="#cb208-1957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Faktor A"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>,</span>
<span id="cb208-1958"><a href="#cb208-1958" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Zero-inflated Poissonverteilung"</span>)</span>
<span id="cb208-1959"><a href="#cb208-1959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1960"><a href="#cb208-1960" aria-hidden="true" tabindex="-1"></a>p1_zeroinf_fac1 <span class="sc">+</span> p2_zeroinf_fac1 <span class="sc">+</span></span>
<span id="cb208-1961"><a href="#cb208-1961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb208-1962"><a href="#cb208-1962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb208-1963"><a href="#cb208-1963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb208-1964"><a href="#cb208-1964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1965"><a href="#cb208-1965" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1966"><a href="#cb208-1966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1967"><a href="#cb208-1967" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kovariates Design {.unnumbered .unlisted}</span></span>
<span id="cb208-1968"><a href="#cb208-1968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1969"><a href="#cb208-1969" aria-hidden="true" tabindex="-1"></a>Im Folgenden nutze ich das einkovariate und zweikovariate Design nochmal um etwas mit dem R Paket <span class="in">`{simstudy}`</span> zu üben und die Funktionen zu zeigen. Am Ende nutzen wir eher selten ein kovariates Design in den Agrarwissenschaften, wenn es um ein poissonverteilten Messwert geht, aber zur Vollständigkeit gehört auch dieser Abschnitt mit dazu. Wir können hier verschiedene Modelle rechnen, ich nutze hier gleich die Gaussian Regression um auf meine Effekte zu kommen. Dann habe ich auch gleich die voreingestellten Mittelwerte wiedergegeben. Ein poissonverteilten Messwert analysieren wir ja eigentlich mit einer Poissonregression, aber dort erhalten wir dann als Effekte eben nicht die Steigung so direkt wieder sondern eben dann das Risk Ratio. Mehr dazu dann wie immer im entsprechenden <span class="co">[</span><span class="ot">Kapitel zu der Poissonregression</span><span class="co">](#sec-poisson)</span>, wenn dich mehr zum Thema interessiert.</span>
<span id="cb208-1970"><a href="#cb208-1970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1971"><a href="#cb208-1971" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einkovariat $c_1$ {.unnumbered .unlisted}</span></span>
<span id="cb208-1972"><a href="#cb208-1972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1973"><a href="#cb208-1973" aria-hidden="true" tabindex="-1"></a>Das Ziel der einkovariaten Datengenierung ist einfach. Wir haben eine normalverteilte Kovariate vorliegen und wollen einen Effekt für die Kovariate im poissonverteilten Messwert generieren. Bei einer Kovariate ist dann der Effekt auch gleichbedeutend mit der Steigung einer Graden durch die Punktewolke im Scatterplot. Ich nutze hier jetzt einmal sehr viel mehr Beobachtungen um dann auch auf die voreingestellten Effekte im Modell rauszukommen. Als erstes baue ich mir eine normalverteilte Kovariate mit einem Mittelwert von $7$ und einer Streuung von $3$ zusammen. Dann kann ich mir meinen Messwert in der folgenden Definition zusammenbauen. Hier habe ich dann einen Intercept von $10$ und einen Effekt von $2$ als Steigung vorliegen.</span>
<span id="cb208-1974"><a href="#cb208-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1977"><a href="#cb208-1977" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1978"><a href="#cb208-1978" aria-hidden="true" tabindex="-1"></a>cov1_pois_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"c_1"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, <span class="at">formula =</span> <span class="st">"6"</span>,</span>
<span id="cb208-1979"><a href="#cb208-1979" aria-hidden="true" tabindex="-1"></a>                         <span class="at">variance =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-1980"><a href="#cb208-1980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>, <span class="at">formula =</span> <span class="st">"10 + 2 * c_1"</span>)</span>
<span id="cb208-1981"><a href="#cb208-1981" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1982"><a href="#cb208-1982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1983"><a href="#cb208-1983" aria-hidden="true" tabindex="-1"></a>Dann kann ich mir auch schon die eintausend Beobachtungen einmal generieren. Da ich hier keinn Faktoren vorliegen habe, brauche ich auch kein Datenraster für die Erstellung der Daten. Wir modellieren hier nicht in der gleichen Weise mit Effektschätzern unsere Daten wie wir dann in einer Poissonregression zurückkriegen würden. Das ist aber ein Preis, den wir aus Gründen der Einfachheit bezahlen wollen.</span>
<span id="cb208-1984"><a href="#cb208-1984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1987"><a href="#cb208-1987" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1988"><a href="#cb208-1988" aria-hidden="true" tabindex="-1"></a>cov1_pois_tbl <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">1000</span>, cov1_pois_def)</span>
<span id="cb208-1989"><a href="#cb208-1989" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-1990"><a href="#cb208-1990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1991"><a href="#cb208-1991" aria-hidden="true" tabindex="-1"></a>Dann können wir uns auch schon das Ergebnis der Datengenerierung in der folgenden Abbildung einmal anschauen. Hier wird dann auch sehr schön deutlich, dass wir durch den poissonverteilten Messwert Banden in dem Scatterplot sehen. Wir haben ja hier nur ganzzahlige Werte für die Messwert vorliegen. Bei einer so hohen Fallzahl an Beobachtungen erhalten wir dann auch unseren voreingestellten Effekte wieder. Hier müssen wir dann ein wenig aufpassen, wie wir denn die Daten analysieren wollen. Eine Poissonregression mit einem Risikoverhältnis als Effekt ist nicht das Gleiche wie eine Gaussianregression.</span>
<span id="cb208-1992"><a href="#cb208-1992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-1995"><a href="#cb208-1995" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-1996"><a href="#cb208-1996" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-1997"><a href="#cb208-1997" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-1998"><a href="#cb208-1998" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb208-1999"><a href="#cb208-1999" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-2000"><a href="#cb208-2000" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-2001"><a href="#cb208-2001" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb208-2002"><a href="#cb208-2002" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb208-2003"><a href="#cb208-2003" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung einer linearen Simulation mit einer normalverteilten Kovariaten sowie einem poissonverteilten Messwert. Einmal ist die Regressiongleichung für den linearen Gaussian Zusammenhang sowie für die Poissonregression dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-2004"><a href="#cb208-2004" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-c1-pois</span></span>
<span id="cb208-2005"><a href="#cb208-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2006"><a href="#cb208-2006" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> c_1, <span class="at">data =</span> cov1_pois_tbl, <span class="at">family =</span> poisson) </span>
<span id="cb208-2007"><a href="#cb208-2007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2008"><a href="#cb208-2008" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cov1_pois_tbl, <span class="fu">aes</span>(c_1, y)) <span class="sc">+</span></span>
<span id="cb208-2009"><a href="#cb208-2009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-2010"><a href="#cb208-2010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-2011"><a href="#cb208-2011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-2012"><a href="#cb208-2012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb208-2013"><a href="#cb208-2013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, </span>
<span id="cb208-2014"><a href="#cb208-2014" aria-hidden="true" tabindex="-1"></a>                 <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-2015"><a href="#cb208-2015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="st">"eq"</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-2016"><a href="#cb208-2016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(fit, <span class="at">type =</span> <span class="st">"response"</span>)),</span>
<span id="cb208-2017"><a href="#cb208-2017" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb208-2018"><a href="#cb208-2018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">25</span>, <span class="at">label =</span> <span class="st">"Poisson"</span>, <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb208-2019"><a href="#cb208-2019" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb208-2020"><a href="#cb208-2020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.9</span>, <span class="at">y =</span> <span class="dv">25</span>, <span class="at">xend =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="dv">15</span>), </span>
<span id="cb208-2021"><a href="#cb208-2021" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.01</span>, <span class="st">"npc"</span>), <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb208-2022"><a href="#cb208-2022" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb208-2023"><a href="#cb208-2023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">hjust =</span> <span class="st">"right"</span>, <span class="at">x =</span> <span class="fl">9.5</span>, <span class="at">y =</span> <span class="dv">20</span>, <span class="at">label =</span> <span class="st">"Gaussian"</span>, <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb208-2024"><a href="#cb208-2024" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-2025"><a href="#cb208-2025" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">9.6</span>, <span class="at">y =</span> <span class="dv">20</span>, <span class="at">xend =</span> <span class="dv">11</span>, <span class="at">yend =</span> <span class="dv">31</span>), </span>
<span id="cb208-2026"><a href="#cb208-2026" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.01</span>, <span class="st">"npc"</span>), <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb208-2027"><a href="#cb208-2027" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-2028"><a href="#cb208-2028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Covariate 1"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>, <span class="at">color =</span> <span class="st">""</span>) </span>
<span id="cb208-2029"><a href="#cb208-2029" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2030"><a href="#cb208-2030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2031"><a href="#cb208-2031" aria-hidden="true" tabindex="-1"></a>Wir können dann auch nochmal ein GLM rechnen und sehen, dass wir bei einer so hohen Fallzahl dann auch in einem GLM die passenden Effekte ungefähr herausbekommen. Ich nutze hier die Funktion <span class="in">`parameters()`</span> aus dem gleichnamigen R Paket damit ich die Schätzer noch wieder zurücktransformieren kann. Auch hier findest du dann mehr in dem <span class="co">[</span><span class="ot">Kapitel zu der Poissonregression</span><span class="co">](#sec-poisson)</span>. Ich fitte hier erstmal die passende Poissonregression.</span>
<span id="cb208-2032"><a href="#cb208-2032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2035"><a href="#cb208-2035" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2036"><a href="#cb208-2036" aria-hidden="true" tabindex="-1"></a>pois_c1_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> c_1, <span class="at">data =</span> cov1_pois_tbl, <span class="at">family =</span> poisson)</span>
<span id="cb208-2037"><a href="#cb208-2037" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2038"><a href="#cb208-2038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2039"><a href="#cb208-2039" aria-hidden="true" tabindex="-1"></a>Danns schauen wir uns einmal die Koeffizienten der Poissonregression an. Wir sind hier hauptsächlich am Inzidenzratenverhältnis (eng *Incidence Rate Ratio*, abk. *IRR*) interessiert.</span>
<span id="cb208-2040"><a href="#cb208-2040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2043"><a href="#cb208-2043" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2044"><a href="#cb208-2044" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-2045"><a href="#cb208-2045" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-2046"><a href="#cb208-2046" aria-hidden="true" tabindex="-1"></a>pois_c1_fit <span class="sc">|&gt;</span></span>
<span id="cb208-2047"><a href="#cb208-2047" aria-hidden="true" tabindex="-1"></a>  parameters<span class="sc">::</span><span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb208-2048"><a href="#cb208-2048" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2049"><a href="#cb208-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2050"><a href="#cb208-2050" aria-hidden="true" tabindex="-1"></a>Was sehen wir hier als Effekte? Wir rechnen hier das Inzidenzratenverhältnis aus. Das Inzidenzratenverhältnis beschreibt die multiplikative Änderung der erwarteten Rate, wenn sich die Kovariate um eine Einheit ändert. Das heißt hier in unserem Fall, dass wenn wir die Kovariate $c_1$ um eine Einheit erhöhen, dass unser Messwert um den Faktor $1.09$ ansteigt. Leider siehst du auch, dass wir es hier nicht mit einer linearen Modellierung zu tun haben. Daher kann ich dir das Inzidenzratenverhältnis einmal zwischen zwei Punkten mit $c_1 = 6$ und $c_1 = 7$ berechnen. Das Problem ist hier wirklich, dass wir es mit einem Faktor zu tun haben. Mehr dazu nochmal weiter unten im Kasten zu den Effekten in der Poissonregression und die Vingette <span class="co">[</span><span class="ot">Targeted logistic model coefficients</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/logisticCoefs.html)</span> geht das Problem in <span class="in">`{simstudy}`</span> nochmal an.</span>
<span id="cb208-2051"><a href="#cb208-2051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2054"><a href="#cb208-2054" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2055"><a href="#cb208-2055" aria-hidden="true" tabindex="-1"></a>pois_c1_fit <span class="sc">|&gt;</span> </span>
<span id="cb208-2056"><a href="#cb208-2056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(<span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>)), <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb208-2057"><a href="#cb208-2057" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2058"><a href="#cb208-2058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2059"><a href="#cb208-2059" aria-hidden="true" tabindex="-1"></a>Jetzt können wir auch den Faktor zwischen den beiden Messwerten berechnen. Wie ändert sich also Multiplikativ der Messwert von $c_1 = 6$ zu $c_1 = 7$? Dafür teilen wir dann die beiden Messwerte durcheinander und erhalten dann faktisch unser Inzidenzratenverhältnis aus dem obigen Modell.</span>
<span id="cb208-2060"><a href="#cb208-2060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2063"><a href="#cb208-2063" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2064"><a href="#cb208-2064" aria-hidden="true" tabindex="-1"></a><span class="fl">23.86757</span> <span class="sc">/</span> <span class="fl">21.72900</span></span>
<span id="cb208-2065"><a href="#cb208-2065" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2066"><a href="#cb208-2066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2067"><a href="#cb208-2067" aria-hidden="true" tabindex="-1"></a>Jetzt können wir uns das Leben auch etwas einfacher machen und einmal die <span class="co">[</span><span class="ot">Marginal effect models</span><span class="co">](#sec-marginal)</span> mit dem R Paket <span class="in">`{marginaleffects}`</span> nutzen um uns den Faktor zwischen den beiden Kovariatenwerten berechnen zu lassen. Das ist manchmal etwas schneller und auch einfacher durchzuführen. Darüber hinaus können wir eben dann nicht nur zwei Werte eingeben, sondern haben auch noch andere Möglichkeiten.</span>
<span id="cb208-2068"><a href="#cb208-2068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2071"><a href="#cb208-2071" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2072"><a href="#cb208-2072" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(pois_c1_fit, <span class="at">comparison =</span> <span class="st">"ratio"</span>,</span>
<span id="cb208-2073"><a href="#cb208-2073" aria-hidden="true" tabindex="-1"></a>                <span class="at">variables =</span> <span class="fu">list</span>(<span class="st">"c_1"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>)))</span>
<span id="cb208-2074"><a href="#cb208-2074" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2075"><a href="#cb208-2075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2076"><a href="#cb208-2076" aria-hidden="true" tabindex="-1"></a>Mehr zu den Möglichkeiten dann auch in der Vingette <span class="co">[</span><span class="ot">Change in numeric predictors</span><span class="co">](https://marginaleffects.com/chapters/comparisons.html#change-in-numeric-predictors)</span> auf der Hilfeseite dem R Paket <span class="in">`{marginaleffects}`</span>. Bei denen heißt dann die numerische Einflussvaraiable dann *numeric predictor*. Je nachdem wo man dann weiterliest ändern sich dann leider auch immer wieder die Begrifflichkeiten.</span>
<span id="cb208-2077"><a href="#cb208-2077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2078"><a href="#cb208-2078" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb208-2079"><a href="#cb208-2079" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ein Wort zum Effekt in der Poissonregression</span></span>
<span id="cb208-2080"><a href="#cb208-2080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2081"><a href="#cb208-2081" aria-hidden="true" tabindex="-1"></a>In der Poissonregression kriegen wir als Effektschätzer das Risk Ratio wiedergegeben. Das ist also nicht ein absoluter Wert, wie die Steigung, sondern ein Faktor um den sich die Messwerte unterschieden. Wenn wir die Einheit der Kovariate von 0 auf 1 erhöhen, dann würden wir vom Messwert von 10 auf 12 springen. Das würde einen Faktor von $12/10 = 1.2$ ausmachen. Wenn wir jetzt aber unsere Kovariate von 1 auf 2 erhöhen, dann haben wir einen Messwert von 12 auf 14. Jetzt haben wir aber einen Faktor von $14/12 = 1.17$ vorliegen. Der Faktor sinkt mit dem Anstieg der Kovariate. Da der absolute Anstieg immer weniger Anteil am Messwert ausmacht. Ich zeige dir den Zusammenhang einmal in der folgenden Abbildung. Mit jedem Sprung wird der Faktor kleiner. Am Ende ist dann das Risk Ratio aus einer Poissonregression mehr oder minder das Mittel über alle Sprünge. Wirklich linear ist dann der Zusammenhang nur auf der Linkskala. Hier hilft dann die Lektüre von @dormann2013parametrische oder aber das <span class="co">[</span><span class="ot">Kapitel zu der Poissonregression</span><span class="co">](#sec-poisson)</span> weiter. Die Vingette <span class="co">[</span><span class="ot">Targeted logistic model coefficients</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/logisticCoefs.html)</span> geht das Problem in <span class="in">`{simstudy}`</span> nochmal an.</span>
<span id="cb208-2082"><a href="#cb208-2082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2085"><a href="#cb208-2085" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2086"><a href="#cb208-2086" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-2087"><a href="#cb208-2087" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-2088"><a href="#cb208-2088" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb208-2089"><a href="#cb208-2089" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-2090"><a href="#cb208-2090" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-2091"><a href="#cb208-2091" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb208-2092"><a href="#cb208-2092" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-2093"><a href="#cb208-2093" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung des abnehmenden Risk Ratio über den Anstieg der Kovariate. Mit dem Anstieg der Kovariate nimmt der absolute Anstieg von $+2$ immer weniger Anteil an dem Messwert. Der Faktor des Anstiegs wird von $\\times1.2$ zu $\\times1.07$ immer kleiner. Das Risk Ratio (abk. *RR*) aus einer Poissonregression ist mehr oder minder der mittlere Faktor. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-2094"><a href="#cb208-2094" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-c1-pois-eff</span></span>
<span id="cb208-2095"><a href="#cb208-2095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2096"><a href="#cb208-2096" aria-hidden="true" tabindex="-1"></a>pois_eff_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb208-2097"><a href="#cb208-2097" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x_start =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">+</span> <span class="fl">0.1</span>,</span>
<span id="cb208-2098"><a href="#cb208-2098" aria-hidden="true" tabindex="-1"></a>                       <span class="at">xend =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>),</span>
<span id="cb208-2099"><a href="#cb208-2099" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> <span class="dv">10</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x,</span>
<span id="cb208-2100"><a href="#cb208-2100" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y_start =</span> y <span class="sc">-</span> <span class="fl">0.5</span>,</span>
<span id="cb208-2101"><a href="#cb208-2101" aria-hidden="true" tabindex="-1"></a>                       <span class="at">yend =</span> <span class="dv">12</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x <span class="sc">-</span> <span class="fl">0.5</span>,</span>
<span id="cb208-2102"><a href="#cb208-2102" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ratio_raw =</span> <span class="fu">c</span>(<span class="cn">NA</span>, y[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">/</span> y[<span class="sc">-</span><span class="dv">11</span>]),</span>
<span id="cb208-2103"><a href="#cb208-2103" aria-hidden="true" tabindex="-1"></a>                       <span class="at">ratio =</span> <span class="fu">round</span>(ratio_raw, <span class="dv">2</span>))</span>
<span id="cb208-2104"><a href="#cb208-2104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2105"><a href="#cb208-2105" aria-hidden="true" tabindex="-1"></a>pois_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y<span class="sc">~</span>x, pois_eff_tbl, <span class="at">family =</span> poisson)</span>
<span id="cb208-2106"><a href="#cb208-2106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2107"><a href="#cb208-2107" aria-hidden="true" tabindex="-1"></a>glm_rr <span class="ot">&lt;-</span> pois_fit <span class="sc">|&gt;</span> </span>
<span id="cb208-2108"><a href="#cb208-2108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">exp</span>() <span class="sc">|&gt;</span> <span class="fu">pluck</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-2109"><a href="#cb208-2109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2110"><a href="#cb208-2110" aria-hidden="true" tabindex="-1"></a>mean_rr <span class="ot">&lt;-</span> <span class="fu">mean</span>(pois_eff_tbl<span class="sc">$</span>ratio_raw, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-2111"><a href="#cb208-2111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2112"><a href="#cb208-2112" aria-hidden="true" tabindex="-1"></a>arrow_tbl <span class="ot">&lt;-</span> pois_eff_tbl[<span class="sc">-</span><span class="dv">11</span>,]</span>
<span id="cb208-2113"><a href="#cb208-2113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2114"><a href="#cb208-2114" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pois_eff_tbl, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb208-2115"><a href="#cb208-2115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-2116"><a href="#cb208-2116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-2117"><a href="#cb208-2117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb208-2118"><a href="#cb208-2118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(pois_fit, <span class="at">type =</span> <span class="st">"response"</span>)), <span class="at">color =</span> <span class="st">"grey70"</span>,</span>
<span id="cb208-2119"><a href="#cb208-2119" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb208-2120"><a href="#cb208-2120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="at">data =</span> arrow_tbl, <span class="fu">aes</span>(<span class="at">x =</span> x_start, <span class="at">y =</span> y_start, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend), </span>
<span id="cb208-2121"><a href="#cb208-2121" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.01</span>, <span class="st">"npc"</span>), <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb208-2122"><a href="#cb208-2122" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="fl">0.9</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-2123"><a href="#cb208-2123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb208-2124"><a href="#cb208-2124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> ratio), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="sc">-</span><span class="dv">6</span>),</span>
<span id="cb208-2125"><a href="#cb208-2125" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">"#CC79A7"</span>, <span class="at">alpha=</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb208-2126"><a href="#cb208-2126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">22</span>, <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb208-2127"><a href="#cb208-2127" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(RR)[GLM]<span class="sc">~</span><span class="st">"="</span>)) <span class="sc">+</span></span>
<span id="cb208-2128"><a href="#cb208-2128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">x =</span> <span class="fl">3.7</span>, <span class="at">y =</span> <span class="dv">22</span>, <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb208-2129"><a href="#cb208-2129" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> glm_rr) <span class="sc">+</span></span>
<span id="cb208-2130"><a href="#cb208-2130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">10</span>, <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb208-2131"><a href="#cb208-2131" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(RR)<span class="sc">~</span><span class="st">"="</span>), <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-2132"><a href="#cb208-2132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">x =</span> <span class="fl">6.1</span>, <span class="at">y =</span> <span class="dv">10</span>, <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb208-2133"><a href="#cb208-2133" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> mean_rr, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb208-2134"><a href="#cb208-2134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Covariate 1"</span>, <span class="at">y =</span> <span class="st">"Messwert (Y)"</span>) <span class="sc">+</span></span>
<span id="cb208-2135"><a href="#cb208-2135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb208-2136"><a href="#cb208-2136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> pois_eff_tbl<span class="sc">$</span>y)</span>
<span id="cb208-2137"><a href="#cb208-2137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2138"><a href="#cb208-2138" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-2139"><a href="#cb208-2139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2140"><a href="#cb208-2140" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweikovariat unabhängig $c_1 + c_2$ {.unnumbered .unlisted}</span></span>
<span id="cb208-2141"><a href="#cb208-2141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2142"><a href="#cb208-2142" aria-hidden="true" tabindex="-1"></a>Wir können natürlich auch mehrere Kovariaten vorliegen haben. Ich zeige hier dann einmal zwei Kovariaten, die einmal einer Normalverteilung und einmal einer Poissonverteilung entstammen. Wir müssen ja nicht nur normalverteilte Kovariaten vorliegen haben. Dann baue ich mir noch meinen poissonverteilten Messwert zusammen.</span>
<span id="cb208-2143"><a href="#cb208-2143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2146"><a href="#cb208-2146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2147"><a href="#cb208-2147" aria-hidden="true" tabindex="-1"></a>cov2_pois_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"c_1"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, <span class="at">formula =</span> <span class="st">"10"</span>,</span>
<span id="cb208-2148"><a href="#cb208-2148" aria-hidden="true" tabindex="-1"></a>                         <span class="at">variance =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2149"><a href="#cb208-2149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"c_2"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>, <span class="at">formula =</span> <span class="st">"5"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2150"><a href="#cb208-2150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">dist =</span> <span class="st">"poisson"</span>, <span class="at">formula =</span> <span class="st">"8 + 2 * c_1 + 1 * c_2"</span>)</span>
<span id="cb208-2151"><a href="#cb208-2151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2152"><a href="#cb208-2152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2153"><a href="#cb208-2153" aria-hidden="true" tabindex="-1"></a>Dann generiere ich mir auch schon meine zehntausend Beobachtungen. Ich werde das Ergebnis der Generierung nicht visualiseren, daher können wir hier auch einmal mit mehr Beobachtungen arbeiten und haben dann auch etwas genauere Schätzer der Effekte in den Modellen.</span>
<span id="cb208-2154"><a href="#cb208-2154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2157"><a href="#cb208-2157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2158"><a href="#cb208-2158" aria-hidden="true" tabindex="-1"></a>cov2_pois_tbl <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">10000</span>, cov2_pois_def)</span>
<span id="cb208-2159"><a href="#cb208-2159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2160"><a href="#cb208-2160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2161"><a href="#cb208-2161" aria-hidden="true" tabindex="-1"></a>Hier einmal das lineare Modell, dort sehen wir dann ob wir auch unsere eingestellten Effekte direkt wiedererhalten. Das ist natürlich jetzt nur so semi hilfreich, da wir ja auch schauen müssen wie denn die Werte in einem GLM aussehen würden.</span>
<span id="cb208-2162"><a href="#cb208-2162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2165"><a href="#cb208-2165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2166"><a href="#cb208-2166" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> c_2, <span class="at">data =</span> cov2_pois_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb208-2167"><a href="#cb208-2167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-2168"><a href="#cb208-2168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2169"><a href="#cb208-2169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2170"><a href="#cb208-2170" aria-hidden="true" tabindex="-1"></a>Dafür passen wir einmal eine Poissonregression an und nutzen gleich einmal das Modell um uns die Inzidenzratenverhältnisse (eng *Incidence Rate Ratio*, abk. *IRR*) für die beiden Kovariaten berechnen zu lassen.</span>
<span id="cb208-2171"><a href="#cb208-2171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2174"><a href="#cb208-2174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2175"><a href="#cb208-2175" aria-hidden="true" tabindex="-1"></a>pois_c2_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> c_2, <span class="at">data =</span> cov2_pois_tbl, <span class="at">family =</span> poisson)</span>
<span id="cb208-2176"><a href="#cb208-2176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2177"><a href="#cb208-2177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2178"><a href="#cb208-2178" aria-hidden="true" tabindex="-1"></a>Wir können hier uns entweder die Koeffizienten einmal direkt über die Funktion <span class="in">`model_parameters()`</span> wiedergeben lassen oder aber dann gleich einmal in der Funktionalität des R Pakets <span class="in">`{marginaleffects}`</span>. Wir sehen hier, dass wir jeweils einen positiven Effekt haben. Mit steigenden Kovariaten erhöhen sich auch die Messwerte.</span>
<span id="cb208-2179"><a href="#cb208-2179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2182"><a href="#cb208-2182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2183"><a href="#cb208-2183" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-2184"><a href="#cb208-2184" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-2185"><a href="#cb208-2185" aria-hidden="true" tabindex="-1"></a>pois_c2_fit <span class="sc">|&gt;</span> </span>
<span id="cb208-2186"><a href="#cb208-2186" aria-hidden="true" tabindex="-1"></a>  parameters<span class="sc">::</span><span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb208-2187"><a href="#cb208-2187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2188"><a href="#cb208-2188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2189"><a href="#cb208-2189" aria-hidden="true" tabindex="-1"></a>Dam Ende dann nochmal die multiplikative Änderung als Inzidenzratenverhältnis für die beiden Kovariaten an zwei definierten Werten für die jeweiligen Kovariaten. Wir sehen dann auch hier das es dann eben auch auf die Werte ankommt, die wir uns anssehen wollen. Wir können eben nicht so einfach die Steigung wieder als Risk Ratio sehen. Aber das ist eben dann auch der Unterschied zwischen einem absoluten Effekt wie der Steigung und dem Risk Ratio also Faktor. Damit werden wir leben müssen. Die Vingette <span class="co">[</span><span class="ot">Targeted logistic model coefficients</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/logisticCoefs.html)</span> geht das Problem in <span class="in">`{simstudy}`</span> nochmal an.</span>
<span id="cb208-2190"><a href="#cb208-2190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2193"><a href="#cb208-2193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2194"><a href="#cb208-2194" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_comparisons</span>(pois_c2_fit, <span class="at">comparison =</span> <span class="st">"ratio"</span>,</span>
<span id="cb208-2195"><a href="#cb208-2195" aria-hidden="true" tabindex="-1"></a>                <span class="at">variables =</span> <span class="fu">list</span>(<span class="st">"c_1"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">11</span>),</span>
<span id="cb208-2196"><a href="#cb208-2196" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"c_2"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>)))</span>
<span id="cb208-2197"><a href="#cb208-2197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2198"><a href="#cb208-2198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2199"><a href="#cb208-2199" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Multikovariat abhängig $c_1 + c_2 + c_3$ {.unnumbered .unlisted}</span></span>
<span id="cb208-2200"><a href="#cb208-2200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2201"><a href="#cb208-2201" aria-hidden="true" tabindex="-1"></a>Eine multivariate Poissonverteilung ist nicht einfach zu bauen. Jedenfalls um so viel schwerer, dass eine gerundete multivariate Normalverteilung mit Korrelationsstruktur viel einfacher zu erstellen ist. Die Funktionalität in <span class="in">`{simstudy}`</span> erlaubt auch multivariate korrelierte Poissondaten zu erstellen. Die Vingette <span class="co">[</span><span class="ot">Correlated data: additional distributions</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/correlated.html#correlated-data-additional-distributions)</span> hilft hierbei. Ich zeige hier einmal die Variante der Poissonverteilung mit drei Kovariaten und einer konstanten Korrelation zwischen den Kovariaten von 0.3 als *compound symmetry (cs)* Korrelationsmatrix.</span>
<span id="cb208-2202"><a href="#cb208-2202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2205"><a href="#cb208-2205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2206"><a href="#cb208-2206" aria-hidden="true" tabindex="-1"></a>cov2_dependent_dt <span class="ot">&lt;-</span> <span class="fu">genCorGen</span>(<span class="dv">1000</span>, <span class="at">nvars =</span> <span class="dv">3</span>, <span class="at">params1 =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>), <span class="at">dist =</span> <span class="st">"poisson"</span>, </span>
<span id="cb208-2207"><a href="#cb208-2207" aria-hidden="true" tabindex="-1"></a>                               <span class="at">rho =</span> <span class="fl">0.3</span>, <span class="at">corstr =</span> <span class="st">"cs"</span>, <span class="at">wide =</span> <span class="cn">TRUE</span>,</span>
<span id="cb208-2208"><a href="#cb208-2208" aria-hidden="true" tabindex="-1"></a>                               <span class="at">cnames =</span> <span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>, <span class="st">"c_3"</span>)) </span>
<span id="cb208-2209"><a href="#cb208-2209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2210"><a href="#cb208-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2211"><a href="#cb208-2211" aria-hidden="true" tabindex="-1"></a>Im Folgenden siehst du dann einmal die Datentabelle der eintausend Beobachtungen. Wir haben die ID Spalte und dann die drei Kovariaten gefolgt von dem Messwert. Die beobachtete Korrelation ist dann 0.3 zwischen den Kovariaten.</span>
<span id="cb208-2212"><a href="#cb208-2212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2215"><a href="#cb208-2215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2216"><a href="#cb208-2216" aria-hidden="true" tabindex="-1"></a>cov2_dependent_dt</span>
<span id="cb208-2217"><a href="#cb208-2217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2218"><a href="#cb208-2218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2219"><a href="#cb208-2219" aria-hidden="true" tabindex="-1"></a>In den rohen Daten ist die Korrelation faktisch nicht zu sehen. Jedenfalls kann ich sowas nicht erkennen. Dafür müssen wir uns dann einmal die Korrelation berechnen lassen. Wie wir dann im Folgenden einmal sehen, passt es sehr gut. Wir erhalten die Korrelationen wieder, die wir auch eingestellt haben.</span>
<span id="cb208-2220"><a href="#cb208-2220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2223"><a href="#cb208-2223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2224"><a href="#cb208-2224" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation</span>(cov2_dependent_dt, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"c_1"</span>, <span class="st">"c_2"</span>, <span class="st">"c_3"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb208-2225"><a href="#cb208-2225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">redundant =</span> <span class="cn">TRUE</span>)</span>
<span id="cb208-2226"><a href="#cb208-2226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2227"><a href="#cb208-2227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2228"><a href="#cb208-2228" aria-hidden="true" tabindex="-1"></a>Wir können jetzt mit den korrelierten Kovariaten uns nochmal neue Messwerte erstellen. Hierbei bitte bachten, dass multiple Modelle Probleme kriegen, wenn die Kovariaten zu stark miteinander korreliert sind. Dazu dann aber mehr in dem <span class="co">[</span><span class="ot">Kapitel zu der multiplen Regression</span><span class="co">](#sec-mult-reg-basic)</span>.</span>
<span id="cb208-2229"><a href="#cb208-2229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2230"><a href="#cb208-2230" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb208-2231"><a href="#cb208-2231" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/personal_opinion.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb208-2232"><a href="#cb208-2232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2233"><a href="#cb208-2233" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Brauchen wir das? Ein klares Jein. Ich finde korrelierte Daten eher sinnvoll in Zeitreihen und dann auch gerne mit einer auto-regressive Korrelationsstruktur. Ansonsten ist es sicherlich in der Theorie spannend, solche Daten zu erstellen." --- Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.*</span></span>
<span id="cb208-2234"><a href="#cb208-2234" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb208-2235"><a href="#cb208-2235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2236"><a href="#cb208-2236" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ordinalverteilt</span></span>
<span id="cb208-2237"><a href="#cb208-2237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2238"><a href="#cb208-2238" aria-hidden="true" tabindex="-1"></a>Was sind ordinalverteilte Messwerte? Wir können diese Art von Messwerten einmal als Antwortmöglichkeiten bei einem Fragebogen oder aber bei der Bonitur beobachten. Bei Fragebögen haben wir dann meistens drei bis fünf Antwortkategorien, die dann eben auch geordnet sind. Alle Kategorien haben dabei den gleichen Abstand. Bei der Bonitur haben wir häufig eine fünf- bis neunstufige Likertskala vorliegen, wobei die Neun immer die stärkste Ausprägung beschreibt. Wenn du nur zwei Antwortmöglichkeiten vorliegen hast, dann bist du im binären Fall, das machen wir dann weiter unten nochmal. Das R Paket <span class="in">`{simstudy}`</span> hat mit der Vingette <span class="co">[</span><span class="ot">Ordinal Categorical Data</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/ordinal.html)</span> eine Hilfeseite, die dir einmal beschreibt, wie wir ordinale Messwerte erstellen. Neben dem R Paket gibt es auch noch andere Möglichkeiten. Wir haben in dem Blogeintrag <span class="co">[</span><span class="ot">A refined brute force method to inform simulation of ordinal response data</span><span class="co">](https://www.rdatagen.net/post/can-empirical-mean-and-variance-data-inform-simulation-of-ordinal-response-variables/)</span> auch nochmal eine andere Sicht der Dinge. Hier simulieren wir aus mittlren Noten udn einer Standardabweichung dann die entsprechenden Daten.</span>
<span id="cb208-2239"><a href="#cb208-2239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2240"><a href="#cb208-2240" aria-hidden="true" tabindex="-1"></a>Am Ende kannst du dir vorstellen, dass wir als Messwert wiederum einen Faktor vorliegen haben und eigentlich keinen numerischen Messwert. Wir wollen hier aber einmal verstehen, wie sich so ordinale Messwerte zusammensetzen. In den Agrarwissenschaften wird gerne eine 9er Likert Skala verwendet. Wir haben also ein Merkmal wie Blattfäule oder Befall und benoten nun mit einem 9er Notensystem. Das Problem ist nun, dass wir bei neun Noten natürlich auch jeder Ausprägung eine Wahrscheinlichkeit zuordnen müssen. Da werden dann die einzlenen Wahrscheinlichketen sehr klein. Darüber hinaus ist dann vermutlich eine Verschiebung der Noten zwischen den Gruppen auch sehr klein. Alles nicht so einfach. Am Ende ist das Verständnis der Datengenierung auch immer sehr hilfreich bei der Auswertung im <span class="co">[</span><span class="ot">Kapitel zur Multinomialen / Ordinalen Regression</span><span class="co">](#sec-multinom-ordinal)</span>.</span>
<span id="cb208-2241"><a href="#cb208-2241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2242"><a href="#cb208-2242" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb208-2243"><a href="#cb208-2243" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb208-2244"><a href="#cb208-2244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2245"><a href="#cb208-2245" aria-hidden="true" tabindex="-1"></a>Um jetzt irgendwas zu sehen, brauchen wir wirklich viele Fallzahlen. Wenn du später nur fünf Beobachtungen pro Gruppe hast, dann wird es sehr schwer die vorengestellten Gruppenwahrscheinlichkeiten wiederzufinden. Deshalb kann es sein, dass es beser ist, dir die Daten einfach per Hand selber in Excel zu bauen.</span>
<span id="cb208-2246"><a href="#cb208-2246" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-2247"><a href="#cb208-2247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2248"><a href="#cb208-2248" aria-hidden="true" tabindex="-1"></a><span class="fu">### Faktorielles Design {.unnumbered .unlisted}</span></span>
<span id="cb208-2249"><a href="#cb208-2249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2250"><a href="#cb208-2250" aria-hidden="true" tabindex="-1"></a>Für die ordinalverteilten Daten nutzen wir jetzt hier hauptsächtlich das faktorielle Design. Wir nutzen hier dabei aber auch nur ein reduziertes Design zum Einstieg. Das hat den Grund, dass die Erstellung schon kompliziert genug ist und wir bei kleinen Fallzahlen später dann kaum noch was wieder erkennen. Daher wir stellen zwar Effekte ein, wollen aber nur so wenige Beobachtungen haben, dass wir die Effekte gar nicht wiedersehen. Dann können wir uns die Zahlen auch händisch in Excel zusammentippen. @gambarota2024ordinal geht in seiner Arbeit <span class="co">[</span><span class="ot">Ordinal regression models made easy: A tutorial on parameter interpretation, data simulation and power analysis</span><span class="co">](https://onlinelibrary.wiley.com/doi/full/10.1002/ijop.13243)</span> nochmal auf das faktorielle Design ein und zeigt auch, wie wir komplexere Modelle simulieren können.</span>
<span id="cb208-2251"><a href="#cb208-2251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2252"><a href="#cb208-2252" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktoriell $f_A$ mit 2 Leveln {.unnumbered .unlisted}</span></span>
<span id="cb208-2253"><a href="#cb208-2253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2254"><a href="#cb208-2254" aria-hidden="true" tabindex="-1"></a>Wir beginnen mit dem einfaktoriellen Modell mit zwei Leveln. Wir nutzen wieder das simple Modell um einmal die Herausforderungen zu verstehen. Wir haben es nämlich bei einem ordinalen Messwert mit etwas komplizierteren Daten zu tun. Beginnen wir mit einem ordinalen Messwert mit fünf Kategorien. Wir haben hier also eine Frage vorliegen mit fünf Antwortmöglichkeiten. Die Antwortmöglichkeiten sind *trifft gar nicht zu*, *trifft nicht zu*, *weder noch*, *trifft zu* und *trifft voll zu*. Jetzt kommt der eigentlich Twist. Wir haben diese Antwortmöglichkeiten ja in unterschiedlichen Häufigkeiten vorliegen. Wir haben also 100 Personen befragt und diese 100 Personen haben jeweils eine der Antwortmöglichkeiten auf die Frage geantwortet. Damit erhalten wir dann folgende hypothetische Verteilung der Antworten.</span>
<span id="cb208-2255"><a href="#cb208-2255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2258"><a href="#cb208-2258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2259"><a href="#cb208-2259" aria-hidden="true" tabindex="-1"></a>null_prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span> <span class="ot">=</span> <span class="fl">0.1</span>, </span>
<span id="cb208-2260"><a href="#cb208-2260" aria-hidden="true" tabindex="-1"></a>               <span class="st">"trifft nicht zu"</span> <span class="ot">=</span> <span class="fl">0.2</span>, </span>
<span id="cb208-2261"><a href="#cb208-2261" aria-hidden="true" tabindex="-1"></a>               <span class="st">"weder noch"</span> <span class="ot">=</span> <span class="fl">0.4</span>, </span>
<span id="cb208-2262"><a href="#cb208-2262" aria-hidden="true" tabindex="-1"></a>               <span class="st">"trifft zu"</span> <span class="ot">=</span> <span class="fl">0.2</span>, </span>
<span id="cb208-2263"><a href="#cb208-2263" aria-hidden="true" tabindex="-1"></a>               <span class="st">"trifft voll zu"</span> <span class="ot">=</span> <span class="fl">0.1</span>)</span>
<span id="cb208-2264"><a href="#cb208-2264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2265"><a href="#cb208-2265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2266"><a href="#cb208-2266" aria-hidden="true" tabindex="-1"></a>Wir können hier nicht einfach einen Effekt aufaddieren um eien zweite Gruppe zu erschaffen. Wir können nicht die Wahrscheinlichkeiten einfach um $+0.1$ erhöhen, dann hätten wir ja in der Summe $5 \times 0.1 = +0.5$ erhöht. Wir brauchen aber eine Wahrschinlichkeit von Eins in Summe. Daher müssen wir von einigen Antwortmöglichkeiten etwas abziehen und bei anderen etwas aufaddieren. Die Änderungen müssen sich ja dann zu Null aufaddieren, wie du im folgenden Beispiel für eine alternative Gruppe siehst.</span>
<span id="cb208-2267"><a href="#cb208-2267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2270"><a href="#cb208-2270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2271"><a href="#cb208-2271" aria-hidden="true" tabindex="-1"></a>alt_prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span> <span class="ot">=</span> <span class="fl">0.1</span> <span class="sc">-</span> <span class="fl">0.05</span>, </span>
<span id="cb208-2272"><a href="#cb208-2272" aria-hidden="true" tabindex="-1"></a>              <span class="st">"trifft nicht zu"</span> <span class="ot">=</span> <span class="fl">0.2</span> <span class="sc">-</span> <span class="fl">0.1</span>, </span>
<span id="cb208-2273"><a href="#cb208-2273" aria-hidden="true" tabindex="-1"></a>              <span class="st">"weder noch"</span> <span class="ot">=</span> <span class="fl">0.4</span> <span class="sc">-</span> <span class="fl">0.1</span>, </span>
<span id="cb208-2274"><a href="#cb208-2274" aria-hidden="true" tabindex="-1"></a>              <span class="st">"trifft zu"</span> <span class="ot">=</span> <span class="fl">0.2</span> <span class="sc">+</span> <span class="fl">0.2</span>, </span>
<span id="cb208-2275"><a href="#cb208-2275" aria-hidden="true" tabindex="-1"></a>              <span class="st">"trifft voll zu"</span> <span class="ot">=</span> <span class="fl">0.1</span> <span class="sc">+</span> <span class="fl">0.05</span>)</span>
<span id="cb208-2276"><a href="#cb208-2276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2277"><a href="#cb208-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2278"><a href="#cb208-2278" aria-hidden="true" tabindex="-1"></a>Dann können wir einmal für die beiden Gruppen dann die fünf Antwortmöglichkeiten mit den jeweiligen Wahrscheinlichkeiten erschaffen. Beachte, dass wir die Namen der Wahrscheinlichkeitsvektoren nicht mitschleifen und dann in der Genierung verlieren. Daher müssen wir dann den Messwert nochmal wieder als Faktor mutieren. Für die Darstellung ist es dann aber mit einem numerischen Messwert einfacher.</span>
<span id="cb208-2279"><a href="#cb208-2279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2282"><a href="#cb208-2282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2283"><a href="#cb208-2283" aria-hidden="true" tabindex="-1"></a>ord_fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"A.1"</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> null_prob),</span>
<span id="cb208-2284"><a href="#cb208-2284" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"A.2"</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> alt_prob))  <span class="sc">|&gt;</span> </span>
<span id="cb208-2285"><a href="#cb208-2285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"f_a"</span>, <span class="at">value =</span> <span class="st">"y"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2286"><a href="#cb208-2286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y_fct =</span> <span class="fu">factor</span>(y, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span>, <span class="st">"trifft nicht zu"</span>, <span class="st">"weder noch"</span>,</span>
<span id="cb208-2287"><a href="#cb208-2287" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"trifft zu"</span>, <span class="st">"trifft voll zu"</span>)))</span>
<span id="cb208-2288"><a href="#cb208-2288" aria-hidden="true" tabindex="-1"></a>ord_fac1_tbl</span>
<span id="cb208-2289"><a href="#cb208-2289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2290"><a href="#cb208-2290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2291"><a href="#cb208-2291" aria-hidden="true" tabindex="-1"></a>Dann können wir uns einmal die Verteilungen der Antwortmöglichkeiten in den beiden Gruppen mit je einhundert Beobachtungen anschauen. Wie du siehst, sind die beiden Verteilungen ineinander verschoben. Dabei hat die zweite Gruppe mehr Antworten bei *trifft zu* und *trifft voll zu*. Daher muss die Anzahl der Antworten bei den negativen Antworten kleiner sein. Wie du dir vorstellen kannst, haben wir hier nicht so viel Raum um Veränderungen zu erreichen und dabei irgendiwe noch eine Verteilung zu sehen. Wenn sich alles auf einer Seite zusammenballt, dann haben wir auch schon fast keine Varianz mehr.</span>
<span id="cb208-2292"><a href="#cb208-2292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2295"><a href="#cb208-2295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2296"><a href="#cb208-2296" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-2297"><a href="#cb208-2297" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-2298"><a href="#cb208-2298" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb208-2299"><a href="#cb208-2299" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-2300"><a href="#cb208-2300" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-2301"><a href="#cb208-2301" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb208-2302"><a href="#cb208-2302" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-2303"><a href="#cb208-2303" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Histogramm der Verteilung der Antwortmöglichkeiten in einem einfaktoriellen Design mit zwei Gruppen. Die Häufigkeit der Antworten ist in den beiden Gruppen verschoben. Da die Summe der Antwortwahrscheinlichkeiten Eins sein muss und die Summe der Verschiebungen Null sein muss, ist die Verschiebung nicht trivial. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-2304"><a href="#cb208-2304" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-ordinal-theo-sample</span></span>
<span id="cb208-2305"><a href="#cb208-2305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2306"><a href="#cb208-2306" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ord_fac1_tbl, <span class="fu">aes</span>(<span class="at">x =</span> y, <span class="at">fill =</span> f_a)) <span class="sc">+</span></span>
<span id="cb208-2307"><a href="#cb208-2307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-2308"><a href="#cb208-2308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb208-2309"><a href="#cb208-2309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()  <span class="sc">+</span></span>
<span id="cb208-2310"><a href="#cb208-2310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb208-2311"><a href="#cb208-2311" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span>, <span class="st">"trifft nicht zu"</span>, <span class="st">"weder noch"</span>,</span>
<span id="cb208-2312"><a href="#cb208-2312" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"trifft zu"</span>, <span class="st">"trifft voll zu"</span>),</span>
<span id="cb208-2313"><a href="#cb208-2313" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb208-2314"><a href="#cb208-2314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Antwortmöglichkeit"</span>, <span class="at">y =</span> <span class="st">"Anzahl"</span>, <span class="at">fill =</span> <span class="st">"Faktor A"</span>) <span class="sc">+</span></span>
<span id="cb208-2315"><a href="#cb208-2315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb208-2316"><a href="#cb208-2316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2317"><a href="#cb208-2317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2318"><a href="#cb208-2318" aria-hidden="true" tabindex="-1"></a>Jetzt ist es natürlich super nervig einen Vektor zu bauen, der die Verschiebungen der Antwortwahrscheinlichkeiten beschreibt. Insbesondere wenn wir viele Antwortmöglichkeiten oder Notenausprägungen haben. Dann wird es sehr schwierig und sehr kleinteilig. Daher ist eine Idee eine latente Variable zu generieren, die wir verschieben können und uns über einen Umweg dann die Wahrscheinlichkeiten für die Antwortmöglichkeiten wiedergibt. Das ist die Lösung in <span class="in">`{simstudy}`</span>.</span>
<span id="cb208-2319"><a href="#cb208-2319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2320"><a href="#cb208-2320" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung habe ich dir einmal das Prinzip visualisiert. Unsere Antwortwahrscheinlichkeiten sind die Flächen unter der Kurve. Damit wir hier alles etwas besser sehen, habe ich mich auf vier Antwortmöglichkeiten beschränkt. Wir können jetzt die z-Werte auf der x-Achse verschieben und damit ändern sich auch die Flächen zwischen den z-Werten. Da die Flächen die Antwortwahrscheinlichkeiten sind, können wir hier einen Wert ändern und erhalten neue Wahrscheinlicheiten wieder. Dabei ist zu beachten, das die Verschiebung für alle Antworten in die gleiche Richtung und um den gleichen Effekt erfolgt.</span>
<span id="cb208-2321"><a href="#cb208-2321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2324"><a href="#cb208-2324" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2325"><a href="#cb208-2325" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-2326"><a href="#cb208-2326" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-2327"><a href="#cb208-2327" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-2328"><a href="#cb208-2328" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-2329"><a href="#cb208-2329" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb208-2330"><a href="#cb208-2330" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb208-2331"><a href="#cb208-2331" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung der Idee der latenten Variable zur Generierung von ordnialen Daten. Die Fläche unter der Kurve stellt die Antwortwahrscheinlichkeit für vier Antworten dar. Wenn der z-Wert verschoben wird, dann ändert sich auch die Fläche und damit auch die Antwortwahrscheinlichkeiten. **(A)** Antwortverteilung für die Gruppe $A.1$  **(B)** Verschobene Antwortverteilung um $+0.7$ für die Gruppe $A.2$. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-2332"><a href="#cb208-2332" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-ordinal-theo</span></span>
<span id="cb208-2333"><a href="#cb208-2333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2334"><a href="#cb208-2334" aria-hidden="true" tabindex="-1"></a>p1_ord_theo <span class="sc">+</span> p2_ord_theo <span class="sc">+</span></span>
<span id="cb208-2335"><a href="#cb208-2335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb208-2336"><a href="#cb208-2336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb208-2337"><a href="#cb208-2337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb208-2338"><a href="#cb208-2338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2339"><a href="#cb208-2339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2340"><a href="#cb208-2340" aria-hidden="true" tabindex="-1"></a>Natürlich ist das etwas zu schön um wahr zu sein. Wir haben hier eine ziemlich strenge Annahme getroffen. Durch die Verschiebung durch ein festes $z$ gleich $+0.7$ haben wir die Annahme an ein proportionales Wahrscheinlichkeitsmodell getroffen. Wir verschieben eben alle Antwortmöglichkeiten gleichmäßig um den gleichen Wert nach rechts. Die Richtung und auch die Effektstärke ist für alle Antwortmöglichkeiten gleich.</span>
<span id="cb208-2341"><a href="#cb208-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2342"><a href="#cb208-2342" aria-hidden="true" tabindex="-1"></a>Proportionales Wahrscheinlichkeitsmodell</span>
<span id="cb208-2343"><a href="#cb208-2343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2344"><a href="#cb208-2344" aria-hidden="true" tabindex="-1"></a>:   Was will und das Proportionales Wahrscheinlichkeitsmodell (eng. *proportional odds model*) sagen? Wenn wir die Wahrscheinlichkeiten der Antworten verschieben, dann verschieben wir in die gleiche Richtung und um den gleichen Wert. Alle Antwortwahrscheinlichkeiten verhalten sich gleich und dementsprechend proportional.</span>
<span id="cb208-2345"><a href="#cb208-2345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2346"><a href="#cb208-2346" aria-hidden="true" tabindex="-1"></a>Wir können jetzt in <span class="in">`{simstudy}`</span> beide Varianten durchführen. Wir können also einmal davon ausgehen, dass wir den gleichen Effekt in die gleiche Richtung für alle Antwortwahrscheinlichkeiten vorliegen haben. Wir rechnen dann mit der *Proportional odds* Annahme. Wir können aber auch den Fall vorliegen haben, dass wir die Antwortwahrscheinlichkeiten individuell verschieben. Dann haben wir die Annahme der *Non-proportional odds* getroffen. Ich zeige dir dann weiter unten einmal die Durchführung in <span class="in">`{simstudy}`</span> und wie wir dann die zufälligen ordinalen Werte erhalten.</span>
<span id="cb208-2347"><a href="#cb208-2347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2348"><a href="#cb208-2348" aria-hidden="true" tabindex="-1"></a>Wir wollen aber erstmal damit anfangen ein Nullmmodell zu bauen. Daran können wir dann nochmal besser die latente Variable $z$ verstehen. Später ist es eigentlich nur eine kleine Anpassung zwischen *proportional odds* und *non-proportional odds*. Als erstes brauchen wir daher wieder einmal unser Klassenwahrscheinlichkeiten für unser Nullmodell oder eben wie wahrscheinlich tritt eine der Antwortkategorien auf. Später können wir dann noch einen Effekt zu dieses Nullmodell hinzufügen. Um die Sache etwas zu vereinfachen habe ich hier nur vier Antwortmöglichkeiten gewählt und die entsprechenden Wahrscheinlichkeiten festgelegt.</span>
<span id="cb208-2349"><a href="#cb208-2349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2352"><a href="#cb208-2352" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2353"><a href="#cb208-2353" aria-hidden="true" tabindex="-1"></a>null_prob <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span> <span class="ot">=</span> <span class="fl">0.31</span>, </span>
<span id="cb208-2354"><a href="#cb208-2354" aria-hidden="true" tabindex="-1"></a>               <span class="st">"trifft nicht zu"</span> <span class="ot">=</span> <span class="fl">0.29</span>, </span>
<span id="cb208-2355"><a href="#cb208-2355" aria-hidden="true" tabindex="-1"></a>               <span class="st">"trifft zu"</span> <span class="ot">=</span> <span class="fl">0.2</span>, </span>
<span id="cb208-2356"><a href="#cb208-2356" aria-hidden="true" tabindex="-1"></a>               <span class="st">"trifft voll zu"</span> <span class="ot">=</span> <span class="fl">0.2</span>)</span>
<span id="cb208-2357"><a href="#cb208-2357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2358"><a href="#cb208-2358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2359"><a href="#cb208-2359" aria-hidden="true" tabindex="-1"></a>Jetzt brauchen wir noch unsere latente Variable $z$ um unseren Wahrscheinlichkeiten in feste Werte zu übersetzen. In der folgenden Abbildung siehst du dann einmal den Logit der Wahrscheinlichkeiten. Der Logit beschreibt die Wahrscheinlichkeiten als logarithmierte Chancen. Das klingt jetzt etwas wild, aber wir transformieren im Prinzip die Flächen so, dass wir dann die Wahrscheinlichkeiten der Antwortzugehörigkeit auch durch die x-Werte beschreiben können.</span>
<span id="cb208-2360"><a href="#cb208-2360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2363"><a href="#cb208-2363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2364"><a href="#cb208-2364" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-2365"><a href="#cb208-2365" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-2366"><a href="#cb208-2366" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb208-2367"><a href="#cb208-2367" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-2368"><a href="#cb208-2368" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-2369"><a href="#cb208-2369" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb208-2370"><a href="#cb208-2370" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-2371"><a href="#cb208-2371" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Zusammenhang zwischen der latenten Variable $z$ als logit und der Antwortwahrscheinlichkeiten. Die Flächen als Wahrscheinlichkeiten werden durch den Logit auf der x-Achse dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-2372"><a href="#cb208-2372" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-ordinal-theo-sample-anno</span></span>
<span id="cb208-2373"><a href="#cb208-2373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2374"><a href="#cb208-2374" aria-hidden="true" tabindex="-1"></a>p1_ord_theo_anno</span>
<span id="cb208-2375"><a href="#cb208-2375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2376"><a href="#cb208-2376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2377"><a href="#cb208-2377" aria-hidden="true" tabindex="-1"></a>Was ist die Logitfunktion einmal mathematisch? In der folgenden Formel siehst du einmal den Zusammenhang. Der Logit einer Wahrscheinlichkeit $Pr$ ist das logarithmierte Chancenverhältnis. Damit können wir Wahrscheinlichkeiten in feste Werte überstetzen, die wir dann durch Addition oder Subtraktion verschieben können. Auf der x-Achse können wir ja schieben, die Flächen ändern sich dann automatisch.</span>
<span id="cb208-2378"><a href="#cb208-2378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2379"><a href="#cb208-2379" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-2380"><a href="#cb208-2380" aria-hidden="true" tabindex="-1"></a>\text{logit}(Pr) = log\left(\cfrac{Pr}{1-Pr}\right)</span>
<span id="cb208-2381"><a href="#cb208-2381" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-2382"><a href="#cb208-2382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2383"><a href="#cb208-2383" aria-hidden="true" tabindex="-1"></a>In dem Fall der ordinalen Messwerte ist es nochmal einen kleinen Schritt komplizierter, da wir immer die kummulierten Wahrscheinlichkeiten für die latente Variable brauchen. In den folgenden Tabs siehst du dann einmal den Weg um die drei Grenzwerte aus der obigen Abbildung zu berechnen. Wir haben vier Antwortmöglichkieten mit vier Wahrscheinlichkeiten, also brauchen wir dann drei Grenzwerte als latente Variable.</span>
<span id="cb208-2384"><a href="#cb208-2384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2385"><a href="#cb208-2385" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb208-2386"><a href="#cb208-2386" aria-hidden="true" tabindex="-1"></a><span class="fu">## *trifft gar nicht zu*</span></span>
<span id="cb208-2387"><a href="#cb208-2387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2388"><a href="#cb208-2388" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-2389"><a href="#cb208-2389" aria-hidden="true" tabindex="-1"></a>log \left(\cfrac{Pr(A.1 \leq  1)}{Pr(A.1 &gt; 1)} | A.1 \right) = log \left(\cfrac{Pr(0.31)}{Pr(1-0.31)}\right) = -0.80</span>
<span id="cb208-2390"><a href="#cb208-2390" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-2391"><a href="#cb208-2391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2392"><a href="#cb208-2392" aria-hidden="true" tabindex="-1"></a><span class="fu">## *trifft nicht zu*</span></span>
<span id="cb208-2393"><a href="#cb208-2393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2394"><a href="#cb208-2394" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-2395"><a href="#cb208-2395" aria-hidden="true" tabindex="-1"></a>log \left(\cfrac{Pr(A.1 \leq  2)}{Pr(A.1 &gt; 2)} | A.1 \right) = log \left(\cfrac{Pr(0.31 + 0.29)}{Pr(1-0.31-0.29)}\right) = 0.4</span>
<span id="cb208-2396"><a href="#cb208-2396" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-2397"><a href="#cb208-2397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2398"><a href="#cb208-2398" aria-hidden="true" tabindex="-1"></a><span class="fu">## *trifft zu*</span></span>
<span id="cb208-2399"><a href="#cb208-2399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2400"><a href="#cb208-2400" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-2401"><a href="#cb208-2401" aria-hidden="true" tabindex="-1"></a>log \left(\cfrac{Pr(A.1 \leq  3)}{Pr(A.1 &gt; 3)} | A.1 \right) = log \left(\cfrac{Pr(0.31 + 0.29 + 0.20)}{Pr(1-0.31-0.29-0.20)} \right) = 1.38 \approx 1.4</span>
<span id="cb208-2402"><a href="#cb208-2402" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-2403"><a href="#cb208-2403" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-2404"><a href="#cb208-2404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2405"><a href="#cb208-2405" aria-hidden="true" tabindex="-1"></a>Natürlich gibt es auch hier eine Implementierung in R. Leider sind die Namen der Funktionen nicht so eingängig wie es sein könnte. Oder andersherum, die R Entwickler wollten keine Doppelungen. Manchmal machen aber Doppelungen Sinn, da wir dann die Namen im Kontext besser zuordnen können. Der Blogeintrag <span class="co">[</span><span class="ot">logit() and logistic() functions in R</span><span class="co">](https://ro-che.info/articles/2018-08-11-logit-logistic-r)</span> geht da nochnmal genauer drauf ein. Hier können wir dann einmal die Wahrscheinlichkeiten aufsummieren und dann die <span class="in">`qlogis()`</span> Funktion als Logitfunktion nutzen.</span>
<span id="cb208-2406"><a href="#cb208-2406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2409"><a href="#cb208-2409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2410"><a href="#cb208-2410" aria-hidden="true" tabindex="-1"></a><span class="fu">qlogis</span>(<span class="fu">cumsum</span>(null_prob))[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-2411"><a href="#cb208-2411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2412"><a href="#cb208-2412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2413"><a href="#cb208-2413" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass es passt. Die sich ergebenden Werte sind die gleichen Werte, die wir auch schon oben in der Abbildung auf der x-Achse haben. Es ist also etwas von hinten durch die Brust, aber am Ende haben wir verstanden, woher die Werte jeweils kommen.</span>
<span id="cb208-2414"><a href="#cb208-2414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2415"><a href="#cb208-2415" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb208-2416"><a href="#cb208-2416" aria-hidden="true" tabindex="-1"></a><span class="fu">## Der $\text{logit}()$ und die Umkehrfunktion $\text{invlogit}()$</span></span>
<span id="cb208-2417"><a href="#cb208-2417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2418"><a href="#cb208-2418" aria-hidden="true" tabindex="-1"></a>Und wie kommen wir wieder zurück? Was ist also die Umkehrfunktion einer $\text{logit}()$-Funktion? Das ist die $\text{logistic}()$-Funktion oder aber eben die $\text{invlogit}()$-Funktion für *inverted*. In unserem Fall können wir hier die Funktion <span class="in">`plogis()`</span> nutzen. Wir erhalten dann die aufsummierten Wahrscheinlichkeiten. Da wir nur die Wahrscheinlichkeiten zwischen den Grenzen erhalten, müssen wir noch die Null und die Eins ergänzen. Dann rechnen wir noch die Differenz aus.</span>
<span id="cb208-2419"><a href="#cb208-2419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2422"><a href="#cb208-2422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2423"><a href="#cb208-2423" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">plogis</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.8</span>, <span class="fl">0.4</span>, <span class="fl">1.4</span>)), <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">diff</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-2424"><a href="#cb208-2424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2425"><a href="#cb208-2425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2426"><a href="#cb208-2426" aria-hidden="true" tabindex="-1"></a>Wie wir sehen, kommen dann die Antwortwahrscheinlichkeiten unseres Nullmodells wieder heraus. Das klappt ja super. Solange ich nicht die Funktion gefunden habe, die mir in R intern die Wahrscheinlichkeiten aus Logits ausrechnet, schreibe ich mir die Funktion hier einmal selber.</span>
<span id="cb208-2427"><a href="#cb208-2427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2430"><a href="#cb208-2430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2431"><a href="#cb208-2431" aria-hidden="true" tabindex="-1"></a>logodds_to_prob <span class="ot">&lt;-</span> \(logodds) {</span>
<span id="cb208-2432"><a href="#cb208-2432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">plogis</span>(logodds), <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">diff</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">unname</span>()</span>
<span id="cb208-2433"><a href="#cb208-2433" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb208-2434"><a href="#cb208-2434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2435"><a href="#cb208-2435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2436"><a href="#cb208-2436" aria-hidden="true" tabindex="-1"></a>Und dann einmal testen, ob die Funktion auch funktioniert. Dafür können wir dann einfach den Vektor der Logitwerte in die Funktion stecken und uns die Wahrscheinlichkeiten wiedergeben lassen.</span>
<span id="cb208-2437"><a href="#cb208-2437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2440"><a href="#cb208-2440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2441"><a href="#cb208-2441" aria-hidden="true" tabindex="-1"></a><span class="fu">logodds_to_prob</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.8</span>, <span class="fl">0.4</span>, <span class="fl">1.4</span>))</span>
<span id="cb208-2442"><a href="#cb208-2442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2443"><a href="#cb208-2443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2444"><a href="#cb208-2444" aria-hidden="true" tabindex="-1"></a>Wunderbar, dann können wir die Funktion hier auch weiter verwenden. Ich nutze gleich mal die Funktion um uns die Antwortwahrscheinlichkeiten nach der Addierung eines Effekts zu berechnen.</span>
<span id="cb208-2445"><a href="#cb208-2445" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-2446"><a href="#cb208-2446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2447"><a href="#cb208-2447" aria-hidden="true" tabindex="-1"></a>Jetzt können wir uns auch schon unsere Daten in <span class="in">`{simstudy}`</span> erstellen. Wir rechnen dann mit der *Proportional odds* Annahme in dem ersten Tab. Wir können aber auch den Fall vorliegen haben, dass wir die Antwortwahrscheinlichkeiten individuell verschieben. Dann haben wir die Annahme der *Non-proportional odds* getroffen. Ich würde aus Gründen der Einfachheit immer die *Proportional odds* Annahme wählen. Hier siehst du dann gleich wie sich die latente Variable $z$ als Logit dann über einen Effekt verschiebt.</span>
<span id="cb208-2448"><a href="#cb208-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2449"><a href="#cb208-2449" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb208-2450"><a href="#cb208-2450" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Proportional odds*</span></span>
<span id="cb208-2451"><a href="#cb208-2451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2452"><a href="#cb208-2452" aria-hidden="true" tabindex="-1"></a>Jetzt können wir uns die Daten bauen. Hier kommt ein wichtiges Achtung. Wir müssen immer mit einem $(-1)\cdot z$ in der Datengenierung rechnen. Da wir in unserem Beispiel die latente Variable um $+0.7$ verschieben wollen, tragen wir in die Formel unten ein $-0.7$ ein. Ja, das ist etwas nervig, hat aber mit dem Logit und dem Algorithmus dahinter zu tun. Wir leben damit und bauen uns entsprechend die Daten. Der Faktor ist hier einfaktoriell mit zwei Leveln. Das mache ich über <span class="in">`1:1`</span>. Wir spezifizieren hier das Verhältnis der beiden Gruppen.</span>
<span id="cb208-2453"><a href="#cb208-2453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2456"><a href="#cb208-2456" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2457"><a href="#cb208-2457" aria-hidden="true" tabindex="-1"></a>ord_fac1_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"f_a"</span>, <span class="at">formula =</span> <span class="st">"1;1"</span>, <span class="at">dist =</span> <span class="st">"trtAssign"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2458"><a href="#cb208-2458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"z"</span>, <span class="at">formula =</span> <span class="st">"-0.7*f_a"</span>, <span class="at">dist =</span> <span class="st">"nonrandom"</span>)</span>
<span id="cb208-2459"><a href="#cb208-2459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2460"><a href="#cb208-2460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2461"><a href="#cb208-2461" aria-hidden="true" tabindex="-1"></a>Dann bauen wir uns einmal ganz viele Beobachtungen. Später ziehe ich dann zufällig ein kleineres Set an Beobachtungen für unsere simulierten Daten. Bis jetzt haben wir aber nur die latente Avriable und die Gruppen definiert.</span>
<span id="cb208-2462"><a href="#cb208-2462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2465"><a href="#cb208-2465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2466"><a href="#cb208-2466" aria-hidden="true" tabindex="-1"></a>ord_fac1_pre_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">25000</span>, ord_fac1_def) <span class="sc">|&gt;</span> </span>
<span id="cb208-2467"><a href="#cb208-2467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A.1"</span>, <span class="st">"A.2"</span>)))</span>
<span id="cb208-2468"><a href="#cb208-2468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2469"><a href="#cb208-2469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2470"><a href="#cb208-2470" aria-hidden="true" tabindex="-1"></a>Jetzt ergänzen wir noch die ordinalen Messwerte als Spalte <span class="in">`antwort`</span>. Dafür müssen wir jetzt sagen, was die latente Variable mit <span class="in">`adjVar`</span> ist. Dann noch die Antwortwahrscheinlichkeiten ergänzen und schon können wir uns die Daten erstellen. Ich erstetze dann noch die Level des ordinalen Messwert mit den Antwortkategorien.</span>
<span id="cb208-2471"><a href="#cb208-2471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2474"><a href="#cb208-2474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2475"><a href="#cb208-2475" aria-hidden="true" tabindex="-1"></a>ord_fac1_dt <span class="ot">&lt;-</span> <span class="fu">genOrdCat</span>(ord_fac1_pre_dt, <span class="at">adjVar =</span> <span class="st">"z"</span>, null_prob, <span class="at">catVar =</span> <span class="st">"antwort"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2476"><a href="#cb208-2476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">antwort =</span> <span class="fu">factor</span>(antwort, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span>, <span class="st">"trifft nicht zu"</span>,</span>
<span id="cb208-2477"><a href="#cb208-2477" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">"trifft zu"</span>, <span class="st">"trifft voll zu"</span>)))</span>
<span id="cb208-2478"><a href="#cb208-2478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2479"><a href="#cb208-2479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2480"><a href="#cb208-2480" aria-hidden="true" tabindex="-1"></a>Jetzt können wir uns für jede Gruppe jeweils fünf Beobachtungen ziehen. Auch hier machen so wenige Beobachtungen kaum Sinn. So ist aber die Ausgabe schön klein und du kannst dann später mehr Beobachtungen ziehen. Dafür dann einfach die <span class="in">`5`</span> mit einer höhren Zahl versehen und mehr Beobachtungen generieren.</span>
<span id="cb208-2481"><a href="#cb208-2481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2484"><a href="#cb208-2484" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2485"><a href="#cb208-2485" aria-hidden="true" tabindex="-1"></a>ord_fac1_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-2486"><a href="#cb208-2486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(f_a) <span class="sc">|&gt;</span> </span>
<span id="cb208-2487"><a href="#cb208-2487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">5</span>)</span>
<span id="cb208-2488"><a href="#cb208-2488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2489"><a href="#cb208-2489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2490"><a href="#cb208-2490" aria-hidden="true" tabindex="-1"></a>Dann schauen wir nochmal, ob wir dann auch die Werte für die Logits auf der x-Achse für das Nullmmodell im Level $A.1$ wiederfinden. Der Weg ist etwas kompliziert, aber dafür funktioniert er gut. Da wir hier ein <span class="in">`{data.table}`</span> Objekt vorliegen haben, können wir in den eckigen Klammern etwas mehr Voodoo betreiben. Wir kriegen jetzt die drei Grenzwerte für die vier Antwortmöglichkeiten.</span>
<span id="cb208-2491"><a href="#cb208-2491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2494"><a href="#cb208-2494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2495"><a href="#cb208-2495" aria-hidden="true" tabindex="-1"></a>logOdds_A1 <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(<span class="fu">cumsum</span>(ord_fac1_dt[f_a <span class="sc">==</span> <span class="st">"A.1"</span>, <span class="fu">prop.table</span>(<span class="fu">table</span>(antwort))]))[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb208-2496"><a href="#cb208-2496" aria-hidden="true" tabindex="-1"></a>logOdds_A1 <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-2497"><a href="#cb208-2497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2498"><a href="#cb208-2498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2499"><a href="#cb208-2499" aria-hidden="true" tabindex="-1"></a>Dann noch schauen, ob die Logits dann auch in den Wahrscheinlichkeiten stimmen. Also kriegen wir die Nullmodell wahrscheinlichkeiten wieder? Anscheinend klappt das auch gut. Die Wahrscheinlichkeiten weichen etwas ab, da wir ja auch hier mit generierten Daten arbeiten.</span>
<span id="cb208-2500"><a href="#cb208-2500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2503"><a href="#cb208-2503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2504"><a href="#cb208-2504" aria-hidden="true" tabindex="-1"></a><span class="fu">logodds_to_prob</span>(logOdds_A1)</span>
<span id="cb208-2505"><a href="#cb208-2505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2506"><a href="#cb208-2506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2507"><a href="#cb208-2507" aria-hidden="true" tabindex="-1"></a>Wir haben dann ja die einen Effekt von $+0.7$ für die latente Variable $z$ eingestellt und damit auch die Logits verschoben. Das kommt auch ungefähr hin. Auch hier kriegen wir dann die drei Grenzwerte für die vier Antwortmöglichkeiten wiedergegeben.</span>
<span id="cb208-2508"><a href="#cb208-2508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2511"><a href="#cb208-2511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2512"><a href="#cb208-2512" aria-hidden="true" tabindex="-1"></a>logOdds_A2 <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(<span class="fu">cumsum</span>(ord_fac1_dt[f_a <span class="sc">==</span> <span class="st">"A.2"</span>, <span class="fu">prop.table</span>(<span class="fu">table</span>(antwort))]))[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb208-2513"><a href="#cb208-2513" aria-hidden="true" tabindex="-1"></a>logOdds_A2 <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-2514"><a href="#cb208-2514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2515"><a href="#cb208-2515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2516"><a href="#cb208-2516" aria-hidden="true" tabindex="-1"></a>Jetzt wird es spannend, da wir uns jetzt einmal anschauen können welche Wahrscheinlichkeiten für die Antwortkategorien entstehen, wenn wir um $z+0.7$ verschieben. Wir ändern ja nicht die Wahrscheinlichkeiten für die Antwortmöglichkeiten direkt sondern eben den Logit.</span>
<span id="cb208-2517"><a href="#cb208-2517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2520"><a href="#cb208-2520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2521"><a href="#cb208-2521" aria-hidden="true" tabindex="-1"></a><span class="fu">logodds_to_prob</span>(logOdds_A2)</span>
<span id="cb208-2522"><a href="#cb208-2522" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2523"><a href="#cb208-2523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2524"><a href="#cb208-2524" aria-hidden="true" tabindex="-1"></a>Am Ende summiert sich alles auf Eins auf und wir haben eben eine Änderung in den Wahrscheinlichkeiten. Die Gruppen verschieben sich und wir haben dann eben auch andere Wahrscheinlichkeiten für die Antworten. Jetzt kannst du spielen, wie stark du den Effekt möchtest.</span>
<span id="cb208-2525"><a href="#cb208-2525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2526"><a href="#cb208-2526" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Non-proportional odds*</span></span>
<span id="cb208-2527"><a href="#cb208-2527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2528"><a href="#cb208-2528" aria-hidden="true" tabindex="-1"></a>Jetzt können wir alles nochmal so bauen, dass wir keinen konstanten Shift von $+0.7$ auf der Logitskala haben, sondern eben einen Shift für jede Antwortkategorie. Mehr dazu dann auch im Blogeintrag <span class="co">[</span><span class="ot">simstudy update: ordinal data generation that violates proportionality</span><span class="co">](https://www.rdatagen.net/post/2022-01-25-simstudy-update-ordinal-data-without-the-proportionality-assumption/)</span>. Wir brauchen dann wieder unser einfaktorielles Design mit der latenten Variable. Wir geben hier dann keinen Shift an, da wir ja gleich individuelle Shifts in der Antwortkategorien haben wollen.</span>
<span id="cb208-2529"><a href="#cb208-2529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2532"><a href="#cb208-2532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2533"><a href="#cb208-2533" aria-hidden="true" tabindex="-1"></a>ord_fac1_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"f_a"</span>, <span class="at">formula =</span> <span class="st">"1;1"</span>, <span class="at">dist =</span> <span class="st">"trtAssign"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2534"><a href="#cb208-2534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"z"</span>, <span class="at">formula =</span> <span class="st">"0"</span>, <span class="at">dist =</span> <span class="st">"nonrandom"</span>)</span>
<span id="cb208-2535"><a href="#cb208-2535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2536"><a href="#cb208-2536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2537"><a href="#cb208-2537" aria-hidden="true" tabindex="-1"></a>Dann einmal die Daten mit der latenten Variable genieren. Aktuell brauchen wir die latente Variable $z$ nur als einen Platzhalter.</span>
<span id="cb208-2538"><a href="#cb208-2538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2541"><a href="#cb208-2541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2542"><a href="#cb208-2542" aria-hidden="true" tabindex="-1"></a>ord_fac1_pre_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">25000</span>, ord_fac1_def) </span>
<span id="cb208-2543"><a href="#cb208-2543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2544"><a href="#cb208-2544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2545"><a href="#cb208-2545" aria-hidden="true" tabindex="-1"></a>Dann legen wir die individuellen Shifts für die Antwortkategorien fest. Hier ist nochmal wichtig, dass der letzte Wert eine Null ist. Wir verschieben ja nur drei Grenzwerte für die vier Antwortkategorien. Die Funktionen brauchen aber einen entsprechend langen Vektor.</span>
<span id="cb208-2546"><a href="#cb208-2546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2549"><a href="#cb208-2549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2550"><a href="#cb208-2550" aria-hidden="true" tabindex="-1"></a>shift_z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.0</span>, <span class="sc">-</span><span class="fl">1.7</span>, <span class="dv">0</span>)</span>
<span id="cb208-2551"><a href="#cb208-2551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2552"><a href="#cb208-2552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2553"><a href="#cb208-2553" aria-hidden="true" tabindex="-1"></a>Dann können wir uns auch schon die Daten zusammenbauen und nutzen die Option <span class="in">`npAdj`</span> um unsere individuellen Verschiebungen in den $z$-Werten anzugeben.</span>
<span id="cb208-2554"><a href="#cb208-2554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2557"><a href="#cb208-2557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2558"><a href="#cb208-2558" aria-hidden="true" tabindex="-1"></a>ord_fac1_nonprop_dt <span class="ot">&lt;-</span> <span class="fu">genOrdCat</span>(ord_fac1_pre_dt, <span class="at">baseprobs =</span> null_prob, <span class="at">adjVar =</span> <span class="st">"z"</span>,</span>
<span id="cb208-2559"><a href="#cb208-2559" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">catVar =</span> <span class="st">"antwort"</span>, <span class="at">npVar =</span> <span class="st">"f_a"</span>, <span class="at">npAdj =</span> shift_z) <span class="sc">|&gt;</span> </span>
<span id="cb208-2560"><a href="#cb208-2560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">antwort =</span> <span class="fu">factor</span>(antwort, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span>, <span class="st">"trifft nicht zu"</span>,</span>
<span id="cb208-2561"><a href="#cb208-2561" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">"trifft zu"</span>, <span class="st">"trifft voll zu"</span>)),</span>
<span id="cb208-2562"><a href="#cb208-2562" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A.1"</span>, <span class="st">"A.2"</span>)))</span>
<span id="cb208-2563"><a href="#cb208-2563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2564"><a href="#cb208-2564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2565"><a href="#cb208-2565" aria-hidden="true" tabindex="-1"></a>Wir können dann wie schon in dem ersten Tab einmal unsere kleinere Stichprobe aus den Daten hier ziehen. Am Ende ist die Frage, ob wir sowas überhaupt brauchen, wenn wir uns Spieldaten für die Analyse erstellen wollen. Es ist sehr schwer auf dem Logit die Verschiebungen nachzuvollziehen. Daher würde ich es bei den *Proportional odds* belassen. Es ist aber eine nette Fingerübung für das Verständnis. Die Verschiebung um einen festen Wert in den Antwortkategorien ist auch eine starke Annahme.</span>
<span id="cb208-2566"><a href="#cb208-2566" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-2567"><a href="#cb208-2567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2568"><a href="#cb208-2568" aria-hidden="true" tabindex="-1"></a>Dann stellt sich noch die Frage, ob wir denn auch die voreingestellten Parameter wieder aus einer ordinalen Regression herausbekommen. Dafür nutzen wir die folgende Formel. Dabei ist wichtig, dass wir eben hier auch das Minus sehen, was wir oben bei der Erstellung der Daten beachten mussten. Der Effekt ist ja die Verschiebung um $+0.7$ durch die latente Variable. Wir sehen dann aber hier den Schätzer $\beta$ für den Effekt mit einem Minuszeichen versehen. So ist eben der Algorithmus und die Modellierung. Wir wollen hier in der Formel den Effekt für das zweite Level $A.2$ bestimmen. Wir haben vier Antwortkategorien, also erhalten wir dann drei Grenzwerte $i$ aus dem ordinalen Modell zurück.</span>
<span id="cb208-2569"><a href="#cb208-2569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2570"><a href="#cb208-2570" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-2571"><a href="#cb208-2571" aria-hidden="true" tabindex="-1"></a>log \left(\cfrac{Pr(Antwort \leq  i)}{Pr(Antwort &gt; i)} | f_A \right) = \alpha_i - \beta*I(f_A=A.2)  \ , \ i \in <span class="sc">\{</span>1, 2, 3<span class="sc">\}</span></span>
<span id="cb208-2572"><a href="#cb208-2572" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-2573"><a href="#cb208-2573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2574"><a href="#cb208-2574" aria-hidden="true" tabindex="-1"></a>Wir nutzen jetzt gleich die Funktion <span class="in">`clm()`</span> aus dem R Paket <span class="in">`{ordinal}`</span> für die Analyse der Daten. In diesem Zusammenhang möchte ich nochmal auf die Arbeit von @gambarota2024ordinal mit dem Titel <span class="co">[</span><span class="ot">Ordinal regression models made easy: A tutorial on parameter interpretation, data simulation and power analysis</span><span class="co">](https://onlinelibrary.wiley.com/doi/full/10.1002/ijop.13243)</span> verweisen. Hier geht es ja erstmal nur kurz darum zu schauen, ob wir die voreingestellten Werte auch wiederfinden. Die ordinale Regression hat ja noch ihr eigenes Kapitel. Wir bauen uns also das Modell wie folgt.</span>
<span id="cb208-2575"><a href="#cb208-2575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2578"><a href="#cb208-2578" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2579"><a href="#cb208-2579" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-2580"><a href="#cb208-2580" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-2581"><a href="#cb208-2581" aria-hidden="true" tabindex="-1"></a>clmFit <span class="ot">&lt;-</span> <span class="fu">clm</span>(antwort <span class="sc">~</span> f_a, <span class="at">data =</span> ord_fac1_dt)</span>
<span id="cb208-2582"><a href="#cb208-2582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2583"><a href="#cb208-2583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2584"><a href="#cb208-2584" aria-hidden="true" tabindex="-1"></a>Dann können wir uns auch schon die Zusammenfassung des Modells angeben lassen. Ich nutze hier nur die <span class="in">`coef()`</span> Funktion, da ich nicht an p-Werten oder anderem interessiert bin. Dafür würde dann die <span class="in">`summary()`</span> gebraucht. Da wir ja auf den vollen Daten rechnen, kommt hier auch was passendes raus. Aber auch hier haben wir dann eine leichte Abweichung, was eben dann auch bei generierten Daten vorkommen kann.</span>
<span id="cb208-2585"><a href="#cb208-2585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2588"><a href="#cb208-2588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2589"><a href="#cb208-2589" aria-hidden="true" tabindex="-1"></a>clm_coef <span class="ot">&lt;-</span> clmFit <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-2590"><a href="#cb208-2590" aria-hidden="true" tabindex="-1"></a>clm_coef </span>
<span id="cb208-2591"><a href="#cb208-2591" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2592"><a href="#cb208-2592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2593"><a href="#cb208-2593" aria-hidden="true" tabindex="-1"></a>Damit ist der z-Wert mit $(-1) \cdot -0.69 \approx +0.7$ gut getroffen. Die Antwortwahrscheinlichkeiten sind auf dem Logit eben um 0.7 verschoben. Dann erhalten wir noch die Grenzwerte wieder, die wir dann auch nochmal in die entsprechenden Wahrscheinlichkeiten der Antworten umrechnen können. Hier brauchen wir dann natürlich nur die ersten drei Werte der Koeffizienten auswählen.</span>
<span id="cb208-2594"><a href="#cb208-2594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2597"><a href="#cb208-2597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2598"><a href="#cb208-2598" aria-hidden="true" tabindex="-1"></a><span class="fu">logodds_to_prob</span>(clm_coef[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb208-2599"><a href="#cb208-2599" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2600"><a href="#cb208-2600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2601"><a href="#cb208-2601" aria-hidden="true" tabindex="-1"></a>Passt doch alles super. Wir erhalten die voreingestellten Wahrscheinlichkeiten unseres Nullmodells wieder. Dann noch die Verschiebung durch den z-Wert auch korrekt wiedergegeben. Damit haben wir dann die Grundlagen gut verstanden. Wir können jetzt nochmal etwas komplexere Modelle angehen.</span>
<span id="cb208-2602"><a href="#cb208-2602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2603"><a href="#cb208-2603" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktoriell $f_A$ mit \&gt;2 Leveln {.unnumbered .unlisted}</span></span>
<span id="cb208-2604"><a href="#cb208-2604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2605"><a href="#cb208-2605" aria-hidden="true" tabindex="-1"></a>Wenn du jetzt mehr Levle oder Gruppen in deinen Faktor simulieren willst, dann kannst du einfach in der Option <span class="in">`formula`</span> mehr Gruppen durch das Semikolon <span class="in">`;`</span> getrennt erschaffen. Wenn du immer eine <span class="in">`1`</span> schreibst, dann haben alle die gleiche Gruppengröße. Je mehr Faktoren du hast, desto kleiner sollte natürlich der Effekt der latenten Variable sein.</span>
<span id="cb208-2606"><a href="#cb208-2606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2609"><a href="#cb208-2609" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2610"><a href="#cb208-2610" aria-hidden="true" tabindex="-1"></a>ord_fac1_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"f_a"</span>, <span class="at">formula =</span> <span class="st">"1;1;1"</span>, <span class="at">dist =</span> <span class="st">"trtAssign"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2611"><a href="#cb208-2611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"z"</span>, <span class="at">formula =</span> <span class="st">"-0.7*f_a"</span>, <span class="at">dist =</span> <span class="st">"nonrandom"</span>)</span>
<span id="cb208-2612"><a href="#cb208-2612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2613"><a href="#cb208-2613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2614"><a href="#cb208-2614" aria-hidden="true" tabindex="-1"></a>Dann brauchen wir wieder die Daten einmal aus denen wir dann gleich die Stichprobe ziehen.</span>
<span id="cb208-2615"><a href="#cb208-2615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2618"><a href="#cb208-2618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2619"><a href="#cb208-2619" aria-hidden="true" tabindex="-1"></a>ord_fac1_pre_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">25000</span>, ord_fac1_def)</span>
<span id="cb208-2620"><a href="#cb208-2620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2621"><a href="#cb208-2621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2622"><a href="#cb208-2622" aria-hidden="true" tabindex="-1"></a>Im Folgenden musst du nur einmal darauf achten, dass du dann auch mehr Level hast und dann eben auch mehr Labels vergeben musst. Hier habe ich ja dann drei Level also muss ich auch drei Level vergeben. Ich übernehme hier einmal die Antwortwahrscheinlichkeiten <span class="in">`null_prob`</span> aus der obigen Erstellung der Daten.</span>
<span id="cb208-2623"><a href="#cb208-2623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2626"><a href="#cb208-2626" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2627"><a href="#cb208-2627" aria-hidden="true" tabindex="-1"></a>ord_fac1_dt <span class="ot">&lt;-</span> <span class="fu">genOrdCat</span>(ord_fac1_pre_dt, <span class="at">adjVar =</span> <span class="st">"z"</span>, null_prob, <span class="at">catVar =</span> <span class="st">"antwort"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2628"><a href="#cb208-2628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">antwort =</span> <span class="fu">factor</span>(antwort, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"trifft gar nicht zu"</span>, <span class="st">"trifft nicht zu"</span>,</span>
<span id="cb208-2629"><a href="#cb208-2629" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">"trifft zu"</span>, <span class="st">"trifft voll zu"</span>)),</span>
<span id="cb208-2630"><a href="#cb208-2630" aria-hidden="true" tabindex="-1"></a>         <span class="at">f_a =</span> <span class="fu">factor</span>(f_a, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A.1"</span>, <span class="st">"A.2"</span>, <span class="st">"A.3"</span>)))</span>
<span id="cb208-2631"><a href="#cb208-2631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2632"><a href="#cb208-2632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2633"><a href="#cb208-2633" aria-hidden="true" tabindex="-1"></a>Dann können wir uns wieder die Stichprobe ziehen. Damit hier die Ausgabe nicht so groß ist, habe ich dann nur drei Beobachtungen pro Gruppe gezogen. Das macht natürlich nur begrenz Sinn. Wie du auch schon siehst, kommen dann kaum Antwortmöglichkeiten vor.</span>
<span id="cb208-2634"><a href="#cb208-2634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2637"><a href="#cb208-2637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2638"><a href="#cb208-2638" aria-hidden="true" tabindex="-1"></a>ord_fac1_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-2639"><a href="#cb208-2639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(f_a) <span class="sc">|&gt;</span> </span>
<span id="cb208-2640"><a href="#cb208-2640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">3</span>)</span>
<span id="cb208-2641"><a href="#cb208-2641" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2642"><a href="#cb208-2642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2643"><a href="#cb208-2643" aria-hidden="true" tabindex="-1"></a>Somit haben wir dann auch die Möglichkeit mehr Gruppen zu simulieren. Hier musst du dann immer schauen, dass der Effekt nicht zu groß wird. Sonst schiebst du den letzten Faktor zu weit nach rechts in der Verteilung und es bleibt keine Fläche mehr als Wahrscheinlichkeit übrig. Das ist immer so eien Sache bei den ordinalen Messwerten. Wir sind eben beschränkt in beide Seiten.</span>
<span id="cb208-2644"><a href="#cb208-2644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2645"><a href="#cb208-2645" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb208-2646"><a href="#cb208-2646" aria-hidden="true" tabindex="-1"></a><span class="fu">## Oder doch die Binomialverteilung?</span></span>
<span id="cb208-2647"><a href="#cb208-2647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2648"><a href="#cb208-2648" aria-hidden="true" tabindex="-1"></a>Eine weitere Möglichkeit sich ordinale Messdaten zu generieren ist die Binomialverteilung. Hier können wir auswählen, wie viele Ausprägungen wir in dem Messwert haben wollen. Hierbei ist aber anzumerken, dass wir die Varianz nicht steuern können. Wir legen mehr oder minder den Mittelwert fest und dann ergibt sich der Rest. Also was ist die mittlere Note und dann streuen die Werte mit einem fixen Wert um den Mittelwert. Wir bauen uns hier auch erstmal wieder unser Faktorenraster um es dann mit den binomiaen Daten zu ergänzen.</span>
<span id="cb208-2649"><a href="#cb208-2649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2652"><a href="#cb208-2652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2653"><a href="#cb208-2653" aria-hidden="true" tabindex="-1"></a>fac1_dt <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb208-2654"><a href="#cb208-2654" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2655"><a href="#cb208-2655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span>
<span id="cb208-2656"><a href="#cb208-2656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2657"><a href="#cb208-2657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2658"><a href="#cb208-2658" aria-hidden="true" tabindex="-1"></a>Hier kommt dann die Besonderheit. Wir legen mit der Option <span class="in">`variance`</span> die Anzahl an Ausprägungen in unserem Messwert fest. Wir wollen hier neuen Noten simulieren, also legen wir den Wert der Varianz auf acht, da wir mit der Null beginnen zu zählen. Wir haben dann einen Effekt von $+0.2$ in dem Faktor vorliegen. Der Effekt muss zwischen $0$ und $1$ liegen oder andersherum, am Ende dürfen keien Werte größer als Eins in der <span class="in">`formula`</span> entstehen.</span>
<span id="cb208-2659"><a href="#cb208-2659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2662"><a href="#cb208-2662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2663"><a href="#cb208-2663" aria-hidden="true" tabindex="-1"></a>y_binom_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"bonitur"</span>, <span class="at">formula =</span> <span class="st">"0 + 0.2 * f_a"</span>,</span>
<span id="cb208-2664"><a href="#cb208-2664" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dist =</span> <span class="st">"binomial"</span>, <span class="at">variance =</span> <span class="dv">8</span>, <span class="at">link =</span> <span class="st">"identity"</span>)</span>
<span id="cb208-2665"><a href="#cb208-2665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2666"><a href="#cb208-2666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2667"><a href="#cb208-2667" aria-hidden="true" tabindex="-1"></a>Dann ergänzen wir einmal den Faktorenraster um die Datendefinition und erhöhen einmal die Bonitur um einen Wert, damit wir dann die Noten auch von Null bis Neun vorliegen haben.</span>
<span id="cb208-2668"><a href="#cb208-2668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2671"><a href="#cb208-2671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2672"><a href="#cb208-2672" aria-hidden="true" tabindex="-1"></a>binom_fac1_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(y_binom_def, fac1_dt) <span class="sc">|&gt;</span> </span>
<span id="cb208-2673"><a href="#cb208-2673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bonitur =</span> bonitur <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb208-2674"><a href="#cb208-2674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2675"><a href="#cb208-2675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2676"><a href="#cb208-2676" aria-hidden="true" tabindex="-1"></a>Dann können wir uns die Daten auch einmal als Tabelle anschauen.</span>
<span id="cb208-2677"><a href="#cb208-2677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2680"><a href="#cb208-2680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2681"><a href="#cb208-2681" aria-hidden="true" tabindex="-1"></a>binom_fac1_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-2682"><a href="#cb208-2682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(f_a, bonitur) </span>
<span id="cb208-2683"><a href="#cb208-2683" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2684"><a href="#cb208-2684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2685"><a href="#cb208-2685" aria-hidden="true" tabindex="-1"></a>Wir sehen hier also ganz gut, wie sich die Noten um eine mittlere Note gruppieren und dann eben streuen. Wir können die Streuung nicht anpassen, so dass hier eventuell nicht das rauskommt, was wir möchten. Eine Alternative ist es aber allemal und daher hier einmal erwähnt.</span>
<span id="cb208-2686"><a href="#cb208-2686" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-2687"><a href="#cb208-2687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2688"><a href="#cb208-2688" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mehrfaktorielles Design {.unnumbered .unlisted}</span></span>
<span id="cb208-2689"><a href="#cb208-2689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2690"><a href="#cb208-2690" aria-hidden="true" tabindex="-1"></a>Ich lasse hier auch einmal das mehrfaktorielle Design offen. Zwar liegt mit @gambarota2024ordinal und der Arbeit <span class="co">[</span><span class="ot">Ordinal regression models made easy: A tutorial on parameter interpretation, data simulation and power analysis</span><span class="co">](https://onlinelibrary.wiley.com/doi/full/10.1002/ijop.13243)</span> R Code vor, den du nutzen kannst um auch komplexere ordinale Daten zu modellieren, aber ist der R Code nur über <span class="co">[</span><span class="ot">GitHub \| `{ordinalsim}`</span><span class="co">](https://github.com/shared-research/ordinalsim)</span> zu erreichen. Das Laden ist aber etwas komplizierter und am Ende ist die Frage, ob wir das auch wollen. Du kannst dir gerne die Arbeit anschauen. Wir machen hier einmal für das Erste Schluss.</span>
<span id="cb208-2691"><a href="#cb208-2691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2692"><a href="#cb208-2692" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kovariates Design {.unnumbered .unlisted}</span></span>
<span id="cb208-2693"><a href="#cb208-2693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2694"><a href="#cb208-2694" aria-hidden="true" tabindex="-1"></a>Machen wir es kurz, wir betrachten hier nicht ein kovariates Design mit einem ordinalen Messwert. Das ergibt für mich keinen wirklichen Sinn. Theoretisch könnten wir eine Kovariate messen und dann schauen, wie sich der ordinale Messwert ändert, aber das würde ich dann eher als Gaussian linear Regression modellieren. Wir nehmen also einfach die mittleren Noten. Das würde dann reichen. Hier jetzt noch für Kovariaten die ordinale Messwerte zu generieren ist zu wild.</span>
<span id="cb208-2695"><a href="#cb208-2695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2696"><a href="#cb208-2696" aria-hidden="true" tabindex="-1"></a><span class="fu">### Binomialverteilt</span></span>
<span id="cb208-2697"><a href="#cb208-2697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2698"><a href="#cb208-2698" aria-hidden="true" tabindex="-1"></a>Kommen wir am Ende noch zu einem binären Messwert oder auch $0/1$-Daten. Binäre Messwerte sind Messwerte, die nur zwei Gruppen beinhalten. Daher ist die Pflanze gesund ($y = 0$) oder krank ($y = 1$). Wir haben also keine kontinuierlichen Messwerte vorliegen sondern eben nur zwei Kategorien. Wir nennen es dann auch gerne zwei Klassen und damit wäre auch schonmal erklärt, warum wir binäre Daten in der Klassifikation im <span class="co">[</span><span class="ot">Kapitel zum maschinellen Lernen</span><span class="co">](https://jkruppa.github.io/classification-preface.html)</span> nutzen. Gerne werden daher auch $0/1$-Daten generell als Daten für die Prädiktion benutzt. Das ist aber nicht generell der Fall. In den Humanwissenschaften haben wir es fast nur mit $0/1$-Messwerten für die gesunden und kranken Patienten zu tun und daher nutzen wir dort auch gerne die logistische Regression für die Analyse der Daten. In den Agrarwissenschaften ist der binäre Messwert eher selten, da wir wirklich eine Menge an Beobachtungen brauchen um sinnvoll mit einem binären Messwert rechnen zu können. Da wir bei solch einem Messwert auch gerne an Anteile denken können, fragen wir uns dann schnell, wie viel Prozent der Beobachtungen sind krank? Wenn wir da nicht in die höheren zweistelligen Fallzahlen kommen, dann ist ja eine Beobachtung gleich sehr viele Prozentpunkte "wert". Das macht dann meistens wenig Sinn tiefer zu analysieren.</span>
<span id="cb208-2699"><a href="#cb208-2699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2700"><a href="#cb208-2700" aria-hidden="true" tabindex="-1"></a>Die Erstellung von binären Messwerten ist recht mühselig. Zum einen liegt es daran, dass wir ja immer die Anteile an den Einsen vorgeben. Daher sind wir auch in dem Zahlenraum $<span class="co">[</span><span class="ot">0;1</span><span class="co">]</span>$ beschränkt. Die Effekt müssen dann entsprechend klein sein, wenn du viele Level im Faktor hast. Der Vorteil ist aber, dass ich keien Lust habe hundert oder mehr Beobachtungen pro Gruppe mit Null und Eins in Excel zu versehen. Das geht dann hier sehr viel schneller. Da die logistsiche Regression als Analysemethode so eine große Bedeutung in den Humanwissenschaften hat, ist <span class="in">`{simstudy}`</span> sehr um diesen Messwert mit Beispielen gesegnet, wie ich im folgenden Kasten nochmal erwähne.</span>
<span id="cb208-2701"><a href="#cb208-2701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2702"><a href="#cb208-2702" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb208-2703"><a href="#cb208-2703" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Tutorien für die Genierung von binären Daten</span></span>
<span id="cb208-2704"><a href="#cb208-2704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2705"><a href="#cb208-2705" aria-hidden="true" tabindex="-1"></a>Die Folgenden beiden Tutorien helfen nochmal bei der Erstellung von binären Daten. Am Ende ist es immer etwas schwierig Daten mit Effekt in einem 0/1 Raum zu erschaffen. Hier mögest du dann noch mehr Inspiration finden.</span>
<span id="cb208-2706"><a href="#cb208-2706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2707"><a href="#cb208-2707" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Generating binary data by specifying the relative risk, with simulations</span><span class="co">](https://www.rdatagen.net/post/2024-07-02-generating-binary-data-by-specifying-relative-risk/)</span> hier gehen wir nochmal auf das relative Risiko ein. Ein häufiger Effektschätzer in der Epidemiologie und den Humanwissenschaften.</span>
<span id="cb208-2708"><a href="#cb208-2708" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Targeted logistic model coefficients</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/logisticCoefs.html)</span> geht nochmal auf das Problem der transformierten Effekt auf der log-Skala ein. Wir können die Daten auf verschiedene Weise mit Effekten versehen und daher gibt es auch etwas mehr zu Lesen.</span>
<span id="cb208-2709"><a href="#cb208-2709" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-2710"><a href="#cb208-2710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2711"><a href="#cb208-2711" aria-hidden="true" tabindex="-1"></a>Beginnen wollen wir wieder mit einem einfaktoriellen Design mit drei Leveln. Im Prinzip können wir auch nur zwei Level nehmen oder mehr, aber wir haben hier schon eine Menge Text produziert, da lohnt isch dann etwas mehr Kürze. Danach schauen wir uns dann noch den Fall mit einer Kovariaten an, dort können wir dann noch etwas zum Logit und der logistischen Funktion lernen. Die mehrfaktoriellen Fälle lasse ich hier einmal außenvor, dass würde alles noch mehr verkomplizieren. Meistens ist es nämlich das Problem, dass wir nicht in dem Bereich von Null bis Eins in der Formula durch die Effekte bleiben. Dann haben wir auf einmal sehr viele fehlende Werte in unseren binären Messwert. Die Lösung wäre dann alles auf dem Logit zu modellieren, aber das hat dann den nachteil der einfacheren Interpretierbarkeit. Dazu dann aber geich mehr.</span>
<span id="cb208-2712"><a href="#cb208-2712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2713"><a href="#cb208-2713" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktoriell $f_A$ mit \&gt;2 Leveln {.unnumbered .unlisted}</span></span>
<span id="cb208-2714"><a href="#cb208-2714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2715"><a href="#cb208-2715" aria-hidden="true" tabindex="-1"></a>Wir wollen uns hier zwei Wege anschauen uns binäre Messwerte zu erschaffen. Zum einen können wir die Binäreverteilung nutzen. Eigentlich ist die Binäreverteilung nur ein Spezialfall der Binomialverteilung, so dass wir uns dann auch noch gleich die Implementierung in der Binomialverteilung anschauen. Zuerst brauchen wir wieder unser Faktorengrid an dem wir dann die Datendefinition kleben können. Damit wir hier überhaupt etwas sehen, nutze ich wieder zehntausend Beobachtungen pro Faktorlevel.</span>
<span id="cb208-2716"><a href="#cb208-2716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2719"><a href="#cb208-2719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2720"><a href="#cb208-2720" aria-hidden="true" tabindex="-1"></a>fac1_dt <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">f_a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb208-2721"><a href="#cb208-2721" aria-hidden="true" tabindex="-1"></a>                       <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2722"><a href="#cb208-2722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.table</span>()</span>
<span id="cb208-2723"><a href="#cb208-2723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2724"><a href="#cb208-2724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2725"><a href="#cb208-2725" aria-hidden="true" tabindex="-1"></a>Dann können wir die Daten schon auf zwei Wegen zusammenbauen. Dabei würde ich hier einmal die Binäreverteilung vorziehen, denn diese Verteilung macht exakt das was wir wollen. Die Binomialeverteilung ist dann einfach nochmal hier, damit ich auch diese später mal wiederfinde.</span>
<span id="cb208-2726"><a href="#cb208-2726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2727"><a href="#cb208-2727" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb208-2728"><a href="#cb208-2728" aria-hidden="true" tabindex="-1"></a><span class="fu">## Binäreverteilung</span></span>
<span id="cb208-2729"><a href="#cb208-2729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2730"><a href="#cb208-2730" aria-hidden="true" tabindex="-1"></a>Im Folgenden bauen wir uns einmal die binären Messwerte. Hierbei ist wichtig, dass wir uns auf dem Identitylink bewegen. Das heißt, wir definieren einen Intercept als Wahrscheinlichkeit eine Eins zu beobachten und dann den Effekt als Änderung der Wahrscheinlichkeit eine Eins zu beobachten. Daher ist alles was in der <span class="in">`formula`</span>-Option steht der Anteil an Einsen in den entsprechenden Leveln des Faktors. Hier ist es dann noch wichtig, dass die <span class="in">`formula`</span>-Option am Ende immer im Interval $<span class="co">[</span><span class="ot">0;1</span><span class="co">]</span>$ bleibt. Wenn du also drei Faktorlevel hast, die alle einen Effekt von $+0.4$ haben sollen, dann eght es nicht. Denn dann wären wir auch mit einem intercept von Null bei dem dritten Level über Eins. Daher müssen die Effekte bei mehr Leveln auch immer kleiner werden. Wir können hier auch andere Linkfunktionen wählen, dazu dann aber mehr bei der Kovariatensimulation.</span>
<span id="cb208-2731"><a href="#cb208-2731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2734"><a href="#cb208-2734" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2735"><a href="#cb208-2735" aria-hidden="true" tabindex="-1"></a>y_binary_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">formula =</span> <span class="st">"0.2 + 0.2*f_a"</span>,</span>
<span id="cb208-2736"><a href="#cb208-2736" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dist =</span> <span class="st">"binary"</span>, <span class="at">link =</span> <span class="st">"identity"</span>)</span>
<span id="cb208-2737"><a href="#cb208-2737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2738"><a href="#cb208-2738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2739"><a href="#cb208-2739" aria-hidden="true" tabindex="-1"></a>Dann bringen wir einmal das Faktorengrid mit der Datendefinition zusammen und generieren uns die entsprechenden Daten mit den binären Messwerten.</span>
<span id="cb208-2740"><a href="#cb208-2740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2743"><a href="#cb208-2743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2744"><a href="#cb208-2744" aria-hidden="true" tabindex="-1"></a>binary_fac1_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(y_binary_def, fac1_dt)</span>
<span id="cb208-2745"><a href="#cb208-2745" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2746"><a href="#cb208-2746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2747"><a href="#cb208-2747" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns einmal das Ergebnis als Tabelle an. Wir haben in dem ersten Level des Anteil an Einsen des Intercepts, nämlich $0.2$ oder 20% plus den Effekt des ersten Levels mit $+0.2$. Dann haben wir als Effekt ja auch $+0.2$ also immer 20% mehr für jedes Faktorlevel. Bei der hohen Anzahl an Beobachtungen stimmt das auch so sehr gut.</span>
<span id="cb208-2748"><a href="#cb208-2748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2751"><a href="#cb208-2751" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2752"><a href="#cb208-2752" aria-hidden="true" tabindex="-1"></a>binary_fac1_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-2753"><a href="#cb208-2753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(f_a, y) <span class="sc">|&gt;</span> </span>
<span id="cb208-2754"><a href="#cb208-2754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>(<span class="st">"row"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2755"><a href="#cb208-2755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-2756"><a href="#cb208-2756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2757"><a href="#cb208-2757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2758"><a href="#cb208-2758" aria-hidden="true" tabindex="-1"></a>Dann könnten wir wieder unsere Stichprobe aus den riesigen Daten wie schon bei der ordinalverteilten Daten ziehen und damit weiterechnen. Ich würde hier aber immer mit Stichproben nahe Hundert für jede Gruppe rechnen wollen. Bei drei Leveln sollte ich also auch gut dreihundert Beobachtungen in meiner Studie haben. So große Stichproben sind dann in den Agrarwissenschaften eher selten.</span>
<span id="cb208-2759"><a href="#cb208-2759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2760"><a href="#cb208-2760" aria-hidden="true" tabindex="-1"></a><span class="fu">## Binomialverteilung</span></span>
<span id="cb208-2761"><a href="#cb208-2761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2762"><a href="#cb208-2762" aria-hidden="true" tabindex="-1"></a>Eine andere Möglichkeit einen binären Messwert zu erschaffen ist die Binomialverteilung mit einer Varianz von Eins. Damit haben wir dann den Spezialfall der Binärenverteilung vorliegen. Der Weg ist der Gleiche, daher hier nur einmal skizziert.</span>
<span id="cb208-2763"><a href="#cb208-2763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2766"><a href="#cb208-2766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2767"><a href="#cb208-2767" aria-hidden="true" tabindex="-1"></a>y_binom_def <span class="ot">&lt;-</span> <span class="fu">defDataAdd</span>(<span class="at">varname =</span> <span class="st">"infected"</span>, <span class="at">formula =</span> <span class="st">"0 + 0.2 * f_a"</span>,</span>
<span id="cb208-2768"><a href="#cb208-2768" aria-hidden="true" tabindex="-1"></a>                          <span class="at">dist =</span> <span class="st">"binomial"</span>, <span class="at">variance =</span> <span class="dv">1</span>, <span class="at">link =</span> <span class="st">"identity"</span>)</span>
<span id="cb208-2769"><a href="#cb208-2769" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2770"><a href="#cb208-2770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2771"><a href="#cb208-2771" aria-hidden="true" tabindex="-1"></a>Dann bringen wir das Faktorenraster mit der Datendefinition zusammen.</span>
<span id="cb208-2772"><a href="#cb208-2772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2775"><a href="#cb208-2775" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2776"><a href="#cb208-2776" aria-hidden="true" tabindex="-1"></a>binom_fac1_dt <span class="ot">&lt;-</span> <span class="fu">addColumns</span>(y_binom_def, fac1_dt)</span>
<span id="cb208-2777"><a href="#cb208-2777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2778"><a href="#cb208-2778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2779"><a href="#cb208-2779" aria-hidden="true" tabindex="-1"></a>Dann können wir uns die Daten auch einmal als Tabelle anschauen. Auch hier sehen wir dann schön, dass wir die Effekte wiederfinden, die wir eingestellt haben. Hier ist der Intercept dann mal $0%$ und die Anzahl an Einsen in jedem Level entspricht dem kumulativen Effekt der Level von $+0.2$ für jedes Level.</span>
<span id="cb208-2780"><a href="#cb208-2780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2783"><a href="#cb208-2783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2784"><a href="#cb208-2784" aria-hidden="true" tabindex="-1"></a>binom_fac1_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-2785"><a href="#cb208-2785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(f_a, infected) <span class="sc">|&gt;</span> </span>
<span id="cb208-2786"><a href="#cb208-2786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_percentages</span>(<span class="st">"row"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2787"><a href="#cb208-2787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb208-2788"><a href="#cb208-2788" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2789"><a href="#cb208-2789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2790"><a href="#cb208-2790" aria-hidden="true" tabindex="-1"></a>Hier sehen wir dann aber leichte Rundungsabweichungen durch die etwas geringe Anzahl an Beobachtungen. Wenn wir noch mehr Beobachtungen einstellen, dann wird auch die geringe Abweichung verschwinden.</span>
<span id="cb208-2791"><a href="#cb208-2791" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-2792"><a href="#cb208-2792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2793"><a href="#cb208-2793" aria-hidden="true" tabindex="-1"></a>Das war es jetzt auch schon für das faktorielle Design. Wenn du ein zweifaktorielles Design brauchst, dann wird es eben schon sehr viel schwieriger mit den kleinen Effekten damit du in dem Interval $<span class="co">[</span><span class="ot">0;1</span><span class="co">]</span>$ bleibst. Da mache ich dann immer eine Simulation mit der Normalverteilung und versuche mir dann einen Grenzwert so zu bauen, dass ich zwei Gruppen erhalte. Mehr dazu dann am Ende des Abschnitts nochmal in dem Kasten zu der Generierung von binären Messwerten mit der Normalverteilung.</span>
<span id="cb208-2794"><a href="#cb208-2794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2795"><a href="#cb208-2795" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kovariates Design {.unnumbered .unlisted}</span></span>
<span id="cb208-2796"><a href="#cb208-2796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2797"><a href="#cb208-2797" aria-hidden="true" tabindex="-1"></a>Kommen wir nun zu dem kovariaten Design, wo wir dann nochmal etwas genauer auf die Erstellung der binären Daten eingehen können. Wenn unsere Einflussvariable numerisch ist, dann haben wir etwas mehr Möglichkeiten unsere Daten darzustellen und zu verstehen, was dort eigentlich passiert. Wir haben ja jetzt auf der x-Achse nicht nur Kategorien sondern eben eine Kovariate. Das macht dann alles etwas einfacher. Hier können wir dann auf zwei Arten nochmal nachvollziehen, wie wir die Daten bauen. Wir haben die Möglichkeit den *identity*-Link zu wählen. Dann erstellen wir alles mit untransformierten Wahrscheinlichkeiten. Wir sagen, dass wir durch die Kovariate als Effekt $+0.05$ haben wollen und für jede Einheit der Kovariate stiegt die Wahrscheinlichkeit für ein Ereignis ($y =1$) um 5% an. Das ist super zu verstehen. Wir können aber auch die Effekte auf dem *logit*-Link angeben. Dann generieren wir nicht mehr so einfach zu verstehende Effekte. Mehr dazu dann im zweiten Tab.</span>
<span id="cb208-2798"><a href="#cb208-2798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2799"><a href="#cb208-2799" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb208-2800"><a href="#cb208-2800" aria-hidden="true" tabindex="-1"></a><span class="fu">## `link = "idenity"`</span></span>
<span id="cb208-2801"><a href="#cb208-2801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2802"><a href="#cb208-2802" aria-hidden="true" tabindex="-1"></a>Am einfachsten machen wir es uns, wenn wir direkt auf den Wahrscheinlichkeiten die Daten generieren. Daher nehmen wir hier einmal eine normalverteilte Kovariate an und wollen dann mit der Kovariate den binären Messwert generieren. Dabei haben wir einen Mittelwert von Null für die Kovariate angenommen. Der Effekt kann jetzt direkt als Wahrscheinlichkeit interpretiert werden. Daher haben wir als Intercept 50% Wahrscheinlichkeit eine Eins in dem Messwert zu beobachten. Je Einheit Kovariate steigt die Wahrscheinlichkeit dann um $+0.15$ an.</span>
<span id="cb208-2803"><a href="#cb208-2803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2806"><a href="#cb208-2806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2807"><a href="#cb208-2807" aria-hidden="true" tabindex="-1"></a>cov1_binary_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"c_1"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, <span class="at">formula =</span> <span class="st">"0"</span>,</span>
<span id="cb208-2808"><a href="#cb208-2808" aria-hidden="true" tabindex="-1"></a>                           <span class="at">variance =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2809"><a href="#cb208-2809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">formula =</span> <span class="st">"0.5 + 0.15*c_1"</span>,</span>
<span id="cb208-2810"><a href="#cb208-2810" aria-hidden="true" tabindex="-1"></a>          <span class="at">dist =</span> <span class="st">"binary"</span>, <span class="at">link =</span> <span class="st">"identity"</span>)</span>
<span id="cb208-2811"><a href="#cb208-2811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2812"><a href="#cb208-2812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2813"><a href="#cb208-2813" aria-hidden="true" tabindex="-1"></a>Dann bauen wir uns einmal die Daten damit wir gleich einmal in der Abbildung schauen können, wie sich die Messwerte dann verteilen.</span>
<span id="cb208-2814"><a href="#cb208-2814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2817"><a href="#cb208-2817" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2818"><a href="#cb208-2818" aria-hidden="true" tabindex="-1"></a>cov1_binary_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">1000</span>, cov1_binary_def)</span>
<span id="cb208-2819"><a href="#cb208-2819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2820"><a href="#cb208-2820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2821"><a href="#cb208-2821" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung können wir uns einmal die Daten und die entsprechenden Effekte anschauen. Die Grade entspricht einer linearen Regression durch die Punktewolke. Wir sehen hier sehr schön, dass wir die voreingestellten Werte aus unserer Simulation wiederfinden. Dafür haben wir hier aber den Nachteil, dass die Grade über die Null und Eins hinausschießen kann. Jetzt können wir natürlich auch sagen, dass wir ja eigentlich eine logistische Regression rechnen würden. Das machen wir auch gleich mal.</span>
<span id="cb208-2822"><a href="#cb208-2822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2825"><a href="#cb208-2825" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2826"><a href="#cb208-2826" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-2827"><a href="#cb208-2827" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-2828"><a href="#cb208-2828" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb208-2829"><a href="#cb208-2829" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-2830"><a href="#cb208-2830" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-2831"><a href="#cb208-2831" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb208-2832"><a href="#cb208-2832" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-2833"><a href="#cb208-2833" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Kovariate und den binären Messwert. Die Regressionsgleichung ist ergänzt und entspricht den voreingestellten Werten. Die Modellierung erfolgt hier über eine lineare Regression. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-2834"><a href="#cb208-2834" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-binomial-01</span></span>
<span id="cb208-2835"><a href="#cb208-2835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2836"><a href="#cb208-2836" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cov1_binary_dt, <span class="fu">aes</span>(c_1, y)) <span class="sc">+</span></span>
<span id="cb208-2837"><a href="#cb208-2837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-2838"><a href="#cb208-2838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb208-2839"><a href="#cb208-2839" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb208-2840"><a href="#cb208-2840" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="st">"eq"</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb208-2841"><a href="#cb208-2841" aria-hidden="true" tabindex="-1"></a>               <span class="at">label.y =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb208-2842"><a href="#cb208-2842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Binärer Messwert (Y)"</span>, <span class="at">x =</span> <span class="st">"Kovariate"</span>) </span>
<span id="cb208-2843"><a href="#cb208-2843" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb208-2844"><a href="#cb208-2844" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2845"><a href="#cb208-2845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2846"><a href="#cb208-2846" aria-hidden="true" tabindex="-1"></a>Wir können uns auch einmal die Modellanpassung mit einer logistischen Regression anschauen. Dafür müsse wir dann erstmal die logistische Regression mit der Funktion <span class="in">`glm()`</span> rechnen.</span>
<span id="cb208-2847"><a href="#cb208-2847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2850"><a href="#cb208-2850" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2851"><a href="#cb208-2851" aria-hidden="true" tabindex="-1"></a>log_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> c_1, cov1_binary_dt, <span class="at">family =</span> binomial)</span>
<span id="cb208-2852"><a href="#cb208-2852" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2853"><a href="#cb208-2853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2854"><a href="#cb208-2854" aria-hidden="true" tabindex="-1"></a>Jetzt können wir die Ergebnisse der Regression direkt einmal in die Punktewolke abbilden. Der große Vorteil ist, dass wir die Grade jetzt dank der logistsichen Transformation innerhalb der Modellierung der logistischen Regression jetzt zwischen Null und Eins bleibt. Dafür haben wir jetzt aber nicht direkt die *logistischen* Effekte modelliert. Deshalb bietet sich im anderen Tab noch die Generierung mit logistischen Effekten an.</span>
<span id="cb208-2855"><a href="#cb208-2855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2858"><a href="#cb208-2858" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2859"><a href="#cb208-2859" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-2860"><a href="#cb208-2860" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-2861"><a href="#cb208-2861" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb208-2862"><a href="#cb208-2862" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-2863"><a href="#cb208-2863" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-2864"><a href="#cb208-2864" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb208-2865"><a href="#cb208-2865" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-2866"><a href="#cb208-2866" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Kovariate und den binären Messwert. Die Modellierung erfolgt hier über eine logistische Regression. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-2867"><a href="#cb208-2867" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-binomial-02</span></span>
<span id="cb208-2868"><a href="#cb208-2868" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cov1_binary_dt, <span class="fu">aes</span>(c_1, y)) <span class="sc">+</span></span>
<span id="cb208-2869"><a href="#cb208-2869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-2870"><a href="#cb208-2870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb208-2871"><a href="#cb208-2871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(log_fit, <span class="at">type =</span> <span class="st">"response"</span>))) <span class="sc">+</span></span>
<span id="cb208-2872"><a href="#cb208-2872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Binärer Messwert (Y)"</span>, <span class="at">x =</span> <span class="st">"Kovariate"</span>) </span>
<span id="cb208-2873"><a href="#cb208-2873" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2874"><a href="#cb208-2874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2875"><a href="#cb208-2875" aria-hidden="true" tabindex="-1"></a><span class="fu">## `link = "logit"`</span></span>
<span id="cb208-2876"><a href="#cb208-2876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2877"><a href="#cb208-2877" aria-hidden="true" tabindex="-1"></a>Es ist natürlich etwas blöd, wenn wir die Daten auf der Basis einer linearen Regression abbilden und dann über die logistische Regression auswerten wollen. Da wäre es ja besser, wenn wir direkt auf der logistischen Transformation unseren Messwert generieren. Hier gibt es auch die Vingette <span class="co">[</span><span class="ot">Simulate data from a logistic regression model: How the intercept parameter affects the probability of the event</span><span class="co">](https://blogs.sas.com/content/iml/2023/01/16/simulate-logistic-intercept.html)</span>, die etwas genauer auf das Problem eingeht. Am Ende wählen wir hier die Option <span class="in">`link = "logit"`</span> um unsere Messwerte mit dem Effekt auf dem Logit zu generieren. Das macht die Interpretation um einiges schwerer bis unmöglich. Wir müssen hier dann also rumprobieren, bis alles passt.</span>
<span id="cb208-2878"><a href="#cb208-2878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2881"><a href="#cb208-2881" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2882"><a href="#cb208-2882" aria-hidden="true" tabindex="-1"></a>cov1_binary_def <span class="ot">&lt;-</span> <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"c_1"</span>, <span class="at">dist =</span> <span class="st">"normal"</span>, <span class="at">formula =</span> <span class="st">"0"</span>,</span>
<span id="cb208-2883"><a href="#cb208-2883" aria-hidden="true" tabindex="-1"></a>                           <span class="at">variance =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2884"><a href="#cb208-2884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">defData</span>(<span class="at">varname =</span> <span class="st">"y"</span>, <span class="at">formula =</span> <span class="st">"0 + 1.5*c_1"</span>,</span>
<span id="cb208-2885"><a href="#cb208-2885" aria-hidden="true" tabindex="-1"></a>          <span class="at">dist =</span> <span class="st">"binary"</span>, <span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb208-2886"><a href="#cb208-2886" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2887"><a href="#cb208-2887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2888"><a href="#cb208-2888" aria-hidden="true" tabindex="-1"></a>Dann können wir auch einmal die Daten generieren und uns anschauen, wie sich die Messwerte ergeben. Ich generiere hier einmal richtig viele Beobachtungen, damit wir auch gleich was sehen und nicht zu viel Rauschen in den Daten haben.</span>
<span id="cb208-2889"><a href="#cb208-2889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2892"><a href="#cb208-2892" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2893"><a href="#cb208-2893" aria-hidden="true" tabindex="-1"></a>cov1_binary_dt <span class="ot">&lt;-</span> <span class="fu">genData</span>(<span class="dv">100000</span>, cov1_binary_def)</span>
<span id="cb208-2894"><a href="#cb208-2894" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2895"><a href="#cb208-2895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2896"><a href="#cb208-2896" aria-hidden="true" tabindex="-1"></a>Der folgende Gedankengang ist eher etwas wild, aber er hilft vielleicht sich die Sachlage nochmal zu veranschaulichen. Rein statistisch gesehen überfahren wir hier einen statistischen Engel, aber so richtig. Mir hat es aber nochmal geholfen eine Idee dafür zu entwicklen, was diese logistische Transfomation sein soll und wie diese stattfindet. Wir können jetzt einmal die Kovariate $c_1$ in zehn gleichmäßige Stücke oder Intervalle teilen. Für jedes dieser Intervalle berechnen wir dann den Anteil an Einsen und addieren einen kleinen Fehler drauf. Am Ende können wir dann die logistische Transformation rechnen.</span>
<span id="cb208-2897"><a href="#cb208-2897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2900"><a href="#cb208-2900" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2901"><a href="#cb208-2901" aria-hidden="true" tabindex="-1"></a>cov1_binary_logit_dt <span class="ot">&lt;-</span> cov1_binary_dt <span class="sc">|&gt;</span> </span>
<span id="cb208-2902"><a href="#cb208-2902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c_1_bin =</span> <span class="fu">cut</span>(c_1, <span class="at">breaks =</span> <span class="dv">10</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb208-2903"><a href="#cb208-2903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(c_1_bin) <span class="sc">|&gt;</span> </span>
<span id="cb208-2904"><a href="#cb208-2904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_y =</span> <span class="fu">round</span>(<span class="fu">mean</span>(y), <span class="dv">2</span>) <span class="sc">+</span> <span class="fl">0.001</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-2905"><a href="#cb208-2905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_y =</span> <span class="fu">ifelse</span>(mean_y <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="fl">0.999</span>, mean_y), </span>
<span id="cb208-2906"><a href="#cb208-2906" aria-hidden="true" tabindex="-1"></a>         <span class="at">lower =</span> <span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">((.+),.*"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, c_1_bin)),</span>
<span id="cb208-2907"><a href="#cb208-2907" aria-hidden="true" tabindex="-1"></a>         <span class="at">upper =</span> <span class="fu">as.numeric</span>( <span class="fu">sub</span>(<span class="st">"[^,]*,([^]]*)</span><span class="sc">\\</span><span class="st">]"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, c_1_bin)),</span>
<span id="cb208-2908"><a href="#cb208-2908" aria-hidden="true" tabindex="-1"></a>         <span class="at">mid =</span> (lower <span class="sc">+</span> upper)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb208-2909"><a href="#cb208-2909" aria-hidden="true" tabindex="-1"></a>         <span class="at">logistic =</span> <span class="fu">plogis</span>(mean_y))</span>
<span id="cb208-2910"><a href="#cb208-2910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2911"><a href="#cb208-2911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2912"><a href="#cb208-2912" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du einmal das Ergebnis. Wir haben hier die logistsiche Transformation von den Wahrscheinlichkeiten eine Eins zu beobachten einmal für das Beispiel einer Kovariate dargestellt. So ergibt sich dann auch die charakteristische S-Kurve der logistischen Regression.</span>
<span id="cb208-2913"><a href="#cb208-2913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2916"><a href="#cb208-2916" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2917"><a href="#cb208-2917" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-2918"><a href="#cb208-2918" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-2919"><a href="#cb208-2919" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb208-2920"><a href="#cb208-2920" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-2921"><a href="#cb208-2921" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-2922"><a href="#cb208-2922" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb208-2923"><a href="#cb208-2923" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-2924"><a href="#cb208-2924" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Logistische Transformation für die Wahrscheinlichkeit eine Eins zu beobachten pro Intervall der Kovariate. Es ergibt sich eine klassiche S-Kurve. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-2925"><a href="#cb208-2925" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-binomial-theo</span></span>
<span id="cb208-2926"><a href="#cb208-2926" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cov1_binary_logit_dt, <span class="fu">aes</span>(mid, logistic)) <span class="sc">+</span></span>
<span id="cb208-2927"><a href="#cb208-2927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-2928"><a href="#cb208-2928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb208-2929"><a href="#cb208-2929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span></span>
<span id="cb208-2930"><a href="#cb208-2930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Logistische Transformation"</span>, <span class="at">x =</span> <span class="st">"Mittelwert der Kovariate pro Intervall"</span>) <span class="sc">+</span></span>
<span id="cb208-2931"><a href="#cb208-2931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>)</span>
<span id="cb208-2932"><a href="#cb208-2932" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2933"><a href="#cb208-2933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2934"><a href="#cb208-2934" aria-hidden="true" tabindex="-1"></a>Dann hier nochmal die Abbildung für die normale Regression mit der Annahme der Normalverteilung. In diesem Fall schießt die Gerade über das Intervall hinaus. Wir haben damit dann auch Werte kleiner als Null und größer als Eins vorhergesagt. Die Gradengleichung ist dann aber hier auf dem *Identity*-Link wie in dem vorherigen Tab.</span>
<span id="cb208-2935"><a href="#cb208-2935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2938"><a href="#cb208-2938" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2939"><a href="#cb208-2939" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-2940"><a href="#cb208-2940" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-2941"><a href="#cb208-2941" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb208-2942"><a href="#cb208-2942" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-2943"><a href="#cb208-2943" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-2944"><a href="#cb208-2944" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb208-2945"><a href="#cb208-2945" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-2946"><a href="#cb208-2946" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Kovariate und den binären Messwert. Die Regressionsgleichung ist ergänzt und entspricht den voreingestellten Werten. Die Modellierung erfolgt hier über eine lineare Regression. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-2947"><a href="#cb208-2947" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-binomial-03</span></span>
<span id="cb208-2948"><a href="#cb208-2948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2949"><a href="#cb208-2949" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cov1_binary_dt, <span class="fu">aes</span>(c_1, y)) <span class="sc">+</span></span>
<span id="cb208-2950"><a href="#cb208-2950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-2951"><a href="#cb208-2951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb208-2952"><a href="#cb208-2952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb208-2953"><a href="#cb208-2953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="st">"eq"</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">formula =</span> y <span class="sc">~</span> x) <span class="sc">+</span></span>
<span id="cb208-2954"><a href="#cb208-2954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Binärer Messwert (Y)"</span>, <span class="at">x =</span> <span class="st">"Kovariate"</span>) </span>
<span id="cb208-2955"><a href="#cb208-2955" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb208-2956"><a href="#cb208-2956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2957"><a href="#cb208-2957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2958"><a href="#cb208-2958" aria-hidden="true" tabindex="-1"></a>Wir können uns auch einmal die Modellanpassung mit einer logistischen Regression anschauen. Dann erhalten wir auch die echte S-Kurve wiedergeben und nicht unsere obige Annäherung. Dafür müsse wir dann erstmal die logistische Regression mit der Funktion <span class="in">`glm()`</span> rechnen.</span>
<span id="cb208-2959"><a href="#cb208-2959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2962"><a href="#cb208-2962" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2963"><a href="#cb208-2963" aria-hidden="true" tabindex="-1"></a>log_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> c_1, cov1_binary_dt, <span class="at">family =</span> binomial)</span>
<span id="cb208-2964"><a href="#cb208-2964" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2965"><a href="#cb208-2965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2966"><a href="#cb208-2966" aria-hidden="true" tabindex="-1"></a>Jetzt können wir die Ergebnisse der Regression direkt einmal in die Punktewolke abbilden. Der große Vorteil ist, dass wir die Grade jetzt dank der logistsichen Transformation innerhalb der Modellierung der logistischen Regression jetzt zwischen Null und Eins bleibt. Dafür haben wir jetzt aber nicht direkt die *logistischen* Effekte modelliert. Somit haben wir uns beides einmal angeschaut. Was das bessere ist, hängt immer von deiner Fragestellung ab.</span>
<span id="cb208-2967"><a href="#cb208-2967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2970"><a href="#cb208-2970" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-2971"><a href="#cb208-2971" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-2972"><a href="#cb208-2972" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-2973"><a href="#cb208-2973" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb208-2974"><a href="#cb208-2974" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-2975"><a href="#cb208-2975" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-2976"><a href="#cb208-2976" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb208-2977"><a href="#cb208-2977" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-2978"><a href="#cb208-2978" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Kovariate und den binären Messwert. Die Modellierung erfolgt hier über eine logistische Regression. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-2979"><a href="#cb208-2979" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-binomial-04</span></span>
<span id="cb208-2980"><a href="#cb208-2980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2981"><a href="#cb208-2981" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cov1_binary_dt, <span class="fu">aes</span>(c_1, y)) <span class="sc">+</span></span>
<span id="cb208-2982"><a href="#cb208-2982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-2983"><a href="#cb208-2983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb208-2984"><a href="#cb208-2984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(log_fit, <span class="at">type =</span> <span class="st">"response"</span>))) <span class="sc">+</span></span>
<span id="cb208-2985"><a href="#cb208-2985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Binärer Messwert (Y)"</span>, <span class="at">x =</span> <span class="st">"Kovariate"</span>) </span>
<span id="cb208-2986"><a href="#cb208-2986" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-2987"><a href="#cb208-2987" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-2988"><a href="#cb208-2988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2989"><a href="#cb208-2989" aria-hidden="true" tabindex="-1"></a>Zum Abschluss dieses Abschnitts möchte ich nochmal einen kleinen Exkurs über die logistsiche Regression geben. Es ist vielleicht hilfreich sich nochmal mit der Thematik zu beschäftigen. Ich würde aber komplexere kovariate Modelle nicht mehr simulieren, dass wird sehr schnell sehr unübersichtlich. Wenn du die Modelle für die Erstellung neuer Algorithmen brauchst, dann sind wir hier auch nicht ganz richtig. Dafür musst du dann tiefer in <span class="in">`{simstudy}`</span> einsteigen.</span>
<span id="cb208-2990"><a href="#cb208-2990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2991"><a href="#cb208-2991" aria-hidden="true" tabindex="-1"></a>:::: callout-tip</span>
<span id="cb208-2992"><a href="#cb208-2992" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exkurs: *logit* und *logistic* Transformation</span></span>
<span id="cb208-2993"><a href="#cb208-2993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2994"><a href="#cb208-2994" aria-hidden="true" tabindex="-1"></a>Wenn wir uns mir der ordinalen oder aber logistischen Regression beschäftigen dann kommen wir nicht um die <span class="in">`logit()`</span> und <span class="in">`logistic()`</span> Funktionen herum. Beide Funktionen haben als Idee die begrenzten Wahrscheinlichkeiten in dem Zahlenraum $<span class="co">[</span><span class="ot">0;1</span><span class="co">]</span>$ auf $<span class="co">[</span><span class="ot">-Inf;+Inf</span><span class="co">]</span>$ zu transformieren. Hier bietet sich dann eben die <span class="in">`logit()`</span> und <span class="in">`logistic()`</span> Funktionen dafür an. Wie immer gibt es eine Reihe an nützlichen Tutorien, die ich hier mal kurz zusammenstelle. Vieles von dem hier passt dann auch eher in das <span class="co">[</span><span class="ot">Kapitel zur logistischen Regression</span><span class="co">](#sec-logistic)</span> rein.</span>
<span id="cb208-2995"><a href="#cb208-2995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-2996"><a href="#cb208-2996" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das Tutorium zur <span class="co">[</span><span class="ot">logit() and logistic() functions in R</span><span class="co">](https://ro-che.info/articles/2018-08-11-logit-logistic-r)</span> liefert nochmal den Zusammehang zwischen den beiden Transformationen und wie die Funktionen in R heißen.</span>
<span id="cb208-2997"><a href="#cb208-2997" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In dem Artikel <span class="co">[</span><span class="ot">Logistic Regression</span><span class="co">](https://numiqo.com/tutorial/logistic-regression)</span> wird nochmal erklärt, wie die Grundlagen der logistischen Regression lauten. Sehr ausführlich gemacht.</span>
<span id="cb208-2998"><a href="#cb208-2998" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Manchmal möchte man dann doch die logistische Regression per Hand rechnen. Dann hilft das Tutorium zu <span class="co">[</span><span class="ot">Logistic regression (by hand)</span><span class="co">](https://maximilianrohde.com/posts/logistic-regresstion-by-hand/)</span></span>
<span id="cb208-2999"><a href="#cb208-2999" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Noch etwas umfangreicher ist das Tutorium <span class="co">[</span><span class="ot">Logistic Regression Explained from Scratch (Visually, Mathematically and Programmatically)</span><span class="co">](https://towardsdatascience.com/logistic-regression-explained-from-scratch-visually-mathematically-and-programmatically-eb83520fdf9a/)</span>.</span>
<span id="cb208-3000"><a href="#cb208-3000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3001"><a href="#cb208-3001" aria-hidden="true" tabindex="-1"></a>Wir wollen uns jetzt nochmal die beiden Transformationen in den beiden folgenden Tabs nochmal hier anschauen. Damit hast du dann eine Idee, was die beiden Funktionen machen. Im Prinzip verwandelt die *logit*-Funktion Zahlen im begrenzten Wahrscheinlichkeitsraum $<span class="co">[</span><span class="ot">0;1</span><span class="co">]</span>$ in einen faktisch unendlichen Zahlenraum.</span>
<span id="cb208-3002"><a href="#cb208-3002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3003"><a href="#cb208-3003" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb208-3004"><a href="#cb208-3004" aria-hidden="true" tabindex="-1"></a><span class="fu">## *logit* mit `qlogis()`</span></span>
<span id="cb208-3005"><a href="#cb208-3005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3006"><a href="#cb208-3006" aria-hidden="true" tabindex="-1"></a>Der Logit einer Wahrscheinlichkeit $Pr$ ist durch folgende Formel gegeben.</span>
<span id="cb208-3007"><a href="#cb208-3007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3008"><a href="#cb208-3008" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-3009"><a href="#cb208-3009" aria-hidden="true" tabindex="-1"></a>\text{logit}(Pr) = log\left(\cfrac{Pr}{1-Pr}\right)</span>
<span id="cb208-3010"><a href="#cb208-3010" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-3011"><a href="#cb208-3011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3012"><a href="#cb208-3012" aria-hidden="true" tabindex="-1"></a>Wir können den Logit in R mit der Funktion <span class="in">`plogis()`</span> bestimmen.</span>
<span id="cb208-3013"><a href="#cb208-3013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3016"><a href="#cb208-3016" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-3017"><a href="#cb208-3017" aria-hidden="true" tabindex="-1"></a><span class="fu">qlogis</span>(<span class="fl">0.6</span>) <span class="co"># logit</span></span>
<span id="cb208-3018"><a href="#cb208-3018" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-3019"><a href="#cb208-3019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3020"><a href="#cb208-3020" aria-hidden="true" tabindex="-1"></a>Manchmal ist das aber etwas wirr, deshalb hier nochmal die Funktion ausgeschrieben, wie wir die Funktion oben in der mathematischen Formel sehen.</span>
<span id="cb208-3021"><a href="#cb208-3021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3024"><a href="#cb208-3024" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-3025"><a href="#cb208-3025" aria-hidden="true" tabindex="-1"></a>logit <span class="ot">&lt;-</span> \(x) <span class="fu">log</span>(x <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> x))</span>
<span id="cb208-3026"><a href="#cb208-3026" aria-hidden="true" tabindex="-1"></a><span class="fu">logit</span>(<span class="fl">0.6</span>)</span>
<span id="cb208-3027"><a href="#cb208-3027" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-3028"><a href="#cb208-3028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3029"><a href="#cb208-3029" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du einmal die Transformation von Wahrscheinlichkeitswerten in den Logit.</span>
<span id="cb208-3030"><a href="#cb208-3030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3033"><a href="#cb208-3033" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-3034"><a href="#cb208-3034" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-3035"><a href="#cb208-3035" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-3036"><a href="#cb208-3036" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb208-3037"><a href="#cb208-3037" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-3038"><a href="#cb208-3038" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-3039"><a href="#cb208-3039" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb208-3040"><a href="#cb208-3040" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-3041"><a href="#cb208-3041" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Die *logit*-Funktion transformiert eine Wahrscheinlichkeit auf der x-Achse in einen unbegrenzten Zahlenraum auf der y-Achse. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-3042"><a href="#cb208-3042" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-binomial-logit-theo</span></span>
<span id="cb208-3043"><a href="#cb208-3043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3044"><a href="#cb208-3044" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>),</span>
<span id="cb208-3045"><a href="#cb208-3045" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">logit</span>(x)),</span>
<span id="cb208-3046"><a href="#cb208-3046" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb208-3047"><a href="#cb208-3047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-3048"><a href="#cb208-3048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Wahrscheinlichkeit"</span>, <span class="at">y =</span> <span class="st">"Logit()"</span>) <span class="sc">+</span></span>
<span id="cb208-3049"><a href="#cb208-3049" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb208-3050"><a href="#cb208-3050" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-3051"><a href="#cb208-3051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3052"><a href="#cb208-3052" aria-hidden="true" tabindex="-1"></a><span class="fu">## *logistic* oder *invlogit* mit `plogis()`</span></span>
<span id="cb208-3053"><a href="#cb208-3053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3054"><a href="#cb208-3054" aria-hidden="true" tabindex="-1"></a>Die logistsiche Funktion ist durch folgende Formel gegeben. Dabei handelt es sich um die Umkehrfunktion der Logit-Funktion.</span>
<span id="cb208-3055"><a href="#cb208-3055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3056"><a href="#cb208-3056" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-3057"><a href="#cb208-3057" aria-hidden="true" tabindex="-1"></a>\text{logistic}(z) = \cfrac{1}{1 + e^{-z}}</span>
<span id="cb208-3058"><a href="#cb208-3058" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb208-3059"><a href="#cb208-3059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3060"><a href="#cb208-3060" aria-hidden="true" tabindex="-1"></a>Wir können den Logit in R mit der Funktion <span class="in">`qlogis()`</span> bestimmen.</span>
<span id="cb208-3061"><a href="#cb208-3061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3064"><a href="#cb208-3064" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-3065"><a href="#cb208-3065" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(<span class="fl">0.4054651</span>) <span class="co"># logistic</span></span>
<span id="cb208-3066"><a href="#cb208-3066" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-3067"><a href="#cb208-3067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3068"><a href="#cb208-3068" aria-hidden="true" tabindex="-1"></a>Manchmal ist das aber etwas wirr, deshalb hier nochmal die Funktion ausgeschrieben, wie wir die Funktion oben in der mathematischen Formel sehen.</span>
<span id="cb208-3069"><a href="#cb208-3069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3072"><a href="#cb208-3072" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-3073"><a href="#cb208-3073" aria-hidden="true" tabindex="-1"></a>invlogit <span class="ot">&lt;-</span> \(z) <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>z))</span>
<span id="cb208-3074"><a href="#cb208-3074" aria-hidden="true" tabindex="-1"></a><span class="fu">invlogit</span>(<span class="fl">0.4054651</span>)</span>
<span id="cb208-3075"><a href="#cb208-3075" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-3076"><a href="#cb208-3076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3077"><a href="#cb208-3077" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du einmal die Rücktransformation von Logitwerten in Wahrscheinlichkeitswerte.</span>
<span id="cb208-3078"><a href="#cb208-3078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3081"><a href="#cb208-3081" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-3082"><a href="#cb208-3082" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb208-3083"><a href="#cb208-3083" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb208-3084"><a href="#cb208-3084" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb208-3085"><a href="#cb208-3085" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb208-3086"><a href="#cb208-3086" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb208-3087"><a href="#cb208-3087" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb208-3088"><a href="#cb208-3088" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb208-3089"><a href="#cb208-3089" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Die *logistic*-Funktion transformiert eine unbegrenzte Zahl auf der x-Achse in eine begrenzte Wahrscheinlichkeit auf der y-Achse. Die Umkehrfunktion der *logit*-Funktion oder eben auch Inverse genannt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb208-3090"><a href="#cb208-3090" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-gen-binomial-logistic-theo</span></span>
<span id="cb208-3091"><a href="#cb208-3091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3092"><a href="#cb208-3092" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb208-3093"><a href="#cb208-3093" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="fu">plogis</span>(x)),</span>
<span id="cb208-3094"><a href="#cb208-3094" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb208-3095"><a href="#cb208-3095" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Wahrscheinlichkeit"</span>, <span class="at">y =</span> <span class="st">"Logistic()"</span>) <span class="sc">+</span></span>
<span id="cb208-3096"><a href="#cb208-3096" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb208-3097"><a href="#cb208-3097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb208-3098"><a href="#cb208-3098" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-3099"><a href="#cb208-3099" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-3100"><a href="#cb208-3100" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb208-3101"><a href="#cb208-3101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3102"><a href="#cb208-3102" aria-hidden="true" tabindex="-1"></a>Was bleibt dann noch am Ende übrig? Wir könnten uns das Leben auch einfacher machen und die binären Daten über kontinuierliche, normalverteilte Daten generieren. Das habe ich einmal in dem folgenden Kasten gemacht. Manchmal ist die Dichotomisierung eine gute Möglichkeit um binäre Daten zu erhalten.</span>
<span id="cb208-3103"><a href="#cb208-3103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3104"><a href="#cb208-3104" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb208-3105"><a href="#cb208-3105" aria-hidden="true" tabindex="-1"></a><span class="fu">## Oder doch die Normalverteilung?</span></span>
<span id="cb208-3106"><a href="#cb208-3106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3107"><a href="#cb208-3107" aria-hidden="true" tabindex="-1"></a>Wir können natürlich auch die Dtane erstmal mit einer Normalverteilung erschaffen und uns dann einen wie auch immer gearteten Grenzwert ausdenken bei dem wir dann entscheiden, dass alle Werte unter dem Grenzwert dann Null sind und alle über dem Grenzwert zu Eins werden. Teilweise ist es vermutlich die bessere Idee, wenn du sehr viele Einflussvariablen vorliegen hast. Hier nutze ich dann die Funktion <span class="in">`ifelse()`</span> um mir einen Grenzwert von 2 zu setzen.</span>
<span id="cb208-3108"><a href="#cb208-3108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3111"><a href="#cb208-3111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-3112"><a href="#cb208-3112" aria-hidden="true" tabindex="-1"></a>binom_norm_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb208-3113"><a href="#cb208-3113" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fl">1.2</span> <span class="sc">*</span> c_1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb208-3114"><a href="#cb208-3114" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y_bin =</span> <span class="fu">ifelse</span>(y <span class="sc">&gt;=</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb208-3115"><a href="#cb208-3115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-3116"><a href="#cb208-3116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3117"><a href="#cb208-3117" aria-hidden="true" tabindex="-1"></a>Dann können wir uns auch einmal anschauen, wie sich unser binärer Messwert dann verteilt.</span>
<span id="cb208-3118"><a href="#cb208-3118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3121"><a href="#cb208-3121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb208-3122"><a href="#cb208-3122" aria-hidden="true" tabindex="-1"></a>binom_norm_tbl <span class="sc">|&gt;</span> </span>
<span id="cb208-3123"><a href="#cb208-3123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(y_bin) </span>
<span id="cb208-3124"><a href="#cb208-3124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb208-3125"><a href="#cb208-3125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3126"><a href="#cb208-3126" aria-hidden="true" tabindex="-1"></a>Besonders wenn du dann viele Einflussvariablen hast, macht es Sinn einmal mit Grenzwerten zu spielen, so dass du am Ende auch balancierte binäre Messwerte hast. Am Ende macht es ja keinen Sinn nur Messwerte zu produzieren die alle Eins oder alle Null sind.</span>
<span id="cb208-3127"><a href="#cb208-3127" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb208-3128"><a href="#cb208-3128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3129"><a href="#cb208-3129" aria-hidden="true" tabindex="-1"></a><span class="fu">## Komplexere Messwerte</span></span>
<span id="cb208-3130"><a href="#cb208-3130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3131"><a href="#cb208-3131" aria-hidden="true" tabindex="-1"></a>Am Ende gibt es natürlich noch komplexere statitische Modell, die wir dann mit künstlichen Daten versehen können. Das R Paket <span class="in">`{simstudy}`</span> hat ja hier eine große Auswahl an Möglichkeiten. Wie immer gilt aber, warum willst du dir die Daten generieren? Die genierung hat ja an sich keinen Selbstzweck. Es macht Sinn sich künstliche Daten zu generieren, wenn wir die Algorithmen besser verstehen wollen. Wenn du dann aber so tief in der Thematik der Algorithmen und Methoden bist, dann übersteigt meist dein Interesse hier meine Fähigkeiten allgemeiner über das Thema zu schreiben. Deshalb hier nochmal eine lockere Linksammlung für die komplexeren Modelle.</span>
<span id="cb208-3132"><a href="#cb208-3132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3133"><a href="#cb208-3133" aria-hidden="true" tabindex="-1"></a><span class="fu">### Überlebenszeiten {.unnumbered .unlisted}</span></span>
<span id="cb208-3134"><a href="#cb208-3134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3135"><a href="#cb208-3135" aria-hidden="true" tabindex="-1"></a>Wenn es um Überlebenszeotdaten geht dann hilft die Vingette <span class="co">[</span><span class="ot">Survival Data</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/survival.html)</span> vom R Paket <span class="in">`{simstudy}`</span> weiter. Dort wird nochmal auf die speziellen Anforderungen einer Überlebenszeitanalyse (eng. *time to event*) eingegangen. Wir haben in einer Überlebenszeitanalyse eben auch einen Messwert vorliegen, der aus zwei Komponenten besteht. Wir brauchen einmal die Information, ob ein Ereignis eingetreten ist oder nicht. Damit haben wir einen binären Messwert. Darüber hinaus wollen wir noch wissen, wie lange es bis zum Ereignis gedauert hat. Das ist eher ein poissonverteilter Messwert. Es sind eben die Anzahl an Tagen oder allgemeiner die vergangene Zeit bis zum Ereignis. Das zusammen macht die Sachlage nicht einfacher. Aktuell nutze ich keine Überlebenszeitanalysen in meinen Vorlesungen und daher bleibt dieses Abschnitt auch erstmal offen.</span>
<span id="cb208-3136"><a href="#cb208-3136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3137"><a href="#cb208-3137" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zeitreihen {.unnumbered .unlisted}</span></span>
<span id="cb208-3138"><a href="#cb208-3138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3139"><a href="#cb208-3139" aria-hidden="true" tabindex="-1"></a>Wenn wir noch weiter über Zeitreihen sprechen, dann können wir verschiedene Dinge meinen. Wir haben eine Kovariate als Zeit vorliegen oder aber wir messen an bestimmten Zeitpunkten. Ein Zeitpunkt ist vermutlich eher ein Faktor. Messen wir viele Zeitpunkte, dann könnte der Zeitpunkt auch wieder eine Kovariate sein. Auf jeden Fall haben die Zeitpunkte untereinander etwas miteinander zu tun. Oder anders gesprochen, die Zeitpunkte sind untereinander korreliert. Je weiter die Zeitpunkte auseinanderliegen, desto geringer ist die Korrelation. Die folgenden Vingetten des R Paketes <span class="in">`{simstudy}`</span> beschäftigen sich mit diesen Fragen.</span>
<span id="cb208-3140"><a href="#cb208-3140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3141"><a href="#cb208-3141" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Vingette zu den <span class="co">[</span><span class="ot">Longitudinal Data</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/longitudinal.html)</span> ist im Prinzip ein guter Einstieg, wenn du längere Zeitreihen vorliegen hast. Was lang ist, hängt wiederum von Betrachter ab. Aber es geht eher um mehrere Wochen bis Monate.</span>
<span id="cb208-3142"><a href="#cb208-3142" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Vingette <span class="co">[</span><span class="ot">Correlated Data</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/correlated.html)</span> beschreibt eher die korrelierten Zeitpunkte als Faktoren. Hier musst du aber mal schauen, ob nicht die Vingette zu <span class="co">[</span><span class="ot">Correlation Matrices</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/corelationmat.html)</span> besser geeignet ist.</span>
<span id="cb208-3143"><a href="#cb208-3143" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wenn es komplizieter wird, dann können wir auch ordinale Messwerte mit der Vingette <span class="co">[</span><span class="ot">Correlated multivariate ordinal data</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/ordinal.html#correlated-multivariate-ordinal-data)</span> erstellen. Hier wird es dann aber sehr komplex, wenn es dann noch um Effekte geht.</span>
<span id="cb208-3144"><a href="#cb208-3144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3145"><a href="#cb208-3145" aria-hidden="true" tabindex="-1"></a>Am Ende sind alle Beispiele der Vingetten eher linear vom Verlauf über die Zeit. Wenn es wilder sein soll, also wir eher eine Kurve beobachten wollen, dann brauchen wir die folgende Vingette.</span>
<span id="cb208-3146"><a href="#cb208-3146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3147"><a href="#cb208-3147" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Vingette <span class="co">[</span><span class="ot">Spline Data</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/spline.html)</span> stellt im Prinzip nicht lineare Zusammenhänge dar. Wenn du also Daten brauchst, die Kurvenverläufe darstellen dann wird dir hier weitergeholfen. Es wird dann aber schnell sehr komplex, so dass du hier dann einiges an Zeit brauchen wirst um die Daten gut zu simulieren.</span>
<span id="cb208-3148"><a href="#cb208-3148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3149"><a href="#cb208-3149" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/eda-generation.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/eda-generation.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
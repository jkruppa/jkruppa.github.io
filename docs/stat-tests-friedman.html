<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>37&nbsp; Der Friedman Test – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-tests-chi-test.html" rel="next">
<link href="./stat-tests-kruskal.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="37&nbsp; Der Friedman Test – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-friedman.html"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der U-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Chi-Quadrat-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-marginal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Marginal effect models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#allgemeiner-hintergrund" id="toc-allgemeiner-hintergrund" class="nav-link active" data-scroll-target="#allgemeiner-hintergrund"><span class="header-section-number">37.1</span> Allgemeiner Hintergrund</a></li>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">37.2</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">37.3</span> Daten</a></li>
  <li><a href="#hypothesen" id="toc-hypothesen" class="nav-link" data-scroll-target="#hypothesen"><span class="header-section-number">37.4</span> Hypothesen</a></li>
  <li><a href="#der-friedman-test" id="toc-der-friedman-test" class="nav-link" data-scroll-target="#der-friedman-test"><span class="header-section-number">37.5</span> Der Friedman Test</a>
  <ul class="collapse">
  <li><a href="#für-ein-randomisiertes-vollständiges-blockdesign" id="toc-für-ein-randomisiertes-vollständiges-blockdesign" class="nav-link" data-scroll-target="#für-ein-randomisiertes-vollständiges-blockdesign"><span class="header-section-number">37.5.1</span> … für ein randomisiertes vollständiges Blockdesign</a></li>
  <li><a href="#für-ein-design-mit-wiederholten-messungen" id="toc-für-ein-design-mit-wiederholten-messungen" class="nav-link" data-scroll-target="#für-ein-design-mit-wiederholten-messungen"><span class="header-section-number">37.5.2</span> … für ein Design mit wiederholten Messungen</a></li>
  </ul></li>
  <li><a href="#post-hoc-test" id="toc-post-hoc-test" class="nav-link" data-scroll-target="#post-hoc-test"><span class="header-section-number">37.6</span> Post-hoc Test</a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-friedman.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-friedman.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-friedman.html"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-friedman" class="quarto-section-identifier"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 14. June 2025 um 15:30:29</em></p>
<blockquote class="blockquote">
<p><em>“It’s easy to lie with statistics. It’s hard to tell the truth without statistics.” — Andrejs Dunkels</em></p>
</blockquote>
<p>Willkommen in der Gruft. Der Friedman Test ist schlecht und sollte nicht angewendet werden. Das Kapitel existiert eigentlich nur, damit du es finden kannst und gleich lesen kannst, dass du den Friedman Test sein lassen sollst. Weder tut der Friedman Test, dass was du von ihm verlangst, noch macht er das was er tut besonders im statistischen Sinne gut. Am besten rechnest du nach <span class="citation" data-cites="zimmerman1993relative">Zimmerman &amp; Zumbo (<a href="#ref-zimmerman1993relative" role="doc-biblioref">1993</a>)</span> auf den rangtransformierten Messwerten eine repeated ANOVA, wie ich dir weiter unten zeige.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/personal_opinion.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/personal_opinion.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>“Sollte man statistische Test schlecht machen? Vermutlich ja. Einige Tests haben einfach Ihren Zenit erreicht und sind einfach nicht mehr der Stand der Wissenschaft im 21. Jahrhundert. Deshalb bitte einfach zurücklassen und sich nicht mehr drum kümmern.” — Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.</em></p>
</blockquote>
</div>
</div>
</div>
<section id="allgemeiner-hintergrund" class="level2" data-number="37.1">
<h2 data-number="37.1" class="anchored" data-anchor-id="allgemeiner-hintergrund"><span class="header-section-number">37.1</span> Allgemeiner Hintergrund</h2>
<p>Der Friedman Test ist der Kruskal Wallis Test für abhängige Daten. Oder doch nicht? Wenn man sich mit den Friedman Test beschäftigt, dann wird einem nach einer etwas längeren Internetscuhe dann doch klar, dass hier irgendwas nicht so richtig stimmt. Es gibt nämlich <a href="https://math.montana.edu/jobo/thainp/ksampa.pdf">zwei Arten des Friedman Tests</a>. Also eigentlich auch nein, es gibt nur einen Friedman Test aber zwei Arten den Test anzuwenden. Wir können den Friedman Test einmal in den Agrarwissenschaften nutzen um ein randomisiertes vollständiges Blockdesign (eng. <em>Randomized Complete Block Design</em>) auszuwerten. In den Geisteswissenschaften wird der Friedman Test gerne für ein einfaches Design mit wiederholten Messungen (eng. <em>Simple Repeated Measures Design</em>) genutzt. Damit fängt es schon an, denn die beiden Designs haben was gemeinsam aber dann auch wieder nicht. Also wir merken uns, je nachdem aus welcher Fachrichtung du kommst, mag der Firedman Test für dich was anderes bedeuten. In beiden Fällen heißt es aber <a href="https://seriousstats.wordpress.com/2012/02/14/friedman/">“Beware the Friedman test!”</a></p>
<p>Hilft ja alles nichts, fangen wir also einmal an uns anzuschauen, was der Friedman Test macht. Du findest noch ein gutes <a href="https://rcompanion.org/handbook/F_10.html">Tutorium zum Friedman Test</a> sowie die Alternative einer repeated ANOVA auf den rangtransformierten Messwerten nach <span class="citation" data-cites="zimmerman1993relative">Zimmerman &amp; Zumbo (<a href="#ref-zimmerman1993relative" role="doc-biblioref">1993</a>)</span>. Wir schauen uns diese Lösung dann auch einmal an. Wichtig ist noch zu wissen, dass die asymptotische Effizienz des Friedman-Tests bei <span class="math inline">\(0.955 \cdot J/(J+1)\)</span>, also bei <span class="math inline">\(0.64\)</span> für <span class="math inline">\(J=2\)</span> und <span class="math inline">\(0.87\)</span> für <span class="math inline">\(J=10\)</span> liegt. Wir beschrieben mit <span class="math inline">\(J\)</span> die Anzahl der Gruppen oder Versuchsbedingungen also den Spalten ist. Bei einer Effizienz von <span class="math inline">\(0.64\)</span> braucht der Friedman Test somit eine um <span class="math inline">\((100-64)/64\)</span> gleich <span class="math inline">\(0.56\)</span> also eine ca. 50% größere Stichprobe um die selbe Signifikanz zu erreichen. Oder etwas anders, dass der Friedman Test <span class="math inline">\(50\%\)</span> mehr Fallzahl benötigt um die gleiche Effizienz zu haben wie eine einfaktorielle ANOVA, deren Annahmen an die Normalverteilung und Varianzhomogenität erfüllt werden. Der Begriff der Effizienz ist hier natürlich etwas wage, aber du kannst den Begriff für dich auch vereinfacht als gleiche statistische Eigenschaften was die Signifikanz angeht lesen. Der Friedman Test braucht also sehr viele Gruppen in den Spalten.</p>
<section id="datenformat" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="datenformat">Datenformat</h4>
<p>Sprechen wir nochmal über das Datenformat. In der Datentabelle für den Friedman Test haben wir keine Wiederholungen für die Faktorkombinationen vorliegen, wie du in der folgenden Tabelle siehst. Solltest du wiederholt Faktorkombinationen gemessen haben, dann müsstest du die Daten erst Aggregieren. Was wiederum wirr ist, denn damit verlierst du Informationen. Heutzutage kannst du auch auf den vollen Datensätzen rechnen. Wir haben also in den Spalten den Faktor <span class="math inline">\(A\)</span> mit den Leveln <span class="math inline">\(A.1\)</span> bis <span class="math inline">\(A.4\)</span> vorliegen. Der Faktor <span class="math inline">\(A\)</span> beschreibt die Versuchsbedingungen, wie Behandlung oder Sorte. Du kannst natürlich auch mehr als vier Behandlungen vorliegen haben. In den Zeilen findest du dann den Faktor <span class="math inline">\(B\)</span> für die Messwiederholungen oder Blöcke. Wir haben hier fünf Level im Faktor <span class="math inline">\(B\)</span> vorliegen. Damit sieht die Tabelle eher wie eine Kreuztabelle einer deskriptiven Statistik aus als ein Datensatz.</p>
<div id="tbl-test" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;37.1— Beispielhafte, aggregierte Datentabelle für einen Friedman Test mit vier Behandlungen in den Spalten und fünf Wiederholungen in den Zeilen. In den Spalten ist der Behandlungsfaktor A mit den entsprechenden Leveln A.1 bis A.4 eingetragen. In den Zeilen finden sich der Faktor für Wiederholungen wie Blöcke oder individuelle IDs mit den entsprechenden Leveln B.1 bis B.5 eingetragen. Es liegen keine Messwiederholungen für die Faktorkombinationen vor.
</figcaption>
<div aria-describedby="tbl-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Faktor B</th>
<th>A.1</th>
<th>A.2</th>
<th>A.3</th>
<th>A.4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>B.1</strong></td>
<td>9.1</td>
<td>10.2</td>
<td>12.2</td>
<td>14.1</td>
</tr>
<tr class="even">
<td><strong>B.2</strong></td>
<td>4.2</td>
<td>5.2</td>
<td>6.2</td>
<td>7.3</td>
</tr>
<tr class="odd">
<td><strong>B.3</strong></td>
<td>12.1</td>
<td>14.5</td>
<td>12.5</td>
<td>13.7</td>
</tr>
<tr class="even">
<td><strong>B.4</strong></td>
<td>1.2</td>
<td>3.6</td>
<td>3.5</td>
<td>7.1</td>
</tr>
<tr class="odd">
<td><strong>B.5</strong></td>
<td>4.1</td>
<td>4.5</td>
<td>4.7</td>
<td>8.1</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Dann wollen wir gleich einmal den Friedman Test anwenden. Dafür habe ich dann auch wieder die passenden R Paket sowie zwei Datensätze mitgebracht. Am Ende musst du schauen, ob du deine Daten mit dem Friedman Test auswerten möchtest. Der Friedman Test hat Probleme bei wenigen Behandlungen und Blöcken einen Effekt signifikant zu finden. Solltest du nur eine aggregierte Datentabelle haben, dann mag der Friedman Test eine Lösung für dein Problem sein.</p>
</section>
</section>
<section id="genutzte-r-pakete" class="level2" data-number="37.2">
<h2 data-number="37.2" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">37.2</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, broom, pgirmess,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               readxl, rstatix, coin, nparcomp,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               effectsize, PMCMRplus, rcompanion,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               afex, conflicted)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="37.3">
<h2 data-number="37.3" class="anchored" data-anchor-id="daten"><span class="header-section-number">37.3</span> Daten</h2>
<p>Eigentlich sind die Datensätze hier zweimal das Gleiche, aber es gibt eben diese <a href="https://math.montana.edu/jobo/thainp/ksampa.pdf">zwei Arten des Friedman Tests</a>, die im Orbit rumgeistern. Deshalb hier im Folgenden einmal der agrawissenschaftliche Datensatz mit einem, Block in den Zeilen sowie einen Datensatz zu Messwiederholungen an Individuen mit unseren Flöhen. Damit haben wir beide Fälle abgefrühstückt und können uns dann die Auswertung einmal näher anschauen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Randomisiertes vollständiges Blockdesign</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Design mit wiederholten Messungen</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Beginnen wir einmal mit dem randomisierten vollständigen Blockdesign (eng. <em>Randomized Complete Block Design</em>). Wir haben die Daten in der folgenden Datei in dem Reiter <code>block</code> abliegen. Die Besonderheit ist hier, dass wir dennoch Messwiederholungen in den Blöcken vorliegen haben. Sehe einfahc die Blöcke als verschiedene Käfige. Ich habe die Daten mal etwas realistischer gebaut. Wir haben hier pro Block jeweils die Sprungweite von drei Hundeflöhen gemessen. Dabei sind die Flöhe dann unter verschiedenen Ernährungsformen gesprungen. Wir haben aber nicht den gleichen Floh in jeder Behandlung gemessen. Jeder Zahlenwert entspricht der Sprungweite eines individuellen Hundeflohs. Der Weg hier vom Wide-Format zum Long-Format über die Aggregation ist etwas lang, aber geht so nicht anders.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>block_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/friedman_data.xlsx"</span>,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sheet =</span> <span class="st">"block"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Datentabelle siehst du einmal den Datensatz mit den Sprungweiten unter den verschiedenen Ernährungsformen. Wir haben eine Wiederholung in den Blöcken vorliegen, diese Wiederholung müssen wir dann noch aggregieren, so dass wir dann nur eine Zeile pro Block haben.</p>
<div class="cell">
<div id="tbl-1fac-table-block" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1fac-table-block-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;37.2— Auszug aus der Datentabelle eines randomisierten vollständigen Blockdesign mit drei Messweiderholungen pro Block. Ein Block kann als ein Käfig angesehen werden. Für die einzelnen Hundeflöhe wurden unter verschiedenen Ernährungsformen die Sprungweiten gemessen. Jeder Wert entspricht einem individuellen Floh. Die Daten müssen noch aggregiert werden damit wir den Friedman Test anwenden können.
</figcaption>
<div aria-describedby="tbl-1fac-table-block-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_6bw7jp6f617kt34j050e</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_6bw7jp6f617kt34j050e" style="table-layout: fixed; width: 100% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">rep</th>
                <th scope="col">block</th>
                <th scope="col">ctrl</th>
                <th scope="col">blood</th>
                <th scope="col">ketchup</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1  </td>
                  <td>1  </td>
                  <td>6.3</td>
                  <td>5.3</td>
                  <td>1.5</td>
                </tr>
                <tr>
                  <td>2  </td>
                  <td>1  </td>
                  <td>7.8</td>
                  <td>5.6</td>
                  <td>1.3</td>
                </tr>
                <tr>
                  <td>3  </td>
                  <td>1  </td>
                  <td>7.1</td>
                  <td>5.8</td>
                  <td>1.5</td>
                </tr>
                <tr>
                  <td>1  </td>
                  <td>2  </td>
                  <td>7.3</td>
                  <td>8.1</td>
                  <td>2.4</td>
                </tr>
                <tr>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                  <td>...</td>
                </tr>
                <tr>
                  <td>3  </td>
                  <td>4  </td>
                  <td>6.5</td>
                  <td>5.8</td>
                  <td>7.3</td>
                </tr>
                <tr>
                  <td>1  </td>
                  <td>5  </td>
                  <td>2.3</td>
                  <td>8.2</td>
                  <td>3.2</td>
                </tr>
                <tr>
                  <td>2  </td>
                  <td>5  </td>
                  <td>2.8</td>
                  <td>8.6</td>
                  <td>3.5</td>
                </tr>
                <tr>
                  <td>3  </td>
                  <td>5  </td>
                  <td>2.9</td>
                  <td>8.5</td>
                  <td>3.8</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_91h1mp2s0fip5mw0d59s(i, j, css_id) {
        var table = document.getElementById("tinytable_6bw7jp6f617kt34j050e");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_6bw7jp6f617kt34j050e');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_91h1mp2s0fip5mw0d59s(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_6bw7jp6f617kt34j050e");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Dann bilden wir einmal den Mittelwert über jede Zeile für jeden Block. Somit haben wir dann die Blockmittel für jede Ernährungsform und nur noch einen Wert für die Sprungweite für jede Faktorkombination. In jeden Zahlenwert gehen jetzt die individuellen Sprungweiten der drei Hundeflöhe auf.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>block_tbl <span class="ot">&lt;-</span> block_raw_tbl <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(block) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(ctrl<span class="sc">:</span>ketchup, mean))  </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Tabelle siehst du dann das Ergebnis der Aggregation. Wir haben dann nur noch eine Sprungweite der Hundeflöhe für jede Faktorkombination der Ernährungsform und des Blocks vorliegen.</p>
<div class="cell">
<div id="tbl-1fac-table-block-aggr" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1fac-table-block-aggr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;37.3— Aggregierte Datentabelle eines randomisierten vollständigen Blockdesign mit den mittleren Sprungweiten pro Block. Jeder Wert entspricht dem Mittel der Sprungweiten der drei Flöhe. Jede Faktorkombination ist nur einmal vertreten.
</figcaption>
<div aria-describedby="tbl-1fac-table-block-aggr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_g5psmd7r43yui5e6p4do</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_g5psmd7r43yui5e6p4do" style="table-layout: fixed; width: 67% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">block</th>
                <th scope="col">ctrl</th>
                <th scope="col">blood</th>
                <th scope="col">ketchup</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>7.07</td>
                  <td>5.57</td>
                  <td>1.43</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>7.33</td>
                  <td>8.17</td>
                  <td>2.50</td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>9.43</td>
                  <td>4.50</td>
                  <td>4.30</td>
                </tr>
                <tr>
                  <td>4</td>
                  <td>6.33</td>
                  <td>5.43</td>
                  <td>7.20</td>
                </tr>
                <tr>
                  <td>5</td>
                  <td>2.67</td>
                  <td>8.43</td>
                  <td>3.50</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_oiaadpg4ipojkx37c5wl(i, j, css_id) {
        var table = document.getElementById("tinytable_g5psmd7r43yui5e6p4do");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_g5psmd7r43yui5e6p4do');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_oiaadpg4ipojkx37c5wl(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_g5psmd7r43yui5e6p4do");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Das reicht dann aber natürlich wieder nicht, den wir haben damit die Daten im Wide-Format in der vorherigen Tabelle vorliegen. Die Analysen in R verlangen aber da Long-Format, so dass ich hier nochmal mit der Funktion <code>pivot_longer()</code> einen entsprechenden Datensatz baue. Dann kann ich auch gleich die entsprechenden Faktoren umwandeln.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>block_long_tbl <span class="ot">&lt;-</span> block_tbl <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> ctrl<span class="sc">:</span>ketchup,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"feeding"</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">block =</span> <span class="fu">as_factor</span>(block),</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">feeding =</span> <span class="fu">as_factor</span>(feeding))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Der Weg war jetzt etwas länger, aber so ist es manchmal, wenn wir mit etwas veralteten Algorithmen rechnen wollen. In der folgenden Abbildung siehst du dann nochmal die Daten in einem Dotplot dargestellt. Wir sehen, dass die Kontrolle eine etwas weitere Sprungweite hat als das Blut und auch die Ernährung mit Ketchup.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(block_long_tbl, <span class="fu">aes</span>(feeding, jump_length, <span class="at">fill =</span> block)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir=</span><span class="st">'center'</span>, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Ernährungsform"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">color =</span> <span class="st">"Block"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fried-ggplot-block" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fried-ggplot-block-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-friedman_files/figure-html/fig-fried-ggplot-block-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;37.1— Dotplot des Datenbeispiels für die fünf Blöcke und die drei Ernährungsformen."><img src="stat-tests-friedman_files/figure-html/fig-fried-ggplot-block-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fried-ggplot-block-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;37.1— Dotplot des Datenbeispiels für die fünf Blöcke und die drei Ernährungsformen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Den zweiten Datensatz, den wir uns anschauen wollen, zeigt ein einfaches Design mit wiederholten Messungen (eng. <em>Simple Repeated Measures Design</em>). Wir haben hier also fünf Hundeflöhe vorliegen, die wir dann viermal springen lassen. Wir messen dann nach jedem Sprung einmal die Sprungweite. Damit haben wir dann über die Zeilen eine Messwiederholung in unseren Daten vorliegen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>repeated_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/friedman_data.xlsx"</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sheet =</span> <span class="st">"repeated"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir haben damit folgenden Datensatz vorliegen. In den Zeilen sind die fünf Hundeflöhe, die jeweils zu vier Zeitpunkten einmal gesprungen sind. Wir haben dann zu jedem Zeitpunkt einmal die Sprungweite erfasst und aufgeschrieben. Die Messwerte sind damit abhängig. Damit ist der Datensatz sehr klassisch für einen Friedman Test.</p>
<div class="cell">
<div id="tbl-1fac-table-repeated" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1fac-table-repeated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;37.4— Datentabelle eines einfachen Design mit wiederholten Messungen für die Sprungweite zu vier Zeitpunkten. Fünf Hundeflöhe sind jeweils viermal gesprungen und die Sprungweiten wurden erfasst. Die Messwiederholungen laufen über die Zeilen.
</figcaption>
<div aria-describedby="tbl-1fac-table-repeated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_ohakpw6y8apg860b8hlu</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_ohakpw6y8apg860b8hlu" style="table-layout: fixed; width: 100% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">flea_id</th>
                <th scope="col">t1</th>
                <th scope="col">t2</th>
                <th scope="col">t3</th>
                <th scope="col">t4</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>10.2</td>
                  <td>12.4</td>
                  <td>11.1</td>
                  <td>13.4</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td> 8.3</td>
                  <td> 9.1</td>
                  <td> 6.8</td>
                  <td> 7.1</td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>12.1</td>
                  <td>15.1</td>
                  <td>11.3</td>
                  <td>12.5</td>
                </tr>
                <tr>
                  <td>4</td>
                  <td> 7.8</td>
                  <td> 8.1</td>
                  <td> 5.6</td>
                  <td> 8.2</td>
                </tr>
                <tr>
                  <td>5</td>
                  <td> 8.6</td>
                  <td>10.3</td>
                  <td> 8.1</td>
                  <td>11.3</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_be6xakfe1gqzny8u7pw7(i, j, css_id) {
        var table = document.getElementById("tinytable_ohakpw6y8apg860b8hlu");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_ohakpw6y8apg860b8hlu');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_be6xakfe1gqzny8u7pw7(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_ohakpw6y8apg860b8hlu");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Das reicht dann aber natürlich noch nicht, den wir haben die Daten noch im Wide-Format in der vorherigen Tabelle vorliegen. Die Analysen in R verlangen aber da Long-Format, so dass ich hier nochmal mit der Funktion <code>pivot_longer()</code> einen entsprechenden Datensatz baue. Dann kann ich auch gleich die entsprechenden Faktoren umwandeln.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>repeated_long_tbl <span class="ot">&lt;-</span> repeated_tbl <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t4,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">flea_id =</span> <span class="fu">as_factor</span>(flea_id),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_fct =</span> <span class="fu">as_factor</span>(time))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung siehst du dann nochmal die Daten in einem Dotplot dargestellt. Die Linien verbinden die einzelnen Flöhe und die Sprungweiten über die Zeiten miteinander. Wie wir sehen, haben wir die höchsten Sprungweiten zu dem Zeitpunkt <code>t2</code> und weniger zu dem Zeitpunkt <code>t3</code>. Hier scheint es einen Effekt der Zeit zu geben.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(repeated_long_tbl, <span class="fu">aes</span>(time_fct, jump_length, <span class="at">fill =</span> flea_id)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> flea_id), <span class="at">color =</span> <span class="st">"gray"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir=</span><span class="st">'center'</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkt"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">color =</span> <span class="st">"Floh ID"</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fried-ggplot-repeated" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fried-ggplot-repeated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-friedman_files/figure-html/fig-fried-ggplot-repeated-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;37.2— Dotplot des Datenbeispiels für die Bonitur von fünf Weizensorten."><img src="stat-tests-friedman_files/figure-html/fig-fried-ggplot-repeated-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fried-ggplot-repeated-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;37.2— Dotplot des Datenbeispiels für die Bonitur von fünf Weizensorten.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Ich habe hier nochmal beide Datenformate dargestellt. Wir können in den Agrarwissenschaften nicht in den verschiedenen Blöcken wiederholt messen. Was wir in den einen Block Pflanzen wächst in dem einen Block und kann nicht nochmal woanders gemessen werden. Zwar ist ein Block eine Versuchseinheit, aber die Pflanzen oder Tiere, die in dem ersten Block stehen, stehen dann eben nicht in dem zweiten Block. Das ist technisch ja gar nicht möglich. Das hier zwei so unterschiedliche Fragestellungen angeblich mit dem gleichen Test beantwortet werden können, sollte einen schon stutzig machen.</p>
</section>
<section id="hypothesen" class="level2" data-number="37.4">
<h2 data-number="37.4" class="anchored" data-anchor-id="hypothesen"><span class="header-section-number">37.4</span> Hypothesen</h2>
<p>Der Friedman Test betrachtet die Gruppen und Ränge um einen Unterschied nachzuweisen. Daher haben wir in der Nullhypothese als Gleichheitshypothese folgende Prosahypothese. Mehr zu den Hintergründen der Hypothesen in einem nichtparametrischen Test findest du im <a href="stat-tests-utest.html">Kapitel zum U-Test</a>.</p>
<p><span class="math inline">\(H_0:\)</span> <em>Die Gruppen werden aus Populationen mit identischen Verteilungen entnommen. Typisch ist, dass die Stichprobenpopulationen stochastische Gleichheit aufweisen. Daher sind häufig die Mediane gleich.</em></p>
<p>Die Alternative lautet, dass sich mindestens ein paarweiser Vergleich unterschiedet. Hierbei ist das mindestens ein Vergleich wichtig. Es können sich alle Gruppen unterschieden oder eben nur ein Paar. Wenn ein Friedman Test die <span class="math inline">\(H_0\)</span> ablehnt, also ein signifikantes Ergebnis liefert, dann wissen wir nicht, welche Gruppen sich unterscheiden und einen entsprechenden Post-hoc Test rechnen.</p>
<p><span class="math inline">\(H_A:\)</span> <em>Die Gruppen werden aus Populationen mit unterschiedlichen Verteilungen entnommen. Typischerweise weist eine der untersuchten Populationen eine stochastische Dominanz auf. Die Mediane sind häufig verschieden.</em></p>
<p>Wir schauen uns jetzt einmal den Friedman Test theoretisch an bevor wir uns mit der Anwendung des Friedman Test in R beschäftigen.</p>
</section>
<section id="der-friedman-test" class="level2" data-number="37.5">
<h2 data-number="37.5" class="anchored" data-anchor-id="der-friedman-test"><span class="header-section-number">37.5</span> Der Friedman Test</h2>
<p>Beginnen wir nun mit der Umsetzung des Friedman Tests. Ich zeige dir hier beide Anwendungsfelder. Nur der erste Fall für ein randomisiertes vollständiges Blockdesign macht überhaupt Sinn. Andere Fall für ein einfaches Design mit Messwiederholungen ist nur hier um dich zu warnen. Der Friedman Test leidet unter Mängeln und sollte nicht verwendet werden.</p>
<section id="für-ein-randomisiertes-vollständiges-blockdesign" class="level3" data-number="37.5.1">
<h3 data-number="37.5.1" class="anchored" data-anchor-id="für-ein-randomisiertes-vollständiges-blockdesign"><span class="header-section-number">37.5.1</span> … für ein randomisiertes vollständiges Blockdesign</h3>
<p>Der Friedman Test ist in R in verschiedenen Paketen implementiert. Alle Funktionen liefern mehr oder minder das gleiche Ergebnis. Wichtig ist wie wir in der Funktion das Modell definieren. Wir nutzen das Symbol <code>|</code> um die Behandlung von dem Block zu trennen. Vor dem <code>|</code> Symbol steht die Behandlung, hinter dem <code>|</code> steht der Block. Damit sieht das Modell etwas anders aus, aber im Prinzip ist die Definition des Modells einfach. Diese Schreibweise ist in allen drei vorgestellten Paketen und Funktionen gleich. Ich würde keine der drei Funktionen benutzen, da ich den Friedman Test nicht rechnen würde. Betrachten wir aber zuerst einmal den theoretischen Teil.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><code>{stats}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false"><code>{coin}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false"><code>{rstatix}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Die Frage bei den nichtparametrischen Tests ist ja immer, wie wir die Ränge bilden. In dem Fall des Friedman Tests bilden wir die Ränge über die Zeilen. Das heißt, wir schauen uns den ersten Block an und sortieren die beobachteten Sprungweiten und vergeben dann absteigend Ränge. Der größte Wert kriegt den ersten Rang und der kleinste Werte den letzten Rang. Das machen wir dann für jede weitere Zeile. Am Ende bilden wir dann die Rangsummen für jede Ernährungsform. Dafür addieren wir die Ränge einfach auf.</p>
<div id="tbl-friedman-theo-block" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-friedman-theo-block-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;37.5— Datentabelle des Blockdesigns mit den Sprungweiten der Flöhe unter drei Ernährungsarten. Pro Zeile wird den beobachteten Sprungweiten ein Rang zugeordnet. Die Summe der Ränge wird pro Spalte gebildet.
</figcaption>
<div aria-describedby="tbl-friedman-theo-block-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 29%">
<col style="width: 29%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Block</th>
<th style="text-align: center;">Kontrolle</th>
<th style="text-align: center;">Blut</th>
<th style="text-align: center;">Ketchup</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(7.07 \rightarrow 1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(5.57 \rightarrow 2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(1.43 \rightarrow 3\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(7.33 \rightarrow 2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8.17 \rightarrow 1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(2.50 \rightarrow 3\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;"><span class="math inline">\(9.43 \rightarrow 1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.50 \rightarrow 2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.30 \rightarrow 3\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;"><span class="math inline">\(6.33 \rightarrow 2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(5.43 \rightarrow 3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(7.20 \rightarrow 1\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;"><span class="math inline">\(2.67 \rightarrow 3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8.43 \rightarrow 1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(3.50 \rightarrow 2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\sum\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9\)</span></td>
<td style="text-align: center;"><span class="math inline">\(12\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wenn wir keinen Effekt der Ernährungsformen erwarten würden, dann würde immer mal wieder jede Ernährungsform große oder kleine Ränge erhalten. Bei einer zufälligen Anordnung würden wir daher eine Rangsumme von <span class="math inline">\(E(R)\)</span> gleich 10 erwarten.</p>
<p><span class="math display">\[
E(R) = \cfrac{N(k+1)}{2} = \cfrac{5(3+1)}{2} = 10
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(k\)</span> ist die Anzahl an Gruppen. Hier also die Spalten der Daten.</li>
<li><span class="math inline">\(N\)</span> der Gesamtzahl an Beobachtungen also die gesamte Fallzahl. Hier also die Zeilen der Daten.</li>
</ul>
<p>Wir sehen, dass wir nahe dran sind und fragen uns jetzt, ob die leichte Abweichung schon signifikant sein kann. Dafür können wir hier ein <span class="math inline">\(\mathcal{X_D}^2\)</span> Statistik berechnen, die uns bei der Beantwortung hilft. Ja, wir können auch in anderen Tests wieder auf andere bekannte Teststatistiken zurückgreifen.</p>
<p><span class="math display">\[
\mathcal{X_D}^2 = \cfrac{12}{N \cdot k \cdot (k+1)} \cdot \sum R^2 - 3 \cdot N \cdot (k+1)
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(R\)</span> der Rangsummen für jede Gruppe mit insgesamt <span class="math inline">\(k\)</span> Gruppen.</li>
<li><span class="math inline">\(k\)</span> ist die Anzahl an Gruppen. Hier also die Spalten der Daten.</li>
<li><span class="math inline">\(N\)</span> der Gesamtzahl an Beobachtungen also die gesamte Fallzahl. Hier also die Zeilen der Daten.</li>
</ul>
<p>Dann setzen wir mal alle Zahlen in die Formel ein und rechnen einmal aus, was wir für eine <span class="math inline">\(\mathcal{X_D}^2\)</span> Statistik erhalten. Je größer die Teststatistik ist, desto eher lehnen wir die Nullhypothese ab.</p>
<p><span class="math display">\[
\begin{aligned}
\mathcal{X_D}^2 &amp;= \cfrac{12}{5 \cdot 3 \cdot (3+1)} \cdot (9^2 + 9^2 + 12^2) - 3 \cdot 5 \cdot (3+1) \\
&amp;= 0.2 \cdot 306 - 60 \\
&amp;= 1.6
\end{aligned}
\]</span></p>
<p>Wir haben den kritischen Wert <span class="math inline">\(\mathcal{X}^2_{\alpha = 5\%}\)</span> in unserem Fall mit <span class="math inline">\(5.99\)</span> gegeben. Wenn die <span class="math inline">\(\mathcal{X_D}^2\)</span> Statistik größer ist als der kritische Wert, können wir die Nullhypothese ablehnen. Das ist hier nicht der Fall. Wir sehen also keinen signifikanten Unterschied zwischen den Ernährungsformen.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Dann kommen wir auch schon zu dem statistischen Test in <code>{stats}</code>. Wir müssen hier nur schauen, dass die Zeilen als Faktor hinter dem Strich <code>|</code> stehen. Dann rechnet sich alles sehr schnell.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">friedman.test</span>(jump_length <span class="sc">~</span> feeding <span class="sc">|</span> block, <span class="at">data =</span> block_long_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Friedman rank sum test

data:  jump_length and feeding and block
Friedman chi-squared = 1.2, df = 2, p-value = 0.5488</code></pre>
</div>
</div>
<p>Nachdem wir die Funktion aufgerufen haben, erhalten wir auch gleich den <span class="math inline">\(p\)</span>-Wert von <span class="math inline">\(0.5488\)</span> wieder. Da der <span class="math inline">\(p\)</span>-Wert größer ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% können wir die Nullhypothese nicht ablehnen. Das war auch anhand des Doplots zu erwarten.</p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Dann kommen wir auch schon zu dem statistischen Test in <code>{coin}</code> mit der Funktion <code>friedman_test()</code>. Da die Funktion gleich heißt wie im R Paket <code>{rstatix}</code> muss ich die Funktion nochmal explizit aufrufen. Wir müssen hier nur schauen, dass die Zeilen als Faktor hinter dem Strich <code>|</code> stehen. Dann rechnet sich alles sehr schnell.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>coin<span class="sc">::</span><span class="fu">friedman_test</span>(jump_length <span class="sc">~</span> feeding <span class="sc">|</span> block, <span class="at">data =</span> block_long_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic Friedman Test

data:  jump_length by
     feeding (ctrl, blood, ketchup) 
     stratified by block
chi-squared = 1.2, df = 2, p-value = 0.5488</code></pre>
</div>
</div>
<p>Nachdem wir die Funktion aufgerufen haben, erhalten wir auch gleich den <span class="math inline">\(p\)</span>-Wert von <span class="math inline">\(0.5488\)</span> wieder. Das gleiche Eregbnis wie schon vorher. Da der <span class="math inline">\(p\)</span>-Wert größer ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% können wir die Nullhypothese nicht ablehnen. Das war auch anhand des Doplots zu erwarten.</p>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>Dann kommen wir auch schon zu dem statistischen Test in <code>{rstatix}</code> mit der Funktion <code>friedman_test()</code>. Da die Funktion gleich heißt wie im R Paket <code>{coin}</code> muss ich die Funktion nochmal explizit aufrufen. Wir müssen hier nur schauen, dass die Zeilen als Faktor hinter dem Strich <code>|</code> stehen. Dann rechnet sich alles sehr schnell. Mehr zu der Funktion erfährst du auch im Tutorium <a href="https://www.datanovia.com/en/lessons/friedman-test-in-r/">Friedman Test in R</a>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>rstatix<span class="sc">::</span><span class="fu">friedman_test</span>(jump_length <span class="sc">~</span> feeding <span class="sc">|</span> block, <span class="at">data =</span> block_long_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  .y.             n statistic    df     p method       
* &lt;chr&gt;       &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        
1 jump_length     5       1.2     2 0.549 Friedman test</code></pre>
</div>
</div>
<p>Nachdem wir die Funktion aufgerufen haben, erhalten wir auch gleich den <span class="math inline">\(p\)</span>-Wert von <span class="math inline">\(0.5488\)</span> wieder. Das gleiche Eregbnis wie schon vorher. Da der <span class="math inline">\(p\)</span>-Wert größer ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% können wir die Nullhypothese nicht ablehnen. Das war auch anhand des Doplots zu erwarten.</p>
</div>
</div>
</div>
<p>Wie wir sehen erhalten wir aus allen drei Funktionen den gleichen p-Wert. Hier kommt es dann eher darauf an mit welchem Paket du sonst so rechnest. Vermutlich würde ich dir das R Paket <code>{rstatix}</code> empfehlen, weil wir hier dann auch gleich den Effektschätzer mit berechnen können. Sonst nehmen sich die Pakete bei einem so simplen Algorithmus wie dem Friedman Test nichts.</p>
<section id="effektschätzer" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="effektschätzer">Effektschätzer</h4>
<p>Wir können den Effektschätzer Kendall’s <span class="math inline">\(W\)</span> im R Paket <code>{rstatix}</code> mit der Funktion <code>friedman_effsize()</code> berechnen. Dann erhalten wir auch gleich noch die Interpretation mitgeliefert, was es dann auch sehr viel einfacher macht. Kendall’s <span class="math inline">\(W\)</span> hat nämlich keine direkte biologische Interpretation und so brauchen wir hier eine entsprechende Einordnung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">friedman_effsize</span>(jump_length <span class="sc">~</span> feeding <span class="sc">|</span> block, <span class="at">data =</span> block_long_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
  .y.             n effsize method    magnitude
* &lt;chr&gt;       &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;ord&gt;    
1 jump_length     5    0.12 Kendall W small    </code></pre>
</div>
</div>
<p>Wir haben also herausgefunden, dass wir einen schwachen Effekt haben und sich die Mediane der Gruppen nicht unterscheiden. Damit sind wir dann auch soweit schon mit dem Friedman test durch, wir können hier dann auch nicht mehr berechnen. Auch erhalten wir keine 95% Konfidenzintervalle für die Effekte.</p>
</section>
<section id="parametrische-lösung-die-anova" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="parametrische-lösung-die-anova">Parametrische Lösung: Die ANOVA</h4>
<p>Dann hier auch die parametrische Lösung des Problems mit der zweifaktoriellen ANOVA. Wir wollen jetzt einfach nur unsere Messwerte einmal Rangtransformieren. Dafür nutze ich entweder die Funktion <code>rank()</code> oder aber die folgende Funktion <code>signed_rank()</code>, wenn ich negative Werte in meinen Messungen erwarte.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>signed_rank <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sign</span>(x) <span class="sc">*</span> <span class="fu">rank</span>(<span class="fu">abs</span>(x))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Konkret habe ich meine Sprungweiten der Flöhe. Jetzt mutiere ich die Sprungweite über die Funktion <code>signed_rank()</code> in Ränge und nutze diese Spalte dann für die ANOVA.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>block_long_ranked_tbl <span class="ot">&lt;-</span> block_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ranked_jump_length =</span> <span class="fu">signed_rank</span>(jump_length))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ich nutze hier die Funktion <code>anova_test()</code> aus dem R Paket <code>{rstatix}</code>, da ich dann einfacher pipen kann. Dann wähle ich noch die passenden Spalten und sehe, dass die Entscheidung die gleiche wäre wie bei den obigen Implementierungen des Friedman Tests. Wir können die Nullhypothese nicht ablehnen, wir haben einen signifikanten Unterschied in den Sprungweiten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>block_long_ranked_tbl <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(ranked_jump_length <span class="sc">~</span> feeding <span class="sc">+</span> block) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type II tests)

   Effect DFn DFd     F     p p&lt;.05   ges
1 feeding   2   8 1.989 0.199       0.332
2   block   4   8 0.214 0.923       0.097</code></pre>
</div>
</div>
<p>Dann können wir die Daten auch in der Form als Messwiederholungen innerhalb des Blocks modellieren, was dann die jeweiligen Blockeffekte miteinschließt. Dann haben wir ein einfaktorielles repeated Design für die ANOVA. Hier nutze ich die Funktion <code>aov_car()</code> aus dem R Paket <code>{afex}</code>. Aber auch hier sehen wir, dass wir dann doch keinen signifikanten Unterschied finden unser p-Wert ist mit <span class="math inline">\(0.202\)</span> immer noch größer als das Signifikanzniveau <span class="math inline">\(\alpha\)</span>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(ranked_jump_length <span class="sc">~</span> feeding <span class="sc">+</span> <span class="fu">Error</span>(block<span class="sc">/</span>feeding), </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> block_long_ranked_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: ranked_jump_length
   Effect         df   MSE    F  ges p.value
1 feeding 1.91, 7.66 22.79 1.99 .310    .202
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
</section>
</section>
<section id="für-ein-design-mit-wiederholten-messungen" class="level3" data-number="37.5.2">
<h3 data-number="37.5.2" class="anchored" data-anchor-id="für-ein-design-mit-wiederholten-messungen"><span class="header-section-number">37.5.2</span> … für ein Design mit wiederholten Messungen</h3>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://seriousstats.wordpress.com/2012/02/14/friedman/">Beware the Friedman test!</a> Das ist der wichtigste Punkt. Wenn du den Friedman Test rechnen willst, weil in deinen Zeilen Messwiederholungen sind, dann bitte lassen. Du also bei jedem Floh wiederholt die Sprungweite gemessen und möchtest jetzt wissen, ob es einen Unterschied in den Zeitpunkten gibt. Die Alternativen hat <span class="citation" data-cites="zimmerman1993relative">Zimmerman &amp; Zumbo (<a href="#ref-zimmerman1993relative" role="doc-biblioref">1993</a>)</span> einmal diskutiert und ich zeige dir dann auch die besseren Lösungen.</p>
</div>
</div>
<p>Die Frage ist, warum sollte man auf Messwiederholungen einen Friedman Test rechnen? Weil die Normalverteilung für den Messwert in einer ANOVA nicht gegeben ist. Dafür brauchen wir aber nicht den Friedman Test wir können da auch einen anderen Weg gehen. Nach dem folgenden Zitat können wir auch eine repeated ANOVA rechnen. Das machen wir dann auch gleich im Anschluss. Wenn du dich dafür entscheidest, die Alternative zu nutzen, dann kannst du gerne einmal die Arbeit von <span class="citation" data-cites="zimmerman1993relative">Zimmerman &amp; Zumbo (<a href="#ref-zimmerman1993relative" role="doc-biblioref">1993</a>)</span> zitieren.</p>
<blockquote class="blockquote">
<p><em>“[In cases] where one-way repeated measures ANOVA is not appropriate, rank transformation followed by ANOVA will provide a more robust test with greater statistical power than the Friedman test.” — <a href="https://seriousstats.wordpress.com/2012/02/14/friedman/">Beware the Friedman test!</a> und <span class="citation" data-cites="zimmerman1993relative">Zimmerman &amp; Zumbo (<a href="#ref-zimmerman1993relative" role="doc-biblioref">1993</a>)</span></em></p>
</blockquote>
<p>Aber wie immer zeige ich natürlich auch die Anwendung des Friedman Test auf unser Design mit wiederholten Messungen. Hier haben wir dann unsere einzelnen Hundeflöhe wiederholt zu unterschiedlichen Zeitpunkten gemessen. Daher sind die einzelnen Zeitpunkte für jeden Floh nicht unabhängig voneinander. Leider ignoriert der Friedman Test jegliche Beziehungen zwischen den Flöhen, so dass hier der Test mit Vorsicht zu genießen ist.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><code>{stats}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false"><code>{rstatix}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false"><code>{nparcomp}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Die Frage bei den nichtparametrischen Tests ist ja immer, wie wir die Ränge bilden. In dem Fall des Friedman Tests bilden wir die Ränge über die Zeilen. Das heißt, wir schauen uns den ersten Block an und sortieren die beobachteten Sprungweiten und vergeben dann absteigend Ränge. Der größte Wert kriegt den ersten Rang und der kleinste Werte den letzten Rang. Das machen wir dann für jede weitere Zeile. Am Ende bilden wir dann die Rangsummen für jeden Zeitpunkt. Dafür addieren wir die Ränge einfach auf.</p>
<div id="tbl-friedman-theo-block" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-friedman-theo-block-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;37.6— Datentabelle des Designs mit Messwiederholungen mit den Sprungweiten individueller Flöhe unter drei Ernährungsarten. Pro Zeile wird den beobachteten Sprungweiten ein Rang zugeordnet. Die Summe der Ränge wird pro Spalte gebildet.
</figcaption>
<div aria-describedby="tbl-friedman-theo-block-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Floh</th>
<th style="text-align: center;">Zeitpunkt 1</th>
<th style="text-align: center;">Zeitpunkt 2</th>
<th style="text-align: center;">Zeitpunkt 3</th>
<th style="text-align: center;">Zeitpunkt 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(10.2 \rightarrow 4\)</span></td>
<td style="text-align: center;"><span class="math inline">\(12.4 \rightarrow 2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(11.1 \rightarrow 3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(13.4 \rightarrow 1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(8.3 \rightarrow 2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9.1 \rightarrow 1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(6.8 \rightarrow 4\)</span></td>
<td style="text-align: center;"><span class="math inline">\(7.1 \rightarrow 3\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;"><span class="math inline">\(12.1 \rightarrow 3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(15.1 \rightarrow 1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(11.3 \rightarrow 4\)</span></td>
<td style="text-align: center;"><span class="math inline">\(12.5 \rightarrow 2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;"><span class="math inline">\(7.8 \rightarrow 3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8.1 \rightarrow 2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(5.6 \rightarrow 4\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8.2 \rightarrow 1\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;"><span class="math inline">\(8.6 \rightarrow 3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(10.3 \rightarrow 2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8.1 \rightarrow 4\)</span></td>
<td style="text-align: center;"><span class="math inline">\(11.3 \rightarrow 1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\sum\)</span></td>
<td style="text-align: center;"><span class="math inline">\(15\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8\)</span></td>
<td style="text-align: center;"><span class="math inline">\(19\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wenn wir keinen Effekt der Ernährungsformen erwarten würden, dann würde immer mal wieder jede Ernährungsform große oder kleine Ränge erhalten. Bei einer zufälligen Anordnung würden wir daher eine Rangsumme von <span class="math inline">\(E(R)\)</span> gleich 12.5 erwarten.</p>
<p><span class="math display">\[
E(R) = \cfrac{N(k+1)}{2} = \cfrac{5(4+1)}{2} = 12.5
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(k\)</span> ist die Anzahl an Gruppen. Hier also die Spalten der Daten.</li>
<li><span class="math inline">\(N\)</span> der Gesamtzahl an Beobachtungen also die gesamte Fallzahl. Hier also die Zeilen der Daten.</li>
</ul>
<p>Wir sehen, dass wir nahe dran sind und fragen uns jetzt, ob die Abweichung schon signifikant sein kann. Dafür können wir hier ein <span class="math inline">\(\mathcal{X_D}^2\)</span> Statistik berechnen, die uns bei der Beantwortung hilft. Ja, wir können auch in anderen Tests wieder auf andere bekannte Teststatistiken zurückgreifen.</p>
<p><span class="math display">\[
\mathcal{X_D}^2 = \cfrac{12}{N \cdot k \cdot (k+1)} \cdot \sum R^2 - 3 \cdot N \cdot (k+1)
\]</span></p>
<ul>
<li><span class="math inline">\(R\)</span> der Rangsummen für jede Gruppe mit insgesamt <span class="math inline">\(k\)</span> Gruppen.</li>
<li><span class="math inline">\(k\)</span> ist die Anzahl an Gruppen. Hier also die Spalten der Daten.</li>
<li><span class="math inline">\(N\)</span> der Gesamtzahl an Beobachtungen also die gesamte Fallzahl. Hier also die Zeilen der Daten.</li>
</ul>
<p>Dann setzen wir mal alle Zahlen in die Formel ein und rechnen einmal aus, was wir für eine <span class="math inline">\(\mathcal{X_D}^2\)</span> Statistik erhalten. Je größer die Teststatistik ist, desto eher lehnen wir die Nullhypothese ab.</p>
<p><span class="math display">\[
\begin{aligned}
\mathcal{X_D}^2 &amp;= \cfrac{12}{5 \cdot 4 \cdot (4+1)} \cdot (15^2 + 8^2 + 19^2 + 8^2) - 3 \cdot 5 \cdot (4+1) \\
&amp;= 0.12 \cdot 714 - 75 \\
&amp;= 10.68
\end{aligned}
\]</span></p>
<p>Wir haben den kritischen Wert <span class="math inline">\(\mathcal{X}^2_{\alpha = 5\%}\)</span> in unserem Fall mit <span class="math inline">\(7.82\)</span> gegeben. Wenn die <span class="math inline">\(\mathcal{X_D}^2\)</span> Statistik größer ist als der kritische Wert, können wir die Nullhypothese ablehnen. Das ist hier tatsächlich der Fall. Wir sehen also einen signifikanten Unterschied zwischen den Zeitpunkten.</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Dann kommen wir auch schon zu dem statistischen Test in <code>{stats}</code>. Wir müssen hier nur schauen, dass die Zeilen als Faktor hinter dem Strich <code>|</code> stehen. Dann rechnet sich alles sehr schnell.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">friedman.test</span>(jump_length <span class="sc">~</span> time_fct <span class="sc">|</span> flea_id, <span class="at">data =</span> repeated_long_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Friedman rank sum test

data:  jump_length and time_fct and flea_id
Friedman chi-squared = 10.68, df = 3, p-value = 0.01359</code></pre>
</div>
</div>
<p>Nachdem wir die Funktion aufgerufen haben, erhalten wir auch gleich den <span class="math inline">\(p\)</span>-Wert von <span class="math inline">\(0.014\)</span> wieder. Da der <span class="math inline">\(p\)</span>-Wert kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% können wir die Nullhypothese ablehnen. Das war auch anhand des Doplots zu erwarten.</p>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>Dann kommen wir auch schon zu dem statistischen Test in <code>{rstatix}</code> mit der Funktion <code>friedman_test()</code>. Da die Funktion gleich heißt wie im R Paket <code>{coin}</code> muss ich die Funktion nochmal explizit aufrufen. Wir müssen hier nur schauen, dass die Zeilen als Faktor hinter dem Strich <code>|</code> stehen. Dann rechnet sich alles sehr schnell. Mehr zu der Funktion erfährst du auch im Tutorium <a href="https://www.datanovia.com/en/lessons/friedman-test-in-r/">Friedman Test in R</a>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>rstatix<span class="sc">::</span><span class="fu">friedman_test</span>(jump_length <span class="sc">~</span> time_fct <span class="sc">|</span> flea_id, <span class="at">data =</span> repeated_long_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  .y.             n statistic    df      p method       
* &lt;chr&gt;       &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;        
1 jump_length     5      10.7     3 0.0136 Friedman test</code></pre>
</div>
</div>
<p>Nachdem wir die Funktion aufgerufen haben, erhalten wir auch gleich den <span class="math inline">\(p\)</span>-Wert von <span class="math inline">\(0.012\)</span> wieder. Damit fast das gleiche Eregbnis wie schon vorher. Da der <span class="math inline">\(p\)</span>-Wert kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% können wir die Nullhypothese ablehnen. Das war auch anhand des Doplots zu erwarten.</p>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<p>Abschöießend gibt es noch in dem R Paket <code>{nparcomp}</code> die Funktion <code>mctp.rm()</code> die es uns ermöglicht eine repeated ANOVA mit einem nichtparametrischen Verfahren zu rechnen. Daher ist diese Variante natürlich den anderen beiden vorzuziehen. Wir erhalten hier aber keine globale Aussage sondern gleich die paarweisen Vergleiche. Sozusagen der Post-hoc Test in einem Test. Wir müssen uns hier leider merken welche Faktorlevel wir vorliegen haben, den die Ausgabe gibt uns leider nur die Zahlen und nicht die Gruppennamen. Das ist natürlich unschön und fehleranfällig. Wir haben eine automatische Adjustierung für multiple Vergleiche.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mctp.rm_obj <span class="ot">&lt;-</span> <span class="fu">mctp.rm</span>(jump_length <span class="sc">~</span> time_fct, <span class="at">data =</span> repeated_long_tbl,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">info =</span> <span class="cn">FALSE</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>mctp.rm_obj<span class="sc">$</span>Analysis</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Estimator  Lower  Upper Statistic    p.Value
2 - 1     0.394 -0.262  1.050     2.208 0.20206184
3 - 1    -0.297 -1.392  0.799    -0.997 0.66981688
4 - 1     0.320 -1.115  1.755     0.820 0.76813230
3 - 2    -0.690 -1.239 -0.142    -4.632 0.02391539
4 - 2    -0.074 -1.024  0.877    -0.286 0.98254292
4 - 3     0.617 -0.002  1.235     3.668 0.05080849</code></pre>
</div>
</div>
<p>Wir sehen, dass nur der Zeitpunkt <code>t3</code> mit dem Zeitpunkt <code>t2</code> signifikant unterschiedlich ist. Alle anderen Zeitpunkte sind zeigen keinen p-Wert unter dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> vo 5%.</p>
</div>
</div>
</div>
<section id="parametrische-lösung-die-repeated-anova" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="parametrische-lösung-die-repeated-anova">Parametrische Lösung: Die repeated ANOVA</h4>
<p>Dann hier auch die parametrische Lösung des Problems mit der repeated ANOVA. Wir wollen jetzt einfach nur unsere Messwerte einmal Rangtransformieren. Dafür nutze ich entweder die Funktion <code>rank()</code> oder aber die folgende Funktion <code>signed_rank()</code>, wenn ich negative Werte in meinen Messungen erwarte.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>signed_rank <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sign</span>(x) <span class="sc">*</span> <span class="fu">rank</span>(<span class="fu">abs</span>(x))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Konkret habe ich meine Sprungweiten der Flöhe. Jetzt mutiere ich die Sprungweite über die Funktion <code>signed_rank()</code> in Ränge und nutze diese Spalte dann für die ANOVA.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>repeated_long_ranked_tbl <span class="ot">&lt;-</span> repeated_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ranked_jump_length =</span> <span class="fu">signed_rank</span>(jump_length))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir können die Daten in der Form als Messwiederholungen innerhalb des Flöhe modellieren. Dann haben wir ein einfaktorielles repeated Design für die ANOVA. Hier nutze ich die Funktion <code>aov_car()</code> aus dem R Paket <code>{afex}</code>. Hier sehen wir, dass wir dann einen signifikanten Unterschied finden unser p-Wert ist mit <span class="math inline">\(0.041\)</span> immer noch kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span>. Der p-Wert ist nicht ganz so klein wie bei dem Friedman Test.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(ranked_jump_length <span class="sc">~</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(flea_id<span class="sc">/</span>time_fct), </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> repeated_long_ranked_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: ranked_jump_length
    Effect         df   MSE      F  ges p.value
1 time_fct 1.38, 5.53 11.46 6.53 * .156    .041
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '+' 0.1 ' ' 1

Sphericity correction method: GG </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="post-hoc-test" class="level2" data-number="37.6">
<h2 data-number="37.6" class="anchored" data-anchor-id="post-hoc-test"><span class="header-section-number">37.6</span> Post-hoc Test</h2>
<p>Wenn wir dann einen signifikanten Unterschied gefunden haben, dann müssen wir ja noch einen Post-hoc Test rechnen. Für das einfache Design mit den Messwiederholungen würde ich dann gleich <code>{nparcomp}</code> empfehlen, wenn es ein nichtparametrischer Test sein soll. Dort haben wir dann auch gleich die paarweisen Vergleiche mit drin. Wenn es dann doch klassischer mit Friedman als Vortest sein soll, dann hier die zwei Alternativen für den Post-hoc Test. Beide Pakete sind schon etwas älter, was die Bedienung der Funktionen angeht.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true"><code>{pgirmess}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false"><code>{PMCMRplus}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Das R Paket <code>{pgirmess}</code> erlaubt es mit dem <code>friedmanmc()</code> einen paarweisen Friedman Test zu rechnen. Wir haben hier eine veraltete Nutzung ohne die Formelschreibweise, so dass wir hier die einzelnen Variablen händisch den Optionen zuordnen müssen. Wir müssten händisch das Signifikanzniveau adjustieren oder aber händisch die p-Werte anpassen, wenn wir für multiple Vergleiche adjustieren wollen würden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>friedmanmc_res <span class="ot">&lt;-</span>  <span class="fu">friedmanmc</span>(<span class="at">y =</span> block_long_tbl<span class="sc">$</span>jump_length,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">groups =</span> block_long_tbl<span class="sc">$</span>feeding,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">blocks =</span> block_long_tbl<span class="sc">$</span>block)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>friedmanmc_res</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Multiple comparisons between groups after Friedman test 
alpha: 0.05 
Comparisons
              obs.dif critical.dif stat.signif p.value
ctrl-blood          0     7.570429       FALSE       1
ctrl-ketchup        3     7.570429       FALSE       1
blood-ketchup       3     7.570429       FALSE       1</code></pre>
</div>
</div>
<p>Dann sehen wir auch schon, dass wir keinen signifkanten Unterschied in den paarweisen Vergleichen vorliegen haben. Alle p-Werte sind größer als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5%. Wir können keine Nullhypothese der Vergleiche ablehnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>friedmanmc_tbl <span class="ot">&lt;-</span> friedmanmc_res<span class="sc">$</span>dif.com <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"comparison"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Am Ende wollen wir dann noch das <em>Compact letter display</em> haben und nutzen dann dafür die Funktion <code>cldList()</code>. Wir sehen dann aber natürlich hier auch keinen Unterschied. Leider gibt es keine Möglichkeit die 95% Konfidenzintervalle zu erhalten. Wir auch beim Kruskal-Wallis-Test erhalten wir bei dem Friedman Test keine 95% Konfidenzintervalle und müssen im Zweifel mit dieser Einschränkung leben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cldList</span>(p.value <span class="sc">~</span> comparison, <span class="at">data =</span> friedmanmc_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Group Letter MonoLetter
1    ctrl      a          a
2   blood      a          a
3 ketchup      a          a</code></pre>
</div>
</div>
<p>Wenn du willst kannst du den paarweisen Vergleich auch für das einfache Design für die Messweiderholungen einmal selber rechnen. Die Funktionen sind die gleichen aber du musst natürlich den Datensatz und die Variablen anpassen.</p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Nachdem wir jetzt festgestellt haben, dass sich mindestens ein Gruppenunterschied zwischen den Weizensorten finden lassen muss, wollen wir noch feststellen wo dieser Unterschied liegt. Wir nutzen dafür den Siegel- und Castellan-Vergleichstests für alle Paare durch. Der Test ist mit der Funktion <code>frdAllPairsSiegelTest()</code> in dem R Paket <code>{PMCMRplus}</code> implementiert und einfach nutzbar. In dem Paket sind noch eine weitere Reihe an statistischen Test für paarweise nicht-parametrische Test enthalten. Leider sind das Paket und die Funktion schon älter, so dass wir nicht einmal die Formelschreibweise zu Verfügung haben. Wir müssen alle Spalten aus unserem Datensatz mit dem <code>$</code> einzeln selektieren und den Optionen zuordnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>siegel_test_res <span class="ot">&lt;-</span>  <span class="fu">frdAllPairsSiegelTest</span>(<span class="at">y =</span> block_long_tbl<span class="sc">$</span>jump_length,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">groups =</span> block_long_tbl<span class="sc">$</span>feeding,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">blocks =</span> block_long_tbl<span class="sc">$</span>block,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">p.adjust.method =</span> <span class="st">"none"</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>siegel_test_res</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        ctrl blood
blood   1.00 -    
ketchup 0.34 0.34 </code></pre>
</div>
</div>
<p>Ich empfehle ja immer eine Adjustierung für multiple Vergleiche, aber du kannst das selber entscheiden. Wenn du für die multiplen Vergleiche adjustieren willst, dann nutze gerne die Option <code>p.adjust.method = "bonferroni"</code> oder eben statt <code>bonferroni</code> die Adjustierungsmethode <code>fdr</code>.</p>
<p>Damit wir auch das <em>compact letter display</em> aus unseren <span class="math inline">\(p\)</span>-Werte berechnen können, müssen wir unser Ergebnisobjekt nochmal in eine Tabelle umwandeln. Dafür gibt es dann auch eine passende Funktion mit <code>PMCMRTable</code>. Wir sehen, es ist alles etwas altbacken.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>siegel_test_tab <span class="ot">&lt;-</span> <span class="fu">PMCMRTable</span>(siegel_test_res)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>siegel_test_tab</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Comparison p.value
1    blood - ctrl = 0       1
2  ketchup - ctrl = 0   0.343
3 ketchup - blood = 0   0.343</code></pre>
</div>
</div>
<p>Nachdem wir die Tabellenschreibweise der <span class="math inline">\(p\)</span>-Werte vorliegen haben, können wir dann das <em>compact letter display</em> uns über die Funktion <code>cldList()</code> anzeigen lassen. Leider gibt es keine Möglichkeit die 95% Konfidenzintervalle zu erhalten. Wir auch beim Kruskal-Wallis-Test erhalten wir bei dem Friedman Test keine 95% Konfidenzintervalle und müssen im Zweifel mit dieser Einschränkung leben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cldList</span>(p.value <span class="sc">~</span> Comparison, <span class="at">data =</span> siegel_test_tab)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Group Letter MonoLetter
1   blood      a          a
2 ketchup      a          a
3    ctrl      a          a</code></pre>
</div>
</div>
<p>Am <em>compact letter display</em> sehen wir im Prinzip das gleiche Muster wie in den <span class="math inline">\(p\)</span>-Werten. Nur nochmal etwas anders dargestellt und mit dem Fokus auf die <em>nicht</em> Unterschiede.</p>
</div>
</div>
</div>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-zimmerman1993relative" class="csl-entry" role="listitem">
Zimmerman, D. W., &amp; Zumbo, B. D. (1993). Relative power of the Wilcoxon test, the Friedman test, and repeated-measures ANOVA on ranks. <em>The Journal of Experimental Education</em>, <em>62</em>(1), 75–86.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-tests-kruskal.html" class="pagination-link" aria-label="Der Kruskal-Wallis-Test">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-tests-chi-test.html" class="pagination-link" aria-label="Der Chi-Quadrat-Test">
        <span class="nav-page-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Chi-Quadrat-Test</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb44" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc, performance, parameters,</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="in">               latex2exp, see, patchwork, mfp, multcomp, emmeans, janitor, effectsize,</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="in">               broom, ggmosaic, tinytable, ggrepel, tidyplots,</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="in">               conflicted)</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="in">cb_pal &lt;- c("#000000", "#E69F00", "#56B4E9", </span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="in">            "#009E73", "#F0E442", "#F5C710", </span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="in">            "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- cb_pal</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="in">source("stat-tests-anova_plot/repeated_plots.R")</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="fu"># Der Friedman Test {#sec-friedman}</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-tests-friedman.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"It's easy to lie with statistics. It's hard to tell the truth without statistics." --- Andrejs Dunkels*</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>Willkommen in der Gruft. Der Friedman Test ist schlecht und sollte nicht angewendet werden. Das Kapitel existiert eigentlich nur, damit du es finden kannst und gleich lesen kannst, dass du den Friedman Test sein lassen sollst. Weder tut der Friedman Test, dass was du von ihm verlangst, noch macht er das was er tut besonders im statistischen Sinne gut. Am besten rechnest du nach @zimmerman1993relative auf den rangtransformierten Messwerten eine repeated ANOVA, wie ich dir weiter unten zeige.</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/personal_opinion.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Sollte man statistische Test schlecht machen? Vermutlich ja. Einige Tests haben einfach Ihren Zenit erreicht und sind einfach nicht mehr der Stand der Wissenschaft im 21. Jahrhundert. Deshalb bitte einfach zurücklassen und sich nicht mehr drum kümmern." --- Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.*</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## Allgemeiner Hintergrund</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>Der Friedman Test ist der Kruskal Wallis Test für abhängige Daten. Oder doch nicht? Wenn man sich mit den Friedman Test beschäftigt, dann wird einem nach einer etwas längeren Internetscuhe dann doch klar, dass hier irgendwas nicht so richtig stimmt. Es gibt nämlich <span class="co">[</span><span class="ot">zwei Arten des Friedman Tests</span><span class="co">](https://math.montana.edu/jobo/thainp/ksampa.pdf)</span>. Also eigentlich auch nein, es gibt nur einen Friedman Test aber zwei Arten den Test anzuwenden. Wir können den Friedman Test einmal in den Agrarwissenschaften nutzen um ein randomisiertes vollständiges Blockdesign (eng. *Randomized Complete Block Design*) auszuwerten. In den Geisteswissenschaften wird der Friedman Test gerne für ein einfaches Design mit wiederholten Messungen (eng. *Simple Repeated Measures Design*) genutzt. Damit fängt es schon an, denn die beiden Designs haben was gemeinsam aber dann auch wieder nicht. Also wir merken uns, je nachdem aus welcher Fachrichtung du kommst, mag der Firedman Test für dich was anderes bedeuten. In beiden Fällen heißt es aber <span class="co">[</span><span class="ot">"Beware the Friedman test!"</span><span class="co">](https://seriousstats.wordpress.com/2012/02/14/friedman/)</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>Hilft ja alles nichts, fangen wir also einmal an uns anzuschauen, was der Friedman Test macht. Du findest noch ein gutes <span class="co">[</span><span class="ot">Tutorium zum Friedman Test</span><span class="co">](https://rcompanion.org/handbook/F_10.html)</span> sowie die Alternative einer repeated ANOVA auf den rangtransformierten Messwerten nach @zimmerman1993relative. Wir schauen uns diese Lösung dann auch einmal an. Wichtig ist noch zu wissen, dass die asymptotische Effizienz des Friedman-Tests bei $0.955 \cdot J/(J+1)$, also bei $0.64$ für $J=2$ und $0.87$ für $J=10$ liegt. Wir beschrieben mit $J$ die Anzahl der Gruppen oder Versuchsbedingungen also den Spalten ist. Bei einer Effizienz von $0.64$ braucht der Friedman Test somit eine um $(100-64)/64$ gleich $0.56$ also eine ca. 50% größere Stichprobe um die selbe Signifikanz zu erreichen. Oder etwas anders, dass der Friedman Test $50\%$ mehr Fallzahl benötigt um die gleiche Effizienz zu haben wie eine einfaktorielle ANOVA, deren Annahmen an die Normalverteilung und Varianzhomogenität erfüllt werden. Der Begriff der Effizienz ist hier natürlich etwas wage, aber du kannst den Begriff für dich auch vereinfacht als gleiche statistische Eigenschaften was die Signifikanz angeht lesen. Der Friedman Test braucht also sehr viele Gruppen in den Spalten.</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Datenformat {.unnumbered .unlisted}</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>Sprechen wir nochmal über das Datenformat. In der Datentabelle für den Friedman Test haben wir keine Wiederholungen für die Faktorkombinationen vorliegen, wie du in der folgenden Tabelle siehst. Solltest du wiederholt Faktorkombinationen gemessen haben, dann müsstest du die Daten erst Aggregieren. Was wiederum wirr ist, denn damit verlierst du Informationen. Heutzutage kannst du auch auf den vollen Datensätzen rechnen. Wir haben also in den Spalten den Faktor $A$ mit den Leveln $A.1$ bis $A.4$ vorliegen. Der Faktor $A$ beschreibt die Versuchsbedingungen, wie Behandlung oder Sorte. Du kannst natürlich auch mehr als vier Behandlungen vorliegen haben. In den Zeilen findest du dann den Faktor $B$ für die Messwiederholungen oder Blöcke. Wir haben hier fünf Level im Faktor $B$ vorliegen. Damit sieht die Tabelle eher wie eine Kreuztabelle einer deskriptiven Statistik aus als ein Datensatz.</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>| Faktor B | A.1  | A.2  | A.3  | A.4  |</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>|----------|------|------|------|------|</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>| **B.1**  | 9.1  | 10.2 | 12.2 | 14.1 |</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>| **B.2**  | 4.2  | 5.2  | 6.2  | 7.3  |</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>| **B.3**  | 12.1 | 14.5 | 12.5 | 13.7 |</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>| **B.4**  | 1.2  | 3.6  | 3.5  | 7.1  |</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>| **B.5**  | 4.1  | 4.5  | 4.7  | 8.1  |</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>: Beispielhafte, aggregierte Datentabelle für einen Friedman Test mit vier Behandlungen in den Spalten und fünf Wiederholungen in den Zeilen. In den Spalten ist der Behandlungsfaktor A mit den entsprechenden Leveln A.1 bis A.4 eingetragen. In den Zeilen finden sich der Faktor für Wiederholungen wie Blöcke oder individuelle IDs mit den entsprechenden Leveln B.1 bis B.5 eingetragen. Es liegen keine Messwiederholungen für die Faktorkombinationen vor. {#tbl-test}</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>Dann wollen wir gleich einmal den Friedman Test anwenden. Dafür habe ich dann auch wieder die passenden R Paket sowie zwei Datensätze mitgebracht. Am Ende musst du schauen, ob du deine Daten mit dem Friedman Test auswerten möchtest. Der Friedman Test hat Probleme bei wenigen Behandlungen und Blöcken einen Effekt signifikant zu finden. Solltest du nur eine aggregierte Datentabelle haben, dann mag der Friedman Test eine Lösung für dein Problem sein.</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, broom, pgirmess,</span></span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a><span class="in">               readxl, rstatix, coin, nparcomp,</span></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a><span class="in">               effectsize, PMCMRplus, rcompanion,</span></span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a><span class="in">               afex, conflicted)</span></span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a>Eigentlich sind die Datensätze hier zweimal das Gleiche, aber es gibt eben diese <span class="co">[</span><span class="ot">zwei Arten des Friedman Tests</span><span class="co">](https://math.montana.edu/jobo/thainp/ksampa.pdf)</span>, die im Orbit rumgeistern. Deshalb hier im Folgenden einmal der agrawissenschaftliche Datensatz mit einem, Block in den Zeilen sowie einen Datensatz zu Messwiederholungen an Individuen mit unseren Flöhen. Damit haben wir beide Fälle abgefrühstückt und können uns dann die Auswertung einmal näher anschauen.</span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a><span class="fu">## Randomisiertes vollständiges Blockdesign</span></span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a>Beginnen wir einmal mit dem randomisierten vollständigen Blockdesign (eng. *Randomized Complete Block Design*). Wir haben die Daten in der folgenden Datei in dem Reiter <span class="in">`block`</span> abliegen. Die Besonderheit ist hier, dass wir dennoch Messwiederholungen in den Blöcken vorliegen haben. Sehe einfahc die Blöcke als verschiedene Käfige. Ich habe die Daten mal etwas realistischer gebaut. Wir haben hier pro Block jeweils die Sprungweite von drei Hundeflöhen gemessen. Dabei sind die Flöhe dann unter verschiedenen Ernährungsformen gesprungen. Wir haben aber nicht den gleichen Floh in jeder Behandlung gemessen. Jeder Zahlenwert entspricht der Sprungweite eines individuellen Hundeflohs. Der Weg hier vom Wide-Format zum Long-Format über die Aggregation ist etwas lang, aber geht so nicht anders.</span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a>block_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/friedman_data.xlsx"</span>,</span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sheet =</span> <span class="st">"block"</span>) </span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a>In der folgenden Datentabelle siehst du einmal den Datensatz mit den Sprungweiten unter den verschiedenen Ernährungsformen. Wir haben eine Wiederholung in den Blöcken vorliegen, diese Wiederholung müssen wir dann noch aggregieren, so dass wir dann nur eine Zeile pro Block haben.</span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1fac-table-block</span></span>
<span id="cb44-96"><a href="#cb44-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Auszug aus der Datentabelle eines randomisierten vollständigen Blockdesign mit drei Messweiderholungen pro Block. Ein Block kann als ein Käfig angesehen werden. Für die einzelnen Hundeflöhe wurden unter verschiedenen Ernährungsformen die Sprungweiten gemessen. Jeder Wert entspricht einem individuellen Floh. Die Daten müssen noch aggregiert werden damit wir den Friedman Test anwenden können."</span></span>
<span id="cb44-97"><a href="#cb44-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a>block_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/friedman_data.xlsx"</span>,</span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a>                        <span class="at">sheet =</span> <span class="st">"block"</span>) </span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(block_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>),</span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(block_raw_tbl)),</span>
<span id="cb44-103"><a href="#cb44-103" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(block_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb44-104"><a href="#cb44-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb44-105"><a href="#cb44-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-106"><a href="#cb44-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-107"><a href="#cb44-107" aria-hidden="true" tabindex="-1"></a>Dann bilden wir einmal den Mittelwert über jede Zeile für jeden Block. Somit haben wir dann die Blockmittel für jede Ernährungsform und nur noch einen Wert für die Sprungweite für jede Faktorkombination. In jeden Zahlenwert gehen jetzt die individuellen Sprungweiten der drei Hundeflöhe auf.</span>
<span id="cb44-108"><a href="#cb44-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-111"><a href="#cb44-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-112"><a href="#cb44-112" aria-hidden="true" tabindex="-1"></a>block_tbl <span class="ot">&lt;-</span> block_raw_tbl <span class="sc">|&gt;</span></span>
<span id="cb44-113"><a href="#cb44-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(block) <span class="sc">|&gt;</span> </span>
<span id="cb44-114"><a href="#cb44-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(ctrl<span class="sc">:</span>ketchup, mean))  </span>
<span id="cb44-115"><a href="#cb44-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-116"><a href="#cb44-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-117"><a href="#cb44-117" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle siehst du dann das Ergebnis der Aggregation. Wir haben dann nur noch eine Sprungweite der Hundeflöhe für jede Faktorkombination der Ernährungsform und des Blocks vorliegen.</span>
<span id="cb44-118"><a href="#cb44-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-121"><a href="#cb44-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-122"><a href="#cb44-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-123"><a href="#cb44-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-124"><a href="#cb44-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-125"><a href="#cb44-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1fac-table-block-aggr</span></span>
<span id="cb44-126"><a href="#cb44-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Aggregierte Datentabelle eines randomisierten vollständigen Blockdesign mit den mittleren Sprungweiten pro Block.  Jeder Wert entspricht dem Mittel der Sprungweiten der drei Flöhe. Jede Faktorkombination ist nur einmal vertreten."</span></span>
<span id="cb44-127"><a href="#cb44-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-128"><a href="#cb44-128" aria-hidden="true" tabindex="-1"></a>block_tbl <span class="sc">|&gt;</span> </span>
<span id="cb44-129"><a href="#cb44-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-130"><a href="#cb44-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb44-131"><a href="#cb44-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-132"><a href="#cb44-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-133"><a href="#cb44-133" aria-hidden="true" tabindex="-1"></a>Das reicht dann aber natürlich wieder nicht, den wir haben damit die Daten im Wide-Format in der vorherigen Tabelle vorliegen. Die Analysen in R verlangen aber da Long-Format, so dass ich hier nochmal mit der Funktion <span class="in">`pivot_longer()`</span> einen entsprechenden Datensatz baue. Dann kann ich auch gleich die entsprechenden Faktoren umwandeln.</span>
<span id="cb44-134"><a href="#cb44-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-137"><a href="#cb44-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-138"><a href="#cb44-138" aria-hidden="true" tabindex="-1"></a>block_long_tbl <span class="ot">&lt;-</span> block_tbl <span class="sc">|&gt;</span> </span>
<span id="cb44-139"><a href="#cb44-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> ctrl<span class="sc">:</span>ketchup,</span>
<span id="cb44-140"><a href="#cb44-140" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"feeding"</span>,</span>
<span id="cb44-141"><a href="#cb44-141" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-142"><a href="#cb44-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">block =</span> <span class="fu">as_factor</span>(block),</span>
<span id="cb44-143"><a href="#cb44-143" aria-hidden="true" tabindex="-1"></a>         <span class="at">feeding =</span> <span class="fu">as_factor</span>(feeding))</span>
<span id="cb44-144"><a href="#cb44-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-145"><a href="#cb44-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-146"><a href="#cb44-146" aria-hidden="true" tabindex="-1"></a>Der Weg war jetzt etwas länger, aber so ist es manchmal, wenn wir mit etwas veralteten Algorithmen rechnen wollen. In der folgenden Abbildung siehst du dann nochmal die Daten in einem Dotplot dargestellt. Wir sehen, dass die Kontrolle eine etwas weitere Sprungweite hat als das Blut und auch die Ernährung mit Ketchup.</span>
<span id="cb44-147"><a href="#cb44-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-150"><a href="#cb44-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-151"><a href="#cb44-151" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb44-152"><a href="#cb44-152" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-153"><a href="#cb44-153" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-154"><a href="#cb44-154" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-fried-ggplot-block</span></span>
<span id="cb44-155"><a href="#cb44-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb44-156"><a href="#cb44-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb44-157"><a href="#cb44-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb44-158"><a href="#cb44-158" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dotplot des Datenbeispiels für die fünf Blöcke und die drei Ernährungsformen."</span></span>
<span id="cb44-159"><a href="#cb44-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-160"><a href="#cb44-160" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(block_long_tbl, <span class="fu">aes</span>(feeding, jump_length, <span class="at">fill =</span> block)) <span class="sc">+</span></span>
<span id="cb44-161"><a href="#cb44-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-162"><a href="#cb44-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir=</span><span class="st">'center'</span>, </span>
<span id="cb44-163"><a href="#cb44-163" aria-hidden="true" tabindex="-1"></a>               <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb44-164"><a href="#cb44-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Ernährungsform"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">color =</span> <span class="st">"Block"</span>) <span class="sc">+</span></span>
<span id="cb44-165"><a href="#cb44-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb44-166"><a href="#cb44-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-167"><a href="#cb44-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-168"><a href="#cb44-168" aria-hidden="true" tabindex="-1"></a><span class="fu">## Design mit wiederholten Messungen</span></span>
<span id="cb44-169"><a href="#cb44-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-170"><a href="#cb44-170" aria-hidden="true" tabindex="-1"></a>Den zweiten Datensatz, den wir uns anschauen wollen, zeigt ein einfaches Design mit wiederholten Messungen (eng. *Simple Repeated Measures Design*). Wir haben hier also fünf Hundeflöhe vorliegen, die wir dann viermal springen lassen. Wir messen dann nach jedem Sprung einmal die Sprungweite. Damit haben wir dann über die Zeilen eine Messwiederholung in unseren Daten vorliegen.</span>
<span id="cb44-171"><a href="#cb44-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-174"><a href="#cb44-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-175"><a href="#cb44-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-176"><a href="#cb44-176" aria-hidden="true" tabindex="-1"></a>repeated_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/friedman_data.xlsx"</span>,</span>
<span id="cb44-177"><a href="#cb44-177" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sheet =</span> <span class="st">"repeated"</span>) </span>
<span id="cb44-178"><a href="#cb44-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-179"><a href="#cb44-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-180"><a href="#cb44-180" aria-hidden="true" tabindex="-1"></a>Wir haben damit folgenden Datensatz vorliegen. In den Zeilen sind die fünf Hundeflöhe, die jeweils zu vier Zeitpunkten einmal gesprungen sind. Wir haben dann zu jedem Zeitpunkt einmal die Sprungweite erfasst und aufgeschrieben. Die Messwerte sind damit abhängig. Damit ist der Datensatz sehr klassisch für einen Friedman Test.</span>
<span id="cb44-181"><a href="#cb44-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-184"><a href="#cb44-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-185"><a href="#cb44-185" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-186"><a href="#cb44-186" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-187"><a href="#cb44-187" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-188"><a href="#cb44-188" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1fac-table-repeated</span></span>
<span id="cb44-189"><a href="#cb44-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Datentabelle eines einfachen Design mit wiederholten Messungen für die Sprungweite zu vier Zeitpunkten. Fünf Hundeflöhe sind jeweils viermal gesprungen und die Sprungweiten wurden erfasst. Die Messwiederholungen laufen über die Zeilen."</span></span>
<span id="cb44-190"><a href="#cb44-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-191"><a href="#cb44-191" aria-hidden="true" tabindex="-1"></a>repeated_tbl <span class="sc">|&gt;</span> </span>
<span id="cb44-192"><a href="#cb44-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">1</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb44-193"><a href="#cb44-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-194"><a href="#cb44-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-195"><a href="#cb44-195" aria-hidden="true" tabindex="-1"></a>Das reicht dann aber natürlich noch nicht, den wir haben die Daten noch im Wide-Format in der vorherigen Tabelle vorliegen. Die Analysen in R verlangen aber da Long-Format, so dass ich hier nochmal mit der Funktion <span class="in">`pivot_longer()`</span> einen entsprechenden Datensatz baue. Dann kann ich auch gleich die entsprechenden Faktoren umwandeln.</span>
<span id="cb44-196"><a href="#cb44-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-199"><a href="#cb44-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-200"><a href="#cb44-200" aria-hidden="true" tabindex="-1"></a>repeated_long_tbl <span class="ot">&lt;-</span> repeated_tbl <span class="sc">|&gt;</span> </span>
<span id="cb44-201"><a href="#cb44-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t4,</span>
<span id="cb44-202"><a href="#cb44-202" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time"</span>,</span>
<span id="cb44-203"><a href="#cb44-203" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-204"><a href="#cb44-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">flea_id =</span> <span class="fu">as_factor</span>(flea_id),</span>
<span id="cb44-205"><a href="#cb44-205" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_fct =</span> <span class="fu">as_factor</span>(time))</span>
<span id="cb44-206"><a href="#cb44-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-207"><a href="#cb44-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-208"><a href="#cb44-208" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du dann nochmal die Daten in einem Dotplot dargestellt. Die Linien verbinden die einzelnen Flöhe und die Sprungweiten über die Zeiten miteinander. Wie wir sehen, haben wir die höchsten Sprungweiten zu dem Zeitpunkt <span class="in">`t2`</span> und weniger zu dem Zeitpunkt <span class="in">`t3`</span>. Hier scheint es einen Effekt der Zeit zu geben.</span>
<span id="cb44-209"><a href="#cb44-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-212"><a href="#cb44-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-213"><a href="#cb44-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb44-214"><a href="#cb44-214" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-215"><a href="#cb44-215" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-216"><a href="#cb44-216" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-fried-ggplot-repeated</span></span>
<span id="cb44-217"><a href="#cb44-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb44-218"><a href="#cb44-218" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb44-219"><a href="#cb44-219" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb44-220"><a href="#cb44-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dotplot des Datenbeispiels für die Bonitur von fünf Weizensorten."</span></span>
<span id="cb44-221"><a href="#cb44-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-222"><a href="#cb44-222" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(repeated_long_tbl, <span class="fu">aes</span>(time_fct, jump_length, <span class="at">fill =</span> flea_id)) <span class="sc">+</span></span>
<span id="cb44-223"><a href="#cb44-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-224"><a href="#cb44-224" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> flea_id), <span class="at">color =</span> <span class="st">"gray"</span>,</span>
<span id="cb44-225"><a href="#cb44-225" aria-hidden="true" tabindex="-1"></a>            <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb44-226"><a href="#cb44-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir=</span><span class="st">'center'</span>, </span>
<span id="cb44-227"><a href="#cb44-227" aria-hidden="true" tabindex="-1"></a>               <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.3</span>)) <span class="sc">+</span></span>
<span id="cb44-228"><a href="#cb44-228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Zeitpunkt"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">color =</span> <span class="st">"Floh ID"</span>) <span class="sc">+</span></span>
<span id="cb44-229"><a href="#cb44-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb44-230"><a href="#cb44-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-231"><a href="#cb44-231" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-232"><a href="#cb44-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-233"><a href="#cb44-233" aria-hidden="true" tabindex="-1"></a>Ich habe hier nochmal beide Datenformate dargestellt. Wir können in den Agrarwissenschaften nicht in den verschiedenen Blöcken wiederholt messen. Was wir in den einen Block Pflanzen wächst in dem einen Block und kann nicht nochmal woanders gemessen werden. Zwar ist ein Block eine Versuchseinheit, aber die Pflanzen oder Tiere, die in dem ersten Block stehen, stehen dann eben nicht in dem zweiten Block. Das ist technisch ja gar nicht möglich. Das hier zwei so unterschiedliche Fragestellungen angeblich mit dem gleichen Test beantwortet werden können, sollte einen schon stutzig machen.</span>
<span id="cb44-234"><a href="#cb44-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-235"><a href="#cb44-235" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hypothesen</span></span>
<span id="cb44-236"><a href="#cb44-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-237"><a href="#cb44-237" aria-hidden="true" tabindex="-1"></a>Der Friedman Test betrachtet die Gruppen und Ränge um einen Unterschied nachzuweisen. Daher haben wir in der Nullhypothese als Gleichheitshypothese folgende Prosahypothese. Mehr zu den Hintergründen der Hypothesen in einem nichtparametrischen Test findest du im <span class="co">[</span><span class="ot">Kapitel zum U-Test</span><span class="co">](#sec-utest)</span>.</span>
<span id="cb44-238"><a href="#cb44-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-239"><a href="#cb44-239" aria-hidden="true" tabindex="-1"></a>$H_0:$ *Die Gruppen werden aus Populationen mit identischen Verteilungen entnommen. Typisch ist, dass die Stichprobenpopulationen stochastische Gleichheit aufweisen. Daher sind häufig die Mediane gleich.*</span>
<span id="cb44-240"><a href="#cb44-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-241"><a href="#cb44-241" aria-hidden="true" tabindex="-1"></a>Die Alternative lautet, dass sich mindestens ein paarweiser Vergleich unterschiedet. Hierbei ist das mindestens ein Vergleich wichtig. Es können sich alle Gruppen unterschieden oder eben nur ein Paar. Wenn ein Friedman Test die $H_0$ ablehnt, also ein signifikantes Ergebnis liefert, dann wissen wir nicht, welche Gruppen sich unterscheiden und einen entsprechenden Post-hoc Test rechnen.</span>
<span id="cb44-242"><a href="#cb44-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-243"><a href="#cb44-243" aria-hidden="true" tabindex="-1"></a>$H_A:$ *Die Gruppen werden aus Populationen mit unterschiedlichen Verteilungen entnommen. Typischerweise weist eine der untersuchten Populationen eine stochastische Dominanz auf. Die Mediane sind häufig verschieden.*</span>
<span id="cb44-244"><a href="#cb44-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-245"><a href="#cb44-245" aria-hidden="true" tabindex="-1"></a>Wir schauen uns jetzt einmal den Friedman Test theoretisch an bevor wir uns mit der Anwendung des Friedman Test in R beschäftigen.</span>
<span id="cb44-246"><a href="#cb44-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-247"><a href="#cb44-247" aria-hidden="true" tabindex="-1"></a><span class="fu">## Der Friedman Test</span></span>
<span id="cb44-248"><a href="#cb44-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-249"><a href="#cb44-249" aria-hidden="true" tabindex="-1"></a>Beginnen wir nun mit der Umsetzung des Friedman Tests. Ich zeige dir hier beide Anwendungsfelder. Nur der erste Fall für ein randomisiertes vollständiges Blockdesign macht überhaupt Sinn. Andere Fall für ein einfaches Design mit Messwiederholungen ist nur hier um dich zu warnen. Der Friedman Test leidet unter Mängeln und sollte nicht verwendet werden.</span>
<span id="cb44-250"><a href="#cb44-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-251"><a href="#cb44-251" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... für ein randomisiertes vollständiges Blockdesign</span></span>
<span id="cb44-252"><a href="#cb44-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-253"><a href="#cb44-253" aria-hidden="true" tabindex="-1"></a>Der Friedman Test ist in R in verschiedenen Paketen implementiert. Alle Funktionen liefern mehr oder minder das gleiche Ergebnis. Wichtig ist wie wir in der Funktion das Modell definieren. Wir nutzen das Symbol <span class="in">`|`</span> um die Behandlung von dem Block zu trennen. Vor dem <span class="in">`|`</span> Symbol steht die Behandlung, hinter dem <span class="in">`|`</span> steht der Block. Damit sieht das Modell etwas anders aus, aber im Prinzip ist die Definition des Modells einfach. Diese Schreibweise ist in allen drei vorgestellten Paketen und Funktionen gleich. Ich würde keine der drei Funktionen benutzen, da ich den Friedman Test nicht rechnen würde. Betrachten wir aber zuerst einmal den theoretischen Teil.</span>
<span id="cb44-254"><a href="#cb44-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-255"><a href="#cb44-255" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb44-256"><a href="#cb44-256" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch</span></span>
<span id="cb44-257"><a href="#cb44-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-258"><a href="#cb44-258" aria-hidden="true" tabindex="-1"></a>Die Frage bei den nichtparametrischen Tests ist ja immer, wie wir die Ränge bilden. In dem Fall des Friedman Tests bilden wir die Ränge über die Zeilen. Das heißt, wir schauen uns den ersten Block an und sortieren die beobachteten Sprungweiten und vergeben dann absteigend Ränge. Der größte Wert kriegt den ersten Rang und der kleinste Werte den letzten Rang. Das machen wir dann für jede weitere Zeile. Am Ende bilden wir dann die Rangsummen für jede Ernährungsform. Dafür addieren wir die Ränge einfach auf.</span>
<span id="cb44-259"><a href="#cb44-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-260"><a href="#cb44-260" aria-hidden="true" tabindex="-1"></a>| Block  |      Kontrolle       |         Blut         |       Ketchup        |</span>
<span id="cb44-261"><a href="#cb44-261" aria-hidden="true" tabindex="-1"></a>|:------:|:--------------------:|:--------------------:|:--------------------:|</span>
<span id="cb44-262"><a href="#cb44-262" aria-hidden="true" tabindex="-1"></a>|   1    | $7.07 \rightarrow 1$ | $5.57 \rightarrow 2$ | $1.43 \rightarrow 3$ |</span>
<span id="cb44-263"><a href="#cb44-263" aria-hidden="true" tabindex="-1"></a>|   2    | $7.33 \rightarrow 2$ | $8.17 \rightarrow 1$ | $2.50 \rightarrow 3$ |</span>
<span id="cb44-264"><a href="#cb44-264" aria-hidden="true" tabindex="-1"></a>|   3    | $9.43 \rightarrow 1$ | $4.50 \rightarrow 2$ | $4.30 \rightarrow 3$ |</span>
<span id="cb44-265"><a href="#cb44-265" aria-hidden="true" tabindex="-1"></a>|   4    | $6.33 \rightarrow 2$ | $5.43 \rightarrow 3$ | $7.20 \rightarrow 1$ |</span>
<span id="cb44-266"><a href="#cb44-266" aria-hidden="true" tabindex="-1"></a>|   5    | $2.67 \rightarrow 3$ | $8.43 \rightarrow 1$ | $3.50 \rightarrow 2$ |</span>
<span id="cb44-267"><a href="#cb44-267" aria-hidden="true" tabindex="-1"></a>| $\sum$ |         $9$          |         $9$          |         $12$         |</span>
<span id="cb44-268"><a href="#cb44-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-269"><a href="#cb44-269" aria-hidden="true" tabindex="-1"></a>: Datentabelle des Blockdesigns mit den Sprungweiten der Flöhe unter drei Ernährungsarten. Pro Zeile wird den beobachteten Sprungweiten ein Rang zugeordnet. Die Summe der Ränge wird pro Spalte gebildet. {#tbl-friedman-theo-block}</span>
<span id="cb44-270"><a href="#cb44-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-271"><a href="#cb44-271" aria-hidden="true" tabindex="-1"></a>Wenn wir keinen Effekt der Ernährungsformen erwarten würden, dann würde immer mal wieder jede Ernährungsform große oder kleine Ränge erhalten. Bei einer zufälligen Anordnung würden wir daher eine Rangsumme von $E(R)$ gleich 10 erwarten.</span>
<span id="cb44-272"><a href="#cb44-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-273"><a href="#cb44-273" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-274"><a href="#cb44-274" aria-hidden="true" tabindex="-1"></a>E(R) = \cfrac{N(k+1)}{2} = \cfrac{5(3+1)}{2} = 10</span>
<span id="cb44-275"><a href="#cb44-275" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-276"><a href="#cb44-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-277"><a href="#cb44-277" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb44-278"><a href="#cb44-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-279"><a href="#cb44-279" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$k$ ist die Anzahl an Gruppen. Hier also die Spalten der Daten.</span>
<span id="cb44-280"><a href="#cb44-280" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$N$ der Gesamtzahl an Beobachtungen also die gesamte Fallzahl. Hier also die Zeilen der Daten.</span>
<span id="cb44-281"><a href="#cb44-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-282"><a href="#cb44-282" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass wir nahe dran sind und fragen uns jetzt, ob die leichte Abweichung schon signifikant sein kann. Dafür können wir hier ein $\mathcal{X_D}^2$ Statistik berechnen, die uns bei der Beantwortung hilft. Ja, wir können auch in anderen Tests wieder auf andere bekannte Teststatistiken zurückgreifen.</span>
<span id="cb44-283"><a href="#cb44-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-284"><a href="#cb44-284" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-285"><a href="#cb44-285" aria-hidden="true" tabindex="-1"></a>\mathcal{X_D}^2 = \cfrac{12}{N \cdot k \cdot (k+1)} \cdot \sum R^2 - 3 \cdot N \cdot (k+1)</span>
<span id="cb44-286"><a href="#cb44-286" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-287"><a href="#cb44-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-288"><a href="#cb44-288" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb44-289"><a href="#cb44-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-290"><a href="#cb44-290" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$R$ der Rangsummen für jede Gruppe mit insgesamt $k$ Gruppen.</span>
<span id="cb44-291"><a href="#cb44-291" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$k$ ist die Anzahl an Gruppen. Hier also die Spalten der Daten.</span>
<span id="cb44-292"><a href="#cb44-292" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$N$ der Gesamtzahl an Beobachtungen also die gesamte Fallzahl. Hier also die Zeilen der Daten.</span>
<span id="cb44-293"><a href="#cb44-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-294"><a href="#cb44-294" aria-hidden="true" tabindex="-1"></a>Dann setzen wir mal alle Zahlen in die Formel ein und rechnen einmal aus, was wir für eine $\mathcal{X_D}^2$ Statistik erhalten. Je größer die Teststatistik ist, desto eher lehnen wir die Nullhypothese ab.</span>
<span id="cb44-295"><a href="#cb44-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-296"><a href="#cb44-296" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-297"><a href="#cb44-297" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb44-298"><a href="#cb44-298" aria-hidden="true" tabindex="-1"></a>\mathcal{X_D}^2 &amp;= \cfrac{12}{5 \cdot 3 \cdot (3+1)} \cdot (9^2 + 9^2 + 12^2) - 3 \cdot 5 \cdot (3+1) <span class="sc">\\</span></span>
<span id="cb44-299"><a href="#cb44-299" aria-hidden="true" tabindex="-1"></a>&amp;= 0.2 \cdot 306 - 60 <span class="sc">\\</span></span>
<span id="cb44-300"><a href="#cb44-300" aria-hidden="true" tabindex="-1"></a>&amp;= 1.6</span>
<span id="cb44-301"><a href="#cb44-301" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb44-302"><a href="#cb44-302" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-303"><a href="#cb44-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-304"><a href="#cb44-304" aria-hidden="true" tabindex="-1"></a>Wir haben den kritischen Wert $\mathcal{X}^2_{\alpha = 5\%}$ in unserem Fall mit $5.99$ gegeben. Wenn die $\mathcal{X_D}^2$ Statistik größer ist als der kritische Wert, können wir die Nullhypothese ablehnen. Das ist hier nicht der Fall. Wir sehen also keinen signifikanten Unterschied zwischen den Ernährungsformen.</span>
<span id="cb44-305"><a href="#cb44-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-306"><a href="#cb44-306" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{stats}`</span></span>
<span id="cb44-307"><a href="#cb44-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-308"><a href="#cb44-308" aria-hidden="true" tabindex="-1"></a>Dann kommen wir auch schon zu dem statistischen Test in <span class="in">`{stats}`</span>. Wir müssen hier nur schauen, dass die Zeilen als Faktor hinter dem Strich <span class="in">`|`</span> stehen. Dann rechnet sich alles sehr schnell.</span>
<span id="cb44-309"><a href="#cb44-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-312"><a href="#cb44-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-313"><a href="#cb44-313" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-314"><a href="#cb44-314" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-315"><a href="#cb44-315" aria-hidden="true" tabindex="-1"></a><span class="fu">friedman.test</span>(jump_length <span class="sc">~</span> feeding <span class="sc">|</span> block, <span class="at">data =</span> block_long_tbl)</span>
<span id="cb44-316"><a href="#cb44-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-317"><a href="#cb44-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-318"><a href="#cb44-318" aria-hidden="true" tabindex="-1"></a>Nachdem wir die Funktion aufgerufen haben, erhalten wir auch gleich den $p$-Wert von $0.5488$ wieder. Da der $p$-Wert größer ist als das Signifikanzniveau $\alpha$ von 5% können wir die Nullhypothese nicht ablehnen. Das war auch anhand des Doplots zu erwarten.</span>
<span id="cb44-319"><a href="#cb44-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-320"><a href="#cb44-320" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{coin}`</span></span>
<span id="cb44-321"><a href="#cb44-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-322"><a href="#cb44-322" aria-hidden="true" tabindex="-1"></a>Dann kommen wir auch schon zu dem statistischen Test in <span class="in">`{coin}`</span> mit der Funktion <span class="in">`friedman_test()`</span>. Da die Funktion gleich heißt wie im R Paket <span class="in">`{rstatix}`</span> muss ich die Funktion nochmal explizit aufrufen. Wir müssen hier nur schauen, dass die Zeilen als Faktor hinter dem Strich <span class="in">`|`</span> stehen. Dann rechnet sich alles sehr schnell.</span>
<span id="cb44-323"><a href="#cb44-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-326"><a href="#cb44-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-327"><a href="#cb44-327" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-328"><a href="#cb44-328" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-329"><a href="#cb44-329" aria-hidden="true" tabindex="-1"></a>coin<span class="sc">::</span><span class="fu">friedman_test</span>(jump_length <span class="sc">~</span> feeding <span class="sc">|</span> block, <span class="at">data =</span> block_long_tbl)</span>
<span id="cb44-330"><a href="#cb44-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-331"><a href="#cb44-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-332"><a href="#cb44-332" aria-hidden="true" tabindex="-1"></a>Nachdem wir die Funktion aufgerufen haben, erhalten wir auch gleich den $p$-Wert von $0.5488$ wieder. Das gleiche Eregbnis wie schon vorher. Da der $p$-Wert größer ist als das Signifikanzniveau $\alpha$ von 5% können wir die Nullhypothese nicht ablehnen. Das war auch anhand des Doplots zu erwarten.</span>
<span id="cb44-333"><a href="#cb44-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-334"><a href="#cb44-334" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{rstatix}`</span></span>
<span id="cb44-335"><a href="#cb44-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-336"><a href="#cb44-336" aria-hidden="true" tabindex="-1"></a>Dann kommen wir auch schon zu dem statistischen Test in <span class="in">`{rstatix}`</span> mit der Funktion <span class="in">`friedman_test()`</span>. Da die Funktion gleich heißt wie im R Paket <span class="in">`{coin}`</span> muss ich die Funktion nochmal explizit aufrufen. Wir müssen hier nur schauen, dass die Zeilen als Faktor hinter dem Strich <span class="in">`|`</span> stehen. Dann rechnet sich alles sehr schnell. Mehr zu der Funktion erfährst du auch im Tutorium <span class="co">[</span><span class="ot">Friedman Test in R</span><span class="co">](https://www.datanovia.com/en/lessons/friedman-test-in-r/)</span>.</span>
<span id="cb44-337"><a href="#cb44-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-340"><a href="#cb44-340" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-341"><a href="#cb44-341" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-342"><a href="#cb44-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-343"><a href="#cb44-343" aria-hidden="true" tabindex="-1"></a>rstatix<span class="sc">::</span><span class="fu">friedman_test</span>(jump_length <span class="sc">~</span> feeding <span class="sc">|</span> block, <span class="at">data =</span> block_long_tbl)</span>
<span id="cb44-344"><a href="#cb44-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-345"><a href="#cb44-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-346"><a href="#cb44-346" aria-hidden="true" tabindex="-1"></a>Nachdem wir die Funktion aufgerufen haben, erhalten wir auch gleich den $p$-Wert von $0.5488$ wieder. Das gleiche Eregbnis wie schon vorher. Da der $p$-Wert größer ist als das Signifikanzniveau $\alpha$ von 5% können wir die Nullhypothese nicht ablehnen. Das war auch anhand des Doplots zu erwarten.</span>
<span id="cb44-347"><a href="#cb44-347" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-348"><a href="#cb44-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-349"><a href="#cb44-349" aria-hidden="true" tabindex="-1"></a>Wie wir sehen erhalten wir aus allen drei Funktionen den gleichen p-Wert. Hier kommt es dann eher darauf an mit welchem Paket du sonst so rechnest. Vermutlich würde ich dir das R Paket <span class="in">`{rstatix}`</span> empfehlen, weil wir hier dann auch gleich den Effektschätzer mit berechnen können. Sonst nehmen sich die Pakete bei einem so simplen Algorithmus wie dem Friedman Test nichts.</span>
<span id="cb44-350"><a href="#cb44-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-351"><a href="#cb44-351" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Effektschätzer {.unnumbered .unlisted}</span></span>
<span id="cb44-352"><a href="#cb44-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-353"><a href="#cb44-353" aria-hidden="true" tabindex="-1"></a>Wir können den Effektschätzer Kendall's $W$ im R Paket <span class="in">`{rstatix}`</span> mit der Funktion <span class="in">`friedman_effsize()`</span> berechnen. Dann erhalten wir auch gleich noch die Interpretation mitgeliefert, was es dann auch sehr viel einfacher macht. Kendall's $W$ hat nämlich keine direkte biologische Interpretation und so brauchen wir hier eine entsprechende Einordnung.</span>
<span id="cb44-354"><a href="#cb44-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-357"><a href="#cb44-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-358"><a href="#cb44-358" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-359"><a href="#cb44-359" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-360"><a href="#cb44-360" aria-hidden="true" tabindex="-1"></a><span class="fu">friedman_effsize</span>(jump_length <span class="sc">~</span> feeding <span class="sc">|</span> block, <span class="at">data =</span> block_long_tbl)</span>
<span id="cb44-361"><a href="#cb44-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-362"><a href="#cb44-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-363"><a href="#cb44-363" aria-hidden="true" tabindex="-1"></a>Wir haben also herausgefunden, dass wir einen schwachen Effekt haben und sich die Mediane der Gruppen nicht unterscheiden. Damit sind wir dann auch soweit schon mit dem Friedman test durch, wir können hier dann auch nicht mehr berechnen. Auch erhalten wir keine 95% Konfidenzintervalle für die Effekte.</span>
<span id="cb44-364"><a href="#cb44-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-365"><a href="#cb44-365" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parametrische Lösung: Die ANOVA {.unnumbered .unlisted}</span></span>
<span id="cb44-366"><a href="#cb44-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-367"><a href="#cb44-367" aria-hidden="true" tabindex="-1"></a>Dann hier auch die parametrische Lösung des Problems mit der zweifaktoriellen ANOVA. Wir wollen jetzt einfach nur unsere Messwerte einmal Rangtransformieren. Dafür nutze ich entweder die Funktion <span class="in">`rank()`</span> oder aber die folgende Funktion <span class="in">`signed_rank()`</span>, wenn ich negative Werte in meinen Messungen erwarte.</span>
<span id="cb44-368"><a href="#cb44-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-371"><a href="#cb44-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-372"><a href="#cb44-372" aria-hidden="true" tabindex="-1"></a>signed_rank <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sign</span>(x) <span class="sc">*</span> <span class="fu">rank</span>(<span class="fu">abs</span>(x))</span>
<span id="cb44-373"><a href="#cb44-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-374"><a href="#cb44-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-375"><a href="#cb44-375" aria-hidden="true" tabindex="-1"></a>Konkret habe ich meine Sprungweiten der Flöhe. Jetzt mutiere ich die Sprungweite über die Funktion <span class="in">`signed_rank()`</span> in Ränge und nutze diese Spalte dann für die ANOVA.</span>
<span id="cb44-376"><a href="#cb44-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-379"><a href="#cb44-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-380"><a href="#cb44-380" aria-hidden="true" tabindex="-1"></a>block_long_ranked_tbl <span class="ot">&lt;-</span> block_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb44-381"><a href="#cb44-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ranked_jump_length =</span> <span class="fu">signed_rank</span>(jump_length))</span>
<span id="cb44-382"><a href="#cb44-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-383"><a href="#cb44-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-384"><a href="#cb44-384" aria-hidden="true" tabindex="-1"></a>Ich nutze hier die Funktion <span class="in">`anova_test()`</span> aus dem R Paket <span class="in">`{rstatix}`</span>, da ich dann einfacher pipen kann. Dann wähle ich noch die passenden Spalten und sehe, dass die Entscheidung die gleiche wäre wie bei den obigen Implementierungen des Friedman Tests. Wir können die Nullhypothese nicht ablehnen, wir haben einen signifikanten Unterschied in den Sprungweiten.</span>
<span id="cb44-385"><a href="#cb44-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-388"><a href="#cb44-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-389"><a href="#cb44-389" aria-hidden="true" tabindex="-1"></a>block_long_ranked_tbl <span class="sc">|&gt;</span> </span>
<span id="cb44-390"><a href="#cb44-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(ranked_jump_length <span class="sc">~</span> feeding <span class="sc">+</span> block) </span>
<span id="cb44-391"><a href="#cb44-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-392"><a href="#cb44-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-393"><a href="#cb44-393" aria-hidden="true" tabindex="-1"></a>Dann können wir die Daten auch in der Form als Messwiederholungen innerhalb des Blocks modellieren, was dann die jeweiligen Blockeffekte miteinschließt. Dann haben wir ein einfaktorielles repeated Design für die ANOVA. Hier nutze ich die Funktion <span class="in">`aov_car()`</span> aus dem R Paket <span class="in">`{afex}`</span>. Aber auch hier sehen wir, dass wir dann doch keinen signifikanten Unterschied finden unser p-Wert ist mit $0.202$ immer noch größer als das Signifikanzniveau $\alpha$.</span>
<span id="cb44-394"><a href="#cb44-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-397"><a href="#cb44-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-398"><a href="#cb44-398" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(ranked_jump_length <span class="sc">~</span> feeding <span class="sc">+</span> <span class="fu">Error</span>(block<span class="sc">/</span>feeding), </span>
<span id="cb44-399"><a href="#cb44-399" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> block_long_ranked_tbl)</span>
<span id="cb44-400"><a href="#cb44-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-401"><a href="#cb44-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-402"><a href="#cb44-402" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... für ein Design mit wiederholten Messungen</span></span>
<span id="cb44-403"><a href="#cb44-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-404"><a href="#cb44-404" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb44-405"><a href="#cb44-405" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb44-406"><a href="#cb44-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-407"><a href="#cb44-407" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Beware the Friedman test!</span><span class="co">](https://seriousstats.wordpress.com/2012/02/14/friedman/)</span> Das ist der wichtigste Punkt. Wenn du den Friedman Test rechnen willst, weil in deinen Zeilen Messwiederholungen sind, dann bitte lassen. Du also bei jedem Floh wiederholt die Sprungweite gemessen und möchtest jetzt wissen, ob es einen Unterschied in den Zeitpunkten gibt. Die Alternativen hat @zimmerman1993relative einmal diskutiert und ich zeige dir dann auch die besseren Lösungen.</span>
<span id="cb44-408"><a href="#cb44-408" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-409"><a href="#cb44-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-410"><a href="#cb44-410" aria-hidden="true" tabindex="-1"></a>Die Frage ist, warum sollte man auf Messwiederholungen einen Friedman Test rechnen? Weil die Normalverteilung für den Messwert in einer ANOVA nicht gegeben ist. Dafür brauchen wir aber nicht den Friedman Test wir können da auch einen anderen Weg gehen. Nach dem folgenden Zitat können wir auch eine repeated ANOVA rechnen. Das machen wir dann auch gleich im Anschluss. Wenn du dich dafür entscheidest, die Alternative zu nutzen, dann kannst du gerne einmal die Arbeit von @zimmerman1993relative zitieren.</span>
<span id="cb44-411"><a href="#cb44-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-412"><a href="#cb44-412" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"\[In cases\] where one-way repeated measures ANOVA is not appropriate, rank transformation followed by ANOVA will provide a more robust test with greater statistical power than the Friedman test." --- [Beware the Friedman test!](https://seriousstats.wordpress.com/2012/02/14/friedman/) und @zimmerman1993relative*</span></span>
<span id="cb44-413"><a href="#cb44-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-414"><a href="#cb44-414" aria-hidden="true" tabindex="-1"></a>Aber wie immer zeige ich natürlich auch die Anwendung des Friedman Test auf unser Design mit wiederholten Messungen. Hier haben wir dann unsere einzelnen Hundeflöhe wiederholt zu unterschiedlichen Zeitpunkten gemessen. Daher sind die einzelnen Zeitpunkte für jeden Floh nicht unabhängig voneinander. Leider ignoriert der Friedman Test jegliche Beziehungen zwischen den Flöhen, so dass hier der Test mit Vorsicht zu genießen ist.</span>
<span id="cb44-415"><a href="#cb44-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-416"><a href="#cb44-416" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb44-417"><a href="#cb44-417" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch</span></span>
<span id="cb44-418"><a href="#cb44-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-419"><a href="#cb44-419" aria-hidden="true" tabindex="-1"></a>Die Frage bei den nichtparametrischen Tests ist ja immer, wie wir die Ränge bilden. In dem Fall des Friedman Tests bilden wir die Ränge über die Zeilen. Das heißt, wir schauen uns den ersten Block an und sortieren die beobachteten Sprungweiten und vergeben dann absteigend Ränge. Der größte Wert kriegt den ersten Rang und der kleinste Werte den letzten Rang. Das machen wir dann für jede weitere Zeile. Am Ende bilden wir dann die Rangsummen für jeden Zeitpunkt. Dafür addieren wir die Ränge einfach auf.</span>
<span id="cb44-420"><a href="#cb44-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-421"><a href="#cb44-421" aria-hidden="true" tabindex="-1"></a>| Floh | Zeitpunkt 1 | Zeitpunkt 2 | Zeitpunkt 3 | Zeitpunkt 4 |</span>
<span id="cb44-422"><a href="#cb44-422" aria-hidden="true" tabindex="-1"></a>|:--:|:--:|:--:|:--:|:--:|</span>
<span id="cb44-423"><a href="#cb44-423" aria-hidden="true" tabindex="-1"></a>| 1 | $10.2 \rightarrow 4$ | $12.4 \rightarrow 2$ | $11.1 \rightarrow 3$ | $13.4 \rightarrow 1$ |</span>
<span id="cb44-424"><a href="#cb44-424" aria-hidden="true" tabindex="-1"></a>| 2 | $8.3 \rightarrow 2$ | $9.1 \rightarrow 1$ | $6.8 \rightarrow 4$ | $7.1 \rightarrow 3$ |</span>
<span id="cb44-425"><a href="#cb44-425" aria-hidden="true" tabindex="-1"></a>| 3 | $12.1 \rightarrow 3$ | $15.1 \rightarrow 1$ | $11.3 \rightarrow 4$ | $12.5 \rightarrow 2$ |</span>
<span id="cb44-426"><a href="#cb44-426" aria-hidden="true" tabindex="-1"></a>| 4 | $7.8 \rightarrow 3$ | $8.1 \rightarrow 2$ | $5.6 \rightarrow 4$ | $8.2 \rightarrow 1$ |</span>
<span id="cb44-427"><a href="#cb44-427" aria-hidden="true" tabindex="-1"></a>| 5 | $8.6 \rightarrow 3$ | $10.3 \rightarrow 2$ | $8.1 \rightarrow 4$ | $11.3 \rightarrow 1$ |</span>
<span id="cb44-428"><a href="#cb44-428" aria-hidden="true" tabindex="-1"></a>| $\sum$ | $15$ | $8$ | $19$ | $8$ |</span>
<span id="cb44-429"><a href="#cb44-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-430"><a href="#cb44-430" aria-hidden="true" tabindex="-1"></a>: Datentabelle des Designs mit Messwiederholungen mit den Sprungweiten individueller Flöhe unter drei Ernährungsarten. Pro Zeile wird den beobachteten Sprungweiten ein Rang zugeordnet. Die Summe der Ränge wird pro Spalte gebildet. {#tbl-friedman-theo-block}</span>
<span id="cb44-431"><a href="#cb44-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-432"><a href="#cb44-432" aria-hidden="true" tabindex="-1"></a>Wenn wir keinen Effekt der Ernährungsformen erwarten würden, dann würde immer mal wieder jede Ernährungsform große oder kleine Ränge erhalten. Bei einer zufälligen Anordnung würden wir daher eine Rangsumme von $E(R)$ gleich 12.5 erwarten.</span>
<span id="cb44-433"><a href="#cb44-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-434"><a href="#cb44-434" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-435"><a href="#cb44-435" aria-hidden="true" tabindex="-1"></a>E(R) = \cfrac{N(k+1)}{2} = \cfrac{5(4+1)}{2} = 12.5</span>
<span id="cb44-436"><a href="#cb44-436" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-437"><a href="#cb44-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-438"><a href="#cb44-438" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb44-439"><a href="#cb44-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-440"><a href="#cb44-440" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$k$ ist die Anzahl an Gruppen. Hier also die Spalten der Daten.</span>
<span id="cb44-441"><a href="#cb44-441" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$N$ der Gesamtzahl an Beobachtungen also die gesamte Fallzahl. Hier also die Zeilen der Daten.</span>
<span id="cb44-442"><a href="#cb44-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-443"><a href="#cb44-443" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass wir nahe dran sind und fragen uns jetzt, ob die Abweichung schon signifikant sein kann. Dafür können wir hier ein $\mathcal{X_D}^2$ Statistik berechnen, die uns bei der Beantwortung hilft. Ja, wir können auch in anderen Tests wieder auf andere bekannte Teststatistiken zurückgreifen.</span>
<span id="cb44-444"><a href="#cb44-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-445"><a href="#cb44-445" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-446"><a href="#cb44-446" aria-hidden="true" tabindex="-1"></a>\mathcal{X_D}^2 = \cfrac{12}{N \cdot k \cdot (k+1)} \cdot \sum R^2 - 3 \cdot N \cdot (k+1)</span>
<span id="cb44-447"><a href="#cb44-447" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-448"><a href="#cb44-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-449"><a href="#cb44-449" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$R$ der Rangsummen für jede Gruppe mit insgesamt $k$ Gruppen.</span>
<span id="cb44-450"><a href="#cb44-450" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$k$ ist die Anzahl an Gruppen. Hier also die Spalten der Daten.</span>
<span id="cb44-451"><a href="#cb44-451" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$N$ der Gesamtzahl an Beobachtungen also die gesamte Fallzahl. Hier also die Zeilen der Daten.</span>
<span id="cb44-452"><a href="#cb44-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-453"><a href="#cb44-453" aria-hidden="true" tabindex="-1"></a>Dann setzen wir mal alle Zahlen in die Formel ein und rechnen einmal aus, was wir für eine $\mathcal{X_D}^2$ Statistik erhalten. Je größer die Teststatistik ist, desto eher lehnen wir die Nullhypothese ab.</span>
<span id="cb44-454"><a href="#cb44-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-455"><a href="#cb44-455" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-456"><a href="#cb44-456" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb44-457"><a href="#cb44-457" aria-hidden="true" tabindex="-1"></a>\mathcal{X_D}^2 &amp;= \cfrac{12}{5 \cdot 4 \cdot (4+1)} \cdot (15^2 + 8^2 + 19^2 + 8^2) - 3 \cdot 5 \cdot (4+1) <span class="sc">\\</span></span>
<span id="cb44-458"><a href="#cb44-458" aria-hidden="true" tabindex="-1"></a>&amp;= 0.12 \cdot 714 - 75 <span class="sc">\\</span></span>
<span id="cb44-459"><a href="#cb44-459" aria-hidden="true" tabindex="-1"></a>&amp;= 10.68</span>
<span id="cb44-460"><a href="#cb44-460" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb44-461"><a href="#cb44-461" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-462"><a href="#cb44-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-463"><a href="#cb44-463" aria-hidden="true" tabindex="-1"></a>Wir haben den kritischen Wert $\mathcal{X}^2_{\alpha = 5\%}$ in unserem Fall mit $7.82$ gegeben. Wenn die $\mathcal{X_D}^2$ Statistik größer ist als der kritische Wert, können wir die Nullhypothese ablehnen. Das ist hier tatsächlich der Fall. Wir sehen also einen signifikanten Unterschied zwischen den Zeitpunkten.</span>
<span id="cb44-464"><a href="#cb44-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-465"><a href="#cb44-465" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{stats}`</span></span>
<span id="cb44-466"><a href="#cb44-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-467"><a href="#cb44-467" aria-hidden="true" tabindex="-1"></a>Dann kommen wir auch schon zu dem statistischen Test in <span class="in">`{stats}`</span>. Wir müssen hier nur schauen, dass die Zeilen als Faktor hinter dem Strich <span class="in">`|`</span> stehen. Dann rechnet sich alles sehr schnell.</span>
<span id="cb44-468"><a href="#cb44-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-471"><a href="#cb44-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-472"><a href="#cb44-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-473"><a href="#cb44-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-474"><a href="#cb44-474" aria-hidden="true" tabindex="-1"></a><span class="fu">friedman.test</span>(jump_length <span class="sc">~</span> time_fct <span class="sc">|</span> flea_id, <span class="at">data =</span> repeated_long_tbl)</span>
<span id="cb44-475"><a href="#cb44-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-476"><a href="#cb44-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-477"><a href="#cb44-477" aria-hidden="true" tabindex="-1"></a>Nachdem wir die Funktion aufgerufen haben, erhalten wir auch gleich den $p$-Wert von $0.014$ wieder. Da der $p$-Wert kleiner ist als das Signifikanzniveau $\alpha$ von 5% können wir die Nullhypothese ablehnen. Das war auch anhand des Doplots zu erwarten.</span>
<span id="cb44-478"><a href="#cb44-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-479"><a href="#cb44-479" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{rstatix}`</span></span>
<span id="cb44-480"><a href="#cb44-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-481"><a href="#cb44-481" aria-hidden="true" tabindex="-1"></a>Dann kommen wir auch schon zu dem statistischen Test in <span class="in">`{rstatix}`</span> mit der Funktion <span class="in">`friedman_test()`</span>. Da die Funktion gleich heißt wie im R Paket <span class="in">`{coin}`</span> muss ich die Funktion nochmal explizit aufrufen. Wir müssen hier nur schauen, dass die Zeilen als Faktor hinter dem Strich <span class="in">`|`</span> stehen. Dann rechnet sich alles sehr schnell. Mehr zu der Funktion erfährst du auch im Tutorium <span class="co">[</span><span class="ot">Friedman Test in R</span><span class="co">](https://www.datanovia.com/en/lessons/friedman-test-in-r/)</span>.</span>
<span id="cb44-482"><a href="#cb44-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-485"><a href="#cb44-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-486"><a href="#cb44-486" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-487"><a href="#cb44-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-488"><a href="#cb44-488" aria-hidden="true" tabindex="-1"></a>rstatix<span class="sc">::</span><span class="fu">friedman_test</span>(jump_length <span class="sc">~</span> time_fct <span class="sc">|</span> flea_id, <span class="at">data =</span> repeated_long_tbl)</span>
<span id="cb44-489"><a href="#cb44-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-490"><a href="#cb44-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-491"><a href="#cb44-491" aria-hidden="true" tabindex="-1"></a>Nachdem wir die Funktion aufgerufen haben, erhalten wir auch gleich den $p$-Wert von $0.012$ wieder. Damit fast das gleiche Eregbnis wie schon vorher. Da der $p$-Wert kleiner ist als das Signifikanzniveau $\alpha$ von 5% können wir die Nullhypothese ablehnen. Das war auch anhand des Doplots zu erwarten.</span>
<span id="cb44-492"><a href="#cb44-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-493"><a href="#cb44-493" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{nparcomp}`</span></span>
<span id="cb44-494"><a href="#cb44-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-495"><a href="#cb44-495" aria-hidden="true" tabindex="-1"></a>Abschöießend gibt es noch in dem R Paket <span class="in">`{nparcomp}`</span> die Funktion <span class="in">`mctp.rm()`</span> die es uns ermöglicht eine repeated ANOVA mit einem nichtparametrischen Verfahren zu rechnen. Daher ist diese Variante natürlich den anderen beiden vorzuziehen. Wir erhalten hier aber keine globale Aussage sondern gleich die paarweisen Vergleiche. Sozusagen der Post-hoc Test in einem Test. Wir müssen uns hier leider merken welche Faktorlevel wir vorliegen haben, den die Ausgabe gibt uns leider nur die Zahlen und nicht die Gruppennamen. Das ist natürlich unschön und fehleranfällig. Wir haben eine automatische Adjustierung für multiple Vergleiche.</span>
<span id="cb44-496"><a href="#cb44-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-499"><a href="#cb44-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-500"><a href="#cb44-500" aria-hidden="true" tabindex="-1"></a>mctp.rm_obj <span class="ot">&lt;-</span> <span class="fu">mctp.rm</span>(jump_length <span class="sc">~</span> time_fct, <span class="at">data =</span> repeated_long_tbl,</span>
<span id="cb44-501"><a href="#cb44-501" aria-hidden="true" tabindex="-1"></a>                       <span class="at">info =</span> <span class="cn">FALSE</span>)</span>
<span id="cb44-502"><a href="#cb44-502" aria-hidden="true" tabindex="-1"></a>mctp.rm_obj<span class="sc">$</span>Analysis</span>
<span id="cb44-503"><a href="#cb44-503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-504"><a href="#cb44-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-505"><a href="#cb44-505" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass nur der Zeitpunkt <span class="in">`t3`</span> mit dem Zeitpunkt <span class="in">`t2`</span> signifikant unterschiedlich ist. Alle anderen Zeitpunkte sind zeigen keinen p-Wert unter dem Signifikanzniveau $\alpha$ vo 5%.</span>
<span id="cb44-506"><a href="#cb44-506" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-507"><a href="#cb44-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-508"><a href="#cb44-508" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parametrische Lösung: Die repeated ANOVA {.unnumbered .unlisted}</span></span>
<span id="cb44-509"><a href="#cb44-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-510"><a href="#cb44-510" aria-hidden="true" tabindex="-1"></a>Dann hier auch die parametrische Lösung des Problems mit der repeated ANOVA. Wir wollen jetzt einfach nur unsere Messwerte einmal Rangtransformieren. Dafür nutze ich entweder die Funktion <span class="in">`rank()`</span> oder aber die folgende Funktion <span class="in">`signed_rank()`</span>, wenn ich negative Werte in meinen Messungen erwarte.</span>
<span id="cb44-511"><a href="#cb44-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-514"><a href="#cb44-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-515"><a href="#cb44-515" aria-hidden="true" tabindex="-1"></a>signed_rank <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sign</span>(x) <span class="sc">*</span> <span class="fu">rank</span>(<span class="fu">abs</span>(x))</span>
<span id="cb44-516"><a href="#cb44-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-517"><a href="#cb44-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-518"><a href="#cb44-518" aria-hidden="true" tabindex="-1"></a>Konkret habe ich meine Sprungweiten der Flöhe. Jetzt mutiere ich die Sprungweite über die Funktion <span class="in">`signed_rank()`</span> in Ränge und nutze diese Spalte dann für die ANOVA.</span>
<span id="cb44-519"><a href="#cb44-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-522"><a href="#cb44-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-523"><a href="#cb44-523" aria-hidden="true" tabindex="-1"></a>repeated_long_ranked_tbl <span class="ot">&lt;-</span> repeated_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb44-524"><a href="#cb44-524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ranked_jump_length =</span> <span class="fu">signed_rank</span>(jump_length))</span>
<span id="cb44-525"><a href="#cb44-525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-526"><a href="#cb44-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-527"><a href="#cb44-527" aria-hidden="true" tabindex="-1"></a>Wir können die Daten in der Form als Messwiederholungen innerhalb des Flöhe modellieren. Dann haben wir ein einfaktorielles repeated Design für die ANOVA. Hier nutze ich die Funktion <span class="in">`aov_car()`</span> aus dem R Paket <span class="in">`{afex}`</span>. Hier sehen wir, dass wir dann einen signifikanten Unterschied finden unser p-Wert ist mit $0.041$ immer noch kleiner als das Signifikanzniveau $\alpha$. Der p-Wert ist nicht ganz so klein wie bei dem Friedman Test.</span>
<span id="cb44-528"><a href="#cb44-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-531"><a href="#cb44-531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-532"><a href="#cb44-532" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_car</span>(ranked_jump_length <span class="sc">~</span> time_fct <span class="sc">+</span> <span class="fu">Error</span>(flea_id<span class="sc">/</span>time_fct), </span>
<span id="cb44-533"><a href="#cb44-533" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> repeated_long_ranked_tbl)</span>
<span id="cb44-534"><a href="#cb44-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-535"><a href="#cb44-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-536"><a href="#cb44-536" aria-hidden="true" tabindex="-1"></a><span class="fu">## Post-hoc Test</span></span>
<span id="cb44-537"><a href="#cb44-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-538"><a href="#cb44-538" aria-hidden="true" tabindex="-1"></a>Wenn wir dann einen signifikanten Unterschied gefunden haben, dann müssen wir ja noch einen Post-hoc Test rechnen. Für das einfache Design mit den Messwiederholungen würde ich dann gleich <span class="in">`{nparcomp}`</span> empfehlen, wenn es ein nichtparametrischer Test sein soll. Dort haben wir dann auch gleich die paarweisen Vergleiche mit drin. Wenn es dann doch klassischer mit Friedman als Vortest sein soll, dann hier die zwei Alternativen für den Post-hoc Test. Beide Pakete sind schon etwas älter, was die Bedienung der Funktionen angeht.</span>
<span id="cb44-539"><a href="#cb44-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-540"><a href="#cb44-540" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb44-541"><a href="#cb44-541" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{pgirmess}`</span></span>
<span id="cb44-542"><a href="#cb44-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-543"><a href="#cb44-543" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{pgirmess}`</span> erlaubt es mit dem <span class="in">`friedmanmc()`</span> einen paarweisen Friedman Test zu rechnen. Wir haben hier eine veraltete Nutzung ohne die Formelschreibweise, so dass wir hier die einzelnen Variablen händisch den Optionen zuordnen müssen. Wir müssten händisch das Signifikanzniveau adjustieren oder aber händisch die p-Werte anpassen, wenn wir für multiple Vergleiche adjustieren wollen würden.</span>
<span id="cb44-544"><a href="#cb44-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-547"><a href="#cb44-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-548"><a href="#cb44-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-549"><a href="#cb44-549" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-550"><a href="#cb44-550" aria-hidden="true" tabindex="-1"></a>friedmanmc_res <span class="ot">&lt;-</span>  <span class="fu">friedmanmc</span>(<span class="at">y =</span> block_long_tbl<span class="sc">$</span>jump_length,</span>
<span id="cb44-551"><a href="#cb44-551" aria-hidden="true" tabindex="-1"></a>                              <span class="at">groups =</span> block_long_tbl<span class="sc">$</span>feeding,</span>
<span id="cb44-552"><a href="#cb44-552" aria-hidden="true" tabindex="-1"></a>                              <span class="at">blocks =</span> block_long_tbl<span class="sc">$</span>block)</span>
<span id="cb44-553"><a href="#cb44-553" aria-hidden="true" tabindex="-1"></a>friedmanmc_res</span>
<span id="cb44-554"><a href="#cb44-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-555"><a href="#cb44-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-556"><a href="#cb44-556" aria-hidden="true" tabindex="-1"></a>Dann sehen wir auch schon, dass wir keinen signifkanten Unterschied in den paarweisen Vergleichen vorliegen haben. Alle p-Werte sind größer als das Signifikanzniveau $\alpha$ von 5%. Wir können keine Nullhypothese der Vergleiche ablehnen.</span>
<span id="cb44-557"><a href="#cb44-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-560"><a href="#cb44-560" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-561"><a href="#cb44-561" aria-hidden="true" tabindex="-1"></a>friedmanmc_tbl <span class="ot">&lt;-</span> friedmanmc_res<span class="sc">$</span>dif.com <span class="sc">|&gt;</span> </span>
<span id="cb44-562"><a href="#cb44-562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"comparison"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-563"><a href="#cb44-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb44-564"><a href="#cb44-564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-565"><a href="#cb44-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-566"><a href="#cb44-566" aria-hidden="true" tabindex="-1"></a>Am Ende wollen wir dann noch das *Compact letter display* haben und nutzen dann dafür die Funktion <span class="in">`cldList()`</span>. Wir sehen dann aber natürlich hier auch keinen Unterschied. Leider gibt es keine Möglichkeit die 95% Konfidenzintervalle zu erhalten. Wir auch beim Kruskal-Wallis-Test erhalten wir bei dem Friedman Test keine 95% Konfidenzintervalle und müssen im Zweifel mit dieser Einschränkung leben.</span>
<span id="cb44-567"><a href="#cb44-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-570"><a href="#cb44-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-571"><a href="#cb44-571" aria-hidden="true" tabindex="-1"></a><span class="fu">cldList</span>(p.value <span class="sc">~</span> comparison, <span class="at">data =</span> friedmanmc_tbl)</span>
<span id="cb44-572"><a href="#cb44-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-573"><a href="#cb44-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-574"><a href="#cb44-574" aria-hidden="true" tabindex="-1"></a>Wenn du willst kannst du den paarweisen Vergleich auch für das einfache Design für die Messweiderholungen einmal selber rechnen. Die Funktionen sind die gleichen aber du musst natürlich den Datensatz und die Variablen anpassen.</span>
<span id="cb44-575"><a href="#cb44-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-576"><a href="#cb44-576" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{PMCMRplus}`</span></span>
<span id="cb44-577"><a href="#cb44-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-578"><a href="#cb44-578" aria-hidden="true" tabindex="-1"></a>Nachdem wir jetzt festgestellt haben, dass sich mindestens ein Gruppenunterschied zwischen den Weizensorten finden lassen muss, wollen wir noch feststellen wo dieser Unterschied liegt. Wir nutzen dafür den Siegel- und Castellan-Vergleichstests für alle Paare durch. Der Test ist mit der Funktion <span class="in">`frdAllPairsSiegelTest()`</span> in dem R Paket <span class="in">`{PMCMRplus}`</span> implementiert und einfach nutzbar. In dem Paket sind noch eine weitere Reihe an statistischen Test für paarweise nicht-parametrische Test enthalten. Leider sind das Paket und die Funktion schon älter, so dass wir nicht einmal die Formelschreibweise zu Verfügung haben. Wir müssen alle Spalten aus unserem Datensatz mit dem <span class="in">`$`</span> einzeln selektieren und den Optionen zuordnen.</span>
<span id="cb44-579"><a href="#cb44-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-582"><a href="#cb44-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-583"><a href="#cb44-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-584"><a href="#cb44-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-585"><a href="#cb44-585" aria-hidden="true" tabindex="-1"></a>siegel_test_res <span class="ot">&lt;-</span>  <span class="fu">frdAllPairsSiegelTest</span>(<span class="at">y =</span> block_long_tbl<span class="sc">$</span>jump_length,</span>
<span id="cb44-586"><a href="#cb44-586" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">groups =</span> block_long_tbl<span class="sc">$</span>feeding,</span>
<span id="cb44-587"><a href="#cb44-587" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">blocks =</span> block_long_tbl<span class="sc">$</span>block,</span>
<span id="cb44-588"><a href="#cb44-588" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">p.adjust.method =</span> <span class="st">"none"</span>)</span>
<span id="cb44-589"><a href="#cb44-589" aria-hidden="true" tabindex="-1"></a>siegel_test_res</span>
<span id="cb44-590"><a href="#cb44-590" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-591"><a href="#cb44-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-592"><a href="#cb44-592" aria-hidden="true" tabindex="-1"></a>Ich empfehle ja immer eine Adjustierung für multiple Vergleiche, aber du kannst das selber entscheiden. Wenn du für die multiplen Vergleiche adjustieren willst, dann nutze gerne die Option <span class="in">`p.adjust.method = "bonferroni"`</span> oder eben statt <span class="in">`bonferroni`</span> die Adjustierungsmethode <span class="in">`fdr`</span>.</span>
<span id="cb44-593"><a href="#cb44-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-594"><a href="#cb44-594" aria-hidden="true" tabindex="-1"></a>Damit wir auch das *compact letter display* aus unseren $p$-Werte berechnen können, müssen wir unser Ergebnisobjekt nochmal in eine Tabelle umwandeln. Dafür gibt es dann auch eine passende Funktion mit <span class="in">`PMCMRTable`</span>. Wir sehen, es ist alles etwas altbacken.</span>
<span id="cb44-595"><a href="#cb44-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-598"><a href="#cb44-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-599"><a href="#cb44-599" aria-hidden="true" tabindex="-1"></a>siegel_test_tab <span class="ot">&lt;-</span> <span class="fu">PMCMRTable</span>(siegel_test_res)</span>
<span id="cb44-600"><a href="#cb44-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-601"><a href="#cb44-601" aria-hidden="true" tabindex="-1"></a>siegel_test_tab</span>
<span id="cb44-602"><a href="#cb44-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-603"><a href="#cb44-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-604"><a href="#cb44-604" aria-hidden="true" tabindex="-1"></a>Nachdem wir die Tabellenschreibweise der $p$-Werte vorliegen haben, können wir dann das *compact letter display* uns über die Funktion <span class="in">`cldList()`</span> anzeigen lassen. Leider gibt es keine Möglichkeit die 95% Konfidenzintervalle zu erhalten. Wir auch beim Kruskal-Wallis-Test erhalten wir bei dem Friedman Test keine 95% Konfidenzintervalle und müssen im Zweifel mit dieser Einschränkung leben.</span>
<span id="cb44-605"><a href="#cb44-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-608"><a href="#cb44-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-609"><a href="#cb44-609" aria-hidden="true" tabindex="-1"></a><span class="fu">cldList</span>(p.value <span class="sc">~</span> Comparison, <span class="at">data =</span> siegel_test_tab)</span>
<span id="cb44-610"><a href="#cb44-610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-611"><a href="#cb44-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-612"><a href="#cb44-612" aria-hidden="true" tabindex="-1"></a>Am *compact letter display* sehen wir im Prinzip das gleiche Muster wie in den $p$-Werten. Nur nochmal etwas anders dargestellt und mit dem Fokus auf die *nicht* Unterschiede.</span>
<span id="cb44-613"><a href="#cb44-613" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-614"><a href="#cb44-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-615"><a href="#cb44-615" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-friedman.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-friedman.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>55&nbsp; Poisson Regression – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-modeling-beta.html" rel="next">
<link href="./stat-modeling-gaussian.html" rel="prev">
<link href="./cover2026_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="55&nbsp; Poisson Regression – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2026.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-modeling-preface.html">Statistisches Modellieren</a></li><li class="breadcrumb-item"><a href="./stat-modeling-poisson.html"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Poisson Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der U-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Chi-Quadrat-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-marginal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Marginal effect models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">55.1</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">55.2</span> Daten</a></li>
  <li><a href="#fit-des-modells" id="toc-fit-des-modells" class="nav-link" data-scroll-target="#fit-des-modells"><span class="header-section-number">55.3</span> Fit des Modells</a></li>
  <li><a href="#performance-des-modells" id="toc-performance-des-modells" class="nav-link" data-scroll-target="#performance-des-modells"><span class="header-section-number">55.4</span> Performance des Modells</a></li>
  <li><a href="#interpretation-des-modells" id="toc-interpretation-des-modells" class="nav-link" data-scroll-target="#interpretation-des-modells"><span class="header-section-number">55.5</span> Interpretation des Modells</a></li>
  <li><a href="#zeroinflation" id="toc-zeroinflation" class="nav-link" data-scroll-target="#zeroinflation"><span class="header-section-number">55.6</span> Zeroinflation</a></li>
  <li><a href="#sec-mult-comp-pois-reg" id="toc-sec-mult-comp-pois-reg" class="nav-link" data-scroll-target="#sec-mult-comp-pois-reg"><span class="header-section-number">55.7</span> Gruppenvergleich</a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-poisson.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-poisson.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-modeling-preface.html">Statistisches Modellieren</a></li><li class="breadcrumb-item"><a href="./stat-modeling-poisson.html"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Poisson Regression</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-poisson" class="quarto-section-identifier"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 09. April 2024 um 19:24:00</em></p>
<p>In diesem Kapitel wollen wir eine Poisson Regression rechnen. Wir müssen uns hier wieder überlegen, was ist eigentlich unser Outcome <span class="math inline">\(y\)</span> und was sind unsere Einflussvariablen <span class="math inline">\(x\)</span>. Die Poisson Regression ist je nach Hintergrund des Anwenders eher selten. In der Ökologie, wo gerne mal gezaählt wird, wie oft etwas vorkommt, ist die Poisson Regression häufig vertreten. Sonst fristet die Poisson Regresson eher ein unbekanntes Dasein.</p>
<p>Ein häufig unterschätzter Vorteil der Poisson Regression ist, dass wir auch auch <span class="math inline">\(0/1\)</span> Daten eine Poisson Regression rechnen können. Moment, wirst du jetzt vielleicht denken, das machen wir doch mit der logistischen Regression. Ja, das stimmt, aber wir können auf Zahlen viel rechnen. Wenn wir auf ein <span class="math inline">\(0/1\)</span> Outcome eine Poisson Regression rechnen, dann kriegen wir nicht Odds Ratios <span class="math inline">\(OR\)</span> als Effektschätzer sondern Risk Ratios <span class="math inline">\(RR\)</span>. Wir erhalten also keine Chancen sondern Wahrscheinlichkeiten. Unter der Annahme, dass das Modell auch konvergiert und wir sinnvolle Zahlen erhalten.</p>
<p>Ein weiteres Problem sind die zu vielen Nullen in dem Outcome <span class="math inline">\(y\)</span>. Daher wir zählen über die Maßen viel <em>Nichts</em>. Wir nennen diesen Fall <em>zero inflation</em> und beschreiben damit die zu vielen Nullen in den Daten. Hier muss dann noch speziell modelliert werden. Eine Poisson Regression hat schon so seine speziellen Tücken.</p>
<p>In der folgenden <a href="#fig-scatter-modeling-poisson-01" class="quarto-xref">Abbildung&nbsp;<span>55.1</span></a> siehst du nochmal den Zusammenhang zwischen einem poissonverteilten Outcome, wie Anzahl oder Auftreten, im Bezug zu einem kontinuierlichen oder kategoriellen <span class="math inline">\(x\)</span> als Einflussgröße. Wir sind dann eher im Bereich der Posthoc-Tests mit kategoriellen <span class="math inline">\(x\)</span> als in wirklich einer Interpretation einer Poisson Regression mit einem kontinuierlichen <span class="math inline">\(x\)</span>. Dennoch müssen wir wissen, ob die Poisson Regression gut funktioniert hat. Die Überprüfung der Modellierung können wir dann in diesem Kapitel einmal durchgehen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatter-modeling-poisson-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-modeling-poisson-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-poisson_files/figure-html/fig-scatter-modeling-poisson-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Abbildung&nbsp;55.1— Visueller Zusammenhang eines kontinuierlichen Outcomes (y) aus einer Poissonverteilung zu Zähldaten im Verhätnis zu verschiedenen Skalen der Einflussvariable (x). Ein Punkt stellt eine Beobachtung dar. Deutlich sind die Ebenen durch die absoluten Zählwerte zu erkennen. (A) x ist kontinuierlich. (B) x ist kategoriell mit zwei oder mehr Gruppen. (C) x ist kategoriell mit zwei Gruppen. [Zum Vergrößern anklicken]"><img src="stat-modeling-poisson_files/figure-html/fig-scatter-modeling-poisson-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1440"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-modeling-poisson-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;55.1— Visueller Zusammenhang eines kontinuierlichen Outcomes (<span class="math inline">\(y\)</span>) aus einer Poissonverteilung zu Zähldaten im Verhätnis zu verschiedenen Skalen der Einflussvariable (<span class="math inline">\(x\)</span>). Ein Punkt stellt eine Beobachtung dar. Deutlich sind die Ebenen durch die absoluten Zählwerte zu erkennen. <strong>(A)</strong> <span class="math inline">\(x\)</span> ist kontinuierlich. <strong>(B)</strong> <span class="math inline">\(x\)</span> ist kategoriell mit zwei oder mehr Gruppen. <strong>(C)</strong> <span class="math inline">\(x\)</span> ist kategoriell mit zwei Gruppen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Häufig wollen wir dann die Ergebnisse aus einer Poisson Regression dann im Falle eines kategoriellen <span class="math inline">\(x\)</span> dann als Barplots wie in der <a href="#fig-scatter-modeling-poisson-02" class="quarto-xref">Abbildung&nbsp;<span>55.2</span></a> darstellen. Hier musst du dann einmal weiter unten in den Abschnitt zu den Gruppenvergleichen springen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatter-modeling-poisson-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-modeling-poisson-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-poisson_files/figure-html/fig-scatter-modeling-poisson-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;55.2— Visueller Zusammenhang eines gemittelten Outcomes (y) aus einer Poissonverteilung im Verhältnis zu der Einflussvariable (x) mit zwei oder mehr Kategorien anhand von Barplots. Hauptsächlich unterscheiden sich die Barplots durch die unterschiedlichen Einheiten auf der y-Achse. Die Fehlerbalken stellen den Standardfehler (SE) dar. [Zum Vergrößern anklicken]"><img src="stat-modeling-poisson_files/figure-html/fig-scatter-modeling-poisson-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-modeling-poisson-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;55.2— Visueller Zusammenhang eines gemittelten Outcomes (<span class="math inline">\(y\)</span>) aus einer Poissonverteilung im Verhältnis zu der Einflussvariable (<span class="math inline">\(x\)</span>) mit zwei oder mehr Kategorien anhand von Barplots. Hauptsächlich unterscheiden sich die Barplots durch die unterschiedlichen Einheiten auf der <span class="math inline">\(y\)</span>-Achse. Die Fehlerbalken stellen den Standardfehler (<em>SE</em>) dar. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Im folgenden Kapitel zu der multiplen Poisson linearen Regression gehen wir davon aus, dass die Daten in der vorliegenden Form <em>ideal</em> sind. Das heißt wir haben weder fehlende Werte vorliegen, noch haben wir mögliche Ausreißer in den Daten. Auch wollen wir keine Variablen selektieren. Wir nehmen alles was wir haben mit ins Modell. Sollte eine oder mehre Bedingungen nicht zutreffen, dann schaue dir einfach die folgenden Kapitel an.</p>
<ul>
<li>Wenn du fehlende Werte in deinen Daten vorliegen hast, dann schaue bitte nochmal in das <a href="stat-modeling-missing.html" class="quarto-xref"><span>Kapitel 50</span></a> zu Imputation von fehlenden Werten.</li>
<li>Wenn du denkst, dass du Ausreißer oder auffälige Werte in deinen Daten hast, dann schaue doch bitte nochmal in das <a href="stat-modeling-outlier.html" class="quarto-xref"><span>Kapitel 48</span></a> zu Ausreißer in den Daten.</li>
<li>Wenn du denkst, dass du zu viele Variablen in deinem Modell hast, dann hilft dir das <a href="stat-modeling-variable-selection.html" class="quarto-xref"><span>Kapitel 49</span></a> bei der Variablenselektion.</li>
</ul>
<p>Daher sieht unser Modell wie folgt aus. Wir haben ein <span class="math inline">\(y\)</span> und <span class="math inline">\(p\)</span>-mal <span class="math inline">\(x\)</span>. Wobei <span class="math inline">\(p\)</span> für die Anzahl an Variablen auf der rechten Seite des Modells steht. Im Weiteren folgt unser <span class="math inline">\(y\)</span> einer Poissonverteilung. Das ist hier sehr wichtig, denn wir wollen ja eine multiple Poisson lineare Regression rechnen.</p>
<p><span class="math display">\[
y \sim x_1 + x_2 + ... + x_p
\]</span></p>
<p>Wir gehen jetzt einmal die lineare Regression mit einem normalverteilten Outcome <span class="math inline">\(y\)</span> einmal durch. Wie schon oben erwähnt, können wir die Poisson Regression als vorangestelltes Modell für eine ANOVA oder dann eben einen Posthoc-Test in <code>{emmeans}</code> nutzen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die Poisson Regression
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wie immer gibt es auch für die Frage nach dem Tutorium für die Poisson Regression verschiedene Quellen. Ich kann noch folgende Informationen und Hilfen empfehlen.</p>
</div>
</div>
<section id="genutzte-r-pakete" class="level2" data-number="55.1">
<h2 data-number="55.1" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">55.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, broom,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               parameters, performance, MASS, pscl, see,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               modelsummary, scales, emmeans, multcomp,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               conflicted)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2 page-columns page-full" data-number="55.2">
<h2 data-number="55.2" class="anchored" data-anchor-id="daten"><span class="header-section-number">55.2</span> Daten</h2>
<p>Im folgenden schauen wir uns ein Datenbeispiel mit Hechten an. Es handelt sich um langnasige Hechte in nordamerikanischen Flüssen. Wir haben uns insgesamt <span class="math inline">\(n = 68\)</span> Flüsse einmal angesehen und dort die Anzahl an Hechten gezählt. Im Weiteren haben wir dann noch andere Flussparameter erhoben und fragen uns nun, welche dieser Parameter einen Einfluss auf die Anzahl an Hechten in den Flussarmen haben. In <a href="example-complex.html#sec-example-longnose" class="quarto-xref"><span>Kapitel 7.3</span></a> findest du nochmal mehr Informationen zu den Daten. Wir entfernen hier die Informationen zu den Flüssen, die brauchen wir in dieser Analyse nicht. Die Daten zu den langnasigen Hechten stammt von <a href="https://rcompanion.org/rcompanion/e_05.html">Salvatore S. Mangiafico - An R Companion for the Handbook of Biological Statistics</a>. Besuche gerne mal seine Webseite, dort findest du auch andere tolle Beispiele zu statistischen Analysen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>longnose_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/longnose.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>stream)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell page-columns page-full">
<div id="tbl-pois-longnose" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pois-longnose-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;55.1— Auszug aus dem Daten zu den langnasigen Hechten.
</figcaption>
<div aria-describedby="tbl-pois-longnose-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="cell-output-display column-page">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">longnose</th>
<th style="text-align: center;">area</th>
<th style="text-align: center;">do2</th>
<th style="text-align: center;">maxdepth</th>
<th style="text-align: center;">no3</th>
<th style="text-align: center;">so4</th>
<th style="text-align: center;">temp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">13</td>
<td style="text-align: center;">2528</td>
<td style="text-align: center;">9.6</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">2.28</td>
<td style="text-align: center;">16.75</td>
<td style="text-align: center;">15.3</td>
</tr>
<tr class="even">
<td style="text-align: center;">12</td>
<td style="text-align: center;">3333</td>
<td style="text-align: center;">8.5</td>
<td style="text-align: center;">83</td>
<td style="text-align: center;">5.34</td>
<td style="text-align: center;">7.74</td>
<td style="text-align: center;">19.4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">54</td>
<td style="text-align: center;">19611</td>
<td style="text-align: center;">8.3</td>
<td style="text-align: center;">96</td>
<td style="text-align: center;">0.99</td>
<td style="text-align: center;">10.92</td>
<td style="text-align: center;">19.5</td>
</tr>
<tr class="even">
<td style="text-align: center;">19</td>
<td style="text-align: center;">3570</td>
<td style="text-align: center;">9.2</td>
<td style="text-align: center;">56</td>
<td style="text-align: center;">5.44</td>
<td style="text-align: center;">16.53</td>
<td style="text-align: center;">17</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">26</td>
<td style="text-align: center;">1450</td>
<td style="text-align: center;">7.9</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">2.96</td>
<td style="text-align: center;">8.84</td>
<td style="text-align: center;">18.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">20</td>
<td style="text-align: center;">4106</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">96</td>
<td style="text-align: center;">2.62</td>
<td style="text-align: center;">5.45</td>
<td style="text-align: center;">15.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">38</td>
<td style="text-align: center;">10274</td>
<td style="text-align: center;">9.3</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">5.45</td>
<td style="text-align: center;">24.76</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="odd">
<td style="text-align: center;">19</td>
<td style="text-align: center;">510</td>
<td style="text-align: center;">6.7</td>
<td style="text-align: center;">82</td>
<td style="text-align: center;">5.25</td>
<td style="text-align: center;">14.19</td>
<td style="text-align: center;">26.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Im Folgenden werden wir die Daten nur für das Fitten eines Modells verwenden. In den anderen oben genannten Kapiteln nutzen wir die Daten dann anders. In <a href="#fig-pois-model-longnose" class="quarto-xref">Abbildung&nbsp;<span>55.3</span></a> sehen wir nochmal die Verteilung der Anzahl der Hechte in den Flüssen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(longnose_tbl, <span class="fu">aes</span>(longnose)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pois-model-longnose" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pois-model-longnose-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-poisson_files/figure-html/fig-pois-model-longnose-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;55.3— Histogramm der Verteilung der Hechte in den beobachteten Flüssen."><img src="stat-modeling-poisson_files/figure-html/fig-pois-model-longnose-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pois-model-longnose-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;55.3— Histogramm der Verteilung der Hechte in den beobachteten Flüssen.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="fit-des-modells" class="level2 page-columns page-full" data-number="55.3">
<h2 data-number="55.3" class="anchored" data-anchor-id="fit-des-modells"><span class="header-section-number">55.3</span> Fit des Modells</h2>
<p>In diesem Abschnitt wollen wir verschiedene Modelle für Zähldaten schätzen. Die Poissonverteilung hat keinen eignen Parameter für die Streung wie die Normalverteilung. Die Poissonverteilung ist mit <span class="math inline">\(\mathcal{Pois}(\lambda)\)</span> definiert und hat somit die Eigenschaft das die Varianz eins zu eins mit dem Mittelwert <span class="math inline">\(\lambda\)</span> der Poissonverteilung ansteigt. Es kann aber sein, dass wir in den Daten nicht diesen ein zu eins Zusammenhang von Mittelwert und Varianz vrliegen haben. Häufig ist die Varianz viel größer und steigt schneller an. Wenn die Varianz in Wirklichkeit sehr viel größer ist, dann würden wir die Varianz in unseren Modell unterschätzen.</p>
<ul>
<li>Ein klassisches Poissonmodell <code>glm(..., familiy = poisson)</code> mit der Annahme keiner Overdisperison.</li>
<li>Ein Quasi-Poissonmodell <code>glm(..., family = quasipoisson)</code> mit der Möglichkeit der Berücksichtigung einer Overdispersion.</li>
<li>Ein negative Binomialmodell <code>glm.nb(...)</code> ebenfalls mit der Berücksichtigung einer Overdispersion.</li>
</ul>
<p>Beginnen wollen wir aber mit einer klassischen Poissonregression ohne die Annahme von einer Overdispersion in den Daten. Wir nutzen dafür die Funktion <code>glm()</code> und spezifizieren die Verteilungsfamilie als <code>poisson</code>. Wir nehmen wieder alle Variablen in das Modell auf der rechten Seite des <code>~</code>. Auf der linken Seite des <code>~</code> kommt dann unser Outcome <code>longnose</code> was die Anzahl an Hechten erhält.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">Hier gibt es nur die Kurzfassung der <em>link</em>-Funktion. <span class="citation" data-cites="dormann2013parametrische">Dormann (<a href="#ref-dormann2013parametrische" role="doc-biblioref">2013</a>)</span> liefert hierzu in Kapitel 7.1.3 nochmal ein Einführung in das Thema.</span></div></div>
<p>Wir müssen für die Possionregression noch beachten, dass die Zähldaten von <span class="math inline">\(0\)</span> bis <span class="math inline">\(+\infty\)</span> laufen. Damit wir normalverteilte Residuen erhalten und einen lineren Zusammenhang, werden wir das Modell auf dem <span class="math inline">\(\log\)</span>-scale fitten. Das heißt, wir werden den Zusammenhang von <span class="math inline">\(y\)</span> und <span class="math inline">\(x\)</span> logarithmieren. Wichtig ist hierbei der <em>Zusammenhang</em>. Wir transformieren nicht einfach <span class="math inline">\(y\)</span> und lassen den Rest unberührt. Das führt dazu, dass wir am Ende die Koeffizienten der Poissonregression exponieren müssen. Das können die gängigen Funktionen, wir müssen das Exponieren aber aktiv durchführen. Deshalb hier schon mal erwähnt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>poisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(longnose <span class="sc">~</span> area <span class="sc">+</span> do2 <span class="sc">+</span> maxdepth <span class="sc">+</span> no3 <span class="sc">+</span> so4 <span class="sc">+</span> temp,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                    longnose_tbl, <span class="at">family =</span> poisson)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir schauen uns die Ausgabe des Modells einmal mit der <code>summary()</code> Funktion an, da wir hier einmal händisch schauen wollen, ob eine Overdispersion vorliegt. Sonst könnten wir auch die Funktion <code>model_parameters()</code> nehmen. Die nutzen wir später für die Interpretation des Modells, hier wollen wir erstmal sehen, ob alles geklappt hat.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>poisson_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = longnose ~ area + do2 + maxdepth + no3 + so4 + 
    temp, family = poisson, data = longnose_tbl)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.564e+00  2.818e-01  -5.551 2.83e-08 ***
area         3.843e-05  2.079e-06  18.480  &lt; 2e-16 ***
do2          2.259e-01  2.126e-02  10.626  &lt; 2e-16 ***
maxdepth     1.155e-02  6.688e-04  17.270  &lt; 2e-16 ***
no3          1.813e-01  1.068e-02  16.974  &lt; 2e-16 ***
so4         -6.810e-03  3.622e-03  -1.880   0.0601 .  
temp         7.854e-02  6.530e-03  12.028  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 2766.9  on 67  degrees of freedom
Residual deviance: 1590.0  on 61  degrees of freedom
AIC: 1936.9

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p>Wir schauen in die Summary-Ausgabe des Poissonmodells und sehen, dass dort steht, dass <code>Dispersion parameter for poisson family taken to be 1</code>. Wir modellieren also einen eins zu eins Zusammenhang von Mittelwert und Varianz. Wenn dieser Zusammenhang nicht in unseren Daten existiert, dann haben wir eine Overdispersion vorliegen.</p>
<p>Wir können die Overdispersion mit abschätzen indem wir die <code>Residual deviance</code> durch die Freiheitsgrade der <code>Residual deviance</code> teilen. Daher erhalten wir eine Overdispersion von <span class="math inline">\(\cfrac{1590.04}{61} \approx 26.1\)</span>. Damit haben wir eine eindeutige Overdispersion vorliegen. Damit steigt die Varianz in einem Verhältnis von ca. 1 zu 26. Wir können auch die Funktion <code>check_overdispersion()</code> aus dem R Paket <code>{performance}</code> nutzen um die Overdispersion zu berechnen. Die Funktion kann das schneller und ist auch in der Abfolge einer Analyse besser geeignet.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>poisson_fit <span class="sc">|&gt;</span> <span class="fu">check_overdispersion</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

       dispersion ratio =   29.403
  Pearson's Chi-Squared = 1793.599
                p-value =  &lt; 0.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Overdispersion detected.</code></pre>
</div>
</div>
<p>Wenn wir Overdispersion vorliegen haben und damit die Varianz zu niedrig schätzen, dann erhalten wir viel mehr signifikante Ergebnisse als es in den Daten zu erwarten wäre. Schauen wir uns nochmal die Parameter der Poissonverteilung und die <span class="math inline">\(p\)</span>-Werte einmal an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>poisson_fit <span class="sc">|&gt;</span> <span class="fu">model_parameters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   |  Log-Mean |       SE |         95% CI |     z |      p
--------------------------------------------------------------------
(Intercept) |     -1.56 |     0.28 | [-2.12, -1.01] | -5.55 | &lt; .001
area        |  3.84e-05 | 2.08e-06 | [ 0.00,  0.00] | 18.48 | &lt; .001
do2         |      0.23 |     0.02 | [ 0.18,  0.27] | 10.63 | &lt; .001
maxdepth    |      0.01 | 6.69e-04 | [ 0.01,  0.01] | 17.27 | &lt; .001
no3         |      0.18 |     0.01 | [ 0.16,  0.20] | 16.97 | &lt; .001
so4         | -6.81e-03 | 3.62e-03 | [-0.01,  0.00] | -1.88 | 0.060 
temp        |      0.08 | 6.53e-03 | [ 0.07,  0.09] | 12.03 | &lt; .001</code></pre>
</div>
</div>
<p>In der Spalte <code>p</code> finden wir die <span class="math inline">\(p\)</span>-Werte für alle Variablen. Wir sehen, dass fast alle Variablen signifikant sind und das wir eine sehr niedrige Varianz in der Spalte <code>SE</code> sehen. Das heißt unser geschätzer Fehler ist sehr gering. Das ahnten wir ja schon, immerhin haben wir eine Overdisperson vorliegen. Das Modell ist somit falsch. Wir müssen uns ein neues Modell suchen, was Overdispersion berückscihtigen und modellieren kann.</p>
<p>Die Quasi-Poisson Verteilung hat einen zusätzlichen, unabhänigen Parameter um die Varianz der Verteilung zu schätzen. Daher können wir die Overdispersion mit einer Quasi-Poisson Verteilung berückscihtigen. Wir können eine Quasi-Poisson Verteilung auch mit der Funktion <code>glm()</code> schätzen nur müssen wir als Verteilungsfamilie <code>quasipoisson</code> angeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>quasipoisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(longnose <span class="sc">~</span> area <span class="sc">+</span> do2 <span class="sc">+</span> maxdepth <span class="sc">+</span> no3 <span class="sc">+</span> so4 <span class="sc">+</span> temp,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> longnose_tbl, <span class="at">family =</span> quasipoisson)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Nach dem Modellti können wir nochmal in der <code>summary()</code> Funktion schauen, ob wir die Overdispersion richtig berücksichtigt haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>quasipoisson_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = longnose ~ area + do2 + maxdepth + no3 + so4 + 
    temp, family = quasipoisson, data = longnose_tbl)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) -1.564e+00  1.528e+00  -1.024  0.30999   
area         3.843e-05  1.128e-05   3.408  0.00116 **
do2          2.259e-01  1.153e-01   1.960  0.05460 . 
maxdepth     1.155e-02  3.626e-03   3.185  0.00228 **
no3          1.813e-01  5.792e-02   3.130  0.00268 **
so4         -6.810e-03  1.964e-02  -0.347  0.73001   
temp         7.854e-02  3.541e-02   2.218  0.03027 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 29.40332)

    Null deviance: 2766.9  on 67  degrees of freedom
Residual deviance: 1590.0  on 61  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p>An der Zeile <code>Dispersion parameter for quasipoisson family taken to be 29.403319</code> in der Summary-Ausgabe sehen wir, dass das Modell der Quasi-Possion Verteilung die Overdispersion korrekt berücksichtigt hat. Wir können uns nun einmal die Modellparameter anschauen. Die Interpretation machen wir am Ende des Kapitels.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>quasipoisson_fit <span class="sc">|&gt;</span> <span class="fu">model_parameters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   |  Log-Mean |       SE |        95% CI | t(61) |      p
-------------------------------------------------------------------
(Intercept) |     -1.56 |     1.53 | [-4.57, 1.41] | -1.02 | 0.306 
area        |  3.84e-05 | 1.13e-05 | [ 0.00, 0.00] |  3.41 | &lt; .001
do2         |      0.23 |     0.12 | [ 0.00, 0.45] |  1.96 | 0.050 
maxdepth    |      0.01 | 3.63e-03 | [ 0.00, 0.02] |  3.18 | 0.001 
no3         |      0.18 |     0.06 | [ 0.07, 0.29] |  3.13 | 0.002 
so4         | -6.81e-03 |     0.02 | [-0.05, 0.03] | -0.35 | 0.729 
temp        |      0.08 |     0.04 | [ 0.01, 0.15] |  2.22 | 0.027 </code></pre>
</div>
</div>
<p>Jetzt sieht unser Modell und die <span class="math inline">\(p\)</span>-Werte zusammen mit dem Standardfehler <code>SE</code> schon sehr viel besser aus. Wir können also diesem Modell erstmal von der Seite der Overdispersion vertrauen.</p>
<p>Am Ende wollen wir nochmal das Modell mit der negativen Binomialverteilung rechnen. Die negativen Binomialverteilung erlaubt auch eine Unabhängigkeit von dem Mittelwert zu der Varianz. Wir können hier auch für die Overdispersion adjustieren. Wir rechnen die negativen Binomialregression mit der Funktion <code>glm.nb()</code> aus dem R Paket <code>{MASS}</code>. Wir müssen keine Verteilungsfamilie angeben, die Funktion <code>glm.nb()</code> kann nur die negative Binomialverteilung modellieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>negativebinomial_fit <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(longnose <span class="sc">~</span> area <span class="sc">+</span> do2 <span class="sc">+</span> maxdepth <span class="sc">+</span> no3 <span class="sc">+</span> so4 <span class="sc">+</span> temp,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> longnose_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Auch hier schauen wir mit der Funktion <code>summary()</code> einmal, ob die Overdisprsion richtig geschätzt wurde oder ob hier auch eine Unterschätzung des Zusammenhangs des Mittelwerts und der Varianz vorliegt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>negativebinomial_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm.nb(formula = longnose ~ area + do2 + maxdepth + no3 + so4 + 
    temp, data = longnose_tbl, init.theta = 1.666933879, link = log)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -2.946e+00  1.305e+00  -2.256 0.024041 *  
area         4.651e-05  1.300e-05   3.577 0.000347 ***
do2          3.419e-01  1.050e-01   3.256 0.001130 ** 
maxdepth     9.538e-03  3.465e-03   2.752 0.005919 ** 
no3          2.072e-01  5.627e-02   3.683 0.000230 ***
so4         -2.157e-03  1.517e-02  -0.142 0.886875    
temp         9.460e-02  3.315e-02   2.854 0.004323 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Negative Binomial(1.6669) family taken to be 1)

    Null deviance: 127.670  on 67  degrees of freedom
Residual deviance:  73.648  on 61  degrees of freedom
AIC: 610.18

Number of Fisher Scoring iterations: 1

              Theta:  1.667 
          Std. Err.:  0.289 

 2 x log-likelihood:  -594.175 </code></pre>
</div>
</div>
<p>Auch hier sehen wir, dass die Overdispersion mit dem Parameter <span class="math inline">\(\theta\)</span> berücksichtigt wird. Wir können die Zahl <span class="math inline">\(1.67\)</span> nicht direkt mit der Overdispersion aus einer Poissonregression verglechen, aber wir sehen dass das Verhältnis von <code>Residual deviance</code> zu den Freiheitsgraden mit <span class="math inline">\(\cfrac{73.65}{61} \approx 1.20\)</span> fast bei 1:1 liegt. Wir könnten also auch eine negative Binomialverteilung für das Modellieren nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>negativebinomial_fit <span class="sc">|&gt;</span> <span class="fu">model_parameters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   |  Log-Mean |       SE |         95% CI |     z |      p
--------------------------------------------------------------------
(Intercept) |     -2.95 |     1.31 | [-5.85, -0.10] | -2.26 | 0.024 
area        |  4.65e-05 | 1.30e-05 | [ 0.00,  0.00] |  3.58 | &lt; .001
do2         |      0.34 |     0.11 | [ 0.11,  0.58] |  3.26 | 0.001 
maxdepth    |  9.54e-03 | 3.47e-03 | [ 0.00,  0.02] |  2.75 | 0.006 
no3         |      0.21 |     0.06 | [ 0.10,  0.32] |  3.68 | &lt; .001
so4         | -2.16e-03 |     0.02 | [-0.03,  0.03] | -0.14 | 0.887 
temp        |      0.09 |     0.03 | [ 0.03,  0.16] |  2.85 | 0.004 </code></pre>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Wie immer gibt es reichlich Tipps &amp; Tricks welches Modell du nun nehmen solltest. <a href="https://stats.stackexchange.com/questions/201903/how-to-deal-with-overdispersion-in-poisson-regression-quasi-likelihood-negativ/332250#332250">How to deal with overdispersion in Poisson regression: quasi-likelihood, negative binomial GLM, or subject-level random effect?</a> und das Tutorial <a href="https://online.stat.psu.edu/stat504/lesson/9/9.2-0">Modeling Count Data</a>. Auch ich mus immer wieder schauen, was am besten konkret in der Anwendung passen könnte und würde.</p>
</div></div><p>Welches Modell nun das beste Modell ist, ist schwer zu sagen. Wenn du Overdisperion vorliegen hast, dann ist natürlich nur das Quasi-Poissonmodell oder das negative Binomialmodell möglich. Welche der beiden dann das bessere ist, hängt wieder von der Fragestellung ab. Allgemein gesprochen ist das Quasi-Poissonmodell <em>besser</em> wenn dich die Zusammenhänge von <span class="math inline">\(y\)</span> zu <span class="math inline">\(x\)</span> am meisten interessieren. Und das ist in unserem Fall hier die Sachlage. Daher gehen wir mit den Quasi-Poissonmdell dann weiter.</p>
</section>
<section id="performance-des-modells" class="level2" data-number="55.4">
<h2 data-number="55.4" class="anchored" data-anchor-id="performance-des-modells"><span class="header-section-number">55.4</span> Performance des Modells</h2>
<p>In diesem kurzen Abschnitt wollen wir uns einmal anschauen, ob das Modell neben der Overdispersion auch sonst aus statistischer Sicht in Ordnung ist. Wir wollen ja mit dem Modell aus dem Fit <code>quasipoisson_fit</code> weitermachen. Also schauen wir uns einmal das pseudo-<span class="math inline">\(R^2\)</span> für die Poissonregression an. Da wir es mit einem GLM zu tun haben, ist das <span class="math inline">\(R^2\)</span> mit Vorsicht zu genießen. In einer Gaussianregression können wir das <span class="math inline">\(R^2\)</span> als Anteil der erklärten Varianz durch das Modell interpretieren. Im Falle von GLM’s müssen wir hier vorsichtiger sein. In GLM’s gibt es ja keine Varianz sondern eine Deviance.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_efron</span>(quasipoisson_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3257711</code></pre>
</div>
</div>
<p>Mit einem pseudo-<span class="math inline">\(R^2\)</span> von <span class="math inline">\(0.33\)</span> erklären wir ca. 33% der Varianz in der Anzahl der Hechte. Das ist zwar keine super gute Zahl, aber dafür, dass wir nur eine handvoll von Parametern erfasst haben, ist es dann auch wieder nicht so schlecht. Die Anzahl an Hechten wird sicherlich an ganz vielen Parametern hängen, wir konnten immerhin einige wichtige Stellschrauben vermutlich finden.</p>
<p>In <a href="#fig-pois-model-check" class="quarto-xref">Abbildung&nbsp;<span>55.4</span></a> schauen wir uns nochmal die Daten in den Modelgüteplots an. Wir sehen vorallem, dass wir vielelicht doch einen Ausreißer mit der Beobachtung 17 vorliegen haben. Auch ist der Fit nicht so super, wie wir an dem QQ-Plot sehen. Die Beobachtungen fallen in dem QQ-Plot nicht alle auf eine Linie. Auch sehen wir dieses Muster in dem Residualplot. Hiererwarten wir eine gerade blaue Linie und auch hier haben wir eventuell Ausreißer mit in den Daten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(quasipoisson_fit, <span class="at">colors =</span> cbbPalette[<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>], </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"qq"</span>, <span class="st">"outliers"</span>, <span class="st">"pp_check"</span>, <span class="st">"homogeneity"</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pois-model-check" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pois-model-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-poisson_files/figure-html/fig-pois-model-check-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;55.4— Ausgabe ausgewählter Modelgüteplots der Funktion check_model()."><img src="stat-modeling-poisson_files/figure-html/fig-pois-model-check-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pois-model-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;55.4— Ausgabe ausgewählter Modelgüteplots der Funktion <code>check_model()</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-des-modells" class="level2" data-number="55.5">
<h2 data-number="55.5" class="anchored" data-anchor-id="interpretation-des-modells"><span class="header-section-number">55.5</span> Interpretation des Modells</h2>
<p>Um die Effektschätzer einer Poissonregression oder aber einer Quasipoisson-Regression interpretieren zu können müssen wir uns einmal einen Beispieldatensatz mit bekannten Effekten zwischen den Gruppen bauen. Im Folgenden bauen wir uns einen Datensatz mit zwei Gruppen. Einmal einer Kontrollgruppe mit einer mittleren Anzahl an <span class="math inline">\(15\)</span> und einer Behandlungsgruppe mit einer um <span class="math inline">\(\beta_1 = 10\)</span> höheren Anzahl. Wir haben also in der Kontrolle im Mittel eine Anzahl von <span class="math inline">\(15\)</span> und in der Behandlungsgruppe eine mittlere Anzahl von <span class="math inline">\(25\)</span>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>longnose_small_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">grp =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> sample_size),</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">count =</span> <span class="dv">15</span> <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> grp <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">2</span> <span class="sc">*</span> sample_size, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">round</span>(count),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">grp =</span> <span class="fu">factor</span>(grp, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"ctrl"</span>, <span class="st">"trt"</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In <a href="#tbl-pois-longnose-small" class="quarto-xref">Tabelle&nbsp;<span>55.2</span></a> sehen wir nochmal die Daten als Ausschnitt dargestellt.</p>
<div class="cell">
<div id="tbl-pois-longnose-small" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pois-longnose-small-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;55.2— How much is the fish? Der Datensatz über <span class="math inline">\(n = 1000\)</span> Beobachtungen an dem wir überlegen wollen wie wir die Effektschätzer einer Poissonregression zu interpretieren haben.
</figcaption>
<div aria-describedby="tbl-pois-longnose-small-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">grp</th>
<th style="text-align: center;">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ctrl</td>
<td style="text-align: center;">16</td>
</tr>
<tr class="even">
<td style="text-align: center;">ctrl</td>
<td style="text-align: center;">16</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ctrl</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;">ctrl</td>
<td style="text-align: center;">14</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">trt</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="odd">
<td style="text-align: center;">trt</td>
<td style="text-align: center;">25</td>
</tr>
<tr class="even">
<td style="text-align: center;">trt</td>
<td style="text-align: center;">26</td>
</tr>
<tr class="odd">
<td style="text-align: center;">trt</td>
<td style="text-align: center;">26</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Da sich die Tabelle schlecht liest hier nochmal der Boxplot in <a href="#fig-pois-model-small" class="quarto-xref">Abbildung&nbsp;<span>55.5</span></a>. Wir sehen den Grupenunterschied von <span class="math inline">\(10\)</span> sowie die unterschiedlichen mittleren Anzahlen für die Kontrolle und die Behandlung.</p>
<div class="cell" data-layout-nrow="2" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(longnose_small_tbl, <span class="fu">aes</span>(<span class="at">x =</span> grp, <span class="at">y =</span> count, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> longnose_small_tbl, <span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="st">"Gruppe"</span>) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">30</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-pois-model-small" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pois-model-small-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-pois-model-small" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-pois-model-small-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-pois-model-small-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-poisson_files/figure-html/fig-pois-model-small-1.png" class="lightbox" data-gallery="fig-pois-model-small" title="Abbildung&nbsp;55.5&nbsp;(a)— Verteilung der Werte als Boxplot."><img src="stat-modeling-poisson_files/figure-html/fig-pois-model-small-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-pois-model-small" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-pois-model-small-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Verteilung der Werte als Boxplot.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-pois-model-small" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-pois-model-small-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-pois-model-small-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-poisson_files/figure-html/fig-pois-model-small-2.png" class="lightbox" data-gallery="fig-pois-model-small" title="Abbildung&nbsp;55.5&nbsp;(b)— Verteilung der Werte als Densityplot."><img src="stat-modeling-poisson_files/figure-html/fig-pois-model-small-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-pois-model-small" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-pois-model-small-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Verteilung der Werte als Densityplot.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pois-model-small-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;55.5— How much is the fish? Der Boxplot über <span class="math inline">\(n = 1000\)</span> Beobachtungen an dem wir überlegen wollen wie wir die Effektschätzer einer Poissonregression zu interpretieren haben.
</figcaption>
</figure>
</div>
</div>
<p>Jetzt fitten wir einmal das simple Poissonmodell mit der Anzahl als Outcome und der Gruppe mit den zwei Leveln als <span class="math inline">\(x\)</span>. Wir pipen dann das Ergebnis des Fittes gleich in die Funktion <code>model_parameters()</code> weiter um die Ergebnisse des Modellierens zu erhalten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(count <span class="sc">~</span> grp, <span class="at">data =</span> longnose_small_tbl, <span class="at">family =</span> poisson) <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   |   IRR |   SE |         95% CI |      z |      p
-------------------------------------------------------------
(Intercept) | 14.98 | 0.39 | [14.23, 15.75] | 104.76 | &lt; .001
grp [trt]   |  1.67 | 0.05 | [ 1.57,  1.78] |  15.69 | &lt; .001</code></pre>
</div>
</div>
<p>Als erstes fällt auf, dass wir die Ausgabe des Modells exponieren müssen. Um einen linearen Zusamenhang hinzukriegen bedient sich die Poissonregression den Trick, das der Zusammenhang zwischen dem <span class="math inline">\(y\)</span> und dem <span class="math inline">\(x\)</span> <em>transformiert</em> wird. Wir rechnen unsere Regression nicht auf den echten Daten sondern auf dem <span class="math inline">\(\log\)</span>-scale. Daher müssen wir die Koeffizienten der Poissonregression wieder zurücktransfomieren, wenn wir die Koeffizienten interpretieren wollen. Das können wir mit der Option <code>exponentiate = TRUE</code> durchführen.</p>
<p>Gut soweit, aber was heißen den jetzt die Zahlen? Wir haben einen Intercept von <span class="math inline">\(14.99\)</span> das entspricht der mittleren Anzahl in der Kontrollgruppe. Und was sagt jetzt die <span class="math inline">\(1.67\)</span> vom Level <code>trt</code> des Faktors <code>grp</code>? Wenn wir <span class="math inline">\(14.99 \cdot 1.67\)</span> rechnen, dann erhalten wir als Ergebnis <span class="math inline">\(25.03\)</span>, also die mittlere Anzahl in der Behandlungsgruppe. Was sagt uns das jetzt aus? Wir erhalten aus der Poissonregression eine Wahrscheinlichkeit oder aber ein Risk Ratio. Wir können sagen, dass die Anzahl in der Behandlungsgruppe <span class="math inline">\(1.67\)</span>-mal so groß ist wie in der Kontrollgruppe.</p>
<p>Schauen wir uns nochmal das volle Modell an und interpretieren die Effekte der einzelnen Variablen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   |  IRR |       SE |       95% CI | t(61) |      p
-------------------------------------------------------------
(Intercept) | 0.21 |     0.32 | [0.01, 4.11] | -1.02 | 0.306 
area        | 1.00 | 1.13e-05 | [1.00, 1.00] |  3.41 | &lt; .001
do2         | 1.25 |     0.14 | [1.00, 1.57] |  1.96 | 0.050 
maxdepth    | 1.01 | 3.67e-03 | [1.00, 1.02] |  3.18 | 0.001 
no3         | 1.20 |     0.07 | [1.07, 1.34] |  3.13 | 0.002 
so4         | 0.99 |     0.02 | [0.95, 1.03] | -0.35 | 0.729 
temp        | 1.08 |     0.04 | [1.01, 1.16] |  2.22 | 0.027 </code></pre>
</div>
</div>
<p>So schön auch die Funktion <code>model_parameters()</code> ist, so haben wir aber hier das Problem, dass wir den Effekt von <code>area</code> nicht mehr richtig sehen. Wir kriegen hier eine zu starke Rundung auf zwei Nachkommastellen. Wir nutzen jetzt mal die Funktion <code>tidy()</code> um hier Abhilfe zu leisten. Ich muss hier noch die Spalte <code>estimate</code> mit <code>num(..., digits = 5)</code> anpassen, damit du in der Ausgabe auf der Webseite auch die Nachkommastellen siehst.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">estimate =</span> <span class="fu">num</span>(estimate, <span class="at">digits =</span> <span class="dv">5</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 3
  term         estimate p.value
  &lt;chr&gt;       &lt;num:.5!&gt; &lt;chr&gt;  
1 (Intercept)   0.20922 0.310  
2 area          1.00004 0.001  
3 do2           1.25342 0.055  
4 maxdepth      1.01162 0.002  
5 no3           1.19879 0.003  
6 so4           0.99321 0.730  
7 temp          1.08171 0.030  </code></pre>
</div>
</div>
<p>Schauen wir uns die Effekte der Poissonregression einmal an und versuchen die Ergebnisse zu interpretieren. Dabei ist wichtig sich zu erinnern, dass kein Effekt eine 1 bedeutet. Wir schauen hier auf einen Faktor. Wenn wir eine Anzahl mal Faktor 1 nehmen, dann ändert sich nichts an der Anzahl.</p>
<ul>
<li><code>(Intercept)</code> beschreibt den Intercept der Poissonregression. Wenn wir mehr als eine simple Regression vorliegen haben, wie in diesem Fall, dann ist der Intercept schwer zu interpretieren. Wir konzentrieren uns auf die Effekte der anderen Variablen.</li>
<li><code>area</code>, beschreibt den Effekt der Fläche. Steigt die Fläche um ein Quadratmeter an, so erhöht sich die <em>Anzahl an Fischen</em> um den <span class="math inline">\(1.00001\)</span>. Daher würde man hier eher sagen, erhöht sich die Fläche um jeweils 1000qm so erhöht sich die <em>Anzahl an Fischen</em> um den Faktor <span class="math inline">\(1.1\)</span>. Dann haben wir auch einen besser zu interpretierenden Effektschätzer. Die Signifikanz bleibt hier davon unbetroffen.</li>
<li><code>do2</code>, beschreibt den Partzialdruck des Sauerstoffs. Steigt dieser um eine Einheit an, so sehen wie eine Erhöhung der <em>Anzahl an Fischen</em> um den Faktor <span class="math inline">\(1.25\)</span>. Der Effekt ist gerade <em>nicht</em> signifikant.</li>
<li><code>maxdepth</code>, beschreibt die maximale Tiefe. Je tiefer ein Fluss, desto mehr Hechte werden wir beobachten. Der Effekt von <span class="math inline">\(1.01\)</span> pro Meter Tiefe ist signifikant.</li>
<li><code>no3</code>, beschreibt den Anteil an Nitrat in den Flüssen. Je mehr Nitrat desto signifiant mehr Hechte werden wir beobachten. Hier steigt der Faktor auch um <span class="math inline">\(1.20\)</span>.</li>
<li><code>so4</code>, beschreibt den Schwefelgehalt und mit steigenden Schwefelgehalt nimmt die <em>Anzahl an Fischen</em> leicht ab. Der Effekt ist aber überhaupt nicht signifikant.</li>
<li><code>temp</code>, beschreibt die Temperatur der Flüsse. Mit steigender Temperatur erwarten wir mehr Hechte zu beobachten. Der Effekt von <span class="math inline">\(1.08\)</span> Fischen pro Grad Erhöhung ist signifikant.</li>
</ul>
<p>Was nehmen wir aus der Poissonregression zu den langnasigen Hechten mit? Zum einen haben die Fläche, die Tiefe und der Nitratgehalt einen signifikanten Einfluss auf die Anzahl an Hechten. Auch führt eine höhere Temperatur zu mehr gefundenen Hechten. Die erhöhte Temperatur steht etwas im Widerspuch zu dem Sauerstoffpartizaldruck. Denn je höher die Temperatur desto weniger Sauerstoff wird in dem Wasser gelöst sein. Auch scheint die Oberfläche mit der Tiefe korreliert. Allgemein scheinen Hechte große Flüsse zu mögen. Hier bietet sich also noch eine Variablenselektion oder eine Untersuchung auf Ausreißer an um solche Effekte nochmal gesondert zu betrachten.</p>
</section>
<section id="zeroinflation" class="level2" data-number="55.6">
<h2 data-number="55.6" class="anchored" data-anchor-id="zeroinflation"><span class="header-section-number">55.6</span> Zeroinflation</h2>
<p>So eine Poissonregression hat schon einiges an Eigenheiten. Neben dem Problem der Overdispersion gibt es aber noch eine weitere Sache, die wir beachten müssen. Wir können bei einer Poissonregression auch eine Zeroinflation vorliegen haben. Das heißt, wir beobachten viel mehr Nullen in den Daen, als wir aus der Poissonverteilung erwarten würden. Es gibt also einen biologischen oder künstlichn Prozess, der uns Nullen produziert. Häufig wissen wir nicht, ob wir den Prozess, der uns die Nullen in den Daten produziert, auch abbilden. Das heißt, es kann sein, dass wir einfach nichts Zählen, weil dort nichts ist oder aber es gibt dafür einen Grund. Diesen Grund müssten wir dann irgendwie in unseren Daten erfasst haben, aber meistens haben wir das nicht.</p>
<p>Schauen wir usn dafür einmal ein Datenbeispiel von Eidechsen in der Lüneburgerheide an. Wir haben Eidechsen <code>lizard</code> in zwei verschiedenen Habitaten <code>grp</code> gezählt. Einmal, ob die Eidechsen eher im offenen Gelände oder eher im bedeckten Gelände zu finden waren. Im Weiteren haben wir geschaut, ob der Boden keinen Regen erhalten hatte, trocken war oder gar feucht. Mit trocken ist hier eine gewisse Restfeuchte gemeint. Am Ende haben wir noch bestimmt, ob wir eher nah an einer Siedlung waren oder eher weiter entfernt. Du kannst dir den Daten satz in der Datei <code>lizards.csv</code> nochmal anschauen. In <a href="#tbl-lizard-data" class="quarto-xref">Tabelle&nbsp;<span>55.3</span></a> sind die Daten nochmal dargestellt.</p>
<div class="cell">
<div id="tbl-lizard-data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lizard-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;55.3— Ausschnitt aus den Eidechsendaten für die zwei Habitate unter verschiedenen Feuchtigkeitsbedingungen und Nähe zur nächsten Siedlung.
</figcaption>
<div aria-describedby="tbl-lizard-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">grp</th>
<th style="text-align: center;">rain</th>
<th style="text-align: center;">pop</th>
<th style="text-align: center;">lizard</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">open</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">near</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">open</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">near</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">open</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">near</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">open</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">near</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">open</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">near</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">open</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">far</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">open</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">far</td>
<td style="text-align: center;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In <a href="#fig-pois-lizard-data" class="quarto-xref">Abbildung&nbsp;<span>55.6</span></a> sehen wir die Zähldaten der Eidechsen nochmal als Histogramm dargestellt. Wenn wir an einem Punkt keine Eidechsen gefunden haben, dann haben wir keine fehlenden Werte eingetragen, sondern eben, dass wir keine Eidechsen gezählt haben. Wir sehen das wir sehr viele Nullen in unseren Daten haben. Ein Indiz für eine Inflation an Nullen oder eben einer Zeroinflation.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lizard_zero_tbl, <span class="fu">aes</span>(lizard)) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Anzahl der gefundenen Eidechsen"</span>, <span class="at">y =</span> <span class="st">"Anzahl"</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pois-lizard-data" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pois-lizard-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-poisson_files/figure-html/fig-pois-lizard-data-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Abbildung&nbsp;55.6— Histogramm der Verteilung der Hechte in den beobachteten Flüssen."><img src="stat-modeling-poisson_files/figure-html/fig-pois-lizard-data-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pois-lizard-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;55.6— Histogramm der Verteilung der Hechte in den beobachteten Flüssen.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Um zu überprüfen, ob wir eine Zeroinflation in den Daten vorliegen haben, werden wir erstmal eine ganz normale Poissonregression auf den Daten rechnen. Wir ignorieren auch eine potenzielle Overdispersion. Das schauen wir uns dann in den Daten später nochmal an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>lizard_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(lizard <span class="sc">~</span> grp <span class="sc">+</span> rain <span class="sc">+</span> pop, <span class="at">data =</span> lizard_zero_tbl,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> poisson)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wie immer nutzen wir die Funktion <code>model_parameters()</code> um uns die exponierten Koeffizienten aus dem Modell wiedergeben zu lassen. Das Modell dient uns jetzt nur als Ausgangsmodell und wir werden das Poissonmodell jetzt nicht weiter tiefer verwenden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>lizard_fit <span class="sc">|&gt;</span> <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   |  IRR |   SE |       95% CI |     z |      p
---------------------------------------------------------
(Intercept) | 1.06 | 0.29 | [0.60, 1.77] |  0.20 | 0.840 
grp [cover] | 1.88 | 0.46 | [1.18, 3.07] |  2.61 | 0.009 
rain [dry]  | 0.31 | 0.09 | [0.17, 0.53] | -4.12 | &lt; .001
rain [wet]  | 0.13 | 0.05 | [0.06, 0.28] | -4.98 | &lt; .001
pop [far]   | 2.41 | 0.61 | [1.49, 4.04] |  3.47 | &lt; .001</code></pre>
</div>
</div>
<p>Wir sehen, dass wir in der Variable <code>rain</code> eine starke Reduzierung der Anzahl an Eidechsen sehen. Vielleicht ist dies eine Variable, die zu viele Nullen produziert. Auch hat die Variable <code>pop</code>, die für die Nähe an einer Siedlung kodiert, einen starken positiven Effekt auf unsere Anzahl an Eidechsen. Hier wollen wir also einmal auf eine Zeroinflation überprüfen. Wir nutzen dazu die Funktion <code>check_zeroinflation()</code> aus dem R Paket <code>{performance}</code>. Die Funktion läuft nur auf einem Modellfit.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_zeroinflation</span>(lizard_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Check for zero-inflation

   Observed zeros: 31
  Predicted zeros: 27
            Ratio: 0.87</code></pre>
</div>
</div>
<p>Die Funktion gibt uns wieder, dass wir vermutlich eine Zeroinflation vorliegen haben. Das können wir aber Modellieren. Um eine Zeroinflation <em>ohne Overdispersion</em> zu modellieren nutzen wir die Funktion <code>zeroinfl()</code> aus dem R Paket <code>{pscl}</code>. Der erste Teil der Funktion ist leicht erkläret. Wir bauen uns wieder unswer Model zusammen, was wir fitten wollen. Dann kommt aber ein <code>|</code> und mit diesem Symbol <code>|</code> definieren wir, ob wir wissen, woher die Nullen kommen oder aber ob wir die Nullen mit einem zufälligen Prozess modellieren wollen.</p>
<p>Wenn wir das Modell in der Form <code>y ~ f1 + f2 | 1</code> schreiben, dann nehmen wir an, dass das Übermaß an Nullen in unseren Daten rein zufällig entstanden sind. Wir haben keine Spalte in de Daten, die uns eine Erklärung für die zusätzlichen Nullen liefern würde.</p>
<p>Wir können auch <code>y ~ f1 + f2 | x3</code> schreiben. Dann haben wir eine Variable <code>x3</code> in den Daten von der wir glauben ein Großteil der Nullen herrührt. Wir könnten also in unseren Daten annehmen, dass wir den Überschuss an Nullen durch den Regen erhalten haben und damit über die Spalte <code>rain</code> den Exzess an Nullen modellieren.</p>
<p>Man sollte immer mit dem einfachsten Modell anfangen, deshalb werden wir jetzt einmal ein Modell fitten, dass annimmt, dass die Nullen durch einen uns unbekannten Zufallsprozess entstanden sind.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>lizard_zero_infl_intercept_fit <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(lizard <span class="sc">~</span> grp <span class="sc">+</span> pop <span class="sc">+</span> rain <span class="sc">|</span> <span class="dv">1</span>, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">data =</span> lizard_zero_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir schauen uns das Modell dann wieder einmal an und sehen eine Zweiteilung der Ausgabe. In dem oberen Teil der Ausgabe wird unsere Anzahl an Eidechsen modelliert. In dem unteren Teil wird der Anteil der Nullen in den Daten modelliert. Daher können wir über Variablen in dem <code>Zero-Inflation</code> Block keine Aussagen über die Anzahl an Eidechsen treffen. Variablen tauchen nämlich nur in einem der beiden Blöcke auf.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>lizard_zero_infl_intercept_fit <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   |  IRR |   SE |       95% CI |     z |      p
---------------------------------------------------------
(Intercept) | 1.06 | 0.31 | [0.60, 1.87] |  0.22 | 0.830 
grp [cover] | 2.03 | 0.51 | [1.25, 3.31] |  2.84 | 0.005 
pop [far]   | 2.59 | 0.67 | [1.56, 4.31] |  3.67 | &lt; .001
rain [dry]  | 0.31 | 0.10 | [0.17, 0.56] | -3.82 | &lt; .001
rain [wet]  | 0.14 | 0.06 | [0.06, 0.31] | -4.73 | &lt; .001

# Zero-Inflation

Parameter   | Odds Ratio |   SE |       95% CI |     z |     p
--------------------------------------------------------------
(Intercept) |       0.11 | 0.11 | [0.02, 0.74] | -2.26 | 0.024</code></pre>
</div>
</div>
<p>Als erstes beobachten wir einen größeren Effekt der Variable <code>grp</code>. Das ist schon mal ein spannender Effekt. An der Signifikanz hat scih nicht viel geändert. Wir werden am Ende des Kapitels einmal alle Modell für die Modellierung der Zeroinflation vergleichen.</p>
<p>Nun könnte es auch sein, dass der Effekt der vielen Nullen in unserer Variable <code>rain</code> verborgen liegt. Wenn es also regnet, dann werden wir viel weniger Eidechsen beoabchten. Nehmen wir also <code>rain</code> als ursächliche Variable mit in das Modell für die Zeroinflation.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>lizard_zero_infl_rain_fit <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(lizard <span class="sc">~</span> grp <span class="sc">+</span> pop <span class="sc">|</span> rain, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">data =</span> lizard_zero_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wieder schauen wir uns einmal die Ausgabe des Modells einmal genauer an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>lizard_zero_infl_rain_fit <span class="sc">|&gt;</span> <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   |  IRR |   SE |       95% CI |    z |     p
-------------------------------------------------------
(Intercept) | 1.13 | 0.34 | [0.63, 2.03] | 0.42 | 0.677
grp [cover] | 1.60 | 0.42 | [0.95, 2.67] | 1.77 | 0.077
pop [far]   | 1.84 | 0.51 | [1.07, 3.18] | 2.20 | 0.028

# Zero-Inflation

Parameter   | Odds Ratio |     SE |          95% CI |     z |     p
-------------------------------------------------------------------
(Intercept) |       0.04 |   0.08 | [0.00,    2.09] | -1.60 | 0.109
rain [dry]  |      27.93 |  59.03 | [0.44, 1758.19] |  1.58 | 0.115
rain [wet]  |      83.69 | 178.35 | [1.28, 5452.98] |  2.08 | 0.038</code></pre>
</div>
</div>
<p>Es ändert sich einiges. Zum einen erfahren wir, dass der Regen anscheined doch viele Nullen in den Daten produziert. Wir haben ein extrem hohes <span class="math inline">\(OR\)</span> für die Variable <code>rain</code>. Die Signifikanz ist jedoch eher gering. Wir haben nämlich auch eine sehr hohe Streuung mit den großen <span class="math inline">\(OR\)</span> vorliegen. Au der anderen Seite verlieren wir jetzt auch die Signifikanz von unseren Habitaten und dem Standort der Population. Nur so mäßig super dieses Modell.</p>
<p>Wir können jetzt natürlich auch noch den Standort der Population mit in den Prozess für die Entstehung der Nullen hineinnehmen. Wir schauen uns dieses Modell aber nicht mehr im Detail an, sondern dann nur im Vergleich zu den anderen Modellen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>lizard_zero_infl_rain_pop_fit <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(lizard <span class="sc">~</span> grp <span class="sc">|</span> rain <span class="sc">+</span> pop, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">data =</span> lizard_zero_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die Gefahr besteht immer, das man sich an die Wand modelliert und vor lauter Modellen die Übersicht verliert. Neben der Zeroinflation müssen wir ja auch schauen, ob wir eventuell eine Overdispersion in den Daten vorliegen haben. Wenn das der Fall ist, dann müsen wir nochmal überlegen, was wir dann machen. Wir testen nun auf Ovrdisprsion in unserem <em>ursprünglichen</em> Poissonmodell mit der Funktion <code>check_overdispersion()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_overdispersion</span>(lizard_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

       dispersion ratio =  1.359
  Pearson's Chi-Squared = 74.743
                p-value =  0.039</code></pre>
</div>
</div>
<p>Tja, und so erfahren wir, dass wir auch noch Overdispersion in unseren Daten vorliegen haben. Wir müsen also beides Modellieren. Einmal modellieren wir die Zeroinflation und einmal die Overdispersion. Wir können beides in einem negativen binominalen Modell fitten. Auch hier hilft die Funktion <code>zeroinfl()</code> mit der Option <code>dist = negbin</code>. Mit der Option geben wir an, dass wir eine negative binominal Verteilungsfamilie wählen. Damit können wir dann auch die Ovrdispersion in unseren Daten modellieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>lizard_zero_nb_intercept_fit <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(lizard <span class="sc">~</span> grp <span class="sc">+</span> rain <span class="sc">+</span> pop <span class="sc">|</span> <span class="dv">1</span>, </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">dist =</span> <span class="st">"negbin"</span>, <span class="at">data =</span> lizard_zero_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann schauen wir usn einmal das Modell an. Zum einen sehen wir, dass der Effekt ähnlich groß ist, wie bei dem Intercept Modell der Funktion <code>zeroinfl</code>. Auch bleiben die Signifikanzen ähnlich.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>lizard_zero_nb_intercept_fit <span class="sc">|&gt;</span> <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   |  IRR |   SE |       95% CI |     z |      p
---------------------------------------------------------
(Intercept) | 1.06 | 0.31 | [0.60, 1.87] |  0.22 | 0.830 
grp [cover] | 2.03 | 0.51 | [1.25, 3.31] |  2.84 | 0.005 
rain [dry]  | 0.31 | 0.10 | [0.17, 0.56] | -3.82 | &lt; .001
rain [wet]  | 0.14 | 0.06 | [0.06, 0.31] | -4.73 | &lt; .001
pop [far]   | 2.59 | 0.67 | [1.56, 4.31] |  3.67 | &lt; .001

# Zero-Inflation

Parameter   | Odds Ratio |   SE |       95% CI |     z |     p
--------------------------------------------------------------
(Intercept) |       0.11 | 0.11 | [0.02, 0.74] | -2.26 | 0.024</code></pre>
</div>
</div>
<p>Nun haben wir vier Modelle geschätzt und wolen jetzt wissen, was ist das beste Modell. Dafür hilft usn dann eine Gegenüberstellung der Modelle mit der Funktion <code>modelsummary()</code>. Wir könnten die Modelle auch gegeneinander statistsich Testen, aber hier behalten wir uns einmal den beschreibenden Vergleich vor. In <a href="#tbl-model-comp-zero" class="quarto-xref">Tabelle&nbsp;<span>55.4</span></a> sehen wir einmal die vier Modelle nebeneinander gestellt. Für eine bessere Übrsicht, habe ich aus allen Modellen den Intercept entfernt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"ZeroInfl Intercept"</span> <span class="ot">=</span> lizard_zero_infl_intercept_fit,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ZeroInfl rain"</span> <span class="ot">=</span> lizard_zero_infl_rain_fit,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ZeroInfl rain+pop"</span> <span class="ot">=</span> lizard_zero_infl_rain_pop_fit,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"NegBinom intercept"</span> <span class="ot">=</span> lizard_zero_nb_intercept_fit),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"conf.int"</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"s.e. = {std.error}"</span>, </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"t = {statistic}"</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"p = {p.value}"</span>),</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_omit =</span> <span class="st">"Intercept"</span>, </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-model-comp-zero" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-comp-zero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;55.4— Modellvergleich mit den vier Modellen. Wir schauen in wie weit sich die Koeffizienten und Modelgüten für die einzelnen Modelle im direkten Vergleich zum vollen Modell verändert haben.
</figcaption>
<div aria-describedby="tbl-model-comp-zero-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_1fl3y40azkyndl7o2h42</title>
    <style>
.table td.tinytable_css_jtz354eq0il711hrhq06, .table th.tinytable_css_jtz354eq0il711hrhq06 {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_12udcqf0ckow6ncymuzp, .table th.tinytable_css_12udcqf0ckow6ncymuzp {    text-align: left; }
.table td.tinytable_css_7uzcjlz6hnztffzzd9hr, .table th.tinytable_css_7uzcjlz6hnztffzzd9hr {    text-align: center; }
.table td.tinytable_css_crbzh059dh6ibudpt9ks, .table th.tinytable_css_crbzh059dh6ibudpt9ks {    text-align: center; }
.table td.tinytable_css_0jao6fk1ob10tnv2yqqw, .table th.tinytable_css_0jao6fk1ob10tnv2yqqw {    text-align: center; }
.table td.tinytable_css_svvhmchqoxm7a4hw3wza, .table th.tinytable_css_svvhmchqoxm7a4hw3wza {    text-align: center; }
.table td.tinytable_css_1bzvlmxwihu1yhcjg1a4, .table th.tinytable_css_1bzvlmxwihu1yhcjg1a4 {    border-bottom: solid 0.05em black; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_1fl3y40azkyndl7o2h42" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">ZeroInfl Intercept</th>
                <th scope="col">ZeroInfl rain</th>
                <th scope="col">ZeroInfl rain+pop</th>
                <th scope="col">NegBinom intercept</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>count_grpcover</td>
                  <td>2.031         </td>
                  <td>1.595            </td>
                  <td>1.611                </td>
                  <td>2.031         </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>[1.245, 3.313]</td>
                  <td>[0.951, 2.675]   </td>
                  <td>[0.912, 2.845000e+00]</td>
                  <td>[1.245, 3.313]</td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>s.e. = 0.507  </td>
                  <td>s.e. = 0.421     </td>
                  <td>s.e. = 0.468         </td>
                  <td>s.e. = 0.507  </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>t = 2.839     </td>
                  <td>t = 1.771        </td>
                  <td>t = 1.642            </td>
                  <td>t = 2.839     </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>p = 0.005     </td>
                  <td>p = 0.077        </td>
                  <td>p = 0.101            </td>
                  <td>p = 0.005     </td>
                </tr>
                <tr>
                  <td>count_popfar  </td>
                  <td>2.591         </td>
                  <td>1.844            </td>
                  <td>                     </td>
                  <td>2.591         </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>[1.558, 4.310]</td>
                  <td>[1.069, 3.183]   </td>
                  <td>                     </td>
                  <td>[1.558, 4.311]</td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>s.e. = 0.673  </td>
                  <td>s.e. = 0.513     </td>
                  <td>                     </td>
                  <td>s.e. = 0.673  </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>t = 3.667     </td>
                  <td>t = 2.199        </td>
                  <td>                     </td>
                  <td>t = 3.667     </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>p = &lt;0.001    </td>
                  <td>p = 0.028        </td>
                  <td>                     </td>
                  <td>p = &lt;0.001    </td>
                </tr>
                <tr>
                  <td>count_raindry </td>
                  <td>0.308         </td>
                  <td>                 </td>
                  <td>                     </td>
                  <td>0.308         </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>[0.168, 0.564]</td>
                  <td>                 </td>
                  <td>                     </td>
                  <td>[0.168, 0.564]</td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>s.e. = 0.095  </td>
                  <td>                 </td>
                  <td>                     </td>
                  <td>s.e. = 0.095  </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>t = -3.816    </td>
                  <td>                 </td>
                  <td>                     </td>
                  <td>t = -3.816    </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>p = &lt;0.001    </td>
                  <td>                 </td>
                  <td>                     </td>
                  <td>p = &lt;0.001    </td>
                </tr>
                <tr>
                  <td>count_rainwet </td>
                  <td>0.135         </td>
                  <td>                 </td>
                  <td>                     </td>
                  <td>0.135         </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>[0.059, 0.310]</td>
                  <td>                 </td>
                  <td>                     </td>
                  <td>[0.059, 0.310]</td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>s.e. = 0.057  </td>
                  <td>                 </td>
                  <td>                     </td>
                  <td>s.e. = 0.057  </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>t = -4.726    </td>
                  <td>                 </td>
                  <td>                     </td>
                  <td>t = -4.726    </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>p = &lt;0.001    </td>
                  <td>                 </td>
                  <td>                     </td>
                  <td>p = &lt;0.001    </td>
                </tr>
                <tr>
                  <td>zero_raindry  </td>
                  <td>              </td>
                  <td>27.933           </td>
                  <td>98.197               </td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>              </td>
                  <td>[0.444, 1758.190]</td>
                  <td>[0.000, 7.612076e+07]</td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>              </td>
                  <td>s.e. = 59.034    </td>
                  <td>s.e. = 679.419       </td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>              </td>
                  <td>t = 1.576        </td>
                  <td>t = 0.663            </td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>              </td>
                  <td>p = 0.115        </td>
                  <td>p = 0.507            </td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>zero_rainwet  </td>
                  <td>              </td>
                  <td>83.692           </td>
                  <td>402.413              </td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>              </td>
                  <td>[1.285, 5452.976]</td>
                  <td>[0.000, 4.188183e+08]</td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>              </td>
                  <td>s.e. = 178.352   </td>
                  <td>s.e. = 2844.758      </td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>              </td>
                  <td>t = 2.077        </td>
                  <td>t = 0.848            </td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>              </td>
                  <td>p = 0.038        </td>
                  <td>p = 0.396            </td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>zero_popfar   </td>
                  <td>              </td>
                  <td>                 </td>
                  <td>0.148                </td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>              </td>
                  <td>                 </td>
                  <td>[0.022, 1.000000e+00]</td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>              </td>
                  <td>                 </td>
                  <td>s.e. = 0.144         </td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>              </td>
                  <td>                 </td>
                  <td>t = -1.960           </td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>              </td>
                  <td>              </td>
                  <td>                 </td>
                  <td>p = 0.050            </td>
                  <td>              </td>
                </tr>
                <tr>
                  <td>Num.Obs.      </td>
                  <td>60            </td>
                  <td>60               </td>
                  <td>60                   </td>
                  <td>60            </td>
                </tr>
                <tr>
                  <td>R2            </td>
                  <td>0.620         </td>
                  <td>0.477            </td>
                  <td>0.454                </td>
                  <td>0.620         </td>
                </tr>
                <tr>
                  <td>R2 Adj.       </td>
                  <td>0.585         </td>
                  <td>0.449            </td>
                  <td>0.435                </td>
                  <td>0.585         </td>
                </tr>
                <tr>
                  <td>AIC           </td>
                  <td>157.3         </td>
                  <td>167.2            </td>
                  <td>167.4                </td>
                  <td>159.3         </td>
                </tr>
                <tr>
                  <td>BIC           </td>
                  <td>169.8         </td>
                  <td>179.8            </td>
                  <td>180.0                </td>
                  <td>173.9         </td>
                </tr>
                <tr>
                  <td>RMSE          </td>
                  <td>1.27          </td>
                  <td>1.27             </td>
                  <td>1.32                 </td>
                  <td>1.27          </td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_6glt7inmd6qydov5vs39(i, j, css_id) {
        var table = document.getElementById("tinytable_1fl3y40azkyndl7o2h42");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_1fl3y40azkyndl7o2h42');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_6glt7inmd6qydov5vs39(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_1fl3y40azkyndl7o2h42");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(0, 0, 'tinytable_css_jtz354eq0il711hrhq06') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(0, 1, 'tinytable_css_jtz354eq0il711hrhq06') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(0, 2, 'tinytable_css_jtz354eq0il711hrhq06') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(0, 3, 'tinytable_css_jtz354eq0il711hrhq06') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(0, 4, 'tinytable_css_jtz354eq0il711hrhq06') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(0, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(1, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(2, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(3, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(4, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(5, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(6, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(7, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(8, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(9, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(10, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(11, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(12, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(13, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(14, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(15, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(16, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(17, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(18, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(19, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(20, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(21, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(22, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(23, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(24, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(25, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(26, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(27, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(28, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(29, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(30, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(31, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(32, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(33, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(34, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(35, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(36, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(37, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(38, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(39, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(40, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(41, 0, 'tinytable_css_12udcqf0ckow6ncymuzp') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(0, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(1, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(2, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(3, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(4, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(5, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(6, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(7, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(8, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(9, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(10, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(11, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(12, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(13, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(14, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(15, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(16, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(17, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(18, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(19, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(20, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(21, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(22, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(23, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(24, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(25, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(26, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(27, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(28, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(29, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(30, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(31, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(32, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(33, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(34, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(35, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(36, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(37, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(38, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(39, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(40, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(41, 1, 'tinytable_css_7uzcjlz6hnztffzzd9hr') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(0, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(1, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(2, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(3, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(4, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(5, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(6, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(7, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(8, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(9, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(10, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(11, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(12, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(13, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(14, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(15, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(16, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(17, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(18, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(19, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(20, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(21, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(22, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(23, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(24, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(25, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(26, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(27, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(28, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(29, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(30, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(31, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(32, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(33, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(34, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(35, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(36, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(37, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(38, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(39, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(40, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(41, 2, 'tinytable_css_crbzh059dh6ibudpt9ks') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(0, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(1, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(2, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(3, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(4, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(5, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(6, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(7, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(8, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(9, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(10, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(11, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(12, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(13, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(14, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(15, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(16, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(17, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(18, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(19, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(20, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(21, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(22, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(23, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(24, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(25, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(26, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(27, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(28, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(29, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(30, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(31, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(32, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(33, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(34, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(35, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(36, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(37, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(38, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(39, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(40, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(41, 3, 'tinytable_css_0jao6fk1ob10tnv2yqqw') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(0, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(1, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(2, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(3, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(4, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(5, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(6, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(7, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(8, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(9, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(10, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(11, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(12, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(13, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(14, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(15, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(16, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(17, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(18, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(19, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(20, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(21, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(22, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(23, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(24, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(25, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(26, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(27, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(28, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(29, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(30, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(31, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(32, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(33, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(34, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(35, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(36, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(37, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(38, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(39, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(40, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(41, 4, 'tinytable_css_svvhmchqoxm7a4hw3wza') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(35, 0, 'tinytable_css_1bzvlmxwihu1yhcjg1a4') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(35, 1, 'tinytable_css_1bzvlmxwihu1yhcjg1a4') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(35, 2, 'tinytable_css_1bzvlmxwihu1yhcjg1a4') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(35, 3, 'tinytable_css_1bzvlmxwihu1yhcjg1a4') })
window.addEventListener('load', function () { styleCell_tinytable_6glt7inmd6qydov5vs39(35, 4, 'tinytable_css_1bzvlmxwihu1yhcjg1a4') })
    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Die beiden Intercept Modelle haben die kleinsten <span class="math inline">\(AIC\)</span>-Werte der vier Modelle. Darüber hinaus haben dann beide Modelle auch die höchsten <span class="math inline">\(R^2_{adj}\)</span> Werte. Beide Modelle erklären also im Verhältnis viel Varianz mit 58.5%. Auch ist der <span class="math inline">\(RMSE\)</span> Wert als Fehler bei beiden Modellen am kleinsten. Damit haben wir die Qual der Wahl, welches Modell wir nehmen. Ich würde das negative binominal Modell nehmen. Wir haben ins unseren Daten vermutlich eine Zeroinflation sowie eine Overdispersion vorliegen. Daher bietest es sich an, beides in einer negativen binominalen Regression zu berücksichtigen. Zwar sind die beiden Intercept Modelle in diesem Beispielfall von den Koeffizienten fast numerisch gleich, aber das hat eher mit dem reduzierten Beispiel zu tun, als mit dem eigentlichen Modell. In unserem Fall ist die Overdispersion nicht so extrem.</p>
<p>Wie sehe den unser negative binominal Modell aus, wenn wir mit dem Modell einmal die zu erwartenden Eidechsen vorhersagen würden? Auch das kann helfen um abzuschätzen, ob das Modelle einigermaßen funktioniert hat. Wir haben ja hier den Vorteil, dass wir nur mit kategorialen Daten arbeiten. Wir haben keine kontiniuerlichen Variablen vorliegen und darüber hinaus auch nicht so viele Variablen insgesamt.</p>
<p>Daher bauen wir uns mit <code>expand_grid()</code> erstmal einen Datensatz, der nur aus den Faktorkombinationen besteht. Wir haben also nur eine Beobachtung je Faktorkombination. Danach nutzen wir die Daten einmal in der Funktion <code>predict()</code> um uns die vorhergesagten Eidechsen nach dem gefitten Modell wiedergeben zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>newdata_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">grp =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"open"</span>, <span class="st">"cover"</span>)),</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rain =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"no"</span>, <span class="st">"dry"</span>, <span class="st">"wet"</span>)),</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pop =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"near"</span>, <span class="st">"far"</span>)))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>pred_lizards <span class="ot">&lt;-</span> <span class="fu">predict</span>(lizard_zero_nb_intercept_fit, <span class="at">newdata =</span> newdata_tbl) </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>newdata_tbl <span class="ot">&lt;-</span> newdata_tbl <span class="sc">|&gt;</span> </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lizard =</span> pred_lizards)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Nachdem wir in dem Datensatz <code>newdata_tbl</code> nun die vorhergesagten Eidechsen haben, können wir uns jetzt in der <a href="#fig-pred-lizard" class="quarto-xref">Abbildung&nbsp;<span>55.7</span></a> die Zusammenhänge nochmal anschauen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(newdata_tbl, <span class="fu">aes</span>(<span class="at">x =</span> rain, <span class="at">y =</span> lizard, <span class="at">colour =</span> grp, <span class="at">group =</span> grp)) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> pop) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Feuchtigkeit nach Regen"</span>, <span class="at">y =</span> <span class="st">"Anzahl der gezählten Eidechsen"</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Gruppe"</span>) <span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-pred-lizard" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pred-lizard-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-poisson_files/figure-html/fig-pred-lizard-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Abbildung&nbsp;55.7— Scatterplot der vorhergesagten Eidechsen in den Habitaten (grp), der Feuchtigkeit des Bodens nach Regen und dem Abstand zur nächsten Ortschaft."><img src="stat-modeling-poisson_files/figure-html/fig-pred-lizard-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pred-lizard-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;55.7— Scatterplot der vorhergesagten Eidechsen in den Habitaten (<code>grp</code>), der Feuchtigkeit des Bodens nach Regen und dem Abstand zur nächsten Ortschaft.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir erkennen, dass mit der Erhöhung der Feuchtigkeit die Anzahl an aufgefundenen Eidechsen sinkt. Der Effekt ist nicht mehr so stark, wenn es schon einmal geregnet hat. Ebenso macht es einen Unterschied, ob wir nahe einer Siedlung sind oder nicht. Grundsätzlich finden wir immer mehr Eidechsen in geschützten Habitaten als in offenen Habitaten.</p>
</section>
<section id="sec-mult-comp-pois-reg" class="level2" data-number="55.7">
<h2 data-number="55.7" class="anchored" data-anchor-id="sec-mult-comp-pois-reg"><span class="header-section-number">55.7</span> Gruppenvergleich</h2>
<p>Häufig ist es ja so, dass wir das Modell für die Poisson Regression nur schätzen um dann einen Gruppenvergleich zu rechnen. Das heißt, dass es uns interessiert, ob es einen Unterschied zwischen den Leveln eines Faktors gegeben dem Outcome <span class="math inline">\(y\)</span> gibt. Da wir hier in unserem Beispiel zu den Flusshechten keine Gruppe drin haben, zeige ich dir das Prinzip einmal an einem ausgedachten Datensatz. Wir nehmen hier einen Datensatz zu Katzen-, Hunde- und Fuchsflöhen. Dabei erstellen wir uns einen Datensatz mit mittleren Anzahlen an Flöhen pro Tierart. Ich habe jetzt eine mittlere Flohanzahl von <span class="math inline">\(10\)</span> Flöhen bei den Katzen, eine mittlere Anzahl von <span class="math inline">\(30\)</span> Flöhen bei den Hunden und eine mittlere Anzahl von <span class="math inline">\(10\)</span> Flöhen bei den Füchsen gewählt. Wir generieren uns jeweils <span class="math inline">\(20\)</span> Beobachtungen je Tierart. Damit haben wir dann einen Datensatz zusammen, den wir nutzen können um einmal die Ergebnisse eines Gruppenvergleiches mit Zähldaten zu verstehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231202</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>n_rep <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>flea_count_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">animal =</span> <span class="fu">gl</span>(<span class="dv">3</span>, n_rep, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"fox"</span>)),</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">count =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(n_rep, <span class="dv">20</span>, <span class="dv">1</span>), </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">rnorm</span>(n_rep, <span class="dv">30</span>, <span class="dv">1</span>), </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">rnorm</span>(n_rep, <span class="dv">10</span>, <span class="dv">1</span>))))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wenn du gerade hierher gesprungen bist, nochmal das simple Modell für unseren Gruppenvergleich unter einer Poisson Regression. Wir haben hier nur einen Faktor <code>animal</code> mit in dem Modell. Am Ende des Abschnitts findest du dann noch ein Beispiel mit zwei Faktoren zu Thripsen auf Apfelbäumen. Wir modellieren hier eigentlich nicht die Zähldaten an sich, sondern die Raten. Du wirst das aber gleich bei der Ausgabe von <code>emmeans()</code> sehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>pois_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> animal, <span class="at">data =</span> flea_count_tbl, <span class="at">family =</span> <span class="st">"poisson"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Eigentlich ist es recht einfach, wie wir anfangen. Wir rechnen jetzt als erstes die ANOVA. Hier müssen wir dann einmal den Test angeben, der gerechnet werden soll um die p-Werte zu erhalten. Dann nutze ich noch die Funktion <code>model_parameters()</code> um eine schönere Ausgabe zu erhalten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>pois_fit <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>(<span class="at">test =</span> <span class="st">"Chisq"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">drop =</span> <span class="st">"NULL"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter | df | Deviance | df (error) | Deviance (error) |      p
------------------------------------------------------------------
animal    |  2 |   205.42 |         57 |             3.20 | &lt; .001

Anova Table (Type 1 tests)</code></pre>
</div>
</div>
<p>Im Folgenden nutzen wir das R Paket <code>{emmeans}</code> wie folgt. Wenn wir die mittleren Anzahlen benötigen, dann müssen wir die Option <code>type = "response"</code> verwenden. Sonst würdest du Werte auf der Link-Skala wiederbekommen, die dir hier nicht helfen. Ich nutze später die <code>emmeans</code> Ausgabe um ein Säulendiagramm mit den mittleren Anzahlen zu erstellen. Wir du gleich sehen wirst, werden wir aber nicht die Anzahlen vergleichen sondern die <em>Raten</em> in den jeweiligen Gruppen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> pois_fit <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>emm_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal rate    SE  df asymp.LCL asymp.UCL
 cat    20.1 1.002 Inf     18.23      22.2
 dog    30.1 1.227 Inf     27.79      32.6
 fox    10.2 0.714 Inf      8.89      11.7

Confidence level used: 0.95 
Intervals are back-transformed from the log scale </code></pre>
</div>
</div>
<p>Jetzt steht hier zwar <code>rate</code> aber was ist das denn nun? Dafür berechnen wir mal die Mittelwerte der Anzahlen für die drei Tierarten über die Funktion <code>summarise()</code>. Dann vergleichen wir einmal die Ausgaben und schauen, was wir in <code>emmeans()</code> berechnet haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>flea_count_tbl <span class="sc">|&gt;</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">|&gt;</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_count =</span> <span class="fu">mean</span>(count))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  animal mean_count
  &lt;fct&gt;       &lt;dbl&gt;
1 cat          20.1
2 dog          30.1
3 fox          10.2</code></pre>
</div>
</div>
<p>Wunderbar, es sind die Mittelwerte der Anzahlen, die in der Spalte <code>rate</code> in der Ausgabe von <code>emmeans()</code> stehen. Damit können wir dann arbeiten und die Ausgabe nutzen um ein Säulendigramm zu erstellen. Bitte schaue für die Umsetzung in das Beispiel am Ende des Abschnitts. Da zeige ich dir dann wie du ein Säulendigramm zu den Anzahlen von Thripsen auf Apfelbäumen erstellst.</p>
<p>Wenn du die mittleren Anzahlen pro Tierart jetzt für jede Tierart testen willst, dann erhälst du aber keinen Mittelwertsunterschied der Anzahlen, sondern eine <em>Rate</em>. Rechnen wir aber erstmal den paarweisen Vergleich und schauen uns dann an, was wir erhalten haben. Wir kriegen am Ende wiederum einen Vergleich von Wahrscheinlichkeiten, aber eben hier von <em>Raten</em>. Wie immer, es kommt darauf an, was du willst. Hier einmal die paarweisen Vergleiche, darunter dann gleich das <em>compact letter display</em>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast  ratio    SE  df null z.ratio p.value
 cat / dog 0.668 0.043 Inf    1  -6.269  &lt;.0001
 cat / fox 1.971 0.169 Inf    1   7.891  &lt;.0001
 dog / fox 2.951 0.239 Inf    1  13.358  &lt;.0001

P value adjustment: bonferroni method for 3 tests 
Tests are performed on the log scale </code></pre>
</div>
</div>
<p>Okay, jetzt haben wir statt Raten also eine <em>Ratio</em>, also ein Verhältnis von Raten. Das schauen wir uns doch gleich mal in dem Beispiel an. Wir rechnen also einmal die mittlere Anzahl für jede Tierart durch die entsprechende andere mittlere Anzahl der anderen Tierart. Wir erhalten also folgende <em>Ratios</em> der mittleren Anzahlen.</p>
<p><span class="math display">\[
\cfrac{cat}{dog} = \cfrac{20.1}{30.1} = 0.67
\]</span></p>
<p><span class="math display">\[
\cfrac{cat}{fox} = \cfrac{20.1}{10.2} = 1.97
\]</span></p>
<p><span class="math display">\[
\cfrac{dog}{fox} = \cfrac{30.1}{10.2} = 2.95
\]</span></p>
<p>Wie interpretieren wir jetzt die <em>Ratios</em>? Eigentlich ist das intuitiver als man auf den ersten Blick denkt. Wir haben zum Beispiel fast doppelt so viele Flöhe bei Katzen wie bei Füchsen. Die Anzahl von Hundeflöhen ist fast dreimal so hoch wie die Anzahl an Fuchsflöhen. Wir haben fast nur halb so viele Flöhe auf Katzen gefunden als bei den Hunden. Damit können wir dann schon arbeiten und eine Aussage treffen.</p>
<p>Und fast am Ende können wir uns auch das <em>compact letter display</em> erstellen. Auch hier nutzen wir wieder die Funktion <code>cld()</code> aus dem R Paket <code>{multcomp}</code>. Hier erhälst du dann die Information über die mittlere Anzahl der jeweiligen Tierarten und ob sich die mittlere Anzahl unterscheidet. Ich nutze dann die Ausgabe von <code>emmeans()</code> um mir dann direkt das Säulendiagramm mit den Fehlerbalken und dem <em>compact letter display</em> zu erstellen. Mehr dazu dann im Kasten weiter unten zu dem Beispiel zu Thripsenanzahl auf Apfelbäumen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal rate    SE  df asymp.LCL asymp.UCL .group
 fox    10.2 0.714 Inf      8.89      11.7  a    
 cat    20.1 1.002 Inf     18.23      22.2   b   
 dog    30.1 1.227 Inf     27.79      32.6    c  

Confidence level used: 0.95 
Intervals are back-transformed from the log scale 
Tests are performed on the log scale 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Auch hier sehen wir, dass sich alle drei Gruppen signifikant unterschieden, keine der Tierarten teilt sich einen Buchstaben, so dass wir hier von einem Unterschied zwischen den mittleren Anzahlen an Flöhen auf den drei Tierarten ausgehen können.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Offset in einer Poisson Regression
</div>
</div>
<div class="callout-body-container callout-body">
<p>Bei einem geplanten Experiment zählen wir meist in festgelegten Zeiteinheiten oder aber unser <span class="math inline">\(n\)</span> ist vorgeben. Jetzt kann es aber sein, dass wir nicht mit festen Zeitintervallen oder aber einer Fallzahl zählen. Beispielsweise können wir die Anzahl der Baumarten in einem Wald zählen: Ereignisse (eng. <em>event</em>) wären Baumbeobachtungen, die Exposition (eng. <em>exposure</em>) wäre eine Flächeneinheit und die Rate wäre die Anzahl der Arten pro Flächeneinheit. Wir können die Sterberaten in geografischen Gebieten als die Anzahl der Todesfälle geteilt durch die Personenjahre modellieren. Allgemeiner ausgedrückt können Ereignisraten als Ereignisse pro Zeiteinheit berechnet werden, wobei das Beobachtungsfenster für jede Einheit variieren kann. In diesen Beispielen ist die Exposition jeweils eine Einheit Fläche, Personenjahre und Zeiteinheit. So sollten beispielsweise sechs Fälle innerhalb eines Jahres nicht den gleichen Wert haben wie sechs Fälle innerhalb von 10 Jahren. In der Poisson-Regression wird dies als <em>Offset</em> behandelt. Mehr dazu dann gerne im Wikipediartikel zu <a href="https://en.wikipedia.org/wiki/Poisson_regression#.22Exposure.22_and_offset">“Exposure” and offset</a> oder aber die Antwort <a href="https://stats.stackexchange.com/questions/11182/when-to-use-an-offset-in-a-poisson-regression">When to use an offset in a Poisson regression?</a>.</p>
<p>In <code>{emmeans}</code> können wir <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/sophisticated.html#offsets">Modelle mit Offset</a> relativ einfach modellieren. Dazu nutzen wir die Funktion <code>offset()</code> in unserem <code>glm()</code> Modell. Aber zuerst einmal ein Spieldatensatz. Wir haben wir unseren Faktor Tierart und dann aber noch das Alter als Faktor mit zwei Stufen. Wir haben jetzt aber nicht immer die gleiche Anzahl an Hunden und Katzen sowie Füchsen ausgezählt. Unsere Anzahl an Flöhen basiert also auf einer anderen <span class="math inline">\(n\)</span> Anzahl. Die Anzahl <span class="math inline">\(n\)</span> modellieren wir dann als <code>offset()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>toy_count_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">n =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1200</span>, <span class="dv">100</span>, <span class="dv">400</span>, <span class="dv">500</span>, <span class="dv">300</span>),</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">animal =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"cat"</span>,<span class="st">"dog"</span>,<span class="st">"fox"</span>)),</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">age =</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">count =</span> <span class="fu">c</span>(<span class="dv">42</span>, <span class="dv">37</span>, <span class="dv">1</span>, <span class="dv">101</span>, <span class="dv">73</span>, <span class="dv">14</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir nehmen die Anzahl an ausgezählten Tieren dann als Offset mit Logarithmus in das Modell. Deshalb steht dann da auch <code>log(n)</code> im Offset.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>toy_count_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> animal <span class="sc">+</span> age <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(n)), </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> toy_count_tbl, <span class="at">family =</span> <span class="st">"poisson"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns einmal das Modell anschauen, wie <code>{emmeans}</code> den Vergleich rechnen würde.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ref_grid</span>(toy_count_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'emmGrid' object with variables:
    animal = cat, dog, fox
    age = 1, 2
    n = 500
Transformation: "log" </code></pre>
</div>
</div>
<p>Der Offset ist also grob <span class="math inline">\(log(500) \approx 5.97\)</span>. Das stimmt numerisch nicht hundertprozentig, hat aber noch mit einer internen Korrektur zu tun, die uns hier aber nicht weiter interessiert. Das Modell können wir dann wie gewohnt in <code>emmeans()</code> stecken und dann weiter rechnen. In dem Modell wird dann berücksichtigt, dass sich die Anzahlen für das <em>Exposure</em>, also dem Nenner der Raten, unterscheiden.</p>
</div>
</div>
<p>Damit sind wir einmal mit unserem Gruppenvergleich für die Poisson Regression auf Zähldaten durch. In dem Kapitel zu den <a href="stat-tests-posthoc2.html">Multiple Vergleichen oder Post-hoc Tests</a> findest du dann noch mehr Inspirationen für die Nutzung von <code>{emmeans}</code>. Hier war es dann die Anwendung auf Zähldaten zusammen mit einem Faktor. Wenn du dir das Ganze nochmal an einem Beispiel für zwei Faktoren anschauen möchtest, dann findest du im folgenden Kasten ein Beispiel für die Auswertung von Thripsen auf Apfelbäumen nach Gabe verschiedener Dosen eines Insektizids und Zeitpunkten.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Anwendungsbeispiel: Zweifaktorieller Gruppenvergleich für Thripsenbefall
</div>
</div>
<div class="callout-body-container callout-body">
<p>Im folgenden Beispiel schauen wir uns nochmal ein praktische Auswertung von einem agrarwissenschaftlichen Beispiel mit jungen Apfelbäumen an. Wir haben uns in diesem Experiment verschiedene Dosen <code>trt</code> von einem Insektizid aufgebracht sowie verschiedene Startanzahlen von Raubmilben als biologische Alternative untersucht. Dann haben wir noch fünf Zeitpunkte bestimmt, an denen wir die Anzahl an Thripsen auf den Blättern gezählt haben. Wir haben nicht die Blätter per se gezählt sondern Fallen waagerecht aufgestellt. Dann haben wir geschaut, wie viele Thripsen wir über <code>above</code> und unter <code>below</code> von den Fallen gefunden haben. In unserem Fall beschränken wir uns auf die obere Anzahl an Thripsen und schauen uns auch nur die Behandlung mit dem Insektizid an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>insects_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/insects_count.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timepoint =</span> <span class="fu">factor</span>(timepoint, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1 Tag"</span>, <span class="st">"4 Tag"</span>, <span class="st">"7 Tag"</span>, <span class="st">"11 Tag"</span>, <span class="st">"14 Tag"</span>)),</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">rep =</span> <span class="fu">as_factor</span>(rep),</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt =</span> <span class="fu">as_factor</span>(trt)) <span class="sc">|&gt;</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(timepoint, trt, <span class="at">thripse =</span> thripse_above) <span class="sc">|&gt;</span> </span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"10ml"</span>, <span class="st">"30ml"</span>, <span class="st">"60ml"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir auch schon die Poisson Regression mit <code>glm()</code> rechnen. Auch hier wieder darauf achten, dass wir dann als Option <code>family = poisson</code> oder <code>family = quasipoisson</code> wählen. Es hängt jetzt davon ab, ob du in deinen Daten Overdispersion vorliegen hast oder nicht. In den beiden folgenden Tabs, rechne ich dann mal beide Modelle.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page"><code>family = poisson</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><code>family = quasipoisson</code></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Als Erstes rechnen wir eine normale Poisson Regression und schauen einmal, ob wir Overdispersion vorliegen haben. Wenn wir Overdispersion vorliegen haben, dann können wir keine Poisson Regression rechnen, sondern müssen auf eine Quasipoisson Regression ausweichen. Das ist aber sehr einfach, wie du im anderen Tab sehen wirst.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>insects_poisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(thripse <span class="sc">~</span> trt <span class="sc">+</span> timepoint <span class="sc">+</span> trt<span class="sc">:</span>timepoint, </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> insects_tbl, </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">family =</span> poisson) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Bevor wir uns das Modell mit <code>summary()</code> überhaupt anschauen, wollen wir erstmal überprüfen, ob wir überhaupt Overdispersion vorliegen haben. Wenn ja, dann können wir uns die <code>summary()</code> hier gleich sparen. Also einmal geguckt, was die Overdispersion macht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>insects_poisson_fit <span class="sc">|&gt;</span> <span class="fu">check_overdispersion</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

       dispersion ratio =   23.498
  Pearson's Chi-Squared = 3172.179
                p-value =  &lt; 0.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Overdispersion detected.</code></pre>
</div>
</div>
<p>Wir haben sehr starke Overdispersion vorliegen und gehen daher rüber in den anderen Tab und rechnen eine Quasipoisson Regression. Nur wenn du keine Overdispersion vorliegen hast, dann kannst du eine eine Poisson Regression rechnen.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Entweder hast du in deinen Daten eine Overdispersion gefunden oder aber du meinst, es wäre besser gleich eine Quasipoisson zu rechnen. Beides ist vollkommen in Ordnung. Ich rechne meistens immer eine Quasipoisson und schaue dann nur, ob die Overdispersion sehr groß war. In den seltensten Fällen hast du eine Overdispersion vorliegen, die eher klein ist. Daher mache ich erst die Lösung und schaue, ob das Problem dann da war.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(thripse <span class="sc">~</span> trt <span class="sc">+</span> timepoint <span class="sc">+</span> trt<span class="sc">:</span>timepoint, </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">data =</span> insects_tbl, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">family =</span> quasipoisson) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Du kannst in der <code>summary()</code> Ausgabe direkt sehen, ob du Overdispersion vorliegen hast. Du musst nur relativ weit unten schauen, was zu dem <code>Dispersion parameter</code> in den Klammern geschrieben ist. Wenn da eine Zahl größer als 1 drin steht, dann hast du Overdispersion.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = thripse ~ trt + timepoint + trt:timepoint, family = quasipoisson, 
    data = insects_tbl)

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              3.861686   0.211964  18.219   &lt;2e-16 ***
trt30ml                 -0.565849   0.376336  -1.504   0.1350    
trt60ml                 -1.058326   0.432830  -2.445   0.0158 *  
timepoint4 Tag          -0.448440   0.339528  -1.321   0.1888    
timepoint7 Tag          -0.001914   0.299907  -0.006   0.9949    
timepoint11 Tag         -0.121854   0.309323  -0.394   0.6942    
timepoint14 Tag         -0.177363   0.313970  -0.565   0.5731    
trt30ml:timepoint4 Tag   0.476840   0.553141   0.862   0.3902    
trt60ml:timepoint4 Tag  -0.579968   0.809916  -0.716   0.4752    
trt30ml:timepoint7 Tag   0.154299   0.519303   0.297   0.7668    
trt60ml:timepoint7 Tag   0.252555   0.585830   0.431   0.6671    
trt30ml:timepoint11 Tag  0.121854   0.537661   0.227   0.8210    
trt60ml:timepoint11 Tag  0.091083   0.620448   0.147   0.8835    
trt30ml:timepoint14 Tag -0.162407   0.575416  -0.282   0.7782    
trt60ml:timepoint14 Tag -0.201195   0.670025  -0.300   0.7644    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for quasipoisson family taken to be 23.49807)

    Null deviance: 4263.4  on 149  degrees of freedom
Residual deviance: 3345.0  on 135  degrees of freedom
AIC: NA

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p>Wir haben hier auf jeden Fall Overdispersion vorliegen. Daher nutze ich dann auch das Modell hier mit der Annahme an eine Quasipoissonverteilung. Dann stimmt es auch mit unseren Varianzen und wir produzieren nicht zufällig zu viele signifikante Ergebnisse, die es dann gar nicht gibt.</p>
</div>
</div>
</div>
<p>Ich habe mich gerade in den obigen Tabs für eine Quasipoisson Regression entschieden, da wir Overdispersion vorliegen haben. Damit mache ich dann mit dem <code>insects_quasipoisson_fit</code> Modell weiter. In den beiden folgenden Tabs findest du dann einmal das Ergebnis für die ANOVA und einmal für den Gruppenvergleich mit dem R Paket <code>{emmeans}</code>. Bitte beachte, dass die ANOVA für ein <code>glm()</code>-Objekt nicht ganz gleich wie für ein <code>lm()</code>-Objekt ist. Du kannst aber die ANOVA erstmal ganz normal interpretieren, nur haben wir hier nicht die Möglichkeit ein <span class="math inline">\(\eta^2\)</span> zu bestimmen. Dann nutzen wir <code>{emmeans}</code> für den Gruppenvergleich. Nochmal, weil wir Overdispersion festgestellt haben, nutzen wir das Objekt <code>insects_quasipoisson_fit</code> mit der Berücksichtigung der Overdispersion.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">ANOVA mit <code>anova()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Gruppenvergleich mit <code>emmeans()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Wir rechnen hier einmal die ANOVA und nutzen den <span class="math inline">\(\mathcal{X}^2\)</span>-Test für die Ermittelung der p-Werte. Wir müssen hier einen Test auswählen, da per Standardeinstellung kein Test gerechnet wird. Wir machen dann die Ausageb nochmal schöner und fertig sind wir.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>(<span class="at">test =</span> <span class="st">"Chisq"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">drop =</span> <span class="st">"NULL"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter     | df | Deviance | df (error) | Deviance (error) |      p
----------------------------------------------------------------------
trt           |  2 |   730.20 |        147 |          3533.22 | &lt; .001
timepoint     |  4 |   112.27 |        143 |          3420.95 | 0.311 
trt:timepoint |  8 |    75.93 |        135 |          3345.03 | 0.919 

Anova Table (Type 1 tests)</code></pre>
</div>
</div>
<p>Wir sehen, dass der Effekt für die Behandlung signifikant ist, jedoch die Zeit und die Interaktion keinen signifikanten Einfluss haben. Wir haben aber also keine Interaktion vorliegen. Daher können wir dann die Analyse gemeinsam über alle Zeitpunkte rechnen.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Im Folgenden rechnen wir einmal über alle Faktorkombinationen von <code>trt</code> und <code>timepoint</code> einen Gruppenvergleich. Dafür nutzen wir die Opition <code>trt * timepoint</code>. Wenn du die Analyse <em>getrennt</em> für die Zeitpunkte durchführen willst, dann nutze die Option <code>trt | timepoint</code>. Wir wollen die Wahrscheinlichkeiten für das Auftreten einer Beschädigung von wiedergegeben bekommen, deshalb die Option <code>regrid = "response</code>. Dann adjustieren wir noch nach Bonferroni und sind fertig.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> insects_quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt <span class="sc">*</span> timepoint, <span class="at">regrid =</span> <span class="st">"response"</span>) <span class="sc">|&gt;</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>emm_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> trt  timepoint rate    SE  df asymp.LCL asymp.UCL .group
 60ml 4 Tag      5.9  3.72 Inf    -5.029      16.8  a    
 60ml 14 Tag    11.3  5.15 Inf    -3.825      26.4  ab   
 60ml 11 Tag    16.0  6.13 Inf    -1.998      34.0  ab   
 60ml 1 Tag     16.5  6.23 Inf    -1.777      34.8  ab   
 30ml 14 Tag    19.2  7.08 Inf    -1.572      40.0  ab   
 60ml 7 Tag     21.2  7.06 Inf     0.483      41.9  ab   
 30ml 1 Tag     27.0  8.40 Inf     2.356      51.6  ab   
 30ml 11 Tag    27.0  8.40 Inf     2.356      51.6  ab   
 30ml 4 Tag     27.8  8.52 Inf     2.782      52.8  ab   
 10ml 4 Tag     30.4  8.05 Inf     6.725      54.0  ab   
 30ml 7 Tag     31.4  9.06 Inf     4.849      58.0  ab   
 10ml 14 Tag    39.8  9.22 Inf    12.748      66.9  ab   
 10ml 11 Tag    42.1  9.48 Inf    14.258      69.9   b   
 10ml 7 Tag     47.5 10.07 Inf    17.902      77.0   b   
 10ml 1 Tag     47.5 10.08 Inf    17.965      77.1   b   

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 15 estimates 
P value adjustment: bonferroni method for 105 tests 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Das <code>emm_obj</code> Objekt werden wir dann gleich einmal in <code>{ggplot}</code> visualisieren. Die <code>rate</code> stellt die mittlere Anzahl an Thripsen je Faktorkombination dar. Dann können wir auch das <em>compact letter display</em> anhand der Abbildung interpretieren.</p>
</div>
</div>
</div>
<p>In der <a href="stat-modeling-mixed.html#fig-log-mod-pois-insect" class="quarto-xref">Abbildung&nbsp;<span>60.20</span></a> siehst du das Ergebnis der Auswertung in einem Säulendiagramm. Hier unbedingt <code>SE</code> als den Standardfehler für die Fehlerbalken nutzen, da wir sonst Fehlerbalken größer und kleiner als <span class="math inline">\(0\)</span> erhalten, wenn wir die Standardabweichung nutzen würden. Das ist in unserem Fall nicht so das Problem, aber wenn du eher kleine Anzahlen zählst, kann das schnell zu Werten kleiner Null führen. Wir sehen einen klaren Effekt der Behandlung <code>60ml</code>. Die Zeit hat keinen Effekt, was ja schon aus der ANOVA klar war, die Säulen sehen für jeden Zeitpunkt vollkommen gleich aus. Gut etwas Unterschied ist ja immer.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> timepoint, <span class="at">y =</span> rate, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mittlere Anzahl an Thripsen"</span>, <span class="at">x =</span> <span class="st">"Messzeitpunkte der Zählungen"</span>,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Dosis"</span>) <span class="sc">+</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> rate <span class="sc">+</span> SE <span class="sc">+</span> <span class="fl">0.01</span>),  </span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> rate<span class="sc">-</span>SE, <span class="at">ymax =</span> rate<span class="sc">+</span>SE),</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-log-mod-pois-insect" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-mod-pois-insect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-poisson_files/figure-html/fig-log-mod-pois-insect-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Abbildung&nbsp;55.8— Säulendigramm der mitleren Zahl der Thripsen aus einer Poisson Regression. Das glm()-Modell berechnet die mittlere Anzahl in jeder Faktorkombination. Das compact letter display wird dann in {emmeans} generiert."><img src="stat-modeling-poisson_files/figure-html/fig-log-mod-pois-insect-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-mod-pois-insect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;55.8— Säulendigramm der mitleren Zahl der Thripsen aus einer Poisson Regression. Das <code>glm()</code>-Modell berechnet die mittlere Anzahl in jeder Faktorkombination. Das <em>compact letter display</em> wird dann in <code>{emmeans}</code> generiert.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-dormann2013parametrische" class="csl-entry" role="listitem">
Dormann, C. F. (2013). <em>Parametrische Statistik</em>. Springer.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-modeling-gaussian.html" class="pagination-link" aria-label="Gaussian Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-modeling-beta.html" class="pagination-link" aria-label="Beta Regression">
        <span class="nav-page-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Beta Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb83" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, patchwork)</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="in">source("images/R/stat-modeling-preface-00.R")</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="in">source("images/R/stat-modeling-preface-02.R")</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="fu"># Poisson Regression {#sec-poisson}</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-modeling-poisson.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel wollen wir eine Poisson Regression rechnen. Wir müssen uns hier wieder überlegen, was ist eigentlich unser Outcome $y$ und was sind unsere Einflussvariablen $x$. Die Poisson Regression ist je nach Hintergrund des Anwenders eher selten. In der Ökologie, wo gerne mal gezaählt wird, wie oft etwas vorkommt, ist die Poisson Regression häufig vertreten. Sonst fristet die Poisson Regresson eher ein unbekanntes Dasein.</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>Ein häufig unterschätzter Vorteil der Poisson Regression ist, dass wir auch auch $0/1$ Daten eine Poisson Regression rechnen können. Moment, wirst du jetzt vielleicht denken, das machen wir doch mit der logistischen Regression. Ja, das stimmt, aber wir können auf Zahlen viel rechnen. Wenn wir auf ein $0/1$ Outcome eine Poisson Regression rechnen, dann kriegen wir nicht Odds Ratios $OR$ als Effektschätzer sondern Risk Ratios $RR$. Wir erhalten also keine Chancen sondern Wahrscheinlichkeiten. Unter der Annahme, dass das Modell auch konvergiert und wir sinnvolle Zahlen erhalten.</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>Ein weiteres Problem sind die zu vielen Nullen in dem Outcome $y$. Daher wir zählen über die Maßen viel *Nichts*. Wir nennen diesen Fall *zero inflation* und beschreiben damit die zu vielen Nullen in den Daten. Hier muss dann noch speziell modelliert werden. Eine Poisson Regression hat schon so seine speziellen Tücken.</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>In der folgenden @fig-scatter-modeling-poisson-01 siehst du nochmal den Zusammenhang zwischen einem poissonverteilten Outcome, wie Anzahl oder Auftreten, im Bezug zu einem kontinuierlichen oder kategoriellen $x$ als Einflussgröße. Wir sind dann eher im Bereich der Posthoc-Tests mit kategoriellen $x$ als in wirklich einer Interpretation einer Poisson Regression mit einem kontinuierlichen $x$. Dennoch müssen wir wissen, ob die Poisson Regression gut funktioniert hat. Die Überprüfung der Modellierung können wir dann in diesem Kapitel einmal durchgehen.</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scatter-modeling-poisson-01</span></span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 15</span></span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visueller Zusammenhang eines kontinuierlichen Outcomes ($y$) aus einer Poissonverteilung zu Zähldaten im Verhätnis zu verschiedenen Skalen der Einflussvariable ($x$). Ein Punkt stellt eine Beobachtung dar. Deutlich sind die Ebenen durch die absoluten Zählwerte zu erkennen. **(A)** $x$ ist kontinuierlich. **(B)** $x$ ist kategoriell mit zwei oder mehr Gruppen. **(C)** $x$ ist kategoriell mit zwei Gruppen. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a>p21 <span class="sc">+</span> p22 <span class="sc">+</span> p23 <span class="sc">+</span></span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>)</span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-41"><a href="#cb83-41" aria-hidden="true" tabindex="-1"></a>Häufig wollen wir dann die Ergebnisse aus einer Poisson Regression dann im Falle eines kategoriellen $x$ dann als Barplots wie in der @fig-scatter-modeling-poisson-02 darstellen. Hier musst du dann einmal weiter unten in den Abschnitt zu den Gruppenvergleichen springen.</span>
<span id="cb83-42"><a href="#cb83-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-45"><a href="#cb83-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-46"><a href="#cb83-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb83-47"><a href="#cb83-47" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-48"><a href="#cb83-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-49"><a href="#cb83-49" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scatter-modeling-poisson-02</span></span>
<span id="cb83-50"><a href="#cb83-50" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-51"><a href="#cb83-51" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb83-52"><a href="#cb83-52" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb83-53"><a href="#cb83-53" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visueller Zusammenhang eines gemittelten Outcomes ($y$) aus einer Poissonverteilung im Verhältnis zu der Einflussvariable ($x$) mit zwei oder mehr Kategorien anhand von Barplots. Hauptsächlich unterscheiden sich die Barplots durch die unterschiedlichen Einheiten auf der $y$-Achse. Die Fehlerbalken stellen den Standardfehler (*SE*) dar. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb83-54"><a href="#cb83-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-55"><a href="#cb83-55" aria-hidden="true" tabindex="-1"></a>p02 <span class="sc">+</span></span>
<span id="cb83-56"><a href="#cb83-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb83-57"><a href="#cb83-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-58"><a href="#cb83-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-59"><a href="#cb83-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-60"><a href="#cb83-60" aria-hidden="true" tabindex="-1"></a>Im folgenden Kapitel zu der multiplen Poisson linearen Regression gehen wir davon aus, dass die Daten in der vorliegenden Form *ideal* sind. Das heißt wir haben weder fehlende Werte vorliegen, noch haben wir mögliche Ausreißer in den Daten. Auch wollen wir keine Variablen selektieren. Wir nehmen alles was wir haben mit ins Modell. Sollte eine oder mehre Bedingungen nicht zutreffen, dann schaue dir einfach die folgenden Kapitel an.</span>
<span id="cb83-61"><a href="#cb83-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-62"><a href="#cb83-62" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wenn du fehlende Werte in deinen Daten vorliegen hast, dann schaue bitte nochmal in das @sec-missing zu Imputation von fehlenden Werten.</span>
<span id="cb83-63"><a href="#cb83-63" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wenn du denkst, dass du Ausreißer oder auffälige Werte in deinen Daten hast, dann schaue doch bitte nochmal in das @sec-outlier zu Ausreißer in den Daten.</span>
<span id="cb83-64"><a href="#cb83-64" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wenn du denkst, dass du zu viele Variablen in deinem Modell hast, dann hilft dir das @sec-variable-selection bei der Variablenselektion.</span>
<span id="cb83-65"><a href="#cb83-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-66"><a href="#cb83-66" aria-hidden="true" tabindex="-1"></a>Daher sieht unser Modell wie folgt aus. Wir haben ein $y$ und $p$-mal $x$. Wobei $p$ für die Anzahl an Variablen auf der rechten Seite des Modells steht. Im Weiteren folgt unser $y$ einer Poissonverteilung. Das ist hier sehr wichtig, denn wir wollen ja eine multiple Poisson lineare Regression rechnen.</span>
<span id="cb83-67"><a href="#cb83-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-68"><a href="#cb83-68" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-69"><a href="#cb83-69" aria-hidden="true" tabindex="-1"></a>y \sim x_1 + x_2 + ... + x_p </span>
<span id="cb83-70"><a href="#cb83-70" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-71"><a href="#cb83-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-72"><a href="#cb83-72" aria-hidden="true" tabindex="-1"></a>Wir gehen jetzt einmal die lineare Regression mit einem normalverteilten Outcome $y$ einmal durch. Wie schon oben erwähnt, können wir die Poisson Regression als vorangestelltes Modell für eine ANOVA oder dann eben einen Posthoc-Test in <span class="in">`{emmeans}`</span> nutzen.</span>
<span id="cb83-73"><a href="#cb83-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-74"><a href="#cb83-74" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb83-75"><a href="#cb83-75" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Tutorien für die Poisson Regression</span></span>
<span id="cb83-76"><a href="#cb83-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-77"><a href="#cb83-77" aria-hidden="true" tabindex="-1"></a>Wie immer gibt es auch für die Frage nach dem Tutorium für die Poisson Regression verschiedene Quellen. Ich kann noch folgende Informationen und Hilfen empfehlen.</span>
<span id="cb83-78"><a href="#cb83-78" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-79"><a href="#cb83-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-80"><a href="#cb83-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb83-81"><a href="#cb83-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-82"><a href="#cb83-82" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb83-83"><a href="#cb83-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-84"><a href="#cb83-84" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb83-85"><a href="#cb83-85" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb83-86"><a href="#cb83-86" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, broom,</span></span>
<span id="cb83-87"><a href="#cb83-87" aria-hidden="true" tabindex="-1"></a><span class="in">               parameters, performance, MASS, pscl, see,</span></span>
<span id="cb83-88"><a href="#cb83-88" aria-hidden="true" tabindex="-1"></a><span class="in">               modelsummary, scales, emmeans, multcomp,</span></span>
<span id="cb83-89"><a href="#cb83-89" aria-hidden="true" tabindex="-1"></a><span class="in">               conflicted)</span></span>
<span id="cb83-90"><a href="#cb83-90" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb83-91"><a href="#cb83-91" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb83-92"><a href="#cb83-92" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb83-93"><a href="#cb83-93" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb83-94"><a href="#cb83-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-95"><a href="#cb83-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-96"><a href="#cb83-96" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb83-97"><a href="#cb83-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-98"><a href="#cb83-98" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb83-99"><a href="#cb83-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-100"><a href="#cb83-100" aria-hidden="true" tabindex="-1"></a>Im folgenden schauen wir uns ein Datenbeispiel mit Hechten an. Es handelt sich um langnasige Hechte in nordamerikanischen Flüssen. Wir haben uns insgesamt $n = 68$ Flüsse einmal angesehen und dort die Anzahl an Hechten gezählt. Im Weiteren haben wir dann noch andere Flussparameter erhoben und fragen uns nun, welche dieser Parameter einen Einfluss auf die Anzahl an Hechten in den Flussarmen haben. In @sec-example-longnose findest du nochmal mehr Informationen zu den Daten. Wir entfernen hier die Informationen zu den Flüssen, die brauchen wir in dieser Analyse nicht. Die Daten zu den langnasigen Hechten stammt von <span class="co">[</span><span class="ot">Salvatore S. Mangiafico - An R Companion for the Handbook of Biological Statistics</span><span class="co">](https://rcompanion.org/rcompanion/e_05.html)</span>. Besuche gerne mal seine Webseite, dort findest du auch andere tolle Beispiele zu statistischen Analysen.</span>
<span id="cb83-101"><a href="#cb83-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-104"><a href="#cb83-104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-105"><a href="#cb83-105" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-106"><a href="#cb83-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-107"><a href="#cb83-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-108"><a href="#cb83-108" aria-hidden="true" tabindex="-1"></a>longnose_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/longnose.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb83-109"><a href="#cb83-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>stream)</span>
<span id="cb83-110"><a href="#cb83-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-111"><a href="#cb83-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-114"><a href="#cb83-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-115"><a href="#cb83-115" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb83-116"><a href="#cb83-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-117"><a href="#cb83-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-118"><a href="#cb83-118" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-pois-longnose</span></span>
<span id="cb83-119"><a href="#cb83-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Auszug aus dem Daten zu den langnasigen Hechten.</span></span>
<span id="cb83-120"><a href="#cb83-120" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb83-121"><a href="#cb83-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-122"><a href="#cb83-122" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(longnose_tbl, <span class="at">n =</span> <span class="dv">4</span>),</span>
<span id="cb83-123"><a href="#cb83-123" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(longnose_tbl)),</span>
<span id="cb83-124"><a href="#cb83-124" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(longnose_tbl, <span class="at">n =</span> <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb83-125"><a href="#cb83-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb83-126"><a href="#cb83-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-127"><a href="#cb83-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-128"><a href="#cb83-128" aria-hidden="true" tabindex="-1"></a>Im Folgenden werden wir die Daten nur für das Fitten eines Modells verwenden. In den anderen oben genannten Kapiteln nutzen wir die Daten dann anders. In @fig-pois-model-longnose sehen wir nochmal die Verteilung der Anzahl der Hechte in den Flüssen.</span>
<span id="cb83-129"><a href="#cb83-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-132"><a href="#cb83-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-133"><a href="#cb83-133" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb83-134"><a href="#cb83-134" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-135"><a href="#cb83-135" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pois-model-longnose</span></span>
<span id="cb83-136"><a href="#cb83-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-137"><a href="#cb83-137" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb83-138"><a href="#cb83-138" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb83-139"><a href="#cb83-139" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Histogramm der Verteilung der Hechte in den beobachteten Flüssen."</span></span>
<span id="cb83-140"><a href="#cb83-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-141"><a href="#cb83-141" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(longnose_tbl, <span class="fu">aes</span>(longnose)) <span class="sc">+</span></span>
<span id="cb83-142"><a href="#cb83-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-143"><a href="#cb83-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb83-144"><a href="#cb83-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-145"><a href="#cb83-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-146"><a href="#cb83-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-147"><a href="#cb83-147" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fit des Modells</span></span>
<span id="cb83-148"><a href="#cb83-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-149"><a href="#cb83-149" aria-hidden="true" tabindex="-1"></a>In diesem Abschnitt wollen wir verschiedene Modelle für Zähldaten schätzen. Die Poissonverteilung hat keinen eignen Parameter für die Streung wie die Normalverteilung. Die Poissonverteilung ist mit $\mathcal{Pois}(\lambda)$ definiert und hat somit die Eigenschaft das die Varianz eins zu eins mit dem Mittelwert $\lambda$ der Poissonverteilung ansteigt. Es kann aber sein, dass wir in den Daten nicht diesen ein zu eins Zusammenhang von Mittelwert und Varianz vrliegen haben. Häufig ist die Varianz viel größer und steigt schneller an. Wenn die Varianz in Wirklichkeit sehr viel größer ist, dann würden wir die Varianz in unseren Modell unterschätzen.</span>
<span id="cb83-150"><a href="#cb83-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-151"><a href="#cb83-151" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ein klassisches Poissonmodell <span class="in">`glm(..., familiy = poisson)`</span> mit der Annahme keiner Overdisperison.</span>
<span id="cb83-152"><a href="#cb83-152" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ein Quasi-Poissonmodell <span class="in">`glm(..., family = quasipoisson)`</span> mit der Möglichkeit der Berücksichtigung einer Overdispersion.</span>
<span id="cb83-153"><a href="#cb83-153" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ein negative Binomialmodell <span class="in">`glm.nb(...)`</span> ebenfalls mit der Berücksichtigung einer Overdispersion.</span>
<span id="cb83-154"><a href="#cb83-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-155"><a href="#cb83-155" aria-hidden="true" tabindex="-1"></a>Beginnen wollen wir aber mit einer klassischen Poissonregression ohne die Annahme von einer Overdispersion in den Daten. Wir nutzen dafür die Funktion <span class="in">`glm()`</span> und spezifizieren die Verteilungsfamilie als <span class="in">`poisson`</span>. Wir nehmen wieder alle Variablen in das Modell auf der rechten Seite des <span class="in">`~`</span>. Auf der linken Seite des <span class="in">`~`</span> kommt dann unser Outcome <span class="in">`longnose`</span> was die Anzahl an Hechten erhält.</span>
<span id="cb83-156"><a href="#cb83-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-157"><a href="#cb83-157" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Hier gibt es nur die Kurzfassung der *link*-Funktion. @dormann2013parametrische liefert hierzu in Kapitel 7.1.3 nochmal ein Einführung in das Thema.</span><span class="co">]</span>{.aside}</span>
<span id="cb83-158"><a href="#cb83-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-159"><a href="#cb83-159" aria-hidden="true" tabindex="-1"></a>Wir müssen für die Possionregression noch beachten, dass die Zähldaten von $0$ bis $+\infty$ laufen. Damit wir normalverteilte Residuen erhalten und einen lineren Zusammenhang, werden wir das Modell auf dem $\log$-scale fitten. Das heißt, wir werden den Zusammenhang von $y$ und $x$ logarithmieren. Wichtig ist hierbei der *Zusammenhang*. Wir transformieren nicht einfach $y$ und lassen den Rest unberührt. Das führt dazu, dass wir am Ende die Koeffizienten der Poissonregression exponieren müssen. Das können die gängigen Funktionen, wir müssen das Exponieren aber aktiv durchführen. Deshalb hier schon mal erwähnt.</span>
<span id="cb83-160"><a href="#cb83-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-163"><a href="#cb83-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-164"><a href="#cb83-164" aria-hidden="true" tabindex="-1"></a>poisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(longnose <span class="sc">~</span> area <span class="sc">+</span> do2 <span class="sc">+</span> maxdepth <span class="sc">+</span> no3 <span class="sc">+</span> so4 <span class="sc">+</span> temp,</span>
<span id="cb83-165"><a href="#cb83-165" aria-hidden="true" tabindex="-1"></a>                    longnose_tbl, <span class="at">family =</span> poisson)</span>
<span id="cb83-166"><a href="#cb83-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-167"><a href="#cb83-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-168"><a href="#cb83-168" aria-hidden="true" tabindex="-1"></a>Wir schauen uns die Ausgabe des Modells einmal mit der <span class="in">`summary()`</span> Funktion an, da wir hier einmal händisch schauen wollen, ob eine Overdispersion vorliegt. Sonst könnten wir auch die Funktion <span class="in">`model_parameters()`</span> nehmen. Die nutzen wir später für die Interpretation des Modells, hier wollen wir erstmal sehen, ob alles geklappt hat.</span>
<span id="cb83-169"><a href="#cb83-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-172"><a href="#cb83-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-173"><a href="#cb83-173" aria-hidden="true" tabindex="-1"></a>poisson_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb83-174"><a href="#cb83-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-175"><a href="#cb83-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-176"><a href="#cb83-176" aria-hidden="true" tabindex="-1"></a>Wir schauen in die Summary-Ausgabe des Poissonmodells und sehen, dass dort steht, dass <span class="in">`Dispersion parameter for poisson family taken to be 1`</span>. Wir modellieren also einen eins zu eins Zusammenhang von Mittelwert und Varianz. Wenn dieser Zusammenhang nicht in unseren Daten existiert, dann haben wir eine Overdispersion vorliegen.</span>
<span id="cb83-177"><a href="#cb83-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-178"><a href="#cb83-178" aria-hidden="true" tabindex="-1"></a>Wir können die Overdispersion mit abschätzen indem wir die <span class="in">`Residual deviance`</span> durch die Freiheitsgrade der <span class="in">`Residual deviance`</span> teilen. Daher erhalten wir eine Overdispersion von $\cfrac{1590.04}{61} \approx 26.1$. Damit haben wir eine eindeutige Overdispersion vorliegen. Damit steigt die Varianz in einem Verhältnis von ca. 1 zu 26. Wir können auch die Funktion <span class="in">`check_overdispersion()`</span> aus dem R Paket <span class="in">`{performance}`</span> nutzen um die Overdispersion zu berechnen. Die Funktion kann das schneller und ist auch in der Abfolge einer Analyse besser geeignet.</span>
<span id="cb83-179"><a href="#cb83-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-182"><a href="#cb83-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-183"><a href="#cb83-183" aria-hidden="true" tabindex="-1"></a>poisson_fit <span class="sc">|&gt;</span> <span class="fu">check_overdispersion</span>()</span>
<span id="cb83-184"><a href="#cb83-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-185"><a href="#cb83-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-186"><a href="#cb83-186" aria-hidden="true" tabindex="-1"></a>Wenn wir Overdispersion vorliegen haben und damit die Varianz zu niedrig schätzen, dann erhalten wir viel mehr signifikante Ergebnisse als es in den Daten zu erwarten wäre. Schauen wir uns nochmal die Parameter der Poissonverteilung und die $p$-Werte einmal an.</span>
<span id="cb83-187"><a href="#cb83-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-190"><a href="#cb83-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-191"><a href="#cb83-191" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-192"><a href="#cb83-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-193"><a href="#cb83-193" aria-hidden="true" tabindex="-1"></a>poisson_fit <span class="sc">|&gt;</span> <span class="fu">model_parameters</span>()</span>
<span id="cb83-194"><a href="#cb83-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-195"><a href="#cb83-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-196"><a href="#cb83-196" aria-hidden="true" tabindex="-1"></a>In der Spalte <span class="in">`p`</span> finden wir die $p$-Werte für alle Variablen. Wir sehen, dass fast alle Variablen signifikant sind und das wir eine sehr niedrige Varianz in der Spalte <span class="in">`SE`</span> sehen. Das heißt unser geschätzer Fehler ist sehr gering. Das ahnten wir ja schon, immerhin haben wir eine Overdisperson vorliegen. Das Modell ist somit falsch. Wir müssen uns ein neues Modell suchen, was Overdispersion berückscihtigen und modellieren kann.</span>
<span id="cb83-197"><a href="#cb83-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-198"><a href="#cb83-198" aria-hidden="true" tabindex="-1"></a>Die Quasi-Poisson Verteilung hat einen zusätzlichen, unabhänigen Parameter um die Varianz der Verteilung zu schätzen. Daher können wir die Overdispersion mit einer Quasi-Poisson Verteilung berückscihtigen. Wir können eine Quasi-Poisson Verteilung auch mit der Funktion <span class="in">`glm()`</span> schätzen nur müssen wir als Verteilungsfamilie <span class="in">`quasipoisson`</span> angeben.</span>
<span id="cb83-199"><a href="#cb83-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-202"><a href="#cb83-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-203"><a href="#cb83-203" aria-hidden="true" tabindex="-1"></a>quasipoisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(longnose <span class="sc">~</span> area <span class="sc">+</span> do2 <span class="sc">+</span> maxdepth <span class="sc">+</span> no3 <span class="sc">+</span> so4 <span class="sc">+</span> temp,</span>
<span id="cb83-204"><a href="#cb83-204" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> longnose_tbl, <span class="at">family =</span> quasipoisson)</span>
<span id="cb83-205"><a href="#cb83-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-206"><a href="#cb83-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-207"><a href="#cb83-207" aria-hidden="true" tabindex="-1"></a>Nach dem Modellti können wir nochmal in der <span class="in">`summary()`</span> Funktion schauen, ob wir die Overdispersion richtig berücksichtigt haben.</span>
<span id="cb83-208"><a href="#cb83-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-211"><a href="#cb83-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-212"><a href="#cb83-212" aria-hidden="true" tabindex="-1"></a>quasipoisson_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb83-213"><a href="#cb83-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-214"><a href="#cb83-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-215"><a href="#cb83-215" aria-hidden="true" tabindex="-1"></a>An der Zeile <span class="in">`Dispersion parameter for quasipoisson family taken to be 29.403319`</span> in der Summary-Ausgabe sehen wir, dass das Modell der Quasi-Possion Verteilung die Overdispersion korrekt berücksichtigt hat. Wir können uns nun einmal die Modellparameter anschauen. Die Interpretation machen wir am Ende des Kapitels.</span>
<span id="cb83-216"><a href="#cb83-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-219"><a href="#cb83-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-220"><a href="#cb83-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-221"><a href="#cb83-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-222"><a href="#cb83-222" aria-hidden="true" tabindex="-1"></a>quasipoisson_fit <span class="sc">|&gt;</span> <span class="fu">model_parameters</span>()</span>
<span id="cb83-223"><a href="#cb83-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-224"><a href="#cb83-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-225"><a href="#cb83-225" aria-hidden="true" tabindex="-1"></a>Jetzt sieht unser Modell und die $p$-Werte zusammen mit dem Standardfehler <span class="in">`SE`</span> schon sehr viel besser aus. Wir können also diesem Modell erstmal von der Seite der Overdispersion vertrauen.</span>
<span id="cb83-226"><a href="#cb83-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-227"><a href="#cb83-227" aria-hidden="true" tabindex="-1"></a>Am Ende wollen wir nochmal das Modell mit der negativen Binomialverteilung rechnen. Die negativen Binomialverteilung erlaubt auch eine Unabhängigkeit von dem Mittelwert zu der Varianz. Wir können hier auch für die Overdispersion adjustieren. Wir rechnen die negativen Binomialregression mit der Funktion <span class="in">`glm.nb()`</span> aus dem R Paket <span class="in">`{MASS}`</span>. Wir müssen keine Verteilungsfamilie angeben, die Funktion <span class="in">`glm.nb()`</span> kann nur die negative Binomialverteilung modellieren.</span>
<span id="cb83-228"><a href="#cb83-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-231"><a href="#cb83-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-232"><a href="#cb83-232" aria-hidden="true" tabindex="-1"></a>negativebinomial_fit <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(longnose <span class="sc">~</span> area <span class="sc">+</span> do2 <span class="sc">+</span> maxdepth <span class="sc">+</span> no3 <span class="sc">+</span> so4 <span class="sc">+</span> temp,</span>
<span id="cb83-233"><a href="#cb83-233" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> longnose_tbl)</span>
<span id="cb83-234"><a href="#cb83-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-235"><a href="#cb83-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-236"><a href="#cb83-236" aria-hidden="true" tabindex="-1"></a>Auch hier schauen wir mit der Funktion <span class="in">`summary()`</span> einmal, ob die Overdisprsion richtig geschätzt wurde oder ob hier auch eine Unterschätzung des Zusammenhangs des Mittelwerts und der Varianz vorliegt.</span>
<span id="cb83-237"><a href="#cb83-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-240"><a href="#cb83-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-241"><a href="#cb83-241" aria-hidden="true" tabindex="-1"></a>negativebinomial_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb83-242"><a href="#cb83-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-243"><a href="#cb83-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-244"><a href="#cb83-244" aria-hidden="true" tabindex="-1"></a>Auch hier sehen wir, dass die Overdispersion mit dem Parameter $\theta$ berücksichtigt wird. Wir können die Zahl $1.67$ nicht direkt mit der Overdispersion aus einer Poissonregression verglechen, aber wir sehen dass das Verhältnis von <span class="in">`Residual deviance`</span> zu den Freiheitsgraden mit $\cfrac{73.65}{61} \approx 1.20$ fast bei 1:1 liegt. Wir könnten also auch eine negative Binomialverteilung für das Modellieren nutzen.</span>
<span id="cb83-245"><a href="#cb83-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-248"><a href="#cb83-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-249"><a href="#cb83-249" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-250"><a href="#cb83-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-251"><a href="#cb83-251" aria-hidden="true" tabindex="-1"></a>negativebinomial_fit <span class="sc">|&gt;</span> <span class="fu">model_parameters</span>()</span>
<span id="cb83-252"><a href="#cb83-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-253"><a href="#cb83-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-254"><a href="#cb83-254" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb83-255"><a href="#cb83-255" aria-hidden="true" tabindex="-1"></a>Wie immer gibt es reichlich Tipps &amp; Tricks welches Modell du nun nehmen solltest. <span class="co">[</span><span class="ot">How to deal with overdispersion in Poisson regression: quasi-likelihood, negative binomial GLM, or subject-level random effect?</span><span class="co">](https://stats.stackexchange.com/questions/201903/how-to-deal-with-overdispersion-in-poisson-regression-quasi-likelihood-negativ/332250#332250)</span> und das Tutorial <span class="co">[</span><span class="ot">Modeling Count Data</span><span class="co">](https://online.stat.psu.edu/stat504/lesson/9/9.2-0)</span>. Auch ich mus immer wieder schauen, was am besten konkret in der Anwendung passen könnte und würde.</span>
<span id="cb83-256"><a href="#cb83-256" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-257"><a href="#cb83-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-258"><a href="#cb83-258" aria-hidden="true" tabindex="-1"></a>Welches Modell nun das beste Modell ist, ist schwer zu sagen. Wenn du Overdisperion vorliegen hast, dann ist natürlich nur das Quasi-Poissonmodell oder das negative Binomialmodell möglich. Welche der beiden dann das bessere ist, hängt wieder von der Fragestellung ab. Allgemein gesprochen ist das Quasi-Poissonmodell *besser* wenn dich die Zusammenhänge von $y$ zu $x$ am meisten interessieren. Und das ist in unserem Fall hier die Sachlage. Daher gehen wir mit den Quasi-Poissonmdell dann weiter.</span>
<span id="cb83-259"><a href="#cb83-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-260"><a href="#cb83-260" aria-hidden="true" tabindex="-1"></a><span class="fu">## Performance des Modells</span></span>
<span id="cb83-261"><a href="#cb83-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-262"><a href="#cb83-262" aria-hidden="true" tabindex="-1"></a>In diesem kurzen Abschnitt wollen wir uns einmal anschauen, ob das Modell neben der Overdispersion auch sonst aus statistischer Sicht in Ordnung ist. Wir wollen ja mit dem Modell aus dem Fit <span class="in">`quasipoisson_fit`</span> weitermachen. Also schauen wir uns einmal das pseudo-$R^2$ für die Poissonregression an. Da wir es mit einem GLM zu tun haben, ist das $R^2$ mit Vorsicht zu genießen. In einer Gaussianregression können wir das $R^2$ als Anteil der erklärten Varianz durch das Modell interpretieren. Im Falle von GLM's müssen wir hier vorsichtiger sein. In GLM's gibt es ja keine Varianz sondern eine Deviance.</span>
<span id="cb83-263"><a href="#cb83-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-266"><a href="#cb83-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-267"><a href="#cb83-267" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_efron</span>(quasipoisson_fit)</span>
<span id="cb83-268"><a href="#cb83-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-269"><a href="#cb83-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-270"><a href="#cb83-270" aria-hidden="true" tabindex="-1"></a>Mit einem pseudo-$R^2$ von $0.33$ erklären wir ca. 33% der Varianz in der Anzahl der Hechte. Das ist zwar keine super gute Zahl, aber dafür, dass wir nur eine handvoll von Parametern erfasst haben, ist es dann auch wieder nicht so schlecht. Die Anzahl an Hechten wird sicherlich an ganz vielen Parametern hängen, wir konnten immerhin einige wichtige Stellschrauben vermutlich finden.</span>
<span id="cb83-271"><a href="#cb83-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-272"><a href="#cb83-272" aria-hidden="true" tabindex="-1"></a>In @fig-pois-model-check schauen wir uns nochmal die Daten in den Modelgüteplots an. Wir sehen vorallem, dass wir vielelicht doch einen Ausreißer mit der Beobachtung 17 vorliegen haben. Auch ist der Fit nicht so super, wie wir an dem QQ-Plot sehen. Die Beobachtungen fallen in dem QQ-Plot nicht alle auf eine Linie. Auch sehen wir dieses Muster in dem Residualplot. Hiererwarten wir eine gerade blaue Linie und auch hier haben wir eventuell Ausreißer mit in den Daten.</span>
<span id="cb83-273"><a href="#cb83-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-276"><a href="#cb83-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-277"><a href="#cb83-277" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb83-278"><a href="#cb83-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-279"><a href="#cb83-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pois-model-check</span></span>
<span id="cb83-280"><a href="#cb83-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-281"><a href="#cb83-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb83-282"><a href="#cb83-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb83-283"><a href="#cb83-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Ausgabe ausgewählter Modelgüteplots der Funktion `check_model()`."</span></span>
<span id="cb83-284"><a href="#cb83-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-285"><a href="#cb83-285" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(quasipoisson_fit, <span class="at">colors =</span> cbbPalette[<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>], </span>
<span id="cb83-286"><a href="#cb83-286" aria-hidden="true" tabindex="-1"></a>            <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"qq"</span>, <span class="st">"outliers"</span>, <span class="st">"pp_check"</span>, <span class="st">"homogeneity"</span>)) </span>
<span id="cb83-287"><a href="#cb83-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-288"><a href="#cb83-288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-289"><a href="#cb83-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-290"><a href="#cb83-290" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpretation des Modells</span></span>
<span id="cb83-291"><a href="#cb83-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-292"><a href="#cb83-292" aria-hidden="true" tabindex="-1"></a>Um die Effektschätzer einer Poissonregression oder aber einer Quasipoisson-Regression interpretieren zu können müssen wir uns einmal einen Beispieldatensatz mit bekannten Effekten zwischen den Gruppen bauen. Im Folgenden bauen wir uns einen Datensatz mit zwei Gruppen. Einmal einer Kontrollgruppe mit einer mittleren Anzahl an $15$ und einer Behandlungsgruppe mit einer um $\beta_1 = 10$ höheren Anzahl. Wir haben also in der Kontrolle im Mittel eine Anzahl von $15$ und in der Behandlungsgruppe eine mittlere Anzahl von $25$.</span>
<span id="cb83-293"><a href="#cb83-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-296"><a href="#cb83-296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-297"><a href="#cb83-297" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb83-298"><a href="#cb83-298" aria-hidden="true" tabindex="-1"></a>longnose_small_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">grp =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> sample_size),</span>
<span id="cb83-299"><a href="#cb83-299" aria-hidden="true" tabindex="-1"></a>                             <span class="at">count =</span> <span class="dv">15</span> <span class="sc">+</span> <span class="dv">10</span> <span class="sc">*</span> grp <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">2</span> <span class="sc">*</span> sample_size, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb83-300"><a href="#cb83-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">round</span>(count),</span>
<span id="cb83-301"><a href="#cb83-301" aria-hidden="true" tabindex="-1"></a>         <span class="at">grp =</span> <span class="fu">factor</span>(grp, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"ctrl"</span>, <span class="st">"trt"</span>)))</span>
<span id="cb83-302"><a href="#cb83-302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-303"><a href="#cb83-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-304"><a href="#cb83-304" aria-hidden="true" tabindex="-1"></a>In @tbl-pois-longnose-small sehen wir nochmal die Daten als Ausschnitt dargestellt.</span>
<span id="cb83-305"><a href="#cb83-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-308"><a href="#cb83-308" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-309"><a href="#cb83-309" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb83-310"><a href="#cb83-310" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-311"><a href="#cb83-311" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-312"><a href="#cb83-312" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-pois-longnose-small</span></span>
<span id="cb83-313"><a href="#cb83-313" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: How much is the fish? Der Datensatz über $n = 1000$ Beobachtungen an dem wir überlegen wollen wie wir die Effektschätzer einer Poissonregression zu interpretieren haben. </span></span>
<span id="cb83-314"><a href="#cb83-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-315"><a href="#cb83-315" aria-hidden="true" tabindex="-1"></a>longnose_small_raw_tbl <span class="ot">&lt;-</span> longnose_small_tbl <span class="sc">|&gt;</span> </span>
<span id="cb83-316"><a href="#cb83-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grp =</span> <span class="fu">as.character</span>(grp))</span>
<span id="cb83-317"><a href="#cb83-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-318"><a href="#cb83-318" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(longnose_small_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>),</span>
<span id="cb83-319"><a href="#cb83-319" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(longnose_small_raw_tbl)),</span>
<span id="cb83-320"><a href="#cb83-320" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(longnose_small_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb83-321"><a href="#cb83-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb83-322"><a href="#cb83-322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-323"><a href="#cb83-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-324"><a href="#cb83-324" aria-hidden="true" tabindex="-1"></a>Da sich die Tabelle schlecht liest hier nochmal der Boxplot in @fig-pois-model-small. Wir sehen den Grupenunterschied von $10$ sowie die unterschiedlichen mittleren Anzahlen für die Kontrolle und die Behandlung.</span>
<span id="cb83-325"><a href="#cb83-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-328"><a href="#cb83-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-329"><a href="#cb83-329" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb83-330"><a href="#cb83-330" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-331"><a href="#cb83-331" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pois-model-small</span></span>
<span id="cb83-332"><a href="#cb83-332" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-333"><a href="#cb83-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb83-334"><a href="#cb83-334" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb83-335"><a href="#cb83-335" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: How much is the fish? Der Boxplot über $n = 1000$ Beobachtungen an dem wir überlegen wollen wie wir die Effektschätzer einer Poissonregression zu interpretieren haben. </span></span>
<span id="cb83-336"><a href="#cb83-336" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb83-337"><a href="#cb83-337" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Verteilung der Werte als Boxplot."</span></span>
<span id="cb83-338"><a href="#cb83-338" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Verteilung der Werte als Densityplot."</span></span>
<span id="cb83-339"><a href="#cb83-339" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-nrow: 2</span></span>
<span id="cb83-340"><a href="#cb83-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-341"><a href="#cb83-341" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(longnose_small_tbl, <span class="fu">aes</span>(<span class="at">x =</span> grp, <span class="at">y =</span> count, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb83-342"><a href="#cb83-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-343"><a href="#cb83-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb83-344"><a href="#cb83-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb83-345"><a href="#cb83-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb83-346"><a href="#cb83-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-347"><a href="#cb83-347" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> longnose_small_tbl, <span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">fill =</span> grp)) <span class="sc">+</span></span>
<span id="cb83-348"><a href="#cb83-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-349"><a href="#cb83-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb83-350"><a href="#cb83-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="st">"Gruppe"</span>) <span class="sc">+</span></span>
<span id="cb83-351"><a href="#cb83-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb83-352"><a href="#cb83-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">30</span>)) </span>
<span id="cb83-353"><a href="#cb83-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-354"><a href="#cb83-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-355"><a href="#cb83-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-356"><a href="#cb83-356" aria-hidden="true" tabindex="-1"></a>Jetzt fitten wir einmal das simple Poissonmodell mit der Anzahl als Outcome und der Gruppe mit den zwei Leveln als $x$. Wir pipen dann das Ergebnis des Fittes gleich in die Funktion <span class="in">`model_parameters()`</span> weiter um die Ergebnisse des Modellierens zu erhalten.</span>
<span id="cb83-357"><a href="#cb83-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-360"><a href="#cb83-360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-361"><a href="#cb83-361" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-362"><a href="#cb83-362" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-363"><a href="#cb83-363" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(count <span class="sc">~</span> grp, <span class="at">data =</span> longnose_small_tbl, <span class="at">family =</span> poisson) <span class="sc">|&gt;</span></span>
<span id="cb83-364"><a href="#cb83-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-365"><a href="#cb83-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-366"><a href="#cb83-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-367"><a href="#cb83-367" aria-hidden="true" tabindex="-1"></a>Als erstes fällt auf, dass wir die Ausgabe des Modells exponieren müssen. Um einen linearen Zusamenhang hinzukriegen bedient sich die Poissonregression den Trick, das der Zusammenhang zwischen dem $y$ und dem $x$ *transformiert* wird. Wir rechnen unsere Regression nicht auf den echten Daten sondern auf dem $\log$-scale. Daher müssen wir die Koeffizienten der Poissonregression wieder zurücktransfomieren, wenn wir die Koeffizienten interpretieren wollen. Das können wir mit der Option <span class="in">`exponentiate = TRUE`</span> durchführen.</span>
<span id="cb83-368"><a href="#cb83-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-369"><a href="#cb83-369" aria-hidden="true" tabindex="-1"></a>Gut soweit, aber was heißen den jetzt die Zahlen? Wir haben einen Intercept von $14.99$ das entspricht der mittleren Anzahl in der Kontrollgruppe. Und was sagt jetzt die $1.67$ vom Level <span class="in">`trt`</span> des Faktors <span class="in">`grp`</span>? Wenn wir $14.99 \cdot 1.67$ rechnen, dann erhalten wir als Ergebnis $25.03$, also die mittlere Anzahl in der Behandlungsgruppe. Was sagt uns das jetzt aus? Wir erhalten aus der Poissonregression eine Wahrscheinlichkeit oder aber ein Risk Ratio. Wir können sagen, dass die Anzahl in der Behandlungsgruppe $1.67$-mal so groß ist wie in der Kontrollgruppe.</span>
<span id="cb83-370"><a href="#cb83-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-371"><a href="#cb83-371" aria-hidden="true" tabindex="-1"></a>Schauen wir uns nochmal das volle Modell an und interpretieren die Effekte der einzelnen Variablen.</span>
<span id="cb83-372"><a href="#cb83-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-375"><a href="#cb83-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-376"><a href="#cb83-376" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-377"><a href="#cb83-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-378"><a href="#cb83-378" aria-hidden="true" tabindex="-1"></a>quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb83-379"><a href="#cb83-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) </span>
<span id="cb83-380"><a href="#cb83-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-381"><a href="#cb83-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-382"><a href="#cb83-382" aria-hidden="true" tabindex="-1"></a>So schön auch die Funktion <span class="in">`model_parameters()`</span> ist, so haben wir aber hier das Problem, dass wir den Effekt von <span class="in">`area`</span> nicht mehr richtig sehen. Wir kriegen hier eine zu starke Rundung auf zwei Nachkommastellen. Wir nutzen jetzt mal die Funktion <span class="in">`tidy()`</span> um hier Abhilfe zu leisten. Ich muss hier noch die Spalte <span class="in">`estimate`</span> mit <span class="in">`num(..., digits = 5)`</span> anpassen, damit du in der Ausgabe auf der Webseite auch die Nachkommastellen siehst.</span>
<span id="cb83-383"><a href="#cb83-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-386"><a href="#cb83-386" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-387"><a href="#cb83-387" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-388"><a href="#cb83-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-389"><a href="#cb83-389" aria-hidden="true" tabindex="-1"></a>quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb83-390"><a href="#cb83-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb83-391"><a href="#cb83-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb83-392"><a href="#cb83-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">pvalue</span>(p.value),</span>
<span id="cb83-393"><a href="#cb83-393" aria-hidden="true" tabindex="-1"></a>         <span class="at">estimate =</span> <span class="fu">num</span>(estimate, <span class="at">digits =</span> <span class="dv">5</span>))</span>
<span id="cb83-394"><a href="#cb83-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-395"><a href="#cb83-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-396"><a href="#cb83-396" aria-hidden="true" tabindex="-1"></a>Schauen wir uns die Effekte der Poissonregression einmal an und versuchen die Ergebnisse zu interpretieren. Dabei ist wichtig sich zu erinnern, dass kein Effekt eine 1 bedeutet. Wir schauen hier auf einen Faktor. Wenn wir eine Anzahl mal Faktor 1 nehmen, dann ändert sich nichts an der Anzahl.</span>
<span id="cb83-397"><a href="#cb83-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-398"><a href="#cb83-398" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`(Intercept)`</span> beschreibt den Intercept der Poissonregression. Wenn wir mehr als eine simple Regression vorliegen haben, wie in diesem Fall, dann ist der Intercept schwer zu interpretieren. Wir konzentrieren uns auf die Effekte der anderen Variablen.</span>
<span id="cb83-399"><a href="#cb83-399" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`area`</span>, beschreibt den Effekt der Fläche. Steigt die Fläche um ein Quadratmeter an, so erhöht sich die *Anzahl an Fischen* um den $1.00001$. Daher würde man hier eher sagen, erhöht sich die Fläche um jeweils 1000qm so erhöht sich die *Anzahl an Fischen* um den Faktor $1.1$. Dann haben wir auch einen besser zu interpretierenden Effektschätzer. Die Signifikanz bleibt hier davon unbetroffen.</span>
<span id="cb83-400"><a href="#cb83-400" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`do2`</span>, beschreibt den Partzialdruck des Sauerstoffs. Steigt dieser um eine Einheit an, so sehen wie eine Erhöhung der *Anzahl an Fischen* um den Faktor $1.25$. Der Effekt ist gerade *nicht* signifikant.</span>
<span id="cb83-401"><a href="#cb83-401" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`maxdepth`</span>, beschreibt die maximale Tiefe. Je tiefer ein Fluss, desto mehr Hechte werden wir beobachten. Der Effekt von $1.01$ pro Meter Tiefe ist signifikant.</span>
<span id="cb83-402"><a href="#cb83-402" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`no3`</span>, beschreibt den Anteil an Nitrat in den Flüssen. Je mehr Nitrat desto signifiant mehr Hechte werden wir beobachten. Hier steigt der Faktor auch um $1.20$.</span>
<span id="cb83-403"><a href="#cb83-403" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`so4`</span>, beschreibt den Schwefelgehalt und mit steigenden Schwefelgehalt nimmt die *Anzahl an Fischen* leicht ab. Der Effekt ist aber überhaupt nicht signifikant.</span>
<span id="cb83-404"><a href="#cb83-404" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`temp`</span>, beschreibt die Temperatur der Flüsse. Mit steigender Temperatur erwarten wir mehr Hechte zu beobachten. Der Effekt von $1.08$ Fischen pro Grad Erhöhung ist signifikant.</span>
<span id="cb83-405"><a href="#cb83-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-406"><a href="#cb83-406" aria-hidden="true" tabindex="-1"></a>Was nehmen wir aus der Poissonregression zu den langnasigen Hechten mit? Zum einen haben die Fläche, die Tiefe und der Nitratgehalt einen signifikanten Einfluss auf die Anzahl an Hechten. Auch führt eine höhere Temperatur zu mehr gefundenen Hechten. Die erhöhte Temperatur steht etwas im Widerspuch zu dem Sauerstoffpartizaldruck. Denn je höher die Temperatur desto weniger Sauerstoff wird in dem Wasser gelöst sein. Auch scheint die Oberfläche mit der Tiefe korreliert. Allgemein scheinen Hechte große Flüsse zu mögen. Hier bietet sich also noch eine Variablenselektion oder eine Untersuchung auf Ausreißer an um solche Effekte nochmal gesondert zu betrachten.</span>
<span id="cb83-407"><a href="#cb83-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-408"><a href="#cb83-408" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zeroinflation</span></span>
<span id="cb83-409"><a href="#cb83-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-410"><a href="#cb83-410" aria-hidden="true" tabindex="-1"></a>So eine Poissonregression hat schon einiges an Eigenheiten. Neben dem Problem der Overdispersion gibt es aber noch eine weitere Sache, die wir beachten müssen. Wir können bei einer Poissonregression auch eine Zeroinflation vorliegen haben. Das heißt, wir beobachten viel mehr Nullen in den Daen, als wir aus der Poissonverteilung erwarten würden. Es gibt also einen biologischen oder künstlichn Prozess, der uns Nullen produziert. Häufig wissen wir nicht, ob wir den Prozess, der uns die Nullen in den Daten produziert, auch abbilden. Das heißt, es kann sein, dass wir einfach nichts Zählen, weil dort nichts ist oder aber es gibt dafür einen Grund. Diesen Grund müssten wir dann irgendwie in unseren Daten erfasst haben, aber meistens haben wir das nicht.</span>
<span id="cb83-411"><a href="#cb83-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-412"><a href="#cb83-412" aria-hidden="true" tabindex="-1"></a>Schauen wir usn dafür einmal ein Datenbeispiel von Eidechsen in der Lüneburgerheide an. Wir haben Eidechsen <span class="in">`lizard`</span> in zwei verschiedenen Habitaten <span class="in">`grp`</span> gezählt. Einmal, ob die Eidechsen eher im offenen Gelände oder eher im bedeckten Gelände zu finden waren. Im Weiteren haben wir geschaut, ob der Boden keinen Regen erhalten hatte, trocken war oder gar feucht. Mit trocken ist hier eine gewisse Restfeuchte gemeint. Am Ende haben wir noch bestimmt, ob wir eher nah an einer Siedlung waren oder eher weiter entfernt. Du kannst dir den Daten satz in der Datei <span class="in">`lizards.csv`</span> nochmal anschauen. In @tbl-lizard-data sind die Daten nochmal dargestellt.</span>
<span id="cb83-413"><a href="#cb83-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-416"><a href="#cb83-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-417"><a href="#cb83-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-418"><a href="#cb83-418" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-419"><a href="#cb83-419" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb83-420"><a href="#cb83-420" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Ausschnitt aus den Eidechsendaten für die zwei Habitate unter verschiedenen Feuchtigkeitsbedingungen und Nähe zur nächsten Siedlung."</span></span>
<span id="cb83-421"><a href="#cb83-421" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-lizard-data</span></span>
<span id="cb83-422"><a href="#cb83-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-423"><a href="#cb83-423" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20210061</span>)</span>
<span id="cb83-424"><a href="#cb83-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-425"><a href="#cb83-425" aria-hidden="true" tabindex="-1"></a>lizard_zero_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">grp =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb83-426"><a href="#cb83-426" aria-hidden="true" tabindex="-1"></a>                               <span class="at">rain =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb83-427"><a href="#cb83-427" aria-hidden="true" tabindex="-1"></a>                               <span class="at">pop =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb83-428"><a href="#cb83-428" aria-hidden="true" tabindex="-1"></a>                               <span class="at">rep =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb83-429"><a href="#cb83-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lizard =</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> grp <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> rain <span class="sc">+</span> <span class="fl">1.2</span> <span class="sc">*</span> pop <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="dv">0</span>, <span class="dv">2</span>),</span>
<span id="cb83-430"><a href="#cb83-430" aria-hidden="true" tabindex="-1"></a>         <span class="at">lizard =</span> <span class="fu">ifelse</span>(<span class="fu">round</span>(lizard) <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">round</span>(lizard)),</span>
<span id="cb83-431"><a href="#cb83-431" aria-hidden="true" tabindex="-1"></a>         <span class="at">grp =</span> <span class="fu">factor</span>(grp, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"open"</span>, <span class="st">"cover"</span>)),</span>
<span id="cb83-432"><a href="#cb83-432" aria-hidden="true" tabindex="-1"></a>         <span class="at">rain =</span> <span class="fu">factor</span>(rain, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"no"</span>, <span class="st">"dry"</span>, <span class="st">"wet"</span>)),</span>
<span id="cb83-433"><a href="#cb83-433" aria-hidden="true" tabindex="-1"></a>         <span class="at">pop =</span> <span class="fu">factor</span>(pop, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"near"</span>, <span class="st">"far"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb83-434"><a href="#cb83-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>rep)</span>
<span id="cb83-435"><a href="#cb83-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-436"><a href="#cb83-436" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv2</span>(lizard_zero_tbl, <span class="st">"data/lizards.csv"</span>)</span>
<span id="cb83-437"><a href="#cb83-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-438"><a href="#cb83-438" aria-hidden="true" tabindex="-1"></a>lizard_zero_tbl <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">7</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb83-439"><a href="#cb83-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-440"><a href="#cb83-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-441"><a href="#cb83-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-442"><a href="#cb83-442" aria-hidden="true" tabindex="-1"></a>In @fig-pois-lizard-data sehen wir die Zähldaten der Eidechsen nochmal als Histogramm dargestellt. Wenn wir an einem Punkt keine Eidechsen gefunden haben, dann haben wir keine fehlenden Werte eingetragen, sondern eben, dass wir keine Eidechsen gezählt haben. Wir sehen das wir sehr viele Nullen in unseren Daten haben. Ein Indiz für eine Inflation an Nullen oder eben einer Zeroinflation.</span>
<span id="cb83-443"><a href="#cb83-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-446"><a href="#cb83-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-447"><a href="#cb83-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb83-448"><a href="#cb83-448" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-449"><a href="#cb83-449" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pois-lizard-data</span></span>
<span id="cb83-450"><a href="#cb83-450" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-451"><a href="#cb83-451" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb83-452"><a href="#cb83-452" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb83-453"><a href="#cb83-453" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Histogramm der Verteilung der Hechte in den beobachteten Flüssen."</span></span>
<span id="cb83-454"><a href="#cb83-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-455"><a href="#cb83-455" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lizard_zero_tbl, <span class="fu">aes</span>(lizard)) <span class="sc">+</span></span>
<span id="cb83-456"><a href="#cb83-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-457"><a href="#cb83-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb83-458"><a href="#cb83-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Anzahl der gefundenen Eidechsen"</span>, <span class="at">y =</span> <span class="st">"Anzahl"</span>) <span class="sc">+</span></span>
<span id="cb83-459"><a href="#cb83-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb83-460"><a href="#cb83-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-461"><a href="#cb83-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-462"><a href="#cb83-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-463"><a href="#cb83-463" aria-hidden="true" tabindex="-1"></a>Um zu überprüfen, ob wir eine Zeroinflation in den Daten vorliegen haben, werden wir erstmal eine ganz normale Poissonregression auf den Daten rechnen. Wir ignorieren auch eine potenzielle Overdispersion. Das schauen wir uns dann in den Daten später nochmal an.</span>
<span id="cb83-464"><a href="#cb83-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-467"><a href="#cb83-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-468"><a href="#cb83-468" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-469"><a href="#cb83-469" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-470"><a href="#cb83-470" aria-hidden="true" tabindex="-1"></a>lizard_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(lizard <span class="sc">~</span> grp <span class="sc">+</span> rain <span class="sc">+</span> pop, <span class="at">data =</span> lizard_zero_tbl,</span>
<span id="cb83-471"><a href="#cb83-471" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> poisson)</span>
<span id="cb83-472"><a href="#cb83-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-473"><a href="#cb83-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-474"><a href="#cb83-474" aria-hidden="true" tabindex="-1"></a>Wie immer nutzen wir die Funktion <span class="in">`model_parameters()`</span> um uns die exponierten Koeffizienten aus dem Modell wiedergeben zu lassen. Das Modell dient uns jetzt nur als Ausgangsmodell und wir werden das Poissonmodell jetzt nicht weiter tiefer verwenden.</span>
<span id="cb83-475"><a href="#cb83-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-478"><a href="#cb83-478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-479"><a href="#cb83-479" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-480"><a href="#cb83-480" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-481"><a href="#cb83-481" aria-hidden="true" tabindex="-1"></a>lizard_fit <span class="sc">|&gt;</span> <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-482"><a href="#cb83-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-483"><a href="#cb83-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-484"><a href="#cb83-484" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass wir in der Variable <span class="in">`rain`</span> eine starke Reduzierung der Anzahl an Eidechsen sehen. Vielleicht ist dies eine Variable, die zu viele Nullen produziert. Auch hat die Variable <span class="in">`pop`</span>, die für die Nähe an einer Siedlung kodiert, einen starken positiven Effekt auf unsere Anzahl an Eidechsen. Hier wollen wir also einmal auf eine Zeroinflation überprüfen. Wir nutzen dazu die Funktion <span class="in">`check_zeroinflation()`</span> aus dem R Paket <span class="in">`{performance}`</span>. Die Funktion läuft nur auf einem Modellfit.</span>
<span id="cb83-485"><a href="#cb83-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-488"><a href="#cb83-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-489"><a href="#cb83-489" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: true</span></span>
<span id="cb83-490"><a href="#cb83-490" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-491"><a href="#cb83-491" aria-hidden="true" tabindex="-1"></a><span class="fu">check_zeroinflation</span>(lizard_fit)</span>
<span id="cb83-492"><a href="#cb83-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-493"><a href="#cb83-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-494"><a href="#cb83-494" aria-hidden="true" tabindex="-1"></a>Die Funktion gibt uns wieder, dass wir vermutlich eine Zeroinflation vorliegen haben. Das können wir aber Modellieren. Um eine Zeroinflation *ohne Overdispersion* zu modellieren nutzen wir die Funktion <span class="in">`zeroinfl()`</span> aus dem R Paket <span class="in">`{pscl}`</span>. Der erste Teil der Funktion ist leicht erkläret. Wir bauen uns wieder unswer Model zusammen, was wir fitten wollen. Dann kommt aber ein <span class="in">`|`</span> und mit diesem Symbol <span class="in">`|`</span> definieren wir, ob wir wissen, woher die Nullen kommen oder aber ob wir die Nullen mit einem zufälligen Prozess modellieren wollen.</span>
<span id="cb83-495"><a href="#cb83-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-496"><a href="#cb83-496" aria-hidden="true" tabindex="-1"></a>Wenn wir das Modell in der Form <span class="in">`y ~ f1 + f2 | 1`</span> schreiben, dann nehmen wir an, dass das Übermaß an Nullen in unseren Daten rein zufällig entstanden sind. Wir haben keine Spalte in de Daten, die uns eine Erklärung für die zusätzlichen Nullen liefern würde.</span>
<span id="cb83-497"><a href="#cb83-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-498"><a href="#cb83-498" aria-hidden="true" tabindex="-1"></a>Wir können auch <span class="in">`y ~ f1 + f2 | x3`</span> schreiben. Dann haben wir eine Variable <span class="in">`x3`</span> in den Daten von der wir glauben ein Großteil der Nullen herrührt. Wir könnten also in unseren Daten annehmen, dass wir den Überschuss an Nullen durch den Regen erhalten haben und damit über die Spalte <span class="in">`rain`</span> den Exzess an Nullen modellieren.</span>
<span id="cb83-499"><a href="#cb83-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-500"><a href="#cb83-500" aria-hidden="true" tabindex="-1"></a>Man sollte immer mit dem einfachsten Modell anfangen, deshalb werden wir jetzt einmal ein Modell fitten, dass annimmt, dass die Nullen durch einen uns unbekannten Zufallsprozess entstanden sind.</span>
<span id="cb83-501"><a href="#cb83-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-504"><a href="#cb83-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-505"><a href="#cb83-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-506"><a href="#cb83-506" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-507"><a href="#cb83-507" aria-hidden="true" tabindex="-1"></a>lizard_zero_infl_intercept_fit <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(lizard <span class="sc">~</span> grp <span class="sc">+</span> pop <span class="sc">+</span> rain <span class="sc">|</span> <span class="dv">1</span>, </span>
<span id="cb83-508"><a href="#cb83-508" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">data =</span> lizard_zero_tbl) </span>
<span id="cb83-509"><a href="#cb83-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-510"><a href="#cb83-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-511"><a href="#cb83-511" aria-hidden="true" tabindex="-1"></a>Wir schauen uns das Modell dann wieder einmal an und sehen eine Zweiteilung der Ausgabe. In dem oberen Teil der Ausgabe wird unsere Anzahl an Eidechsen modelliert. In dem unteren Teil wird der Anteil der Nullen in den Daten modelliert. Daher können wir über Variablen in dem <span class="in">`Zero-Inflation`</span> Block keine Aussagen über die Anzahl an Eidechsen treffen. Variablen tauchen nämlich nur in einem der beiden Blöcke auf.</span>
<span id="cb83-512"><a href="#cb83-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-515"><a href="#cb83-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-516"><a href="#cb83-516" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-517"><a href="#cb83-517" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-518"><a href="#cb83-518" aria-hidden="true" tabindex="-1"></a>lizard_zero_infl_intercept_fit <span class="sc">|&gt;</span> </span>
<span id="cb83-519"><a href="#cb83-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-520"><a href="#cb83-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-521"><a href="#cb83-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-522"><a href="#cb83-522" aria-hidden="true" tabindex="-1"></a>Als erstes beobachten wir einen größeren Effekt der Variable <span class="in">`grp`</span>. Das ist schon mal ein spannender Effekt. An der Signifikanz hat scih nicht viel geändert. Wir werden am Ende des Kapitels einmal alle Modell für die Modellierung der Zeroinflation vergleichen.</span>
<span id="cb83-523"><a href="#cb83-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-524"><a href="#cb83-524" aria-hidden="true" tabindex="-1"></a>Nun könnte es auch sein, dass der Effekt der vielen Nullen in unserer Variable <span class="in">`rain`</span> verborgen liegt. Wenn es also regnet, dann werden wir viel weniger Eidechsen beoabchten. Nehmen wir also <span class="in">`rain`</span> als ursächliche Variable mit in das Modell für die Zeroinflation.</span>
<span id="cb83-525"><a href="#cb83-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-528"><a href="#cb83-528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-529"><a href="#cb83-529" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-530"><a href="#cb83-530" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-531"><a href="#cb83-531" aria-hidden="true" tabindex="-1"></a>lizard_zero_infl_rain_fit <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(lizard <span class="sc">~</span> grp <span class="sc">+</span> pop <span class="sc">|</span> rain, </span>
<span id="cb83-532"><a href="#cb83-532" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">data =</span> lizard_zero_tbl)</span>
<span id="cb83-533"><a href="#cb83-533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-534"><a href="#cb83-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-535"><a href="#cb83-535" aria-hidden="true" tabindex="-1"></a>Wieder schauen wir uns einmal die Ausgabe des Modells einmal genauer an.</span>
<span id="cb83-536"><a href="#cb83-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-539"><a href="#cb83-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-540"><a href="#cb83-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-541"><a href="#cb83-541" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-542"><a href="#cb83-542" aria-hidden="true" tabindex="-1"></a>lizard_zero_infl_rain_fit <span class="sc">|&gt;</span> <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-543"><a href="#cb83-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-544"><a href="#cb83-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-545"><a href="#cb83-545" aria-hidden="true" tabindex="-1"></a>Es ändert sich einiges. Zum einen erfahren wir, dass der Regen anscheined doch viele Nullen in den Daten produziert. Wir haben ein extrem hohes $OR$ für die Variable <span class="in">`rain`</span>. Die Signifikanz ist jedoch eher gering. Wir haben nämlich auch eine sehr hohe Streuung mit den großen $OR$ vorliegen. Au der anderen Seite verlieren wir jetzt auch die Signifikanz von unseren Habitaten und dem Standort der Population. Nur so mäßig super dieses Modell.</span>
<span id="cb83-546"><a href="#cb83-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-547"><a href="#cb83-547" aria-hidden="true" tabindex="-1"></a>Wir können jetzt natürlich auch noch den Standort der Population mit in den Prozess für die Entstehung der Nullen hineinnehmen. Wir schauen uns dieses Modell aber nicht mehr im Detail an, sondern dann nur im Vergleich zu den anderen Modellen.</span>
<span id="cb83-548"><a href="#cb83-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-551"><a href="#cb83-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-552"><a href="#cb83-552" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-553"><a href="#cb83-553" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-554"><a href="#cb83-554" aria-hidden="true" tabindex="-1"></a>lizard_zero_infl_rain_pop_fit <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(lizard <span class="sc">~</span> grp <span class="sc">|</span> rain <span class="sc">+</span> pop, </span>
<span id="cb83-555"><a href="#cb83-555" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">data =</span> lizard_zero_tbl)</span>
<span id="cb83-556"><a href="#cb83-556" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-557"><a href="#cb83-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-558"><a href="#cb83-558" aria-hidden="true" tabindex="-1"></a>Die Gefahr besteht immer, das man sich an die Wand modelliert und vor lauter Modellen die Übersicht verliert. Neben der Zeroinflation müssen wir ja auch schauen, ob wir eventuell eine Overdispersion in den Daten vorliegen haben. Wenn das der Fall ist, dann müsen wir nochmal überlegen, was wir dann machen. Wir testen nun auf Ovrdisprsion in unserem *ursprünglichen* Poissonmodell mit der Funktion <span class="in">`check_overdispersion()`</span>.</span>
<span id="cb83-559"><a href="#cb83-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-562"><a href="#cb83-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-563"><a href="#cb83-563" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: true</span></span>
<span id="cb83-564"><a href="#cb83-564" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-565"><a href="#cb83-565" aria-hidden="true" tabindex="-1"></a><span class="fu">check_overdispersion</span>(lizard_fit)</span>
<span id="cb83-566"><a href="#cb83-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-567"><a href="#cb83-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-568"><a href="#cb83-568" aria-hidden="true" tabindex="-1"></a>Tja, und so erfahren wir, dass wir auch noch Overdispersion in unseren Daten vorliegen haben. Wir müsen also beides Modellieren. Einmal modellieren wir die Zeroinflation und einmal die Overdispersion. Wir können beides in einem negativen binominalen Modell fitten. Auch hier hilft die Funktion <span class="in">`zeroinfl()`</span> mit der Option <span class="in">`dist = negbin`</span>. Mit der Option geben wir an, dass wir eine negative binominal Verteilungsfamilie wählen. Damit können wir dann auch die Ovrdispersion in unseren Daten modellieren.</span>
<span id="cb83-569"><a href="#cb83-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-572"><a href="#cb83-572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-573"><a href="#cb83-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-574"><a href="#cb83-574" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-575"><a href="#cb83-575" aria-hidden="true" tabindex="-1"></a>lizard_zero_nb_intercept_fit <span class="ot">&lt;-</span> <span class="fu">zeroinfl</span>(lizard <span class="sc">~</span> grp <span class="sc">+</span> rain <span class="sc">+</span> pop <span class="sc">|</span> <span class="dv">1</span>, </span>
<span id="cb83-576"><a href="#cb83-576" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">dist =</span> <span class="st">"negbin"</span>, <span class="at">data =</span> lizard_zero_tbl)</span>
<span id="cb83-577"><a href="#cb83-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-578"><a href="#cb83-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-579"><a href="#cb83-579" aria-hidden="true" tabindex="-1"></a>Dann schauen wir usn einmal das Modell an. Zum einen sehen wir, dass der Effekt ähnlich groß ist, wie bei dem Intercept Modell der Funktion <span class="in">`zeroinfl`</span>. Auch bleiben die Signifikanzen ähnlich.</span>
<span id="cb83-580"><a href="#cb83-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-583"><a href="#cb83-583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-584"><a href="#cb83-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-585"><a href="#cb83-585" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-586"><a href="#cb83-586" aria-hidden="true" tabindex="-1"></a>lizard_zero_nb_intercept_fit <span class="sc">|&gt;</span> <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-587"><a href="#cb83-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-588"><a href="#cb83-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-589"><a href="#cb83-589" aria-hidden="true" tabindex="-1"></a>Nun haben wir vier Modelle geschätzt und wolen jetzt wissen, was ist das beste Modell. Dafür hilft usn dann eine Gegenüberstellung der Modelle mit der Funktion <span class="in">`modelsummary()`</span>. Wir könnten die Modelle auch gegeneinander statistsich Testen, aber hier behalten wir uns einmal den beschreibenden Vergleich vor. In @tbl-model-comp-zero sehen wir einmal die vier Modelle nebeneinander gestellt. Für eine bessere Übrsicht, habe ich aus allen Modellen den Intercept entfernt.</span>
<span id="cb83-590"><a href="#cb83-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-593"><a href="#cb83-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-594"><a href="#cb83-594" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-595"><a href="#cb83-595" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb83-596"><a href="#cb83-596" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Modellvergleich mit den vier Modellen. Wir schauen in wie weit sich die Koeffizienten und Modelgüten für die einzelnen Modelle im direkten Vergleich zum vollen Modell verändert haben."</span></span>
<span id="cb83-597"><a href="#cb83-597" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-model-comp-zero</span></span>
<span id="cb83-598"><a href="#cb83-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-599"><a href="#cb83-599" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"ZeroInfl Intercept"</span> <span class="ot">=</span> lizard_zero_infl_intercept_fit,</span>
<span id="cb83-600"><a href="#cb83-600" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ZeroInfl rain"</span> <span class="ot">=</span> lizard_zero_infl_rain_fit,</span>
<span id="cb83-601"><a href="#cb83-601" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"ZeroInfl rain+pop"</span> <span class="ot">=</span> lizard_zero_infl_rain_pop_fit,</span>
<span id="cb83-602"><a href="#cb83-602" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"NegBinom intercept"</span> <span class="ot">=</span> lizard_zero_nb_intercept_fit),</span>
<span id="cb83-603"><a href="#cb83-603" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"conf.int"</span>,</span>
<span id="cb83-604"><a href="#cb83-604" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"s.e. = {std.error}"</span>, </span>
<span id="cb83-605"><a href="#cb83-605" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"t = {statistic}"</span>,</span>
<span id="cb83-606"><a href="#cb83-606" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"p = {p.value}"</span>),</span>
<span id="cb83-607"><a href="#cb83-607" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_omit =</span> <span class="st">"Intercept"</span>, </span>
<span id="cb83-608"><a href="#cb83-608" aria-hidden="true" tabindex="-1"></a>             <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-609"><a href="#cb83-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-610"><a href="#cb83-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-611"><a href="#cb83-611" aria-hidden="true" tabindex="-1"></a>Die beiden Intercept Modelle haben die kleinsten $AIC$-Werte der vier Modelle. Darüber hinaus haben dann beide Modelle auch die höchsten $R^2_{adj}$ Werte. Beide Modelle erklären also im Verhältnis viel Varianz mit 58.5%. Auch ist der $RMSE$ Wert als Fehler bei beiden Modellen am kleinsten. Damit haben wir die Qual der Wahl, welches Modell wir nehmen. Ich würde das negative binominal Modell nehmen. Wir haben ins unseren Daten vermutlich eine Zeroinflation sowie eine Overdispersion vorliegen. Daher bietest es sich an, beides in einer negativen binominalen Regression zu berücksichtigen. Zwar sind die beiden Intercept Modelle in diesem Beispielfall von den Koeffizienten fast numerisch gleich, aber das hat eher mit dem reduzierten Beispiel zu tun, als mit dem eigentlichen Modell. In unserem Fall ist die Overdispersion nicht so extrem.</span>
<span id="cb83-612"><a href="#cb83-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-613"><a href="#cb83-613" aria-hidden="true" tabindex="-1"></a>Wie sehe den unser negative binominal Modell aus, wenn wir mit dem Modell einmal die zu erwartenden Eidechsen vorhersagen würden? Auch das kann helfen um abzuschätzen, ob das Modelle einigermaßen funktioniert hat. Wir haben ja hier den Vorteil, dass wir nur mit kategorialen Daten arbeiten. Wir haben keine kontiniuerlichen Variablen vorliegen und darüber hinaus auch nicht so viele Variablen insgesamt.</span>
<span id="cb83-614"><a href="#cb83-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-615"><a href="#cb83-615" aria-hidden="true" tabindex="-1"></a>Daher bauen wir uns mit <span class="in">`expand_grid()`</span> erstmal einen Datensatz, der nur aus den Faktorkombinationen besteht. Wir haben also nur eine Beobachtung je Faktorkombination. Danach nutzen wir die Daten einmal in der Funktion <span class="in">`predict()`</span> um uns die vorhergesagten Eidechsen nach dem gefitten Modell wiedergeben zu lassen.</span>
<span id="cb83-616"><a href="#cb83-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-619"><a href="#cb83-619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-620"><a href="#cb83-620" aria-hidden="true" tabindex="-1"></a>newdata_tbl <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">grp =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"open"</span>, <span class="st">"cover"</span>)),</span>
<span id="cb83-621"><a href="#cb83-621" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rain =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"no"</span>, <span class="st">"dry"</span>, <span class="st">"wet"</span>)),</span>
<span id="cb83-622"><a href="#cb83-622" aria-hidden="true" tabindex="-1"></a>                           <span class="at">pop =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"near"</span>, <span class="st">"far"</span>)))</span>
<span id="cb83-623"><a href="#cb83-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-624"><a href="#cb83-624" aria-hidden="true" tabindex="-1"></a>pred_lizards <span class="ot">&lt;-</span> <span class="fu">predict</span>(lizard_zero_nb_intercept_fit, <span class="at">newdata =</span> newdata_tbl) </span>
<span id="cb83-625"><a href="#cb83-625" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-626"><a href="#cb83-626" aria-hidden="true" tabindex="-1"></a>newdata_tbl <span class="ot">&lt;-</span> newdata_tbl <span class="sc">|&gt;</span> </span>
<span id="cb83-627"><a href="#cb83-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lizard =</span> pred_lizards)</span>
<span id="cb83-628"><a href="#cb83-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-629"><a href="#cb83-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-630"><a href="#cb83-630" aria-hidden="true" tabindex="-1"></a>Nachdem wir in dem Datensatz <span class="in">`newdata_tbl`</span> nun die vorhergesagten Eidechsen haben, können wir uns jetzt in der @fig-pred-lizard die Zusammenhänge nochmal anschauen.</span>
<span id="cb83-631"><a href="#cb83-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-634"><a href="#cb83-634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-635"><a href="#cb83-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb83-636"><a href="#cb83-636" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-637"><a href="#cb83-637" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-pred-lizard</span></span>
<span id="cb83-638"><a href="#cb83-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-639"><a href="#cb83-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb83-640"><a href="#cb83-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb83-641"><a href="#cb83-641" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der vorhergesagten Eidechsen in den Habitaten (`grp`), der Feuchtigkeit des Bodens nach Regen und dem Abstand zur nächsten Ortschaft."</span></span>
<span id="cb83-642"><a href="#cb83-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-643"><a href="#cb83-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-644"><a href="#cb83-644" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(newdata_tbl, <span class="fu">aes</span>(<span class="at">x =</span> rain, <span class="at">y =</span> lizard, <span class="at">colour =</span> grp, <span class="at">group =</span> grp)) <span class="sc">+</span></span>
<span id="cb83-645"><a href="#cb83-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb83-646"><a href="#cb83-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb83-647"><a href="#cb83-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb83-648"><a href="#cb83-648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> pop) <span class="sc">+</span></span>
<span id="cb83-649"><a href="#cb83-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Feuchtigkeit nach Regen"</span>, <span class="at">y =</span> <span class="st">"Anzahl der gezählten Eidechsen"</span>,</span>
<span id="cb83-650"><a href="#cb83-650" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Gruppe"</span>) <span class="sc">+</span></span>
<span id="cb83-651"><a href="#cb83-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb83-652"><a href="#cb83-652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-653"><a href="#cb83-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-654"><a href="#cb83-654" aria-hidden="true" tabindex="-1"></a>Wir erkennen, dass mit der Erhöhung der Feuchtigkeit die Anzahl an aufgefundenen Eidechsen sinkt. Der Effekt ist nicht mehr so stark, wenn es schon einmal geregnet hat. Ebenso macht es einen Unterschied, ob wir nahe einer Siedlung sind oder nicht. Grundsätzlich finden wir immer mehr Eidechsen in geschützten Habitaten als in offenen Habitaten.</span>
<span id="cb83-655"><a href="#cb83-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-656"><a href="#cb83-656" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gruppenvergleich {#sec-mult-comp-pois-reg}</span></span>
<span id="cb83-657"><a href="#cb83-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-658"><a href="#cb83-658" aria-hidden="true" tabindex="-1"></a>Häufig ist es ja so, dass wir das Modell für die Poisson Regression nur schätzen um dann einen Gruppenvergleich zu rechnen. Das heißt, dass es uns interessiert, ob es einen Unterschied zwischen den Leveln eines Faktors gegeben dem Outcome $y$ gibt. Da wir hier in unserem Beispiel zu den Flusshechten keine Gruppe drin haben, zeige ich dir das Prinzip einmal an einem ausgedachten Datensatz. Wir nehmen hier einen Datensatz zu Katzen-, Hunde- und Fuchsflöhen. Dabei erstellen wir uns einen Datensatz mit mittleren Anzahlen an Flöhen pro Tierart. Ich habe jetzt eine mittlere Flohanzahl von $10$ Flöhen bei den Katzen, eine mittlere Anzahl von $30$ Flöhen bei den Hunden und eine mittlere Anzahl von $10$ Flöhen bei den Füchsen gewählt. Wir generieren uns jeweils $20$ Beobachtungen je Tierart. Damit haben wir dann einen Datensatz zusammen, den wir nutzen können um einmal die Ergebnisse eines Gruppenvergleiches mit Zähldaten zu verstehen.</span>
<span id="cb83-659"><a href="#cb83-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-662"><a href="#cb83-662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-663"><a href="#cb83-663" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231202</span>)</span>
<span id="cb83-664"><a href="#cb83-664" aria-hidden="true" tabindex="-1"></a>n_rep <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb83-665"><a href="#cb83-665" aria-hidden="true" tabindex="-1"></a>flea_count_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">animal =</span> <span class="fu">gl</span>(<span class="dv">3</span>, n_rep, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"fox"</span>)),</span>
<span id="cb83-666"><a href="#cb83-666" aria-hidden="true" tabindex="-1"></a>                         <span class="at">count =</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(n_rep, <span class="dv">20</span>, <span class="dv">1</span>), </span>
<span id="cb83-667"><a href="#cb83-667" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">rnorm</span>(n_rep, <span class="dv">30</span>, <span class="dv">1</span>), </span>
<span id="cb83-668"><a href="#cb83-668" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">rnorm</span>(n_rep, <span class="dv">10</span>, <span class="dv">1</span>))))</span>
<span id="cb83-669"><a href="#cb83-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-670"><a href="#cb83-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-671"><a href="#cb83-671" aria-hidden="true" tabindex="-1"></a>Wenn du gerade hierher gesprungen bist, nochmal das simple Modell für unseren Gruppenvergleich unter einer Poisson Regression. Wir haben hier nur einen Faktor <span class="in">`animal`</span> mit in dem Modell. Am Ende des Abschnitts findest du dann noch ein Beispiel mit zwei Faktoren zu Thripsen auf Apfelbäumen. Wir modellieren hier eigentlich nicht die Zähldaten an sich, sondern die Raten. Du wirst das aber gleich bei der Ausgabe von <span class="in">`emmeans()`</span> sehen.</span>
<span id="cb83-672"><a href="#cb83-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-675"><a href="#cb83-675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-676"><a href="#cb83-676" aria-hidden="true" tabindex="-1"></a>pois_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> animal, <span class="at">data =</span> flea_count_tbl, <span class="at">family =</span> <span class="st">"poisson"</span>) </span>
<span id="cb83-677"><a href="#cb83-677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-678"><a href="#cb83-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-679"><a href="#cb83-679" aria-hidden="true" tabindex="-1"></a>Eigentlich ist es recht einfach, wie wir anfangen. Wir rechnen jetzt als erstes die ANOVA. Hier müssen wir dann einmal den Test angeben, der gerechnet werden soll um die p-Werte zu erhalten. Dann nutze ich noch die Funktion <span class="in">`model_parameters()`</span> um eine schönere Ausgabe zu erhalten.</span>
<span id="cb83-680"><a href="#cb83-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-683"><a href="#cb83-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-684"><a href="#cb83-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-685"><a href="#cb83-685" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-686"><a href="#cb83-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-687"><a href="#cb83-687" aria-hidden="true" tabindex="-1"></a>pois_fit <span class="sc">|&gt;</span> </span>
<span id="cb83-688"><a href="#cb83-688" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>(<span class="at">test =</span> <span class="st">"Chisq"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb83-689"><a href="#cb83-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">drop =</span> <span class="st">"NULL"</span>)</span>
<span id="cb83-690"><a href="#cb83-690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-691"><a href="#cb83-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-692"><a href="#cb83-692" aria-hidden="true" tabindex="-1"></a>Im Folgenden nutzen wir das R Paket <span class="in">`{emmeans}`</span> wie folgt. Wenn wir die mittleren Anzahlen benötigen, dann müssen wir die Option <span class="in">`type = "response"`</span> verwenden. Sonst würdest du Werte auf der Link-Skala wiederbekommen, die dir hier nicht helfen. Ich nutze später die <span class="in">`emmeans`</span> Ausgabe um ein Säulendiagramm mit den mittleren Anzahlen zu erstellen. Wir du gleich sehen wirst, werden wir aber nicht die Anzahlen vergleichen sondern die *Raten* in den jeweiligen Gruppen.</span>
<span id="cb83-693"><a href="#cb83-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-696"><a href="#cb83-696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-697"><a href="#cb83-697" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> pois_fit <span class="sc">|&gt;</span> </span>
<span id="cb83-698"><a href="#cb83-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb83-699"><a href="#cb83-699" aria-hidden="true" tabindex="-1"></a>emm_obj</span>
<span id="cb83-700"><a href="#cb83-700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-701"><a href="#cb83-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-702"><a href="#cb83-702" aria-hidden="true" tabindex="-1"></a>Jetzt steht hier zwar <span class="in">`rate`</span> aber was ist das denn nun? Dafür berechnen wir mal die Mittelwerte der Anzahlen für die drei Tierarten über die Funktion <span class="in">`summarise()`</span>. Dann vergleichen wir einmal die Ausgaben und schauen, was wir in <span class="in">`emmeans()`</span> berechnet haben.</span>
<span id="cb83-703"><a href="#cb83-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-706"><a href="#cb83-706" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-707"><a href="#cb83-707" aria-hidden="true" tabindex="-1"></a>flea_count_tbl <span class="sc">|&gt;</span> </span>
<span id="cb83-708"><a href="#cb83-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">|&gt;</span> </span>
<span id="cb83-709"><a href="#cb83-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_count =</span> <span class="fu">mean</span>(count))</span>
<span id="cb83-710"><a href="#cb83-710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-711"><a href="#cb83-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-712"><a href="#cb83-712" aria-hidden="true" tabindex="-1"></a>Wunderbar, es sind die Mittelwerte der Anzahlen, die in der Spalte <span class="in">`rate`</span> in der Ausgabe von <span class="in">`emmeans()`</span> stehen. Damit können wir dann arbeiten und die Ausgabe nutzen um ein Säulendigramm zu erstellen. Bitte schaue für die Umsetzung in das Beispiel am Ende des Abschnitts. Da zeige ich dir dann wie du ein Säulendigramm zu den Anzahlen von Thripsen auf Apfelbäumen erstellst.</span>
<span id="cb83-713"><a href="#cb83-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-714"><a href="#cb83-714" aria-hidden="true" tabindex="-1"></a>Wenn du die mittleren Anzahlen pro Tierart jetzt für jede Tierart testen willst, dann erhälst du aber keinen Mittelwertsunterschied der Anzahlen, sondern eine *Rate*. Rechnen wir aber erstmal den paarweisen Vergleich und schauen uns dann an, was wir erhalten haben. Wir kriegen am Ende wiederum einen Vergleich von Wahrscheinlichkeiten, aber eben hier von *Raten*. Wie immer, es kommt darauf an, was du willst. Hier einmal die paarweisen Vergleiche, darunter dann gleich das *compact letter display*.</span>
<span id="cb83-715"><a href="#cb83-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-718"><a href="#cb83-718" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-719"><a href="#cb83-719" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb83-720"><a href="#cb83-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb83-721"><a href="#cb83-721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-722"><a href="#cb83-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-723"><a href="#cb83-723" aria-hidden="true" tabindex="-1"></a>Okay, jetzt haben wir statt Raten also eine *Ratio*, also ein Verhältnis von Raten. Das schauen wir uns doch gleich mal in dem Beispiel an. Wir rechnen also einmal die mittlere Anzahl für jede Tierart durch die entsprechende andere mittlere Anzahl der anderen Tierart. Wir erhalten also folgende *Ratios* der mittleren Anzahlen.</span>
<span id="cb83-724"><a href="#cb83-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-725"><a href="#cb83-725" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-726"><a href="#cb83-726" aria-hidden="true" tabindex="-1"></a>\cfrac{cat}{dog} = \cfrac{20.1}{30.1} = 0.67 </span>
<span id="cb83-727"><a href="#cb83-727" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-728"><a href="#cb83-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-729"><a href="#cb83-729" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-730"><a href="#cb83-730" aria-hidden="true" tabindex="-1"></a>\cfrac{cat}{fox} = \cfrac{20.1}{10.2} = 1.97 </span>
<span id="cb83-731"><a href="#cb83-731" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-732"><a href="#cb83-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-733"><a href="#cb83-733" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-734"><a href="#cb83-734" aria-hidden="true" tabindex="-1"></a>\cfrac{dog}{fox} = \cfrac{30.1}{10.2} = 2.95 </span>
<span id="cb83-735"><a href="#cb83-735" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-736"><a href="#cb83-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-737"><a href="#cb83-737" aria-hidden="true" tabindex="-1"></a>Wie interpretieren wir jetzt die *Ratios*? Eigentlich ist das intuitiver als man auf den ersten Blick denkt. Wir haben zum Beispiel fast doppelt so viele Flöhe bei Katzen wie bei Füchsen. Die Anzahl von Hundeflöhen ist fast dreimal so hoch wie die Anzahl an Fuchsflöhen. Wir haben fast nur halb so viele Flöhe auf Katzen gefunden als bei den Hunden. Damit können wir dann schon arbeiten und eine Aussage treffen.</span>
<span id="cb83-738"><a href="#cb83-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-739"><a href="#cb83-739" aria-hidden="true" tabindex="-1"></a>Und fast am Ende können wir uns auch das *compact letter display* erstellen. Auch hier nutzen wir wieder die Funktion `cld()` aus dem R Paket `{multcomp}`. Hier erhälst du dann die Information über die mittlere Anzahl der jeweiligen Tierarten und ob sich die mittlere Anzahl unterscheidet. Ich nutze dann die Ausgabe von `emmeans()` um mir dann direkt das Säulendiagramm mit den Fehlerbalken und dem *compact letter display* zu erstellen. Mehr dazu dann im Kasten weiter unten zu dem Beispiel zu Thripsenanzahl auf Apfelbäumen.</span>
<span id="cb83-740"><a href="#cb83-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-743"><a href="#cb83-743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-744"><a href="#cb83-744" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-745"><a href="#cb83-745" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-746"><a href="#cb83-746" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span></span>
<span id="cb83-747"><a href="#cb83-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb83-748"><a href="#cb83-748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-749"><a href="#cb83-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-750"><a href="#cb83-750" aria-hidden="true" tabindex="-1"></a>Auch hier sehen wir, dass sich alle drei Gruppen signifikant unterschieden, keine der Tierarten teilt sich einen Buchstaben, so dass wir hier von einem Unterschied zwischen den mittleren Anzahlen an Flöhen auf den drei Tierarten ausgehen können.</span>
<span id="cb83-751"><a href="#cb83-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-752"><a href="#cb83-752" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb83-753"><a href="#cb83-753" aria-hidden="true" tabindex="-1"></a><span class="fu">## Offset in einer Poisson Regression</span></span>
<span id="cb83-754"><a href="#cb83-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-755"><a href="#cb83-755" aria-hidden="true" tabindex="-1"></a>Bei einem geplanten Experiment zählen wir meist in festgelegten Zeiteinheiten oder aber unser $n$ ist vorgeben. Jetzt kann es aber sein, dass wir nicht mit festen Zeitintervallen oder aber einer Fallzahl zählen. Beispielsweise können wir die Anzahl der Baumarten in einem Wald zählen: Ereignisse (eng. *event*) wären Baumbeobachtungen, die Exposition (eng. *exposure*) wäre eine Flächeneinheit und die Rate wäre die Anzahl der Arten pro Flächeneinheit. Wir können die Sterberaten in geografischen Gebieten als die Anzahl der Todesfälle geteilt durch die Personenjahre modellieren. Allgemeiner ausgedrückt können Ereignisraten als Ereignisse pro Zeiteinheit berechnet werden, wobei das Beobachtungsfenster für jede Einheit variieren kann. In diesen Beispielen ist die Exposition jeweils eine Einheit Fläche, Personenjahre und Zeiteinheit. So sollten beispielsweise sechs Fälle innerhalb eines Jahres nicht den gleichen Wert haben wie sechs Fälle innerhalb von 10 Jahren. In der Poisson-Regression wird dies als *Offset* behandelt. Mehr dazu dann gerne im Wikipediartikel zu <span class="co">[</span><span class="ot">"Exposure" and offset</span><span class="co">](https://en.wikipedia.org/wiki/Poisson_regression#.22Exposure.22_and_offset)</span> oder aber die Antwort <span class="co">[</span><span class="ot">When to use an offset in a Poisson regression?</span><span class="co">](https://stats.stackexchange.com/questions/11182/when-to-use-an-offset-in-a-poisson-regression)</span>.</span>
<span id="cb83-756"><a href="#cb83-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-757"><a href="#cb83-757" aria-hidden="true" tabindex="-1"></a>In <span class="in">`{emmeans}`</span> können wir <span class="co">[</span><span class="ot">Modelle mit Offset</span><span class="co">](https://cran.r-project.org/web/packages/emmeans/vignettes/sophisticated.html#offsets)</span> relativ einfach modellieren. Dazu nutzen wir die Funktion <span class="in">`offset()`</span> in unserem <span class="in">`glm()`</span> Modell. Aber zuerst einmal ein Spieldatensatz. Wir haben wir unseren Faktor Tierart und dann aber noch das Alter als Faktor mit zwei Stufen. Wir haben jetzt aber nicht immer die gleiche Anzahl an Hunden und Katzen sowie Füchsen ausgezählt. Unsere Anzahl an Flöhen basiert also auf einer anderen $n$ Anzahl. Die Anzahl $n$ modellieren wir dann als <span class="in">`offset()`</span>.</span>
<span id="cb83-758"><a href="#cb83-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-761"><a href="#cb83-761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-762"><a href="#cb83-762" aria-hidden="true" tabindex="-1"></a>toy_count_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">n =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1200</span>, <span class="dv">100</span>, <span class="dv">400</span>, <span class="dv">500</span>, <span class="dv">300</span>),</span>
<span id="cb83-763"><a href="#cb83-763" aria-hidden="true" tabindex="-1"></a>                        <span class="at">animal =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"cat"</span>,<span class="st">"dog"</span>,<span class="st">"fox"</span>)),</span>
<span id="cb83-764"><a href="#cb83-764" aria-hidden="true" tabindex="-1"></a>                        <span class="at">age =</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb83-765"><a href="#cb83-765" aria-hidden="true" tabindex="-1"></a>                        <span class="at">count =</span> <span class="fu">c</span>(<span class="dv">42</span>, <span class="dv">37</span>, <span class="dv">1</span>, <span class="dv">101</span>, <span class="dv">73</span>, <span class="dv">14</span>))</span>
<span id="cb83-766"><a href="#cb83-766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-767"><a href="#cb83-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-768"><a href="#cb83-768" aria-hidden="true" tabindex="-1"></a>Wir nehmen die Anzahl an ausgezählten Tieren dann als Offset mit Logarithmus in das Modell. Deshalb steht dann da auch <span class="in">`log(n)`</span> im Offset.</span>
<span id="cb83-769"><a href="#cb83-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-772"><a href="#cb83-772" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-773"><a href="#cb83-773" aria-hidden="true" tabindex="-1"></a>toy_count_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> animal <span class="sc">+</span> age <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(n)), </span>
<span id="cb83-774"><a href="#cb83-774" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> toy_count_tbl, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb83-775"><a href="#cb83-775" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-776"><a href="#cb83-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-777"><a href="#cb83-777" aria-hidden="true" tabindex="-1"></a>Dann können wir uns einmal das Modell anschauen, wie <span class="in">`{emmeans}`</span> den Vergleich rechnen würde.</span>
<span id="cb83-778"><a href="#cb83-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-781"><a href="#cb83-781" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-782"><a href="#cb83-782" aria-hidden="true" tabindex="-1"></a><span class="fu">ref_grid</span>(toy_count_fit)</span>
<span id="cb83-783"><a href="#cb83-783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-784"><a href="#cb83-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-785"><a href="#cb83-785" aria-hidden="true" tabindex="-1"></a>Der Offset ist also grob $log(500) \approx 5.97$. Das stimmt numerisch nicht hundertprozentig, hat aber noch mit einer internen Korrektur zu tun, die uns hier aber nicht weiter interessiert. Das Modell können wir dann wie gewohnt in <span class="in">`emmeans()`</span> stecken und dann weiter rechnen. In dem Modell wird dann berücksichtigt, dass sich die Anzahlen für das *Exposure*, also dem Nenner der Raten, unterscheiden.</span>
<span id="cb83-786"><a href="#cb83-786" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-787"><a href="#cb83-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-788"><a href="#cb83-788" aria-hidden="true" tabindex="-1"></a>Damit sind wir einmal mit unserem Gruppenvergleich für die Poisson Regression auf Zähldaten durch. In dem Kapitel zu den <span class="co">[</span><span class="ot">Multiple Vergleichen oder Post-hoc Tests</span><span class="co">](#sec-posthoc)</span> findest du dann noch mehr Inspirationen für die Nutzung von <span class="in">`{emmeans}`</span>. Hier war es dann die Anwendung auf Zähldaten zusammen mit einem Faktor. Wenn du dir das Ganze nochmal an einem Beispiel für zwei Faktoren anschauen möchtest, dann findest du im folgenden Kasten ein Beispiel für die Auswertung von Thripsen auf Apfelbäumen nach Gabe verschiedener Dosen eines Insektizids und Zeitpunkten.</span>
<span id="cb83-789"><a href="#cb83-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-790"><a href="#cb83-790" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb83-791"><a href="#cb83-791" aria-hidden="true" tabindex="-1"></a><span class="fu">## Anwendungsbeispiel: Zweifaktorieller Gruppenvergleich für Thripsenbefall</span></span>
<span id="cb83-792"><a href="#cb83-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-793"><a href="#cb83-793" aria-hidden="true" tabindex="-1"></a>Im folgenden Beispiel schauen wir uns nochmal ein praktische Auswertung von einem agrarwissenschaftlichen Beispiel mit jungen Apfelbäumen an. Wir haben uns in diesem Experiment verschiedene Dosen <span class="in">`trt`</span> von einem Insektizid aufgebracht sowie verschiedene Startanzahlen von Raubmilben als biologische Alternative untersucht. Dann haben wir noch fünf Zeitpunkte bestimmt, an denen wir die Anzahl an Thripsen auf den Blättern gezählt haben. Wir haben nicht die Blätter per se gezählt sondern Fallen waagerecht aufgestellt. Dann haben wir geschaut, wie viele Thripsen wir über <span class="in">`above`</span> und unter <span class="in">`below`</span> von den Fallen gefunden haben. In unserem Fall beschränken wir uns auf die obere Anzahl an Thripsen und schauen uns auch nur die Behandlung mit dem Insektizid an.</span>
<span id="cb83-794"><a href="#cb83-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-797"><a href="#cb83-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-798"><a href="#cb83-798" aria-hidden="true" tabindex="-1"></a>insects_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/insects_count.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb83-799"><a href="#cb83-799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timepoint =</span> <span class="fu">factor</span>(timepoint, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1 Tag"</span>, <span class="st">"4 Tag"</span>, <span class="st">"7 Tag"</span>, <span class="st">"11 Tag"</span>, <span class="st">"14 Tag"</span>)),</span>
<span id="cb83-800"><a href="#cb83-800" aria-hidden="true" tabindex="-1"></a>         <span class="at">rep =</span> <span class="fu">as_factor</span>(rep),</span>
<span id="cb83-801"><a href="#cb83-801" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt =</span> <span class="fu">as_factor</span>(trt)) <span class="sc">|&gt;</span></span>
<span id="cb83-802"><a href="#cb83-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(timepoint, trt, <span class="at">thripse =</span> thripse_above) <span class="sc">|&gt;</span> </span>
<span id="cb83-803"><a href="#cb83-803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"10ml"</span>, <span class="st">"30ml"</span>, <span class="st">"60ml"</span>))</span>
<span id="cb83-804"><a href="#cb83-804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-805"><a href="#cb83-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-806"><a href="#cb83-806" aria-hidden="true" tabindex="-1"></a>Dann können wir auch schon die Poisson Regression mit <span class="in">`glm()`</span> rechnen. Auch hier wieder darauf achten, dass wir dann als Option <span class="in">`family = poisson`</span> oder <span class="in">`family = quasipoisson`</span> wählen. Es hängt jetzt davon ab, ob du in deinen Daten Overdispersion vorliegen hast oder nicht. In den beiden folgenden Tabs, rechne ich dann mal beide Modelle.</span>
<span id="cb83-807"><a href="#cb83-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-808"><a href="#cb83-808" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb83-809"><a href="#cb83-809" aria-hidden="true" tabindex="-1"></a><span class="fu">## `family = poisson`</span></span>
<span id="cb83-810"><a href="#cb83-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-811"><a href="#cb83-811" aria-hidden="true" tabindex="-1"></a>Als Erstes rechnen wir eine normale Poisson Regression und schauen einmal, ob wir Overdispersion vorliegen haben. Wenn wir Overdispersion vorliegen haben, dann können wir keine Poisson Regression rechnen, sondern müssen auf eine Quasipoisson Regression ausweichen. Das ist aber sehr einfach, wie du im anderen Tab sehen wirst.</span>
<span id="cb83-812"><a href="#cb83-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-815"><a href="#cb83-815" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-816"><a href="#cb83-816" aria-hidden="true" tabindex="-1"></a>insects_poisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(thripse <span class="sc">~</span> trt <span class="sc">+</span> timepoint <span class="sc">+</span> trt<span class="sc">:</span>timepoint, </span>
<span id="cb83-817"><a href="#cb83-817" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> insects_tbl, </span>
<span id="cb83-818"><a href="#cb83-818" aria-hidden="true" tabindex="-1"></a>                           <span class="at">family =</span> poisson) </span>
<span id="cb83-819"><a href="#cb83-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-820"><a href="#cb83-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-821"><a href="#cb83-821" aria-hidden="true" tabindex="-1"></a>Bevor wir uns das Modell mit <span class="in">`summary()`</span> überhaupt anschauen, wollen wir erstmal überprüfen, ob wir überhaupt Overdispersion vorliegen haben. Wenn ja, dann können wir uns die <span class="in">`summary()`</span> hier gleich sparen. Also einmal geguckt, was die Overdispersion macht.</span>
<span id="cb83-822"><a href="#cb83-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-825"><a href="#cb83-825" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-826"><a href="#cb83-826" aria-hidden="true" tabindex="-1"></a>insects_poisson_fit <span class="sc">|&gt;</span> <span class="fu">check_overdispersion</span>()</span>
<span id="cb83-827"><a href="#cb83-827" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-828"><a href="#cb83-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-829"><a href="#cb83-829" aria-hidden="true" tabindex="-1"></a>Wir haben sehr starke Overdispersion vorliegen und gehen daher rüber in den anderen Tab und rechnen eine Quasipoisson Regression. Nur wenn du keine Overdispersion vorliegen hast, dann kannst du eine eine Poisson Regression rechnen.</span>
<span id="cb83-830"><a href="#cb83-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-831"><a href="#cb83-831" aria-hidden="true" tabindex="-1"></a><span class="fu">## `family = quasipoisson`</span></span>
<span id="cb83-832"><a href="#cb83-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-833"><a href="#cb83-833" aria-hidden="true" tabindex="-1"></a>Entweder hast du in deinen Daten eine Overdispersion gefunden oder aber du meinst, es wäre besser gleich eine Quasipoisson zu rechnen. Beides ist vollkommen in Ordnung. Ich rechne meistens immer eine Quasipoisson und schaue dann nur, ob die Overdispersion sehr groß war. In den seltensten Fällen hast du eine Overdispersion vorliegen, die eher klein ist. Daher mache ich erst die Lösung und schaue, ob das Problem dann da war.</span>
<span id="cb83-834"><a href="#cb83-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-837"><a href="#cb83-837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-838"><a href="#cb83-838" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(thripse <span class="sc">~</span> trt <span class="sc">+</span> timepoint <span class="sc">+</span> trt<span class="sc">:</span>timepoint, </span>
<span id="cb83-839"><a href="#cb83-839" aria-hidden="true" tabindex="-1"></a>                                <span class="at">data =</span> insects_tbl, </span>
<span id="cb83-840"><a href="#cb83-840" aria-hidden="true" tabindex="-1"></a>                                <span class="at">family =</span> quasipoisson) </span>
<span id="cb83-841"><a href="#cb83-841" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-842"><a href="#cb83-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-843"><a href="#cb83-843" aria-hidden="true" tabindex="-1"></a>Du kannst in der <span class="in">`summary()`</span> Ausgabe direkt sehen, ob du Overdispersion vorliegen hast. Du musst nur relativ weit unten schauen, was zu dem <span class="in">`Dispersion parameter`</span> in den Klammern geschrieben ist. Wenn da eine Zahl größer als 1 drin steht, dann hast du Overdispersion.</span>
<span id="cb83-844"><a href="#cb83-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-847"><a href="#cb83-847" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-848"><a href="#cb83-848" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb83-849"><a href="#cb83-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span>
<span id="cb83-850"><a href="#cb83-850" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-851"><a href="#cb83-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-852"><a href="#cb83-852" aria-hidden="true" tabindex="-1"></a>Wir haben hier auf jeden Fall Overdispersion vorliegen. Daher nutze ich dann auch das Modell hier mit der Annahme an eine Quasipoissonverteilung. Dann stimmt es auch mit unseren Varianzen und wir produzieren nicht zufällig zu viele signifikante Ergebnisse, die es dann gar nicht gibt.</span>
<span id="cb83-853"><a href="#cb83-853" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-854"><a href="#cb83-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-855"><a href="#cb83-855" aria-hidden="true" tabindex="-1"></a>Ich habe mich gerade in den obigen Tabs für eine Quasipoisson Regression entschieden, da wir Overdispersion vorliegen haben. Damit mache ich dann mit dem <span class="in">`insects_quasipoisson_fit`</span> Modell weiter. In den beiden folgenden Tabs findest du dann einmal das Ergebnis für die ANOVA und einmal für den Gruppenvergleich mit dem R Paket <span class="in">`{emmeans}`</span>. Bitte beachte, dass die ANOVA für ein <span class="in">`glm()`</span>-Objekt nicht ganz gleich wie für ein <span class="in">`lm()`</span>-Objekt ist. Du kannst aber die ANOVA erstmal ganz normal interpretieren, nur haben wir hier nicht die Möglichkeit ein $\eta^2$ zu bestimmen. Dann nutzen wir <span class="in">`{emmeans}`</span> für den Gruppenvergleich. Nochmal, weil wir Overdispersion festgestellt haben, nutzen wir das Objekt <span class="in">`insects_quasipoisson_fit`</span> mit der Berücksichtigung der Overdispersion.</span>
<span id="cb83-856"><a href="#cb83-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-857"><a href="#cb83-857" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb83-858"><a href="#cb83-858" aria-hidden="true" tabindex="-1"></a><span class="fu">## ANOVA mit `anova()`</span></span>
<span id="cb83-859"><a href="#cb83-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-860"><a href="#cb83-860" aria-hidden="true" tabindex="-1"></a>Wir rechnen hier einmal die ANOVA und nutzen den $\mathcal{X}^2$-Test für die Ermittelung der p-Werte. Wir müssen hier einen Test auswählen, da per Standardeinstellung kein Test gerechnet wird. Wir machen dann die Ausageb nochmal schöner und fertig sind wir.</span>
<span id="cb83-861"><a href="#cb83-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-864"><a href="#cb83-864" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-865"><a href="#cb83-865" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb83-866"><a href="#cb83-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>(<span class="at">test =</span> <span class="st">"Chisq"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb83-867"><a href="#cb83-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">drop =</span> <span class="st">"NULL"</span>)</span>
<span id="cb83-868"><a href="#cb83-868" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-869"><a href="#cb83-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-870"><a href="#cb83-870" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass der Effekt für die Behandlung signifikant ist, jedoch die Zeit und die Interaktion keinen signifikanten Einfluss haben. Wir haben aber also keine Interaktion vorliegen. Daher können wir dann die Analyse gemeinsam über alle Zeitpunkte rechnen.</span>
<span id="cb83-871"><a href="#cb83-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-872"><a href="#cb83-872" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gruppenvergleich mit `emmeans()`</span></span>
<span id="cb83-873"><a href="#cb83-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-874"><a href="#cb83-874" aria-hidden="true" tabindex="-1"></a>Im Folgenden rechnen wir einmal über alle Faktorkombinationen von <span class="in">`trt`</span> und <span class="in">`timepoint`</span> einen Gruppenvergleich. Dafür nutzen wir die Opition <span class="in">`trt * timepoint`</span>. Wenn du die Analyse *getrennt* für die Zeitpunkte durchführen willst, dann nutze die Option <span class="in">`trt | timepoint`</span>. Wir wollen die Wahrscheinlichkeiten für das Auftreten einer Beschädigung von wiedergegeben bekommen, deshalb die Option <span class="in">`regrid = "response`</span>. Dann adjustieren wir noch nach Bonferroni und sind fertig.</span>
<span id="cb83-875"><a href="#cb83-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-878"><a href="#cb83-878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-879"><a href="#cb83-879" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> insects_quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb83-880"><a href="#cb83-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt <span class="sc">*</span> timepoint, <span class="at">regrid =</span> <span class="st">"response"</span>) <span class="sc">|&gt;</span></span>
<span id="cb83-881"><a href="#cb83-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb83-882"><a href="#cb83-882" aria-hidden="true" tabindex="-1"></a>emm_obj</span>
<span id="cb83-883"><a href="#cb83-883" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-884"><a href="#cb83-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-885"><a href="#cb83-885" aria-hidden="true" tabindex="-1"></a>Das <span class="in">`emm_obj`</span> Objekt werden wir dann gleich einmal in <span class="in">`{ggplot}`</span> visualisieren. Die <span class="in">`rate`</span> stellt die mittlere Anzahl an Thripsen je Faktorkombination dar. Dann können wir auch das *compact letter display* anhand der Abbildung interpretieren.</span>
<span id="cb83-886"><a href="#cb83-886" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-887"><a href="#cb83-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-888"><a href="#cb83-888" aria-hidden="true" tabindex="-1"></a>In der @fig-log-mod-pois-insect siehst du das Ergebnis der Auswertung in einem Säulendiagramm. Hier unbedingt <span class="in">`SE`</span> als den Standardfehler für die Fehlerbalken nutzen, da wir sonst Fehlerbalken größer und kleiner als $0$ erhalten, wenn wir die Standardabweichung nutzen würden. Das ist in unserem Fall nicht so das Problem, aber wenn du eher kleine Anzahlen zählst, kann das schnell zu Werten kleiner Null führen. Wir sehen einen klaren Effekt der Behandlung <span class="in">`60ml`</span>. Die Zeit hat keinen Effekt, was ja schon aus der ANOVA klar war, die Säulen sehen für jeden Zeitpunkt vollkommen gleich aus. Gut etwas Unterschied ist ja immer.</span>
<span id="cb83-889"><a href="#cb83-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-892"><a href="#cb83-892" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-893"><a href="#cb83-893" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb83-894"><a href="#cb83-894" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb83-895"><a href="#cb83-895" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb83-896"><a href="#cb83-896" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-log-mod-pois-insect</span></span>
<span id="cb83-897"><a href="#cb83-897" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb83-898"><a href="#cb83-898" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb83-899"><a href="#cb83-899" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb83-900"><a href="#cb83-900" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Säulendigramm der mitleren Zahl der Thripsen aus einer Poisson Regression. Das `glm()`-Modell berechnet die mittlere Anzahl in jeder Faktorkombination. Das *compact letter display* wird dann in `{emmeans}` generiert."</span></span>
<span id="cb83-901"><a href="#cb83-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-902"><a href="#cb83-902" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb83-903"><a href="#cb83-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb83-904"><a href="#cb83-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> timepoint, <span class="at">y =</span> rate, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb83-905"><a href="#cb83-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb83-906"><a href="#cb83-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mittlere Anzahl an Thripsen"</span>, <span class="at">x =</span> <span class="st">"Messzeitpunkte der Zählungen"</span>,</span>
<span id="cb83-907"><a href="#cb83-907" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Dosis"</span>) <span class="sc">+</span></span>
<span id="cb83-908"><a href="#cb83-908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb83-909"><a href="#cb83-909" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb83-910"><a href="#cb83-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> rate <span class="sc">+</span> SE <span class="sc">+</span> <span class="fl">0.01</span>),  </span>
<span id="cb83-911"><a href="#cb83-911" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb83-912"><a href="#cb83-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> rate<span class="sc">-</span>SE, <span class="at">ymax =</span> rate<span class="sc">+</span>SE),</span>
<span id="cb83-913"><a href="#cb83-913" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb83-914"><a href="#cb83-914" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb83-915"><a href="#cb83-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb83-916"><a href="#cb83-916" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-917"><a href="#cb83-917" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb83-918"><a href="#cb83-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-919"><a href="#cb83-919" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-poisson.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-poisson.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
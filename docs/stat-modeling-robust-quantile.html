<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>62&nbsp; Robuste und Quantilesregression – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-modeling-survival.html" rel="next">
<link href="./stat-modeling-non-linear.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="62&nbsp; Robuste und Quantilesregression – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-modeling-preface.html">Statistisches Modellieren</a></li><li class="breadcrumb-item"><a href="./stat-modeling-robust-quantile.html"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">62.1</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">62.2</span> Daten</a></li>
  <li><a href="#gewöhnliche-lineare-regression" id="toc-gewöhnliche-lineare-regression" class="nav-link" data-scroll-target="#gewöhnliche-lineare-regression"><span class="header-section-number">62.3</span> Gewöhnliche lineare Regression</a>
  <ul class="collapse">
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova"><span class="header-section-number">62.3.1</span> ANOVA</a></li>
  <li><a href="#gruppenvergleich" id="toc-gruppenvergleich" class="nav-link" data-scroll-target="#gruppenvergleich"><span class="header-section-number">62.3.2</span> Gruppenvergleich</a></li>
  </ul></li>
  <li><a href="#sec-robust-reg" id="toc-sec-robust-reg" class="nav-link" data-scroll-target="#sec-robust-reg"><span class="header-section-number">62.4</span> Robuste Regression</a>
  <ul class="collapse">
  <li><a href="#anova-1" id="toc-anova-1" class="nav-link" data-scroll-target="#anova-1"><span class="header-section-number">62.4.1</span> ANOVA</a></li>
  <li><a href="#gruppenvergleich-1" id="toc-gruppenvergleich-1" class="nav-link" data-scroll-target="#gruppenvergleich-1"><span class="header-section-number">62.4.2</span> Gruppenvergleich</a></li>
  </ul></li>
  <li><a href="#sec-quantile-reg" id="toc-sec-quantile-reg" class="nav-link" data-scroll-target="#sec-quantile-reg"><span class="header-section-number">62.5</span> Quantilsregression</a>
  <ul class="collapse">
  <li><a href="#anova-2" id="toc-anova-2" class="nav-link" data-scroll-target="#anova-2"><span class="header-section-number">62.5.1</span> ANOVA</a></li>
  <li><a href="#gruppenvergleich-2" id="toc-gruppenvergleich-2" class="nav-link" data-scroll-target="#gruppenvergleich-2"><span class="header-section-number">62.5.2</span> Gruppenvergleich</a></li>
  </ul></li>
  <li><a href="#modellvergleich" id="toc-modellvergleich" class="nav-link" data-scroll-target="#modellvergleich"><span class="header-section-number">62.6</span> Modellvergleich</a>
  <ul class="collapse">
  <li><a href="#basilikumdaten" id="toc-basilikumdaten" class="nav-link" data-scroll-target="#basilikumdaten"><span class="header-section-number">62.6.1</span> Basilikumdaten</a></li>
  <li><a href="#gurkendaten" id="toc-gurkendaten" class="nav-link" data-scroll-target="#gurkendaten"><span class="header-section-number">62.6.2</span> Gurkendaten</a></li>
  </ul></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-robust-quantile.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-robust-quantile.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-modeling-preface.html">Statistisches Modellieren</a></li><li class="breadcrumb-item"><a href="./stat-modeling-robust-quantile.html"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-reg-quantile" class="quarto-section-identifier"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 24. March 2024 um 20:26:49</em></p>
<blockquote class="blockquote">
<p><em>“Methods for robust statistics, a state of the art in the early 2000s, notably for robust regression and robust multivariate analysis.” — <a href="https://cran.r-project.org/web/packages/robust/index.html">robust: Port of the S+ “Robust Library”</a></em></p>
</blockquote>
<p>In diesem Kapitel geht es um zwei Arten der Regression, die immer wieder genannt werden, aber dennoch eine Art Nischendasein fristen. Zum einen möchte ich hier die robuste Regression (eng. <em>robust regression</em>) und zum anderen die Quantilsregression (eng. <em>quantile regression</em>) vorstellen. Die robuste Regression ist faktisch statistisch tot. Das heißt, die Implementierungen werden kaum weiterentwickelt und auch findet methodische Forschung nur in der theoretischen Nische statt. Zwar wird die robuste Regression in ihrer ursprünglichen Form als Regression angewendet, aber das reicht meistens nicht. Selten wollen wir nur durch ein paar Punkte eine Gerade ziehen und uns über das gute Modell erfreuen. Wir haben mit dem Modell meist mehr vor. Wir wollen eine ANOVA rechnen und dann auch einen wie auch immer gearteten Mittelwertsvergleich. Wenn dies zwar theoretisch möglich ist, praktisch aber nicht implementiert, dann wollen und können wir die Methoden nur eingeschränkt verwenden. Bei der Quantilsregression sieht es etwas anders aus, hier können wir dann schon den ein oder anderen Mittelwertsvergleich rechnen. Was bei der Quantilsregression eher problematisch ist, ist das das Modell nicht immer konvergiert oder aber nicht algorithmisch eine Lösung für einen spezifischen Datensatz findet. In diesem Datensatz dann den einen Grund zu finden, ist dann meist so aufwendig, dass wir es auch gleich mit der Quantilsregression lassen können.</p>
<p>Der Charme der Quantilesregression ist ja am Ende, dass wir auch den Median als Quantile auswählen können. So haben wir dann die Möglichkeit eine Regression auf den Medianen zu rechnen. Wir vergleichen damit dann auch die Mediane und sind so nicht mehr auf die Normalverteilung unseres Outcomes wie in der gewöhnlichen Regression angewiesen. Also eigentlich eine tolle Sache, wenn wir nur an den Mittelwertsvergleichen interessiert sind. Eine klassische ANOVA geht leider nicht auf einer Medianregression. Eine klassische ANOVA wäre aber mit nicht parametrischen Methoden sowieso nicht möglich gewesen. Wir verlieren also nicht so viel, gewinnen aber etwas, wenn das Modell konvergiert und ein Ergebnis liefert.</p>
<p>In diesem Kapitel brechen wir etwas die bisherige Struktur der Regressionskapitel auf. Wir schauen uns hier zuerst die beiden Modelle an und entscheiden dann, ob wir die Modelle für die ANOVA oder den Gruppenvergleich <em>überhaupt</em> nutzen können. Am Ende vergleichen wir dann einmal alle Modell mit dem fantastische Paket <code>{modelsummary}</code> mit der gleichnamigen Funktion. Hier hilft dann wie immer die tolle <a href="https://vincentarelbundock.github.io/modelsummary/articles/modelsummary.html">Hilfsseite von modelsummary</a> zu besuchen.</p>
<section id="genutzte-r-pakete" class="level2" data-number="62.1">
<h2 data-number="62.1" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">62.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, conflicted, broom, quantreg,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               see, performance, emmeans, multcomp, janitor,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               parameters, effectsize, MASS, modelsummary,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               robustbase, multcompView, conflicted)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2 page-columns page-full" data-number="62.2">
<h2 data-number="62.2" class="anchored" data-anchor-id="daten"><span class="header-section-number">62.2</span> Daten</h2>
<p>Für unser erstes Beispiel nutzen wir die Daten aus einem Wachstumsversuch mit Basilikum mit vier Bodenbehandlungen und vier Blöcken, die Blöcke sind eigentlich Gewächshaustische. Wir wollen also einen klassischen Gruppenvergleich mit Berücksichtigung der Blockstruktur rechnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>basi_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/keimversuch_basilikum_block.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">versuchsgruppe =</span> <span class="fu">as_factor</span>(versuchsgruppe)) <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(versuchsgruppe, block_1<span class="sc">:</span>block_4)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In <a href="#tbl-model-1" class="quarto-xref">Tabelle&nbsp;<span>62.1</span></a> sehen wir einmal die Daten im Wide-Format. Wir haben also das Frischgewicht der Basilikumpflanzen gemessen und wollen wissen, ob die verschiedenen Bodenarten einen Einfluss auf das Wachstum haben.</p>
<div class="cell">
<div id="tbl-model-1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;62.1— Datensatz des Frischegewichts von Basilikumpflanzen auf vier Tischen bzw. Blöcken in vier Versuchsgruppen.
</figcaption>
<div aria-describedby="tbl-model-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">versuchsgruppe</th>
<th style="text-align: center;">block_1</th>
<th style="text-align: center;">block_2</th>
<th style="text-align: center;">block_3</th>
<th style="text-align: center;">block_4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Erde</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">23</td>
<td style="text-align: center;">23</td>
</tr>
<tr class="even">
<td style="text-align: center;">Erde</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">19</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Erde</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">23</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="even">
<td style="text-align: center;">Erde</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">21</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Erde</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="even">
<td style="text-align: center;">Erde+Fließ</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">21</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">Erde+Perlite</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">25</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Perlite+Fließ</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">24</td>
</tr>
<tr class="even">
<td style="text-align: center;">Perlite+Fließ</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">26</td>
<td style="text-align: center;">26</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Perlite+Fließ</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">19</td>
<td style="text-align: center;">19</td>
<td style="text-align: center;">19</td>
</tr>
<tr class="even">
<td style="text-align: center;">Perlite+Fließ</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">22</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Perlite+Fließ</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">22</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Da wir die Daten im Wide-Format vorliegen haben, müssen wir die Daten nochmal in Long-Format umwandeln. Wie immer nutzen wir dafür die Funktion <code>pivot_longer()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>basi_block_tbl <span class="ot">&lt;-</span> basi_tbl <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> block_1<span class="sc">:</span>block_4,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"weight"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"block"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">block =</span> <span class="fu">as_factor</span>(block))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#fig-robust-basi-00" class="quarto-xref">Abbildung&nbsp;<span>62.1</span></a> siehst du einmal die Daten als Dotplots mit Mittelwert und Standardabweichung. Wir machen hier mal einen etwas komplizierteren Plot, aber immer nur Barplot ist ja auch langweilig.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(basi_block_tbl, <span class="fu">aes</span>(versuchsgruppe, weight, <span class="at">color =</span> block)) <span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>), <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data=</span><span class="st">"mean_sdl"</span>, <span class="at">fun.args =</span> <span class="fu">list</span>(<span class="at">mult =</span> <span class="dv">1</span>), </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom=</span><span class="st">"pointrange"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>))  <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">fun.min =</span> <span class="st">"min"</span>, <span class="at">fun.max =</span> <span class="st">"max"</span>, <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-robust-basi-00" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-robust-basi-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-robust-quantile_files/figure-html/fig-robust-basi-00-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Abbildung&nbsp;62.1— Dotplot des Frischegewichts von Basilikumpflanzen auf vier Tischen bzw. Blöcken in vier Versuchsgruppen mit Mittelwert und Standardabweichung."><img src="stat-modeling-robust-quantile_files/figure-html/fig-robust-basi-00-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-robust-basi-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;62.1— Dotplot des Frischegewichts von Basilikumpflanzen auf vier Tischen bzw. Blöcken in vier Versuchsgruppen mit Mittelwert und Standardabweichung.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Unser zweiter Datensatz ist ein Anwendungsdatensatz aus dem Gemüsebau. Wir schauen uns das Wachstum von drei Gurkensorten über siebzehn Wochen an. Die Gurkensorten sind hier unsere Versuchsgruppen. Da wir es hier mit echten Daten zu tun haben, müssen wir uns etwas strecken damit die Daten dann auch passen. Wir wollen das Wachstum der drei Gurkensorten <em>über</em> die Zeit betrachten - also faktisch den Verlauf des Wachstums. Wir ignorieren hier einmal die abhängige Datenstruktur über die Zeitpunkte.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Mit einer abhängigen Datenstruktur müssten wir eigentlich ein lineares gemischtes Modell rechnen. Aber wir nutzen hier die Daten einmal anders.</p>
</div></div><p>Im Weiteren haben wir zwei Typen von Daten für das Gurkenwachstum. Einmal messen wir den Durchmesser für jede Sorte (<code>D</code> im Namen der Versuchsgruppe) oder aber die Länge (<code>L</code> im Namen der Versuchsgruppe). Wir betrachten hier nur das Längenwachstum und deshalb filtern wir erstmal nach allen Versuchsgruppen mit einem <code>L</code> im Namen. Am Ende schmeißen wir noch Spalten raus, die wir nicht weiter brauchen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>gurke_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/wachstum_gurke.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(versuchsgruppe, <span class="st">"L$"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>pfl, <span class="sc">-</span>erntegewicht) <span class="sc">|&gt;</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">versuchsgruppe =</span> <span class="fu">factor</span>(versuchsgruppe, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Katrina"</span>, <span class="st">"Proloog"</span>, <span class="st">"Quarto"</span>))) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#tbl-model-2" class="quarto-xref">Tabelle&nbsp;<span>62.2</span></a> sehen wir einmal die rohen Daten dargestellt.</p>
<div class="cell">
<div id="tbl-model-2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;62.2— Datensatz zu dem Längen- und Dickenwachstum von Gurken.
</figcaption>
<div aria-describedby="tbl-model-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">versuchsgruppe</th>
<th style="text-align: center;">t1</th>
<th style="text-align: center;">t2</th>
<th style="text-align: center;">t3</th>
<th style="text-align: center;">t4</th>
<th style="text-align: center;">t5</th>
<th style="text-align: center;">t6</th>
<th style="text-align: center;">t7</th>
<th style="text-align: center;">t8</th>
<th style="text-align: center;">t9</th>
<th style="text-align: center;">t10</th>
<th style="text-align: center;">t11</th>
<th style="text-align: center;">t12</th>
<th style="text-align: center;">t13</th>
<th style="text-align: center;">t14</th>
<th style="text-align: center;">t15</th>
<th style="text-align: center;">t16</th>
<th style="text-align: center;">t17</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Proloog</td>
<td style="text-align: center;">5.5</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">7.4</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">9.9</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">14.4</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">19.8</td>
<td style="text-align: center;">21.2</td>
<td style="text-align: center;">23.2</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">29.7</td>
<td style="text-align: center;">32.8</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
<tr class="even">
<td style="text-align: center;">Proloog</td>
<td style="text-align: center;">4.6</td>
<td style="text-align: center;">5.1</td>
<td style="text-align: center;">6.4</td>
<td style="text-align: center;">5.7</td>
<td style="text-align: center;">5.5</td>
<td style="text-align: center;">5.2</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">4.5</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Proloog</td>
<td style="text-align: center;">5.3</td>
<td style="text-align: center;">5.8</td>
<td style="text-align: center;">6.8</td>
<td style="text-align: center;">8.3</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">12.3</td>
<td style="text-align: center;">14.6</td>
<td style="text-align: center;">17.6</td>
<td style="text-align: center;">19.3</td>
<td style="text-align: center;">23.1</td>
<td style="text-align: center;">23.8</td>
<td style="text-align: center;">31.7</td>
<td style="text-align: center;">32.3</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
<tr class="even">
<td style="text-align: center;">Proloog</td>
<td style="text-align: center;">5.4</td>
<td style="text-align: center;">5.7</td>
<td style="text-align: center;">6.9</td>
<td style="text-align: center;">8.2</td>
<td style="text-align: center;">8.6</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">12.1</td>
<td style="text-align: center;">14.5</td>
<td style="text-align: center;">16.2</td>
<td style="text-align: center;">17.1</td>
<td style="text-align: center;">19.3</td>
<td style="text-align: center;">21.6</td>
<td style="text-align: center;">28.5</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Proloog</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">5.5</td>
<td style="text-align: center;">6.3</td>
<td style="text-align: center;">7.5</td>
<td style="text-align: center;">8.3</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">12.2</td>
<td style="text-align: center;">14.4</td>
<td style="text-align: center;">16.5</td>
<td style="text-align: center;">19.9</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">22.9</td>
<td style="text-align: center;">30.4</td>
<td style="text-align: center;">31</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
<tr class="even">
<td style="text-align: center;">Proloog</td>
<td style="text-align: center;">4.2</td>
<td style="text-align: center;">4.6</td>
<td style="text-align: center;">5.4</td>
<td style="text-align: center;">5.5</td>
<td style="text-align: center;">5.2</td>
<td style="text-align: center;">5.3</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">6.5</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">9.3</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">12.5</td>
<td style="text-align: center;">22.3</td>
<td style="text-align: center;">24.2</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">Katrina</td>
<td style="text-align: center;">3.7</td>
<td style="text-align: center;">3.9</td>
<td style="text-align: center;">3.9</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4.7</td>
<td style="text-align: center;">5.2</td>
<td style="text-align: center;">5.4</td>
<td style="text-align: center;">5.3</td>
<td style="text-align: center;">5.4</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Katrina</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">3.3</td>
<td style="text-align: center;">3.5</td>
<td style="text-align: center;">3.6</td>
<td style="text-align: center;">4.4</td>
<td style="text-align: center;">5.2</td>
<td style="text-align: center;">5.8</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">6.2</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">6.2</td>
<td style="text-align: center;">6.8</td>
<td style="text-align: center;">7.9</td>
<td style="text-align: center;">9.4</td>
<td style="text-align: center;">10.4</td>
<td style="text-align: center;">13.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">Katrina</td>
<td style="text-align: center;">3.3</td>
<td style="text-align: center;">3.3</td>
<td style="text-align: center;">3.4</td>
<td style="text-align: center;">3.6</td>
<td style="text-align: center;">3.5</td>
<td style="text-align: center;">3.5</td>
<td style="text-align: center;">3.4</td>
<td style="text-align: center;">3.7</td>
<td style="text-align: center;">3.5</td>
<td style="text-align: center;">3.6</td>
<td style="text-align: center;">3.6</td>
<td style="text-align: center;">3.6</td>
<td style="text-align: center;">2.8</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Katrina</td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">3.4</td>
<td style="text-align: center;">3.7</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4.5</td>
<td style="text-align: center;">5.9</td>
<td style="text-align: center;">6.9</td>
<td style="text-align: center;">8.4</td>
<td style="text-align: center;">9.4</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">12.2</td>
<td style="text-align: center;">13.5</td>
<td style="text-align: center;">17.9</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
<tr class="even">
<td style="text-align: center;">Katrina</td>
<td style="text-align: center;">3.3</td>
<td style="text-align: center;">3.4</td>
<td style="text-align: center;">3.9</td>
<td style="text-align: center;">4.6</td>
<td style="text-align: center;">5.2</td>
<td style="text-align: center;">6.5</td>
<td style="text-align: center;">7.9</td>
<td style="text-align: center;">9.5</td>
<td style="text-align: center;">10.5</td>
<td style="text-align: center;">11.7</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">13.4</td>
<td style="text-align: center;">17.9</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Katrina</td>
<td style="text-align: center;">3.1</td>
<td style="text-align: center;">3.6</td>
<td style="text-align: center;">3.6</td>
<td style="text-align: center;">3.8</td>
<td style="text-align: center;">4.2</td>
<td style="text-align: center;">4.9</td>
<td style="text-align: center;">5.7</td>
<td style="text-align: center;">6.8</td>
<td style="text-align: center;">7.7</td>
<td style="text-align: center;">9.1</td>
<td style="text-align: center;">10.7</td>
<td style="text-align: center;">12.3</td>
<td style="text-align: center;">17.7</td>
<td style="text-align: center;">18.6</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Dann müssen wir die Daten noch in Long-Format bringen. Da wir dann auch noch auf zwei Arten die Daten über die Zeit darstellen wollen, brauchen wir einmal die Zeit als Faktor <code>time_fct</code> und einmal als numerisch <code>time_num</code>. Leider haben wir auch Gurken mit einer Länge von 0 cm, diese Gruken lassen wir jetzt mal drin, da wir ja eine robuste Regression noch rechnen wollen. Auch haben wir ab Woche 14 keine Messungen mehr in der Versuchsgruppe <code>Prolong</code>, also nehmen wir auch nur die Daten bis zur vierzehnten Woche.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>gurke_time_len_tbl <span class="ot">&lt;-</span> gurke_raw_tbl <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t17,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"length"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_fct =</span> <span class="fu">as_factor</span>(time),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_num =</span> <span class="fu">as.numeric</span>(time_fct)) <span class="sc">|&gt;</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time_num <span class="sc">&lt;=</span> <span class="dv">14</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#fig-robust-gurke-00" class="quarto-xref">Abbildung&nbsp;<span>62.2</span></a> sehen wir dann nochmal den Scatterplot für das Gurkenwachstum. Die gestrichtelten Linien stellen den Median und die durchgezogene Line den Mittelwert der Gruppen dar.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gurke_time_len_tbl, <span class="fu">aes</span>(time_num, length, <span class="at">color =</span> versuchsgruppe)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"median"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-robust-gurke-00" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-robust-gurke-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-robust-quantile_files/figure-html/fig-robust-gurke-00-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;62.2— Scatterplot des Längenwachstums der drei Gurkensorten über vierzehn Wochen. Die gestrichtelten Linien stellen den Median und die durchgezogene Line den Mittelwert der Gruppen dar."><img src="stat-modeling-robust-quantile_files/figure-html/fig-robust-gurke-00-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-robust-gurke-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;62.2— Scatterplot des Längenwachstums der drei Gurkensorten über vierzehn Wochen. Die gestrichtelten Linien stellen den Median und die durchgezogene Line den Mittelwert der Gruppen dar.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="gewöhnliche-lineare-regression" class="level2" data-number="62.3">
<h2 data-number="62.3" class="anchored" data-anchor-id="gewöhnliche-lineare-regression"><span class="header-section-number">62.3</span> Gewöhnliche lineare Regression</h2>
<p>Damit wir einen Vergleich zu der robusten Regression und der Quantilsregression haben wollen wir hier zu Anfang nochmal schnell die gewöhnliche Regression (eng. <em>ordinary linear regression</em>), die du schon durch die Funktion <code>lm()</code> kennst. Wir fitten also einmal das Modell mit Interaktionsterm für den Basilikumdatensatz.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>basi_lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="anova" class="level3" data-number="62.3.1">
<h3 data-number="62.3.1" class="anchored" data-anchor-id="anova"><span class="header-section-number">62.3.1</span> ANOVA</h3>
<p>Dann schauen wir uns nochmal den Interaktionsplot in <a href="#fig-stat-robust" class="quarto-xref">Abbildung&nbsp;<span>62.3</span></a> mit der Funktion <code>emmip()</code> aus dem R Paket <code>{emmeans}</code> an. Wir sehen, das wir eventuell eine leichte Interaktion vorliegen haben könnten, da sich einige der Geraden überschneiden.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmip</span>(basi_lm_fit, versuchsgruppe <span class="sc">~</span> block, <span class="at">CIs =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">cov.reduce =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-stat-robust" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stat-robust-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-robust-quantile_files/figure-html/fig-stat-robust-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;62.3— Interaktionsplot über die Versuchsgruppen und Blöcke."><img src="stat-modeling-robust-quantile_files/figure-html/fig-stat-robust-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stat-robust-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;62.3— Interaktionsplot über die Versuchsgruppen und Blöcke.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Schauen wir einmal in eine zweifaktorielle ANOVA, ob sich unser leichter Verdacht validieren lässt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>basi_lm_fit <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter            | Sum_Squares | df | Mean_Square |     F |      p
----------------------------------------------------------------------
versuchsgruppe       |      158.84 |  3 |       52.95 |  6.53 | &lt; .001
block                |      355.34 |  3 |      118.45 | 14.60 | &lt; .001
versuchsgruppe:block |       83.51 |  9 |        9.28 |  1.14 | 0.346 
Residuals            |      519.20 | 64 |        8.11 |       |       

Anova Table (Type 1 tests)</code></pre>
</div>
</div>
<p>Wir sehen, dass wir mindestens einen paarweisen Unterschied zwischen den Versuchsgruppen und den Blöcken erwarten. Die Interaktion ist nicht signifikant. Betrachten wir noch kurz das <span class="math inline">\(\eta^2\)</span> um zu sehen, wie viel Varianz jeweils die Versuchsgruppe und Blöcke erklären.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>basi_lm_fit <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter            | Eta2 (partial) |       95% CI
----------------------------------------------------
versuchsgruppe       |           0.23 | [0.08, 1.00]
block                |           0.41 | [0.24, 1.00]
versuchsgruppe:block |           0.14 | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>Leider erklären hier die Blöcke sehr viel der Varianz, das ist nicht so schön, aber in diesem Kapitel lassen wir es dabei.</p>
</section>
<section id="gruppenvergleich" class="level3" data-number="62.3.2">
<h3 data-number="62.3.2" class="anchored" data-anchor-id="gruppenvergleich"><span class="header-section-number">62.3.2</span> Gruppenvergleich</h3>
<p>Wir haben keine Interaktion vorliegen, alos mitteln wir einmal über alle Blöcke. Wenn du den Code <code>| block</code> zu dem Aufruf der <code>emmeans()</code> Funktion hinzufügst, dann hast du die Analyse für die Blöcke getrennt durchgeführt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>basi_lm_fit <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> <span class="sc">~</span> versuchsgruppe) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> versuchsgruppe emmean    SE df lower.CL upper.CL .group
 Erde+Fließ       19.4 0.637 64     18.1     20.7  a    
 Erde             19.8 0.637 64     18.5     21.0  a    
 Perlite+Fließ    22.1 0.637 64     20.8     23.3   b   
 Erde+Perlite     22.6 0.637 64     21.4     23.9   b   

Results are averaged over the levels of: block 
Confidence level used: 0.95 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Wenn wir uns die unadjustierten <span class="math inline">\(p\)</span>-Werte anschauen, dann sehen wir einen leichten Effekt zwischen den einzelnen Versuchsgruppen. Warum sage ich leichten Effekt? Die Mittelwerte der Gruppen in der spalte <code>emmean</code> unterscheiden sich kaum. Aber soviel zu der gewöhnlichen Regression, das war ja hier nur der Vergleich und die Erinnerung.</p>
</section>
</section>
<section id="sec-robust-reg" class="level2 page-columns page-full" data-number="62.4">
<h2 data-number="62.4" class="anchored" data-anchor-id="sec-robust-reg"><span class="header-section-number">62.4</span> Robuste Regression</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nur Normalverteilung? Geht auch mehr?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nein es geht auch mit allen anderen Modellen. So ist auch das <code>glm()</code> für die robuste Regression implementiert. Wir schauen uns aber nur die Grundlagen für die klassische robuste Regression unter der Annahme eines nromalverteilten Outcomes an.</p>
</div>
</div>
<p>Bei einer robusten Regression werden jeder Beobachtung auf der Grundlage ihres Residuums unterschiedliche Gewichte (eng. <em>robustness weights</em>) von 0 bis 1 zugewiesen. Wir kennen ja ein Residuum als die Differenz zwischen den beobachteten und den vorhergesagten Werten der Daten. Die vorhergesagten Daten sind ja die Punkte auf der Geraden. Je kleiner also das Residuum ist, desto größer ist die Gewichtung und desto näher liegt eine Beobachtung an der geschätzten Geraden. Wir bestrafen also Punkte, die weit weg von unserer potenziellen Gerade liegen.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Ein englisches Tutorium gibt es dann nochmal ausführlicher unter <a href="https://yuzar-blog.netlify.app/posts/2022-09-02-robustregression/">R demo | Robust Regression (don’t depend on influential data!)</a></p>
<p>Ebenso liefert auch das Tutorium <a href="https://stats.oarc.ucla.edu/r/dae/robust-regression/">Robust regression | R data analysis example</a> einen Überblick.</p>
</div></div><p>Schauen wir uns das Problem an einem kleinen Spieldatensatz einmal an, den es so in vielen Geschmacksrichtungen gibt. Wir haben acht Beobachtungen mit jeweils einem <span class="math inline">\(x\)</span> und einem <span class="math inline">\(y\)</span> Wert in unserem Datensatz <code>reg_tbl</code>. Wie folgt einmal dargestellt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>reg_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>),</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.4</span>, <span class="fl">2.5</span>, <span class="fl">2.7</span>, <span class="fl">4.3</span>, <span class="fl">5.2</span>, <span class="dv">0</span>, <span class="fl">6.7</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir rechnen jetzt einmal eine gewöhnliche lineare Regression mit der Funktion <code>lm()</code> und eine robuste Regression mit dem Paket <code>{MASS}</code> und der Funtkion <code>rlm()</code>. Es gibt noch das R Paket <code>{robustbase}</code> und der Funktion <code>rq()</code> aber wir können die Ergebnisse dann nicht in <code>{emmeans}</code> weiter nutzen, was uns dann etwas den Weg mit versperrt. Wir können aber für die multiplen Mittelwertsvergleich mit <code>{robustbase}</code> das R Paket <code>{multcomp}</code> nutzen. Aber fangen wir hier erstmal mit dem Beispiel an und vergleichen die beiden Implementierungen der robusten Regression zu der gewöhnlichen Regression</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>reg_lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, reg_tbl)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>reg_rlm_fit <span class="ot">&lt;-</span> <span class="fu">rlm</span>(y <span class="sc">~</span> x, reg_tbl)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>reg_lmrob_fit <span class="ot">&lt;-</span> <span class="fu">lmrob</span>(y <span class="sc">~</span> x, reg_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#fig-stat-robust-demo" class="quarto-xref">Abbildung&nbsp;<span>62.4</span></a> sehen wir einmal den Unterschied zwischen den beiden robusten Regressionen und der gewöhnlichen Regression.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(reg_tbl, <span class="fu">aes</span>(x, y, <span class="at">label =</span> x)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(reg_lm_fit), <span class="at">colour =</span> <span class="st">"lm"</span>)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(reg_rlm_fit), <span class="at">colour =</span> <span class="st">"rlm"</span>)) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(reg_lmrob_fit), <span class="at">colour =</span> <span class="st">"lmrob"</span>)) <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_okabeito</span>() <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">"Method"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-stat-robust-demo" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stat-robust-demo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-robust-quantile_files/figure-html/fig-stat-robust-demo-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;62.4— Scatterplot für den Unterschied zwischen einer robusten und gewöhnlichen Regression. Die gewöhnliche Regression ist gelb, die robuste Regression MASS::rlm() grün und die robuste Regression robustbase::lmrob() blau."><img src="stat-modeling-robust-quantile_files/figure-html/fig-stat-robust-demo-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stat-robust-demo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;62.4— Scatterplot für den Unterschied zwischen einer robusten und gewöhnlichen Regression. Die gewöhnliche Regression ist gelb, die robuste Regression MASS::rlm() grün und die robuste Regression robustbase::lmrob() blau.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In unserem Beispiel ist die sechste Beobachtung der Ausreißer. Die <code>lm</code>-Regression wird durch den Wert 0 der sechsten Beobachtung nach unten gezogen. Die sechste Beobachtung erhält ein viel zu starkes Gewicht in der gewöhnlichen Regression im Bezug auf den Verlauf der Geraden. Die robusten Regressionen geben der sechsten Beobachtung hingegen ein viel geringeres Gewicht, so dass die Beobachtung keinen Einfluss auf den Verlauf der Geraden hat. In einer robusten Regression erhält eine Beobachtung mit einem großen Residuum sehr wenig Gewicht, in diesem konstruierten Beispiel fast 0. Daher können wir sagen, das unser Modell <em>robust</em> gegen Ausreißer ist.</p>
<p>Okay, soweit lernt es jeder und die Idee der robusten Regression ist auch ziemlich einleuchtend. Aber in der Wissenschaft zeichnen wir keine Gerade durch Punkte und freuen uns drüber, dass die eine gerade besser passt als die andere Gerade. Wir nutzen dann ja das Modell weiter in eine ANOVA oder aber eben in einem paarweisen Gruppenvergleich. Und hier fangen dann die Probleme der <em>Implementierung</em> an. Leider ist es so, dass nicht alle Funktionalitäten implementiert sind. Das heißt, die Funktion <code>anova()</code> oder <code>emmeans()</code> kann mit der Ausgabe der robusten Regressionen mit <code>MASS::rlm()</code> und <code>robustbase::lmrob()</code> nichts anfangen. Das ist problematisch und nicht anwenderfreundlich. Und wir sind hier nunmal Anwender…</p>
<p>Warum so unbeliebt? Das ist eine gute Frage. Zu der robusten Regression gibt es eine lange Geschichte mit vielen Wirrungen und Irrungen. Am Ende kannst du in Wikipedia noch etwas zur <a href="https://en.wikipedia.org/wiki/Robust_regression#History_and_unpopularity_of_robust_regression">History and unpopularity of robust regression</a> nachlesen. Nach <span class="citation" data-cites="stromberg2004write">Stromberg (<a href="#ref-stromberg2004write" role="doc-biblioref">2004</a>)</span> hat es auch etwas mit der schlechten und mangelhaften Implementierung in gängiger Statistiksoftware zu tun. Das merke ich hier auch gerade, als ich versuche die Funktionen zusammen zubauen und miteinander zu vernetzen. Sicherlich gibt es auch die biologische Diskussion. Gibt es in biologischen Daten eigentlich überhaupt Ausreißer? Oder müssten wir nicht Ausreißer besonders betrachten, weil die Ausreißer dann doch mehr über die Daten verraten? Macht es also Sinn die Ausreißer einfach platt zu bügeln und nicht mehr weiter zu beachten oder ist nicht die Beobachtung Nr.6 oben von Interesse? Denn vielleicht ist was mit dem Experiment schief gelaufen und diese Beobachtung ist gerade ein Anzeichen dafür. Dann müssten auch die anderen Messwerte kritisch hinterfragt werden.</p>
<p>Wie immer es auch sein. Wir fitten jetzt mal die beiden robusten Regression in der Standardausstattung mit der Funktion <code>MASS::rlm()</code> aus dem Paket <code>{MASS}</code> wie folgt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>basi_rlm_fit <span class="ot">&lt;-</span> <span class="fu">rlm</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann natürlich noch die Funktion <code>robustbase::lmrob()</code> aus dem Paket <code>{robustbase}</code>. Hinter dem Paket <code>{robusbase}</code> steht ein ganzen Buch von <span class="citation" data-cites="maronna2019robust">Maronna u.&nbsp;a. (<a href="#ref-maronna2019robust" role="doc-biblioref">2019</a>)</span>, aber leider keine gute Internetseite mit Beispielen und Anwendungen in R, wie es eigentlich heutzutage üblich ist. Aber dennoch, hier einmal das Modell.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>basi_lmrob_fit <span class="ot">&lt;-</span> <span class="fu">lmrob</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="anova-1" class="level3" data-number="62.4.1">
<h3 data-number="62.4.1" class="anchored" data-anchor-id="anova-1"><span class="header-section-number">62.4.1</span> ANOVA</h3>
<p>Dann wollen wir einmal eine zweifaktorielle ANOVA auf den Modell der robusten Regression mit der Funktion <code>MASS::rlm()</code> rechnen. Leider kann ich schon gleich sagen, dass wir hier ein Problem kriegen. Es ist nicht ganz klar unter Theoretikern welche Anzahl an Beobachtungen für die Residuen in der robusten Regression genutzt werden soll. Welche Beobachtungen werden den im Modell berücksichtigt und welche nicht? Daher ist dann der Wert für die Freiheitsgrade <span class="math inline">\(df\)</span> leer und wir erhalten keine <span class="math inline">\(F\)</span>-Statistik und dann auch keine <span class="math inline">\(p\)</span>-Werte. Für mich super unbefriedigend, so kann man dann auch keine Funktionen richtig nutzen. Die Funktion <code>robustbase::lmrob()</code> bietet die ANOVA nicht an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>basi_rlm_aov <span class="ot">&lt;-</span> basi_rlm_fit <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>basi_rlm_aov</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  term                    df sumsq meansq statistic p.value
  &lt;chr&gt;                &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 versuchsgruppe           3 114.   37.9         NA      NA
2 block                    3 318.  106.          NA      NA
3 versuchsgruppe:block     9  63.7   7.07        NA      NA
4 Residuals               NA 527.   NA           NA      NA</code></pre>
</div>
</div>
<p>Was als Freiheitsgrad für die Residuen nehmen? In unserem Datensatz haben wir 80 Basilikumpflanzen und somit auch Beobachtungen vorliegen. Wir setzen jetzt einfach brutal die Freiheitsgrade <code>df</code> für die Residuen auf 80 und können dann die Mean Squares für die Residuen berechnen. Also einmal flott die <code>meansq</code> für die Residuen durch die Anzahl an Beobachtungen geteilt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ms_resid <span class="ot">&lt;-</span> <span class="dv">527</span> <span class="sc">/</span> <span class="dv">80</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Mit den Mean Square der Residuen können wir dann auch die <span class="math inline">\(F\)</span>-Werte berechnen. Den rechnerischen Weg kennen wir ja schon aus der zweifaktoriellen ANOVA.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>f_calc <span class="ot">&lt;-</span> basi_rlm_aov<span class="sc">$</span>meansq <span class="sc">/</span> ms_resid</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wie kriegen wir jetzt aus den ganzen berechneten <span class="math inline">\(F\)</span>-Werten die entsprechenden <span class="math inline">\(p\)</span>-Werte? Die <span class="math inline">\(p\)</span>-Werte sind die Fläche rechts von den berechneten Werten. Wir können die Funktion <code>pf()</code> nutzen um diese Flächen zu berechnen. Wir machen das einmal beispielhaft für einen <span class="math inline">\(F_{calc} = 3.41\)</span> für 4 Gruppen mit <span class="math inline">\(df_1 = 4 - 1 = 3\)</span> und 12 Beobachtungen <span class="math inline">\(df_2 = 12\)</span>. Die Berechnung von <span class="math inline">\(df_2\)</span> ist statistisch <em>falsch</em> aber für unseren MacGyver Hack hinreichend.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(<span class="fl">3.41</span>, <span class="dv">3</span>, <span class="dv">12</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.053</code></pre>
</div>
</div>
<p>Und siehe da, wir erhalten einen <span class="math inline">\(p\)</span>-Wert von <span class="math inline">\(0.053\)</span>. Nun können wir das nicht nur für einzelnen <span class="math inline">\(F\)</span>-Werte machen sondern auch für unseren ganzen Vektor <code>f_calc</code>. Als <span class="math inline">\(df_2\)</span> setzen wir die Anzahl an Basilikumpflanzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>p_vec <span class="ot">&lt;-</span> <span class="fu">pf</span>(f_calc, <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">9</span>), <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">80</span>, <span class="dv">80</span>), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  scales<span class="sc">::</span><span class="fu">pvalue</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die berechneten <span class="math inline">\(F\)</span>-Werte und <span class="math inline">\(p\)</span>-Werte können wir jetzt in die ANOVA Tabelle ergänzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>basi_rlm_aov <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">statistic =</span> f_calc, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">p.value =</span> p_vec)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  term                    df sumsq meansq statistic p.value
  &lt;chr&gt;                &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
1 versuchsgruppe           3 114.   37.9       5.75 0.001  
2 block                    3 318.  106.       16.1  &lt;0.001 
3 versuchsgruppe:block     9  63.7   7.07      1.07 0.391  
4 Residuals               NA 527.   NA        NA    &lt;NA&gt;   </code></pre>
</div>
</div>
<p>Das war jetzt ein ganz schöner Angang und den <span class="math inline">\(p\)</span>-Werten ist nur approximativ zu trauen, aber wenn wir weit vom Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% sind, dann macht eine numerische Ungenauigkeit auch nicht viel aus. Achtung deshalb bei <span class="math inline">\(p\)</span>-Werten nahe des Signifikanzniveau <span class="math inline">\(\alpha\)</span>, hier ist dann die Aussage mit Vorsicht zu treffen oder eher nicht möglich.</p>
<p>Glücklicherweise können wir aus den Sum of squares dann unsere <span class="math inline">\(\eta^2\)</span>-Werte für die erklärte Varianz unserer ANOVA berechnen. Das ist dann doch schon mal was. Wir sehen, dass die Blöcke am meisten der Varianz erklären und die Versuchsgruppen sehr wenig. Das ist für das Modell dann nicht so schön, deckt sich aber mit den Ergebnissen gewöhnlichen Regression. Wir erhalten eine Konfidenzintervalle, woran du schon erkennen kannst, dass in der Ausgabe der ANOVA der robusten Regression was fehlt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>basi_rlm_fit <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter            | Eta2 (partial) |       95% CI
----------------------------------------------------
versuchsgruppe       |           0.23 | [0.08, 1.00]
block                |           0.41 | [0.24, 1.00]
versuchsgruppe:block |           0.14 | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>Nochmal als Erinnerung, mit der Funktion <code>robustbase::lmrob()</code> ist die ANOVA nicht möglich. Die Funktionalität ist nicht implementiert.</p>
</section>
<section id="gruppenvergleich-1" class="level3" data-number="62.4.2">
<h3 data-number="62.4.2" class="anchored" data-anchor-id="gruppenvergleich-1"><span class="header-section-number">62.4.2</span> Gruppenvergleich</h3>
<p>Dafür geht der Gruppenvergleich für die robuste Regression mit <code>MASS::rlm()</code> wie von alleine. Wir haben keine Interaktion vorliegen, daher müssen wir auch nicht den Block berücksichtigen. Das wir in Block 1 ein Problem haben, steht dann aber auf einem anderen Blatt. Da aber <em>alle</em> Basilikumpflanzen immer im Block 1 kleiner sind, passt es dann wieder im Sinne keiner Interaktion. Mit Interaktion hätten wir sonst <code>versuchsgruppe | block</code> statt nur <code>versuchsgruppe</code> hinter die Tilde geschrieben. Dann wollen wir noch das <em>compact letter disply</em> und alles ist wie es sein sollte.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>basi_rlm_fit <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> <span class="sc">~</span> versuchsgruppe) <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> versuchsgruppe emmean    SE df asymp.LCL asymp.UCL .group
 Erde+Fließ       19.7 0.668 NA      18.4      21.0  a    
 Erde             19.9 0.668 NA      18.6      21.2  a    
 Perlite+Fließ    22.2 0.668 NA      20.9      23.5   b   
 Erde+Perlite     22.4 0.668 NA      21.1      23.7   b   

Results are averaged over the levels of: block 
Confidence level used: 0.95 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Wir sehen also, dass sich Erde+Fließ und Erde nicht unterscheiden. Die beiden aber dann von Perlite+Fließ sowie Erde+Perlite. Am Ende unterscheiden sich Perlite+Fließ und Erde+Perlite nicht.</p>
<p>Für die Funktion <code>robustbase::lmrob()</code> müssen wir dann auf das R Paket <code>{multcomp}</code> umswitchen. Hier kriegen wir dann ein Problem, wenn wir eine Interaktion vorliegen ahben, da ist <code>{multcomp}</code> nicht so schön anzuwenden, wie dann <code>{emmeans}</code>. Aber hier schauen wir uns dann mal die einfache Implementierung ohne Interaktion an. Bei einer Interaktion müssten wir dann händisch über die Funktion <code>filter()</code> die Analysen für die einzelnen Blöcke aufspalten.</p>
<p>Wir lassen jetzt aber erstmal auf dem Modell aus der Funktion <code>robustbase::lmrob()</code> den paarweisen Vergleich nach Tukey laufen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mult_lmrob <span class="ot">&lt;-</span> <span class="fu">glht</span>(basi_lmrob_fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">versuchsgruppe =</span> <span class="st">"Tukey"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Das erhaltende Objekt können wir dann mit <code>tidy()</code> aufräumen und uns dann die gewünschten Spalten wiedergeben lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>mult_lmrob_tbl <span class="ot">&lt;-</span> mult_lmrob <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, conf.low, conf.high, adj.p.value) </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>mult_lmrob_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  contrast                     estimate conf.low conf.high adj.p.value
  &lt;chr&gt;                           &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
1 Erde+Fließ - Erde              1.68      -1.79      5.14       0.592
2 Erde+Perlite - Erde            1.63      -2.38      5.64       0.717
3 Perlite+Fließ - Erde           4.84      -1.35     11.0        0.182
4 Erde+Perlite - Erde+Fließ     -0.0439    -2.86      2.78       1.00 
5 Perlite+Fließ - Erde+Fließ     3.17      -2.52      8.85       0.474
6 Perlite+Fließ - Erde+Perlite   3.21      -2.79      9.21       0.509</code></pre>
</div>
</div>
<p>Wir sehen, dass wir mit der Adjustierung keinen signifikanten Unterschied zwischen den Bodensorten finden. Im Folgenden dann noch die Darstellung im <em>compact letter display</em>, wo wir etwas rumfrickeln müssen damit die Funktion <code>multcompLetters()</code> auch die Kontraste aus der Funktion <code>glht()</code> akzeptiert. Aber das haben wir dann alles zusammen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>mult_lmrob_tbl <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(adj.p.value, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Letters"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Erde+Fließ  Erde+Perlite Perlite+Fließ          Erde 
          "a"           "a"           "a"           "a" </code></pre>
</div>
</div>
<p>Auch hier sehen wir keinen Unterschied im <em>compact letter display</em> für die adjustierten <span class="math inline">\(p\)</span>-Werte. Für die unadjustierten rohen <span class="math inline">\(p\)</span>-Werte nutzen wir dann den Umweg über die <code>summary()</code> Funktion. Die unadjustierten <span class="math inline">\(p\)</span>-Werte können wir dann auch in das <em>compact letter display</em> umwandeln lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mult_lmrob, <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"none"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p.value, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Letters"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Erde+Fließ  Erde+Perlite Perlite+Fließ          Erde 
         "ab"          "ab"           "a"           "b" </code></pre>
</div>
</div>
<p>Und wenn man eine andere Funktion nutzt, dann kommen auch leicht andere Ergebnisse raus. Bei den rohen <span class="math inline">\(p\)</span>-Werten haben wir jetzt etwas andere Unterschiede. Aber das liegt auch an den sehr ähnlichen Mittelwerten. So groß sind die Unterschiede nicht, so dass wir hier natürlich durch unterschiedliche Algorithmen leicht andere Ergebnisse kriegen. Wieder ein Grund die <span class="math inline">\(p\)</span>-Werte zu adjustieren um dann auch konsistente Ergebnisse zu haben.</p>
</section>
</section>
<section id="sec-quantile-reg" class="level2 page-columns page-full" data-number="62.5">
<h2 data-number="62.5" class="anchored" data-anchor-id="sec-quantile-reg"><span class="header-section-number">62.5</span> Quantilsregression</h2>
<p>Jetzt wollen wir uns als Spezialfall der robusten Regression einmal die Quantilesregression anschauen. Wir der Name schon sagt, optimiert die Quantilregression nicht über den Mittelwert und die Standardabweichung als quadratische Abweichungen sondern über den Median und die absoluten Abweichungen. Wir haben es also hier mit einer Alternativen zu der gewöhnlichen Regression zu tun. Das schöne an der Quantilesregression ist, dass der Median nicht so anfällig gegenüber Ausreißern ist. Hier haben wir einen Vorteil. Wir können theoretisch auch andere Quantile als Referenzwert nehmen und die absoluten Abstände berechnen. Wenn wir aber später dann mit <code>emmeans</code> die Gruppenvergleiche rechnen wollen, geht das nur über den Median.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Ein englisches Tutorium gibt es dann nochmal ausführlicher unter <a href="https://yuzar-blog.netlify.app/posts/2022-12-01-quantileregression/">Quantile Regression as an useful Alternative for Ordinary Linear Regression</a></p>
</div></div><p>Um die Quantilesregression zu rechnen nutzen wir das R Paket <code>{quantreg}</code> und die Funktion <code>rq()</code>. Wichtig ist hier, dass wir das <code>tau</code> auf <span class="math inline">\(0.5\)</span> setzen und somit dann eine Median-Regression rechnen. Wir können theoretisch auch andere Quantile als Referenz wählen, aber dann passt es nicht mehr mit <code>emmeans()</code>. Wir nutzen hier auch nochmal die Gelegenheit zwei Modelle mit anzupassen. Wir rechnen einmal ein Modell mit einer linearen Komponente der Zeit <code>time_num</code> und einmal ein Modell mit der quadratischen Komponente der Zeit mit <code>poly(time_num, 2)</code> was nicht anderes als <code>time_num</code><span class="math inline">\(^2\)</span> ist. Neben dieser Variante ist mit <code>nlrq()</code> auch eine Möglichkeit implementiert um noch komplexere nicht lineare Zusammenhänge zu modellieren. Hier dann einfach mal die Hilfeseite von <code>?nlrq</code> anschauen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>time_rq_lin_fit <span class="ot">&lt;-</span> <span class="fu">rq</span>(length <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> time_num <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>time_num, <span class="at">tau =</span> <span class="fl">0.5</span>,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                      gurke_time_len_tbl)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>time_rq_quad_fit <span class="ot">&lt;-</span> <span class="fu">rq</span>(length <span class="sc">~</span> versuchsgruppe <span class="sc">*</span> <span class="fu">poly</span>(time_num, <span class="dv">2</span>), <span class="at">tau =</span> <span class="fl">0.5</span>, </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                       gurke_time_len_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#fig-robust-gurke-01" class="quarto-xref">Abbildung&nbsp;<span>62.5</span></a> plotten wir einmal die Modelle aus der linearen und der quadratischen Anpassung des zeitlichen Verlaufs in die Abbildung. Wir sehen, dass das Modell mit der quadratischen Anpassung besser zu den Daten passt. Daher nutzen wir jetzt im weiteren das Modell <code>time_rq_quad_fit</code>.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gurke_time_len_tbl, <span class="fu">aes</span>(time_num, length, <span class="at">color =</span> versuchsgruppe)) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(time_rq_quad_fit), <span class="at">linetype =</span> <span class="st">"Quadratic"</span>)) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(time_rq_lin_fit), <span class="at">linetype =</span> <span class="st">"Linear"</span>)) <span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">linetype =</span> <span class="st">""</span>, <span class="at">color =</span> <span class="st">""</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-robust-gurke-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-robust-gurke-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-robust-quantile_files/figure-html/fig-robust-gurke-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Abbildung&nbsp;62.5— Scatterplot des Längenwachstums der drei Gurkensorten über vierzehn Wochen. Die gestrichtelten Linien stellen den Median und die durchgezogene Line den Mittelwert der Gruppen dar."><img src="stat-modeling-robust-quantile_files/figure-html/fig-robust-gurke-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-robust-gurke-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;62.5— Scatterplot des Längenwachstums der drei Gurkensorten über vierzehn Wochen. Die gestrichtelten Linien stellen den Median und die durchgezogene Line den Mittelwert der Gruppen dar.
</figcaption>
</figure>
</div>
</div>
</div>
<section id="anova-2" class="level3" data-number="62.5.1">
<h3 data-number="62.5.1" class="anchored" data-anchor-id="anova-2"><span class="header-section-number">62.5.1</span> ANOVA</h3>
<p>Machen wir es kurz. Die ANOVA ist für die Quantilsregression nicht implementiert und damit auch nicht anwendbar. Damit können wir aber leben, wenn wir die ANOVA nur als Vortest ansehen. Wir müssen dann eine mögliche Interaktion visuell überprüfen. Um die Interaktion visuell zu überprüfen nutzen wir die Funktion <code>emimp()</code> aus dem R Paket <code>{emmeans}</code>. Wir sehen in der <a href="#fig-rob-inter-time" class="quarto-xref">Abbildung&nbsp;<span>62.6</span></a>, dass sich die Gerade für die Versuchsgruppen über die Zeit nicht schneiden, was gegen eine starke Interaktion spricht. Die Steigung ist aber für alle drei Versuchsgruppen über die Zeit nicht gleich, wir haben zumindest eine mittlere Interaktion.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmip</span>(time_rq_lin_fit, versuchsgruppe <span class="sc">~</span> time_num, <span class="at">CIs =</span> <span class="cn">TRUE</span>, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">cov.reduce =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">emmip</span>(time_rq_quad_fit, versuchsgruppe <span class="sc">~</span> time_num, <span class="at">CIs =</span> <span class="cn">TRUE</span>, </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">cov.reduce =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-rob-inter-time" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rob-inter-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-rob-inter-time" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-rob-inter-time-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-rob-inter-time-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-robust-quantile_files/figure-html/fig-rob-inter-time-1.png" class="lightbox" data-gallery="fig-rob-inter-time" title="Abbildung&nbsp;62.6&nbsp;(a)— Linear"><img src="stat-modeling-robust-quantile_files/figure-html/fig-rob-inter-time-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-rob-inter-time" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-rob-inter-time-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Linear
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-rob-inter-time" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-rob-inter-time-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-rob-inter-time-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-robust-quantile_files/figure-html/fig-rob-inter-time-2.png" class="lightbox" data-gallery="fig-rob-inter-time" title="Abbildung&nbsp;62.6&nbsp;(b)— Quadratic"><img src="stat-modeling-robust-quantile_files/figure-html/fig-rob-inter-time-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-rob-inter-time" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-rob-inter-time-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Quadratic
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-rob-inter-time-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;62.6— Interaktionsplot über den zeitlichen Verlauf für alle drei Sorten für die Quantilesregression.
</figcaption>
</figure>
</div>
</div>
<p>Wir würden also in unseren Gruppenvergleich der Mediane auf jeden Fall die Interaktion mit rein nehmen und die <code>emmeans()</code> Funktion entsprechend mit dem <code>|</code> anpassen.</p>
</section>
<section id="gruppenvergleich-2" class="level3" data-number="62.5.2">
<h3 data-number="62.5.2" class="anchored" data-anchor-id="gruppenvergleich-2"><span class="header-section-number">62.5.2</span> Gruppenvergleich</h3>
<p>Wenn wir den Gruppenvergleich in <code>emmeans()</code> rechnen wollen, dann geht es nur dem Spezialfall der Median-Regression. Wir müssen also zwangsweise in der Quantilesregression <code>rq()</code> das <code>tau = 0.5</code> setzen um dann eine Median-Regression zu rechnen. Sonst können wir nicht <code>emmeans</code> nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>time_rq_quad_fit <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> versuchsgruppe <span class="sc">|</span> time_num, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">adjust =</span> <span class="st">"none"</span>, <span class="at">at =</span> <span class="fu">list</span>(<span class="at">time_num =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">14</span>))) <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>time_num =  1:
 versuchsgruppe emmean     SE  df lower.CL upper.CL .group
 Quarto           2.30 0.0513 243     2.20     2.40  a    
 Katrina          3.30 0.2879 243     2.73     3.87   b   
 Proloog          5.00 0.2243 243     4.56     5.44    c  

time_num =  7:
 versuchsgruppe emmean     SE  df lower.CL upper.CL .group
 Quarto           3.83 0.2467 243     3.35     4.32  a    
 Katrina          5.20 0.3184 243     4.57     5.83   b   
 Proloog         11.97 0.2938 243    11.39    12.55    c  

time_num = 14:
 versuchsgruppe emmean     SE  df lower.CL upper.CL .group
 Quarto           7.30 1.7815 243     3.79    10.81  a    
 Katrina         11.36 3.1038 243     5.25    17.47  a    
 Proloog         30.06 1.6609 243    26.79    33.34   b   

Confidence level used: 0.95 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Das sieht ja schon mal ganz gut aus. Interessant ist, dass wir an dann in der vierzehnten Woche dann keinen signifikanten Unterschied mehr vorliegen zwischen Quarto und Katrina vorliegen haben. Das liegt dann aber alleinig an dem hohen Standardfehler <code>SE</code> der Sorte Katrina mit <span class="math inline">\(3.1\)</span> gegenüber den anderen Sorten. Vermutlich sehe das Ergebnis leicht anders aus, wenn wir die unsinnigen Gurken mit einer Länge von 0 cm wirklich aus den Dten entfernen würden und nicht zu Demonstrationszwecken wie hier drin lassen würden.</p>
<p>Aber Achtung, die Spalte <code>emmean</code> beschriebt hier die Mediane. Wir haben also hier die Mediane des Längenwachstums für die Gurken vorliegen. Wenn wir die paarweisen Vergleich rechnen wollen würden dann können wir noch <code>pairwise ~ versuchsgruppe</code> statt <code>~ versuchsgruppe</code> schreiben. Auch liefert die Funktion <code>pwpm()</code> die Medianunterschiede wie wir im Folgenden einmal sehen. Ich habe hier mal das <code>at</code> entfernt und da die Zeit numrisch ist, haben wir dann auch nur noch eine Tabelle. Die <code>Diagonal: [Estimates] (emmean)</code> sind die Mediane des Längenwachstums.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>time_rq_quad_fit <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> versuchsgruppe <span class="sc">|</span> time_num, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        Katrina Proloog  Quarto
Katrina [ 5.50]  &lt;.0001  0.0095
Proloog   -7.41 [12.91]  &lt;.0001
Quarto     1.48    8.89 [ 4.02]

Row and column labels: versuchsgruppe
Upper triangle: P values   adjust = "tukey"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
</div>
</section>
</section>
<section id="modellvergleich" class="level2" data-number="62.6">
<h2 data-number="62.6" class="anchored" data-anchor-id="modellvergleich"><span class="header-section-number">62.6</span> Modellvergleich</h2>
<p>Im Folgenden wollen wir einmal verschiedene Modelle miteinander vergleichen und schauen, welches Modell hier das beste ist. Das machen wir dann einmal für die Basilikumdaten sowie die Wachstumsdaten für die Gurken.</p>
<section id="basilikumdaten" class="level3" data-number="62.6.1">
<h3 data-number="62.6.1" class="anchored" data-anchor-id="basilikumdaten"><span class="header-section-number">62.6.1</span> Basilikumdaten</h3>
<p>Für den Modellvergleich der gewöhnlichen, robusten und medianen Regression nutzen wir nochmal den Datensatz für das Basilikumwachstum. In einem ersten Schritt fitten wir wieder alle Modelle und achten darauf, dass wir bei der Quantilesregression angeben welches Quantile wir wollen. Wir wählen mit <code>tau = 0.5</code> dann den Median und rechnen so eine Medianregression.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>basi_lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>basi_rlm_fit <span class="ot">&lt;-</span> <span class="fu">rlm</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>basi_lmrob_fit <span class="ot">&lt;-</span> <span class="fu">lmrob</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>basi_rq_fit <span class="ot">&lt;-</span> <span class="fu">rq</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tau =</span> <span class="fl">0.5</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Im Folgenden nutzen wir dann das fantastische Paket <code>{modelsummary}</code> mit der gleichnamigen Funktion um uns einmal die Modelle im Vergleich anzuschauen. Hier hilft dann wie immer die tolle <a href="https://vincentarelbundock.github.io/modelsummary/articles/modelsummary.html">Hilfsseite von <code>{modelsummary}</code></a> zu besuchen. Ich möchte nur nicht den Intercept und die Schätzer für die Blöcke haben, deshalb fliegen die hier einmal raus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"Ordinary"</span> <span class="ot">=</span> basi_lm_fit,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"MASS::rlm"</span> <span class="ot">=</span> basi_rlm_fit,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"robustbase::lmrob"</span> <span class="ot">=</span> basi_lmrob_fit,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Quantile"</span> <span class="ot">=</span> basi_rq_fit),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">estimate  =</span> <span class="st">"{estimate}"</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"conf.int"</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"s.e. = {std.error}"</span>, </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"t = {statistic}"</span>,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"p = {p.value}"</span>),</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_omit =</span> <span class="st">"Intercept|block"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_uy4drsapircvsqgdmj2r</title>
    <style>
.table td.tinytable_css_jwxf219x36menrdne5ig, .table th.tinytable_css_jwxf219x36menrdne5ig {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_sb8gbf2xv5mfnj2utmuk, .table th.tinytable_css_sb8gbf2xv5mfnj2utmuk {    text-align: left; }
.table td.tinytable_css_w71so0eev70zi7z5473z, .table th.tinytable_css_w71so0eev70zi7z5473z {    text-align: center; }
.table td.tinytable_css_laeje8n3or55ffvk7lhw, .table th.tinytable_css_laeje8n3or55ffvk7lhw {    text-align: center; }
.table td.tinytable_css_3y20xt695wmx2zye6zi2, .table th.tinytable_css_3y20xt695wmx2zye6zi2 {    text-align: center; }
.table td.tinytable_css_fjnd9f9dcs0wefd14f0k, .table th.tinytable_css_fjnd9f9dcs0wefd14f0k {    text-align: center; }
.table td.tinytable_css_vflu4oe1w20qdja6yqac, .table th.tinytable_css_vflu4oe1w20qdja6yqac {    border-bottom: solid 0.05em black; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_uy4drsapircvsqgdmj2r" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Ordinary</th>
                <th scope="col">MASS::rlm</th>
                <th scope="col">robustbase::lmrob</th>
                <th scope="col">Quantile</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>versuchsgruppeErde+Fließ   </td>
                  <td>2.200          </td>
                  <td>1.515          </td>
                  <td>1.675          </td>
                  <td>1.000          </td>
                </tr>
                <tr>
                  <td>                           </td>
                  <td>[-1.399, 5.799]</td>
                  <td>[-2.257, 5.286]</td>
                  <td>[-1.053, 4.403]</td>
                  <td>[-0.374, 2.374]</td>
                </tr>
                <tr>
                  <td>                           </td>
                  <td>s.e. = 1.801   </td>
                  <td>s.e. = 1.888   </td>
                  <td>s.e. = 1.365   </td>
                  <td>s.e. = 0.701   </td>
                </tr>
                <tr>
                  <td>                           </td>
                  <td>t = 1.221      </td>
                  <td>t = 0.802      </td>
                  <td>t = 1.227      </td>
                  <td>t = 1.426      </td>
                </tr>
                <tr>
                  <td>                           </td>
                  <td>p = 0.226      </td>
                  <td>p = 0.425      </td>
                  <td>p = 0.224      </td>
                  <td>p = 0.159      </td>
                </tr>
                <tr>
                  <td>versuchsgruppeErde+Perlite </td>
                  <td>2.200          </td>
                  <td>1.515          </td>
                  <td>1.631          </td>
                  <td>0.000          </td>
                </tr>
                <tr>
                  <td>                           </td>
                  <td>[-1.399, 5.799]</td>
                  <td>[-2.257, 5.286]</td>
                  <td>[-1.529, 4.791]</td>
                  <td>[-3.073, 3.073]</td>
                </tr>
                <tr>
                  <td>                           </td>
                  <td>s.e. = 1.801   </td>
                  <td>s.e. = 1.888   </td>
                  <td>s.e. = 1.582   </td>
                  <td>s.e. = 1.568   </td>
                </tr>
                <tr>
                  <td>                           </td>
                  <td>t = 1.221      </td>
                  <td>t = 0.802      </td>
                  <td>t = 1.031      </td>
                  <td>t = 0.000      </td>
                </tr>
                <tr>
                  <td>                           </td>
                  <td>p = 0.226      </td>
                  <td>p = 0.425      </td>
                  <td>p = 0.306      </td>
                  <td>p = 1.000      </td>
                </tr>
                <tr>
                  <td>versuchsgruppePerlite+Fließ</td>
                  <td>5.200          </td>
                  <td>4.683          </td>
                  <td>4.841          </td>
                  <td>6.000          </td>
                </tr>
                <tr>
                  <td>                           </td>
                  <td>[1.601, 8.799] </td>
                  <td>[0.911, 8.455] </td>
                  <td>[-0.037, 9.718]</td>
                  <td>[1.045, 10.955]</td>
                </tr>
                <tr>
                  <td>                           </td>
                  <td>s.e. = 1.801   </td>
                  <td>s.e. = 1.888   </td>
                  <td>s.e. = 2.442   </td>
                  <td>s.e. = 2.528   </td>
                </tr>
                <tr>
                  <td>                           </td>
                  <td>t = 2.887      </td>
                  <td>t = 2.480      </td>
                  <td>t = 1.982      </td>
                  <td>t = 2.373      </td>
                </tr>
                <tr>
                  <td>                           </td>
                  <td>p = 0.005      </td>
                  <td>p = 0.016      </td>
                  <td>p = 0.052      </td>
                  <td>p = 0.021      </td>
                </tr>
                <tr>
                  <td>Num.Obs.                   </td>
                  <td>80             </td>
                  <td>80             </td>
                  <td>80             </td>
                  <td>80             </td>
                </tr>
                <tr>
                  <td>R2                         </td>
                  <td>0.535          </td>
                  <td>               </td>
                  <td>0.501          </td>
                  <td>0.480          </td>
                </tr>
                <tr>
                  <td>R2 Adj.                    </td>
                  <td>0.426          </td>
                  <td>               </td>
                  <td>0.384          </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>AIC                        </td>
                  <td>410.7          </td>
                  <td>411.8          </td>
                  <td>               </td>
                  <td>404.5          </td>
                </tr>
                <tr>
                  <td>BIC                        </td>
                  <td>451.1          </td>
                  <td>452.3          </td>
                  <td>               </td>
                  <td>442.7          </td>
                </tr>
                <tr>
                  <td>Log.Lik.                   </td>
                  <td>-188.326       </td>
                  <td>-188.914       </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>F                          </td>
                  <td>4.912          </td>
                  <td>3.903          </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>RMSE                       </td>
                  <td>2.55           </td>
                  <td>2.57           </td>
                  <td>2.55           </td>
                  <td>2.69           </td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_n3gyc506ip24fh7bkxcm(i, j, css_id) {
        var table = document.getElementById("tinytable_uy4drsapircvsqgdmj2r");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_uy4drsapircvsqgdmj2r');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_n3gyc506ip24fh7bkxcm(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_uy4drsapircvsqgdmj2r");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(0, 0, 'tinytable_css_jwxf219x36menrdne5ig') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(0, 1, 'tinytable_css_jwxf219x36menrdne5ig') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(0, 2, 'tinytable_css_jwxf219x36menrdne5ig') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(0, 3, 'tinytable_css_jwxf219x36menrdne5ig') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(0, 4, 'tinytable_css_jwxf219x36menrdne5ig') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(0, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(1, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(2, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(3, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(4, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(5, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(6, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(7, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(8, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(9, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(10, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(11, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(12, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(13, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(14, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(15, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(16, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(17, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(18, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(19, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(20, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(21, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(22, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(23, 0, 'tinytable_css_sb8gbf2xv5mfnj2utmuk') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(0, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(1, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(2, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(3, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(4, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(5, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(6, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(7, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(8, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(9, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(10, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(11, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(12, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(13, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(14, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(15, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(16, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(17, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(18, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(19, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(20, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(21, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(22, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(23, 1, 'tinytable_css_w71so0eev70zi7z5473z') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(0, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(1, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(2, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(3, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(4, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(5, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(6, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(7, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(8, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(9, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(10, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(11, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(12, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(13, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(14, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(15, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(16, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(17, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(18, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(19, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(20, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(21, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(22, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(23, 2, 'tinytable_css_laeje8n3or55ffvk7lhw') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(0, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(1, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(2, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(3, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(4, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(5, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(6, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(7, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(8, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(9, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(10, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(11, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(12, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(13, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(14, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(15, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(16, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(17, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(18, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(19, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(20, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(21, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(22, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(23, 3, 'tinytable_css_3y20xt695wmx2zye6zi2') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(0, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(1, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(2, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(3, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(4, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(5, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(6, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(7, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(8, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(9, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(10, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(11, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(12, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(13, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(14, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(15, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(16, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(17, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(18, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(19, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(20, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(21, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(22, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(23, 4, 'tinytable_css_fjnd9f9dcs0wefd14f0k') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(15, 0, 'tinytable_css_vflu4oe1w20qdja6yqac') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(15, 1, 'tinytable_css_vflu4oe1w20qdja6yqac') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(15, 2, 'tinytable_css_vflu4oe1w20qdja6yqac') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(15, 3, 'tinytable_css_vflu4oe1w20qdja6yqac') })
window.addEventListener('load', function () { styleCell_tinytable_n3gyc506ip24fh7bkxcm(15, 4, 'tinytable_css_vflu4oe1w20qdja6yqac') })
    </script>

  


</div>
</div>
<p>Wie wir sehen sehen haben nicht alle Modelle die gleichen Informationen zurück gegeben. Insbesondere das fehlen des Bestimmtheitsmaßes <span class="math inline">\(R^2\)</span> bei der robusten Regression <code>MASS::rlm</code> ist schmerzlich, da wir hier dann nicht die Möglichkeit haben eine Aussage über die erklärte Varianz der robusten Regression zu treffen. Auch fehlt bei der Medianregression das adjustierte <span class="math inline">\(R^2\)</span>, was die Nutzung bei Modellen mit mehr als einer Einflussvariable <span class="math inline">\(x\)</span> im Modell erschwert bis nutzlos macht. Da ist dann die Funktion aus dem Paket <code>{robustbase}</code> besser, hier haben wir dann ein <span class="math inline">\(R^2\)</span> vorliegen. Daher bleibt uns am Ende nur das AIC oder BIC, wobei wir dort den kleinsten Wert als besser erachten. Die AIC und BIC Werte sind somit am besten für die Quantilesregression. Für die Funktion <code>robustbase::lmrob</code> haben wir dann kein AIC. Dafür ist dann aber der Fehler RMSE bei der gewöhnlichen Regressionzusammen mit der Funktion <code>robustbase::lmrob</code> am niedrigsten. Und so stehe ich wieder davor und weiß nicht was das beste Modell ist. Hier müsste ich dann nochmal überlegen, ob ich lieber über Mittelwerte oder Mediane berichten möchte und das ist ohne die Forschungsfrage nicht hier zu lösen.</p>
</section>
<section id="gurkendaten" class="level3" data-number="62.6.2">
<h3 data-number="62.6.2" class="anchored" data-anchor-id="gurkendaten"><span class="header-section-number">62.6.2</span> Gurkendaten</h3>
<p>Für den Modellvergleich der gewöhnlichen, robusten und medianen Regression nutzen wir nochmal den Datensatz für das Längenwachstum der Gurken. In einem ersten Schritt fitten wir wieder alle Modelle und achten darauf, dass wir bei der Quantilesregression angeben welches Quantile wir wollen. Wir wählen mit <code>tau = 0.5</code> dann den Median und rechnen so eine Median-Regression. Darüber hinaus schauen wir uns nochmal die quadratische Anpassung der Zeit in dem letzten Modell an. Mal schauen, ob das Modell dann auch bei den Kennzahlen das beste Modell ist. Visuell sah das quadratische Modell des zeitlichen Verlaufs schon mal sehr gut aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>time_lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(length <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> time_num <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>time_num, gurke_time_len_tbl)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>time_rlm_fit <span class="ot">&lt;-</span> <span class="fu">rlm</span>(length <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> time_num <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>time_num, gurke_time_len_tbl)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>time_rq_lin_fit <span class="ot">&lt;-</span> <span class="fu">rq</span>(length <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> time_num <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>time_num, <span class="at">tau =</span> <span class="fl">0.5</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                      gurke_time_len_tbl)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>time_rq_quad_fit <span class="ot">&lt;-</span> <span class="fu">rq</span>(length <span class="sc">~</span> versuchsgruppe <span class="sc">*</span> <span class="fu">poly</span>(time_num, <span class="dv">2</span>), <span class="at">tau =</span> <span class="fl">0.5</span>, </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                       gurke_time_len_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Auch hier nutzen wir dann das fantastische Paket <code>{modelsummary}</code> mit der gleichnamigen Funktion um uns einmal die Modelle im Vergleich anzuschauen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"Ordinary"</span> <span class="ot">=</span> time_lm_fit,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Robust"</span> <span class="ot">=</span> time_rlm_fit,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Quantile linear"</span> <span class="ot">=</span> time_rq_lin_fit,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Quantile quadratic"</span> <span class="ot">=</span> time_rq_quad_fit),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">estimate  =</span> <span class="st">"{estimate}"</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"conf.int"</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"s.e. = {std.error}"</span>, </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"t = {statistic}"</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"p = {p.value}"</span>),</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_omit =</span> <span class="st">"Intercept|time_num"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_u0cjk03bfdpkyx9hvyaj</title>
    <style>
.table td.tinytable_css_zmeianufjmt5nbnytmbj, .table th.tinytable_css_zmeianufjmt5nbnytmbj {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_umbohk985svti16xtoym, .table th.tinytable_css_umbohk985svti16xtoym {    text-align: left; }
.table td.tinytable_css_l1rluqsm6bzjnswoxynb, .table th.tinytable_css_l1rluqsm6bzjnswoxynb {    text-align: center; }
.table td.tinytable_css_m7xywhgm12scmqk3kg9b, .table th.tinytable_css_m7xywhgm12scmqk3kg9b {    text-align: center; }
.table td.tinytable_css_651ys6f9e5a73stp88ap, .table th.tinytable_css_651ys6f9e5a73stp88ap {    text-align: center; }
.table td.tinytable_css_y0hfzwujie5y1s7nxqik, .table th.tinytable_css_y0hfzwujie5y1s7nxqik {    text-align: center; }
.table td.tinytable_css_rxa92yxe6223w9eylqfc, .table th.tinytable_css_rxa92yxe6223w9eylqfc {    border-bottom: solid 0.05em black; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_u0cjk03bfdpkyx9hvyaj" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">Ordinary</th>
                <th scope="col">Robust</th>
                <th scope="col">Quantile linear</th>
                <th scope="col">Quantile quadratic</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>versuchsgruppeProloog</td>
                  <td>-0.218         </td>
                  <td>-1.028         </td>
                  <td>-0.823         </td>
                  <td>8.483          </td>
                </tr>
                <tr>
                  <td>                     </td>
                  <td>[-3.056, 2.619]</td>
                  <td>[-2.693, 0.638]</td>
                  <td>[-2.852, 1.206]</td>
                  <td>[6.612, 10.353]</td>
                </tr>
                <tr>
                  <td>                     </td>
                  <td>s.e. = 1.440   </td>
                  <td>s.e. = 0.846   </td>
                  <td>s.e. = 1.035   </td>
                  <td>s.e. = 0.954   </td>
                </tr>
                <tr>
                  <td>                     </td>
                  <td>t = -0.152     </td>
                  <td>t = -1.215     </td>
                  <td>t = -0.795     </td>
                  <td>t = 8.890      </td>
                </tr>
                <tr>
                  <td>                     </td>
                  <td>p = 0.880      </td>
                  <td>p = 0.225      </td>
                  <td>p = 0.427      </td>
                  <td>p = &lt;0.001     </td>
                </tr>
                <tr>
                  <td>versuchsgruppeQuarto </td>
                  <td>-0.412         </td>
                  <td>-0.641         </td>
                  <td>-0.986         </td>
                  <td>-1.883         </td>
                </tr>
                <tr>
                  <td>                     </td>
                  <td>[-3.249, 2.426]</td>
                  <td>[-2.307, 1.025]</td>
                  <td>[-3.045, 1.074]</td>
                  <td>[-3.817, 0.050]</td>
                </tr>
                <tr>
                  <td>                     </td>
                  <td>s.e. = 1.440   </td>
                  <td>s.e. = 0.846   </td>
                  <td>s.e. = 1.051   </td>
                  <td>s.e. = 0.986   </td>
                </tr>
                <tr>
                  <td>                     </td>
                  <td>t = -0.286     </td>
                  <td>t = -0.758     </td>
                  <td>t = -0.938     </td>
                  <td>t = -1.909     </td>
                </tr>
                <tr>
                  <td>                     </td>
                  <td>p = 0.775      </td>
                  <td>p = 0.449      </td>
                  <td>p = 0.349      </td>
                  <td>p = 0.057      </td>
                </tr>
                <tr>
                  <td>Num.Obs.             </td>
                  <td>252            </td>
                  <td>252            </td>
                  <td>252            </td>
                  <td>252            </td>
                </tr>
                <tr>
                  <td>R2                   </td>
                  <td>0.581          </td>
                  <td>               </td>
                  <td>0.548          </td>
                  <td>0.537          </td>
                </tr>
                <tr>
                  <td>R2 Adj.              </td>
                  <td>0.572          </td>
                  <td>               </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>AIC                  </td>
                  <td>1472.0         </td>
                  <td>1488.9         </td>
                  <td>1345.9         </td>
                  <td>1316.6         </td>
                </tr>
                <tr>
                  <td>BIC                  </td>
                  <td>1496.7         </td>
                  <td>1513.6         </td>
                  <td>1367.1         </td>
                  <td>1348.4         </td>
                </tr>
                <tr>
                  <td>Log.Lik.             </td>
                  <td>-729.020       </td>
                  <td>-737.435       </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>F                    </td>
                  <td>68.209         </td>
                  <td>269.196        </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>RMSE                 </td>
                  <td>4.37           </td>
                  <td>4.51           </td>
                  <td>4.53           </td>
                  <td>4.59           </td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_hnvsg1m45bbx6an4l7su(i, j, css_id) {
        var table = document.getElementById("tinytable_u0cjk03bfdpkyx9hvyaj");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_u0cjk03bfdpkyx9hvyaj');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_hnvsg1m45bbx6an4l7su(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_u0cjk03bfdpkyx9hvyaj");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(0, 0, 'tinytable_css_zmeianufjmt5nbnytmbj') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(0, 1, 'tinytable_css_zmeianufjmt5nbnytmbj') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(0, 2, 'tinytable_css_zmeianufjmt5nbnytmbj') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(0, 3, 'tinytable_css_zmeianufjmt5nbnytmbj') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(0, 4, 'tinytable_css_zmeianufjmt5nbnytmbj') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(0, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(1, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(2, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(3, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(4, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(5, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(6, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(7, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(8, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(9, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(10, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(11, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(12, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(13, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(14, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(15, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(16, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(17, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(18, 0, 'tinytable_css_umbohk985svti16xtoym') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(0, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(1, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(2, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(3, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(4, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(5, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(6, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(7, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(8, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(9, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(10, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(11, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(12, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(13, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(14, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(15, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(16, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(17, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(18, 1, 'tinytable_css_l1rluqsm6bzjnswoxynb') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(0, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(1, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(2, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(3, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(4, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(5, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(6, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(7, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(8, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(9, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(10, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(11, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(12, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(13, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(14, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(15, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(16, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(17, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(18, 2, 'tinytable_css_m7xywhgm12scmqk3kg9b') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(0, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(1, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(2, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(3, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(4, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(5, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(6, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(7, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(8, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(9, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(10, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(11, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(12, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(13, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(14, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(15, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(16, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(17, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(18, 3, 'tinytable_css_651ys6f9e5a73stp88ap') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(0, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(1, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(2, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(3, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(4, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(5, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(6, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(7, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(8, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(9, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(10, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(11, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(12, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(13, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(14, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(15, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(16, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(17, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(18, 4, 'tinytable_css_y0hfzwujie5y1s7nxqik') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(10, 0, 'tinytable_css_rxa92yxe6223w9eylqfc') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(10, 1, 'tinytable_css_rxa92yxe6223w9eylqfc') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(10, 2, 'tinytable_css_rxa92yxe6223w9eylqfc') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(10, 3, 'tinytable_css_rxa92yxe6223w9eylqfc') })
window.addEventListener('load', function () { styleCell_tinytable_hnvsg1m45bbx6an4l7su(10, 4, 'tinytable_css_rxa92yxe6223w9eylqfc') })
    </script>

  


</div>
</div>
<p>Hier sieht es ähnlich aus wie bei den Modellvergleichen von den Basilikumdaten. Nur hier wissen wir, dass wir Ausreißer in der Form von Gurken mit einer Länge von 0 cm in den Daten haben. Daher sehen wir auch, dass die robuste Regression und die Median-Regression ein niedrigeres AIC und BIC haben. Für mich interessant ist, dass der Fehler RMSE wieder am kleinsten bei der gewöhnlichen Regression ist, das mag aber auch an der Berechnung liegen. Da wir Ausreißer haben, sind natürlich dann auch die robuste Regression und die Median-Regression vorzuziehen. Da die Median-Regression den kleineren AIC Wert hat, nehmen wir dann die Median-Regression als die beste Regression an. Der RMSE ist am kleinsten für die quadratische Anpassung des zeitlichen Verlaufs. Deshalb wäre dann das vierte Modell mit dem niedrigsten AIC und dem niedrigsten RMSE das Modell der Wahl.</p>
<p>Ich wiederhole mich hier wirklich, aber vermutlich wäre es schlauer zuerst die Daten zu bereinigen und die Gurken mit einem Wachstum von 0 cm zu entfernen. Auch die anderen Wachstumskurven von anderen Gurken sind etwas wirr. Da müsste man auch nochmal ran und schauen, ob nicht die Gurken lieber aus der Analyse raus müssen. Am Ende ist dann natürlich die Frage, ob man die Daten dann nicht doch lieber über ein gemischtes Modell auswertet, da natürlich die Zeitpunkte voneinander abhängig sind, wenn wir immer die glecihen Gurken messen und nicht ernten. Aber wie immer im Leben, alles geht nicht.</p>
</section>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-maronna2019robust" class="csl-entry" role="listitem">
Maronna RA, Martin RD, Yohai VJ, Salibián-Barrera M. 2019. Robust statistics: theory and methods (with R). John Wiley &amp; Sons.
</div>
<div id="ref-stromberg2004write" class="csl-entry" role="listitem">
Stromberg A. 2004. Why write statistical software? The case of robust statistical methods. Journal of Statistical Software 10: 1–8.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-modeling-non-linear.html" class="pagination-link" aria-label="Nicht lineare Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-modeling-survival.html" class="pagination-link" aria-label="Überlebenszeitanalysen">
        <span class="nav-page-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb52" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc)</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Robuste und Quantilesregression {#sec-reg-quantile}</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-modeling-robust-quantile.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Methods for robust statistics, a state of the art in the early 2000s, notably for robust regression and robust multivariate analysis." --- [robust: Port of the S+ "Robust Library"](https://cran.r-project.org/web/packages/robust/index.html)*</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel geht es um zwei Arten der Regression, die immer wieder genannt werden, aber dennoch eine Art Nischendasein fristen. Zum einen möchte ich hier die robuste Regression (eng. *robust regression*) und zum anderen die Quantilsregression (eng. *quantile regression*) vorstellen. Die robuste Regression ist faktisch statistisch tot. Das heißt, die Implementierungen werden kaum weiterentwickelt und auch findet methodische Forschung nur in der theoretischen Nische statt. Zwar wird die robuste Regression in ihrer ursprünglichen Form als Regression angewendet, aber das reicht meistens nicht. Selten wollen wir nur durch ein paar Punkte eine Gerade ziehen und uns über das gute Modell erfreuen. Wir haben mit dem Modell meist mehr vor. Wir wollen eine ANOVA rechnen und dann auch einen wie auch immer gearteten Mittelwertsvergleich. Wenn dies zwar theoretisch möglich ist, praktisch aber nicht implementiert, dann wollen und können wir die Methoden nur eingeschränkt verwenden. Bei der Quantilsregression sieht es etwas anders aus, hier können wir dann schon den ein oder anderen Mittelwertsvergleich rechnen. Was bei der Quantilsregression eher problematisch ist, ist das das Modell nicht immer konvergiert oder aber nicht algorithmisch eine Lösung für einen spezifischen Datensatz findet. In diesem Datensatz dann den einen Grund zu finden, ist dann meist so aufwendig, dass wir es auch gleich mit der Quantilsregression lassen können.</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>Der Charme der Quantilesregression ist ja am Ende, dass wir auch den Median als Quantile auswählen können. So haben wir dann die Möglichkeit eine Regression auf den Medianen zu rechnen. Wir vergleichen damit dann auch die Mediane und sind so nicht mehr auf die Normalverteilung unseres Outcomes wie in der gewöhnlichen Regression angewiesen. Also eigentlich eine tolle Sache, wenn wir nur an den Mittelwertsvergleichen interessiert sind. Eine klassische ANOVA geht leider nicht auf einer Medianregression. Eine klassische ANOVA wäre aber mit nicht parametrischen Methoden sowieso nicht möglich gewesen. Wir verlieren also nicht so viel, gewinnen aber etwas, wenn das Modell konvergiert und ein Ergebnis liefert.</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel brechen wir etwas die bisherige Struktur der Regressionskapitel auf. Wir schauen uns hier zuerst die beiden Modelle an und entscheiden dann, ob wir die Modelle für die ANOVA oder den Gruppenvergleich *überhaupt* nutzen können. Am Ende vergleichen wir dann einmal alle Modell mit dem fantastische Paket <span class="in">`{modelsummary}`</span> mit der gleichnamigen Funktion. Hier hilft dann wie immer die tolle <span class="co">[</span><span class="ot">Hilfsseite von modelsummary</span><span class="co">](https://vincentarelbundock.github.io/modelsummary/articles/modelsummary.html)</span> zu besuchen.</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, conflicted, broom, quantreg,</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="in">               see, performance, emmeans, multcomp, janitor,</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a><span class="in">               parameters, effectsize, MASS, modelsummary,</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a><span class="in">               robustbase, multcompView, conflicted)</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a><span class="in">#cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a><span class="in">#                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>Für unser erstes Beispiel nutzen wir die Daten aus einem Wachstumsversuch mit Basilikum mit vier Bodenbehandlungen und vier Blöcken, die Blöcke sind eigentlich Gewächshaustische. Wir wollen also einen klassischen Gruppenvergleich mit Berücksichtigung der Blockstruktur rechnen.</span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>basi_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/keimversuch_basilikum_block.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">versuchsgruppe =</span> <span class="fu">as_factor</span>(versuchsgruppe)) <span class="sc">|&gt;</span> </span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(versuchsgruppe, block_1<span class="sc">:</span>block_4)</span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a>In @tbl-model-1 sehen wir einmal die Daten im Wide-Format. Wir haben also das Frischgewicht der Basilikumpflanzen gemessen und wollen wissen, ob die verschiedenen Bodenarten einen Einfluss auf das Wachstum haben.</span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Datensatz des Frischegewichts von Basilikumpflanzen auf vier Tischen bzw. Blöcken in vier Versuchsgruppen."</span></span>
<span id="cb52-56"><a href="#cb52-56" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-model-1</span></span>
<span id="cb52-57"><a href="#cb52-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-58"><a href="#cb52-58" aria-hidden="true" tabindex="-1"></a>basi_raw_tbl <span class="ot">&lt;-</span> basi_tbl <span class="sc">|&gt;</span> </span>
<span id="cb52-59"><a href="#cb52-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">versuchsgruppe =</span> <span class="fu">as.character</span>(versuchsgruppe))</span>
<span id="cb52-60"><a href="#cb52-60" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(basi_raw_tbl),</span>
<span id="cb52-61"><a href="#cb52-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(basi_raw_tbl)),</span>
<span id="cb52-62"><a href="#cb52-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(basi_raw_tbl)) <span class="sc">|&gt;</span> </span>
<span id="cb52-63"><a href="#cb52-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb52-64"><a href="#cb52-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-65"><a href="#cb52-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-66"><a href="#cb52-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-67"><a href="#cb52-67" aria-hidden="true" tabindex="-1"></a>Da wir die Daten im Wide-Format vorliegen haben, müssen wir die Daten nochmal in Long-Format umwandeln. Wie immer nutzen wir dafür die Funktion <span class="in">`pivot_longer()`</span>.</span>
<span id="cb52-68"><a href="#cb52-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-71"><a href="#cb52-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-72"><a href="#cb52-72" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-73"><a href="#cb52-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-74"><a href="#cb52-74" aria-hidden="true" tabindex="-1"></a>basi_block_tbl <span class="ot">&lt;-</span> basi_tbl <span class="sc">|&gt;</span> </span>
<span id="cb52-75"><a href="#cb52-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> block_1<span class="sc">:</span>block_4,</span>
<span id="cb52-76"><a href="#cb52-76" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"weight"</span>,</span>
<span id="cb52-77"><a href="#cb52-77" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"block"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-78"><a href="#cb52-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">block =</span> <span class="fu">as_factor</span>(block))</span>
<span id="cb52-79"><a href="#cb52-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-80"><a href="#cb52-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-81"><a href="#cb52-81" aria-hidden="true" tabindex="-1"></a>In der @fig-robust-basi-00 siehst du einmal die Daten als Dotplots mit Mittelwert und Standardabweichung. Wir machen hier mal einen etwas komplizierteren Plot, aber immer nur Barplot ist ja auch langweilig.</span>
<span id="cb52-82"><a href="#cb52-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-85"><a href="#cb52-85" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-86"><a href="#cb52-86" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb52-87"><a href="#cb52-87" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-88"><a href="#cb52-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-89"><a href="#cb52-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-robust-basi-00</span></span>
<span id="cb52-90"><a href="#cb52-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb52-91"><a href="#cb52-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb52-92"><a href="#cb52-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb52-93"><a href="#cb52-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dotplot des Frischegewichts von Basilikumpflanzen auf vier Tischen bzw. Blöcken in vier Versuchsgruppen mit Mittelwert und Standardabweichung."</span></span>
<span id="cb52-94"><a href="#cb52-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-95"><a href="#cb52-95" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(basi_block_tbl, <span class="fu">aes</span>(versuchsgruppe, weight, <span class="at">color =</span> block)) <span class="sc">+</span></span>
<span id="cb52-96"><a href="#cb52-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-97"><a href="#cb52-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb52-98"><a href="#cb52-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>), <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb52-99"><a href="#cb52-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data=</span><span class="st">"mean_sdl"</span>, <span class="at">fun.args =</span> <span class="fu">list</span>(<span class="at">mult =</span> <span class="dv">1</span>), </span>
<span id="cb52-100"><a href="#cb52-100" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom=</span><span class="st">"pointrange"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>))  <span class="sc">+</span></span>
<span id="cb52-101"><a href="#cb52-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">fun.min =</span> <span class="st">"min"</span>, <span class="at">fun.max =</span> <span class="st">"max"</span>, <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="cb52-102"><a href="#cb52-102" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) </span>
<span id="cb52-103"><a href="#cb52-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-104"><a href="#cb52-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-105"><a href="#cb52-105" aria-hidden="true" tabindex="-1"></a>Unser zweiter Datensatz ist ein Anwendungsdatensatz aus dem Gemüsebau. Wir schauen uns das Wachstum von drei Gurkensorten über siebzehn Wochen an. Die Gurkensorten sind hier unsere Versuchsgruppen. Da wir es hier mit echten Daten zu tun haben, müssen wir uns etwas strecken damit die Daten dann auch passen. Wir wollen das Wachstum der drei Gurkensorten *über* die Zeit betrachten - also faktisch den Verlauf des Wachstums. Wir ignorieren hier einmal die abhängige Datenstruktur über die Zeitpunkte.</span>
<span id="cb52-106"><a href="#cb52-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-107"><a href="#cb52-107" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb52-108"><a href="#cb52-108" aria-hidden="true" tabindex="-1"></a>Mit einer abhängigen Datenstruktur müssten wir eigentlich ein lineares gemischtes Modell rechnen. Aber wir nutzen hier die Daten einmal anders.</span>
<span id="cb52-109"><a href="#cb52-109" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb52-110"><a href="#cb52-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-111"><a href="#cb52-111" aria-hidden="true" tabindex="-1"></a>Im Weiteren haben wir zwei Typen von Daten für das Gurkenwachstum. Einmal messen wir den Durchmesser für jede Sorte (<span class="in">`D`</span> im Namen der Versuchsgruppe) oder aber die Länge (<span class="in">`L`</span> im Namen der Versuchsgruppe). Wir betrachten hier nur das Längenwachstum und deshalb filtern wir erstmal nach allen Versuchsgruppen mit einem <span class="in">`L`</span> im Namen. Am Ende schmeißen wir noch Spalten raus, die wir nicht weiter brauchen.</span>
<span id="cb52-112"><a href="#cb52-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-115"><a href="#cb52-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-116"><a href="#cb52-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-117"><a href="#cb52-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-118"><a href="#cb52-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-119"><a href="#cb52-119" aria-hidden="true" tabindex="-1"></a>gurke_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/wachstum_gurke.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-120"><a href="#cb52-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb52-121"><a href="#cb52-121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(versuchsgruppe, <span class="st">"L$"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb52-122"><a href="#cb52-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>pfl, <span class="sc">-</span>erntegewicht) <span class="sc">|&gt;</span> </span>
<span id="cb52-123"><a href="#cb52-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">versuchsgruppe =</span> <span class="fu">factor</span>(versuchsgruppe, </span>
<span id="cb52-124"><a href="#cb52-124" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Katrina"</span>, <span class="st">"Proloog"</span>, <span class="st">"Quarto"</span>))) </span>
<span id="cb52-125"><a href="#cb52-125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-126"><a href="#cb52-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-127"><a href="#cb52-127" aria-hidden="true" tabindex="-1"></a>In der @tbl-model-2 sehen wir einmal die rohen Daten dargestellt.</span>
<span id="cb52-128"><a href="#cb52-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-131"><a href="#cb52-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-132"><a href="#cb52-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-133"><a href="#cb52-133" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb52-134"><a href="#cb52-134" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Datensatz zu dem Längen- und Dickenwachstum von Gurken."</span></span>
<span id="cb52-135"><a href="#cb52-135" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-model-2</span></span>
<span id="cb52-136"><a href="#cb52-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-137"><a href="#cb52-137" aria-hidden="true" tabindex="-1"></a>gurke_raw_2_tbl <span class="ot">&lt;-</span> gurke_raw_tbl <span class="sc">|&gt;</span> </span>
<span id="cb52-138"><a href="#cb52-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">versuchsgruppe =</span> <span class="fu">as.character</span>(versuchsgruppe))</span>
<span id="cb52-139"><a href="#cb52-139" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(gurke_raw_2_tbl),</span>
<span id="cb52-140"><a href="#cb52-140" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(gurke_raw_2_tbl)),</span>
<span id="cb52-141"><a href="#cb52-141" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(gurke_raw_2_tbl)) <span class="sc">|&gt;</span> </span>
<span id="cb52-142"><a href="#cb52-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb52-143"><a href="#cb52-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-144"><a href="#cb52-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-145"><a href="#cb52-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-146"><a href="#cb52-146" aria-hidden="true" tabindex="-1"></a>Dann müssen wir die Daten noch in Long-Format bringen. Da wir dann auch noch auf zwei Arten die Daten über die Zeit darstellen wollen, brauchen wir einmal die Zeit als Faktor <span class="in">`time_fct`</span> und einmal als numerisch <span class="in">`time_num`</span>. Leider haben wir auch Gurken mit einer Länge von 0 cm, diese Gruken lassen wir jetzt mal drin, da wir ja eine robuste Regression noch rechnen wollen. Auch haben wir ab Woche 14 keine Messungen mehr in der Versuchsgruppe <span class="in">`Prolong`</span>, also nehmen wir auch nur die Daten bis zur vierzehnten Woche.</span>
<span id="cb52-147"><a href="#cb52-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-150"><a href="#cb52-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-151"><a href="#cb52-151" aria-hidden="true" tabindex="-1"></a>gurke_time_len_tbl <span class="ot">&lt;-</span> gurke_raw_tbl <span class="sc">|&gt;</span> </span>
<span id="cb52-152"><a href="#cb52-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t17,</span>
<span id="cb52-153"><a href="#cb52-153" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"length"</span>,</span>
<span id="cb52-154"><a href="#cb52-154" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"time"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-155"><a href="#cb52-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time_fct =</span> <span class="fu">as_factor</span>(time),</span>
<span id="cb52-156"><a href="#cb52-156" aria-hidden="true" tabindex="-1"></a>         <span class="at">time_num =</span> <span class="fu">as.numeric</span>(time_fct)) <span class="sc">|&gt;</span> </span>
<span id="cb52-157"><a href="#cb52-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time_num <span class="sc">&lt;=</span> <span class="dv">14</span>)</span>
<span id="cb52-158"><a href="#cb52-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-159"><a href="#cb52-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-160"><a href="#cb52-160" aria-hidden="true" tabindex="-1"></a>In der @fig-robust-gurke-00 sehen wir dann nochmal den Scatterplot für das Gurkenwachstum. Die gestrichtelten Linien stellen den Median und die durchgezogene Line den Mittelwert der Gruppen dar.</span>
<span id="cb52-161"><a href="#cb52-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-164"><a href="#cb52-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-165"><a href="#cb52-165" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb52-166"><a href="#cb52-166" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-167"><a href="#cb52-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-168"><a href="#cb52-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-robust-gurke-00</span></span>
<span id="cb52-169"><a href="#cb52-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb52-170"><a href="#cb52-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb52-171"><a href="#cb52-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb52-172"><a href="#cb52-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot des Längenwachstums der drei Gurkensorten über vierzehn Wochen. Die gestrichtelten Linien stellen den Median und die durchgezogene Line den Mittelwert der Gruppen dar."</span></span>
<span id="cb52-173"><a href="#cb52-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-174"><a href="#cb52-174" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gurke_time_len_tbl, <span class="fu">aes</span>(time_num, length, <span class="at">color =</span> versuchsgruppe)) <span class="sc">+</span></span>
<span id="cb52-175"><a href="#cb52-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-176"><a href="#cb52-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb52-177"><a href="#cb52-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb52-178"><a href="#cb52-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"median"</span>, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb52-179"><a href="#cb52-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb52-180"><a href="#cb52-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb52-181"><a href="#cb52-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-182"><a href="#cb52-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-183"><a href="#cb52-183" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gewöhnliche lineare Regression</span></span>
<span id="cb52-184"><a href="#cb52-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-185"><a href="#cb52-185" aria-hidden="true" tabindex="-1"></a>Damit wir einen Vergleich zu der robusten Regression und der Quantilsregression haben wollen wir hier zu Anfang nochmal schnell die gewöhnliche Regression (eng. *ordinary linear regression*), die du schon durch die Funktion <span class="in">`lm()`</span> kennst. Wir fitten also einmal das Modell mit Interaktionsterm für den Basilikumdatensatz.</span>
<span id="cb52-186"><a href="#cb52-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-189"><a href="#cb52-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-190"><a href="#cb52-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-191"><a href="#cb52-191" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-192"><a href="#cb52-192" aria-hidden="true" tabindex="-1"></a>basi_lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl)</span>
<span id="cb52-193"><a href="#cb52-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-194"><a href="#cb52-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-195"><a href="#cb52-195" aria-hidden="true" tabindex="-1"></a><span class="fu">### ANOVA</span></span>
<span id="cb52-196"><a href="#cb52-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-197"><a href="#cb52-197" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns nochmal den Interaktionsplot in @fig-stat-robust mit der Funktion <span class="in">`emmip()`</span> aus dem R Paket <span class="in">`{emmeans}`</span> an. Wir sehen, das wir eventuell eine leichte Interaktion vorliegen haben könnten, da sich einige der Geraden überschneiden.</span>
<span id="cb52-198"><a href="#cb52-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-201"><a href="#cb52-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-202"><a href="#cb52-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-203"><a href="#cb52-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb52-204"><a href="#cb52-204" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-205"><a href="#cb52-205" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb52-206"><a href="#cb52-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb52-207"><a href="#cb52-207" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb52-208"><a href="#cb52-208" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Interaktionsplot über die Versuchsgruppen und Blöcke.</span></span>
<span id="cb52-209"><a href="#cb52-209" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-stat-robust</span></span>
<span id="cb52-210"><a href="#cb52-210" aria-hidden="true" tabindex="-1"></a><span class="fu">emmip</span>(basi_lm_fit, versuchsgruppe <span class="sc">~</span> block, <span class="at">CIs =</span> <span class="cn">TRUE</span>, </span>
<span id="cb52-211"><a href="#cb52-211" aria-hidden="true" tabindex="-1"></a>      <span class="at">cov.reduce =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb52-212"><a href="#cb52-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-213"><a href="#cb52-213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb52-214"><a href="#cb52-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-215"><a href="#cb52-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-216"><a href="#cb52-216" aria-hidden="true" tabindex="-1"></a>Schauen wir einmal in eine zweifaktorielle ANOVA, ob sich unser leichter Verdacht validieren lässt.</span>
<span id="cb52-217"><a href="#cb52-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-220"><a href="#cb52-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-221"><a href="#cb52-221" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-222"><a href="#cb52-222" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-223"><a href="#cb52-223" aria-hidden="true" tabindex="-1"></a>basi_lm_fit <span class="sc">|&gt;</span> </span>
<span id="cb52-224"><a href="#cb52-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb52-225"><a href="#cb52-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span>
<span id="cb52-226"><a href="#cb52-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-227"><a href="#cb52-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-228"><a href="#cb52-228" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass wir mindestens einen paarweisen Unterschied zwischen den Versuchsgruppen und den Blöcken erwarten. Die Interaktion ist nicht signifikant. Betrachten wir noch kurz das $\eta^2$ um zu sehen, wie viel Varianz jeweils die Versuchsgruppe und Blöcke erklären.</span>
<span id="cb52-229"><a href="#cb52-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-232"><a href="#cb52-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-233"><a href="#cb52-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-234"><a href="#cb52-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-235"><a href="#cb52-235" aria-hidden="true" tabindex="-1"></a>basi_lm_fit <span class="sc">|&gt;</span> </span>
<span id="cb52-236"><a href="#cb52-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>()</span>
<span id="cb52-237"><a href="#cb52-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-238"><a href="#cb52-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-239"><a href="#cb52-239" aria-hidden="true" tabindex="-1"></a>Leider erklären hier die Blöcke sehr viel der Varianz, das ist nicht so schön, aber in diesem Kapitel lassen wir es dabei.</span>
<span id="cb52-240"><a href="#cb52-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-241"><a href="#cb52-241" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gruppenvergleich</span></span>
<span id="cb52-242"><a href="#cb52-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-243"><a href="#cb52-243" aria-hidden="true" tabindex="-1"></a>Wir haben keine Interaktion vorliegen, alos mitteln wir einmal über alle Blöcke. Wenn du den Code <span class="in">`| block`</span> zu dem Aufruf der <span class="in">`emmeans()`</span> Funktion hinzufügst, dann hast du die Analyse für die Blöcke getrennt durchgeführt.</span>
<span id="cb52-244"><a href="#cb52-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-247"><a href="#cb52-247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-248"><a href="#cb52-248" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-249"><a href="#cb52-249" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-250"><a href="#cb52-250" aria-hidden="true" tabindex="-1"></a>basi_lm_fit <span class="sc">|&gt;</span> </span>
<span id="cb52-251"><a href="#cb52-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> <span class="sc">~</span> versuchsgruppe) <span class="sc">|&gt;</span></span>
<span id="cb52-252"><a href="#cb52-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) </span>
<span id="cb52-253"><a href="#cb52-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-254"><a href="#cb52-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-255"><a href="#cb52-255" aria-hidden="true" tabindex="-1"></a>Wenn wir uns die unadjustierten $p$-Werte anschauen, dann sehen wir einen leichten Effekt zwischen den einzelnen Versuchsgruppen. Warum sage ich leichten Effekt? Die Mittelwerte der Gruppen in der spalte <span class="in">`emmean`</span> unterscheiden sich kaum. Aber soviel zu der gewöhnlichen Regression, das war ja hier nur der Vergleich und die Erinnerung.</span>
<span id="cb52-256"><a href="#cb52-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-257"><a href="#cb52-257" aria-hidden="true" tabindex="-1"></a><span class="fu">## Robuste Regression {#sec-robust-reg}</span></span>
<span id="cb52-258"><a href="#cb52-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-259"><a href="#cb52-259" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb52-260"><a href="#cb52-260" aria-hidden="true" tabindex="-1"></a><span class="fu">## Nur Normalverteilung? Geht auch mehr?</span></span>
<span id="cb52-261"><a href="#cb52-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-262"><a href="#cb52-262" aria-hidden="true" tabindex="-1"></a>Nein es geht auch mit allen anderen Modellen. So ist auch das <span class="in">`glm()`</span> für die robuste Regression implementiert. Wir schauen uns aber nur die Grundlagen für die klassische robuste Regression unter der Annahme eines nromalverteilten Outcomes an.</span>
<span id="cb52-263"><a href="#cb52-263" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb52-264"><a href="#cb52-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-265"><a href="#cb52-265" aria-hidden="true" tabindex="-1"></a>Bei einer robusten Regression werden jeder Beobachtung auf der Grundlage ihres Residuums unterschiedliche Gewichte (eng. *robustness weights*) von 0 bis 1 zugewiesen. Wir kennen ja ein Residuum als die Differenz zwischen den beobachteten und den vorhergesagten Werten der Daten. Die vorhergesagten Daten sind ja die Punkte auf der Geraden. Je kleiner also das Residuum ist, desto größer ist die Gewichtung und desto näher liegt eine Beobachtung an der geschätzten Geraden. Wir bestrafen also Punkte, die weit weg von unserer potenziellen Gerade liegen.</span>
<span id="cb52-266"><a href="#cb52-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-267"><a href="#cb52-267" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb52-268"><a href="#cb52-268" aria-hidden="true" tabindex="-1"></a>Ein englisches Tutorium gibt es dann nochmal ausführlicher unter <span class="co">[</span><span class="ot">R demo \| Robust Regression (don't depend on influential data!)</span><span class="co">](https://yuzar-blog.netlify.app/posts/2022-09-02-robustregression/)</span></span>
<span id="cb52-269"><a href="#cb52-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-270"><a href="#cb52-270" aria-hidden="true" tabindex="-1"></a>Ebenso liefert auch das Tutorium <span class="co">[</span><span class="ot">Robust regression \| R data analysis example</span><span class="co">](https://stats.oarc.ucla.edu/r/dae/robust-regression/)</span> einen Überblick.</span>
<span id="cb52-271"><a href="#cb52-271" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb52-272"><a href="#cb52-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-273"><a href="#cb52-273" aria-hidden="true" tabindex="-1"></a>Schauen wir uns das Problem an einem kleinen Spieldatensatz einmal an, den es so in vielen Geschmacksrichtungen gibt. Wir haben acht Beobachtungen mit jeweils einem $x$ und einem $y$ Wert in unserem Datensatz <span class="in">`reg_tbl`</span>. Wie folgt einmal dargestellt.</span>
<span id="cb52-274"><a href="#cb52-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-277"><a href="#cb52-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-278"><a href="#cb52-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-279"><a href="#cb52-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-280"><a href="#cb52-280" aria-hidden="true" tabindex="-1"></a>reg_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>),</span>
<span id="cb52-281"><a href="#cb52-281" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.4</span>, <span class="fl">2.5</span>, <span class="fl">2.7</span>, <span class="fl">4.3</span>, <span class="fl">5.2</span>, <span class="dv">0</span>, <span class="fl">6.7</span>))</span>
<span id="cb52-282"><a href="#cb52-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-283"><a href="#cb52-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-284"><a href="#cb52-284" aria-hidden="true" tabindex="-1"></a>Wir rechnen jetzt einmal eine gewöhnliche lineare Regression mit der Funktion <span class="in">`lm()`</span> und eine robuste Regression mit dem Paket <span class="in">`{MASS}`</span> und der Funtkion <span class="in">`rlm()`</span>. Es gibt noch das R Paket <span class="in">`{robustbase}`</span> und der Funktion <span class="in">`rq()`</span> aber wir können die Ergebnisse dann nicht in <span class="in">`{emmeans}`</span> weiter nutzen, was uns dann etwas den Weg mit versperrt. Wir können aber für die multiplen Mittelwertsvergleich mit <span class="in">`{robustbase}`</span> das R Paket <span class="in">`{multcomp}`</span> nutzen. Aber fangen wir hier erstmal mit dem Beispiel an und vergleichen die beiden Implementierungen der robusten Regression zu der gewöhnlichen Regression</span>
<span id="cb52-285"><a href="#cb52-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-288"><a href="#cb52-288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-289"><a href="#cb52-289" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-290"><a href="#cb52-290" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-291"><a href="#cb52-291" aria-hidden="true" tabindex="-1"></a>reg_lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, reg_tbl)</span>
<span id="cb52-292"><a href="#cb52-292" aria-hidden="true" tabindex="-1"></a>reg_rlm_fit <span class="ot">&lt;-</span> <span class="fu">rlm</span>(y <span class="sc">~</span> x, reg_tbl)</span>
<span id="cb52-293"><a href="#cb52-293" aria-hidden="true" tabindex="-1"></a>reg_lmrob_fit <span class="ot">&lt;-</span> <span class="fu">lmrob</span>(y <span class="sc">~</span> x, reg_tbl)</span>
<span id="cb52-294"><a href="#cb52-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-295"><a href="#cb52-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-296"><a href="#cb52-296" aria-hidden="true" tabindex="-1"></a>In der @fig-stat-robust-demo sehen wir einmal den Unterschied zwischen den beiden robusten Regressionen und der gewöhnlichen Regression.</span>
<span id="cb52-297"><a href="#cb52-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-300"><a href="#cb52-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-301"><a href="#cb52-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-302"><a href="#cb52-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb52-303"><a href="#cb52-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-304"><a href="#cb52-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb52-305"><a href="#cb52-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb52-306"><a href="#cb52-306" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb52-307"><a href="#cb52-307" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot für den Unterschied zwischen einer robusten und gewöhnlichen Regression. Die gewöhnliche Regression ist gelb, die robuste Regression MASS::rlm() grün und die robuste Regression robustbase::lmrob() blau."</span></span>
<span id="cb52-308"><a href="#cb52-308" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-stat-robust-demo</span></span>
<span id="cb52-309"><a href="#cb52-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-310"><a href="#cb52-310" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(reg_tbl, <span class="fu">aes</span>(x, y, <span class="at">label =</span> x)) <span class="sc">+</span></span>
<span id="cb52-311"><a href="#cb52-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-312"><a href="#cb52-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb52-313"><a href="#cb52-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(reg_lm_fit), <span class="at">colour =</span> <span class="st">"lm"</span>)) <span class="sc">+</span></span>
<span id="cb52-314"><a href="#cb52-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(reg_rlm_fit), <span class="at">colour =</span> <span class="st">"rlm"</span>)) <span class="sc">+</span></span>
<span id="cb52-315"><a href="#cb52-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(reg_lmrob_fit), <span class="at">colour =</span> <span class="st">"lmrob"</span>)) <span class="sc">+</span></span>
<span id="cb52-316"><a href="#cb52-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_okabeito</span>() <span class="sc">+</span></span>
<span id="cb52-317"><a href="#cb52-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">"Method"</span>)</span>
<span id="cb52-318"><a href="#cb52-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-319"><a href="#cb52-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-320"><a href="#cb52-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-321"><a href="#cb52-321" aria-hidden="true" tabindex="-1"></a>In unserem Beispiel ist die sechste Beobachtung der Ausreißer. Die <span class="in">`lm`</span>-Regression wird durch den Wert 0 der sechsten Beobachtung nach unten gezogen. Die sechste Beobachtung erhält ein viel zu starkes Gewicht in der gewöhnlichen Regression im Bezug auf den Verlauf der Geraden. Die robusten Regressionen geben der sechsten Beobachtung hingegen ein viel geringeres Gewicht, so dass die Beobachtung keinen Einfluss auf den Verlauf der Geraden hat. In einer robusten Regression erhält eine Beobachtung mit einem großen Residuum sehr wenig Gewicht, in diesem konstruierten Beispiel fast 0. Daher können wir sagen, das unser Modell *robust* gegen Ausreißer ist.</span>
<span id="cb52-322"><a href="#cb52-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-323"><a href="#cb52-323" aria-hidden="true" tabindex="-1"></a>Okay, soweit lernt es jeder und die Idee der robusten Regression ist auch ziemlich einleuchtend. Aber in der Wissenschaft zeichnen wir keine Gerade durch Punkte und freuen uns drüber, dass die eine gerade besser passt als die andere Gerade. Wir nutzen dann ja das Modell weiter in eine ANOVA oder aber eben in einem paarweisen Gruppenvergleich. Und hier fangen dann die Probleme der *Implementierung* an. Leider ist es so, dass nicht alle Funktionalitäten implementiert sind. Das heißt, die Funktion <span class="in">`anova()`</span> oder <span class="in">`emmeans()`</span> kann mit der Ausgabe der robusten Regressionen mit <span class="in">`MASS::rlm()`</span> und <span class="in">`robustbase::lmrob()`</span> nichts anfangen. Das ist problematisch und nicht anwenderfreundlich. Und wir sind hier nunmal Anwender...</span>
<span id="cb52-324"><a href="#cb52-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-325"><a href="#cb52-325" aria-hidden="true" tabindex="-1"></a>Warum so unbeliebt? Das ist eine gute Frage. Zu der robusten Regression gibt es eine lange Geschichte mit vielen Wirrungen und Irrungen. Am Ende kannst du in Wikipedia noch etwas zur <span class="co">[</span><span class="ot">History and unpopularity of robust regression</span><span class="co">](https://en.wikipedia.org/wiki/Robust_regression#History_and_unpopularity_of_robust_regression)</span> nachlesen. Nach @stromberg2004write hat es auch etwas mit der schlechten und mangelhaften Implementierung in gängiger Statistiksoftware zu tun. Das merke ich hier auch gerade, als ich versuche die Funktionen zusammen zubauen und miteinander zu vernetzen. Sicherlich gibt es auch die biologische Diskussion. Gibt es in biologischen Daten eigentlich überhaupt Ausreißer? Oder müssten wir nicht Ausreißer besonders betrachten, weil die Ausreißer dann doch mehr über die Daten verraten? Macht es also Sinn die Ausreißer einfach platt zu bügeln und nicht mehr weiter zu beachten oder ist nicht die Beobachtung Nr.6 oben von Interesse? Denn vielleicht ist was mit dem Experiment schief gelaufen und diese Beobachtung ist gerade ein Anzeichen dafür. Dann müssten auch die anderen Messwerte kritisch hinterfragt werden.</span>
<span id="cb52-326"><a href="#cb52-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-327"><a href="#cb52-327" aria-hidden="true" tabindex="-1"></a>Wie immer es auch sein. Wir fitten jetzt mal die beiden robusten Regression in der Standardausstattung mit der Funktion <span class="in">`MASS::rlm()`</span> aus dem Paket <span class="in">`{MASS}`</span> wie folgt.</span>
<span id="cb52-328"><a href="#cb52-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-331"><a href="#cb52-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-332"><a href="#cb52-332" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-333"><a href="#cb52-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-334"><a href="#cb52-334" aria-hidden="true" tabindex="-1"></a>basi_rlm_fit <span class="ot">&lt;-</span> <span class="fu">rlm</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl)</span>
<span id="cb52-335"><a href="#cb52-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-336"><a href="#cb52-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-337"><a href="#cb52-337" aria-hidden="true" tabindex="-1"></a>Dann natürlich noch die Funktion <span class="in">`robustbase::lmrob()`</span> aus dem Paket <span class="in">`{robustbase}`</span>. Hinter dem Paket <span class="in">`{robusbase}`</span> steht ein ganzen Buch von @maronna2019robust, aber leider keine gute Internetseite mit Beispielen und Anwendungen in R, wie es eigentlich heutzutage üblich ist. Aber dennoch, hier einmal das Modell.</span>
<span id="cb52-338"><a href="#cb52-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-341"><a href="#cb52-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-342"><a href="#cb52-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-343"><a href="#cb52-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-344"><a href="#cb52-344" aria-hidden="true" tabindex="-1"></a>basi_lmrob_fit <span class="ot">&lt;-</span> <span class="fu">lmrob</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl)</span>
<span id="cb52-345"><a href="#cb52-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-346"><a href="#cb52-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-347"><a href="#cb52-347" aria-hidden="true" tabindex="-1"></a><span class="fu">### ANOVA</span></span>
<span id="cb52-348"><a href="#cb52-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-349"><a href="#cb52-349" aria-hidden="true" tabindex="-1"></a>Dann wollen wir einmal eine zweifaktorielle ANOVA auf den Modell der robusten Regression mit der Funktion <span class="in">`MASS::rlm()`</span> rechnen. Leider kann ich schon gleich sagen, dass wir hier ein Problem kriegen. Es ist nicht ganz klar unter Theoretikern welche Anzahl an Beobachtungen für die Residuen in der robusten Regression genutzt werden soll. Welche Beobachtungen werden den im Modell berücksichtigt und welche nicht? Daher ist dann der Wert für die Freiheitsgrade $df$ leer und wir erhalten keine $F$-Statistik und dann auch keine $p$-Werte. Für mich super unbefriedigend, so kann man dann auch keine Funktionen richtig nutzen. Die Funktion <span class="in">`robustbase::lmrob()`</span> bietet die ANOVA nicht an.</span>
<span id="cb52-350"><a href="#cb52-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-353"><a href="#cb52-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-354"><a href="#cb52-354" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-355"><a href="#cb52-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-356"><a href="#cb52-356" aria-hidden="true" tabindex="-1"></a>basi_rlm_aov <span class="ot">&lt;-</span> basi_rlm_fit <span class="sc">|&gt;</span> </span>
<span id="cb52-357"><a href="#cb52-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb52-358"><a href="#cb52-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>()</span>
<span id="cb52-359"><a href="#cb52-359" aria-hidden="true" tabindex="-1"></a>basi_rlm_aov</span>
<span id="cb52-360"><a href="#cb52-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-361"><a href="#cb52-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-362"><a href="#cb52-362" aria-hidden="true" tabindex="-1"></a>Was als Freiheitsgrad für die Residuen nehmen? In unserem Datensatz haben wir <span class="in">`r nrow(basi_block_tbl)`</span> Basilikumpflanzen und somit auch Beobachtungen vorliegen. Wir setzen jetzt einfach brutal die Freiheitsgrade <span class="in">`df`</span> für die Residuen auf 80 und können dann die Mean Squares für die Residuen berechnen. Also einmal flott die <span class="in">`meansq`</span> für die Residuen durch die Anzahl an Beobachtungen geteilt.</span>
<span id="cb52-363"><a href="#cb52-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-366"><a href="#cb52-366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-367"><a href="#cb52-367" aria-hidden="true" tabindex="-1"></a>ms_resid <span class="ot">&lt;-</span> <span class="dv">527</span> <span class="sc">/</span> <span class="dv">80</span></span>
<span id="cb52-368"><a href="#cb52-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-369"><a href="#cb52-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-370"><a href="#cb52-370" aria-hidden="true" tabindex="-1"></a>Mit den Mean Square der Residuen können wir dann auch die $F$-Werte berechnen. Den rechnerischen Weg kennen wir ja schon aus der zweifaktoriellen ANOVA.</span>
<span id="cb52-371"><a href="#cb52-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-374"><a href="#cb52-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-375"><a href="#cb52-375" aria-hidden="true" tabindex="-1"></a>f_calc <span class="ot">&lt;-</span> basi_rlm_aov<span class="sc">$</span>meansq <span class="sc">/</span> ms_resid</span>
<span id="cb52-376"><a href="#cb52-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-377"><a href="#cb52-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-378"><a href="#cb52-378" aria-hidden="true" tabindex="-1"></a>Wie kriegen wir jetzt aus den ganzen berechneten $F$-Werten die entsprechenden $p$-Werte? Die $p$-Werte sind die Fläche rechts von den berechneten Werten. Wir können die Funktion <span class="in">`pf()`</span> nutzen um diese Flächen zu berechnen. Wir machen das einmal beispielhaft für einen $F_{calc} = 3.41$ für 4 Gruppen mit $df_1 = 4 - 1 = 3$ und 12 Beobachtungen $df_2 = 12$. Die Berechnung von $df_2$ ist statistisch *falsch* aber für unseren MacGyver Hack hinreichend.</span>
<span id="cb52-379"><a href="#cb52-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-382"><a href="#cb52-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-383"><a href="#cb52-383" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(<span class="fl">3.41</span>, <span class="dv">3</span>, <span class="dv">12</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb52-384"><a href="#cb52-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-385"><a href="#cb52-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-386"><a href="#cb52-386" aria-hidden="true" tabindex="-1"></a>Und siehe da, wir erhalten einen $p$-Wert von $0.053$. Nun können wir das nicht nur für einzelnen $F$-Werte machen sondern auch für unseren ganzen Vektor <span class="in">`f_calc`</span>. Als $df_2$ setzen wir die Anzahl an Basilikumpflanzen.</span>
<span id="cb52-387"><a href="#cb52-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-390"><a href="#cb52-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-391"><a href="#cb52-391" aria-hidden="true" tabindex="-1"></a>p_vec <span class="ot">&lt;-</span> <span class="fu">pf</span>(f_calc, <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">9</span>), <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">80</span>, <span class="dv">80</span>), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-392"><a href="#cb52-392" aria-hidden="true" tabindex="-1"></a>  scales<span class="sc">::</span><span class="fu">pvalue</span>()</span>
<span id="cb52-393"><a href="#cb52-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-394"><a href="#cb52-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-395"><a href="#cb52-395" aria-hidden="true" tabindex="-1"></a>Die berechneten $F$-Werte und $p$-Werte können wir jetzt in die ANOVA Tabelle ergänzen.</span>
<span id="cb52-396"><a href="#cb52-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-399"><a href="#cb52-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-400"><a href="#cb52-400" aria-hidden="true" tabindex="-1"></a>basi_rlm_aov <span class="sc">|&gt;</span> </span>
<span id="cb52-401"><a href="#cb52-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">statistic =</span> f_calc, </span>
<span id="cb52-402"><a href="#cb52-402" aria-hidden="true" tabindex="-1"></a>         <span class="at">p.value =</span> p_vec)</span>
<span id="cb52-403"><a href="#cb52-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-404"><a href="#cb52-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-405"><a href="#cb52-405" aria-hidden="true" tabindex="-1"></a>Das war jetzt ein ganz schöner Angang und den $p$-Werten ist nur approximativ zu trauen, aber wenn wir weit vom Signifikanzniveau $\alpha$ gleich 5% sind, dann macht eine numerische Ungenauigkeit auch nicht viel aus. Achtung deshalb bei $p$-Werten nahe des Signifikanzniveau $\alpha$, hier ist dann die Aussage mit Vorsicht zu treffen oder eher nicht möglich.</span>
<span id="cb52-406"><a href="#cb52-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-407"><a href="#cb52-407" aria-hidden="true" tabindex="-1"></a>Glücklicherweise können wir aus den Sum of squares dann unsere $\eta^2$-Werte für die erklärte Varianz unserer ANOVA berechnen. Das ist dann doch schon mal was. Wir sehen, dass die Blöcke am meisten der Varianz erklären und die Versuchsgruppen sehr wenig. Das ist für das Modell dann nicht so schön, deckt sich aber mit den Ergebnissen gewöhnlichen Regression. Wir erhalten eine Konfidenzintervalle, woran du schon erkennen kannst, dass in der Ausgabe der ANOVA der robusten Regression was fehlt.</span>
<span id="cb52-408"><a href="#cb52-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-411"><a href="#cb52-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-412"><a href="#cb52-412" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-413"><a href="#cb52-413" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-414"><a href="#cb52-414" aria-hidden="true" tabindex="-1"></a>basi_rlm_fit <span class="sc">|&gt;</span> </span>
<span id="cb52-415"><a href="#cb52-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eta_squared</span>()</span>
<span id="cb52-416"><a href="#cb52-416" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-417"><a href="#cb52-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-418"><a href="#cb52-418" aria-hidden="true" tabindex="-1"></a>Nochmal als Erinnerung, mit der Funktion <span class="in">`robustbase::lmrob()`</span> ist die ANOVA nicht möglich. Die Funktionalität ist nicht implementiert.</span>
<span id="cb52-419"><a href="#cb52-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-420"><a href="#cb52-420" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gruppenvergleich</span></span>
<span id="cb52-421"><a href="#cb52-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-422"><a href="#cb52-422" aria-hidden="true" tabindex="-1"></a>Dafür geht der Gruppenvergleich für die robuste Regression mit <span class="in">`MASS::rlm()`</span> wie von alleine. Wir haben keine Interaktion vorliegen, daher müssen wir auch nicht den Block berücksichtigen. Das wir in Block 1 ein Problem haben, steht dann aber auf einem anderen Blatt. Da aber *alle* Basilikumpflanzen immer im Block 1 kleiner sind, passt es dann wieder im Sinne keiner Interaktion. Mit Interaktion hätten wir sonst `versuchsgruppe | block` statt nur `versuchsgruppe` hinter die Tilde geschrieben. Dann wollen wir noch das *compact letter disply* und alles ist wie es sein sollte.</span>
<span id="cb52-423"><a href="#cb52-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-426"><a href="#cb52-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-427"><a href="#cb52-427" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-428"><a href="#cb52-428" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-429"><a href="#cb52-429" aria-hidden="true" tabindex="-1"></a>basi_rlm_fit <span class="sc">|&gt;</span> </span>
<span id="cb52-430"><a href="#cb52-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> <span class="sc">~</span> versuchsgruppe) <span class="sc">|&gt;</span></span>
<span id="cb52-431"><a href="#cb52-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) </span>
<span id="cb52-432"><a href="#cb52-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-433"><a href="#cb52-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-434"><a href="#cb52-434" aria-hidden="true" tabindex="-1"></a>Wir sehen also, dass sich Erde+Fließ und Erde nicht unterscheiden. Die beiden aber dann von Perlite+Fließ sowie Erde+Perlite. Am Ende unterscheiden sich Perlite+Fließ und Erde+Perlite nicht.</span>
<span id="cb52-435"><a href="#cb52-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-436"><a href="#cb52-436" aria-hidden="true" tabindex="-1"></a>Für die Funktion <span class="in">`robustbase::lmrob()`</span> müssen wir dann auf das R Paket <span class="in">`{multcomp}`</span> umswitchen. Hier kriegen wir dann ein Problem, wenn wir eine Interaktion vorliegen ahben, da ist <span class="in">`{multcomp}`</span> nicht so schön anzuwenden, wie dann <span class="in">`{emmeans}`</span>. Aber hier schauen wir uns dann mal die einfache Implementierung ohne Interaktion an. Bei einer Interaktion müssten wir dann händisch über die Funktion <span class="in">`filter()`</span> die Analysen für die einzelnen Blöcke aufspalten.</span>
<span id="cb52-437"><a href="#cb52-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-438"><a href="#cb52-438" aria-hidden="true" tabindex="-1"></a>Wir lassen jetzt aber erstmal auf dem Modell aus der Funktion <span class="in">`robustbase::lmrob()`</span> den paarweisen Vergleich nach Tukey laufen.</span>
<span id="cb52-439"><a href="#cb52-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-442"><a href="#cb52-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-443"><a href="#cb52-443" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-444"><a href="#cb52-444" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-445"><a href="#cb52-445" aria-hidden="true" tabindex="-1"></a>mult_lmrob <span class="ot">&lt;-</span> <span class="fu">glht</span>(basi_lmrob_fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">versuchsgruppe =</span> <span class="st">"Tukey"</span>))</span>
<span id="cb52-446"><a href="#cb52-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-447"><a href="#cb52-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-448"><a href="#cb52-448" aria-hidden="true" tabindex="-1"></a>Das erhaltende Objekt können wir dann mit <span class="in">`tidy()`</span> aufräumen und uns dann die gewünschten Spalten wiedergeben lassen.</span>
<span id="cb52-449"><a href="#cb52-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-452"><a href="#cb52-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-453"><a href="#cb52-453" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-454"><a href="#cb52-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-455"><a href="#cb52-455" aria-hidden="true" tabindex="-1"></a>mult_lmrob_tbl <span class="ot">&lt;-</span> mult_lmrob <span class="sc">|&gt;</span> </span>
<span id="cb52-456"><a href="#cb52-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-457"><a href="#cb52-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, conf.low, conf.high, adj.p.value) </span>
<span id="cb52-458"><a href="#cb52-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-459"><a href="#cb52-459" aria-hidden="true" tabindex="-1"></a>mult_lmrob_tbl</span>
<span id="cb52-460"><a href="#cb52-460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-461"><a href="#cb52-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-462"><a href="#cb52-462" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass wir mit der Adjustierung keinen signifikanten Unterschied zwischen den Bodensorten finden. Im Folgenden dann noch die Darstellung im *compact letter display*, wo wir etwas rumfrickeln müssen damit die Funktion <span class="in">`multcompLetters()`</span> auch die Kontraste aus der Funktion <span class="in">`glht()`</span> akzeptiert. Aber das haben wir dann alles zusammen.</span>
<span id="cb52-463"><a href="#cb52-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-466"><a href="#cb52-466" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-467"><a href="#cb52-467" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-468"><a href="#cb52-468" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-469"><a href="#cb52-469" aria-hidden="true" tabindex="-1"></a>mult_lmrob_tbl <span class="sc">|&gt;</span> </span>
<span id="cb52-470"><a href="#cb52-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb52-471"><a href="#cb52-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(adj.p.value, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb52-472"><a href="#cb52-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb52-473"><a href="#cb52-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Letters"</span>)</span>
<span id="cb52-474"><a href="#cb52-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-475"><a href="#cb52-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-476"><a href="#cb52-476" aria-hidden="true" tabindex="-1"></a>Auch hier sehen wir keinen Unterschied im *compact letter display* für die adjustierten $p$-Werte. Für die unadjustierten rohen $p$-Werte nutzen wir dann den Umweg über die `summary()` Funktion. Die unadjustierten $p$-Werte können wir dann auch in das *compact letter display* umwandeln lassen.</span>
<span id="cb52-477"><a href="#cb52-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-480"><a href="#cb52-480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-481"><a href="#cb52-481" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-482"><a href="#cb52-482" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-483"><a href="#cb52-483" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mult_lmrob, <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"none"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb52-484"><a href="#cb52-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb52-485"><a href="#cb52-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb52-486"><a href="#cb52-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p.value, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb52-487"><a href="#cb52-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb52-488"><a href="#cb52-488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Letters"</span>)</span>
<span id="cb52-489"><a href="#cb52-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-490"><a href="#cb52-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-491"><a href="#cb52-491" aria-hidden="true" tabindex="-1"></a>Und wenn man eine andere Funktion nutzt, dann kommen auch leicht andere Ergebnisse raus. Bei den rohen $p$-Werten haben wir jetzt etwas andere Unterschiede. Aber das liegt auch an den sehr ähnlichen Mittelwerten. So groß sind die Unterschiede nicht, so dass wir hier natürlich durch unterschiedliche Algorithmen leicht andere Ergebnisse kriegen. Wieder ein Grund die $p$-Werte zu adjustieren um dann auch konsistente Ergebnisse zu haben.</span>
<span id="cb52-492"><a href="#cb52-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-493"><a href="#cb52-493" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quantilsregression {#sec-quantile-reg}</span></span>
<span id="cb52-494"><a href="#cb52-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-495"><a href="#cb52-495" aria-hidden="true" tabindex="-1"></a>Jetzt wollen wir uns als Spezialfall der robusten Regression einmal die Quantilesregression anschauen. Wir der Name schon sagt, optimiert die Quantilregression nicht über den Mittelwert und die Standardabweichung als quadratische Abweichungen sondern über den Median und die absoluten Abweichungen. Wir haben es also hier mit einer Alternativen zu der gewöhnlichen Regression zu tun. Das schöne an der Quantilesregression ist, dass der Median nicht so anfällig gegenüber Ausreißern ist. Hier haben wir einen Vorteil. Wir können theoretisch auch andere Quantile als Referenzwert nehmen und die absoluten Abstände berechnen. Wenn wir aber später dann mit <span class="in">`emmeans`</span> die Gruppenvergleiche rechnen wollen, geht das nur über den Median.</span>
<span id="cb52-496"><a href="#cb52-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-497"><a href="#cb52-497" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb52-498"><a href="#cb52-498" aria-hidden="true" tabindex="-1"></a>Ein englisches Tutorium gibt es dann nochmal ausführlicher unter <span class="co">[</span><span class="ot">Quantile Regression as an useful Alternative for Ordinary Linear Regression</span><span class="co">](https://yuzar-blog.netlify.app/posts/2022-12-01-quantileregression/)</span></span>
<span id="cb52-499"><a href="#cb52-499" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb52-500"><a href="#cb52-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-501"><a href="#cb52-501" aria-hidden="true" tabindex="-1"></a>Um die Quantilesregression zu rechnen nutzen wir das R Paket <span class="in">`{quantreg}`</span> und die Funktion <span class="in">`rq()`</span>. Wichtig ist hier, dass wir das <span class="in">`tau`</span> auf $0.5$ setzen und somit dann eine Median-Regression rechnen. Wir können theoretisch auch andere Quantile als Referenz wählen, aber dann passt es nicht mehr mit <span class="in">`emmeans()`</span>. Wir nutzen hier auch nochmal die Gelegenheit zwei Modelle mit anzupassen. Wir rechnen einmal ein Modell mit einer linearen Komponente der Zeit <span class="in">`time_num`</span> und einmal ein Modell mit der quadratischen Komponente der Zeit mit <span class="in">`poly(time_num, 2)`</span> was nicht anderes als <span class="in">`time_num`</span>$^2$ ist. Neben dieser Variante ist mit <span class="in">`nlrq()`</span> auch eine Möglichkeit implementiert um noch komplexere nicht lineare Zusammenhänge zu modellieren. Hier dann einfach mal die Hilfeseite von <span class="in">`?nlrq`</span> anschauen.</span>
<span id="cb52-502"><a href="#cb52-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-505"><a href="#cb52-505" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-506"><a href="#cb52-506" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-507"><a href="#cb52-507" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-508"><a href="#cb52-508" aria-hidden="true" tabindex="-1"></a>time_rq_lin_fit <span class="ot">&lt;-</span> <span class="fu">rq</span>(length <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> time_num <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>time_num, <span class="at">tau =</span> <span class="fl">0.5</span>,</span>
<span id="cb52-509"><a href="#cb52-509" aria-hidden="true" tabindex="-1"></a>                      gurke_time_len_tbl)</span>
<span id="cb52-510"><a href="#cb52-510" aria-hidden="true" tabindex="-1"></a>time_rq_quad_fit <span class="ot">&lt;-</span> <span class="fu">rq</span>(length <span class="sc">~</span> versuchsgruppe <span class="sc">*</span> <span class="fu">poly</span>(time_num, <span class="dv">2</span>), <span class="at">tau =</span> <span class="fl">0.5</span>, </span>
<span id="cb52-511"><a href="#cb52-511" aria-hidden="true" tabindex="-1"></a>                       gurke_time_len_tbl)</span>
<span id="cb52-512"><a href="#cb52-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-513"><a href="#cb52-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-514"><a href="#cb52-514" aria-hidden="true" tabindex="-1"></a>In der @fig-robust-gurke-01 plotten wir einmal die Modelle aus der linearen und der quadratischen Anpassung des zeitlichen Verlaufs in die Abbildung. Wir sehen, dass das Modell mit der quadratischen Anpassung besser zu den Daten passt. Daher nutzen wir jetzt im weiteren das Modell <span class="in">`time_rq_quad_fit`</span>.</span>
<span id="cb52-515"><a href="#cb52-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-518"><a href="#cb52-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-519"><a href="#cb52-519" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb52-520"><a href="#cb52-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-521"><a href="#cb52-521" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-522"><a href="#cb52-522" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-robust-gurke-01</span></span>
<span id="cb52-523"><a href="#cb52-523" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb52-524"><a href="#cb52-524" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb52-525"><a href="#cb52-525" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb52-526"><a href="#cb52-526" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot des Längenwachstums der drei Gurkensorten über vierzehn Wochen. Die gestrichtelten Linien stellen den Median und die durchgezogene Line den Mittelwert der Gruppen dar."</span></span>
<span id="cb52-527"><a href="#cb52-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-528"><a href="#cb52-528" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gurke_time_len_tbl, <span class="fu">aes</span>(time_num, length, <span class="at">color =</span> versuchsgruppe)) <span class="sc">+</span></span>
<span id="cb52-529"><a href="#cb52-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-530"><a href="#cb52-530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb52-531"><a href="#cb52-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb52-532"><a href="#cb52-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(time_rq_quad_fit), <span class="at">linetype =</span> <span class="st">"Quadratic"</span>)) <span class="sc">+</span></span>
<span id="cb52-533"><a href="#cb52-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(time_rq_lin_fit), <span class="at">linetype =</span> <span class="st">"Linear"</span>)) <span class="sc">+</span></span>
<span id="cb52-534"><a href="#cb52-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb52-535"><a href="#cb52-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">linetype =</span> <span class="st">""</span>, <span class="at">color =</span> <span class="st">""</span>)</span>
<span id="cb52-536"><a href="#cb52-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-537"><a href="#cb52-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-538"><a href="#cb52-538" aria-hidden="true" tabindex="-1"></a><span class="fu">### ANOVA</span></span>
<span id="cb52-539"><a href="#cb52-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-540"><a href="#cb52-540" aria-hidden="true" tabindex="-1"></a>Machen wir es kurz. Die ANOVA ist für die Quantilsregression nicht implementiert und damit auch nicht anwendbar. Damit können wir aber leben, wenn wir die ANOVA nur als Vortest ansehen. Wir müssen dann eine mögliche Interaktion visuell überprüfen. Um die Interaktion visuell zu überprüfen nutzen wir die Funktion <span class="in">`emimp()`</span> aus dem R Paket <span class="in">`{emmeans}`</span>. Wir sehen in der @fig-rob-inter-time, dass sich die Gerade für die Versuchsgruppen über die Zeit nicht schneiden, was gegen eine starke Interaktion spricht. Die Steigung ist aber für alle drei Versuchsgruppen über die Zeit nicht gleich, wir haben zumindest eine mittlere Interaktion.</span>
<span id="cb52-541"><a href="#cb52-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-544"><a href="#cb52-544" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-545"><a href="#cb52-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-546"><a href="#cb52-546" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb52-547"><a href="#cb52-547" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-548"><a href="#cb52-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb52-549"><a href="#cb52-549" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb52-550"><a href="#cb52-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb52-551"><a href="#cb52-551" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-rob-inter-time</span></span>
<span id="cb52-552"><a href="#cb52-552" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Interaktionsplot über den zeitlichen Verlauf für alle drei Sorten für die Quantilesregression."</span></span>
<span id="cb52-553"><a href="#cb52-553" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb52-554"><a href="#cb52-554" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Linear"</span></span>
<span id="cb52-555"><a href="#cb52-555" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Quadratic"</span></span>
<span id="cb52-556"><a href="#cb52-556" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-nrow: 1</span></span>
<span id="cb52-557"><a href="#cb52-557" aria-hidden="true" tabindex="-1"></a><span class="fu">emmip</span>(time_rq_lin_fit, versuchsgruppe <span class="sc">~</span> time_num, <span class="at">CIs =</span> <span class="cn">TRUE</span>, </span>
<span id="cb52-558"><a href="#cb52-558" aria-hidden="true" tabindex="-1"></a>      <span class="at">cov.reduce =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb52-559"><a href="#cb52-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-560"><a href="#cb52-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb52-561"><a href="#cb52-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-562"><a href="#cb52-562" aria-hidden="true" tabindex="-1"></a><span class="fu">emmip</span>(time_rq_quad_fit, versuchsgruppe <span class="sc">~</span> time_num, <span class="at">CIs =</span> <span class="cn">TRUE</span>, </span>
<span id="cb52-563"><a href="#cb52-563" aria-hidden="true" tabindex="-1"></a>      <span class="at">cov.reduce =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb52-564"><a href="#cb52-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-565"><a href="#cb52-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb52-566"><a href="#cb52-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-567"><a href="#cb52-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-568"><a href="#cb52-568" aria-hidden="true" tabindex="-1"></a>Wir würden also in unseren Gruppenvergleich der Mediane auf jeden Fall die Interaktion mit rein nehmen und die <span class="in">`emmeans()`</span> Funktion entsprechend mit dem <span class="in">`|`</span> anpassen.</span>
<span id="cb52-569"><a href="#cb52-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-570"><a href="#cb52-570" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gruppenvergleich</span></span>
<span id="cb52-571"><a href="#cb52-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-572"><a href="#cb52-572" aria-hidden="true" tabindex="-1"></a>Wenn wir den Gruppenvergleich in <span class="in">`emmeans()`</span> rechnen wollen, dann geht es nur dem Spezialfall der Median-Regression. Wir müssen also zwangsweise in der Quantilesregression <span class="in">`rq()`</span> das <span class="in">`tau = 0.5`</span> setzen um dann eine Median-Regression zu rechnen. Sonst können wir nicht <span class="in">`emmeans`</span> nutzen.</span>
<span id="cb52-573"><a href="#cb52-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-576"><a href="#cb52-576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-577"><a href="#cb52-577" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-578"><a href="#cb52-578" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-579"><a href="#cb52-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-580"><a href="#cb52-580" aria-hidden="true" tabindex="-1"></a>time_rq_quad_fit <span class="sc">|&gt;</span> </span>
<span id="cb52-581"><a href="#cb52-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> versuchsgruppe <span class="sc">|</span> time_num, </span>
<span id="cb52-582"><a href="#cb52-582" aria-hidden="true" tabindex="-1"></a>          <span class="at">adjust =</span> <span class="st">"none"</span>, <span class="at">at =</span> <span class="fu">list</span>(<span class="at">time_num =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">14</span>))) <span class="sc">|&gt;</span></span>
<span id="cb52-583"><a href="#cb52-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) </span>
<span id="cb52-584"><a href="#cb52-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-585"><a href="#cb52-585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-586"><a href="#cb52-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-587"><a href="#cb52-587" aria-hidden="true" tabindex="-1"></a>Das sieht ja schon mal ganz gut aus. Interessant ist, dass wir an dann in der vierzehnten Woche dann keinen signifikanten Unterschied mehr vorliegen zwischen Quarto und Katrina vorliegen haben. Das liegt dann aber alleinig an dem hohen Standardfehler <span class="in">`SE`</span> der Sorte Katrina mit $3.1$ gegenüber den anderen Sorten. Vermutlich sehe das Ergebnis leicht anders aus, wenn wir die unsinnigen Gurken mit einer Länge von 0 cm wirklich aus den Dten entfernen würden und nicht zu Demonstrationszwecken wie hier drin lassen würden.</span>
<span id="cb52-588"><a href="#cb52-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-589"><a href="#cb52-589" aria-hidden="true" tabindex="-1"></a>Aber Achtung, die Spalte <span class="in">`emmean`</span> beschriebt hier die Mediane. Wir haben also hier die Mediane des Längenwachstums für die Gurken vorliegen. Wenn wir die paarweisen Vergleich rechnen wollen würden dann können wir noch <span class="in">`pairwise ~ versuchsgruppe`</span> statt <span class="in">`~ versuchsgruppe`</span> schreiben. Auch liefert die Funktion <span class="in">`pwpm()`</span> die Medianunterschiede wie wir im Folgenden einmal sehen. Ich habe hier mal das <span class="in">`at`</span> entfernt und da die Zeit numrisch ist, haben wir dann auch nur noch eine Tabelle. Die <span class="in">`Diagonal: [Estimates] (emmean)`</span> sind die Mediane des Längenwachstums.</span>
<span id="cb52-590"><a href="#cb52-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-593"><a href="#cb52-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-594"><a href="#cb52-594" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-595"><a href="#cb52-595" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-596"><a href="#cb52-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-597"><a href="#cb52-597" aria-hidden="true" tabindex="-1"></a>time_rq_quad_fit <span class="sc">|&gt;</span> </span>
<span id="cb52-598"><a href="#cb52-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> versuchsgruppe <span class="sc">|</span> time_num, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span></span>
<span id="cb52-599"><a href="#cb52-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>()</span>
<span id="cb52-600"><a href="#cb52-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-601"><a href="#cb52-601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-602"><a href="#cb52-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-603"><a href="#cb52-603" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modellvergleich</span></span>
<span id="cb52-604"><a href="#cb52-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-605"><a href="#cb52-605" aria-hidden="true" tabindex="-1"></a>Im Folgenden wollen wir einmal verschiedene Modelle miteinander vergleichen und schauen, welches Modell hier das beste ist. Das machen wir dann einmal für die Basilikumdaten sowie die Wachstumsdaten für die Gurken.</span>
<span id="cb52-606"><a href="#cb52-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-607"><a href="#cb52-607" aria-hidden="true" tabindex="-1"></a><span class="fu">### Basilikumdaten</span></span>
<span id="cb52-608"><a href="#cb52-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-609"><a href="#cb52-609" aria-hidden="true" tabindex="-1"></a>Für den Modellvergleich der gewöhnlichen, robusten und medianen Regression nutzen wir nochmal den Datensatz für das Basilikumwachstum. In einem ersten Schritt fitten wir wieder alle Modelle und achten darauf, dass wir bei der Quantilesregression angeben welches Quantile wir wollen. Wir wählen mit <span class="in">`tau = 0.5`</span> dann den Median und rechnen so eine Medianregression.</span>
<span id="cb52-610"><a href="#cb52-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-613"><a href="#cb52-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-614"><a href="#cb52-614" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-615"><a href="#cb52-615" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-616"><a href="#cb52-616" aria-hidden="true" tabindex="-1"></a>basi_lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl)</span>
<span id="cb52-617"><a href="#cb52-617" aria-hidden="true" tabindex="-1"></a>basi_rlm_fit <span class="ot">&lt;-</span> <span class="fu">rlm</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl)</span>
<span id="cb52-618"><a href="#cb52-618" aria-hidden="true" tabindex="-1"></a>basi_lmrob_fit <span class="ot">&lt;-</span> <span class="fu">lmrob</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl)</span>
<span id="cb52-619"><a href="#cb52-619" aria-hidden="true" tabindex="-1"></a>basi_rq_fit <span class="ot">&lt;-</span> <span class="fu">rq</span>(weight <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> block <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>block, basi_block_tbl,</span>
<span id="cb52-620"><a href="#cb52-620" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tau =</span> <span class="fl">0.5</span>)</span>
<span id="cb52-621"><a href="#cb52-621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-622"><a href="#cb52-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-623"><a href="#cb52-623" aria-hidden="true" tabindex="-1"></a>Im Folgenden nutzen wir dann das fantastische Paket <span class="in">`{modelsummary}`</span> mit der gleichnamigen Funktion um uns einmal die Modelle im Vergleich anzuschauen. Hier hilft dann wie immer die tolle <span class="co">[</span><span class="ot">Hilfsseite von `{modelsummary}`</span><span class="co">](https://vincentarelbundock.github.io/modelsummary/articles/modelsummary.html)</span> zu besuchen. Ich möchte nur nicht den Intercept und die Schätzer für die Blöcke haben, deshalb fliegen die hier einmal raus.</span>
<span id="cb52-624"><a href="#cb52-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-627"><a href="#cb52-627" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-628"><a href="#cb52-628" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"Ordinary"</span> <span class="ot">=</span> basi_lm_fit,</span>
<span id="cb52-629"><a href="#cb52-629" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"MASS::rlm"</span> <span class="ot">=</span> basi_rlm_fit,</span>
<span id="cb52-630"><a href="#cb52-630" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"robustbase::lmrob"</span> <span class="ot">=</span> basi_lmrob_fit,</span>
<span id="cb52-631"><a href="#cb52-631" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Quantile"</span> <span class="ot">=</span> basi_rq_fit),</span>
<span id="cb52-632"><a href="#cb52-632" aria-hidden="true" tabindex="-1"></a>             <span class="at">estimate  =</span> <span class="st">"{estimate}"</span>,</span>
<span id="cb52-633"><a href="#cb52-633" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"conf.int"</span>,</span>
<span id="cb52-634"><a href="#cb52-634" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"s.e. = {std.error}"</span>, </span>
<span id="cb52-635"><a href="#cb52-635" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"t = {statistic}"</span>,</span>
<span id="cb52-636"><a href="#cb52-636" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"p = {p.value}"</span>),</span>
<span id="cb52-637"><a href="#cb52-637" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_omit =</span> <span class="st">"Intercept|block"</span>)</span>
<span id="cb52-638"><a href="#cb52-638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-639"><a href="#cb52-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-640"><a href="#cb52-640" aria-hidden="true" tabindex="-1"></a>Wie wir sehen sehen haben nicht alle Modelle die gleichen Informationen zurück gegeben. Insbesondere das fehlen des Bestimmtheitsmaßes $R^2$ bei der robusten Regression <span class="in">`MASS::rlm`</span> ist schmerzlich, da wir hier dann nicht die Möglichkeit haben eine Aussage über die erklärte Varianz der robusten Regression zu treffen. Auch fehlt bei der Medianregression das adjustierte $R^2$, was die Nutzung bei Modellen mit mehr als einer Einflussvariable $x$ im Modell erschwert bis nutzlos macht. Da ist dann die Funktion aus dem Paket <span class="in">`{robustbase}`</span> besser, hier haben wir dann ein $R^2$ vorliegen. Daher bleibt uns am Ende nur das AIC oder BIC, wobei wir dort den kleinsten Wert als besser erachten. Die AIC und BIC Werte sind somit am besten für die Quantilesregression. Für die Funktion <span class="in">`robustbase::lmrob`</span> haben wir dann kein AIC. Dafür ist dann aber der Fehler RMSE bei der gewöhnlichen Regressionzusammen mit der Funktion <span class="in">`robustbase::lmrob`</span> am niedrigsten. Und so stehe ich wieder davor und weiß nicht was das beste Modell ist. Hier müsste ich dann nochmal überlegen, ob ich lieber über Mittelwerte oder Mediane berichten möchte und das ist ohne die Forschungsfrage nicht hier zu lösen.</span>
<span id="cb52-641"><a href="#cb52-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-642"><a href="#cb52-642" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gurkendaten</span></span>
<span id="cb52-643"><a href="#cb52-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-644"><a href="#cb52-644" aria-hidden="true" tabindex="-1"></a>Für den Modellvergleich der gewöhnlichen, robusten und medianen Regression nutzen wir nochmal den Datensatz für das Längenwachstum der Gurken. In einem ersten Schritt fitten wir wieder alle Modelle und achten darauf, dass wir bei der Quantilesregression angeben welches Quantile wir wollen. Wir wählen mit <span class="in">`tau = 0.5`</span> dann den Median und rechnen so eine Median-Regression. Darüber hinaus schauen wir uns nochmal die quadratische Anpassung der Zeit in dem letzten Modell an. Mal schauen, ob das Modell dann auch bei den Kennzahlen das beste Modell ist. Visuell sah das quadratische Modell des zeitlichen Verlaufs schon mal sehr gut aus.</span>
<span id="cb52-645"><a href="#cb52-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-648"><a href="#cb52-648" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-649"><a href="#cb52-649" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb52-650"><a href="#cb52-650" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb52-651"><a href="#cb52-651" aria-hidden="true" tabindex="-1"></a>time_lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(length <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> time_num <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>time_num, gurke_time_len_tbl)</span>
<span id="cb52-652"><a href="#cb52-652" aria-hidden="true" tabindex="-1"></a>time_rlm_fit <span class="ot">&lt;-</span> <span class="fu">rlm</span>(length <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> time_num <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>time_num, gurke_time_len_tbl)</span>
<span id="cb52-653"><a href="#cb52-653" aria-hidden="true" tabindex="-1"></a>time_rq_lin_fit <span class="ot">&lt;-</span> <span class="fu">rq</span>(length <span class="sc">~</span> versuchsgruppe <span class="sc">+</span> time_num <span class="sc">+</span> versuchsgruppe<span class="sc">:</span>time_num, <span class="at">tau =</span> <span class="fl">0.5</span>,</span>
<span id="cb52-654"><a href="#cb52-654" aria-hidden="true" tabindex="-1"></a>                      gurke_time_len_tbl)</span>
<span id="cb52-655"><a href="#cb52-655" aria-hidden="true" tabindex="-1"></a>time_rq_quad_fit <span class="ot">&lt;-</span> <span class="fu">rq</span>(length <span class="sc">~</span> versuchsgruppe <span class="sc">*</span> <span class="fu">poly</span>(time_num, <span class="dv">2</span>), <span class="at">tau =</span> <span class="fl">0.5</span>, </span>
<span id="cb52-656"><a href="#cb52-656" aria-hidden="true" tabindex="-1"></a>                       gurke_time_len_tbl)</span>
<span id="cb52-657"><a href="#cb52-657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-658"><a href="#cb52-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-659"><a href="#cb52-659" aria-hidden="true" tabindex="-1"></a>Auch hier nutzen wir dann das fantastische Paket <span class="in">`{modelsummary}`</span> mit der gleichnamigen Funktion um uns einmal die Modelle im Vergleich anzuschauen.</span>
<span id="cb52-660"><a href="#cb52-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-663"><a href="#cb52-663" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb52-664"><a href="#cb52-664" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"Ordinary"</span> <span class="ot">=</span> time_lm_fit,</span>
<span id="cb52-665"><a href="#cb52-665" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Robust"</span> <span class="ot">=</span> time_rlm_fit,</span>
<span id="cb52-666"><a href="#cb52-666" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Quantile linear"</span> <span class="ot">=</span> time_rq_lin_fit,</span>
<span id="cb52-667"><a href="#cb52-667" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Quantile quadratic"</span> <span class="ot">=</span> time_rq_quad_fit),</span>
<span id="cb52-668"><a href="#cb52-668" aria-hidden="true" tabindex="-1"></a>             <span class="at">estimate  =</span> <span class="st">"{estimate}"</span>,</span>
<span id="cb52-669"><a href="#cb52-669" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"conf.int"</span>,</span>
<span id="cb52-670"><a href="#cb52-670" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"s.e. = {std.error}"</span>, </span>
<span id="cb52-671"><a href="#cb52-671" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"t = {statistic}"</span>,</span>
<span id="cb52-672"><a href="#cb52-672" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"p = {p.value}"</span>),</span>
<span id="cb52-673"><a href="#cb52-673" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_omit =</span> <span class="st">"Intercept|time_num"</span>)</span>
<span id="cb52-674"><a href="#cb52-674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb52-675"><a href="#cb52-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-676"><a href="#cb52-676" aria-hidden="true" tabindex="-1"></a>Hier sieht es ähnlich aus wie bei den Modellvergleichen von den Basilikumdaten. Nur hier wissen wir, dass wir Ausreißer in der Form von Gurken mit einer Länge von 0 cm in den Daten haben. Daher sehen wir auch, dass die robuste Regression und die Median-Regression ein niedrigeres AIC und BIC haben. Für mich interessant ist, dass der Fehler RMSE wieder am kleinsten bei der gewöhnlichen Regression ist, das mag aber auch an der Berechnung liegen. Da wir Ausreißer haben, sind natürlich dann auch die robuste Regression und die Median-Regression vorzuziehen. Da die Median-Regression den kleineren AIC Wert hat, nehmen wir dann die Median-Regression als die beste Regression an. Der RMSE ist am kleinsten für die quadratische Anpassung des zeitlichen Verlaufs. Deshalb wäre dann das vierte Modell mit dem niedrigsten AIC und dem niedrigsten RMSE das Modell der Wahl.</span>
<span id="cb52-677"><a href="#cb52-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-678"><a href="#cb52-678" aria-hidden="true" tabindex="-1"></a>Ich wiederhole mich hier wirklich, aber vermutlich wäre es schlauer zuerst die Daten zu bereinigen und die Gurken mit einem Wachstum von 0 cm zu entfernen. Auch die anderen Wachstumskurven von anderen Gurken sind etwas wirr. Da müsste man auch nochmal ran und schauen, ob nicht die Gurken lieber aus der Analyse raus müssen. Am Ende ist dann natürlich die Frage, ob man die Daten dann nicht doch lieber über ein gemischtes Modell auswertet, da natürlich die Zeitpunkte voneinander abhängig sind, wenn wir immer die glecihen Gurken messen und nicht ernten. Aber wie immer im Leben, alles geht nicht.</span>
<span id="cb52-679"><a href="#cb52-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-680"><a href="#cb52-680" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-robust-quantile.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-robust-quantile.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
```{r echo = FALSE}
#| warning: false
#| message: false
pacman::p_load(tidyverse, readxl, knitr, kableExtra, see,
               latex2exp, patchwork, parsnip, ggdag, conflicted)
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
conflicts_prefer(dplyr::filter)
set.seed(20250701)
theme_modeling <- function() {
  theme_minimal() +
    theme(panel.grid.minor = element_blank(),
          plot.background = element_rect(fill = "white", color = NA),
          plot.title = element_text(size = 16, face = "bold"),
          plot.subtitle = element_text(size = 12, face = "italic"),
          plot.caption = element_text(face = "italic"),
          axis.title = element_text(size = 12, face = "bold"),
          axis.text = element_text(size = 12),
          strip.text = element_text(face = "bold"),
          strip.background = element_rect(fill = "grey80", color = NA))
}
```

```{r}
#| echo: false
#| message: false
#| warning: false
source("images/R/stat-modeling-R.R")
```

# Mediatoranalyse {#sec-modeling-mediator}

*Letzte Änderung am `r format(fs::file_info("stat-modeling-mediator.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*

> *"The whole world is a very narrow bridge and the main thing is to have no fear at all." --- [Kol Ha'Olam Kulo](https://jwa.org/media/lyrics-to-kol-haolam-kulo)*

![](images/caution.png){fig-align="center" width="100%"}

::: {.callout-caution appearance="simple"}
## Stand des Kapitels: Konstruktion (pausiert)

Dieses Kapitel wird in den nächsten Monaten geschrieben und ist damit eine zukünftige Großbaustelle. Ich plane zum Beginn des SoSe 2026 eine fertige Version des Kapitels erstellt zu haben. Während das Kapitel entsteht, funktioniert so manches dann nicht so wie es soll. Bitte daher hier dann abwarten.
:::

## Allgemeiner Hintergrund

[Simulating confounders, colliders and mediators](https://freerangestats.info/blog/2023/06/04/causality-sims)

[Statistical Control Requires Causal Justification](https://journals.sagepub.com/doi/10.1177/25152459221095823)

[Causal influence and DAGs](https://dtkaplan.github.io/Lessons-in-statistical-thinking/L24-Causality-and-DAGS.html)

In dem Begriff des Disturber (deu. *Störenfried*, abk. $D$) fassen wir die Begriffe des Confounder (deu. *Störfaktor*, abk. $D_{con}$), Collider (deu. *Zusammenstoßen*, abk. $D_{col}$) und Mediator (deu. *Vermittlern*, abk. $D_{med}$) zusammen.

```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-align: center
#| fig-height: 3
#| fig-width: 9
#| fig-cap: "foo **(A)** Confounder **(B)** Collider **(C)** Mediator. *[Zum Vergrößern anklicken]*"
#| label: fig-model-m-dag

arrow_col <- "grey70"
set.seed(123)
p1_dag <- dagify(
  Y ~ X + C,
  X ~ C
) %>%
  ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
  geom_dag_edges_fan(aes(label = c("Effekt", "Effekt", "", "")),
                     edge_colour = arrow_col, label_size = 5, edge_width = 1,
                     label_colour = "black") +
  geom_dag_text(colour = "black", size = 5.5, parse = TRUE,
                label = c(expression(bold(D[con])), expression(bold(X)), expression(bold(Y)))) +
  theme_dag() +
  labs(title = "Confounder") +
  theme(plot.title = element_text(size = 16, face = "bold"),
        plot.caption = element_text(face = "italic")) 

set.seed(123)
p2_dag <- 
dagify(
  C ~ X + Y,
  Y ~ X
) %>%
  ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
  geom_dag_edges_fan(aes(label = c("", "Effekt", "", "Effekt")),
                     edge_colour = arrow_col, label_size = 5, edge_width = 1,
                     label_colour = "black") +
  geom_dag_text(colour = "black", size = 5.5, parse = TRUE,
                label = c(expression(bold(D[col])), expression(bold(X)), expression(bold(Y)))) +
  theme_dag() +
  labs(title = "Collider") +
  theme(plot.title = element_text(size = 16, face = "bold"),
        plot.caption = element_text(face = "italic")) 

set.seed(123)
p3_dag <- 
dagify(
  C ~ X,
  Y ~ X + C
) %>%
  ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
  geom_dag_edges_fan(aes(label = c("Effekt", "Effekt", "", "")),
                     edge_colour = arrow_col, label_size = 5, edge_width = 1,
                     label_colour = "black") +
  geom_dag_text(colour = "black", size = 5.5, parse = TRUE,
                label = c(expression(bold(D[med])), expression(bold(X)), expression(bold(Y)))) +
  theme_dag() +
  labs(title = "Mediator") +
  theme(plot.title = element_text(size = 16, face = "bold"),
        plot.caption = element_text(face = "italic")) 

p1_dag + p2_dag + p3_dag +
  plot_layout(ncol = 3) +
  plot_annotation(tag_levels = 'A', tag_prefix = '(', tag_suffix = ')') &
  theme(plot.tag = element_text(size = 16, face = "bold"))

```

## Theoretischer Hintergrund

## Genutzte R Pakete

Wir wollen folgende R Pakete in diesem Kapitel nutzen.

```{r echo = TRUE}
#| message: false
pacman::p_load(tidyverse, emmeans, multcomp, ggpmisc, conflicted)
conflicts_prefer(dplyr::select)
conflicts_prefer(ggplot2::annotate)
```

An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.

## Daten

## Mediatoranalyse

## Referenzen {.unnumbered}

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>42&nbsp; Der Post-hoc Test – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-linear-reg-preface.html" rel="next">
<link href="./stat-tests-permutationstest.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<meta name="mermaid-theme" content="neutral">
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="42&nbsp; Der Post-hoc Test – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-posthoc2.html"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>purrr</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#theoretischer-hintergrund" id="toc-theoretischer-hintergrund" class="nav-link active" data-scroll-target="#theoretischer-hintergrund"><span class="header-section-number">42.1</span> Theoretischer Hintergrund</a></li>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">42.2</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">42.3</span> Daten</a></li>
  <li><a href="#modell" id="toc-modell" class="nav-link" data-scroll-target="#modell"><span class="header-section-number">42.4</span> Modell</a>
  <ul class="collapse">
  <li><a href="#faktorielle-analyse" id="toc-faktorielle-analyse" class="nav-link" data-scroll-target="#faktorielle-analyse"><span class="header-section-number">42.4.1</span> Faktorielle Analyse</a></li>
  <li><a href="#der-messwert-y" id="toc-der-messwert-y" class="nav-link" data-scroll-target="#der-messwert-y"><span class="header-section-number">42.4.2</span> Der Messwert <span class="math inline">\(y\)</span></a></li>
  <li><a href="#die-faktoren-f" id="toc-die-faktoren-f" class="nav-link" data-scroll-target="#die-faktoren-f"><span class="header-section-number">42.4.3</span> Die Faktoren <span class="math inline">\(f\)</span></a></li>
  </ul></li>
  <li><a href="#sec-emmeans" id="toc-sec-emmeans" class="nav-link" data-scroll-target="#sec-emmeans"><span class="header-section-number">42.5</span> Der effektive Pfad mit <code>{emmeans}</code></a></li>
  <li><a href="#fallbeispiele-mit-emmeans" id="toc-fallbeispiele-mit-emmeans" class="nav-link" data-scroll-target="#fallbeispiele-mit-emmeans"><span class="header-section-number">42.6</span> Fallbeispiele mit <code>{emmeans}</code></a></li>
  <li><a href="#der-anova-pfad-mit-tukey-hsd" id="toc-der-anova-pfad-mit-tukey-hsd" class="nav-link" data-scroll-target="#der-anova-pfad-mit-tukey-hsd"><span class="header-section-number">42.7</span> Der ANOVA Pfad mit Tukey HSD</a></li>
  <li><a href="#weitere-pfade" id="toc-weitere-pfade" class="nav-link" data-scroll-target="#weitere-pfade"><span class="header-section-number">42.8</span> Weitere Pfade</a>
  <ul class="collapse">
  <li><a href="#paarweise-tests" id="toc-paarweise-tests" class="nav-link" data-scroll-target="#paarweise-tests"><span class="header-section-number">42.8.1</span> Paarweise Tests</a></li>
  <li><a href="#games-howell-test" id="toc-games-howell-test" class="nav-link" data-scroll-target="#games-howell-test"><span class="header-section-number">42.8.2</span> Games Howell Test</a></li>
  <li><a href="#r-paket-multcomp" id="toc-r-paket-multcomp" class="nav-link" data-scroll-target="#r-paket-multcomp"><span class="header-section-number">42.8.3</span> R Paket <code>{multcomp}</code></a></li>
  <li><a href="#r-paket-nparcomp" id="toc-r-paket-nparcomp" class="nav-link" data-scroll-target="#r-paket-nparcomp"><span class="header-section-number">42.8.4</span> R Paket <code>{nparcomp}</code></a></li>
  </ul></li>
  <li><a href="#weitere-dinge-von-interesse" id="toc-weitere-dinge-von-interesse" class="nav-link" data-scroll-target="#weitere-dinge-von-interesse"><span class="header-section-number">42.9</span> Weitere Dinge von Interesse</a>
  <ul class="collapse">
  <li><a href="#sec-friedhof-posthoc" id="toc-sec-friedhof-posthoc" class="nav-link" data-scroll-target="#sec-friedhof-posthoc"><span class="header-section-number">42.9.1</span> Friedhof der Post-hoc Tests</a></li>
  <li><a href="#re-engineering-des-compact-letter-displays" id="toc-re-engineering-des-compact-letter-displays" class="nav-link" data-scroll-target="#re-engineering-des-compact-letter-displays"><span class="header-section-number">42.9.2</span> Re-engineering des <em>Compact letter displays</em></a></li>
  <li><a href="#sec-posthoc-var-heterogen" id="toc-sec-posthoc-var-heterogen" class="nav-link" data-scroll-target="#sec-posthoc-var-heterogen"><span class="header-section-number">42.9.3</span> Modellierung von Varianzheterogenität</a></li>
  </ul></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-posthoc2.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-posthoc2.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-posthoc2.html"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-posthoc" class="quarto-section-identifier"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 03. May 2025 um 08:27:17</em></p>
<blockquote class="blockquote">
<p><em>“Comparison is the thief of joy.” — Theodore Roosevelt</em></p>
</blockquote>
<p>In diesem Kapitel wollen wir uns mit den multiplen Vergleichen (eng. <em>post hoc analysis</em>) oder auch paarweise Gruppenvergleiche genannt beschäftigen. Wir kennen diese multiplen Tests auch unter dem Namen <em>Post-hoc Tests</em>, da wir historisch diese Tests <em>nach</em> einer ANOVA durchgeführt haben. Das heißt, wir wollen statistisch Testen, ob sich verschiedene Gruppen einer Behandlung voneinander unterschieden. Technisch Testen wir dabei, ob sich die Level eines Faktors voneinander unterscheiden. Wir können dabei mehrere Faktoren bzw. Behandlungen berücksichtigen und gleichzeitig Testen. Wenn wir nur einen Faktor betrachten, dann sprechen wir von einem einfaktoriellen Vergleich. Wenn wir zwei Behandlungen betrachten, dann entsprechend von einem zweifaktoriellen Vergleich. Sehr selten haben wir dann noch den Fall vorliegen, dass wir drei Faktoren betrachten wollen. In einer Abschlussarbeit haben wir faktisch keine Versuche wo wir mehr als drei Faktoren in einem Gruppenvergleich berücksichtigen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Keine Zeit? Dann nutze gleich den effektiven Pfad mit <code>{emmeans}</code>!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dieses Kapitel ist lang und vieles habe ich hier gerechnet, damit du es nicht musst. Wenn du keine Zeit hast, dann springe gleich in den <a href="#sec-emmeans">Abschnitt mit dem effektiven Pfad mit <code>{emmeans}</code></a> und lasse den Rest links und rechts liegen. Wir freuen uns das es den Rest gibt, aber du willst ja fertig werden und nicht staunen, was andere so alles entwickelt haben. Und das ist vollkommen okay!</p>
</div>
</div>
<p>Wo wollen wir also mit unserem Post-hoc Test hin? Betrachten wir dazu einmal eine wissenschaftliche Veröffentlichungen als Beispiele. In der folgenden Abbildung sehen wir ein Säulendigramm aus der wissenschaftlichen Veröffentlichung von <span class="citation" data-cites="sanchez2022hoverfly">Sánchez u.&nbsp;a. (<a href="#ref-sanchez2022hoverfly" role="doc-biblioref">2022</a>)</span> mit dem Titel <a href="https://www.sciencedirect.com/science/article/pii/S0304423822004411">“Hoverfly pollination enhances yield and fruit quality in mango under protected cultivation”</a>. Dargestellt ist der mittlere Anteil an tragenden Rispen (eng. <em>panicles</em>) von Mango unter verschiedenen Ausbringungsdichten von Schwebfliegen (eng. <em>hoverfly</em>).</p>
<div id="fig-zerforschen-hoverfly" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zerforschen-hoverfly-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_hoverfly.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Abbildung&nbsp;42.1— “Panicles with commercial fruit (%) at 2019 and 2020 harvest. In the same year, different letters indicate significant differences among treatments (Tukey’s test p<0.05).” Quelle: @sanchez2022hoverfly"><img src="images/eda/zerforschen_hoverfly.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zerforschen-hoverfly-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.1— <em>“Panicles with commercial fruit (%) at 2019 and 2020 harvest. In the same year, different letters indicate significant differences among treatments (Tukey’s test p&lt;0.05).”</em> Quelle: <span class="citation" data-cites="sanchez2022hoverfly">Sánchez u.&nbsp;a. (<a href="#ref-sanchez2022hoverfly" role="doc-biblioref">2022</a>)</span>
</figcaption>
</figure>
</div>
<p>Wir haben hier ein typisches zweifaktorielles Design vorliegen. Zum einen den Faktor <em>treatment</em> mit den Gruppen <em>High density</em>, <em>medium density</em>, <em>Low density</em> und <em>Control</em>. Der zweite Faktor ist dann das Jahr der Messung mit zwei Jahren. Wir sehen hier die Buchstaben des <em>Compact letter displays</em> über den Mittelwerten als Säulen dargestellt. Das <em>Compact letter display</em> wollen wir dann hier in diesem Kapitel erstellen. Ein weiteres Beispiel findest du in der wissenschaftlichen Veröffentlichung von <span class="citation" data-cites="salinas2023plant">Salinas u.&nbsp;a. (<a href="#ref-salinas2023plant" role="doc-biblioref">2023</a>)</span> mit dem Titel <a href="https://www.mdpi.com/2223-7747/12/5/1189">“Plant Growth, Yield, and Fruit Size Improvements in ‘Alicia’ Papaya Multiplied by Grafting”</a>.</p>
<section id="theoretischer-hintergrund" class="level2" data-number="42.1">
<h2 data-number="42.1" class="anchored" data-anchor-id="theoretischer-hintergrund"><span class="header-section-number">42.1</span> Theoretischer Hintergrund</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01_small.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="images/angel_01_small.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>In diesem Kapitel werde ich ein paar Engel der Statistik niedergeschlagen oder überfahren. Ich lasse aus Gründen der Didaktik ein paar Sachen weg und dadurch wird einiges leider dann <em>mathematisch</em> unkorrekt. Oder eben das klassische <a href="https://en.wikipedia.org/wiki/Lie-to-children">lying-to-children</a>. Ich kann damit leben und nehme es auf mich damit du deine Abschlussarbeit fertig bekommst.</p>
</blockquote>
</div>
</div>
</div>
<p>Fangen wir nochmal mit etwas theoretischen Hintergrund an. Das heißt wir schauen uns nochmal die wichtigsten Konzepte vom multiplen Testen einmal an. Wichtig ist hier, dass du eben mehr als zwei Gruppen miteinander vergleichen willst. Teilweise hast du mehr als sieben Gruppen und dann wird es schon eine Menge an Vergleichen. Wenn du alle möglichen vergleiche zwischen allen Gruppen rechnen willst, dann nennt man dies den <em>all-pair</em> Vergleich. Es werden eben alle möglichen Paare an Gruppen verglichen. Beginnen wir also mit der Frage nach der Anzahl an möglichen Vergleichen und was dies für unsere statistische Auswertung bedeutet.</p>
<dl>
<dt>Wie viel ist den <em>all-pair</em>? Also alle möglichen Vergleiche?</dt>
<dd>
<p>Wenn du alle möglichen Mittelwertkombinationen testen willst, dann ist die Formel für die Berechnung der durchzuführenden Vergleiche <span class="math inline">\(r = m(m-1)/2\)</span>. Oder um es einmal in der folgenden Tabelle etwas konkreter darzustellen, werden es sehr schnell sehr viele Vergleiche. Dabei drückst du mit jeder zusätzlichen Behandlungsgruppe das Signifikanzniveau <span class="math inline">\(\alpha\)</span> weiter runter, da die Anzahl an potenziellen Vergleichen sehr schnell ansteigt. So fällt dann auch der maximal noch signifikante p-Wert schnell ab. Damit brauchst du dann immer stärkere Effekt, wie einen Mittelwertsunterschied, um überhaupt noch was signifikantes aus einem statistischen Test wiedergeben zu bekommen. In der folgenden Tabelle siehst du dann nochmal den Zusammenhang. Ohne Adjustierung des Signifikanzniveaus erhalten wir schon ab sechs Gruppen mindestens einen signifikanten Unterschied auch wenn es gar keinen Unterschied in den Daten gibt. Denke immer daran, das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gibt an wie groß unsere Fehlerrate an falsch positiven Ergebnissen ist. Also die Nullhypothese mit dem statistischen Test abzulehnen, obwohl wir eigenlich keinen Unterschied vorliegen haben.</p>
</dd>
</dl>
<div class="cell">
<div id="tbl-allpair-bonf" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-allpair-bonf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.1— Zusammenhang von der Anzahl an Gruppen oder Behandlungen und der sich ergebenden Anzahl an <em>all-pair</em> Vergleichen. Daraus ergibt sich ein stark abfallendes Signifikanzniveau. Der maximal noch signifikante p-Wert fällt dementsprechend auch schnell ab. <strong>Ohne Adjustierung</strong> erhalten wir schon ab sechs Gruppen mindestens einen fälschlichen signifikanten Unterschied.
</figcaption>
<div aria-describedby="tbl-allpair-bonf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 23%">
<col style="width: 24%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Anzahl Gruppen</th>
<th style="text-align: center;">Anzahl Vergleiche</th>
<th style="text-align: center;">Signifikanzniveau <span class="math inline">\(\alpha\)</span></th>
<th style="text-align: center;">Maximal signifikanter p-Wert</th>
<th style="text-align: center;"><span class="math inline">\(H_0\)</span> fälschlich abgelehnt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5.00%</td>
<td style="text-align: center;">0.0500</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1.67%</td>
<td style="text-align: center;">0.0167</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.83%</td>
<td style="text-align: center;">0.0083</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">0.50%</td>
<td style="text-align: center;">0.0050</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">6</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">0.33%</td>
<td style="text-align: center;">0.0033</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">0.24%</td>
<td style="text-align: center;">0.0024</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">8</td>
<td style="text-align: center;">28</td>
<td style="text-align: center;">0.18%</td>
<td style="text-align: center;">0.0018</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">9</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">0.14%</td>
<td style="text-align: center;">0.0014</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">10</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">0.11%</td>
<td style="text-align: center;">0.0011</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">11</td>
<td style="text-align: center;">55</td>
<td style="text-align: center;">0.09%</td>
<td style="text-align: center;">0.0009</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">12</td>
<td style="text-align: center;">66</td>
<td style="text-align: center;">0.08%</td>
<td style="text-align: center;">0.0008</td>
<td style="text-align: center;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<dl>
<dt>Was bedeutet <em>konservativ</em> und was <em>liberal</em>?</dt>
<dd>
<p>Häufiger schreibe ich mal das ein statistischer Test konservativ wird oder aber eher liberal testet. Das klingt jetzt etwas schräg sind aber bekannte Begriffe in der Fachsprache der Statistik. Es geht hierbei um die Bewertung des globalen Signifikanzniveau über alle Vergleiche hinweg. Wichtig ist, dass wir häufig nicht exakt wissen, wie groß das Signifikanzniveau in deinem speziellen Datenfall ist. Deshalb ist <em>konservativ</em> und <em>liberal</em> eher als Tendenz zu verstehen.</p>
</dd>
</dl>
<p>Wenn wir von einem konservativen Test sprechen, dann meinen wir, dass wir weniger signifikante Ergebnisse erwarten werden, als es bei einem Signifikanzniveau von <span class="math inline">\(\alpha\)</span> gleich 5% zu erwarten wäre. Der Post-hoc Test nutzt nicht die vollen 5% Fehlerrate sondern testet global zu einem niedrigeren Signifikanzniveau. Wenn wir von einem liberalen Test sprechen, dann testen wir zu einem höheren Signifikanzniveau als <span class="math inline">\(\alpha\)</span> gleich 5%. Wir werden also mehr signifikante Unterschiede finden als wir mit einer globalen Fehlerrate von 5% erwarten würden.</p>
<div id="tbl-theo-con-lib" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-theo-con-lib-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.2— Zusammenfassung der Begrifflichkeit <em>konservativ</em> und <em>liberal</em> im Kontext eines multipen Tests.
</figcaption>
<div aria-describedby="tbl-theo-con-lib-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Globales Signifikanzniveau <span class="math inline">\(\alpha\)</span></th>
<th style="text-align: left;">Bemerkung</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">konservativ</td>
<td style="text-align: center;"><span class="math inline">\(\leq 5\%\)</span></td>
<td style="text-align: left;">Weniger signifikante Unterschiede</td>
</tr>
<tr class="even">
<td style="text-align: center;">liberal</td>
<td style="text-align: center;"><span class="math inline">\(\geq 5\%\)</span></td>
<td style="text-align: left;">Mehr signifikante Unterschiede</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<dl>
<dt>Wie viele multiple Tests gibt es eigentlich?</dt>
<dd>
<p>Es gibt eine Menge an multiplen Tests oder auch Post-hoc Tests. Ich habe dir hier mal eine kleine Tabelle mitgebracht, die dir vier Post-hoc Tests im Vergleich zeigt. Ich habe die Auswahl etwas willkürlich getroffen, es gibt noch viel mehr Post-hoc Tests als ich in diesem Kapitel vorstelle. Wichtig für dich ist aber, dass es eigentlich auf die Entscheidung zwischen dem Tukey HSD Test oder eben dem R Paket <code>{emmeans}</code> herausläuft. Ja, es gibt eben noch die anderen Tests, aber diese haben eine eher Nischenanwendung. Darüber hinaus kannst du <code>{emmeans}</code> so konfigurieren, dass du im Prinzip einen besseren Tukey HSD Test für Varianzhomogenität oder aber einen Games Howell Test für Vanrianzheterogenität rechnest ohne die Nachteil der orginalen Implemntierung. Das ist doch toll!</p>
</dd>
</dl>
<p>In einer normalen agarwissenschaftlichen Abschlussarbeit mit einem Feldexperiment und zwei Faktoren <span class="math inline">\(f_1\)</span> und <span class="math inline">\(f_2\)</span> läuft es eben dann doch auf den Tukey HSD Test oder Games Howell Test heraus. So ist eben die Normalverteilung des Messwertes <span class="math inline">\(y\)</span> eben ein sehr starkes Kriterium zur Wahl des Tests. Da dann häufig noch die ANOVA vorgeschaltet wird sind wir dann im <em>ANOVA Pfad</em> mit dem Tukey HSD Test. Wichtig ist noch, dass du schauen musst, ob die Varianz in deinen Gruppen <span class="math inline">\(x\)</span> eher homogen oder heterogen ist. Davon hängt dann die Entschiedung für oder gegen den Tukey HSD Test ab. Wenn dein Messwert <span class="math inline">\(y\)</span> nicht normalverteilt ist, dann musst du eine anderes Modell rechnen, diese Modelle stelle ich später noch vor. Auch ist die Frage, ob du adjustierte p-Werte möchtest oder nicht. Hier hängt es auch von der Anwendung ab, ob du die Adjustierung für multiple Vergleiche ausstellen kannst.</p>
<div id="tbl-übersicht" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-übersicht-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.3— Übersicht über vier ausgewählte Post-hoc Tests und deren statistischen Eigenschaften. Insbesondere sticht das R Paket <code>{emmeans}</code> mit seiner Flexibilität und einfachen Handbarkeit heraus. Die Mindestfallzahl per Gruppe <span class="math inline">\(n_g\)</span> ist eher als Empfehlung zu verstehen und als untere Grenze. Achtung, teilweise müssen die Optionen <em>aktiv</em> von dir aktiviert werden. Sie dazu auch den <a href="#sec-friedhof-posthoc">Friedhof der Post-ho Tests</a> in diesem Kapitel.
</figcaption>
<div aria-describedby="tbl-übersicht-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Tukey HSD</th>
<th style="text-align: center;">Games Howell</th>
<th style="text-align: center;"><code>{emmeans}</code></th>
<th style="text-align: center;"><code>{multcomp}</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Verteilung von</strong> <span class="math inline">\(y\)</span></td>
<td style="text-align: center;">normalverteilt</td>
<td style="text-align: center;">normalverteilt</td>
<td style="text-align: center;">beliebig</td>
<td style="text-align: center;">beliebig</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Varianzen der Gruppen</strong> <span class="math inline">\(x\)</span></td>
<td style="text-align: center;">homogen</td>
<td style="text-align: center;">heterogen</td>
<td style="text-align: center;">beliebig</td>
<td style="text-align: center;">beliebig</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Fallzahl per Gruppe</strong> <span class="math inline">\(n_g\)</span></td>
<td style="text-align: center;">balanciert; <span class="math inline">\(n_g \geq 4\)</span></td>
<td style="text-align: center;">beliebig; <span class="math inline">\(n_g \geq 6\)</span></td>
<td style="text-align: center;">beliebig; <span class="math inline">\(n_g \geq 4\)</span></td>
<td style="text-align: center;">beliebig; <span class="math inline">\(n_g \geq 4\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Adjustierte p-Werte</strong></td>
<td style="text-align: center;">immer</td>
<td style="text-align: center;">immer</td>
<td style="text-align: center;">beliebig</td>
<td style="text-align: center;">beliebig</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Mögliche Vergleiche</strong></td>
<td style="text-align: center;"><em>all-pair</em></td>
<td style="text-align: center;"><em>all-pair</em></td>
<td style="text-align: center;">beliebig</td>
<td style="text-align: center;">beliebig</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
<section id="genutzte-r-pakete" class="level2" data-number="42.2">
<h2 data-number="42.2" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">42.2</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, readxl, knitr, kableExtra, see, nparcomp,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               multcomp, emmeans,  multcompView, nlme, janitor,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               parameters, patchwork, agricolae, broom, rstatix,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               DescTools, rcompanion, magrittr, quantreg, effectsize,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               conflicted)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(magrittr<span class="sc">::</span>set_names)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(effectsize<span class="sc">::</span>eta_squared)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="42.3">
<h2 data-number="42.3" class="anchored" data-anchor-id="daten"><span class="header-section-number">42.3</span> Daten</h2>
<p>Auch brauchen wir hier in diesem Kapitel einfache Datensätze an denen wir eine einfaktorielle und eine zweifaktorielle Analyse nachvollziehen können. Ich habe dir in einem Abschnitt noch ein paar Fallbeispiele in <code>{emmeans}</code> mitgebracht, die dann einen stärkeren agrarwissenschaftlichen Bezug haben. Für den Anfang reichen aber die beiden Beispiele für das Verständnis dieses Kapitels vollkommen aus. Die Visualisierung der Datensätze schauen wir uns dann in dem Abschnitt zur Abschätzung der Varianzhonogenität und Varianzheterogenität nochmal näher an.</p>
<p>Der erste Datenstaz besteht aus der Sprungweite in [cm] von verschiedenen Tierarten. Dabei ist dann die Sprungllänge unser Messwert <span class="math inline">\(y\)</span> oder Outcome. Unsere Behandlung sind dann die drei Tierarten Hund, Katze und Fuchs. Wir fragen uns also, die verschiedenen Floharten unterschiedlich weit springen. Ich habe dir einmal die Daten in das Objekt <code>fac1_tbl</code> geladen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann schauen wir uns die Daten einmal in der folgenden Tabelle als Auszug einmal an. Wichtig ist hier nochmal, dass du eben einen Faktor <code>animal</code> mit drei Leveln also Gruppen vorliegen hast. Wir wolen jetzt die drei Tierarten hinsichtlich ihrer Sprungweite in [cm] miteinander vergleichen. Weil wir jetzt mehr als zwei Gruppen vorliegen haben, sprechen wir von einem multiplen Vergleich.</p>
<div class="cell">
<div id="tbl-1fac-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.4— Tabelle der Sprungweiten in [cm] als Messwert <span class="math inline">\(y\)</span> von Hunde-, Katzen- und Fuchsflöhen. Der Datensatz ist einfaktoriell, da wir nur einen Behandlungsfaktor <span class="math inline">\(x\)</span> mit <code>animal</code> vorliegen haben.
</figcaption>
<div aria-describedby="tbl-1fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">jump_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.7</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">11.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">8.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.3</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Wir vergleichen natürlich nicht die Sprungweiten in [cm] direkt mitteinandern sondern rechnen natürlich vorher die deskriptive Statistiken wie Mittelwert und Standardabweichung aus. Für die Berechnung des Standardfehlers nutzen wir die Funktion <code>standard_error()</code> aus dem R Paket <code>{parameters}</code>. Am Ende vergleichen wir die mittleren Sprungweiten der Hunde-, Katzen-, und Fuchsflöhe miteinander. Wir können anhand der Mittelwerte schon Tendenzen in den Gruppen sehen.</p>
<div class="cell">
<div id="tbl-1fac-mean" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1fac-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.5— Deskriptive Maßzahlen der Sprungweite in [cm] gruppiert nach den drei Floharten.
</figcaption>
<div aria-describedby="tbl-1fac-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;">Standardabweichung</th>
<th style="text-align: center;">SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.13</td>
<td style="text-align: center;">2.14</td>
<td style="text-align: center;">0.81</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">4.74</td>
<td style="text-align: center;">1.90</td>
<td style="text-align: center;">0.72</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">9.16</td>
<td style="text-align: center;">1.10</td>
<td style="text-align: center;">0.42</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Neben dem einfaktoriellen Datensatz wollen wir uns noch den häufigeren Fall mit zwei Faktoren anschauen. Wir haben also nicht nur die drei Floharten vorliegen und wollen wissen ob diese unterschiedlich weit springen. Darüber hinaus haben wir noch einen zweiten Faktor gewählt. Wir haben die Sprungweiten der Hunde-, Katzen- und Fuchsflöhe nämlich an zwei Messorten, der Stadt und dem Dorf, gemessen. Dadurch haben wir jetzt den Faktor <code>animal</code> und den Faktor <code>site</code> vorliegen. Wiederum fragen wir usn, ob sich die Sprungweite in [cm] der drei Floharten in den beiden Messorten unterscheidet. Im Folgenden lade ich einmal den Datensatz in das Objekt <code>fac2_tbl</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox_site.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, site, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"city"</span>, <span class="st">"village"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">as_factor</span>(site))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Betrachten wir als erstes einen Auszug aus der Datentabelle. Wir haben hier als Messwert oder Outcome <span class="math inline">\(y\)</span> die Sprungweite <code>jump_length</code> vorliegen. Als ersten Faktor die Variable <code>animal</code> und als zweiten Faktor die Variable <code>site</code> festgelegt.</p>
<div class="cell">
<div id="tbl-2fac-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-2fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.6— Tabelle der Sprungweiten in [cm] als Messwert <span class="math inline">\(y\)</span> von Hunde-, Katzen- und Fuchsflöhen an zwei verschiedenen Messorten Stadt und Dorf. Der Datensatz ist zweifaktoriell, da wir einen Behandlungsfaktor <span class="math inline">\(x\)</span> mit <code>animal</code> und einen zweiten Faktor mit <code>site</code> vorliegen haben.
</figcaption>
<div aria-describedby="tbl-2fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">site</th>
<th style="text-align: center;">jump_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">12.04</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">11.98</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">16.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">village</td>
<td style="text-align: center;">16.96</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">village</td>
<td style="text-align: center;">13.38</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">village</td>
<td style="text-align: center;">18.38</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Auch hier schauen wir uns einmal die deskritive Zusammenfassung der Daten an. Hier musst du natürlich beachten welchen Faktor du in welchem verschaltest hast. Klingt jetzt erstmal sperrig, aber es wird vermutlich am Beispiel klarer. Wir haben ja an jedem Messort alle drei Tierarten gemessen. Daher wollen wir natürlich für jeden Messort die Zusammenfassung der drei Tierarten haben. Du kannst das auch andersherum gruppieren, aber für mich macht es sorum mehr Sinn. Für die Berechnung des Standardfehlers nutzen wir die Funktion <code>standard_error()</code> aus dem R Paket <code>{parameters}</code>. Wie du siehst, sind die Mittelwerte unterschiedlich, was auf einen Unterschied zwischen den Floharten im Bezug auf die Sprungweite hindeutet.</p>
<div class="cell">
<div id="tbl-2fac-mean" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-2fac-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.7— Deskriptive Maßzahlen der Sprungweite in [cm] gruppiert nach den drei Floharten und den zwei Messorten.
</figcaption>
<div aria-describedby="tbl-2fac-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">site</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;">Standardabweichung</th>
<th style="text-align: center;">SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">13.58</td>
<td style="text-align: center;">1.88</td>
<td style="text-align: center;">0.59</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">village</td>
<td style="text-align: center;">15.25</td>
<td style="text-align: center;">2.35</td>
<td style="text-align: center;">0.74</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">16.68</td>
<td style="text-align: center;">2.26</td>
<td style="text-align: center;">0.71</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">village</td>
<td style="text-align: center;">16.56</td>
<td style="text-align: center;">1.21</td>
<td style="text-align: center;">0.38</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">20.12</td>
<td style="text-align: center;">1.15</td>
<td style="text-align: center;">0.37</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">village</td>
<td style="text-align: center;">16.98</td>
<td style="text-align: center;">1.73</td>
<td style="text-align: center;">0.55</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="modell" class="level2" data-number="42.4">
<h2 data-number="42.4" class="anchored" data-anchor-id="modell"><span class="header-section-number">42.4</span> Modell</h2>
<p>Beginnen wir mit der Frage, was ein Modell ist. Ein Modell beschreibt, wie du deine Daten auswerten willst. Zuerst einmal beschreibt es in der <code>formula</code>-Schreibweise, welche Spalten du aus deinem Datensatz auswerten willst. Du musst den Funktionen in R ja mitteilen welche Variablen du analysieren möchtest. In dem nachfolgenden Abschnitt schauen wir uns einmal den Messwert <span class="math inline">\(y\)</span> näher an und entscheiden dann noch, ob wir in den Gruppen <span class="math inline">\(x\)</span> eine Varianzhomogenität vorliegen haben oder eher eine Varianzheterogenität finden.</p>
<section id="faktorielle-analyse" class="level3" data-number="42.4.1">
<h3 data-number="42.4.1" class="anchored" data-anchor-id="faktorielle-analyse"><span class="header-section-number">42.4.1</span> Faktorielle Analyse</h3>
<p>Beginnen wir also mit der Festlegung welche Art der Analyse wir rechnen wollen. Wir schauen uns jetzt einmal das einfaktorielle sowie das zweifaktorielle Modell näher an. Du könntest auch mehr als zwei Faktoren auswerten wollen, aber dann musst du einmal in ein anderes Kapitel wechseln. Wir beginnen hier mit dem einfacheren Fall oder auch den häufigsten. Zurst einmal haben wir ein faktorielles Modell vorliegen. Hier einmal die generelle Form mit belieb vielen Faktoren <span class="math inline">\(f\)</span>.</p>
<p><span class="math display">\[
y \sim f_1 + f_2 + ... + f_p + f_1 \times f_2 + ... + f_1 \times f_2 \times f_3
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(y\)</span> gleich dem Messwert oder Outcome</li>
<li><span class="math inline">\(f_1 + f_2 + ... + f_p\)</span> gleich experimenteller Faktoren</li>
<li><span class="math inline">\(f_1 \times f_2\)</span> gleich einem beispielhaften Interaktionsterm erster Ordnung</li>
<li><span class="math inline">\(f_1 \times f_2 \times f_3\)</span> gleich einem beispielhaften Interaktionsterm zweiter Ordnung</li>
</ul>
<p>Zusätzlich können noch Interaktionsterme höherer Ordnungen entstehen, aber hier wird es extrem schwierig diese Interaktionsterme dann auch zu interpretieren. Wir werden uns aber in diesem Kapitel auf ein einfaktorielles sowie zweifaktorielles Modell beschränken. Wenn du theoretisch das zweifaktorielle Modell anwenden kannst, dann kannst auch mit mehr Faktoren einen Post-hoc Test rechnen.</p>
<section id="einfaktorielles-modell" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorielles-modell">Einfaktorielles Modell</h4>
<p>Beginnen wir mit dem einfaktoriellen Modell (eng. <em>one-way design</em>). In einem einfaktoriellen Modell haben wir einen Messwert <span class="math inline">\(y\)</span> sowie einen Faktor mit beliebig vielen Leveln vorliegen. Dabei beschreiben die Level dann die einzelnen Gruppen. In unserem Fall hier haben wir es mit multiplen Vergleichen zu tun, so dass der Faktor natürlich mehr als zwei Level hat.</p>
<p><span class="math display">\[
y \sim f_1
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(y\)</span> gleich dem Messwert oder Outcome, wie die Sprungweite in [cm] als <code>jump_length</code>.</li>
<li><span class="math inline">\(f_1\)</span> gleich der Behandlung als Faktor mit mehr als zwei Gruppen, wie die Tierart als <code>animal</code>.</li>
</ul>
<p>Wir würden dann folgende Schreibweise in R in einem Modell nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.formula</span>(jump_length <span class="sc">~</span> animal)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>jump_length ~ animal</code></pre>
</div>
</div>
</section>
<section id="zweifaktorielles-modell" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorielles-modell">Zweifaktorielles Modell</h4>
<p>Weit aus häufiger kommt das zweifaktorielle Modell (eng. <em>two-way design</em>) in den Agarwissenschaften vor. Wir haben hier nicht nur den Behandlungsfaktor <span class="math inline">\(f_1\)</span> sondern eben noch einen zweiten Faktor <span class="math inline">\(f_2\)</span> vorliegen. Was der zweite Faktor beschreibt, kann von Fragestellung zu Fragestellung sehr unterschiedlich sein. Wenn wir zwei Faktoren vorliegen haben, dann können wir auch die Interaktion zwischen den beiden Faktoren modelliere. Damit wollen wir die Frage beantworten, ob sich jede Faktorkombination gleich verhält oder ob es Unterschiede bei gewissen Faktorkombination gibt. Vielleicht verhalten sich ja Fuchsflöhe in der Stadt ganz anders als im Dorf im Vergleich zu Hunde-, und Katzenflöhen.</p>
<p><span class="math display">\[
y \sim f_1 + f_2 + f_1 \times f_2
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(y\)</span> gleich dem Messwert oder Outcome, wie die Sprungweite in [cm] als <code>jump_length</code>.</li>
<li><span class="math inline">\(f_1\)</span> gleich der Behandlung als ersten Faktor mit mehr als zwei Gruppen, wie die Tierart als <code>animal</code>.</li>
<li><span class="math inline">\(f_2\)</span> gleich dem zweiten Faktor, wie der Messort als <code>site</code>.</li>
<li><span class="math inline">\(f_1 \times f_2\)</span> gleich dem Interaktionsterm zwischen den beiden Faktoren Tierart und Messort.</li>
</ul>
<p>Wir würden dann folgende Schreibweise in R in einem Modell nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.formula</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>jump_length ~ animal + site + animal:site</code></pre>
</div>
</div>
</section>
<section id="mehrfaktorielles-modell" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="mehrfaktorielles-modell">Mehrfaktorielles Modell</h4>
<p>Am Ende können wir dann noch den Fall haben, dass wir noch mehr Faktoren <span class="math inline">\(z\)</span> in unserem Modell berücksichtigen wollen. Hier wird es dann komplizierter. Wichtig ist hier, dass du meistens auch zwei Faktoren hast, die dich am meisten interessieren und deren Interaktion du berücksichtigen willst. Ich mehr Interaktionen du rechnen willst desto mehr Fallzahl brauchst du, so dass hier <em>meisten</em> nur eine oder zwei Interaktionen funktionieren.</p>
<p><span class="math display">\[
y \sim f_1 + f_2 + f_1 \times f_2 + z_1 + \cdots + z_p
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(y\)</span> gleich dem Messwert oder Outcome, wie die Sprungweite in [cm] als <code>jump_length</code>.</li>
<li><span class="math inline">\(f_1\)</span> gleich der Behandlung als ersten Faktor mit mehr als zwei Gruppen, wie die Tierart als <code>animal</code>.</li>
<li><span class="math inline">\(f_2\)</span> gleich dem zweiten Faktor, wie der Messort als <code>site</code>.</li>
<li><span class="math inline">\(f_1 \times f_2\)</span> gleich dem Interaktionsterm zwischen den beiden Faktoren Tierart und Messort.</li>
<li><span class="math inline">\(z_1 + \cdots + z_p\)</span> als weitere experimentelle Faktoren der Umwelt, Zeit oder anderer Einwirkung auf den Messwert sowie einzelene Messungen von Beobachtungen.</li>
</ul>
<p>Wir würden dann folgende Schreibweise in R in einem Modell nutzen. Hier habe ich noch beispielhaft die beiden Faktoren Jahreszeit <code>season</code> und Fütterungszustand <code>feeding</code> ergänzt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.formula</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site <span class="sc">+</span> season <span class="sc">+</span> feeding)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>jump_length ~ animal + site + animal:site + season + feeding</code></pre>
</div>
</div>
<p>Wenn du ein komplexes, mehrfaktorielles Modell auswerten willst, dann schaue dir den Abschnitt zu <a href="stat-modeling-mixed.html#sec-mult-comp-lmer-reg">Multiple Gruppenvergleiche für gemischte Modelle</a> in dem entsprechenden Kapitel zu linearen gemischten Modellen an.</p>
<p>Ein weitere Möglichkeit ist, dass du einfach über den Faktoren <span class="math inline">\(z_1 + \cdots + z_p\)</span> mittelst. Du schaust dir also weiterhin nur die beiden Hauptfaktoren <span class="math inline">\(f_1\)</span> und <span class="math inline">\(f_2\)</span> an und mittelst für jede Faktorkombination von <span class="math inline">\(f_1\)</span> und <span class="math inline">\(f_2\)</span> die Werte für die anderen Faktoren <span class="math inline">\(z_1 + \cdots + z_p\)</span>. Hier verlierst du dann zwar einiges an Informationen, aber dies wird häufig für die einzelnen Pflanzenmessungen je Parzelle gemacht. Du mittelst alle Pflanzen in einer Parzelle und schaust dir die einzelnen Pflanzen als Faktor gar nicht an.</p>
</section>
</section>
<section id="der-messwert-y" class="level3" data-number="42.4.2">
<h3 data-number="42.4.2" class="anchored" data-anchor-id="der-messwert-y"><span class="header-section-number">42.4.2</span> Der Messwert <span class="math inline">\(y\)</span></h3>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>In diesem Kapitel rechne ich alles einmal mit einem normalverteilten Messwert <span class="math inline">\(y\)</span> durch. Daher ist die Sprungweite <code>jump_length</code> normalverteilt und ich kann daher als Modell die Funktion <code>aov()</code> nutzen. Das Kapitel würde zu groß, wenn ich alle möglichen Verteilungen und deren Funktionen in R hier zeigen würde.</p>
</div>
</div>
<p>Bevor wir mit dem multiplen Vergleich anfangen können, müssen wir uns Fragen welcher Verteilungsfamilie eigentlich unser Messwert <span class="math inline">\(y\)</span> folgt. Je nachdem was du misst, musst du eine andere Verteilung modellieren und dann auch eine andere Funktion in R dafür nutzen. Welche statistische Modellierung für das <span class="math inline">\(y\)</span> soll ich für meinen Gruppenvergleich wählen? Ich habe in den jeweiligen Kapiteln zu den statistischen Modellen die jeweiligen Schritte für die Gruppenvergleiche hinterlegt und beschrieben. Daher kannst du in den Kapiteln einmal schauen, wie dein Messwert dort ausgewertet wird. Du findest dort auch immer ein Beispiel mit entsprechenden Daten. Ich konzentriere mich hier in diesem Kapitel auf einen normalverteilten Messwert <span class="math inline">\(y\)</span> mit der Sprungweite in [cm].</p>
<section id="normalverteilte-messwerte-boldsymboly" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="normalverteilte-messwerte-boldsymboly">Normalverteilte Messwerte <span class="math inline">\(\boldsymbol{y}\)</span></h4>
<p><em>Beispiel: Frischgewicht, Trockengewicht, Chlorophyllgehalt, Pflanzenhöhe</em></p>
<div id="tbl-bsp-normal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bsp-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.8— Tabelle mit bespielhaften, normalverteilten Messwerten <span class="math inline">\(y\)</span>.
</figcaption>
<div aria-describedby="tbl-bsp-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">freshmatter</th>
<th style="text-align: center;">drymatter</th>
<th style="text-align: center;">chlorophyll</th>
<th>height</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">8.23</td>
<td style="text-align: center;">1.21</td>
<td style="text-align: center;">45.88</td>
<td>24.19</td>
</tr>
<tr class="even">
<td style="text-align: center;">2.61</td>
<td style="text-align: center;">0.87</td>
<td style="text-align: center;">43.91</td>
<td>18.51</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4.81</td>
<td style="text-align: center;">0.34</td>
<td style="text-align: center;">37.44</td>
<td>21.74</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Ich rechne in diesem Kapitel alles einmal auf einem normalverteilten Messwert <span class="math inline">\(y\)</span> mit der Sprungweite der Floharten durch. Wenn du mehr Informationen zum modellieren brauchst, dann schaue dir den Abschnitt zu <a href="stat-modeling-gaussian.html#sec-mult-comp-gaussian-reg">Multiple Gruppenvergleiche für normalverteilte Daten</a> gerne einmal an. Das ist eigentlich <em>der</em> Standardfall und vieles in diesem Kapitel dreht sich um normalverteilte Daten.</p>
<p>Die Modellierung in R führen wir im Allgemeinen mit der Funktion <code>lm()</code> durch. Da wir hier meistens erst eine ANOVA gerechnet haben um dann des Post-hoc Test zu rechnen nutze ich direkt die Modellierung mit der Funktion <code>aov()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(freshmatter <span class="sc">~</span> ...)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(freshmatter <span class="sc">~</span> ...)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die genaue Anwendung der Funktionen auf Beispielen findest du dann in den unteren Abschnitten oder aber in dem <a href="stat-modeling-gaussian.html">Kapitel zur Gaussian linearen Regression</a>. Dort gehe ich dann auch näher auf das Modell und der Güte der Modellanpassung ein.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Visuelle Überprüfung der Normalverteilung
</div>
</div>
<div class="callout-body-container callout-body">
<blockquote class="blockquote">
<p><em>“Soll ich’s wirklich machen oder lass ich’s lieber sein? Jein…” — Fettes Brot, Jein</em></p>
</blockquote>
<p>Häufig kommt jetzt die Frage, ob mein Messwert <span class="math inline">\(y\)</span> wirklich normalverteilt ist und ich nicht den Messwert auf Normalverteilung testen sollte. Die kurze Antwort lautet nein, da du meistens zu wenig Beobachtungen pro Gruppe vorliegen hast. Die etwas längere liefert <span class="citation" data-cites="kozak2018s">Kozak und Piepho (<a href="#ref-kozak2018s" role="doc-biblioref">2018</a>)</span> mit dem Artikel <a href="https://onlinelibrary.wiley.com/doi/pdf/10.1111/jac.12220?casa_token=22Jm83-kW-MAAAAA:yh0EVuGiGHWDsuPiVP8ZLj51OCasdpIiVWUcYv3Q8dGaIo0yMeNZNwkHIk1ibTCsLhkxbLKZrwZSByo">What’s normal anyway? Residual plots are more telling than significance tests when checking ANOVA assumptions</a>.</p>
</div>
</div>
</section>
<section id="poissonverteilte-messwerte-boldsymboly-bzw.-zähldaten" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="poissonverteilte-messwerte-boldsymboly-bzw.-zähldaten">Poissonverteilte Messwerte <span class="math inline">\(\boldsymbol{y}\)</span> bzw. Zähldaten</h4>
<p><em>Beispiel: Anzahl Insekten, gekeimte Pflanzen, Schädlinge</em></p>
<div id="tbl-bsp-normal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bsp-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.9— Tabelle mit bespielhaften, poissonverteilten Messwerten <span class="math inline">\(y\)</span>.
</figcaption>
<div aria-describedby="tbl-bsp-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Anzahl Blätter</th>
<th style="text-align: center;">Gekeimte Samen</th>
<th style="text-align: center;">Anzahl Schädlinge</th>
<th>Verzweigungen</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">8</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">45</td>
<td>4</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">43</td>
<td>5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">37</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wenn du mehr über die Modellierung von Zähldaten und deren Auswertung wissen willst, dann schaue dir den Abschnitt zu <a href="stat-modeling-poisson.html#sec-mult-comp-pois-reg">Multiple Gruppenvergleiche für Zähldaten</a> an. Die Modellierung führen wir mit der Funktion <code>glm()</code> durch.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(freshmatter <span class="sc">~</span> ..., <span class="at">family =</span> poission)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die genaue Anwendung der Funktionen auf Beispielen findest du dann in dem <a href="eda-distribution.html#sec-poisson">Kapitel zur Poisson Regression</a>. Dort gehe ich dann auch näher auf das Modell und der Güte der Modellanpassung ein. Bei Zähldaten gibt es die eine oder andere Besonderheit beim Modellieren.</p>
</section>
<section id="ordinalverteilte-messwerte-boldsymboly-bzw.-noten" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="ordinalverteilte-messwerte-boldsymboly-bzw.-noten">Ordinalverteilte Messwerte <span class="math inline">\(\boldsymbol{y}\)</span> bzw. Noten</h4>
<p><em>Beispiel: Bonitur von Rasen, Holstrunk, Bonitur von Wurzelwachstum, Zufriedenheit</em></p>
<div id="tbl-bsp-normal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bsp-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.10— Tabelle mit bespielhaften, ordinalverteilten Messwerten <span class="math inline">\(y\)</span>.
</figcaption>
<div aria-describedby="tbl-bsp-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 15%">
<col style="width: 38%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Bonitur von Rasen</th>
<th style="text-align: center;">Holstrunk</th>
<th style="text-align: center;">Bonitur von Wurzelwachstum</th>
<th>Zufriedenheit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">8</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5</td>
<td>6</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td>6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">7</td>
<td>9</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wenn du Noten vorliegen hast, dann schaue dir den Abschnitt zu <a href="stat-modeling-multinom.html#sec-mult-comp-ord-reg">Multiple Gruppenvergleiche für Boniturdaten</a> an. Es sei den du bist an der mittleren Note pro Gruppe interessiert und willst die mittleren Noten miteinander vergleichen. Dann kannst du auch ein Modell unter der Annahme einer Normalverteilung mit heterogenen Varianzen rechnen. Die Modellierung führen wir mit der Funktion <code>clm()</code> durch.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clm</span>(freshmatter <span class="sc">~</span> ...)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die genaue Anwendung der Funktionen auf Beispielen findest du in dem <a href="stat-modeling-multinom.html">Kapitel zur Multinomiale / Ordinale Regression</a>. Dort gehe ich dann auch näher auf das Modell und der Güte der Modellanpassung ein.</p>
</section>
<section id="binomialverteilte-messwerte-boldsymboly-bzw.-anteile" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="binomialverteilte-messwerte-boldsymboly-bzw.-anteile">Binomialverteilte Messwerte <span class="math inline">\(\boldsymbol{y}\)</span> bzw. Anteile</h4>
<p><em>Beispiel: Infektionsstatus, Verstorben, Zielgewicht erreicht, Gekeimt</em></p>
<div id="tbl-bsp-normal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bsp-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.11— Tabelle mit bespielhaften, binomialverteilten Messwerten <span class="math inline">\(y\)</span>.
</figcaption>
<div aria-describedby="tbl-bsp-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Infektionsstatus</th>
<th style="text-align: center;">Verstorben</th>
<th style="text-align: center;">Zielgewicht erreicht</th>
<th>Gekeimt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td>1</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td>1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wenn du nur einen Messwert mit der Ausprägung <span class="math inline">\(0/1\)</span> oder <span class="math inline">\(ja/nein\)</span> vorliegen hast, dann schaue dir den Abschnitt zu <a href="stat-modeling-logistic.html#sec-mult-comp-log-reg">Multiple Gruppenvergleiche für Anteile</a> an. Die Modellierung führen wir mit der Funktion <code>glm()</code> durch.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(freshmatter <span class="sc">~</span> ..., <span class="at">family =</span> binomial)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die genaue Anwendung der Funktionen auf Beispielen findest du dann in den unteren Abschnitten oder aber in dem <a href="stat-modeling-logistic.html">Kapitel zur Logistische Regression</a>. Dort gehe ich dann auch näher auf das Modell und der Güte der Modellanpassung ein.</p>
</section>
<section id="betaverteilte-messwerte-boldsymboly-bzw.-wahrscheinlichkeiten" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="betaverteilte-messwerte-boldsymboly-bzw.-wahrscheinlichkeiten">Betaverteilte Messwerte <span class="math inline">\(\boldsymbol{y}\)</span> bzw. Wahrscheinlichkeiten</h4>
<p><em>Beispiel: Anteil infizierte Pflanzen, Jagderfolg, Auftreten Spezies, Erfolg/Misserfolg einer Anwendung</em></p>
<div id="tbl-bsp-normal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bsp-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.12— Tabelle mit bespielhaften, betaverteilten Messwerten <span class="math inline">\(y\)</span>.
</figcaption>
<div aria-describedby="tbl-bsp-normal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Anteil infizierte Pflanzen</th>
<th style="text-align: center;">Jagderfolg</th>
<th style="text-align: center;">Auftreten Spezies</th>
<th>Erfolg/Misserfolg einer Anwendung</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0.34</td>
<td style="text-align: center;">0.22</td>
<td style="text-align: center;">0.19</td>
<td>0.67</td>
</tr>
<tr class="even">
<td style="text-align: center;">0.29</td>
<td style="text-align: center;">0.78</td>
<td style="text-align: center;">0.11</td>
<td>0.71</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.31</td>
<td style="text-align: center;">0.77</td>
<td style="text-align: center;">0.27</td>
<td>0.82</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wenn du Prozente oder die Wahrscheinlichkeit für das Eintreten eines Ereignisses oder aber die Rate eines Erfolges an Misserfolgen gemessen hast, dann schaue dir den Abschnitt zu <a href="stat-modeling-beta.html#sec-mult-comp-beta-reg">Multiple Gruppenvergleiche für Wahrscheinlichkeiten</a> an. Die Modellierung führen wir mit der Funktion <code>betareg()</code> durch.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">betareg</span>(freshmatter <span class="sc">~</span> ...)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die genaue Anwendung der Funktionen auf Beispielen findest du in dem <a href="stat-modeling-beta.html">Kapitel zur Beta Regression</a>. Dort gehe ich dann auch näher auf das Modell und der Güte der Modellanpassung ein. Insbesondere hier gibt es dann einige unschöne Limitierungen wenn du zu nah an der Grenze von <span class="math inline">\([0,1]\)</span> bist.</p>
</section>
</section>
<section id="die-faktoren-f" class="level3" data-number="42.4.3">
<h3 data-number="42.4.3" class="anchored" data-anchor-id="die-faktoren-f"><span class="header-section-number">42.4.3</span> Die Faktoren <span class="math inline">\(f\)</span></h3>
<p>Neben dem Messwert <span class="math inline">\(y\)</span> müssen wir natürlich auch die Faktoren <span class="math inline">\(f\)</span> mit dem ersten Faktor <span class="math inline">\(f_1\)</span> und dem zweiten Faktor <span class="math inline">\(f_2\)</span> berücksichtigen. Meistens haben wir hier aber einen Hauptfaktor mit den Behandlungsgruppen und dann noch einen zweiten Faktor der uns nicht so ganz interessiert. Das hängt aber von der Fragestellung ab, es kann auch zwei Hauptfaktoren geben. Im Folgenden betrachten wir jedenfalls jeden Faktor getrennt. Wir schauen jetzt einmal, ob sich die Fallzahlen in den Gruppen unterscheiden, wie wir mit der Varianz in den Gruppen umgehen und was schlussendlich als Fehlerbalken dargestellt werden soll.</p>
<section id="balanciert-oder-unbalanciert" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="balanciert-oder-unbalanciert">Balanciert oder unbalanciert</h4>
<p>Eine der ersten Fragen an die Gruppen ist, ob wir ein balanciertes Desgin vorliegen haben oder ein unbalanciertes Design. Im Falle eines balancierten Design sind die Fallzahlen in jeder Behandlungsgruppe gleich groß. Du solltest dein Experiment immer so planen, dass die Gruppen immer gleich groß sind. Das macht vieles einfacher. Manachmal kann es passieren, dass du eine Beobachtung verlierst oder aber eine Messung nicht klappt. Dann hast du ein unbalanciertes Design vorliegen. In einem unbalancierten Design ist die Fallzahl in allen Gruppe nicht gleich groß.</p>
<dl>
<dt>Balanciertes Design</dt>
<dd>
<p>Alle Behandlungsgruppen <span class="math inline">\(1, 2, ..., p\)</span> haben die gleiche Fallzahl <span class="math inline">\(n_g\)</span> in den Behandlungsgruppen.</p>
</dd>
<dt>Unbalanciertes Design</dt>
<dd>
<p>Die Behandlungsgruppen <span class="math inline">\(1, 2, ..., p\)</span> haben unterschiedliche Fallzahlen <span class="math inline">\(n_1, n_2, ..., n_p\)</span> in den Behandlungsgruppen.</p>
</dd>
</dl>
<p>Um es gleich vorwegzunehmen das R Paket <code>{emmeans}</code> wurde extra dafür gebaut mit balancierten und im Besonderen mit unbalancierten Daten umzugehen. Eine ANOVA kann prinzipiell auch mit unbalancierten Daten umgehen. Beim Tukey HSD Test und anderen älteren Implementierungen eines Post-hoc Test wird es dann schwieriger.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Was tun bei unbalancierten Daten?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wenn du <em>unbedingt</em> balancierte Daten ohne fehlende Werte brauchst, dann kannst du die fehlenden Werte in einer Gruppe durch den Mittelwert der jeweiligen Gruppe ersetzen. Das hat dann nicht so starke Auswirkungen, aber überfährt auch einen statistischen Engel.</p>
</div>
</div>
</section>
<section id="varianzhomogenität-und-varianzheterogenität" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored">Varianzhomogenität und Varianzheterogenität</h4>
<p>Kommen wir nun zur Varianzhomogenität oder Varianzhterogenität in den Gruppen des Behandlunsgfaktors. Wir betrachten also meistens nur den wichtigen Faktor <span class="math inline">\(f_1\)</span> und ignorieren ein wenig den zweiten Faktor. Prinzipiell kannst du natürlich auch den zweiten Faktor anschauen, aber dann werden es immer mehr Gruppen und Faktorkombinationen. Am Ende kommt dann sowieso heraus, dass über alle Gruppen hinweg keine homogenen Varianzen vorliegen. Wenn du mehr lesen willst so gibt es auf der Seite DSFAIR noch einen Artikel zu <code>{emmeans}</code> und der Frage <a href="https://schmidtpaul.github.io/dsfair_quarto/ch/summaryarticles/whyseequal.html">Why are the StdErr all the same?</a></p>
<dl>
<dt>Wann liegt vermutlich Varianzheterogenität in deinen experimentellen Faktoren <span class="math inline">\(f\)</span> vor?</dt>
<dd>
<p>Es gibt so ein paar Daumenregeln, die dir helfen abzuschätzen, ob in deinen Gruppen Varianzheterogenität vorliegt. Um es kurz zu machen, vermutlich hast du mindestens leichte Varianzhterogenität in den Daten vorliegen.</p>
</dd>
</dl>
<ol type="1">
<li>Du hat viele Behandlungsgruppen. Je mehr Gruppen du hast oder eben dann auch Faktorkombinationen, die du testen möchtest, desto wahrscheinlicher wird es, dass mindestens eine Gruppe eine unterschiedliche Varianz hat. Du hast Varianzheterogenität vorliegen.</li>
<li>Du misst deine Gruppen über die Zeit. Je größer, schwerer oder allgemein höher ein Messwert wird, desto größer wird auch die Varianz. Schaust du dir deine Messwerte über die Zeit an hast du meistens Varianzheterogenität vorliegen.</li>
<li>Deine Kontrolle ohne Behandlung verhält sich meistens nicht so, wie die Gruppen, die eine Behandlung erhalten haben. Wenn du nichts machst in deiner negativen Kontrolle, dann hast du meistens eine andere Streuung der Messwerte als unter einer Behandlung.</li>
<li>Diene Behandlungen sind stark unterschiedlich. Wenn deine Behandlungen sich biologisch oder chemisch in der Wirkung unterscheiden, denn werden vermutlich deine Messwerte auch anders streuen. Hier spielt auch die Anwendung der Behandlung und deren Bereitstellung eine Rolle. Wenn was nicht gleich ist, dann wird es vermutlich nicht gleiche Messwerte erzeugen.</li>
<li>Du hast wenig Fallzahl pro Gruppe oder Faktorkombination. Wenn du wenig Fallzahl in einer Gruppe hast, dann reicht schon eine (zufällige) Messabweichung und schon sind deine Varianzen heterogen.</li>
</ol>
<p>Gut, jetzt wissen wir, dass du vermutlich Varianzheterogenität in deinen Daten vorliegen hast. Erstmal ist das kein so großes Problem.</p>
<dl>
<dt>Tut Varianzhterogenität anstatt Varianzhomogenität weh?</dt>
<dd>
<p>Nein. Meistens ist die Varianzheterogenität nicht so ausgeprägt, dass du nicht auch eine ANOVA rechnen kannst. Über alle Gruppen hinweg wird dann zwar in einer ANOVA die Varianz gemmittelt und es kann dann zu weniger signifkanten Ergebnissen führen, aber so schlimm ist es nicht. Im Post-hoc Test solltest du aber die Varianzheterogenität berücksichtigen, da du ja immer nur zwei Gruppen gleichzeitig betrachtest.</p>
</dd>
</dl>
<p>Wie immer kannst du alles natürlich auch statistisch Testen. Das ist dann bei der Varianzhomogenität nicht anders. Mehr dazu dann im <a href="stat-tests-pretest.html">Kapitel zum Pre-Test oder Vortest</a>. Hier konzentriere ich mich auf die visuelle Überprüfung, die meistens in einem Setting mit niedriger Fallzahl in den Gruppen vollkommen ausreicht. Die Tests liefern meist eine falsche numerische Sicherheit, die so nicht stimmt.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><code>geom_bar()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false"><code>geom_boxplot()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Excel</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Hier einmal die theoretischen Abbilungen von drei Gruppen mit Varianzhomogenität und Varianzheterogenität. Hier wird schnell klar, dass du mit mehr Behandlungsgruppen kaum die Annahme für Varianzhomogenität aufrecht erhalten kannst. Insbesondere Kontrollen oder Standardbehandlungen haben große oder kleinere Varianzen als der Rest der Behandlungen. Manchaml hat man aber Glück und die Varianzen sind eher homogen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-posthoc-var-homo-bar" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-posthoc-var-homo-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-posthoc-var-homo-bar-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;42.2— Darstellung der Varianzhomogenität und Varianzheterogenität in einem Barplot. [Zum Vergrößern anklicken]"><img src="stat-tests-posthoc2_files/figure-html/fig-posthoc-var-homo-bar-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-posthoc-var-homo-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.2— Darstellung der Varianzhomogenität und Varianzheterogenität in einem Barplot. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-posthoc-var-homo-box" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-posthoc-var-homo-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-posthoc-var-homo-box-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;42.3— Darstellung der Varianzhomogenität und Varianzheterogenität in einem Boxplot. [Zum Vergrößern anklicken]"><img src="stat-tests-posthoc2_files/figure-html/fig-posthoc-var-homo-box-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-posthoc-var-homo-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.3— Darstellung der Varianzhomogenität und Varianzheterogenität in einem Boxplot. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Wir bauen wir usn jetzt die Barplots oder Säulendiagramme? Entweder direkt aus <code>{ememans}</code>, wie ich dir das weiter unten zum <em>Compact letter display</em> zeige oder eben als Wiederholung des <a href="eda-ggplot.html">Kapitels zur Visualisierung von Daten</a>. Wir bauen uns also einmal den einfaktoriellen Barplot wie auch den zweifaktoriellen Barplot.</p>
<section id="einfaktorieller-barplot" class="level3" data-number="42.4.4">
<h3 data-number="42.4.4" class="anchored" data-anchor-id="einfaktorieller-barplot"><span class="header-section-number">42.4.4</span> Einfaktorieller Barplot</h3>
<p>Für den einfaktoriellen Barplot brauchen wir einmal den Mittelwert und die Standardabweichung der einzelne Floharten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>stat_fac1_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(jump_length))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>stat_fac1_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  animal  mean    sd
  &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 dog     8.13  2.14
2 cat     4.74  1.90
3 fox     9.16  1.10</code></pre>
</div>
</div>
<p>Dann können wir uns auch schon den Barplot mit <code>{ggplot}</code> erstellen. Später willst du dann noch das <em>Compact letter display</em> über den Balken als Mittelwerte ergänzen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_fac1_tbl, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-posthoc-barplot-1fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-posthoc-barplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-barplot-1fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Abbildung&nbsp;42.4— Beispielhafter einfaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-barplot-1fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-posthoc-barplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.4— Beispielhafter einfaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweifaktorieller-barplot" class="level3" data-number="42.4.5">
<h3 data-number="42.4.5" class="anchored" data-anchor-id="zweifaktorieller-barplot"><span class="header-section-number">42.4.5</span> Zweifaktorieller Barplot</h3>
<p>Für den zweifaktoriellen Barplot brauchen wir einmal den Mittelwert und die Standardabweichung der einzelne Floharten getrennt für die beiden Messorte. Das geht natürlich auch umgedreht, also die Messorte für die Floharten. Das kommt dann auf deine Fragestellung an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>stat_fac2_tbl <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal, site) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(jump_length))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>stat_fac2_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
# Groups:   animal [3]
  animal site     mean    sd
  &lt;fct&gt;  &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 cat    city     13.6  1.88
2 cat    village  15.2  2.35
3 dog    city     16.7  2.26
4 dog    village  16.6  1.21
5 fox    city     20.1  1.15
6 fox    village  17.0  1.73</code></pre>
</div>
</div>
<p>Und dann können wir auch schon den zweifaktoriellen Barplot in <code>{ggplot}</code> erstellen. Du musst schauen, was du auf die x-Achse legst und was du dann auf die Legende und daher mit <code>fill</code> gruppierst. Damit die Positionen passen, spiele ich hier noch mit der Funktion <code>position_dodge()</code> rum.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_fac2_tbl, </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.9</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-posthoc-barplot-2fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-posthoc-barplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-barplot-2fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Abbildung&nbsp;42.5— Beispielhafter zweifaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Messorten."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-barplot-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-posthoc-barplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.5— Beispielhafter zweifaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Messorten.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<section id="einfaktorieller-boxplot" class="level3" data-number="42.4.6">
<h3 data-number="42.4.6" class="anchored" data-anchor-id="einfaktorieller-boxplot"><span class="header-section-number">42.4.6</span> Einfaktorieller Boxplot</h3>
<p>Das praktische bei den Boxplots ist, dass wir hier nichts mehr vorrechnen müssen, sondern direkt die Boxplots in <code>{ggplot}</code> erstellen können. Ich finde man sieht immer in einem Boxplot besser, ob die Streuung um den Median eher homogen oder eher heterogen ist. Gerne ergänze ich noch den Mittelwert mit der Funktion <code>stat_summary()</code>.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-posthoc-boxplot-1fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-posthoc-boxplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-boxplot-1fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Abbildung&nbsp;42.6— Beispielhafter einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-boxplot-1fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-posthoc-boxplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.6— Beispielhafter einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweifaktorieller-boxplot" class="level3" data-number="42.4.7">
<h3 data-number="42.4.7" class="anchored" data-anchor-id="zweifaktorieller-boxplot"><span class="header-section-number">42.4.7</span> Zweifaktorieller Boxplot</h3>
<p>Den zweifaktoriellen Boxplot erstellen wir für die einzelnen Floharten getrennt für die beiden Messorte. Du musst schauen, was du auf die x-Achse legst und was du dann auf die Legende und daher mit <code>fill</code> gruppierst. Gerne ergänze ich noch den Mittelwert mit der Funktion <code>stat_summary()</code>, muss hier aber schauen, dass ich nach dem Faktor <code>animal</code> gruppiere und dann noch mit der Funktion <code>position_dodge()</code> die richtige Position finde.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac2_tbl, </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="fu">aes</span>(<span class="at">group =</span> animal), </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-posthoc-boxplot-2fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-posthoc-boxplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-boxplot-2fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Abbildung&nbsp;42.7— Beispielhafter zweifaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Messorten."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-boxplot-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-posthoc-boxplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.7— Beispielhafter zweifaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Messorten.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>Dann habe ich mich doch noch hingesetzt und einmal für dich die Videos gemacht, wie du dann einen Barplot oder eben ein Säulendigramm in Excel erstellst. Daran kannst du natürlich auch überprüfen, ob die Varianzen homogen sind oder nicht. Das ganze macht dann nur als Video Sinn, denn sonst kannst du ja nicht nachvollziehen, was ich geklickt habe.</p>
<p>Hier also erstmal die einfachere Variante mit dem einfaktoriellen Barplot. Beginnen wollen wir wie immer mit der Berechnung der Mittelwerte und der Standardabweichung. Bitte nutze für die Standardabweichung die Funktion <code>STABW.S()</code> in Excel.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/UdZ5p8euo64" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Und im Anschluss nochmal das Video für den zweifaktoriellen Barplot. Du hast jetzt eben nicht nur eine Behandlungsgruppe vorliegen sondern zwei Behandlungsgruppen. Dann musst du etwas mehr Arbeit reinstecken um alle Mittelwerte und Standardabweichungen zu berechnen. Bitte nutze auch hier für die Standardabweichung die Funktion <code>STABW.S()</code> in Excel.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/mGSMZ6C7x4E" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div>
</div>
</div>
</section>
<section id="standardfehler-oder-standardabweichung" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="standardfehler-oder-standardabweichung">Standardfehler oder Standardabweichung</h4>
<p>Wenn wir uns jetzt entschieden haben, wie wir die Varianz modellieren wollen, stellt sich häufig die Frage, was wollen wir denn eigentlich in den Säulendiagrammen darstellen. Wie du in dem vorherigen Abschnitt ja schon gesehen hast, zeige ich nicht die Mittelwerte und die Varianz sondern eben die Mittelwerte und die Standardabweichung als Fehlerbalken. Dies ist auch die übliche Darstellung, wenn wir uns einen Barplot anschauen. Ein Barplot stellt den Mittelwert und die Standardabweichung als Fehlerbalken dar. Neben dem der Standardabweichung könntest du auch den Standardfehler als Fehlerbalken wählen. Hier nochmal die Formel für den Standardfehler und die Umstellung nach der Standardabweichung.</p>
<p><span class="math display">\[
SE = \cfrac{s}{\sqrt{n_g}};\; s = SE \cdot \sqrt{n_g}
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(SE\)</span>, dem Standardfehler der jeweiligen Gruppe.</li>
<li><span class="math inline">\(s\)</span>, der Standardabweichung der jeweiligen Gruppe.</li>
<li><span class="math inline">\(n_g\)</span>, der jeweiligen Gruppengröße.</li>
</ul>
<p>Zu den Fehlerbalken liefert die Publikation <a href="https://rupress.org/jcb/article/177/1/7/34602/Error-bars-in-experimental-biology">Error bars in experimental biology</a> von <span class="citation" data-cites="cumming2007error">Cumming u.&nbsp;a. (<a href="#ref-cumming2007error" role="doc-biblioref">2007</a>)</span> nochmal einen Überblick über Fehlerbalken und welche Fehlerbalken man den nun nutzen sollte. Ich gebe hier nochmal eine kurze Übersicht.</p>
<dl>
<dt>Der Standardfehler</dt>
<dd>
<p>Statistische Tests nutzen den Standardfehler um eine Aussage über die Signifikanz zu treffen. Der Standardfehler bleibt immer im Wertebereich des Messwertes.</p>
</dd>
<dt>Die Standardabweichung</dt>
<dd>
<p>Barplots oder Säulendiagramme nutzen die Standardabweichung als Fehlerbalken um eine Aussage über die Streuung um den Mittelwert zu treffen. <em>In bestimmten Fällen macht es Sinn dennoch den Standardfehler als Fehlerbalken zu nutzen, wenn dein Messwert im Wertebereich, wie eine Boniturnote, begrenzt ist.</em></p>
</dd>
</dl>
<p>Am Ende gibt dazu dann auch eine passend die Publikation von <span class="citation" data-cites="kozak2020analyzing">Kozak und Piepho (<a href="#ref-kozak2020analyzing" role="doc-biblioref">2020</a>)</span> mit dem Titel <a href="https://www.cambridge.org/core/services/aop-cambridge-core/content/view/92DB0AF151C157B9C6E2FA40F9C9B635/S0014479719000401a.pdf/analyzing-designed-experiments-should-we-report-standard-deviations-or-standard-errors-of-the-mean-or-standard-errors-of-the-difference-or-what.pdf">Analyzing designed experiments: Should we report standard deviations or standard errors of the mean or standard errors of the difference or what?</a></p>
</section>
</section>
</section>
<section id="sec-emmeans" class="level2" data-number="42.5">
<h2 data-number="42.5" class="anchored" data-anchor-id="sec-emmeans"><span class="header-section-number">42.5</span> Der effektive Pfad mit <code>{emmeans}</code></h2>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Das tolle an <code>{emmeans}</code> ist die Flexibilität. Du kannst sehr einfach viele Methoden in <code>{emmeans}</code> abdecken. Wenn du die Option für die Adjustierung auf <code>tukey</code> stellst, dann rechnest du faktisch einen besseren Tukey HSD Test. Wenn du dann noch in <code>{emmeans}</code> die Option mit der Varianzheterogenität wählst, rechnest du einen besseren Games Howell Test. Mehr dazu dann am Ende des Abschnitts, wie du die Ergebnisse präsentierst, da musst du dann gar nicht so viel schreiben.</p>
</div>
</div>
<p>Wenn du ein zweifaktorielles Design mit etwas wenig Fallzahl pro Gruppe vorliegen hast, dann ist <code>{emmeans}</code> die Antwort auf deine Herausforderungen. Darüber hinaus können wir auch sehr einfach Varianzheterogenität modellieren, die Adjustierung für multiple Vergleiche an und ausschalten sowie direkt das <em>Compact letter display</em> erhalten. Das Paket <code>{emmeans}</code> ist damit die <em>effiktive</em> Lösung für einen Gruppenvergleich in den Agarwissenschaften und darüber hinaus. Schauen wir uns also im Folgenden einmal das Paket näher an. Ich verzichte hier auf eine tiefere händische Berechnung sondern konzentriere mich auf die Anwendung der häufigsten Analysefälle.</p>
<p>Ich kann in diesem Abschnitt hier nicht alles erklären und im Detail durchgehen was <code>{emmeans}</code> alles kann. Hier gibt es noch ein Tutorium zu <code>{emmeans}</code> mit dem Titel <a href="https://aosmith.rbind.io/2019/03/25/getting-started-with-emmeans/">Getting started with emmeans</a>. Daneben gibt es auch noch die <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/basics.html#contents">Einführung mit Theorie auf der Seite des R Paktes</a> oder aber auch der Starter unter <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/AQuickStart.html">Quick start guide for emmeans</a>. Wenn du eine allgemeine Übersicht der Themen in <code>{emmeans}</code> brauchst dann hilft dir der <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/vignette-topics.html">Index of vignette topics – emmeans package, Version 1.10.6</a>. Beginnen wir aber wie immer mit den drängensten Fragen. Wie sieht es mit der Varianz, der Adjustierung und der möglichen Vergleiche sowie der Fallzahl in den einzelnen Behandlungsgruppen aus?</p>
<dl>
<dt>Varianzhomogenität oder Varianzheterogenität</dt>
<dd>
<p>Wir können in <code>{emmeans}</code> eine mögliche Varianzheterogenität modellieren, wenn wir das nicht tun, dann rechnet <code>{emmeans}</code> immer unter der Annahme von Varianzhomogenität. Wenn du nicht für die Varianzheterogenität adjustieren möchtest, dann rechnest du faktisch einen Tukey HSD Test, wenn die Fallzahl in den Gruppen gleich ist. Der Tukey HSD Test rechnet <em>immer</em> mit Varianzhomogenität. In allen Beispielen hier, werde ich aber für Varianzheterogenität adjustieren. Dazu nutze ich dann die Option <code>vcov. = sandwich::vcovHAC</code> im <code>emmeans()</code> Funktionsaufruf. In dem R Paket <code>{sandwich}</code> gibt es eine riesige Anzahl an möglichen Funktionen um für Varianzheterogenität zu adjustieren. Wir nutzen hier die Adjustierung <code>vcovHAC</code>, die in vielen Fällen vollkommen ausreichend ist.</p>
</dd>
<dt>Adjustierung für multiple Vergleiche</dt>
<dd>
<p>Das Paket <code>{emmeans}</code> kann sehr einfach für die Adjustierung von multiplen Vergleichen angepasst werden um adjustierte p-Werte zu erhalten. In der Standardeinstellung nutzt <code>{emmeans}</code> die Quartile aus einem Tukey HSD Test und somit ist <code>{emmeans}</code> gar nicht so weit weg von dem Tukey HSD Test. Ich stelle aber meistens die Adjustierung auf Bonferroni mit der Option <code>adjust = "bonferroni"</code>, da diese Adjustierung etwas eingängiger ist. Das bleibt aber dir überlassen, ob du überhaupt eine Adustierung wählen willst. Mit der Option <code>adjust = "none"</code> stellst du die Adjustierung für multiple Vergleiche aus. Du erhälst die rohen p-Werte, die manchmal auch nützlich sind.</p>
</dd>
<dt>Mögliche multiple Vergleiche</dt>
<dd>
<p>In den folgenden Beispielen rechne ich immer einen <code>all-pair</code> Vergleich. Ich werde also alle Gruppen mit allen anderen Gruppen vergleichen. Ob das jetzt wirklich immer Sinn macht sei dahingestellt. Du kannst abr auch alle Gruppen nur zu eienr Kontrolle vergleichen. Dann müssen wir die Funktion <code>contrast()</code> anders aufbauen. Wir nutzen dann die Option <code>method</code> sowie <code>ref</code> um mitzuteilen welche Behandlungsgruppe die Kontrolle ist. Wir erhalten dann folgenden Funktionsaufruf <code>contrast(method = "trt.vs.ctrl", ref = "fox")</code>. Die Hilfeseite <a href="https://www.rdocumentation.org/packages/emmeans/versions/1.10.6/topics/contrast-methods">contrast-methods</a> gibt dir nochmal eine Übersicht was alles in <code>{emmeans}</code> möglich ist. Welche Kontrast dann neben dem <code>all-pair</code> noch passend ist hängt dann sehr von deiner Fragestellung ab. Hier kann ich dann keine allgemeine Aussage zu treffen.</p>
</dd>
<dt>Fallzahl in den einzelnen Behandlungsgruppen</dt>
<dd>
<p>Die Stärke von <code>{emmeans}</code> ist, dass du dir keine Gedanken machen musst, wie die Fallzahlen in deinen einzelnen Behandlungsgruppen sind. Im Idealfall sind die Fallzahlen balanciert, also die hast in jeder Gruppe die gleiche Anzahl an Beobachtungen. Machmal klappt das aber nicht in einem Experiment und dir fehlen irgendow Beobachtungen, dann rechnet dir <code>{emmeans}</code> aber dennoch richtige statistische Maßzahlen aus. Das ist eine wunderbare Eigenschaft von <code>{emmeans}</code>. Wenn alles balanciert ist, dann ist alles super. Wenn du aber unbalancierte Daten hast, musst du dich nicht drum kümmern.</p>
</dd>
</dl>
<p>Die Stärke der Berücksichtigung von unbalancierten Gruppengrößen kommt von der Berechngn der <em>marginal effects</em>. Deshalb heißt das Paket ja auch <code>{emmeans}</code> für <em>Estimated Marginal Means</em>. Wenn du dich jetzt fragst, was sind denn diese <em>marginal means</em> dann gibt es darauf hier und jetzt keine kurze Antwort. Dafür verweise ich auf <span class="citation" data-cites="heiss2022">Heiss (<a href="#ref-heiss2022" role="doc-biblioref">2022</a>)</span> und das Onlinetutorium <a href="https://www.andrewheiss.com/blog/2022/05/20/marginalia/">Marginalia: A guide to figuring out what the heck marginal effects, marginal slopes, average marginal effects, marginal effects at the mean, and all these other marginal things are</a>. Heiss erklärt dort sehr schön die Zusammenhänge. Dazu dann noch der Verweis auf die Webseite <a href="https://marginaleffects.com/bonus/get_started.html">Model to Meaning</a> von <span class="citation" data-cites="heiss2024">Arel-Bundock u.&nbsp;a. (<a href="#ref-heiss2024" role="doc-biblioref">2024</a>)</span> um nochmal tiefer in das Modellieren von Daten einzusteigen.</p>
<p>Wichtig ist aber, du musst <em>marginal effects</em> oder das Konzept dahinter nicht verstanden haben um das R Paket <code>{emmeans}</code> sinnvoll nutzen zu können. Ja, damit überfahren wir wieder einen statistischen Engel, aber so ist es manchmal, wenn wir hier Sachen auf die Straße bringen wollen. Also fangen wir hier jetzt einmal an die einfaktorielle und zweifaktorielle Analyse in <code>{emmeans}</code> zu rechnen und zu interpretieren.</p>
<section id="einfaktorielle-analyse" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorielle-analyse">Einfaktorielle Analyse</h4>
<p>Beginnen wir mit der einfaktorielle Analyse in dem wir erstmal ein ANOVA Modell rechnen. Wir nehmen hier die Sprungweite in [cm] als unseren Messwert <span class="math inline">\(y\)</span> und dann die Tierrasse <span class="math inline">\(f_1\)</span> als Faktor in das Modell. Hier brauchen wir das ANOVA Modell nur zur Berechnung unserer statistischen Maßzahlen. Wir könnten die Interpreation also auch weglassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fac1_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ich nutze jetzt das ANOVA Modell gleich für den Aufruf der <code>emmeans()</code> Funktion, die uns die Mittelwerte und die Varianzen in den Gruppen berechnet. Ich wähle hier die Adjustierung für die Varianzheterogenität mit der Option <code>vcov.</code> als Standard. Eiegntlich rechne ich immer unter der Annahme der Varianzheterogenität, da ich nicht viel verliere aber viel falsch machen kann, wenn ich die Heterogenität nicht berücksichtige.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj <span class="ot">&lt;-</span> fac1_aov <span class="sc">|&gt;</span>  </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean    SE df lower.CL upper.CL
 dog      8.13 0.427 18     7.23     9.03
 cat      4.74 0.810 18     3.04     6.44
 fox      9.16 0.468 18     8.17    10.14

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wir erhalten also unser <code>{emmeans}</code> Objekt für unsere einfaktorielle Analyse. Darin ist eigentlich alles enthalten was wir jetzt brauchen. Die Mittelwerte der Gruppen sind da und auch die entsprechende Standardfehler der Gruppen. Wenn du die Standardabweichung zurückrechnen willst, dann musst du <span class="math inline">\(SE \cdot \sqrt{n_g}\)</span> rechnen mit der Gruppengröße <span class="math inline">\(n_g =7\)</span> in unserem Fall. Denn nun ist ja die Frage, was willst du haben? Ich zeige dir in den folgenden Tabs einmal wie du die p-Werte, das <em>Comapct letter display</em> und die 95% Konfidenzintervalle berechnest.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">p-Werte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><em>Compact letter display</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">95% Konfidenzintervall</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Beginnen wir mit den p-Werten, die jeder braucht. Wir können das <code>emm_fac1_obj</code> Objekt von oben jetzt einfach in die Funktion <code>{contrast}</code> stecken und dann definieren welche Vergleiche gerechnet werden sollen. In den agrarwissenschaftlichen Fächern ist des dann meist ein <code>all-pair</code> Vergleich. Wir vergleichen alles mit allem. Am Ende wähle ich onch die Adjustierung für multiple Vergleiche nach Bonferroni.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac1_obj <span class="ot">&lt;-</span> emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac1_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast  estimate    SE df t.ratio p.value
 dog - cat     3.39 0.904 18   3.744  0.0045
 dog - fox    -1.03 0.635 18  -1.620  0.3678
 cat - fox    -4.41 0.997 18  -4.425  0.0010

P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
<p>Wir sehen, dass wir die Vergleiche für die einzelnen Floharten für die Sprunglänge erhalten. Der <code>estimate</code> ist der Effekt und damit die Differenz der Mittelwerte für die Sprungweite in [cm] für den jeweiligen Verleiche. Dann sehen wir in der Spalte <code>SE</code> noch, dass wir richtig für Varianzhterogenität adjustiert haben, da der Vergleich <code>dog - cat</code> nur <span class="math inline">\(2/3\)</span> der Varianz der beiden anderen Vergleiche zeigt. Wir sehen dann am Ende, dass die Vergleiche <code>dog - cat</code> und <code>cat - fox</code> signifikant unterschiedlich sind. Die p-Werte liegen unter dem Signifikanzniveau von 5%.</p>
<p>Jetzt ist es manchmal so, dass du die Mittelwerte, die Differenz der Mittelwerte und die p-Werte haben möchtest. Das kannst du ganz einfach durch die Funktion <code>pwpm()</code> erreichen. Hier gibt es dann natürlich nur die paarweisen Vergleiche.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          dog - cat dog - fox cat - fox
dog - cat   [ 3.39]    0.0010    0.0012
dog - fox      4.41   [-1.03]    0.0045
cat - fox      7.80      3.39   [-4.41]

Row and column labels: contrast
Upper triangle: P values   adjust = "bonferroni"
Diagonal: [Estimates] (estimate) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
</div>
<p>Am Ende gibt es in <code>{emmeans}</code> noch den paarweisen p-Wert Plot, der die p-Werte einmal auf der x-Achse visualisiert. Da siehst du dann nochmal die Ordnung der Signifikanz über die gesamten Vergleiche. Die Abbildung finde ich persönlich manchmal interessant und manchmal wenig aussagekräftig. Kommt immer auf den Fall an.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpp</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Abbildung&nbsp;42.8— Visualisierung der Ergebnisse im Pairwise P-value plot. Auf der y-Achse sind die Gruppen und die entsprechenden Gruppenmittelwerte dargestellt."><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.8— Visualisierung der Ergebnisse im Pairwise P-value plot. Auf der y-Achse sind die Gruppen und die entsprechenden Gruppenmittelwerte dargestellt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Nachdem wir in dem vorherigen Tab die p-Werte berechnet haben, könen wir jetzt einmal das <em>Compact letter display</em> erstellen. Hier hat das R Paket <code>{emmeans}</code> eine eigene Funktion mit <code>cld()</code>. Die Funktion nimmt das Objekt <code>emm_fac1_obj</code> und berechnet darauf das nach Bonferroni adjustierte <em>Compact letter display</em>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>emm_cld_fac1_obj <span class="ot">&lt;-</span> emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>emm_cld_fac1_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean    SE df lower.CL upper.CL .group
 cat      4.74 0.810 18     2.61     6.88  a    
 dog      8.13 0.427 18     7.00     9.25   b   
 fox      9.16 0.468 18     7.92    10.39   b   

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 3 estimates 
P value adjustment: bonferroni method for 3 tests 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Der größte Vorteil von <code>{emmeans}</code> ist jetzt, dass wir die Ausgabe des <em>Compact letter displays</em> direkt nutzen können um unseren Barplot zu zeichnen. Wir müssen nur einmal die Werte der Standardfehler mit der Wurzel der Gruppenfallzahl multiplizieren um auf die Standardabweichung zu kommen. Wenn du möchtest, kannst du auch den Standardfehler als Fehlerbalken nutzen, musst es nur Angeben. Da wir hier sieben Flöhe je Tierart gemessen haben, multiplizieren wir den Standardfehler mit der Wurzel von 7 um auf die Standardabweichung zu kommen. Dann entferne ich noch die Leerzeichen in der Spalte <code>.group</code> mit der Funktion <code>str_trim()</code> und ich kann den Barplot erstellen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>emm_cld_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">7</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> emmean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="fl">0.5</span>),</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-fac1-cld" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-fac1-cld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-fac1-cld-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Abbildung&nbsp;42.9— Barplot oder Säulendigramm der mittleren Sprungweiten in [cm] für drei Floharten. Die Fehlerbalken stellen die Standardabweichung dar. Die Buchstaben das Bonferroni adjustierte Compact letter display."><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-fac1-cld-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-fac1-cld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.9— Barplot oder Säulendigramm der mittleren Sprungweiten in [cm] für drei Floharten. Die Fehlerbalken stellen die Standardabweichung dar. Die Buchstaben das Bonferroni adjustierte <em>Compact letter display</em>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Am Ende können wir dann auch aus den paarweisen Vergleichen die 95% Konfidenzintervalle berechnen. Hier nutzen wir dann die Funktion <code>tidy()</code> aus dem Paket <code>{broom}</code> um uns die 95% Konfidenzintervalle sauber wiedergeben zu lassen. Du kannst noch die Kontraste auf <code>revpairwise</code> stellen, wenn die Vergleiche umdrehen willst.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>emm_ci_fac1_obj <span class="ot">&lt;-</span> emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, adj.p.value, conf.low, conf.high) </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>emm_ci_fac1_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  contrast  estimate adj.p.value conf.low conf.high
  &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 dog - cat     3.39    0.00446     0.999     5.77 
2 dog - fox    -1.03    0.368      -2.70      0.647
3 cat - fox    -4.41    0.000980   -7.05     -1.78 </code></pre>
</div>
</div>
<p>Die Stärke eines 95% Konfidenzintervalls ist ja die Signifikanz mit der Relevanz zu verbinden. Daher setze ich jetzt mal die Relevanzschwelle <code>relevance_lvl</code> auf <span class="math inline">\(&gt;0.75cm\)</span>. Wenn also Floharten im Mittel sich mindestens um <span class="math inline">\(0.75cm\)</span> unterscheiden, dann ist der Vergleich relevant. Das habe ich jetzt einfach so entschieden. Wir schauen hier dann auf größer/gleich, was auch mehr Sinn macht. Theoretisch kannst du auch in beide Richtungen die Relevanz definieren, aber in der Anwendung ist es eher selten, dass uns beide Richtungen interessieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>relevance_lvl <span class="ot">&lt;-</span> <span class="fl">0.75</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung siehst du einmal die 95% Konfidenzintervalle für alle paarweisen Vergleiche. Ich habe am Anfang nochmal eine Regel mit <code>case_when()</code> erstellt, nachder ich dann die 95% Konfidenzintervall nach der Signifikanz und Relevanz einfärbe. Das ist ja die Stärke der 95% Konfidenzintervalle und dann sollte man die auch Nutzen. Wo du die Relevanzschwelle legst, ist dann dir selber überlassen. Das hängt von deiner wissenschaftlichen Fragestellung ab.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>emm_ci_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig_lgl =</span> <span class="fu">case_when</span>(<span class="fu">between</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">n</span>()), conf.low, conf.high) <span class="sc">~</span> <span class="st">"n.s."</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                             relevance_lvl <span class="sc">&lt;</span> conf.low <span class="sc">~</span> <span class="st">"s. &amp; r."</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> <span class="st">"s."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(contrast, <span class="at">y =</span> estimate, </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">color =</span> sig_lgl)) <span class="sc">+</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> relevance_lvl, <span class="at">linetype =</span> <span class="st">"11"</span>,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Mittelwertsunterschied"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Abbildung&nbsp;42.10— Die 95% Konfidenzintervalle für die allpair-Vergleiche der mittleren Sprungweite in [cm] für die drei Floharten. Die Farben stellen die Signifkanz und Relevanz der 95% Konfidenzintervalle dar. Als relevant sind mittlere Differenzen größer als 0.75cm definiert. (n.s) Nicht signifikanter Vergleich, da die 0 im 95% Konfidenzintervall enthalten ist. (s) Signifikanter, nicht relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und links von der Relevanzschwelle liegt. (s. &amp; r.) Signifikanter, relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und rechts von der Relevanzschwelle liegt. [Zum Vergrößern anklicken]"><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.10— Die 95% Konfidenzintervalle für die <em>allpair</em>-Vergleiche der mittleren Sprungweite in [cm] für die drei Floharten. Die Farben stellen die Signifkanz und Relevanz der 95% Konfidenzintervalle dar. Als relevant sind mittlere Differenzen größer als <span class="math inline">\(0.75cm\)</span> definiert. <strong>(n.s)</strong> Nicht signifikanter Vergleich, da die 0 im 95% Konfidenzintervall enthalten ist. <strong>(s)</strong> Signifikanter, nicht relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und links von der Relevanzschwelle liegt. <strong>(s. &amp; r.)</strong> Signifikanter, relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und rechts von der Relevanzschwelle liegt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="zweifaktorielle-analyse" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorielle-analyse">Zweifaktorielle Analyse</h4>
<p>Nachdem wir uns die einfaktorielle Analyse angeschaut haben, kommen wir jetzt du der eigentlich interessanten Analyse. Wir wollen nämlich jetzt mal zwei Faktoren in einer zweifaktoriellen Analyse auswerten. Meistens haben wir nicht nur einen Faktor vorliegen sondern minestens zwei. Daher hier einmal das MOdell für unsere Sprungweite in [cm] für den Faktor <code>animal</code> mit den drei Floharten sowie dem Faktor <code>site</code> und den zwei Messorten Stadt und Dorf. Ich ahbe hier absichtlich den zweiten Faktor nur auf zwei Level begrenz, sonst werden die Ausgaben der Funktionen so groß. Später können deine Faktoren natürlich mehr Level oder Gruppen haben. Wir rechnen also einmal eine ANOVA um uns die statistsichen Maßzahlen als ein Modell wiedergeben zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fac2_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wenn wir zwei Faktoren vorliegen haben, dann müssen wir entscheiden, wie wir die zwei Faktoren auswerten wollen. Hierbei kommen wir um den Begriff <em>nested</em> (deu. <em>verschachtelt</em>, nicht gebräuchlich) herum. In der folgenden Abbildung habe ich das Konzept einmal dargestellt. In unserem Fall ist der Faktor <code>animal</code> in dem zweiten Faktor <code>site</code> genested. Alle Floharten wurden an allen Messorten gemessen.</p>
<div class="cell" data-fig-width="6" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-mermaid-emmeans-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mermaid-emmeans-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-mermaid-emmeans-01">flowchart LR
    A(animal):::factor --- B(((nested))) --&gt; C(site):::factor
    classDef factor fill:#56B4E9,stroke:#333,stroke-width:0.75px
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mermaid-emmeans-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.11— Abhängigkeitsstruktur des zweifaktoriellen Designs für die Analyse der Sprungweite von Floharten an verschiedenen Messorten mit einem Faktor <code>animal</code> nested im Faktor <code>site</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Damit gilt dann auch, dass jeder Messort alle Floharten enthält und die Floharten damit innerhalb eines Messortes randomsiert wurden. Ich habe dir das nochmal etwas anders dargestellt. Es ist wichtig sich den Zusammenhang klar zu machen, damit du später die Auswertung für deine wissenschaftliche Fragestellung richtig machst. Ich zeige dir hier jetzt <em>einen</em> Weg und du musst dann entscheiden, ob der bei dir auch so passt.</p>
<p><span class="math display">\[
\underbrace{\mbox{Messorte}}_{f_2} \xrightarrow[]{beinhaltet\; alle} \overbrace{\mbox{Floharten}}^{f_1}
\]</span></p>
<p>Wir müssen uns jetzt entscheiden wie wir die beiden Faktoren <span class="math inline">\(f_1\)</span> mit <code>animal</code> und <span class="math inline">\(f_2\)</span> mit <code>site</code> auswerten wollen. Wir können den Faktor <code>animal</code> getrennt (eng. <em>separate</em>) für jedes Level des Faktors <code>site</code> vergleichen oder wir vergleichen alle Faktorkombinationen gemeinsam (eng. <em>combined</em>). Welcher Fakotr das bei dir dann in deiner Auswertung ist, kann ich natürlich nicht sagen. Aber meistens ist es dann klarer wenn du mit der Auswertung beginnst und dir die Ergebnisse versuchst zu interpretieren. Im Folgenden zeige ich dir einmal wie du die separierte und kombinierte Analyse in <code>{emmeans}</code> rechnest.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true"><span class="math inline">\(f_1\)</span> <strong>separiert</strong> <span class="math inline">\(f_2\)</span> mit <span class="math inline">\(\boxed{\sim f_1\, |\, f_2}\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><span class="math inline">\(f_1\)</span> <strong>kombiniert</strong> <span class="math inline">\(f_2\)</span> mit <span class="math inline">\(\boxed{\sim f_1 * f_2}\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Wenn du den ersten Faktor <code>animal</code> separiert also getrennt für den zweiten Faktor <code>site</code> rechnen willst, dann nutzt du den Separator <code>|</code> um die getrennte Analyse zu rechnen. Du siehst, dass die Mittelwerte für die Floharten getrennt für die Messorte berechnet werden. Wiederum entscheide ich mich hier für die Adjustierung für die Varianzheterogenität.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj <span class="ot">&lt;-</span> fac2_aov <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 animal emmean    SE df lower.CL upper.CL
 cat      13.6 0.603 54     12.4     14.8
 dog      16.7 0.693 54     15.3     18.1
 fox      20.1 0.395 54     19.3     20.9

site = village:
 animal emmean    SE df lower.CL upper.CL
 cat      15.2 0.834 54     13.6     16.9
 dog      16.6 0.246 54     16.1     17.1
 fox      17.0 0.489 54     16.0     18.0

Confidence level used: 0.95 </code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Wenn du den ersten Faktor <code>animal</code> mit allen Kombinationen des zweiten Faktors <code>site</code> berechnen willst, dann nutzt du den Kombinator <code>*</code> um die kombinierte Analyse zu rechnen. Du siehst, dass die Mittelwerte für die Floharten für jeden Messort berechnet wird und die Ausgabe am Ende zusammengefasst wird. Wiederum entscheide ich mich hier für die Adjustierung für die Varianzheterogenität.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>emm_fac2_combinded_obj <span class="ot">&lt;-</span> fac2_aov <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">*</span> site, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>emm_fac2_combinded_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal site    emmean    SE df lower.CL upper.CL
 cat    city      13.6 0.603 54     12.4     14.8
 dog    city      16.7 0.693 54     15.3     18.1
 fox    city      20.1 0.395 54     19.3     20.9
 cat    village   15.2 0.834 54     13.6     16.9
 dog    village   16.6 0.246 54     16.1     17.1
 fox    village   17.0 0.489 54     16.0     18.0

Confidence level used: 0.95 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Wir erhalten also unser <code>{emmeans}</code> Objekt für unsere zweifaktorielle Analyse. Darin ist eigentlich alles enthalten was wir jetzt brauchen. Denn nun ist ja die Frage, was willst du haben? Ich zeige dir in den folgenden Tabs einmal wie du die p-Werte, das <em>Comapct letter display</em> und die 95% Konfidenzintervalle für die getrennte Analyse nach den zweiten Faktor berechnest. Deshalb erst überlegen, wie du die beiden Faktoren <span class="math inline">\(f_1\)</span> und <span class="math inline">\(f_2\)</span> auswerten willst. Je nachdem du dich dann entscheidest, kommen natürlich andere Egebnisse heraus.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">p-Werte mit <span class="math inline">\(\boxed{\sim f_1\, |\, f_2}\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false"><em>Compact letter display</em> mit <span class="math inline">\(\boxed{\sim f_1\, |\, f_2}\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">95% Konfidenzintervall mit <span class="math inline">\(\boxed{\sim f_1\, |\, f_2}\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Beginnen wir wieder die p-Werte für unseren Vergleich der Floharten für die mittleren Sprungweiten zu berechnen. Wir nutzen hierzu wieder die Funktion <code>contrast()</code> wie auch schon im einfaktoriellen Fall. Das ist jetzt auch so eine Stärke von <code>{emmeans}</code>, wenn wir das Modell hinkriegen, dann können wir auch mehr Faktoren beliebig ergänzen. Mir gefällt hier nicht die Reihenfolge in den Vergleichen. Statt <code>cat - dog</code> möchte ich lieber den Kontrast <code>dog - cat</code>. Daher wähle ich als Methode <code>revpairwise</code> und drehe damit einmal meine Vergleiche.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac2_separate_obj <span class="ot">&lt;-</span> emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"revpairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac2_separate_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 contrast  estimate    SE df t.ratio p.value
 dog - cat    3.101 0.919 54   3.376  0.0041
 fox - cat    6.538 0.721 54   9.070  &lt;.0001
 fox - dog    3.437 0.798 54   4.310  0.0002

site = village:
 contrast  estimate    SE df t.ratio p.value
 dog - cat    1.316 0.869 54   1.514  0.4076
 fox - cat    1.729 0.967 54   1.789  0.2377
 fox - dog    0.413 0.547 54   0.755  1.0000

P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
<p>Jetzt erhalten wir für den zweiten Faktor <code>site</code> die Vergleiche der Sprungweiten der Hunde- und Katzenflöhe einmal wiedergegeben. Dabei sehen wir, dass sich die mittleren Sprungweiten signifikant in der Stadt unterscheiden, jedoch nicht auf dem Dorf. Die p-Werte in den Vergleichen in der Stadt sind alle unter dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%. Wir können hier also die Nullhypothese ablehnen, dass die Mitelwerte für den jeweiligen Vergleich gleich sind.</p>
<p>Jetzt können wir uns auch die Vergleiche als eine Matrix getrennt für den Faktor <code>site</code> anzeigen lassen. Hier ist es natürlich praktisch, dass wir gleich die Mittelwerte sowie die mittleren Differenzen als auch die p-Werte in einer Ausgabe vorliegen haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac2_separate_obj <span class="sc">|&gt;</span>   </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
site = city
          dog - cat fox - cat fox - dog
dog - cat    [3.10]    0.0002    1.0000
fox - cat    -3.437    [6.54]    0.0041
fox - dog    -0.336     3.101    [3.44]

site = village
          dog - cat fox - cat fox - dog
dog - cat   [1.316]    1.0000    1.0000
fox - cat    -0.413   [1.729]    0.4076
fox - dog     0.903     1.316   [0.413]

Row and column labels: contrast
Upper triangle: P values   adjust = "bonferroni"
Diagonal: [Estimates] (estimate) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
</div>
<p>Im einfaktoriellen Fall fand ich den paarweisen p-Wert Plot nicht so richtig informativ. Wenn du dir aber zwei Faktoren anschaust, dann kann man da schon mehr erkennen. Bilden die p-Werte in dem einen Level des zweiten Faktors ein anderes Muster als in einem anderen Level des Faktors? Hier sehen wir sehr schön, dass wir in der Stadt sehr kleine p-Werte erhalten aber auf dem Land im Dorf sehr große p-Werte. Das zeigt nochmal sehr deutlich, wie sich der erste Faktor <code>animal</code> in den Leveln des zweiten Faktor <code>site</code> unterscheidet.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpp</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-sep-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-sep-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-sep-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Abbildung&nbsp;42.12— Visualisierung der Ergebnisse im Pairwise P-value plot. Auf der y-Achse sind die Gruppen und die entsprechenden Gruppenmittelwerte dargestellt."><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-sep-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-sep-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.12— Visualisierung der Ergebnisse im Pairwise P-value plot. Auf der y-Achse sind die Gruppen und die entsprechenden Gruppenmittelwerte dargestellt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Nachdem wir in dem vorherigen Tab die p-Werte berechnet haben, könen wir jetzt einmal das <em>Compact letter display</em> erstellen. Hier hat das R Paket <code>{emmeans}</code> eine eigene Funktion mit <code>cld()</code>. Die Funktion nimmt das Objekt <code>emm_fac2_separate_obj</code> und berechnet darauf das nach Bonferroni adjustierte <em>Compact letter display</em>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>emm_cld_fac2_separate_obj <span class="ot">&lt;-</span> emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>emm_cld_fac2_separate_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 animal emmean    SE df lower.CL upper.CL .group
 cat      13.6 0.603 54     12.1     15.1  a    
 dog      16.7 0.693 54     15.0     18.4   b   
 fox      20.1 0.395 54     19.1     21.1    c  

site = village:
 animal emmean    SE df lower.CL upper.CL .group
 cat      15.2 0.834 54     13.2     17.3  a    
 dog      16.6 0.246 54     16.0     17.2  a    
 fox      17.0 0.489 54     15.8     18.2  a    

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 3 estimates 
P value adjustment: bonferroni method for 3 tests 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Auch hier ist der große Vorteil von <code>{emmeans}</code>, dass wir die Ausgabe des <em>Compact letter displays</em> direkt nutzen können um unseren Barplot zu zeichnen. Wir müssen nur einmal die Werte der Standardfehler mit der Wurzel der Gruppenfallzahl multiplizieren um auf die Standardabweichung zu kommen. Da wir hier sieben Flöhe je Tierart gemessen haben, multiplizieren wir den Standardfehler mit der Wurzel von 7 um auf die Standardabweichung zu kommen. Dann entferne ich noch die Leerzeichen in der Spalte <code>.group</code> mit der Funktion <code>str_trim()</code> und ich kann den Barplot erstellen. Wichtig ist hier, dass wir uns die beiden Messorte <code>city</code> und <code>village</code> voneinander <em>getrennt</em> betrachten. Daher haben wir im Dorf auch den Buchstaben a wie auch in der Stadt, obwohl es klare Unterschiede gibt. Wenn du alle Barplots kombiniert ein <em>Compact letter displays</em> haben willst, dann schaue in der Analyse weiter unten nach.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>emm_cld_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">7</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> emmean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.9</span>, </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>,</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-sep-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-sep-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-sep-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Abbildung&nbsp;42.13— Barplot oder Säulendigramm der mittleren Sprungweiten in [cm] für drei Floharten und der entsprechenden Messorte separiert. Die Fehlerbalken stellen die Standardabweichung dar. Die Buchstaben das Bonferroni adjustierte Compact letter display."><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-sep-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-sep-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.13— Barplot oder Säulendigramm der mittleren Sprungweiten in [cm] für drei Floharten und der entsprechenden Messorte separiert. Die Fehlerbalken stellen die Standardabweichung dar. Die Buchstaben das Bonferroni adjustierte <em>Compact letter display</em>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Am Ende können wir dann auch aus den paarweisen Vergleichen die 95% Konfidenzintervalle berechnen. Hier nutzen wir dann die Funktion <code>tidy()</code> aus dem Paket <code>{broom}</code> um uns die 95% Konfidenzintervalle sauber wiedergeben zu lassen. Ich habe hier einmal die Kontraste auf <code>revpairwise</code> gestellt um die Vergleiche wie bei den p-Werten zu drehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>emm_ci_fac2_separate_obj <span class="ot">&lt;-</span> emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, site, estimate, conf.low, conf.high) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die Stärke eines 95% Konfidenzintervalls ist ja die Signifikanz mit der Relevanz zu verbinden. Daher setze ich jetzt mal die Relevanzschwelle <code>relevance_lvl</code> auf <span class="math inline">\(&gt;2cm\)</span>. Wenn also Floharten im Mittel sich mindestens um <span class="math inline">\(2cm\)</span> unterscheiden, dann ist der Vergleich relevant. Das habe ich jetzt einfach so entschieden. Wir schauen hier dann auf größer/gleich, was auch mehr Sinn macht. Theoretisch kannst du auch in beide Richtungen die Relevanz definieren, aber in der Anwendung ist es eher selten, dass uns beide Richtungen interessieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>relevance_lvl <span class="ot">&lt;-</span> <span class="dv">2</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung siehst du einmal die 95% Konfidenzintervalle für alle paarweisen Vergleiche. Ich habe am Anfang nochmal eine Regel mit <code>case_when()</code> erstellt, nachder ich dann die 95% Konfidenzintervall nach der Signifikanz und Relevanz einfärbe. Das ist ja die Stärke der 95% Konfidenzintervalle und dann sollte man die auch Nutzen. Wo du die Relevanzschwelle legst, ist dann dir selber überlassen. Das hängt von deiner wissenschaftlichen Fragestellung ab. Beachte, dass ich hier noch die Linienart ändern musste um die Messorte mit einzeichnen zu können. Wir haben am Ende nur einen relevanten und signifikanten Vergleich. Nämlich den Vergleich der Fuchsflöhe zu den Katzenflöhen in der Stadt.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>emm_ci_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig_lgl =</span> <span class="fu">case_when</span>(<span class="fu">between</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">n</span>()), conf.low, conf.high) <span class="sc">~</span> <span class="st">"n.s."</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                             relevance_lvl <span class="sc">&lt;</span> conf.low <span class="sc">~</span> <span class="st">"s. &amp; r."</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> <span class="st">"s."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(contrast, <span class="at">y =</span> estimate, </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> sig_lgl, <span class="at">linetype =</span> site)) <span class="sc">+</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.25</span>)) <span class="sc">+</span> </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> relevance_lvl, <span class="at">linetype =</span> <span class="st">"11"</span>,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Mittelwertsunterschied"</span>, </span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>, <span class="at">linetype =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-sep-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-sep-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-sep-03-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Abbildung&nbsp;42.14— Die 95% Konfidenzintervalle für die allpair-Vergleiche der mittleren Sprungweite in [cm] für die drei Floharten und zwei Messorte. Die Farben stellen die Signifkanz und Relevanz der 95% Konfidenzintervalle dar. Als relevant sind mittlere Differenzen größer als 0.75cm definiert. (n.s) Nicht signifikanter Vergleich, da die 0 im 95% Konfidenzintervall enthalten ist. (s) Signifikanter, nicht relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und links von der Relevanzschwelle liegt. (s. &amp; r.) Signifikanter, relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und rechts von der Relevanzschwelle liegt. [Zum Vergrößern anklicken]"><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-sep-03-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-sep-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.14— Die 95% Konfidenzintervalle für die <em>allpair</em>-Vergleiche der mittleren Sprungweite in [cm] für die drei Floharten und zwei Messorte. Die Farben stellen die Signifkanz und Relevanz der 95% Konfidenzintervalle dar. Als relevant sind mittlere Differenzen größer als <span class="math inline">\(0.75cm\)</span> definiert. <strong>(n.s)</strong> Nicht signifikanter Vergleich, da die 0 im 95% Konfidenzintervall enthalten ist. <strong>(s)</strong> Signifikanter, nicht relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und links von der Relevanzschwelle liegt. <strong>(s. &amp; r.)</strong> Signifikanter, relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und rechts von der Relevanzschwelle liegt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Eben gerade haben wir das <code>{emmeans}</code> Objekt für unsere zweifaktorielle Analyse für die getrennte Analyse über den zweiten Faktor genutzt. Jetzt zeige ich dir in den folgenden Tabs einmal wie du die p-Werte, das <em>Comapct letter display</em> und die 95% Konfidenzintervalle für die kombinierte Analyse über die beiden Faktoren <span class="math inline">\(f_1\)</span> und <span class="math inline">\(f_2\)</span> berechnest. Das heißt, wir wollen jetzt nicht mehr getrennt die Floharten über die Messorte anschauen, sondern die Interaktionen zwischen den Floharten und Messorten analysieren. Daher werden wir jetzt ein paar mehr Vergleiche rechnen als eben gerade im obigen Fall der getrennten Analyse.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">p-Werte mit <span class="math inline">\(\boxed{\sim f_1 * f_2}\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false"><em>Compact letter display</em> mit <span class="math inline">\(\boxed{\sim f_1 * f_2}\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">95% Konfidenzintervall mit <span class="math inline">\(\boxed{\sim f_1 * f_2}\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Beginnen wir wieder die p-Werte für unseren Vergleich der Floharten für die mittleren Sprungweiten zu berechnen. Wir nutzen hierzu wieder die Funktion <code>contrast()</code> wie auch schon im einfaktoriellen Fall. Das ist jetzt auch so eine Stärke von <code>{emmeans}</code>, wenn wir das Modell hinkriegen, dann können wir auch mehr Faktoren beliebig ergänzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac2_combined_obj <span class="ot">&lt;-</span> emm_fac2_combinded_obj <span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac2_combined_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                  estimate    SE df t.ratio p.value
 cat city - dog city         -3.101 0.919 54  -3.376  0.0206
 cat city - fox city         -6.538 0.721 54  -9.070  &lt;.0001
 cat city - cat village      -1.668 1.008 54  -1.655  1.0000
 cat city - dog village      -2.984 0.651 54  -4.581  0.0004
 cat city - fox village      -3.397 0.776 54  -4.375  0.0008
 dog city - fox city         -3.437 0.798 54  -4.310  0.0010
 dog city - cat village       1.433 1.098 54   1.305  1.0000
 dog city - dog village       0.117 0.743 54   0.157  1.0000
 dog city - fox village      -0.296 0.848 54  -0.349  1.0000
 fox city - cat village       4.870 0.922 54   5.279  &lt;.0001
 fox city - dog village       3.554 0.465 54   7.639  &lt;.0001
 fox city - fox village       3.141 0.633 54   4.964  0.0001
 cat village - dog village   -1.316 0.869 54  -1.514  1.0000
 cat village - fox village   -1.729 0.967 54  -1.789  1.0000
 dog village - fox village   -0.413 0.547 54  -0.755  1.0000

P value adjustment: bonferroni method for 15 tests </code></pre>
</div>
</div>
<p>Das sind eine Menge an Vergleichen. Daher ist es jetzt erstmal die Frage was hier eigentlich wie signifkant ist. Wiederum sieht man dann doch hier, das das <em>Compact letter display</em> gar nicht so schlecht ist um eine Übersicht zu kriegen. Hier ist es dann doch sehr unübersichtlich, welcher Vergleich nun wie signifikant ist. Vorallem lässt sich schwer ein übergeordnetes Muster erkennen.</p>
<p>Jetzt können wir uns auch die Vergleiche als eine Matrix anzeigen lassen. Hier ist es natürlich praktisch, dass wir gleich die Mittelwerte sowie die mittleren Differenzen als auch die p-Werte in einer Ausgabe vorliegen haben. Darüber hinaus sortiert die Matrix auch die vergleiche einmal sinnvoll und wir können viel besser sehen, welche Vergleiche signifikant sind. So lässt sich auch einfacher die Frage beantworten, ob wir Floharten oder Orte haben, wo alles signifikant ist oder die Signifikanz eher zufällig über die Vergleiche verteilt ist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>emm_fac2_combinded_obj <span class="sc">|&gt;</span>   </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            cat city dog city fox city cat village dog village fox village
cat city      [13.6]   0.0206   &lt;.0001      1.0000      0.0004      0.0008
dog city      -3.101   [16.7]   0.0010      1.0000      1.0000      1.0000
fox city      -6.538   -3.437   [20.1]      &lt;.0001      &lt;.0001      0.0001
cat village   -1.668    1.433    4.870      [15.2]      1.0000      1.0000
dog village   -2.984    0.117    3.554      -1.316      [16.6]      1.0000
fox village   -3.397   -0.296    3.141      -1.729      -0.413      [17.0]

Row and column labels: animal:site
Upper triangle: P values   adjust = "bonferroni"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
</div>
<p>Den paarweisen p-Wert Plot finde ich dann mit so vielen vergleichen dann schon wieder nicht so informativ. Wir haben eben sehr viele signifikante Unterschiede. Dann liegen auchs ehr viele Linien an der linken Seite und es ist schwer zu lesen, was wir hier vorliegen haben. Eventuell müsste man nochmal <code>animal * site</code> in dem <code>emmeans()</code> Aufruf auf <code>site * animal</code> drehen und schauen, ob dann die Ordnung der Vergleiche auf der y-Achse etwas besser ist. Aber das ändert auch nichts and er Anzahl an Vergleichen. Jede Abbildung hat dann so seine Grenzen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>emm_fac2_combinded_obj <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpp</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-com-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-com-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-com-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Abbildung&nbsp;42.15— Visualisierung der Ergebnisse im Pairwise P-value plot. Auf der y-Achse sind die Gruppen und die entsprechenden Gruppenmittelwerte dargestellt."><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-com-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-com-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.15— Visualisierung der Ergebnisse im Pairwise P-value plot. Auf der y-Achse sind die Gruppen und die entsprechenden Gruppenmittelwerte dargestellt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Nachdem wir in dem vorherigen Tab die p-Werte berechnet haben, könen wir jetzt einmal das <em>Compact letter display</em> erstellen. Hier hat das R Paket <code>{emmeans}</code> eine eigene Funktion mit <code>cld()</code>. Die Funktion nimmt das Objekt <code>emm_fac2_combindedobj</code> und berechnet darauf das nach Bonferroni adjustierte <em>Compact letter display</em>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>emm_cld_fac2_combined_obj <span class="ot">&lt;-</span> emm_fac2_combinded_obj <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>emm_cld_fac2_combined_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal site    emmean    SE df lower.CL upper.CL .group
 cat    city      13.6 0.603 54     11.9     15.2  a    
 cat    village   15.2 0.834 54     13.0     17.5  ab   
 dog    village   16.6 0.246 54     15.9     17.2   b   
 dog    city      16.7 0.693 54     14.8     18.6   b   
 fox    village   17.0 0.489 54     15.6     18.3   b   
 fox    city      20.1 0.395 54     19.0     21.2    c  

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 6 estimates 
P value adjustment: bonferroni method for 15 tests 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Der große Vorteil von <code>{emmeans}</code> ist, dass wir die Ausgabe des <em>Compact letter displays</em> direkt nutzen können um unseren Barplot zu zeichnen. Wir müssen nur einmal die Werte der Standardfehler mit der Wurzel der Gruppenfallzahl multiplizieren um auf die Standardabweichung zu kommen. Da wir hier sieben Flöhe je Tierart gemessen haben, multiplizieren wir den Standardfehler mit der Wurzel von 7 um auf die Standardabweichung zu kommen. Dann entferne ich noch die Leerzeichen in der Spalte <code>.group</code> mit der Funktion <code>str_trim()</code> und ich kann den Barplot erstellen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>emm_cld_fac2_combined_obj <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">7</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> emmean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.9</span>, </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>,</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-com-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-com-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-com-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Abbildung&nbsp;42.16— Barplot oder Säulendigramm der mittleren Sprungweiten in [cm] für drei Floharten und der entsprechenden Messorte kombiniert. Die Fehlerbalken stellen die Standardabweichung dar. Die Buchstaben das Bonferroni adjustierte Compact letter display."><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-com-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-com-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.16— Barplot oder Säulendigramm der mittleren Sprungweiten in [cm] für drei Floharten und der entsprechenden Messorte kombiniert. Die Fehlerbalken stellen die Standardabweichung dar. Die Buchstaben das Bonferroni adjustierte <em>Compact letter display</em>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>Am Ende können wir dann auch aus den paarweisen Vergleichen die 95% Konfidenzintervalle berechnen. Hier nutzen wir dann die Funktion <code>tidy()</code> aus dem Paket <code>{broom}</code> um uns die 95% Konfidenzintervalle sauber wiedergeben zu lassen. Ich habe hier einmal die Kontraste auf <code>revpairwise</code> gestellt um die Vergleiche wie bei den p-Werten zu drehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>emm_ci_fac2_combined_obj <span class="ot">&lt;-</span> emm_fac2_combinded_obj <span class="sc">|&gt;</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, conf.low, conf.high) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die Stärke eines 95% Konfidenzintervalls ist ja die Signifikanz mit der Relevanz zu verbinden. Weil wir jetzt hier so viele paarweise Vergleiche haben, macht es dann doch Sinn die Relevanzschwelle in beide Richtungen zu definieren. Daher setze ich jetzt mal die Relevanzschwelle <code>relevance_lvl</code> auf <span class="math inline">\(&lt;2cm\)</span> und <span class="math inline">\(&gt;2cm\)</span>. Wenn also Floharten im Mittel sich mindestens um <span class="math inline">\(\pm 2cm\)</span> unterscheiden, dann ist der Vergleich relevant. Das habe ich jetzt einfach so entschieden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>relevance_lvl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung siehst du einmal die 95% Konfidenzintervalle für alle paarweisen Vergleiche. Ich habe am Anfang nochmal eine Regel mit <code>case_when()</code> erstellt, nachder ich dann die 95% Konfidenzintervall nach der Signifikanz und Relevanz einfärbe. Hier ist es dann etwas komplexer, weil ich eben beide Richtungen berücksichtigen will. Wo du die Relevanzschwelle legst, ist dann dir selber überlassen. Das hängt von deiner wissenschaftlichen Fragestellung ab. Wir haben dann drei signifikante und relevante Vergleiche am Ende. In allen drei Fällen ist jeweils der Fuchs in der Stadt enthalten. Wobei in zwei Vergleichen der Unterschied zum Dorf signifikant sowie relevant ist und in einem Vergleich zum Stadtkatzenfloh. Spannendes Ergebnis in diesem Fall.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>emm_ci_fac2_combined_obj <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig_lgl =</span> <span class="fu">case_when</span>(<span class="fu">between</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">n</span>()), conf.low, conf.high) <span class="sc">~</span> <span class="st">"n.s."</span>,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                             relevance_lvl[<span class="dv">2</span>] <span class="sc">&lt;</span> conf.low <span class="sc">|</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>                             relevance_lvl[<span class="dv">1</span>] <span class="sc">&gt;</span> conf.high <span class="sc">~</span> <span class="st">"s. &amp; r."</span>,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> <span class="st">"s."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(contrast, <span class="at">y =</span> estimate, </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">color =</span> sig_lgl)) <span class="sc">+</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(relevance_lvl), <span class="at">linetype =</span> <span class="st">"11"</span>,</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Mittelwertsunterschied"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-com-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-com-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-com-03-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Abbildung&nbsp;42.17— Die 95% Konfidenzintervalle für die allpair-Vergleiche der mittleren Sprungweite in [cm] für die drei Floharten und zwei Messorte. Die Farben stellen die Signifkanz und Relevanz der 95% Konfidenzintervalle dar. Als relevant sind mittlere Differenzen größer als 0.75cm definiert. (n.s) Nicht signifikanter Vergleich, da die 0 im 95% Konfidenzintervall enthalten ist. (s) Signifikanter, nicht relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und links von der Relevanzschwelle liegt. (s. &amp; r.) Signifikanter, relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und rechts von der Relevanzschwelle liegt. [Zum Vergrößern anklicken]"><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-com-03-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-com-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.17— Die 95% Konfidenzintervalle für die <em>allpair</em>-Vergleiche der mittleren Sprungweite in [cm] für die drei Floharten und zwei Messorte. Die Farben stellen die Signifkanz und Relevanz der 95% Konfidenzintervalle dar. Als relevant sind mittlere Differenzen größer als <span class="math inline">\(0.75cm\)</span> definiert. <strong>(n.s)</strong> Nicht signifikanter Vergleich, da die 0 im 95% Konfidenzintervall enthalten ist. <strong>(s)</strong> Signifikanter, nicht relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und links von der Relevanzschwelle liegt. <strong>(s. &amp; r.)</strong> Signifikanter, relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und rechts von der Relevanzschwelle liegt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="weitere-möglichen-analysen" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="weitere-möglichen-analysen">Weitere möglichen Analysen</h4>
<p>Ich möchte hier nur kurz noch auf weitere mögliche Analysen mit <code>{emmeans}</code> eingehen. Zum einen gibt es die Hilfeseite von <code>{emmeans}</code> zur <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html">Interaction analysis in emmeans</a>. Dort findet sich auch die Funktion <code>joint_test()</code>, die dir nochmal erlaubt auf einem Modell die Interaktionen in der richtigen Reihenfolge zu testen. Mehr dazu im <a href="stat-tests-anova2.html">Kapitel zur ANOVA</a>.</p>
<blockquote class="blockquote">
<p><em>“[…] tests the interaction contrasts for all effects in the model and compiles them in one Type-III-ANOVA-like table”</em></p>
</blockquote>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>fac2_aov <span class="sc">|&gt;</span> <span class="fu">joint_tests</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> model term  df1 df2 F.ratio p.value
 animal        2  54  25.745  &lt;.0001
 site          1  54   1.268  0.2652
 animal:site   2  54   8.891  0.0005</code></pre>
</div>
</div>
<p>Ebenso gibt es noch die Möglichkeit dir die Effektstärken mit <code>effsize()</code> zu berechnen. Hier nutzen wir die Informationen aus dem Objekt <code>fac1_aov</code> um mit der Varianz und der Freiheitsgerade Cohen`s d zu berechnen. Mehr dazu dann auch im <a href="stat-tests-effect.html">Kapitel zu dem Effektschätzer</a>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eff_size</span>(emm_fac1_obj, <span class="at">sigma =</span> <span class="fu">sigma</span>(fac1_aov), <span class="at">edf =</span> fac1_aov<span class="sc">$</span>df.residual)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast  effect.size    SE df lower.CL upper.CL
 dog - cat        1.91 0.601 18    0.647    3.174
 dog - fox       -0.58 0.371 18   -1.360    0.199
 cat - fox       -2.49 0.699 18   -3.960   -1.022

sigma used for effect sizes: 1.772 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Mehz zu den weiteren Vergleichen von <code>{emmeans}</code> dann auch unter <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html">Comparisons and contrasts in emmeans</a>. Das ist hier eher so der offene Abschnitt. Vielleicht kommt noch was dazu.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Was schreibe ich in Material und Methoden?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Hier nochmal ein kurzer Textvorschlag für deinen Material und Methodenteil, wenn du deine Abschlussarbeit schreibst. Ich halte den Text bewusst knapp, dann kannst du den Text noch ausschmücken. Gerne kannst du den Teil noch ausführlicher schreiben.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Tukey HSD Test in <code>{emmeans}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Games Howell Test in <code>{emmeans}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p><em>Die Analyse wurde in RStudio (Version 2024.12.0.467) und R (Version 4.2.3) durchgeführt. Die Gruppenvergleiche wurden mit einem Tukey HSD Test in dem R Paket emmeans (Version 1.10.0) berechnet und entsprechend für multiple Vergleiche adjustiert.</em></p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p><em>Die Analyse wurde in RStudio (Version 2024.12.0.467) und R (Version 4.2.3) durchgeführt. Die Gruppenvergleiche wurden mit einem Games Howell Test unter Berücksichtigung der Varianzheterogenität in den Versuchsgruppen in dem R Paket emmeans (Version 1.10.0) berechnet und entsprechend für multiple Vergleiche adjustiert.</em></p>
</div>
</div>
</div>
<p>Du findest die Informationen zu den genutzen Paketen wie <code>{emmeans}</code> und deiner R Version mit den folgenden Funktionen. Damit hast du dann alles zusammen um im Methodenteil einmal zu schreiben was du gemacht hast.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">packageVersion</span>(<span class="st">"emmeans"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>version<span class="sc">$</span>version.string</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">RStudio.Version</span>()<span class="sc">$</span>version</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</section>
</section>
<section id="fallbeispiele-mit-emmeans" class="level2" data-number="42.6">
<h2 data-number="42.6" class="anchored" data-anchor-id="fallbeispiele-mit-emmeans"><span class="header-section-number">42.6</span> Fallbeispiele mit <code>{emmeans}</code></h2>
<p>In den folgenden Zerforschenkästen findest du dann noch einige Fallbeispiele zu <code>{emmeans}</code>. Ich bin über den Campus Haste der Hochschule Osnabrück gelaufen und habe mal ein paar Fotos von Posterabbildungen gemacht. Dann habe ich die Abbildungen zerforscht und mit ausgedachten Daten versehen. Vielleicht findest du hier nochmal eine Inspiration für deine eingenen Auswertungen.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Einfaktorielle Analyse mit <code>{emmeans}</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen einfaktoriellen Barplot oder Säulendiagramm anschauen. Daher fangen wir mit der folgenden Abbildung einmal an. Wir haben hier ein Säulendiagramm mit <em>compact letter display</em> vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der vier Behandlungen jeweils einmal einen Mittelwert für die Höhe der Säule sowie einmal die Standardabweichung. Die Standardabweichung addieren und subtrahieren wir dann jeweils von dem Mittelwert und schon haben wir die Fehlerbalken. Für eine detaillierte Betrachtung der Erstellung der Abbildung schauen einmal in das Kapitel zum <a href="eda-ggplot.html#sec-eda-barplot">Barplot oder Balkendiagramm oder Säulendiagramm</a>.</p>
<div id="fig-ur-barplot" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_simple.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Abbildung&nbsp;42.18— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein simples Säulendiagramm mit sehr für Farbblinde ungünstigen Farben. Es sind die Mittelwerte sowie die Standardabweichung durch die Fehlerbalken dargestellt."><img src="images/eda/zerforschen_barplot_simple.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.18— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein simples Säulendiagramm mit sehr für Farbblinde ungünstigen Farben. Es sind die Mittelwerte sowie die Standardabweichung durch die Fehlerbalken dargestellt.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_simple.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die vier Werte alle um den Mittelwert streuen lassen. Dabei habe ich darauf geachtet, dass die Streuung dann in der letzten Behandlung am größten ist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_simple.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">factor</span>(trt, </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"water"</span>, <span class="st">"rqflex"</span>, <span class="st">"nitra"</span>, <span class="st">"laqua"</span>),</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wasserdestilation"</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"RQflex Nitra"</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Nitrachek"</span>,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Laqua Nitrat"</span>)))</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>barplot_tbl </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 2
   trt               nitrat
   &lt;fct&gt;              &lt;dbl&gt;
 1 Wasserdestilation    135
 2 Wasserdestilation    130
 3 Wasserdestilation    145
 4 Wasserdestilation    135
 5 RQflex Nitra         120
 6 RQflex Nitra         130
 7 RQflex Nitra         135
 8 RQflex Nitra         135
 9 Nitrachek            100
10 Nitrachek            120
11 Nitrachek            130
12 Nitrachek            130
13 Laqua Nitrat         230
14 Laqua Nitrat         210
15 Laqua Nitrat         205
16 Laqua Nitrat         220</code></pre>
</div>
</div>
<p>Im Folgenden sparen wir uns den Aufruf mit <code>group_by()</code> den du aus dem <a href="eda-ggplot.html#sec-eda-barplot">Kapitel zum Barplot</a> schon kennst. Wir machen das alles zusammen in der Funktion <code>emmeans()</code> aus dem gleichnamigen R Paket. Der Vorteil ist, dass wir dann auch gleich die Gruppenvergleiche und auch das <em>compact letter display</em> erhalten. Einzig die Standardabweichung <span class="math inline">\(s\)</span> wird uns nicht wiedergegeben sondern der Standardfehler <span class="math inline">\(SE\)</span>. Da aber folgernder Zusammenhang vorliegt, können wir gleich den Standardfehler in die Standardabweichung umrechnen.</p>
<p><span class="math display">\[
SE = \cfrac{s}{\sqrt{n}}
\]</span></p>
<p>Wir rechnen also gleich einfach den Standardfehler <span class="math inline">\(SE\)</span> mal der <span class="math inline">\(\sqrt{n}\)</span> um dann die Standardabweichung zu erhalten. In unserem Fall ist <span class="math inline">\(n=4\)</span> nämlich die Anzahl Beobachtungen je Gruppe. Wenn du mal etwas unterschiedliche Anzahlen hast, dann kannst du auch einfach den Mittelwert der Fallzahl der Gruppen nehmen. Da überfahren wir zwar einen statistischen Engel, aber der Genauigkeit ist genüge getan.</p>
<p>In den beiden Tabs siehst du jetzt einmal die Modellierung unter der Annahme der Varianzhomogenität mit der Funktion <code>lm()</code> und einmal die Modellierung unter der Annahme der Varianzheterogenität mit der Funktion <code>gls()</code> aus dem R Paket <code>nlme</code>. Wie immer lässt sich an Boxplots visuell überprüfen, ob wir Homogenität oder Heterogenität vorliegen haben. Oder aber du schaust nochmal in das Kapitel <a href="stat-tests-pretest.html">Der Pre-Test oder Vortest</a>, wo du mehr erfährst.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-barplot-1fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Varianzhomogenität</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Varianzheterogenität (<code>gls</code>)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Varianzheterogenität (<code>vcovHAC</code>)</a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-barplot-1fac">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>emmeans_homogen_tbl <span class="ot">&lt;-</span> <span class="fu">lm</span>(nitrat <span class="sc">~</span> trt, <span class="at">data =</span> barplot_tbl) <span class="sc">|&gt;</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">4</span>)) </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>emmeans_homogen_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 8
  trt               emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Nitrachek           120   5.08    12     109.     131. a       10.2
2 RQflex Nitra        130   5.08    12     119.     141. ab      10.2
3 Wasserdestilation   136.  5.08    12     125.     147. b       10.2
4 Laqua Nitrat        216.  5.08    12     205.     227. c       10.2</code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_homogen_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. Wie dir vielleicht auffällt sind alle Standardfehler und damit alle Standardabweichungen für alle Gruppen gleich, das war ja auch unsere Annahme mit der Varianzhomogenität.</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a> und natürlich in den Abschnitt zu dem <a href="#sec-posthoc-var-heterogen">Gruppenvergleich unter Varianzheterogenität</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_gls_tbl <span class="ot">&lt;-</span> <span class="fu">gls</span>(nitrat <span class="sc">~</span> trt, <span class="at">data =</span> barplot_tbl, </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> trt)) <span class="sc">|&gt;</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">4</span>)) </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_gls_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 8
  trt               emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Nitrachek           120   7.07  3.00     97.5     143. a      14.1 
2 RQflex Nitra        130   3.54  3.00    119.      141. a       7.07
3 Wasserdestilation   136.  3.15  3.00    126.      146. a       6.29
4 Laqua Nitrat        216.  5.54  3.00    199.      234. b      11.1 </code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_hetrogen_gls_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. In diesem Fall hier sind die Standardfehler und damit auch die Standardabweichungen nicht alle gleich, wir haben ja für jede Gruppe eine eigene Standardabweichung angenommen. Die Varianzen sollten ja auch heterogen sein.</p>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a> und natürlich in den Abschnitt zu dem <a href="#sec-posthoc-var-heterogen">Gruppenvergleich unter Varianzheterogenität</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_vcov_tbl <span class="ot">&lt;-</span> <span class="fu">lm</span>(nitrat <span class="sc">~</span> trt, <span class="at">data =</span> barplot_tbl) <span class="sc">|&gt;</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) <span class="sc">|&gt;</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">4</span>)) </span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_vcov_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 8
  trt               emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Nitrachek           120   7.84    12     103.     137. a      15.7 
2 RQflex Nitra        130   3.92    12     121.     139. a       7.84
3 Wasserdestilation   136.  2.06    12     132.     141. a       4.12
4 Laqua Nitrat        216.  4.94    12     205.     227. b       9.88</code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_hetrogen_vcov_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. In diesem Fall hier sind die Standardfehler und damit auch die Standardabweichungen nicht alle gleich, wir haben ja für jede Gruppe eine eigene Standardabweichung angenommen. Die Varianzen sollten ja auch heterogen sein.</p>
</div>
</div>
</div>
<p>Und dann haben wir auch schon die Abbildungen hier erstellt. Ja vielleicht passen die Standardabweichungen nicht so richtig, da könnte man nochmal an den Daten spielen und die Werte solange ändern, bis es besser passt. Du hast aber jetzt eine Idee, wie der Aufbau funktioniert. Die beiden Tabs zeigen dir dann die Abbildungen für die beiden Annahmen der Varianzhomogenität oder Varianzheterogenität. Der Code ist der gleiche für die drei Abbildungen, die Daten <code>emmeans_homogen_tbl</code> oder <code>emmeans_hetrogen_gls_tbl</code> ober <code>emmeans_hetrogen_vcov_tbl</code> sind das Ausschlaggebende.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-barplot-1fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Varianzhomogenität</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Varianzheterogenität (<code>gls</code>)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Varianzheterogenität (<code>vcovHAC</code>)</a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-barplot-1fac">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_homogen_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> emmean, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">250</span>) <span class="sc">+</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span> </span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">10</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-simple-emmeans-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-simple-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Abbildung&nbsp;42.19— Die Abbildung des Säulendiagramms in ggplot nachgebaut mit den Informationen aus der Funktion emmeans(). Das compact letter display wird dann über das geom_text() gesetzt."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-simple-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.19— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_hetrogen_gls_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> emmean, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">250</span>) <span class="sc">+</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span> </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">10</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-simple-emmeans-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-simple-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Abbildung&nbsp;42.20— Die Abbildung des Säulendiagramms in ggplot nachgebaut mit den Informationen aus der Funktion emmeans(). Das compact letter display wird dann über das geom_text() gesetzt. Die Varianzheterogenität nach der Funktion gls() im obigen Modell berücksichtigt."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-simple-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.20— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt. Die Varianzheterogenität nach der Funktion <code>gls()</code> im obigen Modell berücksichtigt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_hetrogen_vcov_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> emmean, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">250</span>) <span class="sc">+</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span> </span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">10</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-simple-emmeans-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-simple-emmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Abbildung&nbsp;42.21— Die Abbildung des Säulendiagramms in ggplot nachgebaut mit den Informationen aus der Funktion emmeans(). Das compact letter display wird dann über das geom_text() gesetzt. Die Varianzheterogenität nach der Funktion sandwich::vcovHAC im obigen Modell berücksichtigt."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-simple-emmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.21— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt. Die Varianzheterogenität nach der Funktion <code>sandwich::vcovHAC</code> im obigen Modell berücksichtigt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_barplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Zweifaktorielle Analyse mit <code>{emmeans}</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen zweifaktoriellen Barplot anschauen. Wir haben hier ein Säulendiagramm mit <em>compact letter display</em> vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der vier Zeitpunkte und der Kontrolle jeweils einmal einen Mittelwert für die Höhe der Säule sowie einmal die Standardabweichung. Da wir hier aber noch mit <code>emmeans()</code> eine Gruppenvergleich rechnen wollen, brauchen wir mehr Beobachtungen. Wir erschaffen uns also fünf Beobachtungen je Zeit/Jod-Kombination. Für eine detaillierte Betrachtung der Erstellung der Abbildung schauen einmal in das Kapitel zum <a href="eda-ggplot.html#sec-eda-barplot">Barplot oder Balkendiagramm oder Säulendiagramm</a>.</p>
<div id="fig-ur-barplot-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_2fac.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Abbildung&nbsp;42.22— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit den zwei Faktoren Zeit und die Iodine Form."><img src="images/eda/zerforschen_barplot_2fac.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.22— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit den zwei Faktoren Zeit und die Iodine Form.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_2fac_target_emmeans.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die fünf Werte alle um den Mittelwert streuen lassen. Ich brauche hier eigentlich mehr als fünf Werte, sonst kriegen wir bei <code>emmeans()</code> und der Interaktion im <code>gls()</code>-Modell Probleme, aber da gibt es dann bei kleinen Fallzahlen noch ein Workaround. Bitte nicht mit weniger als fünf Beobachtungen versuchen, dann wird es schwierig mit der Konsistenz der Schätzer aus dem Modell.</p>
<p>Ach, und ganz wichtig. Wir entfernen die Kontrolle, da wir die Kontrolle nur mit einer Iodid-Stufe gemessen haben. Dann können wir weder die Interaktion rechnen, noch anständig eine Interpretation durchführen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_2fac_target_emmeans.xlsx"</span>)  <span class="sc">|&gt;</span>  </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ctrl"</span>, <span class="st">"7"</span>, <span class="st">"11"</span>, <span class="st">"15"</span>, <span class="st">"19"</span>),</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Contr."</span>, <span class="st">"07:00"</span>, <span class="st">"11:00"</span>, <span class="st">"15:00"</span>, <span class="st">"19:00"</span>)),</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as_factor</span>(type)) <span class="sc">|&gt;</span> </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">!=</span> <span class="st">"Contr."</span>)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>barplot_tbl </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 3
   time  type  iodine
   &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
 1 07:00 KIO3      50
 2 07:00 KIO3      55
 3 07:00 KIO3      60
 4 07:00 KIO3      52
 5 07:00 KIO3      62
 6 07:00 KI        97
 7 07:00 KI        90
 8 07:00 KI        83
 9 07:00 KI        81
10 07:00 KI        98
# ℹ 30 more rows</code></pre>
</div>
</div>
<p>Im Folgenden sparen wir uns den Aufruf mit <code>group_by()</code> den du aus dem <a href="eda-ggplot.html#sec-eda-barplot">Kapitel zum Barplot</a> schon kennst. Wir machen das alles zusammen in der Funktion <code>emmeans()</code> aus dem gleichnamigen R Paket. Der Vorteil ist, dass wir dann auch gleich die Gruppenvergleiche und auch das <em>compact letter display</em> erhalten. Einzig die Standardabweichung <span class="math inline">\(s\)</span> wird uns nicht wiedergegeben sondern der Standardfehler <span class="math inline">\(SE\)</span>. Da aber folgernder Zusammenhang vorliegt, können wir gleich den Standardfehler in die Standardabweichung umrechnen.</p>
<p><span class="math display">\[
SE = \cfrac{s}{\sqrt{n}}
\]</span></p>
<p>Wir rechnen also gleich einfach den Standardfehler <span class="math inline">\(SE\)</span> mal der <span class="math inline">\(\sqrt{n}\)</span> um dann die Standardabweichung zu erhalten. In unserem Fall ist <span class="math inline">\(n=5\)</span> nämlich die Anzahl Beobachtungen je Gruppe. Wenn du mal etwas unterschiedliche Anzahlen hast, dann kannst du auch einfach den Mittelwert der Fallzahl der Gruppen nehmen. Da überfahren wir zwar einen statistischen Engel, aber der Genauigkeit ist genüge getan.</p>
<p>In den beiden Tabs siehst du jetzt einmal die Modellierung unter der Annahme der Varianzhomogenität mit der Funktion <code>lm()</code> und einmal die Modellierung unter der Annahme der Varianzheterogenität mit der Funktion <code>gls()</code> aus dem R Paket <code>nlme</code>. Wie immer lässt sich an Boxplots visuell überprüfen, ob wir Homogenität oder Heterogenität vorliegen haben. Oder aber du schaust nochmal in das Kapitel <a href="stat-tests-pretest.html">Der Pre-Test oder Vortest</a>, wo du mehr erfährst.</p>
<p>Wenn du <em>jeden</em> Boxplot miteinander vergleichen willst, dann musst du in dem Code <code>emmeans(~ time * type)</code> setzen. Dann berechnet dir <code>emmeans</code> für jede Faktorkombination einen paarweisen Vergleich.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-barplot-2fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Varianzhomogenität</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Varianzheterogenität</a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-barplot-2fac">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen. Wenn du alles mit allem Vergleichen willst, dann setze bitte <code>emmeans(~ time * type)</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>emmeans_homogen_tbl <span class="ot">&lt;-</span> <span class="fu">lm</span>(iodine <span class="sc">~</span> time <span class="sc">+</span> type <span class="sc">+</span> time<span class="sc">:</span>type, <span class="at">data =</span> barplot_tbl) <span class="sc">|&gt;</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> time <span class="sc">|</span> type) <span class="sc">|&gt;</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)) </span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>emmeans_homogen_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 9
  time  type  emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 07:00 KIO3    55.8  5.58    32     44.4     67.2 a       12.5
2 11:00 KIO3    75.2  5.58    32     63.8     86.6 b       12.5
3 15:00 KIO3    81    5.58    32     69.6     92.4 b       12.5
4 19:00 KIO3    84.2  5.58    32     72.8     95.6 b       12.5
5 07:00 KI      89.8  5.58    32     78.4    101.  a       12.5
6 19:00 KI      90    5.58    32     78.6    101.  a       12.5
7 15:00 KI     124    5.58    32    113.     135.  b       12.5
8 11:00 KI     152    5.58    32    141.     163.  c       12.5</code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_homogen_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. Wie dir vielleicht auffällt sind alle Standardfehler und damit alle Standardabweichungen für alle Gruppen gleich, das war ja auch unsere Annahme mit der Varianzhomogenität.</p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>. Da wir hier etwas Probleme mit der Fallzahl haben, nutzen wir die Option <code>mode = "appx-satterthwaite"</code> um dennoch ein vollwertiges, angepasstes Modell zu erhalten. Du kannst die Option auch erstmal entfernen und schauen, ob es mit deinen Daten auch so klappt. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen. Wenn du alles mit allem Vergleichen willst, dann setze bitte <code>emmeans(~ time * type)</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_tbl <span class="ot">&lt;-</span> <span class="fu">gls</span>(iodine <span class="sc">~</span> time <span class="sc">+</span> type <span class="sc">+</span> time<span class="sc">:</span>type, <span class="at">data =</span> barplot_tbl, </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> time<span class="sc">*</span>type)) <span class="sc">|&gt;</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> time <span class="sc">|</span> type, <span class="at">mode =</span> <span class="st">"appx-satterthwaite"</span>) <span class="sc">|&gt;</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)) </span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 9
  time  type  emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 07:00 KIO3    55.8  2.29  4.06     49.5     62.1 a       5.12
2 11:00 KIO3    75.2  1.50  4.06     71.1     79.3 b       3.35
3 15:00 KIO3    81.0  3.30  3.96     71.8     90.2 b       7.38
4 19:00 KIO3    84.2  7.88  4.02     62.4    106.  b      17.6 
5 07:00 KI      89.8  3.48  3.99     80.1     99.5 a       7.79
6 19:00 KI      90.0  4.31  3.99     78.0    102.  a       9.64
7 15:00 KI     124    7.48  4.00    103.     145.  b      16.7 
8 11:00 KI     152    9.03  4.00    127.     177.  c      20.2 </code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_hetrogen_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. In diesem Fall hier sind die Standardfehler und damit auch die Standardabweichungen nicht alle gleich, wir haben ja für jede Gruppe eine eigene Standardabweichung angenommen. Die Varianzen sollten ja auch heterogen sein.</p>
</div>
</div>
</div>
<p>Dann bauen wir usn auch schon die Abbildung. Wir müssen am Anfang einmal <code>scale_x_discrete()</code> setzen, damit wir gleich den Zielbereich ganz hinten zeichnen können. Sonst ist der blaue Bereich im Vordergrund. Dann färben wir auch mal die Balken anders ein. Muss ja auch mal sein. Auch nutzen wir die Funktion <code>geom_text()</code> um das <em>compact letter display</em> gut zu setzten. Die <span class="math inline">\(y\)</span>-Position berechnet sich aus dem Mittelwert <code>emmean</code> plus Standardabweichung <code>sd</code> innerhalb des <code>geom_text()</code>. Da wir hier die Kontrollgruppe entfernen mussten, habe ich dann nochmal den Zielbereich verschoben und mit einem Pfeil ergänzt. Die beiden Tabs zeigen dir dann die Abbildungen für die beiden Annahmen der Varianzhomogenität oder Varianzheterogenität. Der Code ist der gleiche für beide Abbildungen, die Daten <code>emmeans_homogen_tbl</code> oder <code>emmeans_hetrogen_tbl</code> sind das Ausschlaggebende. Wie du sehen wirst, haben wir hier mal keinen Unterschied vorliegen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-barplot-2fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Varianzhomogenität</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Varianzheterogenität</a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-barplot-2fac">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_homogen_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> emmean, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">4.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>, </span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.25</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">xend =</span> <span class="fl">1.7</span>, <span class="at">yend =</span> <span class="dv">105</span>),   </span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"#555555"</span>,   </span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>,   </span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.2</span>,  </span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd),</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">2</span>),  </span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Abbildung&nbsp;42.23— Die Abbildung des Säulendiagramms in ggplot nachgebaut. Wir nutzen das geom_text() um noch besser unser compact letter display zu setzen. Die Kontrolle wurde entfernt, sonst hätten wir hier nicht emmeans in der einfachen Form nutzen können. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.23— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen. Die Kontrolle wurde entfernt, sonst hätten wir hier nicht <code>emmeans</code> in der einfachen Form nutzen können. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_hetrogen_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> emmean, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">4.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>, </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.25</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">xend =</span> <span class="fl">1.7</span>, <span class="at">yend =</span> <span class="dv">105</span>),   </span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"#555555"</span>,   </span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>,   </span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.2</span>,  </span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd),</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">2</span>),  </span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Abbildung&nbsp;42.24— Die Abbildung des Säulendiagramms in ggplot nachgebaut. Wir nutzen das geom_text() um noch besser unser compact letter display zu setzen. Die Kontrolle wurde entfernt, sonst hätten wir hier nicht emmeans in der einfachen Form nutzen können. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.24— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen. Die Kontrolle wurde entfernt, sonst hätten wir hier nicht <code>emmeans</code> in der einfachen Form nutzen können. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_barplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Zweifaktorielle Analyse mit <code>{emmeans}</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen zweifaktoriellen Boxplot unter der Annahme nicht normalverteilter Daten anschauen. Dabei ist Iodanteil in den Pflanzen nicht normalverteilt, so dass wir hier eine <a href="stat-modeling-robust-quantile.html">Quantilesregression</a> rechnen wollen. Die Daten siehst du wieder in der unteren Abbildung. Ich nehme für jede der vier Zeitpunkte jeweils fünf Beobachtungen an. Für die Kontrolle haben wir dann nur drei Beobachtungen in der Gruppe <span class="math inline">\(KIO_3\)</span> vorliegen. Das ist wichtig, denn sonst können wir nicht mit <code>emmeans</code> rechnen. Wir haben einfach zu wenige Beobachtungen vorliegen.</p>
<div id="fig-ur-barplot-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_2fac.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Abbildung&nbsp;42.25— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit den zwei Faktoren Zeit und die Iodine Form. Hier soll es dann ein Boxplot werden."><img src="images/eda/zerforschen_barplot_2fac.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.25— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit den zwei Faktoren Zeit und die Iodine Form. Hier soll es dann ein Boxplot werden.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_2fac_target_emmeans.xlsx</code> selber ausgedacht. Ich nehme hier die gleichen Daten wie für den Barplot. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die fünf Werte alle um den Mittelwert streuen lassen. Ich brauche hier eigentlich mehr als fünf Werte, sonst kriegen wir bei <code>emmeans()</code> und der Interaktion im <code>gls()</code>-Modell Probleme, aber da gibt es dann bei kleinen Fallzahlen noch ein Workaround. Bitte nicht mit weniger als fünf Beobachtungen versuchen, dann wird es schwierig mit der Konsistenz der Schätzer aus dem Modell.</p>
<p>Ach, und ganz wichtig. Wir entfernen die Kontrolle, da wir die Kontrolle nur mit einer Iodid-Stufe gemessen haben. Dann können wir weder die Interaktion rechnen, noch anständig eine Interpretation durchführen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>boxplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_2fac_target_emmeans.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ctrl"</span>, <span class="st">"7"</span>, <span class="st">"11"</span>, <span class="st">"15"</span>, <span class="st">"19"</span>),</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Contr."</span>, <span class="st">"07:00"</span>, <span class="st">"11:00"</span>, <span class="st">"15:00"</span>, <span class="st">"19:00"</span>)),</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as_factor</span>(type)) <span class="sc">|&gt;</span> </span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">!=</span> <span class="st">"Contr."</span>)</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>boxplot_tbl  </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 3
   time  type  iodine
   &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
 1 07:00 KIO3      50
 2 07:00 KIO3      55
 3 07:00 KIO3      60
 4 07:00 KIO3      52
 5 07:00 KIO3      62
 6 07:00 KI        97
 7 07:00 KI        90
 8 07:00 KI        83
 9 07:00 KI        81
10 07:00 KI        98
# ℹ 30 more rows</code></pre>
</div>
</div>
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>. Wichtig ist hier, dass wir zur Modellierung die Funktion <code>rq()</code> aus dem R Paket <code>quantreg</code> nutzen. Wenn du den Aufbau mit den anderen Zerforschenbeispielen vergleichst, siehst du, dass hier viel ähnlich ist. Achtung, ganz wichtig! Du musst am Ende wieder die Ausgabe aus der <code>cld()</code>-Funktion nach der Zeit <code>time</code> und der Form <code>type</code> sortieren, sonst passt es gleich nicht mit den Beschriftungen der Boxplots.</p>
<p>Du musst dich nur noch entscheiden, ob du das <em>compact letter display</em> getrennt für die beiden Jodformen <code>type</code> berechnen willst oder aber zusammen. Wenn du das <em>compact letter display</em> für die beiden Jodformen zusammen berechnest, dann berechnest du für jede Faktorkombination einen paarweisen Vergleich.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-boxplot-2fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Getrennt nach <code>type</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Zusammen über <code>type</code></a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-boxplot-2fac">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<p>Hier rechnen wir den Vergleich nur innerhalb der jeweiligen Jodform <code>type</code>. Daher vergleichen wir die Boxplots nicht untereinander sondern eben nur in den jeweiligen Leveln <span class="math inline">\(KIO_3\)</span> und <span class="math inline">\(KI\)</span>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>emmeans_quant_sep_tbl <span class="ot">&lt;-</span> <span class="fu">rq</span>(iodine <span class="sc">~</span> time <span class="sc">+</span> type <span class="sc">+</span> time<span class="sc">:</span>type, <span class="at">data =</span> boxplot_tbl, <span class="at">tau =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> time <span class="sc">|</span> type) <span class="sc">|&gt;</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group)) <span class="sc">|&gt;</span> </span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(time, type)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>emmeans_quant_sep_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
  time  type  emmean    SE    df lower.CL upper.CL .group
  &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt; 
1 07:00 KIO3      55  3.15    32     48.6     61.4 a     
2 07:00 KI        90  5.51    32     78.8    101.  a     
3 11:00 KIO3      75  1.97    32     71.0     79.0 b     
4 11:00 KI       150 13.8     32    122.     178.  b     
5 15:00 KIO3      80  4.72    32     70.4     89.6 b     
6 15:00 KI       120  7.87    32    104.     136.  b     
7 19:00 KIO3      85  7.48    32     69.8    100.  b     
8 19:00 KI        90  2.36    32     85.2     94.8 a     </code></pre>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p>Dann einmal die Berechnung über alle Boxplots und damit allen Faktorkombinationen aus Zeit und Jodform. Wir können dann damit jeden Boxplot mit jedem anderen Boxplot vergleichen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>emmeans_quant_comb_tbl <span class="ot">&lt;-</span> <span class="fu">rq</span>(iodine <span class="sc">~</span> time <span class="sc">+</span> type <span class="sc">+</span> time<span class="sc">:</span>type, <span class="at">data =</span> boxplot_tbl, <span class="at">tau =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> time<span class="sc">*</span>type) <span class="sc">|&gt;</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group)) <span class="sc">|&gt;</span> </span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(time, type)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>emmeans_quant_comb_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
  time  type  emmean    SE    df lower.CL upper.CL .group
  &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt; 
1 07:00 KIO3      55  3.15    32     48.6     61.4 a     
2 07:00 KI        90  5.51    32     78.8    101.  c     
3 11:00 KIO3      75  1.97    32     71.0     79.0 b     
4 11:00 KI       150 13.8     32    122.     178.  d     
5 15:00 KIO3      80  4.72    32     70.4     89.6 bc    
6 15:00 KI       120  7.87    32    104.     136.  d     
7 19:00 KIO3      85  7.48    32     69.8    100.  bc    
8 19:00 KI        90  2.36    32     85.2     94.8 c     </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Für die Boxplots brauchen wir dann noch ein Objekt mehr. Um das nach den Faktorkombinationen sortierte <em>compacte letter dislay</em> an die richtige Position zu setzen brauchen wir noch eine <span class="math inline">\(y\)</span>-Position. Ich nehme hier dann das 95% Quantile. Das 95% Quantile sollte dann auf jeden Fall über die Schnurrhaare raus reichen. Wir nutzen dann den Datensatz <code>letter_pos_tbl</code> in dem <code>geom_text()</code> um die Buchstaben richtig zu setzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>letter_pos_tbl <span class="ot">&lt;-</span> boxplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, type) <span class="sc">|&gt;</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">quant_90 =</span> <span class="fu">quantile</span>(iodine, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.95</span>)))</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>letter_pos_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   time [4]
  time  type  quant_90
  &lt;fct&gt; &lt;fct&gt;    &lt;dbl&gt;
1 07:00 KIO3      61.6
2 07:00 KI        97.8
3 11:00 KIO3      78.8
4 11:00 KI       174  
5 15:00 KIO3      89.4
6 15:00 KI       146  
7 19:00 KIO3     106  
8 19:00 KI        99.8</code></pre>
</div>
</div>
<p>Das Problem sind natürlich die wenigen Beobachtungen, deshalb sehen die Boxplots teilweise etwas wild aus. Aber wir wollen hier eben die Mediane darstellen, die wir dann auch in der Quantilesregression berechnet haben. Wenn du mehr Beobachtungen erstellst, dann werden die Boxplots auch besser dargestellt.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-boxplot-2fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Getrennt nach <code>type</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Zusammen über <code>type</code></a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-boxplot-2fac">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>Hier nehmen wir das <em>compact letter display</em> aus dem Objekt <code>emmeans_quant_sep_tbl</code>. Wichtig ist, dass die Sortierung gleich der Beschriftung der <span class="math inline">\(x\)</span>-Achse ist. Deshalb nutzen wir weiter oben auch die Funktion <code>arrange()</code> zur Sortierung der Buchstaben. Beachte, dass wir hier jeweils die beiden Jodformen getrennt voneinander betrachten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> boxplot_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> iodine,</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">4.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>) <span class="sc">+</span> </span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.1</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">xend =</span> <span class="fl">1.7</span>, <span class="at">yend =</span> <span class="dv">105</span>),   </span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"#555555"</span>,   </span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>,   </span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.2</span>,  </span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letter_pos_tbl, </span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> emmeans_quant_sep_tbl<span class="sc">$</span>.group, </span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> quant_90 <span class="sc">+</span> <span class="dv">5</span>),  </span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerfor-barplot-2fac-box-emmeans-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerfor-barplot-2fac-box-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerfor-barplot-2fac-box-emmeans-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="Abbildung&nbsp;42.26— Die Abbildung des Säulendiagramms in ggplot als Boxplot nachgebaut. Wir nutzen das geom_text() um noch besser unser compact letter display zu setzen, dafür müssen wir uns aber nochmal ein Positionsdatensatz bauen. Hier ist das compact letter display getrennt für die beiden Jodformen berechnet."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerfor-barplot-2fac-box-emmeans-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerfor-barplot-2fac-box-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.26— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen, dafür müssen wir uns aber nochmal ein Positionsdatensatz bauen. Hier ist das <em>compact letter display</em> getrennt für die beiden Jodformen berechnet.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<p>Und hier nutzen wir das <em>compact letter display</em> aus dem Objekt <code>emmeans_quant_comb_tbl</code>. Wichtig ist, dass die Sortierung gleich der Beschriftung der <span class="math inline">\(x\)</span>-Achse ist. Deshalb nutzen wir weiter oben auch die Funktion <code>arrange()</code> zur Sortierung der Buchstaben. Hier betrachten wir jeden Boxplot einzelne und du kannst auch jeden Boxplot mit jedem Boxplot vergleichen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> boxplot_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> iodine,</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">4.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>) <span class="sc">+</span> </span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.1</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">xend =</span> <span class="fl">1.7</span>, <span class="at">yend =</span> <span class="dv">105</span>),   </span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"#555555"</span>,   </span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>,   </span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.2</span>,  </span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letter_pos_tbl, </span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> emmeans_quant_comb_tbl<span class="sc">$</span>.group, </span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> quant_90 <span class="sc">+</span> <span class="dv">5</span>),  </span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerfor-barplot-2fac-box-emmeans-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerfor-barplot-2fac-box-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerfor-barplot-2fac-box-emmeans-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Abbildung&nbsp;42.27— Die Abbildung des Säulendiagramms in ggplot als Boxplot nachgebaut. Wir nutzen das geom_text() um noch besser unser compact letter display zu setzen, dafür müssen wir uns aber nochmal ein Positionsdatensatz bauen. Hier ist das compact letter display für jede einzelne Faktorkombination berechnet."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-zerfor-barplot-2fac-box-emmeans-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerfor-barplot-2fac-box-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.27— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen, dafür müssen wir uns aber nochmal ein Positionsdatensatz bauen. Hier ist das <em>compact letter display</em> für jede einzelne Faktorkombination berechnet.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_boxplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Komplexere Analyse mit <code>{emmeans}</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Hier wollen wir einmal eine etwas größere <a href="#fig-zer-boxplot-mult" class="quarto-xref">Abbildung&nbsp;<span>42.28</span></a> mit einer Menge Boxplots zerforschen. Da ich den Datensatz dann nicht zu groß machen wollte und Boxplots zu zerforschen manchmal nicht so einfach ist, passen die Ausreißer dann manchmal dann doch nicht. Auch liefern die statistischen Tests dann nicht super genau die gleichen Ergebnisse. Aber das macht vermutlich nicht so viel, hier geht es ja dann eher um den Bau der Boxplots und dem rechnen des statistischen Tests in <code>{emmeans}</code>. Die Reihenfolge des <em>compact letter displays</em> habe ich dann auch nicht angepasst sondern die Buchstaben genommen, die ich dann erhalten habe. Die Sortierung kann man ja selber einfach ändern. Wir haben hier ein einfaktorielles Design mit einem Behandlungsfaktor mit drei Leveln vorliegen. Insgesamt schauen wir uns vier Endpunkte in veränderten Substrat- und Wasserbedingungen an.</p>
<div id="fig-zer-boxplot-mult" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zer-boxplot-mult-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_boxplot_mult.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Abbildung&nbsp;42.28— Ursprüngliche Abbildung, die nachgebaut werden soll. Insgesamt vier Outcomes sollen für zwei Behandlungen ausgewertet werden. Das praktische ist hier, dass wir es nur mit einem einfaktoriellen Design zu tun haben."><img src="images/eda/zerforschen_boxplot_mult.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zer-boxplot-mult-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.28— Ursprüngliche Abbildung, die nachgebaut werden soll. Insgesamt vier Outcomes sollen für zwei Behandlungen ausgewertet werden. Das praktische ist hier, dass wir es nur mit einem einfaktoriellen Design zu tun haben.
</figcaption>
</figure>
</div>
<p>Im Folgenden lade ich einmal den Datensatz, den ich dann per Auge zusammengesetzt habe. Das war jetzt etwas anstrengender als gedacht, da ich nicht weiß wie viele Beobachtungen einen Boxplot bilden. Je mehr Beobachtungen, desto feiner kann man den Boxplot abstimmen. Da ich hier nur mit sieben Beobachtungen ja Gruppe gearbeitet habe, habe ich es nicht geschafft die Ausreißer darzustellen. Das wäre mir dann zu viel Arbeit geworden. Nachdem ich jetzt die Daten geladen habe, muss ich noch über die Funktion <code>pivot_longer()</code> einen Datensatz passenden im Longformat bauen. Abschließend mutiere ich dann noch alle Faktoren richtig und vergebe bessere Namen als <code>labels</code> sonst versteht man ja nicht was die Spalten bedeuten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_boxplot_mult.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> fresh_weight<span class="sc">:</span>flower_number,</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"rsp"</span>,</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"plant_measure"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt),</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">plant_measure =</span> <span class="fu">factor</span>(plant_measure,</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"fresh_weight"</span>, <span class="st">"dry_weight"</span>,</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"plant_height"</span>, <span class="st">"flower_number"</span>),</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Fresh weight (g)"</span>, <span class="st">"Dry weight (g)"</span>,</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Plant height (cm)"</span>, <span class="st">"Flower number"</span>)),</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Substrate"</span>, <span class="st">"Water"</span>))) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ich habe mir dann die beiden Behandlungen <code>substrate</code> und <code>water</code> in die neue Spalte <code>type</code> geschrieben. Die Spaltennamen der Outcomes wandern in die Spalte <code>plant_measure</code> und die entsprechenden Werte in die Spalte <code>rsp</code>. Dann werde ich hier mal alle Outcomes auf einmal auswerten und nutze dafür das R Paket <code>{purrr}</code> mit der Funktion <code>nest()</code> und <code>map()</code>. Ich packe mir als die Daten nach <code>type</code> und <code>plant_measure</code> einmal zusammen. Dann habe ich einen neuen genesteten Datensatz mit nur noch acht Zeilen. Auf jeder Zeile rechne ich dann jeweils mein Modell. Wie du dann siehst ist in der Spalte <code>data</code> dann jeweils ein Datensatz mit der Spalte <code>trt</code> und <code>rsp</code> für die entsprechenden 21 Beobachtungen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_tbl <span class="ot">&lt;-</span> boxplot_mult_tbl <span class="sc">|&gt;</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, plant_measure) <span class="sc">|&gt;</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   type, plant_measure [8]
  type      plant_measure     data             
  &lt;fct&gt;     &lt;fct&gt;             &lt;list&gt;           
1 Substrate Fresh weight (g)  &lt;tibble [21 × 2]&gt;
2 Substrate Dry weight (g)    &lt;tibble [21 × 2]&gt;
3 Substrate Plant height (cm) &lt;tibble [21 × 2]&gt;
4 Substrate Flower number     &lt;tibble [21 × 2]&gt;
5 Water     Fresh weight (g)  &lt;tibble [21 × 2]&gt;
6 Water     Dry weight (g)    &lt;tibble [21 × 2]&gt;
7 Water     Plant height (cm) &lt;tibble [21 × 2]&gt;
8 Water     Flower number     &lt;tibble [21 × 2]&gt;</code></pre>
</div>
</div>
<p>Zur Veranschaulichung rechne ich jetzt einmal mit <code>mutate()</code> und <code>map()</code> für jeden der Datensätze in der Spalte <code>data</code> einmal ein lineares Modell mit der Funktion <code>lm()</code>. Ich muss nur darauf achten, dass ich die Daten mit <code>.x</code> einmal an die richtige Stelle in der Funktion <code>lm()</code> übergebe. Dann habe ich alle Modell komprimiert in der Spalte <code>model</code>. Das geht natürlcih auch alles super in einem Rutsch.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl <span class="ot">&lt;-</span> boxplot_mult_nest_tbl <span class="sc">|&gt;</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> .x)))</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
# Groups:   type, plant_measure [8]
  type      plant_measure     data              model 
  &lt;fct&gt;     &lt;fct&gt;             &lt;list&gt;            &lt;list&gt;
1 Substrate Fresh weight (g)  &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
2 Substrate Dry weight (g)    &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
3 Substrate Plant height (cm) &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
4 Substrate Flower number     &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
5 Water     Fresh weight (g)  &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
6 Water     Dry weight (g)    &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
7 Water     Plant height (cm) &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
8 Water     Flower number     &lt;tibble [21 × 2]&gt; &lt;lm&gt;  </code></pre>
</div>
</div>
<p>Jetzt können wir einmal eskalieren und insgesamt acht mal die ANOVA rechnen. Das sieht jetzt nach viel Code aus, aber am Ende ist es nur eine lange Pipe. Am Ende erhalten wir dann den <span class="math inline">\(p\)</span>-Wert für die einfaktorielle ANOVA für die Behandlung <code>trt</code> wiedergegeben. Wir sehen, dass wir eigentlich nur einen signifikanten Unterschied in der Wassergruppe und der Pflanzenhöhe erwarten sollten. Da der <span class="math inline">\(p\)</span>-Wert für die Wassergruppe und der Blütenanzahl auch sehr nah an dem Signifikanzniveau ist, könnte hier auch etwas sein, wenn wir die Gruppen nochmal getrennt testen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl  <span class="sc">|&gt;</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">anova =</span> <span class="fu">map</span>(model, anova)) <span class="sc">|&gt;</span> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parameter =</span> <span class="fu">map</span>(anova, model_parameters)) <span class="sc">|&gt;</span> </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, parameter) <span class="sc">|&gt;</span> </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(parameter) <span class="sc">|&gt;</span> </span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">!=</span> <span class="st">"Residuals"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, parameter, p)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
# Groups:   type, plant_measure [8]
  type      plant_measure     parameter        p
  &lt;fct&gt;     &lt;fct&gt;             &lt;chr&gt;        &lt;dbl&gt;
1 Substrate Fresh weight (g)  trt       0.813   
2 Substrate Dry weight (g)    trt       0.381   
3 Substrate Plant height (cm) trt       0.959   
4 Substrate Flower number     trt       0.444   
5 Water     Fresh weight (g)  trt       0.384   
6 Water     Dry weight (g)    trt       0.843   
7 Water     Plant height (cm) trt       0.000138
8 Water     Flower number     trt       0.0600  </code></pre>
</div>
</div>
<p>Dann schauen wir uns nochmal das <span class="math inline">\(\eta^2\)</span> an um zu sehen, wie viel Varianz unsere Behandlung in den Daten erklärt. Leider sieht es in unseren Daten sehr schlecht aus. Nur bei der Wassergruppe und der Pflanzenhöhe scheinen wir durch die Behandlung Varianz zu erklären.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl <span class="sc">%&gt;%</span>  </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eta =</span> <span class="fu">map</span>(model, eta_squared)) <span class="sc">%&gt;%</span> </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(eta) <span class="sc">%&gt;%</span> </span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, eta2) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   type, plant_measure [8]
  type      plant_measure        eta2
  &lt;fct&gt;     &lt;fct&gt;               &lt;dbl&gt;
1 Substrate Fresh weight (g)  0.0228 
2 Substrate Dry weight (g)    0.102  
3 Substrate Plant height (cm) 0.00466
4 Substrate Flower number     0.0863 
5 Water     Fresh weight (g)  0.101  
6 Water     Dry weight (g)    0.0188 
7 Water     Plant height (cm) 0.628  
8 Water     Flower number     0.268  </code></pre>
</div>
</div>
<p>Dann können wir auch schon den Gruppenvergleich mit dem R Paket <code>{emmeans}</code> rechnen. Wir nutzen hier die Option <code>vcov. = sandwich::vcovHAC</code> um heterogene Varianzen zuzulassen. Im Weiteren adjustieren wir nicht für die Anzahl der Vergleiche und lassen uns am Ende das <em>compact letter display</em> wiedergeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>emm_tbl <span class="ot">&lt;-</span> boxplot_mult_nest_model_tbl <span class="sc">|&gt;</span> </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">emm =</span> <span class="fu">map</span>(model, emmeans, <span class="sc">~</span>trt, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC)) <span class="sc">|&gt;</span> </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cld =</span> <span class="fu">map</span>(emm, cld, <span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(cld) <span class="sc">|&gt;</span> </span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, trt, <span class="at">rsp =</span> emmean, <span class="at">group =</span> .group) <span class="sc">|&gt;</span> </span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">str_trim</span>(group))</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>emm_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 5
# Groups:   type, plant_measure [8]
   type      plant_measure     trt     rsp group
   &lt;fct&gt;     &lt;fct&gt;             &lt;fct&gt; &lt;dbl&gt; &lt;chr&gt;
 1 Substrate Fresh weight (g)  UWF    95.4 a    
 2 Substrate Fresh weight (g)  TWF   101   a    
 3 Substrate Fresh weight (g)  Peat  105   a    
 4 Substrate Dry weight (g)    UWF    12.3 a    
 5 Substrate Dry weight (g)    Peat   14.3 ab   
 6 Substrate Dry weight (g)    TWF    15.1 b    
 7 Substrate Plant height (cm) TWF    37.9 a    
 8 Substrate Plant height (cm) Peat   38.0 a    
 9 Substrate Plant height (cm) UWF    39.1 a    
10 Substrate Flower number     UWF    14.6 a    
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>Da die Ausgabe viel zu lang ist, wollen wir ja jetzt einmal unsere Abbildungen in <code>{ggplot}</code> nachbauen. Dazu nutze ich dann einmal zwei Wege. Einmal den etwas schnelleren mit <code>facet_wrap()</code> bei dem wir eigentlich alles automatisch machen lassen. Zum anderen zeige ich dir mit etwas Mehraufwand alle acht Abbildungen einzeln baust und dann über das R Paket <code>{patchwork}</code> wieder zusammenklebst. Der zweite Weg ist der Weg, wenn du mehr Kontrolle über die einzelnen Abbildungen haben willst.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Mit <code>facet_wrap()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Mit <code>{patchwork}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<p>Die Funktion <code>facet_wrap()</code> erlaubt es dir automatisch Subplots nach einem oder mehreren Faktoren zu erstellen. Dabei muss auch ich immer wieder probieren, wie ich die Faktoren anordne. In unserem Fall wollen wir zwei Zeilen und auch den Subplots erlauben eigene <span class="math inline">\(x\)</span>-Achsen und <span class="math inline">\(y\)</span>-Achsen zu haben. Wenn du die Option <code>scale = "free"</code> nicht wählst, dann haben alle Plots alle Einteilungen der <span class="math inline">\(x\)</span>_Achse und die <span class="math inline">\(y\)</span>-Achse läuft von dem kleinsten zu größten Wert in den gesamten Daten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_tbl <span class="sc">|&gt;</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trt, rsp)) <span class="sc">+</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="dv">18</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type <span class="sc">*</span> plant_measure, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> emm_tbl, <span class="fu">aes</span>(<span class="at">y =</span> rsp, <span class="at">label =</span> group), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fl">0.2</span>), <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-zerforschen_boxplot_mult-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zerforschen_boxplot_mult-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-zerforschen_boxplot_mult-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29" title="Abbildung&nbsp;42.29— Nachbau der Abbildung mit der Funktion facte_wrap() mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das compact letter display. Auf eine Einfärbung nach der Behandlung wurde verzichtet um die Abbildung nicht noch mehr zu überladen."><img src="stat-tests-posthoc2_files/figure-html/fig-zerforschen_boxplot_mult-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zerforschen_boxplot_mult-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.29— Nachbau der Abbildung mit der Funktion <code>facte_wrap()</code> mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das <em>compact letter display</em>. Auf eine Einfärbung nach der Behandlung wurde verzichtet um die Abbildung nicht noch mehr zu überladen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<p>Jetzt wird es etwas wilder. Wir bauen uns jetzt alle acht Plots einzeln und kleben diese dann mit dem R Paket <code>{patchwork}</code> zusammen. Das hat ein paar Vorteile. Wir können jetzt jeden einzelnen Plot bearbeiten und anpassen wie wir es wollen. Damit wir aber nicht zu viel Redundanz haben bauen wir uns erstmal ein Template für <code>ggplot()</code>. Dann können wir immer noch die Werte für <code>scale_y_continuous()</code> in den einzelnen Plots ändern. Hier also einmal das Template, was beinhaltet was für alle Abbildungen gelten soll.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>gg_template <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(trt, rsp) <span class="sc">+</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="dv">18</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ja, jetzt geht es los. Wir bauen also jeden Plot einmal nach. Dafür müssen wir dann jeweils den Datensatz filtern, den wir auch brauchen. Dann ergänzen wir noch die korrekte <span class="math inline">\(y\)</span>-Achsenbeschriftung. So können wir dann auch händisch das <em>compact letter display</em> über die Whisker einfach setzen. Im Weiteren habe ich dann auch einmal als Beispiel noch die <span class="math inline">\(y\)</span>-Achseneinteilung mit <code>scale_y_continuous()</code> geändert. Ich habe das einmal für den Plot <code>p1</code> gemacht, der Rest würde analog dazu funktionieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Fresh weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Fresh weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">170</span>, <span class="dv">120</span>, <span class="dv">135</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>), </span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">40</span>, <span class="dv">180</span>, <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">180</span>))</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Dry weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Dry weight (g)"</span>)</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Plant height (cm)"</span>) <span class="sc">+</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Plant height (cm)"</span>)</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Flower number"</span>) <span class="sc">+</span></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Flower number"</span>)</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Fresh weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Fresh weight (g)"</span>)</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Dry weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Dry weight (g)"</span>)</span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Plant height (cm)"</span>) <span class="sc">+</span></span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Plant height (g)"</span>)</span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Flower number"</span>) <span class="sc">+</span></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Flower number"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann kleben wir die Abbildungen einfach mit einem <code>+</code> zusammen und dann wählen wir noch aus, dass wir vier Spalten wollen. Dann können wir noch Buchstaben zu den Subplots hinzufügen und noch Titel und anderes wenn wir wollen würden. Dann haben wir auch den Plot schon nachgebaut. Ich verzichte hier händisch überall das <em>compact letter display</em> zu ergänzen. Das macht super viel Arbeit und endlos viel Code und hilft dir dann aber in deiner Abbildung auch nicht weiter. Du musst dann ja bei dir selber die Positionen für die Buchstaben finden.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>patch <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span> p6 <span class="sc">+</span> p7 <span class="sc">+</span> p8 <span class="sc">+</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>patch <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>,</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title =</span> <span class="st">'Ein Zerforschenbeispiel an Boxplots'</span>,</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">subtitle =</span> <span class="st">'Alle Plots wurden abgelesen und daher sagen Signifikanzen nichts.'</span>,</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">caption =</span> <span class="st">'Disclaimer: Die Abbildungen sagen nichts aus.'</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-zerforschen_boxplot_mult-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zerforschen_boxplot_mult-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-zerforschen_boxplot_mult-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Abbildung&nbsp;42.30— Nachbau der Abbildung mit dem R Paket {patchwork} mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das compact letter display bei dem ersten Plot. Auf eine Einfärbung nach der Behanldung wurde verzichtet um die Abbildung nicht noch mehr zu überladen."><img src="stat-tests-posthoc2_files/figure-html/fig-zerforschen_boxplot_mult-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zerforschen_boxplot_mult-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.30— Nachbau der Abbildung mit dem R Paket <code>{patchwork}</code> mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das <em>compact letter display</em> bei dem ersten Plot. Auf eine Einfärbung nach der Behanldung wurde verzichtet um die Abbildung nicht noch mehr zu überladen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_boxplot.png"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="der-anova-pfad-mit-tukey-hsd" class="level2" data-number="42.7">
<h2 data-number="42.7" class="anchored" data-anchor-id="der-anova-pfad-mit-tukey-hsd"><span class="header-section-number">42.7</span> Der ANOVA Pfad mit Tukey HSD</h2>
<p>Der Tukey HSD Test (abk. <em>HSD Test</em>) hat viele Namen. Im Englischen kennen wir den Tukey HSD Test auch als <em>Tukey’s range test</em> oder aber als <em>Tukey’s test</em>, <em>Tukey method</em>, <em>Tukey’s honest significance test</em> oder eben <em>Tukey’s HSD (honestly significant difference)</em> Test. Dabei steht die Abkürzung HDS für <em>honestly significant difference</em> (deu. <em>ehrlich signifikanter Unterschied</em>). Für mich etwas weit aus dem Fenster gelehnt, aber der Name sagt hier mal was auch wirklich gemacht wird. Im Prinzip stellen wir nur die Formel von den Student t-Test einmal um und benennen alles neu. Dann sieht man auch nicht gleich, was Sache ist und jeder denkt, es wäre was Neues. Wir werden hier aber mal den Tukey HSD Test zerforschen. Wir nutzen aber die ANOVA um einmal die Streuung und die Effekte zu berechnen. Daher nenne ich das ganze hier auch den ANOVA Pfad. Der Tukey HSD Test basiert eben mehr oder minder auf der Ausgabe einer ANOVA. Mehr Informationen gibt es auch im Tutorium <a href="https://rpubs.com/aaronsc32/post-hoc-analysis-tukey">Post-Hoc Analysis with Tukey’s Test</a>. Ach, der Tukey HSD Test ist schon etwas älter und kann nicht so viel wie neuere Implementierungen wie das R Paket <code>{emmeans}</code> und <code>{multcomp}</code>.</p>
<dl>
<dt>Varianzhomogenität</dt>
<dd>
<p>Es ist wichtig zu wissen, dass der Tukey HSD Test auf der ANOVA basiert und die ANOVA nimmt Varianzhomogenität an. Damit meine ich, dass alle Gruppen in der Behandlung die gleiche Varianz haben. Du kannst leider den Tukey HSD Test nur unter der Annahme von Varianzhomogenität nutzen. Wenn das dir eine zu starke Annahme ist, dann nutze einfach das R Paket <code>{emmeans}</code>, wie ich es dir weiter unten im Kapitel vorstelle.</p>
</dd>
<dt>Adjustierung für multiple Vergleiche</dt>
<dd>
<p>Der Tukey HSD Test adjustiert für die <span class="math inline">\(\alpha\)</span>-Inflation bei multiplen Vergleichen. Wir müssen da auch nichts weiter machen um die Adjustierung durchzuführen. Das macht die Funktion <code>TukeyHSD()</code> für uns automatisch. Auf der anderen Seite können wir die Adjustierung für multiple Vergleiche aber auch nicht ausschalten. Du erhälst <em>immer</em> adjustierte p-Werte aus einem Tukey HSD Test. Wenn du das nicht möchtest, dann nutze einfach das R Paket <code>{emmeans}</code>, welches du weiter unten findest.</p>
</dd>
<dt>Mögliche multiple Vergleiche</dt>
<dd>
<p>Wir können immer nur alle Gruppen mit allen anderen Gruppen vergleichen. Wir rechnen also einen <em>all pair</em> Vergleich. Wenn du zum Beispiel nur die Behandlungsgruppen zur Kontrolle vergleichen willst, aber nciht untereinander, dann ist das nicht mit dem Tukey HDS Test möglich. Dafür musst du dann das R Paket <code>{ememans}</code> oder für noch komplexere Gruppenvergleiche das R Paket <code>{multcomp}</code> nutzen.</p>
</dd>
<dt>Fallzahl in den einzelnen Behandlungsgruppen</dt>
<dd>
<p>Der Tukey HSD Test geht von einem balancierten Design aus. Daher brauchen wir in allen Behandlungsgruppen die gleiche Anzahl an Beobachtungen. Wenn wir kein balanciertes Design vorliegen haben, dann wird die Fallzahl mehr oder minder über die Gruppen gemittelt. Teilweise funktioniert dann auch der Tukey HSD Test nicht mehr richtig. Daher ist von der Nutzung es Tukey HSD Tests bei ungleich großen Gruppen abzuraten. Auch hier ist dann der Ausweg das R Paket <code>{emmeans}</code>, welches genau für den unblancierten Fall ursprünglich entworfen wurde.</p>
</dd>
</dl>
<p>Schauen wir uns nun einmal an, wie der Tukey HSD Test theoretisch funktioniert und wie die Implmentierugn in R dargestellt ist. Wir haben die Wahl zwischen der Funktion <code>TukeyHSD()</code> und der Funktion <code>HSD.test()</code> aus dem R Paket <code>{agricolae}</code>. Die Funktion <code>HSD.test()</code> liefert auch gleich das <em>Compact letter display</em> in der Ausgabe mit. Sonst sind die beiden Funktionen sehr ähnlich. Oft wird eben der Tukey HSD Test noch verwendet, weil er eben sehr alt ist und somit schon sehr lange verwendet wurde.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false"><code>TukeyHSD()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false"><code>{emmeans}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-5" role="tab" aria-controls="tabset-14-5" aria-selected="false"><code>HSD.test()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<p>Zuerst einmal die Formel des Tukey HSD Test. Wir berechnen dabei als statistische Maßzahl den HSD-Wert, der nichts anderes aussagt als der minimal Mittelwertsunterschied, den wir gegeben der Streuung und der Fallzahl in den Daten als signifikant nachweisen können. Sozusagen der minimalste mögliche signifikante Mittelwertsunterschied.</p>
<p><span class="math display">\[
HSD = q_{\alpha=5\%, k, n-k} \cdot \sqrt{\tfrac{MSE}{n}}
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(HSD\)</span>, den zu berechnenden minimalsten möglichen signifikanten Mittelwertsunterschied.</li>
<li><span class="math inline">\(q_{\alpha=5\%, k, n-k}\)</span>, den kritischen Wert gegeben aus dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% der Anzahl an zu vergleichenden Gruppen <span class="math inline">\(k\)</span> und einem Freiheitsgrad <span class="math inline">\(n-k\)</span>.</li>
<li><span class="math inline">\(\sqrt{\tfrac{MSE}{n}}\)</span>, der Streuung in den Daten gewichtet für die Fallzahl <span class="math inline">\(n\)</span>. Hier wird die Streuung über alle Gruppen hinweg berechnet.</li>
</ul>
<p>Wir können uns das Ganze auch nochmal in der folgenden Tabelle als Vergleich zu dem Student t-Test anschauen. Hier dann erstmal noch die beiden Formeln.</p>
<p><span class="math display">\[
\begin{array}{c|c}
  HSD = q_{\alpha=5\%, k, n-k} \cdot \sqrt{\tfrac{MSE}{n}} &amp; \bar{y}_1 - \bar{y}_2 =  T_{\alpha=5\%} \cdot s_p\sqrt{\tfrac{2}{n_g}}
\end{array}
\]</span></p>
<p>Ich habe dort einmal die statistischen Maßzahlen aus einem Tukey HDS Test den statistischen Maßzahlen eines Student t-Test in der folgenden Tabelle gegenüber gestellt. Du siehst, dass wir hier eigentlich nur eine Umstellung der t-Test Formel haben.</p>
<div id="tbl-hds-ttest" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hds-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.13— Etwas wilder Vergleich vom Tukey HSD Test zum Student t-Test. Im Prinzip ist der Tukey HSD Test nur eine Umstellung der Formel des Student t-Test.
</figcaption>
<div aria-describedby="tbl-hds-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 36%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Tukey HSD Test</th>
<th>Student t-Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Effekt</td>
<td><span class="math inline">\(HSD\)</span></td>
<td><span class="math inline">\(\bar{y}_1 - \bar{y}_2\)</span></td>
</tr>
<tr class="even">
<td>Streuung</td>
<td><span class="math inline">\(\tfrac{MSE}{n}\)</span></td>
<td><span class="math inline">\(s_p\sqrt{\tfrac{2}{n_g}}\)</span></td>
</tr>
<tr class="odd">
<td>Kritischer Wert</td>
<td><span class="math inline">\(q_{\alpha=5\%, k, n-k}\)</span></td>
<td><span class="math inline">\(T_{\alpha=5\%}\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Um die Idee des Tukey HDS Test zusammenzufassen, setzen wir für <span class="math inline">\(q_{\alpha=5\%, k, n-k}\)</span> den Wert ein, den wir mindestens erreichen müssen um einen signifikanten Unterschied nachweisen zu können. Bei dem Student t-Test war es meist <span class="math inline">\(T_{\alpha=5\%}\)</span> gleich <span class="math inline">\(1.96\)</span>, hier ist der Wert für <span class="math inline">\(q_{\alpha=5\%, k, n-k}\)</span> natürlich anders. Dann können wir den minimalen Mittelwertsunterschied mit <span class="math inline">\(\bar{y}_1 - \bar{y}_2\)</span> oder eben <span class="math inline">\(HSD\)</span> berechnen, denn wir mindestens erreichen müssen um einen signifikanten Unterschied nachweisen zu können. Alle Mittelwertsdifferenzen größer als der <span class="math inline">\(HDS\)</span> Wert werden dann signifikant sein und alle Mittelwertsdifferenzen kleiner als der <span class="math inline">\(HDS\)</span> Wert nicht signifikant sein.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Entscheidung mit dem HDS Wert
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wenn eine Mittelwertsdifferenz <span class="math inline">\(\bar{y}_i - \bar{y}_j\)</span> eines Gruppenvergleiches <em>größer</em> ist als der HDS Wert dann wird die Nullhypothese (H<span class="math inline">\(_0\)</span>) abgelehnt. Ist die Mittelwertsdifferenz <span class="math inline">\(\bar{y}_i - \bar{y}_j\)</span> eines Gruppenvergleiches ist als der HDS Wert dann wird die Nullhypothese (H<span class="math inline">\(_0\)</span>) beibehalten.</p>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<p>Im Folgenden wollen wir einmal den Tukey HSD Test nachvollziehen. Dafür hier nochmal die Formel, die wir dann mit den entsprechenden Werten ausfüllen müssen. Wir beginnen mit dem q-Wert und erhalten den MSE Wert aus einer ANOVA.</p>
<p><span class="math display">\[
HSD = q_{\alpha=5\%, k, n-k} \cdot \sqrt{\tfrac{MSE}{n}}
\]</span></p>
<p>Für die semihändische Berechnung des Tukey HSD Test brauchen wir erstmal die Werte für die gesamte Fallzahl in dem Datensatz <span class="math inline">\(N\)</span>, dann noch die Anzahl an Behandlungsgruppen <span class="math inline">\(k\)</span> und abschließend die Fallzahl pro Gruppe <span class="math inline">\(n\)</span>. Ich nutze hier dann den Datensatz <code>fac1_tbl</code> mit der Sprungweite von 21 Flöhen von drei Tierrassen mit jeweils sieben Beobachtungen pro Gruppe. Dann geben wir das Ganze einmal bei R ein.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">21</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">21</span> <span class="sc">/</span> <span class="dv">3</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die Funktion <code>qtukey()</code> gibt uns den q-Wert anhand des Signifikanzniveaus <span class="math inline">\(1 - \alpha\)</span> sowie der Anzahl an Gruppen <span class="math inline">\(k\)</span> und der dem Freiheitsgrad <span class="math inline">\(N-k\)</span> wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtukey</span>(<span class="at">p =</span> <span class="fl">0.95</span>, <span class="at">nmeans =</span> k, <span class="at">df =</span> N <span class="sc">-</span> k)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.609304</code></pre>
</div>
</div>
<p>Dann brauchen wir noch den Wert für die Streuung <span class="math inline">\(MSE\)</span>. Den MSE Wert könnten wir auch händisch berechnen, aber normalerweise nutzen wir auch die ANOVA um an den Wert zu gelangen. Daher hier einmal die ANOVA und wir lesen den Wert für MSE in der Ergebnistabelle ab.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
animal       2  74.68   37.34   11.89 0.000511 ***
Residuals   18  56.53    3.14                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Nun wissen wir den Wert für <span class="math inline">\(MSE\)</span> mit <span class="math inline">\(3.14\)</span> aus der Tabelle der einfaktoriellen ANOVA. Dann können wir auch schon den HSD Wert anhand der Formel berechnen in dem wir die Werte einsetzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>hsd <span class="ot">&lt;-</span> <span class="fl">3.61</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fl">3.14</span> <span class="sc">/</span> <span class="dv">7</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>hsd</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.417815</code></pre>
</div>
</div>
<p>Am Ende müssen wir dann die Mittelwertsdifferenzen unserer Tierarten mit dem HDS Wert vergleichen. Dafür ahbe ich einmal die folgende Tabelle aufgebaut. Wichtig ist hier, dass wir mit den Beträgen der Mittelwertsdifferenz rechnen, sonst macht der Vergleich zum HDS Wert keinen Sinn. Wir erhalten also zwei signifikante Vergleiche. Die Sprungweiten der Katzenflöhe unterscheiden sich von den Sprungweiten der Fuchs- und Hundeflöhe.</p>
<div id="tbl-hds-ttest-händisch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hds-ttest-händisch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.14— Händische Testentscheidung anhand des berechneten HDS Wert und den Mittelwertsdifferenzen der drei Tierarten. Wenn eine Mittelwertsdifferenz größer ist als der HDS Wert, dann liegt ein signifikanter Unterschied vor.
</figcaption>
<div aria-describedby="tbl-hds-ttest-händisch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Vergleich</th>
<th>Mittelwertsdifferenz</th>
<th>HDS Testentscheidung</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cat-dog</td>
<td><span class="math inline">\(4.74 - 8.13 = -3.39\)</span></td>
<td><span class="math inline">\(\mid-3.39\mid\; \geq 2.42 \rightarrow \mbox{signifikant}\)</span></td>
</tr>
<tr class="even">
<td>fox-dog</td>
<td><span class="math inline">\(9.16 - 8.13 = \phantom{-}1.03\)</span></td>
<td><span class="math inline">\(\mid1.03\mid\; \geq 2.42 \rightarrow \mbox{nicht signifikant}\)</span></td>
</tr>
<tr class="odd">
<td>fox-cat</td>
<td><span class="math inline">\(9.16 - 4.74 = \phantom{-}4.42\)</span></td>
<td><span class="math inline">\(\mid4.42\mid\; \geq 2.42 \rightarrow \mbox{signifikant}\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Am Ende willst du das natürlich nicht händische machen sondern wir nutzen die Funktionen in R um uns die Testentscheidung auch mit einem p-Wert berechnen zu lassen. Ganz wichtig hier nochmal, wir glauben daran, dass die Varianz in allen drei Tierarten gleich ist. Wir haben Varianzhomogenität vorliegen.</p>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<p>Die Standardfunktion für den Tukey HDS Test ist <code>TukeyHSD()</code>. Wir können den Tukey HSD Test mit nur einem Faktor oder zwei Faktoren rechnen. Ich stelle hier die einfaktorielle sowie zweifaktorielle Analyse einmal vor. Am Ende zeige ich dann nochmal, wie du das <em>Compact letter display</em> erhälst. Hier müssen wir noch ein zusätzliches Paket nutzen. Die Funktion <code>HSD.test()</code> aus dem Paket <code>{agricolae}</code>, die du im nächsten Tab findest, gibt dir sofort das <em>Compact letter display</em> wieder. Der Ablauf ist aber in beiden Fällen der gleiche. Wir rechnen erst eine ANOVA mit der Funktion <code>aov()</code> um dann den Tukey HSD Test zu rechnen.</p>
<section id="einfaktorielle-analyse-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorielle-analyse-1">Einfaktorielle Analyse</h4>
<p>Am Anfang rechnen wir erst eine einfaktorielle ANOVA mit der Funktion <code>aov()</code>. Wir erhalten dann alle notwendigen Informationen in dem Ausgabeobjekt für die Berechnung des Tukey HSD Test. Darüber hinaus können wir auch auch gleich schauen, ob unsere Behandlung überhaupt einen signifikanten Einfluss auf unser Outcome der Sprunglänge hat.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
animal       2  74.68   37.34   11.89 0.000511 ***
Residuals   18  56.53    3.14                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>An dem p-Wert sehen wir, dass wir einen signifikanten Effekt der Tierart <code>animal</code> auf die Sprunglänge der Flöhe vorliegen haben. Wir können jetzt einen Tukey HSD Test rechnen um rauszufinden welche der drei Tierarten sich unterscheiden. Wir erhalten dann als Ausgabe die Mittlwertsdifferenzen zusammen mit den 95% Konfidenzintervallen und den adjustierten p-Werten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(fac1_av)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = jump_length ~ animal, data = fac1_tbl)

$animal
             diff       lwr        upr     p adj
cat-dog -3.385714 -5.803246 -0.9681827 0.0058404
fox-dog  1.028571 -1.388960  3.4461031 0.5346652
fox-cat  4.414286  1.996754  6.8318173 0.0005441</code></pre>
</div>
</div>
<p>Du erhälst immer adjustierte p-Werte aus einem Tukey HSD Test. Das muss dir klar sein. Die p-Werte kannst du dann mit dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% vergleichen. Wir sehen dass sich die Sprungweiten der Katzenflöhe von den Sprungweiten der Fuchs- und Hundeflöhe signifikant unterscheiden.</p>
<p>Dann kannst du noch die Funktion <code>mulcompLetters()</code> aus dem R Paket <code>{mulcompView}</code> nutzen um dir das <em>Compact letter display</em> wiedergeben zu lassen. Das <em>Compact letter display</em> kannst du dann entsprechend zu deinen Barplots ergänzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">multcompLetters</span>(<span class="fu">extract_p</span>(tukey_fac1_obj<span class="sc">$</span>animal))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>cat fox dog 
"a" "b" "b" </code></pre>
</div>
</div>
<p>Auch hier sei angemerkt, dass du dan schauen muss, ob das <em>Compact letter display</em> zu deinen Daten passt. Sind die Mittelwerte wirklich unterschiedlich? Kannst du die Unterschiede in den Barplots erkennen? Wenn das der Fall ist, dann spricht nichts gegen die Verwendung des Tukey HSD Test.</p>
</section>
<section id="zweifaktorielle-analyse-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorielle-analyse-1">Zweifaktorielle Analyse</h4>
<p>Jetzt können wir die Sache etwas kürzer machen, da wir auch in einem zweifaktoriellen Fall den gleichen Weg wie im einfaktoriellen Fall durchgehen. Wir rechnen erst eine ANOVA mit den beiden Faktoren und dem Interaktionsterm, dargestellt durch den Doppelpunkt zwischen den beiden Faktoren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>fac2_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac2_av)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
animal       2 171.13   85.56  25.745 1.41e-08 ***
site         1   4.21    4.21   1.268  0.26516    
animal:site  2  59.10   29.55   8.891  0.00046 ***
Residuals   54 179.47    3.32                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>In diesem Fall finden wir eine signifikante Interaktion. Daher verhalten sich die Tierarten <code>animal</code> in den beiden Messorten in dem Faktor <code>site</code> nicht gleich. Die Interaktion kannst du auch in der Visualisierung der Daten in der weiter oben sehen. Für die Füchse ändert sich die Sprungweite von <code>city</code> zu <code>village</code>. Bei Hunden- und Katzenflöhen springen in der Tendenz Dorfflöhe weiter als Stadtflöhe. Wir nutzen jetzt das Modell einmal in der Funktion <code>TukeyHSD()</code> um uns einmal einen Tukey HSD Test berechnen zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>tukey_fac2_obj <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(fac2_av)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>tukey_fac2_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = jump_length ~ animal + site + animal:site, data = fac2_tbl)

$animal
          diff       lwr      upr     p adj
dog-cat 2.2085 0.8191476 3.597852 0.0009626
fox-cat 4.1335 2.7441476 5.522852 0.0000000
fox-dog 1.9250 0.5356476 3.314352 0.0042936

$site
              diff       lwr      upr     p adj
village-city -0.53 -1.473715 0.413715 0.2651614

$`animal:site`
                          diff        lwr        upr     p adj
dog:city-cat:city        3.101  0.6922358  5.5097642 0.0046806
fox:city-cat:city        6.538  4.1292358  8.9467642 0.0000000
cat:village-cat:city     1.668 -0.7407642  4.0767642 0.3308895
dog:village-cat:city     2.984  0.5752358  5.3927642 0.0072069
fox:village-cat:city     3.397  0.9882358  5.8057642 0.0015002
fox:city-dog:city        3.437  1.0282358  5.8457642 0.0012805
cat:village-dog:city    -1.433 -3.8417642  0.9757642 0.5010180
dog:village-dog:city    -0.117 -2.5257642  2.2917642 0.9999910
fox:village-dog:city     0.296 -2.1127642  2.7047642 0.9991270
cat:village-fox:city    -4.870 -7.2787642 -2.4612358 0.0000027
dog:village-fox:city    -3.554 -5.9627642 -1.1452358 0.0008014
fox:village-fox:city    -3.141 -5.5497642 -0.7322358 0.0040284
dog:village-cat:village  1.316 -1.0927642  3.7247642 0.5930304
fox:village-cat:village  1.729 -0.6797642  4.1377642 0.2923986
fox:village-dog:village  0.413 -1.9957642  2.8217642 0.9957142</code></pre>
</div>
</div>
<p>Wie du an der sehr langen Ausgabe sehen kannst, erhalten wir erstmal die Informationen zu der Tierart, dort sehen wir dann, dass sich alle drei Sprungweiten der Tierarten voneinander unterscheiden. Dann erhalten wir die Information über den Ort oder eben den zweiten Faktor. Am Ende nochmal sehr detailliert alle Interaktionen aufgeschlüsselt. Leider ist die Tabelle dann sehr schlecht zu lesen, aber hier siehst du dann welche Faktorkombination dann signifikant ist. Wenn du eine signifikante Interaktion vorliegen hast, dann kannst du keine <em>pauschale</em> Aussage über die Sprungweiten der Tierarten machen. Es kommt eben immer drauf an, welches Level du im zweiten Faktor betrachtest.</p>
<p>Am Ende wollen wir dann doch noch das <em>Compact letter display</em> haben. Ich wähle hier einmal die Gruppe der Tierarten aus. Du kannst das auch für die anderen Faktoren machen, aber hier einmal zur Demonstration. Wir sehen, dass sich alle Tierarten in der Sprungweite unterscheiden, keine Tierart hat den gleichen Buchstaben. Wenn du willst, kannst du dir natürlich auch andere Buchstaben rausziehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">multcompLetters</span>(<span class="fu">extract_p</span>(tukey_fac2_obj<span class="sc">$</span>animal))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>dog fox cat 
"a" "b" "c" </code></pre>
</div>
</div>
<p>Hier nochmal Achtung, die Interaktion wird natürlich nicht berücksichtigt. Im Zweifel dann doch lieber <code>{emmeans}</code> nutzen. Du findest die Anwendung im folgenden Tab. Allgemeine Aussagen zur Interaktion kann ich immer schwer treffen, es hängt sehr von der wissenschaftlichen Fragestellung und den Daten ab.</p>
</section>
</div>
<div id="tabset-14-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<p>Wir können auch den Tukey HSD Test mit <code>{emmeans}</code> rechnen, wenn wir nichts an der Standardeingabe ändern. Dann nutzen wir nämlich die Adjustierung nach Tukey und somit rechnen wir faktisch einen Tukey HSD Test. Im einfaktoriellen Fall sind die p-Werte dann auch identisch zu der Funktion <code>TukeyHSD()</code>. Das ist aber nur der Fall wenn wir wirklich gleiche Fallzahlen in den Gruppen haben und der Algorithmus von <code>{emmeans}</code> ist natürlich nicht <em>identisch</em> mit der Berechnung eines Tukey HSD Tests.</p>
<section id="einfaktorielle-analyse-2" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorielle-analyse-2">Einfaktorielle Analyse</h4>
<p>Auch hier brauchen wir erstmal das Modell für unseren Tukey HSD Test mit <code>{emmeans}</code>. Dafür nutze ich auch hier wieder die Funktion <code>aov()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
animal       2  74.68   37.34   11.89 0.000511 ***
Residuals   18  56.53    3.14                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Wenn du alle paarweisen Vergleiche rechnen willst, dann nutzt du die Funktion <code>emmeans()</code> und anschließend die Funktion <code>contrast()</code>, die dir dann alle paarweisen Vergleiche wiedergibt. In einem balancierten Design unter der Annahme von Varianzhomogenität kommt hier dann auch das gleiche wie bei dem Tukey HSD Test raus. Hier sind nur die Vorzeichen im Vergleich zum <code>TukeyHSD()</code> gedreht, da wir hier nicht <code>cat - dog</code> rechnen sondern alles einmal gedreht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="sc">|&gt;</span> </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast  estimate    SE df t.ratio p.value
 dog - cat     3.39 0.947 18   3.574  0.0058
 dog - fox    -1.03 0.947 18  -1.086  0.5347
 cat - fox    -4.41 0.947 18  -4.660  0.0005

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>Abschließend können wir uns dann auch noch das <em>Compact letter display</em> wiedergeben lassen. Auch hier haben wir dann das gleiche Ergebnis vorliegen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="sc">|&gt;</span> </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean   SE df lower.CL upper.CL .group
 cat      4.74 0.67 18     3.34     6.15  a    
 dog      8.13 0.67 18     6.72     9.54   b   
 fox      9.16 0.67 18     7.75    10.56   b   

Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</section>
<section id="zweifaktorielle-analyse-2" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorielle-analyse-2">Zweifaktorielle Analyse</h4>
<p>Im zweifaktoriellen Fall müssen wir wiederum erstmal die ANOVA rechnen um ein Modell vorliegen zu haben. Auf diesem Modell können wir dann die Funktionen von <code>{emmeans}</code> rechnen. Der Vorteil liegt es jetzt der flexibeln Auswertung der Interaktion <code>animal:site</code>. Mehr dazu dann im obigen Abschnitt zu <code>{emmeans}</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>fac2_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac2_av)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
animal       2 171.13   85.56  25.745 1.41e-08 ***
site         1   4.21    4.21   1.268  0.26516    
animal:site  2  59.10   29.55   8.891  0.00046 ***
Residuals   54 179.47    3.32                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Hier rechne ich jetzt eine kombinierte Analyse für die beiden Faktoren <code>animal</code> und <code>site</code>. Wenn du die Analysen getrennt rechnen möchtest dann ersetze den Stern <code>*</code> durch einen Strich <code>|</code>. Mehr dazu ebenfalls weiter oben im Abschnitt zu <code>{emmeans}</code>. Im Weiteren rechne ich dann alle paarweisen Vergleiche und zwar zwischen allen Faktorkombinationen. Dann möchte ich mir das Ergebnis noch kompakt wiedergeben lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>fac2_av <span class="sc">|&gt;</span> </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">*</span> site) <span class="sc">|&gt;</span> </span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">simple =</span> <span class="st">"each"</span>, <span class="at">combine =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> site    animal contrast       estimate    SE df t.ratio p.value
 city    .      cat - dog        -3.101 0.815 54  -3.804  0.0033
 city    .      cat - fox        -6.538 0.815 54  -8.019  &lt;.0001
 city    .      dog - fox        -3.437 0.815 54  -4.216  0.0009
 village .      cat - dog        -1.316 0.815 54  -1.614  1.0000
 village .      cat - fox        -1.729 0.815 54  -2.121  0.3470
 village .      dog - fox        -0.413 0.815 54  -0.507  1.0000
 .       cat    city - village   -1.668 0.815 54  -2.046  0.4109
 .       dog    city - village    0.117 0.815 54   0.144  1.0000
 .       fox    city - village    3.141 0.815 54   3.853  0.0028

P value adjustment: bonferroni method for 9 tests </code></pre>
</div>
</div>
<p>Ich kann mir dann auch über alle Faktorkombinationen das <em>Compact letter display</em> wiedergeben lassen. Hier ist jetzt der Vorteil, dass ich wirklich die Buchstaben für jeden Messort <code>site</code> und die jeweilige Tierrasse <code>animal</code> habe.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>fac2_av <span class="sc">|&gt;</span> </span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">*</span> site) <span class="sc">|&gt;</span> </span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(<span class="at">Letters =</span> letters)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal site    emmean    SE df lower.CL upper.CL .group
 cat    city      13.6 0.576 54     12.4     14.7  a    
 cat    village   15.2 0.576 54     14.1     16.4  ab   
 dog    village   16.6 0.576 54     15.4     17.7   b   
 dog    city      16.7 0.576 54     15.5     17.8   b   
 fox    village   17.0 0.576 54     15.8     18.1   b   
 fox    city      20.1 0.576 54     19.0     21.3    c  

Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 6 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Beachte, dass über die gleiche Varianz angenommen wird. das kann sein, dass es nicht passt und daher schaue dir dann einmal oben <code>{emmeans}</code> mit Varianzheterogenität an.</p>
</section>
</div>
<div id="tabset-14-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-5-tab">
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Funktion <code>HSD.test()</code> kann nur ein einfaktorielles Modell rechnen und <em>ignoriert</em> weitere Faktoren oder Interaktionsterme im <code>aov()</code> Modell. Du erhälst zwar immer eine Ausgabe, aber nur als einfaktorielle Analyse. Unabhängig von dem Modell was du in die Funktion <code>HSD.test()</code> reinsteckst! Und ohne weitere Warnung.</p>
</div>
</div>
<p>Eine zweite Variante den Tukey HSD Test in R durchzuführen ist die Funktion <code>HSD.test()</code> aus dem R Paket <code>{agricolae}</code>. Persönlich entwickle ich so langsam eine Aversion gegen das Paket, da ich selten eine so rundimentäre und lustlose Hilfe für die Funktion gesehen habe wie in <code>{agricolae}</code>. Prinzipiell haben wir die gleichen Möglichkeiten wie auch mit dem Tukey HSD Test für ein einfaktorielles Versuchsdesign. Wir nutzen auch erste eine ANOVA um uns alle wichtigen statistischen Maßzahlen berechnen zu lassen und dann können wir mit denen den Tukey HSD Test durchführen. Leider erhalten wir <em>keine</em> p-Werte. Was auch irgendwie irre ist. Dafür dann aber das <em>Compact letter display</em> ohne einen weiteren Schritt.</p>
<section id="einfaktorielle-analyse-3" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorielle-analyse-3">Einfaktorielle Analyse</h4>
<p>Am Anfang rechnen wir auch hier eine einfaktorielle ANOVA mit der Funktion <code>aov()</code>. Wir erhalten dann alle notwendigen Informationen in dem Ausgabeobjekt für die Berechnung des Tukey HSD Test. Darüber hinaus können wir auch auch gleich schauen, ob unsere Behandlung überhaupt einen signifikanten Einfluss auf unser Outcome der Sprunglänge hat.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
animal       2  74.68   37.34   11.89 0.000511 ***
Residuals   18  56.53    3.14                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>An dem p-Wert sehen wir, dass wir einen signifikanten Effekt der Tierart <code>animal</code> auf die Sprunglänge der Flöhe vorliegen haben. Wir können jetzt einen Tukey HSD Test rechnen um rauszufinden welche der drei Tierarten sich unterscheiden. Wir erhalten dann als Ausgabe die Mittelwerte ohne p-Werte und müssten uns sogar die Mittelwertsdifferenzen selber berechnen. Keine Ahnung was das soll. Dafür dann aber das <em>Compact letter display</em>, was ja auch irgendwie reicht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(fac1_av, <span class="at">trt =</span> <span class="st">'animal'</span>)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
   MSerror Df     Mean       CV      MSD
  3.140476 18 7.342857 24.13419 2.417532

$parameters
   test name.t ntr StudentizedRange alpha
  Tukey animal   3         3.609304  0.05

$means
    jump_length      std r        se Min  Max  Q25 Q50   Q75
cat    4.742857 1.901628 7 0.6698055 2.2  7.9 3.65 4.3  5.75
dog    8.128571 2.144539 7 0.6698055 5.6 11.8 6.65 8.2  9.00
fox    9.157143 1.098267 7 0.6698055 7.7 10.6 8.35 9.1 10.00

$comparison
NULL

$groups
    jump_length groups
fox    9.157143      a
dog    8.128571      a
cat    4.742857      b

attr(,"class")
[1] "group"</code></pre>
</div>
</div>
<p>Wenn du keinen p-Werte haben möchtest sondern nur das <em>Compact letter display</em>, dann macht es dir die Funktion <code>HSD.test()</code> etwas leichter. Dann brauchst du dir nicht nochmal eine Funktion zusätzlich laden. Wenn du p-Werte brauchst, dann stehst du hier im Regen. Dann nutze bitte die Funktion <code>TukesHSD()</code> im vorherigen Tab.</p>
</section>
<section id="zweifaktorielle-analyse-3" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorielle-analyse-3">Zweifaktorielle Analyse</h4>
<p>Eine zweifaktorielle Analyse ist in der Funktion <code>HSD.test()</code> nicht möglich. Ein zweifaktorielles Modell wird wie ein einfaktorielles Modell behandelt und damit der zweite Faktor sowie der Interaktionsterm von der Funktion <code>HSD.test()</code> ignoriert. Du erhälst keine Warnung sondern eben das Ergebnis einer einfaktoriellen Analyse wiedergeben. Ich bin immer noch sprachlos was das soll.</p>
</section>
</div>
</div>
</div>
</section>
<section id="weitere-pfade" class="level2" data-number="42.8">
<h2 data-number="42.8" class="anchored" data-anchor-id="weitere-pfade"><span class="header-section-number">42.8</span> Weitere Pfade</h2>
<section id="paarweise-tests" class="level3" data-number="42.8.1">
<h3 data-number="42.8.1" class="anchored" data-anchor-id="paarweise-tests"><span class="header-section-number">42.8.1</span> Paarweise Tests</h3>
<p>Wenn du nur eine einfaktorielle Analyse rechnen willst, dann kann man natürlich auch die einfachste aller Arten als Post-hoc Test rechnen. Du rechnest nämlich alle paarweisen Vergleiche mit einem t-Test oder aber mit einem Wilxonon Test. Da du dann natürlich sehr viele Tests rechnen müsstest, gibt es auch eine Funktion in R, die das für dich übernimmt. Die Funktion <code>pairwise.*.test()</code> kann nämlich verschiedene Gruppentests einmal automatisieren über alle möglichen Vergleiche.</p>
<p>Die Funktionen <code>pairwise.*.test()</code> sind etwas älter und deshalb etwas sperrig zu nutzen. Du gibt hier kein Modell an sondern musst erst das <span class="math inline">\(y\)</span> als einen Vektor und dann die Gruppenvariable <span class="math inline">\(x\)</span> als einen Vektor der Funktion übergeben. Dann entscheidest du dich noch für die Methode der Adjustierung der p-Werte und ob du Vrainzheterogenität vorliegen hast. Ich habe mich mit der Option <code>pool.sd = FALSE</code> für Varianzheterogenität und damit gegen Varianzhomogenität entschieden. Die Annahme ist hier, dass unser Outcome <span class="math inline">\(y\)</span> näherungsweise normalverteilt ist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">pool.sd =</span> <span class="cn">FALSE</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with non-pooled SD 

data:  fac1_tbl$jump_length and fac1_tbl$animal 

    dog    cat   
cat 0.0267 -     
fox 0.8642 0.0012

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<p>Wenn du dir bei deinem <span class="math inline">\(y\)</span> nicht so sicher bist, was die Normalverteilung angeht, dann kannst du auch einen paarweisen Wilcoxon Test rechnen. Dafür bietet sich die folgende Funktion an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum exact test 

data:  fac1_tbl$jump_length and fac1_tbl$animal 

    dog    cat   
cat 0.0332 -     
fox 0.8307 0.0035

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<p>Am Ende kannst du dir dann auch mit folgendem Code das <em>Compact letter display</em> wiedergeben lassen. Wegen der etwas sperrigen Struktur der Ausgabe der Funktion <code>pairwise.*.test()</code> müssen wir hier etwas mehr arbeiten um an das <em>Compact letter display</em> zu kommen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract2</span>(<span class="st">"p.value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fullPTable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>dog cat fox 
"a" "b" "a" </code></pre>
</div>
</div>
<p>Am Ende bieten beide Funktionen einen schnellen Weg ein einfaktorielles Design auszuwerten. Ja, es ist etwas ruppig und am Ende vermutlich auch nicht so schön, aber für eine Abschlussarbeit mit Fokus jenseits der statistischen Auswertung mag es Sinn machen.</p>
</section>
<section id="games-howell-test" class="level3" data-number="42.8.2">
<h3 data-number="42.8.2" class="anchored" data-anchor-id="games-howell-test"><span class="header-section-number">42.8.2</span> Games Howell Test</h3>
<p>Der Games Howell Test ist eine Alternative zu dem Paket <code>{multcomp}</code> und dem Paket <code>{emmeans}</code> für ein einfaktorielles Design. Wir können auch ein zweifakorielles Design rechnen, dann würden wir aber die Analyse <em>getrennt</em> für den zweiten Faktor durchführen. Gemeinsam geht dann nur in <code>{emmeans}</code>. Wir nutzen den Games Howell Test, wenn die Annahme der Homogenität der Varianzen, der zum Vergleich aller möglichen Kombinationen von Gruppenunterschieden verwendet wird, verletzt ist. Dieser Post-Hoc-Test liefert Konfidenzintervalle für die Unterschiede zwischen den Gruppenmitteln und zeigt, ob die Unterschiede statistisch signifikant sind. Der Test basiert auf der Welch’schen Freiheitsgradkorrektur und adjustiert die <span class="math inline">\(p\)</span>-Werte. Der Test vergleicht also die Differenz zwischen den einzelnen Mittelwertpaaren mit einer Adjustierung für den Mehrfachtest. Es besteht also keine Notwendigkeit, zusätzliche p-Wert-Korrekturen vorzunehmen.</p>
<dl>
<dt>Varianzheterogenität</dt>
<dd>
<p>Es ist wichtig zu wissen, dass der Games Howell Test faktisch das Äquivalent zum Welch t-Test ist und daher Varianzheterogenität annimmt. Du kannst den Games Howell Test nicht unter der Annahme von Varianzhomogenität rechnen. Das wäre dann der Tukey HSD Test, der ja auf der ANOVA basiert und die ANOVA Varianzhomogenität annimmt. Prinzipiell kann es dir dann passieren, das die Ergebnisse eines Games Howell Test nicht mehr mit denen einer vorgeschalteten ANOVA zusammenpassen.</p>
</dd>
<dt>Adjustierung für multiple Vergleiche</dt>
<dd>
<p>Der Games Howell Test adjustiert für die <span class="math inline">\(\alpha\)</span>-Inflation bei multiplen Vergleichen. Wir müssen da auch nichts weiter machen um die Adjustierung durchzuführen. Auf der anderen Seite können wir die Adjustierung für multiple Vergleiche aber auch nicht ausschalten. Du erhälst <em>immer</em> adjustierte p-Werte aus einem Games Howell Test. Wenn du das nicht möchtest, dann nutze einfach das R Paket <code>{emmeans}</code>.</p>
</dd>
<dt>Mögliche multiple Vergleiche</dt>
<dd>
<p>Wir können immer nur alle Gruppen mit allen anderen Gruppen vergleichen. Wir rechnen also einen <em>all pair</em> Vergleich. Wenn du zum Beispiel nur die Behandlungsgruppen zur Kontrolle vergleichen willst, aber nicht untereinander, dann ist das nicht mit dem Games Howell Test möglich. Dafür musst du dann das R Paket <code>{ememans}</code> oder für noch komplexere Gruppenvergleiche das R Paket <code>{multcomp}</code> nutzen.</p>
</dd>
</dl>
<p>Für den Games Howell Test aus dem Paket <code>{rstatix}</code> müssen wir kein lineares Modell fitten. Wir schreiben einfach die wie in einem t-Test das Outcome und den Faktor mit den Gruppenleveln in die Funktion <code>games_howell_test()</code>. Es gibt sehr wenige Implemtierungen des Games Howell Test, da er nicht so weit genutzt wird. Häufig will man dann doch eine ANOVA rechnen und dann den Tukey HSD Test anschließen. Wenn der Games Howell Test passt, dann passt ja meist eine ANOVA mit der Annahme von Varianzhomogenität nicht. Ein Problem mit der Fallzahl bleibt aber, so dass wir mindestens sechs Beobachtungen haben.</p>
<blockquote class="blockquote">
<p>“However, the smaller the number of samples in each group, the [Games Howell Post-hoc Tests] is more tolerant to the type I error control. Thus, this method can be applied when the number of samples is six or more.” — <a href="https://rpkgs.datanovia.com/rstatix/reference/games_howell_test.html">Games Howell Post-hoc Tests in <code>{rstatix}</code></a></p>
</blockquote>
<p>Ich zeige jetzt einmal wie wir die einfaktorielle und dann die zweifaktorielle Analyse eines Games Howell Test in R rechnen. Ich habe mich hier gegen die händisch Berechnung entschieden, da wir hier dann sehr viel rechnen müssen, was eigentlich dann der Welch t-Test ist. Wenn dich die Formeln nochmal gesondert interessieren dann findest du die im Tutorium <a href="https://rpubs.com/aaronsc32/Games%20Howell%20Test">Games-Howell Post-Hoc Test</a>. Hier lasse ich dann gleich ganz bewusst eine ANOVA weg und starte gleich mit dem paarweisen Vergleich.</p>
<section id="einfaktorielle-analyse-4" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorielle-analyse-4">Einfaktorielle Analyse</h4>
<p>Wenn wir den Games Howell Test rechnen wollen dann nutzen wir die Funktion <code>games_howell_test()</code> aus dem R Paket <code>{rstatix}</code>. Die Funktion benötigt kein ANOVA Modell, was ja wenig Sinn machen würde. Wir bräuchten für die ANOVA homogene Varianzen und der Games Howell Test ist ja direkt für heterogene Varianzen entwickelt worden. Daher verzichten wir auch <em>grundsätzlich</em> auf eine vorgestellte ANOVA, wenn wir einen Games Howell Test rechnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>ght_fac1_obj <span class="ot">&lt;-</span> <span class="fu">games_howell_test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Mit dem Objekt des Games Howell Test können wir uns dann die statistischen Maßzahlen wiedergeben lassen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">p-Werte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false"><em>Compact letter display</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">95% Konfidenzintervall</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<p>Die p-Werte finden sich dann direkt in dem Objekt der Ausgabe der Funktion <code>games_howell_test()</code>. Da müssen wir nicht viel machen. Ich habe hier nochmal die p-Werte mit der Funktion <code>pvalue()</code> einmal etwas angepasst. Das musst du natürlich nicht machen. Du erhälst <em>immer</em> adjustierte p-Werte. Die Adjustierung für multiple Vergleiche lässt sich nicht ausschalten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>ght_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">pvalue</span>(p.adj))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 8
  .y.         group1 group2 estimate conf.low conf.high p.adj p.adj.signif
  &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       
1 jump_length dog    cat       -3.39    -6.28    -0.490 0.022 *           
2 jump_length dog    fox        1.03    -1.52     3.57  0.521 ns          
3 jump_length cat    fox        4.41     2.12     6.71  0.001 ***         </code></pre>
</div>
</div>
<p>Das Ergebnis ähnelt dem Tukey HSD Test. Nur wenn wir wirklich starke heterogene Varianzen vorliegen haben, werden wir wirklich einen Unterschied zwischen den Tests sehen. Häufig sind sich der Tukey HSD Test und der Games Howell Test ähnlich in den Ergebnissen.</p>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<p>Für das <em>Compact letter display</em> aus dem Games Howell Test müssen wir uns einmal etwas strecken, da wir erst die Kontraste bauen müssen, die die Funktion <code>multcompLetters()</code> braucht. Sonst ist der Rest dann relativ einfach.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>ght_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2)) <span class="sc">|&gt;</span> </span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p.adj, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>dog cat fox 
"a" "b" "a" </code></pre>
</div>
</div>
<p>Auch hier sehen wir ähnliche Ergebnisse. Was uns aber auch nicht so überrascht. Wenn die Varianzen eher homogen sind, dann macht der Games Howell Test keinen großen Unterschied zum Tukey HSD Test.</p>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<p>In der folgenden Abbildung sind die simultanen 95% Konfidenzintervalle nochmal in einem <code>ggplot</code> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab. Auch hier müssen wir uns erst die Vergleiche zusammenkleben, damit die Konfidenzintervalle richtig darstellbar sind.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>ght_fac1_ci_obj <span class="ot">&lt;-</span> ght_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir aber auch schon die 95% Konfidenzintervalle einmal darstellen. Da wir hier Mittelwerte vergleichen, ist die die Signifikanzschwelle die Null. Wenn die Null mit im Konfidenzintervall enthalten ist können wir die Nullhypothese nicht ablehnen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ght_fac1_ci_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high)) <span class="sc">+</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ght-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ght-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ght-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Abbildung&nbsp;42.31— Die 95% Konfidenzintervalle für den allpair-Vergleich des Games Howell Test."><img src="stat-tests-posthoc2_files/figure-html/fig-ght-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ght-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.31— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des Games Howell Test.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Entscheidungen nach den 95% Konfidenzintervallen sind die gleichen wie nach dem <span class="math inline">\(p\)</span>-Wert. Ob du die Konfidenzintervalle brauchst, hängt dann von deiner Fragestellung in deiner Abschlussarbeit ab.</p>
</div>
</div>
</div>
</section>
<section id="zweifaktorielle-analyse-4" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorielle-analyse-4">Zweifaktorielle Analyse</h4>
<p>Die Funktion <code>games_howell_test()</code> aus dem R Paket <code>{rstatix}</code> kann keinen zweifaktoriellen Vergleich über die Faktoren des zweiten Faktors rechnen. Wenn du das möchtest, dann nutze bitte das R Paket <code>{emmeans}</code>. Wir rechnen hier eine einfaktorielle Analyse <em>getrennt</em> für jedes Level des zweiten Faktors. In unserem konkreten Fall rechnen wir also eine einfaktorielle Analyse für den Vergleich der Tierrassen einmal für das Level <code>city</code> und einmal für das Level <code>village</code> für den Faktor <code>site</code>. Wir erhalten dann jeweils die getrennten p-Werte sowie <em>Compact letter display</em> und Konfidenzintervalle. Dazu nutzen wir die Funktion <code>group_by()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>ght_fac2_obj <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site) <span class="sc">|&gt;</span> </span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">games_howell_test</span>(jump_length <span class="sc">~</span> animal) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dan können wir uns auch schon wie in dem einfaktorielle Fall die statistischen Maßzahlen wiedergeben lassen. Die p-Werte sind hier nicht so das Problem, etwas frickeliger wird es dann bei dem <em>Compact letter display</em>. Hier kann ich dann nur raten gleich <code>{emmeans}</code> zu nutzen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">p-Werte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false"><em>Compact letter display</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false">95% Konfidenzintervall</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<p>Die adjustierten p-Werte lassen sich dann direkt aus dem Objekt der Funktion wiedergeben. Hier mache ich mir noch die Freude einmal die p-Werte etwas anders darzustellen, dass musst du aber nicht unbedingt machen. Wie immer erhalten wir <em>nur</em> adjustierte p-Werte, wir können die Adjustierung nicht ausstellen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>ght_fac2_obj <span class="sc">|&gt;</span> </span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">pvalue</span>(p.adj))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  site    .y.       group1 group2 estimate conf.low conf.high p.adj p.adj.signif
  &lt;fct&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       
1 city    jump_len… cat    dog       3.10     0.725      5.48 0.010 **          
2 city    jump_len… cat    fox       6.54     4.73       8.35 &lt;0.0… ****        
3 city    jump_len… dog    fox       3.44     1.33       5.55 0.002 **          
4 village jump_len… cat    dog       1.32    -0.882      3.51 0.290 ns          
5 village jump_len… cat    fox       1.73    -0.645      4.10 0.178 ns          
6 village jump_len… dog    fox       0.413   -1.31       2.14 0.813 ns          </code></pre>
</div>
</div>
<p>Das etwas nervige ist jetzt, dass wir die p-Werte eben getrennt vorliegen haben. Wir können also nicht Tierrassen aus der Stadt mit den Ergebnissen der Tierrassen aus dem Dorf vergleichen. Dafür wurde übriegens auch nicht adjustiert. Die Adjustierung ist auch nur getrennt für die Level des zweiten Faktors. Am Ende doch etwas unbefriedigend.</p>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<p>Für das <em>Compact letter display</em> müssen wir uns ganz schön strecken. Das hat damit zu tun, dass wir eben die Analyse getrennt für den zweiten Faktor durchführen und daher auch das <em>Comapct letter display</em> getrennt für den zweiten Faktor bauen müssen. Daher nutze ich hier die Funktion <code>map()</code> um hier etwas fortgeschrittener zu programmieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>ght_fac2_obj <span class="sc">|&gt;</span> </span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2)) <span class="sc">|&gt;</span> </span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(<span class="sc">~</span> site) <span class="sc">|&gt;</span> </span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(pull, p.adj, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span><span class="fu">multcompLetters</span>(.x)<span class="sc">$</span>Letters) <span class="sc">|&gt;</span> </span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"site"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  site    cat   dog   fox  
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 city    a     b     c    
2 village a     a     a    </code></pre>
</div>
</div>
<p>Wir immer, dass muss nicht so kompliziert mit allen Nachteilen der getrennten Auswertung sein. Das R Paket <code>{emmeans}</code> kann es schneller, einfacher und noch besser. Daher ist das hier eher eine Demonstration als eine Empfehlung.</p>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<p>In der folgenden Abbildung sind die simultanen 95% Konfidenzintervalle nochmal in einem <code>ggplot</code> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab. Auch hier müssen wir uns erst die Vergleiche zusammenkleben, damit die Konfidenzintervalle richtig darstellbar sind.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>ght_fac2_ci_obj <span class="ot">&lt;-</span> ght_fac2_obj <span class="sc">|&gt;</span> </span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Eigentlich ist es für die Konfidenzintervalle etwas einfacher, nur haben wir hier auch das Problem, dass eigentlich nur das Signifikanzniveau <span class="math inline">\(\alpha\)</span> für jedes Level des zweiten Faktors eingehalten wird. Deshalb eine in sich schwer zu interpretierende Abbildung.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ght_fac2_ci_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high,</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> site, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ght-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ght-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ght-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32" title="Abbildung&nbsp;42.32— Die 95% Konfidenzintervalle für den allpair-Vergleich des Games Howell Test."><img src="stat-tests-posthoc2_files/figure-html/fig-ght-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ght-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.32— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des Games Howell Test.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Entscheidungen nach den 95% Konfidenzintervallen sind die gleichen wie nach dem <span class="math inline">\(p\)</span>-Wert. Da wir hier es mit einem Mittelwertsvergleich zu tun haben, ist die Entscheidung gegen die Nullhypothese zu treffen wenn die 0 im Konfidenzintervall ist. Abgesehen von der etwas wirren Adjustierung durch die getrennte Analyse.</p>
</div>
</div>
</div>
</section>
</section>
<section id="r-paket-multcomp" class="level3" data-number="42.8.3">
<h3 data-number="42.8.3" class="anchored" data-anchor-id="r-paket-multcomp"><span class="header-section-number">42.8.3</span> R Paket <code>{multcomp}</code></h3>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Das Paket <code>{multcomp}</code> kann beliebige faktorielle Modelle berechnen. Das einfaktorielle Modell ist hierbei relativ einfach durchzuführen und die Stärke liegt hier auch in der Flexibiltät der möglichen Vergleiche oder auch <em>Kontrast</em> genannt. Wenn du ein zweifaktorielles Modell vorliegen hast, geht es auch mit <code>{multcomp}</code>, <em>aber</em> hier musst du dann mehr selber machen damit es gut wird. Das Paket <code>{emmeans}</code> ist hier besser in der Bedienung.</p>
</div>
</div>
<p>Der große Vorteil von <code>{multcomp}</code> liegt in der möglichen Auswahl an komplexen Mittelwertsvergleichen oder auch Mittelwertskontrasten. Das Wort <em>Kontrast</em> steht hier für die Art und Weise wie wir verschiedene Mittelwerte miteinander vergleichen wollen. Daher ist der Fokus auch eher auf der einfaktoriellen als auf der mehrfaktoriellen Analyse. Die Fokus des Paketes liegt daher auch auf der Erstellung der 95% Konfidenzintervalle und deren Darstellung. Wenn dich die 95% Konfidenzintervalle nicht primär interessieren und du auch eigentlich nur einen <em>all-pair</em> Vergleich rechnen willst, dann ist das R Paket <code>{emmeans}</code> auch wieder die einfachere Variante für dich.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exkurs: Was ist ein Kontrast?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ein Kontrast teilt uns mit, welche Mittelwert von welchem anderem Mittelwert abgezogen werden soll. Oder eben, welche Gruppen miteinander vergleichen werden sollen. Nehmen wir einmal an, wir wollen die Sprungweite der Hundeflöhe mit der Sprungweite der Katzenflöhe vergleichen. Dazu berechnen wir dann die beiden Mittelwerte der jeweiligen Sprungweiten. Wenn wir uns nun einen Kontrast bauen, sagen wir nichts anders aus, welcher Mittelwert von welchen Mittelwert abgezogen werden soll. Im Folgenden mal ein beispielhafter Kontrast <span class="math inline">\(cat-dog\)</span> für den Mittelwertsvergleich <span class="math inline">\(\bar{y}_{cat} - \bar{y}_{dog}\)</span>.</p>
<p><span class="math display">\[
\matrix{
~         &amp; cat &amp; dog  \\
cat - dog &amp; 1   &amp; -1  }
\]</span> Wir setzen den Hund auf <span class="math inline">\(-1\)</span> und die Katze auf <span class="math inline">\(1\)</span>, da wir den Mittelwert der Hunde vom Mittelwert der Katzen abziehen wollen. Jetzt sieht das erstmal von kompliziert aus wird aber praktisch, wenn wir noch den Fuchs mit dazunehmen.</p>
<p><span class="math display">\[
\matrix{
~         &amp; cat &amp; dog &amp; fox \\
cat - dog &amp; 1   &amp; -1   &amp; 0 \\
fox - dog &amp; 0   &amp; -1   &amp; 1 \\
fox - cat &amp; -1   &amp; 0  &amp;  1 }
\]</span></p>
<p>Jetzt können wir nämlich den <em>all-pair</em> Vergleich durch eine Matrix abbilden. Wenn ein Mittelwert nicht in den Vergleich soll, dann erhält die Gruppe eine <span class="math inline">\(0\)</span>. Die zu vergleichenden Gruppen erhalten vereinfacht erstmal eine <span class="math inline">\(1\)</span> oder <span class="math inline">\(-1\)</span>. Diesen <em>all-pair</em> Vergleich nennen wir auch gerne Tukey Kontrast genannt. Leider hat Tukey hier nichts mit dem Tukey HSD Test zu tun.</p>
<p>Ein weiterer oft genutzter Kontrast ist der <em>many-to-one</em> Kontrast oder auch Dunnett Kontrast genannt. Hier vergleichen wir alle Gruppen zu einer Gruppe. Meistens alle Gruppen zu einer Kontrolle.</p>
<p><span class="math display">\[
\matrix{
~         &amp; cat &amp; dog &amp; fox \\
cat - dog &amp; -1   &amp; 1   &amp; 0 \\
cat - fox &amp; -1   &amp; 0   &amp; 1  }
\]</span></p>
<p>Der eigentliche Witz des Kontrasttest ist jetzt, dass wir nicht nur <span class="math inline">\(-1\)</span> oder <span class="math inline">\(1\)</span> eintragen können. Zwar muss die Summe der Werte für einen Kontrast Null sein, wir können aber auch andere Zahlen eintragen. So zum Beispiel <span class="math inline">\(0.5\)</span> und <span class="math inline">\(0.5\)</span> für zwei Gruppen. Dann vergleichen wir die gemittelten Mittelwerte zweier Gruppen mit einer anderen Gruppe.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">Dunnett</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">Changepoint</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false">AVE</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<p>Der Dunnett Kontrast vergleicht einen Mittwelwert gegen die Mittelwerte der anderen Gruppen. Dabei muss dann eine Gruppe als Kontrolle mit der Option <code>base</code> gewählt werden. Ich habe mich hier für die zweite Gruppe entschieden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrMat</span>(<span class="at">n =</span> <span class="fu">c</span>(<span class="at">cat =</span> <span class="dv">5</span>, <span class="at">dog =</span> <span class="dv">5</span>, <span class="at">fox =</span> <span class="dv">5</span>, <span class="at">cow =</span> <span class="dv">5</span>, <span class="at">ape =</span> <span class="dv">5</span>, <span class="at">bee =</span> <span class="dv">5</span>), </span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"Changepoint"</span>), <span class="at">base =</span> <span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Multiple Comparisons of Means: Changepoint Contrasts

        cat     dog     fox     cow     ape    bee
C 1 -1.0000  0.2000  0.2000  0.2000  0.2000 0.2000
C 2 -0.5000 -0.5000  0.2500  0.2500  0.2500 0.2500
C 3 -0.3333 -0.3333 -0.3333  0.3333  0.3333 0.3333
C 4 -0.2500 -0.2500 -0.2500 -0.2500  0.5000 0.5000
C 5 -0.2000 -0.2000 -0.2000 -0.2000 -0.2000 1.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<p>Der Changepoint Kontrast vergleicht ein laufendes Mittel. So wird erst der erste Mittelwert der ersten Gruppe gegen die gemittelten Mittelwerte der restlichen Gruppen verglichen. Dann werden die ersten beiden Gruppen gegen den Rest vergleichen. Das machen wir dann so lange, bis wir den letzten Mittelwert gegen das Mittel der vorherigen Gruppen vergleichen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrMat</span>(<span class="at">n =</span> <span class="fu">c</span>(<span class="at">cat =</span> <span class="dv">5</span>, <span class="at">dog =</span> <span class="dv">5</span>, <span class="at">fox =</span> <span class="dv">5</span>, <span class="at">cow =</span> <span class="dv">5</span>, <span class="at">ape =</span> <span class="dv">5</span>, <span class="at">bee =</span> <span class="dv">5</span>), </span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"Changepoint"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Multiple Comparisons of Means: Changepoint Contrasts

        cat     dog     fox     cow     ape    bee
C 1 -1.0000  0.2000  0.2000  0.2000  0.2000 0.2000
C 2 -0.5000 -0.5000  0.2500  0.2500  0.2500 0.2500
C 3 -0.3333 -0.3333 -0.3333  0.3333  0.3333 0.3333
C 4 -0.2500 -0.2500 -0.2500 -0.2500  0.5000 0.5000
C 5 -0.2000 -0.2000 -0.2000 -0.2000 -0.2000 1.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<p>Als letztes Beispiel noch den AVE Kontrast oder auch <em>Average</em> Kontrast. Hier wird dann jeder Mittelwert gegen das Mittel der anderen Gruppen verglichen. Das ist jetzt nicht der Anwendungsfall, den du immer mal brauchen wirst, aber manchmal gut zu wissen, dass es geht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrMat</span>(<span class="at">n =</span> <span class="fu">c</span>(<span class="at">cat =</span> <span class="dv">5</span>, <span class="at">dog =</span> <span class="dv">5</span>, <span class="at">fox =</span> <span class="dv">5</span>, <span class="at">cow =</span> <span class="dv">5</span>, <span class="at">ape =</span> <span class="dv">5</span>, <span class="at">bee =</span> <span class="dv">5</span>), </span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"AVE"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Multiple Comparisons of Means: AVE Contrasts

     cat  dog  fox  cow  ape  bee
C 1  1.0 -0.2 -0.2 -0.2 -0.2 -0.2
C 2 -0.2  1.0 -0.2 -0.2 -0.2 -0.2
C 3 -0.2 -0.2  1.0 -0.2 -0.2 -0.2
C 4 -0.2 -0.2 -0.2  1.0 -0.2 -0.2
C 5 -0.2 -0.2 -0.2 -0.2  1.0 -0.2
C 6 -0.2 -0.2 -0.2 -0.2 -0.2  1.0</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="einfaktorielle-analyse-5" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorielle-analyse-5">Einfaktorielle Analyse</h4>
<p>Im Zentrum von <code>{multcomp}</code> steht die einfaktorielle Analyse. Das muss dir zuerst bewusst sein. Ja, es gehen auch mehrere Faktoren oder ein komplexeres Modell, aber dann wird es mit den Kontrasten schwieriger, was ja wiederum die Stärke von <code>{multcomp}</code> ist. Du kannst ein belibiges Modell berechnen und dieses dann als Grundlage für die zentrale Funktion <code>glht()</code> in <code>{multcomp}</code> nutzen. Ich rechne hier einmal ein lineares Modell um die Sprunglängen der Hunde- und Katzenflöhe miteinander zu vergleichen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt kommt der etwas sperrige Aufruf der Funktion <code>glht()</code> um den multiplen Vergleich zu rechnen. Warum ist der Aufruf so sperrig? Zum einen müssen wir erst das Modell angeben, was wir nutzen wollen. Dann brauchen wir aber noch die Variable, die wir dann mit einem Kontrast vergleichen wollen. Das Ganze spezifizieren wir dann in der Option <code>linfct</code>. Du musst dann bei dir im Prinzip nur <code>animal</code> gegen deinen Variablennamen austauschen.</p>
<p>Wir können auch hier für eine mögliche Varianzheterogenität anpassen und entsprechend eine Varianzschätzer mit der Option <code>vcov.</code> wählen. Ich habe hier den Standard gewählt. Am Ende dieses Kapitels kannst du dann nochmal über andere Varianzschätzer lesen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>multcomp_fac1_obj <span class="ot">&lt;-</span> <span class="fu">glht</span>(fac1_fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">animal =</span> <span class="st">"Tukey"</span>), </span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHC) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Leider sehen wir die Anpassung für die Varianzheterogenität nicht in der Ausgabe von <code>glht</code>, was immer etwas nervig ist. Deshalb musst du nochmal gucken, was die Funktion <code>vcov()</code> dir zurückgibt. Wir brauchen nur die Diagonale der Varianz/Covarianzmatrix um zu schauen ob wir heterogene Varianzen geschätzt bekommen haben. Sieht auf jeden Fall gut aus, die Varianzen sind nicht alle gleich.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(multcomp_fac1_obj) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>cat - dog fox - dog fox - cat 
1.3692063 0.9675397 0.8037302 </code></pre>
</div>
</div>
<p>Wenn wir die Funktion durchgeführt haben können wir uns mit der Wiedergabe die statistischen Maßzahlen berechnen lassen. Du kannst natürlich auch die Adjustierung für die heterogenen Varianzen weglassen, aber so viel aus machen tut die Adjustierung nicht.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true">p-Werte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false"><em>Compact letter display</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false">95% Konfidenzintervall</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<p>Per Standardeinstellung erhalten wir die adjustierten p-Werte wieder. Ich nutze noch die Helferfunktion <code>tidy()</code> um mir eine bessere Ausgabe zu erschaffen. Dann wähle ich noch den Kontrast, den Mittelwertsunterschied sowie die adjustierten p-Werte aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>multcomp_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, adj.p.value)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  contrast  estimate adj.p.value
  &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;
1 cat - dog    -3.39    0.0245  
2 fox - dog     1.03    0.554   
3 fox - cat     4.41    0.000254</code></pre>
</div>
</div>
<p>Wir können auch die Adjustierung der p-Werte ausschalten indem wir nochmal die Funktion <code>summary()</code> mit der entsprechenden Option dazwischenschalten. Das ist dann auf jeden Fall nochmal eine gute Option, wenn man beides haben möchte.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>multcomp_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"none"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  term   contrast  null.value estimate std.error statistic  p.value
  &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 animal cat - dog          0    -3.39     1.17      -2.89 0.00968 
2 animal fox - dog          0     1.03     0.984      1.05 0.310   
3 animal fox - cat          0     4.41     0.897      4.92 0.000110</code></pre>
</div>
</div>
<p>Die p-Werte sind ähnlich wie schon in den anderen Analysen, was auch zu erwarten war. Die einfaktorielle Analyse für einen <em>all-pair</em> Vergleich ist recht ähnlich.</p>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<p>Bei dem <em>Compact letter display</em> müssen wir einmal die Leerzeichen aus den Kontrastnamen entfernen damit die Funktion <code>multcompLetters</code> die entsprechenden Buchstaben erstellen kann.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>multcomp_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(adj.p.value, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>cat fox dog 
"a" "b" "b" </code></pre>
</div>
</div>
<p>Wir erhalten dann ein ähnliches Ergebnis wie schon bei den anderen Analysen. Du musst dann immer schauen, was besser zu deiner Fragestellung passt.</p>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<p>Die Stärke von <code>{multcomp}</code> sind die simultanen 95% Konfidenzintervalle die auch alle damit die Fehlerrate des Signifikanzniveaus von 5% über alle Vergleiche einhalten. Das funktioniert besonders git in dem Fall, dass wir eine einfaktorielle Analyse vorliegen haben. Wir müssen aber die Funktion <code>tidy()</code> aufrufen, damit uns die 95% Konfidenzintervalle wiedergegeben werden.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>relevance_lvl <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>multcomp_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig_lgl =</span> <span class="fu">case_when</span>(<span class="fu">between</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">n</span>()), conf.low, conf.high) <span class="sc">~</span> <span class="st">"n.s."</span>,</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>                             relevance_lvl <span class="sc">&lt;</span> conf.low <span class="sc">~</span> <span class="st">"s. &amp; r."</span>,</span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> <span class="st">"s."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(contrast, <span class="at">y =</span> estimate, </span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, </span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> sig_lgl)) <span class="sc">+</span></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">2</span>), <span class="at">linetype =</span> <span class="st">"11"</span>) <span class="sc">+</span></span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb189-18"><a href="#cb189-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Mittelwertsunterschied"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb189-19"><a href="#cb189-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-multcomp-fac1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-multcomp-fac1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-multcomp-fac1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33" title="Abbildung&nbsp;42.33— Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe."><img src="stat-tests-posthoc2_files/figure-html/fig-multcomp-fac1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-multcomp-fac1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.33— Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="zweifaktorielle-analyse-5" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorielle-analyse-5">Zweifaktorielle Analyse</h4>
<p>Es ist acuh möglich in <code>{multcomp}</code> eine mehrfaktorielle Analyse druchzuführen. Hierbei können wir wieder jedes Modell nehmen was wir zu Verfügung haben. Damit es hier einfach bleibt, bleibe ich bei einem linearen Modell für einen normalverteilten Messwert. Wir haben wieder unsere Tierrassen und dann noch den Messort vorliegen. Mehr zu dem Thema findest du auch in der Arbeit von <span class="citation" data-cites="hothorn2008simultaneous">Hothorn u.&nbsp;a. (<a href="#ref-hothorn2008simultaneous" role="doc-biblioref">2008</a>)</span> in dem Dokument <a href="https://cran.r-project.org/web/packages/multcomp/">multcomp: Simultaneous Inference in General Parametric Models</a>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt müssen wir aber einiges an Option auswählen, damit wir die zweifaktorielle Analyse auch gut durchrechnen können. <em>Wichtig ist hier, dass wir über den zweiten Faktor mitteln.</em> Daher verlieren wir den zweiten Faktor in der Betrachung der folgenden Ergebnisse. Manchmal wollen wir das, häufig wollen wir das nicht. Deshalb nutzen wir die Option <code>covariate_average = TRUE</code> und <code>interaction_average = TRUE</code> um eben über den zweiten Faktor <code>site</code> und die Interaktion <code>animal:site</code> zu mitteln (eng. <em>average</em>). Optimal ist es dann trotzdem nicht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>multcomp_fac2_obj <span class="ot">&lt;-</span> <span class="fu">glht</span>(fac2_fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">animal =</span> <span class="st">"Tukey"</span>,</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">covariate_average =</span> <span class="cn">TRUE</span>, <span class="at">interaction_average =</span> <span class="cn">TRUE</span>),</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHC) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Auch hier schauen wir dann einmal, ob die Anpassung der Varianzen geklappt hat und wir sehen, dass wir unterschiedliche Varianzen rausbekommen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(multcomp_fac2_obj) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>dog - cat fox - cat fox - dog 
0.4335275 0.3715813 0.3027267 </code></pre>
</div>
</div>
<p>Jetzt haben wir alles toll über den zweiten Faktor und die Interaktion gemittelt. Das ist aber nicht so super, wenn wir eine signifikante Interaktion vorliegen haben. Da sollten wir uns den ersten Faktor getrennt für den zweiten Faktor anschauen. Und das wird dann in <code>{multcomp}</code> etwas sperrig um es mal freundlich auszudrücken. Wir müssen uns erstmal eine neue Variable bauen, die alle Faktorkombinationen enthält. Das macht die Funktion <code>interaction()</code> für uns.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>fac2_inter_tbl <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inter_animal_site =</span> <span class="fu">interaction</span>(animal, site))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir das Modell einfaktoriell nur mit der Variable der Interaktion rechnen. Das ist natürlich auch so halb eine Lösung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>fac2_inter_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> inter_animal_site, <span class="at">data =</span> fac2_inter_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Mit dem künstlichen einfaktoriellen Modell können wir dann wieder unsere Funktion <code>glht()</code> aufrufen. Hier dann einmal simple ohne Adjustierung für Varianzheterogenität. Hier macht es dann sehr Sinn alle Vergleiche zu rechnen. Obwohl du dann natürlich echt viele Vergleiche rechnest und du damit das Signifikanzniveau sehr drückst. Je mehr ich darüber nachdenke, desto weniger würde ich es so machen. Dann lieber doch alles in <code>{emmeans}</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>multcomp_fac2_inter_obj <span class="ot">&lt;-</span> <span class="fu">glht</span>(fac2_inter_fit, </span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">inter_animal_site =</span> <span class="st">"Tukey"</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Im Folgenden lassen wir uns einmal die p-Werte für das Interaktionmodell wiedergeben. Sonst wäre es mehr oder minder die Wiederholung des einfaktoriellen Modells nur mit gemittelten Werten für den zweiten Faktor und der Interaktion.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true">p-Werte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false"><em>Compact letter display</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false">95% Konfidenzintervall</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<p>Jetzt erhalten wir einiges an Vergleichen, da wir ja auch eine Menge an Tests rechnen. Für jede Faktorkombination kriegst du jetzt einen adjustierten p-Wert wiedergegeben und damit wird es wirklich etwas unübersichtlich. Leider fällt mir auch keine bessere Ordnung ein. Hier hilft dann wirklich mal die Funktion <code>pvalue()</code> umd die p-Werte einheitlich zu formatieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>multcomp_fac2_inter_obj <span class="sc">|&gt;</span> </span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">adj.p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(adj.p.value)) <span class="sc">|&gt;</span> </span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, adj.p.value)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 3
   contrast                  estimate adj.p.value
   &lt;chr&gt;                        &lt;dbl&gt; &lt;chr&gt;      
 1 dog.city - cat.city          3.10  0.005      
 2 fox.city - cat.city          6.54  &lt;0.001     
 3 cat.village - cat.city       1.67  0.331      
 4 dog.village - cat.city       2.98  0.007      
 5 fox.village - cat.city       3.40  0.001      
 6 fox.city - dog.city          3.44  0.001      
 7 cat.village - dog.city      -1.43  0.501      
 8 dog.village - dog.city      -0.117 &gt;0.999     
 9 fox.village - dog.city       0.296 &gt;0.999     
10 cat.village - fox.city      -4.87  &lt;0.001     
11 dog.village - fox.city      -3.55  &lt;0.001     
12 fox.village - fox.city      -3.14  0.004      
13 dog.village - cat.village    1.32  0.593      
14 fox.village - cat.village    1.73  0.292      
15 fox.village - dog.village    0.413 0.996      </code></pre>
</div>
</div>
<p>Besonders bei <em>so vielen</em> Vergleichen macht es eventuell Sinn einmal die p-Wert Adjustierung für multiple Vergleiche auszuschalten und sich die rohen p-Werte in Ruhe zu betrachten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>multcomp_fac2_inter_obj <span class="sc">|&gt;</span> </span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"none"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 7
   term              contrast   null.value estimate std.error statistic  p.value
   &lt;chr&gt;             &lt;chr&gt;           &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
 1 inter_animal_site dog.city …          0    3.10      0.815     3.80  3.65e- 4
 2 inter_animal_site fox.city …          0    6.54      0.815     8.02  9.19e-11
 3 inter_animal_site cat.villa…          0    1.67      0.815     2.05  4.57e- 2
 4 inter_animal_site dog.villa…          0    2.98      0.815     3.66  5.74e- 4
 5 inter_animal_site fox.villa…          0    3.40      0.815     4.17  1.12e- 4
 6 inter_animal_site fox.city …          0    3.44      0.815     4.22  9.54e- 5
 7 inter_animal_site cat.villa…          0   -1.43      0.815    -1.76  8.45e- 2
 8 inter_animal_site dog.villa…          0   -0.117     0.815    -0.144 8.86e- 1
 9 inter_animal_site fox.villa…          0    0.296     0.815     0.363 7.18e- 1
10 inter_animal_site cat.villa…          0   -4.87      0.815    -5.97  1.88e- 7
11 inter_animal_site dog.villa…          0   -3.55      0.815    -4.36  5.90e- 5
12 inter_animal_site fox.villa…          0   -3.14      0.815    -3.85  3.12e- 4
13 inter_animal_site dog.villa…          0    1.32      0.815     1.61  1.12e- 1
14 inter_animal_site fox.villa…          0    1.73      0.815     2.12  3.86e- 2
15 inter_animal_site fox.villa…          0    0.413     0.815     0.507 6.15e- 1</code></pre>
</div>
</div>
<p>Am Ende bleibt eine sehr lange Liste, die schon bei drei Tierrassen und zwei Messorten sehr lang ist. Wenn du dann mehr Level in jedem Faktor hast, dann wird die Sachlage noch unübersichtlicher. Hier würde ich dann die Reißleine ziehen und dann nicht mehr <code>{multcomp}</code> nutzen.</p>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<p>Das <em>Compact letter display</em> leidet auch etwas unter der großen Anzahl an Vergleichen. Dadurch kann es dir passieren, dass dir die Buchstaben ausgehen! Das ist jetzt hier noch nicht der Fall, aber das müsstest du mit in Betracht ziehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>multcomp_fac2_inter_obj <span class="sc">|&gt;</span> </span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(adj.p.value, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   dog.city    fox.city cat.village dog.village fox.village    cat.city 
        "a"         "b"        "ac"         "a"         "a"         "c" </code></pre>
</div>
</div>
<p>Auch hier erhälst du dann eine Menge Vergleiche, die dich vielleicht alle gar nicht interesieren. Dadurch wird dann aber alles noch unübersichtlicher, obwohl die Übersichtlichkeit ja gerade eine Stärke des <em>Compact letter displays</em> ist.</p>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<p>Dann schauen wir uns noch die 95% Konfidenzintervalle an, die hier dann doch etwas übersichtlicher daherkommen. Wir haben zwar eine riesige Menge an Kondfidenzintervallen aber immerhin sieht man hier ganz gut, wie relevant die einzelnen Vergleiche sind. Also wie weit ist denn jetzt das Konfidenzintervall von der Null weg für den jeweiligen Vergleich? Hier lässt sich dann auch eine Relevanzschwelle gut einzeichnen. Ich habe hier mal einen Mittelwertsunterschied von 2cm als relevant eingezeichnet.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>relevance_lvl <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>multcomp_fac2_inter_obj <span class="sc">|&gt;</span> </span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig_lgl =</span> <span class="fu">case_when</span>(<span class="fu">between</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">n</span>()), conf.low, conf.high) <span class="sc">~</span> <span class="st">"n.s."</span>,</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>                             relevance_lvl <span class="sc">&lt;</span> conf.low <span class="sc">~</span> <span class="st">"s. &amp; r."</span>,</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> <span class="st">"s."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(contrast, <span class="at">y =</span> estimate, </span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, </span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> sig_lgl)) <span class="sc">+</span></span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">2</span>), <span class="at">linetype =</span> <span class="st">"11"</span>) <span class="sc">+</span></span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Mittelwertsunterschied"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb203-19"><a href="#cb203-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-multcomp-fac2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-multcomp-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-multcomp-fac2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="Abbildung&nbsp;42.34— Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe."><img src="stat-tests-posthoc2_files/figure-html/fig-multcomp-fac2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-multcomp-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.34— Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Am Ende kannst du dann anhand der Signifikanzschwelle und der Relevanzschwelle deine Ergebnisse entsprechend sortieren und eine Entscheidung treffen. Am Ende steht und fällt es dann natürlich mit der Definition der Relevanzschwelle und der Anzahl an Faktorkombinationen. Wenn es dann zu viele sind, dann siehst du gar nichts mehr.</p>
</div>
</div>
</div>
</section>
</section>
<section id="r-paket-nparcomp" class="level3" data-number="42.8.4">
<h3 data-number="42.8.4" class="anchored" data-anchor-id="r-paket-nparcomp"><span class="header-section-number">42.8.4</span> R Paket <code>{nparcomp}</code></h3>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Das Paket <code>{nparcomp}</code> kann nur ein einfaktorielles Modell rechnen. Dafür brauchst du kein normalverteiltes <span class="math inline">\(y\)</span> in deinen Daten. Darüber hinaus ist die Interpretation des Effekts biologisch nicht möglich. Jedenfalls nicht im klassischen Sinne einer Relevanzbetrachtung auf der Einheit der Messwerte deines <span class="math inline">\(y\)</span>. Das <em>Compact letter display</em> kannst du aber problemlos nutzen.</p>
</div>
</div>
<p>Das R Paket <code>{nparcomp}</code> wird gerne genutzt, wenn du ein nicht normalverteiltes Outcome <span class="math inline">\(y\)</span> vorliegen hast und nur eine Behandlung <span class="math inline">\(x\)</span>. Dieser Fall kommt sehr oft in der Zellbiologie vor oder aber allgemein in den Humanwissenschaften. Teilweise dann auch in Mausmodellen, wo wir dann nur drei bis vier Behandlungen vorliegen haben und diese dann zu einer Kontrolle vergleichen. Dafür ist das R Paket <code>{nparcomp}</code> nützlich. Aber auch nur, wenn du an p-Werten und vielleicht noch dem <em>Compact letter display</em> interessiert bist. Alles andere ist dann nicht sinnvoll abbildbar.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01_small.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="images/angel_01_small.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Hier einmal kurz der niedergeschlagende Engel. In diesem Abschnitt zu <code>{nparcomp}</code> werde ich ein paar Engel der Statistik niedergeschlagen und dann noch überfahren. Ich lasse aus Gründen der Didaktik ein paar Sachen weg und dadurch wird einiges leider dann <em>mathematisch</em> unkorrekt. Ich kann damit leben und nehme es auf mich damit du deine Abschlussarbeit fertig bekommst. Somit sind alle Abbildungen eher Näherungen als mathematisch korrekt.</p>
</blockquote>
</div>
</div>
</div>
<p>Das R Paket <code>{nparcomp}</code> hat viele Stärken. In den meisten praktischen Situationen ist die Verteilung der gemessenen Daten <span class="math inline">\(Y\)</span> unbekannt. Dann kann es auch sein, dass du eine Reihe von atypischen Messungen und Ausreißern vorliegen hast. Mit dem R Paket <code>{nparcomp}</code> hast fast keine Annahmen an die Daten, so dass du hier sehr flexibel bist. Einzig die Verteilungen der Gruppen müssen ähnlich sein. Das ist aber in einem in sich geschlossenen Experiment eigentlich immer der Fall.</p>
<p>Betrachten wir also einmal die Funktionsweise von <code>{nparcomp}</code> an einem simplen Beispiel. Ich gehe hier nicht auf die tiefen der Berechnung ein, sondern wir wollen einmal verstehen, was die Ausgabe von <code>{naparcomp}</code> uns sagen will. Da das Verfahren nicht auf den klassischen statistischen Maßzahlen wie Mittelwert und Standardabweichung beruht ist die Ausgabe nicht ganz so einfach zu verstehen. In der folgenden Tabelle siehst du einmal die Ausgabe der Funktion <code>npar.t.test()</code> in der ich nur die Sprungweiten der Hunde- und Katzenflöhe miteinander vergleichen habe.</p>
<div class="cell">
<div id="tbl-nparcomp-res" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nparcomp-res-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.15— Ergebnis der Funktion <code>npar.t.test()</code> für den paarweisen Vergleichs von der Sprunglänge in [cm] von Hunde- und Kartzenflöhen. Die Fuchsflöhe wurden einmal entfernt um nur einen paarweisen Vergleich zu rechnen.
</figcaption>
<div aria-describedby="tbl-nparcomp-res-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Effect</th>
<th style="text-align: center;">Estimator</th>
<th style="text-align: center;">Lower</th>
<th style="text-align: center;">Upper</th>
<th style="text-align: center;">T</th>
<th style="text-align: center;">p.Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">p(dog,cat)</td>
<td style="text-align: center;">0.102</td>
<td style="text-align: center;">-0.085</td>
<td style="text-align: center;">0.289</td>
<td style="text-align: center;">-4.684</td>
<td style="text-align: center;">0.001</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Wir wissen anhand der Ausgabe von <code>npar.t.test()</code>, dass wir einen signifikanten Unterschied zwischen den Sprungweiten der Hunde- und Katzenflöhe vorliegen haben. Der p-Wert <span class="math inline">\(0.001\)</span> ist kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%. Aber wie groß ist jetzt der Unterschied oder anders gefragt, was ist der berechnete Effekt? Das R Paket <code>{nparcomp}</code> berechnet hierbei den relativen Effekt <span class="math inline">\(p(a,b)\)</span>. Das heißt wiederum, dass wir die Einheit der Sprungweite verlieren und nur eine Wahrscheinlichkeit wiedergeben bekommen.</p>
<dl>
<dt>Was sagt der relative Effekt <span class="math inline">\(\boldsymbol{p(a,b)}\)</span> aus?</dt>
<dd>
<p>Wenn der relative Effekt <span class="math inline">\(p(a,b)\)</span> größer ist als <span class="math inline">\(1/2\)</span>, dann tendiert die Gruppe <span class="math inline">\(b\)</span> dazu größer zu sein als die Gruppe <span class="math inline">\(a\)</span>. Oder etwas anders formuliert. Wenn wir einen relativen Effekt größer als <span class="math inline">\(1/2\)</span> vorliegen haben, dann spricht der relative Effekt für größere Mittelwerte in der Gruppe <span class="math inline">\(b\)</span> im Vergleich zur Gruppe <span class="math inline">\(a\)</span>. Wir können dann sagen, dass <span class="math inline">\(\bar{y}_b &gt; \bar{y}_a\)</span> ist. Oder dur schreibst statt <span class="math inline">\(p(a,b)\)</span> eben <span class="math inline">\(p(b &gt; a)\)</span>. Ja, ist etwas schief…aber wir leben damit.</p>
</dd>
</dl>
<p>Betrachten wir einmal die Darstellung der beiden Verteilungen der Sprungweiten für die Hunde- und Katzenflöhe. Die Katzenflöhe haben einen niedrigeren Mittelwert mit <span class="math inline">\(\\bar{y}_{cat} = 4.74\)</span> und springen nicht so weit wie die Hundeflöhe mit einem hören Mittelwert von <span class="math inline">\(\\bar{y}_{dog} = 8.13\)</span>. Wir erhalten einen relativen Effekt <span class="math inline">\(p_{(dog, cat)}\)</span> von <span class="math inline">\(0.102\)</span>. Was sagt uns nun der Wert aus? In der folgenden Abbidlung ahbe ich dir einmal den Zusammenhang visualisert. Die eingefärbte Fläche ist die Wahrscheinlichkeit <span class="math inline">\(p_{(dog, cat)}\)</span> von <span class="math inline">\(0.102\)</span> zufällig größere Sprungweiten von Katzenflöhen als von Hundeflöhen zu beobachten. Da die Katzenflöhe ja <em>nicht</em> weiter als die Hundeflöhe springen, ist die Wahrscheinlichkeit <span class="math inline">\(p_{(dog, cat)}\)</span> klein.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-nparcomp-dog-cat" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nparcomp-dog-cat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-nparcomp-dog-cat-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36" title="Abbildung&nbsp;42.35— Darstellung der Verteilung der Sprungweiten der Hunde- und Katzenflöhe mit 8.13 \pm 2.14cm für die Hundeflöhe und 4.74 \pm 1.9cm für die Katzenflöhe. Wir gehen hier von einer normalverteilten Sprungweite aus. Wir erhalten einen relativen Effekt p_{(dog, cat)} von 0.102. Die Wahrscheinlichkeit p_{(dog, cat)} beschreibt zufällig größere Werte für \bar{y}_cat als für \bar{y}_dog zu beobachten. Die eingefärbten Flächen dienen als Veranschaulichung. [Zum Vergrößern anklicken]"><img src="stat-tests-posthoc2_files/figure-html/fig-nparcomp-dog-cat-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nparcomp-dog-cat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.35— Darstellung der Verteilung der Sprungweiten der Hunde- und Katzenflöhe mit <span class="math inline">\(8.13 \pm 2.14cm\)</span> für die Hundeflöhe und <span class="math inline">\(4.74 \pm 1.9cm\)</span> für die Katzenflöhe. Wir gehen hier von einer normalverteilten Sprungweite aus. Wir erhalten einen relativen Effekt <span class="math inline">\(p_{(dog, cat)}\)</span> von <span class="math inline">\(0.102\)</span>. Die Wahrscheinlichkeit <span class="math inline">\(p_{(dog, cat)}\)</span> beschreibt zufällig größere Werte für <span class="math inline">\(\bar{y}_cat\)</span> als für <span class="math inline">\(\bar{y}_dog\)</span> zu beobachten. Die eingefärbten Flächen dienen als Veranschaulichung. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir können uns nun die Sachlage auch einmal für alle drei Fälle visualisieren. Daher wir schauen uns an, wie sehen die unterscheidlichen relativen Effektschätzer aus? Zum einen kann ja der Wert des relativen Effekts <span class="math inline">\(p(a,b)\)</span> klein sein und daher eher nahe Null. Damit spricht der relative Effekt dafür das <span class="math inline">\(a\)</span> kleiner ist als <span class="math inline">\(b\)</span>. Oder der Wert von <span class="math inline">\(p(a,b)\)</span> ist 0.5, dann ist <span class="math inline">\(a\)</span> vermutlich gleich <span class="math inline">\(b\)</span>. Im letzte Fall kann <span class="math inline">\(p(a,b)\)</span> nahe Eins sein, dann spricht es für größere Werte in <span class="math inline">\(b\)</span> als in <span class="math inline">\(a\)</span>. Ich kann mit den Zusammenhang besser als eingefärbte Flächen merken, daher habe ich dir nochmal den relativen Effektschätzer etwas anders dargestellt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-normal-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-normal-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-normal-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37" title="Abbildung&nbsp;42.36— Darstellung verschiedener relativer Effekte p(a,b) für zwei Gruppen und einem normalverteilten Outcome y. Die eingefärbten Flächen dienen als Veranschaulichung. Die Flächen stellt die Wahrscheinlichkeit p(a,b) als relativen Effekt dar. (A) Die Gruppe A hat mit \bar{y}_A einen größeren Mittelwert als die Gruppe B mit \bar{y}_B. Damit ist p(A,B) aproximativ 0.2 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A gering. (B) Die Gruppe A und B haben fast den gleichen Mittelwert. Damit ist p(A,B) aproximativ 0.5 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A gleich. (C) Die Gruppe A hat mit \bar{y}_A einen kleineren Mittelwert als die Gruppe B mit \bar{y}_B. Damit ist p(A,B) aproximativ 0.8 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A groß. [Zum Vergrößern anklicken]"><img src="stat-tests-posthoc2_files/figure-html/fig-normal-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1152"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.36— Darstellung verschiedener relativer Effekte <span class="math inline">\(p(a,b)\)</span> für zwei Gruppen und einem normalverteilten Outcome <span class="math inline">\(y\)</span>. Die eingefärbten Flächen dienen als Veranschaulichung. Die Flächen stellt die Wahrscheinlichkeit <span class="math inline">\(p(a,b)\)</span> als relativen Effekt dar. <strong>(A)</strong> Die Gruppe A hat mit <span class="math inline">\(\bar{y}_A\)</span> einen größeren Mittelwert als die Gruppe B mit <span class="math inline">\(\bar{y}_B\)</span>. Damit ist <span class="math inline">\(p(A,B)\)</span> aproximativ 0.2 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A gering. <strong>(B)</strong> Die Gruppe A und B haben fast den gleichen Mittelwert. Damit ist <span class="math inline">\(p(A,B)\)</span> aproximativ 0.5 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A gleich. <strong>(C)</strong> Die Gruppe A hat mit <span class="math inline">\(\bar{y}_A\)</span> einen kleineren Mittelwert als die Gruppe B mit <span class="math inline">\(\bar{y}_B\)</span>. Damit ist <span class="math inline">\(p(A,B)\)</span> aproximativ 0.8 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A groß. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<section id="einfaktorielle-analyse-6" class="level4" data-number="42.8.4.1">
<h4 data-number="42.8.4.1" class="anchored" data-anchor-id="einfaktorielle-analyse-6"><span class="header-section-number">42.8.4.1</span> Einfaktorielle Analyse</h4>
<p>In dem Paket <code>{naprcomp}</code> können wir nur eine einfaktorielle Analyse rechnen. Da ist hier nochmal wichtig zu wissen. Sonst musst du dir die Arbeit nicht machen. Wir müssen einiges Einstellen bei der gleichnamigen Hauptfunktion <code>nparcomp()</code> aber dann funktioniert alles relativ reibungslos. Das Paket ist schon älter und hat damit nicht die Funktionalität des <code>{tidyverse}</code> oder anderen Paketen. Hier sieht man dann auch, dass <code>{naprcomp}</code> nicht so oft genutzt wird, denn ansonsten wäre ja auch der Bedarf einer besseren Integration dar. Aber das lassen wir mal so im Raum stehen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true">p-Werte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false"><em>Compact letter display</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false">95% Konfidenzintervall</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<p>Leider hat die Funktion <code>nparcomp()</code> einem sehr viele Informationen auf der R Konsole auszugeben auch wenn man das nicht will und es einen eigentlich mehr verwirrt als gutes tut. Deshalb stelle ich immer die Option <code>info = FALSE</code> ein. Wir wollen eigentlich immer alle Gruppen miteinander vergleichen, so dass wir als Option <code>type = "Tukey"</code> nehmen. Achtung, das hat jetzt <em>nichts</em> mit dem Tukey HSD Test zu tun. Wir müssen uns dann auch noch aus der Ausgabe den Teil rausziehen, denn wir dann brauchen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="ot">&lt;-</span> <span class="fu">nparcomp</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, <span class="at">type =</span> <span class="st">"Tukey"</span>, </span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info =</span> <span class="cn">FALSE</span>)</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="sc">|&gt;</span> <span class="fu">pluck</span>(<span class="st">"Analysis"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Comparison Estimator Lower Upper Statistic    p.Value
1 p( dog , cat )     0.102 0.013 0.505 -2.345283 0.05174661
2 p( dog , fox )     0.684 0.276 0.925  1.050004 0.60520850
3 p( cat , fox )     0.980 0.612 0.999  2.681488 0.02140955</code></pre>
</div>
</div>
<p>Was wir eigentlich brauchen ist der p-Wert in der letzten Spalte. Spannend ist hier, dass <code>nparcomp()</code> den Vergleich von Hunde- und Katzenflöhen nicht als signifikant findet. Das ist eine Folge davon, dass <code>nparcomp()</code> etwas konservativer ist als die anderen hier vorgestellten Verfahren. Wenn du nochmal nachvollziehen willst, wie der relative Effekt <code>Estimator</code> zu interpretieren ist, habe ich dir nochmal im folgenden eine zusammenfassende Tabelle mit den Mittelwerten der einzelnen Gruppen gebaut. Für mich ist der Wert immer noch von hinten durch die Brust. Leider hat der relative Effekt keinen Bezug zur biologischen Einheit der Messwerte. Deshalb ist die Interpretation im günstigsten Fall schwierig.</p>
<div id="tbl-nparcomp-pval" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nparcomp-pval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;42.16— Interpretation des relativen Effektes <span class="math inline">\(p(a,b)\)</span> am Beispiel der Sprungweiten der Flöhe. Je größer der relative Effekt <span class="math inline">\(p(a,b)\)</span> desto wahrscheinlicher ist es größere Werte in <span class="math inline">\(b\)</span> als in <span class="math inline">\(a\)</span> zu beobachten.
</figcaption>
<div aria-describedby="tbl-nparcomp-pval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Vergleich</th>
<th style="text-align: center;">Relativer Effekt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\bar{y}_{cat} \stackrel{?}{&gt;} \bar{y}_{dog}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.74 \stackrel{?}{&gt;} 8.13 \rightarrow p(dog, cat) = 0.102\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\bar{y}_{fox} \stackrel{?}{&gt;} \bar{y}_{dog}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9.16 \stackrel{?}{&gt;} 8.13 \rightarrow p(dog, fox) = 0.684\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\bar{y}_{fox} \stackrel{?}{&gt;} \bar{y}_{cat}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.74 \stackrel{?}{&gt;} 9.16 \rightarrow p(cat, fox) = 0.980\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<p>Für das <em>Compact letter display</em> brauchen wir wieder einmal das Objekt einer <code>nparcomp()</code> Analyse. Wir nutzen hier den gleichen Aufruf wie schon bei den p-Werten. Die Optionen sind damit die gleichen wie im Tab zu den p-Werten. Wir sind jetzt aber nur an den reinen p-Werten interessiert und nicht an den relativen Effekten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="ot">&lt;-</span> <span class="fu">nparcomp</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, <span class="at">type =</span> <span class="st">"Tukey"</span>, </span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Leider ist es so, dass <code>{nparcomp}</code> nicht für die Erstellung des <em>Compact letter displays</em> optimiert ist. Daher müssen wir uns erst einen Vektor für die Vergleiche mit einem Minuszeichen ohne Leerzeichen bauen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>contrast_vec <span class="ot">&lt;-</span> nparcomp_fac1_res <span class="sc">|&gt;</span>   </span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Contrast"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row.names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wenn wir die Namen der Vergleiche haben, können wir uns die p-Werte aus dem <code>nparcomp()</code> Objekt ziehen und entsprechend dem Vergleich benennen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>adj_p_values_vec <span class="ot">&lt;-</span> nparcomp_fac1_res <span class="sc">|&gt;</span>   </span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Analysis"</span>, <span class="st">"p.Value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(contrast_vec)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Abschließend können wir uns dann mit der Funktion <code>multcompLetters()</code> das <em>Compact letter display</em> wiedergeben lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>adj_p_values_vec <span class="sc">|&gt;</span> <span class="fu">multcompLetters</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> cat  fox  dog 
 "a"  "b" "ab" </code></pre>
</div>
</div>
<p>Hier ist der Weg etwas länger aber wenn wir uns nur auf das <em>Compact letter displays</em> konzentrieren liefert <code>{nparcomp}</code> in einem einfaktoriellen Fall eigentlich alles was wir brauchen. Hier unterscheidet sich das <em>Compact letter display</em> von den anderen Analysen, da wir hier auch etwas andere p-Werte erhalten.</p>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01_small.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38"><img src="images/angel_01_small.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Ja, die 95% Konfidenzintervalle und <code>{nparcomp}</code>, eine für mich schwierige Sache. Eigentlich liefern die 95% Konfidenzintervalle in <code>{nparcomp}</code> nicht so richtig was wir eigentlich wollen. Nämlich eine biologisch zu interpretierende Relevanz und Signifikanz. Die relativen Effekte <span class="math inline">\(p(a,b)\)</span> aus der Funktion <code>nparcomp()</code> sind eben dann doch wieder nur Wahrscheinlichkeiten.</p>
</blockquote>
</div>
</div>
</div>
<p>Wenn du die 95% Konfidenzintervalle brauchst, dann kannst du die Funktion <code>nparcomp()</code> wie in den Tab zu den p-Werten nutzen. Hier ändert sich nichts bei dem Funktionsaufruf. Praktischerweise liefert dir die Ausgabe von <code>nparcomp()</code> auch gleich die 95% Konfidenzintervalle mit.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="ot">&lt;-</span> <span class="fu">nparcomp</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, <span class="at">type =</span> <span class="st">"Tukey"</span>, </span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung siehst du dann einmal die 95% Konfidenzintervalle visualisiert. Durch die Eigenschaft des relativen Effekt eine Wahrscheinlichkeit zu sein, hast du die Begrenzungen von <span class="math inline">\([0, 1]\)</span> und damit dann auch keine symmetrischen 95% Konfidenzintervalle mehr. Die Entscheidung gegen die Nullhypothese liegt bei <span class="math inline">\(p(a,b) = 0.5\)</span>.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nparcomp_fac1_res<span class="sc">$</span>Analysis, </span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(Comparison, <span class="at">y =</span> Estimator, <span class="at">ymin =</span> Lower, <span class="at">ymax =</span> Upper)) <span class="sc">+</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Relativer Effekt"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-nparcomp-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nparcomp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-nparcomp-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39" title="Abbildung&nbsp;42.37— Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe aus dem R Paket {nparcomp} Der relative Effekt ist eine Wahrscheinlichkeit, daher die Begrenzungen bei [0, 1]. Die Entscheidung gegen die Nullhypothese liegt bei p(a,b) = 0.5."><img src="stat-tests-posthoc2_files/figure-html/fig-nparcomp-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nparcomp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;42.37— Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe aus dem R Paket <code>{nparcomp}</code> Der relative Effekt ist eine Wahrscheinlichkeit, daher die Begrenzungen bei <span class="math inline">\([0, 1]\)</span>. Die Entscheidung gegen die Nullhypothese liegt bei <span class="math inline">\(p(a,b) = 0.5\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="zweifaktorielle-analyse-6" class="level4" data-number="42.8.4.2">
<h4 data-number="42.8.4.2" class="anchored" data-anchor-id="zweifaktorielle-analyse-6"><span class="header-section-number">42.8.4.2</span> Zweifaktorielle Analyse</h4>
<p>Eine zweifaktorielle Analyse ist in dem Paket <code>{nparcomp}</code> nicht möglich. Damit war das hier viel Arbeit für mich für vermutlich nicht viel für dich. Dafür habe ich aber eine Menge über <code>{nparcomp}</code> gelernt und du musst dich dafür nicht durch das sehr mathematische Paper von <span class="citation" data-cites="konietschke2015nparcomp">Konietschke u.&nbsp;a. (<a href="#ref-konietschke2015nparcomp" role="doc-biblioref">2015</a>)</span> quälen. Denn in den Agrarwissenschaften haben wir eigentlich immer ein zweifaktorielles Modell und selten nur ein Modell mit einem Faktor vorliegen. Daher ist dieses Paket auch hier unten im Kapitel eingeordnet und würde ich nicht empfehlen.</p>
</section>
</section>
</section>
<section id="weitere-dinge-von-interesse" class="level2" data-number="42.9">
<h2 data-number="42.9" class="anchored" data-anchor-id="weitere-dinge-von-interesse"><span class="header-section-number">42.9</span> Weitere Dinge von Interesse</h2>
<p>Es gibt immer wieder Dinge von Interesse, die ich im Rahmen der multiplen Vergleiche oder Post-hoc Tests so finde. Meistens ist es dann nicht so wichtig, dass ich es in den obigen Abschnitten noch einbauen möchte. Auf der anderen Seite will ich es dann aber auch nicht vergessen, so dass es eben hier steht. SO kannst du über die Suchfunktion noch Sachen finden, die ich dann eben hier parke. Du kannst es nutzen und manchmal ist es dann auch nützlich.</p>
<section id="sec-friedhof-posthoc" class="level3" data-number="42.9.1">
<h3 data-number="42.9.1" class="anchored" data-anchor-id="sec-friedhof-posthoc"><span class="header-section-number">42.9.1</span> Friedhof der Post-hoc Tests</h3>
<p>Hier gebe ich eine – nicht vollständige – Liste an Post-hoc Tests, die es einmal gab und auch noch erwähnt werden, aber dann eigentlich alle irgendwie veraltet sind. Wie immer sind diese Tests nicht per se schlecht. Aber es gibt dann eben besseres. Die Daumenregel lautet dabei, dass es <code>{emmeans}</code> oder <code>{multcomp}</code> besser können. Zwei Übersichtsarbeiten helfen hier nochmal Ordnung in das Dickicht der multiplen Vergleiche zu bringen. Einmal die Arbeit <a href="https://www.sciencedirect.com/science/article/pii/S2405844024011629">On the use of post-hoc tests in environmental and biological sciences: A critical review</a> von <span class="citation" data-cites="agbangba2024use">Agbangba u.&nbsp;a. (<a href="#ref-agbangba2024use" role="doc-biblioref">2024</a>)</span> sowie die Veröffentlichung <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10845891/">A discussion and evaluation of statistical procedures used by JIMB authors when comparing means</a> von <span class="citation" data-cites="klasson2024discussion">Klasson (<a href="#ref-klasson2024discussion" role="doc-biblioref">2024</a>)</span>. Im Folgenden bieten sich zwei Pakete an die etwas älteren Post-hoc Tests zu rechnen. Zum einen das Paket <code>{descTools}</code>, welches einfacher zu bedienen ist und auch mal zweifaktoriell rechnen kann oder das R Paket <code>{agricolae}</code>, was den Fokus auf ein einfaktorielles Design hat aber dafür direkt das <em>Compact letter display</em> ohne p-Werte wiedergibt. Ich verzichte hier auch auf die händische Herleitung, auch wenn es gerade bei den älteren Anwendungen auch möglich ist, aber wir wollen diese Tests eigentlich nicht mehr nutzen.</p>
<dl>
<dt>LSD Test oder auch <em>Fisher`s least Significant Difference (LSD)</em></dt>
<dd>
<p>Der LSD Test ist veraltet. Was überhaupt gegen die Nutzung des LSD Test spricht ist, das der LSD Test das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% über alle Vergleiche nicht einhälst. Sie dazu auch <span class="citation" data-cites="agbangba2024use">Agbangba u.&nbsp;a. (<a href="#ref-agbangba2024use" role="doc-biblioref">2024</a>)</span> mit der klaren Aussage: <em>“LSD does not control for family-wise type I error”.</em> Die einzige Ausnahme ist der seltene Fall, dass du dir nur drei Behandlungsgruppen anschaust, wie von <span class="citation" data-cites="klasson2024discussion">Klasson (<a href="#ref-klasson2024discussion" role="doc-biblioref">2024</a>)</span> diskutiert. Aber am Ende ich kann den LSD Test nicht empfehlen.</p>
</dd>
</dl>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true"><code>{DescTools}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false"><code>{agricolae}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<p>In dem R Paket <code>{descTools}</code> kannst du den LSD Test einmal einfaktoriell rechnen, wie in dem folgenden Modell. Bitte beachte immer, das wir nicht für das multiple Testen adjustieren. Daher kann es dann zu Abweichungen zu anderen Post-hoc Tests kommen. Hier aber erstmal die einfaktorielle ANOVA.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ebenso kannst du eine zweifaktorielle ANOVA nutzen. Hier ist die Herausforderung dann die p-Werte zu extrahieren und das <em>Compact letter display</em> zu berechnen. Wir können dann das Modell in die Funktion <code>PostHocTest()</code> stecken und dann einmal mit der Option <code>method = "lsd"</code> den entsprechenden Test auswählen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>lsd_obj <span class="ot">&lt;-</span> <span class="fu">PostHocTest</span>(fac1_av, <span class="at">method =</span> <span class="st">"lsd"</span>)</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>lsd_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
  Posthoc multiple comparisons of means : Fisher LSD 
    95% family-wise confidence level

$animal
             diff     lwr.ci    upr.ci    pval    
cat-dog -3.385714 -5.3758086 -1.395620 0.00217 ** 
fox-dog  1.028571 -0.9615229  3.018666 0.29187    
fox-cat  4.414286  2.4241914  6.404380 0.00019 ***

---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Und dann können wir uns auch mit einer leichten Umgehung auch das <em>Compact letter display</em> erstellen lassen. Leider ist das immer etwas schwieriger, wenn die Ausgabe der Funktion nicht so richtig zu den der <em>Compact letter display</em> passt. Wir nutzen hier explizit die Funktion <code>extract()</code> aus dem R Paket <code>{magrittr}</code>. Bei dir heißt aber die Variable <code>"animal"</code> der Behandlung natürlich anders.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>lsd_obj <span class="sc">|&gt;</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"animal"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract</span>(, <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>cat fox dog 
"a" "b" "b" </code></pre>
</div>
</div>
<p>Im zweifaktoriellen Fall würde ich dir aber eher <code>{emmeans}</code> empfehlen, da du dort besser und leichter an das <em>Compact letter display</em> kommst.</p>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<p>Das R Paket <code>{agricolae}</code> erlaubt auch einen LSD Test zu rechnen. Wir brauchen nur das Modell einer einfaktoriellen ANOVA und können dann damit weiterrechnen. Ein zweiter Faktor ist in <code>{agricolae}</code> nicht möglich und wird ohne Fehlermeldung einfach von der Funktion ignoriert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Witzigerweise gibt die Funktion <em>von alleine</em> keine Ausgabe wieder. Wie wild dieses Verhalten einer Funktion ist, kann ich gar nicht ausdrücken. Wichtig ist hier, dass wir nur das <em>Compact letter display</em> wiedergegeben bekommen aber keine p-Werte für die paarweisen Vergleiche.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LSD.test</span>(fac1_av, <span class="at">trt =</span> <span class="st">"animal"</span>, <span class="at">p.adj =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"groups"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    jump_length groups
fox    9.157143      a
dog    8.128571      a
cat    4.742857      b</code></pre>
</div>
</div>
<p>Wenn du p-Werte brauchst oder ein zweifaktorielles Design vorliegen hast, dann nutze bitte die Funktionen aus dem R Paket <code>descTools</code> oder eben gleich <code>{emmeans}</code>, was einfach das bessere Paket ist.</p>
</div>
</div>
</div>
<dl>
<dt>Scheffé Test</dt>
<dd>
<p>Der Scheffé Test ist im Prinzipn eng mit dem Tukey HSD Test verwandt. Was aber <span class="citation" data-cites="agbangba2024use">Agbangba u.&nbsp;a. (<a href="#ref-agbangba2024use" role="doc-biblioref">2024</a>)</span> anmerkt ist, dass <em>“the test is too conservative compared to methods like Tukey’s HSD”</em>. Aus dem Grund würde ich den Test nicht empfehlen. Auch testet der Scheffé Test mehr Vergleiche als du meistens möchtest. Es ist eben nicht ein reiner <em>all-pair</em> Vergleich sondern testet auch noch alle anderen möglichen Kombinationen der Mittelwerte.</p>
</dd>
</dl>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true"><code>{DescTools}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false"><code>{agricolae}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<p>Wir können den Scheffé Test im R Paket <code>{DescTools}</code> mit der Funktion <code>ScheffeTest()</code> finden. Wir könnten auch die Funktion <code>PostHocTest()</code> nutzen und die Option <code>method = "scheffe"</code> wählen. Wir nutzen wieder das Modell aus der ANOVA, ob nun einfaktoriell oder zweifaktoriell, um dann den Scheffé Test zu rechnen. Ich zeige hier einmal die einfaktorielle Variante.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann brauchen wir nur noch die Funktion <code>ScheffeTest</code> aufrufen. Ich ziehe mir hier gleich mit der Funktion <code>pluck()</code> die notwendigen Informationen direkt raus. Deine Gruppenspalte in deinen Daten heißt ja anders, deshalb musst du dann <code>"animal"</code> entsprechend durch deinen Variablennamen ersetzen. Beachte, dass du hier adjustierte p-Werte wiedergegeben bekommst.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>scheffe_obj <span class="ot">&lt;-</span> <span class="fu">ScheffeTest</span>(fac1_av) <span class="sc">|&gt;</span> <span class="fu">pluck</span>(<span class="st">"animal"</span>)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>scheffe_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             diff    lwr.ci     upr.ci         pval
cat-dog -3.385714 -5.911354 -0.8600741 0.0080098476
fox-dog  1.028571 -1.497069  3.5542116 0.5649416800
fox-cat  4.414286  1.888646  6.9399259 0.0008066705</code></pre>
</div>
</div>
<p>Und dann können wir uns auch mit einer leichten Umgehung auch das <em>Compact letter display</em> erstellen lassen. Leider ist das immer etwas schwieriger, wenn die Ausgabe der Funktion nicht so richtig zu den der <em>Compact letter display</em> passt. Wir nutzen hier explizit die Funktion <code>extract()</code> aus dem R Paket <code>{magrittr}</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>scheffe_obj <span class="sc">|&gt;</span> </span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract</span>(, <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>cat fox dog 
"a" "b" "b" </code></pre>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<p>Wir können auch den Scheffé Test in dem R Paket <code>{agricolae}</code> rechnen. Dafür brauchen wir wieder ein einfaktorielles Modell. Wir können kein zweifaktorielles rechnen, sondern eben nur für einen Behandlungsfaktor. Deshalb hier einmal das ANOVA Modell.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir de Funktion <code>scheffe.test()</code> nutzen. Auch hier erhalten wir keine Ausgabe sondern müssen die Ausgabe selber anfordern. Wir schauen hier direkt das <em>Compact letter display</em> an. Wir erhlaten keine p-Werte aus der Funktion.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scheffe.test</span>(fac1_av, <span class="at">trt =</span> <span class="st">"animal"</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"groups"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    jump_length groups
fox    9.157143      a
dog    8.128571      a
cat    4.742857      b</code></pre>
</div>
</div>
<p>Wenn du p-Werte brauchst oder ein zweifaktorielles Design vorliegen hast, dann nutze bitte die Funktionen aus dem R Paket <code>descTools</code> oder eben gleich <code>{emmeans}</code>, was einfach das bessere Paket ist.</p>
</div>
</div>
</div>
</section>
<section id="re-engineering-des-compact-letter-displays" class="level3" data-number="42.9.2">
<h3 data-number="42.9.2" class="anchored" data-anchor-id="re-engineering-des-compact-letter-displays"><span class="header-section-number">42.9.2</span> Re-engineering des <em>Compact letter displays</em></h3>
<p>In dem kurzen Kapitel zu <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/re-engineering-clds.html">Re-engineering CLDs</a> in der Vingette des R Pakets <code>{emmeans}</code> geht es darum, wie das <em>Compact letter display</em> auch anders gebaut werden könnte. Nämlich einmal als wirkliches Anzeigen von Gleichheit über die Option <code>delta</code> oder aber über das Anzeigen von Signifikanz über die Option <code>signif</code>. Damit haben dann auch wirklich die Information, die wir dann wollen. Also eigentlich was Schönes. Wie machen wir das nun?</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true">Delta Methode</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false">Unterschied anzeigen</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<p>Wenn wir das <em>Cact letter display</em> in dem Sinne der Gleichheit der Behandlungen interpretieren wollen, also das der gleiche Buchstabe bedeutet, dass sich die Behandlungen nicht unterscheiden, dann müssen wir ein <code>delta</code> setzen in deren Bandbreite oder Intervall die Behandlungen gleich sind. Ich habe hier mal ein <code>delta</code> von 4cm gewählt und wir adjustieren bei einem Test auf Gleichheit nicht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span></span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>, <span class="at">delta =</span> <span class="dv">4</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean   SE df lower.CL upper.CL .equiv.set
 cat      4.74 0.67 18     3.34     6.15  a        
 dog      8.13 0.67 18     6.72     9.54   b       
 fox      9.16 0.67 18     7.75    10.56   b       

Confidence level used: 0.95 
Statistics are tests of equivalence with a threshold of 4 
P values are left-tailed 
significance level used: alpha = 0.05 
Estimates sharing the same symbol test as equivalent </code></pre>
</div>
</div>
<p>Wie wir jetzt sehen, bedeuten gleiche Buchstaben, dass die Behandlungen gleich sind. In dem Sinne gleich sind, dass die Behandlungen im Mittel nicht weiter als der Wert in <code>delta</code> auseinanderliegen. Wie du jetzt das <code>delta</code> bestimmst ist eine biologische und keine statistische Frage.</p>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<p>Können wir uns auch signifikante Unterschiede anzeigen lassen? Ja, können wir auch, aber das ist meiner Meinung nach die schlechtere der beiden Anpassungen. Wir haben ja im Kopf, dass das <em>Compact letter display</em> eben mit gleichen Buchstaben das Gleiche anzeigt. Jetzt würden wir diese Eigenschaften zu Unterschied ändern. Schauen wir uns das einmal an einem kleineren Datensatz einmal an.</p>
<p>Dann können wir uns hier einmal das Problem mit den Buchstaben anschauen. Wir kriegen jetzt mit der Option <code>signif = TRUE</code> wiedergeben <code>Estimates sharing the same symbol are significantly different</code> und das ist irgendwie auch wirr, dass <em>gleiche</em> Buchstaben einen Unterschied darstellen. Das <em>Compact letter display</em> wird eben als Gleichheit gelesen, so dass wir hier mehr verwirrt werden als es hilft.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span></span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>, <span class="at">signif =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean   SE df lower.CL upper.CL .signif.set
 cat      4.74 0.67 18     2.98     6.51  ab        
 dog      8.13 0.67 18     6.36     9.90  a         
 fox      9.16 0.67 18     7.39    10.92   b        

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 3 estimates 
P value adjustment: bonferroni method for 3 tests 
significance level used: alpha = 0.05 
Estimates sharing the same symbol are significantly different </code></pre>
</div>
</div>
<p>Deshalb würde ich auf die Buchstaben verzichten und die Zahlen angeben, damit hier nicht noch mehr Verwirrung aufkommt. Wir nehmen also die Option für die Buchstaben einmal aus dem <code>cld()</code> Aufruf raus. Dann haben wir Zahlen als Gruppenzuweisung, was schon mal was anderes ist als die Buchstaben aus dem <em>Compact letter display</em>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span></span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>, <span class="at">signif =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean   SE df lower.CL upper.CL .signif.set
 cat      4.74 0.67 18     2.98     6.51  12        
 dog      8.13 0.67 18     6.36     9.90  1         
 fox      9.16 0.67 18     7.39    10.92   2        

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 3 estimates 
P value adjustment: bonferroni method for 3 tests 
significance level used: alpha = 0.05 
Estimates sharing the same symbol are significantly different </code></pre>
</div>
</div>
<p>Innerhalb des selben Konzepts dann zwei Arten von Interpretation des <em>Compact letter display</em> zu haben, ist dann auch nicht zielführend. Den auch die <em>gleichen</em> Zahlen bedeuten jetzt einen Unterschied. Irgendwie mag ich persönlich nicht diese sehr verdrehte Interpretation nicht. Deshalb lieber ein <code>delta</code> einführen und auf echte Gleichheit testen.</p>
</div>
</div>
</div>
</section>
<section id="sec-posthoc-var-heterogen" class="level3" data-number="42.9.3">
<h3 data-number="42.9.3" class="anchored" data-anchor-id="sec-posthoc-var-heterogen"><span class="header-section-number">42.9.3</span> Modellierung von Varianzheterogenität</h3>
<p>In diesem Kapitel modelliere ich ja immer die Varianzheterogenität, wenn ich das kann. Es gibt aber eine Reihe von Möglichkeiten die Adjustierung durchzuführen. In den folgenden Tabs findest du dann noch andere Ideen und Anregungen. Ich muss hier nochmal aufräumen, aber wie immer, wenn es nicht dringlich ist, dann lagere ich es hier lieber. Es es bestimmt nochmal nützlich.</p>
<p>Wenn du noch etwas weiter gehen möchtest, dann kannst du dir noch die Hilfeseite von dem R Paket <code>{performance}</code> <a href="https://easystats.github.io/parameters/articles/model_parameters_robust.html?q=Heteroskedasticity#robust-covariance-matrix-estimation-from-model-parameters">Robust Estimation of Standard Errors, Confidence Intervals, and p-values</a> anschauen. Die Idee ist hier, dass wir die Varianz/Kovarianz robuster daher mit der Berücksichtigung von Varianzheterogenität (eng. <em>heteroskedasticity</em>) schätzen.</p>
<p>Hier also jetzt einmal eine Übersicht über die Möglichkeiten mit der Varianzheterogenität in Behandlungsgruppen umzugehen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true">Generalized Least Squares</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false">Robuste Schätzung von Standardfehlern</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<p>Neben dem Games Howell Test gibt es auch die Möglichkeit <em>Generalized Least Squares</em> zu nutzen. Hier haben wir dann auch die Möglichkeit mehrfaktorielle Modelle zu schätzen und dann auch wieder <code>emmeans</code> zu nutzen. Das ist natürlich super, weil wir dann wieder in dem <code>emmeans</code> Framework sind und alle Funktionen von oben nutzen können. Deshalb hier auch nur die Modellanpassung, den Rest kopierst du dir dann von oben dazu.</p>
<p>Die Funktion <code>gls()</code> aus dem R Paket <code>{nlme}</code> passt ein lineares Modell unter Verwendung der verallgemeinerten kleinsten Quadrate an. Die Fehler dürfen dabei aber korreliert oder aber ungleiche Varianzen haben. Damit haben wir ein Modell, was wir nutzen können, wenn wir Varianzheterogenität vorliegen haben. Hier einmal das simple Beispiel für die Tierarten. Wir nehmen wieder die ganz normale Formelschreiweise. Wir können jetzt aber über die Option <code>weights =</code> angeben, wie wir die Varianz modellieren wollen. Die Schreibweise mag etwas ungewohnt sein, aber es gibt wirklich viele Arten die Varianz zu modellieren. Hier machen wir uns es einfach und nutzen die Helferfunktion <code>varIdent</code> und modellieren dann für jedes Tier eine eigene Gruppenvarianz.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>gls_fac1_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal), </span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir die Modellanpasssung auch schon in <code>emmeans()</code> weiterleiten und schauen uns mal das Ergebnis gleich an. Wir achten jetzt auf die Spalte <code>SE</code>, die uns ja den Fehler der Mittelwerte für jede Gruppe wiedergibt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>gls_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean    SE   df lower.CL upper.CL
 dog      8.13 0.811 6.00     6.15     10.1
 cat      4.74 0.719 6.01     2.98      6.5
 fox      9.16 0.415 6.00     8.14     10.2

Degrees-of-freedom method: satterthwaite 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wir sehen, dass wir für jedes Tier eine eigene Varianz über den Standardfehler <code>SE</code> geschätzt haben. Das war es ja auch was wir wollten. Bis hierhin wäre es auch mit dem Games Howell Test gegangen. Was ist aber, wenn wir ein zweifaktorielles Design mit Interaktion schätzen wollen? Das können wir analog wie eben machen. Wir erweitern einfach das Modell um die Terme <code>site</code> für den zweiten Faktor und den Interaktionsterm <code>animal:site</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, </span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal), </span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns wieder die multiplen Vergleiche getrennt für die Interaktionsterme wiedergeben lassen. Blöderweise haben jetzt alle Messorte <code>site</code> die gleiche Varianz für jede Tierart, aber auch da können wir noch ran.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 animal emmean    SE df lower.CL upper.CL
 cat      13.6 0.672 18     12.2     15.0
 dog      16.7 0.573 18     15.5     17.9
 fox      20.1 0.466 18     19.1     21.1

site = village:
 animal emmean    SE df lower.CL upper.CL
 cat      15.2 0.672 18     13.8     16.7
 dog      16.6 0.573 18     15.4     17.8
 fox      17.0 0.466 18     16.0     18.0

Degrees-of-freedom method: satterthwaite 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Die eigentliche Stärke von <code>gls()</code> kommt eigentlich erst zu tragen, wenn wir auch noch erlauben, dass wir die Varianz <em>über alle</em> Tierarten, Messsorte und Interaktionen variieren kann. Das machen wir, in dem wir einfach <code>animal*site</code> zu der <code>varIdent()</code> Funktion ergänzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, </span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal<span class="sc">*</span>site), </span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann noch schnell in <code>emmeans()</code> gesteckt und sich das Ergebnis angeschaut.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 animal emmean    SE   df lower.CL upper.CL
 cat      13.6 0.594 8.93     12.2     14.9
 dog      16.7 0.713 9.03     15.1     18.3
 fox      20.1 0.365 9.01     19.3     20.9

site = village:
 animal emmean    SE   df lower.CL upper.CL
 cat      15.2 0.743 9.00     13.6     16.9
 dog      16.6 0.384 9.00     15.7     17.4
 fox      17.0 0.548 9.22     15.7     18.2

Degrees-of-freedom method: satterthwaite 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wie du jetzt siehst schätzen wir die Varianz für jede Tierart und jeden Messort separat. Wir haben also wirklich jede Varianz einzeln zugeordnet. Die Frage ist immer, ob das notwendig ist, denn wir brauchen auch eine gewisse Fallzahl, damit die Modelle funktionieren. Aber das kommt jetzt sehr auf deine Fragestellung an und müssten wir nochmal konkret besprechen.</p>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<p>Hier noch <code>{sandwich}</code> und <code>{clubSandwich}</code> ergänzen.</p>
<p>Wir immer gibt es noch eine weitere Möglichkeit die Varianzheterogenität zu behandeln. Wir nutzen jetzt hier einmal die Funktionen aus dem R Paket <code>{sandwich}</code>, die es uns ermöglichen Varianzheterogenität (eng. <em>heteroskedasticity</em>) zu modellieren. Es ist eigentlich super einfach, wir müssen als erstes wieder unser Modell anpassen. Hier einmal mit einer simplen linearen Regression.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>lm_fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir auch schon für einen Gruppenvergleich direkt in der Funktion <code>emmeans()</code> für die Varianzheterogenität adjustieren. Es gibt verschiedene mögliche Sandwich-Schätzer, aber wir nehmen jetzt mal einen der häufigsten mit <code>vcovHC</code>. Der Schätzer für die Varianzstruktur ist realtiv stabil und in den häufigsten Fällen vollkomen ausreichend</p>
<p>Wir laden jetzt nicht das ganze Paket <code>{sandwich}</code>, sondern nur die Funktion mit <code>sandwich::vcovHAC</code>. Achtung, hinter der Option <code>vcov.</code> ist ein <em>Punkt</em>. Ohne den Aufruf <code>vcov. =</code> funktioniert die Funktion dann nicht. Das hat mich mal sehr viele Nerven gekostet.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>em_obj <span class="ot">&lt;-</span> lm_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal, <span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC)</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>em_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean    SE df lower.CL upper.CL
 dog      8.13 0.427 18     7.23     9.03
 cat      4.74 0.810 18     3.04     6.44
 fox      9.16 0.468 18     8.17    10.14

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wir du siehst, die Standardfehler sind jetzt nicht mehr über alle Gruppen gleich. Wir haben also erfolgreich füe die Varianzheterogenität adjustiert.</p>
<p>Es gibt eine ganze Reihe von anderen Schätzern in dem R Paket <code>{sandwich}</code> und <code>{clubSandwich}</code>. HIer einmal die Referenzen der beiden Pakete zum nachschlagen, was es da noch so gibt.</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/clubSandwich/index.html">clubSandwich: Cluster-Robust (Sandwich) Variance Estimators with Small-Sample Corrections</a></li>
<li><a href="https://cran.r-project.org/web/packages/sandwich/index.html">sandwich: Robust Covariance Matrix Estimators</a></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-agbangba2024use" class="csl-entry" role="listitem">
Agbangba CE, Aide ES, Honfo H, Kakai RG. 2024. On the use of post-hoc tests in environmental and biological sciences: A critical review. Heliyon.
</div>
<div id="ref-heiss2024" class="csl-entry" role="listitem">
Arel-Bundock V, Greifer N, Heiss A. 2024. <a href="https://doi.org/10.18637/jss.v111.i09">How to Interpret Statistical Models Using <span>marginaleffects</span> for <span>R</span> and <span>Python</span></a>. Journal of Statistical Software 111: 1–32.
</div>
<div id="ref-cumming2007error" class="csl-entry" role="listitem">
Cumming G, Fidler F, Vaux DL. 2007. Error bars in experimental biology. The Journal of cell biology 177: 7–11.
</div>
<div id="ref-heiss2022" class="csl-entry" role="listitem">
Heiss A. 2022. Marginalia: <span>A</span> Guide to Figuring Out What the Heck Marginal Effects, Marginal Slopes, Average Marginal Effects, Marginal Effects at the Mean, and All These Other Marginal Things Are. (<a href="https://www.andrewheiss.com/blog/2022/05/20/marginalia/">https://www.andrewheiss.com/blog/2022/05/20/marginalia/</a>).
</div>
<div id="ref-hothorn2008simultaneous" class="csl-entry" role="listitem">
Hothorn T, Bretz F, Westfall P. 2008. Simultaneous inference in general parametric models. Biometrical Journal: Journal of Mathematical Methods in Biosciences 50: 346–363.
</div>
<div id="ref-klasson2024discussion" class="csl-entry" role="listitem">
Klasson KT. 2024. A discussion and evaluation of statistical procedures used by JIMB authors when comparing means. Journal of Industrial Microbiology and Biotechnology 51: kuae001.
</div>
<div id="ref-konietschke2015nparcomp" class="csl-entry" role="listitem">
Konietschke F, Placzek M, Schaarschmidt F, Hothorn LA. 2015. nparcomp: an R software package for nonparametric multiple comparisons and simultaneous confidence intervals. Journal of statistical software 64: 1–17.
</div>
<div id="ref-kozak2018s" class="csl-entry" role="listitem">
Kozak M, Piepho H-P. 2018. What’s normal anyway? Residual plots are more telling than significance tests when checking ANOVA assumptions. Journal of agronomy and crop science 204: 86–98.
</div>
<div id="ref-kozak2020analyzing" class="csl-entry" role="listitem">
Kozak M, Piepho H-P. 2020. Analyzing designed experiments: Should we report standard deviations or standard errors of the mean or standard errors of the difference or what? Experimental Agriculture 56: 312–319.
</div>
<div id="ref-salinas2023plant" class="csl-entry" role="listitem">
Salinas I, Hueso JJ, Força Baroni D, Cuevas J. 2023. Plant Growth, Yield, and Fruit Size Improvements in ‘Alicia’Papaya Multiplied by Grafting. Plants 12: 1189.
</div>
<div id="ref-sanchez2022hoverfly" class="csl-entry" role="listitem">
Sánchez M, Velásquez Y, González M, Cuevas J. 2022. Hoverfly pollination enhances yield and fruit quality in mango under protected cultivation. Scientia Horticulturae 304: 111320.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-tests-permutationstest.html" class="pagination-link" aria-label="Der Permutationstest">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-linear-reg-preface.html" class="pagination-link" aria-label="Grundlagen des Modellierens">
        <span class="nav-page-text">Grundlagen des Modellierens</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb247" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, see, knitr, scales, conflicted)</span></span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb247-8"><a href="#cb247-8" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb247-9"><a href="#cb247-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-10"><a href="#cb247-10" aria-hidden="true" tabindex="-1"></a><span class="in">gg_template &lt;- ggplot() +</span></span>
<span id="cb247-11"><a href="#cb247-11" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb247-12"><a href="#cb247-12" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(#axis.text.x = element_blank(),</span></span>
<span id="cb247-13"><a href="#cb247-13" aria-hidden="true" tabindex="-1"></a><span class="in">        #axis.ticks.x = element_blank(),</span></span>
<span id="cb247-14"><a href="#cb247-14" aria-hidden="true" tabindex="-1"></a><span class="in">        # axis.text.y = element_text(color = "#CC79A7", face = "bold", size = 14),</span></span>
<span id="cb247-15"><a href="#cb247-15" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_text(),</span></span>
<span id="cb247-16"><a href="#cb247-16" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.ticks.y = element_blank(),</span></span>
<span id="cb247-17"><a href="#cb247-17" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text = element_text(size = 12),</span></span>
<span id="cb247-18"><a href="#cb247-18" aria-hidden="true" tabindex="-1"></a><span class="in">        #axis.title = element_text(size = 14, face = "bold"),</span></span>
<span id="cb247-19"><a href="#cb247-19" aria-hidden="true" tabindex="-1"></a><span class="in">        plot.title = element_text(size = 16, face = "bold"),</span></span>
<span id="cb247-20"><a href="#cb247-20" aria-hidden="true" tabindex="-1"></a><span class="in">        plot.subtitle = element_text(size = 12, face = "italic"),</span></span>
<span id="cb247-21"><a href="#cb247-21" aria-hidden="true" tabindex="-1"></a><span class="in">        plot.caption = element_text(face = "italic"),</span></span>
<span id="cb247-22"><a href="#cb247-22" aria-hidden="true" tabindex="-1"></a><span class="in">        legend.position = "none") +</span></span>
<span id="cb247-23"><a href="#cb247-23" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_okabeito() +</span></span>
<span id="cb247-24"><a href="#cb247-24" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_okabeito() </span></span>
<span id="cb247-25"><a href="#cb247-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-26"><a href="#cb247-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-27"><a href="#cb247-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-28"><a href="#cb247-28" aria-hidden="true" tabindex="-1"></a><span class="fu"># Der Post-hoc Test {#sec-posthoc}</span></span>
<span id="cb247-29"><a href="#cb247-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-30"><a href="#cb247-30" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-tests-posthoc2.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb247-31"><a href="#cb247-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-32"><a href="#cb247-32" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Comparison is the thief of joy." --- Theodore Roosevelt*</span></span>
<span id="cb247-33"><a href="#cb247-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-34"><a href="#cb247-34" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel wollen wir uns mit den multiplen Vergleichen (eng. *post hoc analysis*) oder auch paarweise Gruppenvergleiche genannt beschäftigen. Wir kennen diese multiplen Tests auch unter dem Namen *Post-hoc Tests*, da wir historisch diese Tests *nach* einer ANOVA durchgeführt haben. Das heißt, wir wollen statistisch Testen, ob sich verschiedene Gruppen einer Behandlung voneinander unterschieden. Technisch Testen wir dabei, ob sich die Level eines Faktors voneinander unterscheiden. Wir können dabei mehrere Faktoren bzw. Behandlungen berücksichtigen und gleichzeitig Testen. Wenn wir nur einen Faktor betrachten, dann sprechen wir von einem einfaktoriellen Vergleich. Wenn wir zwei Behandlungen betrachten, dann entsprechend von einem zweifaktoriellen Vergleich. Sehr selten haben wir dann noch den Fall vorliegen, dass wir drei Faktoren betrachten wollen. In einer Abschlussarbeit haben wir faktisch keine Versuche wo wir mehr als drei Faktoren in einem Gruppenvergleich berücksichtigen.</span>
<span id="cb247-35"><a href="#cb247-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-36"><a href="#cb247-36" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb247-37"><a href="#cb247-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Keine Zeit? Dann nutze gleich den effektiven Pfad mit `{emmeans}`!</span></span>
<span id="cb247-38"><a href="#cb247-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-39"><a href="#cb247-39" aria-hidden="true" tabindex="-1"></a>Dieses Kapitel ist lang und vieles habe ich hier gerechnet, damit du es nicht musst. Wenn du keine Zeit hast, dann springe gleich in den <span class="co">[</span><span class="ot">Abschnitt mit dem effektiven Pfad mit `{emmeans}`</span><span class="co">](#sec-emmeans)</span> und lasse den Rest links und rechts liegen. Wir freuen uns das es den Rest gibt, aber du willst ja fertig werden und nicht staunen, was andere so alles entwickelt haben. Und das ist vollkommen okay!</span>
<span id="cb247-40"><a href="#cb247-40" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-41"><a href="#cb247-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-42"><a href="#cb247-42" aria-hidden="true" tabindex="-1"></a>Wo wollen wir also mit unserem Post-hoc Test hin? Betrachten wir dazu einmal eine wissenschaftliche Veröffentlichungen als Beispiele. In der folgenden Abbildung sehen wir ein Säulendigramm aus der wissenschaftlichen Veröffentlichung von @sanchez2022hoverfly mit dem Titel <span class="co">[</span><span class="ot">"Hoverfly pollination enhances yield and fruit quality in mango under protected cultivation"</span><span class="co">](https://www.sciencedirect.com/science/article/pii/S0304423822004411)</span>. Dargestellt ist der mittlere Anteil an tragenden Rispen (eng. *panicles*) von Mango unter verschiedenen Ausbringungsdichten von Schwebfliegen (eng. *hoverfly*).</span>
<span id="cb247-43"><a href="#cb247-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-44"><a href="#cb247-44" aria-hidden="true" tabindex="-1"></a><span class="al">![*"Panicles with commercial fruit (%) at 2019 and 2020 harvest. In the same year, different letters indicate significant differences among treatments (Tukey's test p\&lt;0.05)."* Quelle: @sanchez2022hoverfly](images/eda/zerforschen_hoverfly.png)</span>{#fig-zerforschen-hoverfly fig-align="center" width="80%"}</span>
<span id="cb247-45"><a href="#cb247-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-46"><a href="#cb247-46" aria-hidden="true" tabindex="-1"></a>Wir haben hier ein typisches zweifaktorielles Design vorliegen. Zum einen den Faktor *treatment* mit den Gruppen *High density*, *medium density*, *Low density* und *Control*. Der zweite Faktor ist dann das Jahr der Messung mit zwei Jahren. Wir sehen hier die Buchstaben des *Compact letter displays* über den Mittelwerten als Säulen dargestellt. Das *Compact letter display* wollen wir dann hier in diesem Kapitel erstellen. Ein weiteres Beispiel findest du in der wissenschaftlichen Veröffentlichung von @salinas2023plant mit dem Titel <span class="co">[</span><span class="ot">"Plant Growth, Yield, and Fruit Size Improvements in 'Alicia' Papaya Multiplied by Grafting"</span><span class="co">](https://www.mdpi.com/2223-7747/12/5/1189)</span>.</span>
<span id="cb247-47"><a href="#cb247-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-48"><a href="#cb247-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretischer Hintergrund</span></span>
<span id="cb247-49"><a href="#cb247-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-50"><a href="#cb247-50" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb247-51"><a href="#cb247-51" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01_small.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb247-52"><a href="#cb247-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-53"><a href="#cb247-53" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In diesem Kapitel werde ich ein paar Engel der Statistik niedergeschlagen oder überfahren. Ich lasse aus Gründen der Didaktik ein paar Sachen weg und dadurch wird einiges leider dann *mathematisch* unkorrekt. Oder eben das klassische </span><span class="co">[</span><span class="ot">lying-to-children</span><span class="co">](https://en.wikipedia.org/wiki/Lie-to-children)</span><span class="at">. Ich kann damit leben und nehme es auf mich damit du deine Abschlussarbeit fertig bekommst.</span></span>
<span id="cb247-54"><a href="#cb247-54" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb247-55"><a href="#cb247-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-56"><a href="#cb247-56" aria-hidden="true" tabindex="-1"></a>Fangen wir nochmal mit etwas theoretischen Hintergrund an. Das heißt wir schauen uns nochmal die wichtigsten Konzepte vom multiplen Testen einmal an. Wichtig ist hier, dass du eben mehr als zwei Gruppen miteinander vergleichen willst. Teilweise hast du mehr als sieben Gruppen und dann wird es schon eine Menge an Vergleichen. Wenn du alle möglichen vergleiche zwischen allen Gruppen rechnen willst, dann nennt man dies den *all-pair* Vergleich. Es werden eben alle möglichen Paare an Gruppen verglichen. Beginnen wir also mit der Frage nach der Anzahl an möglichen Vergleichen und was dies für unsere statistische Auswertung bedeutet.</span>
<span id="cb247-57"><a href="#cb247-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-58"><a href="#cb247-58" aria-hidden="true" tabindex="-1"></a>Wie viel ist den *all-pair*? Also alle möglichen Vergleiche?</span>
<span id="cb247-59"><a href="#cb247-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-60"><a href="#cb247-60" aria-hidden="true" tabindex="-1"></a>:   Wenn du alle möglichen Mittelwertkombinationen testen willst, dann ist die Formel für die Berechnung der durchzuführenden Vergleiche $r = m(m-1)/2$. Oder um es einmal in der folgenden Tabelle etwas konkreter darzustellen, werden es sehr schnell sehr viele Vergleiche. Dabei drückst du mit jeder zusätzlichen Behandlungsgruppe das Signifikanzniveau $\alpha$ weiter runter, da die Anzahl an potenziellen Vergleichen sehr schnell ansteigt. So fällt dann auch der maximal noch signifikante p-Wert schnell ab. Damit brauchst du dann immer stärkere Effekt, wie einen Mittelwertsunterschied, um überhaupt noch was signifikantes aus einem statistischen Test wiedergeben zu bekommen. In der folgenden Tabelle siehst du dann nochmal den Zusammenhang. Ohne Adjustierung des Signifikanzniveaus erhalten wir schon ab sechs Gruppen mindestens einen signifikanten Unterschied auch wenn es gar keinen Unterschied in den Daten gibt. Denke immer daran, das Signifikanzniveau $\alpha$ gibt an wie groß unsere Fehlerrate an falsch positiven Ergebnissen ist. Also die Nullhypothese mit dem statistischen Test abzulehnen, obwohl wir eigenlich keinen Unterschied vorliegen haben.</span>
<span id="cb247-61"><a href="#cb247-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-64"><a href="#cb247-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-65"><a href="#cb247-65" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb247-66"><a href="#cb247-66" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-67"><a href="#cb247-67" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-68"><a href="#cb247-68" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-allpair-bonf</span></span>
<span id="cb247-69"><a href="#cb247-69" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Zusammenhang von der Anzahl an Gruppen oder Behandlungen und der sich ergebenden Anzahl an *all-pair* Vergleichen. Daraus ergibt sich ein stark abfallendes Signifikanzniveau. Der maximal noch signifikante p-Wert fällt dementsprechend auch schnell ab. **Ohne Adjustierung** erhalten wir schon ab sechs Gruppen mindestens einen fälschlichen signifikanten Unterschied."</span></span>
<span id="cb247-70"><a href="#cb247-70" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">m =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">12</span>,</span>
<span id="cb247-71"><a href="#cb247-71" aria-hidden="true" tabindex="-1"></a>       <span class="at">r =</span> m<span class="sc">*</span>(m<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb247-72"><a href="#cb247-72" aria-hidden="true" tabindex="-1"></a>       <span class="at">a =</span> <span class="fu">percent</span>(<span class="fu">round</span>(<span class="fl">0.05</span><span class="sc">/</span>r, <span class="dv">4</span>)),</span>
<span id="cb247-73"><a href="#cb247-73" aria-hidden="true" tabindex="-1"></a>       <span class="at">p =</span> <span class="fu">round</span>(<span class="fl">0.05</span><span class="sc">/</span>r, <span class="dv">4</span>),</span>
<span id="cb247-74"><a href="#cb247-74" aria-hidden="true" tabindex="-1"></a>       <span class="at">fp =</span> <span class="fu">round</span>(r<span class="sc">/</span><span class="dv">20</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-75"><a href="#cb247-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"Anzahl Gruppen"</span>, <span class="st">"Anzahl Vergleiche"</span>, </span>
<span id="cb247-76"><a href="#cb247-76" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Signifikanzniveau $</span><span class="sc">\\</span><span class="st">alpha$"</span>, <span class="st">"Maximal signifikanter p-Wert"</span>,</span>
<span id="cb247-77"><a href="#cb247-77" aria-hidden="true" tabindex="-1"></a>              <span class="st">"$H_0$ fälschlich abgelehnt"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-78"><a href="#cb247-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb247-79"><a href="#cb247-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-80"><a href="#cb247-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-81"><a href="#cb247-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-82"><a href="#cb247-82" aria-hidden="true" tabindex="-1"></a>Was bedeutet *konservativ* und was *liberal*?</span>
<span id="cb247-83"><a href="#cb247-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-84"><a href="#cb247-84" aria-hidden="true" tabindex="-1"></a>:   Häufiger schreibe ich mal das ein statistischer Test konservativ wird oder aber eher liberal testet. Das klingt jetzt etwas schräg sind aber bekannte Begriffe in der Fachsprache der Statistik. Es geht hierbei um die Bewertung des globalen Signifikanzniveau über alle Vergleiche hinweg. Wichtig ist, dass wir häufig nicht exakt wissen, wie groß das Signifikanzniveau in deinem speziellen Datenfall ist. Deshalb ist *konservativ* und *liberal* eher als Tendenz zu verstehen.</span>
<span id="cb247-85"><a href="#cb247-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-86"><a href="#cb247-86" aria-hidden="true" tabindex="-1"></a>Wenn wir von einem konservativen Test sprechen, dann meinen wir, dass wir weniger signifikante Ergebnisse erwarten werden, als es bei einem Signifikanzniveau von $\alpha$ gleich 5% zu erwarten wäre. Der Post-hoc Test nutzt nicht die vollen 5% Fehlerrate sondern testet global zu einem niedrigeren Signifikanzniveau. Wenn wir von einem liberalen Test sprechen, dann testen wir zu einem höheren Signifikanzniveau als $\alpha$ gleich 5%. Wir werden also mehr signifikante Unterschiede finden als wir mit einer globalen Fehlerrate von 5% erwarten würden.</span>
<span id="cb247-87"><a href="#cb247-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-88"><a href="#cb247-88" aria-hidden="true" tabindex="-1"></a>|   | Globales Signifikanzniveau $\alpha$ | Bemerkung |</span>
<span id="cb247-89"><a href="#cb247-89" aria-hidden="true" tabindex="-1"></a>|:--:|:--:|:---|</span>
<span id="cb247-90"><a href="#cb247-90" aria-hidden="true" tabindex="-1"></a>| konservativ | $\leq 5\%$ | Weniger signifikante Unterschiede |</span>
<span id="cb247-91"><a href="#cb247-91" aria-hidden="true" tabindex="-1"></a>| liberal | $\geq 5\%$ | Mehr signifikante Unterschiede |</span>
<span id="cb247-92"><a href="#cb247-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-93"><a href="#cb247-93" aria-hidden="true" tabindex="-1"></a>: Zusammenfassung der Begrifflichkeit *konservativ* und *liberal* im Kontext eines multipen Tests. {#tbl-theo-con-lib}</span>
<span id="cb247-94"><a href="#cb247-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-95"><a href="#cb247-95" aria-hidden="true" tabindex="-1"></a>Wie viele multiple Tests gibt es eigentlich?</span>
<span id="cb247-96"><a href="#cb247-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-97"><a href="#cb247-97" aria-hidden="true" tabindex="-1"></a>:   Es gibt eine Menge an multiplen Tests oder auch Post-hoc Tests. Ich habe dir hier mal eine kleine Tabelle mitgebracht, die dir vier Post-hoc Tests im Vergleich zeigt. Ich habe die Auswahl etwas willkürlich getroffen, es gibt noch viel mehr Post-hoc Tests als ich in diesem Kapitel vorstelle. Wichtig für dich ist aber, dass es eigentlich auf die Entscheidung zwischen dem Tukey HSD Test oder eben dem R Paket <span class="in">`{emmeans}`</span> herausläuft. Ja, es gibt eben noch die anderen Tests, aber diese haben eine eher Nischenanwendung. Darüber hinaus kannst du <span class="in">`{emmeans}`</span> so konfigurieren, dass du im Prinzip einen besseren Tukey HSD Test für Varianzhomogenität oder aber einen Games Howell Test für Vanrianzheterogenität rechnest ohne die Nachteil der orginalen Implemntierung. Das ist doch toll!</span>
<span id="cb247-98"><a href="#cb247-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-99"><a href="#cb247-99" aria-hidden="true" tabindex="-1"></a>In einer normalen agarwissenschaftlichen Abschlussarbeit mit einem Feldexperiment und zwei Faktoren $f_1$ und $f_2$ läuft es eben dann doch auf den Tukey HSD Test oder Games Howell Test heraus. So ist eben die Normalverteilung des Messwertes $y$ eben ein sehr starkes Kriterium zur Wahl des Tests. Da dann häufig noch die ANOVA vorgeschaltet wird sind wir dann im *ANOVA Pfad* mit dem Tukey HSD Test. Wichtig ist noch, dass du schauen musst, ob die Varianz in deinen Gruppen $x$ eher homogen oder heterogen ist. Davon hängt dann die Entschiedung für oder gegen den Tukey HSD Test ab. Wenn dein Messwert $y$ nicht normalverteilt ist, dann musst du eine anderes Modell rechnen, diese Modelle stelle ich später noch vor. Auch ist die Frage, ob du adjustierte p-Werte möchtest oder nicht. Hier hängt es auch von der Anwendung ab, ob du die Adjustierung für multiple Vergleiche ausstellen kannst.</span>
<span id="cb247-100"><a href="#cb247-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-101"><a href="#cb247-101" aria-hidden="true" tabindex="-1"></a>|   | Tukey HSD | Games Howell | <span class="in">`{emmeans}`</span> | <span class="in">`{multcomp}`</span> |</span>
<span id="cb247-102"><a href="#cb247-102" aria-hidden="true" tabindex="-1"></a>|:---|:--:|:--:|:--:|:--:|</span>
<span id="cb247-103"><a href="#cb247-103" aria-hidden="true" tabindex="-1"></a>| **Verteilung von** $y$ | normalverteilt | normalverteilt | beliebig | beliebig |</span>
<span id="cb247-104"><a href="#cb247-104" aria-hidden="true" tabindex="-1"></a>| **Varianzen der Gruppen** $x$ | homogen | heterogen | beliebig | beliebig |</span>
<span id="cb247-105"><a href="#cb247-105" aria-hidden="true" tabindex="-1"></a>| **Fallzahl per Gruppe** $n_g$ | balanciert; $n_g \geq 4$ | beliebig; $n_g \geq 6$ | beliebig; $n_g \geq 4$ | beliebig; $n_g \geq 4$ |</span>
<span id="cb247-106"><a href="#cb247-106" aria-hidden="true" tabindex="-1"></a>| **Adjustierte p-Werte** | immer | immer | beliebig | beliebig |</span>
<span id="cb247-107"><a href="#cb247-107" aria-hidden="true" tabindex="-1"></a>| **Mögliche Vergleiche** | *all-pair* | *all-pair* | beliebig | beliebig |</span>
<span id="cb247-108"><a href="#cb247-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-109"><a href="#cb247-109" aria-hidden="true" tabindex="-1"></a>: Übersicht über vier ausgewählte Post-hoc Tests und deren statistischen Eigenschaften. Insbesondere sticht das R Paket <span class="in">`{emmeans}`</span> mit seiner Flexibilität und einfachen Handbarkeit heraus. Die Mindestfallzahl per Gruppe $n_g$ ist eher als Empfehlung zu verstehen und als untere Grenze. Achtung, teilweise müssen die Optionen *aktiv* von dir aktiviert werden. Sie dazu auch den <span class="co">[</span><span class="ot">Friedhof der Post-ho Tests</span><span class="co">](#sec-friedhof-posthoc)</span> in diesem Kapitel. {#tbl-übersicht}</span>
<span id="cb247-110"><a href="#cb247-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-111"><a href="#cb247-111" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb247-112"><a href="#cb247-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-113"><a href="#cb247-113" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb247-114"><a href="#cb247-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-115"><a href="#cb247-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb247-116"><a href="#cb247-116" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb247-117"><a href="#cb247-117" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb247-118"><a href="#cb247-118" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, see, nparcomp,</span></span>
<span id="cb247-119"><a href="#cb247-119" aria-hidden="true" tabindex="-1"></a><span class="in">               multcomp, emmeans,  multcompView, nlme, janitor,</span></span>
<span id="cb247-120"><a href="#cb247-120" aria-hidden="true" tabindex="-1"></a><span class="in">               parameters, patchwork, agricolae, broom, rstatix,</span></span>
<span id="cb247-121"><a href="#cb247-121" aria-hidden="true" tabindex="-1"></a><span class="in">               DescTools, rcompanion, magrittr, quantreg, effectsize,</span></span>
<span id="cb247-122"><a href="#cb247-122" aria-hidden="true" tabindex="-1"></a><span class="in">               conflicted)</span></span>
<span id="cb247-123"><a href="#cb247-123" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb247-124"><a href="#cb247-124" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb247-125"><a href="#cb247-125" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(magrittr::set_names)</span></span>
<span id="cb247-126"><a href="#cb247-126" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(effectsize::eta_squared)</span></span>
<span id="cb247-127"><a href="#cb247-127" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb247-128"><a href="#cb247-128" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb247-129"><a href="#cb247-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-130"><a href="#cb247-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-131"><a href="#cb247-131" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb247-132"><a href="#cb247-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-133"><a href="#cb247-133" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb247-134"><a href="#cb247-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-135"><a href="#cb247-135" aria-hidden="true" tabindex="-1"></a>Auch brauchen wir hier in diesem Kapitel einfache Datensätze an denen wir eine einfaktorielle und eine zweifaktorielle Analyse nachvollziehen können. Ich habe dir in einem Abschnitt noch ein paar Fallbeispiele in <span class="in">`{emmeans}`</span> mitgebracht, die dann einen stärkeren agrarwissenschaftlichen Bezug haben. Für den Anfang reichen aber die beiden Beispiele für das Verständnis dieses Kapitels vollkommen aus. Die Visualisierung der Datensätze schauen wir uns dann in dem Abschnitt zur Abschätzung der Varianzhonogenität und Varianzheterogenität nochmal näher an.</span>
<span id="cb247-136"><a href="#cb247-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-137"><a href="#cb247-137" aria-hidden="true" tabindex="-1"></a>Der erste Datenstaz besteht aus der Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> von verschiedenen Tierarten. Dabei ist dann die Sprungllänge unser Messwert $y$ oder Outcome. Unsere Behandlung sind dann die drei Tierarten Hund, Katze und Fuchs. Wir fragen uns also, die verschiedenen Floharten unterschiedlich weit springen. Ich habe dir einmal die Daten in das Objekt <span class="in">`fac1_tbl`</span> geladen.</span>
<span id="cb247-138"><a href="#cb247-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-141"><a href="#cb247-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-142"><a href="#cb247-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-143"><a href="#cb247-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-144"><a href="#cb247-144" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb247-145"><a href="#cb247-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb247-146"><a href="#cb247-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span>
<span id="cb247-147"><a href="#cb247-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-148"><a href="#cb247-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-149"><a href="#cb247-149" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns die Daten einmal in der folgenden Tabelle als Auszug einmal an. Wichtig ist hier nochmal, dass du eben einen Faktor <span class="in">`animal`</span> mit drei Leveln also Gruppen vorliegen hast. Wir wolen jetzt die drei Tierarten hinsichtlich ihrer Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> miteinander vergleichen. Weil wir jetzt mehr als zwei Gruppen vorliegen haben, sprechen wir von einem multiplen Vergleich.</span>
<span id="cb247-150"><a href="#cb247-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-153"><a href="#cb247-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-154"><a href="#cb247-154" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb247-155"><a href="#cb247-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-156"><a href="#cb247-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-157"><a href="#cb247-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1fac-table</span></span>
<span id="cb247-158"><a href="#cb247-158" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle der Sprungweiten in [cm] als Messwert $y$ von Hunde-, Katzen- und Fuchsflöhen. Der Datensatz ist einfaktoriell, da wir nur einen Behandlungsfaktor $x$ mit `animal` vorliegen haben."</span></span>
<span id="cb247-159"><a href="#cb247-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-160"><a href="#cb247-160" aria-hidden="true" tabindex="-1"></a>fac1_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb247-161"><a href="#cb247-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length)</span>
<span id="cb247-162"><a href="#cb247-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-163"><a href="#cb247-163" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb247-164"><a href="#cb247-164" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fac1_raw_tbl)),</span>
<span id="cb247-165"><a href="#cb247-165" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-166"><a href="#cb247-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb247-167"><a href="#cb247-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-168"><a href="#cb247-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-169"><a href="#cb247-169" aria-hidden="true" tabindex="-1"></a>Wir vergleichen natürlich nicht die Sprungweiten in <span class="sc">\[</span>cm<span class="sc">\]</span> direkt mitteinandern sondern rechnen natürlich vorher die deskriptive Statistiken wie Mittelwert und Standardabweichung aus. Für die Berechnung des Standardfehlers nutzen wir die Funktion <span class="in">`standard_error()`</span> aus dem R Paket <span class="in">`{parameters}`</span>. Am Ende vergleichen wir die mittleren Sprungweiten der Hunde-, Katzen-, und Fuchsflöhe miteinander. Wir können anhand der Mittelwerte schon Tendenzen in den Gruppen sehen.</span>
<span id="cb247-170"><a href="#cb247-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-173"><a href="#cb247-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-174"><a href="#cb247-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb247-175"><a href="#cb247-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-176"><a href="#cb247-176" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-177"><a href="#cb247-177" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1fac-mean</span></span>
<span id="cb247-178"><a href="#cb247-178" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Deskriptive Maßzahlen der Sprungweite in [cm] gruppiert nach den drei Floharten."</span></span>
<span id="cb247-179"><a href="#cb247-179" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb247-180"><a href="#cb247-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">|&gt;</span> </span>
<span id="cb247-181"><a href="#cb247-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mittelwert =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb247-182"><a href="#cb247-182" aria-hidden="true" tabindex="-1"></a>            <span class="at">Standardabweichung =</span> <span class="fu">sd</span>(jump_length),</span>
<span id="cb247-183"><a href="#cb247-183" aria-hidden="true" tabindex="-1"></a>            <span class="at">SE =</span> <span class="fu">standard_error</span>(jump_length)) <span class="sc">|&gt;</span> </span>
<span id="cb247-184"><a href="#cb247-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-185"><a href="#cb247-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb247-186"><a href="#cb247-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-187"><a href="#cb247-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-188"><a href="#cb247-188" aria-hidden="true" tabindex="-1"></a>Neben dem einfaktoriellen Datensatz wollen wir uns noch den häufigeren Fall mit zwei Faktoren anschauen. Wir haben also nicht nur die drei Floharten vorliegen und wollen wissen ob diese unterschiedlich weit springen. Darüber hinaus haben wir noch einen zweiten Faktor gewählt. Wir haben die Sprungweiten der Hunde-, Katzen- und Fuchsflöhe nämlich an zwei Messorten, der Stadt und dem Dorf, gemessen. Dadurch haben wir jetzt den Faktor <span class="in">`animal`</span> und den Faktor <span class="in">`site`</span> vorliegen. Wiederum fragen wir usn, ob sich die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> der drei Floharten in den beiden Messorten unterscheidet. Im Folgenden lade ich einmal den Datensatz in das Objekt <span class="in">`fac2_tbl`</span>.</span>
<span id="cb247-189"><a href="#cb247-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-192"><a href="#cb247-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-193"><a href="#cb247-193" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-194"><a href="#cb247-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-195"><a href="#cb247-195" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox_site.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-196"><a href="#cb247-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, site, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb247-197"><a href="#cb247-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"city"</span>, <span class="st">"village"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-198"><a href="#cb247-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb247-199"><a href="#cb247-199" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">as_factor</span>(site))</span>
<span id="cb247-200"><a href="#cb247-200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-201"><a href="#cb247-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-202"><a href="#cb247-202" aria-hidden="true" tabindex="-1"></a>Betrachten wir als erstes einen Auszug aus der Datentabelle. Wir haben hier als Messwert oder Outcome $y$ die Sprungweite <span class="in">`jump_length`</span> vorliegen. Als ersten Faktor die Variable <span class="in">`animal`</span> und als zweiten Faktor die Variable <span class="in">`site`</span> festgelegt.</span>
<span id="cb247-203"><a href="#cb247-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-206"><a href="#cb247-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-207"><a href="#cb247-207" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb247-208"><a href="#cb247-208" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-209"><a href="#cb247-209" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-210"><a href="#cb247-210" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-2fac-table</span></span>
<span id="cb247-211"><a href="#cb247-211" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle der Sprungweiten in [cm] als Messwert $y$ von Hunde-, Katzen- und Fuchsflöhen an zwei verschiedenen Messorten Stadt und Dorf. Der Datensatz ist zweifaktoriell, da wir einen Behandlungsfaktor $x$ mit `animal` und einen zweiten Faktor mit `site` vorliegen haben."</span></span>
<span id="cb247-212"><a href="#cb247-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-213"><a href="#cb247-213" aria-hidden="true" tabindex="-1"></a>fac2_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox_site.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-214"><a href="#cb247-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, site, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb247-215"><a href="#cb247-215" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"city"</span>, <span class="st">"village"</span>)) </span>
<span id="cb247-216"><a href="#cb247-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-217"><a href="#cb247-217" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fac2_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb247-218"><a href="#cb247-218" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fac2_raw_tbl)),</span>
<span id="cb247-219"><a href="#cb247-219" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fac2_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-220"><a href="#cb247-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb247-221"><a href="#cb247-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-222"><a href="#cb247-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-223"><a href="#cb247-223" aria-hidden="true" tabindex="-1"></a>Auch hier schauen wir uns einmal die deskritive Zusammenfassung der Daten an. Hier musst du natürlich beachten welchen Faktor du in welchem verschaltest hast. Klingt jetzt erstmal sperrig, aber es wird vermutlich am Beispiel klarer. Wir haben ja an jedem Messort alle drei Tierarten gemessen. Daher wollen wir natürlich für jeden Messort die Zusammenfassung der drei Tierarten haben. Du kannst das auch andersherum gruppieren, aber für mich macht es sorum mehr Sinn. Für die Berechnung des Standardfehlers nutzen wir die Funktion <span class="in">`standard_error()`</span> aus dem R Paket <span class="in">`{parameters}`</span>. Wie du siehst, sind die Mittelwerte unterschiedlich, was auf einen Unterschied zwischen den Floharten im Bezug auf die Sprungweite hindeutet.</span>
<span id="cb247-224"><a href="#cb247-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-227"><a href="#cb247-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-228"><a href="#cb247-228" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb247-229"><a href="#cb247-229" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-230"><a href="#cb247-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-231"><a href="#cb247-231" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-2fac-mean</span></span>
<span id="cb247-232"><a href="#cb247-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Deskriptive Maßzahlen der Sprungweite in [cm] gruppiert nach den drei Floharten und den zwei Messorten."</span></span>
<span id="cb247-233"><a href="#cb247-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-234"><a href="#cb247-234" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb247-235"><a href="#cb247-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal, site) <span class="sc">|&gt;</span> </span>
<span id="cb247-236"><a href="#cb247-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mittelwert =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb247-237"><a href="#cb247-237" aria-hidden="true" tabindex="-1"></a>            <span class="at">Standardabweichung =</span> <span class="fu">sd</span>(jump_length),</span>
<span id="cb247-238"><a href="#cb247-238" aria-hidden="true" tabindex="-1"></a>            <span class="at">SE =</span> <span class="fu">standard_error</span>(jump_length)) <span class="sc">|&gt;</span> </span>
<span id="cb247-239"><a href="#cb247-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-240"><a href="#cb247-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb247-241"><a href="#cb247-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-242"><a href="#cb247-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-243"><a href="#cb247-243" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modell</span></span>
<span id="cb247-244"><a href="#cb247-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-245"><a href="#cb247-245" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit der Frage, was ein Modell ist. Ein Modell beschreibt, wie du deine Daten auswerten willst. Zuerst einmal beschreibt es in der <span class="in">`formula`</span>-Schreibweise, welche Spalten du aus deinem Datensatz auswerten willst. Du musst den Funktionen in R ja mitteilen welche Variablen du analysieren möchtest. In dem nachfolgenden Abschnitt schauen wir uns einmal den Messwert $y$ näher an und entscheiden dann noch, ob wir in den Gruppen $x$ eine Varianzhomogenität vorliegen haben oder eher eine Varianzheterogenität finden.</span>
<span id="cb247-246"><a href="#cb247-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-247"><a href="#cb247-247" aria-hidden="true" tabindex="-1"></a><span class="fu">### Faktorielle Analyse</span></span>
<span id="cb247-248"><a href="#cb247-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-249"><a href="#cb247-249" aria-hidden="true" tabindex="-1"></a>Beginnen wir also mit der Festlegung welche Art der Analyse wir rechnen wollen. Wir schauen uns jetzt einmal das einfaktorielle sowie das zweifaktorielle Modell näher an. Du könntest auch mehr als zwei Faktoren auswerten wollen, aber dann musst du einmal in ein anderes Kapitel wechseln. Wir beginnen hier mit dem einfacheren Fall oder auch den häufigsten. Zurst einmal haben wir ein faktorielles Modell vorliegen. Hier einmal die generelle Form mit belieb vielen Faktoren $f$.</span>
<span id="cb247-250"><a href="#cb247-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-251"><a href="#cb247-251" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-252"><a href="#cb247-252" aria-hidden="true" tabindex="-1"></a>y \sim f_1 + f_2 + ... + f_p + f_1 \times f_2 + ... + f_1 \times f_2 \times f_3</span>
<span id="cb247-253"><a href="#cb247-253" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-254"><a href="#cb247-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-255"><a href="#cb247-255" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb247-256"><a href="#cb247-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-257"><a href="#cb247-257" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$y$ gleich dem Messwert oder Outcome</span>
<span id="cb247-258"><a href="#cb247-258" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_1 + f_2 + ... + f_p$ gleich experimenteller Faktoren</span>
<span id="cb247-259"><a href="#cb247-259" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_1 \times f_2$ gleich einem beispielhaften Interaktionsterm erster Ordnung</span>
<span id="cb247-260"><a href="#cb247-260" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_1 \times f_2 \times f_3$ gleich einem beispielhaften Interaktionsterm zweiter Ordnung</span>
<span id="cb247-261"><a href="#cb247-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-262"><a href="#cb247-262" aria-hidden="true" tabindex="-1"></a>Zusätzlich können noch Interaktionsterme höherer Ordnungen entstehen, aber hier wird es extrem schwierig diese Interaktionsterme dann auch zu interpretieren. Wir werden uns aber in diesem Kapitel auf ein einfaktorielles sowie zweifaktorielles Modell beschränken. Wenn du theoretisch das zweifaktorielle Modell anwenden kannst, dann kannst auch mit mehr Faktoren einen Post-hoc Test rechnen.</span>
<span id="cb247-263"><a href="#cb247-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-264"><a href="#cb247-264" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktorielles Modell {.unnumbered .unlisted}</span></span>
<span id="cb247-265"><a href="#cb247-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-266"><a href="#cb247-266" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit dem einfaktoriellen Modell (eng. *one-way design*). In einem einfaktoriellen Modell haben wir einen Messwert $y$ sowie einen Faktor mit beliebig vielen Leveln vorliegen. Dabei beschreiben die Level dann die einzelnen Gruppen. In unserem Fall hier haben wir es mit multiplen Vergleichen zu tun, so dass der Faktor natürlich mehr als zwei Level hat.</span>
<span id="cb247-267"><a href="#cb247-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-268"><a href="#cb247-268" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-269"><a href="#cb247-269" aria-hidden="true" tabindex="-1"></a>y \sim f_1</span>
<span id="cb247-270"><a href="#cb247-270" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-271"><a href="#cb247-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-272"><a href="#cb247-272" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb247-273"><a href="#cb247-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-274"><a href="#cb247-274" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$y$ gleich dem Messwert oder Outcome, wie die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> als <span class="in">`jump_length`</span>.</span>
<span id="cb247-275"><a href="#cb247-275" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_1$ gleich der Behandlung als Faktor mit mehr als zwei Gruppen, wie die Tierart als <span class="in">`animal`</span>.</span>
<span id="cb247-276"><a href="#cb247-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-277"><a href="#cb247-277" aria-hidden="true" tabindex="-1"></a>Wir würden dann folgende Schreibweise in R in einem Modell nutzen.</span>
<span id="cb247-278"><a href="#cb247-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-281"><a href="#cb247-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-282"><a href="#cb247-282" aria-hidden="true" tabindex="-1"></a><span class="fu">as.formula</span>(jump_length <span class="sc">~</span> animal)</span>
<span id="cb247-283"><a href="#cb247-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-284"><a href="#cb247-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-285"><a href="#cb247-285" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktorielles Modell {.unnumbered .unlisted}</span></span>
<span id="cb247-286"><a href="#cb247-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-287"><a href="#cb247-287" aria-hidden="true" tabindex="-1"></a>Weit aus häufiger kommt das zweifaktorielle Modell (eng. *two-way design*) in den Agarwissenschaften vor. Wir haben hier nicht nur den Behandlungsfaktor $f_1$ sondern eben noch einen zweiten Faktor $f_2$ vorliegen. Was der zweite Faktor beschreibt, kann von Fragestellung zu Fragestellung sehr unterschiedlich sein. Wenn wir zwei Faktoren vorliegen haben, dann können wir auch die Interaktion zwischen den beiden Faktoren modelliere. Damit wollen wir die Frage beantworten, ob sich jede Faktorkombination gleich verhält oder ob es Unterschiede bei gewissen Faktorkombination gibt. Vielleicht verhalten sich ja Fuchsflöhe in der Stadt ganz anders als im Dorf im Vergleich zu Hunde-, und Katzenflöhen.</span>
<span id="cb247-288"><a href="#cb247-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-289"><a href="#cb247-289" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-290"><a href="#cb247-290" aria-hidden="true" tabindex="-1"></a>y \sim f_1 + f_2 + f_1 \times f_2</span>
<span id="cb247-291"><a href="#cb247-291" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-292"><a href="#cb247-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-293"><a href="#cb247-293" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb247-294"><a href="#cb247-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-295"><a href="#cb247-295" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$y$ gleich dem Messwert oder Outcome, wie die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> als <span class="in">`jump_length`</span>.</span>
<span id="cb247-296"><a href="#cb247-296" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_1$ gleich der Behandlung als ersten Faktor mit mehr als zwei Gruppen, wie die Tierart als <span class="in">`animal`</span>.</span>
<span id="cb247-297"><a href="#cb247-297" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_2$ gleich dem zweiten Faktor, wie der Messort als <span class="in">`site`</span>.</span>
<span id="cb247-298"><a href="#cb247-298" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_1 \times f_2$ gleich dem Interaktionsterm zwischen den beiden Faktoren Tierart und Messort.</span>
<span id="cb247-299"><a href="#cb247-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-300"><a href="#cb247-300" aria-hidden="true" tabindex="-1"></a>Wir würden dann folgende Schreibweise in R in einem Modell nutzen.</span>
<span id="cb247-301"><a href="#cb247-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-304"><a href="#cb247-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-305"><a href="#cb247-305" aria-hidden="true" tabindex="-1"></a><span class="fu">as.formula</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site)</span>
<span id="cb247-306"><a href="#cb247-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-307"><a href="#cb247-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-308"><a href="#cb247-308" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mehrfaktorielles Modell {.unnumbered .unlisted}</span></span>
<span id="cb247-309"><a href="#cb247-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-310"><a href="#cb247-310" aria-hidden="true" tabindex="-1"></a>Am Ende können wir dann noch den Fall haben, dass wir noch mehr Faktoren $z$ in unserem Modell berücksichtigen wollen. Hier wird es dann komplizierter. Wichtig ist hier, dass du meistens auch zwei Faktoren hast, die dich am meisten interessieren und deren Interaktion du berücksichtigen willst. Ich mehr Interaktionen du rechnen willst desto mehr Fallzahl brauchst du, so dass hier *meisten* nur eine oder zwei Interaktionen funktionieren.</span>
<span id="cb247-311"><a href="#cb247-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-312"><a href="#cb247-312" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-313"><a href="#cb247-313" aria-hidden="true" tabindex="-1"></a>y \sim f_1 + f_2 + f_1 \times f_2 + z_1 + \cdots + z_p</span>
<span id="cb247-314"><a href="#cb247-314" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-315"><a href="#cb247-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-316"><a href="#cb247-316" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb247-317"><a href="#cb247-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-318"><a href="#cb247-318" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$y$ gleich dem Messwert oder Outcome, wie die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> als <span class="in">`jump_length`</span>.</span>
<span id="cb247-319"><a href="#cb247-319" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_1$ gleich der Behandlung als ersten Faktor mit mehr als zwei Gruppen, wie die Tierart als <span class="in">`animal`</span>.</span>
<span id="cb247-320"><a href="#cb247-320" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_2$ gleich dem zweiten Faktor, wie der Messort als <span class="in">`site`</span>.</span>
<span id="cb247-321"><a href="#cb247-321" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$f_1 \times f_2$ gleich dem Interaktionsterm zwischen den beiden Faktoren Tierart und Messort.</span>
<span id="cb247-322"><a href="#cb247-322" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$z_1 + \cdots + z_p$ als weitere experimentelle Faktoren der Umwelt, Zeit oder anderer Einwirkung auf den Messwert sowie einzelene Messungen von Beobachtungen.</span>
<span id="cb247-323"><a href="#cb247-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-324"><a href="#cb247-324" aria-hidden="true" tabindex="-1"></a>Wir würden dann folgende Schreibweise in R in einem Modell nutzen. Hier habe ich noch beispielhaft die beiden Faktoren Jahreszeit <span class="in">`season`</span> und Fütterungszustand <span class="in">`feeding`</span> ergänzt.</span>
<span id="cb247-325"><a href="#cb247-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-328"><a href="#cb247-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-329"><a href="#cb247-329" aria-hidden="true" tabindex="-1"></a><span class="fu">as.formula</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site <span class="sc">+</span> season <span class="sc">+</span> feeding)</span>
<span id="cb247-330"><a href="#cb247-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-331"><a href="#cb247-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-332"><a href="#cb247-332" aria-hidden="true" tabindex="-1"></a>Wenn du ein komplexes, mehrfaktorielles Modell auswerten willst, dann schaue dir den Abschnitt zu <span class="co">[</span><span class="ot">Multiple Gruppenvergleiche für gemischte Modelle</span><span class="co">](#sec-mult-comp-lmer-reg)</span> in dem entsprechenden Kapitel zu linearen gemischten Modellen an.</span>
<span id="cb247-333"><a href="#cb247-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-334"><a href="#cb247-334" aria-hidden="true" tabindex="-1"></a>Ein weitere Möglichkeit ist, dass du einfach über den Faktoren $z_1 + \cdots + z_p$ mittelst. Du schaust dir also weiterhin nur die beiden Hauptfaktoren $f_1$ und $f_2$ an und mittelst für jede Faktorkombination von $f_1$ und $f_2$ die Werte für die anderen Faktoren $z_1 + \cdots + z_p$. Hier verlierst du dann zwar einiges an Informationen, aber dies wird häufig für die einzelnen Pflanzenmessungen je Parzelle gemacht. Du mittelst alle Pflanzen in einer Parzelle und schaust dir die einzelnen Pflanzen als Faktor gar nicht an.</span>
<span id="cb247-335"><a href="#cb247-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-336"><a href="#cb247-336" aria-hidden="true" tabindex="-1"></a><span class="fu">### Der Messwert $y$</span></span>
<span id="cb247-337"><a href="#cb247-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-338"><a href="#cb247-338" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb247-339"><a href="#cb247-339" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb247-340"><a href="#cb247-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-341"><a href="#cb247-341" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel rechne ich alles einmal mit einem normalverteilten Messwert $y$ durch. Daher ist die Sprungweite <span class="in">`jump_length`</span> normalverteilt und ich kann daher als Modell die Funktion <span class="in">`aov()`</span> nutzen. Das Kapitel würde zu groß, wenn ich alle möglichen Verteilungen und deren Funktionen in R hier zeigen würde.</span>
<span id="cb247-342"><a href="#cb247-342" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-343"><a href="#cb247-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-344"><a href="#cb247-344" aria-hidden="true" tabindex="-1"></a>Bevor wir mit dem multiplen Vergleich anfangen können, müssen wir uns Fragen welcher Verteilungsfamilie eigentlich unser Messwert $y$ folgt. Je nachdem was du misst, musst du eine andere Verteilung modellieren und dann auch eine andere Funktion in R dafür nutzen. Welche statistische Modellierung für das $y$ soll ich für meinen Gruppenvergleich wählen? Ich habe in den jeweiligen Kapiteln zu den statistischen Modellen die jeweiligen Schritte für die Gruppenvergleiche hinterlegt und beschrieben. Daher kannst du in den Kapiteln einmal schauen, wie dein Messwert dort ausgewertet wird. Du findest dort auch immer ein Beispiel mit entsprechenden Daten. Ich konzentriere mich hier in diesem Kapitel auf einen normalverteilten Messwert $y$ mit der Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span>.</span>
<span id="cb247-345"><a href="#cb247-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-346"><a href="#cb247-346" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Normalverteilte Messwerte $\boldsymbol{y}$ {.unnumbered .unlisted}</span></span>
<span id="cb247-347"><a href="#cb247-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-348"><a href="#cb247-348" aria-hidden="true" tabindex="-1"></a>*Beispiel: Frischgewicht, Trockengewicht, Chlorophyllgehalt, Pflanzenhöhe*</span>
<span id="cb247-349"><a href="#cb247-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-350"><a href="#cb247-350" aria-hidden="true" tabindex="-1"></a>| freshmatter | drymatter | chlorophyll | height |</span>
<span id="cb247-351"><a href="#cb247-351" aria-hidden="true" tabindex="-1"></a>|:-----------:|:---------:|:-----------:|--------|</span>
<span id="cb247-352"><a href="#cb247-352" aria-hidden="true" tabindex="-1"></a>|    8.23     |   1.21    |    45.88    | 24.19  |</span>
<span id="cb247-353"><a href="#cb247-353" aria-hidden="true" tabindex="-1"></a>|    2.61     |   0.87    |    43.91    | 18.51  |</span>
<span id="cb247-354"><a href="#cb247-354" aria-hidden="true" tabindex="-1"></a>|    4.81     |   0.34    |    37.44    | 21.74  |</span>
<span id="cb247-355"><a href="#cb247-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-356"><a href="#cb247-356" aria-hidden="true" tabindex="-1"></a>: Tabelle mit bespielhaften, normalverteilten Messwerten $y$. {#tbl-bsp-normal}</span>
<span id="cb247-357"><a href="#cb247-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-358"><a href="#cb247-358" aria-hidden="true" tabindex="-1"></a>Ich rechne in diesem Kapitel alles einmal auf einem normalverteilten Messwert $y$ mit der Sprungweite der Floharten durch. Wenn du mehr Informationen zum modellieren brauchst, dann schaue dir den Abschnitt zu <span class="co">[</span><span class="ot">Multiple Gruppenvergleiche für normalverteilte Daten</span><span class="co">](#sec-mult-comp-gaussian-reg)</span> gerne einmal an. Das ist eigentlich *der* Standardfall und vieles in diesem Kapitel dreht sich um normalverteilte Daten.</span>
<span id="cb247-359"><a href="#cb247-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-360"><a href="#cb247-360" aria-hidden="true" tabindex="-1"></a>Die Modellierung in R führen wir im Allgemeinen mit der Funktion <span class="in">`lm()`</span> durch. Da wir hier meistens erst eine ANOVA gerechnet haben um dann des Post-hoc Test zu rechnen nutze ich direkt die Modellierung mit der Funktion <span class="in">`aov()`</span>.</span>
<span id="cb247-361"><a href="#cb247-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-364"><a href="#cb247-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-365"><a href="#cb247-365" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: FALSE</span></span>
<span id="cb247-366"><a href="#cb247-366" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(freshmatter <span class="sc">~</span> ...)</span>
<span id="cb247-367"><a href="#cb247-367" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(freshmatter <span class="sc">~</span> ...)</span>
<span id="cb247-368"><a href="#cb247-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-369"><a href="#cb247-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-370"><a href="#cb247-370" aria-hidden="true" tabindex="-1"></a>Die genaue Anwendung der Funktionen auf Beispielen findest du dann in den unteren Abschnitten oder aber in dem <span class="co">[</span><span class="ot">Kapitel zur Gaussian linearen Regression</span><span class="co">](#sec-gaussian)</span>. Dort gehe ich dann auch näher auf das Modell und der Güte der Modellanpassung ein.</span>
<span id="cb247-371"><a href="#cb247-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-372"><a href="#cb247-372" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb247-373"><a href="#cb247-373" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visuelle Überprüfung der Normalverteilung</span></span>
<span id="cb247-374"><a href="#cb247-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-375"><a href="#cb247-375" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Soll ich's wirklich machen oder lass ich's lieber sein? Jein..." --- Fettes Brot, Jein*</span></span>
<span id="cb247-376"><a href="#cb247-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-377"><a href="#cb247-377" aria-hidden="true" tabindex="-1"></a>Häufig kommt jetzt die Frage, ob mein Messwert $y$ wirklich normalverteilt ist und ich nicht den Messwert auf Normalverteilung testen sollte. Die kurze Antwort lautet nein, da du meistens zu wenig Beobachtungen pro Gruppe vorliegen hast. Die etwas längere liefert @kozak2018s mit dem Artikel <span class="co">[</span><span class="ot">What's normal anyway? Residual plots are more telling than significance tests when checking ANOVA assumptions</span><span class="co">](https://onlinelibrary.wiley.com/doi/pdf/10.1111/jac.12220?casa_token=22Jm83-kW-MAAAAA:yh0EVuGiGHWDsuPiVP8ZLj51OCasdpIiVWUcYv3Q8dGaIo0yMeNZNwkHIk1ibTCsLhkxbLKZrwZSByo)</span>.</span>
<span id="cb247-378"><a href="#cb247-378" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-379"><a href="#cb247-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-380"><a href="#cb247-380" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Poissonverteilte Messwerte $\boldsymbol{y}$ bzw. Zähldaten {.unnumbered .unlisted}</span></span>
<span id="cb247-381"><a href="#cb247-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-382"><a href="#cb247-382" aria-hidden="true" tabindex="-1"></a>*Beispiel: Anzahl Insekten, gekeimte Pflanzen, Schädlinge*</span>
<span id="cb247-383"><a href="#cb247-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-384"><a href="#cb247-384" aria-hidden="true" tabindex="-1"></a>| Anzahl Blätter | Gekeimte Samen | Anzahl Schädlinge | Verzweigungen |</span>
<span id="cb247-385"><a href="#cb247-385" aria-hidden="true" tabindex="-1"></a>|:--------------:|:--------------:|:-----------------:|---------------|</span>
<span id="cb247-386"><a href="#cb247-386" aria-hidden="true" tabindex="-1"></a>|       8        |       18       |        45         | 4             |</span>
<span id="cb247-387"><a href="#cb247-387" aria-hidden="true" tabindex="-1"></a>|       2        |       10       |        43         | 5             |</span>
<span id="cb247-388"><a href="#cb247-388" aria-hidden="true" tabindex="-1"></a>|       4        |       22       |        37         | 4             |</span>
<span id="cb247-389"><a href="#cb247-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-390"><a href="#cb247-390" aria-hidden="true" tabindex="-1"></a>: Tabelle mit bespielhaften, poissonverteilten Messwerten $y$. {#tbl-bsp-normal}</span>
<span id="cb247-391"><a href="#cb247-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-392"><a href="#cb247-392" aria-hidden="true" tabindex="-1"></a>Wenn du mehr über die Modellierung von Zähldaten und deren Auswertung wissen willst, dann schaue dir den Abschnitt zu <span class="co">[</span><span class="ot">Multiple Gruppenvergleiche für Zähldaten</span><span class="co">](#sec-mult-comp-pois-reg)</span> an. Die Modellierung führen wir mit der Funktion <span class="in">`glm()`</span> durch.</span>
<span id="cb247-393"><a href="#cb247-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-396"><a href="#cb247-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-397"><a href="#cb247-397" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: FALSE</span></span>
<span id="cb247-398"><a href="#cb247-398" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(freshmatter <span class="sc">~</span> ..., <span class="at">family =</span> poission)</span>
<span id="cb247-399"><a href="#cb247-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-400"><a href="#cb247-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-401"><a href="#cb247-401" aria-hidden="true" tabindex="-1"></a>Die genaue Anwendung der Funktionen auf Beispielen findest du dann in dem <span class="co">[</span><span class="ot">Kapitel zur Poisson Regression</span><span class="co">](#sec-poisson)</span>. Dort gehe ich dann auch näher auf das Modell und der Güte der Modellanpassung ein. Bei Zähldaten gibt es die eine oder andere Besonderheit beim Modellieren.</span>
<span id="cb247-402"><a href="#cb247-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-403"><a href="#cb247-403" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ordinalverteilte Messwerte $\boldsymbol{y}$ bzw. Noten {.unnumbered .unlisted}</span></span>
<span id="cb247-404"><a href="#cb247-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-405"><a href="#cb247-405" aria-hidden="true" tabindex="-1"></a>*Beispiel: Bonitur von Rasen, Holstrunk, Bonitur von Wurzelwachstum, Zufriedenheit*</span>
<span id="cb247-406"><a href="#cb247-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-407"><a href="#cb247-407" aria-hidden="true" tabindex="-1"></a>| Bonitur von Rasen | Holstrunk | Bonitur von Wurzelwachstum | Zufriedenheit |</span>
<span id="cb247-408"><a href="#cb247-408" aria-hidden="true" tabindex="-1"></a>|:-----------------:|:---------:|:--------------------------:|---------------|</span>
<span id="cb247-409"><a href="#cb247-409" aria-hidden="true" tabindex="-1"></a>|         8         |     1     |             5              | 6             |</span>
<span id="cb247-410"><a href="#cb247-410" aria-hidden="true" tabindex="-1"></a>|         8         |     2     |             4              | 6             |</span>
<span id="cb247-411"><a href="#cb247-411" aria-hidden="true" tabindex="-1"></a>|         1         |     7     |             7              | 9             |</span>
<span id="cb247-412"><a href="#cb247-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-413"><a href="#cb247-413" aria-hidden="true" tabindex="-1"></a>: Tabelle mit bespielhaften, ordinalverteilten Messwerten $y$. {#tbl-bsp-normal}</span>
<span id="cb247-414"><a href="#cb247-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-415"><a href="#cb247-415" aria-hidden="true" tabindex="-1"></a>Wenn du Noten vorliegen hast, dann schaue dir den Abschnitt zu <span class="co">[</span><span class="ot">Multiple Gruppenvergleiche für Boniturdaten</span><span class="co">](#sec-mult-comp-ord-reg)</span> an. Es sei den du bist an der mittleren Note pro Gruppe interessiert und willst die mittleren Noten miteinander vergleichen. Dann kannst du auch ein Modell unter der Annahme einer Normalverteilung mit heterogenen Varianzen rechnen. Die Modellierung führen wir mit der Funktion <span class="in">`clm()`</span> durch.</span>
<span id="cb247-416"><a href="#cb247-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-419"><a href="#cb247-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-420"><a href="#cb247-420" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: FALSE</span></span>
<span id="cb247-421"><a href="#cb247-421" aria-hidden="true" tabindex="-1"></a><span class="fu">clm</span>(freshmatter <span class="sc">~</span> ...)</span>
<span id="cb247-422"><a href="#cb247-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-423"><a href="#cb247-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-424"><a href="#cb247-424" aria-hidden="true" tabindex="-1"></a>Die genaue Anwendung der Funktionen auf Beispielen findest du in dem <span class="co">[</span><span class="ot">Kapitel zur Multinomiale / Ordinale Regression</span><span class="co">](#sec-multinom-ordinal)</span>. Dort gehe ich dann auch näher auf das Modell und der Güte der Modellanpassung ein.</span>
<span id="cb247-425"><a href="#cb247-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-426"><a href="#cb247-426" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Binomialverteilte Messwerte $\boldsymbol{y}$ bzw. Anteile {.unnumbered .unlisted}</span></span>
<span id="cb247-427"><a href="#cb247-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-428"><a href="#cb247-428" aria-hidden="true" tabindex="-1"></a>*Beispiel: Infektionsstatus, Verstorben, Zielgewicht erreicht, Gekeimt*</span>
<span id="cb247-429"><a href="#cb247-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-430"><a href="#cb247-430" aria-hidden="true" tabindex="-1"></a>| Infektionsstatus | Verstorben | Zielgewicht erreicht | Gekeimt |</span>
<span id="cb247-431"><a href="#cb247-431" aria-hidden="true" tabindex="-1"></a>|:----------------:|:----------:|:--------------------:|---------|</span>
<span id="cb247-432"><a href="#cb247-432" aria-hidden="true" tabindex="-1"></a>|        1         |     1      |          0           | 1       |</span>
<span id="cb247-433"><a href="#cb247-433" aria-hidden="true" tabindex="-1"></a>|        1         |     1      |          0           | 1       |</span>
<span id="cb247-434"><a href="#cb247-434" aria-hidden="true" tabindex="-1"></a>|        0         |     0      |          1           | 1       |</span>
<span id="cb247-435"><a href="#cb247-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-436"><a href="#cb247-436" aria-hidden="true" tabindex="-1"></a>: Tabelle mit bespielhaften, binomialverteilten Messwerten $y$. {#tbl-bsp-normal}</span>
<span id="cb247-437"><a href="#cb247-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-438"><a href="#cb247-438" aria-hidden="true" tabindex="-1"></a>Wenn du nur einen Messwert mit der Ausprägung $0/1$ oder $ja/nein$ vorliegen hast, dann schaue dir den Abschnitt zu <span class="co">[</span><span class="ot">Multiple Gruppenvergleiche für Anteile</span><span class="co">](#sec-mult-comp-log-reg)</span> an. Die Modellierung führen wir mit der Funktion <span class="in">`glm()`</span> durch.</span>
<span id="cb247-439"><a href="#cb247-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-442"><a href="#cb247-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-443"><a href="#cb247-443" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: FALSE</span></span>
<span id="cb247-444"><a href="#cb247-444" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(freshmatter <span class="sc">~</span> ..., <span class="at">family =</span> binomial)</span>
<span id="cb247-445"><a href="#cb247-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-446"><a href="#cb247-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-447"><a href="#cb247-447" aria-hidden="true" tabindex="-1"></a>Die genaue Anwendung der Funktionen auf Beispielen findest du dann in den unteren Abschnitten oder aber in dem <span class="co">[</span><span class="ot">Kapitel zur Logistische Regression</span><span class="co">](#sec-logistic)</span>. Dort gehe ich dann auch näher auf das Modell und der Güte der Modellanpassung ein.</span>
<span id="cb247-448"><a href="#cb247-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-449"><a href="#cb247-449" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Betaverteilte Messwerte $\boldsymbol{y}$ bzw. Wahrscheinlichkeiten {.unnumbered .unlisted}</span></span>
<span id="cb247-450"><a href="#cb247-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-451"><a href="#cb247-451" aria-hidden="true" tabindex="-1"></a>*Beispiel: Anteil infizierte Pflanzen, Jagderfolg, Auftreten Spezies, Erfolg/Misserfolg einer Anwendung*</span>
<span id="cb247-452"><a href="#cb247-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-453"><a href="#cb247-453" aria-hidden="true" tabindex="-1"></a>| Anteil infizierte Pflanzen | Jagderfolg | Auftreten Spezies | Erfolg/Misserfolg einer Anwendung |</span>
<span id="cb247-454"><a href="#cb247-454" aria-hidden="true" tabindex="-1"></a>|:--:|:--:|:--:|----|</span>
<span id="cb247-455"><a href="#cb247-455" aria-hidden="true" tabindex="-1"></a>| 0.34 | 0.22 | 0.19 | 0.67 |</span>
<span id="cb247-456"><a href="#cb247-456" aria-hidden="true" tabindex="-1"></a>| 0.29 | 0.78 | 0.11 | 0.71 |</span>
<span id="cb247-457"><a href="#cb247-457" aria-hidden="true" tabindex="-1"></a>| 0.31 | 0.77 | 0.27 | 0.82 |</span>
<span id="cb247-458"><a href="#cb247-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-459"><a href="#cb247-459" aria-hidden="true" tabindex="-1"></a>: Tabelle mit bespielhaften, betaverteilten Messwerten $y$. {#tbl-bsp-normal}</span>
<span id="cb247-460"><a href="#cb247-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-461"><a href="#cb247-461" aria-hidden="true" tabindex="-1"></a>Wenn du Prozente oder die Wahrscheinlichkeit für das Eintreten eines Ereignisses oder aber die Rate eines Erfolges an Misserfolgen gemessen hast, dann schaue dir den Abschnitt zu <span class="co">[</span><span class="ot">Multiple Gruppenvergleiche für Wahrscheinlichkeiten</span><span class="co">](#sec-mult-comp-beta-reg)</span> an. Die Modellierung führen wir mit der Funktion <span class="in">`betareg()`</span> durch.</span>
<span id="cb247-462"><a href="#cb247-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-465"><a href="#cb247-465" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-466"><a href="#cb247-466" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: FALSE</span></span>
<span id="cb247-467"><a href="#cb247-467" aria-hidden="true" tabindex="-1"></a><span class="fu">betareg</span>(freshmatter <span class="sc">~</span> ...)</span>
<span id="cb247-468"><a href="#cb247-468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-469"><a href="#cb247-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-470"><a href="#cb247-470" aria-hidden="true" tabindex="-1"></a>Die genaue Anwendung der Funktionen auf Beispielen findest du in dem <span class="co">[</span><span class="ot">Kapitel zur Beta Regression</span><span class="co">](#sec-beta)</span>. Dort gehe ich dann auch näher auf das Modell und der Güte der Modellanpassung ein. Insbesondere hier gibt es dann einige unschöne Limitierungen wenn du zu nah an der Grenze von $<span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$ bist.</span>
<span id="cb247-471"><a href="#cb247-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-472"><a href="#cb247-472" aria-hidden="true" tabindex="-1"></a><span class="fu">### Die Faktoren $f$</span></span>
<span id="cb247-473"><a href="#cb247-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-474"><a href="#cb247-474" aria-hidden="true" tabindex="-1"></a>Neben dem Messwert $y$ müssen wir natürlich auch die Faktoren $f$ mit dem ersten Faktor $f_1$ und dem zweiten Faktor $f_2$ berücksichtigen. Meistens haben wir hier aber einen Hauptfaktor mit den Behandlungsgruppen und dann noch einen zweiten Faktor der uns nicht so ganz interessiert. Das hängt aber von der Fragestellung ab, es kann auch zwei Hauptfaktoren geben. Im Folgenden betrachten wir jedenfalls jeden Faktor getrennt. Wir schauen jetzt einmal, ob sich die Fallzahlen in den Gruppen unterscheiden, wie wir mit der Varianz in den Gruppen umgehen und was schlussendlich als Fehlerbalken dargestellt werden soll.</span>
<span id="cb247-475"><a href="#cb247-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-476"><a href="#cb247-476" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Balanciert oder unbalanciert {.unnumbered .unlisted}</span></span>
<span id="cb247-477"><a href="#cb247-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-478"><a href="#cb247-478" aria-hidden="true" tabindex="-1"></a>Eine der ersten Fragen an die Gruppen ist, ob wir ein balanciertes Desgin vorliegen haben oder ein unbalanciertes Design. Im Falle eines balancierten Design sind die Fallzahlen in jeder Behandlungsgruppe gleich groß. Du solltest dein Experiment immer so planen, dass die Gruppen immer gleich groß sind. Das macht vieles einfacher. Manachmal kann es passieren, dass du eine Beobachtung verlierst oder aber eine Messung nicht klappt. Dann hast du ein unbalanciertes Design vorliegen. In einem unbalancierten Design ist die Fallzahl in allen Gruppe nicht gleich groß.</span>
<span id="cb247-479"><a href="#cb247-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-480"><a href="#cb247-480" aria-hidden="true" tabindex="-1"></a>Balanciertes Design</span>
<span id="cb247-481"><a href="#cb247-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-482"><a href="#cb247-482" aria-hidden="true" tabindex="-1"></a>:   Alle Behandlungsgruppen $1, 2, ..., p$ haben die gleiche Fallzahl $n_g$ in den Behandlungsgruppen.</span>
<span id="cb247-483"><a href="#cb247-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-484"><a href="#cb247-484" aria-hidden="true" tabindex="-1"></a>Unbalanciertes Design</span>
<span id="cb247-485"><a href="#cb247-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-486"><a href="#cb247-486" aria-hidden="true" tabindex="-1"></a>:   Die Behandlungsgruppen $1, 2, ..., p$ haben unterschiedliche Fallzahlen $n_1, n_2, ..., n_p$ in den Behandlungsgruppen.</span>
<span id="cb247-487"><a href="#cb247-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-488"><a href="#cb247-488" aria-hidden="true" tabindex="-1"></a>Um es gleich vorwegzunehmen das R Paket <span class="in">`{emmeans}`</span> wurde extra dafür gebaut mit balancierten und im Besonderen mit unbalancierten Daten umzugehen. Eine ANOVA kann prinzipiell auch mit unbalancierten Daten umgehen. Beim Tukey HSD Test und anderen älteren Implementierungen eines Post-hoc Test wird es dann schwieriger.</span>
<span id="cb247-489"><a href="#cb247-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-490"><a href="#cb247-490" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb247-491"><a href="#cb247-491" aria-hidden="true" tabindex="-1"></a><span class="fu">## Was tun bei unbalancierten Daten?</span></span>
<span id="cb247-492"><a href="#cb247-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-493"><a href="#cb247-493" aria-hidden="true" tabindex="-1"></a>Wenn du *unbedingt* balancierte Daten ohne fehlende Werte brauchst, dann kannst du die fehlenden Werte in einer Gruppe durch den Mittelwert der jeweiligen Gruppe ersetzen. Das hat dann nicht so starke Auswirkungen, aber überfährt auch einen statistischen Engel.</span>
<span id="cb247-494"><a href="#cb247-494" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-495"><a href="#cb247-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-496"><a href="#cb247-496" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Varianzhomogenität und Varianzheterogenität {.unnumbered .unlisted}</span></span>
<span id="cb247-497"><a href="#cb247-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-498"><a href="#cb247-498" aria-hidden="true" tabindex="-1"></a>Kommen wir nun zur Varianzhomogenität oder Varianzhterogenität in den Gruppen des Behandlunsgfaktors. Wir betrachten also meistens nur den wichtigen Faktor $f_1$ und ignorieren ein wenig den zweiten Faktor. Prinzipiell kannst du natürlich auch den zweiten Faktor anschauen, aber dann werden es immer mehr Gruppen und Faktorkombinationen. Am Ende kommt dann sowieso heraus, dass über alle Gruppen hinweg keine homogenen Varianzen vorliegen. Wenn du mehr lesen willst so gibt es auf der Seite DSFAIR noch einen Artikel zu <span class="in">`{emmeans}`</span> und der Frage <span class="co">[</span><span class="ot">Why are the StdErr all the same?</span><span class="co">](https://schmidtpaul.github.io/dsfair_quarto/ch/summaryarticles/whyseequal.html)</span></span>
<span id="cb247-499"><a href="#cb247-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-500"><a href="#cb247-500" aria-hidden="true" tabindex="-1"></a>Wann liegt vermutlich Varianzheterogenität in deinen experimentellen Faktoren $f$ vor?</span>
<span id="cb247-501"><a href="#cb247-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-502"><a href="#cb247-502" aria-hidden="true" tabindex="-1"></a>:   Es gibt so ein paar Daumenregeln, die dir helfen abzuschätzen, ob in deinen Gruppen Varianzheterogenität vorliegt. Um es kurz zu machen, vermutlich hast du mindestens leichte Varianzhterogenität in den Daten vorliegen.</span>
<span id="cb247-503"><a href="#cb247-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-504"><a href="#cb247-504" aria-hidden="true" tabindex="-1"></a>1)  Du hat viele Behandlungsgruppen. Je mehr Gruppen du hast oder eben dann auch Faktorkombinationen, die du testen möchtest, desto wahrscheinlicher wird es, dass mindestens eine Gruppe eine unterschiedliche Varianz hat. Du hast Varianzheterogenität vorliegen.</span>
<span id="cb247-505"><a href="#cb247-505" aria-hidden="true" tabindex="-1"></a>2)  Du misst deine Gruppen über die Zeit. Je größer, schwerer oder allgemein höher ein Messwert wird, desto größer wird auch die Varianz. Schaust du dir deine Messwerte über die Zeit an hast du meistens Varianzheterogenität vorliegen.</span>
<span id="cb247-506"><a href="#cb247-506" aria-hidden="true" tabindex="-1"></a>3)  Deine Kontrolle ohne Behandlung verhält sich meistens nicht so, wie die Gruppen, die eine Behandlung erhalten haben. Wenn du nichts machst in deiner negativen Kontrolle, dann hast du meistens eine andere Streuung der Messwerte als unter einer Behandlung.</span>
<span id="cb247-507"><a href="#cb247-507" aria-hidden="true" tabindex="-1"></a>4)  Diene Behandlungen sind stark unterschiedlich. Wenn deine Behandlungen sich biologisch oder chemisch in der Wirkung unterscheiden, denn werden vermutlich deine Messwerte auch anders streuen. Hier spielt auch die Anwendung der Behandlung und deren Bereitstellung eine Rolle. Wenn was nicht gleich ist, dann wird es vermutlich nicht gleiche Messwerte erzeugen.</span>
<span id="cb247-508"><a href="#cb247-508" aria-hidden="true" tabindex="-1"></a>5)  Du hast wenig Fallzahl pro Gruppe oder Faktorkombination. Wenn du wenig Fallzahl in einer Gruppe hast, dann reicht schon eine (zufällige) Messabweichung und schon sind deine Varianzen heterogen.</span>
<span id="cb247-509"><a href="#cb247-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-510"><a href="#cb247-510" aria-hidden="true" tabindex="-1"></a>Gut, jetzt wissen wir, dass du vermutlich Varianzheterogenität in deinen Daten vorliegen hast. Erstmal ist das kein so großes Problem.</span>
<span id="cb247-511"><a href="#cb247-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-512"><a href="#cb247-512" aria-hidden="true" tabindex="-1"></a>Tut Varianzhterogenität anstatt Varianzhomogenität weh?</span>
<span id="cb247-513"><a href="#cb247-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-514"><a href="#cb247-514" aria-hidden="true" tabindex="-1"></a>:   Nein. Meistens ist die Varianzheterogenität nicht so ausgeprägt, dass du nicht auch eine ANOVA rechnen kannst. Über alle Gruppen hinweg wird dann zwar in einer ANOVA die Varianz gemmittelt und es kann dann zu weniger signifkanten Ergebnissen führen, aber so schlimm ist es nicht. Im Post-hoc Test solltest du aber die Varianzheterogenität berücksichtigen, da du ja immer nur zwei Gruppen gleichzeitig betrachtest.</span>
<span id="cb247-515"><a href="#cb247-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-516"><a href="#cb247-516" aria-hidden="true" tabindex="-1"></a>Wie immer kannst du alles natürlich auch statistisch Testen. Das ist dann bei der Varianzhomogenität nicht anders. Mehr dazu dann im <span class="co">[</span><span class="ot">Kapitel zum Pre-Test oder Vortest</span><span class="co">](#sec-pretest)</span>. Hier konzentriere ich mich auf die visuelle Überprüfung, die meistens in einem Setting mit niedriger Fallzahl in den Gruppen vollkommen ausreicht. Die Tests liefern meist eine falsche numerische Sicherheit, die so nicht stimmt.</span>
<span id="cb247-517"><a href="#cb247-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-518"><a href="#cb247-518" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-519"><a href="#cb247-519" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch</span></span>
<span id="cb247-520"><a href="#cb247-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-521"><a href="#cb247-521" aria-hidden="true" tabindex="-1"></a>Hier einmal die theoretischen Abbilungen von drei Gruppen mit Varianzhomogenität und Varianzheterogenität. Hier wird schnell klar, dass du mit mehr Behandlungsgruppen kaum die Annahme für Varianzhomogenität aufrecht erhalten kannst. Insbesondere Kontrollen oder Standardbehandlungen haben große oder kleinere Varianzen als der Rest der Behandlungen. Manchaml hat man aber Glück und die Varianzen sind eher homogen.</span>
<span id="cb247-522"><a href="#cb247-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-525"><a href="#cb247-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-526"><a href="#cb247-526" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb247-527"><a href="#cb247-527" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb247-528"><a href="#cb247-528" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-529"><a href="#cb247-529" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-530"><a href="#cb247-530" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-posthoc-var-homo-bar</span></span>
<span id="cb247-531"><a href="#cb247-531" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-532"><a href="#cb247-532" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb247-533"><a href="#cb247-533" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb247-534"><a href="#cb247-534" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung der Varianzhomogenität und Varianzheterogenität in einem Barplot. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb247-535"><a href="#cb247-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-536"><a href="#cb247-536" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb247-537"><a href="#cb247-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x_fct =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),  </span>
<span id="cb247-538"><a href="#cb247-538" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_normal =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="dv">5</span>),</span>
<span id="cb247-539"><a href="#cb247-539" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd_normal =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb247-540"><a href="#cb247-540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x_fct, mean_normal, <span class="at">fill =</span> x_fct) <span class="sc">+</span></span>
<span id="cb247-541"><a href="#cb247-541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb247-542"><a href="#cb247-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_normal<span class="sc">-</span>(sd_normal), </span>
<span id="cb247-543"><a href="#cb247-543" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_normal<span class="sc">+</span>(sd_normal)),</span>
<span id="cb247-544"><a href="#cb247-544" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb247-545"><a href="#cb247-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Behandlungsgruppen (X)"</span>, <span class="at">y =</span> <span class="st">"Mittler Messwert (Y)"</span>,</span>
<span id="cb247-546"><a href="#cb247-546" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Varianzhomogenität"</span>, <span class="at">subtitle =</span> <span class="st">"Varianzen sind gleich"</span>)  <span class="sc">+</span></span>
<span id="cb247-547"><a href="#cb247-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb247-548"><a href="#cb247-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-549"><a href="#cb247-549" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb247-550"><a href="#cb247-550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x_fct =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),  </span>
<span id="cb247-551"><a href="#cb247-551" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_normal =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="dv">5</span>),</span>
<span id="cb247-552"><a href="#cb247-552" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd_normal =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">1.25</span>, <span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb247-553"><a href="#cb247-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x_fct, mean_normal, <span class="at">fill =</span> x_fct) <span class="sc">+</span></span>
<span id="cb247-554"><a href="#cb247-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb247-555"><a href="#cb247-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_normal<span class="sc">-</span>(sd_normal), </span>
<span id="cb247-556"><a href="#cb247-556" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_normal<span class="sc">+</span>(sd_normal)),</span>
<span id="cb247-557"><a href="#cb247-557" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb247-558"><a href="#cb247-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Behandlungsgruppen (X)"</span>, <span class="at">y =</span> <span class="st">"Mittler Messwert (Y)"</span>,</span>
<span id="cb247-559"><a href="#cb247-559" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Varianzheterogenität"</span>, <span class="at">subtitle =</span> <span class="st">"Varianzen sind unterschiedlich"</span>)  <span class="sc">+</span></span>
<span id="cb247-560"><a href="#cb247-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb247-561"><a href="#cb247-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-562"><a href="#cb247-562" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb247-563"><a href="#cb247-563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb247-564"><a href="#cb247-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb247-565"><a href="#cb247-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb247-566"><a href="#cb247-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb247-567"><a href="#cb247-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-568"><a href="#cb247-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-569"><a href="#cb247-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-572"><a href="#cb247-572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-573"><a href="#cb247-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb247-574"><a href="#cb247-574" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb247-575"><a href="#cb247-575" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-576"><a href="#cb247-576" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-577"><a href="#cb247-577" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-posthoc-var-homo-box</span></span>
<span id="cb247-578"><a href="#cb247-578" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-579"><a href="#cb247-579" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb247-580"><a href="#cb247-580" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb247-581"><a href="#cb247-581" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung der Varianzhomogenität und Varianzheterogenität in einem Boxplot. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb247-582"><a href="#cb247-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-583"><a href="#cb247-583" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb247-584"><a href="#cb247-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x_fct =</span> <span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)),  </span>
<span id="cb247-585"><a href="#cb247-585" aria-hidden="true" tabindex="-1"></a>         <span class="at">y_val =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.75</span>,</span>
<span id="cb247-586"><a href="#cb247-586" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">1.25</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="fl">3.75</span>,</span>
<span id="cb247-587"><a href="#cb247-587" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">3.75</span>, <span class="fl">4.5</span>, <span class="dv">5</span>, <span class="fl">5.5</span>, <span class="fl">6.25</span>)) <span class="sc">+</span></span>
<span id="cb247-588"><a href="#cb247-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x_fct, y_val, <span class="at">fill =</span> x_fct) <span class="sc">+</span></span>
<span id="cb247-589"><a href="#cb247-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb247-590"><a href="#cb247-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Behandlungsgruppen (X)"</span>, <span class="at">y =</span> <span class="st">"Mittler Messwert (Y)"</span>,</span>
<span id="cb247-591"><a href="#cb247-591" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Varianzhomogenität"</span>, <span class="at">subtitle =</span> <span class="st">"Varianzen sind gleich"</span>) <span class="sc">+</span></span>
<span id="cb247-592"><a href="#cb247-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb247-593"><a href="#cb247-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-594"><a href="#cb247-594" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb247-595"><a href="#cb247-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x_fct =</span> <span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)),  </span>
<span id="cb247-596"><a href="#cb247-596" aria-hidden="true" tabindex="-1"></a>         <span class="at">y_val =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>,</span>
<span id="cb247-597"><a href="#cb247-597" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">2.5</span>, <span class="dv">4</span>, <span class="fl">6.5</span>,</span>
<span id="cb247-598"><a href="#cb247-598" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb247-599"><a href="#cb247-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x_fct, y_val, <span class="at">fill =</span> x_fct) <span class="sc">+</span></span>
<span id="cb247-600"><a href="#cb247-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb247-601"><a href="#cb247-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Behandlungsgruppen (X)"</span>, <span class="at">y =</span> <span class="st">"Mittler Messwert (Y)"</span>,</span>
<span id="cb247-602"><a href="#cb247-602" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Varianzheterogenität"</span>, <span class="at">subtitle =</span> <span class="st">"Varianzen sind unterschiedlich"</span>)  <span class="sc">+</span></span>
<span id="cb247-603"><a href="#cb247-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb247-604"><a href="#cb247-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-605"><a href="#cb247-605" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb247-606"><a href="#cb247-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb247-607"><a href="#cb247-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb247-608"><a href="#cb247-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb247-609"><a href="#cb247-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb247-610"><a href="#cb247-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-611"><a href="#cb247-611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-612"><a href="#cb247-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-613"><a href="#cb247-613" aria-hidden="true" tabindex="-1"></a><span class="fu">## `geom_bar()`</span></span>
<span id="cb247-614"><a href="#cb247-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-615"><a href="#cb247-615" aria-hidden="true" tabindex="-1"></a>Wir bauen wir usn jetzt die Barplots oder Säulendiagramme? Entweder direkt aus <span class="in">`{ememans}`</span>, wie ich dir das weiter unten zum *Compact letter display* zeige oder eben als Wiederholung des <span class="co">[</span><span class="ot">Kapitels zur Visualisierung von Daten</span><span class="co">](#sec-eda-ggplot)</span>. Wir bauen uns also einmal den einfaktoriellen Barplot wie auch den zweifaktoriellen Barplot.</span>
<span id="cb247-616"><a href="#cb247-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-617"><a href="#cb247-617" aria-hidden="true" tabindex="-1"></a><span class="fu">### Einfaktorieller Barplot</span></span>
<span id="cb247-618"><a href="#cb247-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-619"><a href="#cb247-619" aria-hidden="true" tabindex="-1"></a>Für den einfaktoriellen Barplot brauchen wir einmal den Mittelwert und die Standardabweichung der einzelne Floharten.</span>
<span id="cb247-620"><a href="#cb247-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-623"><a href="#cb247-623" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-624"><a href="#cb247-624" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-625"><a href="#cb247-625" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-626"><a href="#cb247-626" aria-hidden="true" tabindex="-1"></a>stat_fac1_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb247-627"><a href="#cb247-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">|&gt;</span> </span>
<span id="cb247-628"><a href="#cb247-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb247-629"><a href="#cb247-629" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(jump_length))</span>
<span id="cb247-630"><a href="#cb247-630" aria-hidden="true" tabindex="-1"></a>stat_fac1_tbl</span>
<span id="cb247-631"><a href="#cb247-631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-632"><a href="#cb247-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-633"><a href="#cb247-633" aria-hidden="true" tabindex="-1"></a>Dann können wir uns auch schon den Barplot mit <span class="in">`{ggplot}`</span> erstellen. Später willst du dann noch das *Compact letter display* über den Balken als Mittelwerte ergänzen.</span>
<span id="cb247-634"><a href="#cb247-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-637"><a href="#cb247-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-638"><a href="#cb247-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-639"><a href="#cb247-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-640"><a href="#cb247-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-641"><a href="#cb247-641" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-posthoc-barplot-1fac</span></span>
<span id="cb247-642"><a href="#cb247-642" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-643"><a href="#cb247-643" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb247-644"><a href="#cb247-644" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb247-645"><a href="#cb247-645" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafter einfaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten."</span></span>
<span id="cb247-646"><a href="#cb247-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-647"><a href="#cb247-647" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_fac1_tbl, </span>
<span id="cb247-648"><a href="#cb247-648" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb247-649"><a href="#cb247-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-650"><a href="#cb247-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb247-651"><a href="#cb247-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb247-652"><a href="#cb247-652" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb247-653"><a href="#cb247-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb247-654"><a href="#cb247-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb247-655"><a href="#cb247-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb247-656"><a href="#cb247-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-657"><a href="#cb247-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-658"><a href="#cb247-658" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zweifaktorieller Barplot</span></span>
<span id="cb247-659"><a href="#cb247-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-660"><a href="#cb247-660" aria-hidden="true" tabindex="-1"></a>Für den zweifaktoriellen Barplot brauchen wir einmal den Mittelwert und die Standardabweichung der einzelne Floharten getrennt für die beiden Messorte. Das geht natürlich auch umgedreht, also die Messorte für die Floharten. Das kommt dann auf deine Fragestellung an.</span>
<span id="cb247-661"><a href="#cb247-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-664"><a href="#cb247-664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-665"><a href="#cb247-665" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-666"><a href="#cb247-666" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-667"><a href="#cb247-667" aria-hidden="true" tabindex="-1"></a>stat_fac2_tbl <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb247-668"><a href="#cb247-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal, site) <span class="sc">|&gt;</span> </span>
<span id="cb247-669"><a href="#cb247-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb247-670"><a href="#cb247-670" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(jump_length))</span>
<span id="cb247-671"><a href="#cb247-671" aria-hidden="true" tabindex="-1"></a>stat_fac2_tbl</span>
<span id="cb247-672"><a href="#cb247-672" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-673"><a href="#cb247-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-674"><a href="#cb247-674" aria-hidden="true" tabindex="-1"></a>Und dann können wir auch schon den zweifaktoriellen Barplot in <span class="in">`{ggplot}`</span> erstellen. Du musst schauen, was du auf die x-Achse legst und was du dann auf die Legende und daher mit <span class="in">`fill`</span> gruppierst. Damit die Positionen passen, spiele ich hier noch mit der Funktion <span class="in">`position_dodge()`</span> rum.</span>
<span id="cb247-675"><a href="#cb247-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-678"><a href="#cb247-678" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-679"><a href="#cb247-679" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-680"><a href="#cb247-680" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-681"><a href="#cb247-681" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-682"><a href="#cb247-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-posthoc-barplot-2fac</span></span>
<span id="cb247-683"><a href="#cb247-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-684"><a href="#cb247-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb247-685"><a href="#cb247-685" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb247-686"><a href="#cb247-686" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafter zweifaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Messorten."</span></span>
<span id="cb247-687"><a href="#cb247-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-688"><a href="#cb247-688" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_fac2_tbl, </span>
<span id="cb247-689"><a href="#cb247-689" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb247-690"><a href="#cb247-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-691"><a href="#cb247-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.9</span>, </span>
<span id="cb247-692"><a href="#cb247-692" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb247-693"><a href="#cb247-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb247-694"><a href="#cb247-694" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb247-695"><a href="#cb247-695" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb247-696"><a href="#cb247-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb247-697"><a href="#cb247-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb247-698"><a href="#cb247-698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-699"><a href="#cb247-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-700"><a href="#cb247-700" aria-hidden="true" tabindex="-1"></a><span class="fu">## `geom_boxplot()`</span></span>
<span id="cb247-701"><a href="#cb247-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-702"><a href="#cb247-702" aria-hidden="true" tabindex="-1"></a><span class="fu">### Einfaktorieller Boxplot</span></span>
<span id="cb247-703"><a href="#cb247-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-704"><a href="#cb247-704" aria-hidden="true" tabindex="-1"></a>Das praktische bei den Boxplots ist, dass wir hier nichts mehr vorrechnen müssen, sondern direkt die Boxplots in <span class="in">`{ggplot}`</span> erstellen können. Ich finde man sieht immer in einem Boxplot besser, ob die Streuung um den Median eher homogen oder eher heterogen ist. Gerne ergänze ich noch den Mittelwert mit der Funktion <span class="in">`stat_summary()`</span>.</span>
<span id="cb247-705"><a href="#cb247-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-708"><a href="#cb247-708" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-709"><a href="#cb247-709" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-710"><a href="#cb247-710" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-711"><a href="#cb247-711" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-712"><a href="#cb247-712" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-posthoc-boxplot-1fac</span></span>
<span id="cb247-713"><a href="#cb247-713" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-714"><a href="#cb247-714" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb247-715"><a href="#cb247-715" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb247-716"><a href="#cb247-716" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafter einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten."</span></span>
<span id="cb247-717"><a href="#cb247-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-718"><a href="#cb247-718" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb247-719"><a href="#cb247-719" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb247-720"><a href="#cb247-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-721"><a href="#cb247-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb247-722"><a href="#cb247-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb247-723"><a href="#cb247-723" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb247-724"><a href="#cb247-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb247-725"><a href="#cb247-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb247-726"><a href="#cb247-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb247-727"><a href="#cb247-727" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-728"><a href="#cb247-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-729"><a href="#cb247-729" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zweifaktorieller Boxplot</span></span>
<span id="cb247-730"><a href="#cb247-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-731"><a href="#cb247-731" aria-hidden="true" tabindex="-1"></a>Den zweifaktoriellen Boxplot erstellen wir für die einzelnen Floharten getrennt für die beiden Messorte. Du musst schauen, was du auf die x-Achse legst und was du dann auf die Legende und daher mit <span class="in">`fill`</span> gruppierst. Gerne ergänze ich noch den Mittelwert mit der Funktion <span class="in">`stat_summary()`</span>, muss hier aber schauen, dass ich nach dem Faktor <span class="in">`animal`</span> gruppiere und dann noch mit der Funktion <span class="in">`position_dodge()`</span> die richtige Position finde.</span>
<span id="cb247-732"><a href="#cb247-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-735"><a href="#cb247-735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-736"><a href="#cb247-736" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-737"><a href="#cb247-737" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-738"><a href="#cb247-738" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-739"><a href="#cb247-739" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-posthoc-boxplot-2fac</span></span>
<span id="cb247-740"><a href="#cb247-740" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-741"><a href="#cb247-741" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb247-742"><a href="#cb247-742" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb247-743"><a href="#cb247-743" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafter zweifaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Messorten."</span></span>
<span id="cb247-744"><a href="#cb247-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-745"><a href="#cb247-745" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac2_tbl, </span>
<span id="cb247-746"><a href="#cb247-746" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb247-747"><a href="#cb247-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-748"><a href="#cb247-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb247-749"><a href="#cb247-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="fu">aes</span>(<span class="at">group =</span> animal), </span>
<span id="cb247-750"><a href="#cb247-750" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>,</span>
<span id="cb247-751"><a href="#cb247-751" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb247-752"><a href="#cb247-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb247-753"><a href="#cb247-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb247-754"><a href="#cb247-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-755"><a href="#cb247-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-756"><a href="#cb247-756" aria-hidden="true" tabindex="-1"></a><span class="fu">## Excel</span></span>
<span id="cb247-757"><a href="#cb247-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-758"><a href="#cb247-758" aria-hidden="true" tabindex="-1"></a>Dann habe ich mich doch noch hingesetzt und einmal für dich die Videos gemacht, wie du dann einen Barplot oder eben ein Säulendigramm in Excel erstellst. Daran kannst du natürlich auch überprüfen, ob die Varianzen homogen sind oder nicht. Das ganze macht dann nur als Video Sinn, denn sonst kannst du ja nicht nachvollziehen, was ich geklickt habe.</span>
<span id="cb247-759"><a href="#cb247-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-760"><a href="#cb247-760" aria-hidden="true" tabindex="-1"></a>Hier also erstmal die einfachere Variante mit dem einfaktoriellen Barplot. Beginnen wollen wir wie immer mit der Berechnung der Mittelwerte und der Standardabweichung. Bitte nutze für die Standardabweichung die Funktion <span class="in">`STABW.S()`</span> in Excel.</span>
<span id="cb247-761"><a href="#cb247-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-762"><a href="#cb247-762" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/UdZ5p8euo64 &gt;}}</span>
<span id="cb247-763"><a href="#cb247-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-764"><a href="#cb247-764" aria-hidden="true" tabindex="-1"></a>Und im Anschluss nochmal das Video für den zweifaktoriellen Barplot. Du hast jetzt eben nicht nur eine Behandlungsgruppe vorliegen sondern zwei Behandlungsgruppen. Dann musst du etwas mehr Arbeit reinstecken um alle Mittelwerte und Standardabweichungen zu berechnen. Bitte nutze auch hier für die Standardabweichung die Funktion <span class="in">`STABW.S()`</span> in Excel.</span>
<span id="cb247-765"><a href="#cb247-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-766"><a href="#cb247-766" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/mGSMZ6C7x4E &gt;}}</span>
<span id="cb247-767"><a href="#cb247-767" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-768"><a href="#cb247-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-769"><a href="#cb247-769" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Standardfehler oder Standardabweichung {.unnumbered .unlisted}</span></span>
<span id="cb247-770"><a href="#cb247-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-771"><a href="#cb247-771" aria-hidden="true" tabindex="-1"></a>Wenn wir uns jetzt entschieden haben, wie wir die Varianz modellieren wollen, stellt sich häufig die Frage, was wollen wir denn eigentlich in den Säulendiagrammen darstellen. Wie du in dem vorherigen Abschnitt ja schon gesehen hast, zeige ich nicht die Mittelwerte und die Varianz sondern eben die Mittelwerte und die Standardabweichung als Fehlerbalken. Dies ist auch die übliche Darstellung, wenn wir uns einen Barplot anschauen. Ein Barplot stellt den Mittelwert und die Standardabweichung als Fehlerbalken dar. Neben dem der Standardabweichung könntest du auch den Standardfehler als Fehlerbalken wählen. Hier nochmal die Formel für den Standardfehler und die Umstellung nach der Standardabweichung.</span>
<span id="cb247-772"><a href="#cb247-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-773"><a href="#cb247-773" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-774"><a href="#cb247-774" aria-hidden="true" tabindex="-1"></a>SE = \cfrac{s}{\sqrt{n_g}};\; s = SE \cdot \sqrt{n_g}</span>
<span id="cb247-775"><a href="#cb247-775" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-776"><a href="#cb247-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-777"><a href="#cb247-777" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb247-778"><a href="#cb247-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-779"><a href="#cb247-779" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$SE$, dem Standardfehler der jeweiligen Gruppe.</span>
<span id="cb247-780"><a href="#cb247-780" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$s$, der Standardabweichung der jeweiligen Gruppe.</span>
<span id="cb247-781"><a href="#cb247-781" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$n_g$, der jeweiligen Gruppengröße.</span>
<span id="cb247-782"><a href="#cb247-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-783"><a href="#cb247-783" aria-hidden="true" tabindex="-1"></a>Zu den Fehlerbalken liefert die Publikation <span class="co">[</span><span class="ot">Error bars in experimental biology</span><span class="co">](https://rupress.org/jcb/article/177/1/7/34602/Error-bars-in-experimental-biology)</span> von @cumming2007error nochmal einen Überblick über Fehlerbalken und welche Fehlerbalken man den nun nutzen sollte. Ich gebe hier nochmal eine kurze Übersicht.</span>
<span id="cb247-784"><a href="#cb247-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-785"><a href="#cb247-785" aria-hidden="true" tabindex="-1"></a>Der Standardfehler</span>
<span id="cb247-786"><a href="#cb247-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-787"><a href="#cb247-787" aria-hidden="true" tabindex="-1"></a>:   Statistische Tests nutzen den Standardfehler um eine Aussage über die Signifikanz zu treffen. Der Standardfehler bleibt immer im Wertebereich des Messwertes.</span>
<span id="cb247-788"><a href="#cb247-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-789"><a href="#cb247-789" aria-hidden="true" tabindex="-1"></a>Die Standardabweichung</span>
<span id="cb247-790"><a href="#cb247-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-791"><a href="#cb247-791" aria-hidden="true" tabindex="-1"></a>:   Barplots oder Säulendiagramme nutzen die Standardabweichung als Fehlerbalken um eine Aussage über die Streuung um den Mittelwert zu treffen. *In bestimmten Fällen macht es Sinn dennoch den Standardfehler als Fehlerbalken zu nutzen, wenn dein Messwert im Wertebereich, wie eine Boniturnote, begrenzt ist.*</span>
<span id="cb247-792"><a href="#cb247-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-793"><a href="#cb247-793" aria-hidden="true" tabindex="-1"></a>Am Ende gibt dazu dann auch eine passend die Publikation von @kozak2020analyzing mit dem Titel <span class="co">[</span><span class="ot">Analyzing designed experiments: Should we report standard deviations or standard errors of the mean or standard errors of the difference or what?</span><span class="co">](https://www.cambridge.org/core/services/aop-cambridge-core/content/view/92DB0AF151C157B9C6E2FA40F9C9B635/S0014479719000401a.pdf/analyzing-designed-experiments-should-we-report-standard-deviations-or-standard-errors-of-the-mean-or-standard-errors-of-the-difference-or-what.pdf)</span></span>
<span id="cb247-794"><a href="#cb247-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-795"><a href="#cb247-795" aria-hidden="true" tabindex="-1"></a><span class="fu">## Der effektive Pfad mit `{emmeans}` {#sec-emmeans}</span></span>
<span id="cb247-796"><a href="#cb247-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-797"><a href="#cb247-797" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb247-798"><a href="#cb247-798" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb247-799"><a href="#cb247-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-800"><a href="#cb247-800" aria-hidden="true" tabindex="-1"></a>Das tolle an <span class="in">`{emmeans}`</span> ist die Flexibilität. Du kannst sehr einfach viele Methoden in <span class="in">`{emmeans}`</span> abdecken. Wenn du die Option für die Adjustierung auf <span class="in">`tukey`</span> stellst, dann rechnest du faktisch einen besseren Tukey HSD Test. Wenn du dann noch in <span class="in">`{emmeans}`</span> die Option mit der Varianzheterogenität wählst, rechnest du einen besseren Games Howell Test. Mehr dazu dann am Ende des Abschnitts, wie du die Ergebnisse präsentierst, da musst du dann gar nicht so viel schreiben.</span>
<span id="cb247-801"><a href="#cb247-801" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-802"><a href="#cb247-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-803"><a href="#cb247-803" aria-hidden="true" tabindex="-1"></a>Wenn du ein zweifaktorielles Design mit etwas wenig Fallzahl pro Gruppe vorliegen hast, dann ist <span class="in">`{emmeans}`</span> die Antwort auf deine Herausforderungen. Darüber hinaus können wir auch sehr einfach Varianzheterogenität modellieren, die Adjustierung für multiple Vergleiche an und ausschalten sowie direkt das *Compact letter display* erhalten. Das Paket `{emmeans}` ist damit die *effiktive* Lösung für einen Gruppenvergleich in den Agarwissenschaften und darüber hinaus. Schauen wir uns also im Folgenden einmal das Paket näher an. Ich verzichte hier auf eine tiefere händische Berechnung sondern konzentriere mich auf die Anwendung der häufigsten Analysefälle.</span>
<span id="cb247-804"><a href="#cb247-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-805"><a href="#cb247-805" aria-hidden="true" tabindex="-1"></a>Ich kann in diesem Abschnitt hier nicht alles erklären und im Detail durchgehen was <span class="in">`{emmeans}`</span> alles kann. Hier gibt es noch ein Tutorium zu <span class="in">`{emmeans}`</span> mit dem Titel <span class="co">[</span><span class="ot">Getting started with emmeans</span><span class="co">](https://aosmith.rbind.io/2019/03/25/getting-started-with-emmeans/)</span>. Daneben gibt es auch noch die <span class="co">[</span><span class="ot">Einführung mit Theorie auf der Seite des R Paktes</span><span class="co">](https://cran.r-project.org/web/packages/emmeans/vignettes/basics.html#contents)</span> oder aber auch der Starter unter <span class="co">[</span><span class="ot">Quick start guide for emmeans</span><span class="co">](https://cran.r-project.org/web/packages/emmeans/vignettes/AQuickStart.html)</span>. Wenn du eine allgemeine Übersicht der Themen in <span class="in">`{emmeans}`</span> brauchst dann hilft dir der <span class="co">[</span><span class="ot">Index of vignette topics -- emmeans package, Version 1.10.6</span><span class="co">](https://cran.r-project.org/web/packages/emmeans/vignettes/vignette-topics.html)</span>. Beginnen wir aber wie immer mit den drängensten Fragen. Wie sieht es mit der Varianz, der Adjustierung und der möglichen Vergleiche sowie der Fallzahl in den einzelnen Behandlungsgruppen aus?</span>
<span id="cb247-806"><a href="#cb247-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-807"><a href="#cb247-807" aria-hidden="true" tabindex="-1"></a>Varianzhomogenität oder Varianzheterogenität</span>
<span id="cb247-808"><a href="#cb247-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-809"><a href="#cb247-809" aria-hidden="true" tabindex="-1"></a>:   Wir können in <span class="in">`{emmeans}`</span> eine mögliche Varianzheterogenität modellieren, wenn wir das nicht tun, dann rechnet <span class="in">`{emmeans}`</span> immer unter der Annahme von Varianzhomogenität. Wenn du nicht für die Varianzheterogenität adjustieren möchtest, dann rechnest du faktisch einen Tukey HSD Test, wenn die Fallzahl in den Gruppen gleich ist. Der Tukey HSD Test rechnet *immer* mit Varianzhomogenität. In allen Beispielen hier, werde ich aber für Varianzheterogenität adjustieren. Dazu nutze ich dann die Option <span class="in">`vcov. = sandwich::vcovHAC`</span> im <span class="in">`emmeans()`</span> Funktionsaufruf. In dem R Paket <span class="in">`{sandwich}`</span> gibt es eine riesige Anzahl an möglichen Funktionen um für Varianzheterogenität zu adjustieren. Wir nutzen hier die Adjustierung <span class="in">`vcovHAC`</span>, die in vielen Fällen vollkommen ausreichend ist.</span>
<span id="cb247-810"><a href="#cb247-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-811"><a href="#cb247-811" aria-hidden="true" tabindex="-1"></a>Adjustierung für multiple Vergleiche</span>
<span id="cb247-812"><a href="#cb247-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-813"><a href="#cb247-813" aria-hidden="true" tabindex="-1"></a>:   Das Paket <span class="in">`{emmeans}`</span> kann sehr einfach für die Adjustierung von multiplen Vergleichen angepasst werden um adjustierte p-Werte zu erhalten. In der Standardeinstellung nutzt <span class="in">`{emmeans}`</span> die Quartile aus einem Tukey HSD Test und somit ist <span class="in">`{emmeans}`</span> gar nicht so weit weg von dem Tukey HSD Test. Ich stelle aber meistens die Adjustierung auf Bonferroni mit der Option <span class="in">`adjust = "bonferroni"`</span>, da diese Adjustierung etwas eingängiger ist. Das bleibt aber dir überlassen, ob du überhaupt eine Adustierung wählen willst. Mit der Option <span class="in">`adjust = "none"`</span> stellst du die Adjustierung für multiple Vergleiche aus. Du erhälst die rohen p-Werte, die manchmal auch nützlich sind.</span>
<span id="cb247-814"><a href="#cb247-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-815"><a href="#cb247-815" aria-hidden="true" tabindex="-1"></a>Mögliche multiple Vergleiche</span>
<span id="cb247-816"><a href="#cb247-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-817"><a href="#cb247-817" aria-hidden="true" tabindex="-1"></a>:   In den folgenden Beispielen rechne ich immer einen <span class="in">`all-pair`</span> Vergleich. Ich werde also alle Gruppen mit allen anderen Gruppen vergleichen. Ob das jetzt wirklich immer Sinn macht sei dahingestellt. Du kannst abr auch alle Gruppen nur zu eienr Kontrolle vergleichen. Dann müssen wir die Funktion <span class="in">`contrast()`</span> anders aufbauen. Wir nutzen dann die Option <span class="in">`method`</span> sowie <span class="in">`ref`</span> um mitzuteilen welche Behandlungsgruppe die Kontrolle ist. Wir erhalten dann folgenden Funktionsaufruf <span class="in">`contrast(method = "trt.vs.ctrl", ref = "fox")`</span>. Die Hilfeseite <span class="co">[</span><span class="ot">contrast-methods</span><span class="co">](https://www.rdocumentation.org/packages/emmeans/versions/1.10.6/topics/contrast-methods)</span> gibt dir nochmal eine Übersicht was alles in <span class="in">`{emmeans}`</span> möglich ist. Welche Kontrast dann neben dem <span class="in">`all-pair`</span> noch passend ist hängt dann sehr von deiner Fragestellung ab. Hier kann ich dann keine allgemeine Aussage zu treffen.</span>
<span id="cb247-818"><a href="#cb247-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-819"><a href="#cb247-819" aria-hidden="true" tabindex="-1"></a>Fallzahl in den einzelnen Behandlungsgruppen</span>
<span id="cb247-820"><a href="#cb247-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-821"><a href="#cb247-821" aria-hidden="true" tabindex="-1"></a>:   Die Stärke von <span class="in">`{emmeans}`</span> ist, dass du dir keine Gedanken machen musst, wie die Fallzahlen in deinen einzelnen Behandlungsgruppen sind. Im Idealfall sind die Fallzahlen balanciert, also die hast in jeder Gruppe die gleiche Anzahl an Beobachtungen. Machmal klappt das aber nicht in einem Experiment und dir fehlen irgendow Beobachtungen, dann rechnet dir <span class="in">`{emmeans}`</span> aber dennoch richtige statistische Maßzahlen aus. Das ist eine wunderbare Eigenschaft von <span class="in">`{emmeans}`</span>. Wenn alles balanciert ist, dann ist alles super. Wenn du aber unbalancierte Daten hast, musst du dich nicht drum kümmern.</span>
<span id="cb247-822"><a href="#cb247-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-823"><a href="#cb247-823" aria-hidden="true" tabindex="-1"></a>Die Stärke der Berücksichtigung von unbalancierten Gruppengrößen kommt von der Berechngn der *marginal effects*. Deshalb heißt das Paket ja auch `{emmeans}` für *Estimated Marginal Means*. Wenn du dich jetzt fragst, was sind denn diese *marginal means* dann gibt es darauf hier und jetzt keine kurze Antwort. Dafür verweise ich auf @heiss2022 und das Onlinetutorium <span class="co">[</span><span class="ot">Marginalia: A guide to figuring out what the heck marginal effects, marginal slopes, average marginal effects, marginal effects at the mean, and all these other marginal things are</span><span class="co">](https://www.andrewheiss.com/blog/2022/05/20/marginalia/)</span>. Heiss erklärt dort sehr schön die Zusammenhänge. Dazu dann noch der Verweis auf die Webseite <span class="co">[</span><span class="ot">Model to Meaning</span><span class="co">](https://marginaleffects.com/bonus/get_started.html)</span> von @heiss2024 um nochmal tiefer in das Modellieren von Daten einzusteigen.</span>
<span id="cb247-824"><a href="#cb247-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-825"><a href="#cb247-825" aria-hidden="true" tabindex="-1"></a>Wichtig ist aber, du musst *marginal effects* oder das Konzept dahinter nicht verstanden haben um das R Paket <span class="in">`{emmeans}`</span> sinnvoll nutzen zu können. Ja, damit überfahren wir wieder einen statistischen Engel, aber so ist es manchmal, wenn wir hier Sachen auf die Straße bringen wollen. Also fangen wir hier jetzt einmal an die einfaktorielle und zweifaktorielle Analyse in <span class="in">`{emmeans}`</span> zu rechnen und zu interpretieren.</span>
<span id="cb247-826"><a href="#cb247-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-827"><a href="#cb247-827" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktorielle Analyse {.unnumbered .unlisted}</span></span>
<span id="cb247-828"><a href="#cb247-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-829"><a href="#cb247-829" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit der einfaktorielle Analyse in dem wir erstmal ein ANOVA Modell rechnen. Wir nehmen hier die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> als unseren Messwert $y$ und dann die Tierrasse $f_1$ als Faktor in das Modell. Hier brauchen wir das ANOVA Modell nur zur Berechnung unserer statistischen Maßzahlen. Wir könnten die Interpreation also auch weglassen.</span>
<span id="cb247-830"><a href="#cb247-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-833"><a href="#cb247-833" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-834"><a href="#cb247-834" aria-hidden="true" tabindex="-1"></a>fac1_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb247-835"><a href="#cb247-835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-836"><a href="#cb247-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-837"><a href="#cb247-837" aria-hidden="true" tabindex="-1"></a>Ich nutze jetzt das ANOVA Modell gleich für den Aufruf der <span class="in">`emmeans()`</span> Funktion, die uns die Mittelwerte und die Varianzen in den Gruppen berechnet. Ich wähle hier die Adjustierung für die Varianzheterogenität mit der Option <span class="in">`vcov.`</span> als Standard. Eiegntlich rechne ich immer unter der Annahme der Varianzheterogenität, da ich nicht viel verliere aber viel falsch machen kann, wenn ich die Heterogenität nicht berücksichtige.</span>
<span id="cb247-838"><a href="#cb247-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-841"><a href="#cb247-841" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-842"><a href="#cb247-842" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj <span class="ot">&lt;-</span> fac1_aov <span class="sc">|&gt;</span>  </span>
<span id="cb247-843"><a href="#cb247-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) </span>
<span id="cb247-844"><a href="#cb247-844" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj</span>
<span id="cb247-845"><a href="#cb247-845" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-846"><a href="#cb247-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-847"><a href="#cb247-847" aria-hidden="true" tabindex="-1"></a>Wir erhalten also unser <span class="in">`{emmeans}`</span> Objekt für unsere einfaktorielle Analyse. Darin ist eigentlich alles enthalten was wir jetzt brauchen. Die Mittelwerte der Gruppen sind da und auch die entsprechende Standardfehler der Gruppen. Wenn du die Standardabweichung zurückrechnen willst, dann musst du $SE \cdot \sqrt{n_g}$ rechnen mit der Gruppengröße $n_g =7$ in unserem Fall. Denn nun ist ja die Frage, was willst du haben? Ich zeige dir in den folgenden Tabs einmal wie du die p-Werte, das *Comapct letter display* und die 95% Konfidenzintervalle berechnest.</span>
<span id="cb247-848"><a href="#cb247-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-849"><a href="#cb247-849" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-850"><a href="#cb247-850" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte</span></span>
<span id="cb247-851"><a href="#cb247-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-852"><a href="#cb247-852" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit den p-Werten, die jeder braucht. Wir können das <span class="in">`emm_fac1_obj`</span> Objekt von oben jetzt einfach in die Funktion <span class="in">`{contrast}`</span> stecken und dann definieren welche Vergleiche gerechnet werden sollen. In den agrarwissenschaftlichen Fächern ist des dann meist ein <span class="in">`all-pair`</span> Vergleich. Wir vergleichen alles mit allem. Am Ende wähle ich onch die Adjustierung für multiple Vergleiche nach Bonferroni.</span>
<span id="cb247-853"><a href="#cb247-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-856"><a href="#cb247-856" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-857"><a href="#cb247-857" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac1_obj <span class="ot">&lt;-</span> emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-858"><a href="#cb247-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) </span>
<span id="cb247-859"><a href="#cb247-859" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac1_obj</span>
<span id="cb247-860"><a href="#cb247-860" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-861"><a href="#cb247-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-862"><a href="#cb247-862" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass wir die Vergleiche für die einzelnen Floharten für die Sprunglänge erhalten. Der <span class="in">`estimate`</span> ist der Effekt und damit die Differenz der Mittelwerte für die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> für den jeweiligen Verleiche. Dann sehen wir in der Spalte <span class="in">`SE`</span> noch, dass wir richtig für Varianzhterogenität adjustiert haben, da der Vergleich <span class="in">`dog - cat`</span> nur $2/3$ der Varianz der beiden anderen Vergleiche zeigt. Wir sehen dann am Ende, dass die Vergleiche <span class="in">`dog - cat`</span> und <span class="in">`cat - fox`</span> signifikant unterschiedlich sind. Die p-Werte liegen unter dem Signifikanzniveau von 5%.</span>
<span id="cb247-863"><a href="#cb247-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-864"><a href="#cb247-864" aria-hidden="true" tabindex="-1"></a>Jetzt ist es manchmal so, dass du die Mittelwerte, die Differenz der Mittelwerte und die p-Werte haben möchtest. Das kannst du ganz einfach durch die Funktion <span class="in">`pwpm()`</span> erreichen. Hier gibt es dann natürlich nur die paarweisen Vergleiche.</span>
<span id="cb247-865"><a href="#cb247-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-868"><a href="#cb247-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-869"><a href="#cb247-869" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-870"><a href="#cb247-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb247-871"><a href="#cb247-871" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-872"><a href="#cb247-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-873"><a href="#cb247-873" aria-hidden="true" tabindex="-1"></a>Am Ende gibt es in <span class="in">`{emmeans}`</span> noch den paarweisen p-Wert Plot, der die p-Werte einmal auf der x-Achse visualisiert. Da siehst du dann nochmal die Ordnung der Signifikanz über die gesamten Vergleiche. Die Abbildung finde ich persönlich manchmal interessant und manchmal wenig aussagekräftig. Kommt immer auf den Fall an.</span>
<span id="cb247-874"><a href="#cb247-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-877"><a href="#cb247-877" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-878"><a href="#cb247-878" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-879"><a href="#cb247-879" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-880"><a href="#cb247-880" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-881"><a href="#cb247-881" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-882"><a href="#cb247-882" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb247-883"><a href="#cb247-883" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb247-884"><a href="#cb247-884" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Ergebnisse im Pairwise P-value plot. Auf der y-Achse sind die Gruppen und die entsprechenden Gruppenmittelwerte dargestellt."</span></span>
<span id="cb247-885"><a href="#cb247-885" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-3</span></span>
<span id="cb247-886"><a href="#cb247-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-887"><a href="#cb247-887" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-888"><a href="#cb247-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpp</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">+</span></span>
<span id="cb247-889"><a href="#cb247-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-890"><a href="#cb247-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb247-891"><a href="#cb247-891" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-892"><a href="#cb247-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-893"><a href="#cb247-893" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact letter display*</span></span>
<span id="cb247-894"><a href="#cb247-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-895"><a href="#cb247-895" aria-hidden="true" tabindex="-1"></a>Nachdem wir in dem vorherigen Tab die p-Werte berechnet haben, könen wir jetzt einmal das *Compact letter display* erstellen. Hier hat das R Paket `{emmeans}` eine eigene Funktion mit `cld()`. Die Funktion nimmt das Objekt `emm_fac1_obj` und berechnet darauf das nach Bonferroni adjustierte *Compact letter display*.</span>
<span id="cb247-896"><a href="#cb247-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-899"><a href="#cb247-899" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-900"><a href="#cb247-900" aria-hidden="true" tabindex="-1"></a>emm_cld_fac1_obj <span class="ot">&lt;-</span> emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-901"><a href="#cb247-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb247-902"><a href="#cb247-902" aria-hidden="true" tabindex="-1"></a>emm_cld_fac1_obj</span>
<span id="cb247-903"><a href="#cb247-903" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-904"><a href="#cb247-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-905"><a href="#cb247-905" aria-hidden="true" tabindex="-1"></a>Der größte Vorteil von <span class="in">`{emmeans}`</span> ist jetzt, dass wir die Ausgabe des *Compact letter displays* direkt nutzen können um unseren Barplot zu zeichnen. Wir müssen nur einmal die Werte der Standardfehler mit der Wurzel der Gruppenfallzahl multiplizieren um auf die Standardabweichung zu kommen. Wenn du möchtest, kannst du auch den Standardfehler als Fehlerbalken nutzen, musst es nur Angeben. Da wir hier sieben Flöhe je Tierart gemessen haben, multiplizieren wir den Standardfehler mit der Wurzel von 7 um auf die Standardabweichung zu kommen. Dann entferne ich noch die Leerzeichen in der Spalte <span class="in">`.group`</span> mit der Funktion <span class="in">`str_trim()`</span> und ich kann den Barplot erstellen.</span>
<span id="cb247-906"><a href="#cb247-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-909"><a href="#cb247-909" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-910"><a href="#cb247-910" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-911"><a href="#cb247-911" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-912"><a href="#cb247-912" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-913"><a href="#cb247-913" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-914"><a href="#cb247-914" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb247-915"><a href="#cb247-915" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb247-916"><a href="#cb247-916" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Barplot oder Säulendigramm der mittleren Sprungweiten in [cm] für drei Floharten. Die Fehlerbalken stellen die Standardabweichung dar. Die Buchstaben das Bonferroni adjustierte *Compact letter display*."</span></span>
<span id="cb247-917"><a href="#cb247-917" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-fac1-cld</span></span>
<span id="cb247-918"><a href="#cb247-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-919"><a href="#cb247-919" aria-hidden="true" tabindex="-1"></a>emm_cld_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-920"><a href="#cb247-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb247-921"><a href="#cb247-921" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">7</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-922"><a href="#cb247-922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> emmean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb247-923"><a href="#cb247-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-924"><a href="#cb247-924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb247-925"><a href="#cb247-925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb247-926"><a href="#cb247-926" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb247-927"><a href="#cb247-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb247-928"><a href="#cb247-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb247-929"><a href="#cb247-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb247-930"><a href="#cb247-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="fl">0.5</span>),</span>
<span id="cb247-931"><a href="#cb247-931" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="dv">2</span>)</span>
<span id="cb247-932"><a href="#cb247-932" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-933"><a href="#cb247-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-934"><a href="#cb247-934" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall</span></span>
<span id="cb247-935"><a href="#cb247-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-936"><a href="#cb247-936" aria-hidden="true" tabindex="-1"></a>Am Ende können wir dann auch aus den paarweisen Vergleichen die 95% Konfidenzintervalle berechnen. Hier nutzen wir dann die Funktion <span class="in">`tidy()`</span> aus dem Paket <span class="in">`{broom}`</span> um uns die 95% Konfidenzintervalle sauber wiedergeben zu lassen. Du kannst noch die Kontraste auf <span class="in">`revpairwise`</span> stellen, wenn die Vergleiche umdrehen willst.</span>
<span id="cb247-937"><a href="#cb247-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-940"><a href="#cb247-940" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-941"><a href="#cb247-941" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-942"><a href="#cb247-942" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-943"><a href="#cb247-943" aria-hidden="true" tabindex="-1"></a>emm_ci_fac1_obj <span class="ot">&lt;-</span> emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-944"><a href="#cb247-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-945"><a href="#cb247-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-946"><a href="#cb247-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, adj.p.value, conf.low, conf.high) </span>
<span id="cb247-947"><a href="#cb247-947" aria-hidden="true" tabindex="-1"></a>emm_ci_fac1_obj</span>
<span id="cb247-948"><a href="#cb247-948" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-949"><a href="#cb247-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-950"><a href="#cb247-950" aria-hidden="true" tabindex="-1"></a>Die Stärke eines 95% Konfidenzintervalls ist ja die Signifikanz mit der Relevanz zu verbinden. Daher setze ich jetzt mal die Relevanzschwelle <span class="in">`relevance_lvl`</span> auf $&gt;0.75cm$. Wenn also Floharten im Mittel sich mindestens um $0.75cm$ unterscheiden, dann ist der Vergleich relevant. Das habe ich jetzt einfach so entschieden. Wir schauen hier dann auf größer/gleich, was auch mehr Sinn macht. Theoretisch kannst du auch in beide Richtungen die Relevanz definieren, aber in der Anwendung ist es eher selten, dass uns beide Richtungen interessieren.</span>
<span id="cb247-951"><a href="#cb247-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-954"><a href="#cb247-954" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-955"><a href="#cb247-955" aria-hidden="true" tabindex="-1"></a>relevance_lvl <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb247-956"><a href="#cb247-956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-957"><a href="#cb247-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-958"><a href="#cb247-958" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du einmal die 95% Konfidenzintervalle für alle paarweisen Vergleiche. Ich habe am Anfang nochmal eine Regel mit <span class="in">`case_when()`</span> erstellt, nachder ich dann die 95% Konfidenzintervall nach der Signifikanz und Relevanz einfärbe. Das ist ja die Stärke der 95% Konfidenzintervalle und dann sollte man die auch Nutzen. Wo du die Relevanzschwelle legst, ist dann dir selber überlassen. Das hängt von deiner wissenschaftlichen Fragestellung ab.</span>
<span id="cb247-959"><a href="#cb247-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-962"><a href="#cb247-962" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-963"><a href="#cb247-963" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-964"><a href="#cb247-964" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-965"><a href="#cb247-965" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-966"><a href="#cb247-966" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-967"><a href="#cb247-967" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb247-968"><a href="#cb247-968" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb247-969"><a href="#cb247-969" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Die 95% Konfidenzintervalle für die *allpair*-Vergleiche der mittleren Sprungweite in [cm] für die drei Floharten. Die Farben stellen die Signifkanz und Relevanz der 95% Konfidenzintervalle dar. Als relevant sind mittlere Differenzen größer als $0.75cm$ definiert. **(n.s)** Nicht signifikanter Vergleich, da die 0 im 95% Konfidenzintervall enthalten ist. **(s)** Signifikanter, nicht relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und links von der Relevanzschwelle liegt. **(s. &amp; r.)** Signifikanter, relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und rechts von der Relevanzschwelle liegt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb247-970"><a href="#cb247-970" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-1</span></span>
<span id="cb247-971"><a href="#cb247-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-972"><a href="#cb247-972" aria-hidden="true" tabindex="-1"></a>emm_ci_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-973"><a href="#cb247-973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig_lgl =</span> <span class="fu">case_when</span>(<span class="fu">between</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">n</span>()), conf.low, conf.high) <span class="sc">~</span> <span class="st">"n.s."</span>,</span>
<span id="cb247-974"><a href="#cb247-974" aria-hidden="true" tabindex="-1"></a>                             relevance_lvl <span class="sc">&lt;</span> conf.low <span class="sc">~</span> <span class="st">"s. &amp; r."</span>,</span>
<span id="cb247-975"><a href="#cb247-975" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> <span class="st">"s."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-976"><a href="#cb247-976" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(contrast, <span class="at">y =</span> estimate, </span>
<span id="cb247-977"><a href="#cb247-977" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">color =</span> sig_lgl)) <span class="sc">+</span></span>
<span id="cb247-978"><a href="#cb247-978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-979"><a href="#cb247-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb247-980"><a href="#cb247-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb247-981"><a href="#cb247-981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> relevance_lvl, <span class="at">linetype =</span> <span class="st">"11"</span>,</span>
<span id="cb247-982"><a href="#cb247-982" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb247-983"><a href="#cb247-983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb247-984"><a href="#cb247-984" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb247-985"><a href="#cb247-985" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb247-986"><a href="#cb247-986" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Mittelwertsunterschied"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb247-987"><a href="#cb247-987" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb247-988"><a href="#cb247-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-989"><a href="#cb247-989" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-990"><a href="#cb247-990" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-991"><a href="#cb247-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-992"><a href="#cb247-992" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktorielle Analyse {.unnumbered .unlisted}</span></span>
<span id="cb247-993"><a href="#cb247-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-994"><a href="#cb247-994" aria-hidden="true" tabindex="-1"></a>Nachdem wir uns die einfaktorielle Analyse angeschaut haben, kommen wir jetzt du der eigentlich interessanten Analyse. Wir wollen nämlich jetzt mal zwei Faktoren in einer zweifaktoriellen Analyse auswerten. Meistens haben wir nicht nur einen Faktor vorliegen sondern minestens zwei. Daher hier einmal das MOdell für unsere Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> für den Faktor <span class="in">`animal`</span> mit den drei Floharten sowie dem Faktor <span class="in">`site`</span> und den zwei Messorten Stadt und Dorf. Ich ahbe hier absichtlich den zweiten Faktor nur auf zwei Level begrenz, sonst werden die Ausgaben der Funktionen so groß. Später können deine Faktoren natürlich mehr Level oder Gruppen haben. Wir rechnen also einmal eine ANOVA um uns die statistsichen Maßzahlen als ein Modell wiedergeben zu lassen.</span>
<span id="cb247-995"><a href="#cb247-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-998"><a href="#cb247-998" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-999"><a href="#cb247-999" aria-hidden="true" tabindex="-1"></a>fac2_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span>
<span id="cb247-1000"><a href="#cb247-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1001"><a href="#cb247-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1002"><a href="#cb247-1002" aria-hidden="true" tabindex="-1"></a>Wenn wir zwei Faktoren vorliegen haben, dann müssen wir entscheiden, wie wir die zwei Faktoren auswerten wollen. Hierbei kommen wir um den Begriff *nested* (deu. *verschachtelt*, nicht gebräuchlich) herum. In der folgenden Abbildung habe ich das Konzept einmal dargestellt. In unserem Fall ist der Faktor <span class="in">`animal`</span> in dem zweiten Faktor <span class="in">`site`</span> genested. Alle Floharten wurden an allen Messorten gemessen.</span>
<span id="cb247-1003"><a href="#cb247-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1006"><a href="#cb247-1006" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb247-1007"><a href="#cb247-1007" aria-hidden="true" tabindex="-1"></a><span class="in">%%| label: fig-mermaid-emmeans-01</span></span>
<span id="cb247-1008"><a href="#cb247-1008" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-width: 6</span></span>
<span id="cb247-1009"><a href="#cb247-1009" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-cap: "Abhängigkeitsstruktur des zweifaktoriellen Designs für die Analyse der Sprungweite von Floharten an verschiedenen Messorten mit einem Faktor `animal` nested im Faktor `site`."</span></span>
<span id="cb247-1010"><a href="#cb247-1010" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart LR</span></span>
<span id="cb247-1011"><a href="#cb247-1011" aria-hidden="true" tabindex="-1"></a><span class="in">    A(animal):::factor --- B(((nested))) --&gt; C(site):::factor</span></span>
<span id="cb247-1012"><a href="#cb247-1012" aria-hidden="true" tabindex="-1"></a><span class="in">    classDef factor fill:#56B4E9,stroke:#333,stroke-width:0.75px</span></span>
<span id="cb247-1013"><a href="#cb247-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1014"><a href="#cb247-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1015"><a href="#cb247-1015" aria-hidden="true" tabindex="-1"></a>Damit gilt dann auch, dass jeder Messort alle Floharten enthält und die Floharten damit innerhalb eines Messortes randomsiert wurden. Ich habe dir das nochmal etwas anders dargestellt. Es ist wichtig sich den Zusammenhang klar zu machen, damit du später die Auswertung für deine wissenschaftliche Fragestellung richtig machst. Ich zeige dir hier jetzt *einen* Weg und du musst dann entscheiden, ob der bei dir auch so passt.</span>
<span id="cb247-1016"><a href="#cb247-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1017"><a href="#cb247-1017" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-1018"><a href="#cb247-1018" aria-hidden="true" tabindex="-1"></a>\underbrace{\mbox{Messorte}}_{f_2} \xrightarrow[]{beinhaltet\; alle} \overbrace{\mbox{Floharten}}^{f_1}</span>
<span id="cb247-1019"><a href="#cb247-1019" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-1020"><a href="#cb247-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1021"><a href="#cb247-1021" aria-hidden="true" tabindex="-1"></a>Wir müssen uns jetzt entscheiden wie wir die beiden Faktoren $f_1$ mit <span class="in">`animal`</span> und $f_2$ mit <span class="in">`site`</span> auswerten wollen. Wir können den Faktor <span class="in">`animal`</span> getrennt (eng. *separate*) für jedes Level des Faktors `site` vergleichen oder wir vergleichen alle Faktorkombinationen gemeinsam (eng. *combined*). Welcher Fakotr das bei dir dann in deiner Auswertung ist, kann ich natürlich nicht sagen. Aber meistens ist es dann klarer wenn du mit der Auswertung beginnst und dir die Ergebnisse versuchst zu interpretieren. Im Folgenden zeige ich dir einmal wie du die separierte und kombinierte Analyse in <span class="in">`{emmeans}`</span> rechnest.</span>
<span id="cb247-1022"><a href="#cb247-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1023"><a href="#cb247-1023" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-1024"><a href="#cb247-1024" aria-hidden="true" tabindex="-1"></a><span class="fu">## $f_1$ **separiert** $f_2$ mit $\boxed{\sim f_1\, |\, f_2}$</span></span>
<span id="cb247-1025"><a href="#cb247-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1026"><a href="#cb247-1026" aria-hidden="true" tabindex="-1"></a>Wenn du den ersten Faktor <span class="in">`animal`</span> separiert also getrennt für den zweiten Faktor <span class="in">`site`</span> rechnen willst, dann nutzt du den Separator <span class="in">`|`</span> um die getrennte Analyse zu rechnen. Du siehst, dass die Mittelwerte für die Floharten getrennt für die Messorte berechnet werden. Wiederum entscheide ich mich hier für die Adjustierung für die Varianzheterogenität.</span>
<span id="cb247-1027"><a href="#cb247-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1030"><a href="#cb247-1030" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1031"><a href="#cb247-1031" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj <span class="ot">&lt;-</span> fac2_aov <span class="sc">|&gt;</span> </span>
<span id="cb247-1032"><a href="#cb247-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) </span>
<span id="cb247-1033"><a href="#cb247-1033" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj</span>
<span id="cb247-1034"><a href="#cb247-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1035"><a href="#cb247-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1036"><a href="#cb247-1036" aria-hidden="true" tabindex="-1"></a><span class="fu">## $f_1$ **kombiniert** $f_2$ mit $\boxed{\sim f_1 * f_2}$</span></span>
<span id="cb247-1037"><a href="#cb247-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1038"><a href="#cb247-1038" aria-hidden="true" tabindex="-1"></a>Wenn du den ersten Faktor <span class="in">`animal`</span> mit allen Kombinationen des zweiten Faktors <span class="in">`site`</span> berechnen willst, dann nutzt du den Kombinator <span class="in">`*`</span> um die kombinierte Analyse zu rechnen. Du siehst, dass die Mittelwerte für die Floharten für jeden Messort berechnet wird und die Ausgabe am Ende zusammengefasst wird. Wiederum entscheide ich mich hier für die Adjustierung für die Varianzheterogenität.</span>
<span id="cb247-1039"><a href="#cb247-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1042"><a href="#cb247-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1043"><a href="#cb247-1043" aria-hidden="true" tabindex="-1"></a>emm_fac2_combinded_obj <span class="ot">&lt;-</span> fac2_aov <span class="sc">|&gt;</span> </span>
<span id="cb247-1044"><a href="#cb247-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">*</span> site, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) </span>
<span id="cb247-1045"><a href="#cb247-1045" aria-hidden="true" tabindex="-1"></a>emm_fac2_combinded_obj</span>
<span id="cb247-1046"><a href="#cb247-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1047"><a href="#cb247-1047" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-1048"><a href="#cb247-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1049"><a href="#cb247-1049" aria-hidden="true" tabindex="-1"></a>Wir erhalten also unser <span class="in">`{emmeans}`</span> Objekt für unsere zweifaktorielle Analyse. Darin ist eigentlich alles enthalten was wir jetzt brauchen. Denn nun ist ja die Frage, was willst du haben? Ich zeige dir in den folgenden Tabs einmal wie du die p-Werte, das *Comapct letter display* und die 95% Konfidenzintervalle für die getrennte Analyse nach den zweiten Faktor berechnest. Deshalb erst überlegen, wie du die beiden Faktoren $f_1$ und $f_2$ auswerten willst. Je nachdem du dich dann entscheidest, kommen natürlich andere Egebnisse heraus.</span>
<span id="cb247-1050"><a href="#cb247-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1051"><a href="#cb247-1051" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-1052"><a href="#cb247-1052" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte mit $\boxed{\sim f_1\, |\, f_2}$</span></span>
<span id="cb247-1053"><a href="#cb247-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1054"><a href="#cb247-1054" aria-hidden="true" tabindex="-1"></a>Beginnen wir wieder die p-Werte für unseren Vergleich der Floharten für die mittleren Sprungweiten zu berechnen. Wir nutzen hierzu wieder die Funktion <span class="in">`contrast()`</span> wie auch schon im einfaktoriellen Fall. Das ist jetzt auch so eine Stärke von <span class="in">`{emmeans}`</span>, wenn wir das Modell hinkriegen, dann können wir auch mehr Faktoren beliebig ergänzen. Mir gefällt hier nicht die Reihenfolge in den Vergleichen. Statt <span class="in">`cat - dog`</span> möchte ich lieber den Kontrast <span class="in">`dog - cat`</span>. Daher wähle ich als Methode <span class="in">`revpairwise`</span> und drehe damit einmal meine Vergleiche.</span>
<span id="cb247-1055"><a href="#cb247-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1058"><a href="#cb247-1058" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1059"><a href="#cb247-1059" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac2_separate_obj <span class="ot">&lt;-</span> emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1060"><a href="#cb247-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"revpairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb247-1061"><a href="#cb247-1061" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac2_separate_obj</span>
<span id="cb247-1062"><a href="#cb247-1062" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1063"><a href="#cb247-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1064"><a href="#cb247-1064" aria-hidden="true" tabindex="-1"></a>Jetzt erhalten wir für den zweiten Faktor <span class="in">`site`</span> die Vergleiche der Sprungweiten der Hunde- und Katzenflöhe einmal wiedergegeben. Dabei sehen wir, dass sich die mittleren Sprungweiten signifikant in der Stadt unterscheiden, jedoch nicht auf dem Dorf. Die p-Werte in den Vergleichen in der Stadt sind alle unter dem Signifikanzniveau $\alpha$ gleich 5%. Wir können hier also die Nullhypothese ablehnen, dass die Mitelwerte für den jeweiligen Vergleich gleich sind.</span>
<span id="cb247-1065"><a href="#cb247-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1066"><a href="#cb247-1066" aria-hidden="true" tabindex="-1"></a>Jetzt können wir uns auch die Vergleiche als eine Matrix getrennt für den Faktor <span class="in">`site`</span> anzeigen lassen. Hier ist es natürlich praktisch, dass wir gleich die Mittelwerte sowie die mittleren Differenzen als auch die p-Werte in einer Ausgabe vorliegen haben.</span>
<span id="cb247-1067"><a href="#cb247-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1070"><a href="#cb247-1070" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1071"><a href="#cb247-1071" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac2_separate_obj <span class="sc">|&gt;</span>   </span>
<span id="cb247-1072"><a href="#cb247-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb247-1073"><a href="#cb247-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1074"><a href="#cb247-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1075"><a href="#cb247-1075" aria-hidden="true" tabindex="-1"></a>Im einfaktoriellen Fall fand ich den paarweisen p-Wert Plot nicht so richtig informativ. Wenn du dir aber zwei Faktoren anschaust, dann kann man da schon mehr erkennen. Bilden die p-Werte in dem einen Level des zweiten Faktors ein anderes Muster als in einem anderen Level des Faktors? Hier sehen wir sehr schön, dass wir in der Stadt sehr kleine p-Werte erhalten aber auf dem Land im Dorf sehr große p-Werte. Das zeigt nochmal sehr deutlich, wie sich der erste Faktor <span class="in">`animal`</span> in den Leveln des zweiten Faktor <span class="in">`site`</span> unterscheidet.</span>
<span id="cb247-1076"><a href="#cb247-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1079"><a href="#cb247-1079" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1080"><a href="#cb247-1080" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-1081"><a href="#cb247-1081" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-1082"><a href="#cb247-1082" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-1083"><a href="#cb247-1083" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-1084"><a href="#cb247-1084" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb247-1085"><a href="#cb247-1085" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb247-1086"><a href="#cb247-1086" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Ergebnisse im Pairwise P-value plot. Auf der y-Achse sind die Gruppen und die entsprechenden Gruppenmittelwerte dargestellt."</span></span>
<span id="cb247-1087"><a href="#cb247-1087" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-sep-01</span></span>
<span id="cb247-1088"><a href="#cb247-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1089"><a href="#cb247-1089" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1090"><a href="#cb247-1090" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpp</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">+</span></span>
<span id="cb247-1091"><a href="#cb247-1091" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-1092"><a href="#cb247-1092" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb247-1093"><a href="#cb247-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1094"><a href="#cb247-1094" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1095"><a href="#cb247-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1096"><a href="#cb247-1096" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact letter display* mit $\boxed{\sim f_1\, |\, f_2}$</span></span>
<span id="cb247-1097"><a href="#cb247-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1098"><a href="#cb247-1098" aria-hidden="true" tabindex="-1"></a>Nachdem wir in dem vorherigen Tab die p-Werte berechnet haben, könen wir jetzt einmal das *Compact letter display* erstellen. Hier hat das R Paket `{emmeans}` eine eigene Funktion mit `cld()`. Die Funktion nimmt das Objekt `emm_fac2_separate_obj` und berechnet darauf das nach Bonferroni adjustierte *Compact letter display*.</span>
<span id="cb247-1099"><a href="#cb247-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1102"><a href="#cb247-1102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1103"><a href="#cb247-1103" aria-hidden="true" tabindex="-1"></a>emm_cld_fac2_separate_obj <span class="ot">&lt;-</span> emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1104"><a href="#cb247-1104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb247-1105"><a href="#cb247-1105" aria-hidden="true" tabindex="-1"></a>emm_cld_fac2_separate_obj</span>
<span id="cb247-1106"><a href="#cb247-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1107"><a href="#cb247-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1108"><a href="#cb247-1108" aria-hidden="true" tabindex="-1"></a>Auch hier ist der große Vorteil von <span class="in">`{emmeans}`</span>, dass wir die Ausgabe des *Compact letter displays* direkt nutzen können um unseren Barplot zu zeichnen. Wir müssen nur einmal die Werte der Standardfehler mit der Wurzel der Gruppenfallzahl multiplizieren um auf die Standardabweichung zu kommen. Da wir hier sieben Flöhe je Tierart gemessen haben, multiplizieren wir den Standardfehler mit der Wurzel von 7 um auf die Standardabweichung zu kommen. Dann entferne ich noch die Leerzeichen in der Spalte `.group` mit der Funktion `str_trim()` und ich kann den Barplot erstellen. Wichtig ist hier, dass wir uns die beiden Messorte `city` und `village` voneinander *getrennt* betrachten. Daher haben wir im Dorf auch den Buchstaben a wie auch in der Stadt, obwohl es klare Unterschiede gibt. Wenn du alle Barplots kombiniert ein *Compact letter displays* haben willst, dann schaue in der Analyse weiter unten nach.</span>
<span id="cb247-1109"><a href="#cb247-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1112"><a href="#cb247-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1113"><a href="#cb247-1113" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-1114"><a href="#cb247-1114" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-1115"><a href="#cb247-1115" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-1116"><a href="#cb247-1116" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-1117"><a href="#cb247-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb247-1118"><a href="#cb247-1118" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb247-1119"><a href="#cb247-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Barplot oder Säulendigramm der mittleren Sprungweiten in [cm] für drei Floharten und der entsprechenden Messorte separiert. Die Fehlerbalken stellen die Standardabweichung dar. Die Buchstaben das Bonferroni adjustierte *Compact letter display*."</span></span>
<span id="cb247-1120"><a href="#cb247-1120" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-sep-02</span></span>
<span id="cb247-1121"><a href="#cb247-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1122"><a href="#cb247-1122" aria-hidden="true" tabindex="-1"></a>emm_cld_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1123"><a href="#cb247-1123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb247-1124"><a href="#cb247-1124" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">7</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-1125"><a href="#cb247-1125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> emmean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb247-1126"><a href="#cb247-1126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-1127"><a href="#cb247-1127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.9</span>, </span>
<span id="cb247-1128"><a href="#cb247-1128" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb247-1129"><a href="#cb247-1129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb247-1130"><a href="#cb247-1130" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb247-1131"><a href="#cb247-1131" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb247-1132"><a href="#cb247-1132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, </span>
<span id="cb247-1133"><a href="#cb247-1133" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>,</span>
<span id="cb247-1134"><a href="#cb247-1134" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb247-1135"><a href="#cb247-1135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb247-1136"><a href="#cb247-1136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb247-1137"><a href="#cb247-1137" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>))</span>
<span id="cb247-1138"><a href="#cb247-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1139"><a href="#cb247-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1140"><a href="#cb247-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall mit $\boxed{\sim f_1\, |\, f_2}$</span></span>
<span id="cb247-1141"><a href="#cb247-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1142"><a href="#cb247-1142" aria-hidden="true" tabindex="-1"></a>Am Ende können wir dann auch aus den paarweisen Vergleichen die 95% Konfidenzintervalle berechnen. Hier nutzen wir dann die Funktion <span class="in">`tidy()`</span> aus dem Paket <span class="in">`{broom}`</span> um uns die 95% Konfidenzintervalle sauber wiedergeben zu lassen. Ich habe hier einmal die Kontraste auf <span class="in">`revpairwise`</span> gestellt um die Vergleiche wie bei den p-Werten zu drehen.</span>
<span id="cb247-1143"><a href="#cb247-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1146"><a href="#cb247-1146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1147"><a href="#cb247-1147" aria-hidden="true" tabindex="-1"></a>emm_ci_fac2_separate_obj <span class="ot">&lt;-</span> emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1148"><a href="#cb247-1148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-1149"><a href="#cb247-1149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-1150"><a href="#cb247-1150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, site, estimate, conf.low, conf.high) </span>
<span id="cb247-1151"><a href="#cb247-1151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1152"><a href="#cb247-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1153"><a href="#cb247-1153" aria-hidden="true" tabindex="-1"></a>Die Stärke eines 95% Konfidenzintervalls ist ja die Signifikanz mit der Relevanz zu verbinden. Daher setze ich jetzt mal die Relevanzschwelle <span class="in">`relevance_lvl`</span> auf $&gt;2cm$. Wenn also Floharten im Mittel sich mindestens um $2cm$ unterscheiden, dann ist der Vergleich relevant. Das habe ich jetzt einfach so entschieden. Wir schauen hier dann auf größer/gleich, was auch mehr Sinn macht. Theoretisch kannst du auch in beide Richtungen die Relevanz definieren, aber in der Anwendung ist es eher selten, dass uns beide Richtungen interessieren.</span>
<span id="cb247-1154"><a href="#cb247-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1157"><a href="#cb247-1157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1158"><a href="#cb247-1158" aria-hidden="true" tabindex="-1"></a>relevance_lvl <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb247-1159"><a href="#cb247-1159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1160"><a href="#cb247-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1161"><a href="#cb247-1161" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du einmal die 95% Konfidenzintervalle für alle paarweisen Vergleiche. Ich habe am Anfang nochmal eine Regel mit <span class="in">`case_when()`</span> erstellt, nachder ich dann die 95% Konfidenzintervall nach der Signifikanz und Relevanz einfärbe. Das ist ja die Stärke der 95% Konfidenzintervalle und dann sollte man die auch Nutzen. Wo du die Relevanzschwelle legst, ist dann dir selber überlassen. Das hängt von deiner wissenschaftlichen Fragestellung ab. Beachte, dass ich hier noch die Linienart ändern musste um die Messorte mit einzeichnen zu können. Wir haben am Ende nur einen relevanten und signifikanten Vergleich. Nämlich den Vergleich der Fuchsflöhe zu den Katzenflöhen in der Stadt.</span>
<span id="cb247-1162"><a href="#cb247-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1165"><a href="#cb247-1165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1166"><a href="#cb247-1166" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-1167"><a href="#cb247-1167" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-1168"><a href="#cb247-1168" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-1169"><a href="#cb247-1169" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-1170"><a href="#cb247-1170" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb247-1171"><a href="#cb247-1171" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb247-1172"><a href="#cb247-1172" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Die 95% Konfidenzintervalle für die *allpair*-Vergleiche der mittleren Sprungweite in [cm] für die drei Floharten und zwei Messorte. Die Farben stellen die Signifkanz und Relevanz der 95% Konfidenzintervalle dar. Als relevant sind mittlere Differenzen größer als $0.75cm$ definiert. **(n.s)** Nicht signifikanter Vergleich, da die 0 im 95% Konfidenzintervall enthalten ist. **(s)** Signifikanter, nicht relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und links von der Relevanzschwelle liegt. **(s. &amp; r.)** Signifikanter, relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und rechts von der Relevanzschwelle liegt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb247-1173"><a href="#cb247-1173" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-sep-03</span></span>
<span id="cb247-1174"><a href="#cb247-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1175"><a href="#cb247-1175" aria-hidden="true" tabindex="-1"></a>emm_ci_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1176"><a href="#cb247-1176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig_lgl =</span> <span class="fu">case_when</span>(<span class="fu">between</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">n</span>()), conf.low, conf.high) <span class="sc">~</span> <span class="st">"n.s."</span>,</span>
<span id="cb247-1177"><a href="#cb247-1177" aria-hidden="true" tabindex="-1"></a>                             relevance_lvl <span class="sc">&lt;</span> conf.low <span class="sc">~</span> <span class="st">"s. &amp; r."</span>,</span>
<span id="cb247-1178"><a href="#cb247-1178" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> <span class="st">"s."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-1179"><a href="#cb247-1179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(contrast, <span class="at">y =</span> estimate, </span>
<span id="cb247-1180"><a href="#cb247-1180" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, </span>
<span id="cb247-1181"><a href="#cb247-1181" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> sig_lgl, <span class="at">linetype =</span> site)) <span class="sc">+</span></span>
<span id="cb247-1182"><a href="#cb247-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-1183"><a href="#cb247-1183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb247-1184"><a href="#cb247-1184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.25</span>)) <span class="sc">+</span> </span>
<span id="cb247-1185"><a href="#cb247-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> relevance_lvl, <span class="at">linetype =</span> <span class="st">"11"</span>,</span>
<span id="cb247-1186"><a href="#cb247-1186" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb247-1187"><a href="#cb247-1187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb247-1188"><a href="#cb247-1188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb247-1189"><a href="#cb247-1189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb247-1190"><a href="#cb247-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Mittelwertsunterschied"</span>, </span>
<span id="cb247-1191"><a href="#cb247-1191" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>, <span class="at">linetype =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb247-1192"><a href="#cb247-1192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb247-1193"><a href="#cb247-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1194"><a href="#cb247-1194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1195"><a href="#cb247-1195" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-1196"><a href="#cb247-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1197"><a href="#cb247-1197" aria-hidden="true" tabindex="-1"></a>Eben gerade haben wir das <span class="in">`{emmeans}`</span> Objekt für unsere zweifaktorielle Analyse für die getrennte Analyse über den zweiten Faktor genutzt. Jetzt zeige ich dir in den folgenden Tabs einmal wie du die p-Werte, das *Comapct letter display* und die 95% Konfidenzintervalle für die kombinierte Analyse über die beiden Faktoren $f_1$ und $f_2$ berechnest. Das heißt, wir wollen jetzt nicht mehr getrennt die Floharten über die Messorte anschauen, sondern die Interaktionen zwischen den Floharten und Messorten analysieren. Daher werden wir jetzt ein paar mehr Vergleiche rechnen als eben gerade im obigen Fall der getrennten Analyse.</span>
<span id="cb247-1198"><a href="#cb247-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1199"><a href="#cb247-1199" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-1200"><a href="#cb247-1200" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte mit $\boxed{\sim f_1 * f_2}$</span></span>
<span id="cb247-1201"><a href="#cb247-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1202"><a href="#cb247-1202" aria-hidden="true" tabindex="-1"></a>Beginnen wir wieder die p-Werte für unseren Vergleich der Floharten für die mittleren Sprungweiten zu berechnen. Wir nutzen hierzu wieder die Funktion <span class="in">`contrast()`</span> wie auch schon im einfaktoriellen Fall. Das ist jetzt auch so eine Stärke von <span class="in">`{emmeans}`</span>, wenn wir das Modell hinkriegen, dann können wir auch mehr Faktoren beliebig ergänzen.</span>
<span id="cb247-1203"><a href="#cb247-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1206"><a href="#cb247-1206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1207"><a href="#cb247-1207" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac2_combined_obj <span class="ot">&lt;-</span> emm_fac2_combinded_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1208"><a href="#cb247-1208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb247-1209"><a href="#cb247-1209" aria-hidden="true" tabindex="-1"></a>emm_contrast_fac2_combined_obj</span>
<span id="cb247-1210"><a href="#cb247-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1211"><a href="#cb247-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1212"><a href="#cb247-1212" aria-hidden="true" tabindex="-1"></a>Das sind eine Menge an Vergleichen. Daher ist es jetzt erstmal die Frage was hier eigentlich wie signifkant ist. Wiederum sieht man dann doch hier, das das *Compact letter display* gar nicht so schlecht ist um eine Übersicht zu kriegen. Hier ist es dann doch sehr unübersichtlich, welcher Vergleich nun wie signifikant ist. Vorallem lässt sich schwer ein übergeordnetes Muster erkennen.</span>
<span id="cb247-1213"><a href="#cb247-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1214"><a href="#cb247-1214" aria-hidden="true" tabindex="-1"></a>Jetzt können wir uns auch die Vergleiche als eine Matrix anzeigen lassen. Hier ist es natürlich praktisch, dass wir gleich die Mittelwerte sowie die mittleren Differenzen als auch die p-Werte in einer Ausgabe vorliegen haben. Darüber hinaus sortiert die Matrix auch die vergleiche einmal sinnvoll und wir können viel besser sehen, welche Vergleiche signifikant sind. So lässt sich auch einfacher die Frage beantworten, ob wir Floharten oder Orte haben, wo alles signifikant ist oder die Signifikanz eher zufällig über die Vergleiche verteilt ist.</span>
<span id="cb247-1215"><a href="#cb247-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1218"><a href="#cb247-1218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1219"><a href="#cb247-1219" aria-hidden="true" tabindex="-1"></a>emm_fac2_combinded_obj <span class="sc">|&gt;</span>   </span>
<span id="cb247-1220"><a href="#cb247-1220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb247-1221"><a href="#cb247-1221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1222"><a href="#cb247-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1223"><a href="#cb247-1223" aria-hidden="true" tabindex="-1"></a>Den paarweisen p-Wert Plot finde ich dann mit so vielen vergleichen dann schon wieder nicht so informativ. Wir haben eben sehr viele signifikante Unterschiede. Dann liegen auchs ehr viele Linien an der linken Seite und es ist schwer zu lesen, was wir hier vorliegen haben. Eventuell müsste man nochmal <span class="in">`animal * site`</span> in dem <span class="in">`emmeans()`</span> Aufruf auf <span class="in">`site * animal`</span> drehen und schauen, ob dann die Ordnung der Vergleiche auf der y-Achse etwas besser ist. Aber das ändert auch nichts and er Anzahl an Vergleichen. Jede Abbildung hat dann so seine Grenzen.</span>
<span id="cb247-1224"><a href="#cb247-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1227"><a href="#cb247-1227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1228"><a href="#cb247-1228" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-1229"><a href="#cb247-1229" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-1230"><a href="#cb247-1230" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-1231"><a href="#cb247-1231" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-1232"><a href="#cb247-1232" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb247-1233"><a href="#cb247-1233" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb247-1234"><a href="#cb247-1234" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Ergebnisse im Pairwise P-value plot. Auf der y-Achse sind die Gruppen und die entsprechenden Gruppenmittelwerte dargestellt."</span></span>
<span id="cb247-1235"><a href="#cb247-1235" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-com-01</span></span>
<span id="cb247-1236"><a href="#cb247-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1237"><a href="#cb247-1237" aria-hidden="true" tabindex="-1"></a>emm_fac2_combinded_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1238"><a href="#cb247-1238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpp</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">+</span></span>
<span id="cb247-1239"><a href="#cb247-1239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-1240"><a href="#cb247-1240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span>
<span id="cb247-1241"><a href="#cb247-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1242"><a href="#cb247-1242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1243"><a href="#cb247-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1244"><a href="#cb247-1244" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact letter display* mit $\boxed{\sim f_1 * f_2}$</span></span>
<span id="cb247-1245"><a href="#cb247-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1246"><a href="#cb247-1246" aria-hidden="true" tabindex="-1"></a>Nachdem wir in dem vorherigen Tab die p-Werte berechnet haben, könen wir jetzt einmal das *Compact letter display* erstellen. Hier hat das R Paket `{emmeans}` eine eigene Funktion mit `cld()`. Die Funktion nimmt das Objekt `emm_fac2_combindedobj` und berechnet darauf das nach Bonferroni adjustierte *Compact letter display*.</span>
<span id="cb247-1247"><a href="#cb247-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1250"><a href="#cb247-1250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1251"><a href="#cb247-1251" aria-hidden="true" tabindex="-1"></a>emm_cld_fac2_combined_obj <span class="ot">&lt;-</span> emm_fac2_combinded_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1252"><a href="#cb247-1252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb247-1253"><a href="#cb247-1253" aria-hidden="true" tabindex="-1"></a>emm_cld_fac2_combined_obj</span>
<span id="cb247-1254"><a href="#cb247-1254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1255"><a href="#cb247-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1256"><a href="#cb247-1256" aria-hidden="true" tabindex="-1"></a>Der große Vorteil von <span class="in">`{emmeans}`</span> ist, dass wir die Ausgabe des *Compact letter displays* direkt nutzen können um unseren Barplot zu zeichnen. Wir müssen nur einmal die Werte der Standardfehler mit der Wurzel der Gruppenfallzahl multiplizieren um auf die Standardabweichung zu kommen. Da wir hier sieben Flöhe je Tierart gemessen haben, multiplizieren wir den Standardfehler mit der Wurzel von 7 um auf die Standardabweichung zu kommen. Dann entferne ich noch die Leerzeichen in der Spalte <span class="in">`.group`</span> mit der Funktion <span class="in">`str_trim()`</span> und ich kann den Barplot erstellen.</span>
<span id="cb247-1257"><a href="#cb247-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1260"><a href="#cb247-1260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1261"><a href="#cb247-1261" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-1262"><a href="#cb247-1262" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-1263"><a href="#cb247-1263" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-1264"><a href="#cb247-1264" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-1265"><a href="#cb247-1265" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb247-1266"><a href="#cb247-1266" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb247-1267"><a href="#cb247-1267" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Barplot oder Säulendigramm der mittleren Sprungweiten in [cm] für drei Floharten und der entsprechenden Messorte kombiniert. Die Fehlerbalken stellen die Standardabweichung dar. Die Buchstaben das Bonferroni adjustierte *Compact letter display*."</span></span>
<span id="cb247-1268"><a href="#cb247-1268" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-com-02</span></span>
<span id="cb247-1269"><a href="#cb247-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1270"><a href="#cb247-1270" aria-hidden="true" tabindex="-1"></a>emm_cld_fac2_combined_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1271"><a href="#cb247-1271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb247-1272"><a href="#cb247-1272" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">7</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-1273"><a href="#cb247-1273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> emmean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb247-1274"><a href="#cb247-1274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-1275"><a href="#cb247-1275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.9</span>, </span>
<span id="cb247-1276"><a href="#cb247-1276" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb247-1277"><a href="#cb247-1277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb247-1278"><a href="#cb247-1278" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb247-1279"><a href="#cb247-1279" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb247-1280"><a href="#cb247-1280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, </span>
<span id="cb247-1281"><a href="#cb247-1281" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>,</span>
<span id="cb247-1282"><a href="#cb247-1282" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb247-1283"><a href="#cb247-1283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb247-1284"><a href="#cb247-1284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb247-1285"><a href="#cb247-1285" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>))</span>
<span id="cb247-1286"><a href="#cb247-1286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1287"><a href="#cb247-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1288"><a href="#cb247-1288" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall mit $\boxed{\sim f_1 * f_2}$</span></span>
<span id="cb247-1289"><a href="#cb247-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1290"><a href="#cb247-1290" aria-hidden="true" tabindex="-1"></a>Am Ende können wir dann auch aus den paarweisen Vergleichen die 95% Konfidenzintervalle berechnen. Hier nutzen wir dann die Funktion <span class="in">`tidy()`</span> aus dem Paket <span class="in">`{broom}`</span> um uns die 95% Konfidenzintervalle sauber wiedergeben zu lassen. Ich habe hier einmal die Kontraste auf <span class="in">`revpairwise`</span> gestellt um die Vergleiche wie bei den p-Werten zu drehen.</span>
<span id="cb247-1291"><a href="#cb247-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1294"><a href="#cb247-1294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1295"><a href="#cb247-1295" aria-hidden="true" tabindex="-1"></a>emm_ci_fac2_combined_obj <span class="ot">&lt;-</span> emm_fac2_combinded_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1296"><a href="#cb247-1296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-1297"><a href="#cb247-1297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-1298"><a href="#cb247-1298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, conf.low, conf.high) </span>
<span id="cb247-1299"><a href="#cb247-1299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1300"><a href="#cb247-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1301"><a href="#cb247-1301" aria-hidden="true" tabindex="-1"></a>Die Stärke eines 95% Konfidenzintervalls ist ja die Signifikanz mit der Relevanz zu verbinden. Weil wir jetzt hier so viele paarweise Vergleiche haben, macht es dann doch Sinn die Relevanzschwelle in beide Richtungen zu definieren. Daher setze ich jetzt mal die Relevanzschwelle <span class="in">`relevance_lvl`</span> auf $&lt;2cm$ und $&gt;2cm$. Wenn also Floharten im Mittel sich mindestens um $\pm 2cm$ unterscheiden, dann ist der Vergleich relevant. Das habe ich jetzt einfach so entschieden.</span>
<span id="cb247-1302"><a href="#cb247-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1305"><a href="#cb247-1305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1306"><a href="#cb247-1306" aria-hidden="true" tabindex="-1"></a>relevance_lvl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb247-1307"><a href="#cb247-1307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1308"><a href="#cb247-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1309"><a href="#cb247-1309" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du einmal die 95% Konfidenzintervalle für alle paarweisen Vergleiche. Ich habe am Anfang nochmal eine Regel mit <span class="in">`case_when()`</span> erstellt, nachder ich dann die 95% Konfidenzintervall nach der Signifikanz und Relevanz einfärbe. Hier ist es dann etwas komplexer, weil ich eben beide Richtungen berücksichtigen will. Wo du die Relevanzschwelle legst, ist dann dir selber überlassen. Das hängt von deiner wissenschaftlichen Fragestellung ab. Wir haben dann drei signifikante und relevante Vergleiche am Ende. In allen drei Fällen ist jeweils der Fuchs in der Stadt enthalten. Wobei in zwei Vergleichen der Unterschied zum Dorf signifikant sowie relevant ist und in einem Vergleich zum Stadtkatzenfloh. Spannendes Ergebnis in diesem Fall.</span>
<span id="cb247-1310"><a href="#cb247-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1313"><a href="#cb247-1313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1314"><a href="#cb247-1314" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-1315"><a href="#cb247-1315" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-1316"><a href="#cb247-1316" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-1317"><a href="#cb247-1317" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-1318"><a href="#cb247-1318" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb247-1319"><a href="#cb247-1319" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb247-1320"><a href="#cb247-1320" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Die 95% Konfidenzintervalle für die *allpair*-Vergleiche der mittleren Sprungweite in [cm] für die drei Floharten und zwei Messorte. Die Farben stellen die Signifkanz und Relevanz der 95% Konfidenzintervalle dar. Als relevant sind mittlere Differenzen größer als $0.75cm$ definiert. **(n.s)** Nicht signifikanter Vergleich, da die 0 im 95% Konfidenzintervall enthalten ist. **(s)** Signifikanter, nicht relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und links von der Relevanzschwelle liegt. **(s. &amp; r.)** Signifikanter, relevanter Vergleich, da die 0 nicht im 95% Konfidenzintervall enthalten ist und rechts von der Relevanzschwelle liegt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb247-1321"><a href="#cb247-1321" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-com-03</span></span>
<span id="cb247-1322"><a href="#cb247-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1323"><a href="#cb247-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1324"><a href="#cb247-1324" aria-hidden="true" tabindex="-1"></a>emm_ci_fac2_combined_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1325"><a href="#cb247-1325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig_lgl =</span> <span class="fu">case_when</span>(<span class="fu">between</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">n</span>()), conf.low, conf.high) <span class="sc">~</span> <span class="st">"n.s."</span>,</span>
<span id="cb247-1326"><a href="#cb247-1326" aria-hidden="true" tabindex="-1"></a>                             relevance_lvl[<span class="dv">2</span>] <span class="sc">&lt;</span> conf.low <span class="sc">|</span></span>
<span id="cb247-1327"><a href="#cb247-1327" aria-hidden="true" tabindex="-1"></a>                             relevance_lvl[<span class="dv">1</span>] <span class="sc">&gt;</span> conf.high <span class="sc">~</span> <span class="st">"s. &amp; r."</span>,</span>
<span id="cb247-1328"><a href="#cb247-1328" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> <span class="st">"s."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-1329"><a href="#cb247-1329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(contrast, <span class="at">y =</span> estimate, </span>
<span id="cb247-1330"><a href="#cb247-1330" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, <span class="at">color =</span> sig_lgl)) <span class="sc">+</span></span>
<span id="cb247-1331"><a href="#cb247-1331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-1332"><a href="#cb247-1332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb247-1333"><a href="#cb247-1333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb247-1334"><a href="#cb247-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(relevance_lvl), <span class="at">linetype =</span> <span class="st">"11"</span>,</span>
<span id="cb247-1335"><a href="#cb247-1335" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb247-1336"><a href="#cb247-1336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb247-1337"><a href="#cb247-1337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb247-1338"><a href="#cb247-1338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb247-1339"><a href="#cb247-1339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Mittelwertsunterschied"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb247-1340"><a href="#cb247-1340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb247-1341"><a href="#cb247-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1342"><a href="#cb247-1342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1343"><a href="#cb247-1343" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-1344"><a href="#cb247-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1345"><a href="#cb247-1345" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Weitere möglichen Analysen {.unnumbered .unlisted}</span></span>
<span id="cb247-1346"><a href="#cb247-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1347"><a href="#cb247-1347" aria-hidden="true" tabindex="-1"></a>Ich möchte hier nur kurz noch auf weitere mögliche Analysen mit <span class="in">`{emmeans}`</span> eingehen. Zum einen gibt es die Hilfeseite von <span class="in">`{emmeans}`</span> zur <span class="co">[</span><span class="ot">Interaction analysis in emmeans</span><span class="co">](https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html)</span>. Dort findet sich auch die Funktion <span class="in">`joint_test()`</span>, die dir nochmal erlaubt auf einem Modell die Interaktionen in der richtigen Reihenfolge zu testen. Mehr dazu im <span class="co">[</span><span class="ot">Kapitel zur ANOVA</span><span class="co">](#sec-anova)</span>.</span>
<span id="cb247-1348"><a href="#cb247-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1349"><a href="#cb247-1349" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"\[...\] tests the interaction contrasts for all effects in the model and compiles them in one Type-III-ANOVA-like table"*</span></span>
<span id="cb247-1350"><a href="#cb247-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1353"><a href="#cb247-1353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1354"><a href="#cb247-1354" aria-hidden="true" tabindex="-1"></a>fac2_aov <span class="sc">|&gt;</span> <span class="fu">joint_tests</span>()</span>
<span id="cb247-1355"><a href="#cb247-1355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1356"><a href="#cb247-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1357"><a href="#cb247-1357" aria-hidden="true" tabindex="-1"></a>Ebenso gibt es noch die Möglichkeit dir die Effektstärken mit <span class="in">`effsize()`</span> zu berechnen. Hier nutzen wir die Informationen aus dem Objekt <span class="in">`fac1_aov`</span> um mit der Varianz und der Freiheitsgerade Cohen<span class="sc">\`</span>s d zu berechnen. Mehr dazu dann auch im <span class="co">[</span><span class="ot">Kapitel zu dem Effektschätzer</span><span class="co">](#sec-effect)</span>.</span>
<span id="cb247-1358"><a href="#cb247-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1361"><a href="#cb247-1361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1362"><a href="#cb247-1362" aria-hidden="true" tabindex="-1"></a><span class="fu">eff_size</span>(emm_fac1_obj, <span class="at">sigma =</span> <span class="fu">sigma</span>(fac1_aov), <span class="at">edf =</span> fac1_aov<span class="sc">$</span>df.residual)</span>
<span id="cb247-1363"><a href="#cb247-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1364"><a href="#cb247-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1365"><a href="#cb247-1365" aria-hidden="true" tabindex="-1"></a>Mehz zu den weiteren Vergleichen von <span class="in">`{emmeans}`</span> dann auch unter <span class="co">[</span><span class="ot">Comparisons and contrasts in emmeans</span><span class="co">](https://cran.r-project.org/web/packages/emmeans/vignettes/comparisons.html)</span>. Das ist hier eher so der offene Abschnitt. Vielleicht kommt noch was dazu.</span>
<span id="cb247-1366"><a href="#cb247-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1367"><a href="#cb247-1367" aria-hidden="true" tabindex="-1"></a>:::: callout-note</span>
<span id="cb247-1368"><a href="#cb247-1368" aria-hidden="true" tabindex="-1"></a><span class="fu">## Was schreibe ich in Material und Methoden?</span></span>
<span id="cb247-1369"><a href="#cb247-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1370"><a href="#cb247-1370" aria-hidden="true" tabindex="-1"></a>Hier nochmal ein kurzer Textvorschlag für deinen Material und Methodenteil, wenn du deine Abschlussarbeit schreibst. Ich halte den Text bewusst knapp, dann kannst du den Text noch ausschmücken. Gerne kannst du den Teil noch ausführlicher schreiben.</span>
<span id="cb247-1371"><a href="#cb247-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1372"><a href="#cb247-1372" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-1373"><a href="#cb247-1373" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tukey HSD Test in `{emmeans}`</span></span>
<span id="cb247-1374"><a href="#cb247-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1375"><a href="#cb247-1375" aria-hidden="true" tabindex="-1"></a>*Die Analyse wurde in RStudio (Version 2024.12.0.467) und R (Version 4.2.3) durchgeführt. Die Gruppenvergleiche wurden mit einem Tukey HSD Test in dem R Paket emmeans (Version 1.10.0) berechnet und entsprechend für multiple Vergleiche adjustiert.*</span>
<span id="cb247-1376"><a href="#cb247-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1377"><a href="#cb247-1377" aria-hidden="true" tabindex="-1"></a><span class="fu">## Games Howell Test in `{emmeans}`</span></span>
<span id="cb247-1378"><a href="#cb247-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1379"><a href="#cb247-1379" aria-hidden="true" tabindex="-1"></a>*Die Analyse wurde in RStudio (Version 2024.12.0.467) und R (Version 4.2.3) durchgeführt. Die Gruppenvergleiche wurden mit einem Games Howell Test unter Berücksichtigung der Varianzheterogenität in den Versuchsgruppen in dem R Paket emmeans (Version 1.10.0) berechnet und entsprechend für multiple Vergleiche adjustiert.*</span>
<span id="cb247-1380"><a href="#cb247-1380" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-1381"><a href="#cb247-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1382"><a href="#cb247-1382" aria-hidden="true" tabindex="-1"></a>Du findest die Informationen zu den genutzen Paketen wie <span class="in">`{emmeans}`</span> und deiner R Version mit den folgenden Funktionen. Damit hast du dann alles zusammen um im Methodenteil einmal zu schreiben was du gemacht hast.</span>
<span id="cb247-1383"><a href="#cb247-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1386"><a href="#cb247-1386" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1387"><a href="#cb247-1387" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb247-1388"><a href="#cb247-1388" aria-hidden="true" tabindex="-1"></a><span class="fu">packageVersion</span>(<span class="st">"emmeans"</span>)</span>
<span id="cb247-1389"><a href="#cb247-1389" aria-hidden="true" tabindex="-1"></a>version<span class="sc">$</span>version.string</span>
<span id="cb247-1390"><a href="#cb247-1390" aria-hidden="true" tabindex="-1"></a><span class="fu">RStudio.Version</span>()<span class="sc">$</span>version</span>
<span id="cb247-1391"><a href="#cb247-1391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1392"><a href="#cb247-1392" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb247-1393"><a href="#cb247-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1394"><a href="#cb247-1394" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fallbeispiele mit `{emmeans}`</span></span>
<span id="cb247-1395"><a href="#cb247-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1396"><a href="#cb247-1396" aria-hidden="true" tabindex="-1"></a>In den folgenden Zerforschenkästen findest du dann noch einige Fallbeispiele zu <span class="in">`{emmeans}`</span>. Ich bin über den Campus Haste der Hochschule Osnabrück gelaufen und habe mal ein paar Fotos von Posterabbildungen gemacht. Dann habe ich die Abbildungen zerforscht und mit ausgedachten Daten versehen. Vielleicht findest du hier nochmal eine Inspiration für deine eingenen Auswertungen.</span>
<span id="cb247-1397"><a href="#cb247-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1398"><a href="#cb247-1398" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb247-1399"><a href="#cb247-1399" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zerforschen: Einfaktorielle Analyse mit `{emmeans}`</span></span>
<span id="cb247-1400"><a href="#cb247-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1401"><a href="#cb247-1401" aria-hidden="true" tabindex="-1"></a>{{&lt; include zerforschen/zerforschen-simple-barplot-emmeans.qmd &gt;}}</span>
<span id="cb247-1402"><a href="#cb247-1402" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-1403"><a href="#cb247-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1404"><a href="#cb247-1404" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb247-1405"><a href="#cb247-1405" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zerforschen: Zweifaktorielle Analyse mit `{emmeans}`</span></span>
<span id="cb247-1406"><a href="#cb247-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1407"><a href="#cb247-1407" aria-hidden="true" tabindex="-1"></a>{{&lt; include zerforschen/zerforschen-barplot-2fac-target-emmeans.qmd &gt;}}</span>
<span id="cb247-1408"><a href="#cb247-1408" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-1409"><a href="#cb247-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1410"><a href="#cb247-1410" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb247-1411"><a href="#cb247-1411" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zerforschen: Zweifaktorielle Analyse mit `{emmeans}`</span></span>
<span id="cb247-1412"><a href="#cb247-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1413"><a href="#cb247-1413" aria-hidden="true" tabindex="-1"></a>{{&lt; include zerforschen/zerforschen-boxplot-2fac-target-emmeans.qmd &gt;}}</span>
<span id="cb247-1414"><a href="#cb247-1414" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-1415"><a href="#cb247-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1416"><a href="#cb247-1416" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb247-1417"><a href="#cb247-1417" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zerforschen: Komplexere Analyse mit `{emmeans}`</span></span>
<span id="cb247-1418"><a href="#cb247-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1419"><a href="#cb247-1419" aria-hidden="true" tabindex="-1"></a>{{&lt; include zerforschen/zerforschen-boxplot-mult.qmd &gt;}}</span>
<span id="cb247-1420"><a href="#cb247-1420" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-1421"><a href="#cb247-1421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1422"><a href="#cb247-1422" aria-hidden="true" tabindex="-1"></a><span class="fu">## Der ANOVA Pfad mit Tukey HSD</span></span>
<span id="cb247-1423"><a href="#cb247-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1424"><a href="#cb247-1424" aria-hidden="true" tabindex="-1"></a>Der Tukey HSD Test (abk. *HSD Test*) hat viele Namen. Im Englischen kennen wir den Tukey HSD Test auch als *Tukey's range test* oder aber als *Tukey's test*, *Tukey method*, *Tukey's honest significance test* oder eben *Tukey's HSD (honestly significant difference)* Test. Dabei steht die Abkürzung HDS für *honestly significant difference* (deu. *ehrlich signifikanter Unterschied*). Für mich etwas weit aus dem Fenster gelehnt, aber der Name sagt hier mal was auch wirklich gemacht wird. Im Prinzip stellen wir nur die Formel von den Student t-Test einmal um und benennen alles neu. Dann sieht man auch nicht gleich, was Sache ist und jeder denkt, es wäre was Neues. Wir werden hier aber mal den Tukey HSD Test zerforschen. Wir nutzen aber die ANOVA um einmal die Streuung und die Effekte zu berechnen. Daher nenne ich das ganze hier auch den ANOVA Pfad. Der Tukey HSD Test basiert eben mehr oder minder auf der Ausgabe einer ANOVA. Mehr Informationen gibt es auch im Tutorium <span class="co">[</span><span class="ot">Post-Hoc Analysis with Tukey’s Test</span><span class="co">](https://rpubs.com/aaronsc32/post-hoc-analysis-tukey)</span>. Ach, der Tukey HSD Test ist schon etwas älter und kann nicht so viel wie neuere Implementierungen wie das R Paket <span class="in">`{emmeans}`</span> und <span class="in">`{multcomp}`</span>.</span>
<span id="cb247-1425"><a href="#cb247-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1426"><a href="#cb247-1426" aria-hidden="true" tabindex="-1"></a>Varianzhomogenität</span>
<span id="cb247-1427"><a href="#cb247-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1428"><a href="#cb247-1428" aria-hidden="true" tabindex="-1"></a>:   Es ist wichtig zu wissen, dass der Tukey HSD Test auf der ANOVA basiert und die ANOVA nimmt Varianzhomogenität an. Damit meine ich, dass alle Gruppen in der Behandlung die gleiche Varianz haben. Du kannst leider den Tukey HSD Test nur unter der Annahme von Varianzhomogenität nutzen. Wenn das dir eine zu starke Annahme ist, dann nutze einfach das R Paket <span class="in">`{emmeans}`</span>, wie ich es dir weiter unten im Kapitel vorstelle.</span>
<span id="cb247-1429"><a href="#cb247-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1430"><a href="#cb247-1430" aria-hidden="true" tabindex="-1"></a>Adjustierung für multiple Vergleiche</span>
<span id="cb247-1431"><a href="#cb247-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1432"><a href="#cb247-1432" aria-hidden="true" tabindex="-1"></a>:   Der Tukey HSD Test adjustiert für die $\alpha$-Inflation bei multiplen Vergleichen. Wir müssen da auch nichts weiter machen um die Adjustierung durchzuführen. Das macht die Funktion <span class="in">`TukeyHSD()`</span> für uns automatisch. Auf der anderen Seite können wir die Adjustierung für multiple Vergleiche aber auch nicht ausschalten. Du erhälst *immer* adjustierte p-Werte aus einem Tukey HSD Test. Wenn du das nicht möchtest, dann nutze einfach das R Paket <span class="in">`{emmeans}`</span>, welches du weiter unten findest.</span>
<span id="cb247-1433"><a href="#cb247-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1434"><a href="#cb247-1434" aria-hidden="true" tabindex="-1"></a>Mögliche multiple Vergleiche</span>
<span id="cb247-1435"><a href="#cb247-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1436"><a href="#cb247-1436" aria-hidden="true" tabindex="-1"></a>:   Wir können immer nur alle Gruppen mit allen anderen Gruppen vergleichen. Wir rechnen also einen *all pair* Vergleich. Wenn du zum Beispiel nur die Behandlungsgruppen zur Kontrolle vergleichen willst, aber nciht untereinander, dann ist das nicht mit dem Tukey HDS Test möglich. Dafür musst du dann das R Paket <span class="in">`{ememans}`</span> oder für noch komplexere Gruppenvergleiche das R Paket <span class="in">`{multcomp}`</span> nutzen.</span>
<span id="cb247-1437"><a href="#cb247-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1438"><a href="#cb247-1438" aria-hidden="true" tabindex="-1"></a>Fallzahl in den einzelnen Behandlungsgruppen</span>
<span id="cb247-1439"><a href="#cb247-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1440"><a href="#cb247-1440" aria-hidden="true" tabindex="-1"></a>:   Der Tukey HSD Test geht von einem balancierten Design aus. Daher brauchen wir in allen Behandlungsgruppen die gleiche Anzahl an Beobachtungen. Wenn wir kein balanciertes Design vorliegen haben, dann wird die Fallzahl mehr oder minder über die Gruppen gemittelt. Teilweise funktioniert dann auch der Tukey HSD Test nicht mehr richtig. Daher ist von der Nutzung es Tukey HSD Tests bei ungleich großen Gruppen abzuraten. Auch hier ist dann der Ausweg das R Paket <span class="in">`{emmeans}`</span>, welches genau für den unblancierten Fall ursprünglich entworfen wurde.</span>
<span id="cb247-1441"><a href="#cb247-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1442"><a href="#cb247-1442" aria-hidden="true" tabindex="-1"></a>Schauen wir uns nun einmal an, wie der Tukey HSD Test theoretisch funktioniert und wie die Implmentierugn in R dargestellt ist. Wir haben die Wahl zwischen der Funktion <span class="in">`TukeyHSD()`</span> und der Funktion <span class="in">`HSD.test()`</span> aus dem R Paket <span class="in">`{agricolae}`</span>. Die Funktion <span class="in">`HSD.test()`</span> liefert auch gleich das *Compact letter display* in der Ausgabe mit. Sonst sind die beiden Funktionen sehr ähnlich. Oft wird eben der Tukey HSD Test noch verwendet, weil er eben sehr alt ist und somit schon sehr lange verwendet wurde.</span>
<span id="cb247-1443"><a href="#cb247-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1444"><a href="#cb247-1444" aria-hidden="true" tabindex="-1"></a>::::: panel-tabset</span>
<span id="cb247-1445"><a href="#cb247-1445" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch</span></span>
<span id="cb247-1446"><a href="#cb247-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1447"><a href="#cb247-1447" aria-hidden="true" tabindex="-1"></a>Zuerst einmal die Formel des Tukey HSD Test. Wir berechnen dabei als statistische Maßzahl den HSD-Wert, der nichts anderes aussagt als der minimal Mittelwertsunterschied, den wir gegeben der Streuung und der Fallzahl in den Daten als signifikant nachweisen können. Sozusagen der minimalste mögliche signifikante Mittelwertsunterschied.</span>
<span id="cb247-1448"><a href="#cb247-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1449"><a href="#cb247-1449" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-1450"><a href="#cb247-1450" aria-hidden="true" tabindex="-1"></a>HSD = q_{\alpha=5\%, k, n-k} \cdot \sqrt{\tfrac{MSE}{n}}</span>
<span id="cb247-1451"><a href="#cb247-1451" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-1452"><a href="#cb247-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1453"><a href="#cb247-1453" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb247-1454"><a href="#cb247-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1455"><a href="#cb247-1455" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$HSD$, den zu berechnenden minimalsten möglichen signifikanten Mittelwertsunterschied.</span>
<span id="cb247-1456"><a href="#cb247-1456" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$q_{\alpha=5\%, k, n-k}$, den kritischen Wert gegeben aus dem Signifikanzniveau $\alpha$ gleich 5% der Anzahl an zu vergleichenden Gruppen $k$ und einem Freiheitsgrad $n-k$.</span>
<span id="cb247-1457"><a href="#cb247-1457" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\sqrt{\tfrac{MSE}{n}}$, der Streuung in den Daten gewichtet für die Fallzahl $n$. Hier wird die Streuung über alle Gruppen hinweg berechnet.</span>
<span id="cb247-1458"><a href="#cb247-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1459"><a href="#cb247-1459" aria-hidden="true" tabindex="-1"></a>Wir können uns das Ganze auch nochmal in der folgenden Tabelle als Vergleich zu dem Student t-Test anschauen. Hier dann erstmal noch die beiden Formeln.</span>
<span id="cb247-1460"><a href="#cb247-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1461"><a href="#cb247-1461" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-1462"><a href="#cb247-1462" aria-hidden="true" tabindex="-1"></a>\begin{array}{c|c}</span>
<span id="cb247-1463"><a href="#cb247-1463" aria-hidden="true" tabindex="-1"></a>  HSD = q_{\alpha=5\%, k, n-k} \cdot \sqrt{\tfrac{MSE}{n}} &amp; \bar{y}_1 - \bar{y}_2 =  T_{\alpha=5\%} \cdot s_p\sqrt{\tfrac{2}{n_g}}</span>
<span id="cb247-1464"><a href="#cb247-1464" aria-hidden="true" tabindex="-1"></a>\end{array}</span>
<span id="cb247-1465"><a href="#cb247-1465" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-1466"><a href="#cb247-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1467"><a href="#cb247-1467" aria-hidden="true" tabindex="-1"></a>Ich habe dort einmal die statistischen Maßzahlen aus einem Tukey HDS Test den statistischen Maßzahlen eines Student t-Test in der folgenden Tabelle gegenüber gestellt. Du siehst, dass wir hier eigentlich nur eine Umstellung der t-Test Formel haben.</span>
<span id="cb247-1468"><a href="#cb247-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1469"><a href="#cb247-1469" aria-hidden="true" tabindex="-1"></a>|                 | Tukey HSD Test           | Student t-Test             |</span>
<span id="cb247-1470"><a href="#cb247-1470" aria-hidden="true" tabindex="-1"></a>|-----------------|--------------------------|----------------------------|</span>
<span id="cb247-1471"><a href="#cb247-1471" aria-hidden="true" tabindex="-1"></a>| Effekt          | $HSD$                    | $\bar{y}_1 - \bar{y}_2$    |</span>
<span id="cb247-1472"><a href="#cb247-1472" aria-hidden="true" tabindex="-1"></a>| Streuung        | $\tfrac{MSE}{n}$         | $s_p\sqrt{\tfrac{2}{n_g}}$ |</span>
<span id="cb247-1473"><a href="#cb247-1473" aria-hidden="true" tabindex="-1"></a>| Kritischer Wert | $q_{\alpha=5\%, k, n-k}$ | $T_{\alpha=5\%}$           |</span>
<span id="cb247-1474"><a href="#cb247-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1475"><a href="#cb247-1475" aria-hidden="true" tabindex="-1"></a>: Etwas wilder Vergleich vom Tukey HSD Test zum Student t-Test. Im Prinzip ist der Tukey HSD Test nur eine Umstellung der Formel des Student t-Test. {#tbl-hds-ttest}</span>
<span id="cb247-1476"><a href="#cb247-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1477"><a href="#cb247-1477" aria-hidden="true" tabindex="-1"></a>Um die Idee des Tukey HDS Test zusammenzufassen, setzen wir für $q_{\alpha=5\%, k, n-k}$ den Wert ein, den wir mindestens erreichen müssen um einen signifikanten Unterschied nachweisen zu können. Bei dem Student t-Test war es meist $T_{\alpha=5\%}$ gleich $1.96$, hier ist der Wert für $q_{\alpha=5\%, k, n-k}$ natürlich anders. Dann können wir den minimalen Mittelwertsunterschied mit $\bar{y}_1 - \bar{y}_2$ oder eben $HSD$ berechnen, denn wir mindestens erreichen müssen um einen signifikanten Unterschied nachweisen zu können. Alle Mittelwertsdifferenzen größer als der $HDS$ Wert werden dann signifikant sein und alle Mittelwertsdifferenzen kleiner als der $HDS$ Wert nicht signifikant sein.</span>
<span id="cb247-1478"><a href="#cb247-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1479"><a href="#cb247-1479" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb247-1480"><a href="#cb247-1480" aria-hidden="true" tabindex="-1"></a><span class="fu">## Entscheidung mit dem HDS Wert</span></span>
<span id="cb247-1481"><a href="#cb247-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1482"><a href="#cb247-1482" aria-hidden="true" tabindex="-1"></a>Wenn eine Mittelwertsdifferenz $\bar{y}_i - \bar{y}_j$ eines Gruppenvergleiches *größer* ist als der HDS Wert dann wird die Nullhypothese (H$_0$) abgelehnt. Ist die Mittelwertsdifferenz $\bar{y}_i - \bar{y}_j$ eines Gruppenvergleiches ist als der HDS Wert dann wird die Nullhypothese (H$_0$) beibehalten.</span>
<span id="cb247-1483"><a href="#cb247-1483" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-1484"><a href="#cb247-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1485"><a href="#cb247-1485" aria-hidden="true" tabindex="-1"></a><span class="fu">## Händisch</span></span>
<span id="cb247-1486"><a href="#cb247-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1487"><a href="#cb247-1487" aria-hidden="true" tabindex="-1"></a>Im Folgenden wollen wir einmal den Tukey HSD Test nachvollziehen. Dafür hier nochmal die Formel, die wir dann mit den entsprechenden Werten ausfüllen müssen. Wir beginnen mit dem q-Wert und erhalten den MSE Wert aus einer ANOVA.</span>
<span id="cb247-1488"><a href="#cb247-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1489"><a href="#cb247-1489" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-1490"><a href="#cb247-1490" aria-hidden="true" tabindex="-1"></a>HSD = q_{\alpha=5\%, k, n-k} \cdot \sqrt{\tfrac{MSE}{n}}</span>
<span id="cb247-1491"><a href="#cb247-1491" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-1492"><a href="#cb247-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1493"><a href="#cb247-1493" aria-hidden="true" tabindex="-1"></a>Für die semihändische Berechnung des Tukey HSD Test brauchen wir erstmal die Werte für die gesamte Fallzahl in dem Datensatz $N$, dann noch die Anzahl an Behandlungsgruppen $k$ und abschließend die Fallzahl pro Gruppe $n$. Ich nutze hier dann den Datensatz <span class="in">`fac1_tbl`</span> mit der Sprungweite von 21 Flöhen von drei Tierrassen mit jeweils sieben Beobachtungen pro Gruppe. Dann geben wir das Ganze einmal bei R ein.</span>
<span id="cb247-1494"><a href="#cb247-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1497"><a href="#cb247-1497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1498"><a href="#cb247-1498" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">21</span></span>
<span id="cb247-1499"><a href="#cb247-1499" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb247-1500"><a href="#cb247-1500" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">21</span> <span class="sc">/</span> <span class="dv">3</span></span>
<span id="cb247-1501"><a href="#cb247-1501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1502"><a href="#cb247-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1503"><a href="#cb247-1503" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`qtukey()`</span> gibt uns den q-Wert anhand des Signifikanzniveaus $1 - \alpha$ sowie der Anzahl an Gruppen $k$ und der dem Freiheitsgrad $N-k$ wieder.</span>
<span id="cb247-1504"><a href="#cb247-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1507"><a href="#cb247-1507" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1508"><a href="#cb247-1508" aria-hidden="true" tabindex="-1"></a><span class="fu">qtukey</span>(<span class="at">p =</span> <span class="fl">0.95</span>, <span class="at">nmeans =</span> k, <span class="at">df =</span> N <span class="sc">-</span> k)</span>
<span id="cb247-1509"><a href="#cb247-1509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1510"><a href="#cb247-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1511"><a href="#cb247-1511" aria-hidden="true" tabindex="-1"></a>Dann brauchen wir noch den Wert für die Streuung $MSE$. Den MSE Wert könnten wir auch händisch berechnen, aber normalerweise nutzen wir auch die ANOVA um an den Wert zu gelangen. Daher hier einmal die ANOVA und wir lesen den Wert für MSE in der Ergebnistabelle ab.</span>
<span id="cb247-1512"><a href="#cb247-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1515"><a href="#cb247-1515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1516"><a href="#cb247-1516" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb247-1517"><a href="#cb247-1517" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span>
<span id="cb247-1518"><a href="#cb247-1518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1519"><a href="#cb247-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1520"><a href="#cb247-1520" aria-hidden="true" tabindex="-1"></a>Nun wissen wir den Wert für $MSE$ mit $3.14$ aus der Tabelle der einfaktoriellen ANOVA. Dann können wir auch schon den HSD Wert anhand der Formel berechnen in dem wir die Werte einsetzen.</span>
<span id="cb247-1521"><a href="#cb247-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1524"><a href="#cb247-1524" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1525"><a href="#cb247-1525" aria-hidden="true" tabindex="-1"></a>hsd <span class="ot">&lt;-</span> <span class="fl">3.61</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fl">3.14</span> <span class="sc">/</span> <span class="dv">7</span>)</span>
<span id="cb247-1526"><a href="#cb247-1526" aria-hidden="true" tabindex="-1"></a>hsd</span>
<span id="cb247-1527"><a href="#cb247-1527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1528"><a href="#cb247-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1529"><a href="#cb247-1529" aria-hidden="true" tabindex="-1"></a>Am Ende müssen wir dann die Mittelwertsdifferenzen unserer Tierarten mit dem HDS Wert vergleichen. Dafür ahbe ich einmal die folgende Tabelle aufgebaut. Wichtig ist hier, dass wir mit den Beträgen der Mittelwertsdifferenz rechnen, sonst macht der Vergleich zum HDS Wert keinen Sinn. Wir erhalten also zwei signifikante Vergleiche. Die Sprungweiten der Katzenflöhe unterscheiden sich von den Sprungweiten der Fuchs- und Hundeflöhe.</span>
<span id="cb247-1530"><a href="#cb247-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1531"><a href="#cb247-1531" aria-hidden="true" tabindex="-1"></a>| Vergleich | Mittelwertsdifferenz | HDS Testentscheidung |</span>
<span id="cb247-1532"><a href="#cb247-1532" aria-hidden="true" tabindex="-1"></a>|----|----|----|</span>
<span id="cb247-1533"><a href="#cb247-1533" aria-hidden="true" tabindex="-1"></a>| cat-dog | $4.74 - 8.13 = -3.39$ | $\mid-3.39\mid\; \geq 2.42 \rightarrow \mbox{signifikant}$ |</span>
<span id="cb247-1534"><a href="#cb247-1534" aria-hidden="true" tabindex="-1"></a>| fox-dog | $9.16 - 8.13 = \phantom{-}1.03$ | $\mid1.03\mid\; \geq 2.42 \rightarrow \mbox{nicht signifikant}$ |</span>
<span id="cb247-1535"><a href="#cb247-1535" aria-hidden="true" tabindex="-1"></a>| fox-cat | $9.16 - 4.74 = \phantom{-}4.42$ | $\mid4.42\mid\; \geq 2.42 \rightarrow \mbox{signifikant}$ |</span>
<span id="cb247-1536"><a href="#cb247-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1537"><a href="#cb247-1537" aria-hidden="true" tabindex="-1"></a>: Händische Testentscheidung anhand des berechneten HDS Wert und den Mittelwertsdifferenzen der drei Tierarten. Wenn eine Mittelwertsdifferenz größer ist als der HDS Wert, dann liegt ein signifikanter Unterschied vor. {#tbl-hds-ttest-händisch}</span>
<span id="cb247-1538"><a href="#cb247-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1539"><a href="#cb247-1539" aria-hidden="true" tabindex="-1"></a>Am Ende willst du das natürlich nicht händische machen sondern wir nutzen die Funktionen in R um uns die Testentscheidung auch mit einem p-Wert berechnen zu lassen. Ganz wichtig hier nochmal, wir glauben daran, dass die Varianz in allen drei Tierarten gleich ist. Wir haben Varianzhomogenität vorliegen.</span>
<span id="cb247-1540"><a href="#cb247-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1541"><a href="#cb247-1541" aria-hidden="true" tabindex="-1"></a><span class="fu">## `TukeyHSD()`</span></span>
<span id="cb247-1542"><a href="#cb247-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1543"><a href="#cb247-1543" aria-hidden="true" tabindex="-1"></a>Die Standardfunktion für den Tukey HDS Test ist <span class="in">`TukeyHSD()`</span>. Wir können den Tukey HSD Test mit nur einem Faktor oder zwei Faktoren rechnen. Ich stelle hier die einfaktorielle sowie zweifaktorielle Analyse einmal vor. Am Ende zeige ich dann nochmal, wie du das *Compact letter display* erhälst. Hier müssen wir noch ein zusätzliches Paket nutzen. Die Funktion `HSD.test()` aus dem Paket `{agricolae}`, die du im nächsten Tab findest, gibt dir sofort das *Compact letter display* wieder. Der Ablauf ist aber in beiden Fällen der gleiche. Wir rechnen erst eine ANOVA mit der Funktion <span class="in">`aov()`</span> um dann den Tukey HSD Test zu rechnen.</span>
<span id="cb247-1544"><a href="#cb247-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1545"><a href="#cb247-1545" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktorielle Analyse {.unnumbered .unlisted}</span></span>
<span id="cb247-1546"><a href="#cb247-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1547"><a href="#cb247-1547" aria-hidden="true" tabindex="-1"></a>Am Anfang rechnen wir erst eine einfaktorielle ANOVA mit der Funktion <span class="in">`aov()`</span>. Wir erhalten dann alle notwendigen Informationen in dem Ausgabeobjekt für die Berechnung des Tukey HSD Test. Darüber hinaus können wir auch auch gleich schauen, ob unsere Behandlung überhaupt einen signifikanten Einfluss auf unser Outcome der Sprunglänge hat.</span>
<span id="cb247-1548"><a href="#cb247-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1551"><a href="#cb247-1551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1552"><a href="#cb247-1552" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb247-1553"><a href="#cb247-1553" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span>
<span id="cb247-1554"><a href="#cb247-1554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1555"><a href="#cb247-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1556"><a href="#cb247-1556" aria-hidden="true" tabindex="-1"></a>An dem p-Wert sehen wir, dass wir einen signifikanten Effekt der Tierart <span class="in">`animal`</span> auf die Sprunglänge der Flöhe vorliegen haben. Wir können jetzt einen Tukey HSD Test rechnen um rauszufinden welche der drei Tierarten sich unterscheiden. Wir erhalten dann als Ausgabe die Mittlwertsdifferenzen zusammen mit den 95% Konfidenzintervallen und den adjustierten p-Werten.</span>
<span id="cb247-1557"><a href="#cb247-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1560"><a href="#cb247-1560" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1561"><a href="#cb247-1561" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(fac1_av)</span>
<span id="cb247-1562"><a href="#cb247-1562" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj</span>
<span id="cb247-1563"><a href="#cb247-1563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1564"><a href="#cb247-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1565"><a href="#cb247-1565" aria-hidden="true" tabindex="-1"></a>Du erhälst immer adjustierte p-Werte aus einem Tukey HSD Test. Das muss dir klar sein. Die p-Werte kannst du dann mit dem Signifikanzniveau $\alpha$ von 5% vergleichen. Wir sehen dass sich die Sprungweiten der Katzenflöhe von den Sprungweiten der Fuchs- und Hundeflöhe signifikant unterscheiden.</span>
<span id="cb247-1566"><a href="#cb247-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1567"><a href="#cb247-1567" aria-hidden="true" tabindex="-1"></a>Dann kannst du noch die Funktion <span class="in">`mulcompLetters()`</span> aus dem R Paket <span class="in">`{mulcompView}`</span> nutzen um dir das *Compact letter display* wiedergeben zu lassen. Das *Compact letter display* kannst du dann entsprechend zu deinen Barplots ergänzen.</span>
<span id="cb247-1568"><a href="#cb247-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1571"><a href="#cb247-1571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1572"><a href="#cb247-1572" aria-hidden="true" tabindex="-1"></a><span class="fu">multcompLetters</span>(<span class="fu">extract_p</span>(tukey_fac1_obj<span class="sc">$</span>animal))</span>
<span id="cb247-1573"><a href="#cb247-1573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1574"><a href="#cb247-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1575"><a href="#cb247-1575" aria-hidden="true" tabindex="-1"></a>Auch hier sei angemerkt, dass du dan schauen muss, ob das *Compact letter display* zu deinen Daten passt. Sind die Mittelwerte wirklich unterschiedlich? Kannst du die Unterschiede in den Barplots erkennen? Wenn das der Fall ist, dann spricht nichts gegen die Verwendung des Tukey HSD Test.</span>
<span id="cb247-1576"><a href="#cb247-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1577"><a href="#cb247-1577" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktorielle Analyse {.unnumbered .unlisted}</span></span>
<span id="cb247-1578"><a href="#cb247-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1579"><a href="#cb247-1579" aria-hidden="true" tabindex="-1"></a>Jetzt können wir die Sache etwas kürzer machen, da wir auch in einem zweifaktoriellen Fall den gleichen Weg wie im einfaktoriellen Fall durchgehen. Wir rechnen erst eine ANOVA mit den beiden Faktoren und dem Interaktionsterm, dargestellt durch den Doppelpunkt zwischen den beiden Faktoren.</span>
<span id="cb247-1580"><a href="#cb247-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1583"><a href="#cb247-1583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1584"><a href="#cb247-1584" aria-hidden="true" tabindex="-1"></a>fac2_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span>
<span id="cb247-1585"><a href="#cb247-1585" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac2_av)</span>
<span id="cb247-1586"><a href="#cb247-1586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1587"><a href="#cb247-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1588"><a href="#cb247-1588" aria-hidden="true" tabindex="-1"></a>In diesem Fall finden wir eine signifikante Interaktion. Daher verhalten sich die Tierarten <span class="in">`animal`</span> in den beiden Messorten in dem Faktor <span class="in">`site`</span> nicht gleich. Die Interaktion kannst du auch in der Visualisierung der Daten in der weiter oben sehen. Für die Füchse ändert sich die Sprungweite von <span class="in">`city`</span> zu <span class="in">`village`</span>. Bei Hunden- und Katzenflöhen springen in der Tendenz Dorfflöhe weiter als Stadtflöhe. Wir nutzen jetzt das Modell einmal in der Funktion <span class="in">`TukeyHSD()`</span> um uns einmal einen Tukey HSD Test berechnen zu lassen.</span>
<span id="cb247-1589"><a href="#cb247-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1592"><a href="#cb247-1592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1593"><a href="#cb247-1593" aria-hidden="true" tabindex="-1"></a>tukey_fac2_obj <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(fac2_av)</span>
<span id="cb247-1594"><a href="#cb247-1594" aria-hidden="true" tabindex="-1"></a>tukey_fac2_obj</span>
<span id="cb247-1595"><a href="#cb247-1595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1596"><a href="#cb247-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1597"><a href="#cb247-1597" aria-hidden="true" tabindex="-1"></a>Wie du an der sehr langen Ausgabe sehen kannst, erhalten wir erstmal die Informationen zu der Tierart, dort sehen wir dann, dass sich alle drei Sprungweiten der Tierarten voneinander unterscheiden. Dann erhalten wir die Information über den Ort oder eben den zweiten Faktor. Am Ende nochmal sehr detailliert alle Interaktionen aufgeschlüsselt. Leider ist die Tabelle dann sehr schlecht zu lesen, aber hier siehst du dann welche Faktorkombination dann signifikant ist. Wenn du eine signifikante Interaktion vorliegen hast, dann kannst du keine *pauschale* Aussage über die Sprungweiten der Tierarten machen. Es kommt eben immer drauf an, welches Level du im zweiten Faktor betrachtest.</span>
<span id="cb247-1598"><a href="#cb247-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1599"><a href="#cb247-1599" aria-hidden="true" tabindex="-1"></a>Am Ende wollen wir dann doch noch das *Compact letter display* haben. Ich wähle hier einmal die Gruppe der Tierarten aus. Du kannst das auch für die anderen Faktoren machen, aber hier einmal zur Demonstration. Wir sehen, dass sich alle Tierarten in der Sprungweite unterscheiden, keine Tierart hat den gleichen Buchstaben. Wenn du willst, kannst du dir natürlich auch andere Buchstaben rausziehen.</span>
<span id="cb247-1600"><a href="#cb247-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1603"><a href="#cb247-1603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1604"><a href="#cb247-1604" aria-hidden="true" tabindex="-1"></a><span class="fu">multcompLetters</span>(<span class="fu">extract_p</span>(tukey_fac2_obj<span class="sc">$</span>animal))</span>
<span id="cb247-1605"><a href="#cb247-1605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1606"><a href="#cb247-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1607"><a href="#cb247-1607" aria-hidden="true" tabindex="-1"></a>Hier nochmal Achtung, die Interaktion wird natürlich nicht berücksichtigt. Im Zweifel dann doch lieber <span class="in">`{emmeans}`</span> nutzen. Du findest die Anwendung im folgenden Tab. Allgemeine Aussagen zur Interaktion kann ich immer schwer treffen, es hängt sehr von der wissenschaftlichen Fragestellung und den Daten ab.</span>
<span id="cb247-1608"><a href="#cb247-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1609"><a href="#cb247-1609" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{emmeans}`</span></span>
<span id="cb247-1610"><a href="#cb247-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1611"><a href="#cb247-1611" aria-hidden="true" tabindex="-1"></a>Wir können auch den Tukey HSD Test mit <span class="in">`{emmeans}`</span> rechnen, wenn wir nichts an der Standardeingabe ändern. Dann nutzen wir nämlich die Adjustierung nach Tukey und somit rechnen wir faktisch einen Tukey HSD Test. Im einfaktoriellen Fall sind die p-Werte dann auch identisch zu der Funktion <span class="in">`TukeyHSD()`</span>. Das ist aber nur der Fall wenn wir wirklich gleiche Fallzahlen in den Gruppen haben und der Algorithmus von <span class="in">`{emmeans}`</span> ist natürlich nicht *identisch* mit der Berechnung eines Tukey HSD Tests.</span>
<span id="cb247-1612"><a href="#cb247-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1613"><a href="#cb247-1613" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktorielle Analyse {.unnumbered .unlisted}</span></span>
<span id="cb247-1614"><a href="#cb247-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1615"><a href="#cb247-1615" aria-hidden="true" tabindex="-1"></a>Auch hier brauchen wir erstmal das Modell für unseren Tukey HSD Test mit <span class="in">`{emmeans}`</span>. Dafür nutze ich auch hier wieder die Funktion <span class="in">`aov()`</span>.</span>
<span id="cb247-1616"><a href="#cb247-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1619"><a href="#cb247-1619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1620"><a href="#cb247-1620" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb247-1621"><a href="#cb247-1621" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span>
<span id="cb247-1622"><a href="#cb247-1622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1623"><a href="#cb247-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1624"><a href="#cb247-1624" aria-hidden="true" tabindex="-1"></a>Wenn du alle paarweisen Vergleiche rechnen willst, dann nutzt du die Funktion <span class="in">`emmeans()`</span> und anschließend die Funktion <span class="in">`contrast()`</span>, die dir dann alle paarweisen Vergleiche wiedergibt. In einem balancierten Design unter der Annahme von Varianzhomogenität kommt hier dann auch das gleiche wie bei dem Tukey HSD Test raus. Hier sind nur die Vorzeichen im Vergleich zum <span class="in">`TukeyHSD()`</span> gedreht, da wir hier nicht <span class="in">`cat - dog`</span> rechnen sondern alles einmal gedreht.</span>
<span id="cb247-1625"><a href="#cb247-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1628"><a href="#cb247-1628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1629"><a href="#cb247-1629" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="sc">|&gt;</span> </span>
<span id="cb247-1630"><a href="#cb247-1630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb247-1631"><a href="#cb247-1631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>)</span>
<span id="cb247-1632"><a href="#cb247-1632" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1633"><a href="#cb247-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1634"><a href="#cb247-1634" aria-hidden="true" tabindex="-1"></a>Abschließend können wir uns dann auch noch das *Compact letter display* wiedergeben lassen. Auch hier haben wir dann das gleiche Ergebnis vorliegen.</span>
<span id="cb247-1635"><a href="#cb247-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1638"><a href="#cb247-1638" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1639"><a href="#cb247-1639" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="sc">|&gt;</span> </span>
<span id="cb247-1640"><a href="#cb247-1640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb247-1641"><a href="#cb247-1641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters)</span>
<span id="cb247-1642"><a href="#cb247-1642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1643"><a href="#cb247-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1644"><a href="#cb247-1644" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktorielle Analyse {.unnumbered .unlisted}</span></span>
<span id="cb247-1645"><a href="#cb247-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1646"><a href="#cb247-1646" aria-hidden="true" tabindex="-1"></a>Im zweifaktoriellen Fall müssen wir wiederum erstmal die ANOVA rechnen um ein Modell vorliegen zu haben. Auf diesem Modell können wir dann die Funktionen von <span class="in">`{emmeans}`</span> rechnen. Der Vorteil liegt es jetzt der flexibeln Auswertung der Interaktion <span class="in">`animal:site`</span>. Mehr dazu dann im obigen Abschnitt zu <span class="in">`{emmeans}`</span>.</span>
<span id="cb247-1647"><a href="#cb247-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1650"><a href="#cb247-1650" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1651"><a href="#cb247-1651" aria-hidden="true" tabindex="-1"></a>fac2_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span>
<span id="cb247-1652"><a href="#cb247-1652" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac2_av)</span>
<span id="cb247-1653"><a href="#cb247-1653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1654"><a href="#cb247-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1655"><a href="#cb247-1655" aria-hidden="true" tabindex="-1"></a>Hier rechne ich jetzt eine kombinierte Analyse für die beiden Faktoren <span class="in">`animal`</span> und <span class="in">`site`</span>. Wenn du die Analysen getrennt rechnen möchtest dann ersetze den Stern <span class="in">`*`</span> durch einen Strich <span class="in">`|`</span>. Mehr dazu ebenfalls weiter oben im Abschnitt zu <span class="in">`{emmeans}`</span>. Im Weiteren rechne ich dann alle paarweisen Vergleiche und zwar zwischen allen Faktorkombinationen. Dann möchte ich mir das Ergebnis noch kompakt wiedergeben lassen.</span>
<span id="cb247-1656"><a href="#cb247-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1659"><a href="#cb247-1659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1660"><a href="#cb247-1660" aria-hidden="true" tabindex="-1"></a>fac2_av <span class="sc">|&gt;</span> </span>
<span id="cb247-1661"><a href="#cb247-1661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">*</span> site) <span class="sc">|&gt;</span> </span>
<span id="cb247-1662"><a href="#cb247-1662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">simple =</span> <span class="st">"each"</span>, <span class="at">combine =</span> <span class="cn">TRUE</span>)</span>
<span id="cb247-1663"><a href="#cb247-1663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1664"><a href="#cb247-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1665"><a href="#cb247-1665" aria-hidden="true" tabindex="-1"></a>Ich kann mir dann auch über alle Faktorkombinationen das *Compact letter display* wiedergeben lassen. Hier ist jetzt der Vorteil, dass ich wirklich die Buchstaben für jeden Messort <span class="in">`site`</span> und die jeweilige Tierrasse <span class="in">`animal`</span> habe.</span>
<span id="cb247-1666"><a href="#cb247-1666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1669"><a href="#cb247-1669" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1670"><a href="#cb247-1670" aria-hidden="true" tabindex="-1"></a>fac2_av <span class="sc">|&gt;</span> </span>
<span id="cb247-1671"><a href="#cb247-1671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">*</span> site) <span class="sc">|&gt;</span> </span>
<span id="cb247-1672"><a href="#cb247-1672" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(<span class="at">Letters =</span> letters)</span>
<span id="cb247-1673"><a href="#cb247-1673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1674"><a href="#cb247-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1675"><a href="#cb247-1675" aria-hidden="true" tabindex="-1"></a>Beachte, dass über die gleiche Varianz angenommen wird. das kann sein, dass es nicht passt und daher schaue dir dann einmal oben <span class="in">`{emmeans}`</span> mit Varianzheterogenität an.</span>
<span id="cb247-1676"><a href="#cb247-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1677"><a href="#cb247-1677" aria-hidden="true" tabindex="-1"></a><span class="fu">## `HSD.test()`</span></span>
<span id="cb247-1678"><a href="#cb247-1678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1679"><a href="#cb247-1679" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb247-1680"><a href="#cb247-1680" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb247-1681"><a href="#cb247-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1682"><a href="#cb247-1682" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`HSD.test()`</span> kann nur ein einfaktorielles Modell rechnen und *ignoriert* weitere Faktoren oder Interaktionsterme im <span class="in">`aov()`</span> Modell. Du erhälst zwar immer eine Ausgabe, aber nur als einfaktorielle Analyse. Unabhängig von dem Modell was du in die Funktion <span class="in">`HSD.test()`</span> reinsteckst! Und ohne weitere Warnung.</span>
<span id="cb247-1683"><a href="#cb247-1683" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-1684"><a href="#cb247-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1685"><a href="#cb247-1685" aria-hidden="true" tabindex="-1"></a>Eine zweite Variante den Tukey HSD Test in R durchzuführen ist die Funktion <span class="in">`HSD.test()`</span> aus dem R Paket <span class="in">`{agricolae}`</span>. Persönlich entwickle ich so langsam eine Aversion gegen das Paket, da ich selten eine so rundimentäre und lustlose Hilfe für die Funktion gesehen habe wie in <span class="in">`{agricolae}`</span>. Prinzipiell haben wir die gleichen Möglichkeiten wie auch mit dem Tukey HSD Test für ein einfaktorielles Versuchsdesign. Wir nutzen auch erste eine ANOVA um uns alle wichtigen statistischen Maßzahlen berechnen zu lassen und dann können wir mit denen den Tukey HSD Test durchführen. Leider erhalten wir *keine* p-Werte. Was auch irgendwie irre ist. Dafür dann aber das *Compact letter display* ohne einen weiteren Schritt.</span>
<span id="cb247-1686"><a href="#cb247-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1687"><a href="#cb247-1687" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktorielle Analyse {.unnumbered .unlisted}</span></span>
<span id="cb247-1688"><a href="#cb247-1688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1689"><a href="#cb247-1689" aria-hidden="true" tabindex="-1"></a>Am Anfang rechnen wir auch hier eine einfaktorielle ANOVA mit der Funktion <span class="in">`aov()`</span>. Wir erhalten dann alle notwendigen Informationen in dem Ausgabeobjekt für die Berechnung des Tukey HSD Test. Darüber hinaus können wir auch auch gleich schauen, ob unsere Behandlung überhaupt einen signifikanten Einfluss auf unser Outcome der Sprunglänge hat.</span>
<span id="cb247-1690"><a href="#cb247-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1693"><a href="#cb247-1693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1694"><a href="#cb247-1694" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb247-1695"><a href="#cb247-1695" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span>
<span id="cb247-1696"><a href="#cb247-1696" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1697"><a href="#cb247-1697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1698"><a href="#cb247-1698" aria-hidden="true" tabindex="-1"></a>An dem p-Wert sehen wir, dass wir einen signifikanten Effekt der Tierart <span class="in">`animal`</span> auf die Sprunglänge der Flöhe vorliegen haben. Wir können jetzt einen Tukey HSD Test rechnen um rauszufinden welche der drei Tierarten sich unterscheiden. Wir erhalten dann als Ausgabe die Mittelwerte ohne p-Werte und müssten uns sogar die Mittelwertsdifferenzen selber berechnen. Keine Ahnung was das soll. Dafür dann aber das *Compact letter display*, was ja auch irgendwie reicht.</span>
<span id="cb247-1699"><a href="#cb247-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1702"><a href="#cb247-1702" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1703"><a href="#cb247-1703" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(fac1_av, <span class="at">trt =</span> <span class="st">'animal'</span>)</span>
<span id="cb247-1704"><a href="#cb247-1704" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj</span>
<span id="cb247-1705"><a href="#cb247-1705" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1706"><a href="#cb247-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1707"><a href="#cb247-1707" aria-hidden="true" tabindex="-1"></a>Wenn du keinen p-Werte haben möchtest sondern nur das *Compact letter display*, dann macht es dir die Funktion <span class="in">`HSD.test()`</span> etwas leichter. Dann brauchst du dir nicht nochmal eine Funktion zusätzlich laden. Wenn du p-Werte brauchst, dann stehst du hier im Regen. Dann nutze bitte die Funktion <span class="in">`TukesHSD()`</span> im vorherigen Tab.</span>
<span id="cb247-1708"><a href="#cb247-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1709"><a href="#cb247-1709" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktorielle Analyse {.unnumbered .unlisted}</span></span>
<span id="cb247-1710"><a href="#cb247-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1711"><a href="#cb247-1711" aria-hidden="true" tabindex="-1"></a>Eine zweifaktorielle Analyse ist in der Funktion <span class="in">`HSD.test()`</span> nicht möglich. Ein zweifaktorielles Modell wird wie ein einfaktorielles Modell behandelt und damit der zweite Faktor sowie der Interaktionsterm von der Funktion <span class="in">`HSD.test()`</span> ignoriert. Du erhälst keine Warnung sondern eben das Ergebnis einer einfaktoriellen Analyse wiedergeben. Ich bin immer noch sprachlos was das soll.</span>
<span id="cb247-1712"><a href="#cb247-1712" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb247-1713"><a href="#cb247-1713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1714"><a href="#cb247-1714" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Pfade</span></span>
<span id="cb247-1715"><a href="#cb247-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1716"><a href="#cb247-1716" aria-hidden="true" tabindex="-1"></a><span class="fu">### Paarweise Tests</span></span>
<span id="cb247-1717"><a href="#cb247-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1718"><a href="#cb247-1718" aria-hidden="true" tabindex="-1"></a>Wenn du nur eine einfaktorielle Analyse rechnen willst, dann kann man natürlich auch die einfachste aller Arten als Post-hoc Test rechnen. Du rechnest nämlich alle paarweisen Vergleiche mit einem t-Test oder aber mit einem Wilxonon Test. Da du dann natürlich sehr viele Tests rechnen müsstest, gibt es auch eine Funktion in R, die das für dich übernimmt. Die Funktion <span class="in">`pairwise.*.test()`</span> kann nämlich verschiedene Gruppentests einmal automatisieren über alle möglichen Vergleiche.</span>
<span id="cb247-1719"><a href="#cb247-1719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1720"><a href="#cb247-1720" aria-hidden="true" tabindex="-1"></a>Die Funktionen <span class="in">`pairwise.*.test()`</span> sind etwas älter und deshalb etwas sperrig zu nutzen. Du gibt hier kein Modell an sondern musst erst das $y$ als einen Vektor und dann die Gruppenvariable $x$ als einen Vektor der Funktion übergeben. Dann entscheidest du dich noch für die Methode der Adjustierung der p-Werte und ob du Vrainzheterogenität vorliegen hast. Ich habe mich mit der Option <span class="in">`pool.sd = FALSE`</span> für Varianzheterogenität und damit gegen Varianzhomogenität entschieden. Die Annahme ist hier, dass unser Outcome $y$ näherungsweise normalverteilt ist.</span>
<span id="cb247-1721"><a href="#cb247-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1724"><a href="#cb247-1724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1725"><a href="#cb247-1725" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-1726"><a href="#cb247-1726" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb247-1727"><a href="#cb247-1727" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb247-1728"><a href="#cb247-1728" aria-hidden="true" tabindex="-1"></a>                <span class="at">pool.sd =</span> <span class="cn">FALSE</span>) </span>
<span id="cb247-1729"><a href="#cb247-1729" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1730"><a href="#cb247-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1731"><a href="#cb247-1731" aria-hidden="true" tabindex="-1"></a>Wenn du dir bei deinem $y$ nicht so sicher bist, was die Normalverteilung angeht, dann kannst du auch einen paarweisen Wilcoxon Test rechnen. Dafür bietet sich die folgende Funktion an.</span>
<span id="cb247-1732"><a href="#cb247-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1735"><a href="#cb247-1735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1736"><a href="#cb247-1736" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-1737"><a href="#cb247-1737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1738"><a href="#cb247-1738" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb247-1739"><a href="#cb247-1739" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb247-1740"><a href="#cb247-1740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1741"><a href="#cb247-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1742"><a href="#cb247-1742" aria-hidden="true" tabindex="-1"></a>Am Ende kannst du dir dann auch mit folgendem Code das *Compact letter display* wiedergeben lassen. Wegen der etwas sperrigen Struktur der Ausgabe der Funktion `pairwise.*.test()` müssen wir hier etwas mehr arbeiten um an das *Compact letter display* zu kommen.</span>
<span id="cb247-1743"><a href="#cb247-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1746"><a href="#cb247-1746" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1747"><a href="#cb247-1747" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb247-1748"><a href="#cb247-1748" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-1749"><a href="#cb247-1749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract2</span>(<span class="st">"p.value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-1750"><a href="#cb247-1750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fullPTable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb247-1751"><a href="#cb247-1751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>()</span>
<span id="cb247-1752"><a href="#cb247-1752" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1753"><a href="#cb247-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1754"><a href="#cb247-1754" aria-hidden="true" tabindex="-1"></a>Am Ende bieten beide Funktionen einen schnellen Weg ein einfaktorielles Design auszuwerten. Ja, es ist etwas ruppig und am Ende vermutlich auch nicht so schön, aber für eine Abschlussarbeit mit Fokus jenseits der statistischen Auswertung mag es Sinn machen.</span>
<span id="cb247-1755"><a href="#cb247-1755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1756"><a href="#cb247-1756" aria-hidden="true" tabindex="-1"></a><span class="fu">### Games Howell Test</span></span>
<span id="cb247-1757"><a href="#cb247-1757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1758"><a href="#cb247-1758" aria-hidden="true" tabindex="-1"></a>Der Games Howell Test ist eine Alternative zu dem Paket <span class="in">`{multcomp}`</span> und dem Paket <span class="in">`{emmeans}`</span> für ein einfaktorielles Design. Wir können auch ein zweifakorielles Design rechnen, dann würden wir aber die Analyse *getrennt* für den zweiten Faktor durchführen. Gemeinsam geht dann nur in <span class="in">`{emmeans}`</span>. Wir nutzen den Games Howell Test, wenn die Annahme der Homogenität der Varianzen, der zum Vergleich aller möglichen Kombinationen von Gruppenunterschieden verwendet wird, verletzt ist. Dieser Post-Hoc-Test liefert Konfidenzintervalle für die Unterschiede zwischen den Gruppenmitteln und zeigt, ob die Unterschiede statistisch signifikant sind. Der Test basiert auf der Welch'schen Freiheitsgradkorrektur und adjustiert die $p$-Werte. Der Test vergleicht also die Differenz zwischen den einzelnen Mittelwertpaaren mit einer Adjustierung für den Mehrfachtest. Es besteht also keine Notwendigkeit, zusätzliche p-Wert-Korrekturen vorzunehmen.</span>
<span id="cb247-1759"><a href="#cb247-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1760"><a href="#cb247-1760" aria-hidden="true" tabindex="-1"></a>Varianzheterogenität</span>
<span id="cb247-1761"><a href="#cb247-1761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1762"><a href="#cb247-1762" aria-hidden="true" tabindex="-1"></a>:   Es ist wichtig zu wissen, dass der Games Howell Test faktisch das Äquivalent zum Welch t-Test ist und daher Varianzheterogenität annimmt. Du kannst den Games Howell Test nicht unter der Annahme von Varianzhomogenität rechnen. Das wäre dann der Tukey HSD Test, der ja auf der ANOVA basiert und die ANOVA Varianzhomogenität annimmt. Prinzipiell kann es dir dann passieren, das die Ergebnisse eines Games Howell Test nicht mehr mit denen einer vorgeschalteten ANOVA zusammenpassen.</span>
<span id="cb247-1763"><a href="#cb247-1763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1764"><a href="#cb247-1764" aria-hidden="true" tabindex="-1"></a>Adjustierung für multiple Vergleiche</span>
<span id="cb247-1765"><a href="#cb247-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1766"><a href="#cb247-1766" aria-hidden="true" tabindex="-1"></a>:   Der Games Howell Test adjustiert für die $\alpha$-Inflation bei multiplen Vergleichen. Wir müssen da auch nichts weiter machen um die Adjustierung durchzuführen. Auf der anderen Seite können wir die Adjustierung für multiple Vergleiche aber auch nicht ausschalten. Du erhälst *immer* adjustierte p-Werte aus einem Games Howell Test. Wenn du das nicht möchtest, dann nutze einfach das R Paket <span class="in">`{emmeans}`</span>.</span>
<span id="cb247-1767"><a href="#cb247-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1768"><a href="#cb247-1768" aria-hidden="true" tabindex="-1"></a>Mögliche multiple Vergleiche</span>
<span id="cb247-1769"><a href="#cb247-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1770"><a href="#cb247-1770" aria-hidden="true" tabindex="-1"></a>:   Wir können immer nur alle Gruppen mit allen anderen Gruppen vergleichen. Wir rechnen also einen *all pair* Vergleich. Wenn du zum Beispiel nur die Behandlungsgruppen zur Kontrolle vergleichen willst, aber nicht untereinander, dann ist das nicht mit dem Games Howell Test möglich. Dafür musst du dann das R Paket <span class="in">`{ememans}`</span> oder für noch komplexere Gruppenvergleiche das R Paket <span class="in">`{multcomp}`</span> nutzen.</span>
<span id="cb247-1771"><a href="#cb247-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1772"><a href="#cb247-1772" aria-hidden="true" tabindex="-1"></a>Für den Games Howell Test aus dem Paket <span class="in">`{rstatix}`</span> müssen wir kein lineares Modell fitten. Wir schreiben einfach die wie in einem t-Test das Outcome und den Faktor mit den Gruppenleveln in die Funktion <span class="in">`games_howell_test()`</span>. Es gibt sehr wenige Implemtierungen des Games Howell Test, da er nicht so weit genutzt wird. Häufig will man dann doch eine ANOVA rechnen und dann den Tukey HSD Test anschließen. Wenn der Games Howell Test passt, dann passt ja meist eine ANOVA mit der Annahme von Varianzhomogenität nicht. Ein Problem mit der Fallzahl bleibt aber, so dass wir mindestens sechs Beobachtungen haben.</span>
<span id="cb247-1773"><a href="#cb247-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1774"><a href="#cb247-1774" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "However, the smaller the number of samples in each group, the </span><span class="sc">\[</span><span class="at">Games Howell Post-hoc Tests</span><span class="sc">\]</span><span class="at"> is more tolerant to the type I error control. Thus, this method can be applied when the number of samples is six or more." --- </span><span class="co">[</span><span class="ot">Games Howell Post-hoc Tests in `{rstatix}`</span><span class="co">](https://rpkgs.datanovia.com/rstatix/reference/games_howell_test.html)</span></span>
<span id="cb247-1775"><a href="#cb247-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1776"><a href="#cb247-1776" aria-hidden="true" tabindex="-1"></a>Ich zeige jetzt einmal wie wir die einfaktorielle und dann die zweifaktorielle Analyse eines Games Howell Test in R rechnen. Ich habe mich hier gegen die händisch Berechnung entschieden, da wir hier dann sehr viel rechnen müssen, was eigentlich dann der Welch t-Test ist. Wenn dich die Formeln nochmal gesondert interessieren dann findest du die im Tutorium <span class="co">[</span><span class="ot">Games-Howell Post-Hoc Test</span><span class="co">](https://rpubs.com/aaronsc32/Games%20Howell%20Test)</span>. Hier lasse ich dann gleich ganz bewusst eine ANOVA weg und starte gleich mit dem paarweisen Vergleich.</span>
<span id="cb247-1777"><a href="#cb247-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1778"><a href="#cb247-1778" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktorielle Analyse {.unnumbered .unlisted}</span></span>
<span id="cb247-1779"><a href="#cb247-1779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1780"><a href="#cb247-1780" aria-hidden="true" tabindex="-1"></a>Wenn wir den Games Howell Test rechnen wollen dann nutzen wir die Funktion <span class="in">`games_howell_test()`</span> aus dem R Paket <span class="in">`{rstatix}`</span>. Die Funktion benötigt kein ANOVA Modell, was ja wenig Sinn machen würde. Wir bräuchten für die ANOVA homogene Varianzen und der Games Howell Test ist ja direkt für heterogene Varianzen entwickelt worden. Daher verzichten wir auch *grundsätzlich* auf eine vorgestellte ANOVA, wenn wir einen Games Howell Test rechnen.</span>
<span id="cb247-1781"><a href="#cb247-1781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1784"><a href="#cb247-1784" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1785"><a href="#cb247-1785" aria-hidden="true" tabindex="-1"></a>ght_fac1_obj <span class="ot">&lt;-</span> <span class="fu">games_howell_test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) </span>
<span id="cb247-1786"><a href="#cb247-1786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1787"><a href="#cb247-1787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1788"><a href="#cb247-1788" aria-hidden="true" tabindex="-1"></a>Mit dem Objekt des Games Howell Test können wir uns dann die statistischen Maßzahlen wiedergeben lassen.</span>
<span id="cb247-1789"><a href="#cb247-1789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1790"><a href="#cb247-1790" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-1791"><a href="#cb247-1791" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte</span></span>
<span id="cb247-1792"><a href="#cb247-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1793"><a href="#cb247-1793" aria-hidden="true" tabindex="-1"></a>Die p-Werte finden sich dann direkt in dem Objekt der Ausgabe der Funktion <span class="in">`games_howell_test()`</span>. Da müssen wir nicht viel machen. Ich habe hier nochmal die p-Werte mit der Funktion <span class="in">`pvalue()`</span> einmal etwas angepasst. Das musst du natürlich nicht machen. Du erhälst *immer* adjustierte p-Werte. Die Adjustierung für multiple Vergleiche lässt sich nicht ausschalten.</span>
<span id="cb247-1794"><a href="#cb247-1794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1797"><a href="#cb247-1797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1798"><a href="#cb247-1798" aria-hidden="true" tabindex="-1"></a>ght_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1799"><a href="#cb247-1799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">pvalue</span>(p.adj))</span>
<span id="cb247-1800"><a href="#cb247-1800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1801"><a href="#cb247-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1802"><a href="#cb247-1802" aria-hidden="true" tabindex="-1"></a>Das Ergebnis ähnelt dem Tukey HSD Test. Nur wenn wir wirklich starke heterogene Varianzen vorliegen haben, werden wir wirklich einen Unterschied zwischen den Tests sehen. Häufig sind sich der Tukey HSD Test und der Games Howell Test ähnlich in den Ergebnissen.</span>
<span id="cb247-1803"><a href="#cb247-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1804"><a href="#cb247-1804" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact letter display*</span></span>
<span id="cb247-1805"><a href="#cb247-1805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1806"><a href="#cb247-1806" aria-hidden="true" tabindex="-1"></a>Für das *Compact letter display* aus dem Games Howell Test müssen wir uns einmal etwas strecken, da wir erst die Kontraste bauen müssen, die die Funktion <span class="in">`multcompLetters()`</span> braucht. Sonst ist der Rest dann relativ einfach.</span>
<span id="cb247-1807"><a href="#cb247-1807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1810"><a href="#cb247-1810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1811"><a href="#cb247-1811" aria-hidden="true" tabindex="-1"></a>ght_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1812"><a href="#cb247-1812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2)) <span class="sc">|&gt;</span> </span>
<span id="cb247-1813"><a href="#cb247-1813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p.adj, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb247-1814"><a href="#cb247-1814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span>
<span id="cb247-1815"><a href="#cb247-1815" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1816"><a href="#cb247-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1817"><a href="#cb247-1817" aria-hidden="true" tabindex="-1"></a>Auch hier sehen wir ähnliche Ergebnisse. Was uns aber auch nicht so überrascht. Wenn die Varianzen eher homogen sind, dann macht der Games Howell Test keinen großen Unterschied zum Tukey HSD Test.</span>
<span id="cb247-1818"><a href="#cb247-1818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1819"><a href="#cb247-1819" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall</span></span>
<span id="cb247-1820"><a href="#cb247-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1821"><a href="#cb247-1821" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung sind die simultanen 95% Konfidenzintervalle nochmal in einem <span class="in">`ggplot`</span> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab. Auch hier müssen wir uns erst die Vergleiche zusammenkleben, damit die Konfidenzintervalle richtig darstellbar sind.</span>
<span id="cb247-1822"><a href="#cb247-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1825"><a href="#cb247-1825" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1826"><a href="#cb247-1826" aria-hidden="true" tabindex="-1"></a>ght_fac1_ci_obj <span class="ot">&lt;-</span> ght_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1827"><a href="#cb247-1827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2))</span>
<span id="cb247-1828"><a href="#cb247-1828" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1829"><a href="#cb247-1829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1830"><a href="#cb247-1830" aria-hidden="true" tabindex="-1"></a>Dann können wir aber auch schon die 95% Konfidenzintervalle einmal darstellen. Da wir hier Mittelwerte vergleichen, ist die die Signifikanzschwelle die Null. Wenn die Null mit im Konfidenzintervall enthalten ist können wir die Nullhypothese nicht ablehnen.</span>
<span id="cb247-1831"><a href="#cb247-1831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1834"><a href="#cb247-1834" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1835"><a href="#cb247-1835" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-1836"><a href="#cb247-1836" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-1837"><a href="#cb247-1837" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-1838"><a href="#cb247-1838" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-1839"><a href="#cb247-1839" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb247-1840"><a href="#cb247-1840" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb247-1841"><a href="#cb247-1841" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Die 95% Konfidenzintervalle für den *allpair*-Vergleich des Games Howell Test."</span></span>
<span id="cb247-1842"><a href="#cb247-1842" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ght-1</span></span>
<span id="cb247-1843"><a href="#cb247-1843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1844"><a href="#cb247-1844" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ght_fac1_ci_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high)) <span class="sc">+</span></span>
<span id="cb247-1845"><a href="#cb247-1845" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb247-1846"><a href="#cb247-1846" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb247-1847"><a href="#cb247-1847" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb247-1848"><a href="#cb247-1848" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb247-1849"><a href="#cb247-1849" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb247-1850"><a href="#cb247-1850" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1851"><a href="#cb247-1851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1852"><a href="#cb247-1852" aria-hidden="true" tabindex="-1"></a>Die Entscheidungen nach den 95% Konfidenzintervallen sind die gleichen wie nach dem $p$-Wert. Ob du die Konfidenzintervalle brauchst, hängt dann von deiner Fragestellung in deiner Abschlussarbeit ab.</span>
<span id="cb247-1853"><a href="#cb247-1853" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-1854"><a href="#cb247-1854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1855"><a href="#cb247-1855" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktorielle Analyse {.unnumbered .unlisted}</span></span>
<span id="cb247-1856"><a href="#cb247-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1857"><a href="#cb247-1857" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`games_howell_test()`</span> aus dem R Paket <span class="in">`{rstatix}`</span> kann keinen zweifaktoriellen Vergleich über die Faktoren des zweiten Faktors rechnen. Wenn du das möchtest, dann nutze bitte das R Paket <span class="in">`{emmeans}`</span>. Wir rechnen hier eine einfaktorielle Analyse *getrennt* für jedes Level des zweiten Faktors. In unserem konkreten Fall rechnen wir also eine einfaktorielle Analyse für den Vergleich der Tierrassen einmal für das Level `city` und einmal für das Level `village` für den Faktor `site`. Wir erhalten dann jeweils die getrennten p-Werte sowie *Compact letter display* und Konfidenzintervalle. Dazu nutzen wir die Funktion <span class="in">`group_by()`</span>.</span>
<span id="cb247-1858"><a href="#cb247-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1861"><a href="#cb247-1861" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1862"><a href="#cb247-1862" aria-hidden="true" tabindex="-1"></a>ght_fac2_obj <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb247-1863"><a href="#cb247-1863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site) <span class="sc">|&gt;</span> </span>
<span id="cb247-1864"><a href="#cb247-1864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">games_howell_test</span>(jump_length <span class="sc">~</span> animal) </span>
<span id="cb247-1865"><a href="#cb247-1865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1866"><a href="#cb247-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1867"><a href="#cb247-1867" aria-hidden="true" tabindex="-1"></a>Dan können wir uns auch schon wie in dem einfaktorielle Fall die statistischen Maßzahlen wiedergeben lassen. Die p-Werte sind hier nicht so das Problem, etwas frickeliger wird es dann bei dem *Compact letter display*. Hier kann ich dann nur raten gleich <span class="in">`{emmeans}`</span> zu nutzen.</span>
<span id="cb247-1868"><a href="#cb247-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1869"><a href="#cb247-1869" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-1870"><a href="#cb247-1870" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte</span></span>
<span id="cb247-1871"><a href="#cb247-1871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1872"><a href="#cb247-1872" aria-hidden="true" tabindex="-1"></a>Die adjustierten p-Werte lassen sich dann direkt aus dem Objekt der Funktion wiedergeben. Hier mache ich mir noch die Freude einmal die p-Werte etwas anders darzustellen, dass musst du aber nicht unbedingt machen. Wie immer erhalten wir *nur* adjustierte p-Werte, wir können die Adjustierung nicht ausstellen.</span>
<span id="cb247-1873"><a href="#cb247-1873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1876"><a href="#cb247-1876" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1877"><a href="#cb247-1877" aria-hidden="true" tabindex="-1"></a>ght_fac2_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1878"><a href="#cb247-1878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">pvalue</span>(p.adj))</span>
<span id="cb247-1879"><a href="#cb247-1879" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1880"><a href="#cb247-1880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1881"><a href="#cb247-1881" aria-hidden="true" tabindex="-1"></a>Das etwas nervige ist jetzt, dass wir die p-Werte eben getrennt vorliegen haben. Wir können also nicht Tierrassen aus der Stadt mit den Ergebnissen der Tierrassen aus dem Dorf vergleichen. Dafür wurde übriegens auch nicht adjustiert. Die Adjustierung ist auch nur getrennt für die Level des zweiten Faktors. Am Ende doch etwas unbefriedigend.</span>
<span id="cb247-1882"><a href="#cb247-1882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1883"><a href="#cb247-1883" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact letter display*</span></span>
<span id="cb247-1884"><a href="#cb247-1884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1885"><a href="#cb247-1885" aria-hidden="true" tabindex="-1"></a>Für das *Compact letter display* müssen wir uns ganz schön strecken. Das hat damit zu tun, dass wir eben die Analyse getrennt für den zweiten Faktor durchführen und daher auch das *Comapct letter display* getrennt für den zweiten Faktor bauen müssen. Daher nutze ich hier die Funktion <span class="in">`map()`</span> um hier etwas fortgeschrittener zu programmieren.</span>
<span id="cb247-1886"><a href="#cb247-1886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1889"><a href="#cb247-1889" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1890"><a href="#cb247-1890" aria-hidden="true" tabindex="-1"></a>ght_fac2_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1891"><a href="#cb247-1891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2)) <span class="sc">|&gt;</span> </span>
<span id="cb247-1892"><a href="#cb247-1892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(<span class="sc">~</span> site) <span class="sc">|&gt;</span> </span>
<span id="cb247-1893"><a href="#cb247-1893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(pull, p.adj, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb247-1894"><a href="#cb247-1894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span><span class="fu">multcompLetters</span>(.x)<span class="sc">$</span>Letters) <span class="sc">|&gt;</span> </span>
<span id="cb247-1895"><a href="#cb247-1895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"site"</span>) </span>
<span id="cb247-1896"><a href="#cb247-1896" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1897"><a href="#cb247-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1898"><a href="#cb247-1898" aria-hidden="true" tabindex="-1"></a>Wir immer, dass muss nicht so kompliziert mit allen Nachteilen der getrennten Auswertung sein. Das R Paket <span class="in">`{emmeans}`</span> kann es schneller, einfacher und noch besser. Daher ist das hier eher eine Demonstration als eine Empfehlung.</span>
<span id="cb247-1899"><a href="#cb247-1899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1900"><a href="#cb247-1900" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall</span></span>
<span id="cb247-1901"><a href="#cb247-1901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1902"><a href="#cb247-1902" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung sind die simultanen 95% Konfidenzintervalle nochmal in einem <span class="in">`ggplot`</span> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab. Auch hier müssen wir uns erst die Vergleiche zusammenkleben, damit die Konfidenzintervalle richtig darstellbar sind.</span>
<span id="cb247-1903"><a href="#cb247-1903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1906"><a href="#cb247-1906" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1907"><a href="#cb247-1907" aria-hidden="true" tabindex="-1"></a>ght_fac2_ci_obj <span class="ot">&lt;-</span> ght_fac2_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-1908"><a href="#cb247-1908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2))</span>
<span id="cb247-1909"><a href="#cb247-1909" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1910"><a href="#cb247-1910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1911"><a href="#cb247-1911" aria-hidden="true" tabindex="-1"></a>Eigentlich ist es für die Konfidenzintervalle etwas einfacher, nur haben wir hier auch das Problem, dass eigentlich nur das Signifikanzniveau $\alpha$ für jedes Level des zweiten Faktors eingehalten wird. Deshalb eine in sich schwer zu interpretierende Abbildung.</span>
<span id="cb247-1912"><a href="#cb247-1912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1915"><a href="#cb247-1915" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1916"><a href="#cb247-1916" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-1917"><a href="#cb247-1917" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-1918"><a href="#cb247-1918" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-1919"><a href="#cb247-1919" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-1920"><a href="#cb247-1920" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb247-1921"><a href="#cb247-1921" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb247-1922"><a href="#cb247-1922" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Die 95% Konfidenzintervalle für den *allpair*-Vergleich des Games Howell Test."</span></span>
<span id="cb247-1923"><a href="#cb247-1923" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ght-2</span></span>
<span id="cb247-1924"><a href="#cb247-1924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1925"><a href="#cb247-1925" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ght_fac2_ci_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high,</span>
<span id="cb247-1926"><a href="#cb247-1926" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> site, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb247-1927"><a href="#cb247-1927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb247-1928"><a href="#cb247-1928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb247-1929"><a href="#cb247-1929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb247-1930"><a href="#cb247-1930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb247-1931"><a href="#cb247-1931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb247-1932"><a href="#cb247-1932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb247-1933"><a href="#cb247-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1934"><a href="#cb247-1934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1935"><a href="#cb247-1935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1936"><a href="#cb247-1936" aria-hidden="true" tabindex="-1"></a>Die Entscheidungen nach den 95% Konfidenzintervallen sind die gleichen wie nach dem $p$-Wert. Da wir hier es mit einem Mittelwertsvergleich zu tun haben, ist die Entscheidung gegen die Nullhypothese zu treffen wenn die 0 im Konfidenzintervall ist. Abgesehen von der etwas wirren Adjustierung durch die getrennte Analyse.</span>
<span id="cb247-1937"><a href="#cb247-1937" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-1938"><a href="#cb247-1938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1939"><a href="#cb247-1939" aria-hidden="true" tabindex="-1"></a><span class="fu">### R Paket `{multcomp}`</span></span>
<span id="cb247-1940"><a href="#cb247-1940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1941"><a href="#cb247-1941" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb247-1942"><a href="#cb247-1942" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb247-1943"><a href="#cb247-1943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1944"><a href="#cb247-1944" aria-hidden="true" tabindex="-1"></a>Das Paket <span class="in">`{multcomp}`</span> kann beliebige faktorielle Modelle berechnen. Das einfaktorielle Modell ist hierbei relativ einfach durchzuführen und die Stärke liegt hier auch in der Flexibiltät der möglichen Vergleiche oder auch *Kontrast* genannt. Wenn du ein zweifaktorielles Modell vorliegen hast, geht es auch mit `{multcomp}`, *aber* hier musst du dann mehr selber machen damit es gut wird. Das Paket <span class="in">`{emmeans}`</span> ist hier besser in der Bedienung.</span>
<span id="cb247-1945"><a href="#cb247-1945" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-1946"><a href="#cb247-1946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1947"><a href="#cb247-1947" aria-hidden="true" tabindex="-1"></a>Der große Vorteil von <span class="in">`{multcomp}`</span> liegt in der möglichen Auswahl an komplexen Mittelwertsvergleichen oder auch Mittelwertskontrasten. Das Wort *Kontrast* steht hier für die Art und Weise wie wir verschiedene Mittelwerte miteinander vergleichen wollen. Daher ist der Fokus auch eher auf der einfaktoriellen als auf der mehrfaktoriellen Analyse. Die Fokus des Paketes liegt daher auch auf der Erstellung der 95% Konfidenzintervalle und deren Darstellung. Wenn dich die 95% Konfidenzintervalle nicht primär interessieren und du auch eigentlich nur einen *all-pair* Vergleich rechnen willst, dann ist das R Paket <span class="in">`{emmeans}`</span> auch wieder die einfachere Variante für dich.</span>
<span id="cb247-1948"><a href="#cb247-1948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1949"><a href="#cb247-1949" aria-hidden="true" tabindex="-1"></a>:::: callout-tip</span>
<span id="cb247-1950"><a href="#cb247-1950" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exkurs: Was ist ein Kontrast?</span></span>
<span id="cb247-1951"><a href="#cb247-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1952"><a href="#cb247-1952" aria-hidden="true" tabindex="-1"></a>Ein Kontrast teilt uns mit, welche Mittelwert von welchem anderem Mittelwert abgezogen werden soll. Oder eben, welche Gruppen miteinander vergleichen werden sollen. Nehmen wir einmal an, wir wollen die Sprungweite der Hundeflöhe mit der Sprungweite der Katzenflöhe vergleichen. Dazu berechnen wir dann die beiden Mittelwerte der jeweiligen Sprungweiten. Wenn wir uns nun einen Kontrast bauen, sagen wir nichts anders aus, welcher Mittelwert von welchen Mittelwert abgezogen werden soll. Im Folgenden mal ein beispielhafter Kontrast $cat-dog$ für den Mittelwertsvergleich $\bar{y}_{cat} - \bar{y}_{dog}$.</span>
<span id="cb247-1953"><a href="#cb247-1953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1954"><a href="#cb247-1954" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-1955"><a href="#cb247-1955" aria-hidden="true" tabindex="-1"></a>\matrix{</span>
<span id="cb247-1956"><a href="#cb247-1956" aria-hidden="true" tabindex="-1"></a>~         &amp; cat &amp; dog  <span class="sc">\\</span></span>
<span id="cb247-1957"><a href="#cb247-1957" aria-hidden="true" tabindex="-1"></a>cat - dog &amp; 1   &amp; -1  }</span>
<span id="cb247-1958"><a href="#cb247-1958" aria-hidden="true" tabindex="-1"></a>$$ Wir setzen den Hund auf $-1$ und die Katze auf $1$, da wir den Mittelwert der Hunde vom Mittelwert der Katzen abziehen wollen. Jetzt sieht das erstmal von kompliziert aus wird aber praktisch, wenn wir noch den Fuchs mit dazunehmen.</span>
<span id="cb247-1959"><a href="#cb247-1959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1960"><a href="#cb247-1960" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-1961"><a href="#cb247-1961" aria-hidden="true" tabindex="-1"></a>\matrix{</span>
<span id="cb247-1962"><a href="#cb247-1962" aria-hidden="true" tabindex="-1"></a>~         &amp; cat &amp; dog &amp; fox <span class="sc">\\</span></span>
<span id="cb247-1963"><a href="#cb247-1963" aria-hidden="true" tabindex="-1"></a>cat - dog &amp; 1   &amp; -1   &amp; 0 <span class="sc">\\</span></span>
<span id="cb247-1964"><a href="#cb247-1964" aria-hidden="true" tabindex="-1"></a>fox - dog &amp; 0   &amp; -1   &amp; 1 <span class="sc">\\</span></span>
<span id="cb247-1965"><a href="#cb247-1965" aria-hidden="true" tabindex="-1"></a>fox - cat &amp; -1   &amp; 0  &amp;  1 }</span>
<span id="cb247-1966"><a href="#cb247-1966" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-1967"><a href="#cb247-1967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1968"><a href="#cb247-1968" aria-hidden="true" tabindex="-1"></a>Jetzt können wir nämlich den *all-pair* Vergleich durch eine Matrix abbilden. Wenn ein Mittelwert nicht in den Vergleich soll, dann erhält die Gruppe eine $0$. Die zu vergleichenden Gruppen erhalten vereinfacht erstmal eine $1$ oder $-1$. Diesen *all-pair* Vergleich nennen wir auch gerne Tukey Kontrast genannt. Leider hat Tukey hier nichts mit dem Tukey HSD Test zu tun.</span>
<span id="cb247-1969"><a href="#cb247-1969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1970"><a href="#cb247-1970" aria-hidden="true" tabindex="-1"></a>Ein weiterer oft genutzter Kontrast ist der *many-to-one* Kontrast oder auch Dunnett Kontrast genannt. Hier vergleichen wir alle Gruppen zu einer Gruppe. Meistens alle Gruppen zu einer Kontrolle.</span>
<span id="cb247-1971"><a href="#cb247-1971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1972"><a href="#cb247-1972" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-1973"><a href="#cb247-1973" aria-hidden="true" tabindex="-1"></a>\matrix{</span>
<span id="cb247-1974"><a href="#cb247-1974" aria-hidden="true" tabindex="-1"></a>~         &amp; cat &amp; dog &amp; fox <span class="sc">\\</span></span>
<span id="cb247-1975"><a href="#cb247-1975" aria-hidden="true" tabindex="-1"></a>cat - dog &amp; -1   &amp; 1   &amp; 0 <span class="sc">\\</span></span>
<span id="cb247-1976"><a href="#cb247-1976" aria-hidden="true" tabindex="-1"></a>cat - fox &amp; -1   &amp; 0   &amp; 1  }</span>
<span id="cb247-1977"><a href="#cb247-1977" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb247-1978"><a href="#cb247-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1979"><a href="#cb247-1979" aria-hidden="true" tabindex="-1"></a>Der eigentliche Witz des Kontrasttest ist jetzt, dass wir nicht nur $-1$ oder $1$ eintragen können. Zwar muss die Summe der Werte für einen Kontrast Null sein, wir können aber auch andere Zahlen eintragen. So zum Beispiel $0.5$ und $0.5$ für zwei Gruppen. Dann vergleichen wir die gemittelten Mittelwerte zweier Gruppen mit einer anderen Gruppe.</span>
<span id="cb247-1980"><a href="#cb247-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1981"><a href="#cb247-1981" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-1982"><a href="#cb247-1982" aria-hidden="true" tabindex="-1"></a>Zuerst kannst du dir natürlich beliebige Kontraste für deine Fragestellung selber zusammenbauen. Solange die Zeile in der Summe immer Null ergibt, ist alles fein. Es gibt aber auch die Funktion <span class="in">`contrMat()`</span>, die dir abhängig von den Fallzahlen in den Gruppen bekannte Kontraste baut. Ich stelle dir hier mal eine Auswahl vor. Wie du aber siehst, gibt es meine vordefinierter Kontraste.</span>
<span id="cb247-1983"><a href="#cb247-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1986"><a href="#cb247-1986" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-1987"><a href="#cb247-1987" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb247-1988"><a href="#cb247-1988" aria-hidden="true" tabindex="-1"></a><span class="fu">contrMat</span>(n, </span>
<span id="cb247-1989"><a href="#cb247-1989" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"Dunnett"</span>, <span class="st">"Tukey"</span>, <span class="st">"Sequen"</span>, <span class="st">"AVE"</span>, </span>
<span id="cb247-1990"><a href="#cb247-1990" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Changepoint"</span>, <span class="st">"Williams"</span>, <span class="st">"Marcus"</span>, </span>
<span id="cb247-1991"><a href="#cb247-1991" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"McDermott"</span>, <span class="st">"UmbrellaWilliams"</span>, <span class="st">"GrandMean"</span>))</span>
<span id="cb247-1992"><a href="#cb247-1992" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-1993"><a href="#cb247-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1994"><a href="#cb247-1994" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dunnett</span></span>
<span id="cb247-1995"><a href="#cb247-1995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-1996"><a href="#cb247-1996" aria-hidden="true" tabindex="-1"></a>Der Dunnett Kontrast vergleicht einen Mittwelwert gegen die Mittelwerte der anderen Gruppen. Dabei muss dann eine Gruppe als Kontrolle mit der Option <span class="in">`base`</span> gewählt werden. Ich habe mich hier für die zweite Gruppe entschieden.</span>
<span id="cb247-1997"><a href="#cb247-1997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2000"><a href="#cb247-2000" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2001"><a href="#cb247-2001" aria-hidden="true" tabindex="-1"></a><span class="fu">contrMat</span>(<span class="at">n =</span> <span class="fu">c</span>(<span class="at">cat =</span> <span class="dv">5</span>, <span class="at">dog =</span> <span class="dv">5</span>, <span class="at">fox =</span> <span class="dv">5</span>, <span class="at">cow =</span> <span class="dv">5</span>, <span class="at">ape =</span> <span class="dv">5</span>, <span class="at">bee =</span> <span class="dv">5</span>), </span>
<span id="cb247-2002"><a href="#cb247-2002" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"Changepoint"</span>), <span class="at">base =</span> <span class="dv">2</span>)</span>
<span id="cb247-2003"><a href="#cb247-2003" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2004"><a href="#cb247-2004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2005"><a href="#cb247-2005" aria-hidden="true" tabindex="-1"></a><span class="fu">## Changepoint</span></span>
<span id="cb247-2006"><a href="#cb247-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2007"><a href="#cb247-2007" aria-hidden="true" tabindex="-1"></a>Der Changepoint Kontrast vergleicht ein laufendes Mittel. So wird erst der erste Mittelwert der ersten Gruppe gegen die gemittelten Mittelwerte der restlichen Gruppen verglichen. Dann werden die ersten beiden Gruppen gegen den Rest vergleichen. Das machen wir dann so lange, bis wir den letzten Mittelwert gegen das Mittel der vorherigen Gruppen vergleichen.</span>
<span id="cb247-2008"><a href="#cb247-2008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2011"><a href="#cb247-2011" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2012"><a href="#cb247-2012" aria-hidden="true" tabindex="-1"></a><span class="fu">contrMat</span>(<span class="at">n =</span> <span class="fu">c</span>(<span class="at">cat =</span> <span class="dv">5</span>, <span class="at">dog =</span> <span class="dv">5</span>, <span class="at">fox =</span> <span class="dv">5</span>, <span class="at">cow =</span> <span class="dv">5</span>, <span class="at">ape =</span> <span class="dv">5</span>, <span class="at">bee =</span> <span class="dv">5</span>), </span>
<span id="cb247-2013"><a href="#cb247-2013" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"Changepoint"</span>))</span>
<span id="cb247-2014"><a href="#cb247-2014" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2015"><a href="#cb247-2015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2016"><a href="#cb247-2016" aria-hidden="true" tabindex="-1"></a><span class="fu">## AVE</span></span>
<span id="cb247-2017"><a href="#cb247-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2018"><a href="#cb247-2018" aria-hidden="true" tabindex="-1"></a>Als letztes Beispiel noch den AVE Kontrast oder auch *Average* Kontrast. Hier wird dann jeder Mittelwert gegen das Mittel der anderen Gruppen verglichen. Das ist jetzt nicht der Anwendungsfall, den du immer mal brauchen wirst, aber manchmal gut zu wissen, dass es geht.</span>
<span id="cb247-2019"><a href="#cb247-2019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2022"><a href="#cb247-2022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2023"><a href="#cb247-2023" aria-hidden="true" tabindex="-1"></a><span class="fu">contrMat</span>(<span class="at">n =</span> <span class="fu">c</span>(<span class="at">cat =</span> <span class="dv">5</span>, <span class="at">dog =</span> <span class="dv">5</span>, <span class="at">fox =</span> <span class="dv">5</span>, <span class="at">cow =</span> <span class="dv">5</span>, <span class="at">ape =</span> <span class="dv">5</span>, <span class="at">bee =</span> <span class="dv">5</span>), </span>
<span id="cb247-2024"><a href="#cb247-2024" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"AVE"</span>))</span>
<span id="cb247-2025"><a href="#cb247-2025" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2026"><a href="#cb247-2026" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-2027"><a href="#cb247-2027" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb247-2028"><a href="#cb247-2028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2029"><a href="#cb247-2029" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktorielle Analyse {.unnumbered .unlisted}</span></span>
<span id="cb247-2030"><a href="#cb247-2030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2031"><a href="#cb247-2031" aria-hidden="true" tabindex="-1"></a>Im Zentrum von <span class="in">`{multcomp}`</span> steht die einfaktorielle Analyse. Das muss dir zuerst bewusst sein. Ja, es gehen auch mehrere Faktoren oder ein komplexeres Modell, aber dann wird es mit den Kontrasten schwieriger, was ja wiederum die Stärke von <span class="in">`{multcomp}`</span> ist. Du kannst ein belibiges Modell berechnen und dieses dann als Grundlage für die zentrale Funktion <span class="in">`glht()`</span> in <span class="in">`{multcomp}`</span> nutzen. Ich rechne hier einmal ein lineares Modell um die Sprunglängen der Hunde- und Katzenflöhe miteinander zu vergleichen.</span>
<span id="cb247-2032"><a href="#cb247-2032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2035"><a href="#cb247-2035" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2036"><a href="#cb247-2036" aria-hidden="true" tabindex="-1"></a>fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb247-2037"><a href="#cb247-2037" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2038"><a href="#cb247-2038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2039"><a href="#cb247-2039" aria-hidden="true" tabindex="-1"></a>Jetzt kommt der etwas sperrige Aufruf der Funktion <span class="in">`glht()`</span> um den multiplen Vergleich zu rechnen. Warum ist der Aufruf so sperrig? Zum einen müssen wir erst das Modell angeben, was wir nutzen wollen. Dann brauchen wir aber noch die Variable, die wir dann mit einem Kontrast vergleichen wollen. Das Ganze spezifizieren wir dann in der Option <span class="in">`linfct`</span>. Du musst dann bei dir im Prinzip nur <span class="in">`animal`</span> gegen deinen Variablennamen austauschen.</span>
<span id="cb247-2040"><a href="#cb247-2040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2041"><a href="#cb247-2041" aria-hidden="true" tabindex="-1"></a>Wir können auch hier für eine mögliche Varianzheterogenität anpassen und entsprechend eine Varianzschätzer mit der Option <span class="in">`vcov.`</span> wählen. Ich habe hier den Standard gewählt. Am Ende dieses Kapitels kannst du dann nochmal über andere Varianzschätzer lesen.</span>
<span id="cb247-2042"><a href="#cb247-2042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2045"><a href="#cb247-2045" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2046"><a href="#cb247-2046" aria-hidden="true" tabindex="-1"></a>multcomp_fac1_obj <span class="ot">&lt;-</span> <span class="fu">glht</span>(fac1_fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">animal =</span> <span class="st">"Tukey"</span>), </span>
<span id="cb247-2047"><a href="#cb247-2047" aria-hidden="true" tabindex="-1"></a>                          <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHC) </span>
<span id="cb247-2048"><a href="#cb247-2048" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2049"><a href="#cb247-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2050"><a href="#cb247-2050" aria-hidden="true" tabindex="-1"></a>Leider sehen wir die Anpassung für die Varianzheterogenität nicht in der Ausgabe von <span class="in">`glht`</span>, was immer etwas nervig ist. Deshalb musst du nochmal gucken, was die Funktion <span class="in">`vcov()`</span> dir zurückgibt. Wir brauchen nur die Diagonale der Varianz/Covarianzmatrix um zu schauen ob wir heterogene Varianzen geschätzt bekommen haben. Sieht auf jeden Fall gut aus, die Varianzen sind nicht alle gleich.</span>
<span id="cb247-2051"><a href="#cb247-2051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2054"><a href="#cb247-2054" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2055"><a href="#cb247-2055" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(multcomp_fac1_obj) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span>
<span id="cb247-2056"><a href="#cb247-2056" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2057"><a href="#cb247-2057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2058"><a href="#cb247-2058" aria-hidden="true" tabindex="-1"></a>Wenn wir die Funktion durchgeführt haben können wir uns mit der Wiedergabe die statistischen Maßzahlen berechnen lassen. Du kannst natürlich auch die Adjustierung für die heterogenen Varianzen weglassen, aber so viel aus machen tut die Adjustierung nicht.</span>
<span id="cb247-2059"><a href="#cb247-2059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2060"><a href="#cb247-2060" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-2061"><a href="#cb247-2061" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte</span></span>
<span id="cb247-2062"><a href="#cb247-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2063"><a href="#cb247-2063" aria-hidden="true" tabindex="-1"></a>Per Standardeinstellung erhalten wir die adjustierten p-Werte wieder. Ich nutze noch die Helferfunktion <span class="in">`tidy()`</span> um mir eine bessere Ausgabe zu erschaffen. Dann wähle ich noch den Kontrast, den Mittelwertsunterschied sowie die adjustierten p-Werte aus.</span>
<span id="cb247-2064"><a href="#cb247-2064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2067"><a href="#cb247-2067" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2068"><a href="#cb247-2068" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-2069"><a href="#cb247-2069" aria-hidden="true" tabindex="-1"></a>multcomp_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-2070"><a href="#cb247-2070" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb247-2071"><a href="#cb247-2071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, adj.p.value)</span>
<span id="cb247-2072"><a href="#cb247-2072" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2073"><a href="#cb247-2073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2074"><a href="#cb247-2074" aria-hidden="true" tabindex="-1"></a>Wir können auch die Adjustierung der p-Werte ausschalten indem wir nochmal die Funktion <span class="in">`summary()`</span> mit der entsprechenden Option dazwischenschalten. Das ist dann auf jeden Fall nochmal eine gute Option, wenn man beides haben möchte.</span>
<span id="cb247-2075"><a href="#cb247-2075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2078"><a href="#cb247-2078" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2079"><a href="#cb247-2079" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-2080"><a href="#cb247-2080" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-2081"><a href="#cb247-2081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2082"><a href="#cb247-2082" aria-hidden="true" tabindex="-1"></a>multcomp_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-2083"><a href="#cb247-2083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"none"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-2084"><a href="#cb247-2084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() </span>
<span id="cb247-2085"><a href="#cb247-2085" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2086"><a href="#cb247-2086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2087"><a href="#cb247-2087" aria-hidden="true" tabindex="-1"></a>Die p-Werte sind ähnlich wie schon in den anderen Analysen, was auch zu erwarten war. Die einfaktorielle Analyse für einen *all-pair* Vergleich ist recht ähnlich.</span>
<span id="cb247-2088"><a href="#cb247-2088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2089"><a href="#cb247-2089" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact letter display*</span></span>
<span id="cb247-2090"><a href="#cb247-2090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2091"><a href="#cb247-2091" aria-hidden="true" tabindex="-1"></a>Bei dem *Compact letter display* müssen wir einmal die Leerzeichen aus den Kontrastnamen entfernen damit die Funktion <span class="in">`multcompLetters`</span> die entsprechenden Buchstaben erstellen kann.</span>
<span id="cb247-2092"><a href="#cb247-2092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2095"><a href="#cb247-2095" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2096"><a href="#cb247-2096" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-2097"><a href="#cb247-2097" aria-hidden="true" tabindex="-1"></a>multcomp_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-2098"><a href="#cb247-2098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb247-2099"><a href="#cb247-2099" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-2100"><a href="#cb247-2100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(adj.p.value, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb247-2101"><a href="#cb247-2101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span>
<span id="cb247-2102"><a href="#cb247-2102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2103"><a href="#cb247-2103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2104"><a href="#cb247-2104" aria-hidden="true" tabindex="-1"></a>Wir erhalten dann ein ähnliches Ergebnis wie schon bei den anderen Analysen. Du musst dann immer schauen, was besser zu deiner Fragestellung passt.</span>
<span id="cb247-2105"><a href="#cb247-2105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2106"><a href="#cb247-2106" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall</span></span>
<span id="cb247-2107"><a href="#cb247-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2108"><a href="#cb247-2108" aria-hidden="true" tabindex="-1"></a>Die Stärke von <span class="in">`{multcomp}`</span> sind die simultanen 95% Konfidenzintervalle die auch alle damit die Fehlerrate des Signifikanzniveaus von 5% über alle Vergleiche einhalten. Das funktioniert besonders git in dem Fall, dass wir eine einfaktorielle Analyse vorliegen haben. Wir müssen aber die Funktion <span class="in">`tidy()`</span> aufrufen, damit uns die 95% Konfidenzintervalle wiedergegeben werden.</span>
<span id="cb247-2109"><a href="#cb247-2109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2112"><a href="#cb247-2112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2113"><a href="#cb247-2113" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-2114"><a href="#cb247-2114" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-2115"><a href="#cb247-2115" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-2116"><a href="#cb247-2116" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-2117"><a href="#cb247-2117" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb247-2118"><a href="#cb247-2118" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb247-2119"><a href="#cb247-2119" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe."</span></span>
<span id="cb247-2120"><a href="#cb247-2120" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-multcomp-fac1</span></span>
<span id="cb247-2121"><a href="#cb247-2121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2122"><a href="#cb247-2122" aria-hidden="true" tabindex="-1"></a>relevance_lvl <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb247-2123"><a href="#cb247-2123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2124"><a href="#cb247-2124" aria-hidden="true" tabindex="-1"></a>multcomp_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-2125"><a href="#cb247-2125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-2126"><a href="#cb247-2126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig_lgl =</span> <span class="fu">case_when</span>(<span class="fu">between</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">n</span>()), conf.low, conf.high) <span class="sc">~</span> <span class="st">"n.s."</span>,</span>
<span id="cb247-2127"><a href="#cb247-2127" aria-hidden="true" tabindex="-1"></a>                             relevance_lvl <span class="sc">&lt;</span> conf.low <span class="sc">~</span> <span class="st">"s. &amp; r."</span>,</span>
<span id="cb247-2128"><a href="#cb247-2128" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> <span class="st">"s."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-2129"><a href="#cb247-2129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(contrast, <span class="at">y =</span> estimate, </span>
<span id="cb247-2130"><a href="#cb247-2130" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, </span>
<span id="cb247-2131"><a href="#cb247-2131" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> sig_lgl)) <span class="sc">+</span></span>
<span id="cb247-2132"><a href="#cb247-2132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-2133"><a href="#cb247-2133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb247-2134"><a href="#cb247-2134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb247-2135"><a href="#cb247-2135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">2</span>), <span class="at">linetype =</span> <span class="st">"11"</span>) <span class="sc">+</span></span>
<span id="cb247-2136"><a href="#cb247-2136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb247-2137"><a href="#cb247-2137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb247-2138"><a href="#cb247-2138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb247-2139"><a href="#cb247-2139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Mittelwertsunterschied"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb247-2140"><a href="#cb247-2140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb247-2141"><a href="#cb247-2141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2142"><a href="#cb247-2142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2143"><a href="#cb247-2143" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-2144"><a href="#cb247-2144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2145"><a href="#cb247-2145" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktorielle Analyse {.unnumbered .unlisted}</span></span>
<span id="cb247-2146"><a href="#cb247-2146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2147"><a href="#cb247-2147" aria-hidden="true" tabindex="-1"></a>Es ist acuh möglich in <span class="in">`{multcomp}`</span> eine mehrfaktorielle Analyse druchzuführen. Hierbei können wir wieder jedes Modell nehmen was wir zu Verfügung haben. Damit es hier einfach bleibt, bleibe ich bei einem linearen Modell für einen normalverteilten Messwert. Wir haben wieder unsere Tierrassen und dann noch den Messort vorliegen. Mehr zu dem Thema findest du auch in der Arbeit von @hothorn2008simultaneous in dem Dokument <span class="co">[</span><span class="ot">multcomp: Simultaneous Inference in General Parametric Models</span><span class="co">](https://cran.r-project.org/web/packages/multcomp/)</span>.</span>
<span id="cb247-2148"><a href="#cb247-2148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2151"><a href="#cb247-2151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2152"><a href="#cb247-2152" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span>
<span id="cb247-2153"><a href="#cb247-2153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2154"><a href="#cb247-2154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2155"><a href="#cb247-2155" aria-hidden="true" tabindex="-1"></a>Jetzt müssen wir aber einiges an Option auswählen, damit wir die zweifaktorielle Analyse auch gut durchrechnen können. *Wichtig ist hier, dass wir über den zweiten Faktor mitteln.* Daher verlieren wir den zweiten Faktor in der Betrachung der folgenden Ergebnisse. Manchmal wollen wir das, häufig wollen wir das nicht. Deshalb nutzen wir die Option `covariate_average = TRUE` und `interaction_average = TRUE` um eben über den zweiten Faktor `site` und die Interaktion `animal:site` zu mitteln (eng. *average*). Optimal ist es dann trotzdem nicht.</span>
<span id="cb247-2156"><a href="#cb247-2156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2159"><a href="#cb247-2159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2160"><a href="#cb247-2160" aria-hidden="true" tabindex="-1"></a>multcomp_fac2_obj <span class="ot">&lt;-</span> <span class="fu">glht</span>(fac2_fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">animal =</span> <span class="st">"Tukey"</span>,</span>
<span id="cb247-2161"><a href="#cb247-2161" aria-hidden="true" tabindex="-1"></a>                          <span class="at">covariate_average =</span> <span class="cn">TRUE</span>, <span class="at">interaction_average =</span> <span class="cn">TRUE</span>),</span>
<span id="cb247-2162"><a href="#cb247-2162" aria-hidden="true" tabindex="-1"></a>                          <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHC) </span>
<span id="cb247-2163"><a href="#cb247-2163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2164"><a href="#cb247-2164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2165"><a href="#cb247-2165" aria-hidden="true" tabindex="-1"></a>Auch hier schauen wir dann einmal, ob die Anpassung der Varianzen geklappt hat und wir sehen, dass wir unterschiedliche Varianzen rausbekommen.</span>
<span id="cb247-2166"><a href="#cb247-2166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2169"><a href="#cb247-2169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2170"><a href="#cb247-2170" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>(multcomp_fac2_obj) <span class="sc">|&gt;</span> <span class="fu">diag</span>()</span>
<span id="cb247-2171"><a href="#cb247-2171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2172"><a href="#cb247-2172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2173"><a href="#cb247-2173" aria-hidden="true" tabindex="-1"></a>Jetzt haben wir alles toll über den zweiten Faktor und die Interaktion gemittelt. Das ist aber nicht so super, wenn wir eine signifikante Interaktion vorliegen haben. Da sollten wir uns den ersten Faktor getrennt für den zweiten Faktor anschauen. Und das wird dann in <span class="in">`{multcomp}`</span> etwas sperrig um es mal freundlich auszudrücken. Wir müssen uns erstmal eine neue Variable bauen, die alle Faktorkombinationen enthält. Das macht die Funktion <span class="in">`interaction()`</span> für uns.</span>
<span id="cb247-2174"><a href="#cb247-2174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2177"><a href="#cb247-2177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2178"><a href="#cb247-2178" aria-hidden="true" tabindex="-1"></a>fac2_inter_tbl <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb247-2179"><a href="#cb247-2179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inter_animal_site =</span> <span class="fu">interaction</span>(animal, site))</span>
<span id="cb247-2180"><a href="#cb247-2180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2181"><a href="#cb247-2181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2182"><a href="#cb247-2182" aria-hidden="true" tabindex="-1"></a>Dann können wir das Modell einfaktoriell nur mit der Variable der Interaktion rechnen. Das ist natürlich auch so halb eine Lösung.</span>
<span id="cb247-2183"><a href="#cb247-2183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2186"><a href="#cb247-2186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2187"><a href="#cb247-2187" aria-hidden="true" tabindex="-1"></a>fac2_inter_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> inter_animal_site, <span class="at">data =</span> fac2_inter_tbl)</span>
<span id="cb247-2188"><a href="#cb247-2188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2189"><a href="#cb247-2189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2190"><a href="#cb247-2190" aria-hidden="true" tabindex="-1"></a>Mit dem künstlichen einfaktoriellen Modell können wir dann wieder unsere Funktion <span class="in">`glht()`</span> aufrufen. Hier dann einmal simple ohne Adjustierung für Varianzheterogenität. Hier macht es dann sehr Sinn alle Vergleiche zu rechnen. Obwohl du dann natürlich echt viele Vergleiche rechnest und du damit das Signifikanzniveau sehr drückst. Je mehr ich darüber nachdenke, desto weniger würde ich es so machen. Dann lieber doch alles in <span class="in">`{emmeans}`</span>.</span>
<span id="cb247-2191"><a href="#cb247-2191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2194"><a href="#cb247-2194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2195"><a href="#cb247-2195" aria-hidden="true" tabindex="-1"></a>multcomp_fac2_inter_obj <span class="ot">&lt;-</span> <span class="fu">glht</span>(fac2_inter_fit, </span>
<span id="cb247-2196"><a href="#cb247-2196" aria-hidden="true" tabindex="-1"></a>                                <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">inter_animal_site =</span> <span class="st">"Tukey"</span>)) </span>
<span id="cb247-2197"><a href="#cb247-2197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2198"><a href="#cb247-2198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2199"><a href="#cb247-2199" aria-hidden="true" tabindex="-1"></a>Im Folgenden lassen wir uns einmal die p-Werte für das Interaktionmodell wiedergeben. Sonst wäre es mehr oder minder die Wiederholung des einfaktoriellen Modells nur mit gemittelten Werten für den zweiten Faktor und der Interaktion.</span>
<span id="cb247-2200"><a href="#cb247-2200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2201"><a href="#cb247-2201" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-2202"><a href="#cb247-2202" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte</span></span>
<span id="cb247-2203"><a href="#cb247-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2204"><a href="#cb247-2204" aria-hidden="true" tabindex="-1"></a>Jetzt erhalten wir einiges an Vergleichen, da wir ja auch eine Menge an Tests rechnen. Für jede Faktorkombination kriegst du jetzt einen adjustierten p-Wert wiedergegeben und damit wird es wirklich etwas unübersichtlich. Leider fällt mir auch keine bessere Ordnung ein. Hier hilft dann wirklich mal die Funktion <span class="in">`pvalue()`</span> umd die p-Werte einheitlich zu formatieren.</span>
<span id="cb247-2205"><a href="#cb247-2205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2208"><a href="#cb247-2208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2209"><a href="#cb247-2209" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-2210"><a href="#cb247-2210" aria-hidden="true" tabindex="-1"></a>multcomp_fac2_inter_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-2211"><a href="#cb247-2211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb247-2212"><a href="#cb247-2212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">adj.p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(adj.p.value)) <span class="sc">|&gt;</span> </span>
<span id="cb247-2213"><a href="#cb247-2213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, adj.p.value)</span>
<span id="cb247-2214"><a href="#cb247-2214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2215"><a href="#cb247-2215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2216"><a href="#cb247-2216" aria-hidden="true" tabindex="-1"></a>Besonders bei *so vielen* Vergleichen macht es eventuell Sinn einmal die p-Wert Adjustierung für multiple Vergleiche auszuschalten und sich die rohen p-Werte in Ruhe zu betrachten.</span>
<span id="cb247-2217"><a href="#cb247-2217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2220"><a href="#cb247-2220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2221"><a href="#cb247-2221" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-2222"><a href="#cb247-2222" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-2223"><a href="#cb247-2223" aria-hidden="true" tabindex="-1"></a>multcomp_fac2_inter_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-2224"><a href="#cb247-2224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"none"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-2225"><a href="#cb247-2225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() </span>
<span id="cb247-2226"><a href="#cb247-2226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2227"><a href="#cb247-2227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2228"><a href="#cb247-2228" aria-hidden="true" tabindex="-1"></a>Am Ende bleibt eine sehr lange Liste, die schon bei drei Tierrassen und zwei Messorten sehr lang ist. Wenn du dann mehr Level in jedem Faktor hast, dann wird die Sachlage noch unübersichtlicher. Hier würde ich dann die Reißleine ziehen und dann nicht mehr <span class="in">`{multcomp}`</span> nutzen.</span>
<span id="cb247-2229"><a href="#cb247-2229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2230"><a href="#cb247-2230" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact letter display*</span></span>
<span id="cb247-2231"><a href="#cb247-2231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2232"><a href="#cb247-2232" aria-hidden="true" tabindex="-1"></a>Das *Compact letter display* leidet auch etwas unter der großen Anzahl an Vergleichen. Dadurch kann es dir passieren, dass dir die Buchstaben ausgehen! Das ist jetzt hier noch nicht der Fall, aber das müsstest du mit in Betracht ziehen.</span>
<span id="cb247-2233"><a href="#cb247-2233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2236"><a href="#cb247-2236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2237"><a href="#cb247-2237" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-2238"><a href="#cb247-2238" aria-hidden="true" tabindex="-1"></a>multcomp_fac2_inter_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-2239"><a href="#cb247-2239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb247-2240"><a href="#cb247-2240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-2241"><a href="#cb247-2241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(adj.p.value, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb247-2242"><a href="#cb247-2242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span>
<span id="cb247-2243"><a href="#cb247-2243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2244"><a href="#cb247-2244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2245"><a href="#cb247-2245" aria-hidden="true" tabindex="-1"></a>Auch hier erhälst du dann eine Menge Vergleiche, die dich vielleicht alle gar nicht interesieren. Dadurch wird dann aber alles noch unübersichtlicher, obwohl die Übersichtlichkeit ja gerade eine Stärke des *Compact letter displays* ist.</span>
<span id="cb247-2246"><a href="#cb247-2246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2247"><a href="#cb247-2247" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall</span></span>
<span id="cb247-2248"><a href="#cb247-2248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2249"><a href="#cb247-2249" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns noch die 95% Konfidenzintervalle an, die hier dann doch etwas übersichtlicher daherkommen. Wir haben zwar eine riesige Menge an Kondfidenzintervallen aber immerhin sieht man hier ganz gut, wie relevant die einzelnen Vergleiche sind. Also wie weit ist denn jetzt das Konfidenzintervall von der Null weg für den jeweiligen Vergleich? Hier lässt sich dann auch eine Relevanzschwelle gut einzeichnen. Ich habe hier mal einen Mittelwertsunterschied von 2cm als relevant eingezeichnet.</span>
<span id="cb247-2250"><a href="#cb247-2250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2253"><a href="#cb247-2253" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2254"><a href="#cb247-2254" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-2255"><a href="#cb247-2255" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-2256"><a href="#cb247-2256" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-2257"><a href="#cb247-2257" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-2258"><a href="#cb247-2258" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb247-2259"><a href="#cb247-2259" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb247-2260"><a href="#cb247-2260" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe."</span></span>
<span id="cb247-2261"><a href="#cb247-2261" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-multcomp-fac2</span></span>
<span id="cb247-2262"><a href="#cb247-2262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2263"><a href="#cb247-2263" aria-hidden="true" tabindex="-1"></a>relevance_lvl <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb247-2264"><a href="#cb247-2264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2265"><a href="#cb247-2265" aria-hidden="true" tabindex="-1"></a>multcomp_fac2_inter_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-2266"><a href="#cb247-2266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-2267"><a href="#cb247-2267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sig_lgl =</span> <span class="fu">case_when</span>(<span class="fu">between</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">n</span>()), conf.low, conf.high) <span class="sc">~</span> <span class="st">"n.s."</span>,</span>
<span id="cb247-2268"><a href="#cb247-2268" aria-hidden="true" tabindex="-1"></a>                             relevance_lvl <span class="sc">&lt;</span> conf.low <span class="sc">~</span> <span class="st">"s. &amp; r."</span>,</span>
<span id="cb247-2269"><a href="#cb247-2269" aria-hidden="true" tabindex="-1"></a>                             <span class="at">.default =</span> <span class="st">"s."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb247-2270"><a href="#cb247-2270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(contrast, <span class="at">y =</span> estimate, </span>
<span id="cb247-2271"><a href="#cb247-2271" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> conf.low, <span class="at">ymax =</span> conf.high, </span>
<span id="cb247-2272"><a href="#cb247-2272" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> sig_lgl)) <span class="sc">+</span></span>
<span id="cb247-2273"><a href="#cb247-2273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb247-2274"><a href="#cb247-2274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb247-2275"><a href="#cb247-2275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb247-2276"><a href="#cb247-2276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">2</span>), <span class="at">linetype =</span> <span class="st">"11"</span>) <span class="sc">+</span></span>
<span id="cb247-2277"><a href="#cb247-2277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb247-2278"><a href="#cb247-2278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb247-2279"><a href="#cb247-2279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb247-2280"><a href="#cb247-2280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Mittelwertsunterschied"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb247-2281"><a href="#cb247-2281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb247-2282"><a href="#cb247-2282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2283"><a href="#cb247-2283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2284"><a href="#cb247-2284" aria-hidden="true" tabindex="-1"></a>Am Ende kannst du dann anhand der Signifikanzschwelle und der Relevanzschwelle deine Ergebnisse entsprechend sortieren und eine Entscheidung treffen. Am Ende steht und fällt es dann natürlich mit der Definition der Relevanzschwelle und der Anzahl an Faktorkombinationen. Wenn es dann zu viele sind, dann siehst du gar nichts mehr.</span>
<span id="cb247-2285"><a href="#cb247-2285" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-2286"><a href="#cb247-2286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2287"><a href="#cb247-2287" aria-hidden="true" tabindex="-1"></a><span class="fu">### R Paket `{nparcomp}`</span></span>
<span id="cb247-2288"><a href="#cb247-2288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2289"><a href="#cb247-2289" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb247-2290"><a href="#cb247-2290" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb247-2291"><a href="#cb247-2291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2292"><a href="#cb247-2292" aria-hidden="true" tabindex="-1"></a>Das Paket <span class="in">`{nparcomp}`</span> kann nur ein einfaktorielles Modell rechnen. Dafür brauchst du kein normalverteiltes $y$ in deinen Daten. Darüber hinaus ist die Interpretation des Effekts biologisch nicht möglich. Jedenfalls nicht im klassischen Sinne einer Relevanzbetrachtung auf der Einheit der Messwerte deines $y$. Das *Compact letter display* kannst du aber problemlos nutzen.</span>
<span id="cb247-2293"><a href="#cb247-2293" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-2294"><a href="#cb247-2294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2295"><a href="#cb247-2295" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{nparcomp}`</span> wird gerne genutzt, wenn du ein nicht normalverteiltes Outcome $y$ vorliegen hast und nur eine Behandlung $x$. Dieser Fall kommt sehr oft in der Zellbiologie vor oder aber allgemein in den Humanwissenschaften. Teilweise dann auch in Mausmodellen, wo wir dann nur drei bis vier Behandlungen vorliegen haben und diese dann zu einer Kontrolle vergleichen. Dafür ist das R Paket <span class="in">`{nparcomp}`</span> nützlich. Aber auch nur, wenn du an p-Werten und vielleicht noch dem *Compact letter display* interessiert bist. Alles andere ist dann nicht sinnvoll abbildbar.</span>
<span id="cb247-2296"><a href="#cb247-2296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2297"><a href="#cb247-2297" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb247-2298"><a href="#cb247-2298" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01_small.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb247-2299"><a href="#cb247-2299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2300"><a href="#cb247-2300" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Hier einmal kurz der niedergeschlagende Engel. In diesem Abschnitt zu </span><span class="in">`{nparcomp}`</span><span class="at"> werde ich ein paar Engel der Statistik niedergeschlagen und dann noch überfahren. Ich lasse aus Gründen der Didaktik ein paar Sachen weg und dadurch wird einiges leider dann *mathematisch* unkorrekt. Ich kann damit leben und nehme es auf mich damit du deine Abschlussarbeit fertig bekommst. Somit sind alle Abbildungen eher Näherungen als mathematisch korrekt.</span></span>
<span id="cb247-2301"><a href="#cb247-2301" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb247-2302"><a href="#cb247-2302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2303"><a href="#cb247-2303" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{nparcomp}`</span> hat viele Stärken. In den meisten praktischen Situationen ist die Verteilung der gemessenen Daten $Y$ unbekannt. Dann kann es auch sein, dass du eine Reihe von atypischen Messungen und Ausreißern vorliegen hast. Mit dem R Paket <span class="in">`{nparcomp}`</span> hast fast keine Annahmen an die Daten, so dass du hier sehr flexibel bist. Einzig die Verteilungen der Gruppen müssen ähnlich sein. Das ist aber in einem in sich geschlossenen Experiment eigentlich immer der Fall.</span>
<span id="cb247-2304"><a href="#cb247-2304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2305"><a href="#cb247-2305" aria-hidden="true" tabindex="-1"></a>Betrachten wir also einmal die Funktionsweise von <span class="in">`{nparcomp}`</span> an einem simplen Beispiel. Ich gehe hier nicht auf die tiefen der Berechnung ein, sondern wir wollen einmal verstehen, was die Ausgabe von <span class="in">`{naparcomp}`</span> uns sagen will. Da das Verfahren nicht auf den klassischen statistischen Maßzahlen wie Mittelwert und Standardabweichung beruht ist die Ausgabe nicht ganz so einfach zu verstehen. In der folgenden Tabelle siehst du einmal die Ausgabe der Funktion <span class="in">`npar.t.test()`</span> in der ich nur die Sprungweiten der Hunde- und Katzenflöhe miteinander vergleichen habe.</span>
<span id="cb247-2306"><a href="#cb247-2306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2309"><a href="#cb247-2309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2310"><a href="#cb247-2310" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb247-2311"><a href="#cb247-2311" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-2312"><a href="#cb247-2312" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-2313"><a href="#cb247-2313" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-nparcomp-res</span></span>
<span id="cb247-2314"><a href="#cb247-2314" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Ergebnis der Funktion `npar.t.test()` für den paarweisen Vergleichs von der Sprunglänge in [cm] von Hunde- und Kartzenflöhen. Die Fuchsflöhe wurden einmal entfernt um nur einen paarweisen Vergleich zu rechnen."</span></span>
<span id="cb247-2315"><a href="#cb247-2315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2316"><a href="#cb247-2316" aria-hidden="true" tabindex="-1"></a><span class="fu">npar.t.test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> <span class="fu">filter</span>(fac1_tbl, animal <span class="sc">!=</span> <span class="st">"fox"</span>), </span>
<span id="cb247-2317"><a href="#cb247-2317" aria-hidden="true" tabindex="-1"></a>            <span class="at">method =</span> <span class="st">"t.app"</span>,</span>
<span id="cb247-2318"><a href="#cb247-2318" aria-hidden="true" tabindex="-1"></a>            <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-2319"><a href="#cb247-2319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Analysis"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-2320"><a href="#cb247-2320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.Value =</span> <span class="fu">pvalue</span>(p.Value)) <span class="sc">|&gt;</span> </span>
<span id="cb247-2321"><a href="#cb247-2321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)  </span>
<span id="cb247-2322"><a href="#cb247-2322" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb247-2323"><a href="#cb247-2323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2324"><a href="#cb247-2324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2325"><a href="#cb247-2325" aria-hidden="true" tabindex="-1"></a>Wir wissen anhand der Ausgabe von <span class="in">`npar.t.test()`</span>, dass wir einen signifikanten Unterschied zwischen den Sprungweiten der Hunde- und Katzenflöhe vorliegen haben. Der p-Wert $0.001$ ist kleiner als das Signifikanzniveau $\alpha$ gleich 5%. Aber wie groß ist jetzt der Unterschied oder anders gefragt, was ist der berechnete Effekt? Das R Paket <span class="in">`{nparcomp}`</span> berechnet hierbei den relativen Effekt $p(a,b)$. Das heißt wiederum, dass wir die Einheit der Sprungweite verlieren und nur eine Wahrscheinlichkeit wiedergeben bekommen.</span>
<span id="cb247-2326"><a href="#cb247-2326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2327"><a href="#cb247-2327" aria-hidden="true" tabindex="-1"></a>Was sagt der relative Effekt $\boldsymbol{p(a,b)}$ aus?</span>
<span id="cb247-2328"><a href="#cb247-2328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2329"><a href="#cb247-2329" aria-hidden="true" tabindex="-1"></a>:   Wenn der relative Effekt $p(a,b)$ größer ist als $1/2$, dann tendiert die Gruppe $b$ dazu größer zu sein als die Gruppe $a$. Oder etwas anders formuliert. Wenn wir einen relativen Effekt größer als $1/2$ vorliegen haben, dann spricht der relative Effekt für größere Mittelwerte in der Gruppe $b$ im Vergleich zur Gruppe $a$. Wir können dann sagen, dass $\bar{y}_b &gt; \bar{y}_a$ ist. Oder dur schreibst statt $p(a,b)$ eben $p(b &gt; a)$. Ja, ist etwas schief...aber wir leben damit.</span>
<span id="cb247-2330"><a href="#cb247-2330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2331"><a href="#cb247-2331" aria-hidden="true" tabindex="-1"></a>Betrachten wir einmal die Darstellung der beiden Verteilungen der Sprungweiten für die Hunde- und Katzenflöhe. Die Katzenflöhe haben einen niedrigeren Mittelwert mit $<span class="sc">\\</span>bar{y}_{cat} = 4.74$ und springen nicht so weit wie die Hundeflöhe mit einem hören Mittelwert von $\\bar{y}_{dog} = 8.13$. Wir erhalten einen relativen Effekt $p_{(dog, cat)}$ von $0.102$. Was sagt uns nun der Wert aus? In der folgenden Abbidlung ahbe ich dir einmal den Zusammenhang visualisert. Die eingefärbte Fläche ist die Wahrscheinlichkeit $p_{(dog, cat)}$ von $0.102$ zufällig größere Sprungweiten von Katzenflöhen als von Hundeflöhen zu beobachten. Da die Katzenflöhe ja *nicht* weiter als die Hundeflöhe springen, ist die Wahrscheinlichkeit $p_{(dog, cat)}$ klein.</span>
<span id="cb247-2332"><a href="#cb247-2332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2335"><a href="#cb247-2335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2336"><a href="#cb247-2336" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb247-2337"><a href="#cb247-2337" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-2338"><a href="#cb247-2338" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-2339"><a href="#cb247-2339" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-nparcomp-dog-cat</span></span>
<span id="cb247-2340"><a href="#cb247-2340" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-2341"><a href="#cb247-2341" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb247-2342"><a href="#cb247-2342" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb247-2343"><a href="#cb247-2343" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung der Verteilung der Sprungweiten der Hunde- und Katzenflöhe mit $8.13 \\pm 2.14cm$ für die Hundeflöhe und $4.74 \\pm 1.9cm$ für die Katzenflöhe. Wir gehen hier von einer normalverteilten Sprungweite aus. Wir erhalten einen relativen Effekt $p_{(dog, cat)}$ von $0.102$. Die Wahrscheinlichkeit $p_{(dog, cat)}$ beschreibt zufällig größere Werte für $\\bar{y}_cat$ als für $\\bar{y}_dog$ zu beobachten. Die eingefärbten Flächen dienen als Veranschaulichung. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb247-2344"><a href="#cb247-2344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2345"><a href="#cb247-2345" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>))) <span class="sc">+</span></span>
<span id="cb247-2346"><a href="#cb247-2346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb247-2347"><a href="#cb247-2347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  <span class="sc">+</span></span>
<span id="cb247-2348"><a href="#cb247-2348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">8.13</span>)) <span class="sc">+</span> </span>
<span id="cb247-2349"><a href="#cb247-2349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>)) <span class="sc">+</span>   </span>
<span id="cb247-2350"><a href="#cb247-2350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb247-2351"><a href="#cb247-2351" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">8.13</span>, <span class="at">sd =</span> <span class="fl">2.14</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb247-2352"><a href="#cb247-2352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb247-2353"><a href="#cb247-2353" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb247-2354"><a href="#cb247-2354" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb247-2355"><a href="#cb247-2355" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb247-2356"><a href="#cb247-2356" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb247-2357"><a href="#cb247-2357" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb247-2358"><a href="#cb247-2358" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb247-2359"><a href="#cb247-2359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb247-2360"><a href="#cb247-2360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb247-2361"><a href="#cb247-2361" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">4.74</span>, <span class="at">sd =</span> <span class="fl">1.9</span>), <span class="at">color =</span> <span class="st">"#D55E00"</span>) <span class="sc">+</span></span>
<span id="cb247-2362"><a href="#cb247-2362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, , </span>
<span id="cb247-2363"><a href="#cb247-2363" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">4.74</span>, <span class="at">sd =</span> <span class="fl">1.9</span>),</span>
<span id="cb247-2364"><a href="#cb247-2364" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">8.13</span>, <span class="dv">20</span>),</span>
<span id="cb247-2365"><a href="#cb247-2365" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"#D55E00"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>)  <span class="sc">+</span></span>
<span id="cb247-2366"><a href="#cb247-2366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">4.74</span>), <span class="at">color =</span> <span class="st">"#D55E00"</span>) <span class="sc">+</span> </span>
<span id="cb247-2367"><a href="#cb247-2367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="dv">9</span>), </span>
<span id="cb247-2368"><a href="#cb247-2368" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(y)[cat]), <span class="fu">expression</span>(<span class="fu">bar</span>(y)[dog]))) <span class="sc">+</span></span>
<span id="cb247-2369"><a href="#cb247-2369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">14</span>, <span class="at">y =</span> <span class="fl">0.16</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(y)[cat]<span class="sc">~</span><span class="st">"&lt;"</span><span class="sc">~</span><span class="fu">bar</span>(y)[dog]), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb247-2370"><a href="#cb247-2370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">14</span>, <span class="at">y =</span> <span class="fl">0.13</span>, <span class="at">label =</span> <span class="fu">expression</span>(p[<span class="st">"(dog,cat)"</span>]<span class="sc">~</span><span class="st">"="</span><span class="sc">~</span><span class="fl">0.102</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span>   </span>
<span id="cb247-2371"><a href="#cb247-2371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">y =</span> <span class="fl">0.16</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(y)[cat]<span class="sc">~</span><span class="st">"="</span><span class="sc">~</span><span class="fl">4.74</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb247-2372"><a href="#cb247-2372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">y =</span> <span class="fl">0.13</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(y)[dog]<span class="sc">~</span><span class="st">"="</span><span class="sc">~</span><span class="fl">8.13</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb247-2373"><a href="#cb247-2373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="at">x =</span> <span class="fl">13.75</span>, <span class="at">y =</span> <span class="fl">0.13</span>, <span class="at">xend =</span> <span class="dv">9</span>, <span class="at">yend =</span> <span class="fl">0.02</span>,</span>
<span id="cb247-2374"><a href="#cb247-2374" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>), <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb247-2375"><a href="#cb247-2375" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) </span>
<span id="cb247-2376"><a href="#cb247-2376" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb247-2377"><a href="#cb247-2377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2378"><a href="#cb247-2378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2379"><a href="#cb247-2379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2380"><a href="#cb247-2380" aria-hidden="true" tabindex="-1"></a>Wir können uns nun die Sachlage auch einmal für alle drei Fälle visualisieren. Daher wir schauen uns an, wie sehen die unterscheidlichen relativen Effektschätzer aus? Zum einen kann ja der Wert des relativen Effekts $p(a,b)$ klein sein und daher eher nahe Null. Damit spricht der relative Effekt dafür das $a$ kleiner ist als $b$. Oder der Wert von $p(a,b)$ ist 0.5, dann ist $a$ vermutlich gleich $b$. Im letzte Fall kann $p(a,b)$ nahe Eins sein, dann spricht es für größere Werte in $b$ als in $a$. Ich kann mit den Zusammenhang besser als eingefärbte Flächen merken, daher habe ich dir nochmal den relativen Effektschätzer etwas anders dargestellt.</span>
<span id="cb247-2381"><a href="#cb247-2381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2384"><a href="#cb247-2384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2385"><a href="#cb247-2385" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb247-2386"><a href="#cb247-2386" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-2387"><a href="#cb247-2387" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-2388"><a href="#cb247-2388" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-normal-02</span></span>
<span id="cb247-2389"><a href="#cb247-2389" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-2390"><a href="#cb247-2390" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb247-2391"><a href="#cb247-2391" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb247-2392"><a href="#cb247-2392" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung verschiedener relativer Effekte $p(a,b)$ für zwei Gruppen und einem normalverteilten Outcome $y$. Die eingefärbten Flächen dienen als Veranschaulichung. Die Flächen stellt die Wahrscheinlichkeit $p(a,b)$ als relativen Effekt dar.  **(A)** Die Gruppe A hat mit $\\bar{y}_A$ einen größeren Mittelwert als die Gruppe B mit $\\bar{y}_B$. Damit ist $p(A,B)$ aproximativ 0.2 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A gering. **(B)** Die Gruppe A und B haben fast den gleichen Mittelwert. Damit ist $p(A,B)$ aproximativ 0.5 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A gleich. **(C)** Die Gruppe A hat mit $\\bar{y}_A$ einen kleineren Mittelwert als die Gruppe B mit $\\bar{y}_B$. Damit ist $p(A,B)$ aproximativ 0.8 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A groß. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb247-2393"><a href="#cb247-2393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2394"><a href="#cb247-2394" aria-hidden="true" tabindex="-1"></a>gg_template <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb247-2395"><a href="#cb247-2395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  <span class="sc">+</span></span>
<span id="cb247-2396"><a href="#cb247-2396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb247-2397"><a href="#cb247-2397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>)) <span class="sc">+</span>   </span>
<span id="cb247-2398"><a href="#cb247-2398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb247-2399"><a href="#cb247-2399" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">4</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb247-2400"><a href="#cb247-2400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb247-2401"><a href="#cb247-2401" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb247-2402"><a href="#cb247-2402" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb247-2403"><a href="#cb247-2403" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb247-2404"><a href="#cb247-2404" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb247-2405"><a href="#cb247-2405" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb247-2406"><a href="#cb247-2406" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb247-2407"><a href="#cb247-2407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">""</span>)</span>
<span id="cb247-2408"><a href="#cb247-2408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2409"><a href="#cb247-2409" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb247-2410"><a href="#cb247-2410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb247-2411"><a href="#cb247-2411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb247-2412"><a href="#cb247-2412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb247-2413"><a href="#cb247-2413" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">4</span>), <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb247-2414"><a href="#cb247-2414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, , </span>
<span id="cb247-2415"><a href="#cb247-2415" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">4</span>),</span>
<span id="cb247-2416"><a href="#cb247-2416" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>),</span>
<span id="cb247-2417"><a href="#cb247-2417" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>)  <span class="sc">+</span></span>
<span id="cb247-2418"><a href="#cb247-2418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">15</span>), <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span> </span>
<span id="cb247-2419"><a href="#cb247-2419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>), </span>
<span id="cb247-2420"><a href="#cb247-2420" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(y)[A]), <span class="fu">expression</span>(<span class="fu">bar</span>(y)[B]))) <span class="sc">+</span></span>
<span id="cb247-2421"><a href="#cb247-2421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">8</span>, <span class="at">y =</span> <span class="fl">0.08</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(y)[A]<span class="sc">~</span><span class="st">"&lt;"</span><span class="sc">~</span><span class="fu">bar</span>(y)[B]), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb247-2422"><a href="#cb247-2422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">8</span>, <span class="at">y =</span> <span class="fl">0.06</span>, <span class="at">label =</span> <span class="fu">expression</span>(p[<span class="st">"(A,B)"</span>]<span class="sc">%~~%</span><span class="fl">0.8</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>)</span>
<span id="cb247-2423"><a href="#cb247-2423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2424"><a href="#cb247-2424" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb247-2425"><a href="#cb247-2425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb247-2426"><a href="#cb247-2426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb247-2427"><a href="#cb247-2427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb247-2428"><a href="#cb247-2428" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">4</span>), <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb247-2429"><a href="#cb247-2429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, , </span>
<span id="cb247-2430"><a href="#cb247-2430" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">4</span>),</span>
<span id="cb247-2431"><a href="#cb247-2431" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>),</span>
<span id="cb247-2432"><a href="#cb247-2432" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"#CC79A7"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb247-2433"><a href="#cb247-2433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">5</span>), <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span> </span>
<span id="cb247-2434"><a href="#cb247-2434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>), </span>
<span id="cb247-2435"><a href="#cb247-2435" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(y)[A]), <span class="fu">expression</span>(<span class="fu">bar</span>(y)[B]))) <span class="sc">+</span></span>
<span id="cb247-2436"><a href="#cb247-2436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">17</span>, <span class="at">y =</span> <span class="fl">0.08</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(y)[A]<span class="sc">~</span><span class="st">"&gt;"</span><span class="sc">~</span><span class="fu">bar</span>(y)[B]), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb247-2437"><a href="#cb247-2437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">17</span>, <span class="at">y =</span> <span class="fl">0.06</span>, <span class="at">label =</span> <span class="fu">expression</span>(p[<span class="st">"(A,B)"</span>]<span class="sc">%~~%</span><span class="fl">0.2</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>)</span>
<span id="cb247-2438"><a href="#cb247-2438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2439"><a href="#cb247-2439" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb247-2440"><a href="#cb247-2440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb247-2441"><a href="#cb247-2441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb247-2442"><a href="#cb247-2442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb247-2443"><a href="#cb247-2443" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">11</span>, <span class="at">sd =</span> <span class="dv">4</span>), <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb247-2444"><a href="#cb247-2444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, , </span>
<span id="cb247-2445"><a href="#cb247-2445" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">11</span>, <span class="at">sd =</span> <span class="dv">4</span>),</span>
<span id="cb247-2446"><a href="#cb247-2446" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>),</span>
<span id="cb247-2447"><a href="#cb247-2447" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"#009E73"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb247-2448"><a href="#cb247-2448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">11</span>), <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span> </span>
<span id="cb247-2449"><a href="#cb247-2449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">9.5</span>, <span class="fl">12.25</span>), </span>
<span id="cb247-2450"><a href="#cb247-2450" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(y)[A]), <span class="fu">expression</span>(<span class="fu">bar</span>(y)[B]))) <span class="sc">+</span></span>
<span id="cb247-2451"><a href="#cb247-2451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">17</span>, <span class="at">y =</span> <span class="fl">0.08</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(y)[A]<span class="sc">~</span><span class="st">"="</span><span class="sc">~</span><span class="fu">bar</span>(y)[B]), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb247-2452"><a href="#cb247-2452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">17</span>, <span class="at">y =</span> <span class="fl">0.06</span>, <span class="at">label =</span> <span class="fu">expression</span>(p[<span class="st">"(A,B)"</span>]<span class="sc">%~~%</span><span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>)</span>
<span id="cb247-2453"><a href="#cb247-2453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2454"><a href="#cb247-2454" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> p3 <span class="sc">+</span> p1 <span class="sc">+</span></span>
<span id="cb247-2455"><a href="#cb247-2455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb247-2456"><a href="#cb247-2456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb247-2457"><a href="#cb247-2457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb247-2458"><a href="#cb247-2458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb247-2459"><a href="#cb247-2459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2460"><a href="#cb247-2460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2461"><a href="#cb247-2461" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktorielle Analyse</span></span>
<span id="cb247-2462"><a href="#cb247-2462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2463"><a href="#cb247-2463" aria-hidden="true" tabindex="-1"></a>In dem Paket <span class="in">`{naprcomp}`</span> können wir nur eine einfaktorielle Analyse rechnen. Da ist hier nochmal wichtig zu wissen. Sonst musst du dir die Arbeit nicht machen. Wir müssen einiges Einstellen bei der gleichnamigen Hauptfunktion <span class="in">`nparcomp()`</span> aber dann funktioniert alles relativ reibungslos. Das Paket ist schon älter und hat damit nicht die Funktionalität des <span class="in">`{tidyverse}`</span> oder anderen Paketen. Hier sieht man dann auch, dass <span class="in">`{naprcomp}`</span> nicht so oft genutzt wird, denn ansonsten wäre ja auch der Bedarf einer besseren Integration dar. Aber das lassen wir mal so im Raum stehen.</span>
<span id="cb247-2464"><a href="#cb247-2464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2465"><a href="#cb247-2465" aria-hidden="true" tabindex="-1"></a>:::: panel-tabset</span>
<span id="cb247-2466"><a href="#cb247-2466" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte</span></span>
<span id="cb247-2467"><a href="#cb247-2467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2468"><a href="#cb247-2468" aria-hidden="true" tabindex="-1"></a>Leider hat die Funktion <span class="in">`nparcomp()`</span> einem sehr viele Informationen auf der R Konsole auszugeben auch wenn man das nicht will und es einen eigentlich mehr verwirrt als gutes tut. Deshalb stelle ich immer die Option <span class="in">`info = FALSE`</span> ein. Wir wollen eigentlich immer alle Gruppen miteinander vergleichen, so dass wir als Option <span class="in">`type = "Tukey"`</span> nehmen. Achtung, das hat jetzt *nichts* mit dem Tukey HSD Test zu tun. Wir müssen uns dann auch noch aus der Ausgabe den Teil rausziehen, denn wir dann brauchen.</span>
<span id="cb247-2469"><a href="#cb247-2469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2472"><a href="#cb247-2472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2473"><a href="#cb247-2473" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="ot">&lt;-</span> <span class="fu">nparcomp</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, <span class="at">type =</span> <span class="st">"Tukey"</span>, </span>
<span id="cb247-2474"><a href="#cb247-2474" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info =</span> <span class="cn">FALSE</span>)</span>
<span id="cb247-2475"><a href="#cb247-2475" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="sc">|&gt;</span> <span class="fu">pluck</span>(<span class="st">"Analysis"</span>)</span>
<span id="cb247-2476"><a href="#cb247-2476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2477"><a href="#cb247-2477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2478"><a href="#cb247-2478" aria-hidden="true" tabindex="-1"></a>Was wir eigentlich brauchen ist der p-Wert in der letzten Spalte. Spannend ist hier, dass <span class="in">`nparcomp()`</span> den Vergleich von Hunde- und Katzenflöhen nicht als signifikant findet. Das ist eine Folge davon, dass <span class="in">`nparcomp()`</span> etwas konservativer ist als die anderen hier vorgestellten Verfahren. Wenn du nochmal nachvollziehen willst, wie der relative Effekt <span class="in">`Estimator`</span> zu interpretieren ist, habe ich dir nochmal im folgenden eine zusammenfassende Tabelle mit den Mittelwerten der einzelnen Gruppen gebaut. Für mich ist der Wert immer noch von hinten durch die Brust. Leider hat der relative Effekt keinen Bezug zur biologischen Einheit der Messwerte. Deshalb ist die Interpretation im günstigsten Fall schwierig.</span>
<span id="cb247-2479"><a href="#cb247-2479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2480"><a href="#cb247-2480" aria-hidden="true" tabindex="-1"></a>| Vergleich | Relativer Effekt |</span>
<span id="cb247-2481"><a href="#cb247-2481" aria-hidden="true" tabindex="-1"></a>|:--:|:--:|</span>
<span id="cb247-2482"><a href="#cb247-2482" aria-hidden="true" tabindex="-1"></a>| $\bar{y}_{cat} \stackrel{?}{&gt;} \bar{y}_{dog}$ | $4.74 \stackrel{?}{&gt;} 8.13 \rightarrow p(dog, cat) = 0.102$ |</span>
<span id="cb247-2483"><a href="#cb247-2483" aria-hidden="true" tabindex="-1"></a>| $\bar{y}_{fox} \stackrel{?}{&gt;} \bar{y}_{dog}$ | $9.16 \stackrel{?}{&gt;} 8.13 \rightarrow p(dog, fox) = 0.684$ |</span>
<span id="cb247-2484"><a href="#cb247-2484" aria-hidden="true" tabindex="-1"></a>| $\bar{y}_{fox} \stackrel{?}{&gt;} \bar{y}_{cat}$ | $4.74 \stackrel{?}{&gt;} 9.16 \rightarrow p(cat, fox) = 0.980$ |</span>
<span id="cb247-2485"><a href="#cb247-2485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2486"><a href="#cb247-2486" aria-hidden="true" tabindex="-1"></a>: Interpretation des relativen Effektes $p(a,b)$ am Beispiel der Sprungweiten der Flöhe. Je größer der relative Effekt $p(a,b)$ desto wahrscheinlicher ist es größere Werte in $b$ als in $a$ zu beobachten. {#tbl-nparcomp-pval}</span>
<span id="cb247-2487"><a href="#cb247-2487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2488"><a href="#cb247-2488" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact letter display*</span></span>
<span id="cb247-2489"><a href="#cb247-2489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2490"><a href="#cb247-2490" aria-hidden="true" tabindex="-1"></a>Für das *Compact letter display* brauchen wir wieder einmal das Objekt einer <span class="in">`nparcomp()`</span> Analyse. Wir nutzen hier den gleichen Aufruf wie schon bei den p-Werten. Die Optionen sind damit die gleichen wie im Tab zu den p-Werten. Wir sind jetzt aber nur an den reinen p-Werten interessiert und nicht an den relativen Effekten.</span>
<span id="cb247-2491"><a href="#cb247-2491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2494"><a href="#cb247-2494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2495"><a href="#cb247-2495" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="ot">&lt;-</span> <span class="fu">nparcomp</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, <span class="at">type =</span> <span class="st">"Tukey"</span>, </span>
<span id="cb247-2496"><a href="#cb247-2496" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info =</span> <span class="cn">FALSE</span>)</span>
<span id="cb247-2497"><a href="#cb247-2497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2498"><a href="#cb247-2498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2499"><a href="#cb247-2499" aria-hidden="true" tabindex="-1"></a>Leider ist es so, dass <span class="in">`{nparcomp}`</span> nicht für die Erstellung des *Compact letter displays* optimiert ist. Daher müssen wir uns erst einen Vektor für die Vergleiche mit einem Minuszeichen ohne Leerzeichen bauen.</span>
<span id="cb247-2500"><a href="#cb247-2500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2503"><a href="#cb247-2503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2504"><a href="#cb247-2504" aria-hidden="true" tabindex="-1"></a>contrast_vec <span class="ot">&lt;-</span> nparcomp_fac1_res <span class="sc">|&gt;</span>   </span>
<span id="cb247-2505"><a href="#cb247-2505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Contrast"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-2506"><a href="#cb247-2506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row.names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb247-2507"><a href="#cb247-2507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)</span>
<span id="cb247-2508"><a href="#cb247-2508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2509"><a href="#cb247-2509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2510"><a href="#cb247-2510" aria-hidden="true" tabindex="-1"></a>Wenn wir die Namen der Vergleiche haben, können wir uns die p-Werte aus dem <span class="in">`nparcomp()`</span> Objekt ziehen und entsprechend dem Vergleich benennen.</span>
<span id="cb247-2511"><a href="#cb247-2511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2514"><a href="#cb247-2514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2515"><a href="#cb247-2515" aria-hidden="true" tabindex="-1"></a>adj_p_values_vec <span class="ot">&lt;-</span> nparcomp_fac1_res <span class="sc">|&gt;</span>   </span>
<span id="cb247-2516"><a href="#cb247-2516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Analysis"</span>, <span class="st">"p.Value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-2517"><a href="#cb247-2517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(contrast_vec)</span>
<span id="cb247-2518"><a href="#cb247-2518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2519"><a href="#cb247-2519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2520"><a href="#cb247-2520" aria-hidden="true" tabindex="-1"></a>Abschließend können wir uns dann mit der Funktion <span class="in">`multcompLetters()`</span> das *Compact letter display* wiedergeben lassen.</span>
<span id="cb247-2521"><a href="#cb247-2521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2524"><a href="#cb247-2524" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2525"><a href="#cb247-2525" aria-hidden="true" tabindex="-1"></a>adj_p_values_vec <span class="sc">|&gt;</span> <span class="fu">multcompLetters</span>() </span>
<span id="cb247-2526"><a href="#cb247-2526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2527"><a href="#cb247-2527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2528"><a href="#cb247-2528" aria-hidden="true" tabindex="-1"></a>Hier ist der Weg etwas länger aber wenn wir uns nur auf das *Compact letter displays* konzentrieren liefert `{nparcomp}` in einem einfaktoriellen Fall eigentlich alles was wir brauchen. Hier unterscheidet sich das *Compact letter display* von den anderen Analysen, da wir hier auch etwas andere p-Werte erhalten.</span>
<span id="cb247-2529"><a href="#cb247-2529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2530"><a href="#cb247-2530" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall</span></span>
<span id="cb247-2531"><a href="#cb247-2531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2532"><a href="#cb247-2532" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb247-2533"><a href="#cb247-2533" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01_small.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb247-2534"><a href="#cb247-2534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2535"><a href="#cb247-2535" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Ja, die 95% Konfidenzintervalle und </span><span class="in">`{nparcomp}`</span><span class="at">, eine für mich schwierige Sache. Eigentlich liefern die 95% Konfidenzintervalle in </span><span class="in">`{nparcomp}`</span><span class="at"> nicht so richtig was wir eigentlich wollen. Nämlich eine biologisch zu interpretierende Relevanz und Signifikanz. Die relativen Effekte $p(a,b)$ aus der Funktion </span><span class="in">`nparcomp()`</span><span class="at"> sind eben dann doch wieder nur Wahrscheinlichkeiten.</span></span>
<span id="cb247-2536"><a href="#cb247-2536" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb247-2537"><a href="#cb247-2537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2538"><a href="#cb247-2538" aria-hidden="true" tabindex="-1"></a>Wenn du die 95% Konfidenzintervalle brauchst, dann kannst du die Funktion <span class="in">`nparcomp()`</span> wie in den Tab zu den p-Werten nutzen. Hier ändert sich nichts bei dem Funktionsaufruf. Praktischerweise liefert dir die Ausgabe von <span class="in">`nparcomp()`</span> auch gleich die 95% Konfidenzintervalle mit.</span>
<span id="cb247-2539"><a href="#cb247-2539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2542"><a href="#cb247-2542" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2543"><a href="#cb247-2543" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="ot">&lt;-</span> <span class="fu">nparcomp</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, <span class="at">type =</span> <span class="st">"Tukey"</span>, </span>
<span id="cb247-2544"><a href="#cb247-2544" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info =</span> <span class="cn">FALSE</span>)</span>
<span id="cb247-2545"><a href="#cb247-2545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2546"><a href="#cb247-2546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2547"><a href="#cb247-2547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2548"><a href="#cb247-2548" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du dann einmal die 95% Konfidenzintervalle visualisiert. Durch die Eigenschaft des relativen Effekt eine Wahrscheinlichkeit zu sein, hast du die Begrenzungen von $<span class="co">[</span><span class="ot">0, 1</span><span class="co">]</span>$ und damit dann auch keine symmetrischen 95% Konfidenzintervalle mehr. Die Entscheidung gegen die Nullhypothese liegt bei $p(a,b) = 0.5$.</span>
<span id="cb247-2549"><a href="#cb247-2549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2552"><a href="#cb247-2552" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2553"><a href="#cb247-2553" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb247-2554"><a href="#cb247-2554" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb247-2555"><a href="#cb247-2555" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb247-2556"><a href="#cb247-2556" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb247-2557"><a href="#cb247-2557" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb247-2558"><a href="#cb247-2558" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb247-2559"><a href="#cb247-2559" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe aus dem R Paket `{nparcomp}` Der relative Effekt ist eine Wahrscheinlichkeit, daher die Begrenzungen bei $[0, 1]$. Die Entscheidung gegen die Nullhypothese liegt bei $p(a,b) = 0.5$."</span></span>
<span id="cb247-2560"><a href="#cb247-2560" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-nparcomp-1</span></span>
<span id="cb247-2561"><a href="#cb247-2561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2562"><a href="#cb247-2562" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nparcomp_fac1_res<span class="sc">$</span>Analysis, </span>
<span id="cb247-2563"><a href="#cb247-2563" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(Comparison, <span class="at">y =</span> Estimator, <span class="at">ymin =</span> Lower, <span class="at">ymax =</span> Upper)) <span class="sc">+</span></span>
<span id="cb247-2564"><a href="#cb247-2564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb247-2565"><a href="#cb247-2565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb247-2566"><a href="#cb247-2566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb247-2567"><a href="#cb247-2567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb247-2568"><a href="#cb247-2568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb247-2569"><a href="#cb247-2569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb247-2570"><a href="#cb247-2570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Relativer Effekt"</span>)</span>
<span id="cb247-2571"><a href="#cb247-2571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2572"><a href="#cb247-2572" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb247-2573"><a href="#cb247-2573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2574"><a href="#cb247-2574" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktorielle Analyse</span></span>
<span id="cb247-2575"><a href="#cb247-2575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2576"><a href="#cb247-2576" aria-hidden="true" tabindex="-1"></a>Eine zweifaktorielle Analyse ist in dem Paket <span class="in">`{nparcomp}`</span> nicht möglich. Damit war das hier viel Arbeit für mich für vermutlich nicht viel für dich. Dafür habe ich aber eine Menge über <span class="in">`{nparcomp}`</span> gelernt und du musst dich dafür nicht durch das sehr mathematische Paper von @konietschke2015nparcomp quälen. Denn in den Agrarwissenschaften haben wir eigentlich immer ein zweifaktorielles Modell und selten nur ein Modell mit einem Faktor vorliegen. Daher ist dieses Paket auch hier unten im Kapitel eingeordnet und würde ich nicht empfehlen.</span>
<span id="cb247-2577"><a href="#cb247-2577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2578"><a href="#cb247-2578" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Dinge von Interesse</span></span>
<span id="cb247-2579"><a href="#cb247-2579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2580"><a href="#cb247-2580" aria-hidden="true" tabindex="-1"></a>Es gibt immer wieder Dinge von Interesse, die ich im Rahmen der multiplen Vergleiche oder Post-hoc Tests so finde. Meistens ist es dann nicht so wichtig, dass ich es in den obigen Abschnitten noch einbauen möchte. Auf der anderen Seite will ich es dann aber auch nicht vergessen, so dass es eben hier steht. SO kannst du über die Suchfunktion noch Sachen finden, die ich dann eben hier parke. Du kannst es nutzen und manchmal ist es dann auch nützlich.</span>
<span id="cb247-2581"><a href="#cb247-2581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2582"><a href="#cb247-2582" aria-hidden="true" tabindex="-1"></a><span class="fu">### Friedhof der Post-hoc Tests {#sec-friedhof-posthoc}</span></span>
<span id="cb247-2583"><a href="#cb247-2583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2584"><a href="#cb247-2584" aria-hidden="true" tabindex="-1"></a>Hier gebe ich eine -- nicht vollständige -- Liste an Post-hoc Tests, die es einmal gab und auch noch erwähnt werden, aber dann eigentlich alle irgendwie veraltet sind. Wie immer sind diese Tests nicht per se schlecht. Aber es gibt dann eben besseres. Die Daumenregel lautet dabei, dass es <span class="in">`{emmeans}`</span> oder <span class="in">`{multcomp}`</span> besser können. Zwei Übersichtsarbeiten helfen hier nochmal Ordnung in das Dickicht der multiplen Vergleiche zu bringen. Einmal die Arbeit <span class="co">[</span><span class="ot">On the use of post-hoc tests in environmental and biological sciences: A critical review</span><span class="co">](https://www.sciencedirect.com/science/article/pii/S2405844024011629)</span> von @agbangba2024use sowie die Veröffentlichung <span class="co">[</span><span class="ot">A discussion and evaluation of statistical procedures used by JIMB authors when comparing means</span><span class="co">](https://pmc.ncbi.nlm.nih.gov/articles/PMC10845891/)</span> von @klasson2024discussion. Im Folgenden bieten sich zwei Pakete an die etwas älteren Post-hoc Tests zu rechnen. Zum einen das Paket <span class="in">`{descTools}`</span>, welches einfacher zu bedienen ist und auch mal zweifaktoriell rechnen kann oder das R Paket <span class="in">`{agricolae}`</span>, was den Fokus auf ein einfaktorielles Design hat aber dafür direkt das *Compact letter display* ohne p-Werte wiedergibt. Ich verzichte hier auch auf die händische Herleitung, auch wenn es gerade bei den älteren Anwendungen auch möglich ist, aber wir wollen diese Tests eigentlich nicht mehr nutzen.</span>
<span id="cb247-2585"><a href="#cb247-2585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2586"><a href="#cb247-2586" aria-hidden="true" tabindex="-1"></a>LSD Test oder auch *Fisher\`s least Significant Difference (LSD)*</span>
<span id="cb247-2587"><a href="#cb247-2587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2588"><a href="#cb247-2588" aria-hidden="true" tabindex="-1"></a>:   Der LSD Test ist veraltet. Was überhaupt gegen die Nutzung des LSD Test spricht ist, das der LSD Test das Signifikanzniveau $\alpha$ von 5% über alle Vergleiche nicht einhälst. Sie dazu auch @agbangba2024use mit der klaren Aussage: *"LSD does not control for family-wise type I error".* Die einzige Ausnahme ist der seltene Fall, dass du dir nur drei Behandlungsgruppen anschaust, wie von @klasson2024discussion diskutiert. Aber am Ende ich kann den LSD Test nicht empfehlen.</span>
<span id="cb247-2589"><a href="#cb247-2589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2590"><a href="#cb247-2590" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-2591"><a href="#cb247-2591" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{DescTools}`</span></span>
<span id="cb247-2592"><a href="#cb247-2592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2593"><a href="#cb247-2593" aria-hidden="true" tabindex="-1"></a>In dem R Paket <span class="in">`{descTools}`</span> kannst du den LSD Test einmal einfaktoriell rechnen, wie in dem folgenden Modell. Bitte beachte immer, das wir nicht für das multiple Testen adjustieren. Daher kann es dann zu Abweichungen zu anderen Post-hoc Tests kommen. Hier aber erstmal die einfaktorielle ANOVA.</span>
<span id="cb247-2594"><a href="#cb247-2594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2597"><a href="#cb247-2597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2598"><a href="#cb247-2598" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb247-2599"><a href="#cb247-2599" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2600"><a href="#cb247-2600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2601"><a href="#cb247-2601" aria-hidden="true" tabindex="-1"></a>Ebenso kannst du eine zweifaktorielle ANOVA nutzen. Hier ist die Herausforderung dann die p-Werte zu extrahieren und das *Compact letter display* zu berechnen. Wir können dann das Modell in die Funktion <span class="in">`PostHocTest()`</span> stecken und dann einmal mit der Option <span class="in">`method = "lsd"`</span> den entsprechenden Test auswählen.</span>
<span id="cb247-2602"><a href="#cb247-2602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2605"><a href="#cb247-2605" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2606"><a href="#cb247-2606" aria-hidden="true" tabindex="-1"></a>lsd_obj <span class="ot">&lt;-</span> <span class="fu">PostHocTest</span>(fac1_av, <span class="at">method =</span> <span class="st">"lsd"</span>)</span>
<span id="cb247-2607"><a href="#cb247-2607" aria-hidden="true" tabindex="-1"></a>lsd_obj</span>
<span id="cb247-2608"><a href="#cb247-2608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2609"><a href="#cb247-2609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2610"><a href="#cb247-2610" aria-hidden="true" tabindex="-1"></a>Und dann können wir uns auch mit einer leichten Umgehung auch das *Compact letter display* erstellen lassen. Leider ist das immer etwas schwieriger, wenn die Ausgabe der Funktion nicht so richtig zu den der *Compact letter display* passt. Wir nutzen hier explizit die Funktion <span class="in">`extract()`</span> aus dem R Paket <span class="in">`{magrittr}`</span>. Bei dir heißt aber die Variable <span class="in">`"animal"`</span> der Behandlung natürlich anders.</span>
<span id="cb247-2611"><a href="#cb247-2611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2614"><a href="#cb247-2614" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2615"><a href="#cb247-2615" aria-hidden="true" tabindex="-1"></a>lsd_obj <span class="sc">|&gt;</span></span>
<span id="cb247-2616"><a href="#cb247-2616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"animal"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-2617"><a href="#cb247-2617" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract</span>(, <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-2618"><a href="#cb247-2618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span>
<span id="cb247-2619"><a href="#cb247-2619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2620"><a href="#cb247-2620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2621"><a href="#cb247-2621" aria-hidden="true" tabindex="-1"></a>Im zweifaktoriellen Fall würde ich dir aber eher <span class="in">`{emmeans}`</span> empfehlen, da du dort besser und leichter an das *Compact letter display* kommst.</span>
<span id="cb247-2622"><a href="#cb247-2622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2623"><a href="#cb247-2623" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{agricolae}`</span></span>
<span id="cb247-2624"><a href="#cb247-2624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2625"><a href="#cb247-2625" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{agricolae}`</span> erlaubt auch einen LSD Test zu rechnen. Wir brauchen nur das Modell einer einfaktoriellen ANOVA und können dann damit weiterrechnen. Ein zweiter Faktor ist in <span class="in">`{agricolae}`</span> nicht möglich und wird ohne Fehlermeldung einfach von der Funktion ignoriert.</span>
<span id="cb247-2626"><a href="#cb247-2626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2629"><a href="#cb247-2629" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2630"><a href="#cb247-2630" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb247-2631"><a href="#cb247-2631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2632"><a href="#cb247-2632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2633"><a href="#cb247-2633" aria-hidden="true" tabindex="-1"></a>Witzigerweise gibt die Funktion *von alleine* keine Ausgabe wieder. Wie wild dieses Verhalten einer Funktion ist, kann ich gar nicht ausdrücken. Wichtig ist hier, dass wir nur das *Compact letter display* wiedergegeben bekommen aber keine p-Werte für die paarweisen Vergleiche.</span>
<span id="cb247-2634"><a href="#cb247-2634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2637"><a href="#cb247-2637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2638"><a href="#cb247-2638" aria-hidden="true" tabindex="-1"></a><span class="fu">LSD.test</span>(fac1_av, <span class="at">trt =</span> <span class="st">"animal"</span>, <span class="at">p.adj =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-2639"><a href="#cb247-2639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"groups"</span>)</span>
<span id="cb247-2640"><a href="#cb247-2640" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2641"><a href="#cb247-2641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2642"><a href="#cb247-2642" aria-hidden="true" tabindex="-1"></a>Wenn du p-Werte brauchst oder ein zweifaktorielles Design vorliegen hast, dann nutze bitte die Funktionen aus dem R Paket <span class="in">`descTools`</span> oder eben gleich <span class="in">`{emmeans}`</span>, was einfach das bessere Paket ist.</span>
<span id="cb247-2643"><a href="#cb247-2643" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-2644"><a href="#cb247-2644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2645"><a href="#cb247-2645" aria-hidden="true" tabindex="-1"></a>Scheffé Test</span>
<span id="cb247-2646"><a href="#cb247-2646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2647"><a href="#cb247-2647" aria-hidden="true" tabindex="-1"></a>:   Der Scheffé Test ist im Prinzipn eng mit dem Tukey HSD Test verwandt. Was aber @agbangba2024use anmerkt ist, dass *"the test is too conservative compared to methods like Tukey’s HSD"*. Aus dem Grund würde ich den Test nicht empfehlen. Auch testet der Scheffé Test mehr Vergleiche als du meistens möchtest. Es ist eben nicht ein reiner *all-pair* Vergleich sondern testet auch noch alle anderen möglichen Kombinationen der Mittelwerte.</span>
<span id="cb247-2648"><a href="#cb247-2648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2649"><a href="#cb247-2649" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-2650"><a href="#cb247-2650" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{DescTools}`</span></span>
<span id="cb247-2651"><a href="#cb247-2651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2652"><a href="#cb247-2652" aria-hidden="true" tabindex="-1"></a>Wir können den Scheffé Test im R Paket <span class="in">`{DescTools}`</span> mit der Funktion <span class="in">`ScheffeTest()`</span> finden. Wir könnten auch die Funktion <span class="in">`PostHocTest()`</span> nutzen und die Option <span class="in">`method = "scheffe"`</span> wählen. Wir nutzen wieder das Modell aus der ANOVA, ob nun einfaktoriell oder zweifaktoriell, um dann den Scheffé Test zu rechnen. Ich zeige hier einmal die einfaktorielle Variante.</span>
<span id="cb247-2653"><a href="#cb247-2653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2656"><a href="#cb247-2656" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2657"><a href="#cb247-2657" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb247-2658"><a href="#cb247-2658" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2659"><a href="#cb247-2659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2660"><a href="#cb247-2660" aria-hidden="true" tabindex="-1"></a>Dann brauchen wir nur noch die Funktion <span class="in">`ScheffeTest`</span> aufrufen. Ich ziehe mir hier gleich mit der Funktion <span class="in">`pluck()`</span> die notwendigen Informationen direkt raus. Deine Gruppenspalte in deinen Daten heißt ja anders, deshalb musst du dann <span class="in">`"animal"`</span> entsprechend durch deinen Variablennamen ersetzen. Beachte, dass du hier adjustierte p-Werte wiedergegeben bekommst.</span>
<span id="cb247-2661"><a href="#cb247-2661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2664"><a href="#cb247-2664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2665"><a href="#cb247-2665" aria-hidden="true" tabindex="-1"></a>scheffe_obj <span class="ot">&lt;-</span> <span class="fu">ScheffeTest</span>(fac1_av) <span class="sc">|&gt;</span> <span class="fu">pluck</span>(<span class="st">"animal"</span>)</span>
<span id="cb247-2666"><a href="#cb247-2666" aria-hidden="true" tabindex="-1"></a>scheffe_obj</span>
<span id="cb247-2667"><a href="#cb247-2667" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2668"><a href="#cb247-2668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2669"><a href="#cb247-2669" aria-hidden="true" tabindex="-1"></a>Und dann können wir uns auch mit einer leichten Umgehung auch das *Compact letter display* erstellen lassen. Leider ist das immer etwas schwieriger, wenn die Ausgabe der Funktion nicht so richtig zu den der *Compact letter display* passt. Wir nutzen hier explizit die Funktion <span class="in">`extract()`</span> aus dem R Paket <span class="in">`{magrittr}`</span>.</span>
<span id="cb247-2670"><a href="#cb247-2670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2673"><a href="#cb247-2673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2674"><a href="#cb247-2674" aria-hidden="true" tabindex="-1"></a>scheffe_obj <span class="sc">|&gt;</span> </span>
<span id="cb247-2675"><a href="#cb247-2675" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">extract</span>(, <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb247-2676"><a href="#cb247-2676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span>
<span id="cb247-2677"><a href="#cb247-2677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2678"><a href="#cb247-2678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2679"><a href="#cb247-2679" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{agricolae}`</span></span>
<span id="cb247-2680"><a href="#cb247-2680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2681"><a href="#cb247-2681" aria-hidden="true" tabindex="-1"></a>Wir können auch den Scheffé Test in dem R Paket <span class="in">`{agricolae}`</span> rechnen. Dafür brauchen wir wieder ein einfaktorielles Modell. Wir können kein zweifaktorielles rechnen, sondern eben nur für einen Behandlungsfaktor. Deshalb hier einmal das ANOVA Modell.</span>
<span id="cb247-2682"><a href="#cb247-2682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2685"><a href="#cb247-2685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2686"><a href="#cb247-2686" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb247-2687"><a href="#cb247-2687" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2688"><a href="#cb247-2688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2689"><a href="#cb247-2689" aria-hidden="true" tabindex="-1"></a>Dann können wir de Funktion <span class="in">`scheffe.test()`</span> nutzen. Auch hier erhalten wir keine Ausgabe sondern müssen die Ausgabe selber anfordern. Wir schauen hier direkt das *Compact letter display* an. Wir erhlaten keine p-Werte aus der Funktion.</span>
<span id="cb247-2690"><a href="#cb247-2690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2693"><a href="#cb247-2693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2694"><a href="#cb247-2694" aria-hidden="true" tabindex="-1"></a><span class="fu">scheffe.test</span>(fac1_av, <span class="at">trt =</span> <span class="st">"animal"</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb247-2695"><a href="#cb247-2695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"groups"</span>)</span>
<span id="cb247-2696"><a href="#cb247-2696" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2697"><a href="#cb247-2697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2698"><a href="#cb247-2698" aria-hidden="true" tabindex="-1"></a>Wenn du p-Werte brauchst oder ein zweifaktorielles Design vorliegen hast, dann nutze bitte die Funktionen aus dem R Paket <span class="in">`descTools`</span> oder eben gleich <span class="in">`{emmeans}`</span>, was einfach das bessere Paket ist.</span>
<span id="cb247-2699"><a href="#cb247-2699" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-2700"><a href="#cb247-2700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2701"><a href="#cb247-2701" aria-hidden="true" tabindex="-1"></a><span class="fu">### Re-engineering des *Compact letter displays*</span></span>
<span id="cb247-2702"><a href="#cb247-2702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2703"><a href="#cb247-2703" aria-hidden="true" tabindex="-1"></a>In dem kurzen Kapitel zu <span class="co">[</span><span class="ot">Re-engineering CLDs</span><span class="co">](https://cran.r-project.org/web/packages/emmeans/vignettes/re-engineering-clds.html)</span> in der Vingette des R Pakets <span class="in">`{emmeans}`</span> geht es darum, wie das *Compact letter display* auch anders gebaut werden könnte. Nämlich einmal als wirkliches Anzeigen von Gleichheit über die Option <span class="in">`delta`</span> oder aber über das Anzeigen von Signifikanz über die Option <span class="in">`signif`</span>. Damit haben dann auch wirklich die Information, die wir dann wollen. Also eigentlich was Schönes. Wie machen wir das nun?</span>
<span id="cb247-2704"><a href="#cb247-2704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2705"><a href="#cb247-2705" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-2706"><a href="#cb247-2706" aria-hidden="true" tabindex="-1"></a><span class="fu">## Delta Methode</span></span>
<span id="cb247-2707"><a href="#cb247-2707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2708"><a href="#cb247-2708" aria-hidden="true" tabindex="-1"></a>Wenn wir das *Cact letter display* in dem Sinne der Gleichheit der Behandlungen interpretieren wollen, also das der gleiche Buchstabe bedeutet, dass sich die Behandlungen nicht unterscheiden, dann müssen wir ein <span class="in">`delta`</span> setzen in deren Bandbreite oder Intervall die Behandlungen gleich sind. Ich habe hier mal ein <span class="in">`delta`</span> von 4cm gewählt und wir adjustieren bei einem Test auf Gleichheit nicht.</span>
<span id="cb247-2709"><a href="#cb247-2709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2712"><a href="#cb247-2712" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2713"><a href="#cb247-2713" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span></span>
<span id="cb247-2714"><a href="#cb247-2714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span></span>
<span id="cb247-2715"><a href="#cb247-2715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>, <span class="at">delta =</span> <span class="dv">4</span>)</span>
<span id="cb247-2716"><a href="#cb247-2716" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2717"><a href="#cb247-2717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2718"><a href="#cb247-2718" aria-hidden="true" tabindex="-1"></a>Wie wir jetzt sehen, bedeuten gleiche Buchstaben, dass die Behandlungen gleich sind. In dem Sinne gleich sind, dass die Behandlungen im Mittel nicht weiter als der Wert in <span class="in">`delta`</span> auseinanderliegen. Wie du jetzt das <span class="in">`delta`</span> bestimmst ist eine biologische und keine statistische Frage.</span>
<span id="cb247-2719"><a href="#cb247-2719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2720"><a href="#cb247-2720" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unterschied anzeigen</span></span>
<span id="cb247-2721"><a href="#cb247-2721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2722"><a href="#cb247-2722" aria-hidden="true" tabindex="-1"></a>Können wir uns auch signifikante Unterschiede anzeigen lassen? Ja, können wir auch, aber das ist meiner Meinung nach die schlechtere der beiden Anpassungen. Wir haben ja im Kopf, dass das *Compact letter display* eben mit gleichen Buchstaben das Gleiche anzeigt. Jetzt würden wir diese Eigenschaften zu Unterschied ändern. Schauen wir uns das einmal an einem kleineren Datensatz einmal an.</span>
<span id="cb247-2723"><a href="#cb247-2723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2724"><a href="#cb247-2724" aria-hidden="true" tabindex="-1"></a>Dann können wir uns hier einmal das Problem mit den Buchstaben anschauen. Wir kriegen jetzt mit der Option <span class="in">`signif = TRUE`</span> wiedergeben <span class="in">`Estimates sharing the same symbol are significantly different`</span> und das ist irgendwie auch wirr, dass *gleiche* Buchstaben einen Unterschied darstellen. Das *Compact letter display* wird eben als Gleichheit gelesen, so dass wir hier mehr verwirrt werden als es hilft.</span>
<span id="cb247-2725"><a href="#cb247-2725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2728"><a href="#cb247-2728" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2729"><a href="#cb247-2729" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb247-2730"><a href="#cb247-2730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span></span>
<span id="cb247-2731"><a href="#cb247-2731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>, <span class="at">signif =</span> <span class="cn">TRUE</span>)</span>
<span id="cb247-2732"><a href="#cb247-2732" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2733"><a href="#cb247-2733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2734"><a href="#cb247-2734" aria-hidden="true" tabindex="-1"></a>Deshalb würde ich auf die Buchstaben verzichten und die Zahlen angeben, damit hier nicht noch mehr Verwirrung aufkommt. Wir nehmen also die Option für die Buchstaben einmal aus dem <span class="in">`cld()`</span> Aufruf raus. Dann haben wir Zahlen als Gruppenzuweisung, was schon mal was anderes ist als die Buchstaben aus dem *Compact letter display*.</span>
<span id="cb247-2735"><a href="#cb247-2735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2738"><a href="#cb247-2738" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2739"><a href="#cb247-2739" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb247-2740"><a href="#cb247-2740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span></span>
<span id="cb247-2741"><a href="#cb247-2741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>, <span class="at">signif =</span> <span class="cn">TRUE</span>)</span>
<span id="cb247-2742"><a href="#cb247-2742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2743"><a href="#cb247-2743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2744"><a href="#cb247-2744" aria-hidden="true" tabindex="-1"></a>Innerhalb des selben Konzepts dann zwei Arten von Interpretation des *Compact letter display* zu haben, ist dann auch nicht zielführend. Den auch die *gleichen* Zahlen bedeuten jetzt einen Unterschied. Irgendwie mag ich persönlich nicht diese sehr verdrehte Interpretation nicht. Deshalb lieber ein <span class="in">`delta`</span> einführen und auf echte Gleichheit testen.</span>
<span id="cb247-2745"><a href="#cb247-2745" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-2746"><a href="#cb247-2746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2747"><a href="#cb247-2747" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modellierung von Varianzheterogenität {#sec-posthoc-var-heterogen}</span></span>
<span id="cb247-2748"><a href="#cb247-2748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2749"><a href="#cb247-2749" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel modelliere ich ja immer die Varianzheterogenität, wenn ich das kann. Es gibt aber eine Reihe von Möglichkeiten die Adjustierung durchzuführen. In den folgenden Tabs findest du dann noch andere Ideen und Anregungen. Ich muss hier nochmal aufräumen, aber wie immer, wenn es nicht dringlich ist, dann lagere ich es hier lieber. Es es bestimmt nochmal nützlich.</span>
<span id="cb247-2750"><a href="#cb247-2750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2751"><a href="#cb247-2751" aria-hidden="true" tabindex="-1"></a>Wenn du noch etwas weiter gehen möchtest, dann kannst du dir noch die Hilfeseite von dem R Paket <span class="in">`{performance}`</span> <span class="co">[</span><span class="ot">Robust Estimation of Standard Errors, Confidence Intervals, and p-values</span><span class="co">](https://easystats.github.io/parameters/articles/model_parameters_robust.html?q=Heteroskedasticity#robust-covariance-matrix-estimation-from-model-parameters)</span> anschauen. Die Idee ist hier, dass wir die Varianz/Kovarianz robuster daher mit der Berücksichtigung von Varianzheterogenität (eng. *heteroskedasticity*) schätzen.</span>
<span id="cb247-2752"><a href="#cb247-2752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2753"><a href="#cb247-2753" aria-hidden="true" tabindex="-1"></a>Hier also jetzt einmal eine Übersicht über die Möglichkeiten mit der Varianzheterogenität in Behandlungsgruppen umzugehen.</span>
<span id="cb247-2754"><a href="#cb247-2754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2755"><a href="#cb247-2755" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb247-2756"><a href="#cb247-2756" aria-hidden="true" tabindex="-1"></a><span class="fu">## Generalized Least Squares</span></span>
<span id="cb247-2757"><a href="#cb247-2757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2758"><a href="#cb247-2758" aria-hidden="true" tabindex="-1"></a>Neben dem Games Howell Test gibt es auch die Möglichkeit *Generalized Least Squares* zu nutzen. Hier haben wir dann auch die Möglichkeit mehrfaktorielle Modelle zu schätzen und dann auch wieder <span class="in">`emmeans`</span> zu nutzen. Das ist natürlich super, weil wir dann wieder in dem <span class="in">`emmeans`</span> Framework sind und alle Funktionen von oben nutzen können. Deshalb hier auch nur die Modellanpassung, den Rest kopierst du dir dann von oben dazu.</span>
<span id="cb247-2759"><a href="#cb247-2759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2760"><a href="#cb247-2760" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`gls()`</span> aus dem R Paket <span class="in">`{nlme}`</span> passt ein lineares Modell unter Verwendung der verallgemeinerten kleinsten Quadrate an. Die Fehler dürfen dabei aber korreliert oder aber ungleiche Varianzen haben. Damit haben wir ein Modell, was wir nutzen können, wenn wir Varianzheterogenität vorliegen haben. Hier einmal das simple Beispiel für die Tierarten. Wir nehmen wieder die ganz normale Formelschreiweise. Wir können jetzt aber über die Option <span class="in">`weights =`</span> angeben, wie wir die Varianz modellieren wollen. Die Schreibweise mag etwas ungewohnt sein, aber es gibt wirklich viele Arten die Varianz zu modellieren. Hier machen wir uns es einfach und nutzen die Helferfunktion <span class="in">`varIdent`</span> und modellieren dann für jedes Tier eine eigene Gruppenvarianz.</span>
<span id="cb247-2761"><a href="#cb247-2761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2764"><a href="#cb247-2764" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2765"><a href="#cb247-2765" aria-hidden="true" tabindex="-1"></a>gls_fac1_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb247-2766"><a href="#cb247-2766" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal), </span>
<span id="cb247-2767"><a href="#cb247-2767" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac1_tbl)</span>
<span id="cb247-2768"><a href="#cb247-2768" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2769"><a href="#cb247-2769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2770"><a href="#cb247-2770" aria-hidden="true" tabindex="-1"></a>Dann können wir die Modellanpasssung auch schon in <span class="in">`emmeans()`</span> weiterleiten und schauen uns mal das Ergebnis gleich an. Wir achten jetzt auf die Spalte <span class="in">`SE`</span>, die uns ja den Fehler der Mittelwerte für jede Gruppe wiedergibt.</span>
<span id="cb247-2771"><a href="#cb247-2771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2774"><a href="#cb247-2774" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2775"><a href="#cb247-2775" aria-hidden="true" tabindex="-1"></a>gls_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb247-2776"><a href="#cb247-2776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal)</span>
<span id="cb247-2777"><a href="#cb247-2777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2778"><a href="#cb247-2778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2779"><a href="#cb247-2779" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass wir für jedes Tier eine eigene Varianz über den Standardfehler <span class="in">`SE`</span> geschätzt haben. Das war es ja auch was wir wollten. Bis hierhin wäre es auch mit dem Games Howell Test gegangen. Was ist aber, wenn wir ein zweifaktorielles Design mit Interaktion schätzen wollen? Das können wir analog wie eben machen. Wir erweitern einfach das Modell um die Terme <span class="in">`site`</span> für den zweiten Faktor und den Interaktionsterm <span class="in">`animal:site`</span>.</span>
<span id="cb247-2780"><a href="#cb247-2780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2783"><a href="#cb247-2783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2784"><a href="#cb247-2784" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, </span>
<span id="cb247-2785"><a href="#cb247-2785" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal), </span>
<span id="cb247-2786"><a href="#cb247-2786" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac2_tbl)</span>
<span id="cb247-2787"><a href="#cb247-2787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2788"><a href="#cb247-2788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2789"><a href="#cb247-2789" aria-hidden="true" tabindex="-1"></a>Dann können wir uns wieder die multiplen Vergleiche getrennt für die Interaktionsterme wiedergeben lassen. Blöderweise haben jetzt alle Messorte <span class="in">`site`</span> die gleiche Varianz für jede Tierart, aber auch da können wir noch ran.</span>
<span id="cb247-2790"><a href="#cb247-2790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2793"><a href="#cb247-2793" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2794"><a href="#cb247-2794" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb247-2795"><a href="#cb247-2795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site)</span>
<span id="cb247-2796"><a href="#cb247-2796" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2797"><a href="#cb247-2797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2798"><a href="#cb247-2798" aria-hidden="true" tabindex="-1"></a>Die eigentliche Stärke von <span class="in">`gls()`</span> kommt eigentlich erst zu tragen, wenn wir auch noch erlauben, dass wir die Varianz *über alle* Tierarten, Messsorte und Interaktionen variieren kann. Das machen wir, in dem wir einfach `animal*site<span class="in">` zu der `</span>varIdent()` Funktion ergänzen.</span>
<span id="cb247-2799"><a href="#cb247-2799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2802"><a href="#cb247-2802" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2803"><a href="#cb247-2803" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, </span>
<span id="cb247-2804"><a href="#cb247-2804" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal<span class="sc">*</span>site), </span>
<span id="cb247-2805"><a href="#cb247-2805" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac2_tbl)</span>
<span id="cb247-2806"><a href="#cb247-2806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2807"><a href="#cb247-2807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2808"><a href="#cb247-2808" aria-hidden="true" tabindex="-1"></a>Dann noch schnell in <span class="in">`emmeans()`</span> gesteckt und sich das Ergebnis angeschaut.</span>
<span id="cb247-2809"><a href="#cb247-2809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2812"><a href="#cb247-2812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2813"><a href="#cb247-2813" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb247-2814"><a href="#cb247-2814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site)</span>
<span id="cb247-2815"><a href="#cb247-2815" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2816"><a href="#cb247-2816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2817"><a href="#cb247-2817" aria-hidden="true" tabindex="-1"></a>Wie du jetzt siehst schätzen wir die Varianz für jede Tierart und jeden Messort separat. Wir haben also wirklich jede Varianz einzeln zugeordnet. Die Frage ist immer, ob das notwendig ist, denn wir brauchen auch eine gewisse Fallzahl, damit die Modelle funktionieren. Aber das kommt jetzt sehr auf deine Fragestellung an und müssten wir nochmal konkret besprechen.</span>
<span id="cb247-2818"><a href="#cb247-2818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2819"><a href="#cb247-2819" aria-hidden="true" tabindex="-1"></a><span class="fu">## Robuste Schätzung von Standardfehlern</span></span>
<span id="cb247-2820"><a href="#cb247-2820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2821"><a href="#cb247-2821" aria-hidden="true" tabindex="-1"></a>Hier noch <span class="in">`{sandwich}`</span> und <span class="in">`{clubSandwich}`</span> ergänzen.</span>
<span id="cb247-2822"><a href="#cb247-2822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2823"><a href="#cb247-2823" aria-hidden="true" tabindex="-1"></a>Wir immer gibt es noch eine weitere Möglichkeit die Varianzheterogenität zu behandeln. Wir nutzen jetzt hier einmal die Funktionen aus dem R Paket <span class="in">`{sandwich}`</span>, die es uns ermöglichen Varianzheterogenität (eng. *heteroskedasticity*) zu modellieren. Es ist eigentlich super einfach, wir müssen als erstes wieder unser Modell anpassen. Hier einmal mit einer simplen linearen Regression.</span>
<span id="cb247-2824"><a href="#cb247-2824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2827"><a href="#cb247-2827" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2828"><a href="#cb247-2828" aria-hidden="true" tabindex="-1"></a>lm_fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb247-2829"><a href="#cb247-2829" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2830"><a href="#cb247-2830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2831"><a href="#cb247-2831" aria-hidden="true" tabindex="-1"></a>Dann können wir auch schon für einen Gruppenvergleich direkt in der Funktion <span class="in">`emmeans()`</span> für die Varianzheterogenität adjustieren. Es gibt verschiedene mögliche Sandwich-Schätzer, aber wir nehmen jetzt mal einen der häufigsten mit <span class="in">`vcovHC`</span>. Der Schätzer für die Varianzstruktur ist realtiv stabil und in den häufigsten Fällen vollkomen ausreichend</span>
<span id="cb247-2832"><a href="#cb247-2832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2833"><a href="#cb247-2833" aria-hidden="true" tabindex="-1"></a>Wir laden jetzt nicht das ganze Paket <span class="in">`{sandwich}`</span>, sondern nur die Funktion mit <span class="in">`sandwich::vcovHAC`</span>. Achtung, hinter der Option <span class="in">`vcov.`</span> ist ein *Punkt*. Ohne den Aufruf <span class="in">`vcov. =`</span> funktioniert die Funktion dann nicht. Das hat mich mal sehr viele Nerven gekostet.</span>
<span id="cb247-2834"><a href="#cb247-2834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2837"><a href="#cb247-2837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb247-2838"><a href="#cb247-2838" aria-hidden="true" tabindex="-1"></a>em_obj <span class="ot">&lt;-</span> lm_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb247-2839"><a href="#cb247-2839" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal, <span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC)</span>
<span id="cb247-2840"><a href="#cb247-2840" aria-hidden="true" tabindex="-1"></a>em_obj</span>
<span id="cb247-2841"><a href="#cb247-2841" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb247-2842"><a href="#cb247-2842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2843"><a href="#cb247-2843" aria-hidden="true" tabindex="-1"></a>Wir du siehst, die Standardfehler sind jetzt nicht mehr über alle Gruppen gleich. Wir haben also erfolgreich füe die Varianzheterogenität adjustiert.</span>
<span id="cb247-2844"><a href="#cb247-2844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2845"><a href="#cb247-2845" aria-hidden="true" tabindex="-1"></a>Es gibt eine ganze Reihe von anderen Schätzern in dem R Paket <span class="in">`{sandwich}`</span> und <span class="in">`{clubSandwich}`</span>. HIer einmal die Referenzen der beiden Pakete zum nachschlagen, was es da noch so gibt.</span>
<span id="cb247-2846"><a href="#cb247-2846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2847"><a href="#cb247-2847" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">clubSandwich: Cluster-Robust (Sandwich) Variance Estimators with Small-Sample Corrections</span><span class="co">](https://cran.r-project.org/web/packages/clubSandwich/index.html)</span></span>
<span id="cb247-2848"><a href="#cb247-2848" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">sandwich: Robust Covariance Matrix Estimators</span><span class="co">](https://cran.r-project.org/web/packages/sandwich/index.html)</span></span>
<span id="cb247-2849"><a href="#cb247-2849" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb247-2850"><a href="#cb247-2850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-2851"><a href="#cb247-2851" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-posthoc2.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-posthoc2.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
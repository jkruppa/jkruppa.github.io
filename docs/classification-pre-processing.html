<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>71&nbsp; Data preprocessing – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./classification-model-compare.html" rel="next">
<link href="./classification-data.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="71&nbsp; Data preprocessing – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./classification-preface.html">Klassifikation oder maschinelles Lernen</a></li><li class="breadcrumb-item"><a href="./classification-pre-processing.html"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Data preprocessing</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>purrr</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">71.1</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">71.2</span> Daten</a></li>
  <li><a href="#das-rezept-mit-recipe" id="toc-das-rezept-mit-recipe" class="nav-link" data-scroll-target="#das-rezept-mit-recipe"><span class="header-section-number">71.3</span> Das Rezept mit <code>recipe()</code></a></li>
  <li><a href="#fehlende-werte-im-y" id="toc-fehlende-werte-im-y" class="nav-link" data-scroll-target="#fehlende-werte-im-y"><span class="header-section-number">71.4</span> Fehlende Werte im <span class="math inline">\(Y\)</span></a></li>
  <li><a href="#sec-preprocess-dummy" id="toc-sec-preprocess-dummy" class="nav-link" data-scroll-target="#sec-preprocess-dummy"><span class="header-section-number">71.5</span> Dummycodierung von <span class="math inline">\(X\)</span></a></li>
  <li><a href="#sec-preprocess-zv" id="toc-sec-preprocess-zv" class="nav-link" data-scroll-target="#sec-preprocess-zv"><span class="header-section-number">71.6</span> Zero Variance Spalten</a></li>
  <li><a href="#sec-preprocess-standard" id="toc-sec-preprocess-standard" class="nav-link" data-scroll-target="#sec-preprocess-standard"><span class="header-section-number">71.7</span> Standardisieren <span class="math inline">\(\mathcal{N}(0,1)\)</span></a></li>
  <li><a href="#sec-preprocess-normal" id="toc-sec-preprocess-normal" class="nav-link" data-scroll-target="#sec-preprocess-normal"><span class="header-section-number">71.8</span> Normalisieren <span class="math inline">\([0; 1]\)</span></a></li>
  <li><a href="#sec-preprocess-impute" id="toc-sec-preprocess-impute" class="nav-link" data-scroll-target="#sec-preprocess-impute"><span class="header-section-number">71.9</span> Imputieren von fehlenden Werten</a></li>
  <li><a href="#sec-preprocess-discrete" id="toc-sec-preprocess-discrete" class="nav-link" data-scroll-target="#sec-preprocess-discrete"><span class="header-section-number">71.10</span> Kategorisierung</a></li>
  <li><a href="#sec-preprocess-corr" id="toc-sec-preprocess-corr" class="nav-link" data-scroll-target="#sec-preprocess-corr"><span class="header-section-number">71.11</span> Korrelation zwischen Variablen</a></li>
  <li><a href="#beispiel-gummibärchendaten" id="toc-beispiel-gummibärchendaten" class="nav-link" data-scroll-target="#beispiel-gummibärchendaten"><span class="header-section-number">71.12</span> Beispiel Gummibärchendaten</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/classification-pre-processing.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/classification-pre-processing.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./classification-preface.html">Klassifikation oder maschinelles Lernen</a></li><li class="breadcrumb-item"><a href="./classification-pre-processing.html"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Data preprocessing</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-pre-processing" class="quarto-section-identifier"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 23. March 2024 um 21:57:33</em></p>
<blockquote class="blockquote">
<p><em>“I confess that, in 1901, I said to my brother Orville that men would not fly for 50 years. Two years later, we were making flights. This demonstration of my inability as a prophet gave me such a shock that I have ever since refrained from all prediction.” — Wilbur Wright</em></p>
</blockquote>
<p>Die Vorverarbeitung von Daten (eng. <em>preprocessing</em>) für die Klassifikation grundlegend. Wir können nicht auf unseren Daten so wir wie die Daten erhoben haben eine Klassifikation rechnen. Dafür sind die Algorithmen der Klassifikation weder ausgelegt noch gedacht. Zum anderen wollen wir ja gar keine Aussagen über mögliche Effekte von den Einflussvariablen auf das Outcome treffen. Uns ist vollkommen egal, ob eine Variable <em>signifikant</em> ist. Wir wollen nur wissen, ob eine Variable wichtig für die Vorhersage von unserem Label <span class="math inline">\(y\)</span> ist.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Du findest auch noch im Appendix von <a href="https://www.tmwr.org/">Tidy Modeling with R</a> die <a href="https://www.tmwr.org/pre-proc-table.html">Recommended Preprocessing</a> Schritte für viele Algorithmen.</p>
</div></div><p>Du findest auf der <a href="https://recipes.tidymodels.org/reference/index.html#step-functions-discretization">Referenzseite von recipes</a> eine <em>große</em> Auswahl an Vorverarbeitungsschritten. Ich kann dir hier nur eine Auswahl präsentieren und konzentriere mich auf die häufigste genutzen Algorithmen. Du solltest aber für deinen Anwendungsfall auf jeden Fall nochmal selber schauen, ob du was passenderes findest.</p>
<ul>
<li>Die Dummycodierung findest du in <a href="#sec-preprocess-dummy" class="quarto-xref"><span>Kapitel 71.5</span></a>. Wir verwandeln dabei kategorielle Spalten in mehrere <span class="math inline">\(0/1\)</span> kodierte Spalten.</li>
<li>Die Zero Varianz können wir in <a href="#sec-preprocess-zv" class="quarto-xref"><span>Kapitel 71.6</span></a> überprüfen. Mit der Zero Varianz meine ich, dass wir Spalten haben mit nur einem Eintrag und daher natürlich keine Varianz. Du kannst auch schauen, ob du eine Spalte hast in der nahezu eine Varianz von Null vorliegt.</li>
<li>Die Standardisierung von Variablen zu einer <span class="math inline">\(\mathcal{N(0,1)}\)</span> Standardnormalverteilung in <a href="#sec-preprocess-standard" class="quarto-xref"><span>Kapitel 71.7</span></a>.</li>
<li>Die Normalisierung von Variablen in ein Intervall von <span class="math inline">\([0;1]\)</span> in <a href="#sec-preprocess-normal" class="quarto-xref"><span>Kapitel 71.8</span></a>. Es gehen natürlich auch andere Intervalle, aber das Intervall von 0 bis 1 ist wohl das häufigste Intervall was genutzt wird.</li>
<li>Die Imputation von fehlenden Werte in dem <a href="#sec-preprocess-impute" class="quarto-xref"><span>Kapitel 71.9</span></a>. Das ist hier aber nur eine Auswahl. Es gibt sehr viel mehr Möglichkeiten. Du musst auf jeden Fall hier nochmal auf die Referenzseite von <code>recipes</code> nach schauen.</li>
<li>Die Erstellung von Kategorien aus einer numerischen Variable in <a href="#sec-preprocess-discrete" class="quarto-xref"><span>Kapitel 71.10</span></a>. Dann könnten wir auch die neuen kategorialen Variablen dann auch wieder in eine Dummycodierung überführen.</li>
<li>Die Entfernung von hoch korrelierten Variablen in <a href="#sec-preprocess-corr" class="quarto-xref"><span>Kapitel 71.11</span></a>. Hier wäre ich vorsichtig und würde mir den Schritt gerne einmal vorher selber anschauen und dann eventuell Variablen per Hand vor dem <em>preprocessing</em> entfernen.</li>
</ul>
<p>Einige Vorverarbeitungsschritte kannst du auch in den vorherigen Kapiteln nachlesen. Im Kapitel zur <a href="eda-transform.html">Transformation von Daten</a> oder zur <a href="stat-modeling-missing.html">Imputation von fehlenden Werten</a> findest du noch tiefer greifende Informationen zu den Themen. In diesem Kapitel zeige ich nur, wie du die Verfahren anwendest und gehe nochmal eher oberflächlich auf mögliche Probleme ein.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preprocessing und Tuning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Achtung! Du kannst das Preprocessing nicht mit dem Tuning von Algorithmen verbinden. Das heißt, du optimierst deinen Algorithmus immer auf einen Set von pre-prozessierten Daten. Wenn die Daten schlecht sind, dann wird das Tuning auch nicht mehr viel helfen. Deshalb muss man häufig drüber nachdenken, welche Variablen sollen mit in die Analyse und was soll mit den Daten gemacht werden.</p>
</div>
</div>
<section id="genutzte-r-pakete" class="level2" data-number="71.1">
<h2 data-number="71.1" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">71.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, tidymodels, magrittr, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               janitor,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               conflicted)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="71.2">
<h2 data-number="71.2" class="anchored" data-anchor-id="daten"><span class="header-section-number">71.2</span> Daten</h2>
<p>In dieser Einführung nehmen wir die infizierten Ferkel als Beispiel um einmal die verschiedenen Verfahren zu demonstrieren. Ich füge hier noch die ID mit ein, die nichts anderes ist, als die Zeilennummer. Dann habe ich noch die ID an den Anfang gestellt. Wir wählen auch nur ein kleines Subset aus den Daten aus, da wir in diesem Kapitel nur Funktion demonstrieren und nicht die Ergebnisse interpretieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/infected_pigs.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pig_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(pig_id, infected, age, crp, sex, frailty) <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(pig_id, infected, <span class="fu">everything</span>())  </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In <a href="classification-knn.html#tbl-ml-basic-pig" class="quarto-xref">Tabelle&nbsp;<span>73.1</span></a> siehst du nochmal einen Ausschnitt aus den Daten. Wir haben noch die ID mit eingefügt, damit wir einzelne Beobachtungen nachvollziehen können.</p>
<div class="cell">
<div id="tbl-ml-basic-pig" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ml-basic-pig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;71.1— Auszug aus dem Daten zu den kranken Ferkeln.
</figcaption>
<div aria-describedby="tbl-ml-basic-pig-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">pig_id</th>
<th style="text-align: center;">infected</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">crp</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">frailty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">22.38</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">robust</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">53</td>
<td style="text-align: center;">18.64</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">robust</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">66</td>
<td style="text-align: center;">18.76</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">robust</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">59</td>
<td style="text-align: center;">19.37</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">robust</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">63</td>
<td style="text-align: center;">21.57</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">robust</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">55</td>
<td style="text-align: center;">21.45</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">robust</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">407</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">21.5</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">pre-frail</td>
</tr>
<tr class="odd">
<td style="text-align: center;">408</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">56</td>
<td style="text-align: center;">20.8</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">frail</td>
</tr>
<tr class="even">
<td style="text-align: center;">409</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">57</td>
<td style="text-align: center;">21.95</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">pre-frail</td>
</tr>
<tr class="odd">
<td style="text-align: center;">410</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">61</td>
<td style="text-align: center;">23.1</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">robust</td>
</tr>
<tr class="even">
<td style="text-align: center;">411</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">59</td>
<td style="text-align: center;">20.23</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">robust</td>
</tr>
<tr class="odd">
<td style="text-align: center;">412</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">63</td>
<td style="text-align: center;">19.89</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">robust</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Gehen wir jetzt mal die Preprocessing Schritte, die wir für das maschinelle Lernen später brauchen einmal durch. Am Ende des Kapitels schauen wir uns dann die Anwendung nochmal im Ganzen auf den Gummibärchendaten einmal an.</p>
</section>
<section id="das-rezept-mit-recipe" class="level2 page-columns page-full" data-number="71.3">
<h2 data-number="71.3" class="anchored" data-anchor-id="das-rezept-mit-recipe"><span class="header-section-number">71.3</span> Das Rezept mit <code>recipe()</code></h2>
<p>In dem Einführungskapitel zur Klassifikation haben wir uns ja mit dem Rezept und dem Workflow schon mal beschäftigt. Hier möchte ich dann nochmal etwas mehr auf das Rezept eingehen und zeigen, wie das Rezept für Daten dann mit den Daten zusammenkommt. Wir bauen uns wie immer mit der Funktion <code>recipe()</code> das Datenrezept in R zusammen. Ich empfehle grundsätzlich vorab einen <code>select()</code> Schritt durchzuführen und nur die Variablen in den Daten zu behalten, die wir wirklich brauchen. Dann können wir auch mit dem <code>.</code> einfach alle Spalten ohne das Outcome als Prädiktoren definieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pig_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(infected <span class="sc">~</span> ., <span class="at">data =</span> pig_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(pig_id, <span class="at">new_role =</span> <span class="st">"ID"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>pig_rec <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  variable type      role      source  
  &lt;chr&gt;    &lt;list&gt;    &lt;chr&gt;     &lt;chr&gt;   
1 pig_id   &lt;chr [2]&gt; ID        original
2 age      &lt;chr [2]&gt; predictor original
3 crp      &lt;chr [2]&gt; predictor original
4 sex      &lt;chr [3]&gt; predictor original
5 frailty  &lt;chr [3]&gt; predictor original
6 infected &lt;chr [2]&gt; outcome   original</code></pre>
</div>
</div>
<p>Nachdem wir dann unser Rezept definiert haben, können wir auch noch Rollen vergeben. Die Rollen sind nützlich, wenn wir später auf bestimmten Variablen etwas rechnen wollen oder eben nicht. Wir können die Rollen selber definieren und diese Rollen dann auch über die Funktion <code>has_role()</code> ein- oder ausschließen. Neben dieser Möglichkeit gezielt Variablen nach der Rolle anzusprechen, können wir auch <em>alle</em> Prädiktoren oder <em>alle</em> Outcomes auswählen.</p>
<p>Wir haben Funktionen, die die Rolle der Variablen festlegen:</p>
<ul>
<li><code>all_predictors()</code> wendet den Schritt nur auf die Prädiktorvariablen an, daher auf die Features.</li>
<li><code>all_outcomes()</code> wendet den Schritt nur auf die Outcome-Variable(n) an, daher auf die Label.</li>
</ul>
<p>Un wir haben Funktionen, die den Typ der Variablen angeben:</p>
<ul>
<li><code>all_nominal()</code> wendet den Schritt auf alle Variablen an, die nominal (kategorisch) sind.</li>
<li><code>all_numeric()</code> wendet den Schritt auf alle Variablen an, die numerisch sind.</li>
</ul>
<p>Und natürlich deren Kombination wie <code>all_nominal_predictors()</code> oder <code>all_numeric_predictors()</code>, die dann eben auf die Prädiktoren, die nominal also Faktoren oder Gruppen repräsentieren oder eben numerischen Variablen, angewendet werden. Du wirst die Anwendung gleich später in den Rezeptschritten sehen, da macht die Sache dann sehr viel mehr Sinn.</p>
<p>Nun ist es aber auch so, dass es bei dem Rezept auf die Reihenfolge der einzelnen Schritte ankommt. Die Reihenfolge der Zutaten und damit der Rezeptschritte sind ja auch beim Kuchenbacken sehr wichtig! Da das Rezept wirklich in der Reihenfolge durchgeführt wird, wie du die einzelnen Schritte angibst, empfiehlt sich folgende Reihenfolge. Du musst natürlich nicht jeden dieser Schritte auch immer durchführen.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Bitte die Hinweise zur Ordnung der Schritte eines Rezeptes beachten: <a href="https://recipes.tidymodels.org/articles/Ordering.html">Ordering of steps</a></p>
</div></div><ol start="0" type="1">
<li>Entfernen von Beobachtungen mit einem fehlenden Eintrag für das Label.</li>
<li>Imputation von fehlenden Werten in den Daten.</li>
<li>Individuelle Transformationen auf einzelnen Spalten.</li>
<li>Umwandeln von einzelnen numerischen Variablen in eine diskrete Variable.</li>
<li>Erstellung der Dummyvariablen für jede diskrete Variable.</li>
<li>Eventuell Berücksichtigung der Interaktion zwischen Variablen.</li>
<li>Transformation der numerischen Variablen mit zum Beispiel der Standarisierung oder Normalisierung.</li>
<li>Multivariate Transformationen über alle Spalten hinweg wie zum Beispiel PCA.</li>
</ol>
<p>Am Ende wollen wir dann natürlich auch die Daten wiederhaben. Das heißt, wir bauen ja das Rezept auf einem Datensatz. Wenn wir dann das fertige Rezept in die Funktion <code>prep()</code> pipen können wir über die Funktion <code>juice()</code> den ursprünglichen jetzt aber transformierten Datensatz wieder erhalten. Wenn wir das Rezept auf einen <em>neuen</em> Datensatz anwenden wollen, dann nutzen wir die Funktion <code>bake()</code>. Mit einem neuen Datensatz meine ich natürlich einen <a href="classification-data.html">Split in Training- und Testdaten</a> von dem ursprünglichen Datensatz. In dem neuen Datensatz müssen natürlich alle Spaltennamen auch enthalten sein, sonst macht die Sache recht wenig Sinn.</p>
</section>
<section id="fehlende-werte-im-y" class="level2" data-number="71.4">
<h2 data-number="71.4" class="anchored" data-anchor-id="fehlende-werte-im-y"><span class="header-section-number">71.4</span> Fehlende Werte im <span class="math inline">\(Y\)</span></h2>
<p>Wenn wir mit maschinellen Lernverfahren rechnen, dann dürfen wir im Outcome <span class="math inline">\(Y\)</span> oder dem Label keine fehlenden Werte vorliegen haben. Das Outcome ist in dem Sinne hielig, dass wir hier keine Werte imputieren. Wir müssen daher alle Zeilen und damit Beobachtungen aus den Daten entfernen in denen ein <code>NA</code> im Outcome vorliegt. Wir können dazu die Funktion <code>drop_na()</code> nutzen. Wir können in der Funktion spezifizieren, dass nur für eine Spalte die <code>NA</code> entfernt werden sollen. In unserem Beispiel für die Ferkeldaten wäre es dann die Spalte <code>infected</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop_na</span>(infected)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Aktuell haben wir ja keine fehlenden Werte in der Spalte vorliegen, so dass wir die Funktion hier nicht benötigen. In dem Beispiel zu den Gummibärchendaten wollen wir das Geschlecht vorhersagen und hier haben wir dann fehlende Werte im Outcome. Mit der Funktion <code>drop_na(gender)</code> entfernen wir dann alle Beobachtungen aus den Daten mit einem fehlenden Eintrag für das Geschlecht.</p>
</section>
<section id="sec-preprocess-dummy" class="level2 page-columns page-full" data-number="71.5">
<h2 data-number="71.5" class="anchored" data-anchor-id="sec-preprocess-dummy"><span class="header-section-number">71.5</span> Dummycodierung von <span class="math inline">\(X\)</span></h2>
<p>Wir werden immer häufiger davon sprechen, dass wir alle kategorialen Daten in <em>Dummies</em> überführen müssen. Das heißt, wir dürfen keine Faktoren mehr in unseren Daten haben. Wir wandeln daher alle Variablen, die ein Faktor sind, in Dummyspalten um. Die Idee von der Dummyspalte ist die gleiche wie bei der multiplen Regression. Da ich aber nicht davon ausgehe, dass du dir alles hier durchgelesen hast, kommt hier die kurze Einführung zur Dummycodierung.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Mehr Information zu <a href="https://recipes.tidymodels.org/reference/step_dummy.html">Create Traditional Dummy Variables</a></p>
</div></div><p>Die Dummycodierung wird nur auf den Features durchgeführt. Dabei werden nur Spalten erschaffen, die <span class="math inline">\(0/1\)</span>, für Level vorhanden oder Level nicht vorhanden, beinhalten. Wir werden also nur alle <span class="math inline">\(x\)</span> in Dummies umwandeln, die einem Faktor entsprechen. Dafür nutzen wir dann später eine Funktion, hier machen wir das einmal zu Veranschaulichung per Hand. In <a href="#tbl-class-basic-dummy-01" class="quarto-xref">Tabelle&nbsp;<span>71.2</span></a> haben wir einen kleinen Ausschnitt unser Schweinedaten gegeben. Wir wollen zuerst die Spalte <code>sex</code> in eine Dummycodierung umwandeln.</p>
<div id="tbl-class-basic-dummy-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-class-basic-dummy-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;71.2— Beispieldatensatz für die Dummycodierung. Wir wollen die Spalten <code>sex</code> und <code>frailty</code> als Dummyspalten haben.
</figcaption>
<div aria-describedby="tbl-class-basic-dummy-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">infected</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">frailty</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">robust</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">pre-frail</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">frail</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">34</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">robust</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">frail</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>In der <a href="#tbl-class-basic-dummy-02" class="quarto-xref">Tabelle&nbsp;<span>71.3</span></a> sehen wir das Ergebnis für die Dummycodierung der Spalte <code>sex</code> in die Dummyspalte <code>sex_male</code>. Wir haben in der Dummyspalte nur noch die Information, ob das Ferkel mänlich ist oder nicht. Wenn wir eine Eins in der Spalte finden, dann ist das Ferkel männlich. Wenn wir eine Null vorfinden, dann ist das Ferkel nicht männlich also weiblich. Das <em>Nicht</em> müssen wir uns dann immer merken.</p>
<div id="tbl-class-basic-dummy-02" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-class-basic-dummy-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;71.3— Ergebnis der Dummycodierung der Spalte <code>sex</code> zu der Spalte <code>sex_male</code>.
</figcaption>
<div aria-describedby="tbl-class-basic-dummy-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">infected</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">sex_male</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">34</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>In der <a href="#tbl-class-basic-dummy-03" class="quarto-xref">Tabelle&nbsp;<span>71.4</span></a> betrachten wir einen komplexeren Fall. Wenn wir eine Spalte vorliegen haben mit mehr als zwei Leveln, wie zum Beispiel die Spalte <code>frailty</code>, dann erhalten wir zwei Spalten wieder. Die Spalte <code>frailty_robust</code> beschreibt das Vorhandensein des Levels <code>robust</code> und die Spalte <code>frailty_pre-frail</code> das Vorhandensein des Levels <code>pre-frail</code>. Und was ist mit dem Level <code>frail</code>? Das Level wir durch das Nichtvorhandensein von <code>robust</code> und dem Nichtvorhandensein von <code>pre-frail</code> abgebildet. Beinhalten beide Spalten die Null, so ist das Ferkel <code>frail</code>.</p>
<div id="tbl-class-basic-dummy-03" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-class-basic-dummy-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;71.4— Ergebnis der Dummycodierung für eine Spalte mit mehr als zwei Leveln.
</figcaption>
<div aria-describedby="tbl-class-basic-dummy-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">infected</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">frailty_robust</th>
<th style="text-align: center;">frailty_pre-frail</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">34</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wenn wir einen Faktor mit <span class="math inline">\(l\)</span> Leveln haben, erhalten wir immer <span class="math inline">\(l-1\)</span> Spalten nach der Dummycodierung wieder.</p>
<p>Wir nutzen dann die Funktion <code>step_dummy()</code> um eine Dummaycodierung für alle nominalen Prädiktoren spezifiziert durch <code>all_nominal_predictors()</code> durchzuführen. Das tolle ist hier, dass wir durch die Helferfunktionen immer genau sagen können welche Typen von Spalten bearbeitet werden sollen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pig_dummy_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>()) </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>pig_dummy_rec </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Recipe ──────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Inputs </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of variables by role</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>outcome:   1
predictor: 4
ID:        1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Operations </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Dummy variables from: all_nominal_predictors()</code></pre>
</div>
</div>
<p>Wenn wir das Rezept fertig haben, dann können wir uns die Daten einmal anschauen. Durch die Funktion <code>prep()</code> initialisieren wir das Rezept und mit der Funktion <code>juice()</code> teilen wir mit, dass wir das Rezept gleich auf die Trainingsdaten mit denen wir das Rezept gebaut haben, anweden wollen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pig_dummy_rec <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 412 × 7
   pig_id   age   crp infected sex_male frailty_pre.frail frailty_robust
    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;             &lt;dbl&gt;          &lt;dbl&gt;
 1      1    61  22.4        1        1                 0              1
 2      2    53  18.6        1        1                 0              1
 3      3    66  18.8        0        0                 0              1
 4      4    59  19.4        1        0                 0              1
 5      5    63  21.6        1        1                 0              1
 6      6    55  21.4        1        1                 0              1
 7      7    49  19.0        1        1                 1              0
 8      8    53  19.0        0        1                 0              1
 9      9    58  21.9        1        0                 0              1
10     10    57  21.0        1        1                 0              1
# ℹ 402 more rows</code></pre>
</div>
</div>
<p>Die Dummycodierung verwandelt alle nominalen Spalten in mehrere <span class="math inline">\(0/1\)</span> Spalten um. Das ermöglicht den Algorithmen auch mit nominalen Spalten eine Vorhersage zu machen.</p>
</section>
<section id="sec-preprocess-zv" class="level2 page-columns page-full" data-number="71.6">
<h2 data-number="71.6" class="anchored" data-anchor-id="sec-preprocess-zv"><span class="header-section-number">71.6</span> Zero Variance Spalten</h2>
<p>Ein häufiges Problem ist, dass wir manchmal Spalten in unseren Daten haben in denen nur ein Eintrag steht. Das heißt wir haben überall die gleiche Zahl oder eben das gelche Wort stehen. Das tritt häufiger auf, wenn wir uns riesige Datenmengen von extern herunterladen. Manchmal haben wir so viele Spalten, dass wir die Daten gr nicht richtig überblicken. Oder aber, wir haben nach einer Transformation nur noch die gleiche Zahl. Dagegen können wir filtern.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Mehr Information zu <a href="https://recipes.tidymodels.org/reference/step_zv.html">Zero Variance Filter</a> und <a href="https://recipes.tidymodels.org/reference/step_nzv.html">Near-Zero Variance Filter</a></p>
</div></div><p>Wir haben die Auswahl zwischen <code>step_zv()</code>, die Funktion entfernt Spalten mit einer Vaianz von Null. Das mag seltener vorkommen, als eine sehr kleine Varianz. Hier hilft die Funktion <code>step_nzv()</code>. Wir können beide Funktionen auf alle Arten von Prädiktoren anwenden, nur eben nicht <em>gleichzeitig</em>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pig_zero_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_nzv</span>(<span class="fu">all_predictors</span>())</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>pig_zero_rec</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Recipe ──────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Inputs </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of variables by role</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>outcome:   1
predictor: 4
ID:        1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Operations </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Zero variance filter on: all_predictors()</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Sparse, unbalanced variable filter on: all_predictors()</code></pre>
</div>
</div>
<p>Da wir in unseren Daten mit den infizierten Ferkeln jetzt keine Spalten mit einer sehr kleinen Varianz haben, passiert auch nichts, wenn wir die Funktion auf unsere Daten anwenden würden. Demensprechend sparen wir uns an dieser Stelle auch die Datengenerierung.</p>
</section>
<section id="sec-preprocess-standard" class="level2 page-columns page-full" data-number="71.7">
<h2 data-number="71.7" class="anchored" data-anchor-id="sec-preprocess-standard"><span class="header-section-number">71.7</span> Standardisieren <span class="math inline">\(\mathcal{N}(0,1)\)</span></h2>
<p>In dem Kapitel zu der <a href="eda-transform.html">Transformation von Daten</a> haben wir ja schon von der Standardisierung gelesen und uns mit den gängigen Funktion beschäftigt. Deshalb hier nur kurz die Schritte und Funktionen, die wir mit den Rezepten machen können. Zum einen können wir nur die Daten mit der Funktion <code>step_scale()</code> skalieren, dass heißt auf eine Standardabweichung von 1 bringen. Oder aber zum anderen nutzen wir die Funktion <code>scale_center()</code> um die Daten alle auf einen Mittelwert von 0 zu schieben. Manchmal wollen wir nur den einen Schritt getrennt von dem anderen Schritt durchführen. Beide Schritte können wir dann einfach auf allen <em>numerischen</em> Prädiktoren durchführen.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Mehr Information zu <a href="https://recipes.tidymodels.org/reference/step_scale.html">Scaling Numeric Data</a> sowie <a href="https://recipes.tidymodels.org/reference/step_center.html">Centering Numeric Data</a> und <a href="https://recipes.tidymodels.org/reference/step_normalize.html">Center and Scale Numeric Data</a></p>
</div></div><div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pig_scale_center_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_center</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_scale</span>(<span class="fu">all_numeric_predictors</span>()) </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>pig_scale_center_rec </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Recipe ──────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Inputs </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of variables by role</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>outcome:   1
predictor: 4
ID:        1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Operations </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Centering for: all_numeric_predictors()</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Scaling for: all_numeric_predictors()</code></pre>
</div>
</div>
<p>Wenn wir aber auf eine getrennte Durchführung keine Lust haben, gibt es auch die etwas schief benannte Funktion <em>step_normalize()</em>, die beide Schritte kombiniert und uns damit die Daten auf eine Standardnormalverteilung transformiert. Ich persönlich nutze dann meist die zweite Variante, dann hat man alles in einem Schritt zusammen. Das hängt aber sehr vom Anwendungsfall ab und du musst dann schauen, was besser für dich und deine Daten dann passt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>pig_scale_center_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>pig_scale_center_rec </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Recipe ──────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Inputs </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of variables by role</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>outcome:   1
predictor: 4
ID:        1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Operations </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Centering and scaling for: all_numeric_predictors()</code></pre>
</div>
</div>
<p>Jetzt können wir noch die Daten generieren und sehen, dass wir alle numerischen Spalten in eine Standardnormalverteilung transformiert haben. Wir runden hier nochmal alle numerischen Variablen, damit wir nicht so einen breiten Datensatz erhalten. Das hat jetzt aber eher was mit der Ausgabe hier auf der Webseite zu tun. Wir müssen nicht runden um die Daten dann zu verwenden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>pig_scale_center_rec <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() <span class="sc">|&gt;</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 412 × 6
   pig_id   age   crp sex    frailty   infected
    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;        &lt;dbl&gt;
 1      1  0.22  1.62 male   robust           1
 2      2 -1.55 -0.99 male   robust           1
 3      3  1.32 -0.91 female robust           0
 4      4 -0.23 -0.48 female robust           1
 5      5  0.66  1.05 male   robust           1
 6      6 -1.11  0.97 male   robust           1
 7      7 -2.44 -0.76 male   pre-frail        1
 8      8 -1.55 -0.76 male   robust           0
 9      9 -0.45  1.27 female robust           1
10     10 -0.67  0.62 male   robust           1
# ℹ 402 more rows</code></pre>
</div>
</div>
</section>
<section id="sec-preprocess-normal" class="level2 page-columns page-full" data-number="71.8">
<h2 data-number="71.8" class="anchored" data-anchor-id="sec-preprocess-normal"><span class="header-section-number">71.8</span> Normalisieren <span class="math inline">\([0; 1]\)</span></h2>
<p>Auch bei der Normalisierung möchte ich wieder auf das Kapitel zum <a href="eda-transform.html">Transformation von Daten</a> verweisen. In dem <code>tidymodels</code> Universum heißt dann das Normalisieren, also die Daten auf eine Spannweite zwischen 0 und 1 bringen, dann eben <code>step_range()</code>. Das ist natürlich dann schön generalisiert. Wir könnten uns auch andere Spannweiten überlegen, aber hier nehmen wir natürlich immer den Klassiker auf eine Spannweite <span class="math inline">\([0; 1]\)</span>. Unsere Daten liegen dann nach der Normalisierung mit der Funktion <code>step_range()</code> zwischen 0 und 1. Wir können die Normalisierung natürlich nur auf numerischen Variablen durchführen.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Mehr Information zu <a href="https://recipes.tidymodels.org/reference/step_range.html">Scaling Numeric Data to a Specific Range</a></p>
</div></div><div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>pig_range_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_range</span>(<span class="fu">all_numeric_predictors</span>(), <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>) </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>pig_range_rec </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Recipe ──────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Inputs </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of variables by role</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>outcome:   1
predictor: 4
ID:        1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Operations </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Range scaling to [0,1] for: all_numeric_predictors()</code></pre>
</div>
</div>
<p>Auch hier können wir dann die Daten generieren und uns einmal anschauen. Im Gegensatz zu der Standardisierung treten jetzt in unseren Spalten keine negativen Werte mehr auf. Wir runden hier ebenfalls nochmal alle numerischen Variablen, damit wir nicht so einen breiten Datensatz erhalten. Das hat jetzt aber eher was mit der Ausgabe hier auf der Webseite zu tun. Wir müssen nicht runden um die Daten dann zu verwenden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>pig_range_rec <span class="sc">|&gt;</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() <span class="sc">|&gt;</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 412 × 6
   pig_id   age   crp sex    frailty   infected
    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;        &lt;dbl&gt;
 1      1  0.52  0.82 male   robust           1
 2      2  0.17  0.34 male   robust           1
 3      3  0.74  0.36 female robust           0
 4      4  0.43  0.44 female robust           1
 5      5  0.61  0.72 male   robust           1
 6      6  0.26  0.7  male   robust           1
 7      7  0     0.39 male   pre-frail        1
 8      8  0.17  0.39 male   robust           0
 9      9  0.39  0.76 female robust           1
10     10  0.35  0.64 male   robust           1
# ℹ 402 more rows</code></pre>
</div>
</div>
</section>
<section id="sec-preprocess-impute" class="level2 page-columns page-full" data-number="71.9">
<h2 data-number="71.9" class="anchored" data-anchor-id="sec-preprocess-impute"><span class="header-section-number">71.9</span> Imputieren von fehlenden Werten</h2>
<p>In dem Kapitel zur <a href="stat-modeling-missing.html">Imputation von fehlenden Werten</a> haben wir uns mit verschiedenen Methoden zur Imputation von fehlenden Werten beschäftigt. Auch gibt es verschiedene Rezepte um die Imputation durchzuführen. Wir haben also wieder die Qual der Wahl welchen Algorithmus wir nutzen wollen. Da wir wieder zwischen numerischen und nominalen Variablen unterscheiden müssen, haben wir immer zwei Imputationsschritte. Ich mache es mir hier sehr leicht und wähle die <code>mean</code> Imputation für die numerischen Variablen aus und die <code>mode</code> Imputation für die nominalen Variablen. Das sind natürlich die beiden simpelsten Imputation die gehen. Ich würde dir empfehlen nochmal die Alternativen anzuschauen und <em>vorab</em> auf jeden Fall nochmal dir die fehlenden Daten zu visualisieren. Es macht auch hier keinen Sinn nicht vorhandene Spalten mit künstlichen Daten zu füllen.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Mehr Information zu <a href="https://recipes.tidymodels.org/reference/index.html#step-functions-imputation">Step Functions - Imputation</a></p>
</div></div><p>Da wir es uns in diesem Schritt sehr einfach machen, nutzen wir die Funktionen <code>step_impute_mean()</code> auf allen numerischen Variablen und die Funktion <code>step_impute_mode()</code> auf alle nominalen Variablen. Es geht wie immer natürlich besser, das heißt auch komplexerer. Hier ist es auch wieder schwierig zu sagen, welche Methode die <em>beste</em> Methode zur Imputation von fehlenden Werten ist. Hier hilft es dann nichts, du musst dir die imputierten Daten anschauen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>pig_imp_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mode</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>pig_imp_rec </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Recipe ──────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Inputs </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of variables by role</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>outcome:   1
predictor: 4
ID:        1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Operations </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Mean imputation for: all_numeric_predictors()</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Mode imputation for: all_nominal_predictors()</code></pre>
</div>
</div>
<p>Dann können wir uns auch schon die Daten generieren. Wir sehen, dass wir keine fehlenden Werte mehr in unseren Daten vorliegen haben. Wie immer können wir uns die gerundeten Daten dann einmal anschauen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>pig_imp_rec  <span class="sc">|&gt;</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() <span class="sc">|&gt;</span> </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 412 × 6
   pig_id   age   crp sex    frailty   infected
    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;        &lt;dbl&gt;
 1      1    61  22.4 male   robust           1
 2      2    53  18.6 male   robust           1
 3      3    66  18.8 female robust           0
 4      4    59  19.4 female robust           1
 5      5    63  21.6 male   robust           1
 6      6    55  21.4 male   robust           1
 7      7    49  19.0 male   pre-frail        1
 8      8    53  19.0 male   robust           0
 9      9    58  21.9 female robust           1
10     10    57  21.0 male   robust           1
# ℹ 402 more rows</code></pre>
</div>
</div>
<p>Die Imputationrezepte bieten sich natürlich auch für die ganz normale Statistik an. Du kannst ja dann mit den imputierten Daten rechnen was du möchtest. Wir nutzen die Daten hier ja nur im Kontext der Klassifikation. Es gingt natürlich auch die Daten für die lineare Regression zu nutzen.</p>
</section>
<section id="sec-preprocess-discrete" class="level2 page-columns page-full" data-number="71.10">
<h2 data-number="71.10" class="anchored" data-anchor-id="sec-preprocess-discrete"><span class="header-section-number">71.10</span> Kategorisierung</h2>
<p>Manchmal wollen wir nicht mit numerischen Variablen arbeiten sondern uns nominale Variablen erschaffen. Das sollten wir eigentlich nicht so häufig tun, denn die numerischen Variablen haben meist mehr Informationen als nominale Variablen. Wir müssen dann ja unsere nominalen Daten dann wieder in Dummies umkodieren. Das sind dann zwei zusätzliche Schritte. Aber wie immer in der Datenanalyse, es gibt Fälle in denen es Sinn macht und wir eben keine numerischen Variablen haben wollen. Dann können wir eben die Funktion <code>step_discretize()</code> nutzen um verschiedene Gruppen oder <code>bins</code> (eng. <em>Dosen</em>) zu bilden. Das <a href="https://cran.r-project.org/web/packages/embed/embed.pdf">R Paket <code>{embed}</code></a> bietet noch eine Vielzahl an weiteren Funktionen für die Erstellung von kategorialen Variablen.</p>
<p>Es kann natürlich sinnvoll sein aus einer numerischen Outcomevariablen eine binäre Outcomevariable zu erzeugen. Dann können wir wieder eine Klassifikation rechnen. Aber auch hier musst du überlegen, ob das binäre Outcome dann dem numerischen Outcome inhaltlich entspricht. Wir können natürlich aus dem numerischen Lichteinfall die binäre Variable wenig/viel Licht transformieren. Dann muss die neue binäre Variable aber auch zur Fragestellung passen. Oder aus Noten auf der Likert-Skala nur zwei Noten mit schlecht/gut erschaffen.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Mehr Information zu <a href="https://recipes.tidymodels.org/reference/index.html#step-functions-discretization">Step Functions - Discretization</a></p>
</div></div><p>Wir wollen jetzt die Spalten <code>age</code> und <code>crp</code> in mindestens drei gleich große Gruppen aufspalten. Wenn wir mehr Gruppen brauchen, dann werden es mehr Gruppen werden. Das wichtige ist hier, dass wir gleich große Gruppen haben wollen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>pig_discrete_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_discretize</span>(crp, age, <span class="at">min_unique =</span> <span class="dv">3</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>pig_discrete_rec </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Recipe ──────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Inputs </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of variables by role</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>outcome:   1
predictor: 4
ID:        1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Operations </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Discretize numeric variables from: crp and age</code></pre>
</div>
</div>
<p>Und dann können wir uns auch schon die Daten generieren. Wir immer gibt es noch andere Möglichkeiten um aus einer numerischen Spalte eine nominale Spalte zu generieren. Du musst dann abgleichen, welche Variante dir am besten passt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>pig_discrete_tbl <span class="ot">&lt;-</span> pig_discrete_rec  <span class="sc">|&gt;</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Note that the options `prefix` and `labels` will be applied to all
variables.</code></pre>
</div>
</div>
<p>Wir sehen, dass wir dann jeweils vier <code>bins</code> erhalten mit gut 25% Beobachtungen in jedem <code>bin</code>. Wir können dann mit der neuen Variable weiterrechnen und zum Beispiel diese neue nominale Variable dann in eine Dummykodierung umwandeln. Hier siehst du, dass du gewisse Schritte in einem Rezept in der richtigen Reihenfolge durchführen musst.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>pig_discrete_tbl <span class="sc">|&gt;</span> <span class="fu">pull</span>(crp) <span class="sc">|&gt;</span> <span class="fu">tabyl</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> pull(pig_discrete_tbl, crp)   n   percent
                        bin1 104 0.2524272
                        bin2 102 0.2475728
                        bin3 103 0.2500000
                        bin4 103 0.2500000</code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>pig_discrete_tbl <span class="sc">|&gt;</span> <span class="fu">pull</span>(age) <span class="sc">|&gt;</span> <span class="fu">tabyl</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> pull(pig_discrete_tbl, age)   n   percent
                        bin1 122 0.2961165
                        bin2 103 0.2500000
                        bin3  99 0.2402913
                        bin4  88 0.2135922</code></pre>
</div>
</div>
</section>
<section id="sec-preprocess-corr" class="level2 page-columns page-full" data-number="71.11">
<h2 data-number="71.11" class="anchored" data-anchor-id="sec-preprocess-corr"><span class="header-section-number">71.11</span> Korrelation zwischen Variablen</h2>
<p>Als einer der letzten Schritte für die Aufreinigung der Daten schauen wir uns die Korrelation an. Du kannst dir die Korrelation im Kapitel <a href="stat-linear-reg-corr.html" class="quarto-xref"><span>Kapitel 44</span></a> nochmal näher anlesen. Wie schon bei der Imputation kann ich nur davon abraten einfach so den Filter auf die Daten anzuwenden. Es ist besser sich die numerischen Variablen einmal zu visualisieren und die Korrelation einmal zu berechnen. Das blinde Filtern von Variablen macht auf jeden Fall keinen Sinn!</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Mehr Information zu <a href="https://recipes.tidymodels.org/reference/step_corr.html">High Correlation Filter</a></p>
</div></div><p>In der Klassifikation müssen wir schauen, dass wir keine numerischen Variablen haben, die im Prinzip das gleiche Aussagen also hoch miteinander korreliert sind. Die Variablen müssen wir dann entfernen. Oder besser eine von den beiden Variablen. Wir können den Schritt mit der Funktion <code>step_corr()</code> durchführen und einen Threshold für die Entfernung von numerischen Variablen festlegen. Wir nehmen hier ein <span class="math inline">\(\rho = 0.5\)</span>. Nochmal, das ist nicht sehr gut blind Vairablen zu entfernen. Schaue dir vorher einen paarweisen Korrelationsplot an und entscheide dann, ob du und welche Variablen du entfernen möchtest.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>pig_corr_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_corr</span>(<span class="fu">all_numeric_predictors</span>(), <span class="at">threshold =</span> <span class="fl">0.5</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>pig_corr_rec </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Recipe ──────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Inputs </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of variables by role</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>outcome:   1
predictor: 4
ID:        1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Operations </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Correlation filter on: all_numeric_predictors()</code></pre>
</div>
</div>
<p>Dann können wir auch schon die Daten generieren. In unserem Fall wurde keine Variable entfernt. Die Korrelation untereinander ist nicht so groß. Wir runden hier wieder, damit sich die Tabelle nicht so in die Breite auf der Webseite entwickelt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>pig_corr_tbl <span class="ot">&lt;-</span> pig_corr_rec  <span class="sc">|&gt;</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() <span class="sc">|&gt;</span> </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="beispiel-gummibärchendaten" class="level2 page-columns page-full" data-number="71.12">
<h2 data-number="71.12" class="anchored" data-anchor-id="beispiel-gummibärchendaten"><span class="header-section-number">71.12</span> Beispiel Gummibärchendaten</h2>
<p>Schauen wir uns ein Rezept einmal in einem Rutsch auf den Gummibärchendaten einmal an. Wir müssen natürlich erstmal alle nominalen Variablen auch als solche umwandeln. Wir erschaffen also die passenden Faktoren für das Geschlecht und den Lieblingsgeschmack. Dann erschaffen wir noch eine ID für die Studierenden. Am Ende wählen wir noch ein paar Spalten aus, damit wir nicht alle Variablen vorliegen haben. Sonst wird der endgültige Datensatz sehr breit. Wir entfernen dann noch alle Beobachtungen aus den Daten, die einen fehlenden Wert bei dem Geschlecht haben. Das machen wir immer für die Variable, die dann unser Outcome sein soll.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>gummi_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/gummibears.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">as_factor</span>(gender),</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">most_liked =</span> <span class="fu">as_factor</span>(most_liked),</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">student_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(student_id, gender, most_liked, age, semester, height) <span class="sc">|&gt;</span>  </span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(gender)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In <a href="#tbl-gummi-prepro" class="quarto-xref">Tabelle&nbsp;<span>71.5</span></a> sehen wir dann die Daten nochmal vor dem Preprocessing dargestellt. Wir sind nicht an den ursprünglichen Daten interessiert, da wir nur die Spalte <code>gender</code> vorhersagen wollen. Wir wollen hier keine Effekt schätzen oder aber Signifikanzen berechnen. Unsere Features dienen nur der Vorhersage des Labels. Wie die Features zahlenmäßig beschaffen sind, ist uns egal.</p>
<div class="cell">
<div id="tbl-gummi-prepro" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-gummi-prepro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;71.5— Auszug aus dem Daten zu den Gummibärchendaten.
</figcaption>
<div aria-describedby="tbl-gummi-prepro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">student_id</th>
<th style="text-align: center;">gender</th>
<th style="text-align: center;">most_liked</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">semester</th>
<th style="text-align: center;">height</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">lightred</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">193</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">w</td>
<td style="text-align: center;">yellow</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">159</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">w</td>
<td style="text-align: center;">white</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">159</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">w</td>
<td style="text-align: center;">white</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">180</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">white</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">180</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">green</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">180</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">891</td>
<td style="text-align: center;">w</td>
<td style="text-align: center;">green</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">184</td>
</tr>
<tr class="odd">
<td style="text-align: center;">892</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">darkred</td>
<td style="text-align: center;">19</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">184</td>
</tr>
<tr class="even">
<td style="text-align: center;">894</td>
<td style="text-align: center;">w</td>
<td style="text-align: center;">lightred</td>
<td style="text-align: center;">23</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">180</td>
</tr>
<tr class="odd">
<td style="text-align: center;">895</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">darkred</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">170</td>
</tr>
<tr class="even">
<td style="text-align: center;">896</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">green</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">181</td>
</tr>
<tr class="odd">
<td style="text-align: center;">897</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">darkred</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">182</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Wir erschaffen uns nun das Rezept in dem wie definieren, dass das <code>gender</code> unser Label ist und der Rest der Vairablen unsere Features. Da wir noch die Spalte <code>student_id</code> haben, geben wir dieser Spalte noch die Rolle <code>ID</code>. Wir können dann in den Rezeptschritten dann immer diese Rolle <code>ID</code> aus dem Prozess der Transformation ausschließen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>gummi_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(gender <span class="sc">~</span> ., <span class="at">data =</span> gummi_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(student_id, <span class="at">new_role =</span> <span class="st">"ID"</span>)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>gummi_rec <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  variable   type      role      source  
  &lt;chr&gt;      &lt;list&gt;    &lt;chr&gt;     &lt;chr&gt;   
1 student_id &lt;chr [2]&gt; ID        original
2 most_liked &lt;chr [3]&gt; predictor original
3 age        &lt;chr [2]&gt; predictor original
4 semester   &lt;chr [2]&gt; predictor original
5 height     &lt;chr [2]&gt; predictor original
6 gender     &lt;chr [3]&gt; outcome   original</code></pre>
</div>
</div>
<p>Und dann haben wir hier alle Schritte einmal zusammen in einem Block. Wir imputieren die fehlenden Werte für die numerischen und nominalen Variablen getrennt. Dann verwandeln wir das Semester in mindestens vier Gruppen. Im nächsten Schritt werden dann alle numerischen Variablen auf eine Spannweite von <span class="math inline">\([0;1]\)</span> gebracht. Wir erschaffen dann noch die Dummies für die nominalen Daten. Am Ende wollen wir dann alle Variablen mit fast keiner Varianz entfernen. Wir wollen dann immer die Spalte <code>ID</code> aus den Schritten ausschließen. Wir machen das mit der Funktion <code>has_role()</code> und dem <code>-</code> vor der Funktion. Damit schließen wir die Rolle <code>ID</code> aus dem Transformationsschritt aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>gummi_full_rec <span class="ot">&lt;-</span> gummi_rec <span class="sc">|&gt;</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(<span class="fu">all_numeric_predictors</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"ID"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_bag</span>(<span class="fu">all_nominal_predictors</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"ID"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_discretize</span>(semester, <span class="at">num_breaks =</span> <span class="dv">3</span>, <span class="at">min_unique =</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_range</span>(<span class="fu">all_numeric_predictors</span>(), <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>, <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"ID"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"ID"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_nzv</span>(<span class="fu">all_predictors</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"ID"</span>))</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>gummi_full_rec</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Recipe ──────────────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Inputs </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of variables by role</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>outcome:   1
predictor: 4
ID:        1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Operations </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Mean imputation for: all_numeric_predictors() and -has_role("ID")</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Bagged tree imputation for: all_nominal_predictors() and -has_role("ID")</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Discretize numeric variables from: semester</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Range scaling to [0,1] for: all_numeric_predictors() and -has_role("ID")</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Dummy variables from: all_nominal_predictors() and -has_role("ID")</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>• Sparse, unbalanced variable filter on: all_predictors() and -has_role("ID")</code></pre>
</div>
</div>
<p>Dann können wir wieder unsere Daten generieren. Ich runde hier wieder, da wir schnell sehr viele Kommastellen produzieren. In der Anwendung machen wir das natürlich dann nicht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>gummi_class_tbl <span class="ot">&lt;-</span> gummi_full_rec <span class="sc">|&gt;</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() <span class="sc">|&gt;</span> </span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#tbl-gummi-prepro-trans" class="quarto-xref">Tabelle&nbsp;<span>71.6</span></a> können wir uns die transformierten Daten einmal anschauen. Wir sehen das zum einen die Variable <code>student_id</code> nicht transformiert wurde. Alle numerischen Spalten sind auf einer Spannweite zwischen 0 und 1. Das Geschlecht wurde <em>nicht</em> transformiert, da wir das Geschlecht ja als Outcome festgelegt haben. Dann kommen die Dummykodierungen für die nominalen Spalten des Lieblingsgeschmack und des Semesters.</p>
<div class="cell page-columns page-full">
<div id="tbl-gummi-prepro-trans" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-gummi-prepro-trans-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;71.6— Der transformierte Gummibärchendatensatz nach der Anwendung des Rezepts.
</figcaption>
<div aria-describedby="tbl-gummi-prepro-trans-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="cell-output-display column-page">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 12%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">student_id</th>
<th style="text-align: center;">age</th>
<th style="text-align: center;">height</th>
<th style="text-align: center;">gender</th>
<th style="text-align: center;">most_liked_yellow</th>
<th style="text-align: center;">most_liked_white</th>
<th style="text-align: center;">most_liked_green</th>
<th style="text-align: center;">most_liked_darkred</th>
<th style="text-align: center;">most_liked_none</th>
<th style="text-align: center;">semester_bin2</th>
<th style="text-align: center;">semester_bin3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.48</td>
<td style="text-align: center;">0.79</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.2</td>
<td style="text-align: center;">0.21</td>
<td style="text-align: center;">w</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0.2</td>
<td style="text-align: center;">0.21</td>
<td style="text-align: center;">w</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.57</td>
<td style="text-align: center;">w</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.22</td>
<td style="text-align: center;">0.57</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.22</td>
<td style="text-align: center;">0.57</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">806</td>
<td style="text-align: center;">0.2</td>
<td style="text-align: center;">0.64</td>
<td style="text-align: center;">w</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">807</td>
<td style="text-align: center;">0.16</td>
<td style="text-align: center;">0.64</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">808</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;">0.57</td>
<td style="text-align: center;">w</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">809</td>
<td style="text-align: center;">0.22</td>
<td style="text-align: center;">0.4</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">810</td>
<td style="text-align: center;">0.22</td>
<td style="text-align: center;">0.59</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">811</td>
<td style="text-align: center;">0.18</td>
<td style="text-align: center;">0.6</td>
<td style="text-align: center;">m</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Bis hierher haben wir jetzt die Rezepte nur genutzt um uns die Daten aufzuarbeiten. Das ist eigentlich nur ein Schritt in der Klassifikation. Mit der Funktion <code>workflow()</code> können wir dann Rezepte mit Algorithmen verbinden. Dann nutzen wir die Funktion <code>fit()</code> um verschiedene Daten auf den Workflow anzuwenden. Das musst du aber nicht tun. Du kannst die Rezepte hier auch verwenden um deine Daten einfach aufzuarbeiten und dann eben doch ganz <em>normale</em> Statistik drauf zu rechnen.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./classification-data.html" class="pagination-link" aria-label="Data splitting">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Data splitting</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./classification-model-compare.html" class="pagination-link" aria-label="Vergleich von Algorithmen">
        <span class="nav-page-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb123" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc)</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data preprocessing {#sec-pre-processing}</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("classification-pre-processing.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"I confess that, in 1901, I said to my brother Orville that men would not fly for 50 years. Two years later, we were making flights. This demonstration of my inability as a prophet gave me such a shock that I have ever since refrained from all prediction." --- Wilbur Wright*</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>Die Vorverarbeitung von Daten (eng. *preprocessing*) für die Klassifikation grundlegend. Wir können nicht auf unseren Daten so wir wie die Daten erhoben haben eine Klassifikation rechnen. Dafür sind die Algorithmen der Klassifikation weder ausgelegt noch gedacht. Zum anderen wollen wir ja gar keine Aussagen über mögliche Effekte von den Einflussvariablen auf das Outcome treffen. Uns ist vollkommen egal, ob eine Variable *signifikant* ist. Wir wollen nur wissen, ob eine Variable wichtig für die Vorhersage von unserem Label $y$ ist.</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>Du findest auch noch im Appendix von <span class="co">[</span><span class="ot">Tidy Modeling with R</span><span class="co">](https://www.tmwr.org/)</span> die <span class="co">[</span><span class="ot">Recommended Preprocessing</span><span class="co">](https://www.tmwr.org/pre-proc-table.html)</span> Schritte für viele Algorithmen.</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>Du findest auf der <span class="co">[</span><span class="ot">Referenzseite von recipes</span><span class="co">](https://recipes.tidymodels.org/reference/index.html#step-functions-discretization)</span> eine *große* Auswahl an Vorverarbeitungsschritten. Ich kann dir hier nur eine Auswahl präsentieren und konzentriere mich auf die häufigste genutzen Algorithmen. Du solltest aber für deinen Anwendungsfall auf jeden Fall nochmal selber schauen, ob du was passenderes findest.</span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Dummycodierung findest du in @sec-preprocess-dummy. Wir verwandeln dabei kategorielle Spalten in mehrere $0/1$ kodierte Spalten.</span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Zero Varianz können wir in @sec-preprocess-zv überprüfen. Mit der Zero Varianz meine ich, dass wir Spalten haben mit nur einem Eintrag und daher natürlich keine Varianz. Du kannst auch schauen, ob du eine Spalte hast in der nahezu eine Varianz von Null vorliegt.</span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Standardisierung von Variablen zu einer $\mathcal{N(0,1)}$ Standardnormalverteilung in @sec-preprocess-standard.</span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Normalisierung von Variablen in ein Intervall von $<span class="co">[</span><span class="ot">0;1</span><span class="co">]</span>$ in @sec-preprocess-normal. Es gehen natürlich auch andere Intervalle, aber das Intervall von 0 bis 1 ist wohl das häufigste Intervall was genutzt wird.</span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Imputation von fehlenden Werte in dem @sec-preprocess-impute. Das ist hier aber nur eine Auswahl. Es gibt sehr viel mehr Möglichkeiten. Du musst auf jeden Fall hier nochmal auf die Referenzseite von <span class="in">`recipes`</span> nach schauen.</span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Erstellung von Kategorien aus einer numerischen Variable in @sec-preprocess-discrete. Dann könnten wir auch die neuen kategorialen Variablen dann auch wieder in eine Dummycodierung überführen.</span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Entfernung von hoch korrelierten Variablen in @sec-preprocess-corr. Hier wäre ich vorsichtig und würde mir den Schritt gerne einmal vorher selber anschauen und dann eventuell Variablen per Hand vor dem *preprocessing* entfernen.</span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a>Einige Vorverarbeitungsschritte kannst du auch in den vorherigen Kapiteln nachlesen. Im Kapitel zur <span class="co">[</span><span class="ot">Transformation von Daten</span><span class="co">](#sec-eda-transform)</span> oder zur <span class="co">[</span><span class="ot">Imputation von fehlenden Werten</span><span class="co">](#sec-missing)</span> findest du noch tiefer greifende Informationen zu den Themen. In diesem Kapitel zeige ich nur, wie du die Verfahren anwendest und gehe nochmal eher oberflächlich auf mögliche Probleme ein.</span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a>::: callout-caution</span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a><span class="fu">## Preprocessing und Tuning</span></span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-32"><a href="#cb123-32" aria-hidden="true" tabindex="-1"></a>Achtung! Du kannst das Preprocessing nicht mit dem Tuning von Algorithmen verbinden. Das heißt, du optimierst deinen Algorithmus immer auf einen Set von pre-prozessierten Daten. Wenn die Daten schlecht sind, dann wird das Tuning auch nicht mehr viel helfen. Deshalb muss man häufig drüber nachdenken, welche Variablen sollen mit in die Analyse und was soll mit den Daten gemacht werden.</span>
<span id="cb123-33"><a href="#cb123-33" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-34"><a href="#cb123-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-35"><a href="#cb123-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb123-36"><a href="#cb123-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-37"><a href="#cb123-37" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb123-38"><a href="#cb123-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-39"><a href="#cb123-39" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb123-40"><a href="#cb123-40" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb123-41"><a href="#cb123-41" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, tidymodels, magrittr, </span></span>
<span id="cb123-42"><a href="#cb123-42" aria-hidden="true" tabindex="-1"></a><span class="in">               janitor,</span></span>
<span id="cb123-43"><a href="#cb123-43" aria-hidden="true" tabindex="-1"></a><span class="in">               conflicted)</span></span>
<span id="cb123-44"><a href="#cb123-44" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-45"><a href="#cb123-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-46"><a href="#cb123-46" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb123-47"><a href="#cb123-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-48"><a href="#cb123-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb123-49"><a href="#cb123-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-50"><a href="#cb123-50" aria-hidden="true" tabindex="-1"></a>In dieser Einführung nehmen wir die infizierten Ferkel als Beispiel um einmal die verschiedenen Verfahren zu demonstrieren. Ich füge hier noch die ID mit ein, die nichts anderes ist, als die Zeilennummer. Dann habe ich noch die ID an den Anfang gestellt. Wir wählen auch nur ein kleines Subset aus den Daten aus, da wir in diesem Kapitel nur Funktion demonstrieren und nicht die Ergebnisse interpretieren.</span>
<span id="cb123-51"><a href="#cb123-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-54"><a href="#cb123-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-55"><a href="#cb123-55" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/infected_pigs.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb123-56"><a href="#cb123-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pig_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb123-57"><a href="#cb123-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(pig_id, infected, age, crp, sex, frailty) <span class="sc">|&gt;</span> </span>
<span id="cb123-58"><a href="#cb123-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(pig_id, infected, <span class="fu">everything</span>())  </span>
<span id="cb123-59"><a href="#cb123-59" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-60"><a href="#cb123-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-61"><a href="#cb123-61" aria-hidden="true" tabindex="-1"></a>In @tbl-ml-basic-pig siehst du nochmal einen Ausschnitt aus den Daten. Wir haben noch die ID mit eingefügt, damit wir einzelne Beobachtungen nachvollziehen können.</span>
<span id="cb123-62"><a href="#cb123-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-65"><a href="#cb123-65" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-66"><a href="#cb123-66" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb123-67"><a href="#cb123-67" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-68"><a href="#cb123-68" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-69"><a href="#cb123-69" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-ml-basic-pig</span></span>
<span id="cb123-70"><a href="#cb123-70" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Auszug aus dem Daten zu den kranken Ferkeln.</span></span>
<span id="cb123-71"><a href="#cb123-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-72"><a href="#cb123-72" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(pig_tbl),</span>
<span id="cb123-73"><a href="#cb123-73" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(pig_tbl)),</span>
<span id="cb123-74"><a href="#cb123-74" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(pig_tbl)) <span class="sc">|&gt;</span> </span>
<span id="cb123-75"><a href="#cb123-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb123-76"><a href="#cb123-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-77"><a href="#cb123-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-78"><a href="#cb123-78" aria-hidden="true" tabindex="-1"></a>Gehen wir jetzt mal die Preprocessing Schritte, die wir für das maschinelle Lernen später brauchen einmal durch. Am Ende des Kapitels schauen wir uns dann die Anwendung nochmal im Ganzen auf den Gummibärchendaten einmal an.</span>
<span id="cb123-79"><a href="#cb123-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-80"><a href="#cb123-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## Das Rezept mit `recipe()`</span></span>
<span id="cb123-81"><a href="#cb123-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-82"><a href="#cb123-82" aria-hidden="true" tabindex="-1"></a>In dem Einführungskapitel zur Klassifikation haben wir uns ja mit dem Rezept und dem Workflow schon mal beschäftigt. Hier möchte ich dann nochmal etwas mehr auf das Rezept eingehen und zeigen, wie das Rezept für Daten dann mit den Daten zusammenkommt. Wir bauen uns wie immer mit der Funktion <span class="in">`recipe()`</span> das Datenrezept in R zusammen. Ich empfehle grundsätzlich vorab einen <span class="in">`select()`</span> Schritt durchzuführen und nur die Variablen in den Daten zu behalten, die wir wirklich brauchen. Dann können wir auch mit dem <span class="in">`.`</span> einfach alle Spalten ohne das Outcome als Prädiktoren definieren.</span>
<span id="cb123-83"><a href="#cb123-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-86"><a href="#cb123-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-87"><a href="#cb123-87" aria-hidden="true" tabindex="-1"></a>pig_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(infected <span class="sc">~</span> ., <span class="at">data =</span> pig_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb123-88"><a href="#cb123-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(pig_id, <span class="at">new_role =</span> <span class="st">"ID"</span>)</span>
<span id="cb123-89"><a href="#cb123-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-90"><a href="#cb123-90" aria-hidden="true" tabindex="-1"></a>pig_rec <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb123-91"><a href="#cb123-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-92"><a href="#cb123-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-93"><a href="#cb123-93" aria-hidden="true" tabindex="-1"></a>Nachdem wir dann unser Rezept definiert haben, können wir auch noch Rollen vergeben. Die Rollen sind nützlich, wenn wir später auf bestimmten Variablen etwas rechnen wollen oder eben nicht. Wir können die Rollen selber definieren und diese Rollen dann auch über die Funktion <span class="in">`has_role()`</span> ein- oder ausschließen. Neben dieser Möglichkeit gezielt Variablen nach der Rolle anzusprechen, können wir auch *alle* Prädiktoren oder *alle* Outcomes auswählen.</span>
<span id="cb123-94"><a href="#cb123-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-95"><a href="#cb123-95" aria-hidden="true" tabindex="-1"></a>Wir haben Funktionen, die die Rolle der Variablen festlegen:</span>
<span id="cb123-96"><a href="#cb123-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-97"><a href="#cb123-97" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`all_predictors()`</span> wendet den Schritt nur auf die Prädiktorvariablen an, daher auf die Features.</span>
<span id="cb123-98"><a href="#cb123-98" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`all_outcomes()`</span> wendet den Schritt nur auf die Outcome-Variable(n) an, daher auf die Label.</span>
<span id="cb123-99"><a href="#cb123-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-100"><a href="#cb123-100" aria-hidden="true" tabindex="-1"></a>Un wir haben Funktionen, die den Typ der Variablen angeben:</span>
<span id="cb123-101"><a href="#cb123-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-102"><a href="#cb123-102" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`all_nominal()`</span> wendet den Schritt auf alle Variablen an, die nominal (kategorisch) sind.</span>
<span id="cb123-103"><a href="#cb123-103" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`all_numeric()`</span> wendet den Schritt auf alle Variablen an, die numerisch sind.</span>
<span id="cb123-104"><a href="#cb123-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-105"><a href="#cb123-105" aria-hidden="true" tabindex="-1"></a>Und natürlich deren Kombination wie <span class="in">`all_nominal_predictors()`</span> oder <span class="in">`all_numeric_predictors()`</span>, die dann eben auf die Prädiktoren, die nominal also Faktoren oder Gruppen repräsentieren oder eben numerischen Variablen, angewendet werden. Du wirst die Anwendung gleich später in den Rezeptschritten sehen, da macht die Sache dann sehr viel mehr Sinn.</span>
<span id="cb123-106"><a href="#cb123-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-107"><a href="#cb123-107" aria-hidden="true" tabindex="-1"></a>Nun ist es aber auch so, dass es bei dem Rezept auf die Reihenfolge der einzelnen Schritte ankommt. Die Reihenfolge der Zutaten und damit der Rezeptschritte sind ja auch beim Kuchenbacken sehr wichtig! Da das Rezept wirklich in der Reihenfolge durchgeführt wird, wie du die einzelnen Schritte angibst, empfiehlt sich folgende Reihenfolge. Du musst natürlich nicht jeden dieser Schritte auch immer durchführen.</span>
<span id="cb123-108"><a href="#cb123-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-109"><a href="#cb123-109" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb123-110"><a href="#cb123-110" aria-hidden="true" tabindex="-1"></a>Bitte die Hinweise zur Ordnung der Schritte eines Rezeptes beachten: <span class="co">[</span><span class="ot">Ordering of steps</span><span class="co">](https://recipes.tidymodels.org/articles/Ordering.html)</span></span>
<span id="cb123-111"><a href="#cb123-111" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-112"><a href="#cb123-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-113"><a href="#cb123-113" aria-hidden="true" tabindex="-1"></a>0)  Entfernen von Beobachtungen mit einem fehlenden Eintrag für das Label.</span>
<span id="cb123-114"><a href="#cb123-114" aria-hidden="true" tabindex="-1"></a>1)  Imputation von fehlenden Werten in den Daten.</span>
<span id="cb123-115"><a href="#cb123-115" aria-hidden="true" tabindex="-1"></a>2)  Individuelle Transformationen auf einzelnen Spalten.</span>
<span id="cb123-116"><a href="#cb123-116" aria-hidden="true" tabindex="-1"></a>3)  Umwandeln von einzelnen numerischen Variablen in eine diskrete Variable.</span>
<span id="cb123-117"><a href="#cb123-117" aria-hidden="true" tabindex="-1"></a>4)  Erstellung der Dummyvariablen für jede diskrete Variable.</span>
<span id="cb123-118"><a href="#cb123-118" aria-hidden="true" tabindex="-1"></a>5)  Eventuell Berücksichtigung der Interaktion zwischen Variablen.</span>
<span id="cb123-119"><a href="#cb123-119" aria-hidden="true" tabindex="-1"></a>6)  Transformation der numerischen Variablen mit zum Beispiel der Standarisierung oder Normalisierung.</span>
<span id="cb123-120"><a href="#cb123-120" aria-hidden="true" tabindex="-1"></a>7)  Multivariate Transformationen über alle Spalten hinweg wie zum Beispiel PCA.</span>
<span id="cb123-121"><a href="#cb123-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-122"><a href="#cb123-122" aria-hidden="true" tabindex="-1"></a>Am Ende wollen wir dann natürlich auch die Daten wiederhaben. Das heißt, wir bauen ja das Rezept auf einem Datensatz. Wenn wir dann das fertige Rezept in die Funktion <span class="in">`prep()`</span> pipen können wir über die Funktion <span class="in">`juice()`</span> den ursprünglichen jetzt aber transformierten Datensatz wieder erhalten. Wenn wir das Rezept auf einen *neuen* Datensatz anwenden wollen, dann nutzen wir die Funktion <span class="in">`bake()`</span>. Mit einem neuen Datensatz meine ich natürlich einen <span class="co">[</span><span class="ot">Split in Training- und Testdaten</span><span class="co">](#sec-data-splitting)</span> von dem ursprünglichen Datensatz. In dem neuen Datensatz müssen natürlich alle Spaltennamen auch enthalten sein, sonst macht die Sache recht wenig Sinn.</span>
<span id="cb123-123"><a href="#cb123-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-124"><a href="#cb123-124" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fehlende Werte im $Y$</span></span>
<span id="cb123-125"><a href="#cb123-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-126"><a href="#cb123-126" aria-hidden="true" tabindex="-1"></a>Wenn wir mit maschinellen Lernverfahren rechnen, dann dürfen wir im Outcome $Y$ oder dem Label keine fehlenden Werte vorliegen haben. Das Outcome ist in dem Sinne hielig, dass wir hier keine Werte imputieren. Wir müssen daher alle Zeilen und damit Beobachtungen aus den Daten entfernen in denen ein <span class="in">`NA`</span> im Outcome vorliegt. Wir können dazu die Funktion <span class="in">`drop_na()`</span> nutzen. Wir können in der Funktion spezifizieren, dass nur für eine Spalte die <span class="in">`NA`</span> entfernt werden sollen. In unserem Beispiel für die Ferkeldaten wäre es dann die Spalte <span class="in">`infected`</span>.</span>
<span id="cb123-127"><a href="#cb123-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-130"><a href="#cb123-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-131"><a href="#cb123-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb123-132"><a href="#cb123-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-133"><a href="#cb123-133" aria-hidden="true" tabindex="-1"></a><span class="fu">drop_na</span>(infected)</span>
<span id="cb123-134"><a href="#cb123-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-135"><a href="#cb123-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-136"><a href="#cb123-136" aria-hidden="true" tabindex="-1"></a>Aktuell haben wir ja keine fehlenden Werte in der Spalte vorliegen, so dass wir die Funktion hier nicht benötigen. In dem Beispiel zu den Gummibärchendaten wollen wir das Geschlecht vorhersagen und hier haben wir dann fehlende Werte im Outcome. Mit der Funktion <span class="in">`drop_na(gender)`</span> entfernen wir dann alle Beobachtungen aus den Daten mit einem fehlenden Eintrag für das Geschlecht.</span>
<span id="cb123-137"><a href="#cb123-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-138"><a href="#cb123-138" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dummycodierung von $X$ {#sec-preprocess-dummy}</span></span>
<span id="cb123-139"><a href="#cb123-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-140"><a href="#cb123-140" aria-hidden="true" tabindex="-1"></a>Wir werden immer häufiger davon sprechen, dass wir alle kategorialen Daten in *Dummies* überführen müssen. Das heißt, wir dürfen keine Faktoren mehr in unseren Daten haben. Wir wandeln daher alle Variablen, die ein Faktor sind, in Dummyspalten um. Die Idee von der Dummyspalte ist die gleiche wie bei der multiplen Regression. Da ich aber nicht davon ausgehe, dass du dir alles hier durchgelesen hast, kommt hier die kurze Einführung zur Dummycodierung.</span>
<span id="cb123-141"><a href="#cb123-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-142"><a href="#cb123-142" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb123-143"><a href="#cb123-143" aria-hidden="true" tabindex="-1"></a>Mehr Information zu <span class="co">[</span><span class="ot">Create Traditional Dummy Variables</span><span class="co">](https://recipes.tidymodels.org/reference/step_dummy.html)</span></span>
<span id="cb123-144"><a href="#cb123-144" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-145"><a href="#cb123-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-146"><a href="#cb123-146" aria-hidden="true" tabindex="-1"></a>Die Dummycodierung wird nur auf den Features durchgeführt. Dabei werden nur Spalten erschaffen, die $0/1$, für Level vorhanden oder Level nicht vorhanden, beinhalten. Wir werden also nur alle $x$ in Dummies umwandeln, die einem Faktor entsprechen. Dafür nutzen wir dann später eine Funktion, hier machen wir das einmal zu Veranschaulichung per Hand. In @tbl-class-basic-dummy-01 haben wir einen kleinen Ausschnitt unser Schweinedaten gegeben. Wir wollen zuerst die Spalte <span class="in">`sex`</span> in eine Dummycodierung umwandeln.</span>
<span id="cb123-147"><a href="#cb123-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-148"><a href="#cb123-148" aria-hidden="true" tabindex="-1"></a>| infected | age |  sex   |  frailty  |</span>
<span id="cb123-149"><a href="#cb123-149" aria-hidden="true" tabindex="-1"></a>|:--------:|:---:|:------:|:---------:|</span>
<span id="cb123-150"><a href="#cb123-150" aria-hidden="true" tabindex="-1"></a>|    1     | 24  |  male  |  robust   |</span>
<span id="cb123-151"><a href="#cb123-151" aria-hidden="true" tabindex="-1"></a>|    0     | 36  |  male  | pre-frail |</span>
<span id="cb123-152"><a href="#cb123-152" aria-hidden="true" tabindex="-1"></a>|    0     | 21  | female |   frail   |</span>
<span id="cb123-153"><a href="#cb123-153" aria-hidden="true" tabindex="-1"></a>|    1     | 34  | female |  robust   |</span>
<span id="cb123-154"><a href="#cb123-154" aria-hidden="true" tabindex="-1"></a>|    1     | 27  |  male  |   frail   |</span>
<span id="cb123-155"><a href="#cb123-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-156"><a href="#cb123-156" aria-hidden="true" tabindex="-1"></a>: Beispieldatensatz für die Dummycodierung. Wir wollen die Spalten <span class="in">`sex`</span> und <span class="in">`frailty`</span> als Dummyspalten haben. {#tbl-class-basic-dummy-01}</span>
<span id="cb123-157"><a href="#cb123-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-158"><a href="#cb123-158" aria-hidden="true" tabindex="-1"></a>In der @tbl-class-basic-dummy-02 sehen wir das Ergebnis für die Dummycodierung der Spalte <span class="in">`sex`</span> in die Dummyspalte <span class="in">`sex_male`</span>. Wir haben in der Dummyspalte nur noch die Information, ob das Ferkel mänlich ist oder nicht. Wenn wir eine Eins in der Spalte finden, dann ist das Ferkel männlich. Wenn wir eine Null vorfinden, dann ist das Ferkel nicht männlich also weiblich. Das *Nicht* müssen wir uns dann immer merken.</span>
<span id="cb123-159"><a href="#cb123-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-160"><a href="#cb123-160" aria-hidden="true" tabindex="-1"></a>| infected | age | sex_male |</span>
<span id="cb123-161"><a href="#cb123-161" aria-hidden="true" tabindex="-1"></a>|:--------:|:---:|:--------:|</span>
<span id="cb123-162"><a href="#cb123-162" aria-hidden="true" tabindex="-1"></a>|    1     | 24  |    1     |</span>
<span id="cb123-163"><a href="#cb123-163" aria-hidden="true" tabindex="-1"></a>|    0     | 36  |    1     |</span>
<span id="cb123-164"><a href="#cb123-164" aria-hidden="true" tabindex="-1"></a>|    0     | 21  |    0     |</span>
<span id="cb123-165"><a href="#cb123-165" aria-hidden="true" tabindex="-1"></a>|    1     | 34  |    0     |</span>
<span id="cb123-166"><a href="#cb123-166" aria-hidden="true" tabindex="-1"></a>|    1     | 27  |    1     |</span>
<span id="cb123-167"><a href="#cb123-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-168"><a href="#cb123-168" aria-hidden="true" tabindex="-1"></a>: Ergebnis der Dummycodierung der Spalte <span class="in">`sex`</span> zu der Spalte <span class="in">`sex_male`</span>. {#tbl-class-basic-dummy-02}</span>
<span id="cb123-169"><a href="#cb123-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-170"><a href="#cb123-170" aria-hidden="true" tabindex="-1"></a>In der @tbl-class-basic-dummy-03 betrachten wir einen komplexeren Fall. Wenn wir eine Spalte vorliegen haben mit mehr als zwei Leveln, wie zum Beispiel die Spalte <span class="in">`frailty`</span>, dann erhalten wir zwei Spalten wieder. Die Spalte <span class="in">`frailty_robust`</span> beschreibt das Vorhandensein des Levels <span class="in">`robust`</span> und die Spalte <span class="in">`frailty_pre-frail`</span> das Vorhandensein des Levels <span class="in">`pre-frail`</span>. Und was ist mit dem Level <span class="in">`frail`</span>? Das Level wir durch das Nichtvorhandensein von <span class="in">`robust`</span> und dem Nichtvorhandensein von <span class="in">`pre-frail`</span> abgebildet. Beinhalten beide Spalten die Null, so ist das Ferkel <span class="in">`frail`</span>.</span>
<span id="cb123-171"><a href="#cb123-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-172"><a href="#cb123-172" aria-hidden="true" tabindex="-1"></a>| infected | age | frailty_robust | frailty_pre-frail |</span>
<span id="cb123-173"><a href="#cb123-173" aria-hidden="true" tabindex="-1"></a>|:--------:|:---:|:--------------:|:-----------------:|</span>
<span id="cb123-174"><a href="#cb123-174" aria-hidden="true" tabindex="-1"></a>|    1     | 24  |       1        |         0         |</span>
<span id="cb123-175"><a href="#cb123-175" aria-hidden="true" tabindex="-1"></a>|    0     | 36  |       0        |         1         |</span>
<span id="cb123-176"><a href="#cb123-176" aria-hidden="true" tabindex="-1"></a>|    0     | 21  |       0        |         0         |</span>
<span id="cb123-177"><a href="#cb123-177" aria-hidden="true" tabindex="-1"></a>|    1     | 34  |       1        |         0         |</span>
<span id="cb123-178"><a href="#cb123-178" aria-hidden="true" tabindex="-1"></a>|    1     | 27  |       0        |         0         |</span>
<span id="cb123-179"><a href="#cb123-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-180"><a href="#cb123-180" aria-hidden="true" tabindex="-1"></a>: Ergebnis der Dummycodierung für eine Spalte mit mehr als zwei Leveln. {#tbl-class-basic-dummy-03}</span>
<span id="cb123-181"><a href="#cb123-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-182"><a href="#cb123-182" aria-hidden="true" tabindex="-1"></a>Wenn wir einen Faktor mit $l$ Leveln haben, erhalten wir immer $l-1$ Spalten nach der Dummycodierung wieder.</span>
<span id="cb123-183"><a href="#cb123-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-184"><a href="#cb123-184" aria-hidden="true" tabindex="-1"></a>Wir nutzen dann die Funktion <span class="in">`step_dummy()`</span> um eine Dummaycodierung für alle nominalen Prädiktoren spezifiziert durch <span class="in">`all_nominal_predictors()`</span> durchzuführen. Das tolle ist hier, dass wir durch die Helferfunktionen immer genau sagen können welche Typen von Spalten bearbeitet werden sollen.</span>
<span id="cb123-185"><a href="#cb123-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-188"><a href="#cb123-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-189"><a href="#cb123-189" aria-hidden="true" tabindex="-1"></a>pig_dummy_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb123-190"><a href="#cb123-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>()) </span>
<span id="cb123-191"><a href="#cb123-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-192"><a href="#cb123-192" aria-hidden="true" tabindex="-1"></a>pig_dummy_rec </span>
<span id="cb123-193"><a href="#cb123-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-194"><a href="#cb123-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-195"><a href="#cb123-195" aria-hidden="true" tabindex="-1"></a>Wenn wir das Rezept fertig haben, dann können wir uns die Daten einmal anschauen. Durch die Funktion <span class="in">`prep()`</span> initialisieren wir das Rezept und mit der Funktion <span class="in">`juice()`</span> teilen wir mit, dass wir das Rezept gleich auf die Trainingsdaten mit denen wir das Rezept gebaut haben, anweden wollen.</span>
<span id="cb123-196"><a href="#cb123-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-199"><a href="#cb123-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-200"><a href="#cb123-200" aria-hidden="true" tabindex="-1"></a>pig_dummy_rec <span class="sc">|&gt;</span></span>
<span id="cb123-201"><a href="#cb123-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb123-202"><a href="#cb123-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() </span>
<span id="cb123-203"><a href="#cb123-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-204"><a href="#cb123-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-205"><a href="#cb123-205" aria-hidden="true" tabindex="-1"></a>Die Dummycodierung verwandelt alle nominalen Spalten in mehrere $0/1$ Spalten um. Das ermöglicht den Algorithmen auch mit nominalen Spalten eine Vorhersage zu machen.</span>
<span id="cb123-206"><a href="#cb123-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-207"><a href="#cb123-207" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zero Variance Spalten {#sec-preprocess-zv}</span></span>
<span id="cb123-208"><a href="#cb123-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-209"><a href="#cb123-209" aria-hidden="true" tabindex="-1"></a>Ein häufiges Problem ist, dass wir manchmal Spalten in unseren Daten haben in denen nur ein Eintrag steht. Das heißt wir haben überall die gleiche Zahl oder eben das gelche Wort stehen. Das tritt häufiger auf, wenn wir uns riesige Datenmengen von extern herunterladen. Manchmal haben wir so viele Spalten, dass wir die Daten gr nicht richtig überblicken. Oder aber, wir haben nach einer Transformation nur noch die gleiche Zahl. Dagegen können wir filtern.</span>
<span id="cb123-210"><a href="#cb123-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-211"><a href="#cb123-211" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb123-212"><a href="#cb123-212" aria-hidden="true" tabindex="-1"></a>Mehr Information zu <span class="co">[</span><span class="ot">Zero Variance Filter</span><span class="co">](https://recipes.tidymodels.org/reference/step_zv.html)</span> und <span class="co">[</span><span class="ot">Near-Zero Variance Filter</span><span class="co">](https://recipes.tidymodels.org/reference/step_nzv.html)</span></span>
<span id="cb123-213"><a href="#cb123-213" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-214"><a href="#cb123-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-215"><a href="#cb123-215" aria-hidden="true" tabindex="-1"></a>Wir haben die Auswahl zwischen <span class="in">`step_zv()`</span>, die Funktion entfernt Spalten mit einer Vaianz von Null. Das mag seltener vorkommen, als eine sehr kleine Varianz. Hier hilft die Funktion <span class="in">`step_nzv()`</span>. Wir können beide Funktionen auf alle Arten von Prädiktoren anwenden, nur eben nicht *gleichzeitig*.</span>
<span id="cb123-216"><a href="#cb123-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-219"><a href="#cb123-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-220"><a href="#cb123-220" aria-hidden="true" tabindex="-1"></a>pig_zero_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb123-221"><a href="#cb123-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb123-222"><a href="#cb123-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_nzv</span>(<span class="fu">all_predictors</span>())</span>
<span id="cb123-223"><a href="#cb123-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-224"><a href="#cb123-224" aria-hidden="true" tabindex="-1"></a>pig_zero_rec</span>
<span id="cb123-225"><a href="#cb123-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-226"><a href="#cb123-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-227"><a href="#cb123-227" aria-hidden="true" tabindex="-1"></a>Da wir in unseren Daten mit den infizierten Ferkeln jetzt keine Spalten mit einer sehr kleinen Varianz haben, passiert auch nichts, wenn wir die Funktion auf unsere Daten anwenden würden. Demensprechend sparen wir uns an dieser Stelle auch die Datengenerierung.</span>
<span id="cb123-228"><a href="#cb123-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-229"><a href="#cb123-229" aria-hidden="true" tabindex="-1"></a><span class="fu">## Standardisieren $\mathcal{N}(0,1)$ {#sec-preprocess-standard}</span></span>
<span id="cb123-230"><a href="#cb123-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-231"><a href="#cb123-231" aria-hidden="true" tabindex="-1"></a>In dem Kapitel zu der <span class="co">[</span><span class="ot">Transformation von Daten</span><span class="co">](#sec-eda-transform)</span> haben wir ja schon von der Standardisierung gelesen und uns mit den gängigen Funktion beschäftigt. Deshalb hier nur kurz die Schritte und Funktionen, die wir mit den Rezepten machen können. Zum einen können wir nur die Daten mit der Funktion <span class="in">`step_scale()`</span> skalieren, dass heißt auf eine Standardabweichung von 1 bringen. Oder aber zum anderen nutzen wir die Funktion <span class="in">`scale_center()`</span> um die Daten alle auf einen Mittelwert von 0 zu schieben. Manchmal wollen wir nur den einen Schritt getrennt von dem anderen Schritt durchführen. Beide Schritte können wir dann einfach auf allen *numerischen* Prädiktoren durchführen.</span>
<span id="cb123-232"><a href="#cb123-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-233"><a href="#cb123-233" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb123-234"><a href="#cb123-234" aria-hidden="true" tabindex="-1"></a>Mehr Information zu <span class="co">[</span><span class="ot">Scaling Numeric Data</span><span class="co">](https://recipes.tidymodels.org/reference/step_scale.html)</span> sowie <span class="co">[</span><span class="ot">Centering Numeric Data</span><span class="co">](https://recipes.tidymodels.org/reference/step_center.html)</span> und <span class="co">[</span><span class="ot">Center and Scale Numeric Data</span><span class="co">](https://recipes.tidymodels.org/reference/step_normalize.html)</span></span>
<span id="cb123-235"><a href="#cb123-235" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-236"><a href="#cb123-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-239"><a href="#cb123-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-240"><a href="#cb123-240" aria-hidden="true" tabindex="-1"></a>pig_scale_center_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb123-241"><a href="#cb123-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_center</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb123-242"><a href="#cb123-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_scale</span>(<span class="fu">all_numeric_predictors</span>()) </span>
<span id="cb123-243"><a href="#cb123-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-244"><a href="#cb123-244" aria-hidden="true" tabindex="-1"></a>pig_scale_center_rec </span>
<span id="cb123-245"><a href="#cb123-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-246"><a href="#cb123-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-247"><a href="#cb123-247" aria-hidden="true" tabindex="-1"></a>Wenn wir aber auf eine getrennte Durchführung keine Lust haben, gibt es auch die etwas schief benannte Funktion *step_normalize()*, die beide Schritte kombiniert und uns damit die Daten auf eine Standardnormalverteilung transformiert. Ich persönlich nutze dann meist die zweite Variante, dann hat man alles in einem Schritt zusammen. Das hängt aber sehr vom Anwendungsfall ab und du musst dann schauen, was besser für dich und deine Daten dann passt.</span>
<span id="cb123-248"><a href="#cb123-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-251"><a href="#cb123-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-252"><a href="#cb123-252" aria-hidden="true" tabindex="-1"></a>pig_scale_center_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb123-253"><a href="#cb123-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_numeric_predictors</span>()) </span>
<span id="cb123-254"><a href="#cb123-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-255"><a href="#cb123-255" aria-hidden="true" tabindex="-1"></a>pig_scale_center_rec </span>
<span id="cb123-256"><a href="#cb123-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-257"><a href="#cb123-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-258"><a href="#cb123-258" aria-hidden="true" tabindex="-1"></a>Jetzt können wir noch die Daten generieren und sehen, dass wir alle numerischen Spalten in eine Standardnormalverteilung transformiert haben. Wir runden hier nochmal alle numerischen Variablen, damit wir nicht so einen breiten Datensatz erhalten. Das hat jetzt aber eher was mit der Ausgabe hier auf der Webseite zu tun. Wir müssen nicht runden um die Daten dann zu verwenden.</span>
<span id="cb123-259"><a href="#cb123-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-262"><a href="#cb123-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-263"><a href="#cb123-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-264"><a href="#cb123-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-265"><a href="#cb123-265" aria-hidden="true" tabindex="-1"></a>pig_scale_center_rec <span class="sc">|&gt;</span></span>
<span id="cb123-266"><a href="#cb123-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb123-267"><a href="#cb123-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() <span class="sc">|&gt;</span> </span>
<span id="cb123-268"><a href="#cb123-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>))</span>
<span id="cb123-269"><a href="#cb123-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-270"><a href="#cb123-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-271"><a href="#cb123-271" aria-hidden="true" tabindex="-1"></a><span class="fu">## Normalisieren $[0; 1]$ {#sec-preprocess-normal}</span></span>
<span id="cb123-272"><a href="#cb123-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-273"><a href="#cb123-273" aria-hidden="true" tabindex="-1"></a>Auch bei der Normalisierung möchte ich wieder auf das Kapitel zum <span class="co">[</span><span class="ot">Transformation von Daten</span><span class="co">](#sec-eda-transform)</span> verweisen. In dem <span class="in">`tidymodels`</span> Universum heißt dann das Normalisieren, also die Daten auf eine Spannweite zwischen 0 und 1 bringen, dann eben <span class="in">`step_range()`</span>. Das ist natürlich dann schön generalisiert. Wir könnten uns auch andere Spannweiten überlegen, aber hier nehmen wir natürlich immer den Klassiker auf eine Spannweite $<span class="co">[</span><span class="ot">0; 1</span><span class="co">]</span>$. Unsere Daten liegen dann nach der Normalisierung mit der Funktion <span class="in">`step_range()`</span> zwischen 0 und 1. Wir können die Normalisierung natürlich nur auf numerischen Variablen durchführen.</span>
<span id="cb123-274"><a href="#cb123-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-275"><a href="#cb123-275" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb123-276"><a href="#cb123-276" aria-hidden="true" tabindex="-1"></a>Mehr Information zu <span class="co">[</span><span class="ot">Scaling Numeric Data to a Specific Range</span><span class="co">](https://recipes.tidymodels.org/reference/step_range.html)</span></span>
<span id="cb123-277"><a href="#cb123-277" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-278"><a href="#cb123-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-281"><a href="#cb123-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-282"><a href="#cb123-282" aria-hidden="true" tabindex="-1"></a>pig_range_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb123-283"><a href="#cb123-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_range</span>(<span class="fu">all_numeric_predictors</span>(), <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>) </span>
<span id="cb123-284"><a href="#cb123-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-285"><a href="#cb123-285" aria-hidden="true" tabindex="-1"></a>pig_range_rec </span>
<span id="cb123-286"><a href="#cb123-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-287"><a href="#cb123-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-288"><a href="#cb123-288" aria-hidden="true" tabindex="-1"></a>Auch hier können wir dann die Daten generieren und uns einmal anschauen. Im Gegensatz zu der Standardisierung treten jetzt in unseren Spalten keine negativen Werte mehr auf. Wir runden hier ebenfalls nochmal alle numerischen Variablen, damit wir nicht so einen breiten Datensatz erhalten. Das hat jetzt aber eher was mit der Ausgabe hier auf der Webseite zu tun. Wir müssen nicht runden um die Daten dann zu verwenden.</span>
<span id="cb123-289"><a href="#cb123-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-292"><a href="#cb123-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-293"><a href="#cb123-293" aria-hidden="true" tabindex="-1"></a>pig_range_rec <span class="sc">|&gt;</span></span>
<span id="cb123-294"><a href="#cb123-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb123-295"><a href="#cb123-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() <span class="sc">|&gt;</span> </span>
<span id="cb123-296"><a href="#cb123-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>))</span>
<span id="cb123-297"><a href="#cb123-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-298"><a href="#cb123-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-299"><a href="#cb123-299" aria-hidden="true" tabindex="-1"></a><span class="fu">## Imputieren von fehlenden Werten {#sec-preprocess-impute}</span></span>
<span id="cb123-300"><a href="#cb123-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-301"><a href="#cb123-301" aria-hidden="true" tabindex="-1"></a>In dem Kapitel zur <span class="co">[</span><span class="ot">Imputation von fehlenden Werten</span><span class="co">](#sec-missing)</span> haben wir uns mit verschiedenen Methoden zur Imputation von fehlenden Werten beschäftigt. Auch gibt es verschiedene Rezepte um die Imputation durchzuführen. Wir haben also wieder die Qual der Wahl welchen Algorithmus wir nutzen wollen. Da wir wieder zwischen numerischen und nominalen Variablen unterscheiden müssen, haben wir immer zwei Imputationsschritte. Ich mache es mir hier sehr leicht und wähle die <span class="in">`mean`</span> Imputation für die numerischen Variablen aus und die <span class="in">`mode`</span> Imputation für die nominalen Variablen. Das sind natürlich die beiden simpelsten Imputation die gehen. Ich würde dir empfehlen nochmal die Alternativen anzuschauen und *vorab* auf jeden Fall nochmal dir die fehlenden Daten zu visualisieren. Es macht auch hier keinen Sinn nicht vorhandene Spalten mit künstlichen Daten zu füllen.</span>
<span id="cb123-302"><a href="#cb123-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-303"><a href="#cb123-303" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb123-304"><a href="#cb123-304" aria-hidden="true" tabindex="-1"></a>Mehr Information zu <span class="co">[</span><span class="ot">Step Functions - Imputation</span><span class="co">](https://recipes.tidymodels.org/reference/index.html#step-functions-imputation)</span></span>
<span id="cb123-305"><a href="#cb123-305" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-306"><a href="#cb123-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-307"><a href="#cb123-307" aria-hidden="true" tabindex="-1"></a>Da wir es uns in diesem Schritt sehr einfach machen, nutzen wir die Funktionen <span class="in">`step_impute_mean()`</span> auf allen numerischen Variablen und die Funktion <span class="in">`step_impute_mode()`</span> auf alle nominalen Variablen. Es geht wie immer natürlich besser, das heißt auch komplexerer. Hier ist es auch wieder schwierig zu sagen, welche Methode die *beste* Methode zur Imputation von fehlenden Werten ist. Hier hilft es dann nichts, du musst dir die imputierten Daten anschauen.</span>
<span id="cb123-308"><a href="#cb123-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-311"><a href="#cb123-311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-312"><a href="#cb123-312" aria-hidden="true" tabindex="-1"></a>pig_imp_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb123-313"><a href="#cb123-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(<span class="fu">all_numeric_predictors</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb123-314"><a href="#cb123-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mode</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb123-315"><a href="#cb123-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-316"><a href="#cb123-316" aria-hidden="true" tabindex="-1"></a>pig_imp_rec </span>
<span id="cb123-317"><a href="#cb123-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-318"><a href="#cb123-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-319"><a href="#cb123-319" aria-hidden="true" tabindex="-1"></a>Dann können wir uns auch schon die Daten generieren. Wir sehen, dass wir keine fehlenden Werte mehr in unseren Daten vorliegen haben. Wie immer können wir uns die gerundeten Daten dann einmal anschauen.</span>
<span id="cb123-320"><a href="#cb123-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-323"><a href="#cb123-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-324"><a href="#cb123-324" aria-hidden="true" tabindex="-1"></a>pig_imp_rec  <span class="sc">|&gt;</span></span>
<span id="cb123-325"><a href="#cb123-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb123-326"><a href="#cb123-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() <span class="sc">|&gt;</span> </span>
<span id="cb123-327"><a href="#cb123-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>))</span>
<span id="cb123-328"><a href="#cb123-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-329"><a href="#cb123-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-330"><a href="#cb123-330" aria-hidden="true" tabindex="-1"></a>Die Imputationrezepte bieten sich natürlich auch für die ganz normale Statistik an. Du kannst ja dann mit den imputierten Daten rechnen was du möchtest. Wir nutzen die Daten hier ja nur im Kontext der Klassifikation. Es gingt natürlich auch die Daten für die lineare Regression zu nutzen.</span>
<span id="cb123-331"><a href="#cb123-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-332"><a href="#cb123-332" aria-hidden="true" tabindex="-1"></a><span class="fu">## Kategorisierung {#sec-preprocess-discrete}</span></span>
<span id="cb123-333"><a href="#cb123-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-334"><a href="#cb123-334" aria-hidden="true" tabindex="-1"></a>Manchmal wollen wir nicht mit numerischen Variablen arbeiten sondern uns nominale Variablen erschaffen. Das sollten wir eigentlich nicht so häufig tun, denn die numerischen Variablen haben meist mehr Informationen als nominale Variablen. Wir müssen dann ja unsere nominalen Daten dann wieder in Dummies umkodieren. Das sind dann zwei zusätzliche Schritte. Aber wie immer in der Datenanalyse, es gibt Fälle in denen es Sinn macht und wir eben keine numerischen Variablen haben wollen. Dann können wir eben die Funktion <span class="in">`step_discretize()`</span> nutzen um verschiedene Gruppen oder <span class="in">`bins`</span> (eng. *Dosen*) zu bilden. Das <span class="co">[</span><span class="ot">R Paket `{embed}`</span><span class="co">](https://cran.r-project.org/web/packages/embed/embed.pdf)</span> bietet noch eine Vielzahl an weiteren Funktionen für die Erstellung von kategorialen Variablen.</span>
<span id="cb123-335"><a href="#cb123-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-336"><a href="#cb123-336" aria-hidden="true" tabindex="-1"></a>Es kann natürlich sinnvoll sein aus einer numerischen Outcomevariablen eine binäre Outcomevariable zu erzeugen. Dann können wir wieder eine Klassifikation rechnen. Aber auch hier musst du überlegen, ob das binäre Outcome dann dem numerischen Outcome inhaltlich entspricht. Wir können natürlich aus dem numerischen Lichteinfall die binäre Variable wenig/viel Licht transformieren. Dann muss die neue binäre Variable aber auch zur Fragestellung passen. Oder aus Noten auf der Likert-Skala nur zwei Noten mit schlecht/gut erschaffen.</span>
<span id="cb123-337"><a href="#cb123-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-338"><a href="#cb123-338" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb123-339"><a href="#cb123-339" aria-hidden="true" tabindex="-1"></a>Mehr Information zu <span class="co">[</span><span class="ot">Step Functions - Discretization</span><span class="co">](https://recipes.tidymodels.org/reference/index.html#step-functions-discretization)</span></span>
<span id="cb123-340"><a href="#cb123-340" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-341"><a href="#cb123-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-342"><a href="#cb123-342" aria-hidden="true" tabindex="-1"></a>Wir wollen jetzt die Spalten <span class="in">`age`</span> und <span class="in">`crp`</span> in mindestens drei gleich große Gruppen aufspalten. Wenn wir mehr Gruppen brauchen, dann werden es mehr Gruppen werden. Das wichtige ist hier, dass wir gleich große Gruppen haben wollen.</span>
<span id="cb123-343"><a href="#cb123-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-346"><a href="#cb123-346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-347"><a href="#cb123-347" aria-hidden="true" tabindex="-1"></a>pig_discrete_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span></span>
<span id="cb123-348"><a href="#cb123-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_discretize</span>(crp, age, <span class="at">min_unique =</span> <span class="dv">3</span>)</span>
<span id="cb123-349"><a href="#cb123-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-350"><a href="#cb123-350" aria-hidden="true" tabindex="-1"></a>pig_discrete_rec </span>
<span id="cb123-351"><a href="#cb123-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-352"><a href="#cb123-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-353"><a href="#cb123-353" aria-hidden="true" tabindex="-1"></a>Und dann können wir uns auch schon die Daten generieren. Wir immer gibt es noch andere Möglichkeiten um aus einer numerischen Spalte eine nominale Spalte zu generieren. Du musst dann abgleichen, welche Variante dir am besten passt.</span>
<span id="cb123-354"><a href="#cb123-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-357"><a href="#cb123-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-358"><a href="#cb123-358" aria-hidden="true" tabindex="-1"></a>pig_discrete_tbl <span class="ot">&lt;-</span> pig_discrete_rec  <span class="sc">|&gt;</span></span>
<span id="cb123-359"><a href="#cb123-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb123-360"><a href="#cb123-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() </span>
<span id="cb123-361"><a href="#cb123-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-362"><a href="#cb123-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-363"><a href="#cb123-363" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass wir dann jeweils vier <span class="in">`bins`</span> erhalten mit gut 25% Beobachtungen in jedem <span class="in">`bin`</span>. Wir können dann mit der neuen Variable weiterrechnen und zum Beispiel diese neue nominale Variable dann in eine Dummykodierung umwandeln. Hier siehst du, dass du gewisse Schritte in einem Rezept in der richtigen Reihenfolge durchführen musst.</span>
<span id="cb123-364"><a href="#cb123-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-367"><a href="#cb123-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-368"><a href="#cb123-368" aria-hidden="true" tabindex="-1"></a>pig_discrete_tbl <span class="sc">|&gt;</span> <span class="fu">pull</span>(crp) <span class="sc">|&gt;</span> <span class="fu">tabyl</span>()</span>
<span id="cb123-369"><a href="#cb123-369" aria-hidden="true" tabindex="-1"></a>pig_discrete_tbl <span class="sc">|&gt;</span> <span class="fu">pull</span>(age) <span class="sc">|&gt;</span> <span class="fu">tabyl</span>()</span>
<span id="cb123-370"><a href="#cb123-370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-371"><a href="#cb123-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-372"><a href="#cb123-372" aria-hidden="true" tabindex="-1"></a><span class="fu">## Korrelation zwischen Variablen {#sec-preprocess-corr}</span></span>
<span id="cb123-373"><a href="#cb123-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-374"><a href="#cb123-374" aria-hidden="true" tabindex="-1"></a>Als einer der letzten Schritte für die Aufreinigung der Daten schauen wir uns die Korrelation an. Du kannst dir die Korrelation im Kapitel @sec-lin-reg-corr nochmal näher anlesen. Wie schon bei der Imputation kann ich nur davon abraten einfach so den Filter auf die Daten anzuwenden. Es ist besser sich die numerischen Variablen einmal zu visualisieren und die Korrelation einmal zu berechnen. Das blinde Filtern von Variablen macht auf jeden Fall keinen Sinn!</span>
<span id="cb123-375"><a href="#cb123-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-376"><a href="#cb123-376" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb123-377"><a href="#cb123-377" aria-hidden="true" tabindex="-1"></a>Mehr Information zu <span class="co">[</span><span class="ot">High Correlation Filter</span><span class="co">](https://recipes.tidymodels.org/reference/step_corr.html)</span></span>
<span id="cb123-378"><a href="#cb123-378" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-379"><a href="#cb123-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-380"><a href="#cb123-380" aria-hidden="true" tabindex="-1"></a>In der Klassifikation müssen wir schauen, dass wir keine numerischen Variablen haben, die im Prinzip das gleiche Aussagen also hoch miteinander korreliert sind. Die Variablen müssen wir dann entfernen. Oder besser eine von den beiden Variablen. Wir können den Schritt mit der Funktion <span class="in">`step_corr()`</span> durchführen und einen Threshold für die Entfernung von numerischen Variablen festlegen. Wir nehmen hier ein $\rho = 0.5$. Nochmal, das ist nicht sehr gut blind Vairablen zu entfernen. Schaue dir vorher einen paarweisen Korrelationsplot an und entscheide dann, ob du und welche Variablen du entfernen möchtest.</span>
<span id="cb123-381"><a href="#cb123-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-384"><a href="#cb123-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-385"><a href="#cb123-385" aria-hidden="true" tabindex="-1"></a>pig_corr_rec <span class="ot">&lt;-</span> pig_rec <span class="sc">|&gt;</span> </span>
<span id="cb123-386"><a href="#cb123-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_corr</span>(<span class="fu">all_numeric_predictors</span>(), <span class="at">threshold =</span> <span class="fl">0.5</span>)</span>
<span id="cb123-387"><a href="#cb123-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-388"><a href="#cb123-388" aria-hidden="true" tabindex="-1"></a>pig_corr_rec </span>
<span id="cb123-389"><a href="#cb123-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-390"><a href="#cb123-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-391"><a href="#cb123-391" aria-hidden="true" tabindex="-1"></a>Dann können wir auch schon die Daten generieren. In unserem Fall wurde keine Variable entfernt. Die Korrelation untereinander ist nicht so groß. Wir runden hier wieder, damit sich die Tabelle nicht so in die Breite auf der Webseite entwickelt.</span>
<span id="cb123-392"><a href="#cb123-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-395"><a href="#cb123-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-396"><a href="#cb123-396" aria-hidden="true" tabindex="-1"></a>pig_corr_tbl <span class="ot">&lt;-</span> pig_corr_rec  <span class="sc">|&gt;</span></span>
<span id="cb123-397"><a href="#cb123-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb123-398"><a href="#cb123-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() <span class="sc">|&gt;</span> </span>
<span id="cb123-399"><a href="#cb123-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>)) </span>
<span id="cb123-400"><a href="#cb123-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-401"><a href="#cb123-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-402"><a href="#cb123-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-403"><a href="#cb123-403" aria-hidden="true" tabindex="-1"></a><span class="fu">## Beispiel Gummibärchendaten</span></span>
<span id="cb123-404"><a href="#cb123-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-405"><a href="#cb123-405" aria-hidden="true" tabindex="-1"></a>Schauen wir uns ein Rezept einmal in einem Rutsch auf den Gummibärchendaten einmal an. Wir müssen natürlich erstmal alle nominalen Variablen auch als solche umwandeln. Wir erschaffen also die passenden Faktoren für das Geschlecht und den Lieblingsgeschmack. Dann erschaffen wir noch eine ID für die Studierenden. Am Ende wählen wir noch ein paar Spalten aus, damit wir nicht alle Variablen vorliegen haben. Sonst wird der endgültige Datensatz sehr breit. Wir entfernen dann noch alle Beobachtungen aus den Daten, die einen fehlenden Wert bei dem Geschlecht haben. Das machen wir immer für die Variable, die dann unser Outcome sein soll.</span>
<span id="cb123-406"><a href="#cb123-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-409"><a href="#cb123-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-410"><a href="#cb123-410" aria-hidden="true" tabindex="-1"></a>gummi_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/gummibears.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb123-411"><a href="#cb123-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">as_factor</span>(gender),</span>
<span id="cb123-412"><a href="#cb123-412" aria-hidden="true" tabindex="-1"></a>         <span class="at">most_liked =</span> <span class="fu">as_factor</span>(most_liked),</span>
<span id="cb123-413"><a href="#cb123-413" aria-hidden="true" tabindex="-1"></a>         <span class="at">student_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb123-414"><a href="#cb123-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(student_id, gender, most_liked, age, semester, height) <span class="sc">|&gt;</span>  </span>
<span id="cb123-415"><a href="#cb123-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(gender)</span>
<span id="cb123-416"><a href="#cb123-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-417"><a href="#cb123-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-418"><a href="#cb123-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-419"><a href="#cb123-419" aria-hidden="true" tabindex="-1"></a>In @tbl-gummi-prepro sehen wir dann die Daten nochmal vor dem Preprocessing dargestellt. Wir sind nicht an den ursprünglichen Daten interessiert, da wir nur die Spalte <span class="in">`gender`</span> vorhersagen wollen. Wir wollen hier keine Effekt schätzen oder aber Signifikanzen berechnen. Unsere Features dienen nur der Vorhersage des Labels. Wie die Features zahlenmäßig beschaffen sind, ist uns egal.</span>
<span id="cb123-420"><a href="#cb123-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-423"><a href="#cb123-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-424"><a href="#cb123-424" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb123-425"><a href="#cb123-425" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-426"><a href="#cb123-426" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-427"><a href="#cb123-427" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-gummi-prepro</span></span>
<span id="cb123-428"><a href="#cb123-428" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Auszug aus dem Daten zu den Gummibärchendaten.</span></span>
<span id="cb123-429"><a href="#cb123-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-430"><a href="#cb123-430" aria-hidden="true" tabindex="-1"></a>gummi_raw_tbl <span class="ot">&lt;-</span> gummi_tbl <span class="sc">|&gt;</span> </span>
<span id="cb123-431"><a href="#cb123-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">as.character</span>(gender),</span>
<span id="cb123-432"><a href="#cb123-432" aria-hidden="true" tabindex="-1"></a>         <span class="at">most_liked =</span> <span class="fu">as.character</span>(most_liked))</span>
<span id="cb123-433"><a href="#cb123-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-434"><a href="#cb123-434" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(gummi_raw_tbl),</span>
<span id="cb123-435"><a href="#cb123-435" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(gummi_raw_tbl)),</span>
<span id="cb123-436"><a href="#cb123-436" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(gummi_raw_tbl)) <span class="sc">|&gt;</span> </span>
<span id="cb123-437"><a href="#cb123-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb123-438"><a href="#cb123-438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-439"><a href="#cb123-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-440"><a href="#cb123-440" aria-hidden="true" tabindex="-1"></a>Wir erschaffen uns nun das Rezept in dem wie definieren, dass das <span class="in">`gender`</span> unser Label ist und der Rest der Vairablen unsere Features. Da wir noch die Spalte <span class="in">`student_id`</span> haben, geben wir dieser Spalte noch die Rolle <span class="in">`ID`</span>. Wir können dann in den Rezeptschritten dann immer diese Rolle <span class="in">`ID`</span> aus dem Prozess der Transformation ausschließen.</span>
<span id="cb123-441"><a href="#cb123-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-444"><a href="#cb123-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-445"><a href="#cb123-445" aria-hidden="true" tabindex="-1"></a>gummi_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(gender <span class="sc">~</span> ., <span class="at">data =</span> gummi_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb123-446"><a href="#cb123-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(student_id, <span class="at">new_role =</span> <span class="st">"ID"</span>)</span>
<span id="cb123-447"><a href="#cb123-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-448"><a href="#cb123-448" aria-hidden="true" tabindex="-1"></a>gummi_rec <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb123-449"><a href="#cb123-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-450"><a href="#cb123-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-451"><a href="#cb123-451" aria-hidden="true" tabindex="-1"></a>Und dann haben wir hier alle Schritte einmal zusammen in einem Block. Wir imputieren die fehlenden Werte für die numerischen und nominalen Variablen getrennt. Dann verwandeln wir das Semester in mindestens vier Gruppen. Im nächsten Schritt werden dann alle numerischen Variablen auf eine Spannweite von $<span class="co">[</span><span class="ot">0;1</span><span class="co">]</span>$ gebracht. Wir erschaffen dann noch die Dummies für die nominalen Daten. Am Ende wollen wir dann alle Variablen mit fast keiner Varianz entfernen. Wir wollen dann immer die Spalte <span class="in">`ID`</span> aus den Schritten ausschließen. Wir machen das mit der Funktion <span class="in">`has_role()`</span> und dem <span class="in">`-`</span> vor der Funktion. Damit schließen wir die Rolle <span class="in">`ID`</span> aus dem Transformationsschritt aus.</span>
<span id="cb123-452"><a href="#cb123-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-455"><a href="#cb123-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-456"><a href="#cb123-456" aria-hidden="true" tabindex="-1"></a>gummi_full_rec <span class="ot">&lt;-</span> gummi_rec <span class="sc">|&gt;</span> </span>
<span id="cb123-457"><a href="#cb123-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(<span class="fu">all_numeric_predictors</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"ID"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb123-458"><a href="#cb123-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_bag</span>(<span class="fu">all_nominal_predictors</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"ID"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb123-459"><a href="#cb123-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_discretize</span>(semester, <span class="at">num_breaks =</span> <span class="dv">3</span>, <span class="at">min_unique =</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb123-460"><a href="#cb123-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_range</span>(<span class="fu">all_numeric_predictors</span>(), <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>, <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"ID"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb123-461"><a href="#cb123-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"ID"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb123-462"><a href="#cb123-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_nzv</span>(<span class="fu">all_predictors</span>(), <span class="sc">-</span><span class="fu">has_role</span>(<span class="st">"ID"</span>))</span>
<span id="cb123-463"><a href="#cb123-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-464"><a href="#cb123-464" aria-hidden="true" tabindex="-1"></a>gummi_full_rec</span>
<span id="cb123-465"><a href="#cb123-465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-466"><a href="#cb123-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-467"><a href="#cb123-467" aria-hidden="true" tabindex="-1"></a>Dann können wir wieder unsere Daten generieren. Ich runde hier wieder, da wir schnell sehr viele Kommastellen produzieren. In der Anwendung machen wir das natürlich dann nicht.</span>
<span id="cb123-468"><a href="#cb123-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-471"><a href="#cb123-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-472"><a href="#cb123-472" aria-hidden="true" tabindex="-1"></a>gummi_class_tbl <span class="ot">&lt;-</span> gummi_full_rec <span class="sc">|&gt;</span></span>
<span id="cb123-473"><a href="#cb123-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prep</span>() <span class="sc">|&gt;</span></span>
<span id="cb123-474"><a href="#cb123-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">juice</span>() <span class="sc">|&gt;</span> </span>
<span id="cb123-475"><a href="#cb123-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>)) </span>
<span id="cb123-476"><a href="#cb123-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-477"><a href="#cb123-477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-478"><a href="#cb123-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-479"><a href="#cb123-479" aria-hidden="true" tabindex="-1"></a>In der @tbl-gummi-prepro-trans können wir uns die transformierten Daten einmal anschauen. Wir sehen das zum einen die Variable <span class="in">`student_id`</span> nicht transformiert wurde. Alle numerischen Spalten sind auf einer Spannweite zwischen 0 und 1. Das Geschlecht wurde *nicht* transformiert, da wir das Geschlecht ja als Outcome festgelegt haben. Dann kommen die Dummykodierungen für die nominalen Spalten des Lieblingsgeschmack und des Semesters.</span>
<span id="cb123-480"><a href="#cb123-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-483"><a href="#cb123-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-484"><a href="#cb123-484" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb123-485"><a href="#cb123-485" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-486"><a href="#cb123-486" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-487"><a href="#cb123-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-gummi-prepro-trans</span></span>
<span id="cb123-488"><a href="#cb123-488" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Der transformierte Gummibärchendatensatz nach der Anwendung des Rezepts. </span></span>
<span id="cb123-489"><a href="#cb123-489" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb123-490"><a href="#cb123-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-491"><a href="#cb123-491" aria-hidden="true" tabindex="-1"></a>gummi_class_tbl <span class="ot">&lt;-</span> gummi_class_tbl <span class="sc">|&gt;</span> </span>
<span id="cb123-492"><a href="#cb123-492" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">as.character</span>(gender),</span>
<span id="cb123-493"><a href="#cb123-493" aria-hidden="true" tabindex="-1"></a>         <span class="at">student_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb123-494"><a href="#cb123-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-495"><a href="#cb123-495" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(gummi_class_tbl),</span>
<span id="cb123-496"><a href="#cb123-496" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(gummi_class_tbl)),</span>
<span id="cb123-497"><a href="#cb123-497" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(gummi_class_tbl)) <span class="sc">|&gt;</span> </span>
<span id="cb123-498"><a href="#cb123-498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb123-499"><a href="#cb123-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-500"><a href="#cb123-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-501"><a href="#cb123-501" aria-hidden="true" tabindex="-1"></a>Bis hierher haben wir jetzt die Rezepte nur genutzt um uns die Daten aufzuarbeiten. Das ist eigentlich nur ein Schritt in der Klassifikation. Mit der Funktion <span class="in">`workflow()`</span> können wir dann Rezepte mit Algorithmen verbinden. Dann nutzen wir die Funktion <span class="in">`fit()`</span> um verschiedene Daten auf den Workflow anzuwenden. Das musst du aber nicht tun. Du kannst die Rezepte hier auch verwenden um deine Daten einfach aufzuarbeiten und dann eben doch ganz *normale* Statistik drauf zu rechnen.</span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/classification-pre-processing.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/classification-pre-processing.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>




</body></html>
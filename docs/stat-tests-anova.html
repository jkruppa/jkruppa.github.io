<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik">

<title>Bio Data Science - 29&nbsp; Die ANOVA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-tests-ancova.html" rel="next">
<link href="./stat-tests-ttest.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Bio Data Science - 29&nbsp; Die ANOVA">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-anova.html"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Die ANOVA</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Dunkelmodus umschalten"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Buchstaben und Zahlen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ein <code>purrr</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Multiple Vergleiche &amp; Post-hoc Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Permutationstest &amp; Bootstraping</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">29.1</span> Genutzte R Pakete</a></li>
  <li><a href="#sec-fac1" id="toc-sec-fac1" class="nav-link" data-scroll-target="#sec-fac1"><span class="header-section-number">29.2</span> Einfaktorielle ANOVA</a>
  <ul class="collapse">
  <li><a href="#daten-für-die-einfaktorielle-anova" id="toc-daten-für-die-einfaktorielle-anova" class="nav-link" data-scroll-target="#daten-für-die-einfaktorielle-anova"><span class="header-section-number">29.2.1</span> Daten für die einfaktorielle ANOVA</a></li>
  <li><a href="#hypothesen-für-die-einfaktorielle-anova" id="toc-hypothesen-für-die-einfaktorielle-anova" class="nav-link" data-scroll-target="#hypothesen-für-die-einfaktorielle-anova"><span class="header-section-number">29.2.2</span> Hypothesen für die einfaktorielle ANOVA</a></li>
  <li><a href="#einfaktoriellen-anova-theoretisch" id="toc-einfaktoriellen-anova-theoretisch" class="nav-link" data-scroll-target="#einfaktoriellen-anova-theoretisch"><span class="header-section-number">29.2.3</span> Einfaktoriellen ANOVA theoretisch</a></li>
  <li><a href="#einfaktoriellen-anova-in-r" id="toc-einfaktoriellen-anova-in-r" class="nav-link" data-scroll-target="#einfaktoriellen-anova-in-r"><span class="header-section-number">29.2.4</span> Einfaktoriellen ANOVA in R</a></li>
  </ul></li>
  <li><a href="#sec-fac2" id="toc-sec-fac2" class="nav-link" data-scroll-target="#sec-fac2"><span class="header-section-number">29.3</span> Zweifaktorielle ANOVA</a>
  <ul class="collapse">
  <li><a href="#daten-für-die-zweifaktorielle-anova" id="toc-daten-für-die-zweifaktorielle-anova" class="nav-link" data-scroll-target="#daten-für-die-zweifaktorielle-anova"><span class="header-section-number">29.3.1</span> Daten für die zweifaktorielle ANOVA</a></li>
  <li><a href="#hypothesen-für-die-zweifaktorielle-anova" id="toc-hypothesen-für-die-zweifaktorielle-anova" class="nav-link" data-scroll-target="#hypothesen-für-die-zweifaktorielle-anova"><span class="header-section-number">29.3.2</span> Hypothesen für die zweifaktorielle ANOVA</a></li>
  <li><a href="#zweifaktoriellen-anova-in-r" id="toc-zweifaktoriellen-anova-in-r" class="nav-link" data-scroll-target="#zweifaktoriellen-anova-in-r"><span class="header-section-number">29.3.3</span> Zweifaktoriellen ANOVA in R</a></li>
  </ul></li>
  <li><a href="#und-weiter" id="toc-und-weiter" class="nav-link" data-scroll-target="#und-weiter"><span class="header-section-number">29.4</span> Und weiter?</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-anova.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-anova.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-anova.html"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Die ANOVA</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-anova" class="quarto-section-identifier"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 29. April 2024 um 15:33:47</em></p>
<blockquote class="blockquote">
<p><em>“Yeah, I might seem so strong; Yeah, I might speak so long; I’ve never been so wrong.” — London Grammar, Strong</em></p>
</blockquote>
<p>Die ANOVA (eng. <em>analysis of variance</em>) ist wichtig. Was für ein schöner Satz um anzufangen. Historisch betrachtet ist die ANOVA, <em>das</em> statistische Verfahren was gut per Hand ohne Computer berechnet werden kann. Daher war die ANOVA von den 20zigern bis in die frühen 90ziger des letzten Jahrhunderts <em>das</em> statistische Verfahren der Wahl. Wir brauchen daher die ANOVA aus mehreren Gründen. Die Hochzeiten der ANOVA sind eigentlich vorbei, wir haben in der Statistik für viele Fälle mittlerweile besser Werkzeuge, aber als Allrounder ist die ANOVA immer noch nutzbar. Wir werden immer wieder auf die ANOVA inhaltlich zurück kommen und in vielen Abschlussarbeiten wird die ANOVA immer noch als integraler Bestandteil genutzt. Wofür und wann brauchen wir die ANOVA, wenn wir Daten auswerten?</p>
<ol type="1">
<li>Wir brauchen die ANOVA um mehr als zwei Gruppen <em>gleichzeitig</em> miteinander zu vergleichen. Das heißt wir haben einen Faktor mit mehr als zwei Levels und wollen wissen, ob sich <em>mindestens</em> zwei Level bzw. Gruppen im Mittelwert unterscheiden.</li>
<li>Wir brauchen die ANOVA und deren Varianzzerlegung in der Züchtung. Hier spielt die ANOVA eine gewichtige Rolle bei der Abschätzung des genetischen Effekts. Wir werden aktuell (Stand Ende 2022) hierauf noch nicht tiefer eingehen.</li>
<li>Wir nutzen die ANOVA in vielen Anwendungsgebieten als eine Arte Vortest um zu schauen, ob sich ein Effekt in den Daten verbirgt. Eigentlich stammt dieses Ritual mit einer ANOVA als Vortest und dann ein Posthoc Test noch aus der Zeit, wo wir keine modernen Rechner zu Verfügung hatten. Damals machte diese Reihenfolge noch Sinn. Wir werdend darüber aber später nochmal lesen.</li>
<li>Experimentelle Designs sind darauf ausgelegt mit der ANOVA ausgewertet zu werden. Insbesondere in den Agrarwissenschaften hat die ANOVA daher eine historische Bedeutung. Insbesondere durch die enge Verzahnung vom Experiment auf dem Feld und der eigentlichen Auswertung mit der ANOVA.</li>
</ol>
<p>Wir können die <em>einfaktorielle</em> ANOVA in folgender Form schreiben mit einem <span class="math inline">\(f_1\)</span> für den Faktor. Damit haben wir einen bessere Übersicht. Wieder ist das <span class="math inline">\(y\)</span> und der Faktor <span class="math inline">\(f_1\)</span> jeweils eine separate Spalte in unserem Datensatz.</p>
<p><span class="math display">\[
y \sim f_1
\]</span></p>
<p>Somit erklärt sich die zweifaktorielle ANOVA schon fast von alleine. Wir erweitern einfach das Modell um einen zweiten Faktor <span class="math inline">\(f_2\)</span> und haben somit eine zweifaktorielle ANOVA vorliegen. Auch hier müssen wir beachten, dass das <span class="math inline">\(y\)</span> und die Faktoren <span class="math inline">\(f_1\)</span> und <span class="math inline">\(f_2\)</span> jeweils eine separate Spalte in unserem Datensatz sind.</p>
<p><span class="math display">\[
y \sim f_1 + f_2
\]</span></p>
<p>Wir sehen also, dass die ANOVA zum einen alt ist, aber auch heute noch viel verwendet wird. Daher werden wir in diesem <em>langem</em> Kapitel uns einmal mit der ANOVA ausgiebig beschäftigen. Fangen wir also an, dieses großartige Schweizertaschenmesser der Statistik besser zu verstehen.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Was macht die ANOVA?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die <em>einfaktorielle</em> ANOVA vergleicht die Parameter mehrerer Normalverteilungen miteinander. Oder etwas anders formuliert, vergleicht die ANOVA die Mittlelwerte von mehreren Gruppen bzw. Behandlungen miteinander.</p>
<p>Die <em>zweifaktorielle</em> ANOVA vergleicht die Parameter mehrerer Normalverteilungen von zwei Faktoren miteinander. Oder etwas anders formuliert, vergleicht die ANOVA die Mittelwerte von mehreren Gruppen bzw. Behandlungen miteinander. Dabei kann die <em>zweifaktorielle</em> ANOVA auch die Interaktion zwischen zwei Variablen abbilden.</p>
</div>
</div>
<section id="genutzte-r-pakete" class="level2" data-number="29.1">
<h2 data-number="29.1" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">29.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, broom, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               readxl, effectsize, ggpubr, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               see, car, conflicted)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(plyr<span class="sc">::</span>mutate)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>summarize)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="sec-fac1" class="level2 page-columns page-full" data-number="29.2">
<h2 data-number="29.2" class="anchored" data-anchor-id="sec-fac1"><span class="header-section-number">29.2</span> Einfaktorielle ANOVA</h2>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/JDltrsRdAS4" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/LMgMIy2mh1k" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Die einfaktorielle ANOVA ist die simpelste Form der ANOVA. Wir nutzen einen Faktor <span class="math inline">\(x\)</span> mit mehr als zwei Leveln. Im Rahmen der einfaktoriellen ANOVA wollen wir uns auch die ANOVA theoretisch einmal anschauen. Danach wie die einfaktorielle ANOVA in R genutzt wird. Ebenso werden wir die einfaktorielle ANOVA visualisieren. Abschließend müssen wir uns noch überlegen, ob es einen Effektschätzer für die einfaktorielle ANOVA gibt.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/angel_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Die einfaktorielle ANOVA verlangt ein normalverteiltes <span class="math inline">\(y\)</span> sowie Varianzhomogenität über den Behandlungsfaktor <span class="math inline">\(x\)</span>. Daher alle Level von <span class="math inline">\(x\)</span> sollen die gleiche Varianz haben. Unsere Annahme an die Daten <span class="math inline">\(D\)</span> ist, dass das dein <span class="math inline">\(y\)</span> normalverteilt ist und das die Level vom <span class="math inline">\(x\)</span> homogen in den Varianzen sind. Später mehr dazu, wenn wir beides nicht vorliegen haben…</p>
</blockquote>
</div>
</div>
</div>
<section id="daten-für-die-einfaktorielle-anova" class="level3" data-number="29.2.1">
<h3 data-number="29.2.1" class="anchored" data-anchor-id="daten-für-die-einfaktorielle-anova"><span class="header-section-number">29.2.1</span> Daten für die einfaktorielle ANOVA</h3>
<p>Wir wollen uns nun erstmal den einfachsten Fall anschauen mit einem simplen Datensatz. Wir nehmen ein normalverteiltes <span class="math inline">\(y\)</span> aus den Datensatz <code>flea_dog_cat_fox.csv</code> und einen Faktor mit mehr als zwei Leveln. Hätten wir nur zwei Level, dann hätten wir auch einen t-Test rechnen können.</p>
<p>Im Folgenden selektieren mit der Funktion <code>select()</code> die beiden Spalten <code>jump_length</code> als <span class="math inline">\(y\)</span> und die Spalte <code>animal</code> als <span class="math inline">\(x\)</span>. Danach müssen wir noch die Variable <code>animal</code> in einen Faktor mit der Funktion <code>as_factor()</code> umwandeln.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/flea_dog_cat_fox.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir erhalten das Objekt <code>fac1_tbl</code> mit dem Datensatz in <a href="#tbl-data-anova-1" class="quarto-xref">Tabelle&nbsp;<span>29.1</span></a> nochmal dargestellt.</p>
<div class="cell">
<div id="tbl-data-anova-1" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-data-anova-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;29.1— Selektierter Datensatz für die einfaktorielle ANOVA mit einer normalverteilten Variable <code>jump_length</code> und einem Faktor <code>animal</code> mit drei Leveln.
</figcaption>
<div aria-describedby="tbl-data-anova-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">jump_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.7</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">11.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">9.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">7.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">3.2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">2.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">5.4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">4.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">4.3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">7.9</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">6.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">7.7</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">8.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">9.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">9.7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">8.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.3</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Wir bauen daher mit den beiden Variablen mit dem Objekt <code>fac1_tbl</code> folgendes Modell für die spätere Analyse in R.</p>
<p><span class="math display">\[
jump\_length \sim animal
\]</span></p>
<p>Bevor wir jetzt das Modell verwenden, müssen wir uns nochmal überlegen, welchen Schluß wir eigentlich über die Nullhypothese machen. Wir immer können wir nur die Nullhypothese ablehnen. Daher überlegen wir uns im Folgenden wie die Nullhypothese in der einfaktoriellen ANOVA aussieht. Dann bilden wir anhand der Nullhypothese noch die Alternativehypothese.</p>
</section>
<section id="hypothesen-für-die-einfaktorielle-anova" class="level3" data-number="29.2.2">
<h3 data-number="29.2.2" class="anchored" data-anchor-id="hypothesen-für-die-einfaktorielle-anova"><span class="header-section-number">29.2.2</span> Hypothesen für die einfaktorielle ANOVA</h3>
<p>Die ANOVA betrachtet die Mittelwerte und nutzt die Varianzen um einen Unterschied nachzuweisen. Daher haben wir in der Nullhypothese als Gleichheitshypothese. In unserem Beispiel lautet die Nullhypothese, dass die Mittelwerte jedes Levels des Faktors <code>animal</code> gleich sind.</p>
<p><span class="math display">\[
H_0: \; \bar{y}_{cat} = \bar{y}_{dog} = \bar{y}_{fox}
\]</span></p>
<p>Die Alternative lautet, dass sich mindestens ein paarweiser Vergleich in den Mittelwerten unterschiedet. Hierbei ist das <em>mindestens ein Vergleich</em> wichtig. Es können sich alle Mittelwerte unterschieden oder eben nur ein Paar. Wenn eine ANOVA die <span class="math inline">\(H_0\)</span> ablehnt, also ein signifikantes Ergebnis liefert, dann wissen wir nicht, welche Mittelwerte sich unterscheiden.</p>
<p><span class="math display">\[
\begin{aligned}
H_A: &amp;\; \bar{y}_{cat} \ne \bar{y}_{dog}\\
\phantom{H_A:} &amp;\; \bar{y}_{cat} \ne \bar{y}_{fox}\\
\phantom{H_A:} &amp;\; \bar{y}_{dog} \ne \bar{y}_{fox}\\
\phantom{H_A:} &amp;\; \mbox{für mindestens ein Paar}
\end{aligned}
\]</span></p>
<p>Wir schauen uns jetzt einmal die ANOVA theoretisch an bevor wir uns mit der Anwendung der ANOVA in R beschäftigen.</p>
</section>
<section id="einfaktoriellen-anova-theoretisch" class="level3 page-columns page-full" data-number="29.2.3">
<h3 data-number="29.2.3" class="anchored" data-anchor-id="einfaktoriellen-anova-theoretisch"><span class="header-section-number">29.2.3</span> Einfaktoriellen ANOVA theoretisch</h3>
<p>Kommen wir zurück zu den Daten in <a href="#tbl-data-anova-1" class="quarto-xref">Tabelle&nbsp;<span>29.1</span></a>. Wenn wir die ANOVA per Hand rechnen wollen, dann ist nicht das Long Format die beste Wahl sondern das Wide Format. Wir haben ein balanciertes Design vorliegen, dass heißt in jeder Level sind die gleiche Anzahl Beobachtungen. Wir schauen uns jeweils sieben Flöhe von jeder Tierart an. Für eine ANOVA ist aber ein balanciertes Design nicht notwendig, wir können auch mit ungleichen Gruppengrößen eine ANOVA rechnen. Statt einer einfaktoriellen ANOVA könnten wir auch gleich einen <code>pairwise.t.test()</code>rechnen. Historisch betrachtet ist die einfaktorielle ANOVA die Visualisierung des paarweisen t-Tests.</p>
<p>Eine einfaktorielle ANOVA macht eigentlich keinen großen Sinn, wenn wir anschließend sowieso paarweise Vergleich, wie in <a href="stat-tests-posthoc.html" class="quarto-xref"><span>Kapitel 37</span></a> beschrieben, rechnen. Aus der Historie stellte sich die Frage, ob es sich lohnt die ganze Arbeit für die paarweisen t-Tests per Hand zu rechnen. Daher wurde die ANOVA davor geschaltet. War die ANOVA nicht signifikant, dann konnte man sich dann auch die Rechnerei für die paarweisen t-Tests sparen.</p>
<p>In <a href="#tbl-fac1-wide-01" class="quarto-xref">Tabelle&nbsp;<span>29.2</span></a> sehen wir die Daten einmal als Wide-Format dargestellt.</p>
<div id="tbl-fac1-wide-01" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fac1-wide-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;29.2— Wide Format der Beispieldaten <code>fac1_tbl</code> für die jeweils <span class="math inline">\(j=7\)</span> Beobachtungen für den Faktor <code>animal</code>.
</figcaption>
<div aria-describedby="tbl-fac1-wide-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">j</th>
<th style="text-align: center;">dog</th>
<th style="text-align: center;">cat</th>
<th style="text-align: center;">fox</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">5.7</td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">7.7</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">2.2</td>
<td style="text-align: center;">8.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">11.8</td>
<td style="text-align: center;">5.4</td>
<td style="text-align: center;">9.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">8.2</td>
<td style="text-align: center;">4.1</td>
<td style="text-align: center;">9.7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">5.6</td>
<td style="text-align: center;">4.3</td>
<td style="text-align: center;">10.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">9.1</td>
<td style="text-align: center;">7.9</td>
<td style="text-align: center;">8.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">7.6</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">10.3</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wir können jetzt für jedes der Level den Mittelwert über all <span class="math inline">\(j=7\)</span> Beobachtungen berechnen.</p>
<p><span class="math display">\[
\begin{aligned}
\bar{y}_{dog} &amp;= 8.13 \\
\bar{y}_{cat} &amp;= 4.74 \\
\bar{y}_{fox} &amp;= 9.16 \\
\end{aligned}
\]</span></p>
<p>Wir tun jetzt für einen Moment so, als gebe es den Faktor <code>animal</code> nicht in den Daten und schauen uns die Verteilung der einzelnen Beobachtungen in <a href="#fig-anova-exp-1-1" class="quarto-xref">Abbildung&nbsp;<span>29.1 (a)</span></a> einmal an. Wir sehen das sich die Beobachtungen von ca. 2.2cm bis 11 cm streuen. Woher kommt nun diese Streuung bzw. Varianz? Was ist die Quelle der Varianz? In <a href="#fig-anova-exp-1-2" class="quarto-xref">Abbildung&nbsp;<span>29.1 (b)</span></a> haben wir die Punkte einmal nach dem Faktor <code>animal</code> eingefärbt. Wir sehen, dass die blauen Beobachtungen eher weitere Sprunglängen haben als die grünen Beobachtungen. Wir gruppieren die Beobachtungen in <a href="#fig-anova-exp-1-3" class="quarto-xref">Abbildung&nbsp;<span>29.1 (c)</span></a> nach dem Faktor <code>animal</code> und sehen, dass ein Teil der Varianz der Daten von dem Faktor <code>animal</code> ausgelöst wird.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<div id="fig-anova-exp-1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-anova-exp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-anova-exp-1" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-anova-exp-1-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-anova-exp-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-anova-exp-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="fig-anova-exp-1"><img src="stat-tests-anova_files/figure-html/fig-anova-exp-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-anova-exp-1" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-anova-exp-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Die Sprungweite in [cm] ohne den Faktor <code>animal</code> betrachtet.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-anova-exp-1" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-anova-exp-1-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-anova-exp-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-anova-exp-1-2.png" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="fig-anova-exp-1"><img src="stat-tests-anova_files/figure-html/fig-anova-exp-1-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-anova-exp-1" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-anova-exp-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Die Sprungweite in [cm] mit den Faktor <code>animal</code> eingefärbt.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-anova-exp-1" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-anova-exp-1-3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-anova-exp-1-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-anova-exp-1-3.png" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="fig-anova-exp-1"><img src="stat-tests-anova_files/figure-html/fig-anova-exp-1-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-anova-exp-1" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-anova-exp-1-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Die Sprungweite in [cm] mit den Faktor <code>animal</code> eingefärbt und gruppiert.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anova-exp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;29.1— Die Spungweite in [cm] in Abhängigkeit von dem Faktor <code>animal</code> dargestellt.
</figcaption>
</figure>
</div>
</div>
<p>Gehen wir einen Schritt weiter und zeichnen einmal das globale Mittel in die <a href="#fig-anova-exp-5-1" class="quarto-xref">Abbildung&nbsp;<span>29.2 (a)</span></a> von <span class="math inline">\(\bar{y}_{..} = 7.34\)</span> und lassen die Beobachtungen gruppiert nach dem Faktor <code>animal</code>. Wir sehen, dass die Level des Faktors <code>animal</code> um das globale Mittel streuen. Was ja auch bei einem Mittelwert zu erwarten ist. Wir können jetzt in <a href="#fig-anova-exp-5-2" class="quarto-xref">Abbildung&nbsp;<span>29.2 (b)</span></a> die lokalen Mittel für die einzelnen Level <code>dog</code>, <code>cat</code>und <code>fox</code> ergänzen. Und abschließend in <a href="#fig-anova-exp-5-3" class="quarto-xref">Abbildung&nbsp;<span>29.2 (c)</span></a> die Abweichungen <span class="math inline">\(\\beta_i\)</span> zwischen dem globalen Mittel <span class="math inline">\(\bar{y}_{..} = 7.34\)</span> und den einzelnen lokalen Mittel berechnen. Die Summe der Abweichungen <span class="math inline">\(\\beta_i\)</span> ist <span class="math inline">\(0.79 + (-2.6) + 1.81 \approx 0\)</span>. Das ist auch zu erwarten, den das globale Mittel muss ja per Definition als Mittelwert gleich großen Abstand “nach oben” wie “nach unten” haben.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<div id="fig-anova-exp-5" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-anova-exp-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-anova-exp-5" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-anova-exp-5-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-anova-exp-5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-anova-exp-5-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-5" data-gallery="fig-anova-exp-5"><img src="stat-tests-anova_files/figure-html/fig-anova-exp-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-anova-exp-5" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-anova-exp-5-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Die Sprungweite in [cm] mit den Faktor <code>animal</code> gruppiert und das globale Mittel <span class="math inline">\(\bar{y}_{..} = 7.34\)</span> ergänzt.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-anova-exp-5" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-anova-exp-5-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-anova-exp-5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-anova-exp-5-2.png" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="fig-anova-exp-5"><img src="stat-tests-anova_files/figure-html/fig-anova-exp-5-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-anova-exp-5" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-anova-exp-5-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Die Sprungweite in [cm] mit den Faktor <code>animal</code> gruppiert und die lokalen Mittel <span class="math inline">\(\bar{y}_{i.}\)</span> für jedes Level ergänzt.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-anova-exp-5" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-anova-exp-5-3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-anova-exp-5-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-anova-exp-5-3.png" class="lightbox" data-glightbox="description: .lightbox-desc-7" data-gallery="fig-anova-exp-5"><img src="stat-tests-anova_files/figure-html/fig-anova-exp-5-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-anova-exp-5" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-anova-exp-5-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Die Sprungweite in [cm] mit den Faktor <code>animal</code> gruppiert und die Abweichungen <span class="math inline">\(\beta_i\)</span> ergänzt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anova-exp-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;29.2— Dotplot der Spungweite in [cm] in Abhängigkeit von dem Faktor <code>animal</code>.
</figcaption>
</figure>
</div>
</div>
<p>Wir tragen die Werte der lokalen Mittelwerte <span class="math inline">\(\bar{y}_{i.}\)</span> und deren Abweichungen <span class="math inline">\(\beta_i\)</span> vom globalen Mittelwert <span class="math inline">\(\bar{y}_{..} = 7.34\)</span> noch in die <a href="#tbl-fac1-wide-02" class="quarto-xref">Tabelle&nbsp;<span>29.3</span></a> ein. Wir sehen in diesem Beispiel warum das Wide Format <em>besser</em> zum Verstehen der ANOVA ist, weil wir ja die lokalen Mittelwerte und die Abweichungen per Hand berechnen. Da wir in der Anwendung aber <em>nie</em> die ANOVA per Hand rechnen, liegen unsere Daten immer in R als Long-Format vor. Es handelt sich hier nur um die Veranschaulichung des Konzepts der ANOVA.</p>
<div id="tbl-fac1-wide-02" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-fac1-wide-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;29.3— Wide Format der Beispieldaten <code>fac1_tbl</code> für die jeweils <span class="math inline">\(j=7\)</span> Beobachtungen für den Faktor <code>animal</code>. Wir ergänzen die lokalen Mittlwerte <span class="math inline">\(\bar{y}_{i.}\)</span> und deren Abweichungen <span class="math inline">\(\beta_i\)</span> vom globalen Mittelwert <span class="math inline">\(\bar{y}_{..} = 7.34\)</span>.
</figcaption>
<div aria-describedby="tbl-fac1-wide-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">j</th>
<th style="text-align: center;">dog</th>
<th style="text-align: center;">cat</th>
<th style="text-align: center;">fox</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">5.7</td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">7.7</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">2.2</td>
<td style="text-align: center;">8.1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">11.8</td>
<td style="text-align: center;">5.4</td>
<td style="text-align: center;">9.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">8.2</td>
<td style="text-align: center;">4.1</td>
<td style="text-align: center;">9.7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">5.6</td>
<td style="text-align: center;">4.3</td>
<td style="text-align: center;">10.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">9.1</td>
<td style="text-align: center;">7.9</td>
<td style="text-align: center;">8.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">7.6</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">10.3</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\bar{y}_{i.}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8.13\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.74\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9.16\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\beta_i\)</span></td>
<td style="text-align: center;"><span class="math inline">\(-2.6\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0.79\)</span></td>
<td style="text-align: center;"><span class="math inline">\(1.81\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wie kriegen wir nun die ANOVA rechnerisch auf die Straße? Schauen wir uns dazu einmal die <a href="#fig-anova-exp-6" class="quarto-xref">Abbildung&nbsp;<span>29.3</span></a> an. Auf der linken Seiten sehen wir vier Gruppen, die keinen Effekt haben. Die Gruppen liegen alle auf der gleichen Höhe. Es ist mit keinem Unterschied zwischen den Gruppen zu rechnen. Alle Gruppen<em>mittel</em> liegen auf dem globalen Mittel. Die Abweichungen der einzelnen Gruppen<em>mittel</em> zum globalen Mittel ist damit gleich null. Auf der rechten Seite sehen wir vier Gruppen mit einem Effekt. Die Gruppen unterscheiden sich in ihren Gruppen<em>mitteln</em>. Dadurch unterscheide sich aber auch die Gruppen<em>mittel</em> von dem globalen Mittel.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<div id="fig-anova-exp-6" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-anova-exp-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-anova-exp-6" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-anova-exp-6-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-anova-exp-6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-anova-exp-6-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-8" data-gallery="fig-anova-exp-6"><img src="stat-tests-anova_files/figure-html/fig-anova-exp-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-anova-exp-6" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-anova-exp-6-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Kein Effekt
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-anova-exp-6" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-anova-exp-6-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-anova-exp-6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-anova-exp-6-2.png" class="lightbox" data-glightbox="description: .lightbox-desc-9" data-gallery="fig-anova-exp-6"><img src="stat-tests-anova_files/figure-html/fig-anova-exp-6-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-anova-exp-6" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-anova-exp-6-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Leichter bis mittlerer Effekt
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anova-exp-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;29.3— Darstellung von keinem Effekt und leichtem bis mittleren Effekt in einer einfaktoriellen ANOVA mit einem Faktor mit vier Leveln A - D.
</figcaption>
</figure>
</div>
</div>
<p>Wir können daher wie in <a href="#tbl-sum-anova-eff" class="quarto-xref">Tabelle&nbsp;<span>29.4</span></a> geschrieben die Funktionsweise der ANOVA zusammenfassen. Wir vergleichen die Mittelwerte indem wir die Varianzen nutzen.</p>
<div id="tbl-sum-anova-eff" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sum-anova-eff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;29.4— Zusammenfassung der ANOVA Funktionsweise.
</figcaption>
<div aria-describedby="tbl-sum-anova-eff-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 5%">
<col style="width: 67%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: center;">All level means are equal.</td>
<td style="text-align: center;">=</td>
<td style="text-align: center;">The differences between level means and the total mean are small.</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Nun kommen wir zum eigentlichen Schwenk und warum eigentlich die ANOVA meist etwas verwirrt. Wir wollen eine Aussage über die Mittelwerte machen. Die Nullhypothese lautet, dass alle Mittelwerte gleich sind. Wie wir in <a href="#tbl-sum-anova-eff" class="quarto-xref">Tabelle&nbsp;<span>29.4</span></a> sagen, heißt alle Mittelwerte gleich auch, dass die Abweichungen von den Gruppenmitteln zum globalen Mittel klein ist.</p>
<p>Wie weit die Gruppenmittel von dem globalen Mittel weg sind, dazu nutzt die ANOVA die Varianz. Die ANOVA vergleicht somit</p>
<ul>
<li>die Varianz der einzelnen Mittelwerte der (Gruppen)Level zum globalen Mittel (eng. <em>variability between levels</em>)</li>
<li>und die Varianz der Beobachtungen zu den einzelnen Mittelwerten der Level (eng. <em>variability within one level</em>)</li>
</ul>
<p>Wir berechnen also wie die Beobachtungen jeweils um das globale Mittel streuen (<span class="math inline">\(SS_{total}\)</span>), die einzelnen Beobachtungen um die einzelnen Gruppenmittel <span class="math inline">\(SS_{error}\)</span> und die Streuung der Gruppenmittel um das globale Mittel (<span class="math inline">\(SS_{animal}\)</span>). Wir nennen die Streuung Abstandquadrate (eng. <em>sum of squares</em>) und damit sind die <em>Sum of Square</em> <span class="math inline">\((SS)\)</span> nichts anderes als die Varianz. Die <a href="#tbl-sumsquares" class="quarto-xref">Tabelle&nbsp;<span>29.5</span></a> zeigt die Berechnung des Anteils jeder einzelnen Beobachtung an den jeweiligen <em>Sum of Squares</em>.</p>
<div class="column-page">
<div id="tbl-sumsquares" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-sumsquares-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;29.5— Berechnung der <span class="math inline">\(SS_{animal}\)</span>, <span class="math inline">\(SS_{error}\)</span> und <span class="math inline">\(SS_{total}\)</span> anhand der einzelnen gemessenen Werte <span class="math inline">\(y\)</span> für durch die jeweiligen Gruppenmittel <span class="math inline">\(\bar{y}_{i.}\)</span> und dem globalen Mittel <span class="math inline">\(\bar{y}_{..}\)</span> über alle Beobachtungen
</figcaption>
<div aria-describedby="tbl-sumsquares-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 19%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">animal (x)</th>
<th style="text-align: center;">jump_length (y)</th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\bar{y}_{i.}}\)</span></th>
<th style="text-align: center;">SS<span class="math inline">\(_{\boldsymbol{animal}}\)</span></th>
<th style="text-align: center;">SS<span class="math inline">\(_{\boldsymbol{error}}\)</span></th>
<th style="text-align: center;">SS<span class="math inline">\(_{\boldsymbol{total}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;"><span class="math inline">\(5.7\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8.13\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.13 - 7.34)^2 = 0.62\)</span></td>
<td style="text-align: center;"><span class="math inline">\((5.7 - 8.13)^2 = 5.90\)</span></td>
<td style="text-align: center;"><span class="math inline">\((5.7 - 7.34)^2 = 2.69\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;"><span class="math inline">\(8.9\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8.13\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.13 - 7.34)^2 = 0.62\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.9 - 8.13)^2 = 0.59\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.9 - 7.34)^2 = 2.43\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;"><span class="math inline">\(11.8\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8.13\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.13 - 7.34)^2 = 0.62\)</span></td>
<td style="text-align: center;"><span class="math inline">\((11.8 - 8.13)^2 = 13.47\)</span></td>
<td style="text-align: center;"><span class="math inline">\((11.8 - 7.34)^2 = 19.89\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;"><span class="math inline">\(8.2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8.13\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.13 - 7.34)^2 = 0.62\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.2 - 8.13)^2 = 0.00\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.2 - 7.34)^2 = 0.74\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;"><span class="math inline">\(5.6\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8.13\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.13 - 7.34)^2 = 0.62\)</span></td>
<td style="text-align: center;"><span class="math inline">\((5.6 - 8.13)^2 = 6.40\)</span></td>
<td style="text-align: center;"><span class="math inline">\((5.6 - 7.34)^2 = 3.03\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;"><span class="math inline">\(9.1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8.13\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.13 - 7.34)^2 = 0.62\)</span></td>
<td style="text-align: center;"><span class="math inline">\((9.1 - 8.13)^2 = 0.94\)</span></td>
<td style="text-align: center;"><span class="math inline">\((9.1 - 7.34)^2 = 3.10\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;"><span class="math inline">\(7.6\)</span></td>
<td style="text-align: center;"><span class="math inline">\(8.13\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.13 - 7.34)^2 = 0.62\)</span></td>
<td style="text-align: center;"><span class="math inline">\((7.6 - 8.13)^2 = 0.28\)</span></td>
<td style="text-align: center;"><span class="math inline">\((7.6 - 7.34)^2 = 0.07\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;"><span class="math inline">\(3.2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.74\)</span></td>
<td style="text-align: center;"><span class="math inline">\((4.74 - 7.34)^2 = 6.76\)</span></td>
<td style="text-align: center;"><span class="math inline">\((3.2 - 4.74)^2 = 2.37\)</span></td>
<td style="text-align: center;"><span class="math inline">\((3.2 - 7.34)^2 = 17.14\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;"><span class="math inline">\(2.2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.74\)</span></td>
<td style="text-align: center;"><span class="math inline">\((4.74 - 7.34)^2 = 6.76\)</span></td>
<td style="text-align: center;"><span class="math inline">\((2.2 - 4.74)^2 = 6.45\)</span></td>
<td style="text-align: center;"><span class="math inline">\((2.2 - 7.34)^2 = 26.42\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;"><span class="math inline">\(5.4\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.74\)</span></td>
<td style="text-align: center;"><span class="math inline">\((4.74 - 7.34)^2 = 6.76\)</span></td>
<td style="text-align: center;"><span class="math inline">\((5.4 - 4.74)^2 = 0.44\)</span></td>
<td style="text-align: center;"><span class="math inline">\((5.4 - 7.34)^2 = 3.76\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;"><span class="math inline">\(4.1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.74\)</span></td>
<td style="text-align: center;"><span class="math inline">\((4.74 - 7.34)^2 = 6.76\)</span></td>
<td style="text-align: center;"><span class="math inline">\((4.1 - 4.74)^2 = 0.41\)</span></td>
<td style="text-align: center;"><span class="math inline">\((4.1 - 7.34)^2 = 10.50\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;"><span class="math inline">\(4.3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.74\)</span></td>
<td style="text-align: center;"><span class="math inline">\((4.74 - 7.34)^2 = 6.76\)</span></td>
<td style="text-align: center;"><span class="math inline">\((4.3 - 4.74)^2 = 0.19\)</span></td>
<td style="text-align: center;"><span class="math inline">\((4.3 - 7.34)^2 = 9.24\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;"><span class="math inline">\(7.9\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.74\)</span></td>
<td style="text-align: center;"><span class="math inline">\((4.74 - 7.34)^2 = 6.76\)</span></td>
<td style="text-align: center;"><span class="math inline">\((7.9 - 4.74)^2 = 9.99\)</span></td>
<td style="text-align: center;"><span class="math inline">\((7.9 - 7.34)^2 = 0.31\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;"><span class="math inline">\(6.1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.74\)</span></td>
<td style="text-align: center;"><span class="math inline">\((4.74 - 7.34)^2 = 6.76\)</span></td>
<td style="text-align: center;"><span class="math inline">\((6.1 - 4.74)^2 = 1.85\)</span></td>
<td style="text-align: center;"><span class="math inline">\((6.1 - 7.34)^2 = 1.54\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;"><span class="math inline">\(7.7\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9.16\)</span></td>
<td style="text-align: center;"><span class="math inline">\((9.16 - 7.34)^2 = 3.31\)</span></td>
<td style="text-align: center;"><span class="math inline">\((7.7 - 9.16)^2 = 2.13\)</span></td>
<td style="text-align: center;"><span class="math inline">\((7.7 - 7.34)^2 = 0.13\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;"><span class="math inline">\(8.1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9.16\)</span></td>
<td style="text-align: center;"><span class="math inline">\((9.16 - 7.34)^2 = 3.31\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.1 - 9.16)^2 = 1.12\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.1 - 7.34)^2 = 0.58\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;"><span class="math inline">\(9.1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9.16\)</span></td>
<td style="text-align: center;"><span class="math inline">\((9.16 - 7.34)^2 = 3.31\)</span></td>
<td style="text-align: center;"><span class="math inline">\((9.1 - 9.16)^2 = 0.00\)</span></td>
<td style="text-align: center;"><span class="math inline">\((9.1 - 7.34)^2 = 3.10\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;"><span class="math inline">\(9.7\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9.16\)</span></td>
<td style="text-align: center;"><span class="math inline">\((9.16 - 7.34)^2 = 3.31\)</span></td>
<td style="text-align: center;"><span class="math inline">\((9.7 - 9.16)^2 = 0.29\)</span></td>
<td style="text-align: center;"><span class="math inline">\((9.7 - 7.34)^2 = 5.57\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;"><span class="math inline">\(10.6\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9.16\)</span></td>
<td style="text-align: center;"><span class="math inline">\((9.16 - 7.34)^2 = 3.31\)</span></td>
<td style="text-align: center;"><span class="math inline">\((10.6 - 9.16)^2 = 2.07\)</span></td>
<td style="text-align: center;"><span class="math inline">\((10.6 - 7.34)^2 = 10.63\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;"><span class="math inline">\(8.6\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9.16\)</span></td>
<td style="text-align: center;"><span class="math inline">\((9.16 - 7.34)^2 = 3.31\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.6 - 9.16)^2 = 0.31\)</span></td>
<td style="text-align: center;"><span class="math inline">\((8.6 - 7.34)^2 = 1.59\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;"><span class="math inline">\(10.3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9.16\)</span></td>
<td style="text-align: center;"><span class="math inline">\((9.16 - 7.34)^2 = 3.31\)</span></td>
<td style="text-align: center;"><span class="math inline">\((10.3 - 9.16)^2 = 1.30\)</span></td>
<td style="text-align: center;"><span class="math inline">\((10.3 - 7.34)^2 = 8.76\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(74.68\)</span></td>
<td style="text-align: center;"><span class="math inline">\(56.53\)</span></td>
<td style="text-align: center;"><span class="math inline">\(131.21\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<p>Die ANOVA wird deshalb auch Varianz<em>zerlegung</em> genannt, da die ANOVA versucht den Abstand der Beobachtungen auf die Variablen im Modell zu zerlegen. Also wie viel der Streuung von den Beobachtungen kann von dem Faktor <code>animal</code> erklärt werden? Genau der Abstand von den Gruppenmitteln zu dem globalen Mittelwert.</p>
<p>Du kannst dir das ungefähr als eine Reise von globalen Mittelwert zu der einzelnen Beobachtung vorstellen. Nehmen wir als Beispiel die kleinste Sprungweite eines Katzenflohs von 2.2 cm und visualisieren wir uns die Reise wie in <a href="#fig-single-cat-anova" class="quarto-xref">Abbildung&nbsp;<span>29.4</span></a> zu sehen. Wie kommen wir jetzt <em>numerisch</em> vom globalen Mittel mit <span class="math inline">\(7.34\)</span> zu der Beobachtung? Wir können zum einen den direkten Abstand mit <span class="math inline">\(2.2 - 7.34\)</span> gleich <span class="math inline">\(-5.14\)</span> cm berechnen. Das wäre der <em>total</em> Abstand. Wie sieht es nun aus, wenn wir das Gruppenmittel mit beachten? In dem Fall gehen wir vom globalen Mittel zum Gruppenmittel <code>cat</code> mit <span class="math inline">\(\bar{y}_{cat} - \bar{y}_{..} = 4.74 -7.34\)</span> gleich <span class="math inline">\(\beta_{cat} = -2.6\)</span> cm. Jetzt sind wir aber noch nicht bei der Beobachtung. Wir haben noch einen Rest von <span class="math inline">\(y_{cat,2} - \bar{y}_{cat} = 2.2 - 4.74\)</span> gleich <span class="math inline">\(\epsilon_{cat, 2} = -2.54\)</span> cm, die wir noch zurücklegen müssen. Das heißt, wir können einen Teil der Strecke mit dem Gruppenmittelwert erklären. Oder anders herum, wir können die Strecke vom globalen Mittelwert zu der Beobachtung in einen Teil für das Gruppenmittel und einen unerklärten Rest zerlegen.</p>
<div id="fig-single-cat-anova" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-single-cat-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/anova-pre-01.png" class="lightbox" data-glightbox="description: .lightbox-desc-10" data-gallery="quarto-lightbox-gallery-10"><img src="images/anova-pre-01.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-single-cat-anova-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;29.4— Visualisierung der Varianzzerlegung des Weges vom globalen Mittel zu der einzelnen Beoabchtung. Um zu einer einzelnen Beobachtung zu kommen legen wir den Weg vom globalen Mittelwert über den Abstand vom globalen Mittel zum Gruppenmittel <span class="math inline">\(\beta\)</span> zurück. Dann fehlt noch der Rest oder Fehler oder Residuum <span class="math inline">\(\epsilon\)</span>.
</figcaption>
</figure>
</div>
<p>Wir rechnen also eine ganze Menge an Abständen und quadrieren dann diese Abstände zu den Sum of Squares. Oder eben der Varianz. Dann fragen wir uns, ob der Faktor in unserem Modell einen Teil der Abstände erklären kann. Wir bauen uns dafür eine ANOVA Tabelle. <a href="#tbl-anova-fac1-theo" class="quarto-xref">Tabelle&nbsp;<span>29.6</span></a> zeigt eine theoretische, einfaktorielle ANOVA Tabelle. Wir berechnen zuerst die Abstände als <span class="math inline">\(SS\)</span>. Nun ist es aber so, dass wenn wir in einer Gruppe viele Level und/oder Beobachtungen haben, wir auch größere Sum of Squares bekommen. Wir müssen also die Sum of Squares in mittlere Abweichungsquadrate (eng. <em>mean squares</em>) mitteln. Abschließend können wir die F Statistik berechnen, indem wir die <span class="math inline">\(MS\)</span> des Faktors durch die <span class="math inline">\(MS\)</span> des Fehlers teilen. Das Verhältnis von erklärter Varianz vom Faktor zu dem unerklärten Rest.</p>
<div class="column-page">
<div id="tbl-anova-fac1-theo" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-fac1-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;29.6— Einfaktorielle ANOVA in der theoretischen Darstellung. Die sum of squares müssen noch zu den Mean squares gemittelt werden. Abschließend wird die F Statistik als Prüfgröße berechnet.
</figcaption>
<div aria-describedby="tbl-anova-fac1-theo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 8%">
<col style="width: 3%">
<col style="width: 40%">
<col style="width: 23%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Varianzquelle</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">Sum of squares</th>
<th style="text-align: center;">Mean squares</th>
<th style="text-align: center;">F<span class="math inline">\(_{\boldsymbol{D}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">animal</td>
<td style="text-align: center;"><span class="math inline">\(k-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{animal} = \sum_{i=1}^{k}n_i(\bar{y}_{i.} - \bar{y}_{..})^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{animal} = \cfrac{SS_{animal}}{k-1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{MS_{animal}}{MS_{error}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">error</td>
<td style="text-align: center;"><span class="math inline">\(n-k\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{error} = \sum_{i=1}^{k}\sum_{j=1}^{n_i}(y_{ij} - \bar{y}_{i.})^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{error} = \cfrac{SS_{error}}{N-k}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">total</td>
<td style="text-align: center;"><span class="math inline">\(n-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{total} = \sum_{i=1}^{k}\sum_{j=1}^{n_i}(y_{ij} - \bar{y}_{..})^2\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<p>Wir füllen jetzt die <a href="#tbl-anova-fac1-example" class="quarto-xref">Tabelle&nbsp;<span>29.7</span></a> einmal mit den Werten aus. Nachdem wir das getan haben oder aber die Tabelle in R ausgegeben bekommen haben, können wir die Zahlen interpretieren.</p>
<div class="column-page">
<div id="tbl-anova-fac1-example" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-fac1-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;29.7— Einfaktorielle ANOVA mit den ausgefüllten Werten. Die <span class="math inline">\(SS_{total}\)</span> sind die Summe der <span class="math inline">\(SS_{animal}\)</span> und <span class="math inline">\(SS_{error}\)</span>. Die <span class="math inline">\(MS\)</span> berechnen sich dann direkt aus den <span class="math inline">\(SS\)</span> und den Freiheitsgraden (<span class="math inline">\(df\)</span>). Abschließend ergibt sich dann die F Statistik.
</figcaption>
<div aria-describedby="tbl-anova-fac1-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 17%">
<col style="width: 34%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Varianzquelle</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">Sum of squares</th>
<th style="text-align: center;">Mean squares</th>
<th style="text-align: center;">F<span class="math inline">\(_{\boldsymbol{D}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">animal</td>
<td style="text-align: center;"><span class="math inline">\(3-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{animal} = 74.68\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{animal} = \cfrac{74.68}{3-1} = 37.34\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{37.34}{3.14} = 11.89\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">error</td>
<td style="text-align: center;"><span class="math inline">\(21-3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{error} = 56.53\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{error} = \cfrac{56.53}{18} = 3.14\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">total</td>
<td style="text-align: center;"><span class="math inline">\(21-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{total} = 131.21\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<p>Zu erst ist die berechnete F Statistik <span class="math inline">\(F_{D}\)</span> von Interesse. Wir haben hier eine <span class="math inline">\(F_{D}\)</span> von 11.89. Wir vergleichen wieder die berechnete F Statistik mit einem kritischen Wert. Der kritische F Wert <span class="math inline">\(F_{\alpha = 5\%}\)</span> lautet für die einfaktorielle ANOVA in diesem konkreten Beispiel mit <span class="math inline">\(F_{\alpha = 5\%} = 3.55\)</span>. Die Entscheidungsregel nach der F Teststatistik lautet, die <span class="math inline">\(H_0\)</span> abzulehnen, wenn <span class="math inline">\(F_{D} &gt; F_{\alpha = 5\%}\)</span>.</p>
<p>Wir können also die Nullhypothese <span class="math inline">\(H_0\)</span> in unserem Beispiel ablehnen. Es liegt ein signifikanter Unterschied zwischen den Tiergruppen vor. Mindestens ein Mittelwertsunterschied in den Sprungweiten liegt vor.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Entscheidung mit der berechneten Teststatistik <span class="math inline">\(F_{\boldsymbol{D}}\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Bei der Entscheidung mit der berechneten Teststatistik <span class="math inline">\(F_{D}\)</span> gilt, wenn <span class="math inline">\(F_{D} \geq F_{\alpha = 5\%}\)</span> wird die Nullhypothese (H<span class="math inline">\(_0\)</span>) abgelehnt.</p>
<p><strong>Achtung –</strong> Wir nutzen die Entscheidung mit der Teststatistik <em>nur und ausschließlich</em> in der Klausur. In der praktischen Anwendung hat die Betrachtung der berechneten Teststatistik <em>keine</em> Verwendung mehr. Wir nutzen in der praktischen Anwendung den <span class="math inline">\(p\)</span>-Wert.</p>
</div>
</div>
<p>Abschließend noch ein Wort zu der Annahme an eine ANOVA. Wir wollen ja für eine ANOVA ein normalverteiltes Outcome <span class="math inline">\(y\)</span> und die gleichen Varianzen über alle Gruppen. Wir wollen Varianzhomogenität vorliegen haben. In <a href="#fig-anova-assumption" class="quarto-xref">Abbildung&nbsp;<span>29.5</span></a> siehst du vier Behandlungsgruppen sowie deren lokale Mittel. Die Gruppe D hat eine sehr viel größere Varianz. Auch ist fraglich, ob die Gruppe D einer Normalverteilung folgt. Dadurch passieren zwei Dinge. Erstens ist der lokale Mittelwert von der Gruppe D viel näher am globalen Mittel als er eigentlich wäre, dadurch wird die <em>Summe</em> aus <span class="math inline">\(MS_{treatment}\)</span> kleiner. Zweitens sind die Beobachtungen sehr weit um das lokale Mittel gestreut, dadurch wird die <em>Summe</em> aus <span class="math inline">\(MS_{error}\)</span> viel größer. Wir erhalten dadurch eine sehr viel kleinere F Statistik. Im Prinzip vergleichst du mit einer ANOVA ein Set an gleich aussehenden Normalverteilungen. Wenn alles schief und krumm ist, dann ist es vermutlich sogar besser, als wenn wir eine total verkorkste Gruppenverteilung haben, wie hier in Beispiel D.</p>
<div id="fig-anova-assumption" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-anova-assumption-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/anova-assumptions.png" class="lightbox" data-glightbox="description: .lightbox-desc-11" data-gallery="quarto-lightbox-gallery-11"><img src="images/anova-assumptions.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anova-assumption-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;29.5— Visualisierung der Annahmen an eine ANOVA. Wir berechnen den <span class="math inline">\(MS_{treatment}\)</span> in dem wir alle Abweichungen vom gloablen Mittel <span class="math inline">\(\bar{y}_{..}\)</span> aufaddieren. Ebenso berechnen wir den <span class="math inline">\(MS_{error}\)</span> indem wir die einzelen Abweichungen von den Bobachtungen <span class="math inline">\(\epsilon\)</span> zu den lokalen Mitteln berechnen. Hat jetzt eine Gruppe, wie die Gruppe D, eine abweichende Streuung, wird das <span class="math inline">\(MS_{error}\)</span> überproportional groß. Damit wird dann die F Statistik klein.
</figcaption>
</figure>
</div>
<p>Wir können das einmal numerisch mit einem kritischen Wert für <span class="math inline">\(F_{\alpha = 5\%} = 3.55\)</span> durchspielen. Nehmen wir folgende Summe für <span class="math inline">\(MS_{treatment}\)</span> aus der <a href="#fig-anova-assumption" class="quarto-xref">Abbildung&nbsp;<span>29.5</span></a> mit den einzelnen <span class="math inline">\(MS\)</span> einmal wie folgt an. Wir nehmen an das <span class="math inline">\(MS_A\)</span> gleich 10, <span class="math inline">\(MS_B\)</span> gleich 20, <span class="math inline">\(MS_C\)</span> gleich 8 und <span class="math inline">\(MS_D\)</span> gleich 7 ist. Dann können wir durch das Summieren das <span class="math inline">\(MS_{treatment}\)</span> berechnen.</p>
<p><span class="math display">\[
MS_{treatment} = 10 + 20 + 8 + 7 = 45
\]</span></p>
<p>Wenn wir jetzt die Summe für <span class="math inline">\(MS_{error}\)</span> berechnen, wird diese Summe sehr große, da die Gruppe D eine sehr große Varianz mit einbringt.</p>
<p><span class="math display">\[
MS_{error} = 5 + 6 + 4 + 20 = 35
\]</span></p>
<p>Das führt am Ende dazu, dass wir eine sehr kleine F Statistik erhalten. Auch wenn sich vielleicht Gruppe B von Gruppe C unterscheidet, können wir den Unterschied wegen der großen Varianz aus Gruppe D nicht nachweisen.</p>
<p><span class="math display">\[
F = \cfrac{MS_{treatment}}{MS_{error}} = \cfrac{45}{35} = 1.28 \leq 3.55
\]</span></p>
<p>Du siehst hier wie wichtig es ist, ich die Daten einmal zu visualisieren um zu sehen vorher mögliche Probleme herrühren können. Auf der anderen Seite können wir die ANOVA auf ein Recht breites Spektrum an Daten anwenden, solange wir wissen, das die Verteilungen in etwa für jede Gruppe gleich aussehen. Wir müssen nur mit dem <span class="math inline">\(\eta^2\)</span> aufpassen, wenn wir zu schiefe Verteilungen haben. Dann gibt uns <span class="math inline">\(\eta^2\)</span> keine valide Aussage mehr über den Anteil der erklärten Varianz.</p>
</section>
<section id="einfaktoriellen-anova-in-r" class="level3" data-number="29.2.4">
<h3 data-number="29.2.4" class="anchored" data-anchor-id="einfaktoriellen-anova-in-r"><span class="header-section-number">29.2.4</span> Einfaktoriellen ANOVA in R</h3>
<p>Wir rechnen keine ANOVA per Hand sondern nutzen R. Dazu müssen wir als erstes das Modell definieren. Das ist im Falle der einfaktoriellen ANOVA relativ einfach. Wir haben unseren Datensatz <code>fac1_tbl</code> mit einer kontinuierlichen Variable <code>jump_lemgth</code> als <span class="math inline">\(y\)</span> vorliegen sowie einen Faktor <code>animal</code> mit mehr als zwei Leveln als <span class="math inline">\(x\)</span>. Wir definieren das Modell in R in der Form <code>jump_length ~ animal</code>. Um das Modell zu rechnen nutzen wir die Funktion <code>lm()</code> - die Abkürzung für <em>linear model</em>. Danach pipen wir die Ausgabe vom <code>lm()</code> direkt in die Funktion <code>anova()</code>. Die Funktion <code>anova()</code> berechnet uns dann die eigentliche einfaktorielle ANOVA. Wir speichern die Ausgabe der ANOVA in <code>fit_1</code>. Schauen wir uns die ANOVA Ausgabe einmal an.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span>  <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>fit_1</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: jump_length
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
animal     2 74.683  37.341   11.89 0.0005113 ***
Residuals 18 56.529   3.140                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Wir erhalten die Information was wir gerechnet haben, eine Varianzanalyse. Darunter steht, was das <span class="math inline">\(y\)</span> war nämlich die <code>jump_length</code>. Wir erhalten eine Zeile für den Faktor <code>animal</code> und damit die <span class="math inline">\(SS_{animal}\)</span> und eine Zeile für den Fehler und damit den <span class="math inline">\(SS_{error}\)</span>. In R heißen die <span class="math inline">\(SS_{error}\)</span> dann <code>Residuals</code>. Die Zeile für die <span class="math inline">\(SS_{total}\)</span> fehlt.</p>
<p>Neben der berechneten F Statistik <span class="math inline">\(F_{D}\)</span> von <span class="math inline">\(11.89\)</span> erhalten wir auch den p-Wert mit <span class="math inline">\(0.005\)</span>. Wir ignorieren die F Statistik, da wir in der Anwendung nur den p-Wert berücksichtigen. Die Entscheidung gegen die Nulhypothese lautet, dass wenn der p-Wert kleiner ist als das Signifkanzniveau <span class="math inline">\(\alpha\)</span> von 5% wir die Nullhypothese ablehnen.</p>
<p>Wir haben hier ein signifikantes Ergebnis vorliegen. Mindestens ein Gruppenmittelerstunterschied ist signifikant. <a href="#fig-boxplot-anova-1" class="quarto-xref">Abbildung&nbsp;<span>29.6</span></a> zeigt nochmal die Daten <code>fac1_tbl</code> als Boxplot. Wir überprüfen visuell, ob das Ergebnis der ANOVA stimmen kann. Ja, die Boxplots und das Ergebnis der ANOVA stimmen überein. Die Boxplots liegen nicht alle auf einer Ebene, so dass hier auch ein signifikanter Unterschied zu erwarten war.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-anova-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-anova-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-boxplot-anova-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-12" data-gallery="quarto-lightbox-gallery-12"><img src="stat-tests-anova_files/figure-html/fig-boxplot-anova-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-anova-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;29.6— Boxplot der Sprungweiten [cm] von Hunden-, Katzen- und Fuchsflöhen.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Abschließend können wir noch die Funktion <code>eta_squared()</code> aus dem R Paket <code>{effectsize}</code> nutzen um einen Effektschätzer für die einfaktorielle ANOVA zu berechnen. Wir können mit <span class="math inline">\(\eta^2\)</span> abschätzen, welchen Anteil der Faktor <code>animal</code> an der gesamten Varianz erklärt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="sc">|&gt;</span> <span class="fu">eta_squared</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>For one-way between subjects designs, partial eta squared is equivalent
  to eta squared. Returning eta squared.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA

Parameter | Eta2 |       95% CI
-------------------------------
animal    | 0.57 | [0.27, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>Das <span class="math inline">\(\eta^2\)</span> können wir auch einfach händisch berechnen.</p>
<p><span class="math display">\[
\eta^2 = \cfrac{SS_{animal}}{SS_{total}} = \cfrac{74.68}{131.21} = 0.57 = 57\%
\]</span></p>
<p>Wir haben nun die Information, das 57% der Varianz der Beobachtungen durch den Faktor <code>animal</code> rklärt wird. Je nach Anwendungsgebiet kann die Relevanz sehr stark variieren. Im Bereich der Züchtung mögen erklärte Varianzen von unter 10% noch sehr relevant sein. Im Bereich des Feldexperiments erwarten wir schon höhere Werte für <span class="math inline">\(\eta^2\)</span>. Immerhin sollte ja unsere Behandlung maßgeblich für die z.B. größeren oder kleineren Pflanzen gesorgt haben.</p>
</section>
</section>
<section id="sec-fac2" class="level2 page-columns page-full" data-number="29.3">
<h2 data-number="29.3" class="anchored" data-anchor-id="sec-fac2"><span class="header-section-number">29.3</span> Zweifaktorielle ANOVA</h2>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/82SUzQL1AEw" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Die zweifaktorielle ANOVA ist eine wunderbare Methode um herauszufinden, ob zwei Faktoren einen Einfluss auf ein normalverteiltes <span class="math inline">\(y\)</span> haben. Die Stärke der zweifaktoriellen ANOVA ist hierbei, dass die ANOVA <em>beide</em> Effekte der Faktoren auf das <span class="math inline">\(y\)</span> simultan modelliert. Darüber hinaus können wir auch noch einen Interaktionsterm mit in das Modell aufnehmen um zu schauen, ob die beiden Faktoren untereinander auch interagieren. Somit haben wir mit der zweifaktoriellen ANOVA die Auswertungsmehode für ein randomiziertes Blockdesign vorliegen.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="images/angel_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Die zweifaktorielle ANOVA verlangt ein normalverteiltes <span class="math inline">\(y\)</span> sowie Varianzhomogenität jeweils separat über beide Behandlungsfaktor <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span>. Daher alle Level von <span class="math inline">\(x_1\)</span> sollen die gleiche Varianz haben. Ebenso sollen alle Level von <span class="math inline">\(x_2\)</span> die gleiche Varianz haben. Unsere Annahme an die Daten <span class="math inline">\(D\)</span> ist, dass das dein <span class="math inline">\(y\)</span> normalverteilt ist und das die Level vom <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span> jeweils für sich homogen in den Varianzen sind.</p>
</blockquote>
</div>
</div>
</div>
<section id="daten-für-die-zweifaktorielle-anova" class="level3" data-number="29.3.1">
<h3 data-number="29.3.1" class="anchored" data-anchor-id="daten-für-die-zweifaktorielle-anova"><span class="header-section-number">29.3.1</span> Daten für die zweifaktorielle ANOVA</h3>
<p>Wir wollen uns nun einen etwas komplexes Modell anschauen mit einem etwas komplizierteren Datensatz <code>flea_dog_cat_fox_site.csv</code>. Wir brauchen hierfür ein normalverteiltes <span class="math inline">\(y\)</span> und sowie zwei Faktoren. Das macht auch soweit Sinn, denn wir wollen ja auch eine zweifaktorielle ANOVA rechnen.</p>
<p>Im Folgenden selektieren mit der Funktion <code>select()</code> die beiden Spalten <code>jump_length</code> als <span class="math inline">\(y\)</span> und die Spalte <code>animal</code> sowie die Spalte <code>site</code> als <span class="math inline">\(x\)</span>. Danach müssen wir noch die Variable <code>animal</code> sowie die Variable <code>site</code> in einen Faktor mit der Funktion <code>as_factor()</code> umwandeln.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/flea_dog_cat_fox_site.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, site, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">as_factor</span>(site))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir erhalten das Objekt <code>fac2_tbl</code> mit dem Datensatz in <a href="#tbl-data-anova-2" class="quarto-xref">Tabelle&nbsp;<span>29.8</span></a> nochmal dargestellt.</p>
<div class="cell">
<div id="tbl-data-anova-2" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-data-anova-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;29.8— Selektierter Datensatz für die zweifaktorielle ANOVA mit einer normalverteilten Variable <code>jump_length</code> und einem Faktor <code>animal</code> mit drei Leveln sowie dem Faktor <code>site</code> mit vier Leveln.
</figcaption>
<div aria-describedby="tbl-data-anova-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">site</th>
<th style="text-align: center;">jump_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">12.04</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">11.98</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">16.10</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">13.42</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">12.37</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">16.36</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">14.91</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Die Beispieldaten sind in <a href="#fig-boxplot-anova-2" class="quarto-xref">Abbildung&nbsp;<span>29.7</span></a> abgebildet. Wir sehen auf der x-Achse den Faktor <code>animal</code> mit den drei Leveln <code>dog</code>, <code>cat</code> und <code>fox</code>. Jeder dieser Faktorlevel hat nochmal einen Faktor in sich. Dieser Faktor lautet <code>site</code> und stellt dar, wo die Flöhe gesammelt wurden. Die vier Level des Faktors <code>site</code> sind <code>city</code>, <code>smalltown</code>, <code>village</code> und <code>field</code>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-anova-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-anova-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-boxplot-anova-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-14" data-gallery="quarto-lightbox-gallery-14"><img src="stat-tests-anova_files/figure-html/fig-boxplot-anova-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-anova-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;29.7— Boxplot der Sprungweiten [cm] von Hunden und Katzen.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir bauen dann mit den beiden Variablen bzw. Faktoren <code>animal</code> und <code>site</code> aus dem Objekt <code>fac2_tbl</code> folgendes Modell für die zweifaktorielle ANOVA:</p>
<p><span class="math display">\[
jump\_length \sim animal + site
\]</span></p>
<p>Bevor wir jetzt das Modell verwenden, müssen wir uns nochmal überlegen, welchen Schluß wir eigentlich über die Nullhypothese machen. Wir immer können wir nur die Nullhypothese ablehnen. Daher überlegen wir uns im Folgenden wie die Nullhypothese in der zweifaktoriellen ANOVA aussieht. Dann bilden wir anhand der Nullhypothese noch die Alternativehypothese.</p>
</section>
<section id="hypothesen-für-die-zweifaktorielle-anova" class="level3" data-number="29.3.2">
<h3 data-number="29.3.2" class="anchored" data-anchor-id="hypothesen-für-die-zweifaktorielle-anova"><span class="header-section-number">29.3.2</span> Hypothesen für die zweifaktorielle ANOVA</h3>
<p>Wir haben für jeden Faktor der zweifaktoriellen ANOVA ein Hypothesenpaar. Im Folgenden sehen wir die jeweiligen Hypothesenpaare. Einmal für <code>animal</code>, als Haupteffekt. Wir nennen einen Faktor den Hauptfaktor, weil wir an diesem Faktor am meisten interessiert sind. Wenn wir später einen Posthoc Test durchführen würden, dann würden wir diesen Faktor nehmen. Wir sind primär an dem Unterschied der Sprungweiten in [cm] in Gruppen Hund, Katze und Fuchs interessiert.</p>
<p><span class="math display">\[
\begin{aligned}
H_0: &amp;\; \bar{y}_{cat} = \bar{y}_{dog} = \bar{y}_{fox}\\
H_A: &amp;\; \bar{y}_{cat} \ne \bar{y}_{dog}\\
\phantom{H_A:} &amp;\; \bar{y}_{cat} \ne \bar{y}_{fox}\\
\phantom{H_A:} &amp;\; \bar{y}_{dog} \ne \bar{y}_{fox}\\
\phantom{H_A:} &amp;\; \mbox{für mindestens ein Paar}
\end{aligned}
\]</span></p>
<p>Einmal für <code>site</code>, als Nebeneffekt oder Blockeffekt oder Clustereffekt. Meist eine Variable, die wir auch erhoben haben und <em>vermutlich</em> auch einen Effekt auf das <span class="math inline">\(y\)</span> haben wird. Oder aber wir haben durch das exprimentelle Design noch eine Aufteilungsvariable wie Block vorliegen. In unserem Beispiel ist es <code>site</code> oder der Ort, wo wir die Hunde-, Katzen, und Fuchsflöhe gefunden haben.</p>
<p><span class="math display">\[
\begin{aligned}
H_0: &amp;\; \bar{y}_{city} = \bar{y}_{smalltown} = \bar{y}_{village} = \bar{y}_{field}\\
H_A: &amp;\; \bar{y}_{city} \ne \bar{y}_{smalltown}\\
\phantom{H_A:} &amp;\; \bar{y}_{city} \ne \bar{y}_{village}\\
\phantom{H_A:} &amp;\; \bar{y}_{city} \ne \bar{y}_{field}\\
\phantom{H_A:} &amp;\; \bar{y}_{smalltown} \ne \bar{y}_{village}\\
\phantom{H_A:} &amp;\; \bar{y}_{smalltown} \ne \bar{y}_{field}\\
\phantom{H_A:} &amp;\; \bar{y}_{village} \ne \bar{y}_{field}\\
\phantom{H_A:} &amp;\; \mbox{für mindestens ein Paar}
\end{aligned}
\]</span></p>
<p>Einmal für die Interaktion <code>animal:site</code> - die eigentliche Stärke der zweifaktoriellen ANOVA. Wir können uns anschauen, ob die beiden Faktoren miteinander interagieren. Das heißt, ob eine Interaktion zwischen dem Faktor <code>animal</code> und dem Faktor <code>site</code> vorliegt.</p>
<p><span class="math display">\[
\begin{aligned}
H_0: &amp;\; \mbox{keine Interaktion}\\
H_A: &amp;\; \mbox{eine Interaktion zwischen animal und site}
\end{aligned}
\]</span></p>
<p>Wir haben also jetzt die verschiedenen Hypothesenpaare definiert und schauen uns jetzt die ANOVA in R einmal in der Anwendung an.</p>
</section>
<section id="zweifaktoriellen-anova-in-r" class="level3 page-columns page-full" data-number="29.3.3">
<h3 data-number="29.3.3" class="anchored" data-anchor-id="zweifaktoriellen-anova-in-r"><span class="header-section-number">29.3.3</span> Zweifaktoriellen ANOVA in R</h3>
<p>Bei der einfaktoriellen ANOVA haben wir die Berechnungen der Sum of squares nochmal nachvollzogen. Im Falle der zweifaktoriellen ANOVA verzichten wir darauf. Das Prinzip ist das gleiche. Wir haben nur mehr Mitelwerte und mehr Abweichungen von diesen Mittelwerten, da wir ja nicht nur einen Faktor <code>animal</code> vorliegen haben sondern auch noch den Faktor <code>site</code>. Da wir aber die ANOVA nur Anwenden und dazu R nutzen, müssen wir jetzt nicht per Hand die zweifaktorielle ANOVA rechnen. Du musst aber die R Ausgabe der ANOVA verstehen. Und diese Ausgabe schauen wir uns jetzt einmal ohne und dann mit Interaktionsterm an.</p>
<p>Wir wollen nun einmal die zweifaktorielle ANOVA ohne Interaktionsterm rechnen die in <a href="#tbl-anova-fac2-ohne-inter" class="quarto-xref">Tabelle&nbsp;<span>29.9</span></a> dargestellt ist. Die <span class="math inline">\(SS\)</span> und <span class="math inline">\(MS\)</span> für die zweifaktorielle ANOVA berechnen wir nicht selber sondern nutzen die Funktion <code>anova()</code> in R.</p>
<div class="column-page">
<div id="tbl-anova-fac2-ohne-inter" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-fac2-ohne-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;29.9— Zweifaktorielle ANOVA ohne Interaktionseffekt in der theoretischen Darstellung. Die Sum of squares müssen noch zu den Mean squares gemittelt werden. Abschließend wird die F Statistik als Prüfgröße berechnet.
</figcaption>
<div aria-describedby="tbl-anova-fac2-ohne-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 14%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Varianzquelle</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">Sum of squares</th>
<th style="text-align: center;">Mean squares</th>
<th style="text-align: center;">F<span class="math inline">\(_{\boldsymbol{D}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">animal</td>
<td style="text-align: center;"><span class="math inline">\(a-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{animal}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{animal}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{MS_{animal}}{MS_{error}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">site</td>
<td style="text-align: center;"><span class="math inline">\(b-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{site}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{site}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{MS_{site}}{MS_{error}}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">error</td>
<td style="text-align: center;"><span class="math inline">\(n-(a-1)(b-1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{error}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{error}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">total</td>
<td style="text-align: center;"><span class="math inline">\(n-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{total}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">Du kannst mehr über Geraden sowie lineare Modelle und deren Eigenschaften im <a href="stat-linear-reg-basic.html" class="quarto-xref"><span>Kapitel 39</span></a> erfahren.</span></div></div>
<p>Im Folgenden sehen wir nochmal das Modell ohne Interaktionsterm. Wir nutzen die Schreibweise in R für eine Modellformel.</p>
<p><span class="math display">\[
jump\_length \sim animal + site
\]</span></p>
<p>Wir bauen nun mit der obigen Formel ein lineares Modell mit der Funktion <code>lm()</code> in R. Danach pipen wir das Modell in die Funktion <code>anova()</code> wie auch in der einfaktoriellen Variante der ANOVA. Die Funktion bleibt die Gleiche, was sich ändert ist das Modell in der Funktion <code>lm()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span>  <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>fit_2</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: jump_length
           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
animal      2 180.03  90.017 19.8808 3.92e-08 ***
site        3   9.13   3.042  0.6718    0.571    
Residuals 114 516.17   4.528                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Wir erhalten wiederum die ANOVA Ergebnistabelle. Anstatt nur die Zeile <code>animal</code> für den Effekt des Faktors <code>animal</code> sehen wir jetzt auch noch die Zeile <code>site</code> für den Effekt des Faktors <code>site</code>. Zuerst ist weiterhin der Faktor <code>animal</code> signifikant, da der <span class="math inline">\(p\)</span>-Wert mit <span class="math inline">\(0.000000039196\)</span> kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5%. Wir können von mindestens einem Gurppenunterschied im Faktor <code>animal</code> ausgehen. Im Weiteren ist der Faktor <code>site</code> nicht signifikant. Es scheint keinen Unterschied zwischend den einzelnen Orten und der Sprunglänge von den Hunde-, Katzen- und Fuchsflöhen zu geben.</p>
<p>Neben der Standausgabe von R können wir auch die <code>tidy</code> Variante uns ausgeben lassen. In dem Fall sieht die Ausgabe etwas mehr aufgeräumt aus.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="sc">|&gt;</span> <span class="fu">tidy</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 6
  term         df  sumsq meansq statistic       p.value
  &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
1 animal        2 180.    90.0     19.9    0.0000000392
2 site          3   9.13   3.04     0.672  0.571       
3 Residuals   114 516.     4.53    NA     NA           </code></pre>
</div>
</div>
<p>Abschließend können wir uns übr <span class="math inline">\(\eta^2\)</span> auch die erklärten Anteile der Varianz wiedergeben lassen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="sc">|&gt;</span> <span class="fu">eta_squared</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter | Eta2 (partial) |       95% CI
-----------------------------------------
animal    |           0.26 | [0.15, 1.00]
site      |           0.02 | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>Wir sehen, dass nur ein kleiner Teil der Varianz von dem Faktor <code>animal</code> erklärt wird, nämlich 26%. Für den Faktor <code>site</code> haben wir nur einen Anteil von 2% der erklärten Varianz. Somit hat die <code>site</code> weder einen signifikanten Einflluss auf die Sprungweite von Flöhen noch ist dieser Einfluss als relevant zu betrachten.</p>
<p>Abschließend können wir die Werte in der <a href="#tbl-anova-fac2-ohne-inter-example" class="quarto-xref">Tabelle&nbsp;<span>29.10</span></a> ergänzen. Die Frage ist inwieweit diese Tabelle in der Form von Interesse ist. Meist wird geschaut, ob die Faktoren signifikant sind oder nicht. Abschließend eventuell noch die <span class="math inline">\(\eta^2\)</span> Werte berichtet. Hier musst du schauen, was in deinem Kontext der Forschung oder Abschlussarbeit erwartet wird.</p>
<div class="column-page">
<div id="tbl-anova-fac2-ohne-inter-example" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-fac2-ohne-inter-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;29.10— Zweifaktorielle Anova ohne Interaktionseffekt mit den ausgefüllten Werten. Die <span class="math inline">\(SS_{total}\)</span> sind die Summe der <span class="math inline">\(SS_{animal}\)</span> und <span class="math inline">\(SS_{error}\)</span>. Die <span class="math inline">\(MS\)</span> berechnen sich dann direkt aus den <span class="math inline">\(SS\)</span> und den Freiheitsgraden (<span class="math inline">\(df\)</span>). Abschließend ergibt sich dann die F Statistik.
</figcaption>
<div aria-describedby="tbl-anova-fac2-ohne-inter-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 19%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Varianzquelle</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">Sum of squares</th>
<th style="text-align: center;">Mean squares</th>
<th style="text-align: center;">F<span class="math inline">\(_{\boldsymbol{D}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">animal</td>
<td style="text-align: center;"><span class="math inline">\(3-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{animal} = 180.03\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{animal} = 90.02\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{90.02}{4.53} = 19.88\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">site</td>
<td style="text-align: center;"><span class="math inline">\(4-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{site} = 9.13\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{site} = 3.04\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{3.04}{4.53} = 0.67\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">error</td>
<td style="text-align: center;"><span class="math inline">\(120-(3-1)(4-1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{error} = 516.17\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{error} = 4.53\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">total</td>
<td style="text-align: center;"><span class="math inline">\(120-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{total} = 705.33\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<p>Die eigentlich Stärke der zweifaktoriellen ANOVA ist die Nutzung des Interaktionsterm. Also die Berücksichtigung der Interaktion zwischen den beiden Faktoren in der ANOVA. Wir wollen nun noch einmal die zweifaktorielle ANOVA mit Interaktionsterm rechnen, die in <a href="#tbl-anova-fac3-inter" class="quarto-xref">Tabelle&nbsp;<span>29.11</span></a> dargestellt ist. Die <span class="math inline">\(SS\)</span> und <span class="math inline">\(MS\)</span> für die zweifaktorielle ANOVA berechnen wir nicht selber sondern nutzen wie immer die Funktion <code>anova()</code> in R.</p>
<div class="column-page">
<div id="tbl-anova-fac3-inter" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-fac3-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;29.11— Zweifaktorielle ANOVA mit Interaktionseffekt in der theoretischen Darstellung. Die Sum of squares müssen noch zu den Mean squares gemittelt werden. Abschließend wird die F Statistik als Prüfgröße berechnet.
</figcaption>
<div aria-describedby="tbl-anova-fac3-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 15%">
<col style="width: 9%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Varianzquelle</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">Sum of squares</th>
<th style="text-align: center;">Mean squares</th>
<th style="text-align: center;">F<span class="math inline">\(_{\boldsymbol{D}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">animal</td>
<td style="text-align: center;"><span class="math inline">\(a-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{animal}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{animal}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{MS_{animal}}{MS_{error}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">site</td>
<td style="text-align: center;"><span class="math inline">\(b-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{site}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{site}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{MS_{site}}{MS_{error}}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">animal <span class="math inline">\(\times\)</span> site</td>
<td style="text-align: center;"><span class="math inline">\((a-1)(b-1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{animal \times site}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{animal \times site}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{MS_{animal \times site}}{MS_{error}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">error</td>
<td style="text-align: center;"><span class="math inline">\(n-ab\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{error}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{error}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">total</td>
<td style="text-align: center;"><span class="math inline">\(n-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{total}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<p>Im Folgenden sehen wir nochmal das Modell mit Interaktionsterm. Wir nutzen die Schreibweise in R für eine Modellformel. Einen Interaktionsterm bilden wir durch das <code>:</code> in R ab. Wir können theoretisch auch noch weitere Interaktionsterme bilden, also auch <code>x:y:z</code>. Ich würde aber davon abraten, da diese Interaktionsterme schwer zu interpretieren sind.</p>
<p><span class="math display">\[
jump\_length \sim animal + site + animal:site
\]</span></p>
<p>Wir bauen nun mit der obigen Formel ein lineares Modell mit der Funktion <code>lm()</code> in R. Es wieder das gleich wie schon zuvor. Danach pipen wir das Modell in die Funktion <code>anova()</code> wie auch in der einfaktoriellen Variante der ANOVA. Die Funktion bleibt die Gleiche, was sich ändert ist das Modell in der Funktion <code>lm()</code>. Auch die Interaktion müssen wir nicht extra in der ANOVA Funktion angeben. Alles wird im Modell des <code>lm()</code> abgebildet.</p>
<p>Die visuelle Regel zur Überprüfung der Interaktion lautet nun wie folgt. <a href="#fig-anova-inter-example" class="quarto-xref">Abbildung&nbsp;<span>29.8</span></a> zeigt die entsprechende Vislualisierung. Wir haben keine Interaktion vorliegen, wenn die Geraden parallel zueinander laufen und die Abstände bei bei jedem Faktorlevel gleich sind. Wir schauen uns im Prinzip die erste Faktorstufe auf der x-Achse an. Wir sehen den Abstand von der roten zu blauen Linie sowie das die blaue Gerade über der roten Gerade liegt. Dieses Muster erwarten wir jetzt auch an dem Faktorlevel B und C. Eine leichte bis mittlere Interaktion liegt vor, wenn sich die Abstände von dem zweiten Faktor über die Faktorstufen des ersten Faktors ändern. Eine starke Interaktion liegt vor, wenn sich die Geraden schneiden.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<div id="fig-anova-inter-example" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-anova-inter-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-anova-inter-example" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-anova-inter-example-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-anova-inter-example-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-anova-inter-example-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-15" data-gallery="fig-anova-inter-example"><img src="stat-tests-anova_files/figure-html/fig-anova-inter-example-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-anova-inter-example" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-anova-inter-example-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Keine Interaktion
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-anova-inter-example" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-anova-inter-example-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-anova-inter-example-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-anova-inter-example-2.png" class="lightbox" data-glightbox="description: .lightbox-desc-16" data-gallery="fig-anova-inter-example"><img src="stat-tests-anova_files/figure-html/fig-anova-inter-example-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-anova-inter-example" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-anova-inter-example-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Leichte bis mittlere Intraktion
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-anova-inter-example" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-anova-inter-example-3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-anova-inter-example-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-anova-inter-example-3.png" class="lightbox" data-glightbox="description: .lightbox-desc-17" data-gallery="fig-anova-inter-example"><img src="stat-tests-anova_files/figure-html/fig-anova-inter-example-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-anova-inter-example" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-anova-inter-example-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Starke Interaktion
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-anova-inter-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;29.8— Darstellung von keiner Interaktion, leichter bis mittler Interaktion und starker Interaktion in einer zweifaktoriellen ANOVA mit einem Faktor mit drei Leveln A, B und C sowie einem Faktor mit zwei Leveln (rot und blau).
</figcaption>
</figure>
</div>
</div>
<p>In der <a href="#fig-interact-anova-1" class="quarto-xref">Abbildung&nbsp;<span>29.9</span></a> sehen wir den Interaktionsplot für unser Beispiel. Auf der y-Achse ist die Sprunglänge abgebildet und auf der x-Achse der Faktor <code>animal</code>. Die einzelnen Farben stellen die Level des Faktor <code>site</code> dar.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fac2_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> site, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-interact-anova-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-interact-anova-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-anova_files/figure-html/fig-interact-anova-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-18" data-gallery="quarto-lightbox-gallery-18"><img src="stat-tests-anova_files/figure-html/fig-interact-anova-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-interact-anova-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;29.9— Interaktionsplot für die Hunde-, Katzen- und Fuchsflöhe.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wenn sich die Geraden in einem Interaktionsplot schneiden, haben wir eine Interaktion zwischen den beiden Faktoren vorliegen. Wir schauen zur visuellen Überprüfung auf den Faktor <code>animal</code> und das erste level <code>cat</code>. Wir sehen die Ordnung des zweiten Faktors <code>site</code> mit <code>field</code>, <code>village</code>, <code>smalltown</code> und <code>city</code>. Diese Ordnung und die Abstände sind bei zweiten Faktorlevel <code>dog</code> schon nicht mehr gegeben. Die Geraden schneiden sich. Auch liegt bei dem Level <code>fox</code> eine andere Ordnung vor. Daher sehen wir hier eine starke Interaktion zwischen den beiden Faktoren <code>animal</code> und <code>site</code>. Du kannst mehr über Geraden sowie lineare Modelle und deren Eigenschaften im <a href="stat-linear-reg-basic.html" class="quarto-xref"><span>Kapitel 39</span></a> erfahren.</p>
<p>Wir nehmen jetzt auf jeden Fall den Interaktionsterm <code>animal:site</code> mit in unser Modell und schauen uns einmal das Ergebnis der ANOVA an. Das lineare Modell der ANOVA wird erneut über die Funktion <code>lm()</code> berechnet und anschließend in die Funktion <code>anova()</code> gepipt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span>  <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>fit_3</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: jump_length
             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
animal        2 180.03  90.017 30.2807 3.63e-11 ***
site          3   9.13   3.042  1.0233   0.3854    
animal:site   6 195.11  32.519 10.9391 1.71e-09 ***
Residuals   108 321.05   2.973                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Die Ergebnistabelle der ANOVA wiederholt sich. Wir sehen, dass der Faktor <code>animal</code> signifikant ist, da der p-Wert mit <span class="math inline">\(0.000000000036\)</span> kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5%. Wir können daher die Nullhypothese ablehnen. Mindestens ein Mittelwertsvergleich unterschiedet sich zwischen den Levels des Faktors <code>animal</code>. Im Weiteren sehen wir, dass der Faktor <code>site</code> nicht signifkant ist, da der p-Wert mit <span class="math inline">\(0.39\)</span> größer ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5%. Wir können daher die Nullhypothese nicht ablehnen. Abschließend finden wir die Interaktion zwischen dem Faktor <code>animal</code>und <code>site</code> las signifikant vor. Wenn wir eine signifikante Interaktion vorliegen haben, dann müssen wir den Faktor <code>animal</code> getrennt für jedes Levels des Faktors <code>site</code> auswerten. Wir können keine Aussage über die Sprungweite von Hunde-, Katzen- und Fuchsflöhen <em>unabhängig</em> von der Herkunft <code>site</code> der Flöhe machen.</p>
<p>Wir können wie immer die etwas aufgeräumte Variante der ANOVA Ausgabe mit der Funktion <code>tidy()</code> uns ausgeben lassen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="sc">|&gt;</span> <span class="fu">tidy</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  term           df  sumsq meansq statistic   p.value
  &lt;chr&gt;       &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 animal          2 180.    90.0      30.3   3.63e-11
2 site            3   9.13   3.04      1.02  3.85e- 1
3 animal:site     6 195.    32.5      10.9   1.71e- 9
4 Residuals     108 321.     2.97     NA    NA       </code></pre>
</div>
</div>
<p>Im Folgenden können wir noch die <span class="math inline">\(\eta^2\)</span> für die ANOVA als Effektschätzer berechnen lassen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="sc">|&gt;</span> <span class="fu">eta_squared</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter   | Eta2 (partial) |       95% CI
-------------------------------------------
animal      |           0.36 | [0.24, 1.00]
site        |           0.03 | [0.00, 1.00]
animal:site |           0.38 | [0.24, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>Wir sehen, dass nur ein kleiner Teil der Varianz von dem Faktor <code>animal</code> erklärt wird, nämlich 36%. Für den Faktor <code>site</code> haben wir nur einen Anteil von 3% der erklärten Varianz. Die Interaktion zwischen <code>animal</code> und <code>site</code> erklärt 38% der beobachteten Varianz udn ist somit auch vom Effekt her nicht zu ignorieren. Somit hat die <code>site</code> weder einen signifikanten Einflluss auf die Sprungweite von Flöhen noch ist dieser Einfluss als relevant zu betrachten.</p>
<p>Abschließend können wir die Werte in der <a href="#tbl-anova-fac3-inter-example" class="quarto-xref">Tabelle&nbsp;<span>29.12</span></a> ergänzen. Die Frage ist inwieweit diese Tabelle in der Form von Interesse ist. Meist wird geschaut, ob die Faktoren signifikant sind oder nicht. Abschließend eventuell noch die <span class="math inline">\(\eta^2\)</span> Werte berichtet. Hier musst du schauen, was in deinem Kontext der Forschung oder Abschlussarbeit erwartet wird.</p>
<div class="column-page">
<div id="tbl-anova-fac3-inter-example" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-anova-fac3-inter-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;29.12— Zweifaktorielle Anova mit Interaktionseffekt mit den ausgefüllten Werten. Die <span class="math inline">\(SS_{total}\)</span> sind die Summe der <span class="math inline">\(SS_{animal}\)</span> und <span class="math inline">\(SS_{error}\)</span>. Die <span class="math inline">\(MS\)</span> berechnen sich dan direkt aus den <span class="math inline">\(SS\)</span> und den Freiheitsgraden (<span class="math inline">\(df\)</span>). Abschließend ergibt sich dann die F Statistik.
</figcaption>
<div aria-describedby="tbl-anova-fac3-inter-example-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 23%">
<col style="width: 22%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Varianzquelle</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">Sum of squares</th>
<th style="text-align: center;">Mean squares</th>
<th style="text-align: center;">F<span class="math inline">\(_{\boldsymbol{D}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">animal</td>
<td style="text-align: center;"><span class="math inline">\(3-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{animal} = 180.03\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{animal} = 90.02\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{90.02}{2.97} = 30.28\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">site</td>
<td style="text-align: center;"><span class="math inline">\(4-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{site} = 9.13\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{site} = 3.04\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{3.04}{2.97} = 1.02\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">animal <span class="math inline">\(\times\)</span> site</td>
<td style="text-align: center;"><span class="math inline">\((3-1)(4-1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{animal \times site} = 195.12\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{animal \times site} = 32.52\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_{D} = \cfrac{32.52}{2.97} = 10.94\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">error</td>
<td style="text-align: center;"><span class="math inline">\(120 - (3 \cdot 4)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{error} = 321.06\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MS_{error} = 2.97\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">total</td>
<td style="text-align: center;"><span class="math inline">\(120-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SS_{total} = 705.34\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<p>Wenn wir eine zweifaktorielle ANOVA rechnen, dann können wir verschiedene Typen von ANOVAs rechnen. Dabei unterscheiden wir zwischen den Typen I, II und III. In dem folgenden Kasten gehe ich einmal auf die drei Typen ein. Wichtig ist, dass wir <em>nur</em> zwischen den drei Typen unterscheiden müssen, wenn wir ein unbalanciertes Design vorliegen haben. Ein unbalanciertes Design haben wir vorliegen, wenn wir in den einzelnen Behandlungsgrupen nicht die gleiche Anzahl an Beobachtungen vorliegen haben. Aber auch hier kommt es dann auf eine Beobachtung Unterschied wieder nicht so an.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Die ANOVA Typ I, II und III
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nochmal ganz wichtig, die Ergebnisse der ANOVA-Typen unterscheiden sich vor allem bei unbalancierten Datensätzen. Bei balancierten Datensätzen liefern alle drei Typen in der Regel ähnliche Ergebnisse. Wenn du aber nicht die gleichen Anzahlen an Beobachtungen pro Gruppe hast, dann gilt Folgendes:</p>
<ul>
<li>Die Ergebnisse von Typ I hängen von der Reihenfolge der Faktoren ab, die du ins Modell nimmst. Es macht also einen Unterschied, ob du erst <span class="math inline">\(f_1\)</span> und dann <span class="math inline">\(f_2\)</span> ins Modell aufnimmst oder umgekehrt.</li>
<li>Die Ergebnisse von Typ II und III bleiben unabhängig von der Reihenfolge der Terme gleich, unterscheiden sich aber von den Ergebnissen von Typ I.</li>
<li>Bei Typ III werden die Haupteffekte von <span class="math inline">\(f_1\)</span> und <span class="math inline">\(f_2\)</span> um die Interaktion <span class="math inline">\(f_1:f_2\)</span> bereinigt, was bei Modellen mit Interaktionsterm zu anderen Ergebnissen führt als bei Typ II.</li>
</ul>
<p>Wir können die verschiedenen ANOVA Typen dann mit dem R Paket <code>{car}</code> rechnen. Das ist relativ einfach, die Funktion lauetet dann nur <code>Anova()</code> mit einem großen <code>A</code> am Anfang. Du ersetzt also einfach die Funktion <code>anova()</code> durch die Funktion <code>Anova()</code>, wenn du ein unbalanciertes Design vorliegen hast. Ich würde dir per default die ANOVA Type III empfehlen, wenn du auch einen Interaktionsterm mit in deinem Modell hast. Dann bist du auf der sicheren Seite.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA Type I</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> <span class="fu">anova</span>()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA Type II</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">"II"</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA Type III</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> <span class="fu">Anova</span>(<span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Einen tieferen Einblick gibt es natürlich wie immer auch unter <a href="https://md.psych.bio.uni-goettingen.de/mv/unit/lm_cat/lm_cat_unbal_ss_explained.html">Anova – Type I/II/III SS explained</a>.</p>
</div>
</div>
</section>
</section>
<section id="und-weiter" class="level2" data-number="29.4">
<h2 data-number="29.4" class="anchored" data-anchor-id="und-weiter"><span class="header-section-number">29.4</span> Und weiter?</h2>
<p>Nach einer berechneten ANOVA können wir zwei Fälle vorliegen haben.</p>
<ol type="1">
<li>Wir habe eine nicht signifikante ANOVA berechnet. Wir können die Nullhypothese <span class="math inline">\(H_0\)</span> nicht ablehnen und die Mittelwerte über den Faktor sind vermutlich alle gleich. Wir enden hier mit unserer statistischen Analyse.</li>
<li>Wir haben eine signifikante ANOVA berechnet. Wir können die Nullhypothese <span class="math inline">\(H_0\)</span> ablehnen und mindestens ein Gruppenvergleich über mindestens einen Faktor ist vermutlich unterschiedlich. Wir können dann in <a href="stat-tests-posthoc.html" class="quarto-xref"><span>Kapitel 37</span></a> eine Posthoc Analyse rechnen.</li>
</ol>
<p>Wenn du in deinem Experiment keine <em>signifikanten</em> Ergebnisse findest, ist das nicht schlimm. Du kannst deine Daten immer noch mit der explorativen Datenanalyse auswerten wie in <a href="eda-ggplot.html" class="quarto-xref"><span>Kapitel 16</span></a> beschrieben. ƒƒ</p>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-2">Abbildung&nbsp;29.1&nbsp;(a)— Die Sprungweite in [cm] ohne den Faktor <code>animal</code> betrachtet.</span>
<span class="glightbox-desc lightbox-desc-3">Abbildung&nbsp;29.1&nbsp;(b)— Die Sprungweite in [cm] mit den Faktor <code>animal</code> eingefärbt.</span>
<span class="glightbox-desc lightbox-desc-4">Abbildung&nbsp;29.1&nbsp;(c)— Die Sprungweite in [cm] mit den Faktor <code>animal</code> eingefärbt und gruppiert.</span>
<span class="glightbox-desc lightbox-desc-5">Abbildung&nbsp;29.2&nbsp;(a)— Die Sprungweite in [cm] mit den Faktor <code>animal</code> gruppiert und das globale Mittel <span class="math inline">\(\bar{y}_{..} = 7.34\)</span> ergänzt.</span>
<span class="glightbox-desc lightbox-desc-6">Abbildung&nbsp;29.2&nbsp;(b)— Die Sprungweite in [cm] mit den Faktor <code>animal</code> gruppiert und die lokalen Mittel <span class="math inline">\(\bar{y}_{i.}\)</span> für jedes Level ergänzt.</span>
<span class="glightbox-desc lightbox-desc-7">Abbildung&nbsp;29.2&nbsp;(c)— Die Sprungweite in [cm] mit den Faktor <code>animal</code> gruppiert und die Abweichungen <span class="math inline">\(\beta_i\)</span> ergänzt.</span>
<span class="glightbox-desc lightbox-desc-8">Abbildung&nbsp;29.3&nbsp;(a)— Kein Effekt</span>
<span class="glightbox-desc lightbox-desc-9">Abbildung&nbsp;29.3&nbsp;(b)— Leichter bis mittlerer Effekt</span>
<span class="glightbox-desc lightbox-desc-10">Abbildung&nbsp;29.4— Visualisierung der Varianzzerlegung des Weges vom globalen Mittel zu der einzelnen Beoabchtung. Um zu einer einzelnen Beobachtung zu kommen legen wir den Weg vom globalen Mittelwert über den Abstand vom globalen Mittel zum Gruppenmittel <span class="math inline">\(\beta\)</span> zurück. Dann fehlt noch der Rest oder Fehler oder Residuum <span class="math inline">\(\epsilon\)</span>.</span>
<span class="glightbox-desc lightbox-desc-11">Abbildung&nbsp;29.5— Visualisierung der Annahmen an eine ANOVA. Wir berechnen den <span class="math inline">\(MS_{treatment}\)</span> in dem wir alle Abweichungen vom gloablen Mittel <span class="math inline">\(\bar{y}_{..}\)</span> aufaddieren. Ebenso berechnen wir den <span class="math inline">\(MS_{error}\)</span> indem wir die einzelen Abweichungen von den Bobachtungen <span class="math inline">\(\epsilon\)</span> zu den lokalen Mitteln berechnen. Hat jetzt eine Gruppe, wie die Gruppe D, eine abweichende Streuung, wird das <span class="math inline">\(MS_{error}\)</span> überproportional groß. Damit wird dann die F Statistik klein.</span>
<span class="glightbox-desc lightbox-desc-12">Abbildung&nbsp;29.6— Boxplot der Sprungweiten [cm] von Hunden-, Katzen- und Fuchsflöhen.</span>
<span class="glightbox-desc lightbox-desc-14">Abbildung&nbsp;29.7— Boxplot der Sprungweiten [cm] von Hunden und Katzen.</span>
<span class="glightbox-desc lightbox-desc-15">Abbildung&nbsp;29.8&nbsp;(a)— Keine Interaktion</span>
<span class="glightbox-desc lightbox-desc-16">Abbildung&nbsp;29.8&nbsp;(b)— Leichte bis mittlere Intraktion</span>
<span class="glightbox-desc lightbox-desc-17">Abbildung&nbsp;29.8&nbsp;(c)— Starke Interaktion</span>
<span class="glightbox-desc lightbox-desc-18">Abbildung&nbsp;29.9— Interaktionsplot für die Hunde-, Katzen- und Fuchsflöhe.</span>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-tests-ttest.html" class="pagination-link" aria-label="Der t-Test">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Der t-Test</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-tests-ancova.html" class="pagination-link" aria-label="Die ANCOVA">
        <span class="nav-page-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-anova.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-anova.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","loop":false,"closeEffect":"zoom","openEffect":"zoom","descPosition":"bottom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>
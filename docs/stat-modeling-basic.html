<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.629">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Skript Bio Data Science - 32&nbsp; Multiple lineare Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-modeling-outlier.html" rel="next">
<link href="./stat-modeling-preface.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skript Bio Data Science</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Willkommen</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Literatur</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Einführung</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./example-preface.html" class="sidebar-item-text sidebar-link">Datenbeispiele</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Von Flöhen und Hunden</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen, Hunden und Katzen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-foxes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-foxes-site.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren in Habitaten</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-length-weight.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von vielen Flöhen auf Hunden und Katzen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Gummibärchen</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">Programmieren in R</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Von Buchstaben und Zahlen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten einlesen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">Explorative Datenanalyse</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./stat-tests-preface.html" class="sidebar-item-text sidebar-link">Frequentistische Hypothesentests</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Der t-Test</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die ANOVA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Multiple Vergleiche oder Post-hoc Tests</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">Grundlagen der linearen Regression</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Maßzahlen der Modelgüte</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Korrelation</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">Statistisches Modellieren</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Ausreißer</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Imputation fehlender Werte</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Variablenselektion</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Gaussian lineare Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Lineare gemische Modelle</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./experimentel-design-preface.html" class="sidebar-item-text sidebar-link">Experimentelles Design</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimentel-design-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Grundlagen der Versuchsplanung</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a href="./bayes-preface.html" class="sidebar-item-text sidebar-link">Bayesianische Statistik</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Grundlagen der Bayesianischen Statistik</span></a>
  </div>
</li>
    </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">Anhang</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-example-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Beispielhafte Auswertungen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-r-tutorial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Tutorium in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-how-to-write.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Writing principles</span></a>
  </div>
</li>
    </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
<li><a href="#genutzte-r-pakete-f%C3%BCr-das-kapitel" id="toc-genutzte-r-pakete-für-das-kapitel" class="nav-link active" data-scroll-target="#genutzte-r-pakete-f%C3%BCr-das-kapitel"> <span class="header-section-number">32.1</span> Genutzte R Pakete für das Kapitel</a></li>
  <li>
<a href="#die-modelmatrix-in-r" id="toc-die-modelmatrix-in-r" class="nav-link" data-scroll-target="#die-modelmatrix-in-r"> <span class="header-section-number">32.2</span> Die Modelmatrix in R</a>
  <ul class="collapse">
<li><a href="#kontinuierliches-x" id="toc-kontinuierliches-x" class="nav-link" data-scroll-target="#kontinuierliches-x"> <span class="header-section-number">32.2.1</span> Kontinuierliches <span class="math inline">\(x\)</span></a></li>
  <li><a href="#kategorielles-x-mit-2-leveln" id="toc-kategorielles-x-mit-2-leveln" class="nav-link" data-scroll-target="#kategorielles-x-mit-2-leveln"> <span class="header-section-number">32.2.2</span> Kategorielles <span class="math inline">\(x\)</span> mit 2 Leveln</a></li>
  <li><a href="#kategorielles-x-mit-2-leveln-1" id="toc-kategorielles-x-mit-2-leveln-1" class="nav-link" data-scroll-target="#kategorielles-x-mit-2-leveln-1"> <span class="header-section-number">32.2.3</span> Kategorielles <span class="math inline">\(x\)</span> mit &gt;2 Leveln</a></li>
  <li><a href="#das-volle-modell" id="toc-das-volle-modell" class="nav-link" data-scroll-target="#das-volle-modell"> <span class="header-section-number">32.2.4</span> Das volle Modell</a></li>
  </ul>
</li>
  <li>
<a href="#sec-interpret-x" id="toc-sec-interpret-x" class="nav-link" data-scroll-target="#sec-interpret-x"> <span class="header-section-number">32.3</span> Interpretation von <span class="math inline">\(x\)</span></a>
  <ul class="collapse">
<li><a href="#sec-interpret-x-cont" id="toc-sec-interpret-x-cont" class="nav-link" data-scroll-target="#sec-interpret-x-cont"> <span class="header-section-number">32.3.1</span> Kontinuierliches <span class="math inline">\(x\)</span></a></li>
  <li><a href="#sec-interpret-x-cat2" id="toc-sec-interpret-x-cat2" class="nav-link" data-scroll-target="#sec-interpret-x-cat2"> <span class="header-section-number">32.3.2</span> Kategorielles <span class="math inline">\(x\)</span> mit 2 Leveln</a></li>
  <li><a href="#sec-interpret-x-cat3" id="toc-sec-interpret-x-cat3" class="nav-link" data-scroll-target="#sec-interpret-x-cat3"> <span class="header-section-number">32.3.3</span> Kategorielles <span class="math inline">\(x\)</span> mit &gt;2 Leveln</a></li>
  </ul>
</li>
  <li><a href="#adjustierung-f%C3%BCr-confounder" id="toc-adjustierung-für-confounder" class="nav-link" data-scroll-target="#adjustierung-f%C3%BCr-confounder"> <span class="header-section-number">32.4</span> Adjustierung für Confounder</a></li>
  <li><a href="#variance-inflation-factor-vif" id="toc-variance-inflation-factor-vif" class="nav-link" data-scroll-target="#variance-inflation-factor-vif"> <span class="header-section-number">32.5</span> Variance inflation factor (VIF)</a></li>
  <li><a href="#vergleich-von-modellen" id="toc-vergleich-von-modellen" class="nav-link" data-scroll-target="#vergleich-von-modellen"> <span class="header-section-number">32.6</span> Vergleich von Modellen</a></li>
  <li><a href="#generalisierung-von-lm-zu-glm-und-glmer" id="toc-generalisierung-von-lm-zu-glm-und-glmer" class="nav-link" data-scroll-target="#generalisierung-von-lm-zu-glm-und-glmer"> <span class="header-section-number">32.7</span> Generalisierung von <code>lm()</code> zu <code>glm()</code> und <code>[g]lmer()</code></a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-mult-reg-basic" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header><div class="cell">

</div>
<p><em>Version vom September 08, 2022 um 16:37:15</em></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/caution.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
<p>Ein multiples lineare Modell hat mehrere <span class="math inline">\(x\)</span>. Daher haben wir auf der linken Seite ein <span class="math inline">\(y\)</span> und auf der rechten Seite <span class="math inline">\(p\)</span>-mal ein <span class="math inline">\(x\)</span>. Wir können daher ein multiples lineares Modell daher wie folgt in R schreiben.</p>
<p><span class="math display">\[
y \sim x_1 + x_2 + ... + x_p
\]</span></p>
<p>Oder konkreter können wir sagen, dass <code>jump_length</code> von <code>animal</code>, <code>sex</code> und <code>weight</code> abhängt und wir diesen Zusammenhang modellieren wollen.</p>
<p><span class="math display">\[
jump\_length \sim animal + sex + weight
\]</span></p>
<p>Das hilft uns jetzt nur bedingt, denn wir wollen ja aus einer Modellierung in R die Koeffizienten der Regression wiederbekommen. Dafür müssen wir uns nochmal klar werden, was die Koeffizienten einer Regression sind. Das sind zum einen der y-Achsenabschnitt <span class="math inline">\(\beta_0\)</span> und die Steigung der einzelnen Variablen mit <span class="math inline">\(\beta_1\)</span> bis <span class="math inline">\(\beta_p\)</span>. Wir erhalten auch bei einem multiplen Regressionsmodell nur einen Vektor mit den Residuen wieder.</p>
<p><span class="math display">\[
y \sim \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_p x_p + \epsilon
\]</span></p>
<p>Dennoch sind die Residuen <span class="math inline">\(\epsilon\)</span> normalverteilt. Wir haben im Mittel einen Abstand der <span class="math inline">\(\epsilon\)</span>’s zur geraden von 0 und eine Streuung von <span class="math inline">\(s^2_{\epsilon}\)</span>.</p>
<p><span class="math display">\[
\epsilon \sim \mathcal{N}(0, s^2_{\epsilon})
\]</span></p>
<p>Wir zeichen im Prinzip eine Gerade durch den <span class="math inline">\(p\)</span>-dimensioneln Raum.</p>
<section id="genutzte-r-pakete-für-das-kapitel" class="level2" data-number="32.1"><h2 data-number="32.1" class="anchored" data-anchor-id="genutzte-r-pakete-für-das-kapitel">
<span class="header-section-number">32.1</span> Genutzte R Pakete für das Kapitel</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>, <span class="va">magrittr</span>, <span class="va">conflicted</span>, <span class="va">broom</span>,</span>
<span>               <span class="va">see</span>, <span class="va">performance</span>, <span class="va">car</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"select"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"filter"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"mutate"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="va">cbbPalette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Am Ende des Kapitels findest du nochmal den gesamten R Code in einem Rutsch zum selber durchführen oder aber kopieren.</p>
</section><section id="die-modelmatrix-in-r" class="level2" data-number="32.2"><h2 data-number="32.2" class="anchored" data-anchor-id="die-modelmatrix-in-r">
<span class="header-section-number">32.2</span> Die Modelmatrix in R</h2>
<p>Als erstes wollen wir verstehen, wie ein Modell <em>in</em> R aussieht. Dann können wir auch besser verstehen, wie die eigentlichen Koeffizienten aus dem Modell entstehen. Wir bauen uns dafür ein sehr simplen Datensatz.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">snake_tbl</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>mass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>                    region <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"west"</span>,<span class="st">"west"</span>, <span class="st">"west"</span>, <span class="st">"nord"</span>,<span class="st">"nord"</span>,<span class="st">"nord"</span>,<span class="st">"nord"</span>,<span class="st">"nord"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    color <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"schwarz"</span>, <span class="st">"schwarz"</span>, <span class="st">"rot"</span>, <span class="st">"rot"</span>, <span class="st">"rot"</span>, <span class="st">"blau"</span>, <span class="st">"blau"</span>, <span class="st">"blau"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    svl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">45</span>, <span class="fl">39</span>, <span class="fl">51</span>, <span class="fl">52</span>, <span class="fl">57</span>, <span class="fl">58</span>, <span class="fl">49</span><span class="op">)</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#tbl-snakes">Tabelle&nbsp;<span>32.1</span></a> ist der Datensatz <code>snake_tbl</code> nochmal dargestellt. Wir haben die Schlangenlänge <code>svl</code> als Outcome <span class="math inline">\(y\)</span> sowie das Gewicht der Schlangen <code>mass</code>, die Sammelregion <code>region</code> und die Farbe der Schlangen <code>color</code>. Dabei ist <code>mass</code> eine kontinuierliche Variable, <code>region</code> eine kategorielle Variable als Faktor mit zwei Leveln und <code>color</code> eine kategorielle Variable als Faktor mit drei Leveln.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-snakes" class="anchored">
<table class="table table-sm table-striped">
<caption>Tabelle 32.1— Datensatz zu Schlangen ist entlehnt und modifiiert nach Kéry <span class="citation" data-cites="kery2010introduction">(<a href="#ref-kery2010introduction" role="doc-biblioref">2010</a>, p.&nbsp;77)</span>
</caption>
<thead><tr class="header">
<th style="text-align: center;">mass</th>
<th style="text-align: center;">region</th>
<th style="text-align: center;">color</th>
<th style="text-align: center;">svl</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">6</td>
<td style="text-align: center;">west</td>
<td style="text-align: center;">schwarz</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">west</td>
<td style="text-align: center;">schwarz</td>
<td style="text-align: center;">45</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">west</td>
<td style="text-align: center;">rot</td>
<td style="text-align: center;">39</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">rot</td>
<td style="text-align: center;">51</td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">rot</td>
<td style="text-align: center;">52</td>
</tr>
<tr class="even">
<td style="text-align: center;">11</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">blau</td>
<td style="text-align: center;">57</td>
</tr>
<tr class="odd">
<td style="text-align: center;">12</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">blau</td>
<td style="text-align: center;">58</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">blau</td>
<td style="text-align: center;">49</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Wir wollen uns nun einmal anschauen, wie ein Modell in R sich zusammensetzt.</p>
<section id="kontinuierliches-x" class="level3" data-number="32.2.1"><h3 data-number="32.2.1" class="anchored" data-anchor-id="kontinuierliches-x">
<span class="header-section-number">32.2.1</span> Kontinuierliches <span class="math inline">\(x\)</span>
</h3>
<p>Im ersten Schritt wollen wir uns einmal das Modell mit einem kontenuierlichen <span class="math inline">\(x\)</span> anschauen. Wir bauen uns ein Modell mit der Variable <code>mass</code>. Die Funktion <code><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix()</a></code> gibt uns die Modelmatrix wieder.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="va">svl</span> <span class="op">~</span> <span class="va">mass</span>, data <span class="op">=</span> <span class="va">snake_tbl</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">as_tibble</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  `(Intercept)`  mass
          &lt;dbl&gt; &lt;dbl&gt;
1             1     6
2             1     8
3             1     5
4             1     7
5             1     9
6             1    11
7             1    12
8             1    10</code></pre>
</div>
</div>
<p>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalte <code>mass</code> als kontinuierliche Variable.</p>
<p>Wir können die Modellmatrix auch mathematisch schreiben und die <span class="math inline">\(y\)</span> Spalte für das Outcome <code>svl</code> ergänzen. Eben so ergänzen wir die <span class="math inline">\(\beta\)</span>-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Gerade.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp; 6 \\
  1 &amp; 8 \\
  1 &amp; 5 \\
  1 &amp; 7 \\
  1 &amp; 9 \\
  1 &amp; 11\\
  1 &amp; 12\\
  1 &amp; 10\\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta_{mass}
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<p>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> um uns die Koeffizienten wiedergeben zu lassen. Die Funktion <code><a href="https://rdrr.io/r/stats/residuals.html">residuals()</a></code> gibt uns die Residuen der Geraden wieder.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">svl</span> <span class="op">~</span> <span class="va">mass</span>, data <span class="op">=</span> <span class="va">snake_tbl</span><span class="op">)</span> </span>
<span><span class="va">fit_1</span> <span class="op">%&gt;%</span> <span class="va">coef</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        mass 
      26.71        2.61 </code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_1</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
-2.36 -2.57 -0.75  6.04  1.82  1.61  0.00 -3.79 </code></pre>
</div>
</div>
<p>Wir können jetzt die Koeffizienten ergänzen mit <span class="math inline">\(\beta_0 = 26.71\)</span> für den Intercept. Weiter ergänzen wir die Koeffizienten für <code>mass</code> mit <span class="math inline">\(\beta_{mass}=2.61\)</span>. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  26.71 &amp; \phantom{0}6 \cdot 2.61\\
  26.71 &amp; \phantom{0}8 \cdot 2.61\\
  26.71 &amp; \phantom{0}5 \cdot 2.61\\
  26.71 &amp; \phantom{0}7 \cdot 2.61\\
  26.71 &amp; \phantom{0}9 \cdot 2.61\\
  26.71 &amp; 11\cdot 2.61\\
  26.71 &amp; 12\cdot 2.61\\
  26.71 &amp; 10\cdot 2.61\\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta_{mass}
\end{pmatrix} +
  \begin{pmatrix}
  -2.36\\
  -2.57\\
  -0.75 \\
  +6.04\\
  +1.82\\
  +1.61\\
  \phantom{+}0.00\\
  -3.79\\
\end{pmatrix}
\]</span></p>
<p>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">26.71</span> <span class="op">+</span>  <span class="fl">6</span><span class="op">*</span><span class="fl">2.61</span> <span class="op">-</span> <span class="fl">2.36</span>,</span>
<span>  <span class="fl">26.71</span> <span class="op">+</span>  <span class="fl">8</span><span class="op">*</span><span class="fl">2.61</span> <span class="op">-</span> <span class="fl">2.57</span>,</span>
<span>  <span class="fl">26.71</span> <span class="op">+</span>  <span class="fl">5</span><span class="op">*</span><span class="fl">2.61</span> <span class="op">-</span> <span class="fl">0.75</span>,</span>
<span>  <span class="fl">26.71</span> <span class="op">+</span>  <span class="fl">7</span><span class="op">*</span><span class="fl">2.61</span> <span class="op">+</span> <span class="fl">6.04</span>,</span>
<span>  <span class="fl">26.71</span> <span class="op">+</span>  <span class="fl">9</span><span class="op">*</span><span class="fl">2.61</span> <span class="op">+</span> <span class="fl">1.82</span>,</span>
<span>  <span class="fl">26.71</span> <span class="op">+</span> <span class="fl">11</span><span class="op">*</span><span class="fl">2.61</span> <span class="op">+</span> <span class="fl">1.61</span>,</span>
<span>  <span class="fl">26.71</span> <span class="op">+</span> <span class="fl">12</span><span class="op">*</span><span class="fl">2.61</span> <span class="op">+</span> <span class="fl">0.00</span>,</span>
<span>  <span class="fl">26.71</span> <span class="op">+</span> <span class="fl">10</span><span class="op">*</span><span class="fl">2.61</span> <span class="op">-</span> <span class="fl">3.79</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 57 58 49</code></pre>
</div>
</div>
<p>Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Outcome <span class="math inline">\(y\)</span> hat.</p>
</section><section id="kategorielles-x-mit-2-leveln" class="level3" data-number="32.2.2"><h3 data-number="32.2.2" class="anchored" data-anchor-id="kategorielles-x-mit-2-leveln">
<span class="header-section-number">32.2.2</span> Kategorielles <span class="math inline">\(x\)</span> mit 2 Leveln</h3>
<p>Im diesem Schritt wollen wir uns einmal das Modell mit einem kategoriellen <span class="math inline">\(x\)</span> mit 2 Leveln anschauen. Wir bauen uns ein Modell mit der Variable <code>region``. Die Funktion</code>model.matrix()` gibt uns die Modelmatrix wieder.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="va">svl</span> <span class="op">~</span> <span class="va">region</span>, data <span class="op">=</span> <span class="va">snake_tbl</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">as_tibble</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  `(Intercept)` regionnord
          &lt;dbl&gt;      &lt;dbl&gt;
1             1          0
2             1          0
3             1          0
4             1          1
5             1          1
6             1          1
7             1          1
8             1          1</code></pre>
</div>
</div>
<p>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalte <code>regionnord</code>. In dieser Spalte steht die Dummykodierung für die Variable <code>region</code>. Die ersten drei Schlangen kommen nicht aus der Region <code>nord</code> und werden deshalb mit einen Wert von 0 versehen. Die nächsten vier Schlangen kommen aus der Region <code>nord</code> und erhalten daher eine 1 in der Spalte.</p>
<p>Wir können die Modellmatrix auch mathematisch schreiben und die <span class="math inline">\(y\)</span> Spalte für das Outcome <code>svl</code> ergänzen. Eben so ergänzen wir die <span class="math inline">\(\beta\)</span>-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Gerade.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp;  0  \\
  1 &amp;  0 \\
  1 &amp;  0\\
  1 &amp;  1\\
  1 &amp;  1 \\
  1 &amp;  1 \\
  1 &amp;  1 \\
  1 &amp;  1 \\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta^{region}_{nord} \\
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<p>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> um uns die Koeffizienten wiedergeben zu lassen. Die Funktion <code><a href="https://rdrr.io/r/stats/residuals.html">residuals()</a></code> gibt uns die Residuen der Geraden wieder.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">svl</span> <span class="op">~</span> <span class="va">region</span>, data <span class="op">=</span> <span class="va">snake_tbl</span><span class="op">)</span> </span>
<span><span class="va">fit_2</span> <span class="op">%&gt;%</span> <span class="va">coef</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)  regionnord 
      41.33       12.07 </code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
-1.33  3.67 -2.33 -2.40 -1.40  3.60  4.60 -4.40 </code></pre>
</div>
</div>
<p>Wir können jetzt die Koeffizienten ergänzen mit <span class="math inline">\(\beta_0 = 41.33\)</span> für den Intercept. Weiter ergänzen wir die Koeffizienten für die Region und das Level <code>nord</code> mit <span class="math inline">\(\beta^{region}_{nord} = 12.07\)</span>. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  41.33 &amp; 0 \cdot 12.07  \\
  41.33 &amp; 0 \cdot 12.07  \\
  41.33 &amp; 0 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
\end{pmatrix} +
  \begin{pmatrix}
  -1.33\\
  +3.67 \\
  -2.33 \\
  -2.40 \\
  -1.40 \\
  +3.60 \\
  +4.60 \\
  -4.40 \\
\end{pmatrix}
\]</span></p>
<p>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">41.33</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">12.07</span> <span class="op">-</span> <span class="fl">1.33</span>,</span>
<span>  <span class="fl">41.33</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">12.07</span> <span class="op">+</span> <span class="fl">3.67</span>,</span>
<span>  <span class="fl">41.33</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">12.07</span> <span class="op">-</span> <span class="fl">2.33</span>,</span>
<span>  <span class="fl">41.33</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">12.07</span> <span class="op">-</span> <span class="fl">2.40</span>,</span>
<span>  <span class="fl">41.33</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">12.07</span> <span class="op">-</span> <span class="fl">1.40</span>,</span>
<span>  <span class="fl">41.33</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">12.07</span> <span class="op">+</span> <span class="fl">3.60</span>,</span>
<span>  <span class="fl">41.33</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">12.07</span> <span class="op">+</span> <span class="fl">4.60</span>,</span>
<span>  <span class="fl">41.33</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">12.07</span> <span class="op">-</span> <span class="fl">4.40</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 57 58 49</code></pre>
</div>
</div>
<p>Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Outcome <span class="math inline">\(y\)</span> hat.</p>
</section><section id="kategorielles-x-mit-2-leveln-1" class="level3" data-number="32.2.3"><h3 data-number="32.2.3" class="anchored" data-anchor-id="kategorielles-x-mit-2-leveln-1">
<span class="header-section-number">32.2.3</span> Kategorielles <span class="math inline">\(x\)</span> mit &gt;2 Leveln</h3>
<p>Im diesem Schritt wollen wir uns einmal das Modell mit einem kategoriellen <span class="math inline">\(x\)</span> mit &gt;2 Leveln anschauen. Wir bauen uns ein Modell mit der Variable <code>color</code>. Die Funktion <code><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix()</a></code> gibt uns die Modelmatrix wieder.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="va">svl</span> <span class="op">~</span> <span class="va">color</span>, data <span class="op">=</span> <span class="va">snake_tbl</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">as_tibble</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  `(Intercept)` colorrot colorblau
          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1             1        0         0
2             1        0         0
3             1        1         0
4             1        1         0
5             1        1         0
6             1        0         1
7             1        0         1
8             1        0         1</code></pre>
</div>
</div>
<p>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalten für <code>color</code>. Die Spalten <code>colorrot</code> und <code>colorblau</code> geben jeweils an, ob die Schlange das Level <code>rot</code> hat oder <code>blau</code> oder keins von beiden. Wenn die Schlange weder rot noch blau ist, dann sind beide Spalten mit einer 0 versehen. Dann ist die Schlange schwarz.</p>
<p>Wir können die Modellmatrix auch mathematisch schreiben und die <span class="math inline">\(y\)</span> Spalte für das Outcome <code>svl</code> ergänzen. Eben so ergänzen wir die <span class="math inline">\(\beta\)</span>-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Gerade.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp; 0 &amp; 0 \\
  1 &amp; 0 &amp; 0\\
  1 &amp; 1 &amp; 0\\
  1 &amp; 1 &amp; 0\\
  1 &amp; 1 &amp; 0\\
  1 &amp; 0 &amp; 1\\
  1 &amp; 0 &amp; 1\\
  1 &amp; 0 &amp; 1\\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta^{color}_{rot} \\
  \beta^{color}_{blau} \\
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<p>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> um uns die Koeffizienten wiedergeben zu lassen. Die Funktion <code><a href="https://rdrr.io/r/stats/residuals.html">residuals()</a></code> gibt uns die Residuen der Geraden wieder.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">svl</span> <span class="op">~</span> <span class="va">color</span>, data <span class="op">=</span> <span class="va">snake_tbl</span><span class="op">)</span> </span>
<span><span class="va">fit_3</span> <span class="op">%&gt;%</span> <span class="va">coef</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)    colorrot   colorblau 
      42.50        4.83       12.17 </code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_3</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
-2.50  2.50 -8.33  3.67  4.67  2.33  3.33 -5.67 </code></pre>
</div>
</div>
<p>Wir können jetzt die Koeffizienten ergänzen mit <span class="math inline">\(\beta_0 = 25\)</span> für den Intercept. Weiter ergänzen wir die Koeffizienten für die Farbe und das Level <code>rot</code> mit <span class="math inline">\(\beta^{color}_{rot} = 4.83\)</span> und für die Farbe und das Level <code>blau</code> mit <span class="math inline">\(\beta^{color}_{blau} = 12.17\)</span>. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  42.50 &amp; 0 \cdot 4.83&amp; 0 \cdot 12.17 \\
  42.50 &amp; 0 \cdot 4.83&amp; 0 \cdot 12.17\\
  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17\\
  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17\\
  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17\\
  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17\\
  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17\\
  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17\\
\end{pmatrix} +
  \begin{pmatrix}
  -2.50 \\
  +2.50 \\
  -8.33 \\
  +3.67 \\
  +4.67 \\
  +2.33 \\
  +3.33 \\
  -5.67 \\
\end{pmatrix}
\]</span></p>
<p>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">42.50</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">4.83</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="op">-</span><span class="fl">12.17</span> <span class="op">-</span> <span class="fl">2.50</span>,</span>
<span>  <span class="fl">42.50</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">4.83</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="op">-</span><span class="fl">12.17</span> <span class="op">+</span> <span class="fl">2.50</span>,</span>
<span>  <span class="fl">42.50</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">4.83</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="op">-</span><span class="fl">12.17</span> <span class="op">-</span> <span class="fl">8.33</span>,</span>
<span>  <span class="fl">42.50</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">4.83</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="op">-</span><span class="fl">12.17</span> <span class="op">+</span> <span class="fl">3.67</span>,</span>
<span>  <span class="fl">42.50</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">4.83</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="op">-</span><span class="fl">12.17</span> <span class="op">+</span> <span class="fl">4.67</span>,</span>
<span>  <span class="fl">42.50</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">4.83</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="op">-</span><span class="fl">12.17</span> <span class="op">+</span> <span class="fl">2.33</span>,</span>
<span>  <span class="fl">42.50</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">4.83</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="op">-</span><span class="fl">12.17</span> <span class="op">+</span> <span class="fl">3.33</span>,</span>
<span>  <span class="fl">42.50</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">4.83</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="op">-</span><span class="fl">12.17</span> <span class="op">-</span> <span class="fl">5.67</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 33 34 25</code></pre>
</div>
</div>
<p>Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Outcome <span class="math inline">\(y\)</span> hat.</p>
</section><section id="das-volle-modell" class="level3" data-number="32.2.4"><h3 data-number="32.2.4" class="anchored" data-anchor-id="das-volle-modell">
<span class="header-section-number">32.2.4</span> Das volle Modell</h3>
<p>Im letzten Schritt wollen wir uns einmal das volle Modell anschauen. Wir bauen uns ein Modell mit allen Variablen in dem Datensatz <code>snake_tbl</code>. Die Funktion <code><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix()</a></code> gibt uns die Modelmatrix wieder.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="va">svl</span> <span class="op">~</span> <span class="va">mass</span> <span class="op">+</span> <span class="va">region</span> <span class="op">+</span> <span class="va">color</span>, data <span class="op">=</span> <span class="va">snake_tbl</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  `(Intercept)`  mass regionnord colorrot colorblau
          &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1             1     6          0        0         0
2             1     8          0        0         0
3             1     5          0        1         0
4             1     7          1        1         0
5             1     9          1        1         0
6             1    11          1        0         1
7             1    12          1        0         1
8             1    10          1        0         1</code></pre>
</div>
</div>
<p>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalte <code>mass</code> als kontenuierliche Variable. In der Spalte <code>regionnord</code> steht die Dummykodierung für die Variable <code>region</code>. Die ersten drei Schlangen kommen nicht aus der Region <code>nord</code> und werden deshalb mit einen Wert von 0 versehen. Die nächsten vier Schlangen kommen aus der Region <code>nord</code> und erhalten daher eine 1 in der Spalte. Die nächsten beiden Spalten sind etwas komplizierter. Die Spalten <code>colorrot</code> und <code>colorblau</code> geben jeweils an, ob die Schlange das Level <code>rot</code> hat oder <code>blau</code> oder keins von beiden. Wenn die Schlange weder rot noch blau ist, dann sind beide Spalten mit einer 0 versehen. Dann ist die Schlange schwarz.</p>
<p>Wir können die Modellmatrix auch mathematisch schreiben und die <span class="math inline">\(y\)</span> Spalte für das Outcome <code>svl</code> ergänzen. Eben so ergänzen wir die <span class="math inline">\(\beta\)</span>-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Gerade.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp; 6 &amp; 0 &amp; 0 &amp; 0 \\
  1 &amp; 8 &amp; 0 &amp; 0 &amp; 0\\
  1 &amp; 5 &amp; 0 &amp; 1 &amp; 0\\
  1 &amp; 7 &amp; 1 &amp; 1 &amp; 0\\
  1 &amp; 9 &amp; 1 &amp; 1 &amp; 0\\
  1 &amp; 11&amp; 1 &amp; 0 &amp; 1\\
  1 &amp; 12&amp; 1 &amp; 0 &amp; 1\\
  1 &amp; 10&amp; 1 &amp; 0 &amp; 1\\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta_{mass} \\
  \beta^{region}_{nord} \\
  \beta^{color}_{rot} \\
  \beta^{color}_{blau} \\
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<p>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <code><a href="https://rdrr.io/r/stats/coef.html">coef()</a></code> um uns die Koeffizienten wiedergeben zu lassen. Die Funktion <code><a href="https://rdrr.io/r/stats/residuals.html">residuals()</a></code> gibt uns die Residuen der Geraden wieder.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">svl</span> <span class="op">~</span> <span class="va">mass</span> <span class="op">+</span> <span class="va">region</span> <span class="op">+</span> <span class="va">color</span>, data <span class="op">=</span> <span class="va">snake_tbl</span><span class="op">)</span> </span>
<span><span class="va">fit_4</span> <span class="op">%&gt;%</span> <span class="va">coef</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        mass  regionnord    colorrot   colorblau 
      25.00        2.50        5.00        1.50       -2.83 </code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_4</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
 0.00  0.00  0.00  2.00 -2.00  2.33  0.83 -3.17 </code></pre>
</div>
</div>
<p>Wir können jetzt die Koeffizienten ergänzen mit <span class="math inline">\(\beta_0 = 25\)</span> für den Intercept. Weiter ergänzen wir die Koeffizienten für <code>mass</code> mit <span class="math inline">\(\beta_{mass}=2.5\)</span>, für Region und das Level <code>nord</code> mit <span class="math inline">\(\beta^{region}_{nord} = 5\)</span>, für die Farbe und das Level <code>rot</code> mit <span class="math inline">\(\beta^{color}_{rot} = 1.5\)</span> und für die Farbe und das Level <code>blau</code> mit <span class="math inline">\(\beta^{color}_{blau} = -2.83\)</span>. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  25 &amp; \phantom{0}6 \cdot 2.5 &amp; 0 \cdot 5 &amp; 0 \cdot 1.5&amp; 0 \cdot -2.83 \\
  25 &amp; \phantom{0}8 \cdot 2.5 &amp; 0 \cdot 5 &amp; 0 \cdot 1.5&amp; 0 \cdot -2.83\\
  25 &amp; \phantom{0}5 \cdot 2.5 &amp; 0 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83\\
  25 &amp; \phantom{0}7 \cdot 2.5 &amp; 1 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83\\
  25 &amp; \phantom{0}9 \cdot 2.5 &amp; 1 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83\\
  25 &amp; 11\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83\\
  25 &amp; 12\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83\\
  25 &amp; 10\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83\\
\end{pmatrix} +
  \begin{pmatrix}
  \phantom{+}0.00 \\
  \phantom{+}0.00 \\
  \phantom{+}0.00 \\
  +2.00 \\
  -2.00 \\
  +2.33 \\
  +0.83 \\
  -3.17 \\
\end{pmatrix}
\]</span></p>
<p>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">25</span> <span class="op">+</span>  <span class="fl">6</span><span class="op">*</span><span class="fl">2.5</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">1.5</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="op">-</span><span class="fl">2.83</span> <span class="op">+</span> <span class="fl">0.00</span>,</span>
<span>  <span class="fl">25</span> <span class="op">+</span>  <span class="fl">8</span><span class="op">*</span><span class="fl">2.5</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">1.5</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="op">-</span><span class="fl">2.83</span> <span class="op">+</span> <span class="fl">0.00</span>,</span>
<span>  <span class="fl">25</span> <span class="op">+</span>  <span class="fl">5</span><span class="op">*</span><span class="fl">2.5</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">1.5</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="op">-</span><span class="fl">2.83</span> <span class="op">+</span> <span class="fl">0.00</span>,</span>
<span>  <span class="fl">25</span> <span class="op">+</span>  <span class="fl">7</span><span class="op">*</span><span class="fl">2.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">1.5</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="op">-</span><span class="fl">2.83</span> <span class="op">+</span> <span class="fl">2.00</span>,</span>
<span>  <span class="fl">25</span> <span class="op">+</span>  <span class="fl">9</span><span class="op">*</span><span class="fl">2.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">1.5</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="op">-</span><span class="fl">2.83</span> <span class="op">-</span> <span class="fl">2.00</span>,</span>
<span>  <span class="fl">25</span> <span class="op">+</span> <span class="fl">11</span><span class="op">*</span><span class="fl">2.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">1.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="op">-</span><span class="fl">2.83</span> <span class="op">+</span> <span class="fl">2.33</span>,</span>
<span>  <span class="fl">25</span> <span class="op">+</span> <span class="fl">12</span><span class="op">*</span><span class="fl">2.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">1.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="op">-</span><span class="fl">2.83</span> <span class="op">+</span> <span class="fl">0.83</span>,</span>
<span>  <span class="fl">25</span> <span class="op">+</span> <span class="fl">10</span><span class="op">*</span><span class="fl">2.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">0</span><span class="op">*</span><span class="fl">1.5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="op">-</span><span class="fl">2.83</span> <span class="op">-</span> <span class="fl">3.17</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 57 58 49</code></pre>
</div>
</div>
<p>Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Outcome <span class="math inline">\(y\)</span> hat. Was haben wir gelernt?</p>
<ul>
<li>In einem Modell gibt es immer ein Faktorlevel weniger als ein Faktor Level hat. Die Information des <em>alphanumerisch</em> ersten Levels steckt dann mit in dem Intercept.</li>
<li>In einem Modell geht eine kontinuierliche Variable als eine Spalte mit ein.</li>
<li>In einem Modell gibt es immer nur eine Spalte für die Residuen und damit nur eine Residue für jede Beobachtung, egal wie viele Variablen ein Modell hat.</li>
</ul></section></section><section id="sec-interpret-x" class="level2" data-number="32.3"><h2 data-number="32.3" class="anchored" data-anchor-id="sec-interpret-x">
<span class="header-section-number">32.3</span> Interpretation von <span class="math inline">\(x\)</span>
</h2>
<section id="sec-interpret-x-cont" class="level3" data-number="32.3.1"><h3 data-number="32.3.1" class="anchored" data-anchor-id="sec-interpret-x-cont">
<span class="header-section-number">32.3.1</span> Kontinuierliches <span class="math inline">\(x\)</span>
</h3>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">20137937</span><span class="op">)</span></span>
<span><span class="va">cont_tbl</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">7</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                   y <span class="op">=</span> <span class="fl">5</span> <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cont_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
      x     y
  &lt;dbl&gt; &lt;dbl&gt;
1     1  5.93
2     2  8.06
3     3  8.95
4     4 12.1 
5     5 11.9 
6     6 14.9 
7     7 16.3 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">cont_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) x
1           1 1
2           1 2
3           1 3
4           1 4
5           1 5
6           1 6
7           1 7
attr(,"assign")
[1] 0 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">cont_tbl</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">term</span>, <span class="va">estimate</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  term        estimate
  &lt;chr&gt;          &lt;dbl&gt;
1 (Intercept)     4.32
2 x               1.71</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">cont_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, fullrange <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">8</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">17</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">17</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">4</span>, y <span class="op">=</span> <span class="fl">9</span>, label <span class="op">=</span> <span class="st">"y ==  4.32 + 1.71 %.% x"</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-stat-modeling-basic-00" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-basic-00-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 32.1— foo</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="sec-interpret-x-cat2" class="level3" data-number="32.3.2"><h3 data-number="32.3.2" class="anchored" data-anchor-id="sec-interpret-x-cat2">
<span class="header-section-number">32.3.2</span> Kategorielles <span class="math inline">\(x\)</span> mit 2 Leveln</h3>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">20339537</span><span class="op">)</span></span>
<span><span class="va">cat_two_tbl</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                      B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span>, mean <span class="op">=</span> <span class="fl">15</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">gather</span><span class="op">(</span>key <span class="op">=</span> <span class="va">x</span>, value <span class="op">=</span> <span class="va">y</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cat_two_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 2
   x         y
   &lt;fct&gt; &lt;dbl&gt;
 1 A     10.0 
 2 A     10.8 
 3 A     10.7 
 4 A     11.0 
 5 A      9.25
 6 A      8.98
 7 A      9.71
 8 B     15.1 
 9 B     16.0 
10 B     14.5 
11 B     15.1 
12 B     14.2 
13 B     16.8 
14 B     15.6 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">cat_two_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) xB
1            1  0
2            1  0
3            1  0
4            1  0
5            1  0
6            1  0
7            1  0
8            1  1
9            1  1
10           1  1
11           1  1
12           1  1
13           1  1
14           1  1
attr(,"assign")
[1] 0 1
attr(,"contrasts")
attr(,"contrasts")$x
[1] "contr.treatment"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">cat_two_tbl</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">term</span>, <span class="va">estimate</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  term        estimate
  &lt;chr&gt;          &lt;dbl&gt;
1 (Intercept)    10.1 
2 xB              5.27</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-cat-2" class="anchored">
<table class="table table-sm table-striped">
<caption>Tabelle 32.2— Datensatz mit mehreren Outcomes zu Flöhen auf verschiedenen Tierarten.</caption>
<thead><tr class="header">
<th style="text-align: center;">Factor x</th>
<th style="text-align: center;">Mean of level</th>
<th style="text-align: center;">Difference to level A</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">10.07</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">15.33</td>
<td style="text-align: center;">5.27</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-stat-modeling-basic-01" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-basic-01-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 32.2— foo</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="sec-interpret-x-cat3" class="level3" data-number="32.3.3"><h3 data-number="32.3.3" class="anchored" data-anchor-id="sec-interpret-x-cat3">
<span class="header-section-number">32.3.3</span> Kategorielles <span class="math inline">\(x\)</span> mit &gt;2 Leveln</h3>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">20339537</span><span class="op">)</span></span>
<span><span class="va">cat_three_tbl</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                        B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span>, mean <span class="op">=</span> <span class="fl">15</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                        C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">7</span>, mean <span class="op">=</span> <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">gather</span><span class="op">(</span>key <span class="op">=</span> <span class="va">x</span>, value <span class="op">=</span> <span class="va">y</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cat_three_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 2
   x         y
   &lt;fct&gt; &lt;dbl&gt;
 1 A     10.0 
 2 A     10.8 
 3 A     10.7 
 4 A     11.0 
 5 A      9.25
 6 A      8.98
 7 A      9.71
 8 B     15.1 
 9 B     16.0 
10 B     14.5 
# … with 11 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">cat_three_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) xB xC
1            1  0  0
2            1  0  0
3            1  0  0
4            1  0  0
5            1  0  0
6            1  0  0
7            1  0  0
8            1  1  0
9            1  1  0
10           1  1  0
11           1  1  0
12           1  1  0
13           1  1  0
14           1  1  0
15           1  0  1
16           1  0  1
17           1  0  1
18           1  0  1
19           1  0  1
20           1  0  1
21           1  0  1
attr(,"assign")
[1] 0 1 1
attr(,"contrasts")
attr(,"contrasts")$x
[1] "contr.treatment"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">cat_three_tbl</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">term</span>, <span class="va">estimate</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  term        estimate
  &lt;chr&gt;          &lt;dbl&gt;
1 (Intercept)    10.1 
2 xB              5.27
3 xC             -7.41</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-cat-3" class="anchored">
<table class="table table-sm table-striped">
<caption>Tabelle 32.3— Datensatz mit mehreren Outcomes zu Flöhen auf verschiedenen Tierarten.</caption>
<thead><tr class="header">
<th style="text-align: center;">Factor x</th>
<th style="text-align: center;">Mean of level</th>
<th style="text-align: center;">Difference to level A</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">10.07</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">15.33</td>
<td style="text-align: center;">5.27</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">2.66</td>
<td style="text-align: center;">-7.41</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-stat-modeling-basic-02" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-basic-02-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 32.3— foo</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section></section><section id="adjustierung-für-confounder" class="level2 page-columns page-full" data-number="32.4"><h2 data-number="32.4" class="anchored" data-anchor-id="adjustierung-für-confounder">
<span class="header-section-number">32.4</span> Adjustierung für Confounder</h2>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_csv2</span><span class="op">(</span><span class="st">"data/flea_dog_cat_length_weight.csv"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>animal <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">animal</span><span class="op">)</span>,</span>
<span>         sex <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span>,</span>
<span>         log_hatch_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">hatch_time</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="stat-modeling-gaussian.html#tbl-model-1">Tabelle&nbsp;<span>36.1</span></a> ist der Datensatz <code>model_tbl</code> nochmal dargestellt.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-model-1" class="anchored">
<table class="table table-sm table-striped">
<caption>Tabelle 32.4— Datensatz mit mehreren Outcomes zu Flöhen auf verschiedenen Tierarten.</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 16%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 20%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">weight</th>
<th style="text-align: center;">jump_length</th>
<th style="text-align: center;">flea_count</th>
<th style="text-align: center;">hatch_time</th>
<th style="text-align: center;">log_hatch_time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">6.02</td>
<td style="text-align: center;">15.79</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">483.6</td>
<td style="text-align: center;">6.18</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">5.99</td>
<td style="text-align: center;">18.33</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">82.56</td>
<td style="text-align: center;">4.41</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">8.05</td>
<td style="text-align: center;">17.58</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">296.73</td>
<td style="text-align: center;">5.69</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">6.71</td>
<td style="text-align: center;">14.09</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">140.9</td>
<td style="text-align: center;">4.95</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">6.19</td>
<td style="text-align: center;">18.22</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">162.2</td>
<td style="text-align: center;">5.09</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">8.18</td>
<td style="text-align: center;">13.49</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">167.47</td>
<td style="text-align: center;">5.12</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">8.04</td>
<td style="text-align: center;">27.81</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">424.46</td>
<td style="text-align: center;">6.05</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">9.03</td>
<td style="text-align: center;">24.02</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">349.48</td>
<td style="text-align: center;">5.86</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">7.42</td>
<td style="text-align: center;">24.53</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">151.43</td>
<td style="text-align: center;">5.02</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">9.26</td>
<td style="text-align: center;">24.35</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">182.68</td>
<td style="text-align: center;">5.21</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">8.85</td>
<td style="text-align: center;">24.36</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">104.89</td>
<td style="text-align: center;">4.65</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">7.89</td>
<td style="text-align: center;">22.13</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">62.99</td>
<td style="text-align: center;">4.14</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><a href="#fig-stat-modeling-mult-01-1">Abbildung&nbsp;<span>32.4 (a)</span></a></p>
<p><a href="#fig-stat-modeling-mult-01-2">Abbildung&nbsp;<span>32.4 (b)</span></a></p>
<p><a href="#fig-stat-modeling-mult-01-3">Abbildung&nbsp;<span>32.4 (c)</span></a></p>
<div id="fig-stat-modeling-mult-01" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-stat-modeling-mult-01-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-mult-01-1.png" class="img-fluid figure-img" data-ref-parent="fig-stat-modeling-mult-01" width="480"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">(a) jump_length ~ weight</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-stat-modeling-mult-01-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-mult-01-2.png" class="img-fluid figure-img" data-ref-parent="fig-stat-modeling-mult-01" width="480"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">(b) jump_length ~ weight + animal</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-stat-modeling-mult-01-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-mult-01-3.png" class="img-fluid figure-img" data-ref-parent="fig-stat-modeling-mult-01" width="480"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">(c) jump_length ~ weight + animal + sex</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption aria-hidden="true" class="figure-caption">Abbildung 32.4— Darstellung des <em>counfounder</em> Effekts anhand des Zusammenhangs der Sprungweite in [cm] und dem Gewicht von Flöhen [mg].</figcaption><p></p>
</figure>
</div>
</section><section id="variance-inflation-factor-vif" class="level2" data-number="32.5"><h2 data-number="32.5" class="anchored" data-anchor-id="variance-inflation-factor-vif">
<span class="header-section-number">32.5</span> Variance inflation factor (VIF)</h2>
<p>VIF kann nicht für kategoriale Daten verwendet werden. Statistisch gesehen würde es keinen Sinn machen.</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">disp</span> <span class="op">+</span> <span class="va">hp</span> <span class="op">+</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">drat</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">jump_length</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">weight</span>, data <span class="op">=</span> <span class="va">model_tbl</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">vif</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      sex    weight 
2.1161355 2.1161355 </code></pre>
</div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">check_model</span><span class="op">(</span><span class="va">model</span>, check <span class="op">=</span> <span class="st">"vif"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="stat-modeling-basic_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="vergleich-von-modellen" class="level2" data-number="32.6"><h2 data-number="32.6" class="anchored" data-anchor-id="vergleich-von-modellen">
<span class="header-section-number">32.6</span> Vergleich von Modellen</h2>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">jump_length</span> <span class="op">~</span> <span class="va">animal</span>, data <span class="op">=</span> <span class="va">model_tbl</span><span class="op">)</span></span>
<span><span class="va">fit_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">jump_length</span> <span class="op">~</span> <span class="va">animal</span> <span class="op">+</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">model_tbl</span><span class="op">)</span></span>
<span><span class="va">fit_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">jump_length</span> <span class="op">~</span> <span class="va">animal</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">weight</span>, data <span class="op">=</span> <span class="va">model_tbl</span><span class="op">)</span></span>
<span><span class="va">fit_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">jump_length</span> <span class="op">~</span> <span class="va">animal</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">sex</span><span class="op">:</span><span class="va">weight</span> <span class="op">+</span> <span class="va">animal</span><span class="op">:</span><span class="va">weight</span>, data <span class="op">=</span> <span class="va">model_tbl</span><span class="op">)</span></span>
<span><span class="va">fit_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">jump_length</span><span class="op">)</span> <span class="op">~</span> <span class="va">animal</span> <span class="op">+</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">model_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Akaike information criterion (AIC)</p>
<p>Bayesian information criterion (BIC)</p>
<p><span class="math display">\[
\Delta_i = AIC_i - AIC_{min}
\]</span></p>
<ul>
<li>wenn <span class="math inline">\(\Delta_i &lt; 2\)</span>, dann gibt es eine deutliche Unterstützung für das <span class="math inline">\(i\)</span>-te Modell;;</li>
<li>wenn <span class="math inline">\(2 &lt; \Delta_i &lt; 4\)</span>, dann gibt es eine starke Unterstützung für das <span class="math inline">\(i\)</span>-te Modell;</li>
<li>wenn <span class="math inline">\(4 &lt; \Delta_i &lt; 7\)</span>, dann gibt es deutlich weniger Unterstützung für das <span class="math inline">\(i\)</span>-te Modell;</li>
<li>Modelle mit <span class="math inline">\(\Delta_i &gt; 10\)</span> haben im Wesentlichen keine Unterstützung.</li>
</ul>
<p><span class="math inline">\(AIC_1 = AIC_{min} = 100\)</span> und <span class="math inline">\(AIC_2\)</span> ist <span class="math inline">\(100,7\)</span>. Dann ist <span class="math inline">\(\Delta_2=0,7&lt;2\)</span>, so dass es keinen wesentlichen Unterschied zwischen den Modellen gibt. <span class="math inline">\(AIC_1 = AIC_{min} = 100000\)</span> und <span class="math inline">\(AIC_2\)</span> ist <span class="math inline">\(100700\)</span>. Dann ist <span class="math inline">\(\Delta_2 = 700 \gg 10\)</span>, also gibt es keine Unterstützung für das <span class="math inline">\(2\)</span>-te Modell.</p>
<p>Je kleiner das AIC ist, desto besser ist das AIC.</p>
<p>Je kleiner das BIC ist, desto besser ist das BIC.</p>
<p><span class="math display">\[
p_i = \exp\left(\cfrac{-\Delta_i}{2}\right)
\]</span></p>
<p>Das <span class="math inline">\(p_i\)</span> ist die relative (im Vergleich zu <span class="math inline">\(AIC_{min}\)</span>) Wahrscheinlichkeit, dass das <span class="math inline">\(i\)</span>-te Modell den AIC minimiert. Zum Beispiel entspricht <span class="math inline">\(\Delta_i = 1.5\)</span> einem <span class="math inline">\(p_i\)</span> von <span class="math inline">\(0.47\)</span> (ziemlich hoch) und ein <span class="math inline">\(\Delta_ = 15\)</span> entspricht einem <span class="math inline">\(p_i =0.0005\)</span> (ziemlich niedrig). Im ersten Fall besteht eine Wahrscheinlichkeit von 47%, dass das <span class="math inline">\(i\)</span>-te Modell tatsächlich eine bessere Beschreibung ist als das Modell, das <span class="math inline">\(AIC_{min}\)</span> ergibt, und im zweiten Fall beträgt diese Wahrscheinlichkeit nur 0,05%.</p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">model_performance</span><span class="op">(</span><span class="va">fit_1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">AIC</span>, <span class="va">BIC</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">round</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
    AIC   BIC
  &lt;dbl&gt; &lt;dbl&gt;
1 3076. 3093.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">comp_res</span> <span class="op">&lt;-</span> <span class="fu">compare_performance</span><span class="op">(</span><span class="va">fit_1</span>, <span class="va">fit_2</span>, <span class="va">fit_3</span>, <span class="va">fit_4</span>, <span class="va">fit_5</span>, rank <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comp_res</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name  | Model |    R2 | R2 (adj.) |  RMSE | Sigma | AIC weights | BIC weights | Performance-Score
-------------------------------------------------------------------------------------------------
fit_2 |    lm | 0.739 |     0.738 | 1.926 | 1.933 |       0.717 |       0.961 |            79.80%
fit_5 |    lm | 0.731 |     0.729 | 0.099 | 0.099 |    2.88e-09 |    3.85e-09 |            66.01%
fit_3 |    lm | 0.739 |     0.737 | 1.926 | 1.935 |       0.265 |       0.039 |            53.28%
fit_4 |    lm | 0.739 |     0.736 | 1.925 | 1.938 |       0.018 |    3.66e-06 |            46.82%
fit_1 |    lm | 0.316 |     0.314 | 3.118 | 3.126 |   6.04e-126 |   7.29e-125 |             0.00%</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">comp_res</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="stat-modeling-basic_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">test_vuong</span><span class="op">(</span><span class="va">fit_1</span>, <span class="va">fit_2</span>, <span class="va">fit_3</span>, <span class="va">fit_4</span>, <span class="va">fit_5</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Name  | Model | Omega2 | p (Omega2) |      LR | p (LR)
------------------------------------------------------
fit_1 |    lm |        |            |         |       
fit_2 |    lm |   0.41 |     &lt; .001 |  -18.46 | &lt; .001
fit_3 |    lm |   0.41 |     &lt; .001 |  -18.45 | &lt; .001
fit_4 |    lm |   0.41 |     &lt; .001 |  -18.46 | &lt; .001
fit_5 |    lm |   0.47 |     &lt; .001 | -123.94 | &lt; .001
Each model is compared to fit_1.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#pacman::p_load(report)</span></span>
<span></span>
<span><span class="co">#report(fit_1)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>War die Transformation sinnvoll?</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">hatch_time</span> <span class="op">~</span> <span class="va">animal</span> <span class="op">+</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">model_tbl</span><span class="op">)</span></span>
<span><span class="va">fit_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">log_hatch_time</span> <span class="op">~</span> <span class="va">animal</span> <span class="op">+</span> <span class="va">sex</span>, data <span class="op">=</span> <span class="va">model_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">comp_res</span> <span class="op">&lt;-</span> <span class="fu">compare_performance</span><span class="op">(</span><span class="va">fit_1</span>, <span class="va">fit_2</span>, rank <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: When comparing models, please note that probably not all models were fit
  from same data.</code></pre>
</div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">comp_res</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name  | Model |    R2 | R2 (adj.) |    RMSE |   Sigma | AIC weights | BIC weights | Performance-Score
-----------------------------------------------------------------------------------------------------
fit_2 |    lm | 0.006 |     0.001 |   0.992 |   0.995 |        1.00 |        1.00 |            66.67%
fit_1 |    lm | 0.008 |     0.003 | 789.441 | 792.086 |    0.00e+00 |    0.00e+00 |            33.33%</code></pre>
</div>
</div>
</section><section id="generalisierung-von-lm-zu-glm-und-glmer" class="level2" data-number="32.7"><h2 data-number="32.7" class="anchored" data-anchor-id="generalisierung-von-lm-zu-glm-und-glmer">
<span class="header-section-number">32.7</span> Generalisierung von <code>lm()</code> zu <code>glm()</code> und <code>[g]lmer()</code>
</h2>
<ul>
<li>Die Funktion <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> nutzen wir, wenn das Outcome <span class="math inline">\(y\)</span> einer Normalverteilung folgt.</li>
<li>Die Funktion <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> nutzen wir, wenn das Outcome <span class="math inline">\(y\)</span> einer <em>andere</em> Verteilung folgt.</li>
<li>Die Funktion <code>lmer()</code> nutzen wir, wenn das Outcome <span class="math inline">\(y\)</span> einer Normalverteilung folgt <em>und</em> wir noch einen Block- oder Clusterfaktor vorliegen haben.</li>
<li>Die Funktion <code>glmer()</code> nutzen wir, wenn das Outcome <span class="math inline">\(y\)</span> einer <em>andere</em> Verteilung folgt <em>und</em> wir noch einen Block- oder Clusterfaktor vorliegen haben.</li>
</ul></section><section id="referenzen" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-kery2010introduction" class="csl-entry" role="doc-biblioentry">
Kéry, Marc. 2010. <em>Introduction to WinBUGS for ecologists: Bayesian approach to regression, ANOVA, mixed models and related analyses</em>. Academic Press.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./stat-modeling-preface.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Statistisches Modellieren</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-modeling-outlier.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Ausreißer</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>
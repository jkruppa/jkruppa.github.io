# Verteilung von Daten

```{r}
#| warning: false
#| echo: false
pacman::p_load(tidyverse, readxl, knitr, kableExtra, see)
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
```

![](images/caution.png){fig-align="center" width="50%"}

## Genutzte R Pakete für das Kapitel

Wir wollen folgende R Pakete in diesem Kapitel nutzen.

```{r echo = TRUE}
pacman::p_load(tidyverse, magrittr, see, readxl)
```

Am Ende des Kapitels findest du nochmal den gesamten R Code in einem Rutsch zum selber durchführen oder aber kopieren.

## Daten

Wir wollen uns nun erstmal den einfachsten Fall anschauen mit einem simplen Datensatz. Wir nehmen ein normalverteiltes $y$ aus den Datensatz `flea_dog_cat_fox.csv` und einen Faktor mit mehr als zwei Leveln. Hätten wir nur zwei Level, dann können wir auch einen t-Test rechnen können.

Im Folgenden selektieren mit der Funktion `select()` die beiden Spalten `jump_length` als $y$ und die Spalte `animal` als $x$. Danach müssen wir noch die Variable `animal` in einen Faktor mit der Funktion `as_factor()` umwandeln.

```{r}
#| message: false

gummi_tbl <- read_excel("data/gummibears.xlsx")  %>%
  select(gender, height, count_bears, count_color) %>% 
  na.omit() %>% 
  mutate(gender = as_factor(gender))
```

## Normalverteilung {#sec-normal}

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-align: center
#| fig-height: 5
#| fig-width: 5
#| label: fig-normal-01
#| fig-cap: "Histogramm der Körpergröße in [cm] für beide Geschlechter getrennt."

ggplot(data = gummi_tbl, aes(x = height, fill = gender)) +
  theme_bw() +
  geom_histogram(position = "dodge", color = "black") +
  labs(x = "", y = "Anzahl") +
  ##theme(legend.position = "none") +
  scale_fill_okabeito() 

```

@dormann2013parametrische

$\mathcal{N}(\bar{y}, s^2_y)$

$\mathcal{N}(0, 1)$

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-align: center
#| fig-height: 5
#| fig-width: 5
#| label: fig-normal-same-sd
#| fig-cap: "An 39 Hunden wurde die Anzahl an Flöhen gezählt."

set.seed(20220789)
norm_tbl <- tibble(n1 = rnorm(10000, 10, 2),
                   n2 = rnorm(10000, 20, 2),
                   n3 = rnorm(10000, 0, 2)) %>% 
  gather()

ggplot(data = norm_tbl, aes(x = value, fill = key)) +
  theme_bw() +
  geom_histogram(position = position_identity(), alpha = 0.75, color = "black") +
  labs(x = "", y = "Anzahl") +
  xlim(-15, 30) +
  theme(legend.position = "none") +
  scale_fill_okabeito() +
  annotate("text", 0, 3200, label = expression(paste("N(0,2)")),
           color = cbbPalette[4]) +
  annotate("text", 10, 3200, label = expression(paste("N(10,2)")),
           color = cbbPalette[2]) +
  annotate("text", 20, 3200, label = expression(paste("N(20,2)")),
           color = cbbPalette[3]) 
```

@fig-normal-same-sd

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-align: center
#| fig-height: 5
#| fig-width: 5
#| label: fig-normal-mu-sd-different
#| fig-cap: "An 39 Hunden wurde die Anzahl an Flöhen gezählt."

set.seed(20220789)
norm_tbl <- tibble(n1 = rnorm(10000, 10, 1),
                   n2 = rnorm(10000, 20, 3),
                   n3 = rnorm(10000, 0, 6)) %>% 
  gather()

ggplot(data = norm_tbl, aes(x = value, fill = key)) +
  theme_bw() +
  geom_histogram(binwidth = 1, position = position_identity(), alpha = 0.75, color = "black") +
  labs(x = "", y = "Anzahl") +
  xlim(-15, 30) +
  theme(legend.position = "none") +
  scale_fill_okabeito() +
  annotate("text", 0, 900, label = expression(paste("N(0,6)")),
           color = cbbPalette[4]) +
  annotate("text", 10, 4100, label = expression(paste("N(10,1)")),
           color = cbbPalette[2]) +
  annotate("text", 20, 1500, label = expression(paste("N(20,3)")),
           color = cbbPalette[3]) 
```

@fig-normal-mu-sd-different

### Homogenität und Heterogenität der Varianzen

Eine Varianzhomogenität liegt vor, wenn die Varianzen der Gruppen gleich sind.

$$
s^2_{dog} = s^2_{cat} = s^2_{fox}
$$

Eine Varianzheterogenität liegt vor, wenn die Varianzen der Gruppen ungleich sind.

$$
s^2_{dog} \neq s^2_{cat} \neq s^2_{fox}
$$

```{r}
rnorm(n = 10, mean = 5, sd = 2) %>% round(2)
```

## Poissonverteilung {#sec-poisson}

$\mathcal{Pois}(\lambda)$

$\mathcal{Pois}(4)$

```{r}
#| message: false
#| echo: false
#| label: fig-pois-01
#| fig-align: center
#| fig-height: 5
#| fig-width: 5
#| fig-cap: "Histogramm der Anzahl an Gummibärchen und die Anzahl an Farben in einer Tüte. Es gibt nicht mehr als sechs Farben."
#| fig-subcap: 
#|   - "Anzahl an Bärchen"
#|   - "Anzahl an Farben"
#| layout-nrow: 1
#| column: page

ggplot(data = gummi_tbl, aes(x = count_bears)) +
  theme_bw() +
  geom_bar(position = "dodge", color = "black", fill = cbbPalette[2]) +
  labs(x = "", y = "Anzahl") 

ggplot(data = gummi_tbl, aes(x = count_color)) +
  theme_bw() +
  geom_bar(position = "dodge", color = "black", fill = cbbPalette[3]) +
  labs(x = "", y = "Anzahl") 


```

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-align: center
#| fig-height: 5
#| fig-width: 5
#| fig-cap: "An 39 Hunden wurde die Anzahl an Flöhen gezählt."

set.seed(20220789)
pois_tbl <- tibble(lambda1 = rpois(1000, 6),
              lambda2 = rpois(1000, 10),
              lambda3 = rpois(1000, 1)) %>% 
  gather()

ggplot(data = pois_tbl, aes(x = value, fill = key)) +
  theme_bw() +
  geom_histogram(binwidth = 1, position = position_dodge(0.95), color = "black") +
  labs(x = "", y = "Anzahl") +
  theme(legend.position = "none") +
  scale_x_continuous(breaks = 0:25, limits = c(0,NA)) +
  scale_fill_okabeito() +
  annotate("text", 3, 250, label = expression(paste("Pois(", lambda, " = 1)")),
           color = cbbPalette[4]) +
  annotate("text", 6, 180, label = expression(paste("Pois(", lambda, " = 6)")),
           color = cbbPalette[2]) +
  annotate("text", 10, 150, label = expression(paste("Pois(", lambda, " = 10)")),
           color = cbbPalette[3]) 
```

@sec-poisson

```{r}
rpois(n = 10, lambda = 5)
```

## Weitere Verteilungen

![](images/caution.png){fig-align="center" width="50%"}

In der nächsten Zeit werden noch weitere gängige Verteilungen ergänzt. Bis dahin können die [Basic Probability Distributions in R](https://rstudio-pubs-static.s3.amazonaws.com/100906_8e3a32dd11c14b839468db756cee7400.html) nochmal extern nachgeschaut werden.

## Referenzen {.unnumbered}

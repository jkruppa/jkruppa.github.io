```{r echo = FALSE}
pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc)
```

# Deskriptive Statistik {#sec-desc-stat}

*Letzte Änderung am `r format(fs::file_info("eda-descriptive.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*

> *"Alles was überhaupt gedacht werden kann, kann klar gedacht werden. Alles was sich aussprechen lässt, lässt sich klar aussprechen." --- Ludwig Wittgenstein, Satz 4.116*

Wir nutzen die deskriptive Statistik um Zahlen zusammenzufassen. Zahlen, die wir an Individuen oder Beobachtungen erhoben haben. Diese Zahlen fassen wir dann in einem Datensatz zusammen. Das heißt wir haben am Ende einen Datensatz vorliegen. Wir nehmen hier als Beispiel den Datensatz zu den Sprungweiten der Hundeflöhe. Wir wollen jetzt den Datensatz in wenigen Zahlen zusammenfassen (eng. *summarize*). Warum wenige Zahlen? Wenn wir das Ergebnis präsentieren wollen, dann müssen es wenige Zahlen sein, die den Datensatz gut zusammenfassen. Daher ist es wichtig zu verstehen, dass wir dutzende bis hunderte Zahlen aus einem Datensatz durch meist eine oder zwei statistische Maßzahlen beschreiben wollen. Wir brauchen die statistischen Maßzahlen später um teilweise noch extrem größere Datensätze darstellen zu können. Ebenso werden wir die Maßzahlen aus diesem Kapitel dafür verwenden statistische Tests und Modelle zu rechnen.

```{r }
#| echo: false
#| warning: false

data_tbl <- read_excel("data/flea_dog_cat.xlsx")
y_dog <- data_tbl %>% 
  filter(animal == "dog") %>% 
  pull(jump_length)
```

Nehmen wir nun als Beispiel die Sprungweiten in \[cm\] von Hundeflöhen. Wir messen die Sprungweiten von sieben Hundeflöhen und erhalten dabei folgende Werte in \[cm\]: `r pander::p(y_dog, wrap = "", copula = " und ")`. Wir schreiben diese Sprungweiten nun als $y$ in einen Vektor in der folgenden Form auf.

$$
y = \{`r str_c(y_dog, collapse = ", ")`\}.
$$

[Du findest in @sec-basics den Einstieg für die Programmierung in R. Da findest du auch die Erklärung für `c()` und den Zuweisungspfeil `<-`.]{.aside}

In R würde der Vektor der Zahlen etwas anders aussehen, aber das hat eher was mit der Schreibweise der Mathematik und der Informatik zu tun. Inhaltlich sehen wir hier gleichen Informationen.

```{r }
y <- c(5.7, 8.9, 11.8, 8.2, 5.6, 9.1, 7.6) 
```

Wir wollen nun die Sprungweiten in $y$ beschrieben und durch wenige andere Zahlen zusammenfassen. Einige dieser statistischen Maßzahlen sind dir vermutlich schon bekannt, andere eher neu. Wir gehen jetzt also gemeinsam eine Menge an statistischen Maßzahlen durch. Nicht alle wirst du immer brauchen und dir auch nicht merken müssen. Wichtig ist zu wissen, dass es die folgenden statistischen Maßzahlen gibt und das du dann im Zweifel den Begriff nachschlagen kannst. Ich mache das im Prinzip auch nicht anders.

::: callout-note
## Warum $y$ und nicht $x$?

Wenn du dir andere Statistikbücher anschaust, dann wird meist die Variable, mit der wir den Mittelwert berechnen, mit $x$ bezeichnet. Wir machen das hier *nicht* denn wir haben später für das $x$ eine andere Verwendung. In einem statistischen Modell schauen wir uns den Zusammenhang von $y \sim x$ an. Die Sprungweite von Hundeflöhen ist das $y$ und nicht das $x$. Glaube mir, es wird nachher leichter zu verstehen. Dafür nehmen wir jetzt einen etwas schwierigen Weg.
:::

## Arithmetisches Mittel oder einfach Mittelwert

Der Mittelwert einer Zahlenreihe beschreibt den Schwerpunkt der Zahlen. Was soll das Bedeuten? Was ist der Schwerpunkt von Zahlen? Du kannst dir das wie eine Wippe vorstellen, der Mittelwert liegt so, dass links und rechts des Mittelwerts gleiche Abstände zu den Zahlen vorliegen. Der Mittelwert wird auch als Lageparameter benannt. Der *Mittelwert* ist damit auch der Lageparameter einer Verteilung. Er beschreibet die numerische Stelle, wo die Verteilungskurve am höchsten ist. Wir schreiben den Mittelwert mit einem Strich über den Vektor, der die Zahlen enthält. Im Folgenden ist die Formel für den Mittelwert der Sprungweite in \[cm\] der Hunde gezeigt. Der Mittelwert ist in dem Sinne eine künstliche Zahl, da der Mittelwert häufig nicht in den beobachteten Zahlen vorkommt.

::: column-margin
![](images/angel_01.png){fig-align="center" width="50%"}

Wir werden immer mal wieder *Formeln vereinfachen*. Zum Beispiel nur $\sum$ schreiben anstatt $\sum_i^n$, wenn wir einen Vektor aufsummieren und uns die Indizes sparen. Ja, das ist nicht schön, aber einfacher.
:::

$$
\bar{y} = \sum_{i=1}^{n}\cfrac{x_i}{n} =
\cfrac{`r str_c(y, collapse = " + ")`}{`r length(y)`} =
`r round(mean(y),2)`
$$

Wir sagen also, dass im Durchschnitt oder im Mittel die Hundeflöhe `r round(mean(y),2)` cm weit springen. In der @fig-index-drawn wollen wir die Formel nochmal visualisieren. Vielleicht fällt dir dann der Zusammenhang von dem Index $i$ und der gesamten Fallzahl $n$ leichter.

![Zusammenhang zwischen $y$ sowie dem Index $i$ in der Formel für den Mittelwert.](images/index-drawn.png){#fig-index-drawn fig-align="center" width="80%"}

In R können wir den Mittelwert einfach mit der Funktion `mean()` berechnen.

[Du findest in @sec-basics den Einstieg für die Programmierung in R. Da findest du auch die Erklärung für den Pipe Operator `%>%`.]{.aside}

```{r }
## ohne pipe-Operator
mean(y)
```

Dann nutzen wir nochmal den Pipe Operator `%>%` für die Berechnung des Mittelwertes. Wir wollen dann den Mittelwert noch auf die zweite Kommastelle runden. Das machen wir dann mit der Funktion `round()`.

```{r }
## mit pipe-Operator
y %>% mean %>% round(2)
```

Wir erhalten das gleiche Ergebnis wie oben in unserer händischen Rechnung. Die Hundeflöhe springen im Mittel `r round(mean(y),2)` cm weit. Ja, für so einfache Beispiele ist es ntürlich etwas kompliziert R zu nutzen und Code zu schreiben, später wird uns der Code aber sehr helfen.

Der Mittelwert ist eine bedeutende statistische Maßzahl der Normalverteilung. Später wirst du noch mehr über Verteilungen von Zahlen erfahren und deshalb hier schon mal die kurze Verbindung vom Mittelwert zur Normalverteilung. Daher merken wir uns hier schon mal, dass wir den Mittelwert brauchen werden. Auch wenn wir darüber nachdenken ob sich zwei Gruppen unterscheiden, so nutzen wir hierzu den Mittelwert. Unterscheiden sich die *mittleren* Sprungweiten in \[cm\] von Hunde- und Katzenflöhen?

## Geometrisches Mittel {#sec-desc-stat-geometric}

Im Gegensatz zum arithmetischen Mittel ist das geometrische Mittel nur für nicht negative Zahlen $y$ definiert. Wir können also für negative Zahlen kein geometrische Mittel berechnen. Das geometrische Mittel ist daher nur für echt positive Zahlen sinnvoll. Wenn eine der Zahlen in $y$ gleich Null ist, ist schon das ganze Produkt der Zahlen gleich Null. Somit ist dann das geometrische Mittel sinnlos. Schauen wir uns einmal die Formel des geometrischen Mittels an.

$$
\bar{y}_\mathrm{geom} = \sqrt[n]{\prod_{i=1}^n{y_i}} = \sqrt[n]{y_1 \cdot y_2 \dotsm y_n} = (y_1 \cdot y_2 \dotsm y_n)^{1/n}
$$

Dann rechnen wir doch auch gleich mal ein Beispiel mit den vier Zahlen $y = \{4, 3, 6, 9\}$.

$$
\bar{y}_\mathrm{geom} =  \sqrt[4]{4 \cdot 3 \cdot 6 \cdot 9} =\sqrt[4]{648} = 5.045
$$

Um die Besonderheit des geometrische Mittelwerts zum arithmetischen Mittel zu verstehen, nehmen wir einmal ein Beispiel mit nur den Zahlen $y = \{1,9\}$. Bei der geometrischen Mittelwertbildung weichen beide Werte vom Mittelwert um denselben Multiplikator ab. Diese Eigenschaft ist beim arithmetischen Mittel nicht gegeben. So ergibt sich aus den Zahlen 1 und 9 das arithmetische Mittel 5. Dabei ist die 1 vom Mittelwert 5 um Faktor 5 entfernt, während die 9 lediglich um Faktor 1.8 davon entfernt liegt.

Das geometrische Mittel aus 1 und 9 hingegen ergibt den Mittelwert $\bar{y}_\mathrm{geom} = 3$. Sowohl der niedrige Wert 1 wie auch der hohe Wert 9 sind vom Mittelwert 3 um den Faktor 3 entfernt. Der Unterschied zwischen arithmetischem und geometrischem Mittelwert kann beträchtlich sein, was in der Praxis unter Umständen zur Fehlinterpretation von Durchschnittsangaben führt.

In R können wir das geometrische Mittel einfach mit der Funktion `geometric.mean()` aus dem R Paket `psych` berechnen.

```{r}
c(4, 3, 6, 9) %>% 
  psych::geometric.mean()
```

Das geometrische Mittel ist der einzige korrekte Mittelwert, wenn normalisierte Ergebnisse gemittelt werden, daher Zahlen und Ergebnisse, die als Verhältnis zu Referenzwerten dargestellt werden. Eine Anwendung ist hierbei der [Wirkungsgrad](#sec-effect-wirkung) von zum Beispiel Pflanzenschutzmitteln.

## Spannweite

Die Spannweite erlaubt uns zu überprüfen was die kleinste Zahl und die größte Zahl ist. Also uns das Minimum und das Maximum einer Zahlenreihe anzuschauen. Auf den ersten Blick mag das nicht so sinnig sein, aber wenn wir uns hunderte von Beobachtungen anschauen, wollen wir wissen, ob wir nicht einen Fehler bei Eintragen der Daten gemacht haben. Wir wissen eigentlich, dass z.B keine negativen Zuwachsraten auftreten können.

$$
y_{range} = y_{max} - y_{min} = 12.1 - 4.9 = 7.2
$$

Die Hundeflöhe springen in einer Spannweite von 7.2 cm. Das kommt einem normal vor und wir würden meinen, dass Flöhe in diesem Bereich springen könnten. Die Spannweite ist nicht übertrieben groß. Der minimale Wert ist $4.9cm$ und der maximale Wert ist $12.1cm$ und somit sind beide Zahlen in Ordnung. Keine der beiden Zahlen ist übertrieben klein oder gar negativ. Später musst du dann selber schauen, ob die Zahlen in die biologische Fragestellung passen. Besonders wenn du Datenbanken ausliest, kann es schnell passieren, dass du unplausible Werte wiederfindest. Dann musst du diese Werte meist entfernen.

In R können wir die Spannweite mit `range()` wie folgt berechnen. Wir erhalten den minimalen und maximalen Wert.

```{r }
## ohne pipe-Operator
range(y) 

## mit pipe-Operator
y %>% range()
```

Wir merken uns, dass die Spannweite eine Maßzahl für die Validität der Daten ist. Hat das Experiment geklappt oder kamen da nur komische Zahlen bei raus, die wir so in der Realität nicht erwarten würden. Zum Beispiel negative Sprungweiten, weil wir einmal auf das Minuszeichen auf der Tastatur beim eingeben der Zahlen gekommen sind.

## Varianz

Bis jetzt können wir mit dem Mittelwert $\bar{y}$ die Lage oder den Mittelpunkt unserer Zahlenreihe $y$ beschreiben. Uns fehlt damit aber die Information über die Streuung der Zahlen. Sind die Zahlen alle eher gleich oder sehr verschieden? Liegen die Zahlen daher alle bei dem Mittelwert oder sind die Zahlen weit um den Mittelwert gestreut. Es macht ja einen bedeutenden Unterschied, ob wir $n$-mal das "Gleiche" messen oder eben $n$-mal sehr unterschiedliche Zahlen.

::: callout-tip
## Die Abweichungsquadrate in der Statistik

Abweichungsquadrate sind ein wichtiges Konzept in der Statistik. Wenn wir wissen wollen, wie groß eine Abweichung von einer Zahl zu einer anderen ist, dann nutzen wir immer das Quadrat der Abweichung und bilden die Quadratsumme.
:::

Die Streuung der Zahlen $y$ um den Mittelwert beschreibt die Varianz. Wir schreiben für die Varianz auch $s^2$. Wir berechnen die Varianz indem wir von jeder Zahl $i$ den Mittelwert aller Zahlen $\bar{y}$ abziehen und dann das Ergebnis quadrieren. Das machen wir für alle Zahlen und addieren dann die Summe auf. Wir erhalten die Quadratsumme von $y$. Wie immer ist Mathematik in Textform etwas sperrig, deshlab einmal auch hier die Formel.

$$
s^2 = \sum_{i=1}^n\cfrac{(y_i - \bar{y})^2}{n-1} = \cfrac{(5.7 -
8.13)^2 + ... + (7.6 - 8.13)^2}{7-1} = 4.6
$$

Die Varianz beschreibt also die Streuung der Zahlen *im Quadrat* um den Mittelwert. Das heißt in unserem Beispiel, dass die Sprungweite eine Varianz von $4.6cm^2$ hat. Wir können Quadratzentimeter schlecht biologisch interpretieren. Wir leben nicht in einer Welt mit quadratischen Einheiten. Deshalb führen wir gleich die Wurzel der Varianz als die Standardabweichung ein. Die Standardabweichung ist also einfach die Wurzel der Varianz. Da die Standardabweichung aber sehr bedeutend ist, kommen wir auf die Standardabweichung gleich nochmal in einem extra Abschnitt zu sprechen.

In R lässt sich die Varianz einfach durch die Funktion `var()` berechnen.

```{r }
## ohne pipe-Operator
var(y)

## mit pipe-Operator
y %>% var %>% round(2) 
```

Wir benötigen die Varianz häufig nur als Zwischenschritt um die Standardabweichung zu berechnen. Das Konzept der Abweichungsquadrate benötigen wir aber in der [Varianzanalyse (ANOVA)](#sec-anova) und für die Beschreibung einer Normalverteilung zusätzlich zum Mittelwert.

## Standardabweichung

Die Standardabweichung $s$ ist die Wurzel der Varianz $s^2$. Wo die Varianz die Abweichung der Sprungweite in \[cm$^2$\] beschreibt, beschreibt die Standardabweichung die Streuung der Sprungweite in \[cm\]. Damit können wir dann die Standardabweichung viel besser interpretieren als die Varianz.

$$
s = \sqrt{s^2} = \sqrt{4.6} = 2.14
$$

Wir können also schreiben, dass die Flöhe im Mittel 8.13 $\pm$ 2.14cm weit springen. Somit haben wir die Lage und die Streuung der Zahlenreihe $y$ der Sprungweite in \[cm\] mit zwei Zahlen beschrieben. Wichtig ist hierbei zu merken, dass wir den Abstand vom Mittelwert nach "oben" und "unten" jeweils mit dem gleichen Abstand beschreiben. Unsere Zahlen können also nicht mehr in die eine als in die andere Richtung streuen.

In R können wir die Standardabweichung einfach mit der Funktion `sd()` berechnen.

```{r }
## ohne pipe-Operator
sd(y)

## mit pipe-Operator
y %>% sd %>% round(2) 
```

Merke dir hier nochmal, dass du die Varianz nur als Zwischenschritt für die Standardabweichung berechnest. Später interessiert dich die Standardabweichung, die du dann auch in deinen Berichten oder deiner Abschlussarbeit nutzt.

::: callout-tip
## Schreibweise des Mittelwerts und der Standardabweichung

Wir schreiben immer den Mittelwert plusminus die Standardabweichung. Also immer in der Form $\bar{y} \pm s$. Meistens willst du dann aber nicht eine Tabelle haben, sondern wir nutzen dann den Mittelwert plusminus die Standardabweichung um uns [Säulendiagramme zu erstellen](@sec-eda-barplot).
:::

## Mittelwert und Varianz - eine Herleitung

Was ist der Mittelwert und die Varianz genau? Schauen wir uns das einmal in @fig-mean-drawn an. Die graue Linie oder Grade beschreibt den Mittelwert der fünf Beobachtungen. Die fünf Beobachtungen sind als blaue Kreuze dargestellt. Auf der $x$-Achse ist nur der Index $i$ der Beobachtung. Das heißt $y_1$ ist die erste Beobachtung und somit ist der Index $i$ gleich 1. In der Form stellen wir dann alle Beobachtungen in der Abbildung dar. Die eigentlichen Zahlenwerte sind dann auf der $y$-Achse.

![Die graue Linie beschreibt den Mittelwert der genau so durch die blauen Punkte geht, dass die Abstände der Punkte oberhalb und unterhalb zu Null aufaddieren. Die Linie liegt in der Mitte der Punkte. Die quadrierten Abstände sind die Varianz der blauen Punkte. Auf der x-Achse ist der Index des Punktes eingetragen.](images/mean-drawn.png){#fig-mean-drawn fig-align="center" width="100%"}

Wenn wir die Summe der Abweichungen von $y_1$ bis $y_5$ zu dem Mittelwert bilden, so wird diese Summe 0 sein. Der Mittelwert liegt genau in der Mitte der Punkte. In unserem Beispiel ist der Mittelwert $\bar{y} = 5.8$. Wir können jetzt die Abstände wie in der folgenden @tbl-y-mean-variance berechnen.

| Index $i$ |  y   | $\boldsymbol{\epsilon_i = y_i - \bar{y}}$ |         Wert         |
|:---------:|:----:|:-----------------------------------------:|:--------------------:|
|     1     | 5.7  |       $\epsilon_1 = y_1 - \bar{y}$        | $5.7 - 8.13 = -2.43$ |
|     2     | 8.9  |       $\epsilon_2 = y_2 - \bar{y}$        | $8.9 - 8.13 = 0.77$  |
|     3     | 11.8 |       $\epsilon_3 = y_3 - \bar{y}$        | $11.8 - 8.13 = 3.67$ |
|     4     | 8.2  |       $\epsilon_4 = y_4 - \bar{y}$        | $8.2 - 8.13 = 0.07$  |
|     5     | 5.6  |       $\epsilon_5 = y_5 - \bar{y}$        | $5.6 - 8.13 = -2.53$ |
|     6     | 9.1  |       $\epsilon_6 = y_4 - \bar{y}$        | $9.1 - 8.13 = 0.97$  |
|     7     | 7.6  |       $\epsilon_7 = y_5 - \bar{y}$        | $7.6 - 8.13 = -0.53$ |

: Zusammenhang von den Werten von $y$, dem Mittelwert sowie die Abweichung vom Mittelwert $\epsilon${#tbl-y-mean-variance}

```{r}
#| echo: false
val_vec <- y_dog
epsilon_vec <- val_vec - mean(y)
```

Wir nennen die Abstände $y_i - \bar{y}$ nach dem griechischen Buchstaben Epsilon $\epsilon$. Das $\epsilon$ soll an das $e$ von *Error* erinnern. So meint dann *Error* eben auch Abweichung. Ja, es gibt hier viele Worte für das gleiche Konzept. Aber manche Sachen brauchen wir dann wiederholt und es ist gut, die Worte hier schon mal zu lesen. Oder sich später hier wieder an das Konzept zu erinnern. Wir berechnen einen Mittelwert von den Epsilons mit $\bar{\epsilon} = `r round(mean(epsilon_vec), 4)`$. Ein Mittelwert nahe Null bzw. von Null wundert uns nicht. Wir haben die Gerade ja so gebaut, das nach oben und unten die gleichen Abstände sind.

## Standardfehler oder Standard Error (SE)

Wenn wir den Mittelwert der Sprungweiten berichten dann gehört die Standardabweichung der Sprungweiten mit als beschreibendes, statistisches Maß dazu. Wir berichten keinen Mittelwert ohne Standardabweichung. Nun ist es aber so, dass der Mittelwert und die Standardabweichung von der Fallzahl abhängen. Je mehr Fallzahl bzw. Beobachtungen wir haben, desto genauer wird der Mittelwert sein. Oder anders ausgedrückt unserer in der Stichprobe unserer Daten ermittelte Mittelwert $\bar{y}$ wird sich dem wahren, unbekannten Mittelwert $\mu_y$ annähern. Das gleiche gilt auch für unsere beobachtete Standardabweichung $s_y$, die sich der wahren, unbekannten Standardabweichung $\sigma_y$ mit steigender Fallzahl annähert.

Aus diesem Grund brauchen wir noch einen Fehler bzw. eine statistische Maßzahl für die Streuung, die unabhängig von der Fallzahl ist. Mit der Fallzahl meinen wir hier die Anzahl an Beobachtungen. Wir skalieren also die Standardabweichung mit der Fallzahl indem wir die Standardabweichung durch die Wurzel der Fallzahl teilen.

$$
SE = \cfrac{s}{\sqrt{n}} = \cfrac{2.14}{2.65} = 0.81
$$

Wir müssten ein Paket in R laden um den Standardfehler zu berechnen. Das Laden von zusätzlichen Paketen wollen wir hier aber vermeiden; wir können den Standardfehler auch einfach selber berechnen.

```{r }
se <- sd(y)/sqrt(length(y))
se %>% round(2)
```

Wir erhalten einen Standardfehler von $0.81cm$. Diese Zahl ist in dem Sinne nicht zu interpretieren, da wir hier nur Experimente losgelöst von deren Fallzahl miteinander vergleichen können. Wenn du also zwei Sprungweitenexperimente mit unterschiedlichen Fallzahlen $n_1$ und $n_2$ bezüglich der Streuung in den Experimenten vergleichen willst, dann nutzt du den Standardfehler, da der Standardfehler unabhängig von der Fallzahl der beiden Experimente ist. Auf der anderen Seite können wir ohne die berichtete Fallzahl nicht vom Standardfehler auf die Standardabweichung schließen.

::: callout-tip
## Der Standardfehler in Berichten

Wir berichten den Standardfehler immer zusammen mit der Fallzahl, so dass die Standardabweichung berechnet werden kann. Wenn wir überhaupt den Standardfehler berichten wollen. Meistens ist das nicht notwenidg, da reicht dann die Standardabweichung.
:::

Wir benötigen den Standardfehler eigentlich nicht zum Berichten von Ergebnissen. Der Standardfehler ist nicht als Zahl interpretierbar und somit eine reine statistische Größe. @tbl-comp-stand-sem zeigt die Zusammenfassung und den Vergleich von Standardabweichung und Standardfehler.

| Standardabweichung                                                           | Standardfehler                                                               |
|------------------------------------------------------------------------------|------------------------------------------------------------------------------|
| ... ist eine Aussage über die Streuung der erhobenen Werte einer Stichprobe. | ... ist eine Aussage über die Genauigkeit des Mittelwertes einer Stichprobe. |
| ... hängt von der biologischen Variabilität ab.                              | ... abhängig von der Messgenauigkeit                                         |
| ... ist ein beschreibendes Maß.                                              | ... ist ein statistisches Maß.                                               |
| ... ist nur wenig durch die Größe der Stichprobe beineinflussbar.            | ... steht im direkten Verhältnis zur Größe der Stichprobe.                   |

: Zusammenfassung und Vergleich von Standardabweichung und Standardfehler {#tbl-comp-stand-sem}

::: callout-note
## Standardfehler wird in der Metaanalyse genutzt

Der Standardfehler ist bedeutend in der Metaanalyse. Also dem gemeinsamen Auswerten von mehreren *klinischen* Studien. Du kannst im Buch [Doing Meta-Analysis with R: A Hands-On Guide](https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/effects.html) mehr darüber erfahren. Wir nutzen keine Metaanalysen in den Grundlagenveranstaltungen.
:::

## Median

Jetzt haben wir uns eine Möglichkeit den Schwerpunkt von einer Zahlenreihe zu berechnen angeschaut. Nun gibt es aber noch eine weitere Möglichkeit die "Mitte" von Zahlen zu ermitteln. Wir wollen uns jetzt noch eine andere Art der Zusammenfassung von Zahlen anschauen. Anstatt mit den Zahlen zu rechnen und die Zahlen aufzusummieren, sortieren wir jetzt die Zahlen. Wir nehmen also die Zahlen aus dem Vektor $y = \{`r str_c(y_dog, collapse = ", ")`\}$ und sortieren diese Zahlen nach dem Rang. Wir rechnen dann mit den Rängen und nicht mehr mit den Werten der Zahlen. Die kleinste Zahl kriegt den kleinsten Rang, die nächst größere Zahl dann den nächsten Rang. Wir können R über die Funktion `sort()` nutzen um den Vektor $y$ zu sortieren. Klar das geht auch schnell per Hand, aber wenn die Zahlenvektoren länger werden, dann ist so eien Funktion schon praktisch.

```{r}
y %>% sort()
```

Die neue Art die Mitte von dem sortierten Zahlenvektor zu bestimmen, nennen wir dann den Median berechnen. Der Median $\tilde{y}$ ist die mittlere Zahl eines Zahlenvektors. Wir haben hier sieben Zahlen, also ist der Median die vierte Zahl. Wir müssen hier aber zwischen einer ungeraden Anzahl und einer geraden Anzahl unterscheiden.

Ungerade Anzahl

:   Wenn wir eine ungerade Anzahl an Zahlen vorliegen haben, ist der Median die mittlere Zahl des Vektors $y$: $$
    5.6,  5.7,  7.6,  \underbrace{8.2,}_{Median}  8.9,  9.1, 11.8
    $$

In R können wir den Median einfach mit der Funktion `median()`berechnen.

```{r }
## ohne pipe-Operator
median(y) 

## mit pipe-Operator
y %>% median()
```

Gerade Anzahl

:   Wenn wir eine gerade Anzahl von Zahlen vorliegen haben, ist der Median der Mittelwert der beiden mittleren Zahlen des Vektors $y$. Ich habe hier einfach die Zahl 13.1 aus dem Hut gezaubert. Es könnte auch eine beliebige andere Zahl sein, die größer als 11.8 ist. Nur damit wir hier eine gerade Anzahl an Zahlen haben: $$
    5.6,  5.7,  7.6,  \underbrace{8.2, 8.9,}_{Median = \tfrac{8.2+8.9}{2}=8.55} 9.1, 11.8, \color{blue}{13.1}
    $$

In R können wir den Median wieder einfach mit der Funktion `median()`berechnen. Wir müssen nur die Zahl 13.1 zu dem Vektor `y` mit der Funktion `c()` hinzufügen.

```{r }
c(y, 13.1) %>% median() 
```

Der Median ist eine Alternative zu dem Mittelwert. Insbesondere in Fällen, wo es sehr große Zahlen gibt, die den Mittelwert in der Aussage verzerren, kann der Median sinnvoll sein. Wenn der Mittelwert stark von dem Median abweicht, deutet dies auf eine schiefe Verteilung oder aber Ausreißer in den Daten hin. Wir müssen dann in der explorativen Datenanalyse der Sachlage nachgehen.

::: callout-tip
## Median versus Mittelwert

Zur Veranschaulichung des Unterschiedes zwischen Median und Mittelwert nehmen wir die Mietpreise in New York. Der mittlere Mietpreis für eine 2-Zimmerwohnung in Manhattan liegt bei 5000\$ pro Monat. In den mittleren Mietpreis gehen aber auch die Mieten der Billionaires' Row mit ein. Der mediane Mietpreis liegt bei 4000\$. Die hohen Mieten ziehen den Mittelwert nach rechts.
:::

## Quantile und Quartile

Bei dem Mittelwert beschreibt die Standardabweichung die Streuung der Daten um den Mittelwert. Bei dem Median sind dies die Quartile. Die Quartile beschreiben die Streuung der Daten um den Median. Damit beschreiben wir also die Streuung der Beobachtungen um den Median anhand der Quartile. Um die Quartile bestimmen zu können, teilen wir die Daten in 100 Quantile. Du kannst dir Quantile wie Prozente vorstellen. Wir schneiden die Daten also in 100 Scheiben. Das geht natürlich erst wirklich, wenn wir hundert Zahlen haben. Deshalb hilft man sich mit Qua**r**tilen - von Quarta, ein Viertel - aus. @tbl-quart-quant zeigt dir da nochmal den Zusammenhang.

|   Quantile   |     Quartile      | Median |
|:------------:|:-----------------:|:------:|
| 25% Quantile | 1$^{st}$ Quartile |        |
| 50% Quantile | 2$^{nd}$ Quartile | Median |
| 75% Quantile | 3$^{rd}$ Quartile |        |

: Zusammenfassung und Vergleich von Quantilen, Quartilen und Median {#tbl-quart-quant}

Damit haben wir sogar eine Dreifachbelegung der "mittleren" Zahl. Zum einen handelt es sich um das 50% Quantil, weil 50% der Zahlen größer und 50% der Zahlen kleiner sind. Zum anderen handelt es sich auch um das 2$^{nd}$ Quartile. Da die Mitte einer Zahlenreihe als Median definiert ist, haben wir dann hier auch den Median vorliegen.

Wir bestimmen die Quartile wie den Median. Wir müssen unterscheiden, ob wir eine ungerade Anzahl an Zahlen oder eine gerade Anzahl an Zahlen vorliegen haben.

Ungerade Anzahl

:   Bei einer ungeraden Anzahl von Zahlen, ist das 1$^{st}$ Quartile die mittlere Zahl des unteren Mittels und das 3$^{rd}$ Quartile die mittlere Zahl des oberen Mittels des Vektors $y$: $$
    5.6,  \underbrace{5.7,}_{1st\ Quartile}  7.6,  8.2,  8.9,  \underbrace{9.1,}_{3rd\ Quartile} 11.8
    $$

Gerade Anzahl

:   Bei einer geraden Anzahl von Zahlen, ist das 1$^{st}$ Quartile der Mittelwert der beiden mittleren Zahl des unteren Mittels und das 3$^{rd}$ Quartile der Mittelwert der beiden mittleren Zahlen des oberen Mittels des Vektors $y$. Ich habe hier einfach die Zahl 13.1 aus dem Hut gezaubert. Es könnte auch eine beliebige andere Zahl sein, die größer als 11.8 ist. Nur damit wir hier eine gerade Anzahl an Zahlen haben: $$
    5.6,  \underbrace{5.7, 7.6,}_{1st\ Quartile = \tfrac{5.7+7.6}{2}=6.65}    8.2,  8.9,  \underbrace{9.1, 11.8}_{3rd\ Quartile = \tfrac{9.1+11.8}{2}=10.45} \color{blue}{13.1}
    $$

Das 95% Quantile und das 97.25% Quantile werden wir später nochmal im statistischen Testen brauchen. Auch hier ist die Idee, dass wir die Daten in hundert Teile schneiden und uns dann die extremen Zahlen anschauen.

In R können wir den Median einfach mit der Funktion `quantile()` berechnen. Wir berechnen hier das 25% Quantile also das 1$^{st}$ Quartile sowie das 50% Quantile also den Median und das 75% Quantile also das 3$^{rd}$ Quartile.

```{r }
y %>% quantile(probs = c(0.25, 0.5, 0.75)) %>% round(2)
c(y, 13.1) %>% quantile(probs = c(0.25, 0.5, 0.75)) %>% round(2) 
```

Warum unterscheiden sich die händisch berechneten Quartile von den Quartilen aus R? Es gibt verschiedene Arten der Berechnung. In der Klausur nutzen wir die Art und Weise wie die händische Berechnung hier beschrieben ist. Später in der Anwendung nehmen wir die Werte, die R ausgibt. Die Abweichungen sind so marginal, dass wir diese Abweichungen in der praktischen Anwendung ignorieren wollen.

## Interquartilesabstand (IQR)

Der Interquartilesabstand (IQR) beschreibt den Abstand zwischen dem 1$^{st}$ Quartile und dem 3$^{rd}$ Quartile. Daher ist der Interquartilesabstand (IQR) ähnlich der Spannweite zwischen dem maximalen und minimalen Wert. Wir benötigen das Interquartilesabstand (IQR) in der explorativen Datenanalyse wenn wir einen Boxplot erstellen wollen.

$$
IQR = 3^{rd}\,\mbox{Quartile} - 1^{st}\,\mbox{Quartile} = 9.1 - 5.7 = 3.4
$$

Wir verwenden das IQR als Zahl eher selten.

::: callout-note
## Parametrik versus Nicht-Parametrik

Wenn wir einen Zahlenvektor wie durch $y = \{`r str_c(y_dog, collapse = ", ")`\}$ beschrieben zusammenfassen wollen, haben wir zwei Möglichkeiten.

1)  Die **parametrische Variante** indem wir *mit den Zahlen* rechnen und deskriptive Maßzahlen wie Mittelwert, Varianz und Standardabweichung berechnen. Diese Maßzahlen kommen aber in den Zahlen nicht vor.
2)  Die **nicht-parametrische** Variante indem wir die Zahlen in Ränge umwandeln, also sortieren, und *mit den Rängen* der Zahlen rechnen. Die deskriptiven Maßzahlen wären dann Median, Quantile und Quartile.
:::

## Variationskoeffizient

Im Gegensatz zu der Varianz ist der Variationskoeffizient ein relatives Streuungsmaß, das heißt, der Variationskoeffizient hängt nicht von der Maßeinheit von $y$ ab. Die Motivation für den Variationskoeffizient ist, dass ein $y$ mit großem Mittelwert häufig eine größere Varianz aufweist als eine mit einem kleinen Mittelwert. Da die Varianz und die daraus abgeleitete Standardabweichung nicht normiert sind, kann ohne Kenntnis des Mittelwerts nicht beurteilt werden, ob eine Varianz groß oder klein ist. Der Variationskoeffizient ist eine Normierung der Varianz. Ist die Standardabweichung somit größer als der Mittelwert, so ist der Variationskoeffizient größer 1. Der Variationskoeffizient wird häufig verwendet, um die Variation zwischen zwei verschiedenen Datensätzen zu vergleichen.

Wir können den Variationskoeffizient basierend auf dem Mittelwert und der Standardabweichung berechnen.

$$
v = \cfrac{s}{\bar{y}}
$$

In unserem Beispiel würden wir als die Standardabweichung $s$ und den Mittelwert $\bar{y}$ in die Formel einsetzen.

$$
v = \cfrac{2.14cm}{8.13cm} = 0.26
$$

Wir können den Variationskoeffizient auch basierend auf dem Median berechnen.

$$
v_r=\cfrac{x_{0.75}-x_{0.25}}{\tilde{x}_{0.5}}
$$

In unserem Fall müssen wir hier dann die Quartile und den Median in die Formel einsetzen.

$$
v_r=\cfrac{9.1 - 5.7}{8.2} = 0.41
$$

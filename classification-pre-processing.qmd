```{r echo = FALSE}
pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc)
```

# Data preprocessing {#sec-pre-processing}

*Version vom `r format(Sys.time(), '%B %d, %Y um %H:%M:%S')`*

![](images/caution.png){fig-align="center" width="50%"}

## Dummycodierung von $X$

Wir werden immer häufiger davon sprechen, dass wir alle kategorialen Daten in *Dummies* überführen müssen. Das heißt, wir dürfen keine Faktoren mehr in unseren Daten haben. Wir wandeln daher alle Variablen, die ein Faktor sind, in Dummyspalten um. Die Idee von der Dummyspalte ist die gleiche wie bei der multiplen Regression. Da ich aber nicht davon ausgehe, dass du dir alles hier durchgelesen hast, kommt hier die kurze Einführung zur Dummycodierung.

Die Dummycodierung wird nur auf den Features durcgeführt. Dabei werden nur Spalten erschaffen, die $0/1$, für Level vorhanden oder Level nicht vorhanden, beinhalten. Wir werden also nur alle $x$ in Dummies umwandeln, die einem Faktor entsprechen. Dafür nutzen wir dann später eine Funktion, hier machen wir das einmal zu Veranschaulichung per Hand. In @tbl-class-basic-dummy-01 haben wir einen kleinen Ausschnitt unser Schweinedaten gegeben. Wir wollen zuerst die Spalte `sex` in eine Dummycodierung umwandeln.

| infected | age |  sex   |  frailty  |
|:--------:|:---:|:------:|:---------:|
|    1     | 24  |  male  |  robust   |
|    0     | 36  |  male  | pre-frail |
|    0     | 21  | female |   frail   |
|    1     | 34  | female |  robust   |
|    1     | 27  |  male  |   frail   |

: Beispieldatensatz für die Dummycodierung. Wir wollen die Spalten `sex` und `frailty` als Dummyspalten haben. {#tbl-class-basic-dummy-01}

In der @tbl-class-basic-dummy-02 sehen wir das Ergebnis für die Dummycodierung der Spalte `sex` in die Dummyspalte `sex_male`. Wir haben in der Dummyspalte nur noch die Information, ob das Ferkel mänlich ist oder nicht. Wenn wir eine Eins in der Spalte finden, dann ist das Ferkel männlich. Wenn wir eine Null vorfinden, dann ist das Ferkel nicht männlich also weiblich. Das *Nicht* müssen wir uns dann immer merken.

| infected | age | sex_male |
|:--------:|:---:|:--------:|
|    1     | 24  |    1     |
|    0     | 36  |    1     |
|    0     | 21  |    0     |
|    1     | 34  |    0     |
|    1     | 27  |    1     |

: Ergebnis der Dummycodierung der Spalte `sex` zu der Spalte `sex_male`. {#tbl-class-basic-dummy-02}

In der @tbl-class-basic-dummy-03 betrachten wir einen kompleren Fall. Wenn wir eine Spalte vorliegen haben mit mehr als zwei Leveln, wie zum Beispiel die Spalte `frailty`, dann erhalten wir zwei Spalten wieder. Die Spalte `frailty_robust` beschreibt das Vorhandensein des Levels `robust` und die Spalte `frailty_pre-frail` das Vorhandensein des Levels `pre-frail`. Und was ist mit dem Level `frail`? Das Level wir durch das Nichtvorhandesein von `robust` und dem Nichtvorhandensein von `pre-frail` abgebildet. Beinhalten beide Spalten die Null, so ist das Ferkel `frail`.

| infected | age | frailty_robust | frailty_pre-frail |
|:--------:|:---:|:--------------:|:-----------------:|
|    1     | 24  |       1        |         0         |
|    0     | 36  |       0        |         1         |
|    0     | 21  |       0        |         0         |
|    1     | 34  |       1        |         0         |
|    1     | 27  |       0        |         0         |

: Ergebnis der Dummycodierung für eine Spalte mit mehr als zwei Leveln. {#tbl-class-basic-dummy-03}

Wenn wir einen Faktor mit $l$ Leveln haben, erhalten wir immer $l-1$ Spalten nach der Dummycodierung wieder.

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>78&nbsp; Der Post-hoc Test – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./app-spielecke.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-729da849622d0d086c6d816acf7508a6.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="78&nbsp; Der Post-hoc Test – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./abspann.html">Abspann</a></li><li class="breadcrumb-item"><a href="./stat-tests-posthoc2.html"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>purrr</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der Post-hoc-Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">78.1</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">78.2</span> Daten</a></li>
  <li><a href="#modell" id="toc-modell" class="nav-link" data-scroll-target="#modell"><span class="header-section-number">78.3</span> Modell</a></li>
  <li><a href="#varianzhomogenität-und-varianzheterogenität" id="toc-varianzhomogenität-und-varianzheterogenität" class="nav-link" data-scroll-target="#varianzhomogenität-und-varianzheterogenität"><span class="header-section-number">78.4</span> Varianzhomogenität und Varianzheterogenität</a></li>
  <li><a href="#der-effektive-pfad-mit-emmeans" id="toc-der-effektive-pfad-mit-emmeans" class="nav-link" data-scroll-target="#der-effektive-pfad-mit-emmeans"><span class="header-section-number">78.5</span> Der effektive Pfad mit <code>{emmeans}</code></a>
  <ul class="collapse">
  <li><a href="#einfaktorielle-analyse" id="toc-einfaktorielle-analyse" class="nav-link" data-scroll-target="#einfaktorielle-analyse"><span class="header-section-number">78.5.1</span> Einfaktorielle Analyse</a></li>
  <li><a href="#zweifaktorielle-analyse" id="toc-zweifaktorielle-analyse" class="nav-link" data-scroll-target="#zweifaktorielle-analyse"><span class="header-section-number">78.5.2</span> Zweifaktorielle Analyse</a></li>
  </ul></li>
  <li><a href="#der-anova-pfad-mit-tukey-hsd" id="toc-der-anova-pfad-mit-tukey-hsd" class="nav-link" data-scroll-target="#der-anova-pfad-mit-tukey-hsd"><span class="header-section-number">78.6</span> Der ANOVA Pfad mit Tukey HSD</a></li>
  <li><a href="#weitere-pfade" id="toc-weitere-pfade" class="nav-link" data-scroll-target="#weitere-pfade"><span class="header-section-number">78.7</span> Weitere Pfade</a>
  <ul class="collapse">
  <li><a href="#paarweise-tests" id="toc-paarweise-tests" class="nav-link" data-scroll-target="#paarweise-tests"><span class="header-section-number">78.7.1</span> Paarweise Tests</a></li>
  <li><a href="#games-howell-test" id="toc-games-howell-test" class="nav-link" data-scroll-target="#games-howell-test"><span class="header-section-number">78.7.2</span> Games Howell Test</a></li>
  <li><a href="#r-paket-multcomp" id="toc-r-paket-multcomp" class="nav-link" data-scroll-target="#r-paket-multcomp"><span class="header-section-number">78.7.3</span> R Paket <code>{multcomp}</code></a></li>
  <li><a href="#r-paket-nparcomp" id="toc-r-paket-nparcomp" class="nav-link" data-scroll-target="#r-paket-nparcomp"><span class="header-section-number">78.7.4</span> R Paket <code>{nparcomp}</code></a></li>
  </ul></li>
  <li><a href="#weitere-dinge-von-interesse" id="toc-weitere-dinge-von-interesse" class="nav-link" data-scroll-target="#weitere-dinge-von-interesse"><span class="header-section-number">78.8</span> Weitere Dinge von Interesse</a>
  <ul class="collapse">
  <li><a href="#sec-friedhof-posthoc" id="toc-sec-friedhof-posthoc" class="nav-link" data-scroll-target="#sec-friedhof-posthoc"><span class="header-section-number">78.8.1</span> Friedhof der Post-hoc Tests</a></li>
  <li><a href="#re-engineering-compact-letter-display" id="toc-re-engineering-compact-letter-display" class="nav-link" data-scroll-target="#re-engineering-compact-letter-display"><span class="header-section-number">78.8.2</span> Re-engineering <em>Compact letter display</em></a></li>
  <li><a href="#sec-posthoc-var-heterogen" id="toc-sec-posthoc-var-heterogen" class="nav-link" data-scroll-target="#sec-posthoc-var-heterogen"><span class="header-section-number">78.8.3</span> Modellierung von Varianzheterogenität</a></li>
  </ul></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-posthoc2.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-posthoc2.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./abspann.html">Abspann</a></li><li class="breadcrumb-item"><a href="./stat-tests-posthoc2.html"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-posthoc" class="quarto-section-identifier"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 10. January 2025 um 09:38:43</em></p>
<blockquote class="blockquote">
<p><em>“Comparison is the thief of joy.” — Theodore Roosevelt</em></p>
</blockquote>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01_small.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/angel_01_small.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>In diesem Kapitel werde ich ein paar Engel der Statistik niedergeschlagen oder überfahren. Ich lasse aus Gründen der Didaktik ein paar Sachen weg und dadurch wird einiges leider dann <em>mathematisch</em> unkorrekt. Ich kann damit leben und nehme es auf mich damit du deine Abschlussarbeit fertig bekommst.</p>
</blockquote>
</div>
</div>
</div>
<div id="tbl-übersicht" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-übersicht-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;78.1— test. Achtung, teilweise müssen die Optionen <em>aktiv</em> von dir aktiviert werden. Sie dazu auch den <a href="#sec-friedhof-posthoc">Friedhof der Post-ho Tests</a> in diesem Kapitel.
</figcaption>
<div aria-describedby="tbl-übersicht-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Tukey HSD</th>
<th style="text-align: center;">Games Howell</th>
<th style="text-align: center;"><code>{emmeans}</code></th>
<th style="text-align: center;"><code>{multcomp}</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Verteilung von y</strong></td>
<td style="text-align: center;">normalverteilt</td>
<td style="text-align: center;">normalverteilt</td>
<td style="text-align: center;">beliebig</td>
<td style="text-align: center;">beliebig</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Varianzen von x</strong></td>
<td style="text-align: center;">homogen</td>
<td style="text-align: center;">heterogen</td>
<td style="text-align: center;">beliebig</td>
<td style="text-align: center;">beliebig</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Fallzahl per Gruppe</strong></td>
<td style="text-align: center;">balanciert</td>
<td style="text-align: center;">beliebig</td>
<td style="text-align: center;">beliebig</td>
<td style="text-align: center;">beliebig</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Adjustierte p-Werte</strong></td>
<td style="text-align: center;">immer</td>
<td style="text-align: center;">immer</td>
<td style="text-align: center;">beliebig</td>
<td style="text-align: center;">beliebig</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Mögliche Vergleiche</strong></td>
<td style="text-align: center;"><em>all-pair</em></td>
<td style="text-align: center;"><em>all-pair</em></td>
<td style="text-align: center;">beliebig</td>
<td style="text-align: center;">beliebig</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Auf der Seite DSFAIR gibt es noch einen Artikel zu <code>emmeans</code> und der Frage <a href="https://schmidtpaul.github.io/dsfair_quarto/ch/summaryarticles/whyseequal.html">Why are the StdErr all the same?</a> und dazu dann auch passend die Publikation <a href="https://www.cambridge.org/core/services/aop-cambridge-core/content/view/92DB0AF151C157B9C6E2FA40F9C9B635/S0014479719000401a.pdf/analyzing-designed-experiments-should-we-report-standard-deviations-or-standard-errors-of-the-mean-or-standard-errors-of-the-difference-or-what.pdf">Analyzing designed experiments: Should we report standard deviations or standard errors of the mean or standard errors of the difference or what?</a></p>
<dl>
<dt>Wieviel ist den <em>all-pair</em>?</dt>
<dd>
<p>Wenn du alle möglichen Mittelwertkombinationen testen willst, dann ist die Formel für die Berechnung der durchzuführenden Vergleiche <span class="math inline">\(r = m(m-1)/2\)</span>. Oder um es einmal in der folgenden Tabelle etwas konkreter darzustellen, werden es sehr schnell sehr viele Vergleiche. Dabei drückst du mit jeder zusätzlichen Behandlungsgruppe das Signifikanznievau <span class="math inline">\(\alpha\)</span> weiter runter, da die Anzahl an potenziellen Vergleichen sehr schnell ansteigt. So fällt dann auch der maximal noch signifikante p-Wert schnell ab. Damit brauchst du dann immer stärkere Effekt, wie einen Mittelwertsunterschied, um überhaupt noch was signifikantes aus einem statistsichen Test wiedergeben zu bekommen. In der folgenden Tabelle siehtst du dann nochmal den Zussammenhang. Ohne Adjustierung des Signifikanzniveaus erhalten wir schon ab sechs Gruppen mindestens einen signifikanten Unterschied auch wenn es gar keinen Unterschied in den Daten gibt.</p>
</dd>
</dl>
<div class="cell">
<div id="tbl-allpair-bonf" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-allpair-bonf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;78.2— Zusammenhang von der Anzahl an Gruppen oder Behandlungen und der sich ergebenden Anzahl an <em>all-pair</em> Vergleichen. Daraus ergibt sich ein stark abfallendes Signifikanzniveau. Der maximal noch signifikante p-Wert fällt dementsprechend auch schnell ab. <strong>Ohne Adjustierung</strong> erhalten wir schon ab sechs Gruppen mindestens einen fälschlichen signifikanten Unterschied.
</figcaption>
<div aria-describedby="tbl-allpair-bonf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 23%">
<col style="width: 24%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Anzahl Gruppen</th>
<th style="text-align: center;">Anzahl Vergleiche</th>
<th style="text-align: center;">Signifikanzniveau <span class="math inline">\(\alpha\)</span></th>
<th style="text-align: center;">Maximal signifikanter p-Wert</th>
<th style="text-align: center;"><span class="math inline">\(H_0\)</span> fälschlich abgelehnt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5.00%</td>
<td style="text-align: center;">0.0500</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1.67%</td>
<td style="text-align: center;">0.0167</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.83%</td>
<td style="text-align: center;">0.0083</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">0.50%</td>
<td style="text-align: center;">0.0050</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">6</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">0.33%</td>
<td style="text-align: center;">0.0033</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">0.24%</td>
<td style="text-align: center;">0.0024</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">8</td>
<td style="text-align: center;">28</td>
<td style="text-align: center;">0.18%</td>
<td style="text-align: center;">0.0018</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">9</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">0.14%</td>
<td style="text-align: center;">0.0014</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">10</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;">0.11%</td>
<td style="text-align: center;">0.0011</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">11</td>
<td style="text-align: center;">55</td>
<td style="text-align: center;">0.09%</td>
<td style="text-align: center;">0.0009</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">12</td>
<td style="text-align: center;">66</td>
<td style="text-align: center;">0.08%</td>
<td style="text-align: center;">0.0008</td>
<td style="text-align: center;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<dl>
<dt>Was bedeutet <em>konservativ</em> und was <em>liberal</em>?</dt>
<dd>
<p>Test</p>
</dd>
</dl>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-posthoc-temp" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-posthoc-temp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-posthoc-temp-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;78.1— Visueller Zusammenhang eines gemittelten Outcomes (y) aus einer Normalverteilung im Verhältnis zu der Einflussvariable (x) mit zwei oder mehr Kategorien anhand von Barplots. Hauptsächlich unterscheiden sich die Barplots durch die unterschiedlichen Einheiten auf der y-Achse. Die Fehlerbalken stellen den Standardfehler (SE) dar. [Zum Vergrößern anklicken]"><img src="stat-tests-posthoc2_files/figure-html/fig-posthoc-temp-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-posthoc-temp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.1— Visueller Zusammenhang eines gemittelten Outcomes (<span class="math inline">\(y\)</span>) aus einer Normalverteilung im Verhältnis zu der Einflussvariable (<span class="math inline">\(x\)</span>) mit zwei oder mehr Kategorien anhand von Barplots. Hauptsächlich unterscheiden sich die Barplots durch die unterschiedlichen Einheiten auf der <span class="math inline">\(y\)</span>-Achse. Die Fehlerbalken stellen den Standardfehler (<em>SE</em>) dar. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<section id="genutzte-r-pakete" class="level2" data-number="78.1">
<h2 data-number="78.1" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">78.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, readxl, knitr, kableExtra, Hmisc, see, latex2exp,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               multcomp, emmeans, ggpubr, multcompView, nlme, quantreg, janitor,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               parameters, effectsize, patchwork, agricolae, broom, rstatix,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               conflicted)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="78.2">
<h2 data-number="78.2" class="anchored" data-anchor-id="daten"><span class="header-section-number">78.2</span> Daten</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div id="tbl-1fac-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;78.3— foo
</figcaption>
<div aria-describedby="tbl-1fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">jump_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.7</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">11.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">8.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.3</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Die Funktion <code>standard_error()</code> aus dem R Paket <code>{parameters}</code></p>
<div class="cell">
<div id="tbl-1fac-mean" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1fac-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;78.4— foo
</figcaption>
<div aria-describedby="tbl-1fac-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;">Standardabweichung</th>
<th style="text-align: center;">SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.13</td>
<td style="text-align: center;">2.14</td>
<td style="text-align: center;">0.81</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">4.74</td>
<td style="text-align: center;">1.90</td>
<td style="text-align: center;">0.72</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">9.16</td>
<td style="text-align: center;">1.10</td>
<td style="text-align: center;">0.42</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-emmeans-fac1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-emmeans-fac1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-boxplot-emmeans-fac1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;78.2— Boxplot der Sprungweiten [cm] von Hunden und Katzen gemessen an verschiedenen Orten."><img src="stat-tests-posthoc2_files/figure-html/fig-boxplot-emmeans-fac1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-emmeans-fac1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.2— Boxplot der Sprungweiten [cm] von Hunden und Katzen gemessen an verschiedenen Orten.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir machen den Datensatz mal kleiner</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox_site.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, site, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"city"</span>, <span class="st">"village"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">as_factor</span>(site))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div id="tbl-2fac-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-2fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;78.5— foo
</figcaption>
<div aria-describedby="tbl-2fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">site</th>
<th style="text-align: center;">jump_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">12.04</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">11.98</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">16.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">13.63</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">14.09</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">15.52</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div id="tbl-2fac-mean" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-2fac-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;78.6— foo
</figcaption>
<div aria-describedby="tbl-2fac-mean-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">site</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;">Standardabweichung</th>
<th style="text-align: center;">SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">13.58</td>
<td style="text-align: center;">1.88</td>
<td style="text-align: center;">0.59</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">village</td>
<td style="text-align: center;">15.25</td>
<td style="text-align: center;">2.35</td>
<td style="text-align: center;">0.74</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">16.68</td>
<td style="text-align: center;">2.26</td>
<td style="text-align: center;">0.71</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">village</td>
<td style="text-align: center;">16.56</td>
<td style="text-align: center;">1.21</td>
<td style="text-align: center;">0.38</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">20.12</td>
<td style="text-align: center;">1.15</td>
<td style="text-align: center;">0.37</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">village</td>
<td style="text-align: center;">16.98</td>
<td style="text-align: center;">1.73</td>
<td style="text-align: center;">0.55</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-emmeans-fac2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-emmeans-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-boxplot-emmeans-fac2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;78.3— Boxplot der Sprungweiten [cm] von Hunden und Katzen gemessen an verschiedenen Orten."><img src="stat-tests-posthoc2_files/figure-html/fig-boxplot-emmeans-fac2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-emmeans-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.3— Boxplot der Sprungweiten [cm] von Hunden und Katzen gemessen an verschiedenen Orten.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="modell" class="level2" data-number="78.3">
<h2 data-number="78.3" class="anchored" data-anchor-id="modell"><span class="header-section-number">78.3</span> Modell</h2>
<p>Einfaktorielles Modell</p>
<p><span class="math display">\[
y \sim f_1
\]</span></p>
<p>Zweifaktorielles Modell</p>
<p><span class="math display">\[
y \sim f_1 + f_2
\]</span></p>
</section>
<section id="varianzhomogenität-und-varianzheterogenität" class="level2" data-number="78.4">
<h2 data-number="78.4" class="anchored" data-anchor-id="varianzhomogenität-und-varianzheterogenität"><span class="header-section-number">78.4</span> Varianzhomogenität und Varianzheterogenität</h2>
<p>Varianz in den Fakoren</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><code>geom_bar()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false"><code>geom_boxplot()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Excel</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-posthoc-var-homo-bar" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-posthoc-var-homo-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-posthoc-var-homo-bar-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Abbildung&nbsp;78.4— Visueller [Zum Vergrößern anklicken]"><img src="stat-tests-posthoc2_files/figure-html/fig-posthoc-var-homo-bar-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-posthoc-var-homo-bar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.4— Visueller <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-posthoc-var-homo-box" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-posthoc-var-homo-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-posthoc-var-homo-box-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Abbildung&nbsp;78.5— Visueller [Zum Vergrößern anklicken]"><img src="stat-tests-posthoc2_files/figure-html/fig-posthoc-var-homo-box-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-posthoc-var-homo-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.5— Visueller <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Das hier ist natürlich nochmal eien Wiederholung des <a href="eda-ggplot.html">Kapitels zur Visualisierung von Daten</a></p>
<section id="einfaktorieller-barplot" class="level3" data-number="78.4.1">
<h3 data-number="78.4.1" class="anchored" data-anchor-id="einfaktorieller-barplot"><span class="header-section-number">78.4.1</span> Einfaktorieller Barplot</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>stat_fac1_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(jump_length))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>stat_fac1_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  animal  mean    sd
  &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 dog     8.13  2.14
2 cat     4.74  1.90
3 fox     9.16  1.10</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_fac1_tbl, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-posthoc-barplot-1fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-posthoc-barplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-barplot-1fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Abbildung&nbsp;78.6— foo."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-barplot-1fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-posthoc-barplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.6— foo.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweifaktorieller-barplot" class="level3" data-number="78.4.2">
<h3 data-number="78.4.2" class="anchored" data-anchor-id="zweifaktorieller-barplot"><span class="header-section-number">78.4.2</span> Zweifaktorieller Barplot</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>stat_fac2_tbl <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal, site) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(jump_length))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'animal'. You can override using the
`.groups` argument.</code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>stat_fac2_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
# Groups:   animal [3]
  animal site     mean    sd
  &lt;fct&gt;  &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 cat    city     13.6  1.88
2 cat    village  15.2  2.35
3 dog    city     16.7  2.26
4 dog    village  16.6  1.21
5 fox    city     20.1  1.15
6 fox    village  17.0  1.73</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_fac2_tbl, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.9</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-posthoc-barplot-2fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-posthoc-barplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-barplot-2fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Abbildung&nbsp;78.7— foo."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-barplot-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-posthoc-barplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.7— foo.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<section id="einfaktorieller-boxplot" class="level3" data-number="78.4.3">
<h3 data-number="78.4.3" class="anchored" data-anchor-id="einfaktorieller-boxplot"><span class="header-section-number">78.4.3</span> Einfaktorieller Boxplot</h3>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-posthoc-boxplot-1fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-posthoc-boxplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-boxplot-1fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Abbildung&nbsp;78.8— foo."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-boxplot-1fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-posthoc-boxplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.8— foo.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweifaktorieller-boxplot" class="level3" data-number="78.4.4">
<h3 data-number="78.4.4" class="anchored" data-anchor-id="zweifaktorieller-boxplot"><span class="header-section-number">78.4.4</span> Zweifaktorieller Boxplot</h3>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac2_tbl, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-posthoc-boxplot-2fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-posthoc-boxplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-boxplot-2fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Abbildung&nbsp;78.9— foo."><img src="stat-tests-posthoc2_files/figure-html/fig-ggplot-posthoc-boxplot-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-posthoc-boxplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.9— foo.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>Dann habe ich mich doch noch hingesetzt und einmal für dich die Videos gemacht, wie du dann einen Barplot oder eben ein Säulendigramm in Excel erstellst. Daran kannst du natürlich auch überprüfen, ob die Variazen homogen sind oder nicht. Das ganze macht dann nur als Video Sinn, denn sonst kannst du ja nicht nachvollziehen, was ich geklickt habe.</p>
<p>Hier also erstmal die einfachere Variante mit dem 1-faktoriellen Barplot. Beginnen wollen wir wie immer mit der Berechnung der Mittelwerte und der Standardabweichung. Bitte nutze für die Standardabweichung die Funktion <code>STABW.S()</code> in Excel.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/UdZ5p8euo64" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Und im Anschluss nochmal das Video für den 2-faktoriellen Barplot. Du hast jetzt eben nicht nur eine Behandlungsgruppe vorliegen sondern zwei Behandlungsgruppen. Dann musst du etwas mehr Arbeit reinstecken um alle Mittelwerte und Standardabweichungen zu berechnen. Bitte nutze auch hier für die Standardabweichung die Funktion <code>STABW.S()</code> in Excel.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/mGSMZ6C7x4E" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div>
</div>
</div>
</section>
<section id="der-effektive-pfad-mit-emmeans" class="level2" data-number="78.5">
<h2 data-number="78.5" class="anchored" data-anchor-id="der-effektive-pfad-mit-emmeans"><span class="header-section-number">78.5</span> Der effektive Pfad mit <code>{emmeans}</code></h2>
<p>Text</p>
<dl>
<dt>Varianzhomogenität oder Varianzheterogenität</dt>
<dd>
<p>Wir können in <code>{emmeans}</code> eine mögliche Varianzheterogenität modellieren, wenn wir das nicht tun, dann rechnet <code>{emmeans}</code> immer unter der Annahme von Varianzhomogenität. Wenn du nicht für die Varianzheterogenität adjustieren möchtest, dann rechnest du faktisch einen Tukey HSD Test. Der Tukey HSD Test rechnet <em>immer</em> mit Varianzhomogenität. In allen Beispielen hier, werde ich aber für Varianzheterogenität adjustieren. Dazu nutze ich dann die Option <code>vcov. = sandwich::vcovHAC</code> im <code>emmeans()</code> Funktionsaufruf. In dem R Paket <code>{sandwich}</code> gibt es eine riesige Anzahl an möglichen Funktionen um für Varianzheterogenität zu adjustieren. Wir nutzen hier die Option <code>vcovHAC</code>, die in vielen Fällen vollkommen ausrichend ist.</p>
</dd>
<dt>Adjustierung für multiple Vergleiche</dt>
<dd>
<p>Das Paket <code>{emmeans}</code> kann sehr einfach für die Adjustierung von multiplen Vergleichen angepasst werden um adjustierte p-Werte zu erhalten. In der Standardeinstellung nutzt <code>{emmeans}</code> die Quartile aus einem Tukey HSD Test und somit ist <code>{emmeans}</code> gar nicht so weit weg von dem Tukey HSD Test. Ich stelle aber meistens die Adjustierung auf Bonferroniadjustierung mit der Option <code>adjust = "bonferroni"</code>, da diese Adjustierung etwas eingängiger ist. Das bleibt aber dir überlassen, ob du überhaupt eine Adustierung wählen willst. Mit der Option <code>adjust = "none"</code> stellst du die Adjustierung für multiple Vergleiche aus. Du erhälst die rohen p-Werte.</p>
</dd>
<dt>Mögliche multiple Vergleiche</dt>
<dd>
<p>Wir können auch eine andere Kontrolle wählen <code>contrast(method = "trt.vs.ctrl", ref = "fox")</code></p>
</dd>
<dt>Fallzahl in den einzelnen Behandlungsgruppen</dt>
<dd>
<p>text</p>
</dd>
</dl>
<section id="einfaktorielle-analyse" class="level3" data-number="78.5.1">
<h3 data-number="78.5.1" class="anchored" data-anchor-id="einfaktorielle-analyse"><span class="header-section-number">78.5.1</span> Einfaktorielle Analyse</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj <span class="ot">&lt;-</span> fac1_fit <span class="sc">|&gt;</span>  </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean    SE df lower.CL upper.CL
 dog      8.13 0.427 18     7.23     9.03
 cat      4.74 0.810 18     3.04     6.44
 fox      9.16 0.468 18     8.17    10.14

Confidence level used: 0.95 </code></pre>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">p-Werte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><em>Compact Letter Display</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">95% Konfidenzintervall</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>comp_fac1_obj <span class="ot">&lt;-</span> emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>comp_fac1_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast  estimate    SE df t.ratio p.value
 dog - cat     3.39 0.904 18   3.744  0.0045
 dog - fox    -1.03 0.635 18  -1.620  0.3678
 cat - fox    -4.41 0.997 18  -4.425  0.0010

P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpp</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Abbildung&nbsp;78.10— Visualisierung der Ergebnisse im Pairwise P-value plot."><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.10— Visualisierung der Ergebnisse im Pairwise P-value plot.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       dog    cat    fox
dog [8.13] 0.0045 0.3678
cat   3.39 [4.74] 0.0010
fox  -1.03  -4.41 [9.16]

Row and column labels: animal
Upper triangle: P values   adjust = "bonferroni"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>emm_fac1_cld <span class="ot">&lt;-</span> emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>emm_fac1_cld</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean    SE df lower.CL upper.CL .group
 cat      4.74 0.810 18     2.61     6.88  a    
 dog      8.13 0.427 18     7.00     9.25   b   
 fox      9.16 0.468 18     7.92    10.39   b   

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 3 estimates 
P value adjustment: bonferroni method for 3 tests 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>emm_fac1_cld <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">7</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> emmean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="fl">0.5</span>),</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-fac1-cld" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-fac1-cld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-fac1-cld-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Abbildung&nbsp;78.11— foo."><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-fac1-cld-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-fac1-cld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.11— foo.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>res_fac1_ci_obj <span class="ot">&lt;-</span> emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, adj.p.value, conf.low, conf.high) <span class="sc">|&gt;</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">4</span>))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>res_fac1_ci_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  contrast  estimate adj.p.value conf.low conf.high
  &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 dog - cat     3.39      0.004      1.08     5.69 
2 dog - fox    -1.03      0.263     -2.65     0.592
3 cat - fox    -4.41      0.0009    -6.96    -1.87 </code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(res_fac1_ci_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Abbildung&nbsp;78.12— Die 95% Konfidenzintervalle für den allpair-Vergleich des simplen Datensatzes."><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.12— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des simplen Datensatzes.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="zweifaktorielle-analyse" class="level3" data-number="78.5.2">
<h3 data-number="78.5.2" class="anchored" data-anchor-id="zweifaktorielle-analyse"><span class="header-section-number">78.5.2</span> Zweifaktorielle Analyse</h3>
<p>Modell</p>
<p><span class="math display">\[
y \sim f_1 + f_2 + f_1 \times f_2
\]</span></p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir müssen uns jetzt entscheiden wie wir die beiden Faktoren <span class="math inline">\(f_1\)</span> mit <code>animal</code> und <span class="math inline">\(f_2\)</span> mit <code>site</code> auswerten wollen. Wir können den Faktor <code>animal</code> getrennt für jedes Level des Faktors <code>site</code> vergleichen oder wir vergleichen alle Faktorkombinationen gemeinsam.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Getrennt für <span class="math inline">\(f_1\)</span> und <span class="math inline">\(f_2\)</span> mit <span class="math inline">\(\boxed{\sim f_1 | f_2}\)</span></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Gemeinsam für <span class="math inline">\(f_1\)</span> und <span class="math inline">\(f_2\)</span> mit <span class="math inline">\(\boxed{\sim f_1 * f_2}\)</span></a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj <span class="ot">&lt;-</span> fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 animal emmean    SE df lower.CL upper.CL
 cat      13.6 0.603 54     12.4     14.8
 dog      16.7 0.693 54     15.3     18.1
 fox      20.1 0.395 54     19.3     20.9

site = village:
 animal emmean    SE df lower.CL upper.CL
 cat      15.2 0.834 54     13.6     16.9
 dog      16.6 0.246 54     16.1     17.1
 fox      17.0 0.489 54     16.0     18.0

Confidence level used: 0.95 </code></pre>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>emm_fac2_combinded_obj <span class="ot">&lt;-</span> fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">*</span> site, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>emm_fac2_combinded_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal site    emmean    SE df lower.CL upper.CL
 cat    city      13.6 0.603 54     12.4     14.8
 dog    city      16.7 0.693 54     15.3     18.1
 fox    city      20.1 0.395 54     19.3     20.9
 cat    village   15.2 0.834 54     13.6     16.9
 dog    village   16.6 0.246 54     16.1     17.1
 fox    village   17.0 0.489 54     16.0     18.0

Confidence level used: 0.95 </code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">p-Werte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false"><em>Compact Letter Display</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">95% Konfidenzintervall</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>comp_fac2_separate_obj <span class="ot">&lt;-</span> emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>comp_fac2_separate_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 contrast  estimate    SE df t.ratio p.value
 cat - dog   -3.101 0.919 54  -3.376  0.0041
 cat - fox   -6.538 0.721 54  -9.070  &lt;.0001
 dog - fox   -3.437 0.798 54  -4.310  0.0002

site = village:
 contrast  estimate    SE df t.ratio p.value
 cat - dog   -1.316 0.869 54  -1.514  0.4076
 cat - fox   -1.729 0.967 54  -1.789  0.2377
 dog - fox   -0.413 0.547 54  -0.755  1.0000

P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>comp_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">|&gt;</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, site, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">format.pval</span>(p.value, <span class="at">eps =</span> <span class="fl">0.001</span>, <span class="at">digits =</span> <span class="dv">2</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  contrast  site    p.value
  &lt;fct&gt;     &lt;fct&gt;   &lt;chr&gt;  
1 cat - dog city    0.00   
2 cat - fox city    &lt;0.001 
3 dog - fox city    &lt;0.001 
4 cat - dog village 0.41   
5 cat - fox village 0.24   
6 dog - fox village 1.00   </code></pre>
</div>
</div>
<p>Hier müssen wir dann nochmal emmeans aufrufen! Wir machen das hier nochmal für getrennt.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpp</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-foo-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-foo-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-foo-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Abbildung&nbsp;78.13— Visualisierung der Ergebnisse im Pairwise P-value plot."><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-foo-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-foo-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.13— Visualisierung der Ergebnisse im Pairwise P-value plot.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj <span class="sc">|&gt;</span>   </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
site = city
       cat    dog    fox
cat [13.6] 0.0041 &lt;.0001
dog  -3.10 [16.7] 0.0002
fox  -6.54  -3.44 [20.1]

site = village
       cat    dog    fox
cat [15.2] 0.4076 0.2377
dog -1.316 [16.6] 1.0000
fox -1.729 -0.413 [17.0]

Row and column labels: animal
Upper triangle: P values   adjust = "bonferroni"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>emm_fac2_cld <span class="ot">&lt;-</span> emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>emm_fac2_cld</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 animal emmean    SE df lower.CL upper.CL .group
 cat      13.6 0.603 54     12.1     15.1  a    
 dog      16.7 0.693 54     15.0     18.4   b   
 fox      20.1 0.395 54     19.1     21.1    c  

site = village:
 animal emmean    SE df lower.CL upper.CL .group
 cat      15.2 0.834 54     13.2     17.3  a    
 dog      16.6 0.246 54     16.0     17.2  a    
 fox      17.0 0.489 54     15.8     18.2  a    

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 3 estimates 
P value adjustment: bonferroni method for 3 tests 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Hier dann noch die Implementierung mit geom text</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>emm_fac2_cld <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">7</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> emmean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.9</span>, </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-fac2-cld" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-fac2-cld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-fac2-cld-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Abbildung&nbsp;78.14— foo."><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-fac2-cld-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-fac2-cld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.14— foo.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>comp_fac2_ci_obj <span class="ot">&lt;-</span> emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">confint</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, site, estimate, <span class="at">conf.low =</span> lower.CL, <span class="at">conf.high =</span> upper.CL) </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>comp_fac2_ci_obj </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  contrast  site    estimate conf.low conf.high
  &lt;fct&gt;     &lt;fct&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 cat - dog city      -3.10     -5.37    -0.831
2 cat - fox city      -6.54     -8.32    -4.76 
3 dog - fox city      -3.44     -5.41    -1.47 
4 cat - dog village   -1.32     -3.46     0.832
5 cat - fox village   -1.73     -4.12     0.659
6 dog - fox village   -0.413    -1.77     0.939</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comp_fac2_ci_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> site, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-emmeans-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Abbildung&nbsp;78.15— Die 95% Konfidenzintervalle für den allpair-Vergleich des Models mit Interaktionseffekt."><img src="stat-tests-posthoc2_files/figure-html/fig-emmeans-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.15— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des Models mit Interaktionseffekt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="der-anova-pfad-mit-tukey-hsd" class="level2" data-number="78.6">
<h2 data-number="78.6" class="anchored" data-anchor-id="der-anova-pfad-mit-tukey-hsd"><span class="header-section-number">78.6</span> Der ANOVA Pfad mit Tukey HSD</h2>
<p>Der Tukey HSD Test (abk. <em>HSD Test</em>) hat viele Namen. Im Englischen kennen wir den Tukey HSD Test auch als <em>Tukey’s range test</em> oder aber als <em>Tukey’s test</em>, <em>Tukey method</em>, <em>Tukey’s honest significance test</em> oder eben <em>Tukey’s HSD (honestly significant difference)</em> Test. Dabei steht die Abkürzung HDS für <em>honestly significant difference</em> (deu. <em>ehrlich signifikanter Unterschied</em>). Für mich etwas weit aus dem Fenster gelehnt, aber der Name sagt hier mal was auch wirklich gemacht wird. Im Prinzip stellen wir nur die Formel von den Student t-Test einmal um und benennen alles neu. Dann sieht man auch nicht gleich, was Sache ist und jeder denkt, es wäre was Neues. Wir werden hier aber mal den Tukey HSD Test zerforschen. Wir nutzen aber die ANOVA um einmal die Streuung und die Effekte zu berechnen. Daher nenne ich das ganze hier auch den ANOVA Pfad. Der Tukey HSD Test basiert eben mehr oder minder auf der Ausgabe einer ANOVA. Mehr Informationen gibt es auch im Tutorial <a href="https://rpubs.com/aaronsc32/post-hoc-analysis-tukey">Post-Hoc Analysis with Tukey’s Test</a>. Ach, der Tukey HSD Test ist schon etwas älter und kann nicht so viel wie neuere Implementierungen wie das R Paket <code>{emmeans}</code> und <code>{multcomp}</code>.</p>
<dl>
<dt>Varianzhomogenität</dt>
<dd>
<p>Es ist wichtig zu wissen, dass der Tukey HSD Test auf der ANOVA basiert und die ANOVA nimmt Varianzhomogenität an. Damit meine ich, dass alle Gruppen in der Behandlung die gleiche Varianz haben. Du kannst leider den Tukey HSD Test nur unter der Annahme von varianzhomogenität nutzen. Wenn das dir eine zu starke Annahme ist, dann nutze einfach das R Paket <code>{emmeans}</code>, wie ich es dir weiter unten im Kapitel vorstelle.</p>
</dd>
<dt>Adjustierung für multiple Vergleiche</dt>
<dd>
<p>Der Tukey HSD Test adjustiert für die <span class="math inline">\(\alpha\)</span>-Inflation bei multiplen Vergleichen. Wir müssen da auch nichts weiter machen um die Adjustierung durchzuführe. Das macht die Funktion <code>TukeyHSD()</code> für uns automatisch. Auf der anderen Seite können wir die Adjustierung für multiple Vergleiche aber auch nicht ausschalten. Du erhälst <em>immer</em> adjustierte p-Werte aus einem Tukey HSD Test. Wenn du das nicht möchtest, dann nutze einfach das R Paket <code>{emmeans}</code>, welches du weiter unten findest.</p>
</dd>
<dt>Mögliche multiple Vergleiche</dt>
<dd>
<p>Wir können immer nur alle Gruppen mit allen anderen Gruppen vergleichen. Wir rechnen also einen <em>all pair</em> Vergleich. Wenn du zum Beispiel nur die Behandlungsgruppen zur Kontrolle vergleichen willst, aber nciht untereinander, dann ist das nicht mit dem Tukey HDS Test möglich. Dafür musst du dann das R Paket <code>{ememans}</code> oder für noch komplexere Gruppenvergleiche das R Paket <code>{multcomp}</code> nutzen.</p>
</dd>
<dt>Fallzahl in den einzelnen Behandlungsgruppen</dt>
<dd>
<p>Der Tukey HSD Test geht von einem balancierten Design aus. Daher brauchen wir in allen Behandlungsgruppen die gleiche Anzahl an Beobachtungen. Wenn wir kein balanciertes Design vorliegen haben, dann wird die Fallzahl mehr oder minder über die Gruppen gemittelt. Teilweise funktioniert dann auch der Tukey HSD Test nicht mehr richtig. Daher ist von der Nutzung es Tukey HSD Tests bei ungleich großen Gruppen abzuraten. Auch hier ist dann der Ausweg das R Paket <code>{emmeans}</code>, welches genau für den unblancierten Fall ursprünglich entworfen wurde.</p>
</dd>
</dl>
<p>Schauen wir uns nun einmal an, wie der Tukey HSD Test theoretisch funktioniert und wie die Implmentierugn in R dargestellt ist. Wir haben die Wahl zwischen der Funktion <code>TukeyHSD()</code> und der Funktion <code>HSD.test()</code> aus dem R Paket <code>{agricolae}</code>. Die Funktion <code>HSD.test()</code> liefert auch gleich das <em>Compact letter display</em> in der Ausgabe mit. Sonst sind die beiden Funktionen sehr ähnlich. Oft wird eben der Tukey HSD Test noch verwendet, weil er eben sehr alt ist und somit schon sehr lange verwendet wurde.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false"><code>TukeyHSD()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false"><code>HSD.test()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Zuerst einmal die Formel des Tukey HSD Test. Wir berechnen dabei asl statistische Maßzahl den HSD-Wert, der nichts anderes aussagt als der minimal Mittelwertsunterschied, den wir gegeben der Streuung und der Fallzahl in den Daten als signifikant nachweisen können. Sozusagen der minimalste mögliche signifikante Mittelwertsunterschied.</p>
<p><span class="math display">\[
HSD = q_{\alpha=5\%, k, n-k} \cdot \sqrt{\tfrac{MSE}{n}}
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(HSD\)</span>, den zu berechnenden minimalst möglichen signifikanten Mittelwertsunterschied.</li>
<li><span class="math inline">\(q_{\alpha=5\%, k, n-k}\)</span>, den kritsichen Wert gegeben aus dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5% der Anzahl an zu vergleichenden Gruppen <span class="math inline">\(k\)</span> und einem Freiheitsgrad <span class="math inline">\(n-k\)</span>.</li>
<li><span class="math inline">\(\sqrt{\tfrac{MSE}{n}}\)</span>, der Streuung in den Daten gewichtet für die Fallzahl <span class="math inline">\(n\)</span>. Hier wird die Streuung über alle Gruppen hinweg berechnet.</li>
</ul>
<p>Wir können uns das Ganze auch nochmal in der folgenden Tabelle als Vergleich zu dem Student t-Test anschauen. Hier dann erstmal noch die beiden Formeln.</p>
<p><span class="math display">\[
\begin{array}{c|c}
  HSD = q_{\alpha=5\%, k, n-k} \cdot \sqrt{\tfrac{MSE}{n}} &amp; \bar{y}_1 - \bar{y}_2 =  T_{\alpha=5\%} \cdot s_p\sqrt{\tfrac{2}{n_g}}
\end{array}
\]</span></p>
<p>Ich habe dort einmal die statistischen Maßzahlen aus einem Tukey HDS Test den statistischen Maßzahlen eines Student t-Test in der folgenden Tabelle gegenüber gestellt. Du siehst, dass wir hier eigentlich nur eine Umstellung der t-Test Formel haben.</p>
<div id="tbl-hds-ttest" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hds-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;78.7— Etwas wilder Vergleich vom Tukey HSD Test zum Student t-Test. Im Prinzip ist der Tukey HSD Test nur eine Umsstellung der Formel des Student t-Test.
</figcaption>
<div aria-describedby="tbl-hds-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 23%">
<col style="width: 36%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Tukey HSD Test</th>
<th>Student t-Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Effekt</td>
<td><span class="math inline">\(HSD\)</span></td>
<td><span class="math inline">\(\bar{y}_1 - \bar{y}_2\)</span></td>
</tr>
<tr class="even">
<td>Streuung</td>
<td><span class="math inline">\(\tfrac{MSE}{n}\)</span></td>
<td><span class="math inline">\(s_p\sqrt{\tfrac{2}{n_g}}\)</span></td>
</tr>
<tr class="odd">
<td>Kritischer Wert</td>
<td><span class="math inline">\(q_{\alpha=5\%, k, n-k}\)</span></td>
<td><span class="math inline">\(T_{\alpha=5\%}\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Um die Idee des Tukey HDS Test zusammenzufassen, setzen wir für <span class="math inline">\(q_{\alpha=5\%, k, n-k}\)</span> den Wert ein, den wir mindestens erreichen müssen um einen signifikanten Unterschied nachweisen zu können. Bei dem Student t-Test war es meist <span class="math inline">\(T_{\alpha=5\%}\)</span> gleich <span class="math inline">\(1.96\)</span>, hier ist der Wert für <span class="math inline">\(q_{\alpha=5\%, k, n-k}\)</span> natürlich anders. Dann können wir den minimalen Mittelwertsunterschied mit <span class="math inline">\(\bar{y}_1 - \bar{y}_2\)</span> oder eben <span class="math inline">\(HSD\)</span> berechnen, denn wir mindestens erreichen müssen um einen signifikanten Unetrschied nachweisen zu können. Alle Mittelwertsdifferenzen größer als der <span class="math inline">\(HDS\)</span> Wert werden dann signifikant sein und alle Mittelwertsdifferenzen kleiner als der <span class="math inline">\(HDS\)</span> Wert nicht signifikant sein.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Entscheidung mit dem HDS Wert
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wenn eine Mittelwertsdifferenz <span class="math inline">\(\bar{y}_i - \bar{y}_j\)</span> eines Gruppenvergleiches <em>größer</em> ist als der HDS Wert dann wird die Nullhypothese (H<span class="math inline">\(_0\)</span>) abgelehnt. Ist die Mittelwertsdifferenz <span class="math inline">\(\bar{y}_i - \bar{y}_j\)</span> eines Gruppenvergleiches ist als der HDS Wert dann wird die Nullhypothese (H<span class="math inline">\(_0\)</span>) beibehalten.</p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Im Folgenden wollen wir einmal den Tuley HSD Test nachvollziehen. Dafür hier nochmal die Formel, die wir dann mit den entsprechenden Werten ausfüllen müssen. Wir beginnen mit dem q-Wert und erhalten den MSE Wert aus einer ANOVA.</p>
<p><span class="math display">\[
HSD = q_{\alpha=5\%, k, n-k} \cdot \sqrt{\tfrac{MSE}{n}}
\]</span></p>
<p>Für die semi händische Berechnung des Tukey HSD Test brauchen wir erstmal die Werte für die gesamte Fallzahl in dem Datensatz <span class="math inline">\(N\)</span>, dann noch die Anzahl an Behandlungsgruppen <span class="math inline">\(k\)</span> und abschließend die Fallzahl pro Gruppe <span class="math inline">\(n\)</span>. Ich nutze hier dann den Datensatz <code>fac1_tbl</code> mit der Sprungweite von 21 Flöhen von drei Tierrassen mit jeweils sieben Beobachtungen pro Gruppe. Dann geben wir das Ganze einmal bei R ein.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">21</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">21</span> <span class="sc">/</span> <span class="dv">3</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die Funktion <code>qtukey()</code> gibt uns den q-Wert anhand des Signifikanzniveaus <span class="math inline">\(1 - \alpha\)</span> sowie der Anzahl an Gruppen <span class="math inline">\(k\)</span> und der dem Freiheitsgrad <span class="math inline">\(N-k\)</span> wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtukey</span>(<span class="at">p =</span> <span class="fl">0.95</span>, <span class="at">nmeans =</span> k, <span class="at">df =</span> N <span class="sc">-</span> k)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.609304</code></pre>
</div>
</div>
<p>Dann brauchen wir noch den Wert für die Streuung <span class="math inline">\(MSE\)</span>. Den MSE Wert könnten wir auch händisch berechnen, aber normalerweise nutzen wir auch die ANOVA um an den Wert zu gelangen. Daher hier einmal die ANOVA und wir lesen den Wert für MSE in der Ergebnistabelle ab.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
animal       2  74.68   37.34   11.89 0.000511 ***
Residuals   18  56.53    3.14                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Nun wissen wir den Wert für <span class="math inline">\(MSE\)</span> mit <span class="math inline">\(3.14\)</span> aus der Tabelle der einfaktoriellen ANOVA. Dann können wir auch schon den HSD Wert anhand der Formel berechnen in dem wir die Werte einsetzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>hsd <span class="ot">&lt;-</span> <span class="fl">3.61</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fl">3.14</span> <span class="sc">/</span> <span class="dv">7</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>hsd</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.417815</code></pre>
</div>
</div>
<p>Am Ende müssen wir dann die Mittelwertsdifferenzen unserer Tierarten mit dem HDS Wert vergleichen. Dafür ahbe ich einmal die folgende Tabelle aufgebaut. Wichtig ist hier, dass wir mit den Beträgen der Mittelwertsdifferenz rechnen, sonst macht der Vergleich zum HDS Wert keinen Sinn. Wir erhalten also zwei signifikante Vergleiche. Die Sprungweiten der Katzenflöhe unterscheiden sich von den Sprungweiten der Fuchs- und Hundeflöhe.</p>
<div id="tbl-hds-ttest-händisch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hds-ttest-händisch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;78.8— Händische Testentscheidung anhand des berechneten HDS Wert und den Mittelwertsdifferenzen der drei Tierarten. Wenn eine Mittelwertsdifferenz größer ist als der HDS Wert, dann liegt ein signifikanter Unterschied vor.
</figcaption>
<div aria-describedby="tbl-hds-ttest-händisch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Vergleich</th>
<th>Mittelwertsdifferenz</th>
<th>HDS Testentscheidung</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>cat-dog</td>
<td><span class="math inline">\(4.74 - 8.13 = -3.39\)</span></td>
<td><span class="math inline">\(\mid-3.39\mid\; \geq 2.42 \rightarrow \mbox{signifikant}\)</span></td>
</tr>
<tr class="even">
<td>fox-dog</td>
<td><span class="math inline">\(9.16 - 8.13 = \phantom{-}1.03\)</span></td>
<td><span class="math inline">\(\mid1.03\mid\; \geq 2.42 \rightarrow \mbox{nicht signifikant}\)</span></td>
</tr>
<tr class="odd">
<td>fox-cat</td>
<td><span class="math inline">\(9.16 - 4.74 = \phantom{-}4.42\)</span></td>
<td><span class="math inline">\(\mid4.42\mid\; \geq 2.42 \rightarrow \mbox{signifikant}\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Am Ende willst du das natürlich nicht händische machen sondern wir nutzen die Funktionen in R um uns die Testentscheidung auch mit einem p-Wert berechnen zu lassen. Ganz wichtig hier nochmal, wir glauben daran, dass die Varianz in allen drei Tierarten gleich ist. Wir haben Varianzhomogenität vorliegen.</p>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>Die Standardfunktion für den Tukey HDS Test ist <code>TukeyHSD()</code>. Wir können den Tukey HSD Test mit nur einem Faktor oder zwei Faktoren rechnen. Ich stelle hier die einfaktorielle sowie zweifaktorielle Analyse einmal vor. Am Ende zeige ich dann nochmal, wie du das <em>Compact letter display</em> erhälst. Hier müssen wir noch ein zusätzliches Paket nutzen. Die Funktion <code>HSD.test()</code> aus dem Paket <code>{agricolae}</code>, die du im nächsten Tab findest, gibt dir sofort das <em>Compact letter display</em> wieder. Der Ablauf ist aber in beiden Fällen der gleiche. Wir rechnen erst eine ANOVA mit der Funktion <code>aov()</code> um dann den Tukey HSD Test zu rechnen.</p>
<section id="einfaktorielle-analyse-1" class="level3" data-number="78.6.1">
<h3 data-number="78.6.1" class="anchored" data-anchor-id="einfaktorielle-analyse-1"><span class="header-section-number">78.6.1</span> Einfaktorielle Analyse</h3>
<p>Am Anfang rechnen wir erst eine einfaktorielle ANOVA mit der Funktion <code>aov()</code>. Wir erhalten dann alle notwendigen Informationen in dem Ausgabeobjekt für die Berechnung des Tukey HSD Test. Darüber hinaus können wir auch auch gleich schauen, ob unsere Bahendlung überhaupt einen signifkanten Einfluss auf unser Outcome der Sprunglänge hat.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
animal       2  74.68   37.34   11.89 0.000511 ***
Residuals   18  56.53    3.14                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>An dem p-Wert sehen wir, dass wir einen signifikanten Effekt der Tierart <code>animal</code> auf die Sprunglänge der Flöhe vorliegen haben. Wir können jetzt einen Tukey HSD Test rechnen um rauszufinden welche der drei Tierarten sich unterscheiden. Wir erhalten dann als Ausgabe die Mittlwertsdifferenzen zusammen mit den 95% Konfidenzintervallen und den adjustierten p-Werten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(fac1_av)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = jump_length ~ animal, data = fac1_tbl)

$animal
             diff       lwr        upr     p adj
cat-dog -3.385714 -5.803246 -0.9681827 0.0058404
fox-dog  1.028571 -1.388960  3.4461031 0.5346652
fox-cat  4.414286  1.996754  6.8318173 0.0005441</code></pre>
</div>
</div>
<p>Du erhälst immer adjustierte p-Werte aus einem Tukey HSD Test. Das muss dir klar sein. Die p-Werte kannst du dann mit dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% vergleichen. Wir sehen dass sich die Sprungweiten der Katzenflöhe von den Sprungweiten der Fuchs- und Hundeflöhe signifikant unterscheiden.</p>
<p>Dann kannst du noch die Funktion <code>mulcompLetters()</code> aus dem R Paket <code>{mulcompView}</code> nutzen um dir das <em>Compact letter display</em> wiedergeben zu lassen. Das <em>Compact letter display</em> kannst du dann entsprechend zu deinen Barplots ergänzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">multcompLetters</span>(<span class="fu">extract_p</span>(tukey_fac1_obj<span class="sc">$</span>animal))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>cat fox dog 
"a" "b" "b" </code></pre>
</div>
</div>
<p>Auch hier sei angemerkt, dass du dan schauen muss, ob das <em>Compact letter display</em> zu deinen Daten passt. Sind die Mittelwerte wirklich unterschiedlich? Kannst du die Unetrschiede in den Barplots erkennen? Wenn das der Fall ist, dann spricht nichts gegen die Verwendung des Tukey HSD Test.</p>
</section>
<section id="zweifaktorielle-analyse-1" class="level3" data-number="78.6.2">
<h3 data-number="78.6.2" class="anchored" data-anchor-id="zweifaktorielle-analyse-1"><span class="header-section-number">78.6.2</span> Zweifaktorielle Analyse</h3>
<p>Jetzt können wir die Sache etwas kürzer machen, da wir auch in einem zweifaktoriellen Fall den gleichen Weg wie im einfaktoriellen Fall durchgehen. Wir rechnen erst eine ANOVA mit den beiden Faktoren und dem Interaktinsterm, dargestellt durch den Doppelpunkt zwischen den beiden Faktoren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>fac2_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac2_av)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
animal       2 171.13   85.56  25.745 1.41e-08 ***
site         1   4.21    4.21   1.268  0.26516    
animal:site  2  59.10   29.55   8.891  0.00046 ***
Residuals   54 179.47    3.32                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>In diesem Fall finden wir eine signifikante Interaktion. Daher verhalten sich die Tierarten <code>animal</code> in den beiden Messorten in dem Faktor <code>site</code> nicht gleich. Die Interaktion kanst du auch in der Visualisierung der Daten in der <a href="#fig-boxplot-emmeans-fac2" class="quarto-xref">Abbildung&nbsp;<span>78.3</span></a> sehen. Für die Füchse ändert sich die Sprungweite von <code>city</code> zu <code>village</code>. Bei Hunden- und Katzenflöhen springen in der Tendenz Dorfflöhe weiter als Stadtflöhe. Wir nutzen jetzt das Modell einmal in der Funktion <code>TukeyHSD()</code> um uns einmal einen Tukey HSD TEst berechnen zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>tukey_fac2_obj <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(fac2_av)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>tukey_fac2_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = jump_length ~ animal + site + animal:site, data = fac2_tbl)

$animal
          diff       lwr      upr     p adj
dog-cat 2.2085 0.8191476 3.597852 0.0009626
fox-cat 4.1335 2.7441476 5.522852 0.0000000
fox-dog 1.9250 0.5356476 3.314352 0.0042936

$site
              diff       lwr      upr     p adj
village-city -0.53 -1.473715 0.413715 0.2651614

$`animal:site`
                          diff        lwr        upr     p adj
dog:city-cat:city        3.101  0.6922358  5.5097642 0.0046806
fox:city-cat:city        6.538  4.1292358  8.9467642 0.0000000
cat:village-cat:city     1.668 -0.7407642  4.0767642 0.3308895
dog:village-cat:city     2.984  0.5752358  5.3927642 0.0072069
fox:village-cat:city     3.397  0.9882358  5.8057642 0.0015002
fox:city-dog:city        3.437  1.0282358  5.8457642 0.0012805
cat:village-dog:city    -1.433 -3.8417642  0.9757642 0.5010180
dog:village-dog:city    -0.117 -2.5257642  2.2917642 0.9999910
fox:village-dog:city     0.296 -2.1127642  2.7047642 0.9991270
cat:village-fox:city    -4.870 -7.2787642 -2.4612358 0.0000027
dog:village-fox:city    -3.554 -5.9627642 -1.1452358 0.0008014
fox:village-fox:city    -3.141 -5.5497642 -0.7322358 0.0040284
dog:village-cat:village  1.316 -1.0927642  3.7247642 0.5930304
fox:village-cat:village  1.729 -0.6797642  4.1377642 0.2923986
fox:village-dog:village  0.413 -1.9957642  2.8217642 0.9957142</code></pre>
</div>
</div>
<p>Wie du an der sehr langen Ausgabe sehen kannst, erhalten wir erstmal die Informationen zu der Tierart, dort sehen wir dann, dass sich alle drei Sprungweiten der Tierarten voneinander unterscheiden. Dann erhalten wir die Information über den Ort oder eben den zweiten Faktor. Am Ende nochmal sehr detailiert alle Interaktionen aufgeschlüsselt. Leider ist die Tabelle dann sehr schlecht zu lesen, aber hier siehst du dann welche Faktorkombination dann signifikant ist. Wenn du eine signifikante Interaktion vorliegen hast, dann kannst du keine <em>pauschale</em> Aussage über die Sprungweiten der Tierarten machen. Es kommt eben immer drauf an, welches Level du im zweiten Faktor betarchtest.</p>
<p>Am Ende wollen wir dann doch noch das <em>Compact letter display</em> haben. Ich wähle hier einmal die Gruppe der Tierarten aus. Du kannst das auch für die anderen Faktoren machen, aber hier einmal zur Demonstration. Wir sehen, dass sich alle Tierarten in der Sprungweiet unterscheiden, keine Tierart hat den gleichen Buchstaben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">multcompLetters</span>(<span class="fu">extract_p</span>(tukey_fac2_obj<span class="sc">$</span>animal))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>dog fox cat 
"a" "b" "c" </code></pre>
</div>
</div>
<p>Hier nochmal Achtung, die Interaktion wird natürlich nicht berücksichtigt. Im Zweifel dann doch lieber <code>{emmeans}</code> nutzen und nochmal bei mir nachfragen. Allgemeine Aussagen zur Interaktion kann ich immer schwer treffen, es hängt sehr von der wissenschaftlichen Fragestellung und den Daten ab.</p>
</section>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Funktion <code>HSD.test()</code> kann nur ein einfaktorielles Modell rechnen und <em>ignoriert</em> weitere Faktoren oder Interaktionsterme im <code>aov()</code> Modell. Du erhälst zwar immer eine Ausgabe, aber nur als einfaktorielle Analyse. Unabhängig von dem Modell was du in die Funktion <code>HSD.test()</code> reinsteckst! Und ohne weitere Warnung.</p>
</div>
</div>
<p>Eine zweite Variante den Tukey HSD Test in R durchzuführen ist die Funktion <code>HSD.test()</code> aus dem R Paket <code>{agricolae}</code>. Persönlich entwickle ich so langsam eine Aversion gegen das Paket, da ich selten eine so rundimentäre und lustlose Hilfe für die Funktion gesehen habe wie in <code>{agricolae}</code>. Prinzipiell haben wir die gleichen Möglichkeiten wie auch mit dem Tukey HSD Test für ein einfaktorielles Versuchsdesign. Wir nutzen auch erste eine ANOVA um uns alle wichtigen statistischen Maßzahlen berechnen zu lassen und dann können wir mit denen den Tukey HSD Test durchführen. Leider erhalten wir <em>keine</em> p-Werte. Was auch irgendwie irre ist. Dafür dann aber das <em>Compact letter display</em> ohne einen weiteren Schritt.</p>
<section id="einfaktorielle-analyse-2" class="level3" data-number="78.6.3">
<h3 data-number="78.6.3" class="anchored" data-anchor-id="einfaktorielle-analyse-2"><span class="header-section-number">78.6.3</span> Einfaktorielle Analyse</h3>
<p>Am Anfang rechnen wir auch hier eine einfaktorielle ANOVA mit der Funktion <code>aov()</code>. Wir erhalten dann alle notwendigen Informationen in dem Ausgabeobjekt für die Berechnung des Tukey HSD Test. Darüber hinaus können wir auch auch gleich schauen, ob unsere Bahendlung überhaupt einen signifkanten Einfluss auf unser Outcome der Sprunglänge hat.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
animal       2  74.68   37.34   11.89 0.000511 ***
Residuals   18  56.53    3.14                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>An dem p-Wert sehen wir, dass wir einen signifikanten Effekt der Tierart <code>animal</code> auf die Sprunglänge der Flöhe vorliegen haben. Wir können jetzt einen Tukey HSD Test rechnen um rauszufinden welche der drei Tierarten sich unterscheiden. Wir erhalten dann als Ausgabe die Mittlwerte ohne p-Werte und müssten uns sogar die Mittelwertsdifferenzen selber berechnen. Keine Ahnung was das soll. Dafür dann aber das <em>Compact letter display</em>, was ja auch irgendwie reicht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(fac1_av, <span class="at">trt =</span> <span class="st">'animal'</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
   MSerror Df     Mean       CV      MSD
  3.140476 18 7.342857 24.13419 2.417532

$parameters
   test name.t ntr StudentizedRange alpha
  Tukey animal   3         3.609304  0.05

$means
    jump_length      std r        se Min  Max  Q25 Q50   Q75
cat    4.742857 1.901628 7 0.6698055 2.2  7.9 3.65 4.3  5.75
dog    8.128571 2.144539 7 0.6698055 5.6 11.8 6.65 8.2  9.00
fox    9.157143 1.098267 7 0.6698055 7.7 10.6 8.35 9.1 10.00

$comparison
NULL

$groups
    jump_length groups
fox    9.157143      a
dog    8.128571      a
cat    4.742857      b

attr(,"class")
[1] "group"</code></pre>
</div>
</div>
<p>Wenn du keinen p-Werte haben möchtest sondern nur das <em>Compact letter display</em>, dann macht es dir die Funktion <code>HSD.test()</code> etwas leichter. Dann brauchst du dir nicht nochmal eine Funktion zusätzlich laden. Wenn du p-Werte brauchst, dann stehst du hier im Regen. Dann nutze bitte die Funktion <code>TukesHSD()</code> im vorherigen Tab.</p>
</section>
<section id="zweifaktorielle-analyse-2" class="level3" data-number="78.6.4">
<h3 data-number="78.6.4" class="anchored" data-anchor-id="zweifaktorielle-analyse-2"><span class="header-section-number">78.6.4</span> Zweifaktorielle Analyse</h3>
<p>Eine zweifaktorielle Analyse ist in der Funktion <code>HSD.test()</code> nicht möglich. Ein zweifaktorielles Modell wird wie ein einfaktorielles Modell behandelt und damit der zweite Faktor sowie der Interaktionsterm von der Funktion <code>HSD.test()</code> ignoriert. Du erhälst keine Warnung sondern eben das Ergebnis einer einfaktoriellen Analyse wiedergeben. Ich bin immer noch sprachlos was das soll.</p>
</section>
</div>
</div>
</div>
</section>
<section id="weitere-pfade" class="level2" data-number="78.7">
<h2 data-number="78.7" class="anchored" data-anchor-id="weitere-pfade"><span class="header-section-number">78.7</span> Weitere Pfade</h2>
<section id="paarweise-tests" class="level3" data-number="78.7.1">
<h3 data-number="78.7.1" class="anchored" data-anchor-id="paarweise-tests"><span class="header-section-number">78.7.1</span> Paarweise Tests</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">pool.sd =</span> <span class="cn">FALSE</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with non-pooled SD 

data:  fac1_tbl$jump_length and fac1_tbl$animal 

    dog    cat   
cat 0.0267 -     
fox 0.8642 0.0012

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum exact test 

data:  fac1_tbl$jump_length and fac1_tbl$animal 

    dog    cat   
cat 0.0332 -     
fox 0.8307 0.0035

P value adjustment method: bonferroni </code></pre>
</div>
</div>
</section>
<section id="games-howell-test" class="level3" data-number="78.7.2">
<h3 data-number="78.7.2" class="anchored" data-anchor-id="games-howell-test"><span class="header-section-number">78.7.2</span> Games Howell Test</h3>
<p><a href="https://rpubs.com/aaronsc32/games-howell-test">Games-Howell Post-Hoc Test</a></p>
<blockquote class="blockquote">
<p>“However, the smaller the number of samples in each group, the [Games Howell Post-hoc Tests] is more tolerant to the type I error control. Thus, this method can be applied when the number of samples is six or more.” — <a href="https://rpkgs.datanovia.com/rstatix/reference/games_howell_test.html">Games Howell Post-hoc Tests in <code>{rstatix}</code></a></p>
</blockquote>
<p>Der Games-Howell-Test ist eine Alternative zu dem Paket <code>{multcomp}</code> und dem Paket <code>{emmeans}</code> für ein einfaktorielles Design. Wir nutzen den Games-Howell-Test, wenn die Annahme der Homogenität der Varianzen, der zum Vergleich aller möglichen Kombinationen von Gruppenunterschieden verwendet wird, verletzt ist. Dieser Post-Hoc-Test liefert Konfidenzintervalle für die Unterschiede zwischen den Gruppenmitteln und zeigt, ob die Unterschiede statistisch signifikant sind. Der Test basiert auf der Welch’schen Freiheitsgradkorrektur und adjustiert die <span class="math inline">\(p\)</span>-Werte. Der Test vergleicht also die Differenz zwischen den einzelnen Mittelwertpaaren mit einer Adjustierung für den Mehrfachtest. Es besteht also keine Notwendigkeit, zusätzliche p-Wert-Korrekturen vorzunehmen. Mit dem Games-Howell-Test ist nur ein <em>all-pair</em> Vergleich möglich.</p>
<p>Für den Games-Howell-Test aus dem Paket <code>{rstatix}</code> müssen wir kein lineares Modell fitten. Wir schreiben einfach die wie in einem t-Test das Outcome und den Faktor mit den Gruppenleveln in die Funktion <code>games_howell_test()</code>. Wir erhalten dann direkt das Ergebnis des Games-Howell-Test. Wir nutzen in diesem Beispiel die Daten aus dem Objekt <code>fac1_tbl</code> zu sehen in <a href="stat-tests-posthoc.html#tbl-data-posthoc-1" class="quarto-xref">Tabelle&nbsp;<span>40.1</span></a>.</p>
<p>Wir wollen aber nicht mit der Ausgabe arbeiten sondern machen uns noch ein wenig Arbeit und passen die Ausgabe an. Zum einen brauchen wir noch die Kontraste und wir wollen die <span class="math inline">\(p\)</span>-Werte auch ansprechend formatieren. Wir erhalten das Objekt <code>res_4_obj</code> und geben uns die Ausgabe wieder.</p>
<p>Wir erhalten ein <code>tibble()</code> mit fünf Spalten. Zum einen den <code>contrast</code>, der den Vergleich widerspiegelt, den haben wir uns selber mit der Funktion <code>mutate()</code> und <code>str_c()</code> aus den Spalten <code>group1</code> und <code>group2</code> gebaut. Wir vergleichen im ersten Kontrast die Katzen- mit den Hundeflöhen, wobei wir <code>dog-cat</code> rechnen. Also wirklich den Mittelwert der Sprungweite der Hundeflöhe <em>minus</em> den Mittelwert der Sprungweite der Katzenflöhe rechnen. In der Spalte <code>estimate</code> sehen wir den Mittelwertsunterschied. Der Mittelwertsunterschied ist in der <em>Richtung</em> nicht ohne den Kontrast zu interpretieren. Danach erhalten wir die adjustierten <span class="math inline">\(p\)</span>-Wert sowie die simultanen 95% Konfidenzintervalle.</p>
<p>Wir können die Nullhypothese ablehnen für den Vergleiche <code>dog - cat</code> mit einem p-Wert von <span class="math inline">\(0.02\)</span> sowie für den Vergleich <span class="math inline">\(cat - fox\)</span> mit einem p-Wert von <span class="math inline">\(0.00\)</span>. Beide p-Werte liegen unter dem Signifikanzniveau von <span class="math inline">\(\alpha\)</span> gleich 5%.</p>
<section id="einfaktorielle-analyse-3" class="level4" data-number="78.7.2.1">
<h4 data-number="78.7.2.1" class="anchored" data-anchor-id="einfaktorielle-analyse-3"><span class="header-section-number">78.7.2.1</span> Einfaktorielle Analyse</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>ght_fac1_obj <span class="ot">&lt;-</span> <span class="fu">games_howell_test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">p-Werte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false"><em>Compact letter display</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">95% Konfidenzintervall</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>ght_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">pvalue</span>(p.adj))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 8
  .y.         group1 group2 estimate conf.low conf.high p.adj p.adj.signif
  &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       
1 jump_length dog    cat       -3.39    -6.28    -0.490 0.022 *           
2 jump_length dog    fox        1.03    -1.52     3.57  0.521 ns          
3 jump_length cat    fox        4.41     2.12     6.71  0.001 ***         </code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>ght_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2)) <span class="sc">|&gt;</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p.adj, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>dog cat fox 
"a" "b" "a" </code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p>In <a href="#fig-ght-1" class="quarto-xref">Abbildung&nbsp;<span>78.16</span></a> sind die simultanen 95% Konfidenzintervalle nochmal in einem <code>ggplot</code> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>ght_fac1_ci_obj <span class="ot">&lt;-</span> ght_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ght_fac1_ci_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high)) <span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ght-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ght-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ght-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Abbildung&nbsp;78.16— Die 95% Konfidenzintervalle für den allpair-Vergleich des Games-Howell-Test."><img src="stat-tests-posthoc2_files/figure-html/fig-ght-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ght-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.16— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des Games-Howell-Test.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Entscheidungen nach den 95% Konfidenzintervallen sind die gleichen wie nach dem <span class="math inline">\(p\)</span>-Wert. Da wir hier es mit einem Mittelwertsvergleich zu tun haben, ist die Entscheidung gegen die Nullhypothese zu treffen wenn die 0 im Konfidenzintervall ist.</p>
</div>
</div>
</div>
</section>
<section id="zweifaktorielle-analyse-3" class="level4" data-number="78.7.2.2">
<h4 data-number="78.7.2.2" class="anchored" data-anchor-id="zweifaktorielle-analyse-3"><span class="header-section-number">78.7.2.2</span> Zweifaktorielle Analyse</h4>
<p>Nur getrennt über die beiden Faktoren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>ght_fac2_obj <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site) <span class="sc">|&gt;</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">games_howell_test</span>(jump_length <span class="sc">~</span> animal) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">p-Werte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false"><em>Compact letter display</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">95% Konfidenzintervall</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>ght_fac2_obj <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">pvalue</span>(p.adj))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  site    .y.       group1 group2 estimate conf.low conf.high p.adj p.adj.signif
  &lt;fct&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       
1 city    jump_len… cat    dog       3.10     0.725      5.48 0.010 **          
2 city    jump_len… cat    fox       6.54     4.73       8.35 &lt;0.0… ****        
3 city    jump_len… dog    fox       3.44     1.33       5.55 0.002 **          
4 village jump_len… cat    dog       1.32    -0.882      3.51 0.290 ns          
5 village jump_len… cat    fox       1.73    -0.645      4.10 0.178 ns          
6 village jump_len… dog    fox       0.413   -1.31       2.14 0.813 ns          </code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>ght_fac2_obj <span class="sc">|&gt;</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2)) <span class="sc">|&gt;</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(<span class="sc">~</span> site) <span class="sc">|&gt;</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(pull, p.adj, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span><span class="fu">multcompLetters</span>(.x)<span class="sc">$</span>Letters) <span class="sc">|&gt;</span> </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"site"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  site    cat   dog   fox  
  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1 city    a     b     c    
2 village a     a     a    </code></pre>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>In <a href="#fig-ght-1" class="quarto-xref">Abbildung&nbsp;<span>78.16</span></a> sind die simultanen 95% Konfidenzintervalle nochmal in einem <code>ggplot</code> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>ght_fac2_ci_obj <span class="ot">&lt;-</span> ght_fac2_obj <span class="sc">|&gt;</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ght_fac2_ci_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high,</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> site, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ght-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ght-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-ght-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Abbildung&nbsp;78.17— Die 95% Konfidenzintervalle für den allpair-Vergleich des Games-Howell-Test."><img src="stat-tests-posthoc2_files/figure-html/fig-ght-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ght-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.17— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des Games-Howell-Test.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Entscheidungen nach den 95% Konfidenzintervallen sind die gleichen wie nach dem <span class="math inline">\(p\)</span>-Wert. Da wir hier es mit einem Mittelwertsvergleich zu tun haben, ist die Entscheidung gegen die Nullhypothese zu treffen wenn die 0 im Konfidenzintervall ist.</p>
</div>
</div>
</div>
</section>
</section>
<section id="r-paket-multcomp" class="level3" data-number="78.7.3">
<h3 data-number="78.7.3" class="anchored" data-anchor-id="r-paket-multcomp"><span class="header-section-number">78.7.3</span> R Paket <code>{multcomp}</code></h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">p-Werte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false"><em>Compact letter display</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">95% Konfidenzintervall</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">

</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">

</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">

</div>
</div>
</div>
</section>
<section id="r-paket-nparcomp" class="level3" data-number="78.7.4">
<h3 data-number="78.7.4" class="anchored" data-anchor-id="r-paket-nparcomp"><span class="header-section-number">78.7.4</span> R Paket <code>{nparcomp}</code></h3>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Das Paket <code>{nparcomp}</code> kann nur ein einfaktorielles Modell rechnen. Dafür brauchst du kein normalverteiltes <span class="math inline">\(y\)</span> in deinen Daten. Darüber hinaus ist die Interpretation des Effekts biologisch nicht möglich. Jedenfalls nicht im klassichen Sinne einer Relevanzbetrachtung auf der Einheit der Messwerte deines <span class="math inline">\(y\)</span>. Das <em>Compact letter display</em> kannst du aber problemlos nutzen.</p>
</div>
</div>
<p>Das R Paket <code>{nparcomp}</code> wird gerne genutzt, wenn du ein nicht normalverteiltes Outcome <span class="math inline">\(y\)</span> vorliegen hast und nur eine Behandlung <span class="math inline">\(x\)</span>. Dieser Fall kommt sehr oft in der Zellbiologie vor oder aber allgemein in den Humanwissenschaften. Teilweise dann auch in Mausmodellen, wo wir dann nur drei bis vier Behandlungen vorliegen haben und diese dann zu einer Kontrolle vergleichen. Dafür ist das R Paket <code>{nparcomp}</code> nützlich. Aber auch nur, wenn du an p-Werten und vielleicht noch dem <em>Compact letter display</em> interessiert bist. Alles andere ist dann nicht sinnvoll abbildbar.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01_small.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="images/angel_01_small.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Hier einmal kurz der niedergeschlagende Engel. In diesem Abschnitt zu <code>{nparcomp}</code> werde ich ein paar Engel der Statistik niedergeschlagen und dann noch überfahren. Ich lasse aus Gründen der Didaktik ein paar Sachen weg und dadurch wird einiges leider dann <em>mathematisch</em> unkorrekt. Ich kann damit leben und nehme es auf mich damit du deine Abschlussarbeit fertig bekommst. Somit sind alle Abbildungen eher Näherungen als mathematisch korrekt.</p>
</blockquote>
</div>
</div>
</div>
<p>Das R Paket <code>{nparcomp}</code> hat viele Stärken. In den meisten praktischen Situationen ist die Verteilung der gemessenen Daten <span class="math inline">\(Y\)</span> unbekannt. Dann kann es auch sein, dass du eine Reihe von atypischen Messungen und Ausreißern vorliegen hast. Mit dem R Paket <code>{nparcomp}</code> hast fast keine Annahmen an die Daten, so dass du hier sehr flexibel bist. Einzig die Verteilungen der Gruppen müssen ähnlich sein. Das ist aber in einem in sich geschlossenen Experiment eigentlich immer der Fall.</p>
<p>Betrachten wir also einmal die Funktionsweise von <code>{nparcomp}</code> an einem simplen Beispiel. Ich gehe hier nicht auf die tiefen der Berechnung ein, sondern wir wollen einmal verstehen, was die Ausgabe con <code>{naparcomp}</code> uns sagen will. Da das Verfahren nicht auf den klassischen statistischen Maßzahlen wie Mittelwert und Standardabweichung beruht ist die Ausgabe nicht ganz so einfach zu verstehen. In der folgenden Tabelle siehst du einmal die Ausgabe der Funktion <code>npar.t.test()</code> in der ich nur die Sprungweiten der Hunde- und Katzenflöhe miteinander vergleichen habe.</p>
<div class="cell">
<div id="tbl-nparcomp-res" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nparcomp-res-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;78.9— Ergebnis der Funktion <code>npar.t.test()</code> für den paarweisen Vergleichs von der Sprunglänge in [cm] von Hunde- und Kartzenflöhen. Die Fuchsflöhe wurden einmal entfernt um nur einen paarweisen Vergleich zu rechnen.
</figcaption>
<div aria-describedby="tbl-nparcomp-res-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Effect</th>
<th style="text-align: center;">Estimator</th>
<th style="text-align: center;">Lower</th>
<th style="text-align: center;">Upper</th>
<th style="text-align: center;">T</th>
<th style="text-align: center;">p.Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">p(dog,cat)</td>
<td style="text-align: center;">0.102</td>
<td style="text-align: center;">-0.085</td>
<td style="text-align: center;">0.289</td>
<td style="text-align: center;">-4.684</td>
<td style="text-align: center;">0.001</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Wir wissen anhand der Ausgabe von <code>npar.t.test()</code>, dass wir einen signifikanten Unterschied zwischen den Sprungweiten der Hunde- und Katzenflöhe vorliegen haben. Der p-Wert <span class="math inline">\(0.001\)</span> ist kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%. Aber wie groß ist jetzt der Unterschied oder anders gefragt, was ist der berechnete Effekt? Das R Paket <code>{nparcomp}</code> berechnet hierbei den relativen Effekt <span class="math inline">\(p(a,b)\)</span>. Das heißt wiederum, dass wir die Einheit der Sprungweite verlieren und nur eine Wahrscheinlichkeit wiedergeben bekommen.</p>
<dl>
<dt>Was sagt der relative Effekt <span class="math inline">\(\boldsymbol{p(a,b)}\)</span> aus?</dt>
<dd>
<p>Wenn der relative Effekt <span class="math inline">\(p(a,b)\)</span> größer ist als <span class="math inline">\(1/2\)</span>, dann tendiert die Gruppe <span class="math inline">\(b\)</span> dazu größer zu sein als die Gruppe <span class="math inline">\(a\)</span>. Oder etwas anders formuliert. Wenn wir einen relativen Effekt größer als <span class="math inline">\(1/2\)</span> vorliegen haben, dann spricht der relative Effekt für größere Mittelwerte in der Gruppe <span class="math inline">\(b\)</span> im Vergleich zur Gruppe <span class="math inline">\(a\)</span>. Wir können dann sagen, dass <span class="math inline">\(\bar{y}_b &gt; \bar{y}_a\)</span> ist. Oder dur schreibst statt <span class="math inline">\(p(a,b)\)</span> eben <span class="math inline">\(p(b &gt; a)\)</span>. Ja, ist etwas schief…aber wir leben damit.</p>
</dd>
</dl>
<p>Betrachten wir einmal die Darstellung der beiden Verteilungen der Sprungweiten für die Hunde- und Katzenflöhe. Die Katzenflöhe haben einen niedrigeren Mittelwert mit <span class="math inline">\(\\bar{y}_{cat} = 4.74\)</span> und springen nicht so weit wie die Hundeflöhe mit einem hören Mittelwert von <span class="math inline">\(\\bar{y}_{dog} = 8.13\)</span>. Wir erhalten einen relativen Effekt <span class="math inline">\(p_{(dog, cat)}\)</span> von <span class="math inline">\(0.102\)</span>. Was sagt uns nun der Wert aus? In der folgenden Abbidlung ahbe ich dir einmal den Zusammenhang visualisert. Die eingefärbte Fläche ist die Wahrscheinlichkeit <span class="math inline">\(p_{(dog, cat)}\)</span> von <span class="math inline">\(0.102\)</span> zufällig größere Sprungweiten von Katzenflöhen als von Hundeflöhen zu beobachten. Da die Katzenflöhe ja <em>nicht</em> weiter als die Hundeflöhe springen, ist die Wahrscheinlichkeit <span class="math inline">\(p_{(dog, cat)}\)</span> klein.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-nparcomp-dog-cat" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nparcomp-dog-cat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-nparcomp-dog-cat-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Abbildung&nbsp;78.18— Darstellung der Verteilung der Sprungweiten der Hunde- und Katzenflöhe mit 8.13 \pm 2.14cm für die Hundeflöhe und 4.74 \pm 1.9cm für die Katzenflöhe. Wir gehen hier von einer normalverteilten Sprungweite aus. Wir erhalten einen relativen Effekt p_{(dog, cat)} von 0.102. Die Wahrscheinlichkeit p_{(dog, cat)} beschreibt zufällig größere Werte für \bar{y}_cat als für \bar{y}_dog zu beobachten. Die eingefärbten Flächen dienen als Veranschaulichung. [Zum Vergrößern anklicken]"><img src="stat-tests-posthoc2_files/figure-html/fig-nparcomp-dog-cat-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nparcomp-dog-cat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.18— Darstellung der Verteilung der Sprungweiten der Hunde- und Katzenflöhe mit <span class="math inline">\(8.13 \pm 2.14cm\)</span> für die Hundeflöhe und <span class="math inline">\(4.74 \pm 1.9cm\)</span> für die Katzenflöhe. Wir gehen hier von einer normalverteilten Sprungweite aus. Wir erhalten einen relativen Effekt <span class="math inline">\(p_{(dog, cat)}\)</span> von <span class="math inline">\(0.102\)</span>. Die Wahrscheinlichkeit <span class="math inline">\(p_{(dog, cat)}\)</span> beschreibt zufällig größere Werte für <span class="math inline">\(\bar{y}_cat\)</span> als für <span class="math inline">\(\bar{y}_dog\)</span> zu beobachten. Die eingefärbten Flächen dienen als Veranschaulichung. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir können uns nun die Sachlage auch einmal für alle drei Fälle visualisieren. Daher wir schauen uns an, wie sehen die unterscheidlichen relativen Effektschätzer aus? Zum einen kann ja der Wert des relativen Effekts <span class="math inline">\(p(a,b)\)</span> klein sein und daher eher nahe Null. Damit spricht der relative Effekt dafür das <span class="math inline">\(a\)</span> kleiner ist als <span class="math inline">\(b\)</span>. Oder der Wert von <span class="math inline">\(p(a,b)\)</span> ist 0.5, dann ist <span class="math inline">\(a\)</span> vermutlich gleich <span class="math inline">\(b\)</span>. Im letzte Fall kann <span class="math inline">\(p(a,b)\)</span> nahe Eins sein, dann spricht es für größere Werte in <span class="math inline">\(b\)</span> als in <span class="math inline">\(a\)</span>. Ich kann mit den Zusammenhang besser als eingefärbte Flächen merken, daher habe ich dir nochmal den relativen Effektschätzer etwas anders dargestellt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-normal-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-normal-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-normal-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Abbildung&nbsp;78.19— Darstellung verschiedener relativer Effekte p(a,b) für zwei Gruppen und einem normalverteilten Outcome y. Die eingefärbten Flächen dienen als Veranschaulichung. Die Flächen stellt die Wahrscheinlichkeit p(a,b) als relativen Effekt dar. (A) Die Gruppe A hat mit \bar{y}_A einen größeren Mittelwert als die Gruppe B mit \bar{y}_B. Damit ist p(A,B) aproximativ 0.2 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A gering. (B) Die Gruppe A und B haben fast den gleichen Mittelwert. Damit ist p(A,B) aproximativ 0.5 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A gleich. (C) Die Gruppe A hat mit \bar{y}_A einen kleineren Mittelwert als die Gruppe B mit \bar{y}_B. Damit ist p(A,B) aproximativ 0.8 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A groß. [Zum Vergrößern anklicken]"><img src="stat-tests-posthoc2_files/figure-html/fig-normal-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1152"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.19— Darstellung verschiedener relativer Effekte <span class="math inline">\(p(a,b)\)</span> für zwei Gruppen und einem normalverteilten Outcome <span class="math inline">\(y\)</span>. Die eingefärbten Flächen dienen als Veranschaulichung. Die Flächen stellt die Wahrscheinlichkeit <span class="math inline">\(p(a,b)\)</span> als relativen Effekt dar. <strong>(A)</strong> Die Gruppe A hat mit <span class="math inline">\(\bar{y}_A\)</span> einen größeren Mittelwert als die Gruppe B mit <span class="math inline">\(\bar{y}_B\)</span>. Damit ist <span class="math inline">\(p(A,B)\)</span> aproximativ 0.2 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A gering. <strong>(B)</strong> Die Gruppe A und B haben fast den gleichen Mittelwert. Damit ist <span class="math inline">\(p(A,B)\)</span> aproximativ 0.5 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A gleich. <strong>(C)</strong> Die Gruppe A hat mit <span class="math inline">\(\bar{y}_A\)</span> einen kleineren Mittelwert als die Gruppe B mit <span class="math inline">\(\bar{y}_B\)</span>. Damit ist <span class="math inline">\(p(A,B)\)</span> aproximativ 0.8 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A groß. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<section id="einfaktorielle-analyse-4" class="level4" data-number="78.7.4.1">
<h4 data-number="78.7.4.1" class="anchored" data-anchor-id="einfaktorielle-analyse-4"><span class="header-section-number">78.7.4.1</span> Einfaktorielle Analyse</h4>
<p>In dem Paket <code>{naprcomp}</code> können wir nur eine einfaktorielle Analyse rechnen. Da ist hier nochmal wichtig zu wissen. Sonst musst du dir die Arbeit nicht machen. Wir müssen einiges Einstellen bei der gleichnamigen Hauptfunktion <code>nparcomp()</code> aber dann funktioniert alles realtiv reibungslos. Das Paket ist schon älter und hat damit nicht die Funktionalität des <code>{tidyverse}</code> oder anderen Paketen. Hier sieht man dann auch, dass <code>{naprcomp}</code> nicht so oft genutzt wird, denn ansonsten wäre ja auch der Bedarf einer besseren Integration dar. Aber das lassen wir mal so im Raum stehen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">p-Werte</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false"><em>Compact letter display</em></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">95% Konfidenzintervall</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>Leider hat die Funktion <code>nparcomp()</code> einem sehr viele Informationen auf der R Konsole auszugeben auch wenn man das nicht will und es einen eigentlich mehr verwirrt als gutes tut. Deshalb stelle ich immer die Option <code>info = FALSE</code> ein. Wir wollen eigentlich immer alle Gruppen miteinander vergleichen, so dass wir als Option <code>type = "Tukey"</code> nehmen. Achtung, das hat jetzt <em>nichts</em> mit dem Tukey HSD Test zu tun. Wir müssen uns dann auch noch aus der Ausgabe den Teil rausziehen, denn wir dann brauchen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="ot">&lt;-</span> <span class="fu">nparcomp</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, <span class="at">type =</span> <span class="st">"Tukey"</span>, </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info =</span> <span class="cn">FALSE</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="sc">|&gt;</span> <span class="fu">pluck</span>(<span class="st">"Analysis"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Comparison Estimator Lower Upper Statistic    p.Value
1 p( dog , cat )     0.102 0.013 0.505 -2.345283 0.05264938
2 p( dog , fox )     0.684 0.276 0.925  1.050004 0.60513796
3 p( cat , fox )     0.980 0.612 0.999  2.681488 0.02072000</code></pre>
</div>
</div>
<p>Was wir eigentlich brauchen ist der p-Wert in der letzten Spalte. Spannend ist hier, dass <code>nparcomp()</code> den Vergleich von Hunde- und Katzenflöhen nicht als signifikant findet. Das ist eine Folge davon, dass <code>nparcomp()</code> etwas konservativer ist als die anderen hier vorgestellten Verfahren. Wenn du nochmal nachvollziehen willst, wie der relative Effekt <code>Estimator</code> zu interpretieren ist, habe ich dir nochmal im folgenden eine zusammenfassende Tabelle mit den Mittelwerten der einzelnen Gruppen gebaut. Für mich ist der Wert immer noch von hinten durch die Brust. Leider hat der relative Effekt keinen Bezug zur biologischen Einheit der Messwerte. Deshalb ist die Interpreation im günstigsten Fall schwierig.</p>
<div id="tbl-nparcomp-pval" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-nparcomp-pval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;78.10— Interpretation des relativen Effektes <span class="math inline">\(p(a,b)\)</span> am Beispiel der Sprungweiten der Flöhe. Je größer der relative Effekt <span class="math inline">\(p(a,b)\)</span> desto wahrscheinlicher ist es größere Werte in <span class="math inline">\(b\)</span> als in <span class="math inline">\(a\)</span> zu beobachten.
</figcaption>
<div aria-describedby="tbl-nparcomp-pval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Vergleich</th>
<th style="text-align: center;">Relativer Effekt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\bar{y}_{cat} \stackrel{?}{&gt;} \bar{y}_{dog}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.74 \stackrel{?}{&gt;} 8.13 \rightarrow p(dog, cat) = 0.102\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\bar{y}_{fox} \stackrel{?}{&gt;} \bar{y}_{dog}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(9.16 \stackrel{?}{&gt;} 8.13 \rightarrow p(dog, fox) = 0.684\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\bar{y}_{fox} \stackrel{?}{&gt;} \bar{y}_{cat}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(4.74 \stackrel{?}{&gt;} 9.16 \rightarrow p(cat, fox) = 0.980\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>Für das <em>Compact letter display</em> brauchen wir wieder einmal das Objekt einer <code>nparcomp()</code> Analyse. Wir nutzen hier den gleichen Aufruf wie schon bei den p-Werten. Die Optionen sind damit die gleichen wie im Tab zu den p-Werten. Wir sind jetzt aber nur an den reinen p-Werten interessiert und nicht an den relativen Effekten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="ot">&lt;-</span> <span class="fu">nparcomp</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, <span class="at">type =</span> <span class="st">"Tukey"</span>, </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Leider ist es so, dass <code>{nparcomp}</code> nicht für die Erstellung des <em>Compact letter displays</em> optimiert ist. Daher müssen wir uns erst einen Vektor für die Vergleiche mit einem Minuszeichen ohne Leerzeichen bauen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>contrast_vec <span class="ot">&lt;-</span> nparcomp_fac1_res <span class="sc">|&gt;</span>   </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Contrast"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row.names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wenn wir die Namen der Vergleiche haben, können wir uns die p-Werte aus dem <code>nparcomp()</code> Objekt ziehen und entsprechend dem Vergleich benennen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>adj_p_values_vec <span class="ot">&lt;-</span> nparcomp_fac1_res <span class="sc">|&gt;</span>   </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Analysis"</span>, <span class="st">"p.Value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(contrast_vec)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Abschließend können wir uns dann mit der Funktion <code>multcompLetters()</code> das <em>Compact letter display</em> wiedergeben lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>adj_p_values_vec <span class="sc">|&gt;</span> <span class="fu">multcompLetters</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> cat  fox  dog 
 "a"  "b" "ab" </code></pre>
</div>
</div>
<p>Hier ist der Weg etwas länger aber wenn wir uns nur auf das <em>Compact letter displays</em> konzentrieren liefert <code>{nparcomp}</code> in einem einfaktoriellen Fall eigentlich alles was wir brauchen. Hier unterscheidet sich das <em>Compact letter display</em> von den anderen Analysen, da wir hier auch etwas andere p-Werte erhalten.</p>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01_small.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="images/angel_01_small.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Ja, die 95% Konfidenzintervalle und <code>{nparcomp}</code>, eine für mich schwierige Sache. Eigentlich liefern die 95% Konfidenzintervalle in <code>{nparcomp}</code> nicht so richtig was wir eigentlich wollen. Nämlich eine biologisch zu interpretierende Relevanz und Signifikanz. Die relativen Effekte <span class="math inline">\(p(a,b)\)</span> aus der Funktion <code>nparcomp()</code> sind eben dann doch wieder nur Wahrscheinlichkeiten.</p>
</blockquote>
</div>
</div>
</div>
<p>Wenn du die 95% Konfidenzintervalle brauchst, dann kannst du die Funktion <code>nparcomp()</code> wie in den Tab zu den p-Werten nutzen. Hier ändert sich nichts bei dem Funktionsaufruf. Praktischerweise liefert dir die Ausgabe von <code>nparcomp()</code> auch gleich die 95% Konfidenzintervalle mit.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="ot">&lt;-</span> <span class="fu">nparcomp</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, <span class="at">type =</span> <span class="st">"Tukey"</span>, </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Abbildung siehst du dann einmal die 95% Konfidenzintervalle visualisiert. Durch die Eigenschaft des relativen Effekt eine Wahrscheinlichkeit zu sein, hast du die Begrenzungen von <span class="math inline">\([0, 1]\)</span> und damit dann auch keine symmetrischen 95% Konfidenzintervalle mehr. Die Entscheidung gegen die Nullhypothese liegt bei <span class="math inline">\(p(a,b) = 0.5\)</span>.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nparcomp_fac1_res<span class="sc">$</span>Analysis, </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(Comparison, <span class="at">y =</span> Estimator, <span class="at">ymin =</span> Lower, <span class="at">ymax =</span> Upper)) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Relativer Effekt"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-nparcomp-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nparcomp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc2_files/figure-html/fig-nparcomp-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Abbildung&nbsp;78.20— Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe aus dem R Paket {nparcomp} Der relative Effekt ist eine Wahrscheinlichkeit, daher die Begrenzungen bei [0, 1]. Die Entscheidung gegen die Nullhypothese liegt bei p(a,b) = 0.5."><img src="stat-tests-posthoc2_files/figure-html/fig-nparcomp-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nparcomp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;78.20— Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe aus dem R Paket <code>{nparcomp}</code> Der relative Effekt ist eine Wahrscheinlichkeit, daher die Begrenzungen bei <span class="math inline">\([0, 1]\)</span>. Die Entscheidung gegen die Nullhypothese liegt bei <span class="math inline">\(p(a,b) = 0.5\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="zweifaktorielle-analyse-4" class="level4" data-number="78.7.4.2">
<h4 data-number="78.7.4.2" class="anchored" data-anchor-id="zweifaktorielle-analyse-4"><span class="header-section-number">78.7.4.2</span> Zweifaktorielle Analyse</h4>
<p>Eine zweifaktorielle Analyse ist in dem Paket <code>{nparcomp}</code> nicht möglich. Damit war das hier viel Arbeit für mich für vermutlich nicht viel für dich. Dafür habe ich aber eine Menge über <code>{nparcomp}</code> gelernt und du musst dich dafür nicht durch das sehr mathematische Paper von <span class="citation" data-cites="konietschke2015nparcomp">Konietschke u.&nbsp;a. (<a href="#ref-konietschke2015nparcomp" role="doc-biblioref">2015</a>)</span> quälen. Denn in den Agrarwissenschaften haben wir eigentlich immer ein zweifaktorielles Modell und selten nur ein Modell mit einem Faktor vorliegen. Daher ist dieses Paket auch hier unten im Kapitel eingeordnet und würde ich nicht empfehlen.</p>
</section>
</section>
</section>
<section id="weitere-dinge-von-interesse" class="level2" data-number="78.8">
<h2 data-number="78.8" class="anchored" data-anchor-id="weitere-dinge-von-interesse"><span class="header-section-number">78.8</span> Weitere Dinge von Interesse</h2>
<p>Es gibt immer wieder Dinge von Interesse, die ich im Rahmen der multiplen Vergleiche oder Post-hoc Tests so finde. Meistens ist es dann nicht so wichtig, dass ich es in den obigen Abschnitten noch einbauen möchte. Auf der anderen Seite will ich es dann aber auch nicht vergessen, so dass es eben hier steht. SO kannst du über die Suchfunktion noch Sachen finden, die ich dann eben hier parke. Du kannst es nutzen und manchmal ist es dann auch nützlich.</p>
<section id="sec-friedhof-posthoc" class="level3" data-number="78.8.1">
<h3 data-number="78.8.1" class="anchored" data-anchor-id="sec-friedhof-posthoc"><span class="header-section-number">78.8.1</span> Friedhof der Post-hoc Tests</h3>
<p>Hier gebe ich eine – nicht vollständige – Liste an Post-hoc Tests, die es einmal gab und auch noch erwähnt werden, aber dann igentlich alle irgendwie veraltet sind. Wie immer sind diese Tests nicht per se schlecht. Aber es gibt dann eben besseres. Die Daumenregel lautet dabei, dass es <code>{emmeans}</code> oder <code>{multcomp}</code> besser können. Zwei Übersichtsarbeiten helfen hier nochmal Ordnung in das Dickicht der multiplen Vergleiche zu bringen. Einmal die Arbeit <a href="https://www.sciencedirect.com/science/article/pii/S2405844024011629">On the use of post-hoc tests in environmental and biological sciences: A critical review</a> von <span class="citation" data-cites="agbangba2024use">Agbangba u.&nbsp;a. (<a href="#ref-agbangba2024use" role="doc-biblioref">2024</a>)</span> sowie die Veröffentlichung <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10845891/">A discussion and evaluation of statistical procedures used by JIMB authors when comparing means</a> von <span class="citation" data-cites="klasson2024discussion">Klasson (<a href="#ref-klasson2024discussion" role="doc-biblioref">2024</a>)</span>.</p>
<dl>
<dt>LSD Test oder auch <em>Fisher`s least Significant Difference (LSD)</em></dt>
<dd>
<p>Der LSD Test ist veraltet. Was überhaupt gegen die Nutung des LSD Test spricht ist, das der LSD Test das Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% über alle Vergleiche nicht einhält. Sie dazu auch <span class="citation" data-cites="agbangba2024use">Agbangba u.&nbsp;a. (<a href="#ref-agbangba2024use" role="doc-biblioref">2024</a>)</span> mit der klaren Aussage: <em>“LSD does not control for family-wise type I error”.</em> Die einzige Ausnahme ist der seltene Fall, dass du dir nur drei Behandlungsgruppen anschaust, wie von <span class="citation" data-cites="klasson2024discussion">Klasson (<a href="#ref-klasson2024discussion" role="doc-biblioref">2024</a>)</span> diskutiert. Aber am Ende ich kann den LSD Test nicht empfehlen.</p>
</dd>
<dt>Scheffé Test</dt>
<dd>
<p>Der Scheffé Test ist im Prinzipn eng mit dem Tukey HSD Test verwandt. Was aber <span class="citation" data-cites="agbangba2024use">Agbangba u.&nbsp;a. (<a href="#ref-agbangba2024use" role="doc-biblioref">2024</a>)</span> anmerkt ist, dass <em>“the test is too conservative compared to methods like Tukey’s HSD”</em>. Aus dem Grund würde ich den Test nicht empfehlen. Auch testet der Scheffé Test mehr Vergleiche als du meistens möchtest. Es ist eben nicht ein reiner <em>all-pair</em> Vergleich sondern testet auch noch alle anderen möglichen Kombinationen der Mittelwerte.</p>
</dd>
</dl>
</section>
<section id="re-engineering-compact-letter-display" class="level3" data-number="78.8.2">
<h3 data-number="78.8.2" class="anchored" data-anchor-id="re-engineering-compact-letter-display"><span class="header-section-number">78.8.2</span> Re-engineering <em>Compact letter display</em></h3>
<p>In dem kurzen Kapitel zu <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/re-engineering-clds.html">Re-engineering CLDs</a> in der Vingette des R Pakets <code>{emmeans}</code> geht es darum, wie das <em>compact letter display</em> auch anders gebaut werden könnte. Nämlich einmal als wirkliches Anzeigen von Gleichheit über die Option <code>delta</code> oder aber über das Anzeigen von Signifikanz über die Option <code>signif</code>. Damit haben dann auch wirklich die Information, die wir dann wollen. Also eigentlich was Schönes. Wie machen wir das nun?</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Delta Methode</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Unterschied anzeigen</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>Wenn wir das <em>compact letter display</em> in dem Sinne der Gleichheit der Behandlungen interpretieren wollen, also das der gleiche Buchstabe bedeutet, dass sich die Behandlungen nicht unterscheiden, dann müssen wir ein <code>delta</code> setzen in deren Bandbreite oder Intervall die Behandlungen gleich sind. Ich habe hier mal ein <code>delta</code> von 4cm gewählt und wir adjustieren bei einem Test auf Gleichheit nicht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>, <span class="at">delta =</span> <span class="dv">4</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean   SE df lower.CL upper.CL .equiv.set
 cat      4.74 0.67 18     3.34     6.15  a        
 dog      8.13 0.67 18     6.72     9.54   b       
 fox      9.16 0.67 18     7.75    10.56   b       

Confidence level used: 0.95 
Statistics are tests of equivalence with a threshold of 4 
P values are left-tailed 
significance level used: alpha = 0.05 
Estimates sharing the same symbol test as equivalent </code></pre>
</div>
</div>
<p>Wie wir jetzt sehen, bedeuten gleiche Buchstaben, dass die Behandlungen gleich sind. In dem Sinne gleich sind, dass die Behandlungen im Mittel nicht weiter als der Wert in <code>delta</code> auseinanderliegen. Wie du jetzt das <code>delta</code> bestimmst ist eine biologische und keine statistische Frage.</p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<p>Können wir uns auch signifikante Unterschiede anzeigen lassen? Ja, können wir auch, aber das ist meiner Meinung nach die schlechtere der beiden Anpassungen. Wir haben ja im Kopf, dass das <em>compact letter display</em> eben mit gleichen Buchstaben das Gleiche anzeigt. Jetzt würden wir diese Eigenschaften zu Unterschied ändern. Schauen wir uns das einmal an einem kleineren Datensatz einmal an.</p>
<p>Dann können wir uns hier einmal das Problem mit den Buchstaben anschauen. Wir kriegen jetzt mit der Option <code>signif = TRUE</code> wiedergeben <code>Estimates sharing the same symbol are significantly different</code> und das ist irgendwie auch wirr, dass <em>gleiche</em> Buchstaben einen Unterschied darstellen. Das <em>compact letter display</em> wird eben als Gleichheit gelesen, so dass wir hier mehr verwirrt werden als es hilft.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>, <span class="at">signif =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean   SE df lower.CL upper.CL .signif.set
 cat      4.74 0.67 18     2.98     6.51  ab        
 dog      8.13 0.67 18     6.36     9.90  a         
 fox      9.16 0.67 18     7.39    10.92   b        

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 3 estimates 
P value adjustment: bonferroni method for 3 tests 
significance level used: alpha = 0.05 
Estimates sharing the same symbol are significantly different </code></pre>
</div>
</div>
<p>Deshalb würde ich auf die Buchstaben verzichten und die Zahlen angeben, damit hier nicht noch mehr Verwirrung aufkommt. Wir nehmen also die Option für die Buchstaben einmal aus dem <code>cld()</code> Aufruf raus. Dann haben wir Zahlen als Gruppenzuweisung, was schon mal was anderes ist als die Buchstaben aus dem <em>compact letter display</em>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>, <span class="at">signif =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean   SE df lower.CL upper.CL .signif.set
 cat      4.74 0.67 18     2.98     6.51  12        
 dog      8.13 0.67 18     6.36     9.90  1         
 fox      9.16 0.67 18     7.39    10.92   2        

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 3 estimates 
P value adjustment: bonferroni method for 3 tests 
significance level used: alpha = 0.05 
Estimates sharing the same symbol are significantly different </code></pre>
</div>
</div>
<p>Innerhalb des selben Konzepts dann zwei Arten von Interpretation des <em>compact letter display</em> zu haben, ist dann auch nicht zielführend. Den auch die <em>gleichen</em> Zahlen bedeuten jetzt einen Unterschied. Irgendwie mag ich persönlich nicht diese sehr verdrehte Interpretation nicht. Deshalb lieber ein <code>delta</code> einführen und auf echte Gleichheit testen.</p>
</div>
</div>
</div>
</section>
<section id="sec-posthoc-var-heterogen" class="level3" data-number="78.8.3">
<h3 data-number="78.8.3" class="anchored" data-anchor-id="sec-posthoc-var-heterogen"><span class="header-section-number">78.8.3</span> Modellierung von Varianzheterogenität</h3>
<p>In diesem Kapitel modelliere ich ja immer die Varianzheterogenität, wenn ich das kann. Es gibt aber eine Reihe von Möglichkeiten die Adjustierung durchzuführen. In den folgenden Tabs findest du dann noch andere Ideen und Anregungen. Ich muss hier nochmal aufräumen, aber wie immer, wenn es nicht dringlich ist, dann lagere ich es hier lieber. Es es bestimmt nochmal nützlich.</p>
<p>Wenn du noch etwas weiter gehen möchtest, dann kannst du dir noch die Hilfeseite von dem R Paket <code>{performance}</code> <a href="https://easystats.github.io/parameters/articles/model_parameters_robust.html?q=Heteroskedasticity#robust-covariance-matrix-estimation-from-model-parameters">Robust Estimation of Standard Errors, Confidence Intervals, and p-values</a> anschauen. Die Idee ist hier, dass wir die Varianz/Kovarianz robuster daher mit der Berücksichtigung von Varianzheterogenität (eng. <em>heteroskedasticity</em>) schätzen.</p>
<p>Hier also jetzt einmal eine Übersicht über die Möglichkeiten mit der Varianzheterogenität in Behandlungsgruppen umzugehen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Generalized Least Squares</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Robuste Schätzung von Standardfehlern</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<p>Neben dem Games-Howell-Test gibt es auch die Möglichkeit <em>Generalized Least Squares</em> zu nutzen. Hier haben wir dann auch die Möglichkeit mehrfaktorielle Modelle zu schätzen und dann auch wieder <code>emmeans</code> zu nutzen. Das ist natürlich super, weil wir dann wieder in dem <code>emmeans</code> Framework sind und alle Funktionen von oben nutzen können. Deshalb hier auch nur die Modellanpassung, den Rest kopierst du dir dann von oben dazu.</p>
<p>Die Funktion <code>gls()</code> aus dem R Paket <code>{nlme}</code> passt ein lineares Modell unter Verwendung der verallgemeinerten kleinsten Quadrate an. Die Fehler dürfen dabei aber korreliert oder aber ungleiche Varianzen haben. Damit haben wir ein Modell, was wir nutzen können, wenn wir Varianzheterogenität vorliegen haben. Hier einmal das simple Beispiel für die Tierarten. Wir nehmen wieder die ganz normale Formelschreiweise. Wir können jetzt aber über die Option <code>weights =</code> angeben, wie wir die Varianz modellieren wollen. Die Schreibweise mag etwas ungewohnt sein, aber es gibt wirklich viele Arten die Varainz zu modellieren. Hier machen wir uns es einfach und nutzen die Helferfunktion <code>varIdent</code> und modellieren dann für jedes Tier eine eigene Gruppenvarianz.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>gls_fac1_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal), </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir die Modellanpasssung auch schon in <code>emmeans()</code> weiterleiten und schauen uns mal das Ergebnis gleich an. Wir achten jetzt auf die Spalte <code>SE</code>, die uns ja den Fehler der Mittelwerte für jede Gruppe wiedergibt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>gls_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean    SE   df lower.CL upper.CL
 dog      8.13 0.811 6.00     6.15     10.1
 cat      4.74 0.719 6.01     2.98      6.5
 fox      9.16 0.415 6.00     8.14     10.2

Degrees-of-freedom method: satterthwaite 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wir sehen, dass wir für jedes Tier eine eigene Varianz über den Standardfehler <code>SE</code> geschätzt haben. Das war es ja auch was wir wollten. Bis hierhin wäre es auch mit dem Games-Howell-Test gegangen. Was ist aber, wenn wir ein zweifaktorielles design mit Interaktion schätzen wollen? Das können wir analog wie eben machen. Wir erweitern einfach das Modell um die Terme <code>site</code> für den zweiten Faktor und den Interaktionsterm <code>animal:site</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal), </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns wieder die multiplen Vergleiche getrennt für die Interaktionsterme wiedergeben lassen. Blöderweise haben jetzt alle Messorte <code>site</code> die gleiche Varianz für jede Tierart, aber auch da können wir noch ran.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 animal emmean    SE df lower.CL upper.CL
 cat      13.6 0.672 18     12.2     15.0
 dog      16.7 0.573 18     15.5     17.9
 fox      20.1 0.466 18     19.1     21.1

site = village:
 animal emmean    SE df lower.CL upper.CL
 cat      15.2 0.672 18     13.8     16.7
 dog      16.6 0.573 18     15.4     17.8
 fox      17.0 0.466 18     16.0     18.0

Degrees-of-freedom method: satterthwaite 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Die eigentliche Stärke von <code>gls()</code> kommt eigentlich erst zu tragen, wenn wir auch noch erlauben, dass wir die Varianz <em>über alle</em> Tierarten, Messsorte und Interaktionen variieren kann. Das machen wir, in dem wir einfach <code>animal*site</code> zu der <code>varIdent()</code> Funktion ergänzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal<span class="sc">*</span>site), </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann noch schnell in <code>emmeans()</code> gesteckt und sich das Ergebnis angeschaut.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 animal emmean    SE   df lower.CL upper.CL
 cat      13.6 0.594 8.93     12.2     14.9
 dog      16.7 0.713 9.03     15.1     18.3
 fox      20.1 0.365 9.01     19.3     20.9

site = village:
 animal emmean    SE   df lower.CL upper.CL
 cat      15.2 0.743 9.00     13.6     16.9
 dog      16.6 0.384 9.00     15.7     17.4
 fox      17.0 0.548 9.22     15.7     18.2

Degrees-of-freedom method: satterthwaite 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wie du jetzt siehst schätzen wir die Varianz für jede Tierart und jeden Messort separat. Wir haben also wirklich jede Varianz einzeln zugeordnet. Die Frage ist immer, ob das notwendig ist, denn wir brauchen auch eine gewisse Fallzahl, damit die Modelle funktionieren. Aber das kommt jetzt sehr auf deine Fragestellung an und müssten wir nochmal konkret besprechen.</p>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p>Wir immer gibt es noch eine weitere Möglichkeit die Varianzheterogenität zu behandeln. Wir nutzen jetzt hier einmal die Funktionen aus dem R Paket <code>{sandwich}</code>, die es uns ermöglichen Varianzheterogenität (eng. <em>heteroskedasticity</em>) zu modellieren. Es ist eigentlich super einfach, wir müssen als erstes wieder unser Modell anpassen. Hier einmal mit einer simplen linearen Regression.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>lm_fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir auch schon für einen Gruppenvergleich direkt in der Funktion <code>emmeans()</code> für die Varianzheterogenität adjustieren. Es gibt verschiedene mögliche Sandwich-Schätzer, aber wir nehmen jetzt mal einen der häufigsten mit <code>vcovHC</code>. Wie immer gilt, es gibt ja nach Datenlage bessere und schlechtere Schätzer. Wir laden jetzt nicht das ganze Paket, sondern nur die Funktion mit <code>sandwich::vcovHAC</code>. Achtung, hinter der Option <code>vcov.</code> ist ein <em>Punkt</em>. Ohne den Aufruf <code>vcov. =</code> funktioniert die Funktion dann nicht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>em_obj <span class="ot">&lt;-</span> lm_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal, <span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC)</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>em_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean    SE df lower.CL upper.CL
 dog      8.13 0.427 18     7.23     9.03
 cat      4.74 0.810 18     3.04     6.44
 fox      9.16 0.468 18     8.17    10.14

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wir du siehst, die Standardfehler sind jetzt nicht mehr über alle Gruppen gleich. Dann können wir uns auch die paarweisen Vergleiche ausgeben lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>contr_obj <span class="ot">&lt;-</span> em_obj <span class="sc">|&gt;</span> </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Oder aber wir lassen uns das <em>compact letter display</em> wiedergeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>cld_obj <span class="ot">&lt;-</span> em_obj <span class="sc">|&gt;</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-agbangba2024use" class="csl-entry" role="listitem">
Agbangba CE, Aide ES, Honfo H, Kakai RG. 2024. On the use of post-hoc tests in environmental and biological sciences: A critical review. Heliyon.
</div>
<div id="ref-klasson2024discussion" class="csl-entry" role="listitem">
Klasson KT. 2024. A discussion and evaluation of statistical procedures used by JIMB authors when comparing means. Journal of Industrial Microbiology and Biotechnology 51: kuae001.
</div>
<div id="ref-konietschke2015nparcomp" class="csl-entry" role="listitem">
Konietschke F, Placzek M, Schaarschmidt F, Hothorn LA. 2015. nparcomp: an R software package for nonparametric multiple comparisons and simultaneous confidence intervals. Journal of statistical software 64: 1–17.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./app-spielecke.html" class="pagination-link" aria-label="Spielecke">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Spielecke</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb116" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc, see, latex2exp,</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="in">               multcomp, emmeans, ggpubr, multcompView, nlme, quantreg, janitor,</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="in">               parameters, effectsize, patchwork, scales, nparcomp, conflicted)</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="in">gg_template &lt;- ggplot() +</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(#axis.text.x = element_blank(),</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="in">        #axis.ticks.x = element_blank(),</span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="in">        # axis.text.y = element_text(color = "#CC79A7", face = "bold", size = 14),</span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_text(),</span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.ticks.y = element_blank(),</span></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text = element_text(size = 12),</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a><span class="in">        #axis.title = element_text(size = 14, face = "bold"),</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a><span class="in">        plot.title = element_text(size = 16, face = "bold"),</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a><span class="in">        plot.subtitle = element_text(size = 12, face = "italic"),</span></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a><span class="in">        plot.caption = element_text(face = "italic"),</span></span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a><span class="in">        legend.position = "none") +</span></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_okabeito() +</span></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_okabeito() </span></span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a><span class="fu"># Der Post-hoc Test {#sec-posthoc}</span></span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-tests-posthoc.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Comparison is the thief of joy." --- Theodore Roosevelt*</span></span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01_small.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-39"><a href="#cb116-39" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; In diesem Kapitel werde ich ein paar Engel der Statistik niedergeschlagen oder überfahren. Ich lasse aus Gründen der Didaktik ein paar Sachen weg und dadurch wird einiges leider dann *mathematisch* unkorrekt. Ich kann damit leben und nehme es auf mich damit du deine Abschlussarbeit fertig bekommst.</span></span>
<span id="cb116-40"><a href="#cb116-40" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a>|   | Tukey HSD | Games Howell | <span class="in">`{emmeans}`</span> | <span class="in">`{multcomp}`</span> |</span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a>|:---|:--:|:--:|:--:|:--:|</span>
<span id="cb116-44"><a href="#cb116-44" aria-hidden="true" tabindex="-1"></a>| **Verteilung von y** | normalverteilt | normalverteilt | beliebig | beliebig |</span>
<span id="cb116-45"><a href="#cb116-45" aria-hidden="true" tabindex="-1"></a>| **Varianzen von x** | homogen | heterogen | beliebig | beliebig |</span>
<span id="cb116-46"><a href="#cb116-46" aria-hidden="true" tabindex="-1"></a>| **Fallzahl per Gruppe** | balanciert | beliebig | beliebig | beliebig |</span>
<span id="cb116-47"><a href="#cb116-47" aria-hidden="true" tabindex="-1"></a>| **Adjustierte p-Werte** | immer | immer | beliebig | beliebig |</span>
<span id="cb116-48"><a href="#cb116-48" aria-hidden="true" tabindex="-1"></a>| **Mögliche Vergleiche** | *all-pair* | *all-pair* | beliebig | beliebig |</span>
<span id="cb116-49"><a href="#cb116-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-50"><a href="#cb116-50" aria-hidden="true" tabindex="-1"></a>: test. Achtung, teilweise müssen die Optionen *aktiv* von dir aktiviert werden. Sie dazu auch den <span class="co">[</span><span class="ot">Friedhof der Post-ho Tests</span><span class="co">](#sec-friedhof-posthoc)</span> in diesem Kapitel. {#tbl-übersicht}</span>
<span id="cb116-51"><a href="#cb116-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-52"><a href="#cb116-52" aria-hidden="true" tabindex="-1"></a>Auf der Seite DSFAIR gibt es noch einen Artikel zu <span class="in">`emmeans`</span> und der Frage <span class="co">[</span><span class="ot">Why are the StdErr all the same?</span><span class="co">](https://schmidtpaul.github.io/dsfair_quarto/ch/summaryarticles/whyseequal.html)</span> und dazu dann auch passend die Publikation <span class="co">[</span><span class="ot">Analyzing designed experiments: Should we report standard deviations or standard errors of the mean or standard errors of the difference or what?</span><span class="co">](https://www.cambridge.org/core/services/aop-cambridge-core/content/view/92DB0AF151C157B9C6E2FA40F9C9B635/S0014479719000401a.pdf/analyzing-designed-experiments-should-we-report-standard-deviations-or-standard-errors-of-the-mean-or-standard-errors-of-the-difference-or-what.pdf)</span></span>
<span id="cb116-53"><a href="#cb116-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-54"><a href="#cb116-54" aria-hidden="true" tabindex="-1"></a>Wieviel ist den *all-pair*?</span>
<span id="cb116-55"><a href="#cb116-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-56"><a href="#cb116-56" aria-hidden="true" tabindex="-1"></a>:   Wenn du alle möglichen Mittelwertkombinationen testen willst, dann ist die Formel für die Berechnung der durchzuführenden Vergleiche $r = m(m-1)/2$. Oder um es einmal in der folgenden Tabelle etwas konkreter darzustellen, werden es sehr schnell sehr viele Vergleiche. Dabei drückst du mit jeder zusätzlichen Behandlungsgruppe das Signifikanznievau $\alpha$ weiter runter, da die Anzahl an potenziellen Vergleichen sehr schnell ansteigt. So fällt dann auch der maximal noch signifikante p-Wert schnell ab. Damit brauchst du dann immer stärkere Effekt, wie einen Mittelwertsunterschied, um überhaupt noch was signifikantes aus einem statistsichen Test wiedergeben zu bekommen. In der folgenden Tabelle siehtst du dann nochmal den Zussammenhang. Ohne Adjustierung des Signifikanzniveaus erhalten wir schon ab sechs Gruppen mindestens einen signifikanten Unterschied auch wenn es gar keinen Unterschied in den Daten gibt.</span>
<span id="cb116-57"><a href="#cb116-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-60"><a href="#cb116-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-61"><a href="#cb116-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-62"><a href="#cb116-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-63"><a href="#cb116-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-64"><a href="#cb116-64" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-allpair-bonf</span></span>
<span id="cb116-65"><a href="#cb116-65" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Zusammenhang von der Anzahl an Gruppen oder Behandlungen und der sich ergebenden Anzahl an *all-pair* Vergleichen. Daraus ergibt sich ein stark abfallendes Signifikanzniveau. Der maximal noch signifikante p-Wert fällt dementsprechend auch schnell ab. **Ohne Adjustierung** erhalten wir schon ab sechs Gruppen mindestens einen fälschlichen signifikanten Unterschied."</span></span>
<span id="cb116-66"><a href="#cb116-66" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">m =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">12</span>,</span>
<span id="cb116-67"><a href="#cb116-67" aria-hidden="true" tabindex="-1"></a>       <span class="at">r =</span> m<span class="sc">*</span>(m<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb116-68"><a href="#cb116-68" aria-hidden="true" tabindex="-1"></a>       <span class="at">a =</span> <span class="fu">percent</span>(<span class="fu">round</span>(<span class="fl">0.05</span><span class="sc">/</span>r, <span class="dv">4</span>)),</span>
<span id="cb116-69"><a href="#cb116-69" aria-hidden="true" tabindex="-1"></a>       <span class="at">p =</span> <span class="fu">round</span>(<span class="fl">0.05</span><span class="sc">/</span>r, <span class="dv">4</span>),</span>
<span id="cb116-70"><a href="#cb116-70" aria-hidden="true" tabindex="-1"></a>       <span class="at">fp =</span> <span class="fu">round</span>(r<span class="sc">/</span><span class="dv">20</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb116-71"><a href="#cb116-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"Anzahl Gruppen"</span>, <span class="st">"Anzahl Vergleiche"</span>, </span>
<span id="cb116-72"><a href="#cb116-72" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Signifikanzniveau $</span><span class="sc">\\</span><span class="st">alpha$"</span>, <span class="st">"Maximal signifikanter p-Wert"</span>,</span>
<span id="cb116-73"><a href="#cb116-73" aria-hidden="true" tabindex="-1"></a>              <span class="st">"$H_0$ fälschlich abgelehnt"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb116-74"><a href="#cb116-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb116-75"><a href="#cb116-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-76"><a href="#cb116-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-77"><a href="#cb116-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-78"><a href="#cb116-78" aria-hidden="true" tabindex="-1"></a>Was bedeutet *konservativ* und was *liberal*?</span>
<span id="cb116-79"><a href="#cb116-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-80"><a href="#cb116-80" aria-hidden="true" tabindex="-1"></a>:   Test</span>
<span id="cb116-81"><a href="#cb116-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-84"><a href="#cb116-84" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-85"><a href="#cb116-85" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-86"><a href="#cb116-86" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb116-87"><a href="#cb116-87" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-88"><a href="#cb116-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-89"><a href="#cb116-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-posthoc-temp</span></span>
<span id="cb116-90"><a href="#cb116-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-91"><a href="#cb116-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb116-92"><a href="#cb116-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb116-93"><a href="#cb116-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visueller Zusammenhang eines gemittelten Outcomes ($y$) aus einer Normalverteilung im Verhältnis zu der Einflussvariable ($x$) mit zwei oder mehr Kategorien anhand von Barplots. Hauptsächlich unterscheiden sich die Barplots durch die unterschiedlichen Einheiten auf der $y$-Achse. Die Fehlerbalken stellen den Standardfehler (*SE*) dar. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb116-94"><a href="#cb116-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-95"><a href="#cb116-95" aria-hidden="true" tabindex="-1"></a>gg_template <span class="sc">%+%</span></span>
<span id="cb116-96"><a href="#cb116-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x_fct =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),  </span>
<span id="cb116-97"><a href="#cb116-97" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_normal =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="dv">5</span>),</span>
<span id="cb116-98"><a href="#cb116-98" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd_normal =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb116-99"><a href="#cb116-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x_fct, mean_normal, <span class="at">fill =</span> x_fct) <span class="sc">+</span></span>
<span id="cb116-100"><a href="#cb116-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb116-101"><a href="#cb116-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_normal<span class="sc">-</span>(sd_normal), </span>
<span id="cb116-102"><a href="#cb116-102" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_normal<span class="sc">+</span>(sd_normal)),</span>
<span id="cb116-103"><a href="#cb116-103" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb116-104"><a href="#cb116-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Kategoriell (&gt;2 Level)"</span>, <span class="at">y =</span> <span class="st">"Mittlerer Ertrag [t/ha]"</span>,</span>
<span id="cb116-105"><a href="#cb116-105" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Paarweiser Vergleich"</span>,</span>
<span id="cb116-106"><a href="#cb116-106" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Mit signifikanter ANOVA und Compact letter display"</span>) <span class="sc">+</span></span>
<span id="cb116-107"><a href="#cb116-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.1</span>, <span class="at">y =</span> <span class="dv">6</span>, <span class="at">hjust =</span> <span class="st">"right"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb116-108"><a href="#cb116-108" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"ANOVA &lt; 0.05"</span>, <span class="at">fontface =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb116-109"><a href="#cb116-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">2.3</span>, <span class="fl">3.3</span>, <span class="fl">5.8</span>),</span>
<span id="cb116-110"><a href="#cb116-110" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"ab"</span>, <span class="st">"b"</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fontface =</span> <span class="dv">2</span>) </span>
<span id="cb116-111"><a href="#cb116-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-112"><a href="#cb116-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-113"><a href="#cb116-113" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb116-114"><a href="#cb116-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-115"><a href="#cb116-115" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb116-116"><a href="#cb116-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-117"><a href="#cb116-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb116-118"><a href="#cb116-118" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb116-119"><a href="#cb116-119" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb116-120"><a href="#cb116-120" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc, see, latex2exp,</span></span>
<span id="cb116-121"><a href="#cb116-121" aria-hidden="true" tabindex="-1"></a><span class="in">               multcomp, emmeans, ggpubr, multcompView, nlme, quantreg, janitor,</span></span>
<span id="cb116-122"><a href="#cb116-122" aria-hidden="true" tabindex="-1"></a><span class="in">               parameters, effectsize, patchwork, agricolae, broom, rstatix,</span></span>
<span id="cb116-123"><a href="#cb116-123" aria-hidden="true" tabindex="-1"></a><span class="in">               conflicted)</span></span>
<span id="cb116-124"><a href="#cb116-124" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb116-125"><a href="#cb116-125" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb116-126"><a href="#cb116-126" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb116-127"><a href="#cb116-127" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb116-128"><a href="#cb116-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-129"><a href="#cb116-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-130"><a href="#cb116-130" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb116-131"><a href="#cb116-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-132"><a href="#cb116-132" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb116-133"><a href="#cb116-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-136"><a href="#cb116-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-137"><a href="#cb116-137" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-138"><a href="#cb116-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-139"><a href="#cb116-139" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb116-140"><a href="#cb116-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb116-141"><a href="#cb116-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span>
<span id="cb116-142"><a href="#cb116-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-143"><a href="#cb116-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-146"><a href="#cb116-146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-147"><a href="#cb116-147" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-148"><a href="#cb116-148" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-149"><a href="#cb116-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-150"><a href="#cb116-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1fac-table</span></span>
<span id="cb116-151"><a href="#cb116-151" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "foo"</span></span>
<span id="cb116-152"><a href="#cb116-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-153"><a href="#cb116-153" aria-hidden="true" tabindex="-1"></a>fac1_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb116-154"><a href="#cb116-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length)</span>
<span id="cb116-155"><a href="#cb116-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-156"><a href="#cb116-156" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb116-157"><a href="#cb116-157" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fac1_raw_tbl)),</span>
<span id="cb116-158"><a href="#cb116-158" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb116-159"><a href="#cb116-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb116-160"><a href="#cb116-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-161"><a href="#cb116-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-162"><a href="#cb116-162" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`standard_error()`</span> aus dem R Paket <span class="in">`{parameters}`</span></span>
<span id="cb116-163"><a href="#cb116-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-166"><a href="#cb116-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-167"><a href="#cb116-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-168"><a href="#cb116-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-169"><a href="#cb116-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-170"><a href="#cb116-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1fac-mean</span></span>
<span id="cb116-171"><a href="#cb116-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "foo"</span></span>
<span id="cb116-172"><a href="#cb116-172" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb116-173"><a href="#cb116-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">|&gt;</span> </span>
<span id="cb116-174"><a href="#cb116-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mittelwert =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb116-175"><a href="#cb116-175" aria-hidden="true" tabindex="-1"></a>            <span class="at">Standardabweichung =</span> <span class="fu">sd</span>(jump_length),</span>
<span id="cb116-176"><a href="#cb116-176" aria-hidden="true" tabindex="-1"></a>            <span class="at">SE =</span> <span class="fu">standard_error</span>(jump_length)) <span class="sc">|&gt;</span> </span>
<span id="cb116-177"><a href="#cb116-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb116-178"><a href="#cb116-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb116-179"><a href="#cb116-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-180"><a href="#cb116-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-183"><a href="#cb116-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-184"><a href="#cb116-184" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-185"><a href="#cb116-185" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-186"><a href="#cb116-186" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-187"><a href="#cb116-187" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb116-188"><a href="#cb116-188" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb116-189"><a href="#cb116-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Boxplot der Sprungweiten [cm] von Hunden und Katzen gemessen an verschiedenen Orten."</span></span>
<span id="cb116-190"><a href="#cb116-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplot-emmeans-fac1</span></span>
<span id="cb116-191"><a href="#cb116-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-192"><a href="#cb116-192" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fac1_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb116-193"><a href="#cb116-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb116-194"><a href="#cb116-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb116-195"><a href="#cb116-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite [cm]"</span>) <span class="sc">+</span></span>
<span id="cb116-196"><a href="#cb116-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-197"><a href="#cb116-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb116-198"><a href="#cb116-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-199"><a href="#cb116-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-200"><a href="#cb116-200" aria-hidden="true" tabindex="-1"></a>Wir machen den Datensatz mal kleiner</span>
<span id="cb116-201"><a href="#cb116-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-204"><a href="#cb116-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-205"><a href="#cb116-205" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-206"><a href="#cb116-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-207"><a href="#cb116-207" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox_site.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb116-208"><a href="#cb116-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, site, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb116-209"><a href="#cb116-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"city"</span>, <span class="st">"village"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb116-210"><a href="#cb116-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb116-211"><a href="#cb116-211" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">as_factor</span>(site))</span>
<span id="cb116-212"><a href="#cb116-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-213"><a href="#cb116-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-216"><a href="#cb116-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-217"><a href="#cb116-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-218"><a href="#cb116-218" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-219"><a href="#cb116-219" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-220"><a href="#cb116-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-2fac-table</span></span>
<span id="cb116-221"><a href="#cb116-221" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "foo"</span></span>
<span id="cb116-222"><a href="#cb116-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-223"><a href="#cb116-223" aria-hidden="true" tabindex="-1"></a>fac2_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox_site.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb116-224"><a href="#cb116-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, site, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb116-225"><a href="#cb116-225" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(site <span class="sc">!=</span> <span class="st">"smalltown"</span>) </span>
<span id="cb116-226"><a href="#cb116-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-227"><a href="#cb116-227" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fac2_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb116-228"><a href="#cb116-228" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fac2_raw_tbl)),</span>
<span id="cb116-229"><a href="#cb116-229" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fac2_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb116-230"><a href="#cb116-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb116-231"><a href="#cb116-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-232"><a href="#cb116-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-235"><a href="#cb116-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-236"><a href="#cb116-236" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-237"><a href="#cb116-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-238"><a href="#cb116-238" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-239"><a href="#cb116-239" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-2fac-mean</span></span>
<span id="cb116-240"><a href="#cb116-240" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "foo"</span></span>
<span id="cb116-241"><a href="#cb116-241" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb116-242"><a href="#cb116-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal, site) <span class="sc">|&gt;</span> </span>
<span id="cb116-243"><a href="#cb116-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Mittelwert =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb116-244"><a href="#cb116-244" aria-hidden="true" tabindex="-1"></a>            <span class="at">Standardabweichung =</span> <span class="fu">sd</span>(jump_length),</span>
<span id="cb116-245"><a href="#cb116-245" aria-hidden="true" tabindex="-1"></a>            <span class="at">SE =</span> <span class="fu">standard_error</span>(jump_length)) <span class="sc">|&gt;</span> </span>
<span id="cb116-246"><a href="#cb116-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb116-247"><a href="#cb116-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb116-248"><a href="#cb116-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-249"><a href="#cb116-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-252"><a href="#cb116-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-253"><a href="#cb116-253" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-254"><a href="#cb116-254" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-255"><a href="#cb116-255" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-256"><a href="#cb116-256" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb116-257"><a href="#cb116-257" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb116-258"><a href="#cb116-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Boxplot der Sprungweiten [cm] von Hunden und Katzen gemessen an verschiedenen Orten."</span></span>
<span id="cb116-259"><a href="#cb116-259" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplot-emmeans-fac2</span></span>
<span id="cb116-260"><a href="#cb116-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-261"><a href="#cb116-261" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fac2_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, </span>
<span id="cb116-262"><a href="#cb116-262" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb116-263"><a href="#cb116-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb116-264"><a href="#cb116-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb116-265"><a href="#cb116-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite [cm]"</span>, <span class="at">fill =</span> <span class="st">"Messort"</span>) <span class="sc">+</span></span>
<span id="cb116-266"><a href="#cb116-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="cb116-267"><a href="#cb116-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-268"><a href="#cb116-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-269"><a href="#cb116-269" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modell</span></span>
<span id="cb116-270"><a href="#cb116-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-271"><a href="#cb116-271" aria-hidden="true" tabindex="-1"></a>Einfaktorielles Modell</span>
<span id="cb116-272"><a href="#cb116-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-273"><a href="#cb116-273" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-274"><a href="#cb116-274" aria-hidden="true" tabindex="-1"></a>y \sim f_1</span>
<span id="cb116-275"><a href="#cb116-275" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-276"><a href="#cb116-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-277"><a href="#cb116-277" aria-hidden="true" tabindex="-1"></a>Zweifaktorielles Modell</span>
<span id="cb116-278"><a href="#cb116-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-279"><a href="#cb116-279" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-280"><a href="#cb116-280" aria-hidden="true" tabindex="-1"></a>y \sim f_1 + f_2</span>
<span id="cb116-281"><a href="#cb116-281" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-282"><a href="#cb116-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-283"><a href="#cb116-283" aria-hidden="true" tabindex="-1"></a><span class="fu">## Varianzhomogenität und Varianzheterogenität</span></span>
<span id="cb116-284"><a href="#cb116-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-285"><a href="#cb116-285" aria-hidden="true" tabindex="-1"></a>Varianz in den Fakoren</span>
<span id="cb116-286"><a href="#cb116-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-287"><a href="#cb116-287" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb116-288"><a href="#cb116-288" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch</span></span>
<span id="cb116-289"><a href="#cb116-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-292"><a href="#cb116-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-293"><a href="#cb116-293" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-294"><a href="#cb116-294" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb116-295"><a href="#cb116-295" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-296"><a href="#cb116-296" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-297"><a href="#cb116-297" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-posthoc-var-homo-bar</span></span>
<span id="cb116-298"><a href="#cb116-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-299"><a href="#cb116-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb116-300"><a href="#cb116-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb116-301"><a href="#cb116-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visueller  *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb116-302"><a href="#cb116-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-303"><a href="#cb116-303" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb116-304"><a href="#cb116-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x_fct =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),  </span>
<span id="cb116-305"><a href="#cb116-305" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_normal =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="dv">5</span>),</span>
<span id="cb116-306"><a href="#cb116-306" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd_normal =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb116-307"><a href="#cb116-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x_fct, mean_normal, <span class="at">fill =</span> x_fct) <span class="sc">+</span></span>
<span id="cb116-308"><a href="#cb116-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb116-309"><a href="#cb116-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_normal<span class="sc">-</span>(sd_normal), </span>
<span id="cb116-310"><a href="#cb116-310" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_normal<span class="sc">+</span>(sd_normal)),</span>
<span id="cb116-311"><a href="#cb116-311" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb116-312"><a href="#cb116-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Behandlungsgruppen (X)"</span>, <span class="at">y =</span> <span class="st">"Mittler Messwert (Y)"</span>,</span>
<span id="cb116-313"><a href="#cb116-313" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Varianzhomogenität"</span>, <span class="at">subtitle =</span> <span class="st">"Varianzen sind gleich"</span>)  <span class="sc">+</span></span>
<span id="cb116-314"><a href="#cb116-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb116-315"><a href="#cb116-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-316"><a href="#cb116-316" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb116-317"><a href="#cb116-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x_fct =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),  </span>
<span id="cb116-318"><a href="#cb116-318" aria-hidden="true" tabindex="-1"></a>         <span class="at">mean_normal =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="dv">5</span>),</span>
<span id="cb116-319"><a href="#cb116-319" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd_normal =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">1.25</span>, <span class="fl">2.5</span>)) <span class="sc">+</span></span>
<span id="cb116-320"><a href="#cb116-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x_fct, mean_normal, <span class="at">fill =</span> x_fct) <span class="sc">+</span></span>
<span id="cb116-321"><a href="#cb116-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb116-322"><a href="#cb116-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_normal<span class="sc">-</span>(sd_normal), </span>
<span id="cb116-323"><a href="#cb116-323" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_normal<span class="sc">+</span>(sd_normal)),</span>
<span id="cb116-324"><a href="#cb116-324" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb116-325"><a href="#cb116-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Behandlungsgruppen (X)"</span>, <span class="at">y =</span> <span class="st">"Mittler Messwert (Y)"</span>,</span>
<span id="cb116-326"><a href="#cb116-326" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Varianzheterogenität"</span>, <span class="at">subtitle =</span> <span class="st">"Varianzen sind unterschiedlich"</span>)  <span class="sc">+</span></span>
<span id="cb116-327"><a href="#cb116-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb116-328"><a href="#cb116-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-329"><a href="#cb116-329" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb116-330"><a href="#cb116-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb116-331"><a href="#cb116-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb116-332"><a href="#cb116-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb116-333"><a href="#cb116-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb116-334"><a href="#cb116-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-335"><a href="#cb116-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-336"><a href="#cb116-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-339"><a href="#cb116-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-340"><a href="#cb116-340" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-341"><a href="#cb116-341" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb116-342"><a href="#cb116-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-343"><a href="#cb116-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-344"><a href="#cb116-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-posthoc-var-homo-box</span></span>
<span id="cb116-345"><a href="#cb116-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-346"><a href="#cb116-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb116-347"><a href="#cb116-347" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb116-348"><a href="#cb116-348" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visueller  *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb116-349"><a href="#cb116-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-350"><a href="#cb116-350" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb116-351"><a href="#cb116-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x_fct =</span> <span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)),  </span>
<span id="cb116-352"><a href="#cb116-352" aria-hidden="true" tabindex="-1"></a>         <span class="at">y_val =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.75</span>,</span>
<span id="cb116-353"><a href="#cb116-353" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">1.25</span>, <span class="dv">2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="fl">3.75</span>,</span>
<span id="cb116-354"><a href="#cb116-354" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">3.75</span>, <span class="fl">4.5</span>, <span class="dv">5</span>, <span class="fl">5.5</span>, <span class="fl">6.25</span>)) <span class="sc">+</span></span>
<span id="cb116-355"><a href="#cb116-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x_fct, y_val, <span class="at">fill =</span> x_fct) <span class="sc">+</span></span>
<span id="cb116-356"><a href="#cb116-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb116-357"><a href="#cb116-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Behandlungsgruppen (X)"</span>, <span class="at">y =</span> <span class="st">"Mittler Messwert (Y)"</span>,</span>
<span id="cb116-358"><a href="#cb116-358" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Varianzhomogenität"</span>, <span class="at">subtitle =</span> <span class="st">"Varianzen sind gleich"</span>) <span class="sc">+</span></span>
<span id="cb116-359"><a href="#cb116-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb116-360"><a href="#cb116-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-361"><a href="#cb116-361" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb116-362"><a href="#cb116-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x_fct =</span> <span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)),  </span>
<span id="cb116-363"><a href="#cb116-363" aria-hidden="true" tabindex="-1"></a>         <span class="at">y_val =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="fl">2.5</span>,</span>
<span id="cb116-364"><a href="#cb116-364" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">2.5</span>, <span class="dv">4</span>, <span class="fl">6.5</span>,</span>
<span id="cb116-365"><a href="#cb116-365" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb116-366"><a href="#cb116-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x_fct, y_val, <span class="at">fill =</span> x_fct) <span class="sc">+</span></span>
<span id="cb116-367"><a href="#cb116-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb116-368"><a href="#cb116-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Behandlungsgruppen (X)"</span>, <span class="at">y =</span> <span class="st">"Mittler Messwert (Y)"</span>,</span>
<span id="cb116-369"><a href="#cb116-369" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Varianzheterogenität"</span>, <span class="at">subtitle =</span> <span class="st">"Varianzen sind unterschiedlich"</span>)  <span class="sc">+</span></span>
<span id="cb116-370"><a href="#cb116-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">8</span>)</span>
<span id="cb116-371"><a href="#cb116-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-372"><a href="#cb116-372" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb116-373"><a href="#cb116-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb116-374"><a href="#cb116-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb116-375"><a href="#cb116-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb116-376"><a href="#cb116-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb116-377"><a href="#cb116-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-378"><a href="#cb116-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-379"><a href="#cb116-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-380"><a href="#cb116-380" aria-hidden="true" tabindex="-1"></a><span class="fu">## `geom_bar()`</span></span>
<span id="cb116-381"><a href="#cb116-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-382"><a href="#cb116-382" aria-hidden="true" tabindex="-1"></a>Das hier ist natürlich nochmal eien Wiederholung des <span class="co">[</span><span class="ot">Kapitels zur Visualisierung von Daten</span><span class="co">](#sec-eda-ggplot)</span></span>
<span id="cb116-383"><a href="#cb116-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-384"><a href="#cb116-384" aria-hidden="true" tabindex="-1"></a><span class="fu">### Einfaktorieller Barplot</span></span>
<span id="cb116-385"><a href="#cb116-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-388"><a href="#cb116-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-389"><a href="#cb116-389" aria-hidden="true" tabindex="-1"></a>stat_fac1_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb116-390"><a href="#cb116-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">|&gt;</span> </span>
<span id="cb116-391"><a href="#cb116-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb116-392"><a href="#cb116-392" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(jump_length))</span>
<span id="cb116-393"><a href="#cb116-393" aria-hidden="true" tabindex="-1"></a>stat_fac1_tbl</span>
<span id="cb116-394"><a href="#cb116-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-395"><a href="#cb116-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-398"><a href="#cb116-398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-399"><a href="#cb116-399" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-400"><a href="#cb116-400" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-401"><a href="#cb116-401" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-402"><a href="#cb116-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-posthoc-barplot-1fac</span></span>
<span id="cb116-403"><a href="#cb116-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-404"><a href="#cb116-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb116-405"><a href="#cb116-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb116-406"><a href="#cb116-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "foo."</span></span>
<span id="cb116-407"><a href="#cb116-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-408"><a href="#cb116-408" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_fac1_tbl, </span>
<span id="cb116-409"><a href="#cb116-409" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb116-410"><a href="#cb116-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-411"><a href="#cb116-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb116-412"><a href="#cb116-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb116-413"><a href="#cb116-413" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb116-414"><a href="#cb116-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb116-415"><a href="#cb116-415" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb116-416"><a href="#cb116-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb116-417"><a href="#cb116-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb116-418"><a href="#cb116-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-419"><a href="#cb116-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-420"><a href="#cb116-420" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zweifaktorieller Barplot</span></span>
<span id="cb116-421"><a href="#cb116-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-424"><a href="#cb116-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-425"><a href="#cb116-425" aria-hidden="true" tabindex="-1"></a>stat_fac2_tbl <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb116-426"><a href="#cb116-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal, site) <span class="sc">|&gt;</span> </span>
<span id="cb116-427"><a href="#cb116-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb116-428"><a href="#cb116-428" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(jump_length))</span>
<span id="cb116-429"><a href="#cb116-429" aria-hidden="true" tabindex="-1"></a>stat_fac2_tbl</span>
<span id="cb116-430"><a href="#cb116-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-431"><a href="#cb116-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-434"><a href="#cb116-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-435"><a href="#cb116-435" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-436"><a href="#cb116-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-437"><a href="#cb116-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-438"><a href="#cb116-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-posthoc-barplot-2fac</span></span>
<span id="cb116-439"><a href="#cb116-439" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-440"><a href="#cb116-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb116-441"><a href="#cb116-441" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb116-442"><a href="#cb116-442" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "foo."</span></span>
<span id="cb116-443"><a href="#cb116-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-444"><a href="#cb116-444" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_fac2_tbl, </span>
<span id="cb116-445"><a href="#cb116-445" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb116-446"><a href="#cb116-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-447"><a href="#cb116-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.9</span>, </span>
<span id="cb116-448"><a href="#cb116-448" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb116-449"><a href="#cb116-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb116-450"><a href="#cb116-450" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb116-451"><a href="#cb116-451" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb116-452"><a href="#cb116-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb116-453"><a href="#cb116-453" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>,</span>
<span id="cb116-454"><a href="#cb116-454" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb116-455"><a href="#cb116-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb116-456"><a href="#cb116-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-457"><a href="#cb116-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-458"><a href="#cb116-458" aria-hidden="true" tabindex="-1"></a><span class="fu">## `geom_boxplot()`</span></span>
<span id="cb116-459"><a href="#cb116-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-460"><a href="#cb116-460" aria-hidden="true" tabindex="-1"></a><span class="fu">### Einfaktorieller Boxplot</span></span>
<span id="cb116-461"><a href="#cb116-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-464"><a href="#cb116-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-465"><a href="#cb116-465" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-466"><a href="#cb116-466" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-467"><a href="#cb116-467" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-468"><a href="#cb116-468" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-posthoc-boxplot-1fac</span></span>
<span id="cb116-469"><a href="#cb116-469" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-470"><a href="#cb116-470" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb116-471"><a href="#cb116-471" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb116-472"><a href="#cb116-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "foo."</span></span>
<span id="cb116-473"><a href="#cb116-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-474"><a href="#cb116-474" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb116-475"><a href="#cb116-475" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb116-476"><a href="#cb116-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-477"><a href="#cb116-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb116-478"><a href="#cb116-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb116-479"><a href="#cb116-479" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb116-480"><a href="#cb116-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb116-481"><a href="#cb116-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb116-482"><a href="#cb116-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-483"><a href="#cb116-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-484"><a href="#cb116-484" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zweifaktorieller Boxplot</span></span>
<span id="cb116-485"><a href="#cb116-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-488"><a href="#cb116-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-489"><a href="#cb116-489" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-490"><a href="#cb116-490" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-491"><a href="#cb116-491" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-492"><a href="#cb116-492" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-posthoc-boxplot-2fac</span></span>
<span id="cb116-493"><a href="#cb116-493" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-494"><a href="#cb116-494" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb116-495"><a href="#cb116-495" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb116-496"><a href="#cb116-496" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "foo."</span></span>
<span id="cb116-497"><a href="#cb116-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-498"><a href="#cb116-498" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac2_tbl, </span>
<span id="cb116-499"><a href="#cb116-499" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb116-500"><a href="#cb116-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-501"><a href="#cb116-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb116-502"><a href="#cb116-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb116-503"><a href="#cb116-503" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>,</span>
<span id="cb116-504"><a href="#cb116-504" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb116-505"><a href="#cb116-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb116-506"><a href="#cb116-506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-507"><a href="#cb116-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-508"><a href="#cb116-508" aria-hidden="true" tabindex="-1"></a><span class="fu">## Excel</span></span>
<span id="cb116-509"><a href="#cb116-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-510"><a href="#cb116-510" aria-hidden="true" tabindex="-1"></a>Dann habe ich mich doch noch hingesetzt und einmal für dich die Videos gemacht, wie du dann einen Barplot oder eben ein Säulendigramm in Excel erstellst. Daran kannst du natürlich auch überprüfen, ob die Variazen homogen sind oder nicht. Das ganze macht dann nur als Video Sinn, denn sonst kannst du ja nicht nachvollziehen, was ich geklickt habe.</span>
<span id="cb116-511"><a href="#cb116-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-512"><a href="#cb116-512" aria-hidden="true" tabindex="-1"></a>Hier also erstmal die einfachere Variante mit dem 1-faktoriellen Barplot. Beginnen wollen wir wie immer mit der Berechnung der Mittelwerte und der Standardabweichung. Bitte nutze für die Standardabweichung die Funktion <span class="in">`STABW.S()`</span> in Excel.</span>
<span id="cb116-513"><a href="#cb116-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-514"><a href="#cb116-514" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/UdZ5p8euo64 &gt;}}</span>
<span id="cb116-515"><a href="#cb116-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-516"><a href="#cb116-516" aria-hidden="true" tabindex="-1"></a>Und im Anschluss nochmal das Video für den 2-faktoriellen Barplot. Du hast jetzt eben nicht nur eine Behandlungsgruppe vorliegen sondern zwei Behandlungsgruppen. Dann musst du etwas mehr Arbeit reinstecken um alle Mittelwerte und Standardabweichungen zu berechnen. Bitte nutze auch hier für die Standardabweichung die Funktion <span class="in">`STABW.S()`</span> in Excel.</span>
<span id="cb116-517"><a href="#cb116-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-518"><a href="#cb116-518" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/mGSMZ6C7x4E &gt;}}</span>
<span id="cb116-519"><a href="#cb116-519" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-520"><a href="#cb116-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-521"><a href="#cb116-521" aria-hidden="true" tabindex="-1"></a><span class="fu">## Der effektive Pfad mit `{emmeans}`</span></span>
<span id="cb116-522"><a href="#cb116-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-523"><a href="#cb116-523" aria-hidden="true" tabindex="-1"></a>Text</span>
<span id="cb116-524"><a href="#cb116-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-525"><a href="#cb116-525" aria-hidden="true" tabindex="-1"></a>Varianzhomogenität oder Varianzheterogenität</span>
<span id="cb116-526"><a href="#cb116-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-527"><a href="#cb116-527" aria-hidden="true" tabindex="-1"></a>:   Wir können in <span class="in">`{emmeans}`</span> eine mögliche Varianzheterogenität modellieren, wenn wir das nicht tun, dann rechnet <span class="in">`{emmeans}`</span> immer unter der Annahme von Varianzhomogenität. Wenn du nicht für die Varianzheterogenität adjustieren möchtest, dann rechnest du faktisch einen Tukey HSD Test. Der Tukey HSD Test rechnet *immer* mit Varianzhomogenität. In allen Beispielen hier, werde ich aber für Varianzheterogenität adjustieren. Dazu nutze ich dann die Option <span class="in">`vcov. = sandwich::vcovHAC`</span> im <span class="in">`emmeans()`</span> Funktionsaufruf. In dem R Paket <span class="in">`{sandwich}`</span> gibt es eine riesige Anzahl an möglichen Funktionen um für Varianzheterogenität zu adjustieren. Wir nutzen hier die Option <span class="in">`vcovHAC`</span>, die in vielen Fällen vollkommen ausrichend ist.</span>
<span id="cb116-528"><a href="#cb116-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-529"><a href="#cb116-529" aria-hidden="true" tabindex="-1"></a>Adjustierung für multiple Vergleiche</span>
<span id="cb116-530"><a href="#cb116-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-531"><a href="#cb116-531" aria-hidden="true" tabindex="-1"></a>:   Das Paket <span class="in">`{emmeans}`</span> kann sehr einfach für die Adjustierung von multiplen Vergleichen angepasst werden um adjustierte p-Werte zu erhalten. In der Standardeinstellung nutzt <span class="in">`{emmeans}`</span> die Quartile aus einem Tukey HSD Test und somit ist <span class="in">`{emmeans}`</span> gar nicht so weit weg von dem Tukey HSD Test. Ich stelle aber meistens die Adjustierung auf Bonferroniadjustierung mit der Option <span class="in">`adjust = "bonferroni"`</span>, da diese Adjustierung etwas eingängiger ist. Das bleibt aber dir überlassen, ob du überhaupt eine Adustierung wählen willst. Mit der Option <span class="in">`adjust = "none"`</span> stellst du die Adjustierung für multiple Vergleiche aus. Du erhälst die rohen p-Werte.</span>
<span id="cb116-532"><a href="#cb116-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-533"><a href="#cb116-533" aria-hidden="true" tabindex="-1"></a>Mögliche multiple Vergleiche</span>
<span id="cb116-534"><a href="#cb116-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-535"><a href="#cb116-535" aria-hidden="true" tabindex="-1"></a>:   Wir können auch eine andere Kontrolle wählen <span class="in">`contrast(method = "trt.vs.ctrl", ref = "fox")`</span></span>
<span id="cb116-536"><a href="#cb116-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-537"><a href="#cb116-537" aria-hidden="true" tabindex="-1"></a>Fallzahl in den einzelnen Behandlungsgruppen</span>
<span id="cb116-538"><a href="#cb116-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-539"><a href="#cb116-539" aria-hidden="true" tabindex="-1"></a>:   text</span>
<span id="cb116-540"><a href="#cb116-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-541"><a href="#cb116-541" aria-hidden="true" tabindex="-1"></a><span class="fu">### Einfaktorielle Analyse</span></span>
<span id="cb116-542"><a href="#cb116-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-545"><a href="#cb116-545" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-546"><a href="#cb116-546" aria-hidden="true" tabindex="-1"></a>fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb116-547"><a href="#cb116-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-548"><a href="#cb116-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-551"><a href="#cb116-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-552"><a href="#cb116-552" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj <span class="ot">&lt;-</span> fac1_fit <span class="sc">|&gt;</span>  </span>
<span id="cb116-553"><a href="#cb116-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) </span>
<span id="cb116-554"><a href="#cb116-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-555"><a href="#cb116-555" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj</span>
<span id="cb116-556"><a href="#cb116-556" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-557"><a href="#cb116-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-558"><a href="#cb116-558" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb116-559"><a href="#cb116-559" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte</span></span>
<span id="cb116-560"><a href="#cb116-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-563"><a href="#cb116-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-564"><a href="#cb116-564" aria-hidden="true" tabindex="-1"></a>comp_fac1_obj <span class="ot">&lt;-</span> emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-565"><a href="#cb116-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) </span>
<span id="cb116-566"><a href="#cb116-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-567"><a href="#cb116-567" aria-hidden="true" tabindex="-1"></a>comp_fac1_obj</span>
<span id="cb116-568"><a href="#cb116-568" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-569"><a href="#cb116-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-572"><a href="#cb116-572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-573"><a href="#cb116-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-574"><a href="#cb116-574" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-575"><a href="#cb116-575" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-576"><a href="#cb116-576" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-577"><a href="#cb116-577" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb116-578"><a href="#cb116-578" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb116-579"><a href="#cb116-579" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Ergebnisse im Pairwise P-value plot."</span></span>
<span id="cb116-580"><a href="#cb116-580" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-3</span></span>
<span id="cb116-581"><a href="#cb116-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-582"><a href="#cb116-582" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-583"><a href="#cb116-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpp</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">+</span></span>
<span id="cb116-584"><a href="#cb116-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-585"><a href="#cb116-585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-586"><a href="#cb116-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-589"><a href="#cb116-589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-590"><a href="#cb116-590" aria-hidden="true" tabindex="-1"></a>emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-591"><a href="#cb116-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb116-592"><a href="#cb116-592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-593"><a href="#cb116-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-594"><a href="#cb116-594" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact Letter Display*</span></span>
<span id="cb116-595"><a href="#cb116-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-598"><a href="#cb116-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-599"><a href="#cb116-599" aria-hidden="true" tabindex="-1"></a>emm_fac1_cld <span class="ot">&lt;-</span> emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-600"><a href="#cb116-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb116-601"><a href="#cb116-601" aria-hidden="true" tabindex="-1"></a>emm_fac1_cld</span>
<span id="cb116-602"><a href="#cb116-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-603"><a href="#cb116-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-606"><a href="#cb116-606" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-607"><a href="#cb116-607" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-608"><a href="#cb116-608" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-609"><a href="#cb116-609" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-610"><a href="#cb116-610" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-611"><a href="#cb116-611" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb116-612"><a href="#cb116-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb116-613"><a href="#cb116-613" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "foo."</span></span>
<span id="cb116-614"><a href="#cb116-614" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-fac1-cld</span></span>
<span id="cb116-615"><a href="#cb116-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-616"><a href="#cb116-616" aria-hidden="true" tabindex="-1"></a>emm_fac1_cld <span class="sc">|&gt;</span> </span>
<span id="cb116-617"><a href="#cb116-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb116-618"><a href="#cb116-618" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">7</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb116-619"><a href="#cb116-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> emmean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb116-620"><a href="#cb116-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-621"><a href="#cb116-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb116-622"><a href="#cb116-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb116-623"><a href="#cb116-623" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb116-624"><a href="#cb116-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb116-625"><a href="#cb116-625" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb116-626"><a href="#cb116-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb116-627"><a href="#cb116-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb116-628"><a href="#cb116-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="fl">0.5</span>),</span>
<span id="cb116-629"><a href="#cb116-629" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="dv">2</span>)</span>
<span id="cb116-630"><a href="#cb116-630" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-631"><a href="#cb116-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-632"><a href="#cb116-632" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall</span></span>
<span id="cb116-633"><a href="#cb116-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-636"><a href="#cb116-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-637"><a href="#cb116-637" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-638"><a href="#cb116-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-639"><a href="#cb116-639" aria-hidden="true" tabindex="-1"></a>res_fac1_ci_obj <span class="ot">&lt;-</span> emm_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-640"><a href="#cb116-640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb116-641"><a href="#cb116-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb116-642"><a href="#cb116-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, adj.p.value, conf.low, conf.high) <span class="sc">|&gt;</span> </span>
<span id="cb116-643"><a href="#cb116-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">4</span>))</span>
<span id="cb116-644"><a href="#cb116-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-645"><a href="#cb116-645" aria-hidden="true" tabindex="-1"></a>res_fac1_ci_obj</span>
<span id="cb116-646"><a href="#cb116-646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-647"><a href="#cb116-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-650"><a href="#cb116-650" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-651"><a href="#cb116-651" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-652"><a href="#cb116-652" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-653"><a href="#cb116-653" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-654"><a href="#cb116-654" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-655"><a href="#cb116-655" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb116-656"><a href="#cb116-656" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb116-657"><a href="#cb116-657" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Die 95% Konfidenzintervalle für den *allpair*-Vergleich des simplen Datensatzes.</span></span>
<span id="cb116-658"><a href="#cb116-658" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-1</span></span>
<span id="cb116-659"><a href="#cb116-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-660"><a href="#cb116-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(res_fac1_ci_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high)) <span class="sc">+</span></span>
<span id="cb116-661"><a href="#cb116-661" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb116-662"><a href="#cb116-662" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb116-663"><a href="#cb116-663" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-664"><a href="#cb116-664" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb116-665"><a href="#cb116-665" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb116-666"><a href="#cb116-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-667"><a href="#cb116-667" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-668"><a href="#cb116-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-669"><a href="#cb116-669" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zweifaktorielle Analyse</span></span>
<span id="cb116-670"><a href="#cb116-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-671"><a href="#cb116-671" aria-hidden="true" tabindex="-1"></a>Modell</span>
<span id="cb116-672"><a href="#cb116-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-673"><a href="#cb116-673" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-674"><a href="#cb116-674" aria-hidden="true" tabindex="-1"></a>y \sim f_1 + f_2 + f_1 \times f_2</span>
<span id="cb116-675"><a href="#cb116-675" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-676"><a href="#cb116-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-679"><a href="#cb116-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-680"><a href="#cb116-680" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span>
<span id="cb116-681"><a href="#cb116-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-682"><a href="#cb116-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-683"><a href="#cb116-683" aria-hidden="true" tabindex="-1"></a>Wir müssen uns jetzt entscheiden wie wir die beiden Faktoren $f_1$ mit <span class="in">`animal`</span> und $f_2$ mit <span class="in">`site`</span> auswerten wollen. Wir können den Faktor <span class="in">`animal`</span> getrennt für jedes Level des Faktors <span class="in">`site`</span> vergleichen oder wir vergleichen alle Faktorkombinationen gemeinsam.</span>
<span id="cb116-684"><a href="#cb116-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-685"><a href="#cb116-685" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb116-686"><a href="#cb116-686" aria-hidden="true" tabindex="-1"></a><span class="fu">## Getrennt für $f_1$ und $f_2$ mit $\boxed{\sim f_1 | f_2}$</span></span>
<span id="cb116-687"><a href="#cb116-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-690"><a href="#cb116-690" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-691"><a href="#cb116-691" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj <span class="ot">&lt;-</span> fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb116-692"><a href="#cb116-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) </span>
<span id="cb116-693"><a href="#cb116-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-694"><a href="#cb116-694" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj</span>
<span id="cb116-695"><a href="#cb116-695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-696"><a href="#cb116-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-697"><a href="#cb116-697" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gemeinsam für $f_1$ und $f_2$ mit $\boxed{\sim f_1 * f_2}$</span></span>
<span id="cb116-698"><a href="#cb116-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-701"><a href="#cb116-701" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-702"><a href="#cb116-702" aria-hidden="true" tabindex="-1"></a>emm_fac2_combinded_obj <span class="ot">&lt;-</span> fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb116-703"><a href="#cb116-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">*</span> site, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) </span>
<span id="cb116-704"><a href="#cb116-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-705"><a href="#cb116-705" aria-hidden="true" tabindex="-1"></a>emm_fac2_combinded_obj</span>
<span id="cb116-706"><a href="#cb116-706" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-707"><a href="#cb116-707" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-708"><a href="#cb116-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-709"><a href="#cb116-709" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb116-710"><a href="#cb116-710" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte</span></span>
<span id="cb116-711"><a href="#cb116-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-714"><a href="#cb116-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-715"><a href="#cb116-715" aria-hidden="true" tabindex="-1"></a>comp_fac2_separate_obj <span class="ot">&lt;-</span> emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-716"><a href="#cb116-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb116-717"><a href="#cb116-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-718"><a href="#cb116-718" aria-hidden="true" tabindex="-1"></a>comp_fac2_separate_obj</span>
<span id="cb116-719"><a href="#cb116-719" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-720"><a href="#cb116-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-723"><a href="#cb116-723" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-724"><a href="#cb116-724" aria-hidden="true" tabindex="-1"></a>comp_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-725"><a href="#cb116-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">|&gt;</span> </span>
<span id="cb116-726"><a href="#cb116-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb116-727"><a href="#cb116-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, site, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb116-728"><a href="#cb116-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">format.pval</span>(p.value, <span class="at">eps =</span> <span class="fl">0.001</span>, <span class="at">digits =</span> <span class="dv">2</span>))</span>
<span id="cb116-729"><a href="#cb116-729" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-730"><a href="#cb116-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-731"><a href="#cb116-731" aria-hidden="true" tabindex="-1"></a>Hier müssen wir dann nochmal emmeans aufrufen! Wir machen das hier nochmal für getrennt.</span>
<span id="cb116-732"><a href="#cb116-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-735"><a href="#cb116-735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-736"><a href="#cb116-736" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-737"><a href="#cb116-737" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-738"><a href="#cb116-738" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-739"><a href="#cb116-739" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-740"><a href="#cb116-740" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb116-741"><a href="#cb116-741" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb116-742"><a href="#cb116-742" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Ergebnisse im Pairwise P-value plot."</span></span>
<span id="cb116-743"><a href="#cb116-743" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-foo-2</span></span>
<span id="cb116-744"><a href="#cb116-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-745"><a href="#cb116-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-746"><a href="#cb116-746" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-747"><a href="#cb116-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpp</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">+</span></span>
<span id="cb116-748"><a href="#cb116-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-749"><a href="#cb116-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-750"><a href="#cb116-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-751"><a href="#cb116-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-754"><a href="#cb116-754" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-755"><a href="#cb116-755" aria-hidden="true" tabindex="-1"></a>emm_fac2_separate_obj <span class="sc">|&gt;</span>   </span>
<span id="cb116-756"><a href="#cb116-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb116-757"><a href="#cb116-757" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-758"><a href="#cb116-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-759"><a href="#cb116-759" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact Letter Display*</span></span>
<span id="cb116-760"><a href="#cb116-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-763"><a href="#cb116-763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-764"><a href="#cb116-764" aria-hidden="true" tabindex="-1"></a>emm_fac2_cld <span class="ot">&lt;-</span> emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-765"><a href="#cb116-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb116-766"><a href="#cb116-766" aria-hidden="true" tabindex="-1"></a>emm_fac2_cld</span>
<span id="cb116-767"><a href="#cb116-767" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-768"><a href="#cb116-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-769"><a href="#cb116-769" aria-hidden="true" tabindex="-1"></a>Hier dann noch die Implementierung mit geom text</span>
<span id="cb116-770"><a href="#cb116-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-773"><a href="#cb116-773" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-774"><a href="#cb116-774" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-775"><a href="#cb116-775" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-776"><a href="#cb116-776" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-777"><a href="#cb116-777" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-778"><a href="#cb116-778" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb116-779"><a href="#cb116-779" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb116-780"><a href="#cb116-780" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "foo."</span></span>
<span id="cb116-781"><a href="#cb116-781" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-fac2-cld</span></span>
<span id="cb116-782"><a href="#cb116-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-783"><a href="#cb116-783" aria-hidden="true" tabindex="-1"></a>emm_fac2_cld <span class="sc">|&gt;</span> </span>
<span id="cb116-784"><a href="#cb116-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb116-785"><a href="#cb116-785" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">7</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb116-786"><a href="#cb116-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> site, <span class="at">y =</span> emmean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb116-787"><a href="#cb116-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-788"><a href="#cb116-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.9</span>, </span>
<span id="cb116-789"><a href="#cb116-789" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb116-790"><a href="#cb116-790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb116-791"><a href="#cb116-791" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb116-792"><a href="#cb116-792" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb116-793"><a href="#cb116-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb116-794"><a href="#cb116-794" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>,</span>
<span id="cb116-795"><a href="#cb116-795" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb116-796"><a href="#cb116-796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb116-797"><a href="#cb116-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb116-798"><a href="#cb116-798" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>))</span>
<span id="cb116-799"><a href="#cb116-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-800"><a href="#cb116-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-801"><a href="#cb116-801" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall</span></span>
<span id="cb116-802"><a href="#cb116-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-805"><a href="#cb116-805" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-806"><a href="#cb116-806" aria-hidden="true" tabindex="-1"></a>comp_fac2_ci_obj <span class="ot">&lt;-</span> emm_fac2_separate_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-807"><a href="#cb116-807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb116-808"><a href="#cb116-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">confint</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb116-809"><a href="#cb116-809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb116-810"><a href="#cb116-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, site, estimate, <span class="at">conf.low =</span> lower.CL, <span class="at">conf.high =</span> upper.CL) </span>
<span id="cb116-811"><a href="#cb116-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-812"><a href="#cb116-812" aria-hidden="true" tabindex="-1"></a>comp_fac2_ci_obj </span>
<span id="cb116-813"><a href="#cb116-813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-814"><a href="#cb116-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-817"><a href="#cb116-817" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-818"><a href="#cb116-818" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-819"><a href="#cb116-819" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-820"><a href="#cb116-820" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-821"><a href="#cb116-821" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-822"><a href="#cb116-822" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb116-823"><a href="#cb116-823" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb116-824"><a href="#cb116-824" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Die 95% Konfidenzintervalle für den *allpair*-Vergleich des Models mit Interaktionseffekt.</span></span>
<span id="cb116-825"><a href="#cb116-825" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-2</span></span>
<span id="cb116-826"><a href="#cb116-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-827"><a href="#cb116-827" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comp_fac2_ci_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high,</span>
<span id="cb116-828"><a href="#cb116-828" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> site, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb116-829"><a href="#cb116-829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb116-830"><a href="#cb116-830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb116-831"><a href="#cb116-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb116-832"><a href="#cb116-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb116-833"><a href="#cb116-833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb116-834"><a href="#cb116-834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb116-835"><a href="#cb116-835" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-836"><a href="#cb116-836" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-837"><a href="#cb116-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-838"><a href="#cb116-838" aria-hidden="true" tabindex="-1"></a><span class="fu">## Der ANOVA Pfad mit Tukey HSD</span></span>
<span id="cb116-839"><a href="#cb116-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-840"><a href="#cb116-840" aria-hidden="true" tabindex="-1"></a>Der Tukey HSD Test (abk. *HSD Test*) hat viele Namen. Im Englischen kennen wir den Tukey HSD Test auch als *Tukey's range test* oder aber als *Tukey's test*, *Tukey method*, *Tukey's honest significance test* oder eben *Tukey's HSD (honestly significant difference)* Test. Dabei steht die Abkürzung HDS für *honestly significant difference* (deu. *ehrlich signifikanter Unterschied*). Für mich etwas weit aus dem Fenster gelehnt, aber der Name sagt hier mal was auch wirklich gemacht wird. Im Prinzip stellen wir nur die Formel von den Student t-Test einmal um und benennen alles neu. Dann sieht man auch nicht gleich, was Sache ist und jeder denkt, es wäre was Neues. Wir werden hier aber mal den Tukey HSD Test zerforschen. Wir nutzen aber die ANOVA um einmal die Streuung und die Effekte zu berechnen. Daher nenne ich das ganze hier auch den ANOVA Pfad. Der Tukey HSD Test basiert eben mehr oder minder auf der Ausgabe einer ANOVA. Mehr Informationen gibt es auch im Tutorial <span class="co">[</span><span class="ot">Post-Hoc Analysis with Tukey’s Test</span><span class="co">](https://rpubs.com/aaronsc32/post-hoc-analysis-tukey)</span>. Ach, der Tukey HSD Test ist schon etwas älter und kann nicht so viel wie neuere Implementierungen wie das R Paket <span class="in">`{emmeans}`</span> und <span class="in">`{multcomp}`</span>.</span>
<span id="cb116-841"><a href="#cb116-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-842"><a href="#cb116-842" aria-hidden="true" tabindex="-1"></a>Varianzhomogenität</span>
<span id="cb116-843"><a href="#cb116-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-844"><a href="#cb116-844" aria-hidden="true" tabindex="-1"></a>:   Es ist wichtig zu wissen, dass der Tukey HSD Test auf der ANOVA basiert und die ANOVA nimmt Varianzhomogenität an. Damit meine ich, dass alle Gruppen in der Behandlung die gleiche Varianz haben. Du kannst leider den Tukey HSD Test nur unter der Annahme von varianzhomogenität nutzen. Wenn das dir eine zu starke Annahme ist, dann nutze einfach das R Paket <span class="in">`{emmeans}`</span>, wie ich es dir weiter unten im Kapitel vorstelle.</span>
<span id="cb116-845"><a href="#cb116-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-846"><a href="#cb116-846" aria-hidden="true" tabindex="-1"></a>Adjustierung für multiple Vergleiche</span>
<span id="cb116-847"><a href="#cb116-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-848"><a href="#cb116-848" aria-hidden="true" tabindex="-1"></a>:   Der Tukey HSD Test adjustiert für die $\alpha$-Inflation bei multiplen Vergleichen. Wir müssen da auch nichts weiter machen um die Adjustierung durchzuführe. Das macht die Funktion <span class="in">`TukeyHSD()`</span> für uns automatisch. Auf der anderen Seite können wir die Adjustierung für multiple Vergleiche aber auch nicht ausschalten. Du erhälst *immer* adjustierte p-Werte aus einem Tukey HSD Test. Wenn du das nicht möchtest, dann nutze einfach das R Paket <span class="in">`{emmeans}`</span>, welches du weiter unten findest.</span>
<span id="cb116-849"><a href="#cb116-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-850"><a href="#cb116-850" aria-hidden="true" tabindex="-1"></a>Mögliche multiple Vergleiche</span>
<span id="cb116-851"><a href="#cb116-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-852"><a href="#cb116-852" aria-hidden="true" tabindex="-1"></a>:   Wir können immer nur alle Gruppen mit allen anderen Gruppen vergleichen. Wir rechnen also einen *all pair* Vergleich. Wenn du zum Beispiel nur die Behandlungsgruppen zur Kontrolle vergleichen willst, aber nciht untereinander, dann ist das nicht mit dem Tukey HDS Test möglich. Dafür musst du dann das R Paket <span class="in">`{ememans}`</span> oder für noch komplexere Gruppenvergleiche das R Paket <span class="in">`{multcomp}`</span> nutzen.</span>
<span id="cb116-853"><a href="#cb116-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-854"><a href="#cb116-854" aria-hidden="true" tabindex="-1"></a>Fallzahl in den einzelnen Behandlungsgruppen</span>
<span id="cb116-855"><a href="#cb116-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-856"><a href="#cb116-856" aria-hidden="true" tabindex="-1"></a>:   Der Tukey HSD Test geht von einem balancierten Design aus. Daher brauchen wir in allen Behandlungsgruppen die gleiche Anzahl an Beobachtungen. Wenn wir kein balanciertes Design vorliegen haben, dann wird die Fallzahl mehr oder minder über die Gruppen gemittelt. Teilweise funktioniert dann auch der Tukey HSD Test nicht mehr richtig. Daher ist von der Nutzung es Tukey HSD Tests bei ungleich großen Gruppen abzuraten. Auch hier ist dann der Ausweg das R Paket <span class="in">`{emmeans}`</span>, welches genau für den unblancierten Fall ursprünglich entworfen wurde.</span>
<span id="cb116-857"><a href="#cb116-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-858"><a href="#cb116-858" aria-hidden="true" tabindex="-1"></a>Schauen wir uns nun einmal an, wie der Tukey HSD Test theoretisch funktioniert und wie die Implmentierugn in R dargestellt ist. Wir haben die Wahl zwischen der Funktion <span class="in">`TukeyHSD()`</span> und der Funktion <span class="in">`HSD.test()`</span> aus dem R Paket <span class="in">`{agricolae}`</span>. Die Funktion <span class="in">`HSD.test()`</span> liefert auch gleich das *Compact letter display* in der Ausgabe mit. Sonst sind die beiden Funktionen sehr ähnlich. Oft wird eben der Tukey HSD Test noch verwendet, weil er eben sehr alt ist und somit schon sehr lange verwendet wurde.</span>
<span id="cb116-859"><a href="#cb116-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-860"><a href="#cb116-860" aria-hidden="true" tabindex="-1"></a>::::: panel-tabset</span>
<span id="cb116-861"><a href="#cb116-861" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch</span></span>
<span id="cb116-862"><a href="#cb116-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-863"><a href="#cb116-863" aria-hidden="true" tabindex="-1"></a>Zuerst einmal die Formel des Tukey HSD Test. Wir berechnen dabei asl statistische Maßzahl den HSD-Wert, der nichts anderes aussagt als der minimal Mittelwertsunterschied, den wir gegeben der Streuung und der Fallzahl in den Daten als signifikant nachweisen können. Sozusagen der minimalste mögliche signifikante Mittelwertsunterschied.</span>
<span id="cb116-864"><a href="#cb116-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-865"><a href="#cb116-865" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-866"><a href="#cb116-866" aria-hidden="true" tabindex="-1"></a>HSD = q_{\alpha=5\%, k, n-k} \cdot \sqrt{\tfrac{MSE}{n}}</span>
<span id="cb116-867"><a href="#cb116-867" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-868"><a href="#cb116-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-869"><a href="#cb116-869" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb116-870"><a href="#cb116-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-871"><a href="#cb116-871" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$HSD$, den zu berechnenden minimalst möglichen signifikanten Mittelwertsunterschied.</span>
<span id="cb116-872"><a href="#cb116-872" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$q_{\alpha=5\%, k, n-k}$, den kritsichen Wert gegeben aus dem Signifikanzniveau $\alpha$ gleich 5% der Anzahl an zu vergleichenden Gruppen $k$ und einem Freiheitsgrad $n-k$.</span>
<span id="cb116-873"><a href="#cb116-873" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\sqrt{\tfrac{MSE}{n}}$, der Streuung in den Daten gewichtet für die Fallzahl $n$. Hier wird die Streuung über alle Gruppen hinweg berechnet.</span>
<span id="cb116-874"><a href="#cb116-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-875"><a href="#cb116-875" aria-hidden="true" tabindex="-1"></a>Wir können uns das Ganze auch nochmal in der folgenden Tabelle als Vergleich zu dem Student t-Test anschauen. Hier dann erstmal noch die beiden Formeln.</span>
<span id="cb116-876"><a href="#cb116-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-877"><a href="#cb116-877" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-878"><a href="#cb116-878" aria-hidden="true" tabindex="-1"></a>\begin{array}{c|c}</span>
<span id="cb116-879"><a href="#cb116-879" aria-hidden="true" tabindex="-1"></a>  HSD = q_{\alpha=5\%, k, n-k} \cdot \sqrt{\tfrac{MSE}{n}} &amp; \bar{y}_1 - \bar{y}_2 =  T_{\alpha=5\%} \cdot s_p\sqrt{\tfrac{2}{n_g}}</span>
<span id="cb116-880"><a href="#cb116-880" aria-hidden="true" tabindex="-1"></a>\end{array}</span>
<span id="cb116-881"><a href="#cb116-881" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-882"><a href="#cb116-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-883"><a href="#cb116-883" aria-hidden="true" tabindex="-1"></a>Ich habe dort einmal die statistischen Maßzahlen aus einem Tukey HDS Test den statistischen Maßzahlen eines Student t-Test in der folgenden Tabelle gegenüber gestellt. Du siehst, dass wir hier eigentlich nur eine Umstellung der t-Test Formel haben.</span>
<span id="cb116-884"><a href="#cb116-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-885"><a href="#cb116-885" aria-hidden="true" tabindex="-1"></a>|                 | Tukey HSD Test           | Student t-Test             |</span>
<span id="cb116-886"><a href="#cb116-886" aria-hidden="true" tabindex="-1"></a>|-----------------|--------------------------|----------------------------|</span>
<span id="cb116-887"><a href="#cb116-887" aria-hidden="true" tabindex="-1"></a>| Effekt          | $HSD$                    | $\bar{y}_1 - \bar{y}_2$    |</span>
<span id="cb116-888"><a href="#cb116-888" aria-hidden="true" tabindex="-1"></a>| Streuung        | $\tfrac{MSE}{n}$         | $s_p\sqrt{\tfrac{2}{n_g}}$ |</span>
<span id="cb116-889"><a href="#cb116-889" aria-hidden="true" tabindex="-1"></a>| Kritischer Wert | $q_{\alpha=5\%, k, n-k}$ | $T_{\alpha=5\%}$           |</span>
<span id="cb116-890"><a href="#cb116-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-891"><a href="#cb116-891" aria-hidden="true" tabindex="-1"></a>: Etwas wilder Vergleich vom Tukey HSD Test zum Student t-Test. Im Prinzip ist der Tukey HSD Test nur eine Umsstellung der Formel des Student t-Test. {#tbl-hds-ttest}</span>
<span id="cb116-892"><a href="#cb116-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-893"><a href="#cb116-893" aria-hidden="true" tabindex="-1"></a>Um die Idee des Tukey HDS Test zusammenzufassen, setzen wir für $q_{\alpha=5\%, k, n-k}$ den Wert ein, den wir mindestens erreichen müssen um einen signifikanten Unterschied nachweisen zu können. Bei dem Student t-Test war es meist $T_{\alpha=5\%}$ gleich $1.96$, hier ist der Wert für $q_{\alpha=5\%, k, n-k}$ natürlich anders. Dann können wir den minimalen Mittelwertsunterschied mit $\bar{y}_1 - \bar{y}_2$ oder eben $HSD$ berechnen, denn wir mindestens erreichen müssen um einen signifikanten Unetrschied nachweisen zu können. Alle Mittelwertsdifferenzen größer als der $HDS$ Wert werden dann signifikant sein und alle Mittelwertsdifferenzen kleiner als der $HDS$ Wert nicht signifikant sein.</span>
<span id="cb116-894"><a href="#cb116-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-895"><a href="#cb116-895" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb116-896"><a href="#cb116-896" aria-hidden="true" tabindex="-1"></a><span class="fu">## Entscheidung mit dem HDS Wert</span></span>
<span id="cb116-897"><a href="#cb116-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-898"><a href="#cb116-898" aria-hidden="true" tabindex="-1"></a>Wenn eine Mittelwertsdifferenz $\bar{y}_i - \bar{y}_j$ eines Gruppenvergleiches *größer* ist als der HDS Wert dann wird die Nullhypothese (H$_0$) abgelehnt. Ist die Mittelwertsdifferenz $\bar{y}_i - \bar{y}_j$ eines Gruppenvergleiches ist als der HDS Wert dann wird die Nullhypothese (H$_0$) beibehalten.</span>
<span id="cb116-899"><a href="#cb116-899" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-900"><a href="#cb116-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-901"><a href="#cb116-901" aria-hidden="true" tabindex="-1"></a><span class="fu">## Händisch</span></span>
<span id="cb116-902"><a href="#cb116-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-903"><a href="#cb116-903" aria-hidden="true" tabindex="-1"></a>Im Folgenden wollen wir einmal den Tuley HSD Test nachvollziehen. Dafür hier nochmal die Formel, die wir dann mit den entsprechenden Werten ausfüllen müssen. Wir beginnen mit dem q-Wert und erhalten den MSE Wert aus einer ANOVA.</span>
<span id="cb116-904"><a href="#cb116-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-905"><a href="#cb116-905" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-906"><a href="#cb116-906" aria-hidden="true" tabindex="-1"></a>HSD = q_{\alpha=5\%, k, n-k} \cdot \sqrt{\tfrac{MSE}{n}}</span>
<span id="cb116-907"><a href="#cb116-907" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-908"><a href="#cb116-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-909"><a href="#cb116-909" aria-hidden="true" tabindex="-1"></a>Für die semi händische Berechnung des Tukey HSD Test brauchen wir erstmal die Werte für die gesamte Fallzahl in dem Datensatz $N$, dann noch die Anzahl an Behandlungsgruppen $k$ und abschließend die Fallzahl pro Gruppe $n$. Ich nutze hier dann den Datensatz <span class="in">`fac1_tbl`</span> mit der Sprungweite von 21 Flöhen von drei Tierrassen mit jeweils sieben Beobachtungen pro Gruppe. Dann geben wir das Ganze einmal bei R ein.</span>
<span id="cb116-910"><a href="#cb116-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-913"><a href="#cb116-913" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-914"><a href="#cb116-914" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">21</span></span>
<span id="cb116-915"><a href="#cb116-915" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb116-916"><a href="#cb116-916" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">21</span> <span class="sc">/</span> <span class="dv">3</span></span>
<span id="cb116-917"><a href="#cb116-917" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-918"><a href="#cb116-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-919"><a href="#cb116-919" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`qtukey()`</span> gibt uns den q-Wert anhand des Signifikanzniveaus $1 - \alpha$ sowie der Anzahl an Gruppen $k$ und der dem Freiheitsgrad $N-k$ wieder.</span>
<span id="cb116-920"><a href="#cb116-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-923"><a href="#cb116-923" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-924"><a href="#cb116-924" aria-hidden="true" tabindex="-1"></a><span class="fu">qtukey</span>(<span class="at">p =</span> <span class="fl">0.95</span>, <span class="at">nmeans =</span> k, <span class="at">df =</span> N <span class="sc">-</span> k)</span>
<span id="cb116-925"><a href="#cb116-925" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-926"><a href="#cb116-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-927"><a href="#cb116-927" aria-hidden="true" tabindex="-1"></a>Dann brauchen wir noch den Wert für die Streuung $MSE$. Den MSE Wert könnten wir auch händisch berechnen, aber normalerweise nutzen wir auch die ANOVA um an den Wert zu gelangen. Daher hier einmal die ANOVA und wir lesen den Wert für MSE in der Ergebnistabelle ab.</span>
<span id="cb116-928"><a href="#cb116-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-931"><a href="#cb116-931" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-932"><a href="#cb116-932" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb116-933"><a href="#cb116-933" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span>
<span id="cb116-934"><a href="#cb116-934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-935"><a href="#cb116-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-936"><a href="#cb116-936" aria-hidden="true" tabindex="-1"></a>Nun wissen wir den Wert für $MSE$ mit $3.14$ aus der Tabelle der einfaktoriellen ANOVA. Dann können wir auch schon den HSD Wert anhand der Formel berechnen in dem wir die Werte einsetzen.</span>
<span id="cb116-937"><a href="#cb116-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-940"><a href="#cb116-940" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-941"><a href="#cb116-941" aria-hidden="true" tabindex="-1"></a>hsd <span class="ot">&lt;-</span> <span class="fl">3.61</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fl">3.14</span> <span class="sc">/</span> <span class="dv">7</span>)</span>
<span id="cb116-942"><a href="#cb116-942" aria-hidden="true" tabindex="-1"></a>hsd</span>
<span id="cb116-943"><a href="#cb116-943" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-944"><a href="#cb116-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-945"><a href="#cb116-945" aria-hidden="true" tabindex="-1"></a>Am Ende müssen wir dann die Mittelwertsdifferenzen unserer Tierarten mit dem HDS Wert vergleichen. Dafür ahbe ich einmal die folgende Tabelle aufgebaut. Wichtig ist hier, dass wir mit den Beträgen der Mittelwertsdifferenz rechnen, sonst macht der Vergleich zum HDS Wert keinen Sinn. Wir erhalten also zwei signifikante Vergleiche. Die Sprungweiten der Katzenflöhe unterscheiden sich von den Sprungweiten der Fuchs- und Hundeflöhe.</span>
<span id="cb116-946"><a href="#cb116-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-947"><a href="#cb116-947" aria-hidden="true" tabindex="-1"></a>| Vergleich | Mittelwertsdifferenz | HDS Testentscheidung |</span>
<span id="cb116-948"><a href="#cb116-948" aria-hidden="true" tabindex="-1"></a>|----|----|----|</span>
<span id="cb116-949"><a href="#cb116-949" aria-hidden="true" tabindex="-1"></a>| cat-dog | $4.74 - 8.13 = -3.39$ | $\mid-3.39\mid\; \geq 2.42 \rightarrow \mbox{signifikant}$ |</span>
<span id="cb116-950"><a href="#cb116-950" aria-hidden="true" tabindex="-1"></a>| fox-dog | $9.16 - 8.13 = \phantom{-}1.03$ | $\mid1.03\mid\; \geq 2.42 \rightarrow \mbox{nicht signifikant}$ |</span>
<span id="cb116-951"><a href="#cb116-951" aria-hidden="true" tabindex="-1"></a>| fox-cat | $9.16 - 4.74 = \phantom{-}4.42$ | $\mid4.42\mid\; \geq 2.42 \rightarrow \mbox{signifikant}$ |</span>
<span id="cb116-952"><a href="#cb116-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-953"><a href="#cb116-953" aria-hidden="true" tabindex="-1"></a>: Händische Testentscheidung anhand des berechneten HDS Wert und den Mittelwertsdifferenzen der drei Tierarten. Wenn eine Mittelwertsdifferenz größer ist als der HDS Wert, dann liegt ein signifikanter Unterschied vor. {#tbl-hds-ttest-händisch}</span>
<span id="cb116-954"><a href="#cb116-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-955"><a href="#cb116-955" aria-hidden="true" tabindex="-1"></a>Am Ende willst du das natürlich nicht händische machen sondern wir nutzen die Funktionen in R um uns die Testentscheidung auch mit einem p-Wert berechnen zu lassen. Ganz wichtig hier nochmal, wir glauben daran, dass die Varianz in allen drei Tierarten gleich ist. Wir haben Varianzhomogenität vorliegen.</span>
<span id="cb116-956"><a href="#cb116-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-957"><a href="#cb116-957" aria-hidden="true" tabindex="-1"></a><span class="fu">## `TukeyHSD()`</span></span>
<span id="cb116-958"><a href="#cb116-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-959"><a href="#cb116-959" aria-hidden="true" tabindex="-1"></a>Die Standardfunktion für den Tukey HDS Test ist <span class="in">`TukeyHSD()`</span>. Wir können den Tukey HSD Test mit nur einem Faktor oder zwei Faktoren rechnen. Ich stelle hier die einfaktorielle sowie zweifaktorielle Analyse einmal vor. Am Ende zeige ich dann nochmal, wie du das *Compact letter display* erhälst. Hier müssen wir noch ein zusätzliches Paket nutzen. Die Funktion `HSD.test()` aus dem Paket `{agricolae}`, die du im nächsten Tab findest, gibt dir sofort das *Compact letter display* wieder. Der Ablauf ist aber in beiden Fällen der gleiche. Wir rechnen erst eine ANOVA mit der Funktion <span class="in">`aov()`</span> um dann den Tukey HSD Test zu rechnen.</span>
<span id="cb116-960"><a href="#cb116-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-961"><a href="#cb116-961" aria-hidden="true" tabindex="-1"></a><span class="fu">### Einfaktorielle Analyse</span></span>
<span id="cb116-962"><a href="#cb116-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-963"><a href="#cb116-963" aria-hidden="true" tabindex="-1"></a>Am Anfang rechnen wir erst eine einfaktorielle ANOVA mit der Funktion <span class="in">`aov()`</span>. Wir erhalten dann alle notwendigen Informationen in dem Ausgabeobjekt für die Berechnung des Tukey HSD Test. Darüber hinaus können wir auch auch gleich schauen, ob unsere Bahendlung überhaupt einen signifkanten Einfluss auf unser Outcome der Sprunglänge hat.</span>
<span id="cb116-964"><a href="#cb116-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-967"><a href="#cb116-967" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-968"><a href="#cb116-968" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb116-969"><a href="#cb116-969" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span>
<span id="cb116-970"><a href="#cb116-970" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-971"><a href="#cb116-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-972"><a href="#cb116-972" aria-hidden="true" tabindex="-1"></a>An dem p-Wert sehen wir, dass wir einen signifikanten Effekt der Tierart <span class="in">`animal`</span> auf die Sprunglänge der Flöhe vorliegen haben. Wir können jetzt einen Tukey HSD Test rechnen um rauszufinden welche der drei Tierarten sich unterscheiden. Wir erhalten dann als Ausgabe die Mittlwertsdifferenzen zusammen mit den 95% Konfidenzintervallen und den adjustierten p-Werten.</span>
<span id="cb116-973"><a href="#cb116-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-976"><a href="#cb116-976" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-977"><a href="#cb116-977" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(fac1_av)</span>
<span id="cb116-978"><a href="#cb116-978" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj</span>
<span id="cb116-979"><a href="#cb116-979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-980"><a href="#cb116-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-981"><a href="#cb116-981" aria-hidden="true" tabindex="-1"></a>Du erhälst immer adjustierte p-Werte aus einem Tukey HSD Test. Das muss dir klar sein. Die p-Werte kannst du dann mit dem Signifikanzniveau $\alpha$ von 5% vergleichen. Wir sehen dass sich die Sprungweiten der Katzenflöhe von den Sprungweiten der Fuchs- und Hundeflöhe signifikant unterscheiden.</span>
<span id="cb116-982"><a href="#cb116-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-983"><a href="#cb116-983" aria-hidden="true" tabindex="-1"></a>Dann kannst du noch die Funktion <span class="in">`mulcompLetters()`</span> aus dem R Paket <span class="in">`{mulcompView}`</span> nutzen um dir das *Compact letter display* wiedergeben zu lassen. Das *Compact letter display* kannst du dann entsprechend zu deinen Barplots ergänzen.</span>
<span id="cb116-984"><a href="#cb116-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-987"><a href="#cb116-987" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-988"><a href="#cb116-988" aria-hidden="true" tabindex="-1"></a><span class="fu">multcompLetters</span>(<span class="fu">extract_p</span>(tukey_fac1_obj<span class="sc">$</span>animal))</span>
<span id="cb116-989"><a href="#cb116-989" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-990"><a href="#cb116-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-991"><a href="#cb116-991" aria-hidden="true" tabindex="-1"></a>Auch hier sei angemerkt, dass du dan schauen muss, ob das *Compact letter display* zu deinen Daten passt. Sind die Mittelwerte wirklich unterschiedlich? Kannst du die Unetrschiede in den Barplots erkennen? Wenn das der Fall ist, dann spricht nichts gegen die Verwendung des Tukey HSD Test.</span>
<span id="cb116-992"><a href="#cb116-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-993"><a href="#cb116-993" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zweifaktorielle Analyse</span></span>
<span id="cb116-994"><a href="#cb116-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-995"><a href="#cb116-995" aria-hidden="true" tabindex="-1"></a>Jetzt können wir die Sache etwas kürzer machen, da wir auch in einem zweifaktoriellen Fall den gleichen Weg wie im einfaktoriellen Fall durchgehen. Wir rechnen erst eine ANOVA mit den beiden Faktoren und dem Interaktinsterm, dargestellt durch den Doppelpunkt zwischen den beiden Faktoren.</span>
<span id="cb116-996"><a href="#cb116-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-999"><a href="#cb116-999" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1000"><a href="#cb116-1000" aria-hidden="true" tabindex="-1"></a>fac2_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span>
<span id="cb116-1001"><a href="#cb116-1001" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac2_av)</span>
<span id="cb116-1002"><a href="#cb116-1002" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1003"><a href="#cb116-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1004"><a href="#cb116-1004" aria-hidden="true" tabindex="-1"></a>In diesem Fall finden wir eine signifikante Interaktion. Daher verhalten sich die Tierarten <span class="in">`animal`</span> in den beiden Messorten in dem Faktor <span class="in">`site`</span> nicht gleich. Die Interaktion kanst du auch in der Visualisierung der Daten in der @fig-boxplot-emmeans-fac2 sehen. Für die Füchse ändert sich die Sprungweite von <span class="in">`city`</span> zu <span class="in">`village`</span>. Bei Hunden- und Katzenflöhen springen in der Tendenz Dorfflöhe weiter als Stadtflöhe. Wir nutzen jetzt das Modell einmal in der Funktion <span class="in">`TukeyHSD()`</span> um uns einmal einen Tukey HSD TEst berechnen zu lassen.</span>
<span id="cb116-1005"><a href="#cb116-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1008"><a href="#cb116-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1009"><a href="#cb116-1009" aria-hidden="true" tabindex="-1"></a>tukey_fac2_obj <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(fac2_av)</span>
<span id="cb116-1010"><a href="#cb116-1010" aria-hidden="true" tabindex="-1"></a>tukey_fac2_obj</span>
<span id="cb116-1011"><a href="#cb116-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1012"><a href="#cb116-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1013"><a href="#cb116-1013" aria-hidden="true" tabindex="-1"></a>Wie du an der sehr langen Ausgabe sehen kannst, erhalten wir erstmal die Informationen zu der Tierart, dort sehen wir dann, dass sich alle drei Sprungweiten der Tierarten voneinander unterscheiden. Dann erhalten wir die Information über den Ort oder eben den zweiten Faktor. Am Ende nochmal sehr detailiert alle Interaktionen aufgeschlüsselt. Leider ist die Tabelle dann sehr schlecht zu lesen, aber hier siehst du dann welche Faktorkombination dann signifikant ist. Wenn du eine signifikante Interaktion vorliegen hast, dann kannst du keine *pauschale* Aussage über die Sprungweiten der Tierarten machen. Es kommt eben immer drauf an, welches Level du im zweiten Faktor betarchtest.</span>
<span id="cb116-1014"><a href="#cb116-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1015"><a href="#cb116-1015" aria-hidden="true" tabindex="-1"></a>Am Ende wollen wir dann doch noch das *Compact letter display* haben. Ich wähle hier einmal die Gruppe der Tierarten aus. Du kannst das auch für die anderen Faktoren machen, aber hier einmal zur Demonstration. Wir sehen, dass sich alle Tierarten in der Sprungweiet unterscheiden, keine Tierart hat den gleichen Buchstaben.</span>
<span id="cb116-1016"><a href="#cb116-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1019"><a href="#cb116-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1020"><a href="#cb116-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">multcompLetters</span>(<span class="fu">extract_p</span>(tukey_fac2_obj<span class="sc">$</span>animal))</span>
<span id="cb116-1021"><a href="#cb116-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1022"><a href="#cb116-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1023"><a href="#cb116-1023" aria-hidden="true" tabindex="-1"></a>Hier nochmal Achtung, die Interaktion wird natürlich nicht berücksichtigt. Im Zweifel dann doch lieber <span class="in">`{emmeans}`</span> nutzen und nochmal bei mir nachfragen. Allgemeine Aussagen zur Interaktion kann ich immer schwer treffen, es hängt sehr von der wissenschaftlichen Fragestellung und den Daten ab.</span>
<span id="cb116-1024"><a href="#cb116-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1025"><a href="#cb116-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">## `HSD.test()`</span></span>
<span id="cb116-1026"><a href="#cb116-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1027"><a href="#cb116-1027" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb116-1028"><a href="#cb116-1028" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb116-1029"><a href="#cb116-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1030"><a href="#cb116-1030" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`HSD.test()`</span> kann nur ein einfaktorielles Modell rechnen und *ignoriert* weitere Faktoren oder Interaktionsterme im <span class="in">`aov()`</span> Modell. Du erhälst zwar immer eine Ausgabe, aber nur als einfaktorielle Analyse. Unabhängig von dem Modell was du in die Funktion <span class="in">`HSD.test()`</span> reinsteckst! Und ohne weitere Warnung.</span>
<span id="cb116-1031"><a href="#cb116-1031" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1032"><a href="#cb116-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1033"><a href="#cb116-1033" aria-hidden="true" tabindex="-1"></a>Eine zweite Variante den Tukey HSD Test in R durchzuführen ist die Funktion <span class="in">`HSD.test()`</span> aus dem R Paket <span class="in">`{agricolae}`</span>. Persönlich entwickle ich so langsam eine Aversion gegen das Paket, da ich selten eine so rundimentäre und lustlose Hilfe für die Funktion gesehen habe wie in <span class="in">`{agricolae}`</span>. Prinzipiell haben wir die gleichen Möglichkeiten wie auch mit dem Tukey HSD Test für ein einfaktorielles Versuchsdesign. Wir nutzen auch erste eine ANOVA um uns alle wichtigen statistischen Maßzahlen berechnen zu lassen und dann können wir mit denen den Tukey HSD Test durchführen. Leider erhalten wir *keine* p-Werte. Was auch irgendwie irre ist. Dafür dann aber das *Compact letter display* ohne einen weiteren Schritt.</span>
<span id="cb116-1034"><a href="#cb116-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1035"><a href="#cb116-1035" aria-hidden="true" tabindex="-1"></a><span class="fu">### Einfaktorielle Analyse</span></span>
<span id="cb116-1036"><a href="#cb116-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1037"><a href="#cb116-1037" aria-hidden="true" tabindex="-1"></a>Am Anfang rechnen wir auch hier eine einfaktorielle ANOVA mit der Funktion <span class="in">`aov()`</span>. Wir erhalten dann alle notwendigen Informationen in dem Ausgabeobjekt für die Berechnung des Tukey HSD Test. Darüber hinaus können wir auch auch gleich schauen, ob unsere Bahendlung überhaupt einen signifkanten Einfluss auf unser Outcome der Sprunglänge hat.</span>
<span id="cb116-1038"><a href="#cb116-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1041"><a href="#cb116-1041" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1042"><a href="#cb116-1042" aria-hidden="true" tabindex="-1"></a>fac1_av <span class="ot">&lt;-</span> <span class="fu">aov</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb116-1043"><a href="#cb116-1043" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fac1_av)</span>
<span id="cb116-1044"><a href="#cb116-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1045"><a href="#cb116-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1046"><a href="#cb116-1046" aria-hidden="true" tabindex="-1"></a>An dem p-Wert sehen wir, dass wir einen signifikanten Effekt der Tierart <span class="in">`animal`</span> auf die Sprunglänge der Flöhe vorliegen haben. Wir können jetzt einen Tukey HSD Test rechnen um rauszufinden welche der drei Tierarten sich unterscheiden. Wir erhalten dann als Ausgabe die Mittlwerte ohne p-Werte und müssten uns sogar die Mittelwertsdifferenzen selber berechnen. Keine Ahnung was das soll. Dafür dann aber das *Compact letter display*, was ja auch irgendwie reicht.</span>
<span id="cb116-1047"><a href="#cb116-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1050"><a href="#cb116-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1051"><a href="#cb116-1051" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj <span class="ot">&lt;-</span> <span class="fu">HSD.test</span>(fac1_av, <span class="at">trt =</span> <span class="st">'animal'</span>)</span>
<span id="cb116-1052"><a href="#cb116-1052" aria-hidden="true" tabindex="-1"></a>tukey_fac1_obj</span>
<span id="cb116-1053"><a href="#cb116-1053" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1054"><a href="#cb116-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1055"><a href="#cb116-1055" aria-hidden="true" tabindex="-1"></a>Wenn du keinen p-Werte haben möchtest sondern nur das *Compact letter display*, dann macht es dir die Funktion <span class="in">`HSD.test()`</span> etwas leichter. Dann brauchst du dir nicht nochmal eine Funktion zusätzlich laden. Wenn du p-Werte brauchst, dann stehst du hier im Regen. Dann nutze bitte die Funktion <span class="in">`TukesHSD()`</span> im vorherigen Tab.</span>
<span id="cb116-1056"><a href="#cb116-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1057"><a href="#cb116-1057" aria-hidden="true" tabindex="-1"></a><span class="fu">### Zweifaktorielle Analyse</span></span>
<span id="cb116-1058"><a href="#cb116-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1059"><a href="#cb116-1059" aria-hidden="true" tabindex="-1"></a>Eine zweifaktorielle Analyse ist in der Funktion <span class="in">`HSD.test()`</span> nicht möglich. Ein zweifaktorielles Modell wird wie ein einfaktorielles Modell behandelt und damit der zweite Faktor sowie der Interaktionsterm von der Funktion <span class="in">`HSD.test()`</span> ignoriert. Du erhälst keine Warnung sondern eben das Ergebnis einer einfaktoriellen Analyse wiedergeben. Ich bin immer noch sprachlos was das soll.</span>
<span id="cb116-1060"><a href="#cb116-1060" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb116-1061"><a href="#cb116-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1062"><a href="#cb116-1062" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Pfade</span></span>
<span id="cb116-1063"><a href="#cb116-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1064"><a href="#cb116-1064" aria-hidden="true" tabindex="-1"></a><span class="fu">### Paarweise Tests</span></span>
<span id="cb116-1065"><a href="#cb116-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1068"><a href="#cb116-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1069"><a href="#cb116-1069" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1070"><a href="#cb116-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb116-1071"><a href="#cb116-1071" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb116-1072"><a href="#cb116-1072" aria-hidden="true" tabindex="-1"></a>                <span class="at">pool.sd =</span> <span class="cn">FALSE</span>) </span>
<span id="cb116-1073"><a href="#cb116-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1074"><a href="#cb116-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1077"><a href="#cb116-1077" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1078"><a href="#cb116-1078" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1079"><a href="#cb116-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1080"><a href="#cb116-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb116-1081"><a href="#cb116-1081" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb116-1082"><a href="#cb116-1082" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1083"><a href="#cb116-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1084"><a href="#cb116-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">### Games Howell Test</span></span>
<span id="cb116-1085"><a href="#cb116-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1086"><a href="#cb116-1086" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Games-Howell Post-Hoc Test</span><span class="co">](https://rpubs.com/aaronsc32/games-howell-test)</span></span>
<span id="cb116-1087"><a href="#cb116-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1088"><a href="#cb116-1088" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "However, the smaller the number of samples in each group, the </span><span class="sc">\[</span><span class="at">Games Howell Post-hoc Tests</span><span class="sc">\]</span><span class="at"> is more tolerant to the type I error control. Thus, this method can be applied when the number of samples is six or more." --- </span><span class="co">[</span><span class="ot">Games Howell Post-hoc Tests in `{rstatix}`</span><span class="co">](https://rpkgs.datanovia.com/rstatix/reference/games_howell_test.html)</span></span>
<span id="cb116-1089"><a href="#cb116-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1090"><a href="#cb116-1090" aria-hidden="true" tabindex="-1"></a>Der Games-Howell-Test ist eine Alternative zu dem Paket <span class="in">`{multcomp}`</span> und dem Paket <span class="in">`{emmeans}`</span> für ein einfaktorielles Design. Wir nutzen den Games-Howell-Test, wenn die Annahme der Homogenität der Varianzen, der zum Vergleich aller möglichen Kombinationen von Gruppenunterschieden verwendet wird, verletzt ist. Dieser Post-Hoc-Test liefert Konfidenzintervalle für die Unterschiede zwischen den Gruppenmitteln und zeigt, ob die Unterschiede statistisch signifikant sind. Der Test basiert auf der Welch'schen Freiheitsgradkorrektur und adjustiert die $p$-Werte. Der Test vergleicht also die Differenz zwischen den einzelnen Mittelwertpaaren mit einer Adjustierung für den Mehrfachtest. Es besteht also keine Notwendigkeit, zusätzliche p-Wert-Korrekturen vorzunehmen. Mit dem Games-Howell-Test ist nur ein *all-pair* Vergleich möglich.</span>
<span id="cb116-1091"><a href="#cb116-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1092"><a href="#cb116-1092" aria-hidden="true" tabindex="-1"></a>Für den Games-Howell-Test aus dem Paket <span class="in">`{rstatix}`</span> müssen wir kein lineares Modell fitten. Wir schreiben einfach die wie in einem t-Test das Outcome und den Faktor mit den Gruppenleveln in die Funktion <span class="in">`games_howell_test()`</span>. Wir erhalten dann direkt das Ergebnis des Games-Howell-Test. Wir nutzen in diesem Beispiel die Daten aus dem Objekt <span class="in">`fac1_tbl`</span> zu sehen in @tbl-data-posthoc-1.</span>
<span id="cb116-1093"><a href="#cb116-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1094"><a href="#cb116-1094" aria-hidden="true" tabindex="-1"></a>Wir wollen aber nicht mit der Ausgabe arbeiten sondern machen uns noch ein wenig Arbeit und passen die Ausgabe an. Zum einen brauchen wir noch die Kontraste und wir wollen die $p$-Werte auch ansprechend formatieren. Wir erhalten das Objekt <span class="in">`res_4_obj`</span> und geben uns die Ausgabe wieder.</span>
<span id="cb116-1095"><a href="#cb116-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1096"><a href="#cb116-1096" aria-hidden="true" tabindex="-1"></a>Wir erhalten ein <span class="in">`tibble()`</span> mit fünf Spalten. Zum einen den <span class="in">`contrast`</span>, der den Vergleich widerspiegelt, den haben wir uns selber mit der Funktion <span class="in">`mutate()`</span> und <span class="in">`str_c()`</span> aus den Spalten <span class="in">`group1`</span> und <span class="in">`group2`</span> gebaut. Wir vergleichen im ersten Kontrast die Katzen- mit den Hundeflöhen, wobei wir <span class="in">`dog-cat`</span> rechnen. Also wirklich den Mittelwert der Sprungweite der Hundeflöhe *minus* den Mittelwert der Sprungweite der Katzenflöhe rechnen. In der Spalte `estimate` sehen wir den Mittelwertsunterschied. Der Mittelwertsunterschied ist in der *Richtung* nicht ohne den Kontrast zu interpretieren. Danach erhalten wir die adjustierten $p$-Wert sowie die simultanen 95% Konfidenzintervalle.</span>
<span id="cb116-1097"><a href="#cb116-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1098"><a href="#cb116-1098" aria-hidden="true" tabindex="-1"></a>Wir können die Nullhypothese ablehnen für den Vergleiche <span class="in">`dog - cat`</span> mit einem p-Wert von $0.02$ sowie für den Vergleich $cat - fox$ mit einem p-Wert von $0.00$. Beide p-Werte liegen unter dem Signifikanzniveau von $\alpha$ gleich 5%.</span>
<span id="cb116-1099"><a href="#cb116-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1100"><a href="#cb116-1100" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktorielle Analyse</span></span>
<span id="cb116-1101"><a href="#cb116-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1104"><a href="#cb116-1104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1105"><a href="#cb116-1105" aria-hidden="true" tabindex="-1"></a>ght_fac1_obj <span class="ot">&lt;-</span> <span class="fu">games_howell_test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) </span>
<span id="cb116-1106"><a href="#cb116-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1107"><a href="#cb116-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1108"><a href="#cb116-1108" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb116-1109"><a href="#cb116-1109" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte</span></span>
<span id="cb116-1110"><a href="#cb116-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1113"><a href="#cb116-1113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1114"><a href="#cb116-1114" aria-hidden="true" tabindex="-1"></a>ght_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-1115"><a href="#cb116-1115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">pvalue</span>(p.adj))</span>
<span id="cb116-1116"><a href="#cb116-1116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1117"><a href="#cb116-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1118"><a href="#cb116-1118" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact letter display*</span></span>
<span id="cb116-1119"><a href="#cb116-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1122"><a href="#cb116-1122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1123"><a href="#cb116-1123" aria-hidden="true" tabindex="-1"></a>ght_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-1124"><a href="#cb116-1124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2)) <span class="sc">|&gt;</span> </span>
<span id="cb116-1125"><a href="#cb116-1125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p.adj, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb116-1126"><a href="#cb116-1126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span>
<span id="cb116-1127"><a href="#cb116-1127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1128"><a href="#cb116-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1129"><a href="#cb116-1129" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall</span></span>
<span id="cb116-1130"><a href="#cb116-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1131"><a href="#cb116-1131" aria-hidden="true" tabindex="-1"></a>In @fig-ght-1 sind die simultanen 95% Konfidenzintervalle nochmal in einem <span class="in">`ggplot`</span> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab.</span>
<span id="cb116-1132"><a href="#cb116-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1135"><a href="#cb116-1135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1136"><a href="#cb116-1136" aria-hidden="true" tabindex="-1"></a>ght_fac1_ci_obj <span class="ot">&lt;-</span> ght_fac1_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-1137"><a href="#cb116-1137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2))</span>
<span id="cb116-1138"><a href="#cb116-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1139"><a href="#cb116-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1142"><a href="#cb116-1142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1143"><a href="#cb116-1143" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-1144"><a href="#cb116-1144" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1145"><a href="#cb116-1145" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-1146"><a href="#cb116-1146" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-1147"><a href="#cb116-1147" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb116-1148"><a href="#cb116-1148" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb116-1149"><a href="#cb116-1149" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Die 95% Konfidenzintervalle für den *allpair*-Vergleich des Games-Howell-Test."</span></span>
<span id="cb116-1150"><a href="#cb116-1150" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ght-1</span></span>
<span id="cb116-1151"><a href="#cb116-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1152"><a href="#cb116-1152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ght_fac1_ci_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high)) <span class="sc">+</span></span>
<span id="cb116-1153"><a href="#cb116-1153" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb116-1154"><a href="#cb116-1154" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb116-1155"><a href="#cb116-1155" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb116-1156"><a href="#cb116-1156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb116-1157"><a href="#cb116-1157" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb116-1158"><a href="#cb116-1158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1159"><a href="#cb116-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1160"><a href="#cb116-1160" aria-hidden="true" tabindex="-1"></a>Die Entscheidungen nach den 95% Konfidenzintervallen sind die gleichen wie nach dem $p$-Wert. Da wir hier es mit einem Mittelwertsvergleich zu tun haben, ist die Entscheidung gegen die Nullhypothese zu treffen wenn die 0 im Konfidenzintervall ist.</span>
<span id="cb116-1161"><a href="#cb116-1161" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1162"><a href="#cb116-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1163"><a href="#cb116-1163" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktorielle Analyse</span></span>
<span id="cb116-1164"><a href="#cb116-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1165"><a href="#cb116-1165" aria-hidden="true" tabindex="-1"></a>Nur getrennt über die beiden Faktoren.</span>
<span id="cb116-1166"><a href="#cb116-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1169"><a href="#cb116-1169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1170"><a href="#cb116-1170" aria-hidden="true" tabindex="-1"></a>ght_fac2_obj <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb116-1171"><a href="#cb116-1171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(site) <span class="sc">|&gt;</span> </span>
<span id="cb116-1172"><a href="#cb116-1172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">games_howell_test</span>(jump_length <span class="sc">~</span> animal) </span>
<span id="cb116-1173"><a href="#cb116-1173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1174"><a href="#cb116-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1175"><a href="#cb116-1175" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb116-1176"><a href="#cb116-1176" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte</span></span>
<span id="cb116-1177"><a href="#cb116-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1180"><a href="#cb116-1180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1181"><a href="#cb116-1181" aria-hidden="true" tabindex="-1"></a>ght_fac2_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-1182"><a href="#cb116-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">pvalue</span>(p.adj))</span>
<span id="cb116-1183"><a href="#cb116-1183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1184"><a href="#cb116-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1185"><a href="#cb116-1185" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact letter display*</span></span>
<span id="cb116-1186"><a href="#cb116-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1189"><a href="#cb116-1189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1190"><a href="#cb116-1190" aria-hidden="true" tabindex="-1"></a>ght_fac2_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-1191"><a href="#cb116-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2)) <span class="sc">|&gt;</span> </span>
<span id="cb116-1192"><a href="#cb116-1192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(<span class="sc">~</span> site) <span class="sc">|&gt;</span> </span>
<span id="cb116-1193"><a href="#cb116-1193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(pull, p.adj, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb116-1194"><a href="#cb116-1194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span><span class="fu">multcompLetters</span>(.x)<span class="sc">$</span>Letters) <span class="sc">|&gt;</span> </span>
<span id="cb116-1195"><a href="#cb116-1195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"site"</span>) </span>
<span id="cb116-1196"><a href="#cb116-1196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1197"><a href="#cb116-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1198"><a href="#cb116-1198" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall</span></span>
<span id="cb116-1199"><a href="#cb116-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1200"><a href="#cb116-1200" aria-hidden="true" tabindex="-1"></a>In @fig-ght-1 sind die simultanen 95% Konfidenzintervalle nochmal in einem <span class="in">`ggplot`</span> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab.</span>
<span id="cb116-1201"><a href="#cb116-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1204"><a href="#cb116-1204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1205"><a href="#cb116-1205" aria-hidden="true" tabindex="-1"></a>ght_fac2_ci_obj <span class="ot">&lt;-</span> ght_fac2_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-1206"><a href="#cb116-1206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2))</span>
<span id="cb116-1207"><a href="#cb116-1207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1208"><a href="#cb116-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1211"><a href="#cb116-1211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1212"><a href="#cb116-1212" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-1213"><a href="#cb116-1213" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1214"><a href="#cb116-1214" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-1215"><a href="#cb116-1215" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-1216"><a href="#cb116-1216" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb116-1217"><a href="#cb116-1217" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb116-1218"><a href="#cb116-1218" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Die 95% Konfidenzintervalle für den *allpair*-Vergleich des Games-Howell-Test."</span></span>
<span id="cb116-1219"><a href="#cb116-1219" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ght-2</span></span>
<span id="cb116-1220"><a href="#cb116-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1221"><a href="#cb116-1221" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ght_fac2_ci_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high,</span>
<span id="cb116-1222"><a href="#cb116-1222" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> site, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb116-1223"><a href="#cb116-1223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb116-1224"><a href="#cb116-1224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb116-1225"><a href="#cb116-1225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb116-1226"><a href="#cb116-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb116-1227"><a href="#cb116-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb116-1228"><a href="#cb116-1228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb116-1229"><a href="#cb116-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1230"><a href="#cb116-1230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1231"><a href="#cb116-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1232"><a href="#cb116-1232" aria-hidden="true" tabindex="-1"></a>Die Entscheidungen nach den 95% Konfidenzintervallen sind die gleichen wie nach dem $p$-Wert. Da wir hier es mit einem Mittelwertsvergleich zu tun haben, ist die Entscheidung gegen die Nullhypothese zu treffen wenn die 0 im Konfidenzintervall ist.</span>
<span id="cb116-1233"><a href="#cb116-1233" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1234"><a href="#cb116-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1235"><a href="#cb116-1235" aria-hidden="true" tabindex="-1"></a><span class="fu">### R Paket `{multcomp}`</span></span>
<span id="cb116-1236"><a href="#cb116-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1237"><a href="#cb116-1237" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb116-1238"><a href="#cb116-1238" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte</span></span>
<span id="cb116-1239"><a href="#cb116-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1240"><a href="#cb116-1240" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact letter display*</span></span>
<span id="cb116-1241"><a href="#cb116-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1242"><a href="#cb116-1242" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall</span></span>
<span id="cb116-1243"><a href="#cb116-1243" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1244"><a href="#cb116-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1245"><a href="#cb116-1245" aria-hidden="true" tabindex="-1"></a><span class="fu">### R Paket `{nparcomp}`</span></span>
<span id="cb116-1246"><a href="#cb116-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1247"><a href="#cb116-1247" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb116-1248"><a href="#cb116-1248" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb116-1249"><a href="#cb116-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1250"><a href="#cb116-1250" aria-hidden="true" tabindex="-1"></a>Das Paket <span class="in">`{nparcomp}`</span> kann nur ein einfaktorielles Modell rechnen. Dafür brauchst du kein normalverteiltes $y$ in deinen Daten. Darüber hinaus ist die Interpretation des Effekts biologisch nicht möglich. Jedenfalls nicht im klassichen Sinne einer Relevanzbetrachtung auf der Einheit der Messwerte deines $y$. Das *Compact letter display* kannst du aber problemlos nutzen.</span>
<span id="cb116-1251"><a href="#cb116-1251" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1252"><a href="#cb116-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1253"><a href="#cb116-1253" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{nparcomp}`</span> wird gerne genutzt, wenn du ein nicht normalverteiltes Outcome $y$ vorliegen hast und nur eine Behandlung $x$. Dieser Fall kommt sehr oft in der Zellbiologie vor oder aber allgemein in den Humanwissenschaften. Teilweise dann auch in Mausmodellen, wo wir dann nur drei bis vier Behandlungen vorliegen haben und diese dann zu einer Kontrolle vergleichen. Dafür ist das R Paket <span class="in">`{nparcomp}`</span> nützlich. Aber auch nur, wenn du an p-Werten und vielleicht noch dem *Compact letter display* interessiert bist. Alles andere ist dann nicht sinnvoll abbildbar.</span>
<span id="cb116-1254"><a href="#cb116-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1255"><a href="#cb116-1255" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb116-1256"><a href="#cb116-1256" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01_small.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb116-1257"><a href="#cb116-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1258"><a href="#cb116-1258" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Hier einmal kurz der niedergeschlagende Engel. In diesem Abschnitt zu </span><span class="in">`{nparcomp}`</span><span class="at"> werde ich ein paar Engel der Statistik niedergeschlagen und dann noch überfahren. Ich lasse aus Gründen der Didaktik ein paar Sachen weg und dadurch wird einiges leider dann *mathematisch* unkorrekt. Ich kann damit leben und nehme es auf mich damit du deine Abschlussarbeit fertig bekommst. Somit sind alle Abbildungen eher Näherungen als mathematisch korrekt.</span></span>
<span id="cb116-1259"><a href="#cb116-1259" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb116-1260"><a href="#cb116-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1261"><a href="#cb116-1261" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{nparcomp}`</span> hat viele Stärken. In den meisten praktischen Situationen ist die Verteilung der gemessenen Daten $Y$ unbekannt. Dann kann es auch sein, dass du eine Reihe von atypischen Messungen und Ausreißern vorliegen hast. Mit dem R Paket <span class="in">`{nparcomp}`</span> hast fast keine Annahmen an die Daten, so dass du hier sehr flexibel bist. Einzig die Verteilungen der Gruppen müssen ähnlich sein. Das ist aber in einem in sich geschlossenen Experiment eigentlich immer der Fall.</span>
<span id="cb116-1262"><a href="#cb116-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1263"><a href="#cb116-1263" aria-hidden="true" tabindex="-1"></a>Betrachten wir also einmal die Funktionsweise von <span class="in">`{nparcomp}`</span> an einem simplen Beispiel. Ich gehe hier nicht auf die tiefen der Berechnung ein, sondern wir wollen einmal verstehen, was die Ausgabe con <span class="in">`{naparcomp}`</span> uns sagen will. Da das Verfahren nicht auf den klassischen statistischen Maßzahlen wie Mittelwert und Standardabweichung beruht ist die Ausgabe nicht ganz so einfach zu verstehen. In der folgenden Tabelle siehst du einmal die Ausgabe der Funktion <span class="in">`npar.t.test()`</span> in der ich nur die Sprungweiten der Hunde- und Katzenflöhe miteinander vergleichen habe.</span>
<span id="cb116-1264"><a href="#cb116-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1267"><a href="#cb116-1267" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1268"><a href="#cb116-1268" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-1269"><a href="#cb116-1269" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-1270"><a href="#cb116-1270" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1271"><a href="#cb116-1271" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-nparcomp-res</span></span>
<span id="cb116-1272"><a href="#cb116-1272" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Ergebnis der Funktion `npar.t.test()` für den paarweisen Vergleichs von der Sprunglänge in [cm] von Hunde- und Kartzenflöhen. Die Fuchsflöhe wurden einmal entfernt um nur einen paarweisen Vergleich zu rechnen."</span></span>
<span id="cb116-1273"><a href="#cb116-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1274"><a href="#cb116-1274" aria-hidden="true" tabindex="-1"></a><span class="fu">npar.t.test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> <span class="fu">filter</span>(fac1_tbl, animal <span class="sc">!=</span> <span class="st">"fox"</span>), </span>
<span id="cb116-1275"><a href="#cb116-1275" aria-hidden="true" tabindex="-1"></a>            <span class="at">method =</span> <span class="st">"t.app"</span>,</span>
<span id="cb116-1276"><a href="#cb116-1276" aria-hidden="true" tabindex="-1"></a>            <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb116-1277"><a href="#cb116-1277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Analysis"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb116-1278"><a href="#cb116-1278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.Value =</span> <span class="fu">pvalue</span>(p.Value)) <span class="sc">|&gt;</span> </span>
<span id="cb116-1279"><a href="#cb116-1279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)  </span>
<span id="cb116-1280"><a href="#cb116-1280" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb116-1281"><a href="#cb116-1281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1282"><a href="#cb116-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1283"><a href="#cb116-1283" aria-hidden="true" tabindex="-1"></a>Wir wissen anhand der Ausgabe von <span class="in">`npar.t.test()`</span>, dass wir einen signifikanten Unterschied zwischen den Sprungweiten der Hunde- und Katzenflöhe vorliegen haben. Der p-Wert $0.001$ ist kleiner als das Signifikanzniveau $\alpha$ gleich 5%. Aber wie groß ist jetzt der Unterschied oder anders gefragt, was ist der berechnete Effekt? Das R Paket <span class="in">`{nparcomp}`</span> berechnet hierbei den relativen Effekt $p(a,b)$. Das heißt wiederum, dass wir die Einheit der Sprungweite verlieren und nur eine Wahrscheinlichkeit wiedergeben bekommen.</span>
<span id="cb116-1284"><a href="#cb116-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1285"><a href="#cb116-1285" aria-hidden="true" tabindex="-1"></a>Was sagt der relative Effekt $\boldsymbol{p(a,b)}$ aus?</span>
<span id="cb116-1286"><a href="#cb116-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1287"><a href="#cb116-1287" aria-hidden="true" tabindex="-1"></a>:   Wenn der relative Effekt $p(a,b)$ größer ist als $1/2$, dann tendiert die Gruppe $b$ dazu größer zu sein als die Gruppe $a$. Oder etwas anders formuliert. Wenn wir einen relativen Effekt größer als $1/2$ vorliegen haben, dann spricht der relative Effekt für größere Mittelwerte in der Gruppe $b$ im Vergleich zur Gruppe $a$. Wir können dann sagen, dass $\bar{y}_b &gt; \bar{y}_a$ ist. Oder dur schreibst statt $p(a,b)$ eben $p(b &gt; a)$. Ja, ist etwas schief...aber wir leben damit.</span>
<span id="cb116-1288"><a href="#cb116-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1289"><a href="#cb116-1289" aria-hidden="true" tabindex="-1"></a>Betrachten wir einmal die Darstellung der beiden Verteilungen der Sprungweiten für die Hunde- und Katzenflöhe. Die Katzenflöhe haben einen niedrigeren Mittelwert mit $<span class="sc">\\</span>bar{y}_{cat} = 4.74$ und springen nicht so weit wie die Hundeflöhe mit einem hören Mittelwert von $\\bar{y}_{dog} = 8.13$. Wir erhalten einen relativen Effekt $p_{(dog, cat)}$ von $0.102$. Was sagt uns nun der Wert aus? In der folgenden Abbidlung ahbe ich dir einmal den Zusammenhang visualisert. Die eingefärbte Fläche ist die Wahrscheinlichkeit $p_{(dog, cat)}$ von $0.102$ zufällig größere Sprungweiten von Katzenflöhen als von Hundeflöhen zu beobachten. Da die Katzenflöhe ja *nicht* weiter als die Hundeflöhe springen, ist die Wahrscheinlichkeit $p_{(dog, cat)}$ klein.</span>
<span id="cb116-1290"><a href="#cb116-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1293"><a href="#cb116-1293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1294"><a href="#cb116-1294" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-1295"><a href="#cb116-1295" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-1296"><a href="#cb116-1296" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1297"><a href="#cb116-1297" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-nparcomp-dog-cat</span></span>
<span id="cb116-1298"><a href="#cb116-1298" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-1299"><a href="#cb116-1299" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb116-1300"><a href="#cb116-1300" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb116-1301"><a href="#cb116-1301" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung der Verteilung der Sprungweiten der Hunde- und Katzenflöhe mit $8.13 \\pm 2.14cm$ für die Hundeflöhe und $4.74 \\pm 1.9cm$ für die Katzenflöhe. Wir gehen hier von einer normalverteilten Sprungweite aus. Wir erhalten einen relativen Effekt $p_{(dog, cat)}$ von $0.102$. Die Wahrscheinlichkeit $p_{(dog, cat)}$ beschreibt zufällig größere Werte für $\\bar{y}_cat$ als für $\\bar{y}_dog$ zu beobachten. Die eingefärbten Flächen dienen als Veranschaulichung. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb116-1302"><a href="#cb116-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1303"><a href="#cb116-1303" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">10</span>))) <span class="sc">+</span></span>
<span id="cb116-1304"><a href="#cb116-1304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb116-1305"><a href="#cb116-1305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  <span class="sc">+</span></span>
<span id="cb116-1306"><a href="#cb116-1306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">8.13</span>)) <span class="sc">+</span> </span>
<span id="cb116-1307"><a href="#cb116-1307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>)) <span class="sc">+</span>   </span>
<span id="cb116-1308"><a href="#cb116-1308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb116-1309"><a href="#cb116-1309" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">8.13</span>, <span class="at">sd =</span> <span class="fl">2.14</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb116-1310"><a href="#cb116-1310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb116-1311"><a href="#cb116-1311" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb116-1312"><a href="#cb116-1312" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb116-1313"><a href="#cb116-1313" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb116-1314"><a href="#cb116-1314" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb116-1315"><a href="#cb116-1315" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb116-1316"><a href="#cb116-1316" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb116-1317"><a href="#cb116-1317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb116-1318"><a href="#cb116-1318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb116-1319"><a href="#cb116-1319" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">4.74</span>, <span class="at">sd =</span> <span class="fl">1.9</span>), <span class="at">color =</span> <span class="st">"#D55E00"</span>) <span class="sc">+</span></span>
<span id="cb116-1320"><a href="#cb116-1320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, , </span>
<span id="cb116-1321"><a href="#cb116-1321" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fl">4.74</span>, <span class="at">sd =</span> <span class="fl">1.9</span>),</span>
<span id="cb116-1322"><a href="#cb116-1322" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">8.13</span>, <span class="dv">20</span>),</span>
<span id="cb116-1323"><a href="#cb116-1323" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"#D55E00"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>)  <span class="sc">+</span></span>
<span id="cb116-1324"><a href="#cb116-1324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">4.74</span>), <span class="at">color =</span> <span class="st">"#D55E00"</span>) <span class="sc">+</span> </span>
<span id="cb116-1325"><a href="#cb116-1325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">5.5</span>, <span class="dv">9</span>), </span>
<span id="cb116-1326"><a href="#cb116-1326" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(y)[cat]), <span class="fu">expression</span>(<span class="fu">bar</span>(y)[dog]))) <span class="sc">+</span></span>
<span id="cb116-1327"><a href="#cb116-1327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">14</span>, <span class="at">y =</span> <span class="fl">0.16</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(y)[cat]<span class="sc">~</span><span class="st">"&lt;"</span><span class="sc">~</span><span class="fu">bar</span>(y)[dog]), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb116-1328"><a href="#cb116-1328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">14</span>, <span class="at">y =</span> <span class="fl">0.13</span>, <span class="at">label =</span> <span class="fu">expression</span>(p[<span class="st">"(dog,cat)"</span>]<span class="sc">~</span><span class="st">"="</span><span class="sc">~</span><span class="fl">0.102</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span>   </span>
<span id="cb116-1329"><a href="#cb116-1329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">y =</span> <span class="fl">0.16</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(y)[cat]<span class="sc">~</span><span class="st">"="</span><span class="sc">~</span><span class="fl">4.74</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb116-1330"><a href="#cb116-1330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">y =</span> <span class="fl">0.13</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(y)[dog]<span class="sc">~</span><span class="st">"="</span><span class="sc">~</span><span class="fl">8.13</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb116-1331"><a href="#cb116-1331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="at">x =</span> <span class="fl">13.75</span>, <span class="at">y =</span> <span class="fl">0.13</span>, <span class="at">xend =</span> <span class="dv">9</span>, <span class="at">yend =</span> <span class="fl">0.02</span>,</span>
<span id="cb116-1332"><a href="#cb116-1332" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>), <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb116-1333"><a href="#cb116-1333" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) </span>
<span id="cb116-1334"><a href="#cb116-1334" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb116-1335"><a href="#cb116-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1336"><a href="#cb116-1336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1337"><a href="#cb116-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1338"><a href="#cb116-1338" aria-hidden="true" tabindex="-1"></a>Wir können uns nun die Sachlage auch einmal für alle drei Fälle visualisieren. Daher wir schauen uns an, wie sehen die unterscheidlichen relativen Effektschätzer aus? Zum einen kann ja der Wert des relativen Effekts $p(a,b)$ klein sein und daher eher nahe Null. Damit spricht der relative Effekt dafür das $a$ kleiner ist als $b$. Oder der Wert von $p(a,b)$ ist 0.5, dann ist $a$ vermutlich gleich $b$. Im letzte Fall kann $p(a,b)$ nahe Eins sein, dann spricht es für größere Werte in $b$ als in $a$. Ich kann mit den Zusammenhang besser als eingefärbte Flächen merken, daher habe ich dir nochmal den relativen Effektschätzer etwas anders dargestellt.</span>
<span id="cb116-1339"><a href="#cb116-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1342"><a href="#cb116-1342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1343"><a href="#cb116-1343" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-1344"><a href="#cb116-1344" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-1345"><a href="#cb116-1345" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1346"><a href="#cb116-1346" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-normal-02</span></span>
<span id="cb116-1347"><a href="#cb116-1347" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-1348"><a href="#cb116-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb116-1349"><a href="#cb116-1349" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb116-1350"><a href="#cb116-1350" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung verschiedener relativer Effekte $p(a,b)$ für zwei Gruppen und einem normalverteilten Outcome $y$. Die eingefärbten Flächen dienen als Veranschaulichung. Die Flächen stellt die Wahrscheinlichkeit $p(a,b)$ als relativen Effekt dar.  **(A)** Die Gruppe A hat mit $\\bar{y}_A$ einen größeren Mittelwert als die Gruppe B mit $\\bar{y}_B$. Damit ist $p(A,B)$ aproximativ 0.2 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A gering. **(B)** Die Gruppe A und B haben fast den gleichen Mittelwert. Damit ist $p(A,B)$ aproximativ 0.5 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A gleich. **(C)** Die Gruppe A hat mit $\\bar{y}_A$ einen kleineren Mittelwert als die Gruppe B mit $\\bar{y}_B$. Damit ist $p(A,B)$ aproximativ 0.8 und somit die Wahrscheinlichkeit größere Werte in der Gruppe B zu beobachten als in der Gruppe A groß. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb116-1351"><a href="#cb116-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1352"><a href="#cb116-1352" aria-hidden="true" tabindex="-1"></a>gg_template <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb116-1353"><a href="#cb116-1353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  <span class="sc">+</span></span>
<span id="cb116-1354"><a href="#cb116-1354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb116-1355"><a href="#cb116-1355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">0</span>)) <span class="sc">+</span>   </span>
<span id="cb116-1356"><a href="#cb116-1356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb116-1357"><a href="#cb116-1357" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">4</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb116-1358"><a href="#cb116-1358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>( <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb116-1359"><a href="#cb116-1359" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb116-1360"><a href="#cb116-1360" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb116-1361"><a href="#cb116-1361" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb116-1362"><a href="#cb116-1362" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb116-1363"><a href="#cb116-1363" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"italic"</span>),</span>
<span id="cb116-1364"><a href="#cb116-1364" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb116-1365"><a href="#cb116-1365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="st">""</span>)</span>
<span id="cb116-1366"><a href="#cb116-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1367"><a href="#cb116-1367" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb116-1368"><a href="#cb116-1368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb116-1369"><a href="#cb116-1369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb116-1370"><a href="#cb116-1370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb116-1371"><a href="#cb116-1371" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">4</span>), <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb116-1372"><a href="#cb116-1372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, , </span>
<span id="cb116-1373"><a href="#cb116-1373" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">4</span>),</span>
<span id="cb116-1374"><a href="#cb116-1374" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>),</span>
<span id="cb116-1375"><a href="#cb116-1375" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"#0072B2"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>)  <span class="sc">+</span></span>
<span id="cb116-1376"><a href="#cb116-1376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">15</span>), <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span> </span>
<span id="cb116-1377"><a href="#cb116-1377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>), </span>
<span id="cb116-1378"><a href="#cb116-1378" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(y)[A]), <span class="fu">expression</span>(<span class="fu">bar</span>(y)[B]))) <span class="sc">+</span></span>
<span id="cb116-1379"><a href="#cb116-1379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">8</span>, <span class="at">y =</span> <span class="fl">0.08</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(y)[A]<span class="sc">~</span><span class="st">"&lt;"</span><span class="sc">~</span><span class="fu">bar</span>(y)[B]), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb116-1380"><a href="#cb116-1380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">8</span>, <span class="at">y =</span> <span class="fl">0.06</span>, <span class="at">label =</span> <span class="fu">expression</span>(p[<span class="st">"(A,B)"</span>]<span class="sc">%~~%</span><span class="fl">0.8</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>)</span>
<span id="cb116-1381"><a href="#cb116-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1382"><a href="#cb116-1382" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb116-1383"><a href="#cb116-1383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb116-1384"><a href="#cb116-1384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb116-1385"><a href="#cb116-1385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb116-1386"><a href="#cb116-1386" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">4</span>), <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb116-1387"><a href="#cb116-1387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, , </span>
<span id="cb116-1388"><a href="#cb116-1388" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">5</span>, <span class="at">sd =</span> <span class="dv">4</span>),</span>
<span id="cb116-1389"><a href="#cb116-1389" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>),</span>
<span id="cb116-1390"><a href="#cb116-1390" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"#CC79A7"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb116-1391"><a href="#cb116-1391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">5</span>), <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span> </span>
<span id="cb116-1392"><a href="#cb116-1392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>), </span>
<span id="cb116-1393"><a href="#cb116-1393" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(y)[A]), <span class="fu">expression</span>(<span class="fu">bar</span>(y)[B]))) <span class="sc">+</span></span>
<span id="cb116-1394"><a href="#cb116-1394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">17</span>, <span class="at">y =</span> <span class="fl">0.08</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(y)[A]<span class="sc">~</span><span class="st">"&gt;"</span><span class="sc">~</span><span class="fu">bar</span>(y)[B]), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb116-1395"><a href="#cb116-1395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">17</span>, <span class="at">y =</span> <span class="fl">0.06</span>, <span class="at">label =</span> <span class="fu">expression</span>(p[<span class="st">"(A,B)"</span>]<span class="sc">%~~%</span><span class="fl">0.2</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>)</span>
<span id="cb116-1396"><a href="#cb116-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1397"><a href="#cb116-1397" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb116-1398"><a href="#cb116-1398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb116-1399"><a href="#cb116-1399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(x) <span class="sc">+</span></span>
<span id="cb116-1400"><a href="#cb116-1400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb116-1401"><a href="#cb116-1401" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">11</span>, <span class="at">sd =</span> <span class="dv">4</span>), <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb116-1402"><a href="#cb116-1402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, , </span>
<span id="cb116-1403"><a href="#cb116-1403" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">11</span>, <span class="at">sd =</span> <span class="dv">4</span>),</span>
<span id="cb116-1404"><a href="#cb116-1404" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>),</span>
<span id="cb116-1405"><a href="#cb116-1405" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"area"</span>, <span class="at">fill =</span> <span class="st">"#009E73"</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb116-1406"><a href="#cb116-1406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="dv">11</span>), <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span> </span>
<span id="cb116-1407"><a href="#cb116-1407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">9.5</span>, <span class="fl">12.25</span>), </span>
<span id="cb116-1408"><a href="#cb116-1408" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(y)[A]), <span class="fu">expression</span>(<span class="fu">bar</span>(y)[B]))) <span class="sc">+</span></span>
<span id="cb116-1409"><a href="#cb116-1409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">17</span>, <span class="at">y =</span> <span class="fl">0.08</span>, <span class="at">label =</span> <span class="fu">expression</span>(<span class="fu">bar</span>(y)[A]<span class="sc">~</span><span class="st">"="</span><span class="sc">~</span><span class="fu">bar</span>(y)[B]), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>) <span class="sc">+</span></span>
<span id="cb116-1410"><a href="#cb116-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">17</span>, <span class="at">y =</span> <span class="fl">0.06</span>, <span class="at">label =</span> <span class="fu">expression</span>(p[<span class="st">"(A,B)"</span>]<span class="sc">%~~%</span><span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">5</span>, <span class="at">hjust =</span> <span class="st">"left"</span>)</span>
<span id="cb116-1411"><a href="#cb116-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1412"><a href="#cb116-1412" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> p3 <span class="sc">+</span> p1 <span class="sc">+</span></span>
<span id="cb116-1413"><a href="#cb116-1413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb116-1414"><a href="#cb116-1414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>) <span class="sc">+</span></span>
<span id="cb116-1415"><a href="#cb116-1415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb116-1416"><a href="#cb116-1416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb116-1417"><a href="#cb116-1417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1418"><a href="#cb116-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1419"><a href="#cb116-1419" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktorielle Analyse</span></span>
<span id="cb116-1420"><a href="#cb116-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1421"><a href="#cb116-1421" aria-hidden="true" tabindex="-1"></a>In dem Paket <span class="in">`{naprcomp}`</span> können wir nur eine einfaktorielle Analyse rechnen. Da ist hier nochmal wichtig zu wissen. Sonst musst du dir die Arbeit nicht machen. Wir müssen einiges Einstellen bei der gleichnamigen Hauptfunktion <span class="in">`nparcomp()`</span> aber dann funktioniert alles realtiv reibungslos. Das Paket ist schon älter und hat damit nicht die Funktionalität des <span class="in">`{tidyverse}`</span> oder anderen Paketen. Hier sieht man dann auch, dass <span class="in">`{naprcomp}`</span> nicht so oft genutzt wird, denn ansonsten wäre ja auch der Bedarf einer besseren Integration dar. Aber das lassen wir mal so im Raum stehen.</span>
<span id="cb116-1422"><a href="#cb116-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1423"><a href="#cb116-1423" aria-hidden="true" tabindex="-1"></a>:::: panel-tabset</span>
<span id="cb116-1424"><a href="#cb116-1424" aria-hidden="true" tabindex="-1"></a><span class="fu">## p-Werte</span></span>
<span id="cb116-1425"><a href="#cb116-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1426"><a href="#cb116-1426" aria-hidden="true" tabindex="-1"></a>Leider hat die Funktion <span class="in">`nparcomp()`</span> einem sehr viele Informationen auf der R Konsole auszugeben auch wenn man das nicht will und es einen eigentlich mehr verwirrt als gutes tut. Deshalb stelle ich immer die Option <span class="in">`info = FALSE`</span> ein. Wir wollen eigentlich immer alle Gruppen miteinander vergleichen, so dass wir als Option <span class="in">`type = "Tukey"`</span> nehmen. Achtung, das hat jetzt *nichts* mit dem Tukey HSD Test zu tun. Wir müssen uns dann auch noch aus der Ausgabe den Teil rausziehen, denn wir dann brauchen.</span>
<span id="cb116-1427"><a href="#cb116-1427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1430"><a href="#cb116-1430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1431"><a href="#cb116-1431" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="ot">&lt;-</span> <span class="fu">nparcomp</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, <span class="at">type =</span> <span class="st">"Tukey"</span>, </span>
<span id="cb116-1432"><a href="#cb116-1432" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-1433"><a href="#cb116-1433" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="sc">|&gt;</span> <span class="fu">pluck</span>(<span class="st">"Analysis"</span>)</span>
<span id="cb116-1434"><a href="#cb116-1434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1435"><a href="#cb116-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1436"><a href="#cb116-1436" aria-hidden="true" tabindex="-1"></a>Was wir eigentlich brauchen ist der p-Wert in der letzten Spalte. Spannend ist hier, dass <span class="in">`nparcomp()`</span> den Vergleich von Hunde- und Katzenflöhen nicht als signifikant findet. Das ist eine Folge davon, dass <span class="in">`nparcomp()`</span> etwas konservativer ist als die anderen hier vorgestellten Verfahren. Wenn du nochmal nachvollziehen willst, wie der relative Effekt <span class="in">`Estimator`</span> zu interpretieren ist, habe ich dir nochmal im folgenden eine zusammenfassende Tabelle mit den Mittelwerten der einzelnen Gruppen gebaut. Für mich ist der Wert immer noch von hinten durch die Brust. Leider hat der relative Effekt keinen Bezug zur biologischen Einheit der Messwerte. Deshalb ist die Interpreation im günstigsten Fall schwierig.</span>
<span id="cb116-1437"><a href="#cb116-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1438"><a href="#cb116-1438" aria-hidden="true" tabindex="-1"></a>| Vergleich | Relativer Effekt |</span>
<span id="cb116-1439"><a href="#cb116-1439" aria-hidden="true" tabindex="-1"></a>|:--:|:--:|</span>
<span id="cb116-1440"><a href="#cb116-1440" aria-hidden="true" tabindex="-1"></a>| $\bar{y}_{cat} \stackrel{?}{&gt;} \bar{y}_{dog}$ | $4.74 \stackrel{?}{&gt;} 8.13 \rightarrow p(dog, cat) = 0.102$ |</span>
<span id="cb116-1441"><a href="#cb116-1441" aria-hidden="true" tabindex="-1"></a>| $\bar{y}_{fox} \stackrel{?}{&gt;} \bar{y}_{dog}$ | $9.16 \stackrel{?}{&gt;} 8.13 \rightarrow p(dog, fox) = 0.684$ |</span>
<span id="cb116-1442"><a href="#cb116-1442" aria-hidden="true" tabindex="-1"></a>| $\bar{y}_{fox} \stackrel{?}{&gt;} \bar{y}_{cat}$ | $4.74 \stackrel{?}{&gt;} 9.16 \rightarrow p(cat, fox) = 0.980$ |</span>
<span id="cb116-1443"><a href="#cb116-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1444"><a href="#cb116-1444" aria-hidden="true" tabindex="-1"></a>: Interpretation des relativen Effektes $p(a,b)$ am Beispiel der Sprungweiten der Flöhe. Je größer der relative Effekt $p(a,b)$ desto wahrscheinlicher ist es größere Werte in $b$ als in $a$ zu beobachten. {#tbl-nparcomp-pval}</span>
<span id="cb116-1445"><a href="#cb116-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1446"><a href="#cb116-1446" aria-hidden="true" tabindex="-1"></a><span class="fu">## *Compact letter display*</span></span>
<span id="cb116-1447"><a href="#cb116-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1448"><a href="#cb116-1448" aria-hidden="true" tabindex="-1"></a>Für das *Compact letter display* brauchen wir wieder einmal das Objekt einer <span class="in">`nparcomp()`</span> Analyse. Wir nutzen hier den gleichen Aufruf wie schon bei den p-Werten. Die Optionen sind damit die gleichen wie im Tab zu den p-Werten. Wir sind jetzt aber nur an den reinen p-Werten interessiert und nicht an den relativen Effekten.</span>
<span id="cb116-1449"><a href="#cb116-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1452"><a href="#cb116-1452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1453"><a href="#cb116-1453" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="ot">&lt;-</span> <span class="fu">nparcomp</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, <span class="at">type =</span> <span class="st">"Tukey"</span>, </span>
<span id="cb116-1454"><a href="#cb116-1454" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-1455"><a href="#cb116-1455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1456"><a href="#cb116-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1457"><a href="#cb116-1457" aria-hidden="true" tabindex="-1"></a>Leider ist es so, dass <span class="in">`{nparcomp}`</span> nicht für die Erstellung des *Compact letter displays* optimiert ist. Daher müssen wir uns erst einen Vektor für die Vergleiche mit einem Minuszeichen ohne Leerzeichen bauen.</span>
<span id="cb116-1458"><a href="#cb116-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1461"><a href="#cb116-1461" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1462"><a href="#cb116-1462" aria-hidden="true" tabindex="-1"></a>contrast_vec <span class="ot">&lt;-</span> nparcomp_fac1_res <span class="sc">|&gt;</span>   </span>
<span id="cb116-1463"><a href="#cb116-1463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Contrast"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb116-1464"><a href="#cb116-1464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row.names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb116-1465"><a href="#cb116-1465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace_all</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)</span>
<span id="cb116-1466"><a href="#cb116-1466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1467"><a href="#cb116-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1468"><a href="#cb116-1468" aria-hidden="true" tabindex="-1"></a>Wenn wir die Namen der Vergleiche haben, können wir uns die p-Werte aus dem <span class="in">`nparcomp()`</span> Objekt ziehen und entsprechend dem Vergleich benennen.</span>
<span id="cb116-1469"><a href="#cb116-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1472"><a href="#cb116-1472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1473"><a href="#cb116-1473" aria-hidden="true" tabindex="-1"></a>adj_p_values_vec <span class="ot">&lt;-</span> nparcomp_fac1_res <span class="sc">|&gt;</span>   </span>
<span id="cb116-1474"><a href="#cb116-1474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"Analysis"</span>, <span class="st">"p.Value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb116-1475"><a href="#cb116-1475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(contrast_vec)</span>
<span id="cb116-1476"><a href="#cb116-1476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1477"><a href="#cb116-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1478"><a href="#cb116-1478" aria-hidden="true" tabindex="-1"></a>Abschließend können wir uns dann mit der Funktion <span class="in">`multcompLetters()`</span> das *Compact letter display* wiedergeben lassen.</span>
<span id="cb116-1479"><a href="#cb116-1479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1482"><a href="#cb116-1482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1483"><a href="#cb116-1483" aria-hidden="true" tabindex="-1"></a>adj_p_values_vec <span class="sc">|&gt;</span> <span class="fu">multcompLetters</span>() </span>
<span id="cb116-1484"><a href="#cb116-1484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1485"><a href="#cb116-1485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1486"><a href="#cb116-1486" aria-hidden="true" tabindex="-1"></a>Hier ist der Weg etwas länger aber wenn wir uns nur auf das *Compact letter displays* konzentrieren liefert `{nparcomp}` in einem einfaktoriellen Fall eigentlich alles was wir brauchen. Hier unterscheidet sich das *Compact letter display* von den anderen Analysen, da wir hier auch etwas andere p-Werte erhalten.</span>
<span id="cb116-1487"><a href="#cb116-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1488"><a href="#cb116-1488" aria-hidden="true" tabindex="-1"></a><span class="fu">## 95% Konfidenzintervall</span></span>
<span id="cb116-1489"><a href="#cb116-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1490"><a href="#cb116-1490" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb116-1491"><a href="#cb116-1491" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01_small.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb116-1492"><a href="#cb116-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1493"><a href="#cb116-1493" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Ja, die 95% Konfidenzintervalle und </span><span class="in">`{nparcomp}`</span><span class="at">, eine für mich schwierige Sache. Eigentlich liefern die 95% Konfidenzintervalle in </span><span class="in">`{nparcomp}`</span><span class="at"> nicht so richtig was wir eigentlich wollen. Nämlich eine biologisch zu interpretierende Relevanz und Signifikanz. Die relativen Effekte $p(a,b)$ aus der Funktion </span><span class="in">`nparcomp()`</span><span class="at"> sind eben dann doch wieder nur Wahrscheinlichkeiten.</span></span>
<span id="cb116-1494"><a href="#cb116-1494" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb116-1495"><a href="#cb116-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1496"><a href="#cb116-1496" aria-hidden="true" tabindex="-1"></a>Wenn du die 95% Konfidenzintervalle brauchst, dann kannst du die Funktion <span class="in">`nparcomp()`</span> wie in den Tab zu den p-Werten nutzen. Hier ändert sich nichts bei dem Funktionsaufruf. Praktischerweise liefert dir die Ausgabe von <span class="in">`nparcomp()`</span> auch gleich die 95% Konfidenzintervalle mit.</span>
<span id="cb116-1497"><a href="#cb116-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1500"><a href="#cb116-1500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1501"><a href="#cb116-1501" aria-hidden="true" tabindex="-1"></a>nparcomp_fac1_res <span class="ot">&lt;-</span> <span class="fu">nparcomp</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, <span class="at">type =</span> <span class="st">"Tukey"</span>, </span>
<span id="cb116-1502"><a href="#cb116-1502" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">info =</span> <span class="cn">FALSE</span>)</span>
<span id="cb116-1503"><a href="#cb116-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1504"><a href="#cb116-1504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1505"><a href="#cb116-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1506"><a href="#cb116-1506" aria-hidden="true" tabindex="-1"></a>In der folgenden Abbildung siehst du dann einmal die 95% Konfidenzintervalle visualisiert. Durch die Eigenschaft des relativen Effekt eine Wahrscheinlichkeit zu sein, hast du die Begrenzungen von $<span class="co">[</span><span class="ot">0, 1</span><span class="co">]</span>$ und damit dann auch keine symmetrischen 95% Konfidenzintervalle mehr. Die Entscheidung gegen die Nullhypothese liegt bei $p(a,b) = 0.5$.</span>
<span id="cb116-1507"><a href="#cb116-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1510"><a href="#cb116-1510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1511"><a href="#cb116-1511" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb116-1512"><a href="#cb116-1512" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1513"><a href="#cb116-1513" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb116-1514"><a href="#cb116-1514" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb116-1515"><a href="#cb116-1515" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb116-1516"><a href="#cb116-1516" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb116-1517"><a href="#cb116-1517" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe aus dem R Paket `{nparcomp}` Der relative Effekt ist eine Wahrscheinlichkeit, daher die Begrenzungen bei $[0, 1]$. Die Entscheidung gegen die Nullhypothese liegt bei $p(a,b) = 0.5$."</span></span>
<span id="cb116-1518"><a href="#cb116-1518" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-nparcomp-1</span></span>
<span id="cb116-1519"><a href="#cb116-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1520"><a href="#cb116-1520" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nparcomp_fac1_res<span class="sc">$</span>Analysis, </span>
<span id="cb116-1521"><a href="#cb116-1521" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(Comparison, <span class="at">y =</span> Estimator, <span class="at">ymin =</span> Lower, <span class="at">ymax =</span> Upper)) <span class="sc">+</span></span>
<span id="cb116-1522"><a href="#cb116-1522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb116-1523"><a href="#cb116-1523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb116-1524"><a href="#cb116-1524" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb116-1525"><a href="#cb116-1525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-1526"><a href="#cb116-1526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb116-1527"><a href="#cb116-1527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb116-1528"><a href="#cb116-1528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Vergleich"</span>, <span class="at">y =</span> <span class="st">"Relativer Effekt"</span>)</span>
<span id="cb116-1529"><a href="#cb116-1529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1530"><a href="#cb116-1530" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb116-1531"><a href="#cb116-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1532"><a href="#cb116-1532" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktorielle Analyse</span></span>
<span id="cb116-1533"><a href="#cb116-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1534"><a href="#cb116-1534" aria-hidden="true" tabindex="-1"></a>Eine zweifaktorielle Analyse ist in dem Paket <span class="in">`{nparcomp}`</span> nicht möglich. Damit war das hier viel Arbeit für mich für vermutlich nicht viel für dich. Dafür habe ich aber eine Menge über <span class="in">`{nparcomp}`</span> gelernt und du musst dich dafür nicht durch das sehr mathematische Paper von @konietschke2015nparcomp quälen. Denn in den Agrarwissenschaften haben wir eigentlich immer ein zweifaktorielles Modell und selten nur ein Modell mit einem Faktor vorliegen. Daher ist dieses Paket auch hier unten im Kapitel eingeordnet und würde ich nicht empfehlen.</span>
<span id="cb116-1535"><a href="#cb116-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1536"><a href="#cb116-1536" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Dinge von Interesse</span></span>
<span id="cb116-1537"><a href="#cb116-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1538"><a href="#cb116-1538" aria-hidden="true" tabindex="-1"></a>Es gibt immer wieder Dinge von Interesse, die ich im Rahmen der multiplen Vergleiche oder Post-hoc Tests so finde. Meistens ist es dann nicht so wichtig, dass ich es in den obigen Abschnitten noch einbauen möchte. Auf der anderen Seite will ich es dann aber auch nicht vergessen, so dass es eben hier steht. SO kannst du über die Suchfunktion noch Sachen finden, die ich dann eben hier parke. Du kannst es nutzen und manchmal ist es dann auch nützlich.</span>
<span id="cb116-1539"><a href="#cb116-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1540"><a href="#cb116-1540" aria-hidden="true" tabindex="-1"></a><span class="fu">### Friedhof der Post-hoc Tests {#sec-friedhof-posthoc}</span></span>
<span id="cb116-1541"><a href="#cb116-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1542"><a href="#cb116-1542" aria-hidden="true" tabindex="-1"></a>Hier gebe ich eine -- nicht vollständige -- Liste an Post-hoc Tests, die es einmal gab und auch noch erwähnt werden, aber dann igentlich alle irgendwie veraltet sind. Wie immer sind diese Tests nicht per se schlecht. Aber es gibt dann eben besseres. Die Daumenregel lautet dabei, dass es <span class="in">`{emmeans}`</span> oder <span class="in">`{multcomp}`</span> besser können. Zwei Übersichtsarbeiten helfen hier nochmal Ordnung in das Dickicht der multiplen Vergleiche zu bringen. Einmal die Arbeit <span class="co">[</span><span class="ot">On the use of post-hoc tests in environmental and biological sciences: A critical review</span><span class="co">](https://www.sciencedirect.com/science/article/pii/S2405844024011629)</span> von @agbangba2024use sowie die Veröffentlichung <span class="co">[</span><span class="ot">A discussion and evaluation of statistical procedures used by JIMB authors when comparing means</span><span class="co">](https://pmc.ncbi.nlm.nih.gov/articles/PMC10845891/)</span> von @klasson2024discussion.</span>
<span id="cb116-1543"><a href="#cb116-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1544"><a href="#cb116-1544" aria-hidden="true" tabindex="-1"></a>LSD Test oder auch *Fisher\`s least Significant Difference (LSD)*</span>
<span id="cb116-1545"><a href="#cb116-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1546"><a href="#cb116-1546" aria-hidden="true" tabindex="-1"></a>:   Der LSD Test ist veraltet. Was überhaupt gegen die Nutung des LSD Test spricht ist, das der LSD Test das Signifikanzniveau $\alpha$ von 5% über alle Vergleiche nicht einhält. Sie dazu auch @agbangba2024use mit der klaren Aussage: *"LSD does not control for family-wise type I error".* Die einzige Ausnahme ist der seltene Fall, dass du dir nur drei Behandlungsgruppen anschaust, wie von @klasson2024discussion diskutiert. Aber am Ende ich kann den LSD Test nicht empfehlen.</span>
<span id="cb116-1547"><a href="#cb116-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1548"><a href="#cb116-1548" aria-hidden="true" tabindex="-1"></a>Scheffé Test</span>
<span id="cb116-1549"><a href="#cb116-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1550"><a href="#cb116-1550" aria-hidden="true" tabindex="-1"></a>:   Der Scheffé Test ist im Prinzipn eng mit dem Tukey HSD Test verwandt. Was aber @agbangba2024use anmerkt ist, dass *"the test is too conservative compared to methods like Tukey’s HSD"*. Aus dem Grund würde ich den Test nicht empfehlen. Auch testet der Scheffé Test mehr Vergleiche als du meistens möchtest. Es ist eben nicht ein reiner *all-pair* Vergleich sondern testet auch noch alle anderen möglichen Kombinationen der Mittelwerte.</span>
<span id="cb116-1551"><a href="#cb116-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1552"><a href="#cb116-1552" aria-hidden="true" tabindex="-1"></a><span class="fu">### Re-engineering *Compact letter display*</span></span>
<span id="cb116-1553"><a href="#cb116-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1554"><a href="#cb116-1554" aria-hidden="true" tabindex="-1"></a>In dem kurzen Kapitel zu <span class="co">[</span><span class="ot">Re-engineering CLDs</span><span class="co">](https://cran.r-project.org/web/packages/emmeans/vignettes/re-engineering-clds.html)</span> in der Vingette des R Pakets <span class="in">`{emmeans}`</span> geht es darum, wie das *compact letter display* auch anders gebaut werden könnte. Nämlich einmal als wirkliches Anzeigen von Gleichheit über die Option <span class="in">`delta`</span> oder aber über das Anzeigen von Signifikanz über die Option <span class="in">`signif`</span>. Damit haben dann auch wirklich die Information, die wir dann wollen. Also eigentlich was Schönes. Wie machen wir das nun?</span>
<span id="cb116-1555"><a href="#cb116-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1556"><a href="#cb116-1556" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb116-1557"><a href="#cb116-1557" aria-hidden="true" tabindex="-1"></a><span class="fu">## Delta Methode</span></span>
<span id="cb116-1558"><a href="#cb116-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1559"><a href="#cb116-1559" aria-hidden="true" tabindex="-1"></a>Wenn wir das *compact letter display* in dem Sinne der Gleichheit der Behandlungen interpretieren wollen, also das der gleiche Buchstabe bedeutet, dass sich die Behandlungen nicht unterscheiden, dann müssen wir ein <span class="in">`delta`</span> setzen in deren Bandbreite oder Intervall die Behandlungen gleich sind. Ich habe hier mal ein <span class="in">`delta`</span> von 4cm gewählt und wir adjustieren bei einem Test auf Gleichheit nicht.</span>
<span id="cb116-1560"><a href="#cb116-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1563"><a href="#cb116-1563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1564"><a href="#cb116-1564" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span></span>
<span id="cb116-1565"><a href="#cb116-1565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span></span>
<span id="cb116-1566"><a href="#cb116-1566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>, <span class="at">delta =</span> <span class="dv">4</span>)</span>
<span id="cb116-1567"><a href="#cb116-1567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1568"><a href="#cb116-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1569"><a href="#cb116-1569" aria-hidden="true" tabindex="-1"></a>Wie wir jetzt sehen, bedeuten gleiche Buchstaben, dass die Behandlungen gleich sind. In dem Sinne gleich sind, dass die Behandlungen im Mittel nicht weiter als der Wert in <span class="in">`delta`</span> auseinanderliegen. Wie du jetzt das <span class="in">`delta`</span> bestimmst ist eine biologische und keine statistische Frage.</span>
<span id="cb116-1570"><a href="#cb116-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1571"><a href="#cb116-1571" aria-hidden="true" tabindex="-1"></a><span class="fu">## Unterschied anzeigen</span></span>
<span id="cb116-1572"><a href="#cb116-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1573"><a href="#cb116-1573" aria-hidden="true" tabindex="-1"></a>Können wir uns auch signifikante Unterschiede anzeigen lassen? Ja, können wir auch, aber das ist meiner Meinung nach die schlechtere der beiden Anpassungen. Wir haben ja im Kopf, dass das *compact letter display* eben mit gleichen Buchstaben das Gleiche anzeigt. Jetzt würden wir diese Eigenschaften zu Unterschied ändern. Schauen wir uns das einmal an einem kleineren Datensatz einmal an.</span>
<span id="cb116-1574"><a href="#cb116-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1575"><a href="#cb116-1575" aria-hidden="true" tabindex="-1"></a>Dann können wir uns hier einmal das Problem mit den Buchstaben anschauen. Wir kriegen jetzt mit der Option <span class="in">`signif = TRUE`</span> wiedergeben <span class="in">`Estimates sharing the same symbol are significantly different`</span> und das ist irgendwie auch wirr, dass *gleiche* Buchstaben einen Unterschied darstellen. Das *compact letter display* wird eben als Gleichheit gelesen, so dass wir hier mehr verwirrt werden als es hilft.</span>
<span id="cb116-1576"><a href="#cb116-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1579"><a href="#cb116-1579" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1580"><a href="#cb116-1580" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb116-1581"><a href="#cb116-1581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span></span>
<span id="cb116-1582"><a href="#cb116-1582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>, <span class="at">signif =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-1583"><a href="#cb116-1583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1584"><a href="#cb116-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1585"><a href="#cb116-1585" aria-hidden="true" tabindex="-1"></a>Deshalb würde ich auf die Buchstaben verzichten und die Zahlen angeben, damit hier nicht noch mehr Verwirrung aufkommt. Wir nehmen also die Option für die Buchstaben einmal aus dem <span class="in">`cld()`</span> Aufruf raus. Dann haben wir Zahlen als Gruppenzuweisung, was schon mal was anderes ist als die Buchstaben aus dem *compact letter display*.</span>
<span id="cb116-1586"><a href="#cb116-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1589"><a href="#cb116-1589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1590"><a href="#cb116-1590" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb116-1591"><a href="#cb116-1591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span></span>
<span id="cb116-1592"><a href="#cb116-1592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>, <span class="at">signif =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-1593"><a href="#cb116-1593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1594"><a href="#cb116-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1595"><a href="#cb116-1595" aria-hidden="true" tabindex="-1"></a>Innerhalb des selben Konzepts dann zwei Arten von Interpretation des *compact letter display* zu haben, ist dann auch nicht zielführend. Den auch die *gleichen* Zahlen bedeuten jetzt einen Unterschied. Irgendwie mag ich persönlich nicht diese sehr verdrehte Interpretation nicht. Deshalb lieber ein <span class="in">`delta`</span> einführen und auf echte Gleichheit testen.</span>
<span id="cb116-1596"><a href="#cb116-1596" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1597"><a href="#cb116-1597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1598"><a href="#cb116-1598" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modellierung von Varianzheterogenität {#sec-posthoc-var-heterogen}</span></span>
<span id="cb116-1599"><a href="#cb116-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1600"><a href="#cb116-1600" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel modelliere ich ja immer die Varianzheterogenität, wenn ich das kann. Es gibt aber eine Reihe von Möglichkeiten die Adjustierung durchzuführen. In den folgenden Tabs findest du dann noch andere Ideen und Anregungen. Ich muss hier nochmal aufräumen, aber wie immer, wenn es nicht dringlich ist, dann lagere ich es hier lieber. Es es bestimmt nochmal nützlich.</span>
<span id="cb116-1601"><a href="#cb116-1601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1602"><a href="#cb116-1602" aria-hidden="true" tabindex="-1"></a>Wenn du noch etwas weiter gehen möchtest, dann kannst du dir noch die Hilfeseite von dem R Paket <span class="in">`{performance}`</span> <span class="co">[</span><span class="ot">Robust Estimation of Standard Errors, Confidence Intervals, and p-values</span><span class="co">](https://easystats.github.io/parameters/articles/model_parameters_robust.html?q=Heteroskedasticity#robust-covariance-matrix-estimation-from-model-parameters)</span> anschauen. Die Idee ist hier, dass wir die Varianz/Kovarianz robuster daher mit der Berücksichtigung von Varianzheterogenität (eng. *heteroskedasticity*) schätzen.</span>
<span id="cb116-1603"><a href="#cb116-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1604"><a href="#cb116-1604" aria-hidden="true" tabindex="-1"></a>Hier also jetzt einmal eine Übersicht über die Möglichkeiten mit der Varianzheterogenität in Behandlungsgruppen umzugehen.</span>
<span id="cb116-1605"><a href="#cb116-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1606"><a href="#cb116-1606" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb116-1607"><a href="#cb116-1607" aria-hidden="true" tabindex="-1"></a><span class="fu">## Generalized Least Squares</span></span>
<span id="cb116-1608"><a href="#cb116-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1609"><a href="#cb116-1609" aria-hidden="true" tabindex="-1"></a>Neben dem Games-Howell-Test gibt es auch die Möglichkeit *Generalized Least Squares* zu nutzen. Hier haben wir dann auch die Möglichkeit mehrfaktorielle Modelle zu schätzen und dann auch wieder <span class="in">`emmeans`</span> zu nutzen. Das ist natürlich super, weil wir dann wieder in dem <span class="in">`emmeans`</span> Framework sind und alle Funktionen von oben nutzen können. Deshalb hier auch nur die Modellanpassung, den Rest kopierst du dir dann von oben dazu.</span>
<span id="cb116-1610"><a href="#cb116-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1611"><a href="#cb116-1611" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`gls()`</span> aus dem R Paket <span class="in">`{nlme}`</span> passt ein lineares Modell unter Verwendung der verallgemeinerten kleinsten Quadrate an. Die Fehler dürfen dabei aber korreliert oder aber ungleiche Varianzen haben. Damit haben wir ein Modell, was wir nutzen können, wenn wir Varianzheterogenität vorliegen haben. Hier einmal das simple Beispiel für die Tierarten. Wir nehmen wieder die ganz normale Formelschreiweise. Wir können jetzt aber über die Option <span class="in">`weights =`</span> angeben, wie wir die Varianz modellieren wollen. Die Schreibweise mag etwas ungewohnt sein, aber es gibt wirklich viele Arten die Varainz zu modellieren. Hier machen wir uns es einfach und nutzen die Helferfunktion <span class="in">`varIdent`</span> und modellieren dann für jedes Tier eine eigene Gruppenvarianz.</span>
<span id="cb116-1612"><a href="#cb116-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1615"><a href="#cb116-1615" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1616"><a href="#cb116-1616" aria-hidden="true" tabindex="-1"></a>gls_fac1_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb116-1617"><a href="#cb116-1617" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal), </span>
<span id="cb116-1618"><a href="#cb116-1618" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac1_tbl)</span>
<span id="cb116-1619"><a href="#cb116-1619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1620"><a href="#cb116-1620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1621"><a href="#cb116-1621" aria-hidden="true" tabindex="-1"></a>Dann können wir die Modellanpasssung auch schon in <span class="in">`emmeans()`</span> weiterleiten und schauen uns mal das Ergebnis gleich an. Wir achten jetzt auf die Spalte <span class="in">`SE`</span>, die uns ja den Fehler der Mittelwerte für jede Gruppe wiedergibt.</span>
<span id="cb116-1622"><a href="#cb116-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1625"><a href="#cb116-1625" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1626"><a href="#cb116-1626" aria-hidden="true" tabindex="-1"></a>gls_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb116-1627"><a href="#cb116-1627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal)</span>
<span id="cb116-1628"><a href="#cb116-1628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1629"><a href="#cb116-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1630"><a href="#cb116-1630" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass wir für jedes Tier eine eigene Varianz über den Standardfehler <span class="in">`SE`</span> geschätzt haben. Das war es ja auch was wir wollten. Bis hierhin wäre es auch mit dem Games-Howell-Test gegangen. Was ist aber, wenn wir ein zweifaktorielles design mit Interaktion schätzen wollen? Das können wir analog wie eben machen. Wir erweitern einfach das Modell um die Terme <span class="in">`site`</span> für den zweiten Faktor und den Interaktionsterm <span class="in">`animal:site`</span>.</span>
<span id="cb116-1631"><a href="#cb116-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1634"><a href="#cb116-1634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1635"><a href="#cb116-1635" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, </span>
<span id="cb116-1636"><a href="#cb116-1636" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal), </span>
<span id="cb116-1637"><a href="#cb116-1637" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac2_tbl)</span>
<span id="cb116-1638"><a href="#cb116-1638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1639"><a href="#cb116-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1640"><a href="#cb116-1640" aria-hidden="true" tabindex="-1"></a>Dann können wir uns wieder die multiplen Vergleiche getrennt für die Interaktionsterme wiedergeben lassen. Blöderweise haben jetzt alle Messorte <span class="in">`site`</span> die gleiche Varianz für jede Tierart, aber auch da können wir noch ran.</span>
<span id="cb116-1641"><a href="#cb116-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1644"><a href="#cb116-1644" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1645"><a href="#cb116-1645" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb116-1646"><a href="#cb116-1646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site)</span>
<span id="cb116-1647"><a href="#cb116-1647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1648"><a href="#cb116-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1649"><a href="#cb116-1649" aria-hidden="true" tabindex="-1"></a>Die eigentliche Stärke von <span class="in">`gls()`</span> kommt eigentlich erst zu tragen, wenn wir auch noch erlauben, dass wir die Varianz *über alle* Tierarten, Messsorte und Interaktionen variieren kann. Das machen wir, in dem wir einfach `animal*site<span class="in">` zu der `</span>varIdent()` Funktion ergänzen.</span>
<span id="cb116-1650"><a href="#cb116-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1653"><a href="#cb116-1653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1654"><a href="#cb116-1654" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, </span>
<span id="cb116-1655"><a href="#cb116-1655" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal<span class="sc">*</span>site), </span>
<span id="cb116-1656"><a href="#cb116-1656" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac2_tbl)</span>
<span id="cb116-1657"><a href="#cb116-1657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1658"><a href="#cb116-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1659"><a href="#cb116-1659" aria-hidden="true" tabindex="-1"></a>Dann noch schnell in <span class="in">`emmeans()`</span> gesteckt und sich das Ergebnis angeschaut.</span>
<span id="cb116-1660"><a href="#cb116-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1663"><a href="#cb116-1663" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1664"><a href="#cb116-1664" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb116-1665"><a href="#cb116-1665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site)</span>
<span id="cb116-1666"><a href="#cb116-1666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1667"><a href="#cb116-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1668"><a href="#cb116-1668" aria-hidden="true" tabindex="-1"></a>Wie du jetzt siehst schätzen wir die Varianz für jede Tierart und jeden Messort separat. Wir haben also wirklich jede Varianz einzeln zugeordnet. Die Frage ist immer, ob das notwendig ist, denn wir brauchen auch eine gewisse Fallzahl, damit die Modelle funktionieren. Aber das kommt jetzt sehr auf deine Fragestellung an und müssten wir nochmal konkret besprechen.</span>
<span id="cb116-1669"><a href="#cb116-1669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1670"><a href="#cb116-1670" aria-hidden="true" tabindex="-1"></a><span class="fu">## Robuste Schätzung von Standardfehlern</span></span>
<span id="cb116-1671"><a href="#cb116-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1672"><a href="#cb116-1672" aria-hidden="true" tabindex="-1"></a>Wir immer gibt es noch eine weitere Möglichkeit die Varianzheterogenität zu behandeln. Wir nutzen jetzt hier einmal die Funktionen aus dem R Paket <span class="in">`{sandwich}`</span>, die es uns ermöglichen Varianzheterogenität (eng. *heteroskedasticity*) zu modellieren. Es ist eigentlich super einfach, wir müssen als erstes wieder unser Modell anpassen. Hier einmal mit einer simplen linearen Regression.</span>
<span id="cb116-1673"><a href="#cb116-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1676"><a href="#cb116-1676" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1677"><a href="#cb116-1677" aria-hidden="true" tabindex="-1"></a>lm_fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb116-1678"><a href="#cb116-1678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1679"><a href="#cb116-1679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1680"><a href="#cb116-1680" aria-hidden="true" tabindex="-1"></a>Dann können wir auch schon für einen Gruppenvergleich direkt in der Funktion <span class="in">`emmeans()`</span> für die Varianzheterogenität adjustieren. Es gibt verschiedene mögliche Sandwich-Schätzer, aber wir nehmen jetzt mal einen der häufigsten mit <span class="in">`vcovHC`</span>. Wie immer gilt, es gibt ja nach Datenlage bessere und schlechtere Schätzer. Wir laden jetzt nicht das ganze Paket, sondern nur die Funktion mit <span class="in">`sandwich::vcovHAC`</span>. Achtung, hinter der Option <span class="in">`vcov.`</span> ist ein *Punkt*. Ohne den Aufruf <span class="in">`vcov. =`</span> funktioniert die Funktion dann nicht.</span>
<span id="cb116-1681"><a href="#cb116-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1684"><a href="#cb116-1684" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1685"><a href="#cb116-1685" aria-hidden="true" tabindex="-1"></a>em_obj <span class="ot">&lt;-</span> lm_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb116-1686"><a href="#cb116-1686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal, <span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC)</span>
<span id="cb116-1687"><a href="#cb116-1687" aria-hidden="true" tabindex="-1"></a>em_obj</span>
<span id="cb116-1688"><a href="#cb116-1688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1689"><a href="#cb116-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1690"><a href="#cb116-1690" aria-hidden="true" tabindex="-1"></a>Wir du siehst, die Standardfehler sind jetzt nicht mehr über alle Gruppen gleich. Dann können wir uns auch die paarweisen Vergleiche ausgeben lassen.</span>
<span id="cb116-1691"><a href="#cb116-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1694"><a href="#cb116-1694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1695"><a href="#cb116-1695" aria-hidden="true" tabindex="-1"></a>contr_obj <span class="ot">&lt;-</span> em_obj <span class="sc">|&gt;</span> </span>
<span id="cb116-1696"><a href="#cb116-1696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb116-1697"><a href="#cb116-1697" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1698"><a href="#cb116-1698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1699"><a href="#cb116-1699" aria-hidden="true" tabindex="-1"></a>Oder aber wir lassen uns das *compact letter display* wiedergeben.</span>
<span id="cb116-1700"><a href="#cb116-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1703"><a href="#cb116-1703" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1704"><a href="#cb116-1704" aria-hidden="true" tabindex="-1"></a>cld_obj <span class="ot">&lt;-</span> em_obj <span class="sc">|&gt;</span></span>
<span id="cb116-1705"><a href="#cb116-1705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb116-1706"><a href="#cb116-1706" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1707"><a href="#cb116-1707" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1708"><a href="#cb116-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1709"><a href="#cb116-1709" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-posthoc2.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-posthoc2.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
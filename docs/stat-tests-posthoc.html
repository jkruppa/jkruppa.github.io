<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik">

<title>Bio Data Science - 39&nbsp; Der Post-hoc-Test</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-linear-reg-preface.html" rel="next">
<link href="./stat-tests-permutationstest.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Bio Data Science - 39&nbsp; Der Post-hoc-Test">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-posthoc.html"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Post-hoc-Test</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Dunkelmodus umschalten"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Buchstaben und Zahlen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ein <code>purrr</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Post-hoc-Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">39.1</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">39.2</span> Daten</a>
  <ul class="collapse">
  <li><a href="#hypothesen-für-multiple-vergleiche" id="toc-hypothesen-für-multiple-vergleiche" class="nav-link" data-scroll-target="#hypothesen-für-multiple-vergleiche"><span class="header-section-number">39.2.1</span> Hypothesen für multiple Vergleiche</a></li>
  </ul></li>
  <li><a href="#sec-posthoc-pairwise" id="toc-sec-posthoc-pairwise" class="nav-link" data-scroll-target="#sec-posthoc-pairwise"><span class="header-section-number">39.3</span> Simple Gruppenvergleiche</a>
  <ul class="collapse">
  <li><a href="#paarweiser-t-test" id="toc-paarweiser-t-test" class="nav-link" data-scroll-target="#paarweiser-t-test"><span class="header-section-number">39.3.1</span> Paarweiser t Test</a></li>
  <li><a href="#paarweiser-wilcoxon-test" id="toc-paarweiser-wilcoxon-test" class="nav-link" data-scroll-target="#paarweiser-wilcoxon-test"><span class="header-section-number">39.3.2</span> Paarweiser Wilcoxon Test</a></li>
  </ul></li>
  <li><a href="#sec-posthoc-emmeans" id="toc-sec-posthoc-emmeans" class="nav-link" data-scroll-target="#sec-posthoc-emmeans"><span class="header-section-number">39.4</span> Gruppenvergleich mit <code>{emmeans}</code></a>
  <ul class="collapse">
  <li><a href="#gruppenvergleiche-mit-emmeans-in-r" id="toc-gruppenvergleiche-mit-emmeans-in-r" class="nav-link" data-scroll-target="#gruppenvergleiche-mit-emmeans-in-r"><span class="header-section-number">39.4.1</span> Gruppenvergleiche mit <code>emmeans</code> in R</a></li>
  </ul></li>
  <li><a href="#sec-posthoc-multcomp" id="toc-sec-posthoc-multcomp" class="nav-link" data-scroll-target="#sec-posthoc-multcomp"><span class="header-section-number">39.5</span> Gruppenvergleich mit <code>{multcomp}</code></a>
  <ul class="collapse">
  <li><a href="#gruppenvergleiche-mit-multcomp-in-r" id="toc-gruppenvergleiche-mit-multcomp-in-r" class="nav-link" data-scroll-target="#gruppenvergleiche-mit-multcomp-in-r"><span class="header-section-number">39.5.1</span> Gruppenvergleiche mit <code>multcomp</code> in R</a></li>
  </ul></li>
  <li><a href="#sec-posthoc-var-heterogen" id="toc-sec-posthoc-var-heterogen" class="nav-link" data-scroll-target="#sec-posthoc-var-heterogen"><span class="header-section-number">39.6</span> Gruppenvergleich mit Varianzheterogenität</a>
  <ul class="collapse">
  <li><a href="#sec-posthoc-ght" id="toc-sec-posthoc-ght" class="nav-link" data-scroll-target="#sec-posthoc-ght"><span class="header-section-number">39.6.1</span> Games-Howell-Test</a></li>
  <li><a href="#generalized-least-squares" id="toc-generalized-least-squares" class="nav-link" data-scroll-target="#generalized-least-squares"><span class="header-section-number">39.6.2</span> Generalized Least Squares</a></li>
  <li><a href="#robuste-schätzung-von-standardfehlern" id="toc-robuste-schätzung-von-standardfehlern" class="nav-link" data-scroll-target="#robuste-schätzung-von-standardfehlern"><span class="header-section-number">39.6.3</span> Robuste Schätzung von Standardfehlern</a></li>
  </ul></li>
  <li><a href="#sec-compact-letter" id="toc-sec-compact-letter" class="nav-link" data-scroll-target="#sec-compact-letter"><span class="header-section-number">39.7</span> Compact letter display</a>
  <ul class="collapse">
  <li><a href="#für-pairwise..test" id="toc-für-pairwise..test" class="nav-link" data-scroll-target="#für-pairwise..test"><span class="header-section-number">39.7.1</span> … für <code>pairwise.*.test()</code></a></li>
  <li><a href="#für-das-paket-emmeans" id="toc-für-das-paket-emmeans" class="nav-link" data-scroll-target="#für-das-paket-emmeans"><span class="header-section-number">39.7.2</span> … für das Paket <code>{emmeans}</code></a></li>
  <li><a href="#für-das-paket-multcomp" id="toc-für-das-paket-multcomp" class="nav-link" data-scroll-target="#für-das-paket-multcomp"><span class="header-section-number">39.7.3</span> … für das Paket <code>{multcomp}</code></a></li>
  <li><a href="#für-den-games-howell-test" id="toc-für-den-games-howell-test" class="nav-link" data-scroll-target="#für-den-games-howell-test"><span class="header-section-number">39.7.4</span> … für den Games-Howell-Test</a></li>
  </ul></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-posthoc.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-posthoc.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-posthoc.html"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Post-hoc-Test</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-posthoc" class="quarto-section-identifier"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Post-hoc-Test</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 03. June 2024 um 21:06:08</em></p>
<blockquote class="blockquote">
<p><em>“Comparison is the thief of joy.” — Theodore Roosevelt</em></p>
</blockquote>
<p>In diesem Kapitel wollen wir uns mit den multiplen Vergleichen (eng. <em>post hoc analysis</em>) oder aber auch paarweise Gruppenvergleiche genannt beschäftigen. Wir kennen diese multiplen Tests auch unter dem Namen <em>Posthoc Tests</em>, da wir historisch diese Tests <em>nach</em> einer ANOVA durchgeführt haben. Das heißt, wir wollen statistisch Testen, ob sich verschiedene Gruppen einer Behandlung voneinander unterschieden. Technisch Testen wir dabei, ob sich die Level eines Faktors voneinander unterscheiden. Wir können dabei mehrere Faktoren bzw. Behandlungen berücksichtigen und gleichzeitig Testen. Wenn wir nur einen Faktor betrachten, dann sprechen wir von einem 1-faktoriellen Vergleich. Wenn wir zwei Behandlungen betrachten, dann entsprechend von einem 2-faktoriellen Vergleich. Sehr selten haben wir dann noch den Fall vorliegen, dass wir drei Faktoren betrachten wollen. In einer Abschlussarbeit haben wir faktisch keine Versuche wo wir mehr als drei Faktoren in einem Gruppenvergleich berücksichtigen.</p>
<p>Wo wollen wir also hin? Betrachten wir dazu einmal zwei wissenschaftliche Veröffentlichungen als Beispiele. In der <a href="#fig-zerforschen-papaya" class="quarto-xref">Abbildung&nbsp;<span>39.1</span></a> sehen wir ein Säulendigramm aus der wissenschaftlichen Veröffentlichung von <span class="citation" data-cites="salinas2023plant">Salinas u.&nbsp;a. (<a href="#ref-salinas2023plant" role="doc-biblioref">2023</a>)</span> mit dem Titel <a href="https://www.mdpi.com/2223-7747/12/5/1189">“Plant Growth, Yield, and Fruit Size Improvements in ‘Alicia’ Papaya Multiplied by Grafting”</a>. Wir haben hier also einen 2-faktoriellen Gruppenvergleich vorliegen. Der erste Faktor ist die <em>TSS</em> Behandlung mit <em>seed</em>, <em>grafting</em> und <em>in virto</em>. Der zweite Faktor sind dann die fünf Zeitpunkte zu denen jeweils die Behandlung auf die Papaya gegeben wurde. In diesem Kapitel wollen wir die Buchstaben aus einem paarweisen Gruppenvergleich über den Säulen erschaffen oder auch <em>compact letter display</em> genannt.</p>
<div id="fig-zerforschen-papaya" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zerforschen-papaya-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_papaya.png" class="lightbox" data-glightbox="description: .lightbox-desc-1" data-gallery="quarto-lightbox-gallery-1"><img src="images/eda/zerforschen_papaya.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zerforschen-papaya-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.1— <em>“Total soluble solids (TSS) in ‘Alicia’ papaya propagated by seed, grafting, and in vitro (n = 12 ± s.e.), evaluated from April 2020 to May 2021 at the maturation of 100% yellow skin color. The line marks the 10 °Brix value, commonly referred to as the minimum for papaya commercialization. Different letters on the same date indicate statistically significant differences between propagation procedures (Tukey’s test p &lt; 0.05).”</em> Quelle: <span class="citation" data-cites="salinas2023plant">Salinas u.&nbsp;a. (<a href="#ref-salinas2023plant" role="doc-biblioref">2023</a>)</span>
</figcaption>
</figure>
</div>
<p>In der <a href="#fig-zerforschen-hoverfly" class="quarto-xref">Abbildung&nbsp;<span>39.2</span></a> sehen wir ein Säulendigramm aus der wissenschaftlichen Veröffentlichung von <span class="citation" data-cites="sanchez2022hoverfly">Sánchez u.&nbsp;a. (<a href="#ref-sanchez2022hoverfly" role="doc-biblioref">2022</a>)</span> mit dem Titel <a href="https://www.sciencedirect.com/science/article/pii/S0304423822004411">“Hoverfly pollination enhances yield and fruit quality in mango under protected cultivation”</a>. Auch hier haben wir ein 2-faktorielles Design vorliegen. Zum einen den Faktor <em>treatment</em> mit den Gruppen <em>High density</em>, <em>medium density</em>, <em>Low density</em> und <em>Control</em>. Der zweite Faktor ist dann das Jahr der Messung. Auch hier sehen wir wieder Buchstaben über den Säulen. Diese Buchstabenwollen wir dann als <em>compact letter display</em> hier in diesem Kapitel erstellen. Zu den Fehlerbalken liefert die Publikation <a href="https://rupress.org/jcb/article/177/1/7/34602/Error-bars-in-experimental-biology">Error bars in experimental biology</a> von <span class="citation" data-cites="cumming2007error">Cumming u.&nbsp;a. (<a href="#ref-cumming2007error" role="doc-biblioref">2007</a>)</span> nochmal einen Überblick über Fehlerbalken und welche Fehlerbalken man den nun nutzen sollte.</p>
<div id="fig-zerforschen-hoverfly" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zerforschen-hoverfly-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_hoverfly.png" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="quarto-lightbox-gallery-2"><img src="images/eda/zerforschen_hoverfly.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zerforschen-hoverfly-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.2— <em>“Panicles with commercial fruit (%) at 2019 and 2020 harvest. In the same year, different letters indicate significant differences among treatments (Tukey’s test p&lt;0.05).”</em> Quelle: <span class="citation" data-cites="sanchez2022hoverfly">Sánchez u.&nbsp;a. (<a href="#ref-sanchez2022hoverfly" role="doc-biblioref">2022</a>)</span>
</figcaption>
</figure>
</div>
<p>Dann wissen wir jetzt wohin wir wollen. Jetzt stellt sich noch die Frage, welches statistisches Verfahren soll ich wählen um einen Gruppenvergleich zu rechnen? In der folgenden Box gebe ich dir da einmal einen Überblick. Abhängig von deinem Outcome oder deinen gemessenen Werten, musst du dich für ein anderes Verfahren entscheiden. Es kann also sein, dass du verschiedene statistische Tests in deiner Abschlussarbeit rechnest, da du verschiedene Outcomes statistisch analysierst. Wir schauen uns in diesem Kapitel zum größten Teil den Fall eines normalverteilten Outcomes an. An einem normalverteilten Outcome, wie Frische- oder Trockengewicht, lassen sich einfacher die Prinzipien des multiplen Testen erklären. Deshalb hier der Fokus auf der Normalverteilung – andere Möglichkeiten dann in der Box.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Welches statistisches Modell für welchen Gruppenvergleich?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Welches Verfahren soll ich für meinen Gruppenvergleich wählen? Ich habe in den jeweiligen Kapiteln zu den statistischen Modellen die jeweiligen Schritte für die Gruppenvergleiche hinterlegt und beschrieben. Daher kannst du in den Kapiteln einmal schauen, wie dein Outcome dort ausgewertet wird. Du findest dort auch immer ein Beispiel mit entsprechenden Daten.</p>
<dl>
<dt>Normalverteiltes Outcome <span class="math inline">\(\boldsymbol{y}\)</span>: Frischgewicht, Trockengewicht, Chlorophyllgehalt…</dt>
<dd>
<p>Dann schaue dir den Abschnitt zu <a href="stat-modeling-gaussian.html#sec-mult-comp-gaussian-reg">Multiple Gruppenvergleiche für normalverteilte Daten</a> an. Das ist eigentlich <em>der</em> Standardfall und vieles in diesem Kapitel dreht sich um normalverteilte Daten.</p>
</dd>
<dt>Poissonverteiltes Outcome <span class="math inline">\(\boldsymbol{y}\)</span> bzw. Zähldaten: Anzahl Insekten, gekeimte Pflanzen, Schädlinge…</dt>
<dd>
<p>Dann schaue dir den Abschnitt zu <a href="stat-modeling-poisson.html#sec-mult-comp-pois-reg">Multiple Gruppenvergleiche für Zähldaten</a> an – dein Outcome besteht nämlich aus einer Zählung von einem Auftreten eines Ereignisses.</p>
</dd>
<dt>Ordinalverteiltes Outcome <span class="math inline">\(\boldsymbol{y}\)</span>: Bonitur von Rasen, Brokkolistängel, Wurzelwachstum…</dt>
<dd>
<p>Dann schaue dir den Abschnitt zu <a href="stat-modeling-multinom.html#sec-mult-comp-ord-reg">Multiple Gruppenvergleiche für Boniturdaten</a> an – dein Outocme besteht aus Noten für ein Merkmal.</p>
</dd>
<dt>Binomialverteiltes Outcome <span class="math inline">\(\boldsymbol{y}\)</span> bzw. Anteile: Infektionsstatus, Zielgewicht erreicht…</dt>
<dd>
<p>Dann schaue dir den Abschnitt zu <a href="stat-modeling-logistic.html#sec-mult-comp-log-reg">Multiple Gruppenvergleiche für Anteile</a> an – dein Outcome ist <span class="math inline">\(0/1\)</span> oder <span class="math inline">\(ja/nein\)</span> kodiert. Ein Ereignis ist eingetreten oder eben nicht.</p>
</dd>
<dt>Betaverteiltes Outcome <span class="math inline">\(\boldsymbol{y}\)</span> bzw. Wahrscheinlichkeiten: Anteil infizierte Pflanzen, Erfolg/Misserfolg…</dt>
<dd>
<p>Dann schaue dir den Abschnitt zu <a href="stat-modeling-beta.html#sec-mult-comp-beta-reg">Multiple Gruppenvergleiche für Wahrscheinlichkeiten</a> an – dein Outcome ist eine Wahrscheinlcihkeit für das Eintreten eines Ereignisses oder aber die Rate eines Erfolges an Misserfolgen.</p>
</dd>
<dt>Auswertungen mit 3 oder mehr Faktoren:</dt>
<dd>
<p>Dann schaue dir den Abschnitt zu <a href="stat-modeling-mixed.html#sec-mult-comp-lmer-reg">Multiple Gruppenvergleiche für gemischte Modelle</a> an – dein Outcome wurde 3-faktoriell oder mit mehr Faktoren gemessen.</p>
</dd>
</dl>
</div>
</div>
<p>Wenn wir multiple Mittelwertsvergleiche rechnen, dann tritt das Problem des multiplen Testens auf. Wir haben eine Inflation des <span class="math inline">\(\alpha\)</span>-Fehlers vorliegen. Im <a href="stat-tests-theorie.html#sec-statistisches-testen-alpha-adjust" class="quarto-xref"><span>Kapitel 20.3</span></a> kannst du mehr über die Problematik erfahren und wie wir mit der <span class="math inline">\(\alpha\)</span> Inflation umgehen. Hier in diesem Kapitel gehe ich jetzt davon aus, dass dir die <span class="math inline">\(\alpha\)</span> Adjustierung ein Begriff ist. Häufig sollen <span class="math inline">\(p\)</span>-Werte nicht adjustiert werden, viele Verfahren in diesem Kapitel adjustieren aber automatisch die <span class="math inline">\(p\)</span>-Werte. Deshalb musst du aktiv die Adjustierung der <span class="math inline">\(p\)</span>-Werte abstellen. Du findest dann in Abschnitten zu den jeweiligen statistischen Verfahren die entsprechende Option. Der paarweise Mittelwertsvergleich wird auch gerne Tukey Test genannt. Das heißt, dass der Tukey Test alle Gruppen miteinander vergleicht. Der Tukey Test wird daher auch gerne <em>all pair</em> Vergleich genannt.</p>
<p>Schaue dir auch die folgenden Zerforschenbeispiele einmal an, wenn dich mehr zu dem Thema der Abbildung von multiplen Gruppenvergleichen interessiert. Du findest in den Kästen Beispiele für Posterabbildungen zur multiplen Gruppenvergleichen, die ich dann zerforscht habe.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Einfaktorieller Barplot mit <code>emmeans</code> und <em>compact letter display</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen einfaktoriellen Barplot oder Säulendiagramm anschauen. Daher fangen wir mit der folgenden Abbildung einmal an. Wir haben hier ein Säulendiagramm mit <em>compact letter display</em> vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der vier Behandlungen jeweils einmal einen Mittelwert für die Höhe der Säule sowie einmal die Standardabweichung. Die Standardabweichung addieren und subtrahieren wir dann jeweils von dem Mittelwert und schon haben wir die Fehlerbalken. Für eine detaillierte Betrachtung der Erstellung der Abbildung schauen einmal in das Kapitel zum <a href="eda-ggplot.html#sec-eda-barplot">Barplot oder Balkendiagramm oder Säulendiagramm</a>.</p>
<div id="fig-ur-barplot" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_simple.png" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="quarto-lightbox-gallery-3"><img src="images/eda/zerforschen_barplot_simple.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.3— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein simples Säulendiagramm mit sehr für Farbblinde ungünstigen Farben. Es sind die Mittelwerte sowie die Standardabweichung durch die Fehlerbalken dargestellt.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_simple.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die vier Werte alle um den Mittelwert streuen lassen. Dabei habe ich darauf geachtet, dass die Streuung dann in der letzten Behandlung am größten ist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_simple.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">factor</span>(trt, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"water"</span>, <span class="st">"rqflex"</span>, <span class="st">"nitra"</span>, <span class="st">"laqua"</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wasserdestilation"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"RQflex Nitra"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Nitrachek"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Laqua Nitrat"</span>)))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>barplot_tbl </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 2
   trt               nitrat
   &lt;fct&gt;              &lt;dbl&gt;
 1 Wasserdestilation    135
 2 Wasserdestilation    130
 3 Wasserdestilation    145
 4 Wasserdestilation    135
 5 RQflex Nitra         120
 6 RQflex Nitra         130
 7 RQflex Nitra         135
 8 RQflex Nitra         135
 9 Nitrachek            100
10 Nitrachek            120
11 Nitrachek            130
12 Nitrachek            130
13 Laqua Nitrat         230
14 Laqua Nitrat         210
15 Laqua Nitrat         205
16 Laqua Nitrat         220</code></pre>
</div>
</div>
<p>Im Folgenden sparen wir uns den Aufruf mit <code>group_by()</code> den du aus dem <a href="eda-ggplot.html#sec-eda-barplot">Kapitel zum Barplot</a> schon kennst. Wir machen das alles zusammen in der Funktion <code>emmeans()</code> aus dem gleichnamigen R Paket. Der Vorteil ist, dass wir dann auch gleich die Gruppenvergleiche und auch das <em>compact letter display</em> erhalten. Einzig die Standardabweichung <span class="math inline">\(s\)</span> wird uns nicht wiedergegeben sondern der Standardfehler <span class="math inline">\(SE\)</span>. Da aber folgernder Zusammenhang vorliegt, können wir gleich den Standardfehler in die Standardabweichung umrechnen.</p>
<p><span class="math display">\[
SE = \cfrac{s}{\sqrt{n}}
\]</span></p>
<p>Wir rechnen also gleich einfach den Standardfehler <span class="math inline">\(SE\)</span> mal der <span class="math inline">\(\sqrt{n}\)</span> um dann die Standardabweichung zu erhalten. In unserem Fall ist <span class="math inline">\(n=4\)</span> nämlich die Anzahl Beobachtungen je Gruppe. Wenn du mal etwas unterschiedliche Anzahlen hast, dann kannst du auch einfach den Mittelwert der Fallzahl der Gruppen nehmen. Da überfahren wir zwar einen statistischen Engel, aber der Genauigkeit ist genüge getan.</p>
<p>In den beiden Tabs siehst du jetzt einmal die Modellierung unter der Annahme der Varianzhomogenität mit der Funktion <code>lm()</code> und einmal die Modellierung unter der Annahme der Varianzheterogenität mit der Funktion <code>gls()</code> aus dem R Paket <code>nlme</code>. Wie immer lässt sich an Boxplots visuell überprüfen, ob wir Homogenität oder Heterogenität vorliegen haben. Oder aber du schaust nochmal in das Kapitel <a href="stat-tests-pretest.html">Der Pre-Test oder Vortest</a>, wo du mehr erfährst.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-barplot-1fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Varianzhomogenität</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Varianzheterogenität (<code>gls</code>)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Varianzheterogenität (<code>vcovHAC</code>)</a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-barplot-1fac">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>emmeans_homogen_tbl <span class="ot">&lt;-</span> <span class="fu">lm</span>(nitrat <span class="sc">~</span> trt, <span class="at">data =</span> barplot_tbl) <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">4</span>)) </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>emmeans_homogen_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 8
  trt               emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Nitrachek           120   5.08    12     109.     131. a       10.2
2 RQflex Nitra        130   5.08    12     119.     141. ab      10.2
3 Wasserdestilation   136.  5.08    12     125.     147. b       10.2
4 Laqua Nitrat        216.  5.08    12     205.     227. c       10.2</code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_homogen_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. Wie dir vielleicht auffällt sind alle Standardfehler und damit alle Standardabweichungen für alle Gruppen gleich, das war ja auch unsere Annahme mit der Varianzhomogenität.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a> und natürlich in den Abschnitt zu dem <a href="#sec-posthoc-var-heterogen">Gruppenvergleich unter Varianzheterogenität</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_gls_tbl <span class="ot">&lt;-</span> <span class="fu">gls</span>(nitrat <span class="sc">~</span> trt, <span class="at">data =</span> barplot_tbl, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> trt)) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">4</span>)) </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_gls_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 8
  trt               emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Nitrachek           120   7.07  3.00     97.5     143. a      14.1 
2 RQflex Nitra        130   3.54  3.00    119.      141. a       7.07
3 Wasserdestilation   136.  3.15  3.00    126.      146. a       6.29
4 Laqua Nitrat        216.  5.54  3.00    199.      234. b      11.1 </code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_hetrogen_gls_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. In diesem Fall hier sind die Standardfehler und damit auch die Standardabweichungen nicht alle gleich, wir haben ja für jede Gruppe eine eigene Standardabweichung angenommen. Die Varianzen sollten ja auch heterogen sein.</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a> und natürlich in den Abschnitt zu dem <a href="#sec-posthoc-var-heterogen">Gruppenvergleich unter Varianzheterogenität</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_vcov_tbl <span class="ot">&lt;-</span> <span class="fu">lm</span>(nitrat <span class="sc">~</span> trt, <span class="at">data =</span> barplot_tbl) <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">4</span>)) </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_vcov_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 8
  trt               emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 Nitrachek           120   7.84    12     103.     137. a      15.7 
2 RQflex Nitra        130   3.92    12     121.     139. a       7.84
3 Wasserdestilation   136.  2.06    12     132.     141. a       4.12
4 Laqua Nitrat        216.  4.94    12     205.     227. b       9.88</code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_hetrogen_vcov_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. In diesem Fall hier sind die Standardfehler und damit auch die Standardabweichungen nicht alle gleich, wir haben ja für jede Gruppe eine eigene Standardabweichung angenommen. Die Varianzen sollten ja auch heterogen sein.</p>
</div>
</div>
</div>
<p>Und dann haben wir auch schon die Abbildungen hier erstellt. Ja vielleicht passen die Standardabweichungen nicht so richtig, da könnte man nochmal an den Daten spielen und die Werte solange ändern, bis es besser passt. Du hast aber jetzt eine Idee, wie der Aufbau funktioniert. Die beiden Tabs zeigen dir dann die Abbildungen für die beiden Annahmen der Varianzhomogenität oder Varianzheterogenität. Der Code ist der gleiche für die drei Abbildungen, die Daten <code>emmeans_homogen_tbl</code> oder <code>emmeans_hetrogen_gls_tbl</code> ober <code>emmeans_hetrogen_vcov_tbl</code> sind das Ausschlaggebende.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-barplot-1fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Varianzhomogenität</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Varianzheterogenität (<code>gls</code>)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Varianzheterogenität (<code>vcovHAC</code>)</a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-barplot-1fac">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_homogen_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> emmean, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">250</span>) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">10</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-simple-emmeans-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-simple-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="quarto-lightbox-gallery-4"><img src="stat-tests-posthoc_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-simple-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.4— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_hetrogen_gls_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> emmean, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">250</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span> </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">10</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-simple-emmeans-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-simple-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-5" data-gallery="quarto-lightbox-gallery-5"><img src="stat-tests-posthoc_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-simple-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.5— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt. Die Varianzheterogenität nach der Funktion <code>gls()</code> im obigen Modell berücksichtigt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_hetrogen_vcov_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> emmean, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd), </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">250</span>) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span> </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">10</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-simple-emmeans-3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-simple-emmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-3-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="quarto-lightbox-gallery-6"><img src="stat-tests-posthoc_files/figure-html/fig-ggplot-zerforschen-barplot-simple-emmeans-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-simple-emmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.6— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt. Die Varianzheterogenität nach der Funktion <code>sandwich::vcovHAC</code> im obigen Modell berücksichtigt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_barplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Zweifaktorieller Barplot mit <code>emmeans</code> und <em>compact letter display</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen zweifaktoriellen Barplot anschauen. Wir haben hier ein Säulendiagramm mit <em>compact letter display</em> vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der vier Zeitpunkte und der Kontrolle jeweils einmal einen Mittelwert für die Höhe der Säule sowie einmal die Standardabweichung. Da wir hier aber noch mit <code>emmeans()</code> eine Gruppenvergleich rechnen wollen, brauchen wir mehr Beobachtungen. Wir erschaffen uns also fünf Beobachtungen je Zeit/Jod-Kombination. Für eine detaillierte Betrachtung der Erstellung der Abbildung schauen einmal in das Kapitel zum <a href="eda-ggplot.html#sec-eda-barplot">Barplot oder Balkendiagramm oder Säulendiagramm</a>.</p>
<div id="fig-ur-barplot-02" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_2fac.png" class="lightbox" data-glightbox="description: .lightbox-desc-7" data-gallery="quarto-lightbox-gallery-7"><img src="images/eda/zerforschen_barplot_2fac.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.7— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit den zwei Faktoren Zeit und die Iodine Form.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_2fac_target_emmeans.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die fünf Werte alle um den Mittelwert streuen lassen. Ich brauche hier eigentlich mehr als fünf Werte, sonst kriegen wir bei <code>emmeans()</code> und der Interaktion im <code>gls()</code>-Modell Probleme, aber da gibt es dann bei kleinen Fallzahlen noch ein Workaround. Bitte nicht mit weniger als fünf Beobachtungen versuchen, dann wird es schwierig mit der Konsistenz der Schätzer aus dem Modell.</p>
<p>Ach, und ganz wichtig. Wir entfernen die Kontrolle, da wir die Kontrolle nur mit einer Iodid-Stufe gemessen haben. Dann können wir weder die Interaktion rechnen, noch anständig eine Interpretation durchführen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_2fac_target_emmeans.xlsx"</span>)  <span class="sc">|&gt;</span>  </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ctrl"</span>, <span class="st">"7"</span>, <span class="st">"11"</span>, <span class="st">"15"</span>, <span class="st">"19"</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Contr."</span>, <span class="st">"07:00"</span>, <span class="st">"11:00"</span>, <span class="st">"15:00"</span>, <span class="st">"19:00"</span>)),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as_factor</span>(type)) <span class="sc">|&gt;</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">!=</span> <span class="st">"Contr."</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>barplot_tbl </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 3
   time  type  iodine
   &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
 1 07:00 KIO3      50
 2 07:00 KIO3      55
 3 07:00 KIO3      60
 4 07:00 KIO3      52
 5 07:00 KIO3      62
 6 07:00 KI        97
 7 07:00 KI        90
 8 07:00 KI        83
 9 07:00 KI        81
10 07:00 KI        98
# ℹ 30 more rows</code></pre>
</div>
</div>
<p>Im Folgenden sparen wir uns den Aufruf mit <code>group_by()</code> den du aus dem <a href="eda-ggplot.html#sec-eda-barplot">Kapitel zum Barplot</a> schon kennst. Wir machen das alles zusammen in der Funktion <code>emmeans()</code> aus dem gleichnamigen R Paket. Der Vorteil ist, dass wir dann auch gleich die Gruppenvergleiche und auch das <em>compact letter display</em> erhalten. Einzig die Standardabweichung <span class="math inline">\(s\)</span> wird uns nicht wiedergegeben sondern der Standardfehler <span class="math inline">\(SE\)</span>. Da aber folgernder Zusammenhang vorliegt, können wir gleich den Standardfehler in die Standardabweichung umrechnen.</p>
<p><span class="math display">\[
SE = \cfrac{s}{\sqrt{n}}
\]</span></p>
<p>Wir rechnen also gleich einfach den Standardfehler <span class="math inline">\(SE\)</span> mal der <span class="math inline">\(\sqrt{n}\)</span> um dann die Standardabweichung zu erhalten. In unserem Fall ist <span class="math inline">\(n=5\)</span> nämlich die Anzahl Beobachtungen je Gruppe. Wenn du mal etwas unterschiedliche Anzahlen hast, dann kannst du auch einfach den Mittelwert der Fallzahl der Gruppen nehmen. Da überfahren wir zwar einen statistischen Engel, aber der Genauigkeit ist genüge getan.</p>
<p>In den beiden Tabs siehst du jetzt einmal die Modellierung unter der Annahme der Varianzhomogenität mit der Funktion <code>lm()</code> und einmal die Modellierung unter der Annahme der Varianzheterogenität mit der Funktion <code>gls()</code> aus dem R Paket <code>nlme</code>. Wie immer lässt sich an Boxplots visuell überprüfen, ob wir Homogenität oder Heterogenität vorliegen haben. Oder aber du schaust nochmal in das Kapitel <a href="stat-tests-pretest.html">Der Pre-Test oder Vortest</a>, wo du mehr erfährst.</p>
<p>Wenn du <em>jeden</em> Boxplot miteinander vergleichen willst, dann musst du in dem Code <code>emmeans(~ time * type)</code> setzen. Dann berechnet dir <code>emmeans</code> für jede Faktorkombination einen paarweisen Vergleich.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-barplot-2fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Varianzhomogenität</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Varianzheterogenität</a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-barplot-2fac">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen. Wenn du alles mit allem Vergleichen willst, dann setze bitte <code>emmeans(~ time * type)</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>emmeans_homogen_tbl <span class="ot">&lt;-</span> <span class="fu">lm</span>(iodine <span class="sc">~</span> time <span class="sc">+</span> type <span class="sc">+</span> time<span class="sc">:</span>type, <span class="at">data =</span> barplot_tbl) <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> time <span class="sc">|</span> type) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)) </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>emmeans_homogen_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 9
  time  type  emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 07:00 KIO3    55.8  5.58    32     44.4     67.2 a       12.5
2 11:00 KIO3    75.2  5.58    32     63.8     86.6 b       12.5
3 15:00 KIO3    81    5.58    32     69.6     92.4 b       12.5
4 19:00 KIO3    84.2  5.58    32     72.8     95.6 b       12.5
5 07:00 KI      89.8  5.58    32     78.4    101.  a       12.5
6 19:00 KI      90    5.58    32     78.6    101.  a       12.5
7 15:00 KI     124    5.58    32    113.     135.  b       12.5
8 11:00 KI     152    5.58    32    141.     163.  c       12.5</code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_homogen_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. Wie dir vielleicht auffällt sind alle Standardfehler und damit alle Standardabweichungen für alle Gruppen gleich, das war ja auch unsere Annahme mit der Varianzhomogenität.</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>. Da wir hier etwas Probleme mit der Fallzahl haben, nutzen wir die Option <code>mode = "appx-satterthwaite"</code> um dennoch ein vollwertiges, angepasstes Modell zu erhalten. Du kannst die Option auch erstmal entfernen und schauen, ob es mit deinen Daten auch so klappt. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen. Wenn du alles mit allem Vergleichen willst, dann setze bitte <code>emmeans(~ time * type)</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_tbl <span class="ot">&lt;-</span> <span class="fu">gls</span>(iodine <span class="sc">~</span> time <span class="sc">+</span> type <span class="sc">+</span> time<span class="sc">:</span>type, <span class="at">data =</span> barplot_tbl, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> time<span class="sc">*</span>type)) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> time <span class="sc">|</span> type, <span class="at">mode =</span> <span class="st">"appx-satterthwaite"</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">sd =</span> SE <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)) </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>emmeans_hetrogen_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 9
  time  type  emmean    SE    df lower.CL upper.CL .group    sd
  &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
1 07:00 KIO3    55.8  2.29  3.98     49.4     62.2 a       5.12
2 11:00 KIO3    75.2  1.50  4.03     71.1     79.3 b       3.35
3 15:00 KIO3    81.0  3.30  4.01     71.8     90.2 b       7.38
4 19:00 KIO3    84.2  7.88  4.02     62.3    106.  b      17.6 
5 07:00 KI      89.8  3.48  3.96     80.1     99.5 a       7.79
6 19:00 KI      90.0  4.31  4.00     78.0    102.  a       9.64
7 15:00 KI     124    7.48  4.00    103.     145.  b      16.7 
8 11:00 KI     152    9.03  4.00    127.     177.  c      20.2 </code></pre>
</div>
</div>
<p>In dem Objekt <code>emmeans_hetrogen_tbl</code> ist jetzt alles enthalten für unsere Barplots mit dem <em>compact letter display</em>. In diesem Fall hier sind die Standardfehler und damit auch die Standardabweichungen nicht alle gleich, wir haben ja für jede Gruppe eine eigene Standardabweichung angenommen. Die Varianzen sollten ja auch heterogen sein.</p>
</div>
</div>
</div>
<p>Dann bauen wir usn auch schon die Abbildung. Wir müssen am Anfang einmal <code>scale_x_discrete()</code> setzen, damit wir gleich den Zielbereich ganz hinten zeichnen können. Sonst ist der blaue Bereich im Vordergrund. Dann färben wir auch mal die Balken anders ein. Muss ja auch mal sein. Auch nutzen wir die Funktion <code>geom_text()</code> um das <em>compact letter display</em> gut zu setzten. Die <span class="math inline">\(y\)</span>-Position berechnet sich aus dem Mittelwert <code>emmean</code> plus Standardabweichung <code>sd</code> innerhalb des <code>geom_text()</code>. Da wir hier die Kontrollgruppe entfernen mussten, habe ich dann nochmal den Zielbereich verschoben und mit einem Pfeil ergänzt. Die beiden Tabs zeigen dir dann die Abbildungen für die beiden Annahmen der Varianzhomogenität oder Varianzheterogenität. Der Code ist der gleiche für beide Abbildungen, die Daten <code>emmeans_homogen_tbl</code> oder <code>emmeans_hetrogen_tbl</code> sind das Ausschlaggebende. Wie du sehen wirst, haben wir hier mal keinen Unterschied vorliegen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-barplot-2fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Varianzhomogenität</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Varianzheterogenität</a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-barplot-2fac">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_homogen_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> emmean, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">4.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.25</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">xend =</span> <span class="fl">1.7</span>, <span class="at">yend =</span> <span class="dv">105</span>),   </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"#555555"</span>,   </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>,   </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.2</span>,  </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd),</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">2</span>),  </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-8" data-gallery="quarto-lightbox-gallery-8"><img src="stat-tests-posthoc_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.8— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen. Die Kontrolle wurde entfernt, sonst hätten wir hier nicht <code>emmeans</code> in der einfachen Form nutzen können. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> emmeans_hetrogen_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> emmean, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">4.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>, </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.25</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">xend =</span> <span class="fl">1.7</span>, <span class="at">yend =</span> <span class="dv">105</span>),   </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"#555555"</span>,   </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>,   </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.2</span>,  </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>sd, <span class="at">ymax =</span> emmean<span class="sc">+</span>sd),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">2</span>),  </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-9" data-gallery="quarto-lightbox-gallery-9"><img src="stat-tests-posthoc_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-target-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.9— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen. Die Kontrolle wurde entfernt, sonst hätten wir hier nicht <code>emmeans</code> in der einfachen Form nutzen können. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_barplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Zweifaktorieller Boxplot mit <code>emmeans</code> und <em>compact letter display</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen zweifaktoriellen Boxplot unter der Annahme nicht normalverteilter Daten anschauen. Dabei ist Iodanteil in den Pflanzen nicht normalverteilt, so dass wir hier eine <a href="stat-modeling-robust-quantile.html">Quantilesregression</a> rechnen wollen. Die Daten siehst du wieder in der unteren Abbildung. Ich nehme für jede der vier Zeitpunkte jeweils fünf Beobachtungen an. Für die Kontrolle haben wir dann nur drei Beobachtungen in der Gruppe <span class="math inline">\(KIO_3\)</span> vorliegen. Das ist wichtig, denn sonst können wir nicht mit <code>emmeans</code> rechnen. Wir haben einfach zu wenige Beobachtungen vorliegen.</p>
<div id="fig-ur-barplot-02" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_2fac.png" class="lightbox" data-glightbox="description: .lightbox-desc-10" data-gallery="quarto-lightbox-gallery-10"><img src="images/eda/zerforschen_barplot_2fac.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.10— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit den zwei Faktoren Zeit und die Iodine Form. Hier soll es dann ein Boxplot werden.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_2fac_target_emmeans.xlsx</code> selber ausgedacht. Ich nehme hier die gleichen Daten wie für den Barplot. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die fünf Werte alle um den Mittelwert streuen lassen. Ich brauche hier eigentlich mehr als fünf Werte, sonst kriegen wir bei <code>emmeans()</code> und der Interaktion im <code>gls()</code>-Modell Probleme, aber da gibt es dann bei kleinen Fallzahlen noch ein Workaround. Bitte nicht mit weniger als fünf Beobachtungen versuchen, dann wird es schwierig mit der Konsistenz der Schätzer aus dem Modell.</p>
<p>Ach, und ganz wichtig. Wir entfernen die Kontrolle, da wir die Kontrolle nur mit einer Iodid-Stufe gemessen haben. Dann können wir weder die Interaktion rechnen, noch anständig eine Interpretation durchführen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>boxplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_2fac_target_emmeans.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ctrl"</span>, <span class="st">"7"</span>, <span class="st">"11"</span>, <span class="st">"15"</span>, <span class="st">"19"</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Contr."</span>, <span class="st">"07:00"</span>, <span class="st">"11:00"</span>, <span class="st">"15:00"</span>, <span class="st">"19:00"</span>)),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as_factor</span>(type)) <span class="sc">|&gt;</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(time <span class="sc">!=</span> <span class="st">"Contr."</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>boxplot_tbl  </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 3
   time  type  iodine
   &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
 1 07:00 KIO3      50
 2 07:00 KIO3      55
 3 07:00 KIO3      60
 4 07:00 KIO3      52
 5 07:00 KIO3      62
 6 07:00 KI        97
 7 07:00 KI        90
 8 07:00 KI        83
 9 07:00 KI        81
10 07:00 KI        98
# ℹ 30 more rows</code></pre>
</div>
</div>
<p>Hier gehen wir nicht weiter auf die Funktionen ein, bitte schaue dann einmal in dem Abschnitt zu <a href="#sec-posthoc-emmeans">Gruppenvergleich mit dem <code>emmeans</code> Paket</a>. Wir entfernen aber noch die Leerzeichen bei den Buchstaben mit der Funktion <code>str_trim()</code>. Wichtig ist hier, dass wir zur Modellierung die Funktion <code>rq()</code> aus dem R Paket <code>quantreg</code> nutzen. Wenn du den Aufbau mit den anderen Zerforschenbeispielen vergleichst, siehst du, dass hier viel ähnlich ist. Achtung, ganz wichtig! Du musst am Ende wieder die Ausgabe aus der <code>cld()</code>-Funktion nach der Zeit <code>time</code> und der Form <code>type</code> sortieren, sonst passt es gleich nicht mit den Beschriftungen der Boxplots.</p>
<p>Du musst dich nur noch entscheiden, ob du das <em>compact letter display</em> getrennt für die beiden Jodformen <code>type</code> berechnen willst oder aber zusammen. Wenn du das <em>compact letter display</em> für die beiden Jodformen zusammen berechnest, dann berechnest du für jede Faktorkombination einen paarweisen Vergleich.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-boxplot-2fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Getrennt nach <code>type</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Zusammen über <code>type</code></a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-boxplot-2fac">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Hier rechnen wir den Vergleich nur innerhalb der jeweiligen Jodform <code>type</code>. Daher vergleichen wir die Boxplots nicht untereinander sondern eben nur in den jeweiligen Leveln <span class="math inline">\(KIO_3\)</span> und <span class="math inline">\(KI\)</span>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>emmeans_quant_sep_tbl <span class="ot">&lt;-</span> <span class="fu">rq</span>(iodine <span class="sc">~</span> time <span class="sc">+</span> type <span class="sc">+</span> time<span class="sc">:</span>type, <span class="at">data =</span> boxplot_tbl, <span class="at">tau =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> time <span class="sc">|</span> type) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group)) <span class="sc">|&gt;</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(time, type)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>emmeans_quant_sep_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
  time  type  emmean    SE    df lower.CL upper.CL .group
  &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt; 
1 07:00 KIO3      55  3.15    32     48.6     61.4 a     
2 07:00 KI        90  5.51    32     78.8    101.  a     
3 11:00 KIO3      75  1.97    32     71.0     79.0 b     
4 11:00 KI       150 13.8     32    122.     178.  b     
5 15:00 KIO3      80  4.72    32     70.4     89.6 b     
6 15:00 KI       120  7.87    32    104.     136.  b     
7 19:00 KIO3      85  7.48    32     69.8    100.  b     
8 19:00 KI        90  2.36    32     85.2     94.8 a     </code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Dann einmal die Berechnung über alle Boxplots und damit allen Faktorkombinationen aus Zeit und Jodform. Wir können dann damit jeden Boxplot mit jedem anderen Boxplot vergleichen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>emmeans_quant_comb_tbl <span class="ot">&lt;-</span> <span class="fu">rq</span>(iodine <span class="sc">~</span> time <span class="sc">+</span> type <span class="sc">+</span> time<span class="sc">:</span>type, <span class="at">data =</span> boxplot_tbl, <span class="at">tau =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> time<span class="sc">*</span>type) <span class="sc">|&gt;</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.group =</span> <span class="fu">str_trim</span>(.group)) <span class="sc">|&gt;</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(time, type)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>emmeans_quant_comb_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 8
  time  type  emmean    SE    df lower.CL upper.CL .group
  &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt; 
1 07:00 KIO3      55  3.15    32     48.6     61.4 a     
2 07:00 KI        90  5.51    32     78.8    101.  c     
3 11:00 KIO3      75  1.97    32     71.0     79.0 b     
4 11:00 KI       150 13.8     32    122.     178.  d     
5 15:00 KIO3      80  4.72    32     70.4     89.6 bc    
6 15:00 KI       120  7.87    32    104.     136.  d     
7 19:00 KIO3      85  7.48    32     69.8    100.  bc    
8 19:00 KI        90  2.36    32     85.2     94.8 c     </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Für die Boxplots brauchen wir dann noch ein Objekt mehr. Um das nach den Faktorkombinationen sortierte <em>compacte letter dislay</em> an die richtige Position zu setzen brauchen wir noch eine <span class="math inline">\(y\)</span>-Position. Ich nehme hier dann das 95% Quantile. Das 95% Quantile sollte dann auf jeden Fall über die Schnurrhaare raus reichen. Wir nutzen dann den Datensatz <code>letter_pos_tbl</code> in dem <code>geom_text()</code> um die Buchstaben richtig zu setzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>letter_pos_tbl <span class="ot">&lt;-</span> boxplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, type) <span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">quant_90 =</span> <span class="fu">quantile</span>(iodine, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.95</span>)))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>letter_pos_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   time [4]
  time  type  quant_90
  &lt;fct&gt; &lt;fct&gt;    &lt;dbl&gt;
1 07:00 KIO3      61.6
2 07:00 KI        97.8
3 11:00 KIO3      78.8
4 11:00 KI       174  
5 15:00 KIO3      89.4
6 15:00 KI       146  
7 19:00 KIO3     106  
8 19:00 KI        99.8</code></pre>
</div>
</div>
<p>Das Problem sind natürlich die wenigen Beobachtungen, deshalb sehen die Boxplots teilweise etwas wild aus. Aber wir wollen hier eben die Mediane darstellen, die wir dann auch in der Quantilesregression berechnet haben. Wenn du mehr Beobachtungen erstellst, dann werden die Boxplots auch besser dargestellt.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset" data-group="zerforschen-emmeans-boxplot-2fac">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Getrennt nach <code>type</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Zusammen über <code>type</code></a></li></ul>
<div class="tab-content" data-group="zerforschen-emmeans-boxplot-2fac">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Hier nehmen wir das <em>compact letter display</em> aus dem Objekt <code>emmeans_quant_sep_tbl</code>. Wichtig ist, dass die Sortierung gleich der Beschriftung der <span class="math inline">\(x\)</span>-Achse ist. Deshalb nutzen wir weiter oben auch die Funktion <code>arrange()</code> zur Sortierung der Buchstaben. Beachte, dass wir hier jeweils die beiden Jodformen getrennt voneinander betrachten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> boxplot_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> iodine,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">4.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>) <span class="sc">+</span> </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.1</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">xend =</span> <span class="fl">1.7</span>, <span class="at">yend =</span> <span class="dv">105</span>),   </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"#555555"</span>,   </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>,   </span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.2</span>,  </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letter_pos_tbl, </span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> emmeans_quant_sep_tbl<span class="sc">$</span>.group, </span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> quant_90 <span class="sc">+</span> <span class="dv">5</span>),  </span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerfor-barplot-2fac-box-emmeans-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerfor-barplot-2fac-box-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-ggplot-zerfor-barplot-2fac-box-emmeans-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-11" data-gallery="quarto-lightbox-gallery-11"><img src="stat-tests-posthoc_files/figure-html/fig-ggplot-zerfor-barplot-2fac-box-emmeans-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerfor-barplot-2fac-box-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.11— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen, dafür müssen wir uns aber nochmal ein Positionsdatensatz bauen. Hier ist das <em>compact letter display</em> getrennt für die beiden Jodformen berechnet.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Und hier nutzen wir das <em>compact letter display</em> aus dem Objekt <code>emmeans_quant_comb_tbl</code>. Wichtig ist, dass die Sortierung gleich der Beschriftung der <span class="math inline">\(x\)</span>-Achse ist. Deshalb nutzen wir weiter oben auch die Funktion <code>arrange()</code> zur Sortierung der Buchstaben. Hier betrachten wir jeden Boxplot einzelne und du kannst auch jeden Boxplot mit jedem Boxplot vergleichen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> boxplot_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> iodine,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">4.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>) <span class="sc">+</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.1</span>, <span class="at">y =</span> <span class="dv">120</span>, <span class="at">xend =</span> <span class="fl">1.7</span>, <span class="at">yend =</span> <span class="dv">105</span>),   </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">"#555555"</span>,   </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>,   </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.2</span>,  </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>))) <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letter_pos_tbl, </span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> emmeans_quant_comb_tbl<span class="sc">$</span>.group, </span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> quant_90 <span class="sc">+</span> <span class="dv">5</span>),  </span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerfor-barplot-2fac-box-emmeans-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerfor-barplot-2fac-box-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-ggplot-zerfor-barplot-2fac-box-emmeans-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-12" data-gallery="quarto-lightbox-gallery-12"><img src="stat-tests-posthoc_files/figure-html/fig-ggplot-zerfor-barplot-2fac-box-emmeans-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerfor-barplot-2fac-box-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.12— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen, dafür müssen wir uns aber nochmal ein Positionsdatensatz bauen. Hier ist das <em>compact letter display</em> für jede einzelne Faktorkombination berechnet.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_boxplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Boxplots mit <code>emmeans</code> und <em>compact letter display</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Hier wollen wir einmal eine etwas größere <a href="#fig-zer-boxplot-mult" class="quarto-xref">Abbildung&nbsp;<span>39.13</span></a> mit einer Menge Boxplots zerforschen. Da ich den Datensatz dann nicht zu groß machen wollte und Boxplots zu zerforschen manchmal nicht so einfach ist, passen die Ausreißer dann manchmal dann doch nicht. Auch liefern die statistischen Tests dann nicht super genau die gleichen Ergebnisse. Aber das macht vermutlich nicht so viel, hier geht es ja dann eher um den Bau der Boxplots und dem rechnen des statistischen Tests in <code>{emmeans}</code>. Die Reihenfolge des <em>compact letter displays</em> habe ich dann auch nicht angepasst sondern die Buchstaben genommen, die ich dann erhalten habe. Die Sortierung kann man ja selber einfach ändern. Wir haben hier ein einfaktorielles Design mit einem Behandlungsfaktor mit drei Leveln vorliegen. Insgesamt schauen wir uns vier Endpunkte in veränderten Substrat- und Wasserbedingungen an.</p>
<div id="fig-zer-boxplot-mult" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zer-boxplot-mult-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_boxplot_mult.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-13" data-gallery="quarto-lightbox-gallery-13"><img src="images/eda/zerforschen_boxplot_mult.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zer-boxplot-mult-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.13— Ursprüngliche Abbildung, die nachgebaut werden soll. Insgesamt vier Outcomes sollen für zwei Behandlungen ausgewertet werden. Das praktische ist hier, dass wir es nur mit einem einfaktoriellen Design zu tun haben.
</figcaption>
</figure>
</div>
<p>Im Folgenden lade ich einmal den Datensatz, den ich dann per Auge zusammengesetzt habe. Das war jetzt etwas anstrengender als gedacht, da ich nicht weiß wie viele Beobachtungen einen Boxplot bilden. Je mehr Beobachtungen, desto feiner kann man den Boxplot abstimmen. Da ich hier nur mit sieben Beobachtungen ja Gruppe gearbeitet habe, habe ich es nicht geschafft die Ausreißer darzustellen. Das wäre mir dann zu viel Arbeit geworden. Nachdem ich jetzt die Daten geladen habe, muss ich noch über die Funktion <code>pivot_longer()</code> einen Datensatz passenden im Longformat bauen. Abschließend mutiere ich dann noch alle Faktoren richtig und vergebe bessere Namen als <code>labels</code> sonst versteht man ja nicht was die Spalten bedeuten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_boxplot_mult.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> fresh_weight<span class="sc">:</span>flower_number,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"rsp"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"plant_measure"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">plant_measure =</span> <span class="fu">factor</span>(plant_measure,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"fresh_weight"</span>, <span class="st">"dry_weight"</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"plant_height"</span>, <span class="st">"flower_number"</span>),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Fresh weight (g)"</span>, <span class="st">"Dry weight (g)"</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Plant height (cm)"</span>, <span class="st">"Flower number"</span>)),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Substrate"</span>, <span class="st">"Water"</span>))) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ich habe mir dann die beiden Behandlungen <code>substrate</code> und <code>water</code> in die neue Spalte <code>type</code> geschrieben. Die Spaltennamen der Outcomes wandern in die Spalte <code>plant_measure</code> und die entsprechenden Werte in die Spalte <code>rsp</code>. Dann werde ich hier mal alle Outcomes auf einmal auswerten und nutze dafür das R Paket <code>{purrr}</code> mit der Funktion <code>nest()</code> und <code>map()</code>. Ich packe mir als die Daten nach <code>type</code> und <code>plant_measure</code> einmal zusammen. Dann habe ich einen neuen genesteten Datensatz mit nur noch acht Zeilen. Auf jeder Zeile rechne ich dann jeweils mein Modell. Wie du dann siehst ist in der Spalte <code>data</code> dann jeweils ein Datensatz mit der Spalte <code>trt</code> und <code>rsp</code> für die entsprechenden 21 Beobachtungen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_tbl <span class="ot">&lt;-</span> boxplot_mult_tbl <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, plant_measure) <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   type, plant_measure [8]
  type      plant_measure     data             
  &lt;fct&gt;     &lt;fct&gt;             &lt;list&gt;           
1 Substrate Fresh weight (g)  &lt;tibble [21 × 2]&gt;
2 Substrate Dry weight (g)    &lt;tibble [21 × 2]&gt;
3 Substrate Plant height (cm) &lt;tibble [21 × 2]&gt;
4 Substrate Flower number     &lt;tibble [21 × 2]&gt;
5 Water     Fresh weight (g)  &lt;tibble [21 × 2]&gt;
6 Water     Dry weight (g)    &lt;tibble [21 × 2]&gt;
7 Water     Plant height (cm) &lt;tibble [21 × 2]&gt;
8 Water     Flower number     &lt;tibble [21 × 2]&gt;</code></pre>
</div>
</div>
<p>Zur Veranschaulichung rechne ich jetzt einmal mit <code>mutate()</code> und <code>map()</code> für jeden der Datensätze in der Spalte <code>data</code> einmal ein lineares Modell mit der Funktion <code>lm()</code>. Ich muss nur darauf achten, dass ich die Daten mit <code>.x</code> einmal an die richtige Stelle in der Funktion <code>lm()</code> übergebe. Dann habe ich alle Modell komprimiert in der Spalte <code>model</code>. Das geht natürlcih auch alles super in einem Rutsch.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl <span class="ot">&lt;-</span> boxplot_mult_nest_tbl <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> .x)))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
# Groups:   type, plant_measure [8]
  type      plant_measure     data              model 
  &lt;fct&gt;     &lt;fct&gt;             &lt;list&gt;            &lt;list&gt;
1 Substrate Fresh weight (g)  &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
2 Substrate Dry weight (g)    &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
3 Substrate Plant height (cm) &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
4 Substrate Flower number     &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
5 Water     Fresh weight (g)  &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
6 Water     Dry weight (g)    &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
7 Water     Plant height (cm) &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
8 Water     Flower number     &lt;tibble [21 × 2]&gt; &lt;lm&gt;  </code></pre>
</div>
</div>
<p>Jetzt können wir einmal eskalieren und insgesamt acht mal die ANOVA rechnen. Das sieht jetzt nach viel Code aus, aber am Ende ist es nur eine lange Pipe. Am Ende erhalten wir dann den <span class="math inline">\(p\)</span>-Wert für die einfaktorielle ANOVA für die Behandlung <code>trt</code> wiedergegeben. Wir sehen, dass wir eigentlich nur einen signifikanten Unterschied in der Wassergruppe und der Pflanzenhöhe erwarten sollten. Da der <span class="math inline">\(p\)</span>-Wert für die Wassergruppe und der Blütenanzahl auch sehr nah an dem Signifikanzniveau ist, könnte hier auch etwas sein, wenn wir die Gruppen nochmal getrennt testen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl  <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">anova =</span> <span class="fu">map</span>(model, anova)) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parameter =</span> <span class="fu">map</span>(anova, model_parameters)) <span class="sc">|&gt;</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, parameter) <span class="sc">|&gt;</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(parameter) <span class="sc">|&gt;</span> </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">!=</span> <span class="st">"Residuals"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, parameter, p)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
# Groups:   type, plant_measure [8]
  type      plant_measure     parameter        p
  &lt;fct&gt;     &lt;fct&gt;             &lt;chr&gt;        &lt;dbl&gt;
1 Substrate Fresh weight (g)  trt       0.813   
2 Substrate Dry weight (g)    trt       0.381   
3 Substrate Plant height (cm) trt       0.959   
4 Substrate Flower number     trt       0.444   
5 Water     Fresh weight (g)  trt       0.384   
6 Water     Dry weight (g)    trt       0.843   
7 Water     Plant height (cm) trt       0.000138
8 Water     Flower number     trt       0.0600  </code></pre>
</div>
</div>
<p>Dann schauen wir uns nochmal das <span class="math inline">\(\eta^2\)</span> an um zu sehen, wie viel Varianz unsere Behandlung in den Daten erklärt. Leider sieht es in unseren Daten sehr schlecht aus. Nur bei der Wassergruppe und der Pflanzenhöhe scheinen wir durch die Behandlung Varianz zu erklären.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl <span class="sc">%&gt;%</span>  </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eta =</span> <span class="fu">map</span>(model, eta_squared)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(eta) <span class="sc">%&gt;%</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, eta2) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   type, plant_measure [8]
  type      plant_measure        eta2
  &lt;fct&gt;     &lt;fct&gt;               &lt;dbl&gt;
1 Substrate Fresh weight (g)  0.0228 
2 Substrate Dry weight (g)    0.102  
3 Substrate Plant height (cm) 0.00466
4 Substrate Flower number     0.0863 
5 Water     Fresh weight (g)  0.101  
6 Water     Dry weight (g)    0.0188 
7 Water     Plant height (cm) 0.628  
8 Water     Flower number     0.268  </code></pre>
</div>
</div>
<p>Dann können wir auch schon den Gruppenvergleich mit dem R Paket <code>{emmeans}</code> rechnen. Wir nutzen hier die Option <code>vcov. = sandwich::vcovHAC</code> um heterogene Varianzen zuzulassen. Im Weiteren adjustieren wir nicht für die Anzahl der Vergleiche und lassen uns am Ende das <em>compact letter display</em> wiedergeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>emm_tbl <span class="ot">&lt;-</span> boxplot_mult_nest_model_tbl <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">emm =</span> <span class="fu">map</span>(model, emmeans, <span class="sc">~</span>trt, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC)) <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cld =</span> <span class="fu">map</span>(emm, cld, <span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(cld) <span class="sc">|&gt;</span> </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, trt, <span class="at">rsp =</span> emmean, <span class="at">group =</span> .group) <span class="sc">|&gt;</span> </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">str_trim</span>(group))</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>emm_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 5
# Groups:   type, plant_measure [8]
   type      plant_measure     trt     rsp group
   &lt;fct&gt;     &lt;fct&gt;             &lt;fct&gt; &lt;dbl&gt; &lt;chr&gt;
 1 Substrate Fresh weight (g)  UWF    95.4 a    
 2 Substrate Fresh weight (g)  TWF   101   a    
 3 Substrate Fresh weight (g)  Peat  105   a    
 4 Substrate Dry weight (g)    UWF    12.3 a    
 5 Substrate Dry weight (g)    Peat   14.3 ab   
 6 Substrate Dry weight (g)    TWF    15.1 b    
 7 Substrate Plant height (cm) TWF    37.9 a    
 8 Substrate Plant height (cm) Peat   38.0 a    
 9 Substrate Plant height (cm) UWF    39.1 a    
10 Substrate Flower number     UWF    14.6 a    
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>Da die Ausgabe viel zu lang ist, wollen wir ja jetzt einmal unsere Abbildungen in <code>{ggplot}</code> nachbauen. Dazu nutze ich dann einmal zwei Wege. Einmal den etwas schnelleren mit <code>facet_wrap()</code> bei dem wir eigentlich alles automatisch machen lassen. Zum anderen zeige ich dir mit etwas Mehraufwand alle acht Abbildungen einzeln baust und dann über das R Paket <code>{patchwork}</code> wieder zusammenklebst. Der zweite Weg ist der Weg, wenn du mehr Kontrolle über die einzelnen Abbildungen haben willst.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Mit <code>facet_wrap()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Mit <code>{patchwork}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>Die Funktion <code>facet_wrap()</code> erlaubt es dir automatisch Subplots nach einem oder mehreren Faktoren zu erstellen. Dabei muss auch ich immer wieder probieren, wie ich die Faktoren anordne. In unserem Fall wollen wir zwei Zeilen und auch den Subplots erlauben eigene <span class="math inline">\(x\)</span>-Achsen und <span class="math inline">\(y\)</span>-Achsen zu haben. Wenn du die Option <code>scale = "free"</code> nicht wählst, dann haben alle Plots alle Einteilungen der <span class="math inline">\(x\)</span>_Achse und die <span class="math inline">\(y\)</span>-Achse läuft von dem kleinsten zu größten Wert in den gesamten Daten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_tbl <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trt, rsp)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="dv">18</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type <span class="sc">*</span> plant_measure, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> emm_tbl, <span class="fu">aes</span>(<span class="at">y =</span> rsp, <span class="at">label =</span> group), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fl">0.2</span>), <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-zerforschen_boxplot_mult-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zerforschen_boxplot_mult-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-zerforschen_boxplot_mult-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-14" data-gallery="quarto-lightbox-gallery-14"><img src="stat-tests-posthoc_files/figure-html/fig-zerforschen_boxplot_mult-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zerforschen_boxplot_mult-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.14— Nachbau der Abbildung mit der Funktion <code>facte_wrap()</code> mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das <em>compact letter display</em>. Auf eine Einfärbung nach der Behandlung wurde verzichtet um die Abbildung nicht noch mehr zu überladen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Jetzt wird es etwas wilder. Wir bauen uns jetzt alle acht Plots einzeln und kleben diese dann mit dem R Paket <code>{patchwork}</code> zusammen. Das hat ein paar Vorteile. Wir können jetzt jeden einzelnen Plot bearbeiten und anpassen wie wir es wollen. Damit wir aber nicht zu viel Redundanz haben bauen wir uns erstmal ein Template für <code>ggplot()</code>. Dann können wir immer noch die Werte für <code>scale_y_continuous()</code> in den einzelnen Plots ändern. Hier also einmal das Template, was beinhaltet was für alle Abbildungen gelten soll.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>gg_template <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(trt, rsp) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="dv">18</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ja, jetzt geht es los. Wir bauen also jeden Plot einmal nach. Dafür müssen wir dann jeweils den Datensatz filtern, den wir auch brauchen. Dann ergänzen wir noch die korrekte <span class="math inline">\(y\)</span>-Achsenbeschriftung. So können wir dann auch händisch das <em>compact letter display</em> über die Whisker einfach setzen. Im Weiteren habe ich dann auch einmal als Beispiel noch die <span class="math inline">\(y\)</span>-Achseneinteilung mit <code>scale_y_continuous()</code> geändert. Ich habe das einmal für den Plot <code>p1</code> gemacht, der Rest würde analog dazu funktionieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Fresh weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Fresh weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">170</span>, <span class="dv">120</span>, <span class="dv">135</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>), </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">40</span>, <span class="dv">180</span>, <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">180</span>))</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Dry weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Dry weight (g)"</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Plant height (cm)"</span>) <span class="sc">+</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Plant height (cm)"</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Flower number"</span>) <span class="sc">+</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Flower number"</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Fresh weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Fresh weight (g)"</span>)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Dry weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Dry weight (g)"</span>)</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Plant height (cm)"</span>) <span class="sc">+</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Plant height (g)"</span>)</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Flower number"</span>) <span class="sc">+</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Flower number"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann kleben wir die Abbildungen einfach mit einem <code>+</code> zusammen und dann wählen wir noch aus, dass wir vier Spalten wollen. Dann können wir noch Buchstaben zu den Subplots hinzufügen und noch Titel und anderes wenn wir wollen würden. Dann haben wir auch den Plot schon nachgebaut. Ich verzichte hier händisch überall das <em>compact letter display</em> zu ergänzen. Das macht super viel Arbeit und endlos viel Code und hilft dir dann aber in deiner Abbildung auch nicht weiter. Du musst dann ja bei dir selber die Positionen für die Buchstaben finden.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>patch <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span> p6 <span class="sc">+</span> p7 <span class="sc">+</span> p8 <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>patch <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title =</span> <span class="st">'Ein Zerforschenbeispiel an Boxplots'</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">subtitle =</span> <span class="st">'Alle Plots wurden abgelesen und daher sagen Signifikanzen nichts.'</span>,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">caption =</span> <span class="st">'Disclaimer: Die Abbildungen sagen nichts aus.'</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-zerforschen_boxplot_mult-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zerforschen_boxplot_mult-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-zerforschen_boxplot_mult-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-15" data-gallery="quarto-lightbox-gallery-15"><img src="stat-tests-posthoc_files/figure-html/fig-zerforschen_boxplot_mult-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zerforschen_boxplot_mult-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.15— Nachbau der Abbildung mit dem R Paket <code>{patchwork}</code> mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das <em>compact letter display</em> bei dem ersten Plot. Auf eine Einfärbung nach der Behanldung wurde verzichtet um die Abbildung nicht noch mehr zu überladen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_boxplot.png"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<section id="genutzte-r-pakete" class="level2" data-number="39.1">
<h2 data-number="39.1" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">39.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, broom, nlme, </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>               multcomp, emmeans, ggpubr, multcompView,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>               rstatix, conflicted, see, rcompanion)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="39.2">
<h2 data-number="39.2" class="anchored" data-anchor-id="daten"><span class="header-section-number">39.2</span> Daten</h2>
<p>Wir nutzen in diesem Kapitel den Datensatz aus dem Beispiel in <a href="example-fleas-dogs-cats.html#sec-example-3" class="quarto-xref"><span>Kapitel 5.3</span></a>. Wir haben als Outcome die Sprunglänge in [cm] von Flöhen. Die Sprunglänge haben wir an Flöhen von Hunde, Katzen und Füchsen gemessen. Der Datensatz ist also recht übeerschaubar. Wir haben ein normalverteiltes <span class="math inline">\(y\)</span> mit <code>jump_length</code> sowie einen multinomialverteiltes <span class="math inline">\(y\)</span> mit <code>grade</code> und einen Faktor <code>animal</code> mit drei Leveln. Im Folgenden laden wir den Datensatz <code>flea_dog_cat_fox.csv</code> und selektieren mit der Funktion <code>select()</code> die benötigten Spalten. Abschließend müssen wir die Spalte <code>animal</code>noch in einen Faktor umwandeln. Damit ist unsere Vorbereitung des Datensatzes abgeschlossen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/flea_dog_cat_fox.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length, grade) <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#tbl-data-posthoc-1" class="quarto-xref">Tabelle&nbsp;<span>39.1</span></a> ist der Datensatz <code>fac1_tbl</code> nochmal dargestellt. Wir werden nun den Datensatz <code>fac1_tbl</code> in den folgenden Abschnitten immer wieder nutzen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Für die vollständige Datentabelle bitte aufklappen
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div id="tbl-data-posthoc-1" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-data-posthoc-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;39.1— Selektierter Datensatz mit einer normalverteilten Variable <code>jump_length</code> sowie der multinominalverteilten Variable <code>grade</code> und einem Faktor <code>animal</code> mit drei Leveln.
</figcaption>
<div aria-describedby="tbl-data-posthoc-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">jump_length</th>
<th style="text-align: center;">grade</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.7</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">11.8</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.6</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">9.1</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.2</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">7.6</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">2.2</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">5.4</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">4.1</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">4.3</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">7.9</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">7.7</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">8.1</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">9.1</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">9.7</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.6</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">8.6</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.3</td>
<td style="text-align: center;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</div>
</div>
</div>
<section id="hypothesen-für-multiple-vergleiche" class="level3" data-number="39.2.1">
<h3 data-number="39.2.1" class="anchored" data-anchor-id="hypothesen-für-multiple-vergleiche"><span class="header-section-number">39.2.1</span> Hypothesen für multiple Vergleiche</h3>
<p>Als wir eine ANOVA gerechnet hatten, hatten wir nur eine Nullhypothese und eine Alternativehypothese. Wenn wir Nullhypothese abgelehnt hatten, wussten wir nur, dass sich mindestens ein paarweiser Vergleich unterschiedet. Multiple Vergleich lösen nun dieses Problem und führen ein Hypothesen<em>paar</em> für jeden paarweisen Vergleich ein. Zum einen rechnen wir damit <span class="math inline">\(k\)</span> Tests und haben damit auch <span class="math inline">\(k\)</span> Hypothesenpaare (siehe auch <a href="stat-tests-theorie.html#sec-statistisches-testen-alpha-adjust" class="quarto-xref"><span>Kapitel 20.3</span></a> zur Problematik des wiederholten Testens). Wenn wir zum Beispiel alle Level des Faktors <code>animal</code> miteinander Vergleichen wollen, dann rechnen wir <span class="math inline">\(k=3\)</span> paarweise Vergleiche. Im Folgenden sind alle drei Hypothesenpaare dargestellt.</p>
<p><span class="math display">\[
\begin{aligned}
H_{01}: &amp;\; \bar{y}_{cat} = \bar{y}_{dog}\\
H_{A1}: &amp;\; \bar{y}_{cat} \ne \bar{y}_{dog}\\
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
H_{02}: &amp;\; \bar{y}_{cat} = \bar{y}_{fox}\\
H_{A2}: &amp;\; \bar{y}_{cat} \ne \bar{y}_{fox}\\
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
H_{03}: &amp;\; \bar{y}_{dog} = \bar{y}_{fox}\\
H_{A3}: &amp;\; \bar{y}_{dog} \ne \bar{y}_{fox}\\
\end{aligned}
\]</span></p>
<p>Wenn wir drei Vergleiche rechnen, dann haben wir eine <span class="math inline">\(\alpha\)</span> Inflation vorliegen. Wir sagen, dass wir für das multiple Testen adjustieren müssen. In R gibt es eine Reihe von Adjustierungsverfahren. Wir nehmen meist Bonferroni oder das Verfahren, was in der jeweiligen Funktion als Standard (eng. <em>default</em>) gesetzt ist. Wir adjustieren grundsätzlich die <span class="math inline">\(p\)</span>-Werte und erhalten adjustierte <span class="math inline">\(p\)</span>-Werte aus den jeweiligen Funktionen in R. Die adjustierten p-Werte können wir dann mit dem Signifikanzniveau von <span class="math inline">\(\alpha\)</span> gleich 5% vergleichen.</p>
</section>
</section>
<section id="sec-posthoc-pairwise" class="level2" data-number="39.3">
<h2 data-number="39.3" class="anchored" data-anchor-id="sec-posthoc-pairwise"><span class="header-section-number">39.3</span> Simple Gruppenvergleiche</h2>
<p>Wenn wir nur einen Faktor mit mehr als zwei Leveln vorliegen haben, dann können wir die Funktion <code>pairwise.*.test()</code> nutzen. Der Stern <code>*</code> steht entweder als Platzhalter für <code>t</code> für den t-Test oder aber für <code>wilcox</code> für den Wilcoxon Test. Die Funktion ist relativ einfach zu nutzen und liefert auch sofort die entsprechenden p-Werte. Die Funktion <code>pairwise.*.test()</code> ist in dem Sinne <em>veraltet</em>, da wir keine 95% Konfidenzintervalle generieren können. Da die Funktion aber immer mal wieder angefragt wird, ist die Funktion hier nochmal aufgeführt. Die Funktion <code>pairwise.*.test()</code> ist <em>veraltet</em>, wir nutzen das R Paket <code>{emmeans}</code> oder das R Paket <code>{multcomp}</code>.</p>
<section id="paarweiser-t-test" class="level3" data-number="39.3.1">
<h3 data-number="39.3.1" class="anchored" data-anchor-id="paarweiser-t-test"><span class="header-section-number">39.3.1</span> Paarweiser t Test</h3>
<p>Wir nutzen den paarweisen t-Test,</p>
<ul>
<li>wenn wir ein normalverteiltes <span class="math inline">\(y\)</span> vorliegen haben, wie <code>jump_length</code>.</li>
<li>wenn wir <em>nur</em> einen Faktor mit mehr als zwei Leveln vorliegen haben, wie <code>animal</code>.</li>
<li>wenn wir Varianzhomogenität über alle Level vorliegen haben, dann nutzen wir die Option <code>pool.sd = TRUE</code>. Wenn wir Varianzheterogenität über alle Level des Faktors vorliegen haben, dann nutzen wir <code>pool.sd = FALSE</code>.</li>
</ul>
<p>Die Funktion <code>pairwise.t.test</code> kann nicht mit Datensätzen arbeiten sondern nur mit Vektoren. Daher können wir der Funktion auch keine <code>formula</code> übergeben sondern müssen die Vektoren aus dem Datensatz mit <code>fac1_tbl$jump_length</code> für das Outcome und mit <code>fac1_tbl$animal</code> für die Gruppierende Variable benennen. Das ist umständlich und daher auch fehleranfällig. Wir können auch den <code>%$%</code>-Operator aus dem R Paket <code>{magrittr}</code> nutzen um die Problematik zu umgehen. Weiter unten siehst du dann einmal beide Anwendungen.</p>
<p>Als Adjustierungsmethode für den <span class="math inline">\(\alpha\)</span> Fehler wählen wir die Bonferroni-Methode mit <code>p.adjust.method = "bonferroni"</code> aus. Da wir eine etwas unübersichtliche Ausgabe in R erhalten nutzen wir die Funktion <code>tidy()</code>um die Ausgabe in ein sauberes <code>tibble</code> zu verwandeln. Abschließend runden wir noch alle numerischen Spalten mit der Funktion <code>round</code> auf drei Stellen hinter dem Komma.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">pool.sd =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  group1 group2 p.value
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 cat    dog      0.007
2 fox    dog      0.876
3 fox    cat      0.001</code></pre>
</div>
</div>
<p>Und das ganze nochmal mit dem <code>%$%</code>-Operator aus dem R Paket <code>{magrittr}</code>. In diesem Fall können wir uns das <code>$</code> sparen und greifen direkt auf die Spalten des Datensatzes zu.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="sc">%$%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairwise.t.test</span>(jump_length, animal,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">pool.sd =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  group1 group2 p.value
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 cat    dog      0.007
2 fox    dog      0.876
3 fox    cat      0.001</code></pre>
</div>
</div>
<p>Wir erhalten in einem Tibble die adjustierten p-Werte nach Bonferroni. Wir können daher die adjustierten p-Werte ganz normal mit dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% vergleichen. Wenn du keine adjustierten p-Werte möchtest, dann nutze die Option <code>p.adjust.method = "none"</code>. Wir sehen, dass der Gruppenvergleich <code>cat - dog</code> signifikant ist, der Gruppenvergleich <code>fox - dog</code> nicht signifikant ist und der Gruppenvergleich <code>fox - cat</code> wiederum signifikant ist. Leider können wir uns keine Konfidenzintervalle wiedergeben lassen, so dass die Funktion nicht dem Stand der Wissenschaft und deren Ansprüchen genügt.</p>
<p>Im Folgenden wollen wir uns nochmal die Visualisierung mit dem R Paket <code>{ggpubr}</code> anschauen. Die <a href="https://rpkgs.datanovia.com/ggpubr/index.html">Hilfeseite des R Pakets <code>{ggpubr}</code></a> liefert noch eine Menge weitere Beispiele für den simplen Fall eines Modells <span class="math inline">\(y ~ x\)</span>, also von einem <span class="math inline">\(y\)</span> und einem Faktor <span class="math inline">\(x\)</span>. Um die <a href="#fig-ggpubr-1" class="quarto-xref">Abbildung&nbsp;<span>39.16</span></a> zu erstellen müssen wir als erstes die Funktion <code>compare_mean()</code> nutzen um mit der <code>formula</code> Syntax einen t-Test zu rechnen. wir adjustieren die p-Werte nach Bonferroni. Anschließend erstellen wir einen Boxplot mit der Funktion <code>ggboxplot()</code> und speichern die Ausgabe in dem Objekt <code>p</code>. Wie in <code>ggplot</code> üblich können wir jetzt auf das Layer <code>p</code> über das <code>+</code>-Zeichen noch weitere Layer ergänzen. Wir nutzen die Funktion <code>stat_pvalue_manual()</code> um die asjustierten p-Werte aus dem Objekt <code>stat_test_obj</code> zu ergänzen. Abschließend wollen wir noch den p-Wert einer einfaktoriellen ANOVA als globalen Test ergänzen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>stat_test_obj <span class="ot">&lt;-</span> <span class="fu">compare_means</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a> jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a> <span class="at">method =</span> <span class="st">"t.test"</span>,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a> <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(<span class="at">data =</span> fac1_tbl, <span class="at">x =</span> <span class="st">"animal"</span>, <span class="at">y =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"animal"</span>, <span class="at">palette =</span><span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">add =</span> <span class="st">"jitter"</span>, <span class="at">shape =</span> <span class="st">"animal"</span>)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_pvalue_manual</span>(stat_test_obj, <span class="at">label =</span> <span class="st">"p.adj"</span>, <span class="at">y.position =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">label.y =</span> <span class="dv">20</span>, <span class="at">method =</span> <span class="st">"anova"</span>)    </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggpubr-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggpubr-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-ggpubr-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-16" data-gallery="quarto-lightbox-gallery-16"><img src="stat-tests-posthoc_files/figure-html/fig-ggpubr-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggpubr-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.16— Boxplot der Sprungweiten [cm] von Hunden und Katzen ergänzt um den paarweisen Vergleich mit dem t-Test und den Bonferroni adjustierten p-Werten.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="paarweiser-wilcoxon-test" class="level3" data-number="39.3.2">
<h3 data-number="39.3.2" class="anchored" data-anchor-id="paarweiser-wilcoxon-test"><span class="header-section-number">39.3.2</span> Paarweiser Wilcoxon Test</h3>
<p>Wir nutzen den paarweisen Wilxocon Test,</p>
<ul>
<li>wenn wir ein <em>nicht</em>-normalverteiltes <span class="math inline">\(y\)</span> vorliegen haben, wie <code>grade</code>.</li>
<li>wenn wir <em>nur</em> einen Faktor mit mehr als zwei Leveln vorliegen haben, wie <code>animal</code>.</li>
</ul>
<p>Die Funktion <code>pairwise.wilcox.test</code> kann nicht mit Datensätzen arbeiten sondern nur mit Vektoren. Daher können wir der Funktion auch keine <code>formula</code> übergeben sondern müssen die Vektoren aus dem Datensatz mit <code>fac1_tbl$jump_length</code> für das Outcome und mit <code>fac1_tbl$animal</code> für die Gruppierende Variable benennen. Das ist umständlich und daher auch fehleranfällig.</p>
<p>Als Adjustierungsmethode für den <span class="math inline">\(\alpha\)</span> Fehler wählen wir die Bonferroni-Methode mit <code>p.adjust.method = "bonferroni"</code> aus. Da wir eine etwas unübersichtliche Ausgabe in R erhalten nutzen wir die Funktion <code>tidy()</code>um die Ausgabe in ein sauberes <code>tibble</code> zu verwandeln. Abschließend runden wir noch alle numerischen Spalten mit der Funktion <code>round</code> auf drei Stellen hinter dem Komma.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(fac1_tbl<span class="sc">$</span>grade, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  group1 group2 p.value
  &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
1 cat    dog      0.045
2 fox    dog      0.005
3 fox    cat      0.011</code></pre>
</div>
</div>
<p>Wir erhalten in einem Tibble die adujstierten p-Werte nach Bonferroni. Wir können daher die adjustierten p-Werte ganz normal mit dem Signifikanzniveau <span class="math inline">\(\alpha\)</span> von 5% vergleichen. Wir sehen, dass der Gruppenvergleich <code>cat - dog</code> knapp signifikant ist, der Gruppenvergleich <code>fox - dog</code> ebenfalls signifikant ist und der Gruppenvergleich <code>fox - cat</code> auch signifikant ist. Leider können wir uns keine Konfidenzintervalle wiedergeben lassen, so dass die Funktion nicht dem Stand der Wissenschaft und deren Ansprüchen genügt.</p>
<p>Im Folgenden wollen wir uns nochmal die Visualisierung mit dem R Paket <code>{ggpubr}</code> anschauen. Die <a href="https://rpkgs.datanovia.com/ggpubr/index.html">Hilfeseite des R Pakets <code>{ggpubr}</code></a> liefert noch eine Menge weitere Beispiele für den simplen Fall eines Modells <span class="math inline">\(y ~ x\)</span>, also von einem <span class="math inline">\(y\)</span> und einem Faktor <span class="math inline">\(x\)</span>. Um die <a href="#fig-ggpubr-2" class="quarto-xref">Abbildung&nbsp;<span>39.17</span></a> zu erstellen müssen wir als erstes die Funktion <code>compare_mean()</code> nutzen um mit der <code>formula</code> Syntax einen Wilcoxon Test zu rechnen. wir adjustieren die p-Werte nach Bonferroni. Anschließend erstellen wir einen Boxplot mit der Funktion <code>ggboxplot()</code> und speichern die Ausgabe in dem Objekt <code>p</code>. Wie in <code>ggplot</code> üblich können wir jetzt auf das Layer <code>p</code> über das <code>+</code>-Zeichen noch weitere Layer ergänzen. Wir nutzen die Funktion <code>stat_pvalue_manual()</code> um die asjustierten p-Werte aus dem Objekt <code>stat_test_obj</code> zu ergänzen. Abschließend wollen wir noch den p-Wert eines Kruskal Wallis als globalen Test ergänzen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>stat_test_obj <span class="ot">&lt;-</span> <span class="fu">compare_means</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a> grade <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a> <span class="at">method =</span> <span class="st">"wilcox.test"</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a> <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(<span class="at">data =</span> fac1_tbl, <span class="at">x =</span> <span class="st">"animal"</span>, <span class="at">y =</span> <span class="st">"grade"</span>,</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"animal"</span>, <span class="at">palette =</span><span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">add =</span> <span class="st">"jitter"</span>, <span class="at">shape =</span> <span class="st">"animal"</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_pvalue_manual</span>(stat_test_obj, <span class="at">label =</span> <span class="st">"p.adj"</span>, <span class="at">y.position =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">13</span>, <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">label.y =</span> <span class="dv">20</span>, <span class="at">method =</span> <span class="st">"kruskal.test"</span>)    </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggpubr-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggpubr-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-ggpubr-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-17" data-gallery="quarto-lightbox-gallery-17"><img src="stat-tests-posthoc_files/figure-html/fig-ggpubr-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggpubr-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.17— Boxplot der Sprungweiten [cm] von Hunden und Katzen ergänzt um den paarweisen Vergleich mit dem Wilcoxon Test und den Bonferroni adjustierten p-Werten.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-posthoc-emmeans" class="level2" data-number="39.4">
<h2 data-number="39.4" class="anchored" data-anchor-id="sec-posthoc-emmeans"><span class="header-section-number">39.4</span> Gruppenvergleich mit <code>{emmeans}</code></h2>
<p>Im Folgenden wollen wir uns mit einem anderen R Paket beschäftigen was auch multiple Vergleiche rechnen kann. In diesem Kapitel nutzen wir das R Paket <code>{emmeans}</code>. Im Prinzip kann <code>{emmeans}</code> das Gleiche wir das R Paket <code>{multcomp}</code>. Beide Pakete rechnen dir einen multiplen Vergleich. Das Paket <code>{emmeans}</code> kann noch mit <em>nested comparisons</em> umgehen. Deshalb hier nochmal die Vorstellung von <code>{emmeans}</code>. Du kannst aber für eine simple Auswertung mit nur einem Faktor beide Pakete verwenden.</p>
<p>Wir können hier nicht alles erklären und im Detail durchgehen. Hier gibt es noch ein aufwendiges Tutorium zu <code>emmeans</code>: <a href="https://aosmith.rbind.io/2019/03/25/getting-started-with-emmeans/">Getting started with emmeans</a>. Daneben gibt es auch noch die <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/basics.html#contents">Einführung mit Theorie auf der Seite des R Paktes</a> Es gibt hier auch ein weiteres englischsprachiges Tutorium <a href="https://yuzar-blog.netlify.app/posts/2022-12-29-emmeans2interactions/">Don’t Ignore Interactions - Unleash the Full Power of Models with {emmeans} R-package</a> oder <a href="https://yuzar-blog.netlify.app/posts/2022-11-29-emmeans/">{emmeans} Game-Changing R-package Squeezes Hidden Knowledge out of Models!</a>. <strong>DISCLAIMER:</strong> Der Text ist gut, die Bebilderung des entsprechenden Videos geht so leider mal gar nicht…</p>
<section id="gruppenvergleiche-mit-emmeans-in-r" class="level3" data-number="39.4.1">
<h3 data-number="39.4.1" class="anchored" data-anchor-id="gruppenvergleiche-mit-emmeans-in-r"><span class="header-section-number">39.4.1</span> Gruppenvergleiche mit <code>emmeans</code> in R</h3>
<p>Um den multiplen Vergleich in <code>emmeans</code> durchführen zu können brauchen wir zuerst ein lineares Modell, was uns die notwenidgen Parameter wie Mittelwerte und Standardabweichungen liefert. Wir nutzen in unserem simplen Beispiel ein lineares Modell mit einer Einflussvariable <span class="math inline">\(x\)</span> und nehmen an, dass unser Outcome <span class="math inline">\(y\)</span> normalverteilt ist. Achtung, hier muss natürlich das <span class="math inline">\(x\)</span> ein Faktor sein. Dann können wir ganz einfach die Funktion <code>lm()</code> nutzen. Im Folgenden fitten wir das Modell <code>fit_2</code> was wir dann auch weiter nutzen werden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Der multiple Vergleich in <code>emmeans</code> ist mehrschrittig. Wir pipen unser Modell aus <code>fit_2</code> in die Funktion <code>emmeans()</code>. Wir geben mit <code>~ animal</code> an, dass wir über die Level des Faktors <code>animal</code> einen Vergleich rechnen wollen. Wir adjustieren die <span class="math inline">\(p\)</span>-Werte nach Bonferroni. Danach pipen wir weiter in die Funktion <code>contrast()</code> wo der eigentliche Vergleich festgelegt wird. In unserem Fall wollen wir einen <em>many-to-one</em> Vergleich rechnen. Alle Gruppen zu der Gruppe <code>fox</code>. Du kannst mit <code>ref =</code> auch ein anderes Level deines Faktors wählen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>comp_2_obj <span class="ot">&lt;-</span> fit_2 <span class="sc">|&gt;</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"trt.vs.ctrl"</span>, <span class="at">ref =</span> <span class="st">"fox"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>comp_2_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast  estimate    SE df t.ratio p.value
 dog - fox    -1.03 0.947 18  -1.086  0.5837
 cat - fox    -4.41 0.947 18  -4.660  0.0004

P value adjustment: bonferroni method for 2 tests </code></pre>
</div>
</div>
<p>Wir können auch einen anderen Kontrast wählen. Wir überschreiben jetzt das Objekt <code>comp_2_obj</code> mit dem Kontrast <em>all-pair</em>, der alle möglichen Vergleiche rechnet. In <code>emmeans</code> heißt der <em>all-pair</em> Kontrast <em>pairwise</em>. Die Ausgabe von <code>emmeans</code> können über die Funktion <code>tidy()</code> aufgeräumt werden. Mehr dazu unter der <a href="https://broom.tidymodels.org/reference/tidy.emmGrid.html">Hilfeseite von <code>tidy</code>() zu emmeans</a>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>comp_2_obj <span class="ot">&lt;-</span> fit_2 <span class="sc">|&gt;</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>comp_2_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast  estimate    SE df t.ratio p.value
 dog - cat     3.39 0.947 18   3.574  0.0065
 dog - fox    -1.03 0.947 18  -1.086  0.8756
 cat - fox    -4.41 0.947 18  -4.660  0.0006

P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
<p>Wir können das Ergebnis auch noch mit der Funktion <code>tidy()</code> weiter aufräumen und dann die Spalten selektieren, die wir brauchen. Häufig benötigen wir nicht alle Spalten, die eine Funktion wiedergibt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>res_2_obj <span class="ot">&lt;-</span> comp_2_obj <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, adj.p.value, conf.low, conf.high) <span class="sc">|&gt;</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">4</span>))</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>res_2_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  contrast  estimate adj.p.value conf.low conf.high
  &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 dog - cat     3.39      0.0065    0.886      5.89
2 dog - fox    -1.03      0.876    -3.53       1.47
3 cat - fox    -4.41      0.0006   -6.91      -1.91</code></pre>
</div>
</div>
<p>Abschließend wollen wir noch die 95% Konfidenzintervalle in <a href="#fig-emmeans-1" class="quarto-xref">Abbildung&nbsp;<span>39.18</span></a> abbilden. Hier ist es bei <code>emmeans</code> genauso wie bei <code>multcomp</code>. Wir können das Objekt <code>res_2_obj</code> direkt in <code>ggplot()</code> weiterverwenden und uns die 95% Konfidenzintervalle einmal plotten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(res_2_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high)) <span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-emmeans-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-18" data-gallery="quarto-lightbox-gallery-18"><img src="stat-tests-posthoc_files/figure-html/fig-emmeans-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.18— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des simplen Datensatzes.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-emmeans-3" class="quarto-xref">Abbildung&nbsp;<span>39.19</span></a> sehen wir die Ergebnisse des multiplen Vergleiches nochmal anders als <em>Pairwise P-value plot</em> dargestellt. Wir haben auf der y-Achse zu Abwechselung mal die Gruppen dargestellt und auf der x-Achse die <span class="math inline">\(p\)</span>-Werte. In den Kästchen sind die Effekte der Gruppen nochmal gezeigt. In unserem Fall die Mittelwerte der Sprungweiten für die drei Gruppen. Wir sehen jetzt immer den <span class="math inline">\(p\)</span>-Wert für den jeweiligen Vergleich durch eine farbige Linie miteinander verbunden. So können wir nochmal eine andere Übersicht über das Ergebnis des multiplen Vergleich kriegen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="sc">|&gt;</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpp</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-emmeans-3-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-19" data-gallery="quarto-lightbox-gallery-19"><img src="stat-tests-posthoc_files/figure-html/fig-emmeans-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.19— Visualisierung der Ergebnisse im Pairwise P-value plot.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Auch haben wir die Möglichkeit un die <span class="math inline">\(p\)</span>-Werte mit der Funktion <code>pwpm()</code> als eine Matrix ausgeben zu lassen. Wir erhalten in dem oberen Triangel die <span class="math inline">\(p\)</span>-Wert für den jeweiligen Vergleich. In dem unteren Triangel die geschätzten Mittelwertsunterschiede. Auf der Diagonalen dann die geschätzten Mittelwerte für die jeweilige Gruppe. So haben wir nochmal alles sehr kompakt zusammen dargestellt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="sc">|&gt;</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       dog    cat    fox
dog [8.13] 0.0065 0.8756
cat   3.39 [4.74] 0.0006
fox  -1.03  -4.41 [9.16]

Row and column labels: animal
Upper triangle: P values   adjust = "bonferroni"
Diagonal: [Estimates] (emmean) 
Lower triangle: Comparisons (estimate)   earlier vs. later</code></pre>
</div>
</div>
<p>Wir wollen uns noch einen etwas komplizierteren Fall anschauen, indem sich <code>emmeans</code> von <code>multcomp</code> in der Anwendung unterscheidet. Wir laden den Datensatz <code>flea_dog_cat_fox_site.csv</code> in dem wir <em>zwei</em> Faktoren haben. Damit können wir dann ein Modell mit einem Interaktionsterm bauen. Wir erinnern uns, dass wir in der zweifaktoriellen ANOAV eine signifikante Interaktion zwischen den beiden Faktoren <code>animal</code> und <code>site</code> festgestelt hatten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/flea_dog_cat_fox_site.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, site, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">as_factor</span>(site))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir erhalten das Objekt <code>fac2_tbl</code> mit dem Datensatz in <a href="#tbl-data-emmeans-1" class="quarto-xref">Tabelle&nbsp;<span>39.2</span></a> nochmal dargestellt.</p>
<div class="cell">
<div id="tbl-data-emmeans-1" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-data-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;39.2— Selektierter Datensatz mit einer normalverteilten Variable <code>jump_length</code> und einem Faktor <code>animal</code> mit drei Leveln sowie dem Faktor <code>site</code> mit vier Leveln.
</figcaption>
<div aria-describedby="tbl-data-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">site</th>
<th style="text-align: center;">jump_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">12.04</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">11.98</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">16.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">13.42</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">12.37</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">city</td>
<td style="text-align: center;">16.36</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">16.38</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">14.59</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">14.03</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">13.63</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">14.09</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">field</td>
<td style="text-align: center;">15.52</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In <a href="#fig-boxplot-emmeans-1" class="quarto-xref">Abbildung&nbsp;<span>39.20</span></a> sehen wir nochmal die Daten visualisiert. Wichtig ist hier, dass wir <em>zwei</em> Faktoren vorliegen haben. Den Faktor <code>animal</code> und den Faktor <code>site</code>. Dabei ist der Faktor <code>animal</code> in dem Faktor <code>site</code> genested. Wir messen jedes Level des Faktors <code>animal</code> jeweils in jedem Level des Faktors <code>site</code>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-emmeans-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-boxplot-emmeans-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-20" data-gallery="quarto-lightbox-gallery-20"><img src="stat-tests-posthoc_files/figure-html/fig-boxplot-emmeans-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-emmeans-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.20— Boxplot der Sprungweiten [cm] von Hunden und Katzen gemessen an verschiedenen Orten.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir rechnen ein multiples lineares Modell mit einem Interaktionsterm. Daher packen wir beide Faktoren in das Modell sowie die Intraktion zwischen den beiden Faktoren. Wir erhalten nach dem fitten des Modells das Objekt <code>fit_3</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Der Unterschied zu unserem vorherigen multiplen Vergleich ist nun, dass wir auch einen multiplen Vergleich für <em>animal nested in site</em> rechnen können. Dafür müssen wir den Vergleich in der Form <code>animal | site</code> schreiben. Wir erhalten dann die Vergleiche der Level des faktors <code>animal</code> <em>getrennt</em> für die Level es Faktors <code>site</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>comp_3_obj <span class="ot">&lt;-</span> fit_3 <span class="sc">|&gt;</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site) <span class="sc">|&gt;</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>comp_3_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 contrast  estimate    SE  df t.ratio p.value
 cat - dog   -3.101 0.771 108  -4.022  0.0003
 cat - fox   -6.538 0.771 108  -8.479  &lt;.0001
 dog - fox   -3.437 0.771 108  -4.457  0.0001

site = smalltown:
 contrast  estimate    SE  df t.ratio p.value
 cat - dog   -4.308 0.771 108  -5.587  &lt;.0001
 cat - fox   -4.064 0.771 108  -5.271  &lt;.0001
 dog - fox    0.244 0.771 108   0.316  1.0000

site = village:
 contrast  estimate    SE  df t.ratio p.value
 cat - dog   -1.316 0.771 108  -1.707  0.2722
 cat - fox   -1.729 0.771 108  -2.242  0.0809
 dog - fox   -0.413 0.771 108  -0.536  1.0000

site = field:
 contrast  estimate    SE  df t.ratio p.value
 cat - dog   -0.982 0.771 108  -1.274  0.6167
 cat - fox    1.366 0.771 108   1.772  0.2379
 dog - fox    2.348 0.771 108   3.045  0.0088

P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
<p>Wir können uns das Ergebnis auch etwas schöner ausgeben lassen. Wir nutzen hier noch die Funktion <code>format.pval()</code> um die <span class="math inline">\(p\)</span>-Werte besser zu formatieren. Die <span class="math inline">\(p\)</span>-Wert, die kleiner sind als 0.001 werden als <code>&lt;0.001</code> ausgegeben und die anderen <span class="math inline">\(p\)</span>-Werte auf zwei Nachstellen nach dem Komma gerundet.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>comp_3_obj <span class="sc">|&gt;</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">|&gt;</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, site, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">format.pval</span>(p.value, <span class="at">eps =</span> <span class="fl">0.001</span>, <span class="at">digits =</span> <span class="dv">2</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   contrast  site      p.value
   &lt;fct&gt;     &lt;fct&gt;     &lt;chr&gt;  
 1 cat - dog city      &lt;0.001 
 2 cat - fox city      &lt;0.001 
 3 dog - fox city      &lt;0.001 
 4 cat - dog smalltown &lt;0.001 
 5 cat - fox smalltown &lt;0.001 
 6 dog - fox smalltown 1.00   
 7 cat - dog village   0.27   
 8 cat - fox village   0.08   
 9 dog - fox village   1.00   
10 cat - dog field     0.62   
11 cat - fox field     0.24   
12 dog - fox field     0.01   </code></pre>
</div>
</div>
<p>In der Ausgabe können wir erkennen, dass die Vergleich in der Stadt alle signifkant sind. Jedoch erkennen wir keine signifikanten Ergebnisse mehr in dem Dorf und im Feld ist nur der Vergleich <code>dog - fox</code> signifkant. Hier solltest du nochmal beachten, warum wir die Analyse getrennt machen. In der zweifaktoriellen ANOVA haben wir gesehen, dass ein signifkanter Interaktionsterm zwischen den beiden Faktoren <code>animal</code> und <code>site</code> vorliegt. Wir wollen uns noch über die Funktion <code>confint()</code> die 95% Konfidenzintervalle wiedergeben lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>res_3_obj <span class="ot">&lt;-</span> comp_3_obj <span class="sc">|&gt;</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">confint</span>() <span class="sc">|&gt;</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, site, estimate, <span class="at">conf.low =</span> lower.CL, <span class="at">conf.high =</span> upper.CL) </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>res_3_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 5
   contrast  site      estimate conf.low conf.high
   &lt;fct&gt;     &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
 1 cat - dog city        -3.10    -4.98     -1.23 
 2 cat - fox city        -6.54    -8.41     -4.66 
 3 dog - fox city        -3.44    -5.31     -1.56 
 4 cat - dog smalltown   -4.31    -6.18     -2.43 
 5 cat - fox smalltown   -4.06    -5.94     -2.19 
 6 dog - fox smalltown    0.244   -1.63      2.12 
 7 cat - dog village     -1.32    -3.19      0.559
 8 cat - fox village     -1.73    -3.60      0.146
 9 dog - fox village     -0.413   -2.29      1.46 
10 cat - dog field       -0.982   -2.86      0.893
11 cat - fox field        1.37    -0.509     3.24 
12 dog - fox field        2.35     0.473     4.22 </code></pre>
</div>
</div>
<p>Besonders mit den 95% Konfiendezintervallen sehen wir nochmal den Interaktionseffekt zwischen den beiden Faktoren <code>animal</code> und <code>site</code>. So dreht sich der Effekt von zum Beispiel <code>dog - fox</code> von <span class="math inline">\(-3.44\)</span> in dem Level <code>city</code> zu <span class="math inline">\(+2.35\)</span> in dem Level <code>field</code>. Wir haben eine Interaktion vorliegen und deshalb die Analyse getrennt für jeden Level des Faktors <code>site</code> durchgeführt. <a href="#fig-emmeans-2" class="quarto-xref">Abbildung&nbsp;<span>39.21</span></a> zeigt die entsprechenden 95% Konfidenzintervalle. Wir müssen hier etwas mit der <code>position</code> spielen, so dass die Punkte und der <code>geom_errorbar</code> richtig liegen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(res_3_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high,</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> site, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-emmeans-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-emmeans-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-21" data-gallery="quarto-lightbox-gallery-21"><img src="stat-tests-posthoc_files/figure-html/fig-emmeans-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emmeans-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.21— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des Models mit Interaktionseffekt.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-posthoc-multcomp" class="level2" data-number="39.5">
<h2 data-number="39.5" class="anchored" data-anchor-id="sec-posthoc-multcomp"><span class="header-section-number">39.5</span> Gruppenvergleich mit <code>{multcomp}</code></h2>
<p>Wir drehen hier einmal die Erklärung um. Wir machen erst die Anwendung in R und sollte dich dann noch mehr über die statistischen Hintergründe der Funktionen interessieren, folgt ein Abschnitt noch zur Theorie. Du wirst die Funktionen aus <code>multcomp</code> vermutlich in deiner Abschlussarbeit brauchen. Häufig werden multiple Gruppenvergleiche in Abschlussarbeiten gerechnet.</p>
<section id="gruppenvergleiche-mit-multcomp-in-r" class="level3" data-number="39.5.1">
<h3 data-number="39.5.1" class="anchored" data-anchor-id="gruppenvergleiche-mit-multcomp-in-r"><span class="header-section-number">39.5.1</span> Gruppenvergleiche mit <code>multcomp</code> in R</h3>
<p>Als erstes brauchen wir ein lineares Modell für die Verwendung von <code>multcomp</code>. Normalerweise verenden wir das gleiche Modell, was wir schon in der ANOVA verwendet haben. Wir nutzen hier ein simples lineares Modell mit nur einem Faktor. Im Prinzip kann das Modell auch größer sein, davon schauen wir uns dann später im Verlauf des Kapitels noch welche an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir haben das Objekt <code>fit_1</code> mit der Funktion <code>lm()</code> erstellt. Im Modell sind jetzt alle Mittelwerte und die entsprechenden Varianzen geschätzt worden. Mit <code>summary(fit_1)</code> kannst du dir gerne das Modell auch nochmal anschauen. Wenn wir keinen <em>all-pair</em> Vergleich rechnen wollen, dann können wir auch einen <em>many-to-one</em> Vergleich mit dem <code>Dunnett</code> Kontrast rechnen.</p>
<p>Im Anschluss nutzen wir die Funktion <code>glht()</code> um den multiplen Vergleich zu rechnen. Als erstes musst du wissen, dass wenn wir <em>alle</em> Vergleiche rechnen wollen, wir einen <em>all-pair</em> Vergleich rechnen. In der Statistik heißt dieser Typ von Vergleich <code>Tukey</code>. Wir wollen jetzt als für den Faktor <code>animal</code> einen multiplen <code>Tukey</code>-Vergleich rechnen. Nichts anders sagt <code>mcp(animal = "Tukey")</code> aus, dabei steht <code>mcp</code> für <em>multiple comparison procedure</em>. Mit dem hinteren Teil der Funktion weiß jetzt die Funktion <code>glht()</code> was gerechnet werden soll. Wir müssen jetzt der Funktion nur noch mitgeben auf was der multiple Vergleich gerechnet werden soll, mit dem Objekt <code>fit_1</code>. Wir speichern die Ausgabe der Funktion in <code>comp_1_obj</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>comp_1_obj <span class="ot">&lt;-</span> <span class="fu">glht</span>(fit_1, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">animal =</span> <span class="st">"Tukey"</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Mit dem Objekt <code>comp_1_fit</code> können wir noch nicht soviel anfangen. Der Inhalt ist etwas durcheinander und wir wollen noch die Konfidenzintervalle haben. Daher pipen wir <code>comp_1_fit</code> erstmal in die Funktion <code>tidy()</code> und lassen mit der Option <code>conf.int = TRUE</code> die simultanen 95% Konfidenzintervalle berechnen. Dann nutzen wir die Funktion <code>select()</code> um die wichtigen Spalten zu selektieren. Abschließend mutieren wir noch alle numerischen Spalten in dem wir auf die dritte Kommastelle runden. Wir speichern alles in das Objekt <code>res_1_obj</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>res_1_obj <span class="ot">&lt;-</span> comp_1_obj <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, adj.p.value, </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>         conf.low, conf.high) <span class="sc">|&gt;</span> </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir lassen uns dann den Inhalt von dem Objekt <code>res_1_obj</code> ausgeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>res_1_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  contrast  estimate adj.p.value conf.low conf.high
  &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 cat - dog    -3.39       0.006    -5.80    -0.969
2 fox - dog     1.03       0.535    -1.39     3.45 
3 fox - cat     4.41       0.001     2.00     6.83 </code></pre>
</div>
</div>
<p>Wir erhalten ein <code>tibble()</code> mit fünf Spalten. Zum einen den <code>contrast</code>, der den Vergleich widerspiegelt. Wir vergleichen im ersten Kontrast die Katzen- mit den Hundeflöhen, wobei wir <code>cat - dog</code> rechnen. Also wirklich der Mittelwert der Sprungweite der Katzenflöhe <em>minus</em> den Mittelwert der Sprungweite der Hundeflöhe rechnen. In der Spalte <code>estimate</code> sehen wir den Mittelwertsunterschied. Der Mittelwertsunterschied ist in der <em>Richtung</em> nicht ohne den Kontrast zu interpretieren. Danach erhalten wir die adjustierten <span class="math inline">\(p\)</span>-Wert sowie die simultanen 95% Konfidenzintervalle.</p>
<p>Wir können die Nullhypothese ablehnen für den Vergleiche<code>cat - dog</code> mit einem p-Wert von <span class="math inline">\(0.006\)</span> sowie für den Vergleich <span class="math inline">\(fox - cat\)</span> mit einem p-Wert von <span class="math inline">\(0.001\)</span>. Beide p-Werte liegen unter dem Signifikanzniveau von <span class="math inline">\(\alpha\)</span> gleich 5%.</p>
<p>Wenn es die unadjustierten <span class="math inline">\(p\)</span>-Werte sein sollen, dann müssen wir nochmal das <code>glht</code>-Objekt in die Funktion <code>summary()</code> stecken und dann die Option <code>test = adjusted("none")</code> wählen. Dann können wir weiter machen wie gewohnt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(comp_1_obj, <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"none"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  term   contrast  null.value estimate std.error statistic  p.value
  &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 animal cat - dog          0    -3.39     0.947     -3.57 0.00217 
2 animal fox - dog          0     1.03     0.947      1.09 0.292   
3 animal fox - cat          0     4.41     0.947      4.66 0.000195</code></pre>
</div>
</div>
<p>In <a href="#fig-multcomp-1" class="quarto-xref">Abbildung&nbsp;<span>39.22</span></a> sind die simultanen und damit adjustierten 95% Konfidenzintervalle nochmal in einem <code>ggplot</code> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab. Mit der Funktion <code>factor()</code> kannst du die Sortierung der Level einem Faktor ändern und somit auch Position auf den Achsen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(res_1_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high)) <span class="sc">+</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-multcomp-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-multcomp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-multcomp-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-22" data-gallery="quarto-lightbox-gallery-22"><img src="stat-tests-posthoc_files/figure-html/fig-multcomp-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-multcomp-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.22— Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Entscheidung gegen die Nullhypothese anhand der simultanen 95% Konfidenzintervalle ist inhaltlich gleich, wie die Entscheidung anhand der p-Werte. Wir entscheiden gegen die Nullhypothese, wenn die 0 nicht mit im Konfindenzintervall enthalten ist. Wir wählen hier die 0 zur Entscheidung gegen die Nullhypothese, weil wir einen Mittelwertsvergleich rechnen.</p>
<p>Für den Vergleich <code>fox -dog</code> ist die 0 im 95% Konfidenzintervall, wir können daher die Nullhypothese nicht ablehnen. Das 95% Konfidenzintervall ist nicht signifikant. Bei dem Vergleich <code>fox - cat</code> sowie dem Vergleich <code>cat - dog</code> ist jeweils die 0 nicht im 95% Konfidenzintervall enthalten. Beide 95% Konfidenzintervalle sind signifikant, wir können die Nullhypothese ablehnen.</p>
</section>
</section>
<section id="sec-posthoc-var-heterogen" class="level2" data-number="39.6">
<h2 data-number="39.6" class="anchored" data-anchor-id="sec-posthoc-var-heterogen"><span class="header-section-number">39.6</span> Gruppenvergleich mit Varianzheterogenität</h2>
<p>Bis jetzt sind wir von Varianzhomogenität über alle Gruppen in unserer Behandlung ausgegangen. Oder aber konkret auf unser Beispiel, die Tierarten haben alle die gleiche Varianz. Jetzt gibt es aber häufiger mal den Fall, da können oder wollen wir nicht an Varianzhomogenität über alle Gruppen glauben. Deshalb gibt es hier noch Alternativen, von denen ich ein paar Vorstellen werde.</p>
<section id="sec-posthoc-ght" class="level3" data-number="39.6.1">
<h3 data-number="39.6.1" class="anchored" data-anchor-id="sec-posthoc-ght"><span class="header-section-number">39.6.1</span> Games-Howell-Test</h3>
<p>Der Games-Howell-Test ist eine Alternative zu dem Paket <code>{multcomp}</code> und dem Paket <code>{emmeans}</code> für ein einfaktorielles Design. Wir nutzen den Games-Howell-Test, wenn die Annahme der Homogenität der Varianzen, der zum Vergleich aller möglichen Kombinationen von Gruppenunterschieden verwendet wird, verletzt ist. Dieser Post-Hoc-Test liefert Konfidenzintervalle für die Unterschiede zwischen den Gruppenmitteln und zeigt, ob die Unterschiede statistisch signifikant sind. Der Test basiert auf der Welch’schen Freiheitsgradkorrektur und adjustiert die <span class="math inline">\(p\)</span>-Werte. Der Test vergleicht also die Differenz zwischen den einzelnen Mittelwertpaaren mit einer Adjustierung für den Mehrfachtest. Es besteht also keine Notwendigkeit, zusätzliche p-Wert-Korrekturen vorzunehmen. Mit dem Games-Howell-Test ist nur ein <em>all-pair</em> Vergleich möglich.</p>
<p>Für den Games-Howell-Test aus dem Paket <code>{rstatix}</code> müssen wir kein lineares Modell fitten. Wir schreiben einfach die wie in einem t-Test das Outcome und den Faktor mit den Gruppenleveln in die Funktion <code>games_howell_test()</code>. Wir erhalten dann direkt das Ergebnis des Games-Howell-Test. Wir nutzen in diesem Beispiel die Daten aus dem Objekt <code>fac1_tbl</code> zu sehen in <a href="#tbl-data-posthoc-1" class="quarto-xref">Tabelle&nbsp;<span>39.1</span></a>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">games_howell_test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir wollen aber nicht mit der Ausgabe arbeiten sondern machen uns noch ein wenig Arbeit und passen die Ausgabe an. Zum einen brauchen wir noch die Kontraste und wir wollen die <span class="math inline">\(p\)</span>-Werte auch ansprechend formatieren. Wir erhalten das Objekt <code>res_4_obj</code> und geben uns die Ausgabe wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>res_4_obj <span class="ot">&lt;-</span> fit_4 <span class="sc">|&gt;</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2)) <span class="sc">|&gt;</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, p.adj, conf.low, conf.high) <span class="sc">|&gt;</span> </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">format.pval</span>(p.adj, <span class="at">eps =</span> <span class="fl">0.001</span>, <span class="at">digits =</span> <span class="dv">2</span>))</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>res_4_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  contrast estimate p.adj conf.low conf.high
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 dog-cat     -3.39 0.02     -6.28    -0.490
2 dog-fox      1.03 0.52     -1.52     3.57 
3 cat-fox      4.41 0.00      2.12     6.71 </code></pre>
</div>
</div>
<p>Wir erhalten ein <code>tibble()</code> mit fünf Spalten. Zum einen den <code>contrast</code>, der den Vergleich widerspiegelt, den haben wir uns selber mit der Funktion <code>mutate()</code> und <code>str_c()</code> aus den Spalten <code>group1</code> und <code>group2</code> gebaut. Wir vergleichen im ersten Kontrast die Katzen- mit den Hundeflöhen, wobei wir <code>dog-cat</code> rechnen. Also wirklich den Mittelwert der Sprungweite der Hundeflöhe <em>minus</em> den Mittelwert der Sprungweite der Katzenflöhe rechnen. In der Spalte <code>estimate</code> sehen wir den Mittelwertsunterschied. Der Mittelwertsunterschied ist in der <em>Richtung</em> nicht ohne den Kontrast zu interpretieren. Danach erhalten wir die adjustierten <span class="math inline">\(p\)</span>-Wert sowie die simultanen 95% Konfidenzintervalle.</p>
<p>Wir können die Nullhypothese ablehnen für den Vergleiche <code>dog - cat</code> mit einem p-Wert von <span class="math inline">\(0.02\)</span> sowie für den Vergleich <span class="math inline">\(cat - fox\)</span> mit einem p-Wert von <span class="math inline">\(0.00\)</span>. Beide p-Werte liegen unter dem Signifikanzniveau von <span class="math inline">\(\alpha\)</span> gleich 5%.</p>
<p>In <a href="#fig-ght-1" class="quarto-xref">Abbildung&nbsp;<span>39.23</span></a> sind die simultanen 95% Konfidenzintervalle nochmal in einem <code>ggplot</code> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(res_4_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high)) <span class="sc">+</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ght-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ght-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-ght-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-23" data-gallery="quarto-lightbox-gallery-23"><img src="stat-tests-posthoc_files/figure-html/fig-ght-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ght-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.23— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des Games-Howell-Test.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Entscheidungen nach den 95% Konfidenzintervallen sind die gleichen wie nach dem <span class="math inline">\(p\)</span>-Wert. Da wir hier es mit einem Mittelwertsvergleich zu tun haben, ist die Entscheidung gegen die Nullhypothese zu treffen wenn die 0 im Konfidenzintervall ist.</p>
</section>
<section id="generalized-least-squares" class="level3" data-number="39.6.2">
<h3 data-number="39.6.2" class="anchored" data-anchor-id="generalized-least-squares"><span class="header-section-number">39.6.2</span> Generalized Least Squares</h3>
<p>Neben dem Games-Howell-Test gibt es auch die Möglichkeit <em>Generalized Least Squares</em> zu nutzen. Hier haben wir dann auch die Möglichkeit mehrfaktorielle Modelle zu schätzen und dann auch wieder <code>emmeans</code> zu nutzen. Das ist natürlich super, weil wir dann wieder in dem <code>emmeans</code> Framework sind und alle Funktionen von oben nutzen können. Deshalb hier auch nur die Modellanpassung, den Rest kopierst du dir dann von oben dazu.</p>
<p>Die Funktion <code>gls()</code> aus dem R Paket <code>{nlme}</code> passt ein lineares Modell unter Verwendung der verallgemeinerten kleinsten Quadrate an. Die Fehler dürfen dabei aber korreliert oder aber ungleiche Varianzen haben. Damit haben wir ein Modell, was wir nutzen können, wenn wir Varianzheterogenität vorliegen haben. Hier einmal das simple Beispiel für die Tierarten. Wir nehmen wieder die ganz normale Formelschreiweise. Wir können jetzt aber über die Option <code>weights =</code> angeben, wie wir die Varianz modellieren wollen. Die Schreibweise mag etwas ungewohnt sein, aber es gibt wirklich viele Arten die Varainz zu modellieren. Hier machen wir uns es einfach und nutzen die Helferfunktion <code>varIdent</code> und modellieren dann für jedes Tier eine eigene Gruppenvarianz.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>gls_fac1_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal), </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir die Modellanpasssung auch schon in <code>emmeans()</code> weiterleiten und schauen uns mal das Ergebnis gleich an. Wir achten jetzt auf die Spalte <code>SE</code>, die uns ja den Fehler der Mittelwerte für jede Gruppe wiedergibt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>gls_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean    SE   df lower.CL upper.CL
 dog      8.13 0.811 6.00     6.15     10.1
 cat      4.74 0.719 6.01     2.98      6.5
 fox      9.16 0.415 6.00     8.14     10.2

Degrees-of-freedom method: satterthwaite 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wir sehen, dass wir für jedes Tier eine eigene Varianz über den Standardfehler <code>SE</code> geschätzt haben. Das war es ja auch was wir wollten. Bis hierhin wäre es auch mit dem Games-Howell-Test gegangen. Was ist aber, wenn wir ein zweifaktorielles design mit Interaktion schätzen wollen? Das können wir analog wie eben machen. Wir erweitern einfach das Modell um die Terme <code>site</code> für den zweiten Faktor und den Interaktionsterm <code>animal:site</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal), </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns wieder die multiplen Vergleiche getrennt für die Interaktionsterme wiedergeben lassen. Blöderweise haben jetzt alle Messorte <code>site</code> die gleiche Varianz für jede Tierart, aber auch da können wir noch ran.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 animal emmean    SE   df lower.CL upper.CL
 cat      13.6 0.603 36.0     12.4     14.8
 dog      16.7 0.581 36.1     15.5     17.9
 fox      20.1 0.437 36.0     19.2     21.0

site = smalltown:
 animal emmean    SE   df lower.CL upper.CL
 cat      13.7 0.603 36.0     12.5     15.0
 dog      18.0 0.581 36.1     16.9     19.2
 fox      17.8 0.437 36.0     16.9     18.7

site = village:
 animal emmean    SE   df lower.CL upper.CL
 cat      15.2 0.603 36.0     14.0     16.5
 dog      16.6 0.581 36.1     15.4     17.7
 fox      17.0 0.437 36.0     16.1     17.9

site = field:
 animal emmean    SE   df lower.CL upper.CL
 cat      16.2 0.603 36.0     15.0     17.4
 dog      17.2 0.581 36.1     16.0     18.3
 fox      14.8 0.437 36.0     13.9     15.7

Degrees-of-freedom method: satterthwaite 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Die eigentliche Stärke von <code>gls()</code> kommt eigentlich erst zu tragen, wenn wir auch noch erlauben, dass wir die Varianz <em>über alle</em> Tierarten, Messsorte und Interaktionen variieren kann. Das machen wir, in dem wir einfach <code>animal*site</code> zu der <code>varIdent()</code> Funktion ergänzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal<span class="sc">*</span>site), </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac2_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann noch schnell in <code>emmeans()</code> gesteckt und sich das Ergebnis angeschaut.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>site = city:
 animal emmean    SE    df lower.CL upper.CL
 cat      13.6 0.594  9.44     12.2     14.9
 dog      16.7 0.713  9.03     15.1     18.3
 fox      20.1 0.365  9.00     19.3     20.9

site = smalltown:
 animal emmean    SE    df lower.CL upper.CL
 cat      13.7 0.433  9.00     12.8     14.7
 dog      18.0 0.614 10.19     16.7     19.4
 fox      17.8 0.433  8.99     16.8     18.8

site = village:
 animal emmean    SE    df lower.CL upper.CL
 cat      15.2 0.743  9.00     13.6     16.9
 dog      16.6 0.384  9.00     15.7     17.4
 fox      17.0 0.548  8.87     15.7     18.2

site = field:
 animal emmean    SE    df lower.CL upper.CL
 cat      16.2 0.601  9.83     14.8     17.5
 dog      17.2 0.563  9.64     15.9     18.4
 fox      14.8 0.378  8.98     14.0     15.7

Degrees-of-freedom method: satterthwaite 
Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wie du jetzt siehst schätzen wir die Varianz für jede Tierart und jeden Messort separat. Wir haben also wirklich jede Varianz einzeln zugeordnet. Die Frage ist immer, ob das notwendig ist, denn wir brauchen auch eine gewisse Fallzahl, damit die Modelle funktionieren. Aber das kommt jetzt sehr auf deine Fragestellung an und müssten wir nochmal konkret besprechen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Literatur
</div>
</div>
<div class="callout-body-container callout-body">
<p>Auf der Seite DSFAIR gibt es noch einen Artikel zu <code>emmeans</code> und der Frage <a href="https://schmidtpaul.github.io/dsfair_quarto/ch/summaryarticles/whyseequal.html">Why are the StdErr all the same?</a> und dazu dann auch passend die Publikation <a href="https://www.cambridge.org/core/services/aop-cambridge-core/content/view/92DB0AF151C157B9C6E2FA40F9C9B635/S0014479719000401a.pdf/analyzing-designed-experiments-should-we-report-standard-deviations-or-standard-errors-of-the-mean-or-standard-errors-of-the-difference-or-what.pdf">Analyzing designed experiments: Should we report standard deviations or standard errors of the mean or standard errors of the difference or what?</a></p>
</div>
</div>
</section>
<section id="robuste-schätzung-von-standardfehlern" class="level3" data-number="39.6.3">
<h3 data-number="39.6.3" class="anchored" data-anchor-id="robuste-schätzung-von-standardfehlern"><span class="header-section-number">39.6.3</span> Robuste Schätzung von Standardfehlern</h3>
<p>Wir immer gibt es noch eine Möglichkeit die Varianzheterogenität zu behandeln. Wir nutzen jetzt hier einmal die Funktionen aus dem R Paket <code>{sandwich}</code>, die es uns ermöglichen Varianzheterogenität (eng. <em>heteroskedasticity</em>) zu modellieren. Es ist eigentlich super einfach, wir müssen als erstes wieder unser Modell anpassen. Hier einmal mit einer simplen linearen Regression.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>lm_fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir auch schon für einen Gruppenvergleich direkt in der Funktion <code>emmeans()</code> für die Varianzheterogenität adjustieren. Es gibt verschiedene mögliche Sandwich-Schätzer, aber wir nehmen jetzt mal einen der häufigsten mit <code>vcovHC</code>. Wie immer gilt, es gibt ja nach Datenlage bessere und schlechtere Schätzer. Wir laden jetzt nicht das ganze Paket, sondern nur die Funktion mit <code>sandwich::vcovHAC</code>. Achtung, hinter der Option <code>vcov.</code> ist ein <em>Punkt</em>. Ohne den Aufruf <code>vcov. =</code> funktioniert die Funktion dann nicht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>em_obj <span class="ot">&lt;-</span> lm_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal, <span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>em_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> animal emmean    SE df lower.CL upper.CL
 dog      8.13 0.427 18     7.23     9.03
 cat      4.74 0.810 18     3.04     6.44
 fox      9.16 0.468 18     8.17    10.14

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Wir du siehst, die Standardfehler sind jetzt nicht mehr über alle Gruppen gleich. Dann können wir uns auch die paarweisen Vergleiche ausgeben lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>contr_obj <span class="ot">&lt;-</span> em_obj <span class="sc">|&gt;</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Oder aber wir lassen uns das <em>compact letter display</em> wiedergeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>cld_obj <span class="ot">&lt;-</span> em_obj <span class="sc">|&gt;</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exkurs: Robuste Schätzung von Standardfehlern, Konfidenzintervallen und p-Werten
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Wenn du noch etwas weiter gehen möchtest, dann kannst du dir noch die Hilfeseite von dem R Paket <code>{performance}</code> <a href="https://easystats.github.io/parameters/articles/model_parameters_robust.html?q=Heteroskedasticity#robust-covariance-matrix-estimation-from-model-parameters">Robust Estimation of Standard Errors, Confidence Intervals, and p-values</a> anschauen. Die Idee ist hier, dass wir die Varianz/Kovarianz robuster daher mit der Berücksichtigung von Varianzheterogenität (eng. <em>heteroskedasticity</em>) schätzen.</p>
</div>
</div>
</div>
</section>
</section>
<section id="sec-compact-letter" class="level2" data-number="39.7">
<h2 data-number="39.7" class="anchored" data-anchor-id="sec-compact-letter"><span class="header-section-number">39.7</span> Compact letter display</h2>
<p>In der Pflanzenernährung ist es nicht unüblich sehr viele Substrate miteinander zu vergleichen. Oder andersherum, wenn wir sehr viele Gruppen haben, dann kann die Darstellung in einem <em>all-pair</em> Vergleich sehr schnell sehr unübersichltich werden. Deshalb wure das <em>compact letter display</em> entwickelt. Das <em>compact letter display</em> zeigt an, bei welchen Vergleichen der Behandlungen die Nullhypothese gilt. Daher werden die <em>nicht</em> signifikanten Ergebnisse visualisiert. Gut zu lesen ist auch die Vignette <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/re-engineering-clds.html">Re-engineering CLDs</a> der Hilfeseite zu <code>{emmeans}</code> sowie die Hilfeseite <a href="https://schmidtpaul.github.io/DSFAIR/compactletterdisplay.html">Compact Letter Display (CLD) - What is it?</a>.</p>
<p>Schauen wir uns aber zuerst einmal ein größeres Beispiel mit neun Behandlungen mit jeweils zwanzig Beobachtungen an. Wir erstellen uns den Datensatz in der Form, dass sich die Mittelwerte für die Behandlungen teilweise unterscheiden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20220914</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>data_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trt =</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">9</span>, <span class="at">k =</span> <span class="dv">20</span>, </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pos_ctrl"</span>, <span class="st">"neg_ctrl"</span>, <span class="st">"treat_A"</span>, <span class="st">"treat_B"</span>, </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"treat_C"</span>, <span class="st">"treat_D"</span>, <span class="st">"treat_E"</span>, <span class="st">"treat_F"</span>, </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"treat_G"</span>)),</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rsp =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">24</span>, <span class="dv">5</span>),</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">35</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">37</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">43</span>, <span class="dv">5</span>),</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">5</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#fig-boxplot-cld-1" class="quarto-xref">Abbildung&nbsp;<span>39.24</span></a> ist der Datensatz <code>data_tbl</code> nochmal als Boxplot dargestellt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-cld-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-cld-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-boxplot-cld-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-24" data-gallery="quarto-lightbox-gallery-24"><img src="stat-tests-posthoc_files/figure-html/fig-boxplot-cld-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-cld-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.24— Boxplot der Beispieldaten.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir sehen, dass sich die positive Kontrolle von dem Rest der Behandlungen unterscheidet. Danach haben wir ein Plateau mit der negativen Kontrolle und der Behanldung A und der Behandlung B. Nach diesem Plateau haben wir einen Sprung und sehen einen leicht linearen Anstieg der Mittelwerte der Behandlungen.</p>
<p>Schauen wir uns zuerst einmal an, wie ein <em>compact letter display</em> aussehen würde, wenn kein Effekt vorliegen würde. Daher die Nullhypothese ist wahr und die Mittelwerte der Gruppen unterscheiden sich nicht. Wir nutzen hier einmal ein kleineres Beispiel mit den Behandlungslevels <code>ctrl</code>, <code>treat_A</code> und <code>treat_B</code>. Alle drei Behandlungslevel haben einen Mittelwert von 10. Es gilt die Nullhypothese und wir erhalten folgendes <em>compact letter display</em> in <a href="#tbl-no-effect-cld" class="quarto-xref">Tabelle&nbsp;<span>39.3</span></a>.</p>
<div id="tbl-no-effect-cld" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-no-effect-cld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;39.3— Das <em>compact letter display</em> für drei Behandlungen nach einem paarweisen Vergleich. Die Nullhypothese gilt, es gibt keinen Mittelwertsunterschied.
</figcaption>
<div aria-describedby="tbl-no-effect-cld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Behandlung</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;"><span class="math inline">\(\phantom{a}\)</span></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ctrl</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"><span class="math inline">\(\phantom{a}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\phantom{a}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_A</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_B</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Das Gegenteil sehen wir in der <a href="#tbl-effect-cld" class="quarto-xref">Tabelle&nbsp;<span>39.4</span></a>. Hier haben wir ein <em>compact letter display</em> wo sich alle drei Mittelwerte mit 10, 15 und 20 voneinander klar unterscheiden. Die Nullhypothese gilt für keinen der möglichen paarweisen Vergleiche.</p>
<div id="tbl-effect-cld" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-effect-cld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;39.4— Das <em>compact letter display</em> für drei Behandlungen nach einem paarweisen Vergleich. Die Nullhypothese gilt nicht, es gibt einen Mittelwertsunterschied.
</figcaption>
<div aria-describedby="tbl-effect-cld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Behandlung</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ctrl</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"><span class="math inline">\(\phantom{a}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\phantom{a}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_A</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_B</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;"><span class="math inline">\(\phantom{a}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">c</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Schauen wir uns nun die Implementierung des <em>compact letter display</em> für die verschiedenen Möglichkeiten der Multiplen Vergleiche einmal an.</p>
<section id="für-pairwise..test" class="level3" data-number="39.7.1">
<h3 data-number="39.7.1" class="anchored" data-anchor-id="für-pairwise..test"><span class="header-section-number">39.7.1</span> … für <code>pairwise.*.test()</code></h3>
<p>Wenn wir für die Funktionen <code>pairwise.*.test()</code> das <em>compact letter display</em> berechnen wollen, dann müssen wir etwas ausholen. Denn wir müssen dafür die Funktion <code>multcompLetters()</code> nutzen. Diese Funktion braucht die <span class="math inline">\(p\)</span>-Werte als Matrix und diese Matrix der <span class="math inline">\(p\)</span>-Werte kriegen wir über die Funktion <code>fullPTable()</code>. Am Ende haben wir aber dann das was wir wollten. Ich habe hier nochmal das einfache Beispiel mit den Sprungweiten von oben genommen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract2</span>(<span class="st">"p.value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fullPTable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>dog cat fox 
"a" "b" "a" </code></pre>
</div>
</div>
<p>Als Ergebnis erhalten wir, dass Hund- und Fuchsflöhe gleich weit springen, beide teilen sich den gleichen Buchstaben. Katzenflöhe springen unterschiedlich zu Hunden- und Fuchsflöhen. Das Vorgehen ändert sich dann nicht, wenn wir eine andere Funktion wie <code>pairwise.wilcox.test()</code> nehmen.</p>
</section>
<section id="für-das-paket-emmeans" class="level3" data-number="39.7.2">
<h3 data-number="39.7.2" class="anchored" data-anchor-id="für-das-paket-emmeans"><span class="header-section-number">39.7.2</span> … für das Paket <code>{emmeans}</code></h3>
<p>In dem Paket <code>{emmeans}</code> ist das <em>compact letter display</em> ebenfalls implementiert und wir müssen nicht die Funktion <code>multcompLetters()</code> nutzen. Durch die direkte Implementierung ist es etwas einfacher sich das <em>compact letter display</em> anzeigen zu lassen. Das Problem ist dann später sich die Buchstaben zu extrahieren um die <a href="#fig-boxplot-cld-3" class="quarto-xref">Abbildung&nbsp;<span>39.25</span></a> zu ergänzen. Wir nutzen in <code>{emmeans}</code> die Funktion <code>cld()</code> um das <em>compact letter display</em> zu erstellen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>emmeans_cld <span class="ot">&lt;-</span> <span class="fu">lm</span>(rsp  <span class="sc">~</span> trt, <span class="at">data =</span> data_tbl) <span class="sc">|&gt;</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir erhalten dann die etwas besser sortierte Ausgabe für die Behandlungen wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>emmeans_cld </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> trt      emmean   SE  df lower.CL upper.CL .group 
 pos_ctrl   9.67 1.12 171     6.51     12.8  a     
 neg_ctrl  20.02 1.12 171    16.86     23.2   b    
 treat_A   20.97 1.12 171    17.81     24.1   b    
 treat_B   23.35 1.12 171    20.19     26.5   b    
 treat_C   34.96 1.12 171    31.80     38.1    c   
 treat_D   37.46 1.12 171    34.30     40.6    cd  
 treat_E   40.17 1.12 171    37.01     43.3     de 
 treat_F   43.23 1.12 171    40.07     46.4      e 
 treat_G   50.51 1.12 171    47.35     53.7       f

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 9 estimates 
P value adjustment: bonferroni method for 36 tests 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Wie die Ausgabe von <code>cld()</code> richtig anmerkt, können <em>compact letter display</em> irreführend sein weil sie eben <strong>Nicht</strong>-Unterschiede anstatt von signifikanten Unterschieden anzeigen. Zum Anderen sehen wir aber auch, dass wir 36 statistische Tests gerechnet haben und somit zu einem Signifikanzniveau von <span class="math inline">\(\cfrac{\alpha}{k} = \cfrac{0.05}{36} \approx 0.0014\)</span> testen. Wir brauchen also schon sehr große Unterschiede oder aber eine sehr kleine Streuung um hier signifikante Effekte nachweisen zu können.</p>
<p>In <a href="#tbl-mean-to-letter-emmeans" class="quarto-xref">Tabelle&nbsp;<span>39.5</span></a> sehen wir das Ergebnis des <em>compact letter display</em> nochmal mit den Mittelwerten der Behandlungslevel zusammen dargestellt. Wir sehen wieder, dass sich <code>pos_crtl</code> von allen anderen Behandlungen unterscheidet, deshalb hat nur die Behandlung <code>pos_crtl</code> den Buchstaben <code>a</code>. Die Mittelwerte vom <code>neg_ctrl</code>, <code>treat_A</code> und <code>treat_B</code> sind nahezu gleich, also damit nicht signifikant. Deshalb erhalten diese Behandlungslevel ein <code>b</code>. Wir gehen so alle Vergleiche einmal durch.</p>
<div id="tbl-mean-to-letter-emmeans" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mean-to-letter-emmeans-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;39.5— Kombination der Level der Behandlungen und deren Mittelwerte zur Generieung sowie dem <em>compact letter display</em> generiert aus den adjustierten <span class="math inline">\(p\)</span>-Werten aus <code>emmeans</code>. Gleiche Buchstaben bedeuten <em>kein</em> signifikanter Unterschied.
</figcaption>
<div aria-describedby="tbl-mean-to-letter-emmeans-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">Behandlung</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">pos_crtl</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">neg_ctrl</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_A</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_B</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_C</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">c</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_D</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">c</td>
<td style="text-align: center;">d</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_E</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">d</td>
<td style="text-align: center;">e</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_F</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">e</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_G</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">f</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Abschließend können wir die Buchstaben aus dem <em>compact letter display</em> noch in die <a href="#fig-boxplot-cld-3" class="quarto-xref">Abbildung&nbsp;<span>39.25</span></a> ergänzen. Hier müssen wir etwas mehr machen um die Buchstaben aus dem Objekt <code>emmeans_cld</code> zu bekommen. Du kannst dann noch die y-Position anpassen wenn du möchtest.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>letters_tbl <span class="ot">&lt;-</span> emmeans_cld <span class="sc">|&gt;</span> </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(trt, <span class="at">label =</span> .group) <span class="sc">|&gt;</span> </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rsp =</span> <span class="dv">0</span>)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> rsp, </span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letters_tbl, </span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> trt , <span class="at">y =</span> rsp, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-boxplot-cld-3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-cld-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-boxplot-cld-3-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-25" data-gallery="quarto-lightbox-gallery-25"><img src="stat-tests-posthoc_files/figure-html/fig-boxplot-cld-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-cld-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.25— Boxplot der Beispieldaten zusammen mit den <em>compact letter display</em>.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Das <em>compact letter display</em> anders gebaut…
</div>
</div>
<div class="callout-body-container callout-body">
<p>In dem kurzen Kapitel zu <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/re-engineering-clds.html">Re-engineering CLDs</a> in der Vingette des R Pakets <code>{emmeans}</code> geht es darum, wie das <em>compact letter display</em> auch anders gebaut werden könnte. Nämlich einmal als wirkliches Anzeigen von Gleichheit über die Option <code>delta</code> oder aber über das Anzeigen von Signifikanz über die Option <code>signif</code>. Damit haben dann auch wirklich die Information, die wir dann wollen. Also eigentlich was Schönes. Wie machen wir das nun?</p>
<p>Wenn wir das <em>compact letter display</em> in dem Sinne der Gleichheit der Behandlungen interpretieren wollen, also das der gleiche Buchstabe bedeutet, dass sich die Behandlungen nicht unterscheiden, dann müssen wir ein <code>delta</code> setzen in deren Bandbreite oder Intervall die Behandlungen gleich sind. Ich habe hier mal ein <code>delta</code> von 20 gewählt und wir adjustieren bei einem Test auf Gleichheit nicht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>emmeans_cld <span class="ot">&lt;-</span> <span class="fu">lm</span>(rsp  <span class="sc">~</span> trt, <span class="at">data =</span> data_tbl) <span class="sc">|&gt;</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>, <span class="at">delta =</span> <span class="dv">20</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>emmeans_cld </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> trt      emmean   SE  df lower.CL upper.CL .equiv.set
 pos_ctrl   9.67 1.12 171     7.45     11.9  a        
 neg_ctrl  20.02 1.12 171    17.80     22.2  ab       
 treat_A   20.97 1.12 171    18.75     23.2  abc      
 treat_B   23.35 1.12 171    21.13     25.6  abcd     
 treat_C   34.96 1.12 171    32.74     37.2   bcde    
 treat_D   37.46 1.12 171    35.24     39.7    cde    
 treat_E   40.17 1.12 171    37.94     42.4     de    
 treat_F   43.23 1.12 171    41.01     45.4      e    
 treat_G   50.51 1.12 171    48.29     52.7      e    

Confidence level used: 0.95 
Statistics are tests of equivalence with a threshold of 20 
P values are left-tailed 
significance level used: alpha = 0.05 
Estimates sharing the same symbol test as equivalent </code></pre>
</div>
</div>
<p>Wie wir jetzt sehen, bedeuten gleiche Buchstaben, dass die Behandlungen gleich sind. In dem Sinne gleich sind, dass die Behandlungen im Mittel nicht weiter als der Wert in <code>delta</code> auseinanderliegen. Wie du jetzt das <code>delta</code> bestimmst ist eine biologische und keine statistische Frage.</p>
<p>Können wir uns auch signifikante Unterschiede anzeigen lassen? Ja, können wir auch, aber das ist meiner Meinung nach die schlechtere der beiden Anpassungen. Wir haben ja im Kopf, dass das <em>compact letter display</em> eben mit gleichen Buchstaben das Gleiche anzeigt. Jetzt würden wir diese Eigenschaften zu Unterschied ändern. Schauen wir uns das einmal an einem kleineren Datensatz einmal an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>small_fit <span class="ot">&lt;-</span> data_tbl <span class="sc">|&gt;</span> </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"pos_ctrl"</span>, <span class="st">"neg_ctrl"</span>, <span class="st">"treat_A"</span>, <span class="st">"treat_G"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(rsp  <span class="sc">~</span> trt, <span class="at">data =</span> _) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns hier einmal das Problem mit den Buchstaben anschauen. Wir kriegen jetzt mit der Option <code>signif = TRUE</code> wiedergeben <code>Estimates sharing the same symbol are significantly different</code> und das ist irgendwie auch wirr, dass <em>gleiche</em> Buchstaben einen Unterschied darstellen. Das <em>compact letter display</em> wird eben als Gleichheit gelesen, so dass wir hier mehr verwirrt werden als es hilft.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>small_fit <span class="sc">|&gt;</span> </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>, <span class="at">signif =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> trt      emmean   SE df lower.CL upper.CL .signif.set
 pos_ctrl   9.67 1.08 76      6.9     12.4  ab        
 neg_ctrl  20.02 1.08 76     17.2     22.8  a         
 treat_A   20.97 1.08 76     18.2     23.7   b        
 treat_G   50.51 1.08 76     47.7     53.3  ab        

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 4 estimates 
P value adjustment: bonferroni method for 6 tests 
significance level used: alpha = 0.05 
Estimates sharing the same symbol are significantly different </code></pre>
</div>
</div>
<p>Deshalb würde ich auf die Buchstaben verzichten und die Zahlen angeben, damit hier nicht noch mehr Verwirrung aufkommt. Wir nehmen also die Option für die Buchstaben einmal aus dem <code>cld()</code> Aufruf raus. Dann haben wir Zahlen als Gruppenzuweisung, was schon mal was anderes ist als die Buchstaben aus dem <em>compact letter display</em>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>small_fit <span class="sc">|&gt;</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>, <span class="at">signif =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> trt      emmean   SE df lower.CL upper.CL .signif.set
 pos_ctrl   9.67 1.08 76      6.9     12.4  12        
 neg_ctrl  20.02 1.08 76     17.2     22.8  1         
 treat_A   20.97 1.08 76     18.2     23.7   2        
 treat_G   50.51 1.08 76     47.7     53.3  12        

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 4 estimates 
P value adjustment: bonferroni method for 6 tests 
significance level used: alpha = 0.05 
Estimates sharing the same symbol are significantly different </code></pre>
</div>
</div>
<p>Innerhalb des selben Konzepts dann zwei Arten von Interpretation des <em>compact letter display</em> zu haben, ist dann auch nicht zielführend. Den auch die <em>gleichen</em> Zahlen bedeuten jetzt einen Unterschied. Irgendwie mag ich persönlich nicht diese sehr verdrehte Interpretation nicht. Deshalb lieber ein <code>delta</code> einführen und auf echte Gleichheit testen.</p>
</div>
</div>
</section>
<section id="für-das-paket-multcomp" class="level3" data-number="39.7.3">
<h3 data-number="39.7.3" class="anchored" data-anchor-id="für-das-paket-multcomp"><span class="header-section-number">39.7.3</span> … für das Paket <code>{multcomp}</code></h3>
<p>Wir schauen uns zuerst einmal die Implementierung des <em>compact letter display</em> in dem Paket <code>{multcomp}</code> an. Wir nutzen die Funktion <code>multcompLetters()</code> aus dem Paket <code>{multcompView}</code> um uns das <em>compact letter display</em> wiedergeben zu lassen. Davor müssen wir noch einige Schritte an Sortierung und Umbenennung durchführen. Das hat den Grund, dass die Funktion <code>multcompLetters()</code> <em>nur</em> einen benannten Vektor mit <span class="math inline">\(p\)</span>-Werten akzeptiert. Das heist wir müssen aus der Funktion <code>glht()</code> die adjustierten <span class="math inline">\(p\)</span>-Werte extrahieren und dann einen Vektor der Vergleiche bzw. Kontraste in der Form <code>A-B</code> bauen. Also ohne Leerzeichen und in der Beschreibung der Level der Behandlung <code>trt</code>. Die Funktion <code>pull()</code> erlaubt uns einen Spalte als Vektor aus einem <code>tibble()</code> zu ziehen und dann nach der Spalte <code>contrast</code> zu benennen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>multcomp_cld <span class="ot">&lt;-</span> <span class="fu">lm</span>(rsp  <span class="sc">~</span> trt, <span class="at">data =</span> data_tbl) <span class="sc">|&gt;</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glht</span>(<span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">trt =</span> <span class="st">"Tukey"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(adj.p.value, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir erhalten dann folgendes <em>compact letter display</em> für die paarweisen Vergleiche aus <code>multcomp</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>multcomp_cld </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>neg_ctrl  treat_A  treat_B  treat_C  treat_D  treat_E  treat_F  treat_G 
     "a"      "a"      "a"      "b"     "bc"     "cd"      "d"      "e" 
pos_ctrl 
     "f" </code></pre>
</div>
</div>
<p>Leider sind diese Buchstaben in dieser Form schwer zu verstehen. Deshalb gibt es noch die Funktion <code>plot()</code> in dem Paket <code>{multcompView}</code> um uns die Buchstaben mit den Leveln der Behandlung einmal ausgeben zu lassen. Wir erhalten dann folgende Abbildung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>multcomp_cld <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="stat-tests-posthoc_files/figure-html/unnamed-chunk-88-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="stat-tests-posthoc_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>In dem <em>compact letter display</em> bedeuten gleiche Buchstaben, dass die Behandlungen gleich sind. Es gilt die Nullhypothese für diesen Vergleich. Was sehen wir also hier? Kombinieren wir einmal das <em>compact letter display</em> mit den Leveln der Behandlung und den Mittelwerten der Behandlungen in einer <a href="#tbl-mean-to-letter-multcomp" class="quarto-xref">Tabelle&nbsp;<span>39.6</span></a>. Wenn die Mittelwerte <em>gleich</em> sind, dann erhalten die Behandlungslevel den gleichen Buchstaben. Die Mittelwerte vom <code>neg_ctrl</code>, <code>treat_A</code> und <code>treat_B</code> sind nahezu gleich, also damit nicht signifikant. Deshalb erhalten diese Behandlungslevel ein <code>a</code>. Ebenso sind die MIttelwerte von <code>treat_C</code> und <code>treat_D</code> nahezu gleich, dehalb erhalten beide ein <code>b</code>. Das machen wir immer so weiter und konzentrieren uns also auf die <em>nicht</em> signifikanten Ergebnisse. Denn gleiche Buchstaben bedeuten, dass die Behandlungen gleich sind. Wir sehen hier also, bei welchen Vergleichen die Nullhypothese gilt.</p>
<div id="tbl-mean-to-letter-multcomp" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mean-to-letter-multcomp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;39.6— Kombination der Level der Behandlungen und deren Mittelwerte zur Generieung sowie dem <em>compact letter display</em> generiert aus den adjustierten <span class="math inline">\(p\)</span>-Werten aus <code>multcomp</code>. Gleiche Buchstaben bedeuten <em>kein</em> signifikanter Unterschied.
</figcaption>
<div aria-describedby="tbl-mean-to-letter-multcomp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">Behandlung</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">neg_ctrl</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_A</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_B</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_C</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_D</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;">c</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_E</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">c</td>
<td style="text-align: center;">d</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_F</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">d</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_G</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">e</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">pos_crtl</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">f</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wir können dann die Buchstaben auch in den Boxplot ergaänzen. Die y-Position kann je nach Belieben dann noch angepasst werden. zum Beispiel könnten hier auch die Mittelwerte aus einer <code>summarise()</code> Funktion ergänzt werden und so die y-Position angepasst werden.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>letters_tbl <span class="ot">&lt;-</span> multcomp_cld<span class="sc">$</span>Letters <span class="sc">|&gt;</span> </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">enframe</span>(<span class="st">"trt"</span>, <span class="st">"label"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rsp =</span> <span class="dv">0</span>)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> rsp, </span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letters_tbl, </span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> trt , <span class="at">y =</span> rsp, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-boxplot-cld-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-cld-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-boxplot-cld-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-27" data-gallery="quarto-lightbox-gallery-27"><img src="stat-tests-posthoc_files/figure-html/fig-boxplot-cld-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-cld-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.26— Boxplot der Beispieldaten zusammen mit den <em>compact letter display</em>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="für-den-games-howell-test" class="level3" data-number="39.7.4">
<h3 data-number="39.7.4" class="anchored" data-anchor-id="für-den-games-howell-test"><span class="header-section-number">39.7.4</span> … für den Games-Howell-Test</h3>
<p>Abschließend wollen wir uns die Implementierung des <em>compact letter display</em> für den Games-Howell-Test einmal anschauen. Es gilt vieles von dem in diesem Abschnitt schon gesagtes. Wir nutzen die Funktion <code>multcompLetters()</code> aus dem Paket <code>{multcompView}</code> um uns das <em>compact letter display</em> aus dem Games-Howell-Test wiedergeben zu lassen. Davor müssen wir noch einige Schritte an Sortierung und Umbenennung durchführen. Das hat den Grund, dass die Funktion <code>multcompLetters()</code> <em>nur</em> einen benannten Vektor mit <span class="math inline">\(p\)</span>-Werten akzeptiert. Die Funktion <code>pull()</code> erlaubt uns einen Spalte als Vektor aus einem <code>tibble()</code> zu ziehen und dann nach der Spalte <code>contrast</code> zu benennen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>ght_cld <span class="ot">&lt;-</span> <span class="fu">games_howell_test</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> data_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2)) <span class="sc">|&gt;</span> </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p.adj, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Das <em>compact letter display</em> kennen wir schon aus der obigen Beschreibung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>ght_cld</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>pos_ctrl neg_ctrl  treat_A  treat_B  treat_C  treat_D  treat_E  treat_F 
     "a"      "b"      "b"      "b"      "c"     "cd"      "d"      "d" 
 treat_G 
     "e" </code></pre>
</div>
</div>
<p>Wir können uns dann auch das <em>compact letter display</em> als übersichtlicheren Plot wiedergeben lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>ght_cld <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="stat-tests-posthoc_files/figure-html/unnamed-chunk-92-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="stat-tests-posthoc_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>Um die Zusammenhänge besser zu verstehen ist in <a href="#tbl-mean-to-letter-ght" class="quarto-xref">Tabelle&nbsp;<span>39.7</span></a> nochmal die Kombination der Level der Behandlungen und deren Mittelwerte zur Generieung sowie dem <em>compact letter display</em> dargestellt. Wir sehen wieder, dass sich <code>pos_crtl</code> von allen anderen Behandlungen unterscheidet, deshalb hat nur die Behandlung <code>pos_crtl</code> den Buchstaben <code>a</code>. Die Mittelwerte vom <code>neg_ctrl</code>, <code>treat_A</code> und <code>treat_B</code> sind nahezu gleich, also damit nicht signifikant. Deshalb erhalten diese Behandlungslevel ein <code>b</code>. In der Form können wir alle Vergleiche einmal durchgehen.</p>
<div id="tbl-mean-to-letter-ght" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mean-to-letter-ght-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;39.7— Kombination der Level der Behandlungen und deren Mittelwerte zur Generieung sowie dem <em>compact letter display</em> generiert aus den adjustierten <span class="math inline">\(p\)</span>-Werten aus dem Games-Howell-Test. Gleiche Buchstaben bedeuten <em>kein</em> signifikanter Unterschied.
</figcaption>
<div aria-describedby="tbl-mean-to-letter-ght-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">Behandlung</th>
<th style="text-align: center;">Mittelwert</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">pos_crtl</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">a</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">neg_ctrl</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_A</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_B</td>
<td style="text-align: center;">24</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">b</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_C</td>
<td style="text-align: center;">35</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">c</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_D</td>
<td style="text-align: center;">37</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">c</td>
<td style="text-align: center;">d</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_E</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">d</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">treat_F</td>
<td style="text-align: center;">43</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">d</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">treat_G</td>
<td style="text-align: center;">45</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">e</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wir können dann auch in <a href="#fig-boxplot-cld-4" class="quarto-xref">Abbildung&nbsp;<span>39.27</span></a> sehen, wie das <em>compact letter display</em> mit den Boxplots verbunden wird.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>letters_tbl <span class="ot">&lt;-</span> ght_cld<span class="sc">$</span>Letters <span class="sc">|&gt;</span> </span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">enframe</span>(<span class="st">"trt"</span>, <span class="st">"label"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rsp =</span> <span class="dv">0</span>)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> rsp, </span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letters_tbl, </span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> trt , <span class="at">y =</span> rsp, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-boxplot-cld-4" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-cld-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-posthoc_files/figure-html/fig-boxplot-cld-4-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-29" data-gallery="quarto-lightbox-gallery-29"><img src="stat-tests-posthoc_files/figure-html/fig-boxplot-cld-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-cld-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;39.27— Boxplot der Beispieldaten zusammen mit den <em>compact letter display</em>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Abbildung&nbsp;39.1— <em>“Total soluble solids (TSS) in ‘Alicia’ papaya propagated by seed, grafting, and in vitro (n = 12 ± s.e.), evaluated from April 2020 to May 2021 at the maturation of 100% yellow skin color. The line marks the 10 °Brix value, commonly referred to as the minimum for papaya commercialization. Different letters on the same date indicate statistically significant differences between propagation procedures (Tukey’s test p &lt; 0.05).”</em> Quelle: <span class="citation" data-cites="salinas2023plant">Salinas u.&nbsp;a. (<a href="#ref-salinas2023plant" role="doc-biblioref">2023</a>)</span></span>
<span class="glightbox-desc lightbox-desc-2">Abbildung&nbsp;39.2— <em>“Panicles with commercial fruit (%) at 2019 and 2020 harvest. In the same year, different letters indicate significant differences among treatments (Tukey’s test p&lt;0.05).”</em> Quelle: <span class="citation" data-cites="sanchez2022hoverfly">Sánchez u.&nbsp;a. (<a href="#ref-sanchez2022hoverfly" role="doc-biblioref">2022</a>)</span></span>
<span class="glightbox-desc lightbox-desc-3">Abbildung&nbsp;39.3— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein simples Säulendiagramm mit sehr für Farbblinde ungünstigen Farben. Es sind die Mittelwerte sowie die Standardabweichung durch die Fehlerbalken dargestellt.</span>
<span class="glightbox-desc lightbox-desc-4">Abbildung&nbsp;39.4— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt.</span>
<span class="glightbox-desc lightbox-desc-5">Abbildung&nbsp;39.5— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt. Die Varianzheterogenität nach der Funktion <code>gls()</code> im obigen Modell berücksichtigt.</span>
<span class="glightbox-desc lightbox-desc-6">Abbildung&nbsp;39.6— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut mit den Informationen aus der Funktion <code>emmeans()</code>. Das <em>compact letter display</em> wird dann über das <em>geom_text()</em> gesetzt. Die Varianzheterogenität nach der Funktion <code>sandwich::vcovHAC</code> im obigen Modell berücksichtigt.</span>
<span class="glightbox-desc lightbox-desc-7">Abbildung&nbsp;39.7— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit den zwei Faktoren Zeit und die Iodine Form.</span>
<span class="glightbox-desc lightbox-desc-8">Abbildung&nbsp;39.8— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen. Die Kontrolle wurde entfernt, sonst hätten wir hier nicht <code>emmeans</code> in der einfachen Form nutzen können. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen.</span>
<span class="glightbox-desc lightbox-desc-9">Abbildung&nbsp;39.9— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen. Die Kontrolle wurde entfernt, sonst hätten wir hier nicht <code>emmeans</code> in der einfachen Form nutzen können. Wir rechnen hier die Vergleiche getrennt für die beiden Jodformen.</span>
<span class="glightbox-desc lightbox-desc-10">Abbildung&nbsp;39.10— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit den zwei Faktoren Zeit und die Iodine Form. Hier soll es dann ein Boxplot werden.</span>
<span class="glightbox-desc lightbox-desc-11">Abbildung&nbsp;39.11— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen, dafür müssen wir uns aber nochmal ein Positionsdatensatz bauen. Hier ist das <em>compact letter display</em> getrennt für die beiden Jodformen berechnet.</span>
<span class="glightbox-desc lightbox-desc-12">Abbildung&nbsp;39.12— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen, dafür müssen wir uns aber nochmal ein Positionsdatensatz bauen. Hier ist das <em>compact letter display</em> für jede einzelne Faktorkombination berechnet.</span>
<span class="glightbox-desc lightbox-desc-13">Abbildung&nbsp;39.13— Ursprüngliche Abbildung, die nachgebaut werden soll. Insgesamt vier Outcomes sollen für zwei Behandlungen ausgewertet werden. Das praktische ist hier, dass wir es nur mit einem einfaktoriellen Design zu tun haben.</span>
<span class="glightbox-desc lightbox-desc-14">Abbildung&nbsp;39.14— Nachbau der Abbildung mit der Funktion <code>facte_wrap()</code> mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das <em>compact letter display</em>. Auf eine Einfärbung nach der Behandlung wurde verzichtet um die Abbildung nicht noch mehr zu überladen.</span>
<span class="glightbox-desc lightbox-desc-15">Abbildung&nbsp;39.15— Nachbau der Abbildung mit dem R Paket <code>{patchwork}</code> mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das <em>compact letter display</em> bei dem ersten Plot. Auf eine Einfärbung nach der Behanldung wurde verzichtet um die Abbildung nicht noch mehr zu überladen.</span>
<span class="glightbox-desc lightbox-desc-16">Abbildung&nbsp;39.16— Boxplot der Sprungweiten [cm] von Hunden und Katzen ergänzt um den paarweisen Vergleich mit dem t-Test und den Bonferroni adjustierten p-Werten.</span>
<span class="glightbox-desc lightbox-desc-17">Abbildung&nbsp;39.17— Boxplot der Sprungweiten [cm] von Hunden und Katzen ergänzt um den paarweisen Vergleich mit dem Wilcoxon Test und den Bonferroni adjustierten p-Werten.</span>
<span class="glightbox-desc lightbox-desc-18">Abbildung&nbsp;39.18— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des simplen Datensatzes.</span>
<span class="glightbox-desc lightbox-desc-19">Abbildung&nbsp;39.19— Visualisierung der Ergebnisse im Pairwise P-value plot.</span>
<span class="glightbox-desc lightbox-desc-20">Abbildung&nbsp;39.20— Boxplot der Sprungweiten [cm] von Hunden und Katzen gemessen an verschiedenen Orten.</span>
<span class="glightbox-desc lightbox-desc-21">Abbildung&nbsp;39.21— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des Models mit Interaktionseffekt.</span>
<span class="glightbox-desc lightbox-desc-22">Abbildung&nbsp;39.22— Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe.</span>
<span class="glightbox-desc lightbox-desc-23">Abbildung&nbsp;39.23— Die 95% Konfidenzintervalle für den <em>allpair</em>-Vergleich des Games-Howell-Test.</span>
<span class="glightbox-desc lightbox-desc-24">Abbildung&nbsp;39.24— Boxplot der Beispieldaten.</span>
<span class="glightbox-desc lightbox-desc-25">Abbildung&nbsp;39.25— Boxplot der Beispieldaten zusammen mit den <em>compact letter display</em>.</span>
<span class="glightbox-desc lightbox-desc-27">Abbildung&nbsp;39.26— Boxplot der Beispieldaten zusammen mit den <em>compact letter display</em>.</span>
<span class="glightbox-desc lightbox-desc-29">Abbildung&nbsp;39.27— Boxplot der Beispieldaten zusammen mit den <em>compact letter display</em>.</span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-cumming2007error" class="csl-entry" role="listitem">
Cumming G, Fidler F, Vaux DL. 2007. Error bars in experimental biology. The Journal of cell biology 177: 7–11.
</div>
<div id="ref-salinas2023plant" class="csl-entry" role="listitem">
Salinas I, Hueso JJ, Força Baroni D, Cuevas J. 2023. Plant Growth, Yield, and Fruit Size Improvements in ‘Alicia’Papaya Multiplied by Grafting. Plants 12: 1189.
</div>
<div id="ref-sanchez2022hoverfly" class="csl-entry" role="listitem">
Sánchez M, Velásquez Y, González M, Cuevas J. 2022. Hoverfly pollination enhances yield and fruit quality in mango under protected cultivation. Scientia Horticulturae 304: 111320.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-tests-permutationstest.html" class="pagination-link" aria-label="Der Permutationstest">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-linear-reg-preface.html" class="pagination-link" aria-label="Grundlagen des Modellierens">
        <span class="nav-page-text">Grundlagen des Modellierens</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb129" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc, see, latex2exp,</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="in">               multcomp, emmeans, ggpubr, multcompView, nlme, quantreg, janitor,</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="in">               parameters, effectsize, patchwork, conflicted)</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="fu"># Der Post-hoc-Test {#sec-posthoc}</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-tests-posthoc.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Comparison is the thief of joy." --- Theodore Roosevelt*</span></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel wollen wir uns mit den multiplen Vergleichen (eng. *post hoc analysis*) oder aber auch paarweise Gruppenvergleiche genannt beschäftigen. Wir kennen diese multiplen Tests auch unter dem Namen *Posthoc Tests*, da wir historisch diese Tests *nach* einer ANOVA durchgeführt haben. Das heißt, wir wollen statistisch Testen, ob sich verschiedene Gruppen einer Behandlung voneinander unterschieden. Technisch Testen wir dabei, ob sich die Level eines Faktors voneinander unterscheiden. Wir können dabei mehrere Faktoren bzw. Behandlungen berücksichtigen und gleichzeitig Testen. Wenn wir nur einen Faktor betrachten, dann sprechen wir von einem 1-faktoriellen Vergleich. Wenn wir zwei Behandlungen betrachten, dann entsprechend von einem 2-faktoriellen Vergleich. Sehr selten haben wir dann noch den Fall vorliegen, dass wir drei Faktoren betrachten wollen. In einer Abschlussarbeit haben wir faktisch keine Versuche wo wir mehr als drei Faktoren in einem Gruppenvergleich berücksichtigen.</span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a>Wo wollen wir also hin? Betrachten wir dazu einmal zwei wissenschaftliche Veröffentlichungen als Beispiele. In der @fig-zerforschen-papaya sehen wir ein Säulendigramm aus der wissenschaftlichen Veröffentlichung von @salinas2023plant mit dem Titel <span class="co">[</span><span class="ot">"Plant Growth, Yield, and Fruit Size Improvements in 'Alicia' Papaya Multiplied by Grafting"</span><span class="co">](https://www.mdpi.com/2223-7747/12/5/1189)</span>. Wir haben hier also einen 2-faktoriellen Gruppenvergleich vorliegen. Der erste Faktor ist die *TSS* Behandlung mit *seed*, *grafting* und *in virto*. Der zweite Faktor sind dann die fünf Zeitpunkte zu denen jeweils die Behandlung auf die Papaya gegeben wurde. In diesem Kapitel wollen wir die Buchstaben aus einem paarweisen Gruppenvergleich über den Säulen erschaffen oder auch *compact letter display* genannt.</span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a><span class="al">![*"Total soluble solids (TSS) in 'Alicia' papaya propagated by seed, grafting, and in vitro (n = 12 ± s.e.), evaluated from April 2020 to May 2021 at the maturation of 100% yellow skin color. The line marks the 10 °Brix value, commonly referred to as the minimum for papaya commercialization. Different letters on the same date indicate statistically significant differences between propagation procedures (Tukey's test p \&lt; 0.05)."* Quelle: @salinas2023plant](images/eda/zerforschen_papaya.png)</span>{#fig-zerforschen-papaya fig-align="center" width="70%"}</span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a>In der @fig-zerforschen-hoverfly sehen wir ein Säulendigramm aus der wissenschaftlichen Veröffentlichung von @sanchez2022hoverfly mit dem Titel <span class="co">[</span><span class="ot">"Hoverfly pollination enhances yield and fruit quality in mango under protected cultivation"</span><span class="co">](https://www.sciencedirect.com/science/article/pii/S0304423822004411)</span>. Auch hier haben wir ein 2-faktorielles Design vorliegen. Zum einen den Faktor *treatment* mit den Gruppen *High density*, *medium density*, *Low density* und *Control*. Der zweite Faktor ist dann das Jahr der Messung. Auch hier sehen wir wieder Buchstaben über den Säulen. Diese Buchstabenwollen wir dann als *compact letter display* hier in diesem Kapitel erstellen. Zu den Fehlerbalken liefert die Publikation <span class="co">[</span><span class="ot">Error bars in experimental biology</span><span class="co">](https://rupress.org/jcb/article/177/1/7/34602/Error-bars-in-experimental-biology)</span> von @cumming2007error nochmal einen Überblick über Fehlerbalken und welche Fehlerbalken man den nun nutzen sollte.</span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-27"><a href="#cb129-27" aria-hidden="true" tabindex="-1"></a><span class="al">![*"Panicles with commercial fruit (%) at 2019 and 2020 harvest. In the same year, different letters indicate significant differences among treatments (Tukey's test p\&lt;0.05)."* Quelle: @sanchez2022hoverfly](images/eda/zerforschen_hoverfly.png)</span>{#fig-zerforschen-hoverfly fig-align="center" width="70%"}</span>
<span id="cb129-28"><a href="#cb129-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-29"><a href="#cb129-29" aria-hidden="true" tabindex="-1"></a>Dann wissen wir jetzt wohin wir wollen. Jetzt stellt sich noch die Frage, welches statistisches Verfahren soll ich wählen um einen Gruppenvergleich zu rechnen? In der folgenden Box gebe ich dir da einmal einen Überblick. Abhängig von deinem Outcome oder deinen gemessenen Werten, musst du dich für ein anderes Verfahren entscheiden. Es kann also sein, dass du verschiedene statistische Tests in deiner Abschlussarbeit rechnest, da du verschiedene Outcomes statistisch analysierst. Wir schauen uns in diesem Kapitel zum größten Teil den Fall eines normalverteilten Outcomes an. An einem normalverteilten Outcome, wie Frische- oder Trockengewicht, lassen sich einfacher die Prinzipien des multiplen Testen erklären. Deshalb hier der Fokus auf der Normalverteilung -- andere Möglichkeiten dann in der Box.</span>
<span id="cb129-30"><a href="#cb129-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-31"><a href="#cb129-31" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb129-32"><a href="#cb129-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Welches statistisches Modell für welchen Gruppenvergleich?</span></span>
<span id="cb129-33"><a href="#cb129-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-34"><a href="#cb129-34" aria-hidden="true" tabindex="-1"></a>Welches Verfahren soll ich für meinen Gruppenvergleich wählen? Ich habe in den jeweiligen Kapiteln zu den statistischen Modellen die jeweiligen Schritte für die Gruppenvergleiche hinterlegt und beschrieben. Daher kannst du in den Kapiteln einmal schauen, wie dein Outcome dort ausgewertet wird. Du findest dort auch immer ein Beispiel mit entsprechenden Daten.</span>
<span id="cb129-35"><a href="#cb129-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-36"><a href="#cb129-36" aria-hidden="true" tabindex="-1"></a>Normalverteiltes Outcome $\boldsymbol{y}$: Frischgewicht, Trockengewicht, Chlorophyllgehalt...</span>
<span id="cb129-37"><a href="#cb129-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-38"><a href="#cb129-38" aria-hidden="true" tabindex="-1"></a>:   Dann schaue dir den Abschnitt zu <span class="co">[</span><span class="ot">Multiple Gruppenvergleiche für normalverteilte Daten</span><span class="co">](#sec-mult-comp-gaussian-reg)</span> an. Das ist eigentlich *der* Standardfall und vieles in diesem Kapitel dreht sich um normalverteilte Daten.</span>
<span id="cb129-39"><a href="#cb129-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-40"><a href="#cb129-40" aria-hidden="true" tabindex="-1"></a>Poissonverteiltes Outcome $\boldsymbol{y}$ bzw. Zähldaten: Anzahl Insekten, gekeimte Pflanzen, Schädlinge...</span>
<span id="cb129-41"><a href="#cb129-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-42"><a href="#cb129-42" aria-hidden="true" tabindex="-1"></a>:   Dann schaue dir den Abschnitt zu <span class="co">[</span><span class="ot">Multiple Gruppenvergleiche für Zähldaten</span><span class="co">](#sec-mult-comp-pois-reg)</span> an -- dein Outcome besteht nämlich aus einer Zählung von einem Auftreten eines Ereignisses.</span>
<span id="cb129-43"><a href="#cb129-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-44"><a href="#cb129-44" aria-hidden="true" tabindex="-1"></a>Ordinalverteiltes Outcome $\boldsymbol{y}$: Bonitur von Rasen, Brokkolistängel, Wurzelwachstum...</span>
<span id="cb129-45"><a href="#cb129-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-46"><a href="#cb129-46" aria-hidden="true" tabindex="-1"></a>:   Dann schaue dir den Abschnitt zu <span class="co">[</span><span class="ot">Multiple Gruppenvergleiche für Boniturdaten</span><span class="co">](#sec-mult-comp-ord-reg)</span> an -- dein Outocme besteht aus Noten für ein Merkmal.</span>
<span id="cb129-47"><a href="#cb129-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-48"><a href="#cb129-48" aria-hidden="true" tabindex="-1"></a>Binomialverteiltes Outcome $\boldsymbol{y}$ bzw. Anteile: Infektionsstatus, Zielgewicht erreicht...</span>
<span id="cb129-49"><a href="#cb129-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-50"><a href="#cb129-50" aria-hidden="true" tabindex="-1"></a>:   Dann schaue dir den Abschnitt zu <span class="co">[</span><span class="ot">Multiple Gruppenvergleiche für Anteile</span><span class="co">](#sec-mult-comp-log-reg)</span> an -- dein Outcome ist $0/1$ oder $ja/nein$ kodiert. Ein Ereignis ist eingetreten oder eben nicht.</span>
<span id="cb129-51"><a href="#cb129-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-52"><a href="#cb129-52" aria-hidden="true" tabindex="-1"></a>Betaverteiltes Outcome $\boldsymbol{y}$ bzw. Wahrscheinlichkeiten: Anteil infizierte Pflanzen, Erfolg/Misserfolg...</span>
<span id="cb129-53"><a href="#cb129-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-54"><a href="#cb129-54" aria-hidden="true" tabindex="-1"></a>:   Dann schaue dir den Abschnitt zu <span class="co">[</span><span class="ot">Multiple Gruppenvergleiche für Wahrscheinlichkeiten</span><span class="co">](#sec-mult-comp-beta-reg)</span> an -- dein Outcome ist eine Wahrscheinlcihkeit für das Eintreten eines Ereignisses oder aber die Rate eines Erfolges an Misserfolgen.</span>
<span id="cb129-55"><a href="#cb129-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-56"><a href="#cb129-56" aria-hidden="true" tabindex="-1"></a>Auswertungen mit 3 oder mehr Faktoren:</span>
<span id="cb129-57"><a href="#cb129-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-58"><a href="#cb129-58" aria-hidden="true" tabindex="-1"></a>:   Dann schaue dir den Abschnitt zu <span class="co">[</span><span class="ot">Multiple Gruppenvergleiche für gemischte Modelle</span><span class="co">](#sec-mult-comp-lmer-reg)</span> an -- dein Outcome wurde 3-faktoriell oder mit mehr Faktoren gemessen.</span>
<span id="cb129-59"><a href="#cb129-59" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb129-60"><a href="#cb129-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-61"><a href="#cb129-61" aria-hidden="true" tabindex="-1"></a>Wenn wir multiple Mittelwertsvergleiche rechnen, dann tritt das Problem des multiplen Testens auf. Wir haben eine Inflation des $\alpha$-Fehlers vorliegen. Im @sec-statistisches-testen-alpha-adjust kannst du mehr über die Problematik erfahren und wie wir mit der $\alpha$ Inflation umgehen. Hier in diesem Kapitel gehe ich jetzt davon aus, dass dir die $\alpha$ Adjustierung ein Begriff ist. Häufig sollen $p$-Werte nicht adjustiert werden, viele Verfahren in diesem Kapitel adjustieren aber automatisch die $p$-Werte. Deshalb musst du aktiv die Adjustierung der $p$-Werte abstellen. Du findest dann in Abschnitten zu den jeweiligen statistischen Verfahren die entsprechende Option. Der paarweise Mittelwertsvergleich wird auch gerne Tukey Test genannt. Das heißt, dass der Tukey Test alle Gruppen miteinander vergleicht. Der Tukey Test wird daher auch gerne *all pair* Vergleich genannt.</span>
<span id="cb129-62"><a href="#cb129-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-63"><a href="#cb129-63" aria-hidden="true" tabindex="-1"></a>Schaue dir auch die folgenden Zerforschenbeispiele einmal an, wenn dich mehr zu dem Thema der Abbildung von multiplen Gruppenvergleichen interessiert. Du findest in den Kästen Beispiele für Posterabbildungen zur multiplen Gruppenvergleichen, die ich dann zerforscht habe.</span>
<span id="cb129-64"><a href="#cb129-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-65"><a href="#cb129-65" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb129-66"><a href="#cb129-66" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zerforschen: Einfaktorieller Barplot mit `emmeans` und *compact letter display*</span></span>
<span id="cb129-67"><a href="#cb129-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-68"><a href="#cb129-68" aria-hidden="true" tabindex="-1"></a>{{&lt; include zerforschen/zerforschen-simple-barplot-emmeans.qmd &gt;}}</span>
<span id="cb129-69"><a href="#cb129-69" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb129-70"><a href="#cb129-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-71"><a href="#cb129-71" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb129-72"><a href="#cb129-72" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zerforschen: Zweifaktorieller Barplot mit `emmeans` und *compact letter display*</span></span>
<span id="cb129-73"><a href="#cb129-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-74"><a href="#cb129-74" aria-hidden="true" tabindex="-1"></a>{{&lt; include zerforschen/zerforschen-barplot-2fac-target-emmeans.qmd &gt;}}</span>
<span id="cb129-75"><a href="#cb129-75" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb129-76"><a href="#cb129-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-77"><a href="#cb129-77" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb129-78"><a href="#cb129-78" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zerforschen: Zweifaktorieller Boxplot mit `emmeans` und *compact letter display*</span></span>
<span id="cb129-79"><a href="#cb129-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-80"><a href="#cb129-80" aria-hidden="true" tabindex="-1"></a>{{&lt; include zerforschen/zerforschen-boxplot-2fac-target-emmeans.qmd &gt;}}</span>
<span id="cb129-81"><a href="#cb129-81" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb129-82"><a href="#cb129-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-83"><a href="#cb129-83" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb129-84"><a href="#cb129-84" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zerforschen: Boxplots mit `emmeans` und *compact letter display*</span></span>
<span id="cb129-85"><a href="#cb129-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-86"><a href="#cb129-86" aria-hidden="true" tabindex="-1"></a>{{&lt; include zerforschen/zerforschen-boxplot-mult.qmd &gt;}}</span>
<span id="cb129-87"><a href="#cb129-87" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb129-88"><a href="#cb129-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-89"><a href="#cb129-89" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb129-90"><a href="#cb129-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-91"><a href="#cb129-91" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb129-92"><a href="#cb129-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-93"><a href="#cb129-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb129-94"><a href="#cb129-94" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb129-95"><a href="#cb129-95" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, broom, nlme, </span></span>
<span id="cb129-96"><a href="#cb129-96" aria-hidden="true" tabindex="-1"></a><span class="in">               multcomp, emmeans, ggpubr, multcompView,</span></span>
<span id="cb129-97"><a href="#cb129-97" aria-hidden="true" tabindex="-1"></a><span class="in">               rstatix, conflicted, see, rcompanion)</span></span>
<span id="cb129-98"><a href="#cb129-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-99"><a href="#cb129-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-100"><a href="#cb129-100" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb129-101"><a href="#cb129-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-102"><a href="#cb129-102" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb129-103"><a href="#cb129-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-104"><a href="#cb129-104" aria-hidden="true" tabindex="-1"></a>Wir nutzen in diesem Kapitel den Datensatz aus dem Beispiel in @sec-example-3. Wir haben als Outcome die Sprunglänge in <span class="sc">\[</span>cm<span class="sc">\]</span> von Flöhen. Die Sprunglänge haben wir an Flöhen von Hunde, Katzen und Füchsen gemessen. Der Datensatz ist also recht übeerschaubar. Wir haben ein normalverteiltes $y$ mit <span class="in">`jump_length`</span> sowie einen multinomialverteiltes $y$ mit <span class="in">`grade`</span> und einen Faktor <span class="in">`animal`</span> mit drei Leveln. Im Folgenden laden wir den Datensatz <span class="in">`flea_dog_cat_fox.csv`</span> und selektieren mit der Funktion <span class="in">`select()`</span> die benötigten Spalten. Abschließend müssen wir die Spalte <span class="in">`animal`</span>noch in einen Faktor umwandeln. Damit ist unsere Vorbereitung des Datensatzes abgeschlossen.</span>
<span id="cb129-105"><a href="#cb129-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-108"><a href="#cb129-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-109"><a href="#cb129-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-110"><a href="#cb129-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-111"><a href="#cb129-111" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/flea_dog_cat_fox.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb129-112"><a href="#cb129-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length, grade) <span class="sc">|&gt;</span> </span>
<span id="cb129-113"><a href="#cb129-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span>
<span id="cb129-114"><a href="#cb129-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-115"><a href="#cb129-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-116"><a href="#cb129-116" aria-hidden="true" tabindex="-1"></a>In der @tbl-data-posthoc-1 ist der Datensatz <span class="in">`fac1_tbl`</span> nochmal dargestellt. Wir werden nun den Datensatz <span class="in">`fac1_tbl`</span> in den folgenden Abschnitten immer wieder nutzen.</span>
<span id="cb129-117"><a href="#cb129-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-118"><a href="#cb129-118" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true"}</span>
<span id="cb129-119"><a href="#cb129-119" aria-hidden="true" tabindex="-1"></a><span class="fu">## Für die vollständige Datentabelle bitte aufklappen</span></span>
<span id="cb129-120"><a href="#cb129-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-123"><a href="#cb129-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-124"><a href="#cb129-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-125"><a href="#cb129-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-126"><a href="#cb129-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Selektierter Datensatz mit einer normalverteilten Variable `jump_length` sowie der multinominalverteilten Variable `grade` und einem Faktor `animal` mit drei Leveln.</span></span>
<span id="cb129-127"><a href="#cb129-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-data-posthoc-1</span></span>
<span id="cb129-128"><a href="#cb129-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-129"><a href="#cb129-129" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="sc">|&gt;</span> <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb129-130"><a href="#cb129-130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-131"><a href="#cb129-131" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb129-132"><a href="#cb129-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-133"><a href="#cb129-133" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hypothesen für multiple Vergleiche</span></span>
<span id="cb129-134"><a href="#cb129-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-135"><a href="#cb129-135" aria-hidden="true" tabindex="-1"></a>Als wir eine ANOVA gerechnet hatten, hatten wir nur eine Nullhypothese und eine Alternativehypothese. Wenn wir Nullhypothese abgelehnt hatten, wussten wir nur, dass sich mindestens ein paarweiser Vergleich unterschiedet. Multiple Vergleich lösen nun dieses Problem und führen ein Hypothesen*paar* für jeden paarweisen Vergleich ein. Zum einen rechnen wir damit $k$ Tests und haben damit auch $k$ Hypothesenpaare (siehe auch @sec-statistisches-testen-alpha-adjust zur Problematik des wiederholten Testens). Wenn wir zum Beispiel alle Level des Faktors <span class="in">`animal`</span> miteinander Vergleichen wollen, dann rechnen wir $k=3$ paarweise Vergleiche. Im Folgenden sind alle drei Hypothesenpaare dargestellt.</span>
<span id="cb129-136"><a href="#cb129-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-137"><a href="#cb129-137" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb129-138"><a href="#cb129-138" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb129-139"><a href="#cb129-139" aria-hidden="true" tabindex="-1"></a>H_{01}: &amp;\; \bar{y}_{cat} = \bar{y}_{dog}<span class="sc">\\</span></span>
<span id="cb129-140"><a href="#cb129-140" aria-hidden="true" tabindex="-1"></a>H_{A1}: &amp;\; \bar{y}_{cat} \ne \bar{y}_{dog}<span class="sc">\\</span></span>
<span id="cb129-141"><a href="#cb129-141" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb129-142"><a href="#cb129-142" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb129-143"><a href="#cb129-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-144"><a href="#cb129-144" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb129-145"><a href="#cb129-145" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb129-146"><a href="#cb129-146" aria-hidden="true" tabindex="-1"></a>H_{02}: &amp;\; \bar{y}_{cat} = \bar{y}_{fox}<span class="sc">\\</span></span>
<span id="cb129-147"><a href="#cb129-147" aria-hidden="true" tabindex="-1"></a>H_{A2}: &amp;\; \bar{y}_{cat} \ne \bar{y}_{fox}<span class="sc">\\</span></span>
<span id="cb129-148"><a href="#cb129-148" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb129-149"><a href="#cb129-149" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb129-150"><a href="#cb129-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-151"><a href="#cb129-151" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb129-152"><a href="#cb129-152" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb129-153"><a href="#cb129-153" aria-hidden="true" tabindex="-1"></a>H_{03}: &amp;\; \bar{y}_{dog} = \bar{y}_{fox}<span class="sc">\\</span></span>
<span id="cb129-154"><a href="#cb129-154" aria-hidden="true" tabindex="-1"></a>H_{A3}: &amp;\; \bar{y}_{dog} \ne \bar{y}_{fox}<span class="sc">\\</span></span>
<span id="cb129-155"><a href="#cb129-155" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb129-156"><a href="#cb129-156" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb129-157"><a href="#cb129-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-158"><a href="#cb129-158" aria-hidden="true" tabindex="-1"></a>Wenn wir drei Vergleiche rechnen, dann haben wir eine $\alpha$ Inflation vorliegen. Wir sagen, dass wir für das multiple Testen adjustieren müssen. In R gibt es eine Reihe von Adjustierungsverfahren. Wir nehmen meist Bonferroni oder das Verfahren, was in der jeweiligen Funktion als Standard (eng. *default*) gesetzt ist. Wir adjustieren grundsätzlich die $p$-Werte und erhalten adjustierte $p$-Werte aus den jeweiligen Funktionen in R. Die adjustierten p-Werte können wir dann mit dem Signifikanzniveau von $\alpha$ gleich 5% vergleichen.</span>
<span id="cb129-159"><a href="#cb129-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-160"><a href="#cb129-160" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simple Gruppenvergleiche {#sec-posthoc-pairwise}</span></span>
<span id="cb129-161"><a href="#cb129-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-162"><a href="#cb129-162" aria-hidden="true" tabindex="-1"></a>Wenn wir nur einen Faktor mit mehr als zwei Leveln vorliegen haben, dann können wir die Funktion <span class="in">`pairwise.*.test()`</span> nutzen. Der Stern <span class="in">`*`</span> steht entweder als Platzhalter für <span class="in">`t`</span> für den t-Test oder aber für <span class="in">`wilcox`</span> für den Wilcoxon Test. Die Funktion ist relativ einfach zu nutzen und liefert auch sofort die entsprechenden p-Werte. Die Funktion <span class="in">`pairwise.*.test()`</span> ist in dem Sinne *veraltet*, da wir keine 95% Konfidenzintervalle generieren können. Da die Funktion aber immer mal wieder angefragt wird, ist die Funktion hier nochmal aufgeführt. Die Funktion `pairwise.*.test()` ist *veraltet*, wir nutzen das R Paket <span class="in">`{emmeans}`</span> oder das R Paket <span class="in">`{multcomp}`</span>.</span>
<span id="cb129-163"><a href="#cb129-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-164"><a href="#cb129-164" aria-hidden="true" tabindex="-1"></a><span class="fu">### Paarweiser t Test</span></span>
<span id="cb129-165"><a href="#cb129-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-166"><a href="#cb129-166" aria-hidden="true" tabindex="-1"></a>Wir nutzen den paarweisen t-Test,</span>
<span id="cb129-167"><a href="#cb129-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-168"><a href="#cb129-168" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>wenn wir ein normalverteiltes $y$ vorliegen haben, wie <span class="in">`jump_length`</span>.</span>
<span id="cb129-169"><a href="#cb129-169" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>wenn wir *nur* einen Faktor mit mehr als zwei Leveln vorliegen haben, wie <span class="in">`animal`</span>.</span>
<span id="cb129-170"><a href="#cb129-170" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>wenn wir Varianzhomogenität über alle Level vorliegen haben, dann nutzen wir die Option <span class="in">`pool.sd = TRUE`</span>. Wenn wir Varianzheterogenität über alle Level des Faktors vorliegen haben, dann nutzen wir <span class="in">`pool.sd = FALSE`</span>.</span>
<span id="cb129-171"><a href="#cb129-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-172"><a href="#cb129-172" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`pairwise.t.test`</span> kann nicht mit Datensätzen arbeiten sondern nur mit Vektoren. Daher können wir der Funktion auch keine <span class="in">`formula`</span> übergeben sondern müssen die Vektoren aus dem Datensatz mit <span class="in">`fac1_tbl$jump_length`</span> für das Outcome und mit <span class="in">`fac1_tbl$animal`</span> für die Gruppierende Variable benennen. Das ist umständlich und daher auch fehleranfällig. Wir können auch den <span class="in">`%$%`</span>-Operator aus dem R Paket <span class="in">`{magrittr}`</span> nutzen um die Problematik zu umgehen. Weiter unten siehst du dann einmal beide Anwendungen.</span>
<span id="cb129-173"><a href="#cb129-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-174"><a href="#cb129-174" aria-hidden="true" tabindex="-1"></a>Als Adjustierungsmethode für den $\alpha$ Fehler wählen wir die Bonferroni-Methode mit <span class="in">`p.adjust.method = "bonferroni"`</span> aus. Da wir eine etwas unübersichtliche Ausgabe in R erhalten nutzen wir die Funktion <span class="in">`tidy()`</span>um die Ausgabe in ein sauberes <span class="in">`tibble`</span> zu verwandeln. Abschließend runden wir noch alle numerischen Spalten mit der Funktion <span class="in">`round`</span> auf drei Stellen hinter dem Komma.</span>
<span id="cb129-175"><a href="#cb129-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-178"><a href="#cb129-178" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-179"><a href="#cb129-179" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb129-180"><a href="#cb129-180" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb129-181"><a href="#cb129-181" aria-hidden="true" tabindex="-1"></a>                <span class="at">pool.sd =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-182"><a href="#cb129-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-183"><a href="#cb129-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb129-184"><a href="#cb129-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-185"><a href="#cb129-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-186"><a href="#cb129-186" aria-hidden="true" tabindex="-1"></a>Und das ganze nochmal mit dem <span class="in">`%$%`</span>-Operator aus dem R Paket <span class="in">`{magrittr}`</span>. In diesem Fall können wir uns das <span class="in">`$`</span> sparen und greifen direkt auf die Spalten des Datensatzes zu.</span>
<span id="cb129-187"><a href="#cb129-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-190"><a href="#cb129-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-191"><a href="#cb129-191" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="sc">%$%</span></span>
<span id="cb129-192"><a href="#cb129-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairwise.t.test</span>(jump_length, animal,</span>
<span id="cb129-193"><a href="#cb129-193" aria-hidden="true" tabindex="-1"></a>                  <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb129-194"><a href="#cb129-194" aria-hidden="true" tabindex="-1"></a>                  <span class="at">pool.sd =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-195"><a href="#cb129-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-196"><a href="#cb129-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb129-197"><a href="#cb129-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-198"><a href="#cb129-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-199"><a href="#cb129-199" aria-hidden="true" tabindex="-1"></a>Wir erhalten in einem Tibble die adjustierten p-Werte nach Bonferroni. Wir können daher die adjustierten p-Werte ganz normal mit dem Signifikanzniveau $\alpha$ von 5% vergleichen. Wenn du keine adjustierten p-Werte möchtest, dann nutze die Option <span class="in">`p.adjust.method = "none"`</span>. Wir sehen, dass der Gruppenvergleich <span class="in">`cat - dog`</span> signifikant ist, der Gruppenvergleich <span class="in">`fox - dog`</span> nicht signifikant ist und der Gruppenvergleich <span class="in">`fox - cat`</span> wiederum signifikant ist. Leider können wir uns keine Konfidenzintervalle wiedergeben lassen, so dass die Funktion nicht dem Stand der Wissenschaft und deren Ansprüchen genügt.</span>
<span id="cb129-200"><a href="#cb129-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-201"><a href="#cb129-201" aria-hidden="true" tabindex="-1"></a>Im Folgenden wollen wir uns nochmal die Visualisierung mit dem R Paket <span class="in">`{ggpubr}`</span> anschauen. Die <span class="co">[</span><span class="ot">Hilfeseite des R Pakets `{ggpubr}`</span><span class="co">](https://rpkgs.datanovia.com/ggpubr/index.html)</span> liefert noch eine Menge weitere Beispiele für den simplen Fall eines Modells $y ~ x$, also von einem $y$ und einem Faktor $x$. Um die @fig-ggpubr-1 zu erstellen müssen wir als erstes die Funktion <span class="in">`compare_mean()`</span> nutzen um mit der <span class="in">`formula`</span> Syntax einen t-Test zu rechnen. wir adjustieren die p-Werte nach Bonferroni. Anschließend erstellen wir einen Boxplot mit der Funktion <span class="in">`ggboxplot()`</span> und speichern die Ausgabe in dem Objekt <span class="in">`p`</span>. Wie in <span class="in">`ggplot`</span> üblich können wir jetzt auf das Layer <span class="in">`p`</span> über das <span class="in">`+`</span>-Zeichen noch weitere Layer ergänzen. Wir nutzen die Funktion <span class="in">`stat_pvalue_manual()`</span> um die asjustierten p-Werte aus dem Objekt <span class="in">`stat_test_obj`</span> zu ergänzen. Abschließend wollen wir noch den p-Wert einer einfaktoriellen ANOVA als globalen Test ergänzen.</span>
<span id="cb129-202"><a href="#cb129-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-205"><a href="#cb129-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-206"><a href="#cb129-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-207"><a href="#cb129-207" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-208"><a href="#cb129-208" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb129-209"><a href="#cb129-209" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb129-210"><a href="#cb129-210" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb129-211"><a href="#cb129-211" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb129-212"><a href="#cb129-212" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Boxplot der Sprungweiten [cm] von Hunden und Katzen ergänzt um den paarweisen Vergleich mit dem t-Test und den Bonferroni adjustierten p-Werten.</span></span>
<span id="cb129-213"><a href="#cb129-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggpubr-1</span></span>
<span id="cb129-214"><a href="#cb129-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-215"><a href="#cb129-215" aria-hidden="true" tabindex="-1"></a>stat_test_obj <span class="ot">&lt;-</span> <span class="fu">compare_means</span>(</span>
<span id="cb129-216"><a href="#cb129-216" aria-hidden="true" tabindex="-1"></a> jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl,</span>
<span id="cb129-217"><a href="#cb129-217" aria-hidden="true" tabindex="-1"></a> <span class="at">method =</span> <span class="st">"t.test"</span>,</span>
<span id="cb129-218"><a href="#cb129-218" aria-hidden="true" tabindex="-1"></a> <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb129-219"><a href="#cb129-219" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb129-220"><a href="#cb129-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-221"><a href="#cb129-221" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(<span class="at">data =</span> fac1_tbl, <span class="at">x =</span> <span class="st">"animal"</span>, <span class="at">y =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb129-222"><a href="#cb129-222" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"animal"</span>, <span class="at">palette =</span><span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb129-223"><a href="#cb129-223" aria-hidden="true" tabindex="-1"></a>               <span class="at">add =</span> <span class="st">"jitter"</span>, <span class="at">shape =</span> <span class="st">"animal"</span>)</span>
<span id="cb129-224"><a href="#cb129-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-225"><a href="#cb129-225" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_pvalue_manual</span>(stat_test_obj, <span class="at">label =</span> <span class="st">"p.adj"</span>, <span class="at">y.position =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">19</span>)) <span class="sc">+</span></span>
<span id="cb129-226"><a href="#cb129-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">label.y =</span> <span class="dv">20</span>, <span class="at">method =</span> <span class="st">"anova"</span>)    </span>
<span id="cb129-227"><a href="#cb129-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-228"><a href="#cb129-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-229"><a href="#cb129-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-230"><a href="#cb129-230" aria-hidden="true" tabindex="-1"></a><span class="fu">### Paarweiser Wilcoxon Test</span></span>
<span id="cb129-231"><a href="#cb129-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-232"><a href="#cb129-232" aria-hidden="true" tabindex="-1"></a>Wir nutzen den paarweisen Wilxocon Test,</span>
<span id="cb129-233"><a href="#cb129-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-234"><a href="#cb129-234" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>wenn wir ein *nicht*-normalverteiltes $y$ vorliegen haben, wie <span class="in">`grade`</span>.</span>
<span id="cb129-235"><a href="#cb129-235" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>wenn wir *nur* einen Faktor mit mehr als zwei Leveln vorliegen haben, wie <span class="in">`animal`</span>.</span>
<span id="cb129-236"><a href="#cb129-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-237"><a href="#cb129-237" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`pairwise.wilcox.test`</span> kann nicht mit Datensätzen arbeiten sondern nur mit Vektoren. Daher können wir der Funktion auch keine <span class="in">`formula`</span> übergeben sondern müssen die Vektoren aus dem Datensatz mit <span class="in">`fac1_tbl$jump_length`</span> für das Outcome und mit <span class="in">`fac1_tbl$animal`</span> für die Gruppierende Variable benennen. Das ist umständlich und daher auch fehleranfällig.</span>
<span id="cb129-238"><a href="#cb129-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-239"><a href="#cb129-239" aria-hidden="true" tabindex="-1"></a>Als Adjustierungsmethode für den $\alpha$ Fehler wählen wir die Bonferroni-Methode mit <span class="in">`p.adjust.method = "bonferroni"`</span> aus. Da wir eine etwas unübersichtliche Ausgabe in R erhalten nutzen wir die Funktion <span class="in">`tidy()`</span>um die Ausgabe in ein sauberes <span class="in">`tibble`</span> zu verwandeln. Abschließend runden wir noch alle numerischen Spalten mit der Funktion <span class="in">`round`</span> auf drei Stellen hinter dem Komma.</span>
<span id="cb129-240"><a href="#cb129-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-243"><a href="#cb129-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-244"><a href="#cb129-244" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-245"><a href="#cb129-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-246"><a href="#cb129-246" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.wilcox.test</span>(fac1_tbl<span class="sc">$</span>grade, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb129-247"><a href="#cb129-247" aria-hidden="true" tabindex="-1"></a>                     <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-248"><a href="#cb129-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-249"><a href="#cb129-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb129-250"><a href="#cb129-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-251"><a href="#cb129-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-252"><a href="#cb129-252" aria-hidden="true" tabindex="-1"></a>Wir erhalten in einem Tibble die adujstierten p-Werte nach Bonferroni. Wir können daher die adjustierten p-Werte ganz normal mit dem Signifikanzniveau $\alpha$ von 5% vergleichen. Wir sehen, dass der Gruppenvergleich <span class="in">`cat - dog`</span> knapp signifikant ist, der Gruppenvergleich <span class="in">`fox - dog`</span> ebenfalls signifikant ist und der Gruppenvergleich <span class="in">`fox - cat`</span> auch signifikant ist. Leider können wir uns keine Konfidenzintervalle wiedergeben lassen, so dass die Funktion nicht dem Stand der Wissenschaft und deren Ansprüchen genügt.</span>
<span id="cb129-253"><a href="#cb129-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-254"><a href="#cb129-254" aria-hidden="true" tabindex="-1"></a>Im Folgenden wollen wir uns nochmal die Visualisierung mit dem R Paket <span class="in">`{ggpubr}`</span> anschauen. Die <span class="co">[</span><span class="ot">Hilfeseite des R Pakets `{ggpubr}`</span><span class="co">](https://rpkgs.datanovia.com/ggpubr/index.html)</span> liefert noch eine Menge weitere Beispiele für den simplen Fall eines Modells $y ~ x$, also von einem $y$ und einem Faktor $x$. Um die @fig-ggpubr-2 zu erstellen müssen wir als erstes die Funktion <span class="in">`compare_mean()`</span> nutzen um mit der <span class="in">`formula`</span> Syntax einen Wilcoxon Test zu rechnen. wir adjustieren die p-Werte nach Bonferroni. Anschließend erstellen wir einen Boxplot mit der Funktion <span class="in">`ggboxplot()`</span> und speichern die Ausgabe in dem Objekt <span class="in">`p`</span>. Wie in <span class="in">`ggplot`</span> üblich können wir jetzt auf das Layer <span class="in">`p`</span> über das <span class="in">`+`</span>-Zeichen noch weitere Layer ergänzen. Wir nutzen die Funktion <span class="in">`stat_pvalue_manual()`</span> um die asjustierten p-Werte aus dem Objekt <span class="in">`stat_test_obj`</span> zu ergänzen. Abschließend wollen wir noch den p-Wert eines Kruskal Wallis als globalen Test ergänzen.</span>
<span id="cb129-255"><a href="#cb129-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-258"><a href="#cb129-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-259"><a href="#cb129-259" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-260"><a href="#cb129-260" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-261"><a href="#cb129-261" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb129-262"><a href="#cb129-262" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb129-263"><a href="#cb129-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb129-264"><a href="#cb129-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb129-265"><a href="#cb129-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Boxplot der Sprungweiten [cm] von Hunden und Katzen ergänzt um den paarweisen Vergleich mit dem Wilcoxon Test und den Bonferroni adjustierten p-Werten.</span></span>
<span id="cb129-266"><a href="#cb129-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggpubr-2</span></span>
<span id="cb129-267"><a href="#cb129-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-268"><a href="#cb129-268" aria-hidden="true" tabindex="-1"></a>stat_test_obj <span class="ot">&lt;-</span> <span class="fu">compare_means</span>(</span>
<span id="cb129-269"><a href="#cb129-269" aria-hidden="true" tabindex="-1"></a> grade <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl,</span>
<span id="cb129-270"><a href="#cb129-270" aria-hidden="true" tabindex="-1"></a> <span class="at">method =</span> <span class="st">"wilcox.test"</span>,</span>
<span id="cb129-271"><a href="#cb129-271" aria-hidden="true" tabindex="-1"></a> <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb129-272"><a href="#cb129-272" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb129-273"><a href="#cb129-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-274"><a href="#cb129-274" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(<span class="at">data =</span> fac1_tbl, <span class="at">x =</span> <span class="st">"animal"</span>, <span class="at">y =</span> <span class="st">"grade"</span>,</span>
<span id="cb129-275"><a href="#cb129-275" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"animal"</span>, <span class="at">palette =</span><span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb129-276"><a href="#cb129-276" aria-hidden="true" tabindex="-1"></a>               <span class="at">add =</span> <span class="st">"jitter"</span>, <span class="at">shape =</span> <span class="st">"animal"</span>)</span>
<span id="cb129-277"><a href="#cb129-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-278"><a href="#cb129-278" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_pvalue_manual</span>(stat_test_obj, <span class="at">label =</span> <span class="st">"p.adj"</span>, <span class="at">y.position =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">13</span>, <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb129-279"><a href="#cb129-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">label.y =</span> <span class="dv">20</span>, <span class="at">method =</span> <span class="st">"kruskal.test"</span>)    </span>
<span id="cb129-280"><a href="#cb129-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-281"><a href="#cb129-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-282"><a href="#cb129-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-283"><a href="#cb129-283" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gruppenvergleich mit `{emmeans}` {#sec-posthoc-emmeans}</span></span>
<span id="cb129-284"><a href="#cb129-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-285"><a href="#cb129-285" aria-hidden="true" tabindex="-1"></a>Im Folgenden wollen wir uns mit einem anderen R Paket beschäftigen was auch multiple Vergleiche rechnen kann. In diesem Kapitel nutzen wir das R Paket <span class="in">`{emmeans}`</span>. Im Prinzip kann <span class="in">`{emmeans}`</span> das Gleiche wir das R Paket <span class="in">`{multcomp}`</span>. Beide Pakete rechnen dir einen multiplen Vergleich. Das Paket <span class="in">`{emmeans}`</span> kann noch mit *nested comparisons* umgehen. Deshalb hier nochmal die Vorstellung von <span class="in">`{emmeans}`</span>. Du kannst aber für eine simple Auswertung mit nur einem Faktor beide Pakete verwenden.</span>
<span id="cb129-286"><a href="#cb129-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-287"><a href="#cb129-287" aria-hidden="true" tabindex="-1"></a>Wir können hier nicht alles erklären und im Detail durchgehen. Hier gibt es noch ein aufwendiges Tutorium zu <span class="in">`emmeans`</span>: <span class="co">[</span><span class="ot">Getting started with emmeans</span><span class="co">](https://aosmith.rbind.io/2019/03/25/getting-started-with-emmeans/)</span>. Daneben gibt es auch noch die <span class="co">[</span><span class="ot">Einführung mit Theorie auf der Seite des R Paktes</span><span class="co">](https://cran.r-project.org/web/packages/emmeans/vignettes/basics.html#contents)</span> Es gibt hier auch ein weiteres englischsprachiges Tutorium <span class="co">[</span><span class="ot">Don't Ignore Interactions - Unleash the Full Power of Models with {emmeans} R-package</span><span class="co">](https://yuzar-blog.netlify.app/posts/2022-12-29-emmeans2interactions/)</span> oder <span class="co">[</span><span class="ot">{emmeans} Game-Changing R-package Squeezes Hidden Knowledge out of Models!</span><span class="co">](https://yuzar-blog.netlify.app/posts/2022-11-29-emmeans/)</span>. **DISCLAIMER:** Der Text ist gut, die Bebilderung des entsprechenden Videos geht so leider mal gar nicht...</span>
<span id="cb129-288"><a href="#cb129-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-289"><a href="#cb129-289" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gruppenvergleiche mit `emmeans` in R</span></span>
<span id="cb129-290"><a href="#cb129-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-291"><a href="#cb129-291" aria-hidden="true" tabindex="-1"></a>Um den multiplen Vergleich in <span class="in">`emmeans`</span> durchführen zu können brauchen wir zuerst ein lineares Modell, was uns die notwenidgen Parameter wie Mittelwerte und Standardabweichungen liefert. Wir nutzen in unserem simplen Beispiel ein lineares Modell mit einer Einflussvariable $x$ und nehmen an, dass unser Outcome $y$ normalverteilt ist. Achtung, hier muss natürlich das $x$ ein Faktor sein. Dann können wir ganz einfach die Funktion <span class="in">`lm()`</span> nutzen. Im Folgenden fitten wir das Modell <span class="in">`fit_2`</span> was wir dann auch weiter nutzen werden.</span>
<span id="cb129-292"><a href="#cb129-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-295"><a href="#cb129-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-296"><a href="#cb129-296" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb129-297"><a href="#cb129-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-298"><a href="#cb129-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-299"><a href="#cb129-299" aria-hidden="true" tabindex="-1"></a>Der multiple Vergleich in <span class="in">`emmeans`</span> ist mehrschrittig. Wir pipen unser Modell aus <span class="in">`fit_2`</span> in die Funktion <span class="in">`emmeans()`</span>. Wir geben mit <span class="in">`~ animal`</span> an, dass wir über die Level des Faktors <span class="in">`animal`</span> einen Vergleich rechnen wollen. Wir adjustieren die $p$-Werte nach Bonferroni. Danach pipen wir weiter in die Funktion <span class="in">`contrast()`</span> wo der eigentliche Vergleich festgelegt wird. In unserem Fall wollen wir einen *many-to-one* Vergleich rechnen. Alle Gruppen zu der Gruppe <span class="in">`fox`</span>. Du kannst mit <span class="in">`ref =`</span> auch ein anderes Level deines Faktors wählen.</span>
<span id="cb129-300"><a href="#cb129-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-303"><a href="#cb129-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-304"><a href="#cb129-304" aria-hidden="true" tabindex="-1"></a>comp_2_obj <span class="ot">&lt;-</span> fit_2 <span class="sc">|&gt;</span> </span>
<span id="cb129-305"><a href="#cb129-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb129-306"><a href="#cb129-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"trt.vs.ctrl"</span>, <span class="at">ref =</span> <span class="st">"fox"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) </span>
<span id="cb129-307"><a href="#cb129-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-308"><a href="#cb129-308" aria-hidden="true" tabindex="-1"></a>comp_2_obj</span>
<span id="cb129-309"><a href="#cb129-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-310"><a href="#cb129-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-311"><a href="#cb129-311" aria-hidden="true" tabindex="-1"></a>Wir können auch einen anderen Kontrast wählen. Wir überschreiben jetzt das Objekt <span class="in">`comp_2_obj`</span> mit dem Kontrast *all-pair*, der alle möglichen Vergleiche rechnet. In `emmeans` heißt der *all-pair* Kontrast *pairwise*. Die Ausgabe von <span class="in">`emmeans`</span> können über die Funktion <span class="in">`tidy()`</span> aufgeräumt werden. Mehr dazu unter der <span class="co">[</span><span class="ot">Hilfeseite von `tidy`() zu emmeans</span><span class="co">](https://broom.tidymodels.org/reference/tidy.emmGrid.html)</span>.</span>
<span id="cb129-312"><a href="#cb129-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-315"><a href="#cb129-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-316"><a href="#cb129-316" aria-hidden="true" tabindex="-1"></a>comp_2_obj <span class="ot">&lt;-</span> fit_2 <span class="sc">|&gt;</span> </span>
<span id="cb129-317"><a href="#cb129-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb129-318"><a href="#cb129-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) </span>
<span id="cb129-319"><a href="#cb129-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-320"><a href="#cb129-320" aria-hidden="true" tabindex="-1"></a>comp_2_obj</span>
<span id="cb129-321"><a href="#cb129-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-322"><a href="#cb129-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-323"><a href="#cb129-323" aria-hidden="true" tabindex="-1"></a>Wir können das Ergebnis auch noch mit der Funktion <span class="in">`tidy()`</span> weiter aufräumen und dann die Spalten selektieren, die wir brauchen. Häufig benötigen wir nicht alle Spalten, die eine Funktion wiedergibt.</span>
<span id="cb129-324"><a href="#cb129-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-327"><a href="#cb129-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-328"><a href="#cb129-328" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-329"><a href="#cb129-329" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-330"><a href="#cb129-330" aria-hidden="true" tabindex="-1"></a>res_2_obj <span class="ot">&lt;-</span> comp_2_obj <span class="sc">|&gt;</span> </span>
<span id="cb129-331"><a href="#cb129-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-332"><a href="#cb129-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, adj.p.value, conf.low, conf.high) <span class="sc">|&gt;</span> </span>
<span id="cb129-333"><a href="#cb129-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">4</span>))</span>
<span id="cb129-334"><a href="#cb129-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-335"><a href="#cb129-335" aria-hidden="true" tabindex="-1"></a>res_2_obj</span>
<span id="cb129-336"><a href="#cb129-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-337"><a href="#cb129-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-338"><a href="#cb129-338" aria-hidden="true" tabindex="-1"></a>Abschließend wollen wir noch die 95% Konfidenzintervalle in @fig-emmeans-1 abbilden. Hier ist es bei <span class="in">`emmeans`</span> genauso wie bei <span class="in">`multcomp`</span>. Wir können das Objekt <span class="in">`res_2_obj`</span> direkt in <span class="in">`ggplot()`</span> weiterverwenden und uns die 95% Konfidenzintervalle einmal plotten.</span>
<span id="cb129-339"><a href="#cb129-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-342"><a href="#cb129-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-343"><a href="#cb129-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-344"><a href="#cb129-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-345"><a href="#cb129-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb129-346"><a href="#cb129-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb129-347"><a href="#cb129-347" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb129-348"><a href="#cb129-348" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb129-349"><a href="#cb129-349" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Die 95% Konfidenzintervalle für den *allpair*-Vergleich des simplen Datensatzes.</span></span>
<span id="cb129-350"><a href="#cb129-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-1</span></span>
<span id="cb129-351"><a href="#cb129-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-352"><a href="#cb129-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(res_2_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high)) <span class="sc">+</span></span>
<span id="cb129-353"><a href="#cb129-353" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb129-354"><a href="#cb129-354" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb129-355"><a href="#cb129-355" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb129-356"><a href="#cb129-356" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb129-357"><a href="#cb129-357" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb129-358"><a href="#cb129-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-359"><a href="#cb129-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-360"><a href="#cb129-360" aria-hidden="true" tabindex="-1"></a>In @fig-emmeans-3 sehen wir die Ergebnisse des multiplen Vergleiches nochmal anders als *Pairwise P-value plot* dargestellt. Wir haben auf der y-Achse zu Abwechselung mal die Gruppen dargestellt und auf der x-Achse die $p$-Werte. In den Kästchen sind die Effekte der Gruppen nochmal gezeigt. In unserem Fall die Mittelwerte der Sprungweiten für die drei Gruppen. Wir sehen jetzt immer den $p$-Wert für den jeweiligen Vergleich durch eine farbige Linie miteinander verbunden. So können wir nochmal eine andere Übersicht über das Ergebnis des multiplen Vergleich kriegen.</span>
<span id="cb129-361"><a href="#cb129-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-364"><a href="#cb129-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-365"><a href="#cb129-365" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-366"><a href="#cb129-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-367"><a href="#cb129-367" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb129-368"><a href="#cb129-368" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb129-369"><a href="#cb129-369" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb129-370"><a href="#cb129-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb129-371"><a href="#cb129-371" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der Ergebnisse im Pairwise P-value plot."</span></span>
<span id="cb129-372"><a href="#cb129-372" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-3</span></span>
<span id="cb129-373"><a href="#cb129-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-374"><a href="#cb129-374" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="sc">|&gt;</span> </span>
<span id="cb129-375"><a href="#cb129-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb129-376"><a href="#cb129-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpp</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="sc">+</span></span>
<span id="cb129-377"><a href="#cb129-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb129-378"><a href="#cb129-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-379"><a href="#cb129-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-380"><a href="#cb129-380" aria-hidden="true" tabindex="-1"></a>Auch haben wir die Möglichkeit un die $p$-Werte mit der Funktion <span class="in">`pwpm()`</span> als eine Matrix ausgeben zu lassen. Wir erhalten in dem oberen Triangel die $p$-Wert für den jeweiligen Vergleich. In dem unteren Triangel die geschätzten Mittelwertsunterschiede. Auf der Diagonalen dann die geschätzten Mittelwerte für die jeweilige Gruppe. So haben wir nochmal alles sehr kompakt zusammen dargestellt.</span>
<span id="cb129-381"><a href="#cb129-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-384"><a href="#cb129-384" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-385"><a href="#cb129-385" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="sc">|&gt;</span> </span>
<span id="cb129-386"><a href="#cb129-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb129-387"><a href="#cb129-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwpm</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb129-388"><a href="#cb129-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-389"><a href="#cb129-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-390"><a href="#cb129-390" aria-hidden="true" tabindex="-1"></a>Wir wollen uns noch einen etwas komplizierteren Fall anschauen, indem sich <span class="in">`emmeans`</span> von <span class="in">`multcomp`</span> in der Anwendung unterscheidet. Wir laden den Datensatz <span class="in">`flea_dog_cat_fox_site.csv`</span> in dem wir *zwei* Faktoren haben. Damit können wir dann ein Modell mit einem Interaktionsterm bauen. Wir erinnern uns, dass wir in der zweifaktoriellen ANOAV eine signifikante Interaktion zwischen den beiden Faktoren <span class="in">`animal`</span> und <span class="in">`site`</span> festgestelt hatten.</span>
<span id="cb129-391"><a href="#cb129-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-394"><a href="#cb129-394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-395"><a href="#cb129-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-396"><a href="#cb129-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-397"><a href="#cb129-397" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/flea_dog_cat_fox_site.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-398"><a href="#cb129-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, site, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb129-399"><a href="#cb129-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb129-400"><a href="#cb129-400" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">as_factor</span>(site))</span>
<span id="cb129-401"><a href="#cb129-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-402"><a href="#cb129-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-403"><a href="#cb129-403" aria-hidden="true" tabindex="-1"></a>Wir erhalten das Objekt <span class="in">`fac2_tbl`</span> mit dem Datensatz in @tbl-data-emmeans-1 nochmal dargestellt.</span>
<span id="cb129-404"><a href="#cb129-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-407"><a href="#cb129-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-408"><a href="#cb129-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-409"><a href="#cb129-409" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-410"><a href="#cb129-410" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Selektierter Datensatz mit einer normalverteilten Variable `jump_length` und einem Faktor `animal` mit drei Leveln  sowie dem Faktor `site` mit vier Leveln.</span></span>
<span id="cb129-411"><a href="#cb129-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-data-emmeans-1</span></span>
<span id="cb129-412"><a href="#cb129-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-413"><a href="#cb129-413" aria-hidden="true" tabindex="-1"></a>fac2_raw_tbl <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb129-414"><a href="#cb129-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as.character</span>(animal),</span>
<span id="cb129-415"><a href="#cb129-415" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> <span class="fu">as.character</span>(site))</span>
<span id="cb129-416"><a href="#cb129-416" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fac2_raw_tbl),</span>
<span id="cb129-417"><a href="#cb129-417" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fac2_raw_tbl)),</span>
<span id="cb129-418"><a href="#cb129-418" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fac2_raw_tbl)) <span class="sc">|&gt;</span> </span>
<span id="cb129-419"><a href="#cb129-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb129-420"><a href="#cb129-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-421"><a href="#cb129-421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-422"><a href="#cb129-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-423"><a href="#cb129-423" aria-hidden="true" tabindex="-1"></a>In @fig-boxplot-emmeans-1 sehen wir nochmal die Daten visualisiert. Wichtig ist hier, dass wir *zwei* Faktoren vorliegen haben. Den Faktor <span class="in">`animal`</span> und den Faktor <span class="in">`site`</span>. Dabei ist der Faktor <span class="in">`animal`</span> in dem Faktor <span class="in">`site`</span> genested. Wir messen jedes Level des Faktors <span class="in">`animal`</span> jeweils in jedem Level des Faktors <span class="in">`site`</span>.</span>
<span id="cb129-424"><a href="#cb129-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-427"><a href="#cb129-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-428"><a href="#cb129-428" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-429"><a href="#cb129-429" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-430"><a href="#cb129-430" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb129-431"><a href="#cb129-431" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb129-432"><a href="#cb129-432" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb129-433"><a href="#cb129-433" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Boxplot der Sprungweiten [cm] von Hunden und Katzen gemessen an verschiedenen Orten.</span></span>
<span id="cb129-434"><a href="#cb129-434" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplot-emmeans-1</span></span>
<span id="cb129-435"><a href="#cb129-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-436"><a href="#cb129-436" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fac2_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, </span>
<span id="cb129-437"><a href="#cb129-437" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> site)) <span class="sc">+</span></span>
<span id="cb129-438"><a href="#cb129-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb129-439"><a href="#cb129-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb129-440"><a href="#cb129-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite [cm]"</span>) <span class="sc">+</span></span>
<span id="cb129-441"><a href="#cb129-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="cb129-442"><a href="#cb129-442" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-443"><a href="#cb129-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-444"><a href="#cb129-444" aria-hidden="true" tabindex="-1"></a>Wir rechnen ein multiples lineares Modell mit einem Interaktionsterm. Daher packen wir beide Faktoren in das Modell sowie die Intraktion zwischen den beiden Faktoren. Wir erhalten nach dem fitten des Modells das Objekt <span class="in">`fit_3`</span>.</span>
<span id="cb129-445"><a href="#cb129-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-448"><a href="#cb129-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-449"><a href="#cb129-449" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, <span class="at">data =</span> fac2_tbl)</span>
<span id="cb129-450"><a href="#cb129-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-451"><a href="#cb129-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-452"><a href="#cb129-452" aria-hidden="true" tabindex="-1"></a>Der Unterschied zu unserem vorherigen multiplen Vergleich ist nun, dass wir auch einen multiplen Vergleich für *animal nested in site* rechnen können. Dafür müssen wir den Vergleich in der Form `animal | site` schreiben. Wir erhalten dann die Vergleiche der Level des faktors `animal` *getrennt* für die Level es Faktors <span class="in">`site`</span>.</span>
<span id="cb129-453"><a href="#cb129-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-456"><a href="#cb129-456" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-457"><a href="#cb129-457" aria-hidden="true" tabindex="-1"></a>comp_3_obj <span class="ot">&lt;-</span> fit_3 <span class="sc">|&gt;</span> </span>
<span id="cb129-458"><a href="#cb129-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site) <span class="sc">|&gt;</span> </span>
<span id="cb129-459"><a href="#cb129-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) </span>
<span id="cb129-460"><a href="#cb129-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-461"><a href="#cb129-461" aria-hidden="true" tabindex="-1"></a>comp_3_obj</span>
<span id="cb129-462"><a href="#cb129-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-463"><a href="#cb129-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-464"><a href="#cb129-464" aria-hidden="true" tabindex="-1"></a>Wir können uns das Ergebnis auch etwas schöner ausgeben lassen. Wir nutzen hier noch die Funktion <span class="in">`format.pval()`</span> um die $p$-Werte besser zu formatieren. Die $p$-Wert, die kleiner sind als 0.001 werden als <span class="in">`&lt;0.001`</span> ausgegeben und die anderen $p$-Werte auf zwei Nachstellen nach dem Komma gerundet.</span>
<span id="cb129-465"><a href="#cb129-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-468"><a href="#cb129-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-469"><a href="#cb129-469" aria-hidden="true" tabindex="-1"></a>comp_3_obj <span class="sc">|&gt;</span> </span>
<span id="cb129-470"><a href="#cb129-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-471"><a href="#cb129-471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-472"><a href="#cb129-472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, site, p.value) <span class="sc">|&gt;</span> </span>
<span id="cb129-473"><a href="#cb129-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">format.pval</span>(p.value, <span class="at">eps =</span> <span class="fl">0.001</span>, <span class="at">digits =</span> <span class="dv">2</span>))</span>
<span id="cb129-474"><a href="#cb129-474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-475"><a href="#cb129-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-476"><a href="#cb129-476" aria-hidden="true" tabindex="-1"></a>In der Ausgabe können wir erkennen, dass die Vergleich in der Stadt alle signifkant sind. Jedoch erkennen wir keine signifikanten Ergebnisse mehr in dem Dorf und im Feld ist nur der Vergleich <span class="in">`dog - fox`</span> signifkant. Hier solltest du nochmal beachten, warum wir die Analyse getrennt machen. In der zweifaktoriellen ANOVA haben wir gesehen, dass ein signifkanter Interaktionsterm zwischen den beiden Faktoren <span class="in">`animal`</span> und <span class="in">`site`</span> vorliegt. Wir wollen uns noch über die Funktion <span class="in">`confint()`</span> die 95% Konfidenzintervalle wiedergeben lassen.</span>
<span id="cb129-477"><a href="#cb129-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-480"><a href="#cb129-480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-481"><a href="#cb129-481" aria-hidden="true" tabindex="-1"></a>res_3_obj <span class="ot">&lt;-</span> comp_3_obj <span class="sc">|&gt;</span> </span>
<span id="cb129-482"><a href="#cb129-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">confint</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-483"><a href="#cb129-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-484"><a href="#cb129-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, site, estimate, <span class="at">conf.low =</span> lower.CL, <span class="at">conf.high =</span> upper.CL) </span>
<span id="cb129-485"><a href="#cb129-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-486"><a href="#cb129-486" aria-hidden="true" tabindex="-1"></a>res_3_obj</span>
<span id="cb129-487"><a href="#cb129-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-488"><a href="#cb129-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-489"><a href="#cb129-489" aria-hidden="true" tabindex="-1"></a>Besonders mit den 95% Konfiendezintervallen sehen wir nochmal den Interaktionseffekt zwischen den beiden Faktoren <span class="in">`animal`</span> und <span class="in">`site`</span>. So dreht sich der Effekt von zum Beispiel <span class="in">`dog - fox`</span> von $-3.44$ in dem Level <span class="in">`city`</span> zu $+2.35$ in dem Level <span class="in">`field`</span>. Wir haben eine Interaktion vorliegen und deshalb die Analyse getrennt für jeden Level des Faktors <span class="in">`site`</span> durchgeführt. @fig-emmeans-2 zeigt die entsprechenden 95% Konfidenzintervalle. Wir müssen hier etwas mit der <span class="in">`position`</span> spielen, so dass die Punkte und der <span class="in">`geom_errorbar`</span> richtig liegen.</span>
<span id="cb129-490"><a href="#cb129-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-493"><a href="#cb129-493" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-494"><a href="#cb129-494" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-495"><a href="#cb129-495" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-496"><a href="#cb129-496" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb129-497"><a href="#cb129-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb129-498"><a href="#cb129-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb129-499"><a href="#cb129-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb129-500"><a href="#cb129-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Die 95% Konfidenzintervalle für den *allpair*-Vergleich des Models mit Interaktionseffekt.</span></span>
<span id="cb129-501"><a href="#cb129-501" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-emmeans-2</span></span>
<span id="cb129-502"><a href="#cb129-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-503"><a href="#cb129-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(res_3_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high,</span>
<span id="cb129-504"><a href="#cb129-504" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> site, <span class="at">group =</span> site)) <span class="sc">+</span></span>
<span id="cb129-505"><a href="#cb129-505" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb129-506"><a href="#cb129-506" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb129-507"><a href="#cb129-507" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb129-508"><a href="#cb129-508" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb129-509"><a href="#cb129-509" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb129-510"><a href="#cb129-510" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb129-511"><a href="#cb129-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-512"><a href="#cb129-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-513"><a href="#cb129-513" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gruppenvergleich mit `{multcomp}` {#sec-posthoc-multcomp}</span></span>
<span id="cb129-514"><a href="#cb129-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-515"><a href="#cb129-515" aria-hidden="true" tabindex="-1"></a>Wir drehen hier einmal die Erklärung um. Wir machen erst die Anwendung in R und sollte dich dann noch mehr über die statistischen Hintergründe der Funktionen interessieren, folgt ein Abschnitt noch zur Theorie. Du wirst die Funktionen aus <span class="in">`multcomp`</span> vermutlich in deiner Abschlussarbeit brauchen. Häufig werden multiple Gruppenvergleiche in Abschlussarbeiten gerechnet.</span>
<span id="cb129-516"><a href="#cb129-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-517"><a href="#cb129-517" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gruppenvergleiche mit `multcomp` in R</span></span>
<span id="cb129-518"><a href="#cb129-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-519"><a href="#cb129-519" aria-hidden="true" tabindex="-1"></a>Als erstes brauchen wir ein lineares Modell für die Verwendung von <span class="in">`multcomp`</span>. Normalerweise verenden wir das gleiche Modell, was wir schon in der ANOVA verwendet haben. Wir nutzen hier ein simples lineares Modell mit nur einem Faktor. Im Prinzip kann das Modell auch größer sein, davon schauen wir uns dann später im Verlauf des Kapitels noch welche an.</span>
<span id="cb129-520"><a href="#cb129-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-523"><a href="#cb129-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-524"><a href="#cb129-524" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb129-525"><a href="#cb129-525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-526"><a href="#cb129-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-527"><a href="#cb129-527" aria-hidden="true" tabindex="-1"></a>Wir haben das Objekt <span class="in">`fit_1`</span> mit der Funktion <span class="in">`lm()`</span> erstellt. Im Modell sind jetzt alle Mittelwerte und die entsprechenden Varianzen geschätzt worden. Mit <span class="in">`summary(fit_1)`</span> kannst du dir gerne das Modell auch nochmal anschauen. Wenn wir keinen *all-pair* Vergleich rechnen wollen, dann können wir auch einen *many-to-one* Vergleich mit dem <span class="in">`Dunnett`</span> Kontrast rechnen.</span>
<span id="cb129-528"><a href="#cb129-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-529"><a href="#cb129-529" aria-hidden="true" tabindex="-1"></a>Im Anschluss nutzen wir die Funktion <span class="in">`glht()`</span> um den multiplen Vergleich zu rechnen. Als erstes musst du wissen, dass wenn wir *alle* Vergleiche rechnen wollen, wir einen *all-pair* Vergleich rechnen. In der Statistik heißt dieser Typ von Vergleich `Tukey`. Wir wollen jetzt als für den Faktor `animal` einen multiplen `Tukey`-Vergleich rechnen. Nichts anders sagt `mcp(animal = "Tukey")` aus, dabei steht `mcp` für *multiple comparison procedure*. Mit dem hinteren Teil der Funktion weiß jetzt die Funktion <span class="in">`glht()`</span> was gerechnet werden soll. Wir müssen jetzt der Funktion nur noch mitgeben auf was der multiple Vergleich gerechnet werden soll, mit dem Objekt <span class="in">`fit_1`</span>. Wir speichern die Ausgabe der Funktion in <span class="in">`comp_1_obj`</span>.</span>
<span id="cb129-530"><a href="#cb129-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-533"><a href="#cb129-533" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-534"><a href="#cb129-534" aria-hidden="true" tabindex="-1"></a>comp_1_obj <span class="ot">&lt;-</span> <span class="fu">glht</span>(fit_1, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">animal =</span> <span class="st">"Tukey"</span>)) </span>
<span id="cb129-535"><a href="#cb129-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-536"><a href="#cb129-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-537"><a href="#cb129-537" aria-hidden="true" tabindex="-1"></a>Mit dem Objekt <span class="in">`comp_1_fit`</span> können wir noch nicht soviel anfangen. Der Inhalt ist etwas durcheinander und wir wollen noch die Konfidenzintervalle haben. Daher pipen wir <span class="in">`comp_1_fit`</span> erstmal in die Funktion <span class="in">`tidy()`</span> und lassen mit der Option <span class="in">`conf.int = TRUE`</span> die simultanen 95% Konfidenzintervalle berechnen. Dann nutzen wir die Funktion <span class="in">`select()`</span> um die wichtigen Spalten zu selektieren. Abschließend mutieren wir noch alle numerischen Spalten in dem wir auf die dritte Kommastelle runden. Wir speichern alles in das Objekt <span class="in">`res_1_obj`</span>.</span>
<span id="cb129-538"><a href="#cb129-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-541"><a href="#cb129-541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-542"><a href="#cb129-542" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-543"><a href="#cb129-543" aria-hidden="true" tabindex="-1"></a>res_1_obj <span class="ot">&lt;-</span> comp_1_obj <span class="sc">|&gt;</span> </span>
<span id="cb129-544"><a href="#cb129-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-545"><a href="#cb129-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, adj.p.value, </span>
<span id="cb129-546"><a href="#cb129-546" aria-hidden="true" tabindex="-1"></a>         conf.low, conf.high) <span class="sc">|&gt;</span> </span>
<span id="cb129-547"><a href="#cb129-547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, round, <span class="dv">3</span>)</span>
<span id="cb129-548"><a href="#cb129-548" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-549"><a href="#cb129-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-550"><a href="#cb129-550" aria-hidden="true" tabindex="-1"></a>Wir lassen uns dann den Inhalt von dem Objekt <span class="in">`res_1_obj`</span> ausgeben.</span>
<span id="cb129-551"><a href="#cb129-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-554"><a href="#cb129-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-555"><a href="#cb129-555" aria-hidden="true" tabindex="-1"></a>res_1_obj</span>
<span id="cb129-556"><a href="#cb129-556" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-557"><a href="#cb129-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-558"><a href="#cb129-558" aria-hidden="true" tabindex="-1"></a>Wir erhalten ein <span class="in">`tibble()`</span> mit fünf Spalten. Zum einen den <span class="in">`contrast`</span>, der den Vergleich widerspiegelt. Wir vergleichen im ersten Kontrast die Katzen- mit den Hundeflöhen, wobei wir <span class="in">`cat - dog`</span> rechnen. Also wirklich der Mittelwert der Sprungweite der Katzenflöhe *minus* den Mittelwert der Sprungweite der Hundeflöhe rechnen. In der Spalte `estimate` sehen wir den Mittelwertsunterschied. Der Mittelwertsunterschied ist in der *Richtung* nicht ohne den Kontrast zu interpretieren. Danach erhalten wir die adjustierten $p$-Wert sowie die simultanen 95% Konfidenzintervalle.</span>
<span id="cb129-559"><a href="#cb129-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-560"><a href="#cb129-560" aria-hidden="true" tabindex="-1"></a>Wir können die Nullhypothese ablehnen für den Vergleiche<span class="in">`cat - dog`</span> mit einem p-Wert von $0.006$ sowie für den Vergleich $fox - cat$ mit einem p-Wert von $0.001$. Beide p-Werte liegen unter dem Signifikanzniveau von $\alpha$ gleich 5%.</span>
<span id="cb129-561"><a href="#cb129-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-562"><a href="#cb129-562" aria-hidden="true" tabindex="-1"></a>Wenn es die unadjustierten $p$-Werte sein sollen, dann müssen wir nochmal das <span class="in">`glht`</span>-Objekt in die Funktion <span class="in">`summary()`</span> stecken und dann die Option <span class="in">`test = adjusted("none")`</span> wählen. Dann können wir weiter machen wie gewohnt.</span>
<span id="cb129-563"><a href="#cb129-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-566"><a href="#cb129-566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-567"><a href="#cb129-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-568"><a href="#cb129-568" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-569"><a href="#cb129-569" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(comp_1_obj, <span class="at">test =</span> <span class="fu">adjusted</span>(<span class="st">"none"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb129-570"><a href="#cb129-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() </span>
<span id="cb129-571"><a href="#cb129-571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-572"><a href="#cb129-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-573"><a href="#cb129-573" aria-hidden="true" tabindex="-1"></a>In @fig-multcomp-1 sind die simultanen und damit adjustierten 95% Konfidenzintervalle nochmal in einem <span class="in">`ggplot`</span> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab. Mit der Funktion <span class="in">`factor()`</span> kannst du die Sortierung der Level einem Faktor ändern und somit auch Position auf den Achsen.</span>
<span id="cb129-574"><a href="#cb129-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-577"><a href="#cb129-577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-578"><a href="#cb129-578" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-579"><a href="#cb129-579" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-580"><a href="#cb129-580" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb129-581"><a href="#cb129-581" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb129-582"><a href="#cb129-582" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb129-583"><a href="#cb129-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb129-584"><a href="#cb129-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Simultane 95% Konfidenzintervalle für den paarweisen Vergleich der Sprungweiten in [cm] der Hunde-, Katzen- und Fuchsflöhe.</span></span>
<span id="cb129-585"><a href="#cb129-585" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-multcomp-1</span></span>
<span id="cb129-586"><a href="#cb129-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-587"><a href="#cb129-587" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(res_1_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, </span>
<span id="cb129-588"><a href="#cb129-588" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high)) <span class="sc">+</span></span>
<span id="cb129-589"><a href="#cb129-589" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb129-590"><a href="#cb129-590" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb129-591"><a href="#cb129-591" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb129-592"><a href="#cb129-592" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb129-593"><a href="#cb129-593" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb129-594"><a href="#cb129-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-595"><a href="#cb129-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-596"><a href="#cb129-596" aria-hidden="true" tabindex="-1"></a>Die Entscheidung gegen die Nullhypothese anhand der simultanen 95% Konfidenzintervalle ist inhaltlich gleich, wie die Entscheidung anhand der p-Werte. Wir entscheiden gegen die Nullhypothese, wenn die 0 nicht mit im Konfindenzintervall enthalten ist. Wir wählen hier die 0 zur Entscheidung gegen die Nullhypothese, weil wir einen Mittelwertsvergleich rechnen.</span>
<span id="cb129-597"><a href="#cb129-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-598"><a href="#cb129-598" aria-hidden="true" tabindex="-1"></a>Für den Vergleich <span class="in">`fox -dog`</span> ist die 0 im 95% Konfidenzintervall, wir können daher die Nullhypothese nicht ablehnen. Das 95% Konfidenzintervall ist nicht signifikant. Bei dem Vergleich <span class="in">`fox - cat`</span> sowie dem Vergleich <span class="in">`cat - dog`</span> ist jeweils die 0 nicht im 95% Konfidenzintervall enthalten. Beide 95% Konfidenzintervalle sind signifikant, wir können die Nullhypothese ablehnen.</span>
<span id="cb129-599"><a href="#cb129-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-600"><a href="#cb129-600" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gruppenvergleich mit Varianzheterogenität {#sec-posthoc-var-heterogen}</span></span>
<span id="cb129-601"><a href="#cb129-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-602"><a href="#cb129-602" aria-hidden="true" tabindex="-1"></a>Bis jetzt sind wir von Varianzhomogenität über alle Gruppen in unserer Behandlung ausgegangen. Oder aber konkret auf unser Beispiel, die Tierarten haben alle die gleiche Varianz. Jetzt gibt es aber häufiger mal den Fall, da können oder wollen wir nicht an Varianzhomogenität über alle Gruppen glauben. Deshalb gibt es hier noch Alternativen, von denen ich ein paar Vorstellen werde.</span>
<span id="cb129-603"><a href="#cb129-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-604"><a href="#cb129-604" aria-hidden="true" tabindex="-1"></a><span class="fu">### Games-Howell-Test {#sec-posthoc-ght}</span></span>
<span id="cb129-605"><a href="#cb129-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-606"><a href="#cb129-606" aria-hidden="true" tabindex="-1"></a>Der Games-Howell-Test ist eine Alternative zu dem Paket <span class="in">`{multcomp}`</span> und dem Paket <span class="in">`{emmeans}`</span> für ein einfaktorielles Design. Wir nutzen den Games-Howell-Test, wenn die Annahme der Homogenität der Varianzen, der zum Vergleich aller möglichen Kombinationen von Gruppenunterschieden verwendet wird, verletzt ist. Dieser Post-Hoc-Test liefert Konfidenzintervalle für die Unterschiede zwischen den Gruppenmitteln und zeigt, ob die Unterschiede statistisch signifikant sind. Der Test basiert auf der Welch'schen Freiheitsgradkorrektur und adjustiert die $p$-Werte. Der Test vergleicht also die Differenz zwischen den einzelnen Mittelwertpaaren mit einer Adjustierung für den Mehrfachtest. Es besteht also keine Notwendigkeit, zusätzliche p-Wert-Korrekturen vorzunehmen. Mit dem Games-Howell-Test ist nur ein *all-pair* Vergleich möglich.</span>
<span id="cb129-607"><a href="#cb129-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-608"><a href="#cb129-608" aria-hidden="true" tabindex="-1"></a>Für den Games-Howell-Test aus dem Paket <span class="in">`{rstatix}`</span> müssen wir kein lineares Modell fitten. Wir schreiben einfach die wie in einem t-Test das Outcome und den Faktor mit den Gruppenleveln in die Funktion <span class="in">`games_howell_test()`</span>. Wir erhalten dann direkt das Ergebnis des Games-Howell-Test. Wir nutzen in diesem Beispiel die Daten aus dem Objekt <span class="in">`fac1_tbl`</span> zu sehen in @tbl-data-posthoc-1.</span>
<span id="cb129-609"><a href="#cb129-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-612"><a href="#cb129-612" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-613"><a href="#cb129-613" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">games_howell_test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) </span>
<span id="cb129-614"><a href="#cb129-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-615"><a href="#cb129-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-616"><a href="#cb129-616" aria-hidden="true" tabindex="-1"></a>Wir wollen aber nicht mit der Ausgabe arbeiten sondern machen uns noch ein wenig Arbeit und passen die Ausgabe an. Zum einen brauchen wir noch die Kontraste und wir wollen die $p$-Werte auch ansprechend formatieren. Wir erhalten das Objekt <span class="in">`res_4_obj`</span> und geben uns die Ausgabe wieder.</span>
<span id="cb129-617"><a href="#cb129-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-620"><a href="#cb129-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-621"><a href="#cb129-621" aria-hidden="true" tabindex="-1"></a>res_4_obj <span class="ot">&lt;-</span> fit_4 <span class="sc">|&gt;</span> </span>
<span id="cb129-622"><a href="#cb129-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-623"><a href="#cb129-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2)) <span class="sc">|&gt;</span> </span>
<span id="cb129-624"><a href="#cb129-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(contrast, estimate, p.adj, conf.low, conf.high) <span class="sc">|&gt;</span> </span>
<span id="cb129-625"><a href="#cb129-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.adj =</span> <span class="fu">format.pval</span>(p.adj, <span class="at">eps =</span> <span class="fl">0.001</span>, <span class="at">digits =</span> <span class="dv">2</span>))</span>
<span id="cb129-626"><a href="#cb129-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-627"><a href="#cb129-627" aria-hidden="true" tabindex="-1"></a>res_4_obj</span>
<span id="cb129-628"><a href="#cb129-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-629"><a href="#cb129-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-630"><a href="#cb129-630" aria-hidden="true" tabindex="-1"></a>Wir erhalten ein <span class="in">`tibble()`</span> mit fünf Spalten. Zum einen den <span class="in">`contrast`</span>, der den Vergleich widerspiegelt, den haben wir uns selber mit der Funktion <span class="in">`mutate()`</span> und <span class="in">`str_c()`</span> aus den Spalten <span class="in">`group1`</span> und <span class="in">`group2`</span> gebaut. Wir vergleichen im ersten Kontrast die Katzen- mit den Hundeflöhen, wobei wir <span class="in">`dog-cat`</span> rechnen. Also wirklich den Mittelwert der Sprungweite der Hundeflöhe *minus* den Mittelwert der Sprungweite der Katzenflöhe rechnen. In der Spalte `estimate` sehen wir den Mittelwertsunterschied. Der Mittelwertsunterschied ist in der *Richtung* nicht ohne den Kontrast zu interpretieren. Danach erhalten wir die adjustierten $p$-Wert sowie die simultanen 95% Konfidenzintervalle.</span>
<span id="cb129-631"><a href="#cb129-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-632"><a href="#cb129-632" aria-hidden="true" tabindex="-1"></a>Wir können die Nullhypothese ablehnen für den Vergleiche <span class="in">`dog - cat`</span> mit einem p-Wert von $0.02$ sowie für den Vergleich $cat - fox$ mit einem p-Wert von $0.00$. Beide p-Werte liegen unter dem Signifikanzniveau von $\alpha$ gleich 5%.</span>
<span id="cb129-633"><a href="#cb129-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-634"><a href="#cb129-634" aria-hidden="true" tabindex="-1"></a>In @fig-ght-1 sind die simultanen 95% Konfidenzintervalle nochmal in einem <span class="in">`ggplot`</span> visualisiert. Die Kontraste und die Position hängen von dem Faktorlevel ab.</span>
<span id="cb129-635"><a href="#cb129-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-638"><a href="#cb129-638" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-639"><a href="#cb129-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-640"><a href="#cb129-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-641"><a href="#cb129-641" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb129-642"><a href="#cb129-642" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb129-643"><a href="#cb129-643" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb129-644"><a href="#cb129-644" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb129-645"><a href="#cb129-645" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Die 95% Konfidenzintervalle für den *allpair*-Vergleich des Games-Howell-Test.</span></span>
<span id="cb129-646"><a href="#cb129-646" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ght-1</span></span>
<span id="cb129-647"><a href="#cb129-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-648"><a href="#cb129-648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(res_4_obj, <span class="fu">aes</span>(contrast, <span class="at">y=</span>estimate, <span class="at">ymin=</span>conf.low, <span class="at">ymax=</span>conf.high)) <span class="sc">+</span></span>
<span id="cb129-649"><a href="#cb129-649" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"11"</span>, <span class="at">colour=</span><span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb129-650"><a href="#cb129-650" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb129-651"><a href="#cb129-651" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb129-652"><a href="#cb129-652" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb129-653"><a href="#cb129-653" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb129-654"><a href="#cb129-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-655"><a href="#cb129-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-656"><a href="#cb129-656" aria-hidden="true" tabindex="-1"></a>Die Entscheidungen nach den 95% Konfidenzintervallen sind die gleichen wie nach dem $p$-Wert. Da wir hier es mit einem Mittelwertsvergleich zu tun haben, ist die Entscheidung gegen die Nullhypothese zu treffen wenn die 0 im Konfidenzintervall ist.</span>
<span id="cb129-657"><a href="#cb129-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-658"><a href="#cb129-658" aria-hidden="true" tabindex="-1"></a><span class="fu">### Generalized Least Squares</span></span>
<span id="cb129-659"><a href="#cb129-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-660"><a href="#cb129-660" aria-hidden="true" tabindex="-1"></a>Neben dem Games-Howell-Test gibt es auch die Möglichkeit *Generalized Least Squares* zu nutzen. Hier haben wir dann auch die Möglichkeit mehrfaktorielle Modelle zu schätzen und dann auch wieder <span class="in">`emmeans`</span> zu nutzen. Das ist natürlich super, weil wir dann wieder in dem <span class="in">`emmeans`</span> Framework sind und alle Funktionen von oben nutzen können. Deshalb hier auch nur die Modellanpassung, den Rest kopierst du dir dann von oben dazu.</span>
<span id="cb129-661"><a href="#cb129-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-662"><a href="#cb129-662" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`gls()`</span> aus dem R Paket <span class="in">`{nlme}`</span> passt ein lineares Modell unter Verwendung der verallgemeinerten kleinsten Quadrate an. Die Fehler dürfen dabei aber korreliert oder aber ungleiche Varianzen haben. Damit haben wir ein Modell, was wir nutzen können, wenn wir Varianzheterogenität vorliegen haben. Hier einmal das simple Beispiel für die Tierarten. Wir nehmen wieder die ganz normale Formelschreiweise. Wir können jetzt aber über die Option <span class="in">`weights =`</span> angeben, wie wir die Varianz modellieren wollen. Die Schreibweise mag etwas ungewohnt sein, aber es gibt wirklich viele Arten die Varainz zu modellieren. Hier machen wir uns es einfach und nutzen die Helferfunktion <span class="in">`varIdent`</span> und modellieren dann für jedes Tier eine eigene Gruppenvarianz.</span>
<span id="cb129-663"><a href="#cb129-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-666"><a href="#cb129-666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-667"><a href="#cb129-667" aria-hidden="true" tabindex="-1"></a>gls_fac1_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal, </span>
<span id="cb129-668"><a href="#cb129-668" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal), </span>
<span id="cb129-669"><a href="#cb129-669" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac1_tbl)</span>
<span id="cb129-670"><a href="#cb129-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-671"><a href="#cb129-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-672"><a href="#cb129-672" aria-hidden="true" tabindex="-1"></a>Dann können wir die Modellanpasssung auch schon in <span class="in">`emmeans()`</span> weiterleiten und schauen uns mal das Ergebnis gleich an. Wir achten jetzt auf die Spalte <span class="in">`SE`</span>, die uns ja den Fehler der Mittelwerte für jede Gruppe wiedergibt.</span>
<span id="cb129-673"><a href="#cb129-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-676"><a href="#cb129-676" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-677"><a href="#cb129-677" aria-hidden="true" tabindex="-1"></a>gls_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb129-678"><a href="#cb129-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal)</span>
<span id="cb129-679"><a href="#cb129-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-680"><a href="#cb129-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-681"><a href="#cb129-681" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass wir für jedes Tier eine eigene Varianz über den Standardfehler <span class="in">`SE`</span> geschätzt haben. Das war es ja auch was wir wollten. Bis hierhin wäre es auch mit dem Games-Howell-Test gegangen. Was ist aber, wenn wir ein zweifaktorielles design mit Interaktion schätzen wollen? Das können wir analog wie eben machen. Wir erweitern einfach das Modell um die Terme <span class="in">`site`</span> für den zweiten Faktor und den Interaktionsterm <span class="in">`animal:site`</span>.</span>
<span id="cb129-682"><a href="#cb129-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-685"><a href="#cb129-685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-686"><a href="#cb129-686" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, </span>
<span id="cb129-687"><a href="#cb129-687" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal), </span>
<span id="cb129-688"><a href="#cb129-688" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac2_tbl)</span>
<span id="cb129-689"><a href="#cb129-689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-690"><a href="#cb129-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-691"><a href="#cb129-691" aria-hidden="true" tabindex="-1"></a>Dann können wir uns wieder die multiplen Vergleiche getrennt für die Interaktionsterme wiedergeben lassen. Blöderweise haben jetzt alle Messorte <span class="in">`site`</span> die gleiche Varianz für jede Tierart, aber auch da können wir noch ran.</span>
<span id="cb129-692"><a href="#cb129-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-695"><a href="#cb129-695" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-696"><a href="#cb129-696" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb129-697"><a href="#cb129-697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site)</span>
<span id="cb129-698"><a href="#cb129-698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-699"><a href="#cb129-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-700"><a href="#cb129-700" aria-hidden="true" tabindex="-1"></a>Die eigentliche Stärke von <span class="in">`gls()`</span> kommt eigentlich erst zu tragen, wenn wir auch noch erlauben, dass wir die Varianz *über alle* Tierarten, Messsorte und Interaktionen variieren kann. Das machen wir, in dem wir einfach `animal*site<span class="in">` zu der `</span>varIdent()` Funktion ergänzen.</span>
<span id="cb129-701"><a href="#cb129-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-704"><a href="#cb129-704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-705"><a href="#cb129-705" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="ot">&lt;-</span> <span class="fu">gls</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> site <span class="sc">+</span> animal<span class="sc">:</span>site, </span>
<span id="cb129-706"><a href="#cb129-706" aria-hidden="true" tabindex="-1"></a>                    <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span>  <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> animal<span class="sc">*</span>site), </span>
<span id="cb129-707"><a href="#cb129-707" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> fac2_tbl)</span>
<span id="cb129-708"><a href="#cb129-708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-709"><a href="#cb129-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-710"><a href="#cb129-710" aria-hidden="true" tabindex="-1"></a>Dann noch schnell in <span class="in">`emmeans()`</span> gesteckt und sich das Ergebnis angeschaut.</span>
<span id="cb129-711"><a href="#cb129-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-714"><a href="#cb129-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-715"><a href="#cb129-715" aria-hidden="true" tabindex="-1"></a>gls_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb129-716"><a href="#cb129-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal <span class="sc">|</span> site)</span>
<span id="cb129-717"><a href="#cb129-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-718"><a href="#cb129-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-719"><a href="#cb129-719" aria-hidden="true" tabindex="-1"></a>Wie du jetzt siehst schätzen wir die Varianz für jede Tierart und jeden Messort separat. Wir haben also wirklich jede Varianz einzeln zugeordnet. Die Frage ist immer, ob das notwendig ist, denn wir brauchen auch eine gewisse Fallzahl, damit die Modelle funktionieren. Aber das kommt jetzt sehr auf deine Fragestellung an und müssten wir nochmal konkret besprechen.</span>
<span id="cb129-720"><a href="#cb129-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-721"><a href="#cb129-721" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb129-722"><a href="#cb129-722" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Literatur</span></span>
<span id="cb129-723"><a href="#cb129-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-724"><a href="#cb129-724" aria-hidden="true" tabindex="-1"></a>Auf der Seite DSFAIR gibt es noch einen Artikel zu <span class="in">`emmeans`</span> und der Frage <span class="co">[</span><span class="ot">Why are the StdErr all the same?</span><span class="co">](https://schmidtpaul.github.io/dsfair_quarto/ch/summaryarticles/whyseequal.html)</span> und dazu dann auch passend die Publikation <span class="co">[</span><span class="ot">Analyzing designed experiments: Should we report standard deviations or standard errors of the mean or standard errors of the difference or what?</span><span class="co">](https://www.cambridge.org/core/services/aop-cambridge-core/content/view/92DB0AF151C157B9C6E2FA40F9C9B635/S0014479719000401a.pdf/analyzing-designed-experiments-should-we-report-standard-deviations-or-standard-errors-of-the-mean-or-standard-errors-of-the-difference-or-what.pdf)</span></span>
<span id="cb129-725"><a href="#cb129-725" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb129-726"><a href="#cb129-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-727"><a href="#cb129-727" aria-hidden="true" tabindex="-1"></a><span class="fu">### Robuste Schätzung von Standardfehlern</span></span>
<span id="cb129-728"><a href="#cb129-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-729"><a href="#cb129-729" aria-hidden="true" tabindex="-1"></a>Wir immer gibt es noch eine Möglichkeit die Varianzheterogenität zu behandeln. Wir nutzen jetzt hier einmal die Funktionen aus dem R Paket <span class="in">`{sandwich}`</span>, die es uns ermöglichen Varianzheterogenität (eng. *heteroskedasticity*) zu modellieren. Es ist eigentlich super einfach, wir müssen als erstes wieder unser Modell anpassen. Hier einmal mit einer simplen linearen Regression.</span>
<span id="cb129-730"><a href="#cb129-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-733"><a href="#cb129-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-734"><a href="#cb129-734" aria-hidden="true" tabindex="-1"></a>lm_fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl)</span>
<span id="cb129-735"><a href="#cb129-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-736"><a href="#cb129-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-737"><a href="#cb129-737" aria-hidden="true" tabindex="-1"></a>Dann können wir auch schon für einen Gruppenvergleich direkt in der Funktion <span class="in">`emmeans()`</span> für die Varianzheterogenität adjustieren. Es gibt verschiedene mögliche Sandwich-Schätzer, aber wir nehmen jetzt mal einen der häufigsten mit <span class="in">`vcovHC`</span>. Wie immer gilt, es gibt ja nach Datenlage bessere und schlechtere Schätzer. Wir laden jetzt nicht das ganze Paket, sondern nur die Funktion mit <span class="in">`sandwich::vcovHAC`</span>. Achtung, hinter der Option <span class="in">`vcov.`</span> ist ein *Punkt*. Ohne den Aufruf <span class="in">`vcov. =`</span> funktioniert die Funktion dann nicht.</span>
<span id="cb129-738"><a href="#cb129-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-741"><a href="#cb129-741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-742"><a href="#cb129-742" aria-hidden="true" tabindex="-1"></a>em_obj <span class="ot">&lt;-</span> lm_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb129-743"><a href="#cb129-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> animal, <span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC)</span>
<span id="cb129-744"><a href="#cb129-744" aria-hidden="true" tabindex="-1"></a>em_obj</span>
<span id="cb129-745"><a href="#cb129-745" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-746"><a href="#cb129-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-747"><a href="#cb129-747" aria-hidden="true" tabindex="-1"></a>Wir du siehst, die Standardfehler sind jetzt nicht mehr über alle Gruppen gleich. Dann können wir uns auch die paarweisen Vergleiche ausgeben lassen.</span>
<span id="cb129-748"><a href="#cb129-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-751"><a href="#cb129-751" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-752"><a href="#cb129-752" aria-hidden="true" tabindex="-1"></a>contr_obj <span class="ot">&lt;-</span> em_obj <span class="sc">|&gt;</span> </span>
<span id="cb129-753"><a href="#cb129-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb129-754"><a href="#cb129-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-755"><a href="#cb129-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-756"><a href="#cb129-756" aria-hidden="true" tabindex="-1"></a>Oder aber wir lassen uns das *compact letter display* wiedergeben.</span>
<span id="cb129-757"><a href="#cb129-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-760"><a href="#cb129-760" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-761"><a href="#cb129-761" aria-hidden="true" tabindex="-1"></a>cld_obj <span class="ot">&lt;-</span> em_obj <span class="sc">|&gt;</span></span>
<span id="cb129-762"><a href="#cb129-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb129-763"><a href="#cb129-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-764"><a href="#cb129-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-765"><a href="#cb129-765" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true"}</span>
<span id="cb129-766"><a href="#cb129-766" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exkurs: Robuste Schätzung von Standardfehlern, Konfidenzintervallen und p-Werten</span></span>
<span id="cb129-767"><a href="#cb129-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-768"><a href="#cb129-768" aria-hidden="true" tabindex="-1"></a>Wenn du noch etwas weiter gehen möchtest, dann kannst du dir noch die Hilfeseite von dem R Paket <span class="in">`{performance}`</span> <span class="co">[</span><span class="ot">Robust Estimation of Standard Errors, Confidence Intervals, and p-values</span><span class="co">](https://easystats.github.io/parameters/articles/model_parameters_robust.html?q=Heteroskedasticity#robust-covariance-matrix-estimation-from-model-parameters)</span> anschauen. Die Idee ist hier, dass wir die Varianz/Kovarianz robuster daher mit der Berücksichtigung von Varianzheterogenität (eng. *heteroskedasticity*) schätzen.</span>
<span id="cb129-769"><a href="#cb129-769" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb129-770"><a href="#cb129-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-771"><a href="#cb129-771" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compact letter display {#sec-compact-letter}</span></span>
<span id="cb129-772"><a href="#cb129-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-773"><a href="#cb129-773" aria-hidden="true" tabindex="-1"></a>In der Pflanzenernährung ist es nicht unüblich sehr viele Substrate miteinander zu vergleichen. Oder andersherum, wenn wir sehr viele Gruppen haben, dann kann die Darstellung in einem *all-pair* Vergleich sehr schnell sehr unübersichltich werden. Deshalb wure das *compact letter display* entwickelt. Das *compact letter display* zeigt an, bei welchen Vergleichen der Behandlungen die Nullhypothese gilt. Daher werden die *nicht* signifikanten Ergebnisse visualisiert. Gut zu lesen ist auch die Vignette <span class="co">[</span><span class="ot">Re-engineering CLDs</span><span class="co">](https://cran.r-project.org/web/packages/emmeans/vignettes/re-engineering-clds.html)</span> der Hilfeseite zu <span class="in">`{emmeans}`</span> sowie die Hilfeseite <span class="co">[</span><span class="ot">Compact Letter Display (CLD) - What is it?</span><span class="co">](https://schmidtpaul.github.io/DSFAIR/compactletterdisplay.html)</span>.</span>
<span id="cb129-774"><a href="#cb129-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-775"><a href="#cb129-775" aria-hidden="true" tabindex="-1"></a>Schauen wir uns aber zuerst einmal ein größeres Beispiel mit neun Behandlungen mit jeweils zwanzig Beobachtungen an. Wir erstellen uns den Datensatz in der Form, dass sich die Mittelwerte für die Behandlungen teilweise unterscheiden.</span>
<span id="cb129-776"><a href="#cb129-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-779"><a href="#cb129-779" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-780"><a href="#cb129-780" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20220914</span>)</span>
<span id="cb129-781"><a href="#cb129-781" aria-hidden="true" tabindex="-1"></a>data_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trt =</span> <span class="fu">gl</span>(<span class="at">n =</span> <span class="dv">9</span>, <span class="at">k =</span> <span class="dv">20</span>, </span>
<span id="cb129-782"><a href="#cb129-782" aria-hidden="true" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"pos_ctrl"</span>, <span class="st">"neg_ctrl"</span>, <span class="st">"treat_A"</span>, <span class="st">"treat_B"</span>, </span>
<span id="cb129-783"><a href="#cb129-783" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"treat_C"</span>, <span class="st">"treat_D"</span>, <span class="st">"treat_E"</span>, <span class="st">"treat_F"</span>, </span>
<span id="cb129-784"><a href="#cb129-784" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"treat_G"</span>)),</span>
<span id="cb129-785"><a href="#cb129-785" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rsp =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">24</span>, <span class="dv">5</span>),</span>
<span id="cb129-786"><a href="#cb129-786" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">35</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">37</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">43</span>, <span class="dv">5</span>),</span>
<span id="cb129-787"><a href="#cb129-787" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">5</span>)))</span>
<span id="cb129-788"><a href="#cb129-788" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-789"><a href="#cb129-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-790"><a href="#cb129-790" aria-hidden="true" tabindex="-1"></a>In der @fig-boxplot-cld-1 ist der Datensatz <span class="in">`data_tbl`</span> nochmal als Boxplot dargestellt.</span>
<span id="cb129-791"><a href="#cb129-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-794"><a href="#cb129-794" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-795"><a href="#cb129-795" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-796"><a href="#cb129-796" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb129-797"><a href="#cb129-797" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb129-798"><a href="#cb129-798" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb129-799"><a href="#cb129-799" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb129-800"><a href="#cb129-800" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Boxplot der Beispieldaten.</span></span>
<span id="cb129-801"><a href="#cb129-801" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplot-cld-1</span></span>
<span id="cb129-802"><a href="#cb129-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-803"><a href="#cb129-803" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> rsp, </span>
<span id="cb129-804"><a href="#cb129-804" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb129-805"><a href="#cb129-805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb129-806"><a href="#cb129-806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb129-807"><a href="#cb129-807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb129-808"><a href="#cb129-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb129-809"><a href="#cb129-809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb129-810"><a href="#cb129-810" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-811"><a href="#cb129-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-812"><a href="#cb129-812" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass sich die positive Kontrolle von dem Rest der Behandlungen unterscheidet. Danach haben wir ein Plateau mit der negativen Kontrolle und der Behanldung A und der Behandlung B. Nach diesem Plateau haben wir einen Sprung und sehen einen leicht linearen Anstieg der Mittelwerte der Behandlungen.</span>
<span id="cb129-813"><a href="#cb129-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-814"><a href="#cb129-814" aria-hidden="true" tabindex="-1"></a>Schauen wir uns zuerst einmal an, wie ein *compact letter display* aussehen würde, wenn kein Effekt vorliegen würde. Daher die Nullhypothese ist wahr und die Mittelwerte der Gruppen unterscheiden sich nicht. Wir nutzen hier einmal ein kleineres Beispiel mit den Behandlungslevels `ctrl`, `treat_A` und `treat_B`. Alle drei Behandlungslevel haben einen Mittelwert von 10. Es gilt die Nullhypothese und wir erhalten folgendes *compact letter display* in @tbl-no-effect-cld.</span>
<span id="cb129-815"><a href="#cb129-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-816"><a href="#cb129-816" aria-hidden="true" tabindex="-1"></a>| Behandlung | Mittelwert | $\phantom{a}$ |               |               |</span>
<span id="cb129-817"><a href="#cb129-817" aria-hidden="true" tabindex="-1"></a>|:----------:|:----------:|:-------------:|:-------------:|:-------------:|</span>
<span id="cb129-818"><a href="#cb129-818" aria-hidden="true" tabindex="-1"></a>|    ctrl    |     10     |       a       | $\phantom{a}$ | $\phantom{a}$ |</span>
<span id="cb129-819"><a href="#cb129-819" aria-hidden="true" tabindex="-1"></a>|  treat_A   |     10     |       a       |               |               |</span>
<span id="cb129-820"><a href="#cb129-820" aria-hidden="true" tabindex="-1"></a>|  treat_B   |     10     |       a       |               |               |</span>
<span id="cb129-821"><a href="#cb129-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-822"><a href="#cb129-822" aria-hidden="true" tabindex="-1"></a>: Das *compact letter display* für drei Behandlungen nach einem paarweisen Vergleich. Die Nullhypothese gilt, es gibt keinen Mittelwertsunterschied. {#tbl-no-effect-cld}</span>
<span id="cb129-823"><a href="#cb129-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-824"><a href="#cb129-824" aria-hidden="true" tabindex="-1"></a>Das Gegenteil sehen wir in der @tbl-effect-cld. Hier haben wir ein *compact letter display* wo sich alle drei Mittelwerte mit 10, 15 und 20 voneinander klar unterscheiden. Die Nullhypothese gilt für keinen der möglichen paarweisen Vergleiche.</span>
<span id="cb129-825"><a href="#cb129-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-826"><a href="#cb129-826" aria-hidden="true" tabindex="-1"></a>| Behandlung | Mittelwert |               |               |               |</span>
<span id="cb129-827"><a href="#cb129-827" aria-hidden="true" tabindex="-1"></a>|:----------:|:----------:|:-------------:|:-------------:|:-------------:|</span>
<span id="cb129-828"><a href="#cb129-828" aria-hidden="true" tabindex="-1"></a>|    ctrl    |     10     |       a       | $\phantom{a}$ | $\phantom{a}$ |</span>
<span id="cb129-829"><a href="#cb129-829" aria-hidden="true" tabindex="-1"></a>|  treat_A   |     15     |               |       b       |               |</span>
<span id="cb129-830"><a href="#cb129-830" aria-hidden="true" tabindex="-1"></a>|  treat_B   |     20     | $\phantom{a}$ |               |       c       |</span>
<span id="cb129-831"><a href="#cb129-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-832"><a href="#cb129-832" aria-hidden="true" tabindex="-1"></a>: Das *compact letter display* für drei Behandlungen nach einem paarweisen Vergleich. Die Nullhypothese gilt nicht, es gibt einen Mittelwertsunterschied. {#tbl-effect-cld}</span>
<span id="cb129-833"><a href="#cb129-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-834"><a href="#cb129-834" aria-hidden="true" tabindex="-1"></a>Schauen wir uns nun die Implementierung des *compact letter display* für die verschiedenen Möglichkeiten der Multiplen Vergleiche einmal an.</span>
<span id="cb129-835"><a href="#cb129-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-836"><a href="#cb129-836" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... für `pairwise.*.test()`</span></span>
<span id="cb129-837"><a href="#cb129-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-838"><a href="#cb129-838" aria-hidden="true" tabindex="-1"></a>Wenn wir für die Funktionen <span class="in">`pairwise.*.test()`</span> das *compact letter display* berechnen wollen, dann müssen wir etwas ausholen. Denn wir müssen dafür die Funktion <span class="in">`multcompLetters()`</span> nutzen. Diese Funktion braucht die $p$-Werte als Matrix und diese Matrix der $p$-Werte kriegen wir über die Funktion <span class="in">`fullPTable()`</span>. Am Ende haben wir aber dann das was wir wollten. Ich habe hier nochmal das einfache Beispiel mit den Sprungweiten von oben genommen.</span>
<span id="cb129-839"><a href="#cb129-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-842"><a href="#cb129-842" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-843"><a href="#cb129-843" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(fac1_tbl<span class="sc">$</span>jump_length, fac1_tbl<span class="sc">$</span>animal,</span>
<span id="cb129-844"><a href="#cb129-844" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-845"><a href="#cb129-845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract2</span>(<span class="st">"p.value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-846"><a href="#cb129-846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fullPTable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-847"><a href="#cb129-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>()</span>
<span id="cb129-848"><a href="#cb129-848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-849"><a href="#cb129-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-850"><a href="#cb129-850" aria-hidden="true" tabindex="-1"></a>Als Ergebnis erhalten wir, dass Hund- und Fuchsflöhe gleich weit springen, beide teilen sich den gleichen Buchstaben. Katzenflöhe springen unterschiedlich zu Hunden- und Fuchsflöhen. Das Vorgehen ändert sich dann nicht, wenn wir eine andere Funktion wie <span class="in">`pairwise.wilcox.test()`</span> nehmen.</span>
<span id="cb129-851"><a href="#cb129-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-852"><a href="#cb129-852" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... für das Paket `{emmeans}`</span></span>
<span id="cb129-853"><a href="#cb129-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-854"><a href="#cb129-854" aria-hidden="true" tabindex="-1"></a>In dem Paket <span class="in">`{emmeans}`</span> ist das *compact letter display* ebenfalls implementiert und wir müssen nicht die Funktion `multcompLetters()` nutzen. Durch die direkte Implementierung ist es etwas einfacher sich das *compact letter display* anzeigen zu lassen. Das Problem ist dann später sich die Buchstaben zu extrahieren um die @fig-boxplot-cld-3 zu ergänzen. Wir nutzen in `{emmeans}` die Funktion `cld()` um das *compact letter display* zu erstellen.</span>
<span id="cb129-855"><a href="#cb129-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-858"><a href="#cb129-858" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-859"><a href="#cb129-859" aria-hidden="true" tabindex="-1"></a>emmeans_cld <span class="ot">&lt;-</span> <span class="fu">lm</span>(rsp  <span class="sc">~</span> trt, <span class="at">data =</span> data_tbl) <span class="sc">|&gt;</span></span>
<span id="cb129-860"><a href="#cb129-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb129-861"><a href="#cb129-861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb129-862"><a href="#cb129-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-863"><a href="#cb129-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-864"><a href="#cb129-864" aria-hidden="true" tabindex="-1"></a>Wir erhalten dann die etwas besser sortierte Ausgabe für die Behandlungen wieder.</span>
<span id="cb129-865"><a href="#cb129-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-868"><a href="#cb129-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-869"><a href="#cb129-869" aria-hidden="true" tabindex="-1"></a>emmeans_cld </span>
<span id="cb129-870"><a href="#cb129-870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-871"><a href="#cb129-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-872"><a href="#cb129-872" aria-hidden="true" tabindex="-1"></a>Wie die Ausgabe von <span class="in">`cld()`</span> richtig anmerkt, können *compact letter display* irreführend sein weil sie eben **Nicht**-Unterschiede anstatt von signifikanten Unterschieden anzeigen. Zum Anderen sehen wir aber auch, dass wir 36 statistische Tests gerechnet haben und somit zu einem Signifikanzniveau von $\cfrac{\alpha}{k} = \cfrac{0.05}{36} \approx 0.0014$ testen. Wir brauchen also schon sehr große Unterschiede oder aber eine sehr kleine Streuung um hier signifikante Effekte nachweisen zu können.</span>
<span id="cb129-873"><a href="#cb129-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-874"><a href="#cb129-874" aria-hidden="true" tabindex="-1"></a>In @tbl-mean-to-letter-emmeans sehen wir das Ergebnis des *compact letter display* nochmal mit den Mittelwerten der Behandlungslevel zusammen dargestellt. Wir sehen wieder, dass sich <span class="in">`pos_crtl`</span> von allen anderen Behandlungen unterscheidet, deshalb hat nur die Behandlung <span class="in">`pos_crtl`</span> den Buchstaben <span class="in">`a`</span>. Die Mittelwerte vom <span class="in">`neg_ctrl`</span>, <span class="in">`treat_A`</span> und <span class="in">`treat_B`</span> sind nahezu gleich, also damit nicht signifikant. Deshalb erhalten diese Behandlungslevel ein <span class="in">`b`</span>. Wir gehen so alle Vergleiche einmal durch.</span>
<span id="cb129-875"><a href="#cb129-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-876"><a href="#cb129-876" aria-hidden="true" tabindex="-1"></a>| Behandlung | Mittelwert |     |     |     |     |     |     |</span>
<span id="cb129-877"><a href="#cb129-877" aria-hidden="true" tabindex="-1"></a>|:----------:|:----------:|:---:|:---:|:---:|:---:|:---:|:---:|</span>
<span id="cb129-878"><a href="#cb129-878" aria-hidden="true" tabindex="-1"></a>|  pos_crtl  |     10     |  a  |     |     |     |     |     |</span>
<span id="cb129-879"><a href="#cb129-879" aria-hidden="true" tabindex="-1"></a>|  neg_ctrl  |     20     |     |  b  |     |     |     |     |</span>
<span id="cb129-880"><a href="#cb129-880" aria-hidden="true" tabindex="-1"></a>|  treat_A   |     22     |     |  b  |     |     |     |     |</span>
<span id="cb129-881"><a href="#cb129-881" aria-hidden="true" tabindex="-1"></a>|  treat_B   |     24     |     |  b  |     |     |     |     |</span>
<span id="cb129-882"><a href="#cb129-882" aria-hidden="true" tabindex="-1"></a>|  treat_C   |     35     |     |     |  c  |     |     |     |</span>
<span id="cb129-883"><a href="#cb129-883" aria-hidden="true" tabindex="-1"></a>|  treat_D   |     37     |     |     |  c  |  d  |     |     |</span>
<span id="cb129-884"><a href="#cb129-884" aria-hidden="true" tabindex="-1"></a>|  treat_E   |     40     |     |     |     |  d  |  e  |     |</span>
<span id="cb129-885"><a href="#cb129-885" aria-hidden="true" tabindex="-1"></a>|  treat_F   |     43     |     |     |     |     |  e  |     |</span>
<span id="cb129-886"><a href="#cb129-886" aria-hidden="true" tabindex="-1"></a>|  treat_G   |     45     |     |     |     |     |     |  f  |</span>
<span id="cb129-887"><a href="#cb129-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-888"><a href="#cb129-888" aria-hidden="true" tabindex="-1"></a>: Kombination der Level der Behandlungen und deren Mittelwerte zur Generieung sowie dem *compact letter display* generiert aus den adjustierten $p$-Werten aus `emmeans`. Gleiche Buchstaben bedeuten *kein* signifikanter Unterschied. {#tbl-mean-to-letter-emmeans}</span>
<span id="cb129-889"><a href="#cb129-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-890"><a href="#cb129-890" aria-hidden="true" tabindex="-1"></a>Abschließend können wir die Buchstaben aus dem *compact letter display* noch in die @fig-boxplot-cld-3 ergänzen. Hier müssen wir etwas mehr machen um die Buchstaben aus dem Objekt <span class="in">`emmeans_cld`</span> zu bekommen. Du kannst dann noch die y-Position anpassen wenn du möchtest.</span>
<span id="cb129-891"><a href="#cb129-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-894"><a href="#cb129-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-895"><a href="#cb129-895" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-896"><a href="#cb129-896" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb129-897"><a href="#cb129-897" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb129-898"><a href="#cb129-898" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb129-899"><a href="#cb129-899" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb129-900"><a href="#cb129-900" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Boxplot der Beispieldaten zusammen mit den *compact letter display*.</span></span>
<span id="cb129-901"><a href="#cb129-901" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplot-cld-3</span></span>
<span id="cb129-902"><a href="#cb129-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-903"><a href="#cb129-903" aria-hidden="true" tabindex="-1"></a>letters_tbl <span class="ot">&lt;-</span> emmeans_cld <span class="sc">|&gt;</span> </span>
<span id="cb129-904"><a href="#cb129-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-905"><a href="#cb129-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(trt, <span class="at">label =</span> .group) <span class="sc">|&gt;</span> </span>
<span id="cb129-906"><a href="#cb129-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rsp =</span> <span class="dv">0</span>)</span>
<span id="cb129-907"><a href="#cb129-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-908"><a href="#cb129-908" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> rsp, </span>
<span id="cb129-909"><a href="#cb129-909" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb129-910"><a href="#cb129-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb129-911"><a href="#cb129-911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb129-912"><a href="#cb129-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb129-913"><a href="#cb129-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb129-914"><a href="#cb129-914" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letters_tbl, </span>
<span id="cb129-915"><a href="#cb129-915" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> trt , <span class="at">y =</span> rsp, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb129-916"><a href="#cb129-916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb129-917"><a href="#cb129-917" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-918"><a href="#cb129-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-919"><a href="#cb129-919" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb129-920"><a href="#cb129-920" aria-hidden="true" tabindex="-1"></a><span class="fu">## Das *compact letter display* anders gebaut...</span></span>
<span id="cb129-921"><a href="#cb129-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-922"><a href="#cb129-922" aria-hidden="true" tabindex="-1"></a>In dem kurzen Kapitel zu <span class="co">[</span><span class="ot">Re-engineering CLDs</span><span class="co">](https://cran.r-project.org/web/packages/emmeans/vignettes/re-engineering-clds.html)</span> in der Vingette des R Pakets <span class="in">`{emmeans}`</span> geht es darum, wie das *compact letter display* auch anders gebaut werden könnte. Nämlich einmal als wirkliches Anzeigen von Gleichheit über die Option <span class="in">`delta`</span> oder aber über das Anzeigen von Signifikanz über die Option <span class="in">`signif`</span>. Damit haben dann auch wirklich die Information, die wir dann wollen. Also eigentlich was Schönes. Wie machen wir das nun?</span>
<span id="cb129-923"><a href="#cb129-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-924"><a href="#cb129-924" aria-hidden="true" tabindex="-1"></a>Wenn wir das *compact letter display* in dem Sinne der Gleichheit der Behandlungen interpretieren wollen, also das der gleiche Buchstabe bedeutet, dass sich die Behandlungen nicht unterscheiden, dann müssen wir ein <span class="in">`delta`</span> setzen in deren Bandbreite oder Intervall die Behandlungen gleich sind. Ich habe hier mal ein <span class="in">`delta`</span> von 20 gewählt und wir adjustieren bei einem Test auf Gleichheit nicht.</span>
<span id="cb129-925"><a href="#cb129-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-928"><a href="#cb129-928" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-929"><a href="#cb129-929" aria-hidden="true" tabindex="-1"></a>emmeans_cld <span class="ot">&lt;-</span> <span class="fu">lm</span>(rsp  <span class="sc">~</span> trt, <span class="at">data =</span> data_tbl) <span class="sc">|&gt;</span></span>
<span id="cb129-930"><a href="#cb129-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb129-931"><a href="#cb129-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>, <span class="at">delta =</span> <span class="dv">20</span>)</span>
<span id="cb129-932"><a href="#cb129-932" aria-hidden="true" tabindex="-1"></a>emmeans_cld </span>
<span id="cb129-933"><a href="#cb129-933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-934"><a href="#cb129-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-935"><a href="#cb129-935" aria-hidden="true" tabindex="-1"></a>Wie wir jetzt sehen, bedeuten gleiche Buchstaben, dass die Behandlungen gleich sind. In dem Sinne gleich sind, dass die Behandlungen im Mittel nicht weiter als der Wert in <span class="in">`delta`</span> auseinanderliegen. Wie du jetzt das <span class="in">`delta`</span> bestimmst ist eine biologische und keine statistische Frage.</span>
<span id="cb129-936"><a href="#cb129-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-937"><a href="#cb129-937" aria-hidden="true" tabindex="-1"></a>Können wir uns auch signifikante Unterschiede anzeigen lassen? Ja, können wir auch, aber das ist meiner Meinung nach die schlechtere der beiden Anpassungen. Wir haben ja im Kopf, dass das *compact letter display* eben mit gleichen Buchstaben das Gleiche anzeigt. Jetzt würden wir diese Eigenschaften zu Unterschied ändern. Schauen wir uns das einmal an einem kleineren Datensatz einmal an.</span>
<span id="cb129-938"><a href="#cb129-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-941"><a href="#cb129-941" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-942"><a href="#cb129-942" aria-hidden="true" tabindex="-1"></a>small_fit <span class="ot">&lt;-</span> data_tbl <span class="sc">|&gt;</span> </span>
<span id="cb129-943"><a href="#cb129-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"pos_ctrl"</span>, <span class="st">"neg_ctrl"</span>, <span class="st">"treat_A"</span>, <span class="st">"treat_G"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb129-944"><a href="#cb129-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(rsp  <span class="sc">~</span> trt, <span class="at">data =</span> _) </span>
<span id="cb129-945"><a href="#cb129-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-946"><a href="#cb129-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-947"><a href="#cb129-947" aria-hidden="true" tabindex="-1"></a>Dann können wir uns hier einmal das Problem mit den Buchstaben anschauen. Wir kriegen jetzt mit der Option <span class="in">`signif = TRUE`</span> wiedergeben <span class="in">`Estimates sharing the same symbol are significantly different`</span> und das ist irgendwie auch wirr, dass *gleiche* Buchstaben einen Unterschied darstellen. Das *compact letter display* wird eben als Gleichheit gelesen, so dass wir hier mehr verwirrt werden als es hilft.</span>
<span id="cb129-948"><a href="#cb129-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-951"><a href="#cb129-951" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-952"><a href="#cb129-952" aria-hidden="true" tabindex="-1"></a>small_fit <span class="sc">|&gt;</span> </span>
<span id="cb129-953"><a href="#cb129-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb129-954"><a href="#cb129-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>, <span class="at">signif =</span> <span class="cn">TRUE</span>)</span>
<span id="cb129-955"><a href="#cb129-955" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-956"><a href="#cb129-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-957"><a href="#cb129-957" aria-hidden="true" tabindex="-1"></a>Deshalb würde ich auf die Buchstaben verzichten und die Zahlen angeben, damit hier nicht noch mehr Verwirrung aufkommt. Wir nehmen also die Option für die Buchstaben einmal aus dem <span class="in">`cld()`</span> Aufruf raus. Dann haben wir Zahlen als Gruppenzuweisung, was schon mal was anderes ist als die Buchstaben aus dem *compact letter display*.</span>
<span id="cb129-958"><a href="#cb129-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-961"><a href="#cb129-961" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-962"><a href="#cb129-962" aria-hidden="true" tabindex="-1"></a>small_fit <span class="sc">|&gt;</span> </span>
<span id="cb129-963"><a href="#cb129-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt) <span class="sc">|&gt;</span></span>
<span id="cb129-964"><a href="#cb129-964" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">adjust =</span> <span class="st">"bonferroni"</span>, <span class="at">signif =</span> <span class="cn">TRUE</span>)</span>
<span id="cb129-965"><a href="#cb129-965" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-966"><a href="#cb129-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-967"><a href="#cb129-967" aria-hidden="true" tabindex="-1"></a>Innerhalb des selben Konzepts dann zwei Arten von Interpretation des *compact letter display* zu haben, ist dann auch nicht zielführend. Den auch die *gleichen* Zahlen bedeuten jetzt einen Unterschied. Irgendwie mag ich persönlich nicht diese sehr verdrehte Interpretation nicht. Deshalb lieber ein <span class="in">`delta`</span> einführen und auf echte Gleichheit testen.</span>
<span id="cb129-968"><a href="#cb129-968" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb129-969"><a href="#cb129-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-970"><a href="#cb129-970" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... für das Paket `{multcomp}`</span></span>
<span id="cb129-971"><a href="#cb129-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-972"><a href="#cb129-972" aria-hidden="true" tabindex="-1"></a>Wir schauen uns zuerst einmal die Implementierung des *compact letter display* in dem Paket `{multcomp}` an. Wir nutzen die Funktion `multcompLetters()` aus dem Paket `{multcompView}` um uns das *compact letter display* wiedergeben zu lassen. Davor müssen wir noch einige Schritte an Sortierung und Umbenennung durchführen. Das hat den Grund, dass die Funktion `multcompLetters()` *nur* einen benannten Vektor mit $p$-Werten akzeptiert. Das heist wir müssen aus der Funktion <span class="in">`glht()`</span> die adjustierten $p$-Werte extrahieren und dann einen Vektor der Vergleiche bzw. Kontraste in der Form <span class="in">`A-B`</span> bauen. Also ohne Leerzeichen und in der Beschreibung der Level der Behandlung <span class="in">`trt`</span>. Die Funktion <span class="in">`pull()`</span> erlaubt uns einen Spalte als Vektor aus einem <span class="in">`tibble()`</span> zu ziehen und dann nach der Spalte <span class="in">`contrast`</span> zu benennen.</span>
<span id="cb129-973"><a href="#cb129-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-976"><a href="#cb129-976" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-977"><a href="#cb129-977" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-978"><a href="#cb129-978" aria-hidden="true" tabindex="-1"></a>multcomp_cld <span class="ot">&lt;-</span> <span class="fu">lm</span>(rsp  <span class="sc">~</span> trt, <span class="at">data =</span> data_tbl) <span class="sc">|&gt;</span></span>
<span id="cb129-979"><a href="#cb129-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glht</span>(<span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">trt =</span> <span class="st">"Tukey"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb129-980"><a href="#cb129-980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-981"><a href="#cb129-981" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_replace_all</span>(contrast, <span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">""</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb129-982"><a href="#cb129-982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(adj.p.value, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb129-983"><a href="#cb129-983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span>
<span id="cb129-984"><a href="#cb129-984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-985"><a href="#cb129-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-986"><a href="#cb129-986" aria-hidden="true" tabindex="-1"></a>Wir erhalten dann folgendes *compact letter display* für die paarweisen Vergleiche aus <span class="in">`multcomp`</span>.</span>
<span id="cb129-987"><a href="#cb129-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-990"><a href="#cb129-990" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-991"><a href="#cb129-991" aria-hidden="true" tabindex="-1"></a>multcomp_cld </span>
<span id="cb129-992"><a href="#cb129-992" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-993"><a href="#cb129-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-994"><a href="#cb129-994" aria-hidden="true" tabindex="-1"></a>Leider sind diese Buchstaben in dieser Form schwer zu verstehen. Deshalb gibt es noch die Funktion <span class="in">`plot()`</span> in dem Paket <span class="in">`{multcompView}`</span> um uns die Buchstaben mit den Leveln der Behandlung einmal ausgeben zu lassen. Wir erhalten dann folgende Abbildung.</span>
<span id="cb129-995"><a href="#cb129-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-998"><a href="#cb129-998" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-999"><a href="#cb129-999" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1000"><a href="#cb129-1000" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-1001"><a href="#cb129-1001" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb129-1002"><a href="#cb129-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1003"><a href="#cb129-1003" aria-hidden="true" tabindex="-1"></a>multcomp_cld <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb129-1004"><a href="#cb129-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1005"><a href="#cb129-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1006"><a href="#cb129-1006" aria-hidden="true" tabindex="-1"></a>In dem *compact letter display* bedeuten gleiche Buchstaben, dass die Behandlungen gleich sind. Es gilt die Nullhypothese für diesen Vergleich. Was sehen wir also hier? Kombinieren wir einmal das *compact letter display* mit den Leveln der Behandlung und den Mittelwerten der Behandlungen in einer @tbl-mean-to-letter-multcomp. Wenn die Mittelwerte *gleich* sind, dann erhalten die Behandlungslevel den gleichen Buchstaben. Die Mittelwerte vom `neg_ctrl`, `treat_A` und `treat_B` sind nahezu gleich, also damit nicht signifikant. Deshalb erhalten diese Behandlungslevel ein `a`. Ebenso sind die MIttelwerte von `treat_C` und `treat_D` nahezu gleich, dehalb erhalten beide ein `b`. Das machen wir immer so weiter und konzentrieren uns also auf die *nicht* signifikanten Ergebnisse. Denn gleiche Buchstaben bedeuten, dass die Behandlungen gleich sind. Wir sehen hier also, bei welchen Vergleichen die Nullhypothese gilt.</span>
<span id="cb129-1007"><a href="#cb129-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1008"><a href="#cb129-1008" aria-hidden="true" tabindex="-1"></a>| Behandlung | Mittelwert |     |     |     |     |     |     |</span>
<span id="cb129-1009"><a href="#cb129-1009" aria-hidden="true" tabindex="-1"></a>|:----------:|:----------:|:---:|:---:|:---:|:---:|:---:|:---:|</span>
<span id="cb129-1010"><a href="#cb129-1010" aria-hidden="true" tabindex="-1"></a>|  neg_ctrl  |     20     |  a  |     |     |     |     |     |</span>
<span id="cb129-1011"><a href="#cb129-1011" aria-hidden="true" tabindex="-1"></a>|  treat_A   |     22     |  a  |     |     |     |     |     |</span>
<span id="cb129-1012"><a href="#cb129-1012" aria-hidden="true" tabindex="-1"></a>|  treat_B   |     24     |  a  |     |     |     |     |     |</span>
<span id="cb129-1013"><a href="#cb129-1013" aria-hidden="true" tabindex="-1"></a>|  treat_C   |     35     |     |  b  |     |     |     |     |</span>
<span id="cb129-1014"><a href="#cb129-1014" aria-hidden="true" tabindex="-1"></a>|  treat_D   |     37     |     |  b  |  c  |     |     |     |</span>
<span id="cb129-1015"><a href="#cb129-1015" aria-hidden="true" tabindex="-1"></a>|  treat_E   |     40     |     |     |  c  |  d  |     |     |</span>
<span id="cb129-1016"><a href="#cb129-1016" aria-hidden="true" tabindex="-1"></a>|  treat_F   |     43     |     |     |     |  d  |     |     |</span>
<span id="cb129-1017"><a href="#cb129-1017" aria-hidden="true" tabindex="-1"></a>|  treat_G   |     45     |     |     |     |     |  e  |     |</span>
<span id="cb129-1018"><a href="#cb129-1018" aria-hidden="true" tabindex="-1"></a>|  pos_crtl  |     10     |     |     |     |     |     |  f  |</span>
<span id="cb129-1019"><a href="#cb129-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1020"><a href="#cb129-1020" aria-hidden="true" tabindex="-1"></a>: Kombination der Level der Behandlungen und deren Mittelwerte zur Generieung sowie dem *compact letter display* generiert aus den adjustierten $p$-Werten aus `multcomp`. Gleiche Buchstaben bedeuten *kein* signifikanter Unterschied. {#tbl-mean-to-letter-multcomp}</span>
<span id="cb129-1021"><a href="#cb129-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1022"><a href="#cb129-1022" aria-hidden="true" tabindex="-1"></a>Wir können dann die Buchstaben auch in den Boxplot ergaänzen. Die y-Position kann je nach Belieben dann noch angepasst werden. zum Beispiel könnten hier auch die Mittelwerte aus einer <span class="in">`summarise()`</span> Funktion ergänzt werden und so die y-Position angepasst werden.</span>
<span id="cb129-1023"><a href="#cb129-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1026"><a href="#cb129-1026" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-1027"><a href="#cb129-1027" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-1028"><a href="#cb129-1028" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb129-1029"><a href="#cb129-1029" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb129-1030"><a href="#cb129-1030" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb129-1031"><a href="#cb129-1031" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb129-1032"><a href="#cb129-1032" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Boxplot der Beispieldaten zusammen mit den *compact letter display*.</span></span>
<span id="cb129-1033"><a href="#cb129-1033" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplot-cld-2</span></span>
<span id="cb129-1034"><a href="#cb129-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1035"><a href="#cb129-1035" aria-hidden="true" tabindex="-1"></a>letters_tbl <span class="ot">&lt;-</span> multcomp_cld<span class="sc">$</span>Letters <span class="sc">|&gt;</span> </span>
<span id="cb129-1036"><a href="#cb129-1036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">enframe</span>(<span class="st">"trt"</span>, <span class="st">"label"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-1037"><a href="#cb129-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rsp =</span> <span class="dv">0</span>)</span>
<span id="cb129-1038"><a href="#cb129-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1039"><a href="#cb129-1039" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> rsp, </span>
<span id="cb129-1040"><a href="#cb129-1040" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb129-1041"><a href="#cb129-1041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb129-1042"><a href="#cb129-1042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb129-1043"><a href="#cb129-1043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb129-1044"><a href="#cb129-1044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb129-1045"><a href="#cb129-1045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letters_tbl, </span>
<span id="cb129-1046"><a href="#cb129-1046" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> trt , <span class="at">y =</span> rsp, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb129-1047"><a href="#cb129-1047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb129-1048"><a href="#cb129-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1049"><a href="#cb129-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1050"><a href="#cb129-1050" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... für den Games-Howell-Test</span></span>
<span id="cb129-1051"><a href="#cb129-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1052"><a href="#cb129-1052" aria-hidden="true" tabindex="-1"></a>Abschließend wollen wir uns die Implementierung des *compact letter display* für den Games-Howell-Test einmal anschauen. Es gilt vieles von dem in diesem Abschnitt schon gesagtes. Wir nutzen die Funktion `multcompLetters()` aus dem Paket `{multcompView}` um uns das *compact letter display* aus dem Games-Howell-Test wiedergeben zu lassen. Davor müssen wir noch einige Schritte an Sortierung und Umbenennung durchführen. Das hat den Grund, dass die Funktion `multcompLetters()` *nur* einen benannten Vektor mit $p$-Werten akzeptiert. Die Funktion <span class="in">`pull()`</span> erlaubt uns einen Spalte als Vektor aus einem <span class="in">`tibble()`</span> zu ziehen und dann nach der Spalte <span class="in">`contrast`</span> zu benennen.</span>
<span id="cb129-1053"><a href="#cb129-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1056"><a href="#cb129-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-1057"><a href="#cb129-1057" aria-hidden="true" tabindex="-1"></a>ght_cld <span class="ot">&lt;-</span> <span class="fu">games_howell_test</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> data_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb129-1058"><a href="#cb129-1058" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> <span class="fu">str_c</span>(group1, <span class="st">"-"</span>, group2)) <span class="sc">|&gt;</span> </span>
<span id="cb129-1059"><a href="#cb129-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p.adj, contrast) <span class="sc">|&gt;</span> </span>
<span id="cb129-1060"><a href="#cb129-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multcompLetters</span>() </span>
<span id="cb129-1061"><a href="#cb129-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1062"><a href="#cb129-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1063"><a href="#cb129-1063" aria-hidden="true" tabindex="-1"></a>Das *compact letter display* kennen wir schon aus der obigen Beschreibung.</span>
<span id="cb129-1064"><a href="#cb129-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1067"><a href="#cb129-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-1068"><a href="#cb129-1068" aria-hidden="true" tabindex="-1"></a>ght_cld</span>
<span id="cb129-1069"><a href="#cb129-1069" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1070"><a href="#cb129-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1071"><a href="#cb129-1071" aria-hidden="true" tabindex="-1"></a>Wir können uns dann auch das *compact letter display* als übersichtlicheren Plot wiedergeben lassen.</span>
<span id="cb129-1072"><a href="#cb129-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1075"><a href="#cb129-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-1076"><a href="#cb129-1076" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb129-1077"><a href="#cb129-1077" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-1078"><a href="#cb129-1078" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: hide</span></span>
<span id="cb129-1079"><a href="#cb129-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1080"><a href="#cb129-1080" aria-hidden="true" tabindex="-1"></a>ght_cld <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb129-1081"><a href="#cb129-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1082"><a href="#cb129-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1083"><a href="#cb129-1083" aria-hidden="true" tabindex="-1"></a>Um die Zusammenhänge besser zu verstehen ist in @tbl-mean-to-letter-ght nochmal die Kombination der Level der Behandlungen und deren Mittelwerte zur Generieung sowie dem *compact letter display* dargestellt. Wir sehen wieder, dass sich <span class="in">`pos_crtl`</span> von allen anderen Behandlungen unterscheidet, deshalb hat nur die Behandlung <span class="in">`pos_crtl`</span> den Buchstaben <span class="in">`a`</span>. Die Mittelwerte vom <span class="in">`neg_ctrl`</span>, <span class="in">`treat_A`</span> und <span class="in">`treat_B`</span> sind nahezu gleich, also damit nicht signifikant. Deshalb erhalten diese Behandlungslevel ein <span class="in">`b`</span>. In der Form können wir alle Vergleiche einmal durchgehen.</span>
<span id="cb129-1084"><a href="#cb129-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1085"><a href="#cb129-1085" aria-hidden="true" tabindex="-1"></a>| Behandlung | Mittelwert |     |     |     |     |     |</span>
<span id="cb129-1086"><a href="#cb129-1086" aria-hidden="true" tabindex="-1"></a>|:----------:|:----------:|:---:|:---:|:---:|:---:|:---:|</span>
<span id="cb129-1087"><a href="#cb129-1087" aria-hidden="true" tabindex="-1"></a>|  pos_crtl  |     10     |  a  |     |     |     |     |</span>
<span id="cb129-1088"><a href="#cb129-1088" aria-hidden="true" tabindex="-1"></a>|  neg_ctrl  |     20     |     |  b  |     |     |     |</span>
<span id="cb129-1089"><a href="#cb129-1089" aria-hidden="true" tabindex="-1"></a>|  treat_A   |     22     |     |  b  |     |     |     |</span>
<span id="cb129-1090"><a href="#cb129-1090" aria-hidden="true" tabindex="-1"></a>|  treat_B   |     24     |     |  b  |     |     |     |</span>
<span id="cb129-1091"><a href="#cb129-1091" aria-hidden="true" tabindex="-1"></a>|  treat_C   |     35     |     |     |  c  |     |     |</span>
<span id="cb129-1092"><a href="#cb129-1092" aria-hidden="true" tabindex="-1"></a>|  treat_D   |     37     |     |     |  c  |  d  |     |</span>
<span id="cb129-1093"><a href="#cb129-1093" aria-hidden="true" tabindex="-1"></a>|  treat_E   |     40     |     |     |     |  d  |     |</span>
<span id="cb129-1094"><a href="#cb129-1094" aria-hidden="true" tabindex="-1"></a>|  treat_F   |     43     |     |     |     |  d  |     |</span>
<span id="cb129-1095"><a href="#cb129-1095" aria-hidden="true" tabindex="-1"></a>|  treat_G   |     45     |     |     |     |     |  e  |</span>
<span id="cb129-1096"><a href="#cb129-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1097"><a href="#cb129-1097" aria-hidden="true" tabindex="-1"></a>: Kombination der Level der Behandlungen und deren Mittelwerte zur Generieung sowie dem *compact letter display* generiert aus den adjustierten $p$-Werten aus dem Games-Howell-Test. Gleiche Buchstaben bedeuten *kein* signifikanter Unterschied. {#tbl-mean-to-letter-ght}</span>
<span id="cb129-1098"><a href="#cb129-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1099"><a href="#cb129-1099" aria-hidden="true" tabindex="-1"></a>Wir können dann auch in @fig-boxplot-cld-4 sehen, wie das *compact letter display* mit den Boxplots verbunden wird.</span>
<span id="cb129-1100"><a href="#cb129-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1103"><a href="#cb129-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb129-1104"><a href="#cb129-1104" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb129-1105"><a href="#cb129-1105" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb129-1106"><a href="#cb129-1106" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb129-1107"><a href="#cb129-1107" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb129-1108"><a href="#cb129-1108" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb129-1109"><a href="#cb129-1109" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Boxplot der Beispieldaten zusammen mit den *compact letter display*.</span></span>
<span id="cb129-1110"><a href="#cb129-1110" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-boxplot-cld-4</span></span>
<span id="cb129-1111"><a href="#cb129-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1112"><a href="#cb129-1112" aria-hidden="true" tabindex="-1"></a>letters_tbl <span class="ot">&lt;-</span> ght_cld<span class="sc">$</span>Letters <span class="sc">|&gt;</span> </span>
<span id="cb129-1113"><a href="#cb129-1113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">enframe</span>(<span class="st">"trt"</span>, <span class="st">"label"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb129-1114"><a href="#cb129-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rsp =</span> <span class="dv">0</span>)</span>
<span id="cb129-1115"><a href="#cb129-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1116"><a href="#cb129-1116" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> rsp, </span>
<span id="cb129-1117"><a href="#cb129-1117" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb129-1118"><a href="#cb129-1118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb129-1119"><a href="#cb129-1119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb129-1120"><a href="#cb129-1120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb129-1121"><a href="#cb129-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb129-1122"><a href="#cb129-1122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letters_tbl, </span>
<span id="cb129-1123"><a href="#cb129-1123" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> trt , <span class="at">y =</span> rsp, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb129-1124"><a href="#cb129-1124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb129-1125"><a href="#cb129-1125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb129-1126"><a href="#cb129-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-1127"><a href="#cb129-1127" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-posthoc.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-posthoc.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"descPosition":"bottom","openEffect":"zoom","selector":".lightbox","loop":false,"closeEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>
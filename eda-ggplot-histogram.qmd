Wir nutzen für die Erstellung eines Histogramms den Datensatz `dog_fleas_hist.csv`. Wir brauchen für ein anständiges Histogramm, wo du auch was erkennen kannst, mindestens 20 Beobachtung. Am besten mehr. Deshalb schauen wir uns jetzt einmal 39 Hunde an und zählen wieviele Flöhe die Hunde jeweils haben `flea_count`. Darüber hinaus bestimmen wir auch noch das mittlere Gewicht der Flöhe auf dem jeweiligen Hund `flea_weight`.

```{r}
#| message: false
dog_fleas_tbl <- read_csv("data/dog_fleas_hist.csv")
```

```{r}
#| echo: false
#| label: tbl-cat-dog-histogram
#| tbl-cap: "Beispieldatensatz für die Anzahl an Flöhen auf 39 Hunden. Gezählt wurde die Anzahl an Flöhen `flea_count` und das gemittelte Gewicht der Flöhe `flea_weight`."

dog_fleas_tbl %>% kable(align = "c", "pipe")
```

@tbl-cat-dog-histogram zeigt den Datensatz `dog_fleas_hist.csv`. Wir wollen jetzt die Variable `flea_count` und `flea_weight` jeweils abbilden.

```{r }
#| echo: false
#| message: false
#| label: fig-dotplot-flea-1
#| fig-align: center
#| fig-height: 3
#| fig-width: 5
#| fig-cap: "An 39 Hunden wurde die Anzahl an Flöhen gezählt."


ggplot(dog_fleas_tbl, aes(x = flea_count)) + 
  geom_dotplot() +
  theme_bw() +
  scale_x_continuous(breaks = c(14,15,16,17,18,19)-14) +
  scale_y_continuous(labels = c(0, 5, 9, 13, 17)) +
  labs(x = "Anzahl Flöhe", y = "Anzahl") 

```

```{r}
#| echo: true
#| message: false
#| label: fig-hist-flea-1
#| fig-align: center
#| fig-height: 3
#| fig-width: 5
#| fig-cap: "An 39 Hunden wurde die Anzahl an Flöhen gezählt."

ggplot(data = dog_fleas_tbl, aes(x = flea_weight)) +
  geom_histogram(binwidth = 1, fill = "gray", color = "black") +
  theme_bw() +
  labs(x = "Gewicht [mg]", y = "Anzahl") 
```

```{r }
#| echo: false
#| message: false
#| label: fig-hist-flea-2
#| fig-align: center
#| fig-height: 3
#| fig-width: 5
#| fig-cap: "An 39 Hunden wurde die Anzahl an Flöhen gezählt."

ggplot(data = dog_fleas_tbl, aes(x = flea_weight)) +
  geom_histogram(binwidth = 1, fill = "gray", color = "black") +
  scale_x_continuous(breaks = 0:28) +
  scale_y_continuous(breaks = 0:9) +
  geom_vline(xintercept = 0:28, color = "blue", alpha = 0.5,
             linetype = "dashed") +
  geom_hline(yintercept = 0:9, color = "blue", alpha = 0.5,
             linetype = "dashed") +
  theme_bw() +
  labs(x = "Gewicht [mg]", y = "Anzahl") 

```

Wenn wir viele Beobachtungen haben. Viele meint mehr als zwanzig Beobachtungen.

```{r }
#| echo: false
#| message: false
#| fig-align: center
#| fig-height: 3
#| fig-width: 5
#| fig-cap: "An 39 Hunden wurde die Anzahl an Flöhen gezählt."

small_tbl <- dog_fleas_tbl %>% 
  filter(flea_weight > 11 & flea_weight < 19)

small_tbl %>% 
  arrange(flea_weight) %>% 
  pull(flea_weight)

ggplot(data = small_tbl, aes(x = flea_weight)) +
  geom_histogram(binwidth = 1, fill = "gray", color = "black", alpha = 0.5) +
  scale_x_continuous(breaks = 11:19) +
  scale_y_continuous(breaks = 0:5) +
  geom_vline(xintercept = seq(10.5, 19.5), color = "blue", alpha = 0.5,
             linetype = "dashed") +
  geom_vline(xintercept = small_tbl$flea_weight, color = "red", size = 1.5) +
  geom_hline(yintercept = 0:5, color = "blue", alpha = 0.5,
             linetype = "dashed") +
  theme_bw() +
  labs(x = "Gewicht [mg]", y = "Anzahl") 

```

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-align: center
#| fig-height: 3
#| fig-width: 5
#| fig-cap: "An 39 Hunden wurde die Anzahl an Flöhen gezählt."

ggplot(data = small_tbl, aes(x = flea_weight)) +
  geom_histogram(binwidth = 2, fill = "gray", color = "black", alpha = 0.5) +
  scale_x_continuous(breaks = 11:19) +
  scale_y_continuous(breaks = 0:5) +
  geom_vline(xintercept = seq(11, 19, 2), color = "blue", alpha = 0.5,
             linetype = "dashed") +
  geom_vline(xintercept = small_tbl$flea_weight, color = "red", size = 1.5) +
  geom_hline(yintercept = 0:5, color = "blue", alpha = 0.5,
             linetype = "dashed") +
  theme_bw() +
  labs(x = "Gewicht [mg]", y = "Anzahl") 
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-align: center
#| fig-height: 3
#| fig-width: 5
#| fig-cap: "An 39 Hunden wurde die Anzahl an Flöhen gezählt."

set.seed(20220789)
pois_tbl <- tibble(lambda1 = rpois(1000, 6),
              lambda2 = rpois(1000, 10),
              lambda3 = rpois(1000, 1)) %>% 
  gather()

ggplot(data = pois_tbl, aes(x = value, fill = key)) +
  theme_bw() +
  geom_histogram(binwidth = 1, position = position_dodge(0.95)) +
  labs(x = "", y = "Anzahl") +
  theme(legend.position = "none") +
  scale_x_continuous(breaks = 0:25, limits = c(0,NA)) +
  annotate("text", 3, 250, label = expression(paste("Pois(", lambda, " = 1)")),
           color = "blue") +
  annotate("text", 6, 180, label = expression(paste("Pois(", lambda, " = 6)")),
           color = "red") +
  annotate("text", 10, 150, label = expression(paste("Pois(", lambda, " = 10)")),
           color = "darkgreen") 
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-align: center
#| fig-height: 3
#| fig-width: 5
#| fig-cap: "An 39 Hunden wurde die Anzahl an Flöhen gezählt."

set.seed(20220789)
norm_tbl <- tibble(n1 = rnorm(10000, 10, 2),
                   n2 = rnorm(10000, 20, 2),
                   n3 = rnorm(10000, 0, 2)) %>% 
  gather()

ggplot(data = norm_tbl, aes(x = value, fill = key)) +
  theme_bw() +
  geom_histogram(position = position_identity(), alpha = 0.75) +
  labs(x = "", y = "Anzahl") +
  xlim(-15, 30) +
  theme(legend.position = "none") +
  annotate("text", 0, 3200, label = expression(paste("N(0,2)")),
           color = "blue") +
  annotate("text", 10, 3200, label = expression(paste("N(10,2)")),
           color = "red") +
  annotate("text", 20, 3200, label = expression(paste("N(20,2)")),
           color = "darkgreen") 
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-align: center
#| fig-height: 3
#| fig-width: 5
#| fig-cap: "An 39 Hunden wurde die Anzahl an Flöhen gezählt."

set.seed(20220789)
norm_tbl <- tibble(n1 = rnorm(10000, 10, 1),
                   n2 = rnorm(10000, 20, 3),
                   n3 = rnorm(10000, 0, 6)) %>% 
  gather()

ggplot(data = norm_tbl, aes(x = value, fill = key)) +
  theme_bw() +
  geom_histogram(binwidth = 1, position = position_identity(), alpha = 0.75) +
  labs(x = "", y = "Anzahl") +
  xlim(-15, 30) +
  theme(legend.position = "none") +
  annotate("text", 0, 900, label = expression(paste("N(0,6)")),
           color = "blue") +
  annotate("text", 10, 4100, label = expression(paste("N(10,1)")),
           color = "red") +
  annotate("text", 20, 1500, label = expression(paste("N(20,3)")),
           color = "darkgreen") 
```

### Density Plot

```{r }
#| echo: true
#| message: false
#| label: fig-dens-flea-1
#| fig-align: center
#| fig-height: 4
#| fig-width: 5
#| fig-cap: "An 39 Hunden wurde die Anzahl an Flöhen gezählt."


ggplot(data = dog_fleas_tbl, aes(x = flea_count)) +
  geom_density(fill = "gray", color = "black") +
  theme_bw()


```

```{r }
#| echo: true
#| message: false
#| label: fig-dens-flea-2
#| fig-align: center
#| fig-height: 4
#| fig-width: 5
#| fig-cap: "An 39 Hunden wurde die Anzahl an Flöhen gezählt."


ggplot(data = dog_fleas_tbl, aes(x = flea_weight)) +
  geom_density(fill = "gray", color = "black") +
  theme_bw()


```

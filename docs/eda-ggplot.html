<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>18&nbsp; Visualisierung von Daten – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./eda-distribution.html" rel="next">
<link href="./eda-descriptive.html" rel="prev">
<link href="./cover2026_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e41caad1b6b9b62eb3087831f3b4c651.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-064472c1586a72cde17e5630ffd91641.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="18&nbsp; Visualisierung von Daten – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2026.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./eda-preface.html">Explorative Datenanalyse</a></li><li class="breadcrumb-item"><a href="./eda-ggplot.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-generation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Generierung von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der U-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Chi-Quadrat-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mediator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Mediatoranalyse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-marginal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Marginal effect models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">83</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">84</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">18.1</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">18.2</span> Daten</a></li>
  <li><a href="#grundlagen-im" id="toc-grundlagen-im" class="nav-link" data-scroll-target="#grundlagen-im"><span class="header-section-number">18.3</span> Grundlagen im…</a>
  <ul class="collapse">
  <li><a href="#r-paket-ggplot" id="toc-r-paket-ggplot" class="nav-link" data-scroll-target="#r-paket-ggplot"><span class="header-section-number">18.3.1</span> R Paket <code>{ggplot}</code></a></li>
  <li><a href="#r-paket-tidyplots" id="toc-r-paket-tidyplots" class="nav-link" data-scroll-target="#r-paket-tidyplots"><span class="header-section-number">18.3.2</span> R Paket <code>{tidyplots}</code></a></li>
  </ul></li>
  <li><a href="#die-häufigsten-abbildungen" id="toc-die-häufigsten-abbildungen" class="nav-link" data-scroll-target="#die-häufigsten-abbildungen"><span class="header-section-number">18.4</span> Die häufigsten Abbildungen</a>
  <ul class="collapse">
  <li><a href="#sec-eda-barplot" id="toc-sec-eda-barplot" class="nav-link" data-scroll-target="#sec-eda-barplot"><span class="header-section-number">18.4.1</span> Barplot</a></li>
  <li><a href="#sec-eda-boxplot" id="toc-sec-eda-boxplot" class="nav-link" data-scroll-target="#sec-eda-boxplot"><span class="header-section-number">18.4.2</span> Boxplot</a></li>
  <li><a href="#sec-eda-scatter" id="toc-sec-eda-scatter" class="nav-link" data-scroll-target="#sec-eda-scatter"><span class="header-section-number">18.4.3</span> Scatterplot</a></li>
  <li><a href="#sec-eda-histogramm" id="toc-sec-eda-histogramm" class="nav-link" data-scroll-target="#sec-eda-histogramm"><span class="header-section-number">18.4.4</span> Histogramm</a></li>
  <li><a href="#density-plot" id="toc-density-plot" class="nav-link" data-scroll-target="#density-plot"><span class="header-section-number">18.4.5</span> Density Plot</a></li>
  <li><a href="#sec-eda-mosaic" id="toc-sec-eda-mosaic" class="nav-link" data-scroll-target="#sec-eda-mosaic"><span class="header-section-number">18.4.6</span> Mosaicplot</a></li>
  <li><a href="#sec-eda-dotplot" id="toc-sec-eda-dotplot" class="nav-link" data-scroll-target="#sec-eda-dotplot"><span class="header-section-number">18.4.7</span> Dotplot, Beeswarm und Raincloud Plot</a></li>
  <li><a href="#sec-eda-violinplot" id="toc-sec-eda-violinplot" class="nav-link" data-scroll-target="#sec-eda-violinplot"><span class="header-section-number">18.4.8</span> Violinplot</a></li>
  </ul></li>
  <li><a href="#weitere-optionen-in-ggplot" id="toc-weitere-optionen-in-ggplot" class="nav-link" data-scroll-target="#weitere-optionen-in-ggplot"><span class="header-section-number">18.5</span> Weitere Optionen in <code>{ggplot}</code></a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/eda-ggplot.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/eda-ggplot.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./eda-preface.html">Explorative Datenanalyse</a></li><li class="breadcrumb-item"><a href="./eda-ggplot.html"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-eda-ggplot" class="quarto-section-identifier"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 07. October 2025 um 14:49:19</em></p>
<blockquote class="blockquote">
<p><em>“The greatest value of a picture is when it forces us to notice what we never expected to see.” — John Tukey</em></p>
</blockquote>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/00OAyTOK_Mw" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Worum geht es in der explorativen Datenanalyse? Die explorative Datenanalyse wurde von <a href="https://de.wikipedia.org/wiki/John_W._Tukey">John Tukey (1915–2000)</a> begründet. Er war ein Pionier im Bereich der frühen Informatik und Computerwissenschaften. Warum explorativ, was wollen wir den erforschen? Denn nichts anderes bedeutet ja explorativ (deu. <em>erforschend, erkundend, untersuchend</em>) – wir wollen etwas entdecken. Die Idee war ziemlich innovativ und neu als <span class="citation" data-cites="tukey1977exploratory">Tukey et al. (<a href="#ref-tukey1977exploratory" role="doc-biblioref">1977</a>)</span> in seinem Buch die explorative Datenanalyse erstmal als Begriff vorstellte. Schon vorher beschrieb <span class="citation" data-cites="tukey1962future">Tukey (<a href="#ref-tukey1962future" role="doc-biblioref">1962</a>)</span> in seinem Artikel “The Future of Data Analysis” die zukünftige Datenanalyse, wie Tukey sie sich vorstellte, was auch sein folgendes Zitat belegt.</p>
<blockquote class="blockquote">
<p><em>“I know of no person or group that is taking nearly adequate advantage of the graphical potentialities of the computer.” — John Tukey</em></p>
</blockquote>
<p>Nun musst du wissen, dass in den 60’ziger Jahren der Computer in den Kinderschuhen steckte. Mal eben eine Berechnung durchführen, dass war dann schon so eine Sache der damaligen Zeit. Vieles bis fast alles wurde als Tabellen veröffentlicht und selten wurde eine Abbildung <em>händisch</em> dazu erstellt. An dieser Stelle sei einmal auf die <a href="https://youtu.be/kOO31qFmi9A?si=wHkm7frVVlH2e_SF">Microsoft Excel Werbung aus dem Jahr 1990</a> verwiesen. Daher war die Idee, sich Daten zu visualisieren entsprechend neu und wirklich ein wissenschaftlicher Fortschritt. Erstaunlicherweise glauben wir heute manchmal dann Zahlen in einer Tabelle mehr als einer Abbildung. Wir schreiben dann den Zahlen eine größere Genauigkeit und Aussagekraft zu, als einer explorativen Abbildung. Dabei können wir in einer Abbildung viel mehr sehen, als in einer Tabelle.</p>
<blockquote class="blockquote">
<p><em>“There is no data that can be displayed in a pie chart, that cannot be displayed BETTER in some other type of chart.” — John Tukey</em></p>
</blockquote>
<div id="fig-wumo-pie" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wumo-pie-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/cake_chart.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Abbildung&nbsp;18.1— “The reason to avoid pie charts” Quelle: wumo.com"><img src="images/eda/cake_chart.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wumo-pie-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.1— “The reason to avoid pie charts” Quelle: wumo.com
</figcaption>
</figure>
</div>
<p>Daher ist ein wichtiger Teil in der Analyse von Daten die Visualisierung und damit die Darstellung in einer Abbildung. Wir haben aber eine großem Auswahl an möglichen Abbildungen, deshalb auch das lange Kapitel hier. Siehe dazu auch die Arbeit von <span class="citation" data-cites="riedel2022replacing">Riedel et al. (<a href="#ref-riedel2022replacing" role="doc-biblioref">2022</a>)</span> mit dem Titel <a href="https://portlandpress.com/clinsci/article/136/15/1139/231562/Replacing-bar-graphs-of-continuous-data-with-more">Replacing bar graphs of continuous data with more informative graphics: are we making progress?</a> um mehr über die Nutzung der Abbildungen im Laufe der Zeit zu erfahren. Nicht alles was schon immer genutzt wurde, macht auch Sinn weiter genutzt zu werden. Wir haben mit R und <code>{ggplot}</code> eine Möglichkeit Abbildungen von Daten sehr viel besser zu erstellen als noch vor ein paar Jahrzehnten möglich war.</p>
<p>Grundsätzlich glauben wir dabei keiner Auswertung eines mathematischen Algorithmus, wenn wir nicht die Bestätigung in einer Abbildung sehen. Wenn wir also einen signifikanten Unterschied aus einem Algorithmus wiedergegeben bekommen, dann müssen wir auch den Unterschied in einer Abbildung sehen können. Eine statistische Analyse und deren Visualisierung gehen Hand in Hand. Daher ist die Visualisierung die Grundlage für ein fundiertes, wissenschaftliches Arbeiten. In diesem Kapitel stelle ich dir verschiedene Abbildungen vor, die uns helfen werden zu Verstehen ob es einen Zusammenhang zwischen <span class="math inline">\(y\)</span> und <span class="math inline">\(x\)</span> gibt. Wir haben ein <span class="math inline">\(y\)</span> vorliegen, was wir auf die y-Achse eines Graphen legen und daneben dann mehrere Variablen bzw. Spalten die wir <span class="math inline">\(x\)</span> nennen. Eine der Variablen legen wir auf die x-Achse des Graphen. Nach den anderen <span class="math inline">\(x\)</span> färben wir die Abbildung ein. Wir nennen dabei eine Abbildung auch häufig Plot. Das ist der englische Begriff und hat nichts in unserem Kontext mit einer Fläche oder einer Handlung in einem Film zu zu tun. Im den beiden folgenden Abbildungen siehst du einmal die beiden häufigsten wissenschaftlichen Fragestellungen in der explorativen Datenanalyse.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-overview-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-overview-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-eda-overview-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;18.2— Visualisierung der beiden häufigsten wissenschaftlichen Fragestellungen in der explorativen Datenanalyse. (A) Die Frage nach dem Unterschied. Unterschieden sich die Gruppen auf der x-Achse gegeben den Werten auf der y-Achse? Um den Unterschied darzustellen können Barplots oder Boxplots verwendet werden. (B) Die Frage nach dem Zusammenhang. Wie verändern sich die Werte der y-Achse, wenn sich die Werte auf der x-Achse ändern? Um den Zusammenhang zu zeigen kann ein Scatterplot verwendet werden. Die Gerade durch die Punkte kann durch eine (nicht) lineare Regression bestimmt werden. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-eda-overview-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1152"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-overview-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.2— Visualisierung der beiden häufigsten wissenschaftlichen Fragestellungen in der explorativen Datenanalyse. <strong>(A)</strong> <em>Die Frage nach dem Unterschied.</em> Unterschieden sich die Gruppen auf der x-Achse gegeben den Werten auf der y-Achse? Um den Unterschied darzustellen können Barplots oder Boxplots verwendet werden. <strong>(B)</strong> <em>Die Frage nach dem Zusammenhang.</em> Wie verändern sich die Werte der y-Achse, wenn sich die Werte auf der x-Achse ändern? Um den Zusammenhang zu zeigen kann ein Scatterplot verwendet werden. Die Gerade durch die Punkte kann durch eine (nicht) lineare Regression bestimmt werden. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>In diesem Kapitel wollen wir durch die bedeutendsten Abbildungen in der explorativen Datenanalyse durchgehen. Ich habe die Abbildungen etwas nach Kontext sortiert und geschaut, dass die Abbildungen zum Gruppennterschied oder Zusammenhang zweier Variablen als erstes besprochen werden.</p>
<ul>
<li><a href="#sec-eda-barplot">Barplot</a> für 5 und mehr Beobachtungen (pro Gruppe). Der Barplot oder das <em>Balkendiagramm</em> bzw. <em>Säulendiagramm</em> stellt den Mittelwert und die Standardabweichung da.</li>
<li><a href="#sec-eda-boxplot">Boxplot</a> für 5 bis 20 Beobachtungen (pro Gruppe). Ebenso wie bei einem Histogramm, geht es bei einem Boxplot auch um die Verteilung der einer Variable. Wir können in einem Boxplot auch erkennen, ob sogenannte auffällige Werte oder Ausreißer vorliegen.</li>
<li><a href="#sec-eda-scatter">Scatterplot</a> für zwei kontinuierliche Variablen. Auch <em>xy-Plot</em> genannt. Die Abbildung, die dir bekannt sein müsste. Wir zeichnen hier eine Grade durch eine Punktewolke.</li>
<li><a href="#sec-eda-mosaic">Mosaicplot</a> für zwei diskrete Variablen. Eine etwas seltene Abbildung, wenn wir Variablen abbilden wollen, die diskret sind bzw. aus Kategorien bestehen.</li>
<li><a href="#sec-eda-histogramm">Histogramm</a> für mehr als 20 Beobachtungen (pro Gruppe). Wir nutzen ein Histogramm um die Verteilung einer Variable zu visualisieren.</li>
<li><a href="#sec-eda-dotplot">Dotplot</a> für 3 bis 5 Beobachtungen (pro Gruppe). Hier geht es weniger um die Verteilung der Variable, sondern darum die wenigen Beobachtungen zu visualisieren.</li>
<li><a href="#sec-eda-violinplot">Violinplot</a> für die Kombination von einem Densityplot und einem Boxplot. Dann können wir hier noch den Dotplot ergänzen und haben eine sehr informative Übersichtsabbildung.</li>
</ul>
<p>Beginnen wir also mit dem Teil, der in der Statistik der mir immer am meisten Spaß macht. Oder aber um es in den Worten von John Tukey, den Begründer der explorativen Datenanalyse zu sagen:</p>
<blockquote class="blockquote">
<p><em>“This is my favorite part about analytics: Taking boring flat data and bringing it to life through visualization.” — John Tukey</em></p>
</blockquote>
<p>Wir immer geht natürlich hier auch noch viel mehr am Abbildungen. Du musst nicht alles in <code>ggplot</code> machen und darüber hinaus gibt es dann auch noch einiges an anderen R Paketen. In dem folgenden Kasten habe ich dir mal ein paar Quellen rausgesucht, wo du einmal gucken kannst, wenn du noch mehr Inspiration benötigst. Ich nutze die Seiten auch als Inspiration, den meisten weiß man gar nicht was alles geht, bis man die Visualisierung gesehen hat.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tipp</span>Weitere Möglichkeiten der Visualisierung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Im Folgenden einmal eine Auswahl an weiteren Möglichkeiten sich Abbildungen in R zu visualisieren. Teilweise ist es dann auch eine Sammlung an Informationen für mich, damit ich eine Idee habe, was noch so alles geht. Manchmal braucht man ja auch noch eine zusätzlich Inspiration.</p>
<ul>
<li><a href="https://rstudio.github.io/cheatsheets/html/data-visualization.html">Data visualization with ggplot2 :: Cheat Sheet</a> – als Überblick über alles was eigentlich in <code>ggplot</code> möglich ist. Du kriegst dann nochmal ein Überblick über die <code>geom</code>e, die es gibt und wie die einzelnen Funktionen und Möglichkeiten miteinander interagieren. Du kannst dir das Cheat Sheet auch auf Deutsch runterladen.<br>
</li>
<li><a href="https://r-charts.com/">R Charts by R Coder</a> – ein großer Überblick über alle möglichen Abbildungen sortiert nach verschiedenen Kategorien. Hier würde ich auf jeden Fall mal drüber schauen, dann kriegst du nochmal eine Idee was neben <code>ggplot</code> noch so alles geht. Ich finde die Seite immer sehr inspirierend.</li>
<li><a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/">ALL YOUR FIGURE ARE BELONG TO US</a> ist eine weitere tolle Übersicht an möglichen Abbildungen in <code>{ggplot}</code> Universum. Die Übersicht zeigt nochmal verschiedene R Pakte mit den entsprechenden möglichen Abbildungen.</li>
<li><a href="https://strengejacke.github.io/sjPlot/">sjPlot - Data Visualization for Statistics in Social Science</a> – auch hier geitbes dann die Möglichkeit nochmal etwas anders auf die Visualisierung zu schauen. Denn hier haben wir dann die Möglichkeiten der Sozialwissenschaften mehr abgedeckt. Das mag insbesondere im Bereich von Fragebögen und Marketing von Interesse sein.</li>
<li>Als spannende zusätzlichen Ressourcen seinen das <a href="https://wilkelab.org/cowplot/index.html">R Paket <code>{cowplot}</code></a> sowie das <a href="https://rpkgs.datanovia.com/ggpubr/index.html">R Paket <code>{ggpubr}</code></a> genannt. Besonders das Paket <code>cowplot</code> liefert noch schöne Formatierungsmöglichkeiten wobei dann <code>ggpubr</code> statistische Test mit der Visualisierung verbindet.</li>
<li><a href="https://plotly.com/r/">{plotly} R Open Source Graphing Library</a> sowie im besonderen dann die Seite <a href="https://plotly.com/ggplot2/getting-started/">Getting Started with {plotly} in {ggplot2}</a> liefert dann interaktive Abbildungen, wo du dann direkt hereinzoomen kannst. Das ist bei sehr großen Abbildungen immer sehr praktisch. Auch kannst du die Werte einer einzelnen Beobachtung gleich im Plot ablesen.</li>
<li><a href="https://bbc.github.io/rcookbook/">How to create BBC style graphics</a> – einmal als ein Beispiel für die Anwendung von <code>ggplot</code> in der Wirtschaft und Data Science. Auch hier sieht man schön die Ideen die möglich sind.</li>
<li><a href="https://www.cedricscherer.com/2021/06/06/visualizing-distributions-with-raincloud-plots-and-how-to-create-them-with-ggplot2/">Visualizing Distributions with Raincloud Plots (and How to Create Them with ggplot2)</a> – manchmal ist dann der Barplot oder Dynamiteplot dann doch irgendwie nicht das richtige Werkzeug um die Daten zu zeigen. Daher hier nochmal der Blogpost mit einer Diskussion was neben dem Säulendiagramm noch so alles gehen könnte.</li>
<li><a href="https://z3tt.github.io/OutlierConf2021/">ggplot Wizardry Hands-On</a> zeigt nochmal sher schön was alles in <code>{ggplot}</code> geht, wenn die entsprechenden zusätzlichen Pakete geladen werden. Ich schaue auch hier immer mal wieder rein, wenn ich eine Abbildung besonders schön machen möchte. Hier liegt dann der Fokus auf dem <a href="https://erocoar.github.io/gghalves/">R Paket<code>{gghalves}</code></a> sowie dem <a href="https://mjskay.github.io/ggdist/">R Paket <code>{ggdist}</code></a>.</li>
<li>Die Publikation <a href="https://rupress.org/jcb/article/177/1/7/34602/Error-bars-in-experimental-biology">Error bars in experimental biology</a> von <span class="citation" data-cites="cumming2007error">Cumming et al. (<a href="#ref-cumming2007error" role="doc-biblioref">2007</a>)</span> liefert nochmal einen Überblick über Fehlerbalken und welche Fehlerbalken man den nun nutzen sollte.</li>
</ul>
</div>
</div>
<section id="genutzte-r-pakete" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">18.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, readxl, ggmosaic, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               janitor, see, patchwork, latex2exp, ggbeeswarm,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               ggdist, gghalves, ggbreak, duke, wesanderson, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               tidyplots, conflicted)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>summarise)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(latex2exp<span class="sc">::</span>TeX)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="daten"><span class="header-section-number">18.2</span> Daten</h2>
<p>Wir immer bringe ich hier ein paar Datensätze mit damit wir dann verstehen, was eigentlich in den folgenden Visualisierungen in <code>{ggplot}</code> und den entsprechenden zusätzlichen R Paketen passiert. Ich zeige hier an den Daten nur die Anwendung in R. Deshalb fehlen dann hier auch die Mittelwerte und andere deskriptive Maßzahlen. Schauen wir jetzt also mal in unsere Beispieldaten für die einfaktorielle und zweifaktorielle Datenanalyse rein. Was heißt das nochmal? Wenn wir einen einfaktoriellen Datensatz vorliegen haben, dann haben wir nur einen Behandlunsgfaktor. Bei einem zweifaktorielle Datenanalyse betrachten wir eben dann zwei Behandlungen. Es wird dann aber gleich in den Beispielen klarer.</p>
<section id="einfaktorieller-datensatz" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorieller-datensatz">Einfaktorieller Datensatz</h4>
<p>Beginnen wir mit einem einfaktoriellen Datensatz. Wir haben hier als Messwert die Sprungweite von Flöhen in [cm] vorliegen. Wissen wollen wir, ob sich die Sprungweite für drei verschiedene Floharten unterscheidet. Damit ist dann in unserem Modell der Faktor <code>animal</code> und die Sprungweite <code>jump_length</code> als Messwert. Ich lade einmal die Daten in das Objekt <code>fac1_tbl</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Dann schauen wir uns die Daten einmal in der folgenden Tabelle als Auszug einmal an. Wichtig ist hier nochmal, dass du eben einen Faktor <code>animal</code> mit drei Leveln also Gruppen vorliegen hast. Wir wollen jetzt die drei Tierarten hinsichtlich ihrer Sprungweite in [cm] miteinander vergleichen.</p>
<div class="cell">
<div id="tbl-1fac-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;18.1— Tabelle der Sprungweiten in [cm] als Messwert <span class="math inline">\(y\)</span> von Hunde-, Katzen- und Fuchsflöhen. Der Datensatz ist einfaktoriell, da wir nur einen Faktor vorliegen haben.
</figcaption>
<div aria-describedby="tbl-1fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">jump_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.7</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">11.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.6</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">8.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">10.3</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="zweifaktorieller-datensatz" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorieller-datensatz">Zweifaktorieller Datensatz</h4>
<p>Neben dem einfaktoriellen Datensatz wollen wir uns noch den häufigeren Fall mit zwei Faktoren anschauen. Wir haben also nicht nur die drei Floharten vorliegen und wollen wissen ob diese unterschiedlich weit springen. Darüber hinaus haben wir noch einen zweiten Faktor gewählt. Wir haben die Sprungweiten der Hunde-, Katzen- und Fuchsflöhe nämlich an zwei Messorten, der Stadt und dem Dorf, gemessen. Dadurch haben wir jetzt den Faktor <code>animal</code> und den Faktor <code>site</code> vorliegen. Wiederum fragen wir uns, ob sich die Sprungweite in [cm] der drei Floharten in den beiden Messorten unterscheidet. Im Folgenden lade ich einmal den Datensatz in das Objekt <code>fac2_tbl</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_length_weight.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, sex, weight, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">sex =</span> <span class="fu">as_factor</span>(sex))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Betrachten wir als erstes einen Auszug aus der Datentabelle. Wir haben hier als Messwert oder Outcome <span class="math inline">\(y\)</span> die Sprungweite <code>jump_length</code> vorliegen. Als ersten Faktor die Variable <code>animal</code> und als zweiten Faktor die Variable <code>sex</code> festgelegt.</p>
<div class="cell">
<div id="tbl-2fac-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-2fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;18.2— Tabelle der Sprungweiten in [cm] als Messwert <span class="math inline">\(y\)</span> von Hunde-, Katzen- und Fuchsflöhen an zwei verschiedenen Messorten Stadt und Dorf. Der Datensatz ist zweifaktoriell, da wir einen Behandlungsfaktor mit <code>animal</code> und einen zweiten Faktor mit <code>site</code> vorliegen haben.
</figcaption>
<div aria-describedby="tbl-2fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">weight</th>
<th style="text-align: center;">jump_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">6.02</td>
<td style="text-align: center;">15.79</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">5.99</td>
<td style="text-align: center;">18.33</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">8.05</td>
<td style="text-align: center;">17.58</td>
</tr>
<tr class="even">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">9.26</td>
<td style="text-align: center;">24.35</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">8.85</td>
<td style="text-align: center;">24.36</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">7.89</td>
<td style="text-align: center;">22.13</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="der-gummibärchendatensatz" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="der-gummibärchendatensatz">Der Gummibärchendatensatz</h4>
<p>Wir brauchen dann ab und an auch nochmal mehr Datenpunkte, daher nehmen wir auch einmal den Gummibärchendatensatz und schauen uns dort die Variablen <code>gender</code>, <code>height</code> und <code>age</code> einmal genauer an. Wie immer nutzen wir die Funktion <code>select()</code> um die Spalten zu selektieren. Abschließend verwandeln wir das Geschlecht <code>gender</code> noch in einen Faktor und entfernen alle fehlenden Werte mit <code>na.omit()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>gummi_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/gummibears.xlsx"</span>)  <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gender, height, age) <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"männlich"</span>, <span class="st">"weiblich"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Und hier dann einmal der ausgewählte Datensatz der Gummibärchendaten. Ich zeige hier nur die ersten sieben Zeilen als Ausschnitt, die eigentlichen Daten sind mit <span class="math inline">\(n = 866\)</span> Beobachtungen viel größer.</p>
<div class="cell">
<div id="tbl-gummi-ggplot" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-gummi-ggplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;18.3— Tabelle mit dem Auzug der Gummibärchendaten von den ersten sieben Beobachtungen für das Geschlecht, die Körpergröße und dem Alter.
</figcaption>
<div aria-describedby="tbl-gummi-ggplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">gender</th>
<th style="text-align: center;">height</th>
<th style="text-align: center;">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">m</td>
<td style="text-align: center;">193</td>
<td style="text-align: center;">35</td>
</tr>
<tr class="even">
<td style="text-align: center;">w</td>
<td style="text-align: center;">159</td>
<td style="text-align: center;">21</td>
</tr>
<tr class="odd">
<td style="text-align: center;">w</td>
<td style="text-align: center;">159</td>
<td style="text-align: center;">21</td>
</tr>
<tr class="even">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="odd">
<td style="text-align: center;">m</td>
<td style="text-align: center;">193</td>
<td style="text-align: center;">23</td>
</tr>
<tr class="even">
<td style="text-align: center;">m</td>
<td style="text-align: center;">190</td>
<td style="text-align: center;">22</td>
</tr>
<tr class="odd">
<td style="text-align: center;">w</td>
<td style="text-align: center;">175</td>
<td style="text-align: center;">19</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="grundlagen-im" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="grundlagen-im"><span class="header-section-number">18.3</span> Grundlagen im…</h2>
<section id="r-paket-ggplot" class="level3" data-number="18.3.1">
<h3 data-number="18.3.1" class="anchored" data-anchor-id="r-paket-ggplot"><span class="header-section-number">18.3.1</span> R Paket <code>{ggplot}</code></h3>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/SGwSVzJ9C-s" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Wir nutzen in R das R Paket <code>{ggplot2}</code> um unsere Daten zu visualisieren. Die zentrale Idee von <code>{ggplot2}</code> ist, dass wir uns eine Abbildung wie ein Sandwich bauen. Zuerst legen wir eine Scheibe Brot hin und legen uns dann Scheibe für Scheibe weitere Schichten übereinander. Oder die Idee eines Bildes, wo wir erst die Leinwand definieren und dann Farbschicht über Farbschicht auftragen. Im Gegensatz zu dem Pipe-Operator <code>|&gt;</code> nutzt <code>{ggplot2}</code> den Operator <code>+</code> um die verschiedenen Funktionen (<code>geom_</code>) miteinander zu verbinden. Das Konzept von <code>{ggplot2}</code>ist schlecht zu be<em>schreiben</em> deshalb habe ich auch noch zwei Videos hierfür gemacht. Um den Prozess von <code>{ggplot2}</code> zu visualisieren - aber wie immer, nutze was du brauchst.</p>
<p>Erstellen wir also erstmal unseren erste Visualisierung in dem R Paket <code>{ggplot2}</code>. Im Folgenden spreche ich dann aber immer von <code>{ggplot}</code>. Die Funktion <code>ggplot()</code> ist die zentrale Funktion, die die Leinwand erschafft auf der wir dann verschiedene Schichten aufbringen werden. Diese Schichten heißen <code>geom</code>. Es gibt nicht nur ein <code>geom</code> sondern mehrere. Zum Beispiel das <code>geom_boxplot()</code> für die Erstellung von Boxplots, das <code>geom_histogram()</code> für die Erstellung von Histogrammen. <a href="https://ggplot2.tidyverse.org/reference/index.html">Die Auswahl ist riesig</a>. Die einzelnen Schichten werden dann über den Operator <code>+</code> miteinander verbunden. Soviel erstmal zur Trockenübung. Schauen wir uns das ganze einmal an einem Beispiel an. Dafür müssen wir dann erstmal einen Datensatz laden, damit wir auch etwas zum abbilden haben.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/SRRQQO3DXtc" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Wie immer empfehle ich dir dann auch das entsprechende Video auf YouTube anzuschauen. In Textform ist eine echte Herausforderung zu erklären wie man Plots baut. Der folgende R Code erstellt die Leinwand in der <a href="#fig-ggplot-1" class="quarto-xref">Abbildung&nbsp;<span>18.3</span></a> für die folgende, zusätzliches Schichten (<code>geom</code>). Wir haben also immer erst eine leere Leinwand auf der wir dann zusätzlich <code>geom</code>e plotten. Wir bauen uns sozusagen ein Sandwich.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal , <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Wir schauen uns einmal den Code im Detail an.</p>
<ul>
<li><code>ggplot</code> ruft die Funktion auf. Die Funktion ist dafür da den Plot zu zeichnen.</li>
<li><code>data = fac1_tbl</code> benennt den Datensatz aus dem der Plot gebaut werden soll.</li>
<li><code>aes()</code>ist die Abkürzung für <em>aesthetics</em> und beschreibt, was auf die <span class="math inline">\(x\)</span>-Achse soll, was auf die <span class="math inline">\(y\)</span>-Achse soll sowie ob es noch andere Faktoren in den Daten gibt. Wir können nämlich noch nach anderen Spalten die Abbildung einfärben oder anderweitig ändern.
<ul>
<li><code>x</code> braucht den Spaltennamen für die Variable auf der <span class="math inline">\(x\)</span>-Achse.</li>
<li><code>y</code> braucht den Spaltennamen für die Variable auf der <span class="math inline">\(y\)</span>-Achse.</li>
</ul></li>
<li><code>+ theme_minimal()</code> setzt das Canvas oder die Leinwand auf schwarz/weiß. Sonst wäre die Leinwand flächig grau.</li>
</ul>
<p>Mit Faktoren meine ich hier andere Gruppenvariablen. Variablen sind ein anderes Wort für Spalten. Also Variablen die wir mit <code>as_factor</code> erschaffen haben und die uns noch mehr über unsere Daten dann verraten können. Hier ist es dann etwas abstrakt, aber es wird dann später in der Anwendung klarer.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;18.3— Leere ggplot() Leinwand mit den Spalten animal und jump_length aus dem Datensatz fac1_tbl. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-ggplot-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.3— Leere ggplot() Leinwand mit den Spalten <code>animal</code> und <code>jump_length</code> aus dem Datensatz <code>fac1_tbl</code>. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Am Ende sehen wir, dass wir nichts sehen. In der <a href="#fig-ggplot-1" class="quarto-xref">Abbildung&nbsp;<span>18.3</span></a> ist nichts dargestellt. Der Grund ist, dass wir noch kein <code>geom</code> hinzugefügt haben. Das <code>geom</code> beschreibt nun wie die Zahlen in der Datentabelle <code>fac1_tbl</code> visualisiert werden sollen. Wir habe eine sehr große Auswahl an <code>geom</code>en, deshalb gibt es gleich einmal eine Auswahl an Abbildungen. Du findest dann auch weitere Optionen in <code>{ggplot}</code> im <a href="programing-ggplot.html">Kapitel zum <code>{ggplot}</code> Cookbook</a>.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Auf der Seite <a href="https://exts.ggplot2.tidyverse.org/gallery/">ggplot2 extensions</a> gibt es noch eine Vielzahl an weiteren tollen Möglichkeiten zu entdecken! Einfach durch die Galerie mit über 150+ Erweiterungen streifen und sich inspirieren lassen!</p>
</div>
</div>
</div>
</section>
<section id="r-paket-tidyplots" class="level3" data-number="18.3.2">
<h3 data-number="18.3.2" class="anchored" data-anchor-id="r-paket-tidyplots"><span class="header-section-number">18.3.2</span> R Paket <code>{tidyplots}</code></h3>
<p>Fortschritt lässt sich ja nicht aufhalten und was am Ende dann fortschrittlich ist, ist dann ja wieder die Frage. Manchmal brauchen wir einfach nicht die ganzen Funktionen und Möglichkeiten, die uns <code>{ggplot}</code> liefert. Wir wollen dann irgendwie alles etwas einfacher haben. In diese Lücke stößt die Arbeit von <span class="citation" data-cites="engler2025tidyplots">Engler (<a href="#ref-engler2025tidyplots" role="doc-biblioref">2025</a>)</span> mit dem <a href="https://jbengler.github.io/tidyplots/">R Paket <code>{tidyplots}</code></a>. Was macht also da R Paket <code>{tidyplots}</code> anders? Zum einen vereinfacht es die Benutzung von <code>{ggplot}</code>. Du hast nur noch eine große Auswahl, aber keien erschlagende Auswahl mehr. Dennoch basiert <code>{tidyplots}</code> auf <code>{ggplot}</code> und somit sind die Abbildungen auch echt schön und gut anzusehen. Am Ende ist es dann eine Geschmacksfrage was dir besser gefällt. Mich haben die <code>{tidyplots}</code> so sehr überzeugt, dass ich die <code>{tidyplots}</code> auf jeden Fall hier einmal vorstellen möchte. Vielleicht brauchst du auch nur diese Art der Darstellung und nicht die volle Batterie der Funktionen von <code>{ggplot}</code>. Deshalb vielleicht auch hier der Disclaimer, vieles geht dann schon, aber ich nutze weiterhin für viele Anwendunsgfälle dann doch <code>{ggplot}</code>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tipp</span>Mehr Informationen und Tipps
</div>
</div>
<div class="callout-body-container callout-body">
<p>Auch hier kann ich nicht alles erklären und auch die beispielhaften Abbildungen in den folgenden Abschnitten können das nicht. Daher schaue dir doch nochmal die Hilfes von <code>{tidyplots}</code> an.</p>
<ul>
<li>Die Hilfeseite <a href="https://jbengler.github.io/tidyplots/articles/tidyplots.html">Get started</a> liefert dir einen ersten Überblick über die Funktionen und Möglichkeiten.</li>
<li>Es gibt auch eine Reihe von tollen <a href="https://tidyplots.org/use-cases/">Use cases</a>, die dir ermöglichen einmal zu schauen was alles so geht.</li>
<li>Das <a href="https://tidyplots.org/tidyplots-cheatsheet-v1.pdf"><code>{tidyplots}</code> Cheatsheet</a> hilft am Ende dann nur, wenn du dich schon mit den Funktionen auseinandergestezt hast. Sonst finde ich es etwas unübersichtlich.</li>
</ul>
</div>
</div>
<p>Fangen wir einmal mit dem Standardaufruf in <code>{tidyplots}</code> an. Wir nutzen die Funktion <code>tidyplot()</code>, ohne das <code>s</code> wie im Namen des Pakets, um einen <code>tidyplot</code> zu erstellen. Wichtig ist hier nocoh, dass wir nicht das Pluszeichen <code>+</code> nutzen sondern alles mit dem Pipe-Operator <code>|&gt;</code> erledigen. Hier siehst du die Verwendung einmal mit der Funktion <code>adjust_size()</code>, die es uns erlaubt die Größe der Abbildung zu steuern.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal , <span class="at">y =</span> jump_length) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Wir schauen uns einmal den Code im Detail an.</p>
<ul>
<li><code>tidyplot</code> ruft die Funktion auf. Die Funktion ist dafür da den Plot zu zeichnen.</li>
<li><code>data = fac1_tbl</code> benennt den Datensatz aus dem der Plot gebaut werden soll.</li>
<li><code>x</code> braucht den Spaltennamen für die Variable auf der <span class="math inline">\(x\)</span>-Achse.</li>
<li><code>y</code> braucht den Spaltennamen für die Variable auf der <span class="math inline">\(y\)</span>-Achse.</li>
<li><code>adjust_size(width = NA, height = NA)</code> ist hier nochmal wichtig, da wir hiermit die Größe der Abbildung kontrollieren können. Ich möchte hier maximale Größe, deshalb sind die Breite <code>width</code> und Höhe <code>height</code> auf den Wert <code>NA</code> gesetzt.</li>
</ul>
<p>Wenn wir jetzt den Code ausführen, erhalten wir folgende leere Abbildung. Wir können dann einfach noch weitere Layer, wie auch bei <code>{ggplot}</code> ergänzen. Mehr dazu dann in den jeweiligen Tabs in den folgenden beispielhaften Abbildungen, die wir dann häufig nutzen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-tidyplot-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-tidyplot-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;18.4— Leere tidyplot() Leinwand mit den Spalten animal und jump_length aus dem Datensatz fac1_tbl. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-tidyplot-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.4— Leere tidyplot() Leinwand mit den Spalten <code>animal</code> und <code>jump_length</code> aus dem Datensatz <code>fac1_tbl</code>. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Du findest dann auch weitere Optionen in <code>{tidyplot}</code> im <a href="programing-ggplot.html">Kapitel zum <code>{ggplot}</code> Cookbook</a>. Oder aber eben auf den Hilfeseiten des <a href="https://jbengler.github.io/tidyplots/">R Paket <code>{tidyplots}</code></a>. Dann fangen wir einmal an uns die häufigsten Abbildungen in der explorativen Datenanalyse anzuschauen.</p>
</section>
</section>
<section id="die-häufigsten-abbildungen" class="level2" data-number="18.4">
<h2 data-number="18.4" class="anchored" data-anchor-id="die-häufigsten-abbildungen"><span class="header-section-number">18.4</span> Die häufigsten Abbildungen</h2>
<p>Im Folgenden gehen wir dann einmal die wichtigsten Abbildungen einmal durch. Viele der Abbildungen kennst du vielleicht schon und dann musst du hier nur noch schauen, wie die Abbildungen in <code>ggplot</code> zu realisieren sind. Ansonsten gilt wie immer, es ist nur ein kleiner Ausschnitt, du findest auf der <a href="https://ggplot2.tidyverse.org/index.html">Hilfeseite von <code>ggplot</code></a> eine sehr viel größere Übersicht.</p>
<section id="sec-eda-barplot" class="level3" data-number="18.4.1">
<h3 data-number="18.4.1" class="anchored" data-anchor-id="sec-eda-barplot"><span class="header-section-number">18.4.1</span> Barplot</h3>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/2ivNhsPJKY8" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Der Barplot oder das Balkendiagramm auch Säulendiagramm ist <em>eigentlich</em> veraltet. Wir haben mit dem Boxplot eine viel bessere Methode um eine Verteilung und gleichzeitig auch die Gruppenunterschiede zu visualisieren. Warum nutzen wir jetzt so viel den Barplot? Das hat damit zu tun, dass früher - oder besser bis vor kurzem - in Excel kein Boxplot möglich war. Daher nutzte jeder der mit Excel seine Daten auswertet den Barplot.</p>
<dl>
<dt>Muss die 0 mit auf die y-Achse?</dt>
<dd>
<p>Der <em>einzige</em> Grund, warum wir einen Barplot nutzen wollen würden, wäre wenn wir unbedingt die 0 mit auf der y-Achse haben wollten.</p>
</dd>
</dl>
<p>Weil aber eben noch viel der Barplot genutzt wird, stelle ich natürlich den Barplot auch hier vor. Der Barplot beinhaltet aber weniger Informationen als der Boxplot. Wir haben nur die Standardabweichung als Maßzahl für die Streuung. Beim Boxplot haben wir den Interquartilesabstand (abk . <em>IQR</em>), der uns mehr über die Streuung aussagt. Aber gut, häufig musst du den Barplot in deiner Abschlussarbeit machen. Zuerst betrachten wir die theoretische Darstellung. Dann zeige ich dir die Werte für unsere Sprungweiten der Hundeflöhe. Im letzten Tab findest du dann die Implementierung in <code>{ggplot}</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="" aria-current="page">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href=""><code>{ggplot}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false" href=""><code>{tidyplots}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false" href="">Excel</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>In den folgenden beiden Abbildungen siehst du einmal zwei Säulendigramme. Die Säulen gehen exakt so hoch wie der Mittelwert <span class="math inline">\(\bar{y}\)</span> der entsprechenden Gruppe <span class="math inline">\(A\)</span>. Dann berechnen wir noch für die Fehlerbalken die Standardabweichung (abk. <em>SD</em>). Je nachdem wie wir die Säulendigramme darstellen wollen, zeigen wir nur <span class="math inline">\(\bar{y} + SD\)</span> oder aber <span class="math inline">\(\bar{y} \pm SD\)</span>. Hier gibt es keine richtige Regel, das hängt sehr vom Geschmack ab und unterscheidet sich auch von Publikation zu Publikation. Je nachdem was wir als Outcome gemessen haben, können wir auch Überlegen anstatt der Standardabweichung den Standardfehler (abk. <em>SE</em>) zu nutzen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-barplot-drawn-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-barplot-drawn-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-barplot-drawn-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Abbildung&nbsp;18.5— Darstellung der Mittelwerte \bar{y} und der Standardabweichung (abk. SD) in einem Säulendigramm. Es gibt zwei Arten der Darstellung, die sich dann auf die Fehlerbalken bezieht. (A) Nur mit \bar{y} + SD (B) Mit \bar{y} \pm SD. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-barplot-drawn-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-barplot-drawn-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.5— Darstellung der Mittelwerte <span class="math inline">\(\bar{y}\)</span> und der Standardabweichung (abk. <em>SD</em>) in einem Säulendigramm. Es gibt zwei Arten der Darstellung, die sich dann auf die Fehlerbalken bezieht. <strong>(A)</strong> Nur mit <span class="math inline">\(\bar{y} + SD\)</span> <strong>(B)</strong> Mit <span class="math inline">\(\bar{y} \pm SD\)</span>. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>In den beiden folgenden Abbildungen siehst du einmal die Sprungweite der Hundeflöhe als ein Säulendigramm dargestellt. Wir haben den Mittelwert mit 8.13 sowie die Standardabweichung mit 2.14 berechnet. Daraus ergeben sich dann die Grenzen der Fehlerbalken. Ich habe dann in der rechten Abbildung die Fehlerbalken dann noch mit dem Standardfehler von 0.81 dargestellt. Wie du siehst, werden dann die Fehlerbalken kleiner, der Mittelwert bleibt natürlich in beiden Fällen gleich. Mehr dazu dann in dem <a href="eda-descriptive.html">Kapitel zur deskriptiven Statistik</a> und unter diesem Kasten.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-barplot-drawn-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-barplot-drawn-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-barplot-drawn-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Abbildung&nbsp;18.6— Darstellung der Mittelwerte \bar{y} und der Standardabweichung (abk. SD) sowie dem Standardfehler (abk. SE) in einem Säulendigramm. (A) Mit \bar{y} \pm SD (B) Mit \bar{y} \pm SE. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-barplot-drawn-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-barplot-drawn-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.6— Darstellung der Mittelwerte <span class="math inline">\(\bar{y}\)</span> und der Standardabweichung (abk. <em>SD</em>) sowie dem Standardfehler (abk. <em>SE</em>) in einem Säulendigramm. <strong>(A)</strong> Mit <span class="math inline">\(\bar{y} \pm SD\)</span> <strong>(B)</strong> Mit <span class="math inline">\(\bar{y} \pm SE\)</span>. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Wir schauen uns hier einmal in <code>{ggplot}</code> den einfaktoriellen sowie zweifaktoriellen Barplot an. Wenn wir von einem einfaktoriellen Barplot sprechen, dann haben wir nur eine Gruppe auf der x-Achse vorliegen. Wenn wir einen zweifaktoriellen Barplot bauen wollen, dann brauchen wir noch einen zweiten Gruppenfaktor für die Legende. Das klingt jetzt etwas wirr, wird aber gleich im Beispiel klarer.</p>
<section id="einfaktorieller-barplot" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorieller-barplot">Einfaktorieller Barplot</h4>
<p>Wenn wir ein Säulendigramm in <code>ggplot()</code> erstellen wollen, dann müssen wir jetzt den Mittelwert und die Streuung für die Gruppen in unseren Daten der Hunde- und Katzenflöhe berechnen. Du kannst als Streuung die Standardabweichung <code>sd</code> oder den Standardfehler <code>se</code> nehmen. Wir nehmen wir einmal die Standardabweichung für die Abbildung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>stat_fac1_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(jump_length),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Wir nutzen nun das Objekt <code>stat_tbl</code> um den Barplot mit der Funktion <code>ggplot()</code> zu erstellen. Dabei müssen wir zum einen schauen, dass die Balken nicht übereinander angeordnet sind. Nebeneinander angeordnete Balken kriegen wir mit der Option <code>stat = "identity"</code> in dem <code>geom_bar()</code>. Dann müssen wir noch die Fehlerbalken ergänzen mit dem <code>geom_errorbar()</code>. Hier kann nochmal mit der Option <code>width =</code> an der Länge der Fehlerenden gedreht werden.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stat_fac1_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-barplot-drawn-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-barplot-drawn-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-barplot-drawn-03-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Abbildung&nbsp;18.7— Säulendigramm der Sprungweiten der Hunde- und Katzenflöhe. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-barplot-drawn-03-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="336"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-barplot-drawn-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.7— Säulendigramm der Sprungweiten der Hunde- und Katzenflöhe. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Dank der Funktion <code>coord_flip()</code> können wir auch schnell aus dem Säulendiagramm ein Balkendiagramm bauen. Du musst dann immer schauen, was besser in deine Visualisierung passt.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stat_fac1_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-barplot-drawn-04" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-barplot-drawn-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-barplot-drawn-04-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Abbildung&nbsp;18.8— Balkendigramm der Sprungweiten der Hunde- und Katzenflöhe. Die Funktion coord_flip() macht aus einem Säulendiagramm ein Balkendiagramm. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-barplot-drawn-04-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-barplot-drawn-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.8— Balkendigramm der Sprungweiten der Hunde- und Katzenflöhe. Die Funktion <code>coord_flip()</code> macht aus einem Säulendiagramm ein Balkendiagramm. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>In der folgenden Abbildung siehst du dann nochmal den Barplot mit mehr Optionen und Informationen dargestellt. Auch habe ich die Farbpalette <code>scale_fill_okabeito()</code> aus dem R Paket <code>{see}</code> genutzt.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_fac1_tbl, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-posthoc-barplot-1fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-posthoc-barplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-posthoc-barplot-1fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Abbildung&nbsp;18.9— Beispielhafter einfaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen."><img src="eda-ggplot_files/figure-html/fig-ggplot-posthoc-barplot-1fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="336"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-posthoc-barplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.9— Beispielhafter einfaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweifaktorieller-barplot" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorieller-barplot">Zweifaktorieller Barplot</h4>
<p>Für den zweifaktoriellen Barplot brauchen wir einmal den Mittelwert und die Standardabweichung der einzelne Floharten getrennt für die beiden Messorte. Das geht natürlich auch umgedreht, also die Messorte für die Floharten. Das kommt dann auf deine Fragestellung an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>stat_fac2_tbl <span class="ot">&lt;-</span> fac2_tbl <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal, sex) <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(jump_length))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>stat_fac2_tbl</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
# Groups:   animal [3]
  animal sex     mean    sd
  &lt;fct&gt;  &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 cat    male    15.4  1.85
2 cat    female  20.5  1.78
3 dog    male    18.1  1.90
4 dog    female  22.9  2.06
5 fox    male    20.7  1.95
6 fox    female  25.5  2.06</code></pre>
</div>
</div>
<p>Und dann können wir auch schon den zweifaktoriellen Barplot in <code>{ggplot}</code> erstellen. Du musst schauen, was du auf die x-Achse legst und was du dann auf die Legende und daher auch so gruppierst. Damit die Positionen passen, spiele ich hier noch mit der Funktion <code>position_dodge()</code> rum.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_fac2_tbl, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> sex, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.9</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-posthoc-barplot-2fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-posthoc-barplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-posthoc-barplot-2fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Abbildung&nbsp;18.10— Beispielhafter zweifaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Geschlechtern."><img src="eda-ggplot_files/figure-html/fig-ggplot-posthoc-barplot-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-posthoc-barplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.10— Beispielhafter zweifaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Geschlechtern.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>Was mich überzeugt hat einmal das R Paket <code>{tidyplots}</code> vorzustellen, war dann die Verwendung für die Erstellung von Barplots. Ich finde den Weg in <code>{ggplot}</code> über die <code>summarise()</code> Funktion dann immer etwas umständlich. Ja, die Idee ist nicht schlecht, aber in <code>{tidyplots}</code> gibt es die Funktion <code>add_mean_bar()</code> was einfach das macht, was ich will. Und dann können wir auch einfach über die Funktion <code>add_sd_errorbar()</code> einen Fehlerbalken ergänzen. Mehr wollen wir ja auch nicht. Ich zeige jetzt gleich noch emhr, aber das hat den Grund, das wir ja auch die Abbildungen dann schöner haben wollen.</p>
<section id="einfaktorieller-barplot-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorieller-barplot-1">Einfaktorieller Barplot</h4>
<p>Der Code für die Erstellung wirkt etwas länger, das hat aber den Grund, dass ich noch einiges an Optionen ergänze. Ich möchte noch die Legende entfernen und dann noch die Variablen umbenennen. Dann kommt da immer was zusammen. Gerne lösche mal die ein oder andere Zeile um mehr zu verstehen was die Funktion macht. Viele Funktionen erklären sich ja vom Namen her von alleine. Die letzte Zeile mit <code>adjust_size(width = NA, height = NA)</code> brauche ich hier noch aktuell im meinem Skript und du kannst die weglassen oder eine andere Größe des Plots wählen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_mean_bar</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_sd_errorbar</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Flohart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"dog"</span> <span class="ot">=</span> <span class="st">"Hund"</span>, <span class="st">"cat"</span> <span class="ot">=</span> <span class="st">"Katze"</span>, <span class="st">"fox"</span> <span class="ot">=</span> <span class="st">"Fuchs"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_annotation_text</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>), <span class="at">fontsize =</span> <span class="dv">12</span>,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.1</span>, <span class="fl">2.1</span>, <span class="fl">3.1</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">8.5</span>, <span class="fl">5.1</span>, <span class="fl">9.5</span>))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-tidyplot-barplot-1fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyplot-barplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-tidyplot-barplot-1fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Abbildung&nbsp;18.11— Beispielhafter einfaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen. Ein beispielhaftes Compact letter display wurde noch ergänzt."><img src="eda-ggplot_files/figure-html/fig-tidyplot-barplot-1fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyplot-barplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.11— Beispielhafter einfaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen. Ein beispielhaftes <em>Compact letter display</em> wurde noch ergänzt.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweifaktorieller-barplot-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorieller-barplot-1">Zweifaktorieller Barplot</h4>
<p>Bei dem zweifaktoriellen Barplot habe ich noch die Beobachtungen etwas aus der Mitte geschoben und dann noch etwas ausgeblendet. Dann habe ich noch die Legende nach oben verlegt und auch hier die Variablen einmal in dem Plot umbenannt. Die letzte Zeile mit <code>adjust_size(width = NA, height = NA)</code> brauche ich hier noch aktuell im meinem Skript und du kannst die weglassen oder eine andere Größe des Plots wählen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac2_tbl, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">color =</span> sex) <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">dodge_width =</span> <span class="fl">1.2</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_mean_bar</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_sd_errorbar</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Flohart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_legend_title</span>(<span class="st">"Geschlecht"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_legend_position</span>(<span class="st">"top"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"dog"</span> <span class="ot">=</span> <span class="st">"Hund"</span>, <span class="st">"cat"</span> <span class="ot">=</span> <span class="st">"Katze"</span>, <span class="st">"fox"</span> <span class="ot">=</span> <span class="st">"Fuchs"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_color_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"männlich"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"weiblich"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_annotation_text</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>), <span class="at">fontsize =</span> <span class="dv">12</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.2</span>, <span class="fl">1.8</span>, <span class="fl">2.2</span>, <span class="fl">2.8</span>, <span class="fl">3.2</span>), </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">24</span>, <span class="dv">22</span>, <span class="dv">27</span>, <span class="dv">24</span>, <span class="dv">29</span>))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-tidyplot-barplot-2fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyplot-barplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-tidyplot-barplot-2fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Abbildung&nbsp;18.12— Beispielhafter zweifaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Geschlechtern der Flöhe mit mehr Optionen und angepassten Beschriftungen. Ein beispielhaftes Compact letter display wurde noch ergänzt"><img src="eda-ggplot_files/figure-html/fig-tidyplot-barplot-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyplot-barplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.12— Beispielhafter zweifaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Geschlechtern der Flöhe mit mehr Optionen und angepassten Beschriftungen. Ein beispielhaftes <em>Compact letter display</em> wurde noch ergänzt
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<p>Dann habe ich mich doch noch hingesetzt und einmal für dich die Videos gemacht, wie du dann einen Barplot oder eben ein Säulendigramm in Excel erstellst. Das ganze macht dann nur als Video Sinn, denn sonst kannst du ja nicht nachvollziehen, was ich geklickt habe.</p>
<p>Hier also erstmal die einfachere Variante mit dem 1-faktoriellen Barplot. Beginnen wollen wir wie immer mit der Berechnung der Mittelwerte und der Standardabweichung. Bitte nutze für die Standardabweichung die Funktion <code>STABW.S()</code> in Excel.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/UdZ5p8euo64" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Und im Anschluss nochmal das Video für den 2-faktoriellen Barplot. Du hast jetzt eben nicht nur eine Behandlungsgruppe vorliegen sondern zwei Behandlungsgruppen. Dann musst du etwas mehr Arbeit reinstecken um alle Mittelwerte und Standardabweichungen zu berechnen. Bitte nutze auch hier für die Standardabweichung die Funktion <code>STABW.S()</code> in Excel.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/mGSMZ6C7x4E" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div>
</div>
</div>
<p>Bei der Darstellung des Barplots haben wir die Wahl wie wir den Fehlerbalken darstellen. Dazu haben wir dann verschiedene Maßzahlen zu Auswahl. Theoretisch haben wir die freie Wahl zwischen der Standardabweichung und dem Standardfehler, aber es gibt Ausnahmen.</p>
<dl>
<dt>Standardabweichung (abk. <em>SD</em>) oder Standardfehler (abk. <em>SE</em>) als Fehlerbalken?</dt>
<dd>
<p>Wenn du etwas misst, was natürliche numerische Grenzen hat, wie zum Beispiel relative Anteile <span class="math inline">\([0,1]\)</span> oder aber etwas zählst <span class="math inline">\([0, \infty]\)</span>, dann empfiehlt sich der Standardfehler, da dieser nicht über die numerischen Grenzen geht. Die Standardabweichung kann hier negative Werte oder aber prozentuale Werte größer 1 oder kleiner 0 liefern. Das wollen wir nicht.</p>
</dd>
</dl>
<p>Schau dir auch hier mal in den Kästen zum Zerforschen rein, da findest du dann noch mehr Inspiration aus anderen Abbildungen, die ich nachgebaut habe. Ich bin einmal über den Campus gelaufen und habe geschaut, welche Abbildungen auf den Postern verwendet werden und habe diese nachgebaut.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Hinweis</span>Zerforschen: Einfaktorieller Barplot mit <em>compact letter display</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen einfaktoriellen Barplot oder Säulendiagramm anschauen. Daher fangen wir mit der folgenden Abbildung einmal an. Wir haben hier ein Säulendiagramm mit <em>Compact letter display</em> vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der vier Behandlungen jeweils einmal einen Mittelwert für die Höhe der Säule sowie einmal die Standardabweichung. Die Standardabweichung addieren und subtrahieren wir dann jeweils von dem Mittelwert und schon haben wir die Fehlerbalken.</p>
<div id="fig-ur-barplot" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_simple.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Abbildung&nbsp;18.13— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein simples Säulendiagramm mit sehr für Farbblinde ungünstigen Farben. Es sind die Mittelwerte sowie die Standardabweichung durch die Fehlerbalken dargestellt."><img src="images/eda/zerforschen_barplot_simple.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.13— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein simples Säulendiagramm mit sehr für Farbblinde ungünstigen Farben. Es sind die Mittelwerte sowie die Standardabweichung durch die Fehlerbalken dargestellt.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_simple.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die vier Werte alle um den Mittelwert streuen lassen. Dabei habe ich darauf geachtet, dass die Streuung dann in der letzten Behandlung am größten ist. Da wir beim Einlesen keine Umlaute oder sonstige Leerzeichen wollen, habe ich alles sehr simple aufgeschrieben und dann in R in der Funktion <code>factor()</code> richtig über die Option <code>levels</code> sortiert und über die Option <code>labels</code> sauber beschrieben. Dann passt auch die Sortierung der <span class="math inline">\(x\)</span>-Achse.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_simple.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">factor</span>(trt, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"water"</span>, <span class="st">"rqflex"</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"nitra"</span>, <span class="st">"laqua"</span>),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wasserdestilation"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"RQflex Nitra"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Nitrachek"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Laqua Nitrat"</span>)))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>barplot_tbl </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 2
   trt               nitrat
   &lt;fct&gt;              &lt;dbl&gt;
 1 Wasserdestilation    135
 2 Wasserdestilation    130
 3 Wasserdestilation    145
 4 Wasserdestilation    135
 5 RQflex Nitra         120
 6 RQflex Nitra         130
 7 RQflex Nitra         135
 8 RQflex Nitra         135
 9 Nitrachek            100
10 Nitrachek            120
11 Nitrachek            130
12 Nitrachek            130
13 Laqua Nitrat         230
14 Laqua Nitrat         210
15 Laqua Nitrat         205
16 Laqua Nitrat         220</code></pre>
</div>
</div>
<p>Jetzt brauchen wir noch die Mittelwerte und die Standardabweichung für jede der vier Behandlungen. Den Code kennst du schon von oben wo wir die Barplots für die Sprungweiten der Hunde- und Katzenflöhe gebaut haben. Hier habe ich dann den Code entsprechen der Daten <code>barplot_tbl</code> angepasst. Wir haben ja als Gruppierungsvariabel <code>trt</code> vorliegen und wollen die Mittelwerte und die Standardabweichung für die Variable <code>nitrat</code> berechnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>stat_tbl <span class="ot">&lt;-</span> barplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trt) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(nitrat),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(nitrat))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>stat_tbl</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  trt                mean    sd
  &lt;fct&gt;             &lt;dbl&gt; &lt;dbl&gt;
1 Wasserdestilation  136.  6.29
2 RQflex Nitra       130   7.07
3 Nitrachek          120  14.1 
4 Laqua Nitrat       216. 11.1 </code></pre>
</div>
</div>
<p>Und dann haben wir auch schon die <a href="#fig-ggplot-zerforschen-barplot-simple" class="quarto-xref">Abbildung&nbsp;<span>18.14</span></a> erstellt. Ja vielleicht passen die Standardabweichungen nicht so richtig, da könnte man nochmal an den Daten spielen und die Werte solange ändern, bis es besser passt. Du hast aber jetzt eine Idee, wie der Aufbau funktioniert.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-28"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-28-1"><a href="#annotated-cell-28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> mean,</span>
<span id="annotated-cell-28-2"><a href="#annotated-cell-28-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="annotated-cell-28-3"><a href="#annotated-cell-28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-28" data-target-annotation="1">1</button><span id="annotated-cell-28-4" class="code-annotation-target"><a href="#annotated-cell-28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-28" data-target-annotation="2">2</button><span id="annotated-cell-28-5" class="code-annotation-target"><a href="#annotated-cell-28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd),</span>
<span id="annotated-cell-28-6"><a href="#annotated-cell-28-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="annotated-cell-28-7"><a href="#annotated-cell-28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="annotated-cell-28-8"><a href="#annotated-cell-28-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-28-9"><a href="#annotated-cell-28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">250</span>) <span class="sc">+</span></span>
<span id="annotated-cell-28-10"><a href="#annotated-cell-28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-28" data-target-annotation="3">3</button><span id="annotated-cell-28-11" class="code-annotation-target"><a href="#annotated-cell-28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="annotated-cell-28-12"><a href="#annotated-cell-28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, </span>
<span id="annotated-cell-28-13"><a href="#annotated-cell-28-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.05</span>, <span class="fl">2.05</span>, <span class="fl">3.05</span>, <span class="fl">4.05</span>), </span>
<span id="annotated-cell-28-14"><a href="#annotated-cell-28-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> stat_tbl<span class="sc">$</span>mean <span class="sc">+</span> stat_tbl<span class="sc">$</span>sd <span class="sc">+</span> <span class="dv">8</span>, </span>
<span id="annotated-cell-28-15"><a href="#annotated-cell-28-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"c"</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-28" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-28" data-code-lines="4" data-code-annotation="1">Hier werden die Säulen des Säulendiagramms erstellt.</span>
</dd>
<dt data-target-cell="annotated-cell-28" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-28" data-code-lines="5,6" data-code-annotation="2">Hier werden die Fehlerbalken erstellt. Die Option <code>width</code> steuert wie breit die Fehlerbalken sind.</span>
</dd>
<dt data-target-cell="annotated-cell-28" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-28" data-code-lines="11" data-code-annotation="3">Hier wird eine Farbpalette für farbblinde Personen geladen.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-simple" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-simple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-simple-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Abbildung&nbsp;18.14— Die Abbildung des Säulendiagramms in ggplot nachgebaut."><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-simple-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-simple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.14— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_barplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Hinweis</span>Zerforschen: Zweifaktorieller Barplot mit <em>compact letter display</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen zweifaktoriellen Barplot oder Säulendiagramm anschauen. Wir haben hier ein Säulendiagramm mit <em>compact letter display</em> vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der vier Zeitpunkte und der Kontrolle jeweils einmal einen Mittelwert für die Höhe der Säule sowie einmal die Standardabweichung. Die Standardabweichung addieren und subtrahieren wir dann jeweils von dem Mittelwert und schon haben wir die Fehlerbalken.</p>
<div id="fig-ur-barplot-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_2fac.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Abbildung&nbsp;18.15— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit zwei Faktoren Zeit und die Iodine Form."><img src="images/eda/zerforschen_barplot_2fac.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.15— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit zwei Faktoren Zeit und die Iodine Form.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_2fac_target.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die drei Werte alle um den Mittelwert streuen lassen. Da wir beim Einlesen keine Umlaute oder sonstige Leerzeichen wollen, habe ich alles sehr simple aufgeschrieben und dann in R in der Funktion <code>factor()</code> richtig über die Option <code>levels</code> sortiert und über die Option <code>labels</code> sauber beschrieben. Dann passt auch die Sortierung der <span class="math inline">\(x\)</span>-Achse.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_2fac_target.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ctrl"</span>, <span class="st">"7"</span>, <span class="st">"11"</span>, <span class="st">"15"</span>, <span class="st">"19"</span>),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Contr."</span>, <span class="st">"07:00"</span>, <span class="st">"11:00"</span>, <span class="st">"15:00"</span>, <span class="st">"19:00"</span>)),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as_factor</span>(type))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>barplot_tbl </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 × 3
   time  type  iodine
   &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
 1 07:00 KIO3      50
 2 07:00 KIO3      55
 3 07:00 KIO3      60
 4 07:00 KI        97
 5 07:00 KI        90
 6 07:00 KI        83
 7 11:00 KIO3      73
 8 11:00 KIO3      75
 9 11:00 KIO3      78
10 11:00 KI       130
# ℹ 17 more rows</code></pre>
</div>
</div>
<p>Jetzt brauchen wir noch die Mittelwerte und die Standardabweichung für jede der vier Behandlungen. Hier nur kurz, den Code kennst du schon aus anderen Zerforschenbeispielen zu den Barplots.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>stat_tbl <span class="ot">&lt;-</span> barplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, type) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(iodine),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(iodine))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>stat_tbl</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
# Groups:   time [5]
  time   type   mean    sd
  &lt;fct&gt;  &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Contr. KIO3    5    3   
2 07:00  KIO3   55    5   
3 07:00  KI     90    7   
4 11:00  KIO3   75.3  2.52
5 11:00  KI    150   20   
6 15:00  KIO3   80    7   
7 15:00  KI    130   20   
8 19:00  KIO3   90.3 19.5 
9 19:00  KI     95    6   </code></pre>
</div>
</div>
<p>Und dann geht es auch schon los. Wir müssen am Anfang einmal <code>scale_x_discrete()</code> setzen, damit wir gleich den Zielbereich ganz hinten zeichnen können. Sonst ist der blaue Bereich im Vordergrund. Dann färben wir auch mal die Balken anders ein. Muss ja auch mal sein. Auch nutzen wir die Funktion <code>geom_text()</code> um das <em>compact letter display</em> gut zu setzten. Die <span class="math inline">\(y\)</span>-Position berechnet sich aus dem Mittelwert plus Standardabweichung innerhalb des <code>geom_text()</code>. Leider haben wir nur einen Balken bei der Kontrolle, deshalb hier nachträglich der Buchstabe mit <code>annotate()</code>. Ich habe mich dann noch entschieden neben dem Barplot noch den Boxplot als Alternative zu erstellen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Barplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Boxplot</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Einmal der Barplot wie beschrieben. Am besten löscht du immer mal wieder eine Zeile Code damit du nachvollziehen kannst, was die Zeile Code in der Abbildung macht. Vergleiche auch einmal diese Abbildung der Barplots mit der Abbildung der Boxplots und überlege, welche der beiden Abbildungen dir mehr Informationen liefert.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> mean,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">5.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">75</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>) <span class="sc">+</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"b"</span>, <span class="st">"bc"</span>, <span class="st">"bc"</span>, <span class="st">"d"</span>, <span class="st">"bc"</span>, <span class="st">"d"</span>, <span class="st">"bc"</span>, <span class="st">"c"</span>), </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> mean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">2</span>),  </span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.77</span>, <span class="at">y =</span> <span class="dv">15</span>, <span class="at">label =</span> <span class="st">"a"</span>) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-target" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-target-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Abbildung&nbsp;18.16— Die Abbildung des Säulendiagramms in ggplot nachgebaut. Wir nutzen das geom_text() um noch besser unser compact letter display zu setzen."><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-target-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.16— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Für die Boxplost brauchen wir dann noch ein Objekt mehr. Um das <em>compacte letter dislay</em> an die richtige Position zu setzen brauchen wir noch eine <span class="math inline">\(y\)</span>-Position. Ich nehme hier dann das 90% Quantile. Das 90% Quantile sollte dann auf jeden Fall über die Schnurrhaare raus reichen. Wir nutzen dann den Datensatz <code>letter_pos_tbl</code> in dem <code>geom_text()</code> um die Buchstaben richtig zu setzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>letter_pos_tbl <span class="ot">&lt;-</span> barplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, type) <span class="sc">|&gt;</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">quant_90 =</span> <span class="fu">quantile</span>(iodine, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.90</span>)))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>letter_pos_tbl</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
# Groups:   time [5]
  time   type  quant_90
  &lt;fct&gt;  &lt;fct&gt;    &lt;dbl&gt;
1 Contr. KIO3       7.4
2 07:00  KIO3      59  
3 07:00  KI        95.6
4 11:00  KIO3      77.4
5 11:00  KI       166  
6 15:00  KIO3      85.6
7 15:00  KI       146  
8 19:00  KIO3     106  
9 19:00  KI        99.8</code></pre>
</div>
</div>
<p>Und dann müssen wir nur noch das <code>geom_bar()</code> und <code>geom_errorbar()</code> entfernen und durch das <code>geom_boxplot()</code> ersetzen. Dann haben wir auch schon unsere wunderbaren Boxplots. Das Problem sind natürlich die wenigen Beobachtungen, deshalb sehen die Boxplots teilweise etwas wild aus. Beachte auch das wir die Orginaldaten nutzen und nicht die zusammengefassten Daten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barplot_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> iodine,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">5.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">75</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>) <span class="sc">+</span> </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letter_pos_tbl, </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"b"</span>, <span class="st">"bc"</span>, <span class="st">"bc"</span>, <span class="st">"d"</span>, <span class="st">"bc"</span>, <span class="st">"d"</span>, <span class="st">"bc"</span>, <span class="st">"c"</span>), </span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> quant_90 <span class="sc">+</span> <span class="dv">5</span>),  </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.77</span>, <span class="at">y =</span> <span class="dv">15</span>, <span class="at">label =</span> <span class="st">"a"</span>) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-target-box" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-target-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-box-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Abbildung&nbsp;18.17— Die Abbildung des Säulendiagramms in ggplot als Boxplot nachgebaut. Wir nutzen das geom_text() um noch besser unser compact letter display zu setzen, dafür müssen wir usn aber nochmal ein Positionsdatensatz bauen."><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-box-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-target-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.17— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen, dafür müssen wir usn aber nochmal ein Positionsdatensatz bauen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_barplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Hinweis</span>Zerforschen: Zweifaktorieller, gekippter Barplot mit Zielbereich
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen zweifaktoriellen Barplot oder Balkendiagramm anschauen. Wir haben hier ein echtes Balkendiagramm mit <em>compact letter display</em> vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der vier Zeitpunkte und der Kontrolle jeweils einmal einen Mittelwert für die Länge des Balkens sowie einmal die Standardabweichung. Die Standardabweichung addieren und subtrahieren wir dann jeweils von dem Mittelwert und schon haben wir die Fehlerbalken. Ich habe hier dann jeweils drei Werte für jede Faktorkombination. Die brauche ich dann auch, weil ich später nochmal vergleichend den Boxplot erstellen möchte. Der macht meiner Ansicht nach hier mehr Sinn.</p>
<div id="fig-ur-barplot-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_complex_02.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Abbildung&nbsp;18.18— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein zweifaktorielles Balkendiagramm mit einem Zielbereich und compact letter display"><img src="images/eda/zerforschen_barplot_complex_02.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.18— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein zweifaktorielles Balkendiagramm mit einem Zielbereich und <em>compact letter display</em>
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir wieder die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_2fac.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die drei Werte alle um den Mittelwert streuen lassen. Das war es dann auch schon.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_2fac_flipped.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iod =</span> <span class="fu">fct_rev</span>(iod),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">fruit =</span> <span class="fu">fct_rev</span>(fruit))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>barplot_tbl</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   iod   fruit iod_yield
   &lt;fct&gt; &lt;fct&gt;     &lt;dbl&gt;
 1 KI    65-75        85
 2 KI    65-75       100
 3 KI    65-75        75
 4 KI    75-80        52
 5 KI    75-80        70
 6 KI    75-80        30
 7 KIO3  65-75        55
 8 KIO3  65-75        48
 9 KIO3  65-75        60
10 KIO3  75-80        45
11 KIO3  75-80        53
12 KIO3  75-80        38</code></pre>
</div>
</div>
<p>Jetzt brauchen wir noch die Mittelwerte und die Standardabweichung für jede der vier Behandlungen. Hier nur kurz, den Code kennst du schon aus anderen Zerforschenbeispielen zu den Barplots.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>stat_tbl <span class="ot">&lt;-</span> barplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(iod, fruit) <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(iod_yield),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(iod_yield))</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>stat_tbl</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
# Groups:   iod [2]
  iod   fruit  mean    sd
  &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;
1 KIO3  75-80  45.3  7.51
2 KIO3  65-75  54.3  6.03
3 KI    75-80  50.7 20.0 
4 KI    65-75  86.7 12.6 </code></pre>
</div>
</div>
<p>Im Folgenden stelle ich die zusammengefassten Daten <code>stat_tbl</code> als Balkendiagramm dar. Die ursprünglichen Daten <code>barplot_tbl</code> kann ich nutzen um die Boxplots zu erstellen. Hier ist wichtig nochmal zu erinnern, das wir Barplots auf dem Mittelwert und der Standardabweichung darstellen und die Boxplots auf den Originaldaten. Mit der unteren Grenze machen Boxplots mehr Sinn, wenn du wissen willst, ob du einen Zielbereich vollkommen erreicht hast.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Barplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Boxplot</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Zuerst einmal der Barplot, wie wir ihn auch schon oben in der Abbildung sehen. Wir nutzen hier zum einen die Funktion <code>coord_flip()</code> um ganz zum Schluss die Abbildung zu drehen. Deshalb musst du aufpassen, denn vor dem Flippen ist ja alles auf der <span class="math inline">\(y\)</span>-Achse die <span class="math inline">\(y\)</span>-Achse und umgekehrt. Deshalb müssen wir dann auch teilweise die Ordnung der Level in den einzelnen Faktoren drehen, damit wir wieder die richtige Reihenfolge <em>nach</em> dem Flip haben. Wir müssen ganz am Anfang einmal <code>scale_x_discrete()</code> setzen, damit wir den Zielbereich als erstes einzeichnen können. Sonst ist der Zielbereich nicht ganz hinten in der Abbildung und überdeckt die Balken. Deshalb ist das Wort “Zielbereich” auch recht weit hinten im Code, damit es eben im Vordergrund ist. Sonst ist eigentlich vieles gleich. Wir nutzen hier einmal das R Paket <code>latex2exp</code> für die Erstellung der mathematischen Formeln.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> iod, <span class="at">y =</span> mean,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> fruit)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">3</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> cbbPalette[<span class="dv">6</span>]) <span class="sc">+</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Iodform"</span>,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span><span class="fu">TeX</span>(r<span class="st">"(Iodgehalt $[\mu g\, l\, (100g\, FM)^{-1}]$)"</span>)) <span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>(<span class="at">name =</span> <span class="st">"Frucht-</span><span class="sc">\n</span><span class="st">größe [mm]"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">'65-75'</span>, <span class="st">'75-80'</span>)) <span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.2</span>),</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>),</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">75</span>, <span class="at">label =</span> <span class="st">"Zielbereich"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.25</span>, <span class="fl">1.8</span>, <span class="fl">2.25</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">62</span>, <span class="dv">72</span>, <span class="dv">102</span>),</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>)) <span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-flipped" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-flipped-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-flipped-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Abbildung&nbsp;18.19— Die Abbildung des Balkendiagramms in ggplot nachgebaut. Ein extra Zielbereich ist definiert sowie die Legende in die Abbildung integriert."><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-flipped-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-flipped-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.19— Die Abbildung des Balkendiagramms in <code>ggplot</code> nachgebaut. Ein extra Zielbereich ist definiert sowie die Legende in die Abbildung integriert.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Für die Boxplots müssen wir gar nicht viel tun. Wir müssen nur noch das <code>geom_bar()</code> und <code>geom_errorbar()</code> entfernen und durch das <code>geom_boxplot()</code> ersetzen. Dann haben wir auch schon unsere wunderbaren Boxplots. Das Problem sind natürlich die wenigen Beobachtungen, deshalb sehen die Boxplots teilweise etwas wild aus. Beachte auch das wir die Orginaldaten nutzen und nicht die zusammengefassten Daten. Am Ende machen Boxplots mit einer unteren Grenze mehr Sinn, wenn wir uns Fragen, ob wir einen Zielbereich erreicht haben. Da sind dann doch Balkendiagramme etwas ungeeignet.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barplot_tbl, <span class="fu">aes</span>(<span class="at">x =</span> iod, <span class="at">y =</span> iod_yield,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> fruit)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Iodform"</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span><span class="fu">TeX</span>(r<span class="st">"(Iodgehalt $[\mu g\, l\, (100g\, FM)^{-1}]$)"</span>)) <span class="sc">+</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>(<span class="at">name =</span> <span class="st">"Frucht-</span><span class="sc">\n</span><span class="st">größe [mm]"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">'65-75'</span>, <span class="st">'75-80'</span>)) <span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.2</span>),</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>),</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">3</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> cbbPalette[<span class="dv">6</span>]) <span class="sc">+</span> </span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">75</span>, <span class="at">label =</span> <span class="st">"Zielbereich"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.25</span>, <span class="fl">1.8</span>, <span class="fl">2.25</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">62</span>, <span class="dv">72</span>, <span class="dv">102</span>),</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>)) <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-flipped-box" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-flipped-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-flipped-box-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Abbildung&nbsp;18.20— Die Abbildung des Balkendiagramms in ggplot nachgebaut. Durch den Boxplot erhalten wir auch untere Grenzen, was bei der Frage, ob wir in einem Zielbereich sind, viel sinnvoller ist, als ein Balkendiagramm. Eine höhere Fallzahl als n=3 würde die Boxplots schöner machen."><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-flipped-box-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-flipped-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.20— Die Abbildung des Balkendiagramms in <code>ggplot</code> nachgebaut. Durch den Boxplot erhalten wir auch untere Grenzen, was bei der Frage, ob wir in einem Zielbereich sind, viel sinnvoller ist, als ein Balkendiagramm. Eine höhere Fallzahl als <span class="math inline">\(n=3\)</span> würde die Boxplots schöner machen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-eda-boxplot" class="level3" data-number="18.4.2">
<h3 data-number="18.4.2" class="anchored" data-anchor-id="sec-eda-boxplot"><span class="header-section-number">18.4.2</span> Boxplot</h3>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/qgKBaBuM1n0" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Mit dem Boxplot können wir den Median und die Quartile visualisieren. Im Folgenden unterscheide ich dann einmal die theoretische Betrachtung des Boxplots sowie die händische Darstellung für unsere Flohdaten als Beispiel. Dann implementieren wir den Boxplot für die Sprungweiten der Hunde- und Katzenflöhe noch einmal abschließend in <code>{ggplot}</code>. Im Folgenden siehst du im ersten Tab einen Boxplot, der den Median und die Quartile eines beliebigen Datensatzes visualisiert.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false" href=""><code>{ggplot}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false" href=""><code>{tidyplots}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Die Box wird aus dem Interquartilesabstand (abk . <em>IQR</em>) gebildet. Der Median wird als Strich in der Box gezeigt. Die Schnurrhaare (eng. <em>Whiskers</em>) sind das 1.5-fache des IQR, wenn nicht das Minimum der Beobachtungen oder das Maximum jeweils größer oder kleiner ist. Punkte die außerhalb der Whiskers liegen werden als einzelne Punkte dargestellt. Diese einzelnen Punkte werden auch als Ausreißer (eng. <em>Outlier</em>) bezeichnet. Ob es sich nun wirklich um Ausreißer handelt, muss biologisch geklärt werden.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-drawn" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-drawn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-boxplot-drawn-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Abbildung&nbsp;18.21— Liegender Boxplot zu Visualisierung der statistischen Maßzahlen Median und Quartile. Die Box wird aus dem Interquartilesabstand (abk . IQR) gebildet, welches die Distanz zwischen den 1^{st} und 3^{rd} Quartile entspricht. Der Median wird als Strich in der Box gezeigt. Die Whiskers sind das 1.5-fache des IQR, wenn das Minimum der Werte nicht größer oder das Maximum der Werte nicht kleiner ist. Punkte die außerhalb der Whiskers liegen werden als einzelne Punkte dargestellt. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-boxplot-drawn-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-drawn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.21— Liegender Boxplot zu Visualisierung der statistischen Maßzahlen Median und Quartile. Die Box wird aus dem Interquartilesabstand (abk . <em>IQR</em>) gebildet, welches die Distanz zwischen den <span class="math inline">\(1^{st}\)</span> und <span class="math inline">\(3^{rd}\)</span> Quartile entspricht. Der Median wird als Strich in der Box gezeigt. Die Whiskers sind das 1.5-fache des IQR, wenn das Minimum der Werte nicht größer oder das Maximum der Werte nicht kleiner ist. Punkte die außerhalb der Whiskers liegen werden als einzelne Punkte dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Jetzt können wir einmal händisch den Boxplot für die Hundeflöhe und der Sprungweite zeichnen. Ich habe dafür dann einmal die Werte für das <span class="math inline">\(1^{st}\)</span> und <span class="math inline">\(3^{rd}\)</span> Quartile mit jeweils 5.7 und 9.1 bestimmt. Der Median der Sprungweite der Hundeflöhe liegt bei 8.2 und der Interquartilesabstand (abk . <em>IQR</em>) ist 3.4, wie du in der nicht maßstabsgetreuen Abbildung sehen kannst. Die Länge der Whisker berechne ich einmal mit <span class="math inline">\(1^{st} - 1.5 \times IQR = 0.6\)</span> sowie <span class="math inline">\(3^{rd} + 1.5 \times IQR = 14.2\)</span> und vergleiche die beiden Werte mit dem Minimum von 5.7 und 11.8 der Sprungweite. In beiden Fällen entscheide ich mich dann für die Minimum und Maximum-Werte.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-drawn-dog-flea" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-drawn-dog-flea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-boxplot-drawn-dog-flea-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Abbildung&nbsp;18.22— Liegender Boxplot zu Visualisierung der Sprungweite der Hundeflöhe. Die Abbildung ist nicht maßstabsgetreu. Die Box wird aus dem Interquartilesabstand (abk . IQR) gebildet, welches die Distanz zwischen den 1^{st} und 3^{rd} Quartile entspricht. Es liegen keine Ausreißer in den Daten vor. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-boxplot-drawn-dog-flea-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-drawn-dog-flea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.22— Liegender Boxplot zu Visualisierung der Sprungweite der Hundeflöhe. Die Abbildung ist nicht maßstabsgetreu. Die Box wird aus dem Interquartilesabstand (abk . <em>IQR</em>) gebildet, welches die Distanz zwischen den <span class="math inline">\(1^{st}\)</span> und <span class="math inline">\(3^{rd}\)</span> Quartile entspricht. Es liegen keine Ausreißer in den Daten vor. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Auch wenn die Abbildung nicht maßstabsgetreu ist, können wir abschätzen, dass unsere Sprungweiten der Hundeflöhe in etwa normalverteilt sind, da der Median in etwa in der Mitte der Box liegt. Darüber hinaus sind auch die Whiskers in etwa gleich lang. Ja, in der Statistik ist vieles eine Abschätzung.</p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Jetzt kommt die Kür, wie erstellen wir einen Boxplot in R mit dem R Paket <code>{ggplot}</code>? Dafür schauen wir uns erstmal an, wie ein Boxplot aussehen würde. Im Folgenden siehst du einmal die Abbildung eines liegenden Boxplot der Hundeflöhe und deren Sprungweiten erstellt in <code>{ggplot}</code>. Wir du erkennen kannst, gibt es da kaum einen Unterschied zu der händischen Darstellung.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-flea-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-flea-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-boxplot-flea-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Abbildung&nbsp;18.23— Liegender Boxplot zu Visualisierung der Sprungweite der Hundeflöhe. Die Linien entsprechen den jeweiligen gemessenen Sprungweiten. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-boxplot-flea-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-flea-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.23— Liegender Boxplot zu Visualisierung der Sprungweite der Hundeflöhe. Die Linien entsprechen den jeweiligen gemessenen Sprungweiten. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Nun ist ein liegender Boxplot eher ungewöhnlich in der Darstellung. Zum zeichnen und verstehen macht das schon Sinn, aber wenn wir später dann mit dem Boxplot arbeiten, dann nutzen wir die stehende Varaiante.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-flea-0" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-flea-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-boxplot-flea-0-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Abbildung&nbsp;18.24— Stehender Boxplot zu Visualisierung der Sprungweite der Hundeflöhe. Die Linien entsprechen den jeweiligen gemessenen Sprungweiten. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-boxplot-flea-0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="192"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-flea-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.24— Stehender Boxplot zu Visualisierung der Sprungweite der Hundeflöhe. Die Linien entsprechen den jeweiligen gemessenen Sprungweiten. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir schauen uns hier einmal in <code>{ggplot}</code> den einfaktoriellen sowie zweifaktoriellen Boxplot an. Wenn wir von einem einfaktoriellen Boxplot sprechen, dann haben wir nur eine Gruppe auf der x-Achse vorliegen. Wenn wir einen zweifaktoriellen Boxplot bauen wollen, dann brauchen wir noch einen zweiten Gruppenfaktor für die Legende. Häufig nutze wir Boxplots um Gruppen, wie hier die Tierarten, miteinander zu vergleichen. In den folgenden Abbildungen sind daher die Boxplots für die Sprungweite in [cm] der Hunde- und Katzen- und Fuchsflöhe dargestellt.</p>
<p>Wir erkennen auf einen Blick, dass die Sprungweite von den Hundeflöhen weiter ist als die Sprungweite der Katzenflöhe und die Fuchsflöhe am weitesten springen. Im Weiteren können wir abschätzen, dass die Streuung etwa gleich groß ist, bei den Füchsen eventuell etwas weniger. Die Boxen sind in etwa gleich groß und die Whiskers in etwa gleich lang. Dann können wir auch die Boxplots komplexer darstellen indem wir eben noch einen zweiten Faktor mit in die Darstellung aufnehmen. Hier schauen wir uns dann zwei Messorte mit an.</p>
<section id="einfaktorieller-boxplot" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorieller-boxplot">Einfaktorieller Boxplot</h4>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-posthoc-boxplot-1fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-posthoc-boxplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-posthoc-boxplot-1fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Abbildung&nbsp;18.25— Beispielhafter einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten. Die Raute zeigt den Mittelwert in den entsprechenden Gruppen an."><img src="eda-ggplot_files/figure-html/fig-ggplot-posthoc-boxplot-1fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-posthoc-boxplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.25— Beispielhafter einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten. Die Raute zeigt den Mittelwert in den entsprechenden Gruppen an.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweifaktorieller-boxplot" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorieller-boxplot">Zweifaktorieller Boxplot</h4>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac2_tbl, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> sex, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="fu">aes</span>(<span class="at">group =</span> animal), </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">fill =</span> <span class="st">"Tierart"</span>) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-posthoc-boxplot-2fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-posthoc-boxplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-posthoc-boxplot-2fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="Abbildung&nbsp;18.26— Beispielhafter zweifaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Geschlchtern. Die Raute zeigt den Mittelwert in den entsprechenden Fakorkombinationen an."><img src="eda-ggplot_files/figure-html/fig-ggplot-posthoc-boxplot-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-posthoc-boxplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.26— Beispielhafter zweifaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Geschlchtern. Die Raute zeigt den Mittelwert in den entsprechenden Fakorkombinationen an.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<p>Wie auch schon bei den Barplots überzeigt <code>{tidyplots}</code> eben dann durch die relativ einfach Zuweisung von Layern mit wichtigen Informationen. Hier haben wir dann zwar bei den Boxplots nicht so viele Vorteile, die Verwendung in <code>{ggplot}</code> ist nicht so kompliziert. In den <code>{tidyplots}</code> ist es dann aber einfacher den Mittelwert der Gruppen als Punkt zuzufügen. Den Rest fand ich dann nicht so unterschiedlich zu <code>{ggplot}</code>. Schön sehen die Abbildungen dann aber doch aus.</p>
<section id="einfaktorieller-boxplot-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorieller-boxplot-1">Einfaktorieller Boxplot</h4>
<p>Hier haben wir dann einmal die einfaktoriellen Boxplots zusammen mit dem Mittelwert der Grupen als Raute dargestellt. Simpel und einfach erstellt. Der Rest des Codes dient eben dazu die Abbildung dann noch schöner zu machen. Die letzte Zeile mit <code>adjust_size(width = NA, height = NA)</code> brauche ich hier noch aktuell im meinem Skript und du kannst die weglassen oder eine andere Größe des Plost wählen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>(<span class="at">dodge_width =</span> <span class="fl">0.5</span>, <span class="at">preserve =</span> <span class="st">"single"</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">box_width =</span> <span class="fl">0.3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_mean_dot</span>(<span class="at">fill =</span> <span class="st">"gray50"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Flohart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"dog"</span> <span class="ot">=</span> <span class="st">"Hund"</span>, <span class="st">"cat"</span> <span class="ot">=</span> <span class="st">"Katze"</span>, <span class="st">"fox"</span> <span class="ot">=</span> <span class="st">"Fuchs"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-tidyplot-boxplot-1fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyplot-boxplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-tidyplot-boxplot-1fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Abbildung&nbsp;18.27— Beispielhafter einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen."><img src="eda-ggplot_files/figure-html/fig-tidyplot-boxplot-1fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyplot-boxplot-1fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.27— Beispielhafter einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweifaktorieller-boxplot-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorieller-boxplot-1">Zweifaktorieller Boxplot</h4>
<p>Auch der zweifaktorielle Fall lässt sich sehr gut abbilden und auch schnell erstellen. Wir haben hier kaum einen Unterschied zu dem Code des einfaktoriellen Boxplots. Wir müssen hier nur die Option <code>color</code> ergänzen und dann schauen, dass wir die Punkte etwas schieben, da wir hier doch sehr viele Beobachtungen vorliegen haben. Die letzte Zeile mit <code>adjust_size(width = NA, height = NA)</code> brauche ich hier noch aktuell im meinem Skript und du kannst die weglassen oder eine andere Größe des Plost wählen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac2_tbl, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">color =</span> sex) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>(<span class="at">dodge_width =</span> <span class="fl">0.4</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">|&gt;</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">box_width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_mean_dot</span>(<span class="at">fill =</span> <span class="st">"gray50"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Flohart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_legend_title</span>(<span class="st">"Geschlecht"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_legend_position</span>(<span class="st">"top"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"dog"</span> <span class="ot">=</span> <span class="st">"Hund"</span>, <span class="st">"cat"</span> <span class="ot">=</span> <span class="st">"Katze"</span>, <span class="st">"fox"</span> <span class="ot">=</span> <span class="st">"Fuchs"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_color_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"male"</span> <span class="ot">=</span> <span class="st">"männlich"</span>, <span class="st">"female"</span> <span class="ot">=</span> <span class="st">"weiblich"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-tidyplot-boxplot-2fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyplot-boxplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-tidyplot-boxplot-2fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Abbildung&nbsp;18.28— Beispielhafter zweifaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Geschlechtern der Flöhe mit mehr Optionen und angepassten Beschriftungen."><img src="eda-ggplot_files/figure-html/fig-tidyplot-boxplot-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyplot-boxplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.28— Beispielhafter zweifaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten und den beiden Geschlechtern der Flöhe mit mehr Optionen und angepassten Beschriftungen.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</div>
</div>
</div>
<p>Der Boxplot erlaubt uns auch abzuschätzen, ob wir eine Normalverteilung vorliegen haben oder aber ob die Varianz in zwei oder. mehr Gruppen annähernd ist. Wir sprechen dann von Varianzhomogenität.</p>
<dl>
<dt>Abschätzung der Normalverteilung</dt>
<dd>
<p>Der Median liegt in der Mitte der Box und die Whiskers sind ungefähr gleich lang. Wir können von einer approximativen Normalverteilung ausgehen.</p>
</dd>
<dt>Abschätzung der Varianzhomogenität</dt>
<dd>
<p>Die Boxen sind über alle Gruppen ungefähr gleich groß und auch die Whiskers haben in etwa die gleiche Länge. Wir können dann von einer Varianzhomogenität über die Gruppen ausgehen.</p>
</dd>
</dl>
<p>Schau dir auch hier mal in den Kästen zum Zerforschen rein, da findest du dann noch mehr Inspiration aus anderen Abbildungen, die ich nachgebaut habe. Ich bin einmal über den Campus gelaufen und habe geschaut, welche Abbildungen auf den Postern verwendet werden und habe diese nachgebaut.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Hinweis</span>Zerforschen: Zweifaktorieller Barplot oder Boxplot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen zweifaktoriellen Barplot oder Säulendiagramm anschauen. Wir haben hier ein Säulendiagramm mit den Mittelwerten über den Faktor auf der <span class="math inline">\(x\)</span>-Achse vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der drei Fruchtgrößen jeweils einmal einen Mittelwert für die Höhe der Säule sowie einmal die Standardabweichung für die vier Stickstoffangebote. Das addiert sich dann auf, aber es geht noch. Die Standardabweichung addieren und subtrahieren wir dann später jeweils von dem Mittelwert und schon haben wir die Fehlerbalken. Da ich auch hier einmal als Alternative die Boxplots erstellen will, brauche ich hier mehr Werte aus denen ich dann die Mittelwerte und die Standardabweichung berechne.</p>
<div id="fig-ur-barplot-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_complex_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29" title="Abbildung&nbsp;18.29— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein zweifaktorieller Barplot mit Mittelwerten über dem Faktor auf der x-Achse."><img src="images/eda/zerforschen_barplot_complex_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.29— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein zweifaktorieller Barplot mit Mittelwerten über dem Faktor auf der <span class="math inline">\(x\)</span>-Achse.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir wieder die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_2fac.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die drei Werte alle um den Mittelwert streuen lassen. Das war es dann auch schon.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_2fac.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">frucht =</span> <span class="fu">factor</span>(frucht, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"klein"</span>, <span class="st">"mittel"</span>, <span class="st">"groß"</span>),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Klein"</span>, <span class="st">"Mittel"</span>, <span class="st">"Groß"</span>)),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">nmin =</span> <span class="fu">as_factor</span>(nmin))</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>barplot_tbl </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 3
   frucht nmin  yield
   &lt;fct&gt;  &lt;fct&gt; &lt;dbl&gt;
 1 Klein  150     1.5
 2 Klein  150     2.2
 3 Klein  150     2.8
 4 Klein  200     2.4
 5 Klein  200     1.9
 6 Klein  200     2.9
 7 Klein  250     3.7
 8 Klein  250     3.9
 9 Klein  250     3.5
10 Klein  300     2.5
# ℹ 26 more rows</code></pre>
</div>
</div>
<p>Jetzt brauchen wir noch die Mittelwerte und die Standardabweichung für jede der drei Fruchtgrößen und Stickstoffangebote. Hier nur kurz, den Code kennst du schon aus anderen Zerforschenbeispielen zu den Barplots. Das ist soweit erstmal nichts besonderes und ähnelt auch der Erstellung der anderen Barplots.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>stat_all_tbl <span class="ot">&lt;-</span> barplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(frucht, nmin) <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(yield),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(yield))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>stat_all_tbl</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
# Groups:   frucht [3]
   frucht nmin   mean    sd
   &lt;fct&gt;  &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Klein  150    2.17 0.651
 2 Klein  200    2.4  0.5  
 3 Klein  250    3.7  0.2  
 4 Klein  300    2.5  0.4  
 5 Mittel 150    5.03 1.05 
 6 Mittel 200    7.03 0.252
 7 Mittel 250    8    0.200
 8 Mittel 300    7.7  0.200
 9 Groß   150    6.1  1.95 
10 Groß   200    8.27 0.702
11 Groß   250    9.07 1.00 
12 Groß   300    8.97 1.00 </code></pre>
</div>
</div>
<p>Weil wir dann noch die globalen Mittelwerte der Früchte über alle Stickstofflevel wollen, müssen wir nochmal die Mittelwerte und die Standardabweichung nur für die drei Fruchtgrößen berechnen. Daher haben wir dann <em>zwei</em> Datensätze, die uns eine Zusammenfassung der Daten liefern.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>stat_fruit_tbl <span class="ot">&lt;-</span> barplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(frucht) <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(yield))</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>stat_fruit_tbl</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  frucht  mean
  &lt;fct&gt;  &lt;dbl&gt;
1 Klein   2.69
2 Mittel  6.94
3 Groß    8.1 </code></pre>
</div>
</div>
<p>Auch hier möchte ich einmal den Barplot nachbauen und dann als Alternative noch den Barplot anbieten. Am nervigsten war der Zeilenumbruch in der Legendenbeschriftung mit N<span class="math inline">\(_min\)</span>. Es hat echt gedauert, bis ich die Funktion <code>atop()</code> gefunden hatte, die in einer <code>expression()</code> einen Zeilenumbruch erzwingt. Meine Güte war das langwierig. Der Rest ist eigentlich wie schon in den anderen Beispielen. Da schaue dann doch nochmal da mit rein.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">Barplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Boxplot</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Einmal der Barplot wie beschrieben. Vergleiche auch einmal diese Abbildung der Barplots mit der Abbildung der Boxplots in dem anderem Tab und überlege, welche der beiden Abbildungen dir mehr Informationen liefert.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_all_tbl, <span class="fu">aes</span>(<span class="at">x =</span> frucht, <span class="at">y =</span> mean,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">fill =</span> nmin)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fruchtgröße zum Erntezeitpunkt"</span>, </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">atop</span>(<span class="st">"Gesamtfruchtertrag"</span>, <span class="st">"["</span><span class="sc">*</span>kg<span class="sc">~</span>FM<span class="sc">~</span>m<span class="sc">^</span><span class="st">"-2"</span><span class="sc">*</span><span class="st">"]"</span>)),</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">expression</span>(<span class="fu">atop</span>(N[min]<span class="sc">~</span><span class="st">"Angebot"</span>, <span class="st">"["</span><span class="sc">*</span>kg<span class="sc">~</span>N<span class="sc">~</span>ha<span class="sc">^</span><span class="st">"-1"</span><span class="sc">*</span><span class="st">"]"</span>))) <span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>),</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>),</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="fl">1.45</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">3</span>),</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(y)<span class="sc">*</span><span class="st">" = "</span><span class="sc">*</span><span class="fl">2.7</span>),</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">expression</span>(<span class="fu">bar</span>(y)<span class="sc">*</span><span class="st">" = "</span><span class="sc">*</span><span class="fl">6.9</span>),</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">expression</span>(<span class="fu">bar</span>(y)<span class="sc">*</span><span class="st">" = "</span><span class="sc">*</span><span class="fl">8.1</span>),</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"SD"</span>))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Abbildung&nbsp;18.30— Die Abbildung des Säulendiagramms in ggplot nachgebaut."><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.30— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Für die Boxplots müssen wir gar nicht viel tun. Wir müssen nur noch das <code>geom_bar()</code> und <code>geom_errorbar()</code> entfernen und durch das <code>geom_boxplot()</code> ersetzen. Dann haben wir auch schon unsere wunderbaren Boxplots. Das Problem sind natürlich die wenigen Beobachtungen, deshalb sehen die Boxplots teilweise etwas wild aus. Beachte auch das wir die Orginaldaten nutzen und nicht die zusammengefassten Daten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barplot_tbl, <span class="fu">aes</span>(<span class="at">x =</span> frucht, <span class="at">y =</span> yield,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> nmin)) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fruchtgröße zum Erntezeitpunkt"</span>, </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">atop</span>(<span class="st">"Gesamtfruchtertrag"</span>, <span class="st">"["</span><span class="sc">*</span>kg<span class="sc">~</span>FM<span class="sc">~</span>m<span class="sc">^</span><span class="st">"-2"</span><span class="sc">*</span><span class="st">"]"</span>)),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">expression</span>(<span class="fu">atop</span>(N[min]<span class="sc">~</span><span class="st">"Angebot"</span>, <span class="st">"["</span><span class="sc">*</span>kg<span class="sc">~</span>N<span class="sc">~</span>ha<span class="sc">^</span><span class="st">"-1"</span><span class="sc">*</span><span class="st">"]"</span>))) <span class="sc">+</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>),</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>),</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">11</span>),</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(y)<span class="sc">*</span><span class="st">" = "</span><span class="sc">*</span><span class="fl">2.7</span>),</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">expression</span>(<span class="fu">bar</span>(y)<span class="sc">*</span><span class="st">" = "</span><span class="sc">*</span><span class="fl">6.9</span>),</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">expression</span>(<span class="fu">bar</span>(y)<span class="sc">*</span><span class="st">" = "</span><span class="sc">*</span><span class="fl">8.1</span>)))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-box" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-box-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Abbildung&nbsp;18.31— Die Abbildung des Säulendiagramms in ggplot als Boxplot nachgebaut."><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-box-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.31— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_barplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Hinweis</span>Zerforschen: Boxplot für mehrere Outcomes
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Hier wollen wir einmal eine etwas größere <a href="stat-tests-posthoc2.html#fig-zer-boxplot-mult" class="quarto-xref">Abbildung&nbsp;<span>44.28</span></a> mit einer Menge Boxplots zerforschen. Da ich den Datensatz dann nicht zu groß machen wollte und Boxplots zu zerforschen manchmal nicht so einfach ist, passen die Ausreißer dann manchmal dann doch nicht. Auch liefern die statistischen Tests dann nicht super genau die gleichen Ergebnisse. Aber das macht vermutlich nicht so viel, hier geht es ja dann eher um den Bau der Boxplots und dem rechnen des statistischen Tests in <code>{emmeans}</code>. Die Reihenfolge des <em>compact letter displays</em> habe ich dann auch nicht angepasst sondern die Buchstaben genommen, die ich dann erhalten habe. Die Sortierung kann man ja selber einfach ändern. Wir haben hier ein einfaktorielles Design mit einem Behandlungsfaktor mit drei Leveln vorliegen. Insgesamt schauen wir uns vier Endpunkte in veränderten Substrat- und Wasserbedingungen an.</p>
<div id="fig-zer-boxplot-mult" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zer-boxplot-mult-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_boxplot_mult.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-32" title="Abbildung&nbsp;18.32— Ursprüngliche Abbildung, die nachgebaut werden soll. Insgesamt vier Outcomes sollen für zwei Behandlungen ausgewertet werden. Das praktische ist hier, dass wir es nur mit einem einfaktoriellen Design zu tun haben."><img src="images/eda/zerforschen_boxplot_mult.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zer-boxplot-mult-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.32— Ursprüngliche Abbildung, die nachgebaut werden soll. Insgesamt vier Outcomes sollen für zwei Behandlungen ausgewertet werden. Das praktische ist hier, dass wir es nur mit einem einfaktoriellen Design zu tun haben.
</figcaption>
</figure>
</div>
<p>Im Folgenden lade ich einmal den Datensatz, den ich dann per Auge zusammengesetzt habe. Das war jetzt etwas anstrengender als gedacht, da ich nicht weiß wie viele Beobachtungen einen Boxplot bilden. Je mehr Beobachtungen, desto feiner kann man den Boxplot abstimmen. Da ich hier nur mit sieben Beobachtungen ja Gruppe gearbeitet habe, habe ich es nicht geschafft die Ausreißer darzustellen. Das wäre mir dann zu viel Arbeit geworden. Nachdem ich jetzt die Daten geladen habe, muss ich noch über die Funktion <code>pivot_longer()</code> einen Datensatz passenden im Longformat bauen. Abschließend mutiere ich dann noch alle Faktoren richtig und vergebe bessere Namen als <code>labels</code> sonst versteht man ja nicht was die Spalten bedeuten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_boxplot_mult.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> fresh_weight<span class="sc">:</span>flower_number,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"rsp"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"plant_measure"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt),</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">plant_measure =</span> <span class="fu">factor</span>(plant_measure,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"fresh_weight"</span>, <span class="st">"dry_weight"</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"plant_height"</span>, <span class="st">"flower_number"</span>),</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Fresh weight (g)"</span>, <span class="st">"Dry weight (g)"</span>,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Plant height (cm)"</span>, <span class="st">"Flower number"</span>)),</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Substrate"</span>, <span class="st">"Water"</span>))) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Ich habe mir dann die beiden Behandlungen <code>substrate</code> und <code>water</code> in die neue Spalte <code>type</code> geschrieben. Die Spaltennamen der Outcomes wandern in die Spalte <code>plant_measure</code> und die entsprechenden Werte in die Spalte <code>rsp</code>. Dann werde ich hier mal alle Outcomes auf einmal auswerten und nutze dafür das R Paket <code>{purrr}</code> mit der Funktion <code>nest()</code> und <code>map()</code>. Ich packe mir als die Daten nach <code>type</code> und <code>plant_measure</code> einmal zusammen. Dann habe ich einen neuen genesteten Datensatz mit nur noch acht Zeilen. Auf jeder Zeile rechne ich dann jeweils mein Modell. Wie du dann siehst ist in der Spalte <code>data</code> dann jeweils ein Datensatz mit der Spalte <code>trt</code> und <code>rsp</code> für die entsprechenden 21 Beobachtungen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_tbl <span class="ot">&lt;-</span> boxplot_mult_tbl <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, plant_measure) <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_tbl</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   type, plant_measure [8]
  type      plant_measure     data             
  &lt;fct&gt;     &lt;fct&gt;             &lt;list&gt;           
1 Substrate Fresh weight (g)  &lt;tibble [21 × 2]&gt;
2 Substrate Dry weight (g)    &lt;tibble [21 × 2]&gt;
3 Substrate Plant height (cm) &lt;tibble [21 × 2]&gt;
4 Substrate Flower number     &lt;tibble [21 × 2]&gt;
5 Water     Fresh weight (g)  &lt;tibble [21 × 2]&gt;
6 Water     Dry weight (g)    &lt;tibble [21 × 2]&gt;
7 Water     Plant height (cm) &lt;tibble [21 × 2]&gt;
8 Water     Flower number     &lt;tibble [21 × 2]&gt;</code></pre>
</div>
</div>
<p>Zur Veranschaulichung rechne ich jetzt einmal mit <code>mutate()</code> und <code>map()</code> für jeden der Datensätze in der Spalte <code>data</code> einmal ein lineares Modell mit der Funktion <code>lm()</code>. Ich muss nur darauf achten, dass ich die Daten mit <code>.x</code> einmal an die richtige Stelle in der Funktion <code>lm()</code> übergebe. Dann habe ich alle Modell komprimiert in der Spalte <code>model</code>. Das geht natürlcih auch alles super in einem Rutsch.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl <span class="ot">&lt;-</span> boxplot_mult_nest_tbl <span class="sc">|&gt;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> .x)))</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
# Groups:   type, plant_measure [8]
  type      plant_measure     data              model 
  &lt;fct&gt;     &lt;fct&gt;             &lt;list&gt;            &lt;list&gt;
1 Substrate Fresh weight (g)  &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
2 Substrate Dry weight (g)    &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
3 Substrate Plant height (cm) &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
4 Substrate Flower number     &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
5 Water     Fresh weight (g)  &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
6 Water     Dry weight (g)    &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
7 Water     Plant height (cm) &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
8 Water     Flower number     &lt;tibble [21 × 2]&gt; &lt;lm&gt;  </code></pre>
</div>
</div>
<p>Jetzt können wir einmal eskalieren und insgesamt acht mal die ANOVA rechnen. Das sieht jetzt nach viel Code aus, aber am Ende ist es nur eine lange Pipe. Am Ende erhalten wir dann den <span class="math inline">\(p\)</span>-Wert für die einfaktorielle ANOVA für die Behandlung <code>trt</code> wiedergegeben. Wir sehen, dass wir eigentlich nur einen signifikanten Unterschied in der Wassergruppe und der Pflanzenhöhe erwarten sollten. Da der <span class="math inline">\(p\)</span>-Wert für die Wassergruppe und der Blütenanzahl auch sehr nah an dem Signifikanzniveau ist, könnte hier auch etwas sein, wenn wir die Gruppen nochmal getrennt testen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl  <span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">anova =</span> <span class="fu">map</span>(model, anova)) <span class="sc">|&gt;</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parameter =</span> <span class="fu">map</span>(anova, model_parameters)) <span class="sc">|&gt;</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, parameter) <span class="sc">|&gt;</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(parameter) <span class="sc">|&gt;</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">!=</span> <span class="st">"Residuals"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, parameter, p)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
# Groups:   type, plant_measure [8]
  type      plant_measure     parameter        p
  &lt;fct&gt;     &lt;fct&gt;             &lt;chr&gt;        &lt;dbl&gt;
1 Substrate Fresh weight (g)  trt       0.813   
2 Substrate Dry weight (g)    trt       0.381   
3 Substrate Plant height (cm) trt       0.959   
4 Substrate Flower number     trt       0.444   
5 Water     Fresh weight (g)  trt       0.384   
6 Water     Dry weight (g)    trt       0.843   
7 Water     Plant height (cm) trt       0.000138
8 Water     Flower number     trt       0.0600  </code></pre>
</div>
</div>
<p>Dann schauen wir uns nochmal das <span class="math inline">\(\eta^2\)</span> an um zu sehen, wie viel Varianz unsere Behandlung in den Daten erklärt. Leider sieht es in unseren Daten sehr schlecht aus. Nur bei der Wassergruppe und der Pflanzenhöhe scheinen wir durch die Behandlung Varianz zu erklären.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl <span class="sc">%&gt;%</span>  </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eta =</span> <span class="fu">map</span>(model, eta_squared)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(eta) <span class="sc">%&gt;%</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, eta2) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   type, plant_measure [8]
  type      plant_measure        eta2
  &lt;fct&gt;     &lt;fct&gt;               &lt;dbl&gt;
1 Substrate Fresh weight (g)  0.0228 
2 Substrate Dry weight (g)    0.102  
3 Substrate Plant height (cm) 0.00466
4 Substrate Flower number     0.0863 
5 Water     Fresh weight (g)  0.101  
6 Water     Dry weight (g)    0.0188 
7 Water     Plant height (cm) 0.628  
8 Water     Flower number     0.268  </code></pre>
</div>
</div>
<p>Dann können wir auch schon den Gruppenvergleich mit dem R Paket <code>{emmeans}</code> rechnen. Wir nutzen hier die Option <code>vcov. = sandwich::vcovHAC</code> um heterogene Varianzen zuzulassen. Im Weiteren adjustieren wir nicht für die Anzahl der Vergleiche und lassen uns am Ende das <em>compact letter display</em> wiedergeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>emm_tbl <span class="ot">&lt;-</span> boxplot_mult_nest_model_tbl <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">emm =</span> <span class="fu">map</span>(model, emmeans, <span class="sc">~</span>trt, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC)) <span class="sc">|&gt;</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cld =</span> <span class="fu">map</span>(emm, cld, <span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(cld) <span class="sc">|&gt;</span> </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, trt, <span class="at">rsp =</span> emmean, <span class="at">group =</span> .group) <span class="sc">|&gt;</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">str_trim</span>(group))</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>emm_tbl</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 5
# Groups:   type, plant_measure [8]
   type      plant_measure     trt     rsp group
   &lt;fct&gt;     &lt;fct&gt;             &lt;fct&gt; &lt;dbl&gt; &lt;chr&gt;
 1 Substrate Fresh weight (g)  UWF    95.4 a    
 2 Substrate Fresh weight (g)  TWF   101   a    
 3 Substrate Fresh weight (g)  Peat  105   a    
 4 Substrate Dry weight (g)    UWF    12.3 a    
 5 Substrate Dry weight (g)    Peat   14.3 ab   
 6 Substrate Dry weight (g)    TWF    15.1 b    
 7 Substrate Plant height (cm) TWF    37.9 a    
 8 Substrate Plant height (cm) Peat   38.0 a    
 9 Substrate Plant height (cm) UWF    39.1 a    
10 Substrate Flower number     UWF    14.6 a    
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>Da die Ausgabe viel zu lang ist, wollen wir ja jetzt einmal unsere Abbildungen in <code>{ggplot}</code> nachbauen. Dazu nutze ich dann einmal zwei Wege. Einmal den etwas schnelleren mit <code>facet_wrap()</code> bei dem wir eigentlich alles automatisch machen lassen. Zum anderen zeige ich dir mit etwas Mehraufwand alle acht Abbildungen einzeln baust und dann über das R Paket <code>{patchwork}</code> wieder zusammenklebst. Der zweite Weg ist der Weg, wenn du mehr Kontrolle über die einzelnen Abbildungen haben willst.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">Mit <code>facet_wrap()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Mit <code>{patchwork}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Die Funktion <code>facet_wrap()</code> erlaubt es dir automatisch Subplots nach einem oder mehreren Faktoren zu erstellen. Dabei muss auch ich immer wieder probieren, wie ich die Faktoren anordne. In unserem Fall wollen wir zwei Zeilen und auch den Subplots erlauben eigene <span class="math inline">\(x\)</span>-Achsen und <span class="math inline">\(y\)</span>-Achsen zu haben. Wenn du die Option <code>scale = "free"</code> nicht wählst, dann haben alle Plots alle Einteilungen der <span class="math inline">\(x\)</span>_Achse und die <span class="math inline">\(y\)</span>-Achse läuft von dem kleinsten zu größten Wert in den gesamten Daten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_tbl <span class="sc">|&gt;</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trt, rsp)) <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="dv">18</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type <span class="sc">*</span> plant_measure, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> emm_tbl, <span class="fu">aes</span>(<span class="at">y =</span> rsp, <span class="at">label =</span> group), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fl">0.2</span>), <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-zerforschen_boxplot_mult-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zerforschen_boxplot_mult-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-zerforschen_boxplot_mult-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33" title="Abbildung&nbsp;18.33— Nachbau der Abbildung mit der Funktion facte_wrap() mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das compact letter display. Auf eine Einfärbung nach der Behandlung wurde verzichtet um die Abbildung nicht noch mehr zu überladen."><img src="eda-ggplot_files/figure-html/fig-zerforschen_boxplot_mult-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zerforschen_boxplot_mult-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.33— Nachbau der Abbildung mit der Funktion <code>facte_wrap()</code> mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das <em>compact letter display</em>. Auf eine Einfärbung nach der Behandlung wurde verzichtet um die Abbildung nicht noch mehr zu überladen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Jetzt wird es etwas wilder. Wir bauen uns jetzt alle acht Plots einzeln und kleben diese dann mit dem R Paket <code>{patchwork}</code> zusammen. Das hat ein paar Vorteile. Wir können jetzt jeden einzelnen Plot bearbeiten und anpassen wie wir es wollen. Damit wir aber nicht zu viel Redundanz haben bauen wir uns erstmal ein Template für <code>ggplot()</code>. Dann können wir immer noch die Werte für <code>scale_y_continuous()</code> in den einzelnen Plots ändern. Hier also einmal das Template, was beinhaltet was für alle Abbildungen gelten soll.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>gg_template <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(trt, rsp) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="dv">18</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Ja, jetzt geht es los. Wir bauen also jeden Plot einmal nach. Dafür müssen wir dann jeweils den Datensatz filtern, den wir auch brauchen. Dann ergänzen wir noch die korrekte <span class="math inline">\(y\)</span>-Achsenbeschriftung. So können wir dann auch händisch das <em>compact letter display</em> über die Whisker einfach setzen. Im Weiteren habe ich dann auch einmal als Beispiel noch die <span class="math inline">\(y\)</span>-Achseneinteilung mit <code>scale_y_continuous()</code> geändert. Ich habe das einmal für den Plot <code>p1</code> gemacht, der Rest würde analog dazu funktionieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Fresh weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Fresh weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">170</span>, <span class="dv">120</span>, <span class="dv">135</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>), </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">40</span>, <span class="dv">180</span>, <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">180</span>))</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Dry weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Dry weight (g)"</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Plant height (cm)"</span>) <span class="sc">+</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Plant height (cm)"</span>)</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Flower number"</span>) <span class="sc">+</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Flower number"</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Fresh weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Fresh weight (g)"</span>)</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Dry weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Dry weight (g)"</span>)</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Plant height (cm)"</span>) <span class="sc">+</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Plant height (g)"</span>)</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Flower number"</span>) <span class="sc">+</span></span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Flower number"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Dann kleben wir die Abbildungen einfach mit einem <code>+</code> zusammen und dann wählen wir noch aus, dass wir vier Spalten wollen. Dann können wir noch Buchstaben zu den Subplots hinzufügen und noch Titel und anderes wenn wir wollen würden. Dann haben wir auch den Plot schon nachgebaut. Ich verzichte hier händisch überall das <em>compact letter display</em> zu ergänzen. Das macht super viel Arbeit und endlos viel Code und hilft dir dann aber in deiner Abbildung auch nicht weiter. Du musst dann ja bei dir selber die Positionen für die Buchstaben finden.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>patch <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span> p6 <span class="sc">+</span> p7 <span class="sc">+</span> p8 <span class="sc">+</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>patch <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title =</span> <span class="st">'Ein Zerforschenbeispiel an Boxplots'</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">subtitle =</span> <span class="st">'Alle Plots wurden abgelesen und daher sagen Signifikanzen nichts.'</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">caption =</span> <span class="st">'Disclaimer: Die Abbildungen sagen nichts aus.'</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-zerforschen_boxplot_mult-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zerforschen_boxplot_mult-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-zerforschen_boxplot_mult-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="Abbildung&nbsp;18.34— Nachbau der Abbildung mit dem R Paket {patchwork} mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das compact letter display bei dem ersten Plot. Auf eine Einfärbung nach der Behanldung wurde verzichtet um die Abbildung nicht noch mehr zu überladen."><img src="eda-ggplot_files/figure-html/fig-zerforschen_boxplot_mult-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zerforschen_boxplot_mult-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.34— Nachbau der Abbildung mit dem R Paket <code>{patchwork}</code> mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das <em>compact letter display</em> bei dem ersten Plot. Auf eine Einfärbung nach der Behanldung wurde verzichtet um die Abbildung nicht noch mehr zu überladen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_boxplot.png"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="sec-eda-scatter" class="level3" data-number="18.4.3">
<h3 data-number="18.4.3" class="anchored" data-anchor-id="sec-eda-scatter"><span class="header-section-number">18.4.3</span> Scatterplot</h3>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/eGtLyR2vxAM" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Der Scatterplot wird auch <span class="math inline">\(xy\)</span>-Plot genannt. Wir stellen in einem Scatterplot zwei kontinuierliche Variablen dar. Wir haben also auf der <span class="math inline">\(x\)</span>-Achse Kommazahlen genauso wie auf der <span class="math inline">\(y\)</span>-Achse. Aber dazu dann gleich mehr in den folgenden Tabs zur theoretischen Betrachtung, einem Beispiel und der Umsetzung in <code>{ggplot}</code>. Ein Scatterplot nutzen wir relativ häufig, wenn wir den Zusammenhang zwischen kontinuierlichen Zahlen zeigen wollen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false" href=""><code>{ggplot}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false" href="">Excel</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>Das Ziel eines Scatterplots ist es eine Abhängigkeit zwischen den Werten auf der <span class="math inline">\(y\)</span>-Achse und der <span class="math inline">\(x\)</span>-Achse darzustellen. Wenn sich die Werte auf der <span class="math inline">\(x\)</span>-Achse ändern, wie ändern sich dann die Werte auf der <span class="math inline">\(y\)</span>-Achse? Im einfachsten Fall zeichnen wir für die Wertepaare von <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span> jeweils ein Punkt in unserer Koordinatensystem.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatter-theo-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-theo-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-theo-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35" title="Abbildung&nbsp;18.35— Typischer Scatterplot mit gängigen Bezeichnungen der x-Achse sowie der y-Achse. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-scatter-theo-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-theo-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.35— Typischer Scatterplot mit gängigen Bezeichnungen der <span class="math inline">\(x\)</span>-Achse sowie der <span class="math inline">\(y\)</span>-Achse. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Um den Zusammenhang zwischen <span class="math inline">\(y\)</span> und <span class="math inline">\(x\)</span> zu visualisieren legen wir eine Linie durch die Punkte. Diese Gerade folgt dann einer Geradengleichung der Form <span class="math inline">\(y = \beta_0 + \beta_1 x\)</span>. Wobei der Wert für <span class="math inline">\(\beta_0\)</span> den y-Achsenabschnitt beschreibt und der Wert für <span class="math inline">\(\beta_1\)</span> die Steigung der Geraden. Wir wir methodisch zu den Zahlen einer Geradengleichung kommen und damit den Werten für <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span>, kannst du dann später in dem <a href="stat-linear-reg-basic.html">Kapitel zur linearen Regression</a> nachlesen. Im Prinzip fragen wir uns also, wie hänge die Werte auf der <span class="math inline">\(y\)</span>-Achse von den Werten auf der <span class="math inline">\(x\)</span>-Achse ab? Wenn sich also die Werte auf der <span class="math inline">\(x\)</span>-Achse erhöhen oder kleiner werden, wie verhalten sich dann die Werte auf der <span class="math inline">\(y\)</span>-Achse?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatter-theo-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-theo-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-theo-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36" title="Abbildung&nbsp;18.36— Visualisierung eines Scatterplots mit einer Geraden durch die Punktewolke. Die lineare Regression wurde zur Bestimmung der Geradengleichung der Geraden durch die Punkte des Scatterplots genutzt. Die Linie oder Gerade wird durch die statistischen Maßzahlen oder Parameter \beta_0 als y-Achsenabschnitt und \beta_1 als Steigung der Gerade beschrieben. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-scatter-theo-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-theo-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.36— Visualisierung eines Scatterplots mit einer Geraden durch die Punktewolke. Die lineare Regression wurde zur Bestimmung der Geradengleichung der Geraden durch die Punkte des Scatterplots genutzt. Die Linie oder Gerade wird durch die statistischen Maßzahlen oder Parameter <span class="math inline">\(\beta_0\)</span> als y-Achsenabschnitt und <span class="math inline">\(\beta_1\)</span> als Steigung der Gerade beschrieben. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>Wenn wir ein Scatterplot zeichnen wollen, dann brauchen wir erstmal paarweise Werte für <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span>. In der folgenden Tabelle findest du die Informationen von sieben HUndeflöhen zu der Sprungweite in [cm] und dem Gewicht der Flöhe in [mg]. Gibt es nun einen Zusammenhang zwischen der Sprungweite und dem Gewicht der Flöhe? Springen kräftigere Flöhe weiter? Oder eher nicht so weit, weil schwere Flöhe eben nicht so hoch springen können? Diesen Zusammenhang können wir dann mit einem Scatterplot visualisieren.</p>
<div class="cell">
<div id="tbl-scatter-flea-weight" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-scatter-flea-weight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;18.4— Die Sprungweite in [cm] und das Gewicht in [mg] von sieben Hundeflöhen.
</figcaption>
<div aria-describedby="tbl-scatter-flea-weight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Index</th>
<th style="text-align: center;">jump_length</th>
<th style="text-align: center;">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">0.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">1.3</td>
<td style="text-align: center;">1.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">1.7</td>
<td style="text-align: center;">1.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">2.6</td>
<td style="text-align: center;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">2.7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">2.8</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In der folgenden Abbildung siehst du einmal den Zusammenhang zwischen der Sprungweite und dem Gewicht von von unseren sieben Hundeflöhen. Für das dritte und fünfte Tier habe ich dir einmal das Wertepaar mit <span class="math inline">\((x_3, y_3)\)</span> und <span class="math inline">\((x_5, y_5)\)</span> beschriftet.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatter-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37" title="Abbildung&nbsp;18.37— Visualisierung des Scatterplots für die Sprungweite in [cm] und das Gewicht in [mg] von sieben Hundeflöhen. Das dritte und fünfte Tier wurde mit dem Wertepaar (x_3, y_3) und (x_5, y_5) beschriftet. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-scatter-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.37— Visualisierung des Scatterplots für die Sprungweite in [cm] und das Gewicht in [mg] von sieben Hundeflöhen. Das dritte und fünfte Tier wurde mit dem Wertepaar <span class="math inline">\((x_3, y_3)\)</span> und <span class="math inline">\((x_5, y_5)\)</span> beschriftet. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Nun können wir auch hier einmal die Geradengleichung ergänzen. Wenn wir das ganze händisch machen, dann würden wir die Werte für <span class="math inline">\(\\beta_0\)</span> als y-Achsenabschnitt und <span class="math inline">\(\\beta_1\)</span> als Steigung der Gerade visuell abschätzen. Das machen wir natürlich nicht in der Anwendung. Dafür habe ich dann das <a href="stat-linear-reg-basic.html">Kapitel zur linearen Regression</a> geschrieben. Aus einer linearen Regression erhalten wir dann auch die Werte <span class="math inline">\(\beta_0 = 0.99\)</span> und <span class="math inline">\(\beta_1 = 0.51\)</span>, die wir dann in die Regressiongleichung einsetzen. In der folgenden Abbildung siehst du den Zusammenhang nochmal dargestellt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatter-04" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-04-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38" title="Abbildung&nbsp;18.38— Visualisierung der Bestimmung der Geradengleichung anhand eines Scatterplots für die Sprungweite in [cm] und das Gewicht in [mg] von sieben Hundeflöhen. Wir legen eine Gerade durch eine Punktewolke. Die Gerade wird durch die statistischen Maßzahlen bzw. Parameter \beta_0 und \beta_1 beschrieben. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-scatter-04-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.38— Visualisierung der Bestimmung der Geradengleichung anhand eines Scatterplots für die Sprungweite in [cm] und das Gewicht in [mg] von sieben Hundeflöhen. Wir legen eine Gerade durch eine Punktewolke. Die Gerade wird durch die statistischen Maßzahlen bzw. Parameter <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span> beschrieben. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>Als erstes brauchen wir wieder einen kleineren Datensatz und ich nehme hier mal die Sprungweiten und das Körpergewicht von sieben Katzenflöhen. Dafür nutze ich die Funktionen <code>filter()</code> und <code>select()</code> um mir einen kleineren Datensatz zu bauen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>flea_cat_jump_weight_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(animal <span class="sc">==</span> <span class="st">"cat"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(jump_length, weight)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Die <a href="#fig-scatter-flea-0" class="quarto-xref">Abbildung&nbsp;<span>18.39</span></a> zeigt den Scatterplot für die Spalte <code>weight</code> auf der <span class="math inline">\(x\)</span>-Achse und <code>jump_length</code> auf der <span class="math inline">\(y\)</span>-Achse für unsere sieben Katzenflöhe. Mit der Funktion <code>geom_point()</code> können wir die Punktepaare für jede Beobachtung zeichnen. Wie du erkennen kannst, hat das Gewicht der Katzenflöhe einen Einfluss auf die Sprungweite.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_cat_jump_weight_tbl, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gewicht der Katzenflöhe [mg]"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="cn">NA</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-scatter-flea-0" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-flea-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-flea-0-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39" title="Abbildung&nbsp;18.39— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar."><img src="eda-ggplot_files/figure-html/fig-scatter-flea-0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-flea-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.39— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt wollen wir noch die Geradengleichung aus einer <a href="stat-linear-reg-basic.html">simplen linearen Regression</a> zu der Abbildung ergänzen. Die Gleichung ist dabei wie folgt.</p>
<p><span class="math display">\[
jump\_length = 0.6377 + 1.8188 \cdot weight
\]</span></p>
<p>Wir bauen uns hier eine Funktion in R, die die Geradengleichung repräsentiert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>jump_func <span class="ot">&lt;-</span> \(x){<span class="fl">0.6377</span> <span class="sc">+</span> <span class="fl">1.8188</span> <span class="sc">*</span> x}</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Wir können jetzt die Geradengleichung einmal über die Funktion <code>geom_function()</code> zu der Abbildung ergänzen. Es gebe auch die Möglichkeit die Funktion <code>geom_smooth()</code> zu nutzen, aber dann haben wir nicht die Werte für die Gerade sondern nur die Gerade in der Abbildung. Das macht besonders bei mehreren Gruppen Sinn, wenn wir mal schauen wollen, ob es einen Zusammenhang gibt.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_cat_jump_weight_tbl, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> jump_func, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gewicht der Katzenflöhe [mg]"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="cn">NA</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-scatter-flea-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-flea-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-flea-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40" title="Abbildung&nbsp;18.40— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar. Eine eigene Geradengleichung wurde durch geom_function() ergänzt."><img src="eda-ggplot_files/figure-html/fig-scatter-flea-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-flea-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.40— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar. Eine eigene Geradengleichung wurde durch <code>geom_function()</code> ergänzt.
</figcaption>
</figure>
</div>
</div>
</div>
<section id="einfaktorieller-scatterplot" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorieller-scatterplot">Einfaktorieller Scatterplot</h4>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> animal)) <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gewicht der Flöhe [mg]"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>,</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Flohart"</span>, <span class="at">shape =</span> <span class="st">"Flohart"</span>) <span class="sc">+</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">2.5</span>)))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-scatter-flea-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-flea-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-flea-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-41" title="Abbildung&nbsp;18.41— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar. Eine eigene Gerade wurde durch stat_smooth() für jede Gruppe ergänzt."><img src="eda-ggplot_files/figure-html/fig-scatter-flea-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-flea-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.41— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar. Eine eigene Gerade wurde durch <code>stat_smooth()</code> für jede Gruppe ergänzt.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweifaktorieller-scatterplot" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorieller-scatterplot">Zweifaktorieller Scatterplot</h4>
<p>Wenn wir uns einen zweifaktoriellen Scatterplot anschauen wollen, dann wird die Sachlage schon spannender. hier müssen wir dann mehr programmieren. Ich muss selbr gestehen, dass die gemeinsame Legende immer so eine Sache ist und ich danna und ich dann auch immer länger brauche, bis ich alles zusammen habe. Aber das ist bei komplexeren Abbdilungen eigentlich immer der Fall. Hier wollen wir dann ja auch vier Spalten mit den Sprungweiten, dem Gewicht sowie der Flohart und dem Geschlecht in einer Abbildung darstellen und das ist dann auch komplexer.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">Getrennte Legende</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Gemeinsame Legende</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false" href=""><code>{tidyplots}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac2_tbl, </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> sex)) <span class="sc">+</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gewicht der Flöhe [mg]"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">"Geschlecht"</span>, <span class="at">color =</span> <span class="st">"Flohart"</span>) <span class="sc">+</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">1.2</span>, <span class="st">"cm"</span>)) <span class="sc">+</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>)),</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>)))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-scatter-flea-4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-flea-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-flea-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42" title="Abbildung&nbsp;18.42— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar. Eine eigene Gerade wurde durch stat_smooth() für jede Faktorkombination ergänzt. Hier wird die Legende getrennt für das Geschlecht und die Floharten dargestellt. Die einzelnen Beobachtungen wurden ausgegraut."><img src="eda-ggplot_files/figure-html/fig-scatter-flea-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-flea-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.42— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar. Eine eigene Gerade wurde durch <code>stat_smooth()</code> für jede Faktorkombination ergänzt. Hier wird die Legende getrennt für das Geschlecht und die Floharten dargestellt. Die einzelnen Beobachtungen wurden ausgegraut.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac2_tbl, </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> jump_length, <span class="at">color =</span> <span class="fu">interaction</span>(sex, animal),</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="fu">interaction</span>(sex, animal))) <span class="sc">+</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point2</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Geschlecht &amp; Flohart"</span>, </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Katze &amp; männlich"</span>, <span class="st">"Hund &amp; männlich"</span>, <span class="st">"Fuchs &amp; männlich"</span>,</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Katze &amp; weiblich"</span>, <span class="st">"Hund &amp; weiblich"</span>, <span class="st">"Fuchs &amp; weiblich"</span>),</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>), <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">name =</span> <span class="st">"Geschlecht &amp; Flohart"</span>, </span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Katze &amp; männlich"</span>, <span class="st">"Hund &amp; männlich"</span>, <span class="st">"Fuchs &amp; männlich"</span>,</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Katze &amp; weiblich"</span>, <span class="st">"Hund &amp; weiblich"</span>, <span class="st">"Fuchs &amp; weiblich"</span>),</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">each =</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gewicht der Flöhe [mg]"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>, </span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">1.3</span>,<span class="st">"cm"</span>),</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>)))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-scatter-flea-5" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-flea-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-flea-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43" title="Abbildung&nbsp;18.43— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar. Eine eigene Gerade wurde durch stat_smooth() für jede Faktorkombination ergänzt. Hier wird die Legende zusammen für das Geschlecht und die Floharten dargestellt. Die Legende wurde dann auch über die Abbildung gesetzt. Die einzelnen Beobachtungen wurden ausgegraut."><img src="eda-ggplot_files/figure-html/fig-scatter-flea-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-flea-5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.43— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar. Eine eigene Gerade wurde durch <code>stat_smooth()</code> für jede Faktorkombination ergänzt. Hier wird die Legende zusammen für das Geschlecht und die Floharten dargestellt. Die Legende wurde dann auch über die Abbildung gesetzt. Die einzelnen Beobachtungen wurden ausgegraut.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>Der Scaterplot lässt sich nict so gut in <code>{tidyplots}</code> darstellen, wenn wir dann noch eine Gleichung oder ein Modell ergänzen wollen. Da ist dann <code>{ggplot}</code> einfach besser. Hier also dann einmal den simplen Plot für den Zusammenhang von der Sprungweite und den Floharten. Oder andersherum, für die Darstellung von Scatterplots mit Regressionen würde ich dann nicht <code>{tidyplots}</code> nutzen.</p>
<section id="einfaktorieller-scatterplot-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="einfaktorieller-scatterplot-1">Einfaktorieller Scatterplot</h4>
<p>Wir brauchen für den Scatterplot nur die Funktion <code>add_data_points()</code> für die Darstellung der Punkte und dann noch die Funktion <code>add_curve_fit()</code> für die Geraden durch die Punkte. Der Rest dient dann dazu die Abbildung zu formatieren und hübscher zu machen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> weight, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_curve_fit</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Flohgewicht in [mg]"</span>) <span class="sc">|&gt;</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_legend_title</span>(<span class="st">"Flohart"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_legend_position</span>(<span class="st">"top"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_color_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"dog"</span> <span class="ot">=</span> <span class="st">"Hund"</span>, <span class="st">"cat"</span> <span class="ot">=</span> <span class="st">"Katze"</span>, <span class="st">"fox"</span> <span class="ot">=</span> <span class="st">"Fuchs"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-scatter-flea-6" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-flea-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-flea-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44" title="Abbildung&nbsp;18.44— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar. Eine eigene Gerade wurde durch add_curve_fit() für jede Gruppe ergänzt."><img src="eda-ggplot_files/figure-html/fig-scatter-flea-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-flea-6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.44— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar. Eine eigene Gerade wurde durch <code>add_curve_fit()</code> für jede Gruppe ergänzt.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zweifaktorieller-scatterplot-1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="zweifaktorieller-scatterplot-1">Zweifaktorieller Scatterplot</h4>
<p>Der zweifaktorielle Scatterplot ist hier in <code>{tidyplots}</code> noch nicht möglich. Ich schaue aber immer mal wieder in <code>{tidyplots}</code> rein udn vielleicht ist es dann doch noch möglich. Es ist ja aber auch etwas gegen die Philosophie so komplexe Abbildungen zu bauen und die dann auch noch generisch einfach zu halten. Dann machen wir das dann einfach in <code>{ggplot}</code>.</p>
</section>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<p>Dann habe ich mich doch noch hingesetzt und einmal für dich ein Video gemacht, wie du dann einen Scatterplot mit Trendlinie und Formel in Excel erstellst. Das ganze macht dann nur als Video Sinn, denn sonst kannst du ja nicht nachvollziehen, was ich geklickt habe.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/pEmxZivq8l0" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div>
</div>
</div>
<p>Wenn du mehr über die Regression lernen willst schau dir auch hier mal in den Kästen zum Zerforschen rein, da findest du dann noch mehr Inspiration aus anderen Abbildungen, die ich nachgebaut habe. Ich bin einmal über den Campus gelaufen und habe geschaut, welche Abbildungen auf den Postern verwendet werden und habe diese nachgebaut.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Hinweis</span>Zerforschen: Simple lineare Regression mit Bestimmtheitsmaß <span class="math inline">\(R^2\)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns eine simple lineare Regression in einem Scatterplot anschauen. Das schöne an dem Beispiel ist, dass wir hier zum einen noch einen Pfeil einfügen wollen und dass wir nur einen Bereich darstellen wollen. Die Gerade fürht also nicht durch den gesamten Plot. Sonst haben wir dann noch die Herausforderung, dass wir einmal die Geradengleichung zusammen mit dem Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> ergänzen müssen.</p>
<div id="fig-simple-regression" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simple-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_regression_linear_02.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-45" title="Abbildung&nbsp;18.45— Ursprüngliche Abbildung, die nachgebaut werden soll. Eine simple lineare Regression mit Bestimmtheitsmaß R^2 für die Gerade durch die Punkte."><img src="images/eda/zerforschen_regression_linear_02.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simple-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.45— Ursprüngliche Abbildung, die nachgebaut werden soll. Eine simple lineare Regression mit Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> für die Gerade durch die Punkte.
</figcaption>
</figure>
</div>
<p>Auch hier mache ich es mir etwas einfacher und erschaffe mir die Daten dann direkt in R. Ich baue mir also einen <code>tibble()</code> mit den ungefähren Werten aus der Abbildung. Das war ein wenig aufwendig, aber nach einigem Hin und Her passte dann auch die Werte zu der Abbildung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>shoot_n_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">n_in_shoot =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">3.9</span>, <span class="fl">4.1</span>, <span class="fl">4.2</span>, <span class="fl">4.3</span> ,<span class="fl">4.5</span>, <span class="fl">4.7</span>, <span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">5.8</span>),</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">freshmass =</span> <span class="fu">c</span>(<span class="fl">7.5</span>, <span class="dv">9</span>, <span class="fl">12.5</span>, <span class="dv">11</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">12</span>, <span class="dv">17</span>, <span class="dv">16</span>, <span class="dv">20</span>, <span class="dv">21</span>))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Dann rechnen wir auch schon die lineare Regression mit der Funktion <code>lm()</code> die uns dann die Koeffizienten der Geraden wiedergibt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>shoot_n_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(freshmass <span class="sc">~</span> n_in_shoot, <span class="at">data =</span> shoot_n_tbl)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Dann einmal die Koeffizienten mit der Funktion <code>coef()</code> ausgelesen. Den Rest brauchen wir hier nicht für die Abbildung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>shoot_n_fit <span class="sc">|&gt;</span> <span class="fu">coef</span>()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)  n_in_shoot 
  -4.333333    4.353599 </code></pre>
</div>
</div>
<p>Aus den Koeffizienten baue ich mir dann auch die Geradengleichung einmal in R. Ich kann dann die Gleichung mit der Funktion <code>geom_function()</code> gleich in meine nachgebaute Abbildung ergänzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>shoot_n_func <span class="ot">&lt;-</span> \(x){<span class="fl">4.35</span> <span class="sc">*</span> x <span class="sc">-</span> <span class="fl">4.33</span>}</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Ich berechne dann einmal das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> mit der Funktion <code>r2()</code> aus dem R Paket <code>{performance}</code>. Wir sehen, ich habe die Werte recht gut abgelesen, dass passt ganz gut mit dem Bestimmtheitsmaß <span class="math inline">\(R^2\)</span>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>shoot_n_fit <span class="sc">|&gt;</span> <span class="fu">r2</span>()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Linear Regression
       R2: 0.750
  adj. R2: 0.722</code></pre>
</div>
</div>
<p>Und dann bauen wir uns schon die <a href="#fig-zerforschen-shoot_n-01" class="quarto-xref">Abbildung&nbsp;<span>18.46</span></a> einmal nach. Der etwas aufwendigere Teil sind die Achsenbeschriftungen sowie die Ergänzung des Pfeils und der Beschriftung. Das verbraucht dann immer etwas mehr Code und Platz. Ich habe dann etwas die Achseneinteilung geändert und stelle nicht den ganzen Bereich dar. Es reicht auch vollkommen nur den Bereich zu visualisieren, der von Interesse ist. Daher beginnt dann meine <span class="math inline">\(x\)</span>-Achse auch bei Zwei und nicht bei Null.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>shoot_n_tbl <span class="sc">|&gt;</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(n_in_shoot, freshmass)) <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"red4"</span>) <span class="sc">+</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> shoot_n_func, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">6</span>)) <span class="sc">+</span> </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"N in shoot [% DM]"</span>, <span class="at">y =</span> <span class="fu">TeX</span>(r<span class="st">"(Shoot fresh mass \[g plant$^{-1}$\] - 17 DAP)"</span>)) <span class="sc">+</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="dv">22</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($y = 4.35 \cdot x - 4.33$)"</span>)) <span class="sc">+</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="dv">20</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($R^2 = 0.75$)"</span>)) <span class="sc">+</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="at">x =</span> <span class="fl">3.5</span>, <span class="at">y =</span> <span class="fl">5.1</span>, <span class="at">xend =</span> <span class="fl">2.55</span>, <span class="at">yend =</span> <span class="dv">7</span>,</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>), <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">3.6</span>, <span class="at">y =</span> <span class="fl">4.5</span>, <span class="at">label =</span> <span class="st">"Trt. with</span><span class="sc">\n</span><span class="st">50% cattail"</span>,</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">size =</span> <span class="dv">4</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-zerforschen-shoot_n-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zerforschen-shoot_n-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-zerforschen-shoot_n-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-46" title="Abbildung&nbsp;18.46— Visualisierung der simplen linearen Regression mit einem Pfeil sowie den Informationen zu der Geradengleichung und dem Bestimmtheitsmaß R^2."><img src="eda-ggplot_files/figure-html/fig-zerforschen-shoot_n-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zerforschen-shoot_n-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.46— Visualisierung der simplen linearen Regression mit einem Pfeil sowie den Informationen zu der Geradengleichung und dem Bestimmtheitsmaß <span class="math inline">\(R^2\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Hinweis</span>Zerforschen: Zwei simple lineare Regression nebeneinander
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns eine simple lineare Regression in einem Scatterplot anschauen. Das stimmt nicht so ganz, den die Schwierigkeit liegt darin, dass es sich um zwei Scatterplots handelt. Klar, du kannst die beiden Abbildungen einfach getrennt erstellen und dann wäre gut. Ich zeige dir dann aber noch zwei weitere Möglichkeiten. Daher fangen wir mit der folgenden Abbildung einmal an. Wir haben hier zwei Scatterplots mit jeweils einer linearen Regression, dargestellt durch eine Gerade mit Regressionsgleichung, vorliegen. Hier brauchen wir dann mal ein paar mehr Zahlen, die ich mir dann aber so grob aus der Abbildung abgeleitet habe.</p>
<div id="fig-simple-regression" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simple-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_regression_linear.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-47" title="Abbildung&nbsp;18.47— Ursprüngliche Abbildung, die nachgebaut werden soll. Zwei lineare Regressionen mit den jeweiligen Regressionsgleichungen."><img src="images/eda/zerforschen_regression_linear.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simple-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.47— Ursprüngliche Abbildung, die nachgebaut werden soll. Zwei lineare Regressionen mit den jeweiligen Regressionsgleichungen.
</figcaption>
</figure>
</div>
<p>Wir laden als erstes wieder den Datensatz, den ich mir aus der obigen Abbildung erstellt habe. Wie immer beim Zerforschen habe ich nicht so genau drauf geachtet nur das die Zahlen so grob stimmen. Die Erstellung der Daten kann hier recht langwierig sein, aber hier geht es ja mehr um die Nutzung von <code>ggplot</code>. Also mach dir keinen Gedanken, wenn die Punkte nicht so perfekt passen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>regression_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_regression_linear.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Basil"</span>, <span class="st">"Oregano"</span>)))</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>regression_tbl </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 3
   type  washed unwashed
   &lt;fct&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 Basil      0        0
 2 Basil     10       15
 3 Basil     20       18
 4 Basil     30       32
 5 Basil     40       36
 6 Basil     50       52
 7 Basil     60       59
 8 Basil     70       72
 9 Basil     80       85
10 Basil    100      105
# ℹ 30 more rows</code></pre>
</div>
</div>
<p>Den folgenden Teil kannst du überspringen, wenn es dir um die Abbildung geht. Ich möchte in den zwei folgenden Tabs einmal die simple lineare Regression für die Abbildung mit dem Basilikum und einmal für das Oregano rechnen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">Lineare Regression für Basilikum</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">Lineare Regression für Oregano</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>Wir erstellen uns einmal eine simple lineare Regression mit der Funktion <code>lm()</code>. Mehr zu dem Thema und die Maßzahlen der Güte einer linearen Regression wie das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> findest du im Kapitel zur <a href="stat-linear-reg-basic.html">simplen linearen Regression</a>. Deshalb hier nur die Durchführung und nicht mehr.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(unwashed <span class="sc">~</span> washed, <span class="at">data =</span> <span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Basil"</span>))</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  parameters<span class="sc">::</span><span class="fu">model_parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Parameter, Coefficient)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient
-------------------------
(Intercept) |        2.10
washed      |        1.00</code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2</span>(fit)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Linear Regression
       R2: 0.994
  adj. R2: 0.994</code></pre>
</div>
</div>
<p>Wir nutzen jetzt gleich die Koeffizienten aus der linearen Regression für die Erstellung der Geradengleichung.</p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>Auch hier gilt wie im anderen Tab, dass wir uns einmal eine simple lineare Regression mit der Funktion <code>lm()</code> erstellen. Mehr zu dem Thema und die Maßzahlen der Güte einer linearen Regression wie das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> findest du im Kapitel zur <a href="stat-linear-reg-basic.html">simplen linearen Regression</a>. Deshalb hier nur die Durchführung und nicht mehr.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(unwashed <span class="sc">~</span> washed, <span class="at">data =</span> <span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Oregano"</span>))</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  parameters<span class="sc">::</span><span class="fu">model_parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Parameter, Coefficient)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient
-------------------------
(Intercept) |        8.17
washed      |        0.99</code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2</span>(fit)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Linear Regression
       R2: 0.997
  adj. R2: 0.996</code></pre>
</div>
</div>
<p>Wir nutzen jetzt gleich die Koeffizienten aus der linearen Regression für die Erstellung der Geradengleichung.</p>
</div>
</div>
</div>
<p>Soweit so gut. In den beiden obigen Tabs haben wir jetzt die Koeffizienten der Regressionsgleichung berechnet. Wir kriegen also aus der Funktion <code>lm()</code> die Steigung und den y-Achsenabschnitt (eng. <em>Intercept</em>). Damit können wir uns dann die beiden Funktionen für die Gerade der Basilikumdaten und der Oreganodaten bauen. Wir werden dann in <code>ggplot</code> mit der Funktion <code>geom_function()</code> die entsprechenden Gerade zeichnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>basil_func <span class="ot">&lt;-</span> \(x){<span class="fl">2.10</span> <span class="sc">+</span> <span class="fl">1.00</span> <span class="sc">*</span> x}</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>oregano_func <span class="ot">&lt;-</span> \(x){<span class="fl">8.17</span> <span class="sc">+</span> <span class="fl">0.99</span> <span class="sc">*</span> x}</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Du hast jetzt im Folgenden die Wahl zwischen drei Lösungen des Problems. Jede dieser Lösungen ist vollkommen in Ordnung und ich zeige dir hier nur die Möglichkeiten. Nimm einfach die Lösung, die dir am besten gefällt und passt. Was machen wir nun? Wir stellen einmal die beiden Abbildungen getrennt voneinander dar. Im Weiteren nutzen wir einmal die Funktion <code>facet_wrap()</code> um nach einem Faktor die Abbildungen aufzutrennen. Am Ende nutzen wir noch das R Paket <code>patchwork</code> um aus zwei Abbildungen dann eine schön annotierte Abbildung zu machen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">Zwei Abbildungen</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">Mit <code>facet_wrap()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false" href="">Mit <code>patchwork</code></a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>Der Kern der <a href="stat-modeling-noninferiority.html#fig-ggplot-zerforschen-regression-3a" class="quarto-xref">Abbildung&nbsp;<span>67.2</span></a> und <a href="stat-modeling-noninferiority.html#fig-ggplot-zerforschen-regression-3b" class="quarto-xref">Abbildung&nbsp;<span>67.3</span></a> ist die Funktion <code>filter()</code>. Wir bauen uns sozusagen zweimal einen Datensatz und leiten dann den Datensatz in die Funktion <code>ggplot()</code> weiter. Der Trick ist eigentlich, dass wir große Teile des Codes kopieren und dann für das Oregano wieder verwenden. Wenn du dir beide Chunks mal näher anschaust, wirst du große Änlichkeiten sehen. Im Prinzip musst du nur aufpassen, dass du jeweils die richtigen Geradenfunktionen einsetzt.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Basil"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> washed, <span class="at">y =</span> unwashed, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> basil_func, <span class="at">color =</span> cbbPalette[<span class="dv">2</span>], <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span> </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> cbbPalette[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(Iodine content in </span><span class="sc">\t</span><span class="st">extbf{unwashed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>), </span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">600</span>, <span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(Iodine content in </span><span class="sc">\t</span><span class="st">extbf{washed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>), </span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">600</span>, <span class="dv">150</span>)) <span class="sc">+</span> </span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">150</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> cbbPalette[<span class="dv">2</span>],  </span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($y = 2.10 + 1.00 \cdot x;\; R^2 = 0.99$)"</span>)) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-regression-3a" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-regression-3a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3a-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-48" title="Abbildung&nbsp;18.48— Einmal die einfache Abbildung der linearen Regression in ggplot für Basilikum nachgebaut. Beachte die Funktion filter(), die den jeweiligen Datensatz für die beiden Kräuter erzeugt."><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3a-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-regression-3a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.48— Einmal die einfache Abbildung der linearen Regression in <code>ggplot</code> für Basilikum nachgebaut. Beachte die Funktion <code>filter()</code>, die den jeweiligen Datensatz für die beiden Kräuter erzeugt.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Und nochmal die simple Regression in dem Scatterplot für das Oregano. Bitte beachte einmal die Beschreibungen im Code und du wirst sehen, dass hier sehr viel gleich zum obigen Codeblock ist. In dem Tab zum R Paket <code>patchwork</code> zeige ich dir dann noch die Möglichkeit ein Template zu erstellen und dann einiges an Zeilen an Code zu sparen. Aber es geht auch so.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Oregano"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> washed, <span class="at">y =</span> unwashed, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> oregano_func, <span class="at">color =</span> cbbPalette[<span class="dv">3</span>], <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> cbbPalette[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(Iodine content in </span><span class="sc">\t</span><span class="st">extbf{unwashed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>),</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">150</span>)) <span class="sc">+</span> </span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(Iodine content in </span><span class="sc">\t</span><span class="st">extbf{washed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>), </span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">150</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> cbbPalette[<span class="dv">3</span>],  </span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($y = 8.17 + 0.99 \cdot x;\; R^2 = 0.99$)"</span>)) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-regression-3b" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-regression-3b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3b-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-49" title="Abbildung&nbsp;18.49— Einmal die einfache Abbildung der linearen Regression in ggplot für Oregano nachgebaut. Beachte die Funktion filter(), die den jeweiligen Datensatz für die beiden Kräuter erzeugt."><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3b-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-regression-3b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.49— Einmal die einfache Abbildung der linearen Regression in <code>ggplot</code> für Oregano nachgebaut. Beachte die Funktion <code>filter()</code>, die den jeweiligen Datensatz für die beiden Kräuter erzeugt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<p>Hier brauchen wir jetzt das R Paket <code>grid</code> damit wir am Anschluss noch unsere Abbildungen mit den Gleichungen beschriften können. Die Idee ist eigentlich recht simple. Wir haben den Faktor <code>type</code> und nutzen die Funktion <code>facet_wrap()</code> um nach diesem Faktor zwei Abbildungen zu bauen. Unser Faktor hat zwei Level <code>Basilikum</code> und <code>Oregano</code> und deshalb erhalten wir auch zwei Subbplots. Wir können dann auch entscheiden, wie die Abbildungen angeordnet werden sollen, aber da bitte einmal bei <a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">Hilfeseite von <code>facet_wrap()</code></a>. Sonst sit alles gleich wie im ersten Tab. Also bitte nochmal da schauen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> regression_tbl, <span class="fu">aes</span>(<span class="at">x =</span> washed, <span class="at">y =</span> unwashed,</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">data =</span> <span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Basil"</span>),</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">fun =</span> basil_func, <span class="at">color =</span> cbbPalette[<span class="dv">2</span>], <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span> </span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">data =</span> <span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Oregano"</span>),</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">fun =</span> oregano_func, <span class="at">color =</span> cbbPalette[<span class="dv">3</span>], <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span> </span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type) <span class="sc">+</span> </span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(Iodine content in </span><span class="sc">\t</span><span class="st">extbf{unwashed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>),</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(Iodine content in </span><span class="sc">\t</span><span class="st">extbf{washed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>),</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.text</span>(<span class="fu">TeX</span>(r<span class="st">"($y = 2.10 + 1.00 \cdot x;\; R^2 = 0.99$)"</span>),  </span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">just =</span> <span class="st">"left"</span>, <span class="at">gp =</span> grid<span class="sc">::</span><span class="fu">gpar</span>(<span class="at">col =</span> cbbPalette[<span class="dv">2</span>])) </span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.text</span>(<span class="fu">TeX</span>(r<span class="st">"($y = 8.17 + 0.99 \cdot x;\; R^2 = 0.99$)"</span>),  </span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="fl">0.65</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">just =</span> <span class="st">"left"</span>, <span class="at">gp =</span> grid<span class="sc">::</span><span class="fu">gpar</span>(<span class="at">col =</span> cbbPalette[<span class="dv">3</span>]))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-regression-3c" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-regression-3c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3c-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-50" title="Abbildung&nbsp;18.50— Einmal die einfache Abbildung der linearen Regression in ggplot für Oregano nachgebaut. Beachte die Funktion facet_wrap(), die den jeweiligen Datensatz für die beiden Kräuter erzeugt."><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3c-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-regression-3c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.50— Einmal die einfache Abbildung der linearen Regression in <code>ggplot</code> für Oregano nachgebaut. Beachte die Funktion <code>facet_wrap()</code>, die den jeweiligen Datensatz für die beiden Kräuter erzeugt.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Und dann sind wir auch schon fertig. Gut, das ist jetzt mit der Regressionsgleichung etwas fricklig, aber das ist es meistens, wenn du viel auf einmal darstellen willst. Vielleicht ist dann noch die Idee mit dem R Paket <code>patchwork</code> im nächsten Tab hilfreich.</p>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<p>Jetzt drehen wir nochmal frei und holen alles raus was geht. Wir nutzen zum einen das <a href="https://patchwork.data-imaginist.com/">R Paket <code>patchwork</code></a> um zwei Abbildungen miteinander zu verbinden. Prinzipiell geht das auch mit dem <a href="https://cran.r-project.org/web/packages/gridExtra/vignettes/arrangeGrob.html">R Paket <code>grid</code></a> und der Funktion <code>grid.arrange()</code>, aber dann wird das hier sehr voll. Wir nutzen am Ende nur eine Funktion aus dem Paket <code>grid</code> um wiederum die <span class="math inline">\(x\)</span>-Achse schön hinzukriegen. Als erstes wollen wir uns aber ein Template in <code>ggplot</code> bauen, dass wir dann mit einem neuen Datensatz durch den Operator <code>%+%</code> mit einem neuen Datensatz versehen können.</p>
<p>Im Folgenden stecken wir den <em>ganzen</em> Datensatz in eine <code>ggplot()</code>-Funktion. Später wählen wir dann mit <code>filter()</code> die beiden Kräuterdatensätze aus. Wir definieren in dem Template alles, was wir auch für die beiden Abbildungen brauchen würden. Das spart dann etwas an Zeilen Code. Manchmal dann aber auch nicht ganz so viel, denn wir müssen für die einzelnen Datensätze dann doch noch einiges anpassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>p_template <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(regression_tbl, <span class="fu">aes</span>(<span class="at">x =</span> washed, <span class="at">y =</span> unwashed,</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">150</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">900</span>)) <span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(</span><span class="sc">\t</span><span class="st">extbf{Washed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>),</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">150</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">900</span>)) <span class="sc">+</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Wir nutzen jetzt das <code>p_template</code> und ergänzen den gefilterten Datensatz für das Basilikum mit dem Operator <code>%+%</code>. Dann wählen wir noch die passende Farbe über die Option <code>order = 1</code> aus und ergänzen die Geradengleichung sowie den Titel für die Abbildung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>p_basil <span class="ot">&lt;-</span> p_template <span class="sc">%+%</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Basil"</span>) <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>(<span class="at">order =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> basil_func, <span class="at">color =</span> cbbPalette[<span class="dv">2</span>], </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">150</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> cbbPalette[<span class="dv">2</span>], </span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($y = 2.10 + 1.00 \cdot x;\; R^2 = 0.99$)"</span>)) <span class="sc">+</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Basil"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Das Ganze dann nochmal für das Oregano, aber hier entfernen wir die <span class="math inline">\(y\)</span>-Achse. Wir brauchen nur eine auf der linken Seite. Das ist auch der Grund warum wir keine <span class="math inline">\(x\)</span>-Achse benannte haben, dass machen wir dann über die beiden Plots zusammen ganz am Ende. Auch hier ergänzen wir dann die Gweradengleichung sowie den Titel der Abbildung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>p_oregano <span class="ot">&lt;-</span> p_template <span class="sc">%+%</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Oregano"</span>) <span class="sc">+</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>(<span class="at">order =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> oregano_func, <span class="at">color =</span> cbbPalette[<span class="dv">3</span>], </span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">150</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> cbbPalette[<span class="dv">3</span>], </span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($y = 8.17 + 0.99 \cdot x;\; R^2 = 0.99$)"</span>)) <span class="sc">+</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Oregano"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Jetzt geht es los mit dem Zusammenbauen. Wir können dazu einfach das <code>+</code> nutzen. Wenn du mehr wissen willst, was du noch ändern kannst, dann schaue einmal das Tutorium <a href="https://patchwork.data-imaginist.com/articles/guides/annotation.html">Adding Annotation and Style</a> für das R Paket <code>patchwork</code>an. Da kannst du dann auch die Schriftgröße und weiteres ändern. Wir müssen dann ganz am Ende nochmal mit der Funktion <code>grid.draw()</code> die gemeinsame <span class="math inline">\(x\)</span>-Achse ergänzen. Am Ende habe ich noch die Achsenbeschriftungen gekürzt und die Informationen in den Titel mit der Funktion <code>plot_annotation</code> geschoben. Dann habe ich noch die Subplots mit einem Buchstaben versehen. Und dann sind wir auch schon fertig.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>p_basil <span class="sc">+</span> p_oregano <span class="sc">+</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">'Iodine content in herbs'</span>,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">subtitle =</span> <span class="st">'The iodine content is measured in washed and unwashed herbs'</span>,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">caption =</span> <span class="st">'Disclaimer: The measurement has been done in freshmatter'</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_levels =</span> <span class="st">'A'</span>)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.draw</span>(grid<span class="sc">::</span><span class="fu">textGrob</span>(<span class="fu">TeX</span>(r<span class="st">"(</span><span class="sc">\t</span><span class="st">extbf{Unwashed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>), </span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> <span class="fl">0.07</span>))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-regression-3d" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-regression-3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3d-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-51" title="Abbildung&nbsp;18.51— Einmal die einfache Abbildung der linearen Regression in ggplot nachgebaut. Die Abbildung A zeigt die Punkte und die Geradengleichung für das Basilikum. Die Abbildung B die entsprechenden Informationen für das Oregano. Die beiden Achsenbeschriftungen wurden gekürzt und die Informationen in den Titel übernommen."><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3d-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-regression-3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.51— Einmal die einfache Abbildung der linearen Regression in <code>ggplot</code> nachgebaut. Die Abbildung A zeigt die Punkte und die Geradengleichung für das Basilikum. Die Abbildung B die entsprechenden Informationen für das Oregano. Die beiden Achsenbeschriftungen wurden gekürzt und die Informationen in den Titel übernommen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_simple_regression.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="sec-eda-histogramm" class="level3" data-number="18.4.4">
<h3 data-number="18.4.4" class="anchored" data-anchor-id="sec-eda-histogramm"><span class="header-section-number">18.4.4</span> Histogramm</h3>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/lENH6vv6ir8" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Wozu nutzen wir das Histogramm? Wir brauchen das Histogramm um die Verteilung der Messwerte <span class="math inline">\(y\)</span> abzuschätzen. Daher wie sind unsere Sprungweiten, Anzahlen oder Gewichte unserer Hunde- und Katzenflöhe verteilt. Zuerst brauchen wir aber viele Beobachtungen. Wir brauchen für ein anständiges Histogramm, wo du auch was erkennen kannst, mindestens 20 Beobachtung <em>pro Gruppe</em>. Hier ist das <em>pro Gruppe</em> sehr wichtig. Zwar haben wir auch in unseren Hunde- und Katzenflohdaten vierzehn Beobachtungen, aber nur sieben pro Gruppe! Da können wir dann mit einem Histogramm nicht viel erkennen und dann nutzen wir den Boxplot für die Abschätzung der Verteilung. Häufig irritiert bei einem Histogramm auch, dass wir auf der x-Achse die Werte der y-Achse darstellen und dann auf der y-Achse des Histogramms die Anzahlen zählen. Aber dazu dann gleich mehr in den folgenden Tabs zur theoretischen Betrachtung, einem Beispiel und der Umsetzung in <code>{ggplot}</code>. Ein Histogramm nutzen wir eigentlich in einer laufenden Analyse als ein statistisches Tool und berichten es eher selten.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false" href=""><code>{ggplot}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false" href=""><code>{tidyplots}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<p>Für die Erstellung eines Histogramm müssen wir unterscheiden, ob wir als Outcome etwas zählbares vorliegen haben. Also ob unser Outcome Kategorien hat. Wir zählen die Anzahl an Haaren eines Flohbeins oder aber die Noten von Schülern. Wir können aber auch andere Kategorien vorliegen haben, aber es müssen schon ein paar sein. Mit ein paar meine ich dann mehr als fünf Kategorien. Ein Notenspiegel macht ja auch nur Sinn, da wir da gut zehn Notenschritte drin haben. Im Folgenden siehst du einmal eine Abbildung mit den Kategorien A bis I. Jetzt zählen wir wie oft kommt A vor, wie oft kommt B vor und so weiter. Die Anzahlen tragen wir dann als Balken ein. Dann haben wir die <em>absoluten</em> Anzahlen gezählt. Wenn wir aber Histogramme mit unterschiedlichen Beobachtungen vergleichen wollen, dann macht es mehr Sinn sich die <em>relativen</em> Häufigkeiten anzuschauen. In unserem Fall haben wir achtzehn Beobachtungen vorliegen, also bedeutet eine Beobachtung <span class="math inline">\(1/18 = 0.055\)</span> relativen Anteil.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-hist-drawn-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-drawn-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-hist-drawn-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-52" title="Abbildung&nbsp;18.52— Histogramm von achtzehn Flöhen für einen kategorialen Endpunkt der Kategorien A bis I. Auf der linken Seite sind die absoluten Anzahlen dargestellt und auf der rechten Seite die entsprechenden relativen Häufigkeiten. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-hist-drawn-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-drawn-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.52— Histogramm von achtzehn Flöhen für einen kategorialen Endpunkt der Kategorien A bis I. Auf der linken Seite sind die absoluten Anzahlen dargestellt und auf der rechten Seite die entsprechenden relativen Häufigkeiten. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wenn wir keine Kategorien vorliegen haben, dann müssen wir uns für unser Outcome welche Überlegen. Das heißt wir nutzen das so genannte <em>bining</em> (deu. <em>eindosen</em>, ungebräuchlich). Wenn du das Gewicht von Flöhen misst, dann hast du Kommazahlen und damit kontinuierliche Daten vorliegen. Damit unterscheiden sich alle deine Messwerte vermutlich. Deshalb fasst du “gleiche” Werte zusammen. Meistens machen wir das, indem wir Beobachtungen in zwischen zwei Zahlen als eine Kategorie zählen. Wie da die Grenzen liegen, ist immer unterschiedlich und hängt von der Fragestellung ab.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-hist-drawn-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-drawn-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-hist-drawn-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-53" title="Abbildung&nbsp;18.53— Histogramm von achtzehn Flöhen für einen kontinuierlichen Endpunkt. Ein Balken entspricht immer einem Zahlenraum entsprechend der x-Achse. Auf der linken Seite sind die absoluten Anzahlen dargestellt und auf der rechten Seite die entsprechenden relativen Häufigkeiten. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-hist-drawn-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-drawn-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.53— Histogramm von achtzehn Flöhen für einen kontinuierlichen Endpunkt. Ein Balken entspricht immer einem Zahlenraum entsprechend der x-Achse. Auf der linken Seite sind die absoluten Anzahlen dargestellt und auf der rechten Seite die entsprechenden relativen Häufigkeiten. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p>Betrachten wir einmal die Erstellung eine Histogramms für einen Endpunkt mit Kategorien. Dafür habe ich mir einmal die Boniturnoten für achtzehn Hundeflöhe in der folgenden Tabelle ausgedacht. Wir brauchen eben mehr Daten als wir in den ursprünglichen Hunde- und Katzenflohdaten vorliegen haben. Jetzt wollen wir uns einmal die Verteilung der Boniturnoten anschauen.</p>
<div class="cell">
<div id="tbl-hist-cat-flea-grade" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hist-cat-flea-grade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;18.5— Die Boniturnote von achtzehn Hundeflöhen.
</figcaption>
<div aria-describedby="tbl-hist-cat-flea-grade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In der folgenden Abbildung siehst du einmal die Verteilung der achtzehn Boniturnoten der Hundeflöhe dargestellt. Wir sehen sofort, dass wir am meisten die Note 3 vergeben haben. Wir haben nämlich fünfmal die Note 3 an unseren Flöhen festgestellt. Die Boniturnote 5 haben wir dann an zwei Flöhen erhoben. Da wir achtzehn Flöhe haben, entspricht jede Anzahl dann <span class="math inline">\(5.5%\)</span> auf der relativen Skala.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-hist-drawn-04" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-drawn-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-hist-drawn-04-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-54" title="Abbildung&nbsp;18.54— Histogramm von achtzehn Flöhen für die Boniturnoten als kategorialen Endpunkt. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-hist-drawn-04-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-drawn-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.54— Histogramm von achtzehn Flöhen für die Boniturnoten als kategorialen Endpunkt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Schauen wir uns im zweiten Beispiel einmal das Gewicht von achtzehn Hundeflöhen an. Hier siehst du, dass wir Kommazahlen also kontinuierliche Daten vorliegen haben. Keine der Zahlen ist doppelt, so dass wir hier dann keine Balken hochzählen können. Damit wir das aber können, bilden wir Zahlenräume in denen wir die Gewichte zusammenfassen.</p>
<div class="cell">
<div id="tbl-hist-cont-flea-weight" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hist-cont-flea-weight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;18.6— Das Gewicht in [mg] von achtzehn Hundeflöhen.
</figcaption>
<div aria-describedby="tbl-hist-cont-flea-weight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">5.2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">7.4</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In der folgenden Abbildung siehst du einmal die Zusammenfassung unserer Flohgewichte in die Zahlenräume der Größe <span class="math inline">\(1mg\)</span>. Gewichte, die in den Bereich <span class="math inline">\(x \pm 0.5\)</span> fallen, werden dann in einem Balken zusammengefasst. Wir haben zum Beispiel in dem Bereich mit <span class="math inline">\(x = 2\)</span> und somit <span class="math inline">\(2 \pm 0.5\)</span> dann die drei Werte 1.7, 2.0 und 2.1 vorliegen. Wir zeichnen einen Balken der Höhe drei. Ebenso haben wir in dem Bereich <span class="math inline">\(5.5 &lt; x \leq 6.5\)</span> zwei Beobachtungen vorliegen. Wir zeichnen hier einen Balken der Höhe zwei. Die Entscheidung wie weit der Zahlenraum zum zusammenfassen reichen soll, ist meist ein Ausprobieren. Das ist natürlich bei der händischen Erstellung problematisch.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-hist-drawn-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-drawn-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-hist-drawn-03-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-55" title="Abbildung&nbsp;18.55— Histogramm von achtzehn Flöhen für das Gewicht als kontinuierlichen Endpunkt. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-hist-drawn-03-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-drawn-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.55— Histogramm von achtzehn Flöhen für das Gewicht als kontinuierlichen Endpunkt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<p>Für die Erstellung eines Histogramms mit <code>{ggplot}</code> nutzen wir unsere Spieldaten aus dem Tab zur händischen Erstellung eines Histogramms. Nun schauen wir uns jetzt einmal achtzehn Hundflöhe an und bestimmen die Boniturnote, dargestellt in der Spalte <code>grade</code>. Darüber hinaus bestimmen wir auch noch das mittlere Gewicht der Flöhe auf dem jeweiligen Hund, dargestellt in der Spalte <code>weight</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>flea_hist_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">grade =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>),</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">weight =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.7</span>, <span class="fl">2.0</span>, <span class="fl">2.1</span>, <span class="fl">2.7</span>, </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="fl">2.8</span>, <span class="fl">3.0</span>, <span class="fl">3.1</span>, <span class="fl">3.3</span>, <span class="fl">3.8</span>, </span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="fl">4.0</span>, <span class="fl">4.1</span>, <span class="fl">4.3</span>, <span class="fl">4.9</span>, <span class="fl">5.2</span>, </span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="fl">5.9</span>, <span class="fl">6.1</span>, <span class="fl">7.4</span>))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>In <code>{ggplot}</code> können wir ein Histogramm mit der Funktion <code>geom_histogram()</code> erstellen. Dabei ist es dann immer etwas verwirrend, dass wir unser Outcome als <span class="math inline">\(y\)</span> dann auf der x-Achse darstellen. Wir können die Option <code>binwidth</code> nutzen, um zu entscheiden, wie viele Noten in einem Balken zusammengefasst werden sollen. Sinnvoll ist natürlich hier eine <code>binwidth</code> von 1, da wir pro Balken eine Boniturnote zählen wollen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_hist_tbl, <span class="fu">aes</span>(<span class="at">x =</span> grade)) <span class="sc">+</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"gray"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Boniturnote"</span>, <span class="at">y =</span> <span class="st">"Anzahl"</span>) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-hist-flea-count" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-flea-count-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-hist-flea-count-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-56" title="Abbildung&nbsp;18.56— Histogramm der Boniturnoten von achtzehn Hundeflöhen. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-hist-flea-count-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-flea-count-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.56— Histogramm der Boniturnoten von achtzehn Hundeflöhen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Anders sieht es für kontinuierliche Variablen mit Kommazahlen aus. Schauen wir uns das Gewicht der Flöhe an, so sehen wir, dass es sehr viele Zahlen gibt, die nur einmal vorkommen. Hier können wir dann mit <code>binwidth</code> den Bereich einstellen, in denen die Zahlen fallen sollen. Auch hier ist es immer ein Gefummel, wenn wir zu wenige Beobachtungen vorliegen haben. Die beste Bandbreite für die Balken zu finden, ist immer ein Ausprobieren.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_hist_tbl, <span class="fu">aes</span>(<span class="at">x =</span> weight)) <span class="sc">+</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"gray"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gewicht [mg]"</span>, <span class="at">y =</span> <span class="st">"Anzahl"</span>) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-hist-flea-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-flea-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-hist-flea-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-57" title="Abbildung&nbsp;18.57— Histogramm des Gewichts von achtzehn Hundeflöhen. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-hist-flea-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-flea-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.57— Histogramm des Gewichts von achtzehn Hundeflöhen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<p>Wir können auch auf den folgenden Daten ein Histogramm in <code>{tidyplots}</code> erstellen. Dafür nutzen wir wieder folgenden kleinen Datensatz. Hier haben wir dann wieder einmal die Boniturdaten, die wir dann einfach in einem Histogramm darestellen können.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>flea_hist_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">grade =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>))</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Dann erhalten wir auch schon ein schnelles Histogramm. Eigentlich brauchen wir hier nur zwei Zeilen Code. Der Rest dient nur der Anpassung hier in dem Skript. Wenn du mehr willst, dann musst du nochmal bei <code>{ggplot}</code> schauen. MIr persönlich ist das zu wenig, aber für den alltäglichen schnellen Gebrauch reicht es.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> flea_hist_tbl, <span class="at">x =</span> grade) <span class="sc">|&gt;</span> </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_histogram</span>() <span class="sc">|&gt;</span> </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-hist-flea-count-tidy" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-flea-count-tidy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-hist-flea-count-tidy-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-58" title="Abbildung&nbsp;18.58— Histogramm der Boniturnoten von achtzehn Hundeflöhen. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-hist-flea-count-tidy-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-flea-count-tidy-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.58— Histogramm der Boniturnoten von achtzehn Hundeflöhen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="density-plot" class="level3" data-number="18.4.5">
<h3 data-number="18.4.5" class="anchored" data-anchor-id="density-plot"><span class="header-section-number">18.4.5</span> Density Plot</h3>
<p>Eine weitere Möglichkeit sich eine Verteilung anzuschauen, ist die Daten nicht als Balkendiagramm sondern als Densityplot - also Dichteverteilung - anzusehen. Im Prinzip verwandeln wir die Balken in eine Kurve. Damit würden wir im Prinzip unterschiedliche Balkenhöhen ausgleichen und eine “glattere” Darstellung erreichen. Wir wir aber gleich sehen werden, benötigen wir dazu eine Menge an Beobachtungen und auch dann ist das Ergebnis eventuell nicht gut zu interpretieren. Eine händische Darstellung ist nicht möglich, wir machen Dichteverteilungen nur in R aber nicht selber auf einem Blattpapier.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href="">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href=""><code>{ggplot}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>Anbei einmal die Darstellung des Densityplots mit einem Histogramm im Hintergrund. Auf der <span class="math inline">\(y\)</span>-Achse ist die Dichte als schwer zu interpretieren angeben. Im Prinzip interpretieren wir die Dichte nicht direkt sondern schätzen an der Kurve die Verteilung der Daten ab. Wie die Dichtekurve entsteht, ist hier nicht von Belang. Wir nutzen die Dichtekurve auch häufig zusammen mit anderen Abbildungen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-density-drawn-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-density-drawn-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-density-drawn-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-59" title="Abbildung&nbsp;18.59— Beispielhafte Dichtekurve für die Abschätzung der Verteilung der Daten. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-density-drawn-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-density-drawn-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.59— Beispielhafte Dichtekurve für die Abschätzung der Verteilung der Daten. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<p>Schauen wir uns einmal die Densityplots in <code>{ggplot}</code> an. Wir nutzen dazu die Funktion <code>geom_density()</code>. Die Werte der Dichte interpretieren wir nicht direkt sondern betrachten nur die Form der Dichtekurve. In unserem Fall sieht die Kurve sehr nach einer Normalverteilung aus. Um die ganze Kurve zu sehen muss ich nochmal an <code>xlim()</code> drehen und den x-Achsenbereich erhöhen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_hist_tbl, <span class="fu">aes</span>(<span class="at">x =</span> grade)) <span class="sc">+</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"#CC79A7"</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Boniturnote"</span>, <span class="at">y =</span> <span class="st">"Dichte"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-dens-flea-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dens-flea-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-dens-flea-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-60" title="Abbildung&nbsp;18.60— Densityplot der Boniturnote achtzehn Hundeflöhen. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-dens-flea-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dens-flea-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.60— Densityplot der Boniturnote achtzehn Hundeflöhen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-eda-mosaic" class="level3" data-number="18.4.6">
<h3 data-number="18.4.6" class="anchored" data-anchor-id="sec-eda-mosaic"><span class="header-section-number">18.4.6</span> Mosaicplot</h3>
<p>Der Mosaicplot ist ein eher seltener Plot. Wir nutzen ihn aber häufig in der <a href="stat-modeling-survey.html">Fragebogenanalyse</a> oder aber in den Gesundheitswissenschaften. Da wir dann aber immer wieder Überschneidungen haben, wollen wir hier auch den Mosaicplot lernen. Was macht der Mosaicplot? Wir können mit dem Mosaicplot zwei Variablen, die nur aus Kategorien bestehen visualisieren. Ein Mosaicplot macht dabei für nur eine Gruppe keinen Sinn. Wir brauchen immer ein <span class="math inline">\(X\)</span> mit mindestens zwei Gruppen sowie ein <span class="math inline">\(Y\)</span> mit mindestens zwei Gruppen. Betrachten wir also einmal den Mosaicplot theoretisch, dann einmal händisch am Beispiel der mit Flohschnupfen infizierten Hunde- und Katzenflöhe sowie die Umsetzung in <code>{ggplot}</code>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tipp</span>Alternativen in <code>{tidyplots}</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Das R Paket <code>{tidyplots}</code> bietet auch noch andere Alternativen für die Darstellung von Anteilen in deinen Daten unter <a href="https://jbengler.github.io/tidyplots/articles/Visualizing-data.html#proportion">Visualisierung von Anteilen</a>. Vielleicht findest du da auch noch eine bessere Abbildung als hier mit dem Mosaicplot.</p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href="">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href="">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false" href=""><code>{ggplot}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<p>Ein Mosaicplot ist nichts anderes als die Visualisierung einer 2x2 Kreuztabelle. Daher im Folgenden einmal eine typische 2x2 Kreuztabelle als Abbildung. Wir schreiben in die Kästen die jeweiligen Anzahlen des Auftretens und berechnen dann die Anteile <em>in der Spalte</em>. Hier ist schon die erste Entscheidung zu treffen. Wie wollen wir die Anteile berechnen? Auf der ganzen Tabelle und daher durch <span class="math inline">\(n\)</span> teilen? Oder aber über die Zeilen und damit über die Kategorien von <span class="math inline">\(Y\)</span>? Häufig wollen wir wissen, wie sich die Gruppen in <span class="math inline">\(X\)</span> im Bezug auf <span class="math inline">\(Y\)</span> unterscheiden. Daher werden die Gruppen in die Spalten geschrieben und wir berechnen die Anteile spaltenweise. In der folgenden 2x2 Tafl siehst du einmal die Erstellung für den spaltenweisen Anteilsvergleich.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-mosaic-theo-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosaic-theo-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-mosaic-theo-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-61" title="Abbildung&nbsp;18.61— Eine theoretische 2x2 Tafel für zwei Gruppen und einem kategoriellen Endpunkt y mit den beiden Ausprägungen ja/nein oder 0/1. Für jedes der Felder wird spaltenweise der Anteil berechnet. Insgesamt wurden n Beobachtungen gemacht. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-mosaic-theo-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosaic-theo-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.61— Eine theoretische 2x2 Tafel für zwei Gruppen und einem kategoriellen Endpunkt <span class="math inline">\(y\)</span> mit den beiden Ausprägungen ja/nein oder 0/1. Für jedes der Felder wird spaltenweise der Anteil berechnet. Insgesamt wurden <span class="math inline">\(n\)</span> Beobachtungen gemacht. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Der Mosaicplot ist jetzt nichts anderes als die Visualisierung der obigen theoretischen 2x2 Kreuztabelle. Dabei kippen wir einmal die Beschriftung der Spalten von oben nach unten, da wir es ja jetzt mit einer Abbildung zu tun haben und nicht mit einer Abbildung. Der eigentliche Witz eines Mosaicplot ist jetzt die Flächen <em>spaltenweise</em> den berechneten Anteilen anzupassen. Auf diese Weise können wir die Anteile der Gruppen sofort visuell erfassen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-mosaic-theo-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosaic-theo-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-mosaic-theo-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-62" title="Abbildung&nbsp;18.62— Theoretischer Mosaicplot, der die Anteile spaltenweise für die beiden Guppen an dem Endpunkt Y wiedergibt. Dabei ist die Fläche A, die jedes Quadrat einnimmt proportional zu dem berechneten Anteil. Die Anteile können so visuell schnell verglichen werden. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-mosaic-theo-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosaic-theo-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.62— Theoretischer Mosaicplot, der die Anteile <em>spaltenweise</em> für die beiden Guppen an dem Endpunkt <span class="math inline">\(Y\)</span> wiedergibt. Dabei ist die Fläche <span class="math inline">\(A\)</span>, die jedes Quadrat einnimmt proportional zu dem berechneten Anteil. Die Anteile können so visuell schnell verglichen werden. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<p>Für unsere händische Erstellung des Mosaicplots brauchen wir erstmal eine 2x2 Kreuztabelle. Hierz nutzen wir den Anteil der Flöhe mit Flohschnupfen in unseren Hunde- und Katzenflohdaten. Dabei wollen wir wissen, ob sich die beiden Tierarten als Gruppen voneinander unterscheiden. Damit ist unser <span class="math inline">\(Y\)</span> der Infektionsstatus (ja/nein) und unser <span class="math inline">\(X\)</span> die beiden Tierarten (dog/cat). Es ergibt sich dann die folgende 2x2 Kreuztabelle. Beachte auch die entsprechenden Randsummen, die auch noch eine Information über die Daten beinhalten. So finden wir nämlich mehr gesunde Tiere in unseren Daten als kranke Tiere über die beiden Tierart hinweg.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-mosaic-hand-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosaic-hand-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-mosaic-hand-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-63" title="Abbildung&nbsp;18.63— Eine 2x2 Tafel für die Hunde- und Katzenflöhe und dem entsprechenden Infektionsstatus mit den beiden Ausprägungen ja/nein oder 0/1. Für jedes der Felder wird spaltenweise der Anteil berechnet. So haben 43% der Hundeflöhe einen Schnupfen aber nur 29% der Katzen. Insgesamt wurden n Beobachtungen gemacht. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-mosaic-hand-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosaic-hand-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.63— Eine 2x2 Tafel für die Hunde- und Katzenflöhe und dem entsprechenden Infektionsstatus mit den beiden Ausprägungen ja/nein oder 0/1. Für jedes der Felder wird spaltenweise der Anteil berechnet. So haben 43% der Hundeflöhe einen Schnupfen aber nur 29% der Katzen. Insgesamt wurden <span class="math inline">\(n\)</span> Beobachtungen gemacht. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Leider sind die Prozentzahlen in der 2x2 Kreuztabelle schwer visuell zu unterscheiden. Deshalb zeichnen wir den Mosaicplot so, dass die Flächen die Anteile in den Spalten widerspiegeln. So ist die Fläche von 43% kranken Hundeflöhen fast doppelt so groß wie die Fläche der 29% kranken Katzen. Daher lassen sich so schnell die Gruppen miteinander vergleichen. Wir sehen hier sehr schön, dass weit weniger Katzenflöhe mit Flohschnupfen infiziert sind als Hundeflöhe.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-mosaic-hand-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosaic-hand-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-mosaic-hand-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-64" title="Abbildung&nbsp;18.64— Mosaicplot des Infektionsstatus für die Hunde- und Katzenflöhe. Der Anteil ist für beide Gruppen spaltenweise an dem Endpunkt Y berechnet. Dabei ist die Fläche A, die jedes Quadrat einnimmt proportional zu dem berechneten Anteil. Die Anteile können so visuell schnell verglichen werden. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-mosaic-hand-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosaic-hand-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.64— Mosaicplot des Infektionsstatus für die Hunde- und Katzenflöhe. Der Anteil ist für beide Gruppen <em>spaltenweise</em> an dem Endpunkt <span class="math inline">\(Y\)</span> berechnet. Dabei ist die Fläche <span class="math inline">\(A\)</span>, die jedes Quadrat einnimmt proportional zu dem berechneten Anteil. Die Anteile können so visuell schnell verglichen werden. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<p>Für unseren Mosaicplot in R nutzen wir das R Paket <code>{ggmosaic}</code> welches uns dann ermöglicht einen Mosaicplot in <code>{ggplot}</code> zu erstellen. Zuerst müssen wir uns aber noch die Daten zusammenbauen. Dafür brauchen wir die Spalten <code>infected</code> und <code>animal</code> einmal als Faktoren und nicht als Zahlen oder Wörter. Um die 2x2 Tabelle in R in der richtigen Orientierung vorliegen zu haben, müssen wir nochmal einen kleinen Klimmzug über <code>mutate()</code> nehmen. Wir wandeln die Variable <code>infected</code> in einen Faktor um und sortieren die Level entsprechend, so dass wir die richtige Ordnung wie später im Mosaicplot haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>flea_dog_cat_mosaic_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">factor</span>(animal, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"dog"</span>, <span class="st">"cat"</span>)),</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">infected =</span> <span class="fu">factor</span>(infected, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Betrachten wir jetzt einmal die 2x2 Kreuztabelle der beiden Spalten <code>animal</code> und <code>infected</code> mit der Funktion <code>tabyl()</code> aus dem R Paket <code>{janitor}</code> um einen Überblick zu erhalten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>flea_dog_cat_mosaic_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(infected, animal) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> infected dog cat
        0   4   5
        1   3   2</code></pre>
</div>
</div>
<p>Dannn können wir uns einmal den Mosaicplot in <code>{ggplot}</code> anschauen. Wir nutzen dafür das R Paket <code>{ggmosaic}</code> mit der Funktion <code>geom_mosaic()</code>. <a href="#fig-mosaic-flea-0" class="quarto-xref">Abbildung&nbsp;<span>18.65</span></a> zeigt den Mosaic Plot für die Variable <code>animal</code> und <code>infected</code>. Die unterschiedlich großen Flächen bilden die Verhältnisse der 2x2 Tabelle ab. So sehen wir, dass es mehr uninfizierte Flöhe als infizierte Tiere Flöhe. Am meisten gibt es uninfizierte Katzenflöhe.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_mosaic_tbl) <span class="sc">+</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(infected, animal), <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-mosaic-flea-0" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosaic-flea-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-mosaic-flea-0-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-65" title="Abbildung&nbsp;18.65— Mosaicplot des Infektionsstatus für die Hunde- und Katzenflöhe. Der Anteil ist für beide Gruppen spaltenweise an dem Endpunkt Y berechnet. Dabei ist die Fläche A, die jedes Quadrat einnimmt proportional zu dem berechneten Anteil. Die Anteile können so visuell schnell verglichen werden. [Zum Vergrößern anklicken]"><img src="eda-ggplot_files/figure-html/fig-mosaic-flea-0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosaic-flea-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.65— Mosaicplot des Infektionsstatus für die Hunde- und Katzenflöhe. Der Anteil ist für beide Gruppen <em>spaltenweise</em> an dem Endpunkt <span class="math inline">\(Y\)</span> berechnet. Dabei ist die Fläche <span class="math inline">\(A\)</span>, die jedes Quadrat einnimmt proportional zu dem berechneten Anteil. Die Anteile können so visuell schnell verglichen werden. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-eda-dotplot" class="level3" data-number="18.4.7">
<h3 data-number="18.4.7" class="anchored" data-anchor-id="sec-eda-dotplot"><span class="header-section-number">18.4.7</span> Dotplot, Beeswarm und Raincloud Plot</h3>
<p>Wenn wir weniger als fünf Beobachtungen haben, dann ist meist ein Boxplot verzerrend. Wir sehen eine Box und glauben, dass wir viele Datenpunkte vorliegen haben. Bei 3 bis 7 Beobachtungen je Gruppe bietet sich der Dotplot als eine Lösung an. Wir stellen hier alle Beobachtungen als einzelne Punkte dar. Wie erstellen wir nun einen Dotplot in R? Wir nutzen dazu die Funktion <code>geom_dotplot()</code> wie folgt.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> grade, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>) <span class="sc">+</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Boniturnote [1-9]"</span>) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-dotplot-flea-eda-0" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dotplot-flea-eda-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-dotplot-flea-eda-0-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-66" title="Abbildung&nbsp;18.66— Der Dotplot für die Anzahl der Flöhe für die beiden Tierarten Hund und Katze."><img src="eda-ggplot_files/figure-html/fig-dotplot-flea-eda-0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dotplot-flea-eda-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.66— Der Dotplot für die Anzahl der Flöhe für die beiden Tierarten Hund und Katze.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir können uns mit dem Dotplot auch kontinuierliche Daten, wie die Sprungweite anschauen. Dann hilft es immer, sich auch den Mittelwert und die Standardabweichung mit einzuzeichnen. Ich nutze hierzu die Funktion <code>stat_summary()</code> für die Mittelwerte und die Standardabweichung. Da die Fehlerbalken genau eine Standardabweichung lang sein sollen, wähle ich noch die Option <code>fun.args = list(mult=1)</code> aus.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fac1_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span> </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">'y'</span>, <span class="at">stackdir =</span> <span class="st">'center'</span>) <span class="sc">+</span> </span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_sdl, <span class="at">fun.args =</span> <span class="fu">list</span>(<span class="at">mult=</span><span class="dv">1</span>), </span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite [cm]"</span>) <span class="sc">+</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hund"</span>, <span class="st">"Katze"</span>)) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-dotplot-ttest" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dotplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-dotplot-ttest-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-67" title="Abbildung&nbsp;18.67— Dotplot der Sprungweiten [cm] von Hunden und Katzen zusammen mit dem Mittelwert und der Stanardabweichung als Fehlerbalken."><img src="eda-ggplot_files/figure-html/fig-dotplot-ttest-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dotplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.67— Dotplot der Sprungweiten [cm] von Hunden und Katzen zusammen mit dem Mittelwert und der Stanardabweichung als Fehlerbalken.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-dotplot-flea-eda-0" class="quarto-xref">Abbildung&nbsp;<span>18.66</span></a> sehen wir den Dotplot aus der Datei <code>flea_dog_cat.xlsx</code>. Auf der x-Achse sind die Level des Faktors <code>animal</code> dargestellt und auf der y-Achse die Notenbewertung <code>grade</code> der einzelnen Hunde und Katzen. Die Funktion <code>geom_dotplot()</code> erschafft das Layer für die Dots bzw. Punkte. Wir müssen in der Funktion noch zwei Dinge angeben, damit der Plot so aussieht, dass wir den Dotplot gut interpretieren können. Zum einen müssen wir die Option <code>binaxis = y</code> wählen, damit die Punkte horizontal geordnet werden. Zum anderen wollen wir auch, dass die Punkte zentriert sind und nutzen dafür die Option <code>stackdir = center</code>.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> grade, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>) <span class="sc">+</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> median, <span class="at">fun.min =</span> median, <span class="at">fun.max =</span> median,</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"crossbar"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Boniturnote [1-9]"</span>) </span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-dotplot-flea-eda-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dotplot-flea-eda-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-dotplot-flea-eda-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-68" title="Abbildung&nbsp;18.68— Der Dotplot für die Anzahl der Flöhe für die beiden Tierarten Hund und Katze. Die schwarze Linie stelt den Median für die beiden Tierarten dar."><img src="eda-ggplot_files/figure-html/fig-dotplot-flea-eda-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dotplot-flea-eda-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.68— Der Dotplot für die Anzahl der Flöhe für die beiden Tierarten Hund und Katze. Die schwarze Linie stelt den Median für die beiden Tierarten dar.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Nun macht es wenig Sinn bei sehr wenigen Beobachtungen noch statistische Maßzahlen mit in den Plot zu zeichnen. Sonst hätten wir auch gleich einen Boxplot als Visualisierung der Daten wählen können. In <a href="#fig-dotplot-flea-eda-1" class="quarto-xref">Abbildung&nbsp;<span>18.68</span></a> sehen wir die Ergänzung des Medians. Hier müssen wir etwas mehr angeben, aber immerhin haben wir so eine Idee, wo die “meisten” Beobachtungen wären. Aber auch hier ist Vorsicht geboten. Wir haben sehr wenige Beobachtungen, so dass eine Beobachtung mehr oder weniger große Auswirkungen auf den Median und die Interpretation hat.</p>
<p>Dann möchte ich hier den Beeswarm als eine Alternative zu dem Dotplot vorstellen. Insbesondere wenn du sehr viele Beobachtungen hast, dann hat der Beeswarm bessere Eigenschaften als der Dotplot. Es gibt hier auch die tolle Hilfeseite zu <a href="https://r-charts.com/distribution/ggbeeswarm/">Beeswarm plot in ggplot2 with <code>geom_beeswarm()</code></a> und natürlich noch die Möglichkeit ein Violin Plot zu ergänzen. Auch hier dann mal bei der Hilfeseite <a href="https://r-charts.com/distribution/violin-plot-points-ggplot2/">Violin plot with data points in ggplot2</a> schauen. In <a href="#fig-beeswarm-flea-eda-0" class="quarto-xref">Abbildung&nbsp;<span>18.69</span></a> siehst du dann einmal das Alter und die Körpergröße für die beiden Geschlechter in den Gummibärchendaten aufgeteilt.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> age,</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>() <span class="sc">+</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Alter in Jahren"</span>) <span class="sc">+</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> height,</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>() <span class="sc">+</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Körpergröße in cm"</span>) <span class="sc">+</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div id="fig-beeswarm-flea-eda-0" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-beeswarm-flea-eda-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-beeswarm-flea-eda-0" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-beeswarm-flea-eda-0-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-beeswarm-flea-eda-0-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-beeswarm-flea-eda-0-1.png" class="lightbox" data-gallery="fig-beeswarm-flea-eda-0" title="Abbildung&nbsp;18.69&nbsp;(a)— Alter nach Geschlecht"><img src="eda-ggplot_files/figure-html/fig-beeswarm-flea-eda-0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-beeswarm-flea-eda-0" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-beeswarm-flea-eda-0-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Alter nach Geschlecht
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-beeswarm-flea-eda-0" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-beeswarm-flea-eda-0-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-beeswarm-flea-eda-0-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-beeswarm-flea-eda-0-2.png" class="lightbox" data-gallery="fig-beeswarm-flea-eda-0" title="Abbildung&nbsp;18.69&nbsp;(b)— Körpergröße nach Geschlecht"><img src="eda-ggplot_files/figure-html/fig-beeswarm-flea-eda-0-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-beeswarm-flea-eda-0" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-beeswarm-flea-eda-0-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Körpergröße nach Geschlecht
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-beeswarm-flea-eda-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.69— Der Beeswarm ist ein Dotplot für eine große Anzahl an Beobachtungen. Hier schauen wir uns einmal das Alter und die Körpergröße aufgeteilt nach Geschlecht an.
</figcaption>
</figure>
</div>
</div>
<p>Und dann bringen wir in der <a href="#fig-halfplot-dot-gummi-1" class="quarto-xref">Abbildung&nbsp;<span>18.70</span></a> mal verschiedene Abbildungen zusammen mit dem <a href="https://erocoar.github.io/gghalves/">R Paket<code>{gghalves}</code></a>. Wir können mit <code>{gghalves}</code> halbe Plots erstellen und diese dann miteinander kombinieren. Damit packen wir dann in die Mitte Boxplots. Links von den Boxplots zeichnen wir die einzelnen Beobachtungen als Punkte mit <code>stat_dots()</code> und die Verteilung der einzelnen Beobachtungen zeichnen wir mit dem <a href="https://mjskay.github.io/ggdist/">R Paket <code>{ggdist}</code></a>. Das Tutorium <a href="https://www.cedricscherer.com/2021/06/06/visualizing-distributions-with-raincloud-plots-and-how-to-create-them-with-ggplot2/">Visualizing Distributions with Raincloud Plots</a> liefert dann noch mehr Anleitungen für noch mehr Varianten. Wie du aber schon am R Code siehst, ist das eine etwas komplexere Abbildung geworden.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> age, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">.width =</span> <span class="dv">0</span>, </span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">point_colour =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dots</span>(<span class="at">side =</span> <span class="st">"left"</span>, <span class="at">justification =</span> <span class="fl">1.12</span>, <span class="at">binwidth =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">1.9</span>), <span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Alter in Jahren"</span>) <span class="sc">+</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> height, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">.width =</span> <span class="dv">0</span>, </span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">point_colour =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dots</span>(<span class="at">side =</span> <span class="st">"left"</span>, <span class="at">justification =</span> <span class="fl">1.12</span>, <span class="at">binwidth =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">1.9</span>), <span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Körpergröße in cm"</span>) <span class="sc">+</span></span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div id="fig-halfplot-dot-gummi-1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-halfplot-dot-gummi-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-halfplot-dot-gummi-1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-halfplot-dot-gummi-1-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-halfplot-dot-gummi-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-halfplot-dot-gummi-1-1.png" class="lightbox" data-gallery="fig-halfplot-dot-gummi-1" title="Abbildung&nbsp;18.70&nbsp;(a)— Alter nach Geschlecht"><img src="eda-ggplot_files/figure-html/fig-halfplot-dot-gummi-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-halfplot-dot-gummi-1" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-halfplot-dot-gummi-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Alter nach Geschlecht
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-halfplot-dot-gummi-1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-halfplot-dot-gummi-1-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-halfplot-dot-gummi-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-halfplot-dot-gummi-1-2.png" class="lightbox" data-gallery="fig-halfplot-dot-gummi-1" title="Abbildung&nbsp;18.70&nbsp;(b)— Körpergröße nach Geschlecht"><img src="eda-ggplot_files/figure-html/fig-halfplot-dot-gummi-1-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-halfplot-dot-gummi-1" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-halfplot-dot-gummi-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Körpergröße nach Geschlecht
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-halfplot-dot-gummi-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.70— Der <code>{gghalves}</code>-Plot als Kombination vom Dotplot, Boxplot sowie Densityplot. Mit der Art der Abbildung spart man sich dann drei Abbildungen. Hier haben wir dann alle Informationen über die Körpergröße sowie dem Alter in Abhängigkeit vom Geschlecht in einer Abbildung.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="sec-eda-violinplot" class="level3" data-number="18.4.8">
<h3 data-number="18.4.8" class="anchored" data-anchor-id="sec-eda-violinplot"><span class="header-section-number">18.4.8</span> Violinplot</h3>
<p>Eine etwas neuere Abbildung, die eigentlich gar so neu ist, ist der Violinplot. Der Violinplot verbindet im Prinzip den Boxplot zusammen mit dem Densityplot. Wir haben am Ende eben eine Verteilung der Daten visualisiert. Wir schauen uns aber nicht wie in einem Histogramm die Werte als Balken an, sondern glätten die Balken zu einer Kurve. Wie immer gibt es auch ein Tutorium mit noch mehr Hilfe unter <a href="http://www.sthda.com/english/wiki/ggplot2-violin-plot-quick-start-guide-r-software-and-data-visualization">ggplot2 violin plot : Quick start guide - R software and data visualization</a>. Wir schauen uns jetzt mal die Erstellung von Violinplots in verschiedenen Kombinationen mit anderen Abbildungen an.</p>
<p>Da ein Violinplot keinen Median oder sonst eine deskriptive Zahl beinhaltet, müssen wir uns eine Funktion erstellen, die den Mittelwert plusminus Standardabweichung wiedergibt. Die Funktion rufen wir dann innerhalb von <code>ggplot()</code> auf und erhalten dann den Mittelwert und Standardabweichung als einen Punkt mit zwei Linien dargestellt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>data_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(y) {</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>   m <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>   ymin <span class="ot">&lt;-</span> m <span class="sc">-</span> <span class="fu">sd</span>(y)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>   ymax <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">sd</span>(y)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">y =</span> m, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax))</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>In der <a href="#fig-violin-gummi-1" class="quarto-xref">Abbildung&nbsp;<span>18.71</span></a> siehst du einmal einen Violinplot mit der Funktion <code>geom_violin()</code>. Ich nutze eigentlich immer die Option <code>trim = FALSE</code> damit die Violinplots nicht so abgeschnitten sind. Der Nachteil ist dann, dass eventuell Werte angezeigt werden, die in den Daten nicht vorkommen, aber das ist auch sonst der Fall bei anderen Densityplots. Hier sieht es dann einfach besser aus und deshalb nutze ich es gerne. Durch die Funktion <code>stat_summary()</code> ergänze ich dann noch den Mittelwert und die Standardabweichung.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> height,</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> data_summary) <span class="sc">+</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Körpergröße in cm"</span>) <span class="sc">+</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-violin-gummi-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-violin-gummi-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-violin-gummi-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-73" title="Abbildung&nbsp;18.71— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung."><img src="eda-ggplot_files/figure-html/fig-violin-gummi-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-violin-gummi-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.71— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In der nächsten <a href="#fig-violin-gummi-2" class="quarto-xref">Abbildung&nbsp;<span>18.72</span></a> siehst du dann die Implementierung des Violinplot aus dem R Paket <code>{see}</code> mit der Funktion <code>geom_violindot()</code>. Auch hier trimme ich nicht die Spitzen der Violinplots und vergrößere die Punkte in dem Dotplot. Die Stärke von der Funktion ist der halbe Violinplot zusammen mit einem Dotplot, wir haben dann beides. Zum einen können wir die Werte sehen, wie sie sich in einem Histogramm anordnen würden. Zum anderen haben wir dann auch den Densityplot als geglättete Kurve daneben. Ich habe auch hier den Mittelwert und die Standardabweichung ergänzt, musste aber die Position in der <span class="math inline">\(x\)</span>-Richtung etwas verschieben.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> height,</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violindot</span>(<span class="at">dots_size =</span> <span class="dv">4</span>, <span class="at">trim =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> data_summary, </span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Körpergröße in cm"</span>) <span class="sc">+</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-violin-gummi-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-violin-gummi-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-violin-gummi-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-74" title="Abbildung&nbsp;18.72— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung. Hier müssen wir aber die Darstellung auf der x-Achse um 0.1 etwas verschieben."><img src="eda-ggplot_files/figure-html/fig-violin-gummi-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-violin-gummi-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.72— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung. Hier müssen wir aber die Darstellung auf der <span class="math inline">\(x\)</span>-Achse um <span class="math inline">\(0.1\)</span> etwas verschieben.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Du musst natürlich keine Funktion aus einem anderen Paket nehmen. Der Violinplot lässt sich als ganzer Plot auch mit dem Dotplot kombinieren. Wir plotten als erstes in den Hintergrund den Violinplot, ergänzen dann darüber den Dotplot und zeichnen ganz zum Schluss noch die Mittelwerte und die Standardabweichung ein. So erhalten wir dann die <a href="#fig-violin-gummi-3" class="quarto-xref">Abbildung&nbsp;<span>18.73</span></a>.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> height,</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">trim =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>,</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">dotsize =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> data_summary, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Körpergröße in cm"</span>) <span class="sc">+</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-violin-gummi-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-violin-gummi-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-violin-gummi-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-75" title="Abbildung&nbsp;18.73— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung sowie den einzelnen Beobachtungen aus einem Dotplot."><img src="eda-ggplot_files/figure-html/fig-violin-gummi-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-violin-gummi-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.73— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung sowie den einzelnen Beobachtungen aus einem Dotplot.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In der <a href="#fig-violin-gummi-4" class="quarto-xref">Abbildung&nbsp;<span>18.74</span></a> sehen wir dann anstatt von einem Dotplot einen Beeswarm. Wie immer ist es Geschmackssache welcher Plot einem mehr zusagt. Der Beeswarm wirkt immer etwas kompakter und so lässt sich hier auch mehr erkennen. Das Problem ist eher, dass die Punkte sich nicht füllen lassen, so dass wir dann doch ein recht einheitliches Bild kriegen. Hier muss ich dann immer überlegen, was ich dann wie einfärben will.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> height,</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill =</span> gender, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">trim =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>() <span class="sc">+</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> data_summary, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="dv">2</span>,</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Körpergröße in cm"</span>) <span class="sc">+</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="fig-violin-gummi-4" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-violin-gummi-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-violin-gummi-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-76" title="Abbildung&nbsp;18.74— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung sowie den einzelnen Beobachtungen aus einem Beeswarm."><img src="eda-ggplot_files/figure-html/fig-violin-gummi-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-violin-gummi-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;18.74— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung sowie den einzelnen Beobachtungen aus einem Beeswarm.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="weitere-optionen-in-ggplot" class="level2" data-number="18.5">
<h2 data-number="18.5" class="anchored" data-anchor-id="weitere-optionen-in-ggplot"><span class="header-section-number">18.5</span> Weitere Optionen in <code>{ggplot}</code></h2>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Besuche auch <a href="https://exts.ggplot2.tidyverse.org/gallery/">ggplot2 extensions</a> für weitere tolle Möglichkeiten! Dort gibt es eine große Auswahl an Erweiterungen, die dich inspierieren mögen.</p>
</div>
</div>
</div>
<p>Du findest dann auch weitere Optionen in <code>{ggplot}</code> im <a href="programing-ggplot.html">Kapitel zum <code>{ggplot}</code> Cookbook</a>. Ich habe einen Teil der Optionen dann in das Programmieren ausgelagert, da wir dann dort mehr machen können und dieses Kapitel nicht zu voll wird. Es ist auch so, dass du in allen anderen Kapiteln zur Anwendung und statistischen Analyse dann entsprechende Visualisierungen in <code>{ggplot}</code> findest. Du musst dann immer schauen, was zu deiner wissenschaftlichen Fragestellung passt. Ich habe hier nicht alles aufgenommen, da es dann immer dieses Kapitel gesprengt hat. Hier geht es dann eben um die explorative Datenanalyse und nicht um das statistische Modellieren.</p>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-cumming2007error" class="csl-entry" role="listitem">
Cumming, G., Fidler, F., &amp; Vaux, D. L. (2007). Error bars in experimental biology. <em>The Journal of cell biology</em>, <em>177</em>(1), 7–11.
</div>
<div id="ref-engler2025tidyplots" class="csl-entry" role="listitem">
Engler, J. B. (2025). Tidyplots empowers life scientists with easy code-based data visualization. <em>iMeta</em>, <em>4</em>(2), e70018.
</div>
<div id="ref-riedel2022replacing" class="csl-entry" role="listitem">
Riedel, N., Schulz, R., Kazezian, V., &amp; Weissgerber, T. (2022). Replacing bar graphs of continuous data with more informative graphics: are we making progress? <em>Clinical Science</em>, <em>136</em>(15), 1139–1156.
</div>
<div id="ref-tukey1962future" class="csl-entry" role="listitem">
Tukey, J. W. (1962). The future of data analysis. <em>The annals of mathematical statistics</em>, <em>33</em>(1), 1–67.
</div>
<div id="ref-tukey1977exploratory" class="csl-entry" role="listitem">
Tukey, J. W. et al. (1977). <em>Exploratory data analysis</em> (Bd. 2). Reading, MA.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Kopiert");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Kopiert");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./eda-descriptive.html" class="pagination-link" aria-label="Deskriptive Statistik">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./eda-distribution.html" class="pagination-link" aria-label="Verteilung von Daten">
        <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb120" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Visualisierung von Daten {#sec-eda-ggplot}</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("eda-ggplot.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, readxl, knitr, kableExtra, quantreg,</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>               multcomp, emmeans, ggpubr, multcompView, nlme,</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>               ggdist, gghalves, performance, parameters, broom,</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>               effectsize, patchwork, tidyplots, conflicted)</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select)</span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"The greatest value of a picture is when it forces us to notice what we never expected to see." --- John Tukey*</span></span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/00OAyTOK_Mw &gt;}}</span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>Worum geht es in der explorativen Datenanalyse? Die explorative Datenanalyse wurde von <span class="co">[</span><span class="ot">John Tukey (1915--2000)</span><span class="co">](https://de.wikipedia.org/wiki/John_W._Tukey)</span> begründet. Er war ein Pionier im Bereich der frühen Informatik und Computerwissenschaften. Warum explorativ, was wollen wir den erforschen? Denn nichts anderes bedeutet ja explorativ (deu. *erforschend, erkundend, untersuchend*) -- wir wollen etwas entdecken. Die Idee war ziemlich innovativ und neu als @tukey1977exploratory in seinem Buch die explorative Datenanalyse erstmal als Begriff vorstellte. Schon vorher beschrieb @tukey1962future in seinem Artikel "The Future of Data Analysis" die zukünftige Datenanalyse, wie Tukey sie sich vorstellte, was auch sein folgendes Zitat belegt.</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"I know of no person or group that is taking nearly adequate advantage of the graphical potentialities of the computer." --- John Tukey*</span></span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a>Nun musst du wissen, dass in den 60'ziger Jahren der Computer in den Kinderschuhen steckte. Mal eben eine Berechnung durchführen, dass war dann schon so eine Sache der damaligen Zeit. Vieles bis fast alles wurde als Tabellen veröffentlicht und selten wurde eine Abbildung *händisch* dazu erstellt. An dieser Stelle sei einmal auf die <span class="co">[</span><span class="ot">Microsoft Excel Werbung aus dem Jahr 1990</span><span class="co">](https://youtu.be/kOO31qFmi9A?si=wHkm7frVVlH2e_SF)</span> verwiesen. Daher war die Idee, sich Daten zu visualisieren entsprechend neu und wirklich ein wissenschaftlicher Fortschritt. Erstaunlicherweise glauben wir heute manchmal dann Zahlen in einer Tabelle mehr als einer Abbildung. Wir schreiben dann den Zahlen eine größere Genauigkeit und Aussagekraft zu, als einer explorativen Abbildung. Dabei können wir in einer Abbildung viel mehr sehen, als in einer Tabelle.</span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"There is no data that can be displayed in a pie chart, that cannot be displayed BETTER in some other type of chart." --- John Tukey*</span></span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a><span class="al">!["The reason to avoid pie charts" Quelle: wumo.com](images/eda/cake_chart.jpg)</span>{#fig-wumo-pie fig-align="center" width="100%"}</span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a>Daher ist ein wichtiger Teil in der Analyse von Daten die Visualisierung und damit die Darstellung in einer Abbildung. Wir haben aber eine großem Auswahl an möglichen Abbildungen, deshalb auch das lange Kapitel hier. Siehe dazu auch die Arbeit von @riedel2022replacing mit dem Titel <span class="co">[</span><span class="ot">Replacing bar graphs of continuous data with more informative graphics: are we making progress?</span><span class="co">](https://portlandpress.com/clinsci/article/136/15/1139/231562/Replacing-bar-graphs-of-continuous-data-with-more)</span> um mehr über die Nutzung der Abbildungen im Laufe der Zeit zu erfahren. Nicht alles was schon immer genutzt wurde, macht auch Sinn weiter genutzt zu werden. Wir haben mit R und <span class="in">`{ggplot}`</span> eine Möglichkeit Abbildungen von Daten sehr viel besser zu erstellen als noch vor ein paar Jahrzehnten möglich war.</span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a>Grundsätzlich glauben wir dabei keiner Auswertung eines mathematischen Algorithmus, wenn wir nicht die Bestätigung in einer Abbildung sehen. Wenn wir also einen signifikanten Unterschied aus einem Algorithmus wiedergegeben bekommen, dann müssen wir auch den Unterschied in einer Abbildung sehen können. Eine statistische Analyse und deren Visualisierung gehen Hand in Hand. Daher ist die Visualisierung die Grundlage für ein fundiertes, wissenschaftliches Arbeiten. In diesem Kapitel stelle ich dir verschiedene Abbildungen vor, die uns helfen werden zu Verstehen ob es einen Zusammenhang zwischen $y$ und $x$ gibt. Wir haben ein $y$ vorliegen, was wir auf die y-Achse eines Graphen legen und daneben dann mehrere Variablen bzw. Spalten die wir $x$ nennen. Eine der Variablen legen wir auf die x-Achse des Graphen. Nach den anderen $x$ färben wir die Abbildung ein. Wir nennen dabei eine Abbildung auch häufig Plot. Das ist der englische Begriff und hat nichts in unserem Kontext mit einer Fläche oder einer Handlung in einem Film zu zu tun. Im den beiden folgenden Abbildungen siehst du einmal die beiden häufigsten wissenschaftlichen Fragestellungen in der explorativen Datenanalyse.</span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-40"><a href="#cb120-40" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-41"><a href="#cb120-41" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb120-42"><a href="#cb120-42" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb120-43"><a href="#cb120-43" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb120-44"><a href="#cb120-44" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-overview-01</span></span>
<span id="cb120-45"><a href="#cb120-45" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb120-46"><a href="#cb120-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5.5</span></span>
<span id="cb120-47"><a href="#cb120-47" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb120-48"><a href="#cb120-48" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der beiden häufigsten wissenschaftlichen Fragestellungen in der explorativen Datenanalyse. **(A)** *Die Frage nach dem Unterschied.* Unterschieden sich die Gruppen auf der x-Achse gegeben den Werten auf der y-Achse? Um den Unterschied darzustellen können Barplots oder Boxplots verwendet werden. **(B)** *Die Frage nach dem Zusammenhang.* Wie verändern sich die Werte der y-Achse, wenn sich die Werte auf der x-Achse ändern? Um den Zusammenhang zu zeigen kann ein Scatterplot verwendet werden. Die Gerade durch die Punkte kann durch eine (nicht) lineare Regression bestimmt werden. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb120-49"><a href="#cb120-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-50"><a href="#cb120-50" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"images/R/eda-ggplot-01.R"</span>)</span>
<span id="cb120-51"><a href="#cb120-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-52"><a href="#cb120-52" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> p1 <span class="sc">+</span> </span>
<span id="cb120-53"><a href="#cb120-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb120-54"><a href="#cb120-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb120-55"><a href="#cb120-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb120-56"><a href="#cb120-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-57"><a href="#cb120-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-58"><a href="#cb120-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-59"><a href="#cb120-59" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel wollen wir durch die bedeutendsten Abbildungen in der explorativen Datenanalyse durchgehen. Ich habe die Abbildungen etwas nach Kontext sortiert und geschaut, dass die Abbildungen zum Gruppennterschied oder Zusammenhang zweier Variablen als erstes besprochen werden.</span>
<span id="cb120-60"><a href="#cb120-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-61"><a href="#cb120-61" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Barplot</span><span class="co">](#sec-eda-barplot)</span> für 5 und mehr Beobachtungen (pro Gruppe). Der Barplot oder das *Balkendiagramm* bzw. *Säulendiagramm* stellt den Mittelwert und die Standardabweichung da.</span>
<span id="cb120-62"><a href="#cb120-62" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Boxplot</span><span class="co">](#sec-eda-boxplot)</span> für 5 bis 20 Beobachtungen (pro Gruppe). Ebenso wie bei einem Histogramm, geht es bei einem Boxplot auch um die Verteilung der einer Variable. Wir können in einem Boxplot auch erkennen, ob sogenannte auffällige Werte oder Ausreißer vorliegen.</span>
<span id="cb120-63"><a href="#cb120-63" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Scatterplot</span><span class="co">](#sec-eda-scatter)</span> für zwei kontinuierliche Variablen. Auch *xy-Plot* genannt. Die Abbildung, die dir bekannt sein müsste. Wir zeichnen hier eine Grade durch eine Punktewolke.</span>
<span id="cb120-64"><a href="#cb120-64" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Mosaicplot</span><span class="co">](#sec-eda-mosaic)</span> für zwei diskrete Variablen. Eine etwas seltene Abbildung, wenn wir Variablen abbilden wollen, die diskret sind bzw. aus Kategorien bestehen.</span>
<span id="cb120-65"><a href="#cb120-65" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Histogramm</span><span class="co">](#sec-eda-histogramm)</span> für mehr als 20 Beobachtungen (pro Gruppe). Wir nutzen ein Histogramm um die Verteilung einer Variable zu visualisieren.</span>
<span id="cb120-66"><a href="#cb120-66" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Dotplot</span><span class="co">](#sec-eda-dotplot)</span> für 3 bis 5 Beobachtungen (pro Gruppe). Hier geht es weniger um die Verteilung der Variable, sondern darum die wenigen Beobachtungen zu visualisieren.</span>
<span id="cb120-67"><a href="#cb120-67" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Violinplot</span><span class="co">](#sec-eda-violinplot)</span> für die Kombination von einem Densityplot und einem Boxplot. Dann können wir hier noch den Dotplot ergänzen und haben eine sehr informative Übersichtsabbildung.</span>
<span id="cb120-68"><a href="#cb120-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-69"><a href="#cb120-69" aria-hidden="true" tabindex="-1"></a>Beginnen wir also mit dem Teil, der in der Statistik der mir immer am meisten Spaß macht. Oder aber um es in den Worten von John Tukey, den Begründer der explorativen Datenanalyse zu sagen:</span>
<span id="cb120-70"><a href="#cb120-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-71"><a href="#cb120-71" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"This is my favorite part about analytics: Taking boring flat data and bringing it to life through visualization." --- John Tukey*</span></span>
<span id="cb120-72"><a href="#cb120-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-73"><a href="#cb120-73" aria-hidden="true" tabindex="-1"></a>Wir immer geht natürlich hier auch noch viel mehr am Abbildungen. Du musst nicht alles in <span class="in">`ggplot`</span> machen und darüber hinaus gibt es dann auch noch einiges an anderen R Paketen. In dem folgenden Kasten habe ich dir mal ein paar Quellen rausgesucht, wo du einmal gucken kannst, wenn du noch mehr Inspiration benötigst. Ich nutze die Seiten auch als Inspiration, den meisten weiß man gar nicht was alles geht, bis man die Visualisierung gesehen hat.</span>
<span id="cb120-74"><a href="#cb120-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-75"><a href="#cb120-75" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb120-76"><a href="#cb120-76" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Möglichkeiten der Visualisierung</span></span>
<span id="cb120-77"><a href="#cb120-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-78"><a href="#cb120-78" aria-hidden="true" tabindex="-1"></a>Im Folgenden einmal eine Auswahl an weiteren Möglichkeiten sich Abbildungen in R zu visualisieren. Teilweise ist es dann auch eine Sammlung an Informationen für mich, damit ich eine Idee habe, was noch so alles geht. Manchmal braucht man ja auch noch eine zusätzlich Inspiration.</span>
<span id="cb120-79"><a href="#cb120-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-80"><a href="#cb120-80" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Data visualization with ggplot2 :: Cheat Sheet</span><span class="co">](https://rstudio.github.io/cheatsheets/html/data-visualization.html)</span> -- als Überblick über alles was eigentlich in <span class="in">`ggplot`</span> möglich ist. Du kriegst dann nochmal ein Überblick über die <span class="in">`geom`</span>e, die es gibt und wie die einzelnen Funktionen und Möglichkeiten miteinander interagieren. Du kannst dir das Cheat Sheet auch auf Deutsch runterladen.\</span>
<span id="cb120-81"><a href="#cb120-81" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">R Charts by R Coder</span><span class="co">](https://r-charts.com/)</span> -- ein großer Überblick über alle möglichen Abbildungen sortiert nach verschiedenen Kategorien. Hier würde ich auf jeden Fall mal drüber schauen, dann kriegst du nochmal eine Idee was neben <span class="in">`ggplot`</span> noch so alles geht. Ich finde die Seite immer sehr inspirierend.</span>
<span id="cb120-82"><a href="#cb120-82" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">ALL YOUR FIGURE ARE BELONG TO US</span><span class="co">](https://yutannihilation.github.io/allYourFigureAreBelongToUs/)</span> ist eine weitere tolle Übersicht an möglichen Abbildungen in <span class="in">`{ggplot}`</span> Universum. Die Übersicht zeigt nochmal verschiedene R Pakte mit den entsprechenden möglichen Abbildungen.</span>
<span id="cb120-83"><a href="#cb120-83" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">sjPlot - Data Visualization for Statistics in Social Science</span><span class="co">](https://strengejacke.github.io/sjPlot/)</span> -- auch hier geitbes dann die Möglichkeit nochmal etwas anders auf die Visualisierung zu schauen. Denn hier haben wir dann die Möglichkeiten der Sozialwissenschaften mehr abgedeckt. Das mag insbesondere im Bereich von Fragebögen und Marketing von Interesse sein.</span>
<span id="cb120-84"><a href="#cb120-84" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Als spannende zusätzlichen Ressourcen seinen das <span class="co">[</span><span class="ot">R Paket `{cowplot}`</span><span class="co">](https://wilkelab.org/cowplot/index.html)</span> sowie das <span class="co">[</span><span class="ot">R Paket `{ggpubr}`</span><span class="co">](https://rpkgs.datanovia.com/ggpubr/index.html)</span> genannt. Besonders das Paket <span class="in">`cowplot`</span> liefert noch schöne Formatierungsmöglichkeiten wobei dann <span class="in">`ggpubr`</span> statistische Test mit der Visualisierung verbindet.</span>
<span id="cb120-85"><a href="#cb120-85" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">{plotly} R Open Source Graphing Library</span><span class="co">](https://plotly.com/r/)</span> sowie im besonderen dann die Seite <span class="co">[</span><span class="ot">Getting Started with {plotly} in {ggplot2}</span><span class="co">](https://plotly.com/ggplot2/getting-started/)</span> liefert dann interaktive Abbildungen, wo du dann direkt hereinzoomen kannst. Das ist bei sehr großen Abbildungen immer sehr praktisch. Auch kannst du die Werte einer einzelnen Beobachtung gleich im Plot ablesen.</span>
<span id="cb120-86"><a href="#cb120-86" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">How to create BBC style graphics</span><span class="co">](https://bbc.github.io/rcookbook/)</span> -- einmal als ein Beispiel für die Anwendung von <span class="in">`ggplot`</span> in der Wirtschaft und Data Science. Auch hier sieht man schön die Ideen die möglich sind.</span>
<span id="cb120-87"><a href="#cb120-87" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Visualizing Distributions with Raincloud Plots (and How to Create Them with ggplot2)</span><span class="co">](https://www.cedricscherer.com/2021/06/06/visualizing-distributions-with-raincloud-plots-and-how-to-create-them-with-ggplot2/)</span> -- manchmal ist dann der Barplot oder Dynamiteplot dann doch irgendwie nicht das richtige Werkzeug um die Daten zu zeigen. Daher hier nochmal der Blogpost mit einer Diskussion was neben dem Säulendiagramm noch so alles gehen könnte.</span>
<span id="cb120-88"><a href="#cb120-88" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">ggplot Wizardry Hands-On</span><span class="co">](https://z3tt.github.io/OutlierConf2021/)</span> zeigt nochmal sher schön was alles in <span class="in">`{ggplot}`</span> geht, wenn die entsprechenden zusätzlichen Pakete geladen werden. Ich schaue auch hier immer mal wieder rein, wenn ich eine Abbildung besonders schön machen möchte. Hier liegt dann der Fokus auf dem <span class="co">[</span><span class="ot">R Paket`{gghalves}`</span><span class="co">](https://erocoar.github.io/gghalves/)</span> sowie dem <span class="co">[</span><span class="ot">R Paket `{ggdist}`</span><span class="co">](https://mjskay.github.io/ggdist/)</span>.</span>
<span id="cb120-89"><a href="#cb120-89" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Publikation <span class="co">[</span><span class="ot">Error bars in experimental biology</span><span class="co">](https://rupress.org/jcb/article/177/1/7/34602/Error-bars-in-experimental-biology)</span> von @cumming2007error liefert nochmal einen Überblick über Fehlerbalken und welche Fehlerbalken man den nun nutzen sollte.</span>
<span id="cb120-90"><a href="#cb120-90" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-91"><a href="#cb120-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-92"><a href="#cb120-92" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb120-93"><a href="#cb120-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-94"><a href="#cb120-94" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb120-95"><a href="#cb120-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-96"><a href="#cb120-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb120-97"><a href="#cb120-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb120-98"><a href="#cb120-98" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb120-99"><a href="#cb120-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-100"><a href="#cb120-100" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, readxl, ggmosaic, </span>
<span id="cb120-101"><a href="#cb120-101" aria-hidden="true" tabindex="-1"></a>               janitor, see, patchwork, latex2exp, ggbeeswarm,</span>
<span id="cb120-102"><a href="#cb120-102" aria-hidden="true" tabindex="-1"></a>               ggdist, gghalves, ggbreak, duke, wesanderson, </span>
<span id="cb120-103"><a href="#cb120-103" aria-hidden="true" tabindex="-1"></a>               tidyplots, conflicted)</span>
<span id="cb120-104"><a href="#cb120-104" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>summarise)</span>
<span id="cb120-105"><a href="#cb120-105" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span>
<span id="cb120-106"><a href="#cb120-106" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(latex2exp<span class="sc">::</span>TeX)</span>
<span id="cb120-107"><a href="#cb120-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-108"><a href="#cb120-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-109"><a href="#cb120-109" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb120-110"><a href="#cb120-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-111"><a href="#cb120-111" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb120-112"><a href="#cb120-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-113"><a href="#cb120-113" aria-hidden="true" tabindex="-1"></a>Wir immer bringe ich hier ein paar Datensätze mit damit wir dann verstehen, was eigentlich in den folgenden Visualisierungen in <span class="in">`{ggplot}`</span> und den entsprechenden zusätzlichen R Paketen passiert. Ich zeige hier an den Daten nur die Anwendung in R. Deshalb fehlen dann hier auch die Mittelwerte und andere deskriptive Maßzahlen. Schauen wir jetzt also mal in unsere Beispieldaten für die einfaktorielle und zweifaktorielle Datenanalyse rein. Was heißt das nochmal? Wenn wir einen einfaktoriellen Datensatz vorliegen haben, dann haben wir nur einen Behandlunsgfaktor. Bei einem zweifaktorielle Datenanalyse betrachten wir eben dann zwei Behandlungen. Es wird dann aber gleich in den Beispielen klarer.</span>
<span id="cb120-114"><a href="#cb120-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-115"><a href="#cb120-115" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Einfaktorieller Datensatz {.unnumbered .unlisted}</span></span>
<span id="cb120-116"><a href="#cb120-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-117"><a href="#cb120-117" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit einem einfaktoriellen Datensatz. Wir haben hier als Messwert die Sprungweite von Flöhen in <span class="sc">\[</span>cm<span class="sc">\]</span> vorliegen. Wissen wollen wir, ob sich die Sprungweite für drei verschiedene Floharten unterscheidet. Damit ist dann in unserem Modell der Faktor <span class="in">`animal`</span> und die Sprungweite <span class="in">`jump_length`</span> als Messwert. Ich lade einmal die Daten in das Objekt <span class="in">`fac1_tbl`</span>.</span>
<span id="cb120-118"><a href="#cb120-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-121"><a href="#cb120-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-122"><a href="#cb120-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb120-123"><a href="#cb120-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-124"><a href="#cb120-124" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb120-125"><a href="#cb120-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span>
<span id="cb120-126"><a href="#cb120-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-127"><a href="#cb120-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-128"><a href="#cb120-128" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns die Daten einmal in der folgenden Tabelle als Auszug einmal an. Wichtig ist hier nochmal, dass du eben einen Faktor <span class="in">`animal`</span> mit drei Leveln also Gruppen vorliegen hast. Wir wollen jetzt die drei Tierarten hinsichtlich ihrer Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> miteinander vergleichen.</span>
<span id="cb120-129"><a href="#cb120-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-132"><a href="#cb120-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-133"><a href="#cb120-133" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb120-134"><a href="#cb120-134" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb120-135"><a href="#cb120-135" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb120-136"><a href="#cb120-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1fac-table</span></span>
<span id="cb120-137"><a href="#cb120-137" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle der Sprungweiten in [cm] als Messwert $y$ von Hunde-, Katzen- und Fuchsflöhen. Der Datensatz ist einfaktoriell, da wir nur einen Faktor vorliegen haben."</span></span>
<span id="cb120-138"><a href="#cb120-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-139"><a href="#cb120-139" aria-hidden="true" tabindex="-1"></a>fac1_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_fox.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb120-140"><a href="#cb120-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) </span>
<span id="cb120-141"><a href="#cb120-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-142"><a href="#cb120-142" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb120-143"><a href="#cb120-143" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fac1_raw_tbl)),</span>
<span id="cb120-144"><a href="#cb120-144" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb120-145"><a href="#cb120-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb120-146"><a href="#cb120-146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-147"><a href="#cb120-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-148"><a href="#cb120-148" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Zweifaktorieller Datensatz {.unnumbered .unlisted}</span></span>
<span id="cb120-149"><a href="#cb120-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-150"><a href="#cb120-150" aria-hidden="true" tabindex="-1"></a>Neben dem einfaktoriellen Datensatz wollen wir uns noch den häufigeren Fall mit zwei Faktoren anschauen. Wir haben also nicht nur die drei Floharten vorliegen und wollen wissen ob diese unterschiedlich weit springen. Darüber hinaus haben wir noch einen zweiten Faktor gewählt. Wir haben die Sprungweiten der Hunde-, Katzen- und Fuchsflöhe nämlich an zwei Messorten, der Stadt und dem Dorf, gemessen. Dadurch haben wir jetzt den Faktor <span class="in">`animal`</span> und den Faktor <span class="in">`site`</span> vorliegen. Wiederum fragen wir uns, ob sich die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> der drei Floharten in den beiden Messorten unterscheidet. Im Folgenden lade ich einmal den Datensatz in das Objekt <span class="in">`fac2_tbl`</span>.</span>
<span id="cb120-151"><a href="#cb120-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-154"><a href="#cb120-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-155"><a href="#cb120-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb120-156"><a href="#cb120-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-157"><a href="#cb120-157" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_length_weight.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb120-158"><a href="#cb120-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, sex, weight, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb120-159"><a href="#cb120-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb120-160"><a href="#cb120-160" aria-hidden="true" tabindex="-1"></a>         <span class="at">sex =</span> <span class="fu">as_factor</span>(sex))</span>
<span id="cb120-161"><a href="#cb120-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-162"><a href="#cb120-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-163"><a href="#cb120-163" aria-hidden="true" tabindex="-1"></a>Betrachten wir als erstes einen Auszug aus der Datentabelle. Wir haben hier als Messwert oder Outcome $y$ die Sprungweite <span class="in">`jump_length`</span> vorliegen. Als ersten Faktor die Variable <span class="in">`animal`</span> und als zweiten Faktor die Variable <span class="in">`sex`</span> festgelegt.</span>
<span id="cb120-164"><a href="#cb120-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-167"><a href="#cb120-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-168"><a href="#cb120-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb120-169"><a href="#cb120-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb120-170"><a href="#cb120-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb120-171"><a href="#cb120-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-2fac-table</span></span>
<span id="cb120-172"><a href="#cb120-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle der Sprungweiten in [cm] als Messwert $y$ von Hunde-, Katzen- und Fuchsflöhen an zwei verschiedenen Messorten Stadt und Dorf. Der Datensatz ist zweifaktoriell, da wir einen Behandlungsfaktor mit `animal` und einen zweiten Faktor mit `site` vorliegen haben."</span></span>
<span id="cb120-173"><a href="#cb120-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-174"><a href="#cb120-174" aria-hidden="true" tabindex="-1"></a>fac2_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat_length_weight.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb120-175"><a href="#cb120-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, sex, weight, jump_length)</span>
<span id="cb120-176"><a href="#cb120-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-177"><a href="#cb120-177" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fac2_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb120-178"><a href="#cb120-178" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fac2_raw_tbl)),</span>
<span id="cb120-179"><a href="#cb120-179" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fac2_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb120-180"><a href="#cb120-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb120-181"><a href="#cb120-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-182"><a href="#cb120-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-183"><a href="#cb120-183" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Der Gummibärchendatensatz {.unnumbered .unlisted}</span></span>
<span id="cb120-184"><a href="#cb120-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-185"><a href="#cb120-185" aria-hidden="true" tabindex="-1"></a>Wir brauchen dann ab und an auch nochmal mehr Datenpunkte, daher nehmen wir auch einmal den Gummibärchendatensatz und schauen uns dort die Variablen <span class="in">`gender`</span>, <span class="in">`height`</span> und <span class="in">`age`</span> einmal genauer an. Wie immer nutzen wir die Funktion <span class="in">`select()`</span> um die Spalten zu selektieren. Abschließend verwandeln wir das Geschlecht <span class="in">`gender`</span> noch in einen Faktor und entfernen alle fehlenden Werte mit <span class="in">`na.omit()`</span>.</span>
<span id="cb120-186"><a href="#cb120-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-189"><a href="#cb120-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-190"><a href="#cb120-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb120-191"><a href="#cb120-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-192"><a href="#cb120-192" aria-hidden="true" tabindex="-1"></a>gummi_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/gummibears.xlsx"</span>)  <span class="sc">|&gt;</span></span>
<span id="cb120-193"><a href="#cb120-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gender, height, age) <span class="sc">|&gt;</span> </span>
<span id="cb120-194"><a href="#cb120-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"männlich"</span>, <span class="st">"weiblich"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb120-195"><a href="#cb120-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb120-196"><a href="#cb120-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-197"><a href="#cb120-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-198"><a href="#cb120-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-199"><a href="#cb120-199" aria-hidden="true" tabindex="-1"></a>Und hier dann einmal der ausgewählte Datensatz der Gummibärchendaten. Ich zeige hier nur die ersten sieben Zeilen als Ausschnitt, die eigentlichen Daten sind mit $n = <span class="in">`r nrow(gummi_tbl)`</span>$ Beobachtungen viel größer.</span>
<span id="cb120-200"><a href="#cb120-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-203"><a href="#cb120-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-204"><a href="#cb120-204" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb120-205"><a href="#cb120-205" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-gummi-ggplot</span></span>
<span id="cb120-206"><a href="#cb120-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle mit dem Auzug der Gummibärchendaten von den ersten sieben Beobachtungen für das Geschlecht, die Körpergröße und dem Alter."</span></span>
<span id="cb120-207"><a href="#cb120-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-208"><a href="#cb120-208" aria-hidden="true" tabindex="-1"></a>gummi_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/gummibears.xlsx"</span>)  <span class="sc">|&gt;</span></span>
<span id="cb120-209"><a href="#cb120-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gender, height, age)</span>
<span id="cb120-210"><a href="#cb120-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-211"><a href="#cb120-211" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(gummi_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb120-212"><a href="#cb120-212" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(gummi_raw_tbl)),</span>
<span id="cb120-213"><a href="#cb120-213" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(gummi_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb120-214"><a href="#cb120-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb120-215"><a href="#cb120-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-216"><a href="#cb120-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-217"><a href="#cb120-217" aria-hidden="true" tabindex="-1"></a><span class="fu">## Grundlagen im...</span></span>
<span id="cb120-218"><a href="#cb120-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-219"><a href="#cb120-219" aria-hidden="true" tabindex="-1"></a><span class="fu">### R Paket `{ggplot}`</span></span>
<span id="cb120-220"><a href="#cb120-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-221"><a href="#cb120-221" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/SGwSVzJ9C-s &gt;}}</span>
<span id="cb120-222"><a href="#cb120-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-223"><a href="#cb120-223" aria-hidden="true" tabindex="-1"></a>Wir nutzen in R das R Paket <span class="in">`{ggplot2}`</span> um unsere Daten zu visualisieren. Die zentrale Idee von <span class="in">`{ggplot2}`</span> ist, dass wir uns eine Abbildung wie ein Sandwich bauen. Zuerst legen wir eine Scheibe Brot hin und legen uns dann Scheibe für Scheibe weitere Schichten übereinander. Oder die Idee eines Bildes, wo wir erst die Leinwand definieren und dann Farbschicht über Farbschicht auftragen. Im Gegensatz zu dem Pipe-Operator <span class="in">`|&gt;`</span> nutzt <span class="in">`{ggplot2}`</span> den Operator <span class="in">`+`</span> um die verschiedenen Funktionen (<span class="in">`geom_`</span>) miteinander zu verbinden. Das Konzept von <span class="in">`{ggplot2}`</span>ist schlecht zu be*schreiben* deshalb habe ich auch noch zwei Videos hierfür gemacht. Um den Prozess von <span class="in">`{ggplot2}`</span> zu visualisieren - aber wie immer, nutze was du brauchst.</span>
<span id="cb120-224"><a href="#cb120-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-225"><a href="#cb120-225" aria-hidden="true" tabindex="-1"></a>Erstellen wir also erstmal unseren erste Visualisierung in dem R Paket <span class="in">`{ggplot2}`</span>. Im Folgenden spreche ich dann aber immer von <span class="in">`{ggplot}`</span>. Die Funktion <span class="in">`ggplot()`</span> ist die zentrale Funktion, die die Leinwand erschafft auf der wir dann verschiedene Schichten aufbringen werden. Diese Schichten heißen <span class="in">`geom`</span>. Es gibt nicht nur ein <span class="in">`geom`</span> sondern mehrere. Zum Beispiel das <span class="in">`geom_boxplot()`</span> für die Erstellung von Boxplots, das <span class="in">`geom_histogram()`</span> für die Erstellung von Histogrammen. <span class="co">[</span><span class="ot">Die Auswahl ist riesig</span><span class="co">](https://ggplot2.tidyverse.org/reference/index.html)</span>. Die einzelnen Schichten werden dann über den Operator <span class="in">`+`</span> miteinander verbunden. Soviel erstmal zur Trockenübung. Schauen wir uns das ganze einmal an einem Beispiel an. Dafür müssen wir dann erstmal einen Datensatz laden, damit wir auch etwas zum abbilden haben.</span>
<span id="cb120-226"><a href="#cb120-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-227"><a href="#cb120-227" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/SRRQQO3DXtc &gt;}}</span>
<span id="cb120-228"><a href="#cb120-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-229"><a href="#cb120-229" aria-hidden="true" tabindex="-1"></a>Wie immer empfehle ich dir dann auch das entsprechende Video auf YouTube anzuschauen. In Textform ist eine echte Herausforderung zu erklären wie man Plots baut. Der folgende R Code erstellt die Leinwand in der @fig-ggplot-1 für die folgende, zusätzliches Schichten (<span class="in">`geom`</span>). Wir haben also immer erst eine leere Leinwand auf der wir dann zusätzlich <span class="in">`geom`</span>e plotten. Wir bauen uns sozusagen ein Sandwich.</span>
<span id="cb120-230"><a href="#cb120-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-233"><a href="#cb120-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-234"><a href="#cb120-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb120-235"><a href="#cb120-235" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-236"><a href="#cb120-236" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb120-237"><a href="#cb120-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-238"><a href="#cb120-238" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb120-239"><a href="#cb120-239" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal , <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb120-240"><a href="#cb120-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb120-241"><a href="#cb120-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-242"><a href="#cb120-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-243"><a href="#cb120-243" aria-hidden="true" tabindex="-1"></a>Wir schauen uns einmal den Code im Detail an.</span>
<span id="cb120-244"><a href="#cb120-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-245"><a href="#cb120-245" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ggplot`</span> ruft die Funktion auf. Die Funktion ist dafür da den Plot zu zeichnen.</span>
<span id="cb120-246"><a href="#cb120-246" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`data = fac1_tbl`</span> benennt den Datensatz aus dem der Plot gebaut werden soll.</span>
<span id="cb120-247"><a href="#cb120-247" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`aes()`</span>ist die Abkürzung für *aesthetics* und beschreibt, was auf die $x$-Achse soll, was auf die $y$-Achse soll sowie ob es noch andere Faktoren in den Daten gibt. Wir können nämlich noch nach anderen Spalten die Abbildung einfärben oder anderweitig ändern.</span>
<span id="cb120-248"><a href="#cb120-248" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`x`</span> braucht den Spaltennamen für die Variable auf der $x$-Achse.</span>
<span id="cb120-249"><a href="#cb120-249" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`y`</span> braucht den Spaltennamen für die Variable auf der $y$-Achse.</span>
<span id="cb120-250"><a href="#cb120-250" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`+ theme_minimal()`</span> setzt das Canvas oder die Leinwand auf schwarz/weiß. Sonst wäre die Leinwand flächig grau.</span>
<span id="cb120-251"><a href="#cb120-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-252"><a href="#cb120-252" aria-hidden="true" tabindex="-1"></a>Mit Faktoren meine ich hier andere Gruppenvariablen. Variablen sind ein anderes Wort für Spalten. Also Variablen die wir mit <span class="in">`as_factor`</span> erschaffen haben und die uns noch mehr über unsere Daten dann verraten können. Hier ist es dann etwas abstrakt, aber es wird dann später in der Anwendung klarer.</span>
<span id="cb120-253"><a href="#cb120-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-256"><a href="#cb120-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-257"><a href="#cb120-257" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb120-258"><a href="#cb120-258" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb120-259"><a href="#cb120-259" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-1</span></span>
<span id="cb120-260"><a href="#cb120-260" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb120-261"><a href="#cb120-261" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb120-262"><a href="#cb120-262" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb120-263"><a href="#cb120-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Leere ggplot() Leinwand mit den Spalten `animal` und `jump_length` aus dem Datensatz `fac1_tbl`. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb120-264"><a href="#cb120-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-265"><a href="#cb120-265" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb120-266"><a href="#cb120-266" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal , <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb120-267"><a href="#cb120-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb120-268"><a href="#cb120-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-269"><a href="#cb120-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-270"><a href="#cb120-270" aria-hidden="true" tabindex="-1"></a>Am Ende sehen wir, dass wir nichts sehen. In der @fig-ggplot-1 ist nichts dargestellt. Der Grund ist, dass wir noch kein <span class="in">`geom`</span> hinzugefügt haben. Das <span class="in">`geom`</span> beschreibt nun wie die Zahlen in der Datentabelle <span class="in">`fac1_tbl`</span> visualisiert werden sollen. Wir habe eine sehr große Auswahl an <span class="in">`geom`</span>en, deshalb gibt es gleich einmal eine Auswahl an Abbildungen. Du findest dann auch weitere Optionen in <span class="in">`{ggplot}`</span> im <span class="co">[</span><span class="ot">Kapitel zum `{ggplot}` Cookbook</span><span class="co">](#sec-ggplot-cookbook)</span>.</span>
<span id="cb120-271"><a href="#cb120-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-272"><a href="#cb120-272" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="minimal"}</span>
<span id="cb120-273"><a href="#cb120-273" aria-hidden="true" tabindex="-1"></a>Auf der Seite <span class="co">[</span><span class="ot">ggplot2 extensions</span><span class="co">](https://exts.ggplot2.tidyverse.org/gallery/)</span> gibt es noch eine Vielzahl an weiteren tollen Möglichkeiten zu entdecken! Einfach durch die Galerie mit über 150+ Erweiterungen streifen und sich inspirieren lassen!</span>
<span id="cb120-274"><a href="#cb120-274" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-275"><a href="#cb120-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-276"><a href="#cb120-276" aria-hidden="true" tabindex="-1"></a><span class="fu">### R Paket `{tidyplots}`</span></span>
<span id="cb120-277"><a href="#cb120-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-278"><a href="#cb120-278" aria-hidden="true" tabindex="-1"></a>Fortschritt lässt sich ja nicht aufhalten und was am Ende dann fortschrittlich ist, ist dann ja wieder die Frage. Manchmal brauchen wir einfach nicht die ganzen Funktionen und Möglichkeiten, die uns <span class="in">`{ggplot}`</span> liefert. Wir wollen dann irgendwie alles etwas einfacher haben. In diese Lücke stößt die Arbeit von @engler2025tidyplots mit dem <span class="co">[</span><span class="ot">R Paket `{tidyplots}`</span><span class="co">](https://jbengler.github.io/tidyplots/)</span>. Was macht also da R Paket <span class="in">`{tidyplots}`</span> anders? Zum einen vereinfacht es die Benutzung von <span class="in">`{ggplot}`</span>. Du hast nur noch eine große Auswahl, aber keien erschlagende Auswahl mehr. Dennoch basiert <span class="in">`{tidyplots}`</span> auf <span class="in">`{ggplot}`</span> und somit sind die Abbildungen auch echt schön und gut anzusehen. Am Ende ist es dann eine Geschmacksfrage was dir besser gefällt. Mich haben die <span class="in">`{tidyplots}`</span> so sehr überzeugt, dass ich die <span class="in">`{tidyplots}`</span> auf jeden Fall hier einmal vorstellen möchte. Vielleicht brauchst du auch nur diese Art der Darstellung und nicht die volle Batterie der Funktionen von <span class="in">`{ggplot}`</span>. Deshalb vielleicht auch hier der Disclaimer, vieles geht dann schon, aber ich nutze weiterhin für viele Anwendunsgfälle dann doch <span class="in">`{ggplot}`</span>.</span>
<span id="cb120-279"><a href="#cb120-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-280"><a href="#cb120-280" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb120-281"><a href="#cb120-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mehr Informationen und Tipps</span></span>
<span id="cb120-282"><a href="#cb120-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-283"><a href="#cb120-283" aria-hidden="true" tabindex="-1"></a>Auch hier kann ich nicht alles erklären und auch die beispielhaften Abbildungen in den folgenden Abschnitten können das nicht. Daher schaue dir doch nochmal die Hilfes von <span class="in">`{tidyplots}`</span> an.</span>
<span id="cb120-284"><a href="#cb120-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-285"><a href="#cb120-285" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Hilfeseite <span class="co">[</span><span class="ot">Get started</span><span class="co">](https://jbengler.github.io/tidyplots/articles/tidyplots.html)</span> liefert dir einen ersten Überblick über die Funktionen und Möglichkeiten.</span>
<span id="cb120-286"><a href="#cb120-286" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Es gibt auch eine Reihe von tollen <span class="co">[</span><span class="ot">Use cases</span><span class="co">](https://tidyplots.org/use-cases/)</span>, die dir ermöglichen einmal zu schauen was alles so geht.</span>
<span id="cb120-287"><a href="#cb120-287" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das <span class="co">[</span><span class="ot">`{tidyplots}` Cheatsheet</span><span class="co">](https://tidyplots.org/tidyplots-cheatsheet-v1.pdf)</span> hilft am Ende dann nur, wenn du dich schon mit den Funktionen auseinandergestezt hast. Sonst finde ich es etwas unübersichtlich.</span>
<span id="cb120-288"><a href="#cb120-288" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-289"><a href="#cb120-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-290"><a href="#cb120-290" aria-hidden="true" tabindex="-1"></a>Fangen wir einmal mit dem Standardaufruf in <span class="in">`{tidyplots}`</span> an. Wir nutzen die Funktion <span class="in">`tidyplot()`</span>, ohne das <span class="in">`s`</span> wie im Namen des Pakets, um einen <span class="in">`tidyplot`</span> zu erstellen. Wichtig ist hier nocoh, dass wir nicht das Pluszeichen <span class="in">`+`</span> nutzen sondern alles mit dem Pipe-Operator <span class="in">`|&gt;`</span> erledigen. Hier siehst du die Verwendung einmal mit der Funktion <span class="in">`adjust_size()`</span>, die es uns erlaubt die Größe der Abbildung zu steuern.</span>
<span id="cb120-291"><a href="#cb120-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-294"><a href="#cb120-294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-295"><a href="#cb120-295" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb120-296"><a href="#cb120-296" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb120-297"><a href="#cb120-297" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb120-298"><a href="#cb120-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-299"><a href="#cb120-299" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb120-300"><a href="#cb120-300" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal , <span class="at">y =</span> jump_length) <span class="sc">|&gt;</span></span>
<span id="cb120-301"><a href="#cb120-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>)</span>
<span id="cb120-302"><a href="#cb120-302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-303"><a href="#cb120-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-304"><a href="#cb120-304" aria-hidden="true" tabindex="-1"></a>Wir schauen uns einmal den Code im Detail an.</span>
<span id="cb120-305"><a href="#cb120-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-306"><a href="#cb120-306" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`tidyplot`</span> ruft die Funktion auf. Die Funktion ist dafür da den Plot zu zeichnen.</span>
<span id="cb120-307"><a href="#cb120-307" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`data = fac1_tbl`</span> benennt den Datensatz aus dem der Plot gebaut werden soll.</span>
<span id="cb120-308"><a href="#cb120-308" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`x`</span> braucht den Spaltennamen für die Variable auf der $x$-Achse.</span>
<span id="cb120-309"><a href="#cb120-309" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`y`</span> braucht den Spaltennamen für die Variable auf der $y$-Achse.</span>
<span id="cb120-310"><a href="#cb120-310" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`adjust_size(width = NA, height = NA)`</span> ist hier nochmal wichtig, da wir hiermit die Größe der Abbildung kontrollieren können. Ich möchte hier maximale Größe, deshalb sind die Breite <span class="in">`width`</span> und Höhe <span class="in">`height`</span> auf den Wert <span class="in">`NA`</span> gesetzt.</span>
<span id="cb120-311"><a href="#cb120-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-312"><a href="#cb120-312" aria-hidden="true" tabindex="-1"></a>Wenn wir jetzt den Code ausführen, erhalten wir folgende leere Abbildung. Wir können dann einfach noch weitere Layer, wie auch bei <span class="in">`{ggplot}`</span> ergänzen. Mehr dazu dann in den jeweiligen Tabs in den folgenden beispielhaften Abbildungen, die wir dann häufig nutzen.</span>
<span id="cb120-313"><a href="#cb120-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-316"><a href="#cb120-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb120-317"><a href="#cb120-317" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb120-318"><a href="#cb120-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb120-319"><a href="#cb120-319" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-tidyplot-1</span></span>
<span id="cb120-320"><a href="#cb120-320" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb120-321"><a href="#cb120-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb120-322"><a href="#cb120-322" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb120-323"><a href="#cb120-323" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Leere tidyplot() Leinwand mit den Spalten `animal` und `jump_length` aus dem Datensatz `fac1_tbl`. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb120-324"><a href="#cb120-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-325"><a href="#cb120-325" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb120-326"><a href="#cb120-326" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal , <span class="at">y =</span> jump_length) <span class="sc">|&gt;</span></span>
<span id="cb120-327"><a href="#cb120-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) <span class="sc">|&gt;</span> </span>
<span id="cb120-328"><a href="#cb120-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>)</span>
<span id="cb120-329"><a href="#cb120-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb120-330"><a href="#cb120-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-331"><a href="#cb120-331" aria-hidden="true" tabindex="-1"></a>Du findest dann auch weitere Optionen in <span class="in">`{tidyplot}`</span> im <span class="co">[</span><span class="ot">Kapitel zum `{ggplot}` Cookbook</span><span class="co">](#sec-ggplot-cookbook)</span>. Oder aber eben auf den Hilfeseiten des <span class="co">[</span><span class="ot">R Paket `{tidyplots}`</span><span class="co">](https://jbengler.github.io/tidyplots/)</span>. Dann fangen wir einmal an uns die häufigsten Abbildungen in der explorativen Datenanalyse anzuschauen.</span>
<span id="cb120-332"><a href="#cb120-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-333"><a href="#cb120-333" aria-hidden="true" tabindex="-1"></a><span class="fu">## Die häufigsten Abbildungen</span></span>
<span id="cb120-334"><a href="#cb120-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-335"><a href="#cb120-335" aria-hidden="true" tabindex="-1"></a>Im Folgenden gehen wir dann einmal die wichtigsten Abbildungen einmal durch. Viele der Abbildungen kennst du vielleicht schon und dann musst du hier nur noch schauen, wie die Abbildungen in <span class="in">`ggplot`</span> zu realisieren sind. Ansonsten gilt wie immer, es ist nur ein kleiner Ausschnitt, du findest auf der <span class="co">[</span><span class="ot">Hilfeseite von `ggplot`</span><span class="co">](https://ggplot2.tidyverse.org/index.html)</span> eine sehr viel größere Übersicht.</span>
<span id="cb120-336"><a href="#cb120-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-337"><a href="#cb120-337" aria-hidden="true" tabindex="-1"></a><span class="fu">### Barplot {#sec-eda-barplot}</span></span>
<span id="cb120-338"><a href="#cb120-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-339"><a href="#cb120-339" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/2ivNhsPJKY8 &gt;}}</span>
<span id="cb120-340"><a href="#cb120-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-341"><a href="#cb120-341" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-barplot.qmd &gt;}}</span>
<span id="cb120-342"><a href="#cb120-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-343"><a href="#cb120-343" aria-hidden="true" tabindex="-1"></a><span class="fu">### Boxplot {#sec-eda-boxplot}</span></span>
<span id="cb120-344"><a href="#cb120-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-345"><a href="#cb120-345" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/qgKBaBuM1n0 &gt;}}</span>
<span id="cb120-346"><a href="#cb120-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-347"><a href="#cb120-347" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-boxplot.qmd &gt;}}</span>
<span id="cb120-348"><a href="#cb120-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-349"><a href="#cb120-349" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scatterplot {#sec-eda-scatter}</span></span>
<span id="cb120-350"><a href="#cb120-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-351"><a href="#cb120-351" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/eGtLyR2vxAM &gt;}}</span>
<span id="cb120-352"><a href="#cb120-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-353"><a href="#cb120-353" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-scatterplot.qmd &gt;}}</span>
<span id="cb120-354"><a href="#cb120-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-355"><a href="#cb120-355" aria-hidden="true" tabindex="-1"></a><span class="fu">### Histogramm {#sec-eda-histogramm}</span></span>
<span id="cb120-356"><a href="#cb120-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-357"><a href="#cb120-357" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/lENH6vv6ir8 &gt;}}</span>
<span id="cb120-358"><a href="#cb120-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-359"><a href="#cb120-359" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-histogram.qmd &gt;}}</span>
<span id="cb120-360"><a href="#cb120-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-361"><a href="#cb120-361" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mosaicplot {#sec-eda-mosaic}</span></span>
<span id="cb120-362"><a href="#cb120-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-363"><a href="#cb120-363" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-mosaic.qmd &gt;}}</span>
<span id="cb120-364"><a href="#cb120-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-365"><a href="#cb120-365" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dotplot, Beeswarm und Raincloud Plot {#sec-eda-dotplot}</span></span>
<span id="cb120-366"><a href="#cb120-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-367"><a href="#cb120-367" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-dotplot.qmd &gt;}}</span>
<span id="cb120-368"><a href="#cb120-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-369"><a href="#cb120-369" aria-hidden="true" tabindex="-1"></a><span class="fu">### Violinplot {#sec-eda-violinplot}</span></span>
<span id="cb120-370"><a href="#cb120-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-371"><a href="#cb120-371" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-violinplot.qmd &gt;}}</span>
<span id="cb120-372"><a href="#cb120-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-373"><a href="#cb120-373" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Optionen in `{ggplot}`</span></span>
<span id="cb120-374"><a href="#cb120-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-375"><a href="#cb120-375" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="minimal"}</span>
<span id="cb120-376"><a href="#cb120-376" aria-hidden="true" tabindex="-1"></a>Besuche auch <span class="co">[</span><span class="ot">ggplot2 extensions</span><span class="co">](https://exts.ggplot2.tidyverse.org/gallery/)</span> für weitere tolle Möglichkeiten! Dort gibt es eine große Auswahl an Erweiterungen, die dich inspierieren mögen.</span>
<span id="cb120-377"><a href="#cb120-377" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb120-378"><a href="#cb120-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-379"><a href="#cb120-379" aria-hidden="true" tabindex="-1"></a>Du findest dann auch weitere Optionen in <span class="in">`{ggplot}`</span> im <span class="co">[</span><span class="ot">Kapitel zum `{ggplot}` Cookbook</span><span class="co">](#sec-ggplot-cookbook)</span>. Ich habe einen Teil der Optionen dann in das Programmieren ausgelagert, da wir dann dort mehr machen können und dieses Kapitel nicht zu voll wird. Es ist auch so, dass du in allen anderen Kapiteln zur Anwendung und statistischen Analyse dann entsprechende Visualisierungen in <span class="in">`{ggplot}`</span> findest. Du musst dann immer schauen, was zu deiner wissenschaftlichen Fragestellung passt. Ich habe hier nicht alles aufgenommen, da es dann immer dieses Kapitel gesprengt hat. Hier geht es dann eben um die explorative Datenanalyse und nicht um das statistische Modellieren.</span>
<span id="cb120-380"><a href="#cb120-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-381"><a href="#cb120-381" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code></pre></div><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/eda-ggplot.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/eda-ggplot.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
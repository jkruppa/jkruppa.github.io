<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Skript Bio Data Science - Appendix A — Beispielhafte Auswertungen</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./app-r-tutorial.html" rel="next">
<link href="./classification-neural-networks.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken"
  }
}</script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Appendix A — Beispielhafte Auswertungen</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skript Bio Data Science</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Willkommen</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Literatur</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Einführung</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">Datenbeispiele</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Von Flöhen auf Hunden und Katzen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-foxes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-length-weight.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von vielen Flöhen auf Hunden und Katzen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">Programmieren in R</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Buchstaben und Zahlen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Mit <code>purrr</code> und <code>furrr</code></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">Explorative Datenanalyse</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface.html" class="sidebar-item-text sidebar-link">Frequentistische Hypothesentests</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der t-Test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Die ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Friedman Test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Pre-Tests oder Vortest</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Multiple Vergleiche oder Post-hoc Tests</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">Grundlagen der linearen Regression</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Maßzahlen der Modelgüte</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Korrelation</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">Statistisches Modellieren</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Variablenselektion</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Ausreißer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Imputation fehlender Werte</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale logistische Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Logistische Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">Experimentelles Design</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Grundlagen der Versuchsplanung</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">Klassifikation oder maschinelles Lernen</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Data splitting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Data preprocessing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Decision trees</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Support vector machines</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Neural networks</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">Anhang</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-example-analysis.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Beispielhafte Auswertungen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-r-tutorial.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Tutorium in R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-how-to-write.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Writing principles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-bewertungsbogen.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Bewertungsbogen</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./module.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Modulbeschreibung</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
<li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="toc-section-number">A.1</span>  Genutzte R Pakete</a></li>
  <li><a href="#sec-app-example-iso" id="toc-sec-app-example-iso" class="nav-link" data-scroll-target="#sec-app-example-iso"><span class="toc-section-number">A.2</span>  Isoplethendiagramm für Münster &amp; Osnabrück</a></li>
  <li><a href="#sec-app-example-number-groups" id="toc-sec-app-example-number-groups" class="nav-link" data-scroll-target="#sec-app-example-number-groups"><span class="toc-section-number">A.3</span>  Analyse von Anzahlen in zwei Gruppen</a></li>
  <li><a href="#sec-app-example-anova-inter" id="toc-sec-app-example-anova-inter" class="nav-link" data-scroll-target="#sec-app-example-anova-inter"><span class="toc-section-number">A.4</span>  Auswertung zweifaktorielle ANOVA mit Interaktion</a></li>
  <li><a href="#sec-mult-map-ght" id="toc-sec-mult-map-ght" class="nav-link" data-scroll-target="#sec-mult-map-ght"><span class="toc-section-number">A.5</span>  Multiples Testen mit Games Howell Test</a></li>
  <li><a href="#sec-root-quality" id="toc-sec-root-quality" class="nav-link" data-scroll-target="#sec-root-quality"><span class="toc-section-number">A.6</span>  Wurzelqualität in einem zweifaktoriellen Design</a></li>
  <li>
<a href="#sec-cutting" id="toc-sec-cutting" class="nav-link" data-scroll-target="#sec-cutting"><span class="toc-section-number">A.7</span>  Wachstum nach Rückschnitt mit Messwiederholung</a>
  <ul class="collapse">
<li><a href="#triebl%C3%A4nge" id="toc-trieblänge" class="nav-link" data-scroll-target="#triebl%C3%A4nge"><span class="toc-section-number">A.7.1</span>  Trieblänge</a></li>
  <li><a href="#bl%C3%BCtenanzahl" id="toc-blütenanzahl" class="nav-link" data-scroll-target="#bl%C3%BCtenanzahl"><span class="toc-section-number">A.7.2</span>  Blütenanzahl</a></li>
  </ul>
</li>
  <li><a href="#sec-tukeyHSD" id="toc-sec-tukeyHSD" class="nav-link" data-scroll-target="#sec-tukeyHSD"><span class="toc-section-number">A.8</span>  Einen TukeyHSD Test rechnen</a></li>
  <li><a href="#sec-plowing-data" id="toc-sec-plowing-data" class="nav-link" data-scroll-target="#sec-plowing-data"><span class="toc-section-number">A.9</span>  Auswertung von Pflugdaten mit <code>ggplot</code> Templates</a></li>
  <li><a href="#sec-app-mixed-cutting" id="toc-sec-app-mixed-cutting" class="nav-link" data-scroll-target="#sec-app-mixed-cutting"><span class="toc-section-number">A.10</span>  Auswertung mit Messwiederholungen</a></li>
  <li>
<a href="#sec-app-spinach-metal" id="toc-sec-app-spinach-metal" class="nav-link" data-scroll-target="#sec-app-spinach-metal"><span class="toc-section-number">A.11</span>  Spurenelemente in Spinatblättern und Stielen</a>
  <ul class="collapse">
<li><a href="#eisen-fe-und-blatt" id="toc-eisen-fe-und-blatt" class="nav-link" data-scroll-target="#eisen-fe-und-blatt"><span class="toc-section-number">A.11.1</span>  Eisen (Fe) und Blatt</a></li>
  <li><a href="#und-alles-aufeinmal" id="toc-und-alles-aufeinmal" class="nav-link" data-scroll-target="#und-alles-aufeinmal"><span class="toc-section-number">A.11.2</span>  Und alles aufeinmal…</a></li>
  </ul>
</li>
  <li><a href="#sec-app-logger" id="toc-sec-app-logger" class="nav-link" data-scroll-target="#sec-app-logger"><span class="toc-section-number">A.12</span>  Daten eines automatischen Loggers</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-beispiel-auswertung" class="quarto-section-identifier d-none d-lg-block">Appendix A — Beispielhafte Auswertungen</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="cell">

</div>
<p><em>Version vom January 03, 2023 um 18:37:37</em></p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Beispielhafte Auswertungen per Video
</div>
</div>
<div class="callout-body-container callout-body">
<p>Du findest auf YouTube in der Playlist <a href="https://www.youtube.com/playlist?list=PLe51bCp9JvEFZeYClBKad6yurjUzc8jXp">Spielweise in R (Level 3)</a> viele der Analysen hier einmal als Video. Ich werde zwar alles nochmal hier als Text aufschreiben, aber manchmal ist das Sehen und Hören dann einfacher.</p>
</div>
</div>
<p>Worum geht es in diesem Kapitel? Ich rechne hier fröhlich Dinge und präsentiere dann die Ergebnisse. Das heißt, du findest hier beispielhafte Auswertungen, die eventuell auch deine Problemstellung betreffen. Da <em>ich selber</em> meist keine Ahnung von der Biologie hinter den Experimenten habe, musst du mir nachsehen, dass ich hier nie zu einem echten biologischen Schluss oder Auswertung komme.</p>
<ul>
<li>In <a href="#sec-app-example-iso"><span>Kapitel&nbsp;A.2</span></a> schauen wir uns einmal die Erstellung eines Isoplethendiagramms für Münster &amp; Osnabrück aus den frei verfügbaren Daten des Deutschen Wetterdienstes an.</li>
<li>In <a href="#sec-app-example-number-groups"><span>Kapitel&nbsp;A.3</span></a> rechnen wir einmal ein simples Beispiel für Zähldaten in zwei Gruppen. Wir haben hier nicht wiederholt gezählt, sondern nur jeweils einmal an einer Stelle.</li>
<li>In <a href="#sec-app-example-anova-inter"><span>Kapitel&nbsp;A.4</span></a> rechnen wir nochmal eine zweifaktorielle ANOVA mit Interaktionsterm durch. Wir kriegen dann unser <em>Compact letter display</em> wie auch die Konfidenzintervalle wieder.</li>
<li>In <a href="#sec-mult-map-ght"><span>Kapitel&nbsp;A.5</span></a> rechnen wir einen Games Howell Test für normalverteilte Daten mit Varianzheterogenität. Hier hauen wir ein wenig auf die Pauke und rechnen alles in wenigen Zeilen mit der Funktion <code>map()</code>. War eine spaßige Auswerung für mich, da ich hier mal wieder programmieren üben konnte.</li>
<li>In <a href="#sec-root-quality"><span>Kapitel&nbsp;A.6</span></a> schauen wir uns ein größeres Beispiel für die Analyse von Wurzelbonituren an. Im Prinzip geht das natürlich auch alles für jede andere Bonitur. Wenn du eine andere Bonitur hast, kannst du natürlich auch den Weg der Analyse gehen.</li>
<li>In <a href="#sec-cutting"><span>Kapitel&nbsp;A.7</span></a> haben wir ein etwas komplexeres Beispiel für vier Outcomes, die an acht Terminen gemessen wurden. Wir sehen hier einmal, wie die Daten eingelesen werden und ein Korrelationsplot über die vier Outcomes erstellt wird.</li>
<li>In <a href="#sec-tukeyHSD"><span>Kapitel&nbsp;A.8</span></a> schauen wir uns den Tukey Test für paaweise Vergleiche einmal an. Wir nutzen hier die schnelle Variante mit der Funktion <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>. Für das <em>Compact letter display</em> müssen wir uns dann ein wenig strecken, aber es geht dann auch.</li>
<li>In <a href="#sec-plowing-data"><span>Kapitel&nbsp;A.9</span></a> haben wir nochmal ein schönes Beispiel für eine Analyse mit mehreren Faktoren und verschiedenen Outcomes. Wir haben also einen Blumenstrauß an Daten, die wir sortieren und auswerten müssen. Da ich selber keine Ahnung vom Pflügen habe, gehen wir die Sache distanziert durch.</li>
<li>In <a href="#sec-app-mixed-cutting"><span>Kapitel&nbsp;A.10</span></a> schauen wir uns ein lineares gemischtes Modell an. Das heißt, wir wollen einen Gruppenvergleich rechnen und dabei die verschiedenen Zeitpunkte mit berücksichtigen. Anstatt also jeden Zeitpunkt einzeln, rechnen wir alle Zeitpunkte zusammen.</li>
<li>In <a href="#sec-app-spinach-metal"><span>Kapitel&nbsp;A.11</span></a> wollen wir uns die Konzentration von drei Spurenelementen als Outcome in Blättern und Stielen der Spinatpflanze anschauen. Wir haben hierfür dann die Konzentration von Fe, Cd und Zn gemessen. Insgesamt gab es sieben verschiedene Behandlungsformen.</li>
<li>In <a href="#sec-app-logger"><span>Kapitel&nbsp;A.12</span></a>
</li>
</ul>
<p>Je weiter du nach unten in diesem Kapitel kommst, desto weniger Text wirst du finden. Ich werde noch eine Zeit brauchen, bis ich alles wieder schon mit Text hier verarbeitet habe. Es wird aber immer mal wieder etwas <em>messy</em> aussehen. Hier wird eben auch gearbeitet. Der R Code wird dann aber immer funktionieren, nur die Beschreibungen sind dann eben manchmal nicht da.</p>
<section id="genutzte-r-pakete" class="level2" data-number="A.1"><h2 data-number="A.1" class="anchored" data-anchor-id="genutzte-r-pakete">
<span class="header-section-number">A.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>, <span class="va">magrittr</span>, <span class="va">readxl</span>, <span class="va">janitor</span>,</span>
<span>               <span class="va">broom</span>, <span class="va">multcomp</span>, <span class="va">emmeans</span>, <span class="va">effectsize</span>, <span class="va">report</span>,</span>
<span>               <span class="va">see</span>, <span class="va">metR</span>, <span class="va">parameters</span>, <span class="va">multcompView</span>,</span>
<span>               <span class="va">modelsummary</span>, <span class="va">rstatix</span>, <span class="va">corrplot</span>, <span class="va">psych</span>,</span>
<span>               <span class="va">ordinal</span>, <span class="va">rcompanion</span>, <span class="va">lme4</span>, <span class="va">performance</span>,</span>
<span>               <span class="va">scales</span>, <span class="va">lubridate</span>,</span>
<span>               <span class="va">conflicted</span><span class="op">)</span></span>
<span><span class="co">## resolve some conflicts with same function naming</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"select"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"filter"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"chisq.test"</span>, <span class="st">"stats"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"%+%"</span>, <span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"eta_squared"</span>, <span class="st">"effectsize"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Am Ende des Kapitels findest du nochmal den gesamten R Code in einem Rutsch zum selber durchführen oder aber kopieren.</p>
</section><section id="sec-app-example-iso" class="level2 page-columns page-full" data-number="A.2"><h2 data-number="A.2" class="anchored" data-anchor-id="sec-app-example-iso">
<span class="header-section-number">A.2</span> Isoplethendiagramm für Münster &amp; Osnabrück</h2>
<p>Im Folgenden zeige ich ein Beispiel für die Nutzung der <a href="https://www.dwd-shop.de/index.php/default/kostenfreie-informationen.html">entgeltfreien Informationen auf der DWD-Website</a>. Wir finden dort auf der Seite die <a href="https://www.dwd.de/DE/leistungen/klimadatendeutschland/klimadatendeutschland.html#buehneTop">Klimadaten für Deutschland</a> und natürlich auch die Daten für Münster/Osnabrück. Ich habe mir flux die Tageswerte runtergeladen und noch ein wenig den Header der txt-Datei angepasst. Du findest die Datei <a href="https://github.com/jkruppa/jkruppa.github.io/tree/master/data"><code>day_values_osnabrueck.txt</code></a> wie immer auf meiner GitHub Seite. Du musst dir für andere Orte die Daten nur entsprechend zusammenbauen. Am Ende brauchen wir noch die <a href="https://www.dwd.de/DE/leistungen/klimadatendeutschland/beschreibung_tagesmonatswerte.html">Informationen zu den Tages- und Monatswerten</a> damit wir auch verstehen, was wir uns da von der DWD runtergeladen haben. Ich nutze gleich nur einen Ausschnitt aus den Daten.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Wenn wir <a href="https://geocompr.robinlovelace.net/index.html">Geocomputation with R</a> machen wollen, dann haben wir natürlich noch viele andere Möglichkeiten. Das verlinkte Buch hilft da weiter.</p>
</div></div><p>Dann lesen wir die Daten einmal ein und müssen dann eine Winkelzüge machen, damit wir aus dem Datum <code>JJJJMMDD</code> dann jeweils den Monat und den Tag extrahiert kriegen. Dann müssen wir die Monatszahl und die Tageszahl noch in eine Zahl umwandeln. Sonst geht es schlecht mit dem Zeichnen des Konturplots. Wir nehmen dann die Temperaturen <code>TG</code>, <code>TN</code>, <code>TM</code> und <code>TX</code> um diese Temperaturen in vier Konturplots zu zeigen.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">weather_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_table</span><span class="op">(</span><span class="st">"data/day_values_osnabrueck.txt"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>JJJJMMDD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">JJJJMMDD</span><span class="op">)</span>, <span class="st">"%Y%m%d"</span><span class="op">)</span>,</span>
<span>         day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">JJJJMMDD</span>, <span class="st">"%d"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>         month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">JJJJMMDD</span>, <span class="st">"%m"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>         year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">JJJJMMDD</span>, <span class="st">"%Y"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">month</span>, <span class="va">day</span>, <span class="va">TG</span>, <span class="va">TN</span>, <span class="va">TM</span>, <span class="va">TX</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">gather</span><span class="op">(</span><span class="va">temp</span>, <span class="va">grad</span>, <span class="va">TG</span><span class="op">:</span><span class="va">TX</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">temp</span>, </span>
<span>                       labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Minimum der Temperatur in 5 cm (TG)"</span>,</span>
<span>                                  <span class="st">"Minimum der Temperatur in 2 m (TN)"</span>,</span>
<span>                                  <span class="st">"Mittel der Temperatur in 2 m (TM)"</span>,</span>
<span>                                  <span class="st">"Maximum der Temperatur in 2 m (TX)"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nachdem wir ordentlich an den Daten geschraubt haben können wir jetzt in <a href="#fig-weather">Abbildung&nbsp;<span>A.1</span></a> die vier Konturplots sehen. Wir mussten noch das Spektrum der Farben einmal drehen, damit es auch mit den Temperaturfarben passt und wir haben noch ein paar Hilfslinien miteingezeichnet.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">weather_tbl</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">month</span>, <span class="va">day</span>, z <span class="op">=</span> <span class="va">grad</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_contour_filled</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">13</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_contour</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">2</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">temp</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, alpha <span class="op">=</span> <span class="fl">0.9</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">25</span>, <span class="fl">30</span><span class="op">)</span>, </span>
<span>             alpha <span class="op">=</span> <span class="fl">0.9</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-weather" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-weather-1.png" class="img-fluid figure-img" width="864"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.1— Konturplot der verschiedenen Temperaturen.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="sec-app-example-number-groups" class="level2" data-number="A.3"><h2 data-number="A.3" class="anchored" data-anchor-id="sec-app-example-number-groups">
<span class="header-section-number">A.3</span> Analyse von Anzahlen in zwei Gruppen</h2>
<p>In dieser sehr simplen Analyse haben wir zwei Gruppen vorliegen. Die Gruppe 1 ist hat zwei Level oder Behandlungen abgekürzt mit I und II. Die Gruppe 2 hat insgesamt vier Level oder eben Behandlungen, die wir mit A, B, C und D bezeichnen. Wir haben jetzt für die jeweiligen Kombinationen auf dem Feld etwas <em>gezählt</em>. Wir haben also für jede dieser Kombinationen nur eine Zahl. Es ergbit sich somit die folgende Matrix an Zahlen.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rel_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">45</span>, <span class="fl">14</span>, <span class="fl">4</span>, <span class="fl">0</span>,</span>
<span>                    <span class="fl">25</span>, <span class="fl">32</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"II"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rel_mat</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    A  B C D
I  45 14 4 0
II 25 32 5 1</code></pre>
</div>
</div>
<p>Nun können wir den <span class="math inline">\(\mathcal{X}^2\)</span>-Test nutzen, um zu testen, ob die Zahlen in der Matrix bzw. auf unseren Feld gelcihverteilt sind. Die Nullhypothese lautet, dass es keinen Zusammenhang zwischen der Gruppe 1 und der Gruppe 2 auf dem Feld gibt. Die Zahlen sind also rein zufällig in dieser Anordnung.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">rel_mat</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  rel_mat
X-squared = 13.8689, df = 3, p-value = 0.0030892</code></pre>
</div>
</div>
<p>Wir erhalten einen sehr kleinen <span class="math inline">\(p\)</span>-Wert mit <span class="math inline">\(0.003\)</span>. Wir können daher die Nullhypothese ablehnen, da der <span class="math inline">\(p\)</span>-Wert kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> mit 5%. Wir haben ein signifikantes Ergebnis. Wir können von einen Zusamenhang zwischen den beiden Gruppen ausgehen.</p>
<p>Mit Cramers V können wir auch noch die Effektstärke für einen <span class="math inline">\(\mathcal{X}^2\)</span>-Test berechnen.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">cramers_v</span><span class="op">(</span><span class="va">rel_mat</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cramer's V (adj.) |       95% CI
--------------------------------
0.29              | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>Der Effekt ist mit <span class="math inline">\(0.33\)</span> nicht besonders stark. Du kannst Cramers V wie die Korrelation interpretieren. Ein V von 0 bedeutet keinen Zusammenhang und ein V von 1 einen maximalen Zusammenhang. Wir wollen uns die Daten dann nochmal in einer Abbidlung anschauen. Dafür müssen wir die Matrix erstmal in einen Datensatz umwandeln und die Gruppen zu Faktoren machen.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_tbl</span> <span class="op">&lt;-</span> <span class="va">rel_mat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"group1"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">gather</span><span class="op">(</span><span class="va">A</span><span class="op">:</span><span class="va">D</span>, key <span class="op">=</span> <span class="st">"group2"</span>, value <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>group1 <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">group1</span><span class="op">)</span>,</span>
<span>         group2 <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">group2</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <a href="#fig-app-count-1">Abbildung&nbsp;<span>A.2</span></a> sehen wir die Matrix der Zähldaten für die beiden Gruppen nochmal visualisiert. Beim betrachten fällt auf, dass die beiden Level C und D kaum Zähldaten enthalten. Hier wäre zu überlegen die beiden Level aus der Analyse herauszunehmen und einen klassischen <span class="math inline">\(\mathcal{X}^2\)</span>-Test auf einer 2x2 Kreuztabelle zu rechnen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">plot_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">group2</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">group1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Gruppe 2"</span>, y <span class="op">=</span> <span class="st">"Anzahl"</span>, fill <span class="op">=</span> <span class="st">"Gruppe 1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-count-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-count-1-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.2— Barplot der Zähldaten aus der Matrix.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="sec-app-example-anova-inter" class="level2 page-columns page-full" data-number="A.4"><h2 data-number="A.4" class="anchored" data-anchor-id="sec-app-example-anova-inter">
<span class="header-section-number">A.4</span> Auswertung zweifaktorielle ANOVA mit Interaktion</h2>
<p>Hier kommt jetzt ein schönes Beispiel für eine Auswertung von einem dreifaktoriellen Design mit einer ANOVA. Passenderweise haben wir auch einen Interaktionsterm vorliegen. Unser dreifaktoriellen Design ist auch kein echtes dreifaktorielles Design. Wir müssen uns hier entscheiden, welcher der zwei Blockfaktoren nun unsere Wiederholung sein soll. Aber schreiben wir erstmal unser Modell auf, bevor wir das Modell mit Inhalt füllen.</p>
<p><span class="math display">\[
y \sim  f_1 + b_1 + b_2
\]</span></p>
<p>In unserem Beispiel schauen wir uns das Pflanzenwachstum <code>growth</code> in einer Klimakammer mit verschiedenen Belichtungsstufen <code>light_intensity</code> sowie der Position der Pflanze in der Lichtkammer. Die Pflanze hat eine Position im <code>rack</code> und dann im <code>layer</code>. So ergibt sich dann für uns folgendes ausgeschriebenes Modell.</p>
<p><span class="math display">\[
growth \sim light\_intensity + layer + rack
\]</span></p>
<p>In dieser Form wird unser Modell aber leider nicht funktionieren. Wir hätten dann keine Wiederholungen mehr. Jede Pflanze würe dann exakt durch eine Faktorkombination beschrieben. Wir sehen gleich das Problem visualisiert. Vorher müssen wir uns aber einmal die Daten einlesen und eine Menge Faktoren erschaffen. Achtung, das Erschaffen der Faktoren ist hier sehr wichtig! Im Orginaldatensatz stehen nur Zahlen für die Faktoren. Wir kriegen dann ein echtes Problem.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">light_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/light_intensity_data.xlsx"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>rack <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">rack</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"middle"</span>, <span class="st">"right"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         layer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">layer</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1st"</span>, <span class="st">"2nd"</span>, <span class="st">"3rd"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         light_intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">light_intensity</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"mid"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         growth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">growth</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#tbl-app-light">Tabelle&nbsp;<span>A.1</span></a> sehen wir nochmal einen Ausschnitt aus den Daten.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-app-light" class="anchored">
<table class="table table-sm table-striped">
<caption>Tabelle&nbsp;A.1— Auszug aus dem Daten zu der Lichtintensität.</caption>
<thead><tr class="header">
<th style="text-align: center;">rack</th>
<th style="text-align: center;">layer</th>
<th style="text-align: center;">light_intensity</th>
<th style="text-align: center;">growth</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">left</td>
<td style="text-align: center;">1st</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">17.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">left</td>
<td style="text-align: center;">1st</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">14.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">left</td>
<td style="text-align: center;">1st</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">10.3</td>
</tr>
<tr class="even">
<td style="text-align: center;">left</td>
<td style="text-align: center;">1st</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">23.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">left</td>
<td style="text-align: center;">1st</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">0.3</td>
</tr>
<tr class="even">
<td style="text-align: center;">left</td>
<td style="text-align: center;">1st</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">3.6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">right</td>
<td style="text-align: center;">3rd</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">19.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">right</td>
<td style="text-align: center;">3rd</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">25.9</td>
</tr>
<tr class="even">
<td style="text-align: center;">right</td>
<td style="text-align: center;">3rd</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">35.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">right</td>
<td style="text-align: center;">3rd</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">44.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">right</td>
<td style="text-align: center;">3rd</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">10.7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">right</td>
<td style="text-align: center;">3rd</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">18.3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Nachdem wir die Daten eingelesen haben, schauen wir uns den Sachverhalt einmal für die drei Faktoren über die Level der einzelnen Faktoren an. Wir nutzen dafür die Funktion <code>datasummary_crosstab()</code> aus dem R Paket <code>modelsummary</code>. Wir können uns hier die Anzahl der Beobachtungen je Faktorlevelkombination einmal anschauen.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">datasummary_crosstab</span><span class="op">(</span><span class="va">light_intensity</span> <span class="op">~</span> <span class="va">layer</span> <span class="op">*</span> <span class="va">rack</span>, data <span class="op">=</span> <span class="va">light_tbl</span>,</span>
<span>                     statistic <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1"></th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">1st</div></th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">2nd</div></th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">3rd</div></th>
</tr>
<tr>
<th style="text-align:left;"> light_intensity </th>
   <th style="text-align:right;"> left </th>
   <th style="text-align:right;"> middle </th>
   <th style="text-align:right;"> right </th>
   <th style="text-align:right;"> left </th>
   <th style="text-align:right;"> middle </th>
   <th style="text-align:right;"> right </th>
   <th style="text-align:right;"> left </th>
   <th style="text-align:right;"> middle </th>
   <th style="text-align:right;"> right </th>
  </tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;"> low </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
<tr>
<td style="text-align:left;"> mid </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
<tr>
<td style="text-align:left;"> high </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>
</div>
</div>
<p>Wir sehen eine Menge Nullen. Das heißt, dass diese Faktorlevelkombinationen keine Beobachtungen haben. Dann können wir auch über diese Kombinationen keine Aussage treffen. Wenn wir <em>entweder</em> <code>rack</code> oder <code>layer</code> entfernen, sieht die Sache schon besser aus. Wir haben jetzt alle Faktorlevelkombinationen belegt. Wir müssen uns dann nur noch entscheiden, welchen Faktor wir ins Modell nehmen wollen.</p>
<div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">datasummary_crosstab</span><span class="op">(</span><span class="va">light_intensity</span> <span class="op">~</span> <span class="va">layer</span>, data <span class="op">=</span> <span class="va">light_tbl</span>,</span>
<span>                     statistic <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu">datasummary_crosstab</span><span class="op">(</span><span class="va">light_intensity</span> <span class="op">~</span> <span class="va">rack</span>, data <span class="op">=</span> <span class="va">light_tbl</span>,</span>
<span>                     statistic <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;"> light_intensity </th>
   <th style="text-align:right;"> 1st </th>
   <th style="text-align:right;"> 2nd </th>
   <th style="text-align:right;"> 3rd </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> low </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
<tr>
<td style="text-align:left;"> mid </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
<tr>
<td style="text-align:left;"> high </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
</tbody>
</table>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;"> light_intensity </th>
   <th style="text-align:right;"> left </th>
   <th style="text-align:right;"> middle </th>
   <th style="text-align:right;"> right </th>
  </tr></thead>
<tbody>
<tr>
<td style="text-align:left;"> low </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
<tr>
<td style="text-align:left;"> mid </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
<tr>
<td style="text-align:left;"> high </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
</tbody>
</table>
</div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Das R Paket <a href="https://vincentarelbundock.github.io/modelsummary/articles/datasummary.html">modelsummary</a> bietet hier eine sehr große Auswahl an tollen Funktionen an um seine Daten übersichtlich zu gestalten.</p>
</div></div><p>Für die Entscheidung welcher der beiden Faktoren <code>rack</code> oder <code>layer</code> mit ins Modekll soll, schauen wir uns einmal die Boxplots für die jeweiligen Fakoten an. In <a href="#fig-app-anova-interaction-1">Abbildung&nbsp;<span>A.3</span></a> sehen wir einmal die Boxplots aufgeteilt nach <code>rack</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">light_tbl</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">light_intensity</span>, <span class="va">growth</span>, fill <span class="op">=</span> <span class="va">rack</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-anova-interaction-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-anova-interaction-1-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.3— Boxplots des Pflanzenwachstums aufgeteilt nach <code>rack</code>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Und wir sehen schon, da stimmt was nicht. Die Annahme der ANOVA ist, dass sich der Trend im ersten Faktorlevel für alle im Faktor über die anderen Faktoren gleicht. Das liest sich kryptisch, aber verdeutlichen wir es mal. Im Level <code>low</code> steigen alle Level des Faktors <code>rack</code> an. Wenn <em>keine</em> Interaktion vorliegen würde, dann müssten dieses Muster in dem Level <code>mid</code> und <code>high</code> ebenfalls annährend zu beobachten sein. Tut es aber nicht. Wir haben eine Interaktion zwischen <code>light_intensity</code> und <code>rack</code> visuell bestätigt.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">light_tbl</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">light_intensity</span>, <span class="va">growth</span>, fill <span class="op">=</span> <span class="va">layer</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-anova-interaction-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-anova-interaction-2-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.4— Boxplots des Pflanzenwachstums aufgeteilt nach <code>layer</code>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Dieses wirre Muster sehen wir dann auch in <a href="#fig-app-anova-interaction-2">Abbildung&nbsp;<span>A.4</span></a>. Hier passen die Trends des Faktors <code>layer</code> über die Faktorlevel <code>low</code>, <code>mid</code> und <code>high</code> auch wieder nicht. Schauen wir uns jetzt nochmal die ganze Sache aufgeteilt nach <code>rack</code> und <code>layer</code> an. Vielelicht werden wir dann etwas schlauer oder das Problem wird noch klarer.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">light_tbl</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">light_intensity</span>, <span class="va">growth</span>, fill <span class="op">=</span> <span class="va">rack</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">layer</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-anova-interaction-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-anova-interaction-3-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.5— Boxplots des Pflanzenwachstums aufgeteilt nach <code>rack</code> und <code>layer</code>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Jetzt sehen wir etwas mehr. Im <code>1st</code> Level liegen alle <code>rack</code>-Level auf einer Ebene. Ebenso liegen alle <code>rack</code>-Level auf einer Ebene im <code>2n</code> Level. Das ganze Problem der Interaktion entsteht im <code>3rd</code> Level. Hier ging etwas drunter und drüber im Pflanzenwachstum. Wir wissen jetzt, dass das dritte Layer anscheinend defekt war oder irgendwas dort mit den Racks nicht gestimmt hat.</p>
<p>Wir könnten jetzt das dritte Layer aus der Analyse werfen. Das wäre aber nur eine Möglichkeit. Wenn wir das tuen würden, dann würde wir auch die Interaktion los werden. Das wollen wir hier aber nicht, wir ziehen jetzt die Analyse einmal mit der Interaktion durch. Dafür bauen wir uns jetzt das lineare Modell und schauen uns einmal die ANOVA an.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">growth</span> <span class="op">~</span> <span class="va">light_intensity</span> <span class="op">+</span> <span class="va">layer</span> <span class="op">+</span> <span class="va">light_intensity</span><span class="op">:</span><span class="va">layer</span>, </span>
<span>            data <span class="op">=</span> <span class="va">light_tbl</span><span class="op">)</span></span>
<span><span class="va">fit_1</span> <span class="op">%&gt;%</span> <span class="fu">model_parameters</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter                            | Coefficient |   SE |           95% CI | t(45) |      p
---------------------------------------------------------------------------------------------
(Intercept)                          |       11.62 | 2.80 | [  5.97,  17.26] |  4.14 | &lt; .001
light intensity [mid]                |        1.43 | 3.96 | [ -6.55,   9.42] |  0.36 | 0.719 
light intensity [high]               |        3.70 | 3.96 | [ -4.28,  11.68] |  0.93 | 0.356 
layer [2nd]                          |        5.68 | 3.96 | [ -2.30,  13.67] |  1.43 | 0.159 
layer [3rd]                          |       14.05 | 3.96 | [  6.07,  22.03] |  3.54 | &lt; .001
light intensity [mid] × layer [2nd]  |       -3.33 | 5.61 | [-14.62,   7.96] | -0.59 | 0.555 
light intensity [high] × layer [2nd] |       -5.92 | 5.61 | [-17.21,   5.37] | -1.06 | 0.297 
light intensity [mid] × layer [3rd]  |       -9.60 | 5.61 | [-20.89,   1.69] | -1.71 | 0.094 
light intensity [high] × layer [3rd] |      -25.90 | 5.61 | [-37.19, -14.61] | -4.62 | &lt; .001</code></pre>
</div>
</div>
<p>Erstmal sehen wir an den Modellparameters, dass hier wieder etwas nicht stimmt. Wir würden erwarten, dass der Effekt des Layers immer gleich ist. Hier ist der Effekt von dem <code>2nd</code> Layer zu dem <code>3rd</code> Layer fast dreimal so stark. Und eigentlich sollten die Layer den gleichen Effekt haben. Nämlich eigentlich keinen oder einen Effekt weit unter dem von der Lichtintensität. Das Layer ist eine technische Komponente.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_1</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">model_parameters</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter             | Sum_Squares | df | Mean_Square |    F |      p
----------------------------------------------------------------------
light_intensity       |      433.15 |  2 |      216.57 | 4.60 | 0.015 
layer                 |       70.92 |  2 |       35.46 | 0.75 | 0.477 
light_intensity:layer |     1138.80 |  4 |      284.70 | 6.04 | &lt; .001
Residuals             |     2120.85 | 45 |       47.13 |      |       

Anova Table (Type 1 tests)</code></pre>
</div>
</div>
<p>Wir sehen die visuelle Interaktion auch in der ANOVA Ausgabe als hoch signifikanten Term <code>light_intensity:layer</code> mit dem <span class="math inline">\(p\)</span>-Wert <span class="math inline">\(&lt;0.001\)</span>. Im Anschluss rechnen wir jetzt die paarweisen Vergleiche mit der Funktion <code>emmeans()</code>. Mit dem <code>|</code> geben wir an, dass wir die paarweisen Vergleiche für die Level von <code>light_intensity</code> getrennt für die Level vom <code>layer</code> rechnen wollen. Wenn du <em>keine</em> Adjustierung des <span class="math inline">\(\alpha\)</span>-Niveaus für die multiplen Vergleiche möchtest, dann wähle einfach die Option <code>adjust = "none"</code>. Wir nutzen dann die Ausgabe nicht direkt sondern werden noch die Ausgabe etwas aufhübschen.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">comp_1_obj</span> <span class="op">&lt;-</span> <span class="va">fit_1</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span>specs <span class="op">=</span> <span class="op">~</span> <span class="va">light_intensity</span> <span class="op">|</span> <span class="va">layer</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"pairwise"</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In dem Objekt <code>comp_1_obj</code> sind eine Menge Informationen enthalten. Ich kürze mir immer die Informationen und sortiere nochmal die Ergebnisse. Wir erhalten dann eine saubere Wiedergabe.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">comp_1_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">summary</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">as_tibble</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">contrast</span>, <span class="va">layer</span>, <span class="va">p.value</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>p.value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.pval.html">format.pval</a></span><span class="op">(</span><span class="va">p.value</span>, eps <span class="op">=</span> <span class="fl">0.001</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
  contrast   layer p.value
  &lt;fct&gt;      &lt;fct&gt; &lt;chr&gt;  
1 low - mid  1st   1.0000 
2 low - high 1st   1.0000 
3 mid - high 1st   1.0000 
4 low - mid  2nd   1.0000 
5 low - high 2nd   1.0000 
6 mid - high 2nd   1.0000 
7 low - mid  3rd   0.1355 
8 low - high 3rd   &lt;0.001 
9 mid - high 3rd   0.0028 </code></pre>
</div>
</div>
<p>Nach der Adjustierung für die multiplen Vergleiche haben wir nur noch einen Effekt in dem <code>3rd</code> Layer. Sonst haben die Lichtintensitäten keinen Einfluss auf die Wuchshöhe der Pflanzen. Da wir wissen, dass das <code>3rd</code> Layer auch das defekte Layer war, sehen wir hier schon, dass wir keinen wirklichen Effekt durch das Licht vorliegen haben. Alles was wir gefunden haben, ist eben ein defektes <code>3rd</code> Layer.</p>
<p>Die 95% Konfidenzintervalle erhalten wir mit der Funktion <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code>. Die Ergebnisse sind natürlich die gleichen. Wir sehen wieder keinen Unterschied zwischen den Lichtintensitäten außer in dem <code>3rd</code> Layer.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ci_obj</span> <span class="op">&lt;-</span> <span class="va">comp_1_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">contrast</span>, <span class="va">layer</span>, <span class="va">estimate</span>, conf.low <span class="op">=</span> <span class="va">lower.CL</span>, conf.high <span class="op">=</span> <span class="va">upper.CL</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">ci_obj</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 5
  contrast   layer estimate conf.low conf.high
  &lt;fct&gt;      &lt;fct&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 low - mid  1st     -1.43    -11.3       8.42
2 low - high 1st     -3.70    -13.6       6.16
3 mid - high 1st     -2.27    -12.1       7.59
4 low - mid  2nd      1.90     -7.96     11.8 
5 low - high 2nd      2.22     -7.64     12.1 
6 mid - high 2nd      0.317    -9.54     10.2 
7 low - mid  3rd      8.17     -1.69     18.0 
8 low - high 3rd     22.2      12.3      32.1 
9 mid - high 3rd     14.0       4.18     23.9 </code></pre>
</div>
</div>
<p>In der <a href="#fig-app-anova-interaction-4">Abbildung&nbsp;<span>A.6</span></a> sehen wir dann die berechneten 95% Konfidenzintervalle nochmal visualisiert. Wenn wir einen Effekt haben, dann im <code>3rd</code> Layer. In den restlichen 95% Konfidenzintervallen ist die Null mit enthalten, wir können also die Nullhypothese auf Gleichheit des Gruppenvergleiches nicht ablehnen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ci_obj</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">contrast</span>, y<span class="op">=</span><span class="va">estimate</span>, ymin<span class="op">=</span><span class="va">conf.low</span>, ymax<span class="op">=</span><span class="va">conf.high</span>,</span>
<span>                   color <span class="op">=</span> <span class="va">layer</span>, group <span class="op">=</span> <span class="va">layer</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="st">"11"</span>, colour<span class="op">=</span><span class="st">"grey60"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.1</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_okabeito</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_flip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-anova-interaction-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-anova-interaction-4-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.6— Die 95% Konfidenzintervalle für die paarweisen Vergleiche aufgeteilt <code>layer</code>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Neben der Darstellung mit 95% Konfidenzintervallen ist auch die Darstellung mit dem <em>compact letter display</em> sehr beliebt. Wir nutzen dafür dann die Funktion <code>cld()</code>. Wir adjustieren uns wieder die Vergleiche nach Bonferroni. Im Weiteren trenne wir die Vergleiche auch wieder nach den Leveln für den Faktor <code>layer</code> auf.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cld_obj</span> <span class="op">&lt;-</span> <span class="va">fit_1</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span>specs <span class="op">=</span> <span class="op">~</span> <span class="va">light_intensity</span> <span class="op">|</span> <span class="va">layer</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">cld</span><span class="op">(</span>Letters <span class="op">=</span> <span class="va">letters</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">cld_obj</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>layer = 1st:
 light_intensity emmean  SE df lower.CL upper.CL .group
 low              11.62 2.8 45     4.65     18.6  a    
 mid              13.05 2.8 45     6.08     20.0  a    
 high             15.32 2.8 45     8.35     22.3  a    

layer = 2nd:
 light_intensity emmean  SE df lower.CL upper.CL .group
 high             15.08 2.8 45     8.11     22.1  a    
 mid              15.40 2.8 45     8.43     22.4  a    
 low              17.30 2.8 45    10.33     24.3  a    

layer = 3rd:
 light_intensity emmean  SE df lower.CL upper.CL .group
 high              3.47 2.8 45    -3.50     10.4  a    
 mid              17.50 2.8 45    10.53     24.5   b   
 low              25.67 2.8 45    18.70     32.6   b   

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 3 estimates 
P value adjustment: bonferroni method for 3 tests 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Wir sehen wieder, dass wir nur in dem <code>3rd</code> Layer Buchstabenunterschiede haben. Daher haben wir auch nur im <code>3rd</code> Layer signifikante Ergebnisse. Wichtig ist, dass wir die Buchstaben nur pro Level des Layers vergleichen können, aber auf keinen Fall über die Layer hinweg. Das geht dann leider nicht. Die Ausgabe der Funktion <code>emmeans()</code> schlägt noch andere Darstellungsformen für die Vergleiche vor, du kannst gerne einmal die Funktionen <code><a href="https://rdrr.io/r/graphics/pairs.html">pairs()</a></code>, <code>pwpp()</code> oder <code>pwpm()</code> ausprobieren und schauen, ob dir die Visualisierung mehr sagt. Im <a href="stat-tests-posthoc.html#sec-posthoc-emmeans"><span>Kapitel&nbsp;31.5</span></a> gehe ich nochmal auf die verschiedene Darstellungsformen in <code>emmeans</code> ein.</p>
<p>Wenn wir das <em>compact letter display</em> mit deinem Barplot verbinden wollen, müssen wir uns etwas strecken. Zuerst sortieren wir die Ausgabe von <code>cld_obj</code> wieder in die korrekte Reihenfolge der Faktorenlevel. Dann können wir die Spalte <code>.group</code> direkt in <code>ggplot()</code> verwenden.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cld_sort_obj</span> <span class="op">&lt;-</span> <span class="va">cld_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">light_intensity</span>, <span class="va">layer</span>, <span class="va">.group</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">layer</span>, <span class="va">light_intensity</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <a href="#fig-app-anova-interaction-5">Abbildung&nbsp;<span>A.7</span></a> sehen wir die Ausgabe des Barplots für die Daten und dann an die Balken geschrieben das <em>compact letter display</em>. Wichtig ist hier, dass die Buchstaben immer nur für <em>ein</em> Layer gelten. Wir können wegen der Interaktion nicht die Layer untereinander mit den Buchstaben vergleichen. Wir sehen wiederum, dass wir keine relevanten signifikanten Ergebnisse aus dem Experiment mitnehmen können.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stat_tbl</span> <span class="op">&lt;-</span> <span class="va">light_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">light_intensity</span>, <span class="va">layer</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">growth</span><span class="op">)</span>,</span>
<span>            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">growth</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">stat_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">layer</span>, y <span class="op">=</span> <span class="va">mean</span>, group <span class="op">=</span> <span class="va">light_intensity</span>, </span>
<span>                     fill <span class="op">=</span> <span class="va">light_intensity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">mean</span><span class="op">-</span><span class="va">sd</span>, ymax <span class="op">=</span> <span class="va">mean</span><span class="op">+</span><span class="va">sd</span><span class="op">)</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">0.2</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, </span>
<span>           x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">1</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>, <span class="fl">2</span>, <span class="fl">2.3</span>, <span class="fl">2.7</span>, <span class="fl">3</span>, <span class="fl">3.3</span><span class="op">)</span>, </span>
<span>           y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">22</span>, <span class="fl">21</span>, <span class="fl">23</span>, <span class="fl">24</span>, <span class="fl">20</span>, <span class="fl">23</span>, <span class="fl">39</span>, <span class="fl">25</span>, <span class="fl">9</span><span class="op">)</span>, </span>
<span>           label <span class="op">=</span> <span class="fu">pluck</span><span class="op">(</span><span class="va">cld_sort_obj</span>, <span class="st">".group"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Behandlung"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-anova-interaction-5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-anova-interaction-5-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.7— Barplots für die Mittelwerte mit den entsprechenden Standardabweichungen und dem <em>compact letter display</em> für die paarweisen Vergleiche. Achtung die <em>letter</em> gelten nur in einem Level des Layers.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="sec-mult-map-ght" class="level2 page-columns page-full" data-number="A.5"><h2 data-number="A.5" class="anchored" data-anchor-id="sec-mult-map-ght">
<span class="header-section-number">A.5</span> Multiples Testen mit Games Howell Test</h2>
<p>In diesem Abschnitt wollen wir einen einfaktoriellen Datensatz auswerten. Das heißt, wir haben eine Spalte mit unseren Variantenfaktor mit 11 Leveln und dann aber auch neun Outcomes. Wir müssen also für alle neun Outcomes einen Test rechnen. Dementsprechend bauen wir uns Liste in R. In jedem der Listeneinträge ist nur die Spalte für die Variante und <em>einem</em> Outcome. Wir haben dann also am Ende eine Liste mit neun Listeneinträgen und pro Liste einen Datensatz mit zwei Spalten. Wir brauchen noch das R Paket <code>multcompView</code> für die Darstellung des <em>compact letter display</em> und das R Paket <code>rstatix</code> für die Anwendung der R Funktion <code>games_howell_test()</code>. Wir gehen nämlich von einem normalverteilten Outcome mit Varianzheterogenität aus. Das nehmen wir für jedes Outcome an, dann können wir immer das Gleiche auf den Daten rechnen.</p>
<p>Also erstmal die Daten einlesen, dann die Varianten bilden und die Zahlen wieder auf eine angemessene Länge runden. Ich nehme da immer auf Zweikommastellen, aber das hat hier eher mit der Übersicht zu tun. Gerne kannst du da auch mehr Kommastellen zulassen.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">soil_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/soil_1fac_data.xlsx"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>variante <span class="op">=</span> <span class="fu">str_c</span><span class="op">(</span><span class="va">variante</span>, <span class="st">"_"</span>, <span class="va">amount</span><span class="op">)</span>,</span>
<span>         variante <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">variante</span><span class="op">)</span>,</span>
<span>         <span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">round</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">amount</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#tbl-app-soil">Tabelle&nbsp;<span>A.2</span></a> sehen wir nochmal einen Ausschnitt aus den Daten. Wir schmeißen <code>amount</code> aus den Daten, da die Spalte dann in der Variante aufgeht.</p>
<div class="cell page-columns page-full">
<div class="cell-output-display column-page">
<div id="tbl-app-soil" class="anchored">
<table class="table table-sm table-striped">
<caption>Tabelle&nbsp;A.2— Auszug aus dem Daten zu der Lichtintensität.</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">variante</th>
<th style="text-align: center;">fe</th>
<th style="text-align: center;">k</th>
<th style="text-align: center;">no3</th>
<th style="text-align: center;">no4</th>
<th style="text-align: center;">mg</th>
<th style="text-align: center;">ca</th>
<th style="text-align: center;">drymatter</th>
<th style="text-align: center;">freshweight</th>
<th style="text-align: center;">height</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Holzfasern_0</td>
<td style="text-align: center;">0.26</td>
<td style="text-align: center;">3.7</td>
<td style="text-align: center;">3.28</td>
<td style="text-align: center;">4.1</td>
<td style="text-align: center;">0.43</td>
<td style="text-align: center;">0.45</td>
<td style="text-align: center;">11.24</td>
<td style="text-align: center;">95.3</td>
<td style="text-align: center;">22.17</td>
</tr>
<tr class="even">
<td style="text-align: center;">Holzfasern_0</td>
<td style="text-align: center;">0.33</td>
<td style="text-align: center;">3.66</td>
<td style="text-align: center;">3.24</td>
<td style="text-align: center;">4.05</td>
<td style="text-align: center;">0.44</td>
<td style="text-align: center;">0.47</td>
<td style="text-align: center;">11.48</td>
<td style="text-align: center;">86.15</td>
<td style="text-align: center;">23</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Holzfasern_0</td>
<td style="text-align: center;">0.27</td>
<td style="text-align: center;">3.83</td>
<td style="text-align: center;">3.64</td>
<td style="text-align: center;">4.3</td>
<td style="text-align: center;">0.48</td>
<td style="text-align: center;">0.47</td>
<td style="text-align: center;">11.11</td>
<td style="text-align: center;">86.93</td>
<td style="text-align: center;">28.17</td>
</tr>
<tr class="even">
<td style="text-align: center;">Holzfasern_0</td>
<td style="text-align: center;">0.31</td>
<td style="text-align: center;">3.66</td>
<td style="text-align: center;">3.24</td>
<td style="text-align: center;">3.75</td>
<td style="text-align: center;">0.31</td>
<td style="text-align: center;">0.43</td>
<td style="text-align: center;">11.95</td>
<td style="text-align: center;">89.68</td>
<td style="text-align: center;">26.83</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Torf_30</td>
<td style="text-align: center;">0.46</td>
<td style="text-align: center;">2.89</td>
<td style="text-align: center;">5.02</td>
<td style="text-align: center;">4.95</td>
<td style="text-align: center;">0.37</td>
<td style="text-align: center;">0.39</td>
<td style="text-align: center;">11.21</td>
<td style="text-align: center;">70.82</td>
<td style="text-align: center;">23.83</td>
</tr>
<tr class="even">
<td style="text-align: center;">Torf_30</td>
<td style="text-align: center;">0.37</td>
<td style="text-align: center;">3.41</td>
<td style="text-align: center;">9.44</td>
<td style="text-align: center;">5.01</td>
<td style="text-align: center;">0.49</td>
<td style="text-align: center;">0.42</td>
<td style="text-align: center;">11.29</td>
<td style="text-align: center;">66.23</td>
<td style="text-align: center;">22.33</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">Aufgefasertes_30</td>
<td style="text-align: center;">0.57</td>
<td style="text-align: center;">9.65</td>
<td style="text-align: center;">18.98</td>
<td style="text-align: center;">6.5</td>
<td style="text-align: center;">0.33</td>
<td style="text-align: center;">0.29</td>
<td style="text-align: center;">10.28</td>
<td style="text-align: center;">73.8</td>
<td style="text-align: center;">22</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Aufgefasertes_30</td>
<td style="text-align: center;">0.78</td>
<td style="text-align: center;">27.65</td>
<td style="text-align: center;">16.96</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">0.34</td>
<td style="text-align: center;">0.32</td>
<td style="text-align: center;">13.91</td>
<td style="text-align: center;">74.18</td>
<td style="text-align: center;">22.5</td>
</tr>
<tr class="even">
<td style="text-align: center;">Aufgefasertes_50</td>
<td style="text-align: center;">1.78</td>
<td style="text-align: center;">22.91</td>
<td style="text-align: center;">59.38</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">0.34</td>
<td style="text-align: center;">0.25</td>
<td style="text-align: center;">13.61</td>
<td style="text-align: center;">45.58</td>
<td style="text-align: center;">18.67</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Aufgefasertes_50</td>
<td style="text-align: center;">1.3</td>
<td style="text-align: center;">36.06</td>
<td style="text-align: center;">58.02</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">0.35</td>
<td style="text-align: center;">0.25</td>
<td style="text-align: center;">9.62</td>
<td style="text-align: center;">37.93</td>
<td style="text-align: center;">20</td>
</tr>
<tr class="even">
<td style="text-align: center;">Aufgefasertes_50</td>
<td style="text-align: center;">1.08</td>
<td style="text-align: center;">3.66</td>
<td style="text-align: center;">56.85</td>
<td style="text-align: center;">7.99</td>
<td style="text-align: center;">0.32</td>
<td style="text-align: center;">0.25</td>
<td style="text-align: center;">9.5</td>
<td style="text-align: center;">43.98</td>
<td style="text-align: center;">18.67</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Aufgefasertes_50</td>
<td style="text-align: center;">1.06</td>
<td style="text-align: center;">3.75</td>
<td style="text-align: center;">44.39</td>
<td style="text-align: center;">7.99</td>
<td style="text-align: center;">0.39</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;">10.67</td>
<td style="text-align: center;">35.48</td>
<td style="text-align: center;">19.67</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Im Folgenden werden wir immer wieder die Funktion <code>map()</code> aus dem R Paket <code>purrr</code> nutzen um auf Listen zu rechnen. Die Funktion <code>map()</code> erlaubt auf <em>allen</em> Listeneinträgen die gleiche Funktion durchzuführen. Das macht es natürlich sehr angenehm, wenn wir immer das gleiche Modell auf unsere Daten rechnen wollen.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Wir immer gibt es auch Tutorien im Netz, wenn du mehr über <code><a href="https://purrr.tidyverse.org/reference/map.html">purrr::map()</a></code> erfahren willst. Es gibt das<br><a href="https://jennybc.github.io/purrr-tutorial/index.html">purrr tutorial</a> und die Zusammenfassung in <a href="https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_purrr.pdf">Apply functions with purrr::CHEAT SHEET</a>.</p>
</div></div><p>Als erstes müssen wir aber unsere Daten in das Long-Format kriegen. Dann können wir die Daten nach dem Outcome in der Spalte <code>key</code> die Daten in neuen Listeneinträge aufspalten. Warum neun? Wir haben eben neun Outcomes. Dann haben wir auch neun Listeneinträge. In jedem Listeneintrag ist die Spalte <code>variante</code> und die Spalte <code>value</code>. Der Name des Listeneintrags enthält dann den Namen des Outcomes. Mit dem <code>.x</code> übergeben wir iterativ jeden Listeneintrag in die Funktion <code>select()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">soil_lst</span> <span class="op">&lt;-</span> <span class="va">soil_tbl</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">gather</span><span class="op">(</span><span class="va">key</span>, <span class="va">value</span>, <span class="va">fe</span><span class="op">:</span><span class="va">height</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">key</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="fu">select</span><span class="op">(</span><span class="va">.x</span>, <span class="op">-</span><span class="va">key</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Schauen wir uns von jedem Listeneintrag einmal die ersten beiden Zeilen an. Das machen wir auch wieder mit <code>map()</code> indem wir die Funktion <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code> auf jedem Listeneintrag ausführen.</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">soil_lst</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$ca
# A tibble: 2 × 2
  variante     value
  &lt;fct&gt;        &lt;dbl&gt;
1 Holzfasern_0  0.45
2 Holzfasern_0  0.47

$drymatter
# A tibble: 2 × 2
  variante     value
  &lt;fct&gt;        &lt;dbl&gt;
1 Holzfasern_0  11.2
2 Holzfasern_0  11.5

$fe
# A tibble: 2 × 2
  variante     value
  &lt;fct&gt;        &lt;dbl&gt;
1 Holzfasern_0  0.26
2 Holzfasern_0  0.33

$freshweight
# A tibble: 2 × 2
  variante     value
  &lt;fct&gt;        &lt;dbl&gt;
1 Holzfasern_0  95.3
2 Holzfasern_0  86.2

$height
# A tibble: 2 × 2
  variante     value
  &lt;fct&gt;        &lt;dbl&gt;
1 Holzfasern_0  22.2
2 Holzfasern_0  23  

$k
# A tibble: 2 × 2
  variante     value
  &lt;fct&gt;        &lt;dbl&gt;
1 Holzfasern_0  3.7 
2 Holzfasern_0  3.66

$mg
# A tibble: 2 × 2
  variante     value
  &lt;fct&gt;        &lt;dbl&gt;
1 Holzfasern_0  0.43
2 Holzfasern_0  0.44

$no3
# A tibble: 2 × 2
  variante     value
  &lt;fct&gt;        &lt;dbl&gt;
1 Holzfasern_0  3.28
2 Holzfasern_0  3.24

$no4
# A tibble: 2 × 2
  variante     value
  &lt;fct&gt;        &lt;dbl&gt;
1 Holzfasern_0  4.1 
2 Holzfasern_0  4.05</code></pre>
</div>
</div>
<p>Jetzt geht kannst du einmal <code>map()</code> in seiner vollen Schönheit sehen. Wir rechnen auf jeden Listeneintrag einmal den Games Howell Test. Dann steht in jedem der Listeneinträge das Ergebnis des Games Howell Test. Wir müssen dann noch die Spalte <code>contrast</code> aus der Ausgabe des Games Howell Test abändern, damit wir das <em>compact letter display</em> über die Funktion <code>multcompLetters()</code> nutzen können. Dann brauchen wir die adjustierten p-Werte und den Kontrast. Beides schieben wir dann in die Funktion <code>multcompLetters()</code> und lassen uns nur die Buchstaben des <em>compact letter display</em> wiedergeben. Am Ende kleben wir noch alle Einträge der einzelnen Listen mit der Funktion <code>bind_rows()</code> zu einem Datensatz zusammen. Vermutlich musst du die einzelnen Funktion selber mal Schritt für Schritt ausführen. Aber das hier war ja auch jetzt mal fortgeschrittene Programmierung.</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">soil_lst</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="fu">games_howell_test</span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">variante</span>, data <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="fu">mutate</span><span class="op">(</span><span class="va">.x</span>, contrast <span class="op">=</span> <span class="fu">str_c</span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">group1</span>, <span class="st">"-"</span>, <span class="va">.x</span><span class="op">$</span><span class="va">group2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="fu">pull</span><span class="op">(</span><span class="va">.x</span>, <span class="va">p.adj</span>, <span class="va">contrast</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="fu">multcompLetters</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">$</span><span class="va">Letters</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">bind_rows</span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"outcome"</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 12
  outcome     Holzfase…¹ Torf_30 Kompo…² Kompo…³ Kompo…⁴ Gehäc…⁵ Gehäc…⁶ Gehäc…⁷
  &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
1 ca          ab         ab      ab      cd      e       abc     a       b      
2 drymatter   a          a       ab      ab      ab      ab      ab      b      
3 fe          a          abc     ab      abc     bc      a       abc     abc    
4 freshweight a          b       ac      abcdef  de      abc     bcd     f      
5 height      abcde      abc     abcde   acd     ade     abcd    abcde   e      
6 k           a          a       ab      ab      ab      ab      ab      ab     
7 mg          ab         ab      a       a       a       ab      ab      b      
8 no3         a          ab      ab      abcd    abc     a       abc     abc    
9 no4         a          b       bcdef   c       d       ae      cf      c      
# … with 3 more variables: Aufgefasertes_10 &lt;chr&gt;, Aufgefasertes_30 &lt;chr&gt;,
#   Aufgefasertes_50 &lt;chr&gt;, and abbreviated variable names ¹​Holzfasern_0,
#   ²​Kompostiertes_10, ³​Kompostiertes_30, ⁴​Kompostiertes_50, ⁵​Gehäckseltes_10,
#   ⁶​Gehäckseltes_30, ⁷​Gehäckseltes_50</code></pre>
</div>
</div>
<p>Wie du dann mit dem <em>compact letter display</em> weiterarbeitest und interpretierst, findest du dann im <a href="stat-tests-posthoc.html#sec-compact-letter"><span>Kapitel&nbsp;31.7</span></a> über das <em>compact letter display</em> für den Games Howell Test. Hier ist erstmal Schluss, sonst wird hier alles sehr wiederholend.</p>
</section><section id="sec-root-quality" class="level2" data-number="A.6"><h2 data-number="A.6" class="anchored" data-anchor-id="sec-root-quality">
<span class="header-section-number">A.6</span> Wurzelqualität in einem zweifaktoriellen Design</h2>
<p>Sehr häufig haben wir es auch in den Agrarwissenschaften mit Boniturnoten auf der Likert-Skala zu tun. Das heißt wir haben ein Outcome <span class="math inline">\(y\)</span> mit Noten zwischen 1 und 9. Die ganzen Beobachtungen haben wir dann meist noch irgendwie in einem Block wiederholt. Neben den Problemen eine gute und richtige Bonitur <em>praktisch</em> durchzuführen, ist natürlich die Normalverteilung für das Outcome der Noten nicht gegeben. Wir könnten hier zum einen mit einem paarweisen Wilcoxon Rangsummentest ran oder aber wir nutzen die Funktion <code>clm()</code> aus dem R Paket <code>ordnial</code> für die Schätzung der Gruppenunterschiede. Wir nehmen hier mal die Funktion <code>clm()</code> da wir auch den Block mit ins Modell nehmen können.</p>
<p>Zuerst laden wir wieder die Daten. Dabei müssen wir dann noch die Notenspalte <code>grade</code> einmal als numerisch lassen und einmal in einen Faktor mutieren. Wir brauchen ein Faktor für die Funktion <code>clm()</code> aber eine numerische Variable für die Funktion <code>ggplot()</code>. Deshalb eben die Noten in einer doppelten Spalte.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">root_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/root_2fac_data.xlsx"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>treatment <span class="op">=</span> <span class="fu">str_c</span><span class="op">(</span><span class="va">treatment</span>, <span class="st">"_"</span>, <span class="va">fert</span>, <span class="st">"_"</span>, <span class="va">mixture</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">treatment</span>, <span class="va">block</span>, <span class="va">grade</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>grade_fctr <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">grade</span><span class="op">)</span>,</span>
<span>         block <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">block</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <a href="#fig-app-example-root-1">Abbildung&nbsp;<span>A.8</span></a> sehen wir einmal die Abbildung der Noten. Wie immer sind über so viele Behandlungsstufen dann die Abbildungen sehr unübersichtlich. Ich nutze hier einen Dotplot, da du dann die einzelnen Beobachtungen besser sehen kannst. Wir sehen aber, dass es Effekte zwischen den Behandlungen gibt.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">root_tbl</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">treatment</span>, <span class="va">grade</span>, fill <span class="op">=</span> <span class="va">block</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_dotplot</span><span class="op">(</span>binaxis <span class="op">=</span> <span class="st">"y"</span>, stackdir<span class="op">=</span><span class="st">'center'</span>, </span>
<span>              position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.6</span><span class="op">)</span>, dotsize <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-example-root-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-example-root-1-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.8— Boniturnoten der Wurzel über alle Behandlungslevel.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Wir könnten jetzt einen Friedman Test rechen. Der Friedman Test ist das Äquivalent zur einer zweifaktorielle ANOVA. Wenn wir aber die Funktion <code><a href="https://rdrr.io/r/stats/friedman.test.html">friedman.test()</a></code> durchführen sehen wir, dass wir kein <em>complete block design</em> vorliegen haben. Wir können hier also einen Friedman Test nicht rechnen.</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/friedman.test.html">friedman.test</a></span><span class="op">(</span><span class="va">grade_fctr</span> <span class="op">~</span> <span class="va">treatment</span> <span class="op">|</span> <span class="va">block</span>, <span class="va">root_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>Error in friedman.test: not an unreplicated complete block design</code></p>
<p>Da es eben mit dem Friedman Test nicht geht, nutzen wir <em>Cumulative Link Models</em> mit der Funktion <code>clm()</code>. Die Modelle erlauben ein ordinales Outcome zusammen mit einem multiplen linearen Modell zu schätzen. Das ist was wir wollen, damit können wir den Block mit berücksichtigen. Dann geben wir mit <code>threshold = "symmetric"</code> noch an, dass die Abstände in unserem Outcome <span class="math inline">\(y\)</span> symmetrisch sind. Die Abstände zwischen den Notenstufen sind ja immer gleich groß.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clm_fit</span> <span class="op">&lt;-</span> <span class="fu">clm</span><span class="op">(</span><span class="va">grade_fctr</span> <span class="op">~</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">block</span>, data <span class="op">=</span> <span class="va">root_tbl</span>,</span>
<span>               threshold <span class="op">=</span> <span class="st">"symmetric"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mit dem Fit des Modells können wir dann auch eine ANOVA rechnen, um zu schauen, ob wir überhaupt einen signifikanten Effekt unser Behandlung vorliegen haben. Das haben wir, zum einen ist die Behandlung signifikant und leider auch der Block. Das ist natürlich nicht so schön. Eine Interaktion können wir nicht rechnen, da wir zu wenig Fallzahl vorliegen haben.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">clm_fit</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">model_parameters</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter |  Chi2 | df |      p
-------------------------------
treatment | 54.46 | 13 | &lt; .001
block     | 24.64 |  3 | &lt; .001

Anova Table (Type 1 tests)</code></pre>
</div>
</div>
<p>Nun nutzen wir das Modell einmal um uns die <em>compact letters</em> wiedergeben zu lassen. Dafür nutzen wir wieder die Funktion <code>emmeans()</code> aus dem R Paket <code>emmeans</code>. Am Ende sortieren wir nochmal nach der Behandlung und dann lassen wir uns nur die Behandlung und die Buchstaben wiedergeben. Wenn du mehr möchtest, kannst du auch im Kapitel über die Posthoc Tests oder der ordinalen logistischen Regression mehr Optionen anlesen.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clm_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span><span class="op">~</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cld</span><span class="op">(</span>Letters <span class="op">=</span> <span class="va">letters</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">treatment</span>, <span class="va">.group</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          treatment .group
1     CRTL_high_100    cde
2   CRTL_normal_100   bcde
3    WF0_high_30-70      e
4    WF0_high_60-40  abcd 
5  WF0_normal_30-70    cde
6  WF0_normal_60-40  ab   
7    WF1_high_30-70   bcde
8    WF1_high_60-40  abcde
9  WF1_normal_30-70  abc  
10 WF1_normal_60-40  abcde
11   WF3_high_30-70  abcde
12   WF3_high_60-40  a    
13 WF3_normal_30-70     de
14 WF3_normal_60-40   bcde</code></pre>
</div>
</div>
<p>Wenn wir für den Block mit adjustieren wollen würden, können wir den Aufruf wie folgt ändern <code>emmeans(~ treatment | block)</code>. Leider erhalten wir dann in der <code>df</code> Spalte den Eintrag <code>Inf</code> für eng. <em>infinity</em> und das ist nie ein gutes Zeichen. Wir haben auch die sich immer gleich wiederholende Abfolge der <em>compact letters</em>. Also macht es mehr kaputt als heile und wir lassen das Modell so wie es ist. Wir nehmen den Block als reine Wiederholung mit in das Modell rein.</p>
</section><section id="sec-cutting" class="level2 page-columns page-full" data-number="A.7"><h2 data-number="A.7" class="anchored" data-anchor-id="sec-cutting">
<span class="header-section-number">A.7</span> Wachstum nach Rückschnitt mit Messwiederholung</h2>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Beispielhafte Auswertungen per Video
</div>
</div>
<div class="callout-body-container callout-body">
<p>Du findest auf YouTube <a href="https://youtu.be/-KdhG_mntRc">Spielewiese in R - Teil 04.0 - Messwiederholungen einlesen und Outcomes korrelieren</a> die Auswertung einmal als Video. Ich werde zwar alles nochmal hier als Text aufschreiben, aber manchmal ist das Sehen und Hören dann einfacher.</p>
</div>
</div>
<p>In diesem Beispiel haben vier Outcomes mit <code>shoot</code>, <code>flower</code>, <code>leaf</code> und <code>fruit</code> gemessen. Wir nehmen hier an, dass wir es bei dem Outcome <code>shoot</code> mit einer Pflanzenhöhe zu tun haben und bei den drei anderen Outcomes jeweils mit einer Anzahl. Wir haben jeweils drei Pflanzen in zwei Blöcken randomisiert. Darüber hinaus haben wir vier Behandlungen. Einmal schauen wir uns eine Kontrolle an sowie drei Arten von Rückschnitten. Die Fragestellung ist nun, wie sich die Behandlung durch die Rückschnitte auf die Outcomes auswirkt.</p>
<p>Wir lesen wieder als erstes die Daten ein. Bitte beachte, dass wir den Versuch an acht Terminen ausgewertet haben. Das heißt, wir haben an acht Terminen alle vier Outcomes gemessen. Dadurch ergeben sich immer vier Spalten mit dem Namen des Outcomes ergänzt um eine Zahl für den Messtermin. Wir nutzen noch die Funktion <code>clean_names()</code> um sicherzugehen, dass wir keine Leerzeichen mehr in den Spaltennamen haben.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cutting_raw_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/cutting_data.xlsx"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">clean_names</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nun müssen wir noch die Spalten <code>shoot_1</code> bis zur letzten Spalte <code>fruit_8</code> in drei Spalten verwandeln. In der einen Spalte <code>rsp</code> sollen nur die numerischen Messwerte stehen. In der Spalte <code>week</code> soll nur die Messwoche hinein und in die Spalte Outcome soll sich der Name der Spalte wiederfinden. Um diese Modifizierung der Daten zu erreichen, nutzen wir die Funktion <code>pivot_longer()</code>. Wir spalten die Namen der Spalten durch den Unterstrich <code>_</code> in zwei neue Spalten <code>outcome</code> und <code>week</code>. Dann müssen wir noch die Daten sortieren und die Behandlung sowie die Blöcke in einen Faktor umwandeln. Damit wir später eine bessere Abbildung haben, verwandeln wir noch die Wochen in eine numerische Spalte.</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cutting_tbl</span> <span class="op">&lt;-</span> <span class="va">cutting_raw_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">shoot_1</span><span class="op">:</span><span class="va">fruit_8</span>, </span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"outcome"</span>, <span class="st">"week"</span><span class="op">)</span>, </span>
<span>               names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"rsp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">outcome</span>, <span class="va">week</span>, <span class="va">trt</span>, <span class="va">block</span>, <span class="va">rsp</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>block <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">block</span><span class="op">)</span>,</span>
<span>         trt <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">trt</span><span class="op">)</span>,</span>
<span>         outcome <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span>,</span>
<span>         week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">week</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Jetzt wollen wir für die <a href="#fig-app-exp-cutting-01">Abbildung&nbsp;<span>A.9</span></a> etwas andere Namen für unsere Outcomes. Dafür nutzen wir dann die Funktion <code>recode()</code> in der wir die Level eines Faktors umbenennen können. Nachdem wir das gemacht haben, stellen wir einmal die Verläufe der Outcomes über die Wochen getrennt für die Behandlungen und die Blöcke dar. Die Funktion <code>stat_smooth()</code> erlaubt uns einmal eine Gerade durch die Punkte zu legen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cutting_plot_tbl</span> <span class="op">&lt;-</span> <span class="va">cutting_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>outcome <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span><span class="va">outcome</span>, </span>
<span>                          shoot <span class="op">=</span> <span class="st">"Trieblänge"</span>, </span>
<span>                          flower <span class="op">=</span> <span class="st">"Blütenanzahl"</span>, </span>
<span>                          leaf <span class="op">=</span> <span class="st">"Blätteranzahl"</span>, </span>
<span>                          fruit <span class="op">=</span> <span class="st">"Fruchtanzahl"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cutting_plot_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">week</span>, <span class="va">rsp</span>, color <span class="op">=</span> <span class="va">trt</span>, linetype <span class="op">=</span> <span class="va">block</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">outcome</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_smooth</span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_okabeito</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-exp-cutting-01" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-exp-cutting-01-1.png" class="img-fluid figure-img" width="1056"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.9— Abbildung der vier Outcomes über die acht Messtermine mit den vier Behandlungen und den zwei Blöcken.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Wir wir erkennen können, sind die Blöcke ähnlich. Hier haben wir also gut randomisiert. Auch scheint keine gravierende Interaktion vorzuliegen. Die Abstände und der Anstieg ist über die Wochen relativ konstant. Wir werden uns am Ende auf die Woche acht konzentrieren, da wir an dem letzten Termin unsere multiplen Vergleiche rechnen wollen.</p>
<p>Häufig ist es so, dass wir dann noch einen Barplot wollen. Hier ist aber Vorsicht geboten. Ein Barplot mit Mittelwert und Standardabweichung macht eigentlich nur Sinn, wenn das Outcome normalverteilt ist. Sonst können schnell negative oder ungewollte Werte raus kommen. Immerhin haben wir hier mit <code>flower</code>, <code>leaf</code> und <code>fruit</code> drei Outcomes die als Zähldaten einer Poissonverteilung folgen.</p>
<p>Um die Mittelwerte für die Behandlungen getrennt für die Wochen zu berechnen, nutzen wir die Funktion <code>group_by()</code> um uns alle Paare von Behandlung und Woche zu bilden. Dann rechnen wir für jede dieser Paarungen dann den Mittelwert und die Standardabweichung aus. Wir mitteln aber hier über die Blöcke, um dann die Barplots überhaupt sinnvoll darstellen zu können.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stat_tbl</span> <span class="op">&lt;-</span> <span class="va">cutting_plot_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">trt</span>, <span class="va">outcome</span>, <span class="va">week</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rsp</span><span class="op">)</span>,</span>
<span>            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">rsp</span><span class="op">)</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <a href="#fig-app-exp-cutting-03">Abbildung&nbsp;<span>A.10</span></a> sehen wir die Barplots. Wir zu erwarten erhalten wir bei den Zäldaten negatuve Werte durch den Fehlerbalken angezeigt. Die Streuung ist hier zu groß und so sind die Fehlerbalken auch negativ. Barplots sind keine gute Lösung für die Darstellung von Zähldaten durch den Mittelwert und die Standardabweichung. Da wären dann Boxplots besser. Aber es ist immer gut mal was zu zeigen, was dann auch nicht so gut geht, also hier einmal die Barplots.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="">Achtung, wenn du nicht normalverteilte Daten mit Barplots und den Fehlerbalken darstellst, dann kann es zu Fehlerbalken führen, die negativ werden</span></div></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">stat_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">week</span>, y <span class="op">=</span> <span class="va">mean</span>, group <span class="op">=</span> <span class="va">trt</span>, fill <span class="op">=</span> <span class="va">trt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">mean</span><span class="op">-</span><span class="va">sd</span>, ymax <span class="op">=</span> <span class="va">mean</span><span class="op">+</span><span class="va">sd</span><span class="op">)</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">0.2</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Behandlung"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">outcome</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-exp-cutting-03" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-exp-cutting-03-1.png" class="img-fluid figure-img" width="1056"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.10— Barplots mit Fehlerbalken der vier Outcomes über die acht Messtermine mit den vier Behandlungen und den zwei Blöcken.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Eine Frage, die sich im Rahmen der Analyse noch gestellt hat, war ob die Outcomes untereinander stark korrelieren. Daher wurde nochmal entschieden sich die Korrelation der vier Outcomes anzuschauen. Wir machen das jetzt erstmal über die Woche sechs bis Woche acht. In den früheren Wochen haben die Pflanzen noch keine Früchte und dann sehen die Abbildungen sehr seltsam verzerrt aus.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Es gibt eine große Auswahl an R Paketen und damit auch Plots für die Korrelation. In dem Tutorial <a href="https://r-coder.com/correlation-plot-r/">Correlation plot in R</a> werden dir eine große Auwahl präsentiert.</p>
</div></div><p>Wir filtern uns also die Wochen sechs bis acht und nutzen dann die Funktion <code>pivot_wider()</code> um die Outcomes wieder nebeneinander in vier Spalten anzuordnen. Da <code>pivot_wider()</code> die wiederholenden Zeilen von Behandlung und Block zusammenfasst, müssen wir die Spalten nochmal wieder ausklappen. Dieses Ausklappen machen wir mit der Funktion <code>unnest()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cutting_cor_tbl</span> <span class="op">&lt;-</span> <span class="va">cutting_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">week</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">outcome</span>, values_from <span class="op">=</span> <span class="va">rsp</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">unnest</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">flower</span>, <span class="va">fruit</span>, <span class="va">leaf</span>, <span class="va">shoot</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <a href="#fig-app-exp-cutting-02">Abbildung&nbsp;<span>A.11</span></a> sehen wir jetzt ein Beispiel für ein Korrelationsplot. Es gibt wirklich sehr viele Möglichkeiten in R sich die Korrelation von <em>numerischen</em> Spalten anzeigen zu lassen. Wir wählen hier nur den Korrelationskoeffizient nach Kendall, da wir hier nicht nur normalverteilte Outcomes vorliegen haben. In dem Histogramm auf der Diagonalen kannst du auch sehr gut die Poissonverteilungen von der Normalverteilung unterscheiden. Die Trieblänge ist normalverteilt und die anderen Outcomes mit den Anzahlen folgen einer Poissonverteilung.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cutting_cor_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">flower</span><span class="op">:</span><span class="va">shoot</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pairs.panels</span><span class="op">(</span>smooth <span class="op">=</span> <span class="cn">TRUE</span>, density <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"kendall"</span>, lm <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>               cor <span class="op">=</span> <span class="cn">TRUE</span>, ellipses <span class="op">=</span> <span class="cn">FALSE</span>, stars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>    </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-exp-cutting-02" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-exp-cutting-02-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.11— Abbildung der Scatterplots, Histogramme und Korrelation zwischen den vier Outcomes.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Wunderbar, jetzt können wir mit der Analyse der Outcomes anfangen. Wir rechnen als erstes die Trieblänge als eine multiple lineare Gaussian Regression. Danach dann die Anzahlen mit einer multiplen linearen Poisson Regression. Dann wollen wir noch das <em>Compact letter display</em> für die multiplen Vergleiche wiedergegeben haben.</p>
<section id="trieblänge" class="level3" data-number="A.7.1"><h3 data-number="A.7.1" class="anchored" data-anchor-id="trieblänge">
<span class="header-section-number">A.7.1</span> Trieblänge</h3>
<p>Beginnen wir damit, dass wir uns zuerst den Datensatz filtern. Wir wollen nur die Trieblänge und die achte Woche in unseren Analysedatensatz. Dann sind wir sicher, dass wir nicht ausversehen eine andere Analyse rechnen.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shoot_length_tbl</span> <span class="op">&lt;-</span> <span class="va">cutting_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">==</span> <span class="st">"shoot"</span> <span class="op">&amp;</span> <span class="va">week</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir bauen uns unser lineares Modell mit der Annahme einers normalverteilten Outcomes mit der Funktion <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>. Wir nehmen noch den Interaktionsterm für die Behandlung und Blöcke mit in das Modell.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shoot_length_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">rsp</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="va">block</span> <span class="op">+</span> <span class="va">trt</span><span class="op">:</span><span class="va">block</span>, </span>
<span>                       data <span class="op">=</span> <span class="va">shoot_length_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ein kurzer Blick in eine zweifaktorielle ANOVA um zu schauen ob wir überhaupt einen Behandlunsgeffekt haben und eventuell auch eine signifikante Interaktion.</p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shoot_length_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">model_parameters</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter | Sum_Squares | df | Mean_Square |     F |      p
-----------------------------------------------------------
trt       |     1651.86 |  3 |      550.62 | 18.45 | &lt; .001
block     |        1.67 |  1 |        1.67 |  0.06 | 0.816 
trt:block |       73.67 |  3 |       24.56 |  0.82 | 0.500 
Residuals |      477.57 | 16 |       29.85 |       |       

Anova Table (Type 1 tests)</code></pre>
</div>
</div>
<p>Wir haben einen signifikanten Behandlungseffekt vorliegen und keine signifikante Interaktion zwischen der Behandlung und den Blöcken. Das ist wie wir es wollten und dann können wir noch kurz schauen, wie gut unser Experiment funktioniert hat. Wieviel Varianz können wir mit dem Behandlungen erklären? Wir berechnen dazu <span class="math inline">\(\eta^2\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shoot_length_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">eta_squared</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter | Eta2 (partial) |       95% CI
-----------------------------------------
trt       |           0.78 | [0.55, 1.00]
block     |       3.49e-03 | [0.00, 1.00]
trt:block |           0.13 | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>Mit einem <span class="math inline">\(\eta^2\)</span> von <span class="math inline">\(0.78\)</span> können wir 78% der Varianz in unserem Experiment mit der Behandlung erklären. Das ist mehr als gut. Das spricht für ein gut geplantes und durchgeführtes Experiment.</p>
<p>Nachdem wir also sicher sind, dass wir etwas in den Daten haben, nutzen wir wieder das Paket <code>emmeans</code> um die paarweisen Vergleiche zu rechnen. Dafür legen wir erstmal wieder ein <code>emmeans</code> Objekt an. Wir müssen uns hier nicht um die Blöcke scheren, wir haben ja keine signifikante Interaktion vorliegen.</p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shoot_emm_obj</span> <span class="op">&lt;-</span> <span class="va">shoot_length_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span>specs <span class="op">=</span> <span class="op">~</span> <span class="va">trt</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
</div>
</div>
<p>Als nächstes rechnen wir dann schon die paarweisen Vergleiche und erhalten die Bonferroni adjustierten <span class="math inline">\(p\)</span>-Werte zurück. Wenn du nicht adjustieren <span class="math inline">\(p\)</span>-Werte willst, dann nehme einfach die Option <code>adjust = "none"</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shoot_emm_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"pairwise"</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                estimate   SE df t.ratio p.value
 control - nodium_3rd       18.53 3.15 16   5.874  0.0001
 control - nodium_5th       11.22 3.15 16   3.558  0.0157
 control - strong           21.53 3.15 16   6.825  &lt;.0001
 nodium_3rd - nodium_5th    -7.31 3.15 16  -2.316  0.2049
 nodium_3rd - strong         3.00 3.15 16   0.951  1.0000
 nodium_5th - strong        10.31 3.15 16   3.267  0.0291

Results are averaged over the levels of: block 
P value adjustment: bonferroni method for 6 tests </code></pre>
</div>
</div>
<p>Wir können uns dann auch das <em>compact letter display</em> wiedergeben lassen.</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shoot_emm_obj</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">cld</span><span class="op">(</span>Letters <span class="op">=</span> <span class="va">letters</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> trt        emmean   SE df lower.CL upper.CL .group
 strong       34.8 2.23 16     28.5     41.1  a    
 nodium_3rd   37.8 2.23 16     31.5     44.1  ab   
 nodium_5th   45.1 2.23 16     38.8     51.4   b   
 control      56.3 2.23 16     50.1     62.6    c  

Results are averaged over the levels of: block 
Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 4 estimates 
P value adjustment: bonferroni method for 6 tests 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Insbesondere in diesme Beispiel macht es auch Sinn sich nicht alle paarweisen Vergleiche anzuschauen sondern eben nur die Vergleiche <em>zu der Kontrolle</em>. Dafür nutzen wir dann die Methode <code>trt.vs.ctrlk</code> und wählen mit der Option <code>ref = 1</code> unser Referenzlevel des Behandlungsfaktors. Da unsere Kontrolle schon das erste Level ist, schreiben wir also <code>ref = 1</code> und erhalten die Vergleiche zu der Kontrolle.</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shoot_emm_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"trt.vs.ctrlk"</span>, ref <span class="op">=</span> <span class="fl">1</span>, </span>
<span>           adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast             estimate   SE df t.ratio p.value
 nodium_3rd - control    -18.5 3.15 16  -5.874  0.0001
 nodium_5th - control    -11.2 3.15 16  -3.558  0.0079
 strong - control        -21.5 3.15 16  -6.825  &lt;.0001

Results are averaged over the levels of: block 
P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
<p>Wie wir sehen rechnen wir nur noch die Vergleiche zu der Kontrolle. Alle Vergleiche sind auch signifikant und die Kontrolle ist immer größer als die anderen Behandlungen. Wenn du das Minus gedreht haben möchtest, dann nutze <code>reverse = TRUE</code> als Option. Dann rechnest du Kontrolle minus den anderen Behandlungen.</p>
<p>Zum Abschluss können wir uns für die achte Woche noch die Barplots in der <a href="#fig-app-exp-cutting-04">Abbildung&nbsp;<span>A.12</span></a> für die vier Behandlungen anschauen. Wir mitteln dabei über die beiden Blöcke. Wir wollen jetzt das <em>Compact letter display</em> noch ergänzen. Dafür bauen wir uns einen <code>letter_vec</code> in dem wir die richtig sortierten Buchstaben dann eintragen.</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">letter_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"ab"</span>, <span class="st">"b"</span>, <span class="st">"a"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann bauen wir uns noch ein Objekt mit den Mittelwerten und der Stndardabweichung für die vier Behandlungen.</p>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">shoot_stat_tbl</span> <span class="op">&lt;-</span> <span class="va">shoot_length_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">trt</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rsp</span><span class="op">)</span>,</span>
<span>            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">rsp</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Abschließend können wir dann die Barplots mit den Fehlerbalken und dem <em>Compact letter display</em> darstellen. Ich habe hier mal eine rote Farbe für die Buchstaben gewählt, aber du kannst da gerne eine andere Farbe nutzen. so sieht man aber die Buchstaben auf den ersten Blick. Die Position der Buchstaben auf der y-Achse habe ich mit Try&amp;Error dann selber rausgefunden. Geht sicherlich noch schöner, aber so ist es dann auch gut.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">shoot_stat_tbl</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">trt</span>, y <span class="op">=</span> <span class="va">mean</span>, fill <span class="op">=</span> <span class="va">trt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">mean</span><span class="op">-</span><span class="va">sd</span>, ymax <span class="op">=</span> <span class="va">mean</span><span class="op">+</span><span class="va">sd</span><span class="op">)</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">0.2</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Mittlere Anzahl an Blüten"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">""</span>, fill <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">48</span>, <span class="fl">55</span>, <span class="fl">45</span><span class="op">)</span>,</span>
<span>           label <span class="op">=</span> <span class="va">letter_vec</span>, size <span class="op">=</span> <span class="fl">5</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-exp-cutting-04" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-exp-cutting-04-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.12— Barplots der vier Behandlungen gemittelt über die Blöcke zusammen mit dem <em>Compact letter display</em>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="blütenanzahl" class="level3" data-number="A.7.2"><h3 data-number="A.7.2" class="anchored" data-anchor-id="blütenanzahl">
<span class="header-section-number">A.7.2</span> Blütenanzahl</h3>
<p>Im Folgenden schaue ich mir nur die Blütenanzahl <code>flowers</code> als Outcome an. Die anderen Outcomes sind dann einfach nur Copy&amp;Paste von dieser Analyse der Blütenanzahl. Wenn wir eine Analyse für eine Poissonregression rechnen können, dann können wir das auch ohne weiteres für die anderen beiden Outcomes.</p>
<p>Als erstes filtern wir wieder die Daten. Wir wollen nur die Blüten und die achte Woche in unseren Analysedatensatz. Dann sind wir sicher, dass wir nicht ausversehen eine andere Analyse rechnen.</p>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flowers_tbl</span> <span class="op">&lt;-</span> <span class="va">cutting_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">==</span> <span class="st">"flower"</span> <span class="op">&amp;</span> <span class="va">week</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Jetzt kommt der größte Unterschied. Wir rechnen kein <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> mit der implizieten Annahme eines normalverteilten Outcomes sondern ein <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> in dem wir dann die Verteilunsgfamilie des Outcomes definieren können. In unserem Fall dann für die Zähldaten die Quasipoissonverteilung. Sonst ist das Modell gleich wie ebi unserer Trieblänge.</p>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flowers_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">rsp</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="va">block</span> <span class="op">+</span> <span class="va">trt</span><span class="op">:</span><span class="va">block</span>, </span>
<span>                   data <span class="op">=</span> <span class="va">flowers_tbl</span>, </span>
<span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">quasipoisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Schauen wir uns einmal die ANOVA an. Da wir ein GLM rechnen, können wir nicht die Funktion <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> nutzen sondern müssen die Funktion <code>Anova()</code> aus dem R Paket <code>car</code> anwenden. Dann erhalten wir auch die <span class="math inline">\(p\)</span>-Werte die wir wollen.</p>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flowers_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">model_parameters</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter |  Chi2 | df |      p
-------------------------------
trt       | 19.41 |  3 | &lt; .001
block     |  0.49 |  1 | 0.484 
trt:block |  1.80 |  3 | 0.615 

Anova Table (Type 2 tests)</code></pre>
</div>
</div>
<p>Im Prinzip das gleiche Ergebnis wie schon bei der Trieblänge. Wir haben einen signifikanten Effekt der Behandlung auf die Blütenanzahl und keine signifkante Interaktion. Wir rechnen also mit dem Modell jetzt weiter. Wiederum nutzen wir das R Paket <code>emmeans</code>. Wichtig ist hier, dass wir als Typ dann die <code>response</code> angeben. Sonst erhalten wir alle Effektschätzer auf der Link-Scale und die Link-Scale können wir dann nicht interpretieren.</p>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flowers_emm_obj</span> <span class="op">&lt;-</span> <span class="va">flowers_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span>specs <span class="op">=</span> <span class="op">~</span> <span class="va">trt</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir machen auch hier wieder so weiter wie schon bei der Treiblänge. Einmal die paarweisen Vergleiche mit Bonferroni adjustierten <span class="math inline">\(p\)</span>-Werten.</p>
<div class="cell">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flowers_emm_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"pairwise"</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                ratio    SE  df null z.ratio p.value
 control / nodium_3rd    1.702 0.444 Inf    1   2.037  0.2498
 control / nodium_5th    1.087 0.249 Inf    1   0.363  1.0000
 control / strong        3.278 1.081 Inf    1   3.601  0.0019
 nodium_3rd / nodium_5th 0.639 0.169 Inf    1  -1.698  0.5374
 nodium_3rd / strong     1.926 0.683 Inf    1   1.847  0.3883
 nodium_5th / strong     3.016 1.002 Inf    1   3.323  0.0053

Results are averaged over the levels of: block 
P value adjustment: bonferroni method for 6 tests 
Tests are performed on the log scale </code></pre>
</div>
</div>
<p>Dann lassen wir uns noch das <em>Compact letter display</em> für die Blütennzahl wiedergeben.</p>
<div class="cell">
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flowers_emm_obj</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">cld</span><span class="op">(</span>Letters <span class="op">=</span> <span class="va">letters</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> trt         rate   SE  df asymp.LCL asymp.UCL .group
 strong      8.91 2.57 Inf      4.34      18.3  a    
 nodium_3rd 17.16 3.54 Inf     10.24      28.7  ab   
 nodium_5th 26.88 4.43 Inf     17.81      40.6   b   
 control    29.21 4.67 Inf     19.60      43.5   b   

Results are averaged over the levels of: block 
Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 4 estimates 
Intervals are back-transformed from the log scale 
P value adjustment: bonferroni method for 6 tests 
Tests are performed on the log scale 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Auch hier könnten wir nur zu der Kontrolle vergleichen, wenn wir das wollen würden. Hier ist aber das Rüchschneiden nicht so signifikant wie bei der Trieblänge. Hier sehen wir dann auch die Rate der Blüten. Wir haben also im Verhätnis zur Kontrolle nur knapp die Häfte an Blüten bei der Behandlung <code>nodium_3rd</code> und fast nur ein Drittel der Anzahl an Blüten bei der Behandlung <code>strong</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flowers_emm_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"trt.vs.ctrlk"</span>, ref <span class="op">=</span> <span class="fl">1</span>, </span>
<span>           adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast             ratio    SE  df null z.ratio p.value
 nodium_3rd / control 0.587 0.153 Inf    1  -2.037  0.1249
 nodium_5th / control 0.920 0.211 Inf    1  -0.363  1.0000
 strong / control     0.305 0.101 Inf    1  -3.601  0.0010

Results are averaged over the levels of: block 
P value adjustment: bonferroni method for 3 tests 
Tests are performed on the log scale </code></pre>
</div>
</div>
<p>Jetzt kanst du den R Code im Prinzip auch nochmal für die zwei anderen Outcomes durchführen.</p>
</section></section><section id="sec-tukeyHSD" class="level2" data-number="A.8"><h2 data-number="A.8" class="anchored" data-anchor-id="sec-tukeyHSD">
<span class="header-section-number">A.8</span> Einen TukeyHSD Test rechnen</h2>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Beispielhafte Auswertungen per Video
</div>
</div>
<div class="callout-body-container callout-body">
<p>Du findest auf YouTube <a href="https://youtu.be/3X38OlrDyQo">Spielewiese in R - Teil 03.0 - ANOVA zusammen mit TukeyHSD</a> die Auswertung einmal als Video. Ich werde zwar alles nochmal hier als Text aufschreiben, aber manchmal ist das Sehen und Hören dann einfacher.</p>
</div>
</div>
<p>In diesem sehr kurzen Beispiel wollen wir uns einem den Tukey Test anschauen. Eigentlich ist es der Tukey HSD Test für <em>Tukey Honest Significant Differences</em>. Die von dieser Funktion zurückgegebenen <span class="math inline">\(p\)</span>-Werte und 95% Konfidenzintervalle basieren auf der t-Test Verteilung. Wir nehmen also ein normalverteiltes Outcome <span class="math inline">\(y\)</span> sowie eine homogene Varianz an.</p>
<p>Die auf diese Weise konstruierten 95% Konfidenzintervalle gelten nur für balancierte Designs, bei denen in jedem Level des Faktors die gleiche Anzahl von Beobachtungen gemacht wird. Die Funktion <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> enthält eine Anpassung für den Stichprobenumfang, die sinnvolle 95% Konfidenzintervalle für leicht unbalancierte Designs erzeugt. Ja, und da geht es schon wieder los. Was heißt sinnvoll? Oder andersherum, was ist eine leichte Abweichung? Deshalb mag ich persönlich nicht die Funktion <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> und ziehe das R Paket <code>emmeans</code> vor. Du siehst auch in den anderen Beispielen immer die Anwendung von <code>emmeans</code>.</p>
<p>Aber gut, hier soll es ja um den Tukey Test gehen. Also wir nehmen uns einmal ein simples Beispiel mit verschiedenen Bodenarten und dann wollen wir als Outcome <span class="math inline">\(y\)</span> die Pflanzenhöhe miteinander vergleichen.</p>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">soil_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/soil_1fac_data.xlsx"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>variante <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">variante</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">variante</span>, <span class="va">height</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Die Funktion <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> ist alt. Deshalb kann die Funktion nur den Modellfit aus der Funktion <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> verarbeiten. Die Funktion <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> wiederum ist eigentlich nur eine Funktion, die die beiden Funktionen <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> und <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> in ungünstiger Art und Weise kombiniert. Aber gut, geht eben nicht anders.</p>
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">aov_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">variante</span>, data <span class="op">=</span> <span class="va">soil_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann können wir den Modellfit in die Funktion <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> stecken und benutzen. Wir kriegen eine etwas seltsame Ausgabe, aber wir wollen auch hier dann weiter zu dem <em>compact letter display</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tukey_obj</span> <span class="op">&lt;-</span> <span class="va">aov_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das <em>compact letter display</em> können wir über die Funktion <code>multcompLetters()</code> erstellen. Wir müssen dafür die <span class="math inline">\(p\)</span>-Werte extrahieren und dann an die Funktion weiterleiten. Hier ist wichtig, dass wir nur adjustierte <span class="math inline">\(p\)</span>-Werte wiederbekommen. Wenn du unadjustierte <span class="math inline">\(p\)</span>-Werte möchtest, dann musst du nochmal in die Funktion <code>emmeans()</code> schauen.</p>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tukey_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"variante"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">magrittr</span><span class="fu">::</span><span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html">extract</a></span><span class="op">(</span> , <span class="st">"p adj"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">multcompLetters</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Torf Kompostiertes  Gehäckseltes Aufgefasertes    Holzfasern 
         "ab"          "ab"           "a"          "ab"           "b" </code></pre>
</div>
</div>
<p>Mehr zum <em>compact letter display</em> und der Interpretation kannst du im Kapitel zu <a href="stat-tests-posthoc.html">Multiple Vergleiche oder Post-hoc Tests</a> nachlesen. Dort findest du auch eine Alternative zu dem Tukey Test.</p>
</section><section id="sec-plowing-data" class="level2" data-number="A.9"><h2 data-number="A.9" class="anchored" data-anchor-id="sec-plowing-data">
<span class="header-section-number">A.9</span> Auswertung von Pflugdaten mit <code>ggplot</code> Templates</h2>
<p>In diesem Beispiel wollen wir eine Exceldatei mit mehreren Tabellenblättern in eine Liste einlesen. Dann werden wir noch das Template in <code>ggplot</code> kennen lernen. Wir können nämlich auf Daten mit den gleichen Spaltennamen auch immer wieder den gleichen Plot anwenden. Das macht es natürlich recht einfach, denn wir müssen nicht immer den gleichen R Code tippen und Kopieren.</p>
<p>Fangen wir also alle Tabellenblätter einer Exceldatei einzulesen. Wir brauchen dafür den Pfad zu der Datei. Hier bei mit ist es recht einfach, aber bei dir mag es etwas komplizierter sein. Du kannst auch einfach die Datei einmal über das RStudio einlesen und dann den Pfad kopieren.</p>
<div class="cell">
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plowing_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="st">"data/plowing_data.xlsx"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In Folgenden leiten wir den Pfad in die Funktion <code>excel_sheets()</code> die uns dann die einzelnen Tabellenblätter wiedergibt. Dann müssen wir noch den Vektor mit den Tabellenblätternmane benennen. Dann können wir die Funktion <code>map()</code> nutzen um alle Blätter, die sich in der Exceldatei im Pfad befinden, in eine Liste laden.</p>
<div class="cell">
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plowing_lst</span> <span class="op">&lt;-</span> <span class="va">plowing_file</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">excel_sheets</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html">set_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="va">read_excel</span>, path <span class="op">=</span> <span class="va">plowing_file</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir wollen jetzt auf der Liste mit der Funktion <code>map()</code> noch ein paar Anpassungen durchführen. Die Funktion <code>map()</code> erlaubt uns andere Funktion auf alle Listeneinträge der Liste anzuwenden. Als erstes Sortieren wir alle Tibble in jedem Listeneintrag und verwandeln dann die Spalten in Faktoren, die eben auch Faktoren repräsentieren.</p>
<div class="cell">
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plowing_lst</span> <span class="op">&lt;-</span> <span class="va">plowing_lst</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="fu">arrange</span><span class="op">(</span><span class="va">.x</span>, <span class="va">day</span>, <span class="va">block</span>, <span class="va">variant</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="fu">mutate</span><span class="op">(</span><span class="va">.x</span>, </span>
<span>              block <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">block</span><span class="op">)</span>,</span>
<span>              variant <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">variant</span><span class="op">)</span>,</span>
<span>              day <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">day</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Jetzt brauchen wir aber die Datensätze wieder einzeln und wollen uns daher einmal die beiden Listen <code>as</code> und <code>water</code> mit der Funktion <code>pluck()</code> aus der Liste rausziehen und in ein eigenes Objekt abspeichern.</p>
<div class="cell">
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">as_tbl</span> <span class="op">&lt;-</span> <span class="fu">pluck</span><span class="op">(</span><span class="va">plowing_lst</span>, <span class="st">"as"</span><span class="op">)</span></span>
<span><span class="va">water_tbl</span> <span class="op">&lt;-</span> <span class="fu">pluck</span><span class="op">(</span><span class="va">plowing_lst</span>, <span class="st">"water"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nun kommen wir zu der Möglichkeit ein Template in <code>ggplot</code> anzulegen. Wir bauen uns dafür einfach genau so wie immer ein <code>ggplot</code>. Mit der Ausnahme, dass wir <em>keine</em> Daten in die Funktion <code>ggplot()</code> stecken sondern eine leere Funktion <code>ggplot()</code> mit der Funktion <code>aes()</code> verbinden. Das machen wir dann für alle Layer, die wir dann in dem <code>ggplot()</code> sehen wollen. Dann speichern wir das <code>ggplot</code> Objekt für unseren Barplot ab.</p>
<div class="cell">
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p_template</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">variant</span>, y <span class="op">=</span> <span class="va">mean</span>, group <span class="op">=</span> <span class="va">day</span>, fill <span class="op">=</span> <span class="va">day</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">mean</span><span class="op">-</span><span class="va">sd</span>, ymax <span class="op">=</span> <span class="va">mean</span><span class="op">+</span><span class="va">sd</span><span class="op">)</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">0.2</span>, position <span class="op">=</span> <span class="fu">position_dodge</span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Tag"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_okabeito</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir wollen jetzt einmal für das Outcome <code>as</code> den Barplot erstellen. Dafür brauchen wir wieder die Daten, die wir uns mit der Funktion <code>summarise()</code> zusammenbauen. Wir haben dann die Mittelwerte und die Standardabweichung für die Behandlungen.</p>
<div class="cell">
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">as_stat_tbl</span> <span class="op">&lt;-</span> <span class="va">as_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">day</span>, <span class="va">variant</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">as</span><span class="op">)</span>,</span>
<span>            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">as</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'day'. You can override using the `.groups`
argument.</code></pre>
</div>
</div>
<p>In der <a href="#fig-app-exp-plow-01">Abbildung&nbsp;<span>A.13</span></a> sehen wir dann den Barplot für unser Outcome <code>as</code>. Der Barplot ist jetzt erstmal nichts besonderes, aber wie wir den Plot bauen schon. Wir nutzen dafür den Operator <code>%+%</code>. Mit dem Operator <code>%+%</code> können wir einen leeren <code>ggplot</code> mit einem neuen Datensatz verbinden. Wichtig ist nur, dass die Spaltennamen dann jeweils übereinstimmen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p_template</span> <span class="op">%+%</span> <span class="va">as_stat_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-exp-plow-01" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-exp-plow-01-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.13— Barplot für das Outcome <code>as</code>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Das ganze können wir dann auch einmal für das Outcome <code>water</code> machen.</p>
<div class="cell">
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">water_stat_tbl</span> <span class="op">&lt;-</span> <span class="va">water_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">day</span>, <span class="va">variant</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">water</span><span class="op">)</span>,</span>
<span>            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">water</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'day'. You can override using the `.groups`
argument.</code></pre>
</div>
</div>
<p>In der <a href="#fig-app-exp-plow-02">Abbildung&nbsp;<span>A.14</span></a> sehen wir dann die Anwendung des Operators <code>%+%</code> auf den Datensatz für unser Outcome <code>water</code>. Das ist jetzt natürlich sehr effizient. Wir können das Template auf die anderen beiden Outcomes ebenfalss anwenden. Damit sind wir sicher, das wir immer die gleiche Beschriftung und eben auch die gleichen Farben haben.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p_template</span> <span class="op">%+%</span> <span class="va">water_stat_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-exp-plow-02" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-exp-plow-02-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.14— Barplot für das Outcome <code>water</code>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Wie immer musst du bei jedem Beispiel schauen, ob du alles so stark automatisieren willst. Meistens ist die Automatisierung nicht notwendig, aber wenn du wie ich dann teilweise sehr viele Datensätze auswertest, dann geht die Auswertung natürlich mit einer Automatisierung sehr viel schneller.</p>
</section><section id="sec-app-mixed-cutting" class="level2 page-columns page-full" data-number="A.10"><h2 data-number="A.10" class="anchored" data-anchor-id="sec-app-mixed-cutting">
<span class="header-section-number">A.10</span> Auswertung mit Messwiederholungen</h2>
<p>In diesem Abschnitt wollen wir ein multiples lineares Gaussion gemischtes Modell rechnen. Das heißt, wir wollen die Messwiederholungen über die Wochen mit in unser Modell als einen zufälligen Effekt aufnehmen. Dafür brauchen wir wieder unsere Daten zu dem Rückschnitt. Wir nehmen aber hier nur die Trieblänge als normalverteiltes Outcome. Dann wollen wir herausfinden, ob die drei Arten des Rückschnitts und die Kontrolle einen Einfluss auf die Trieblänge haben.</p>
<div class="cell">
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cutting_raw_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/cutting_data.xlsx"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">clean_names</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir in <a href="#sec-cutting"><span>Kapitel&nbsp;A.7</span></a> müssen wir die Daten wieder von dem Wide-Format in das Long-Format umwandeln. Wir wollen aber vorher nur die Spalten wähen die <code>shoot</code> in dem Spaltennamen haben. Diese Auswahl können wir über die Funktion <code>matches()</code> erreichen. Dann können wir die Funktion <code>pivot_longer()</code> nutzen um unseren Datensatz in dem Long_Format zu bauen.</p>
<div class="cell">
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cutting_tbl</span> <span class="op">&lt;-</span> <span class="va">cutting_raw_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">trt</span>, <span class="va">block</span>, <span class="fu">matches</span><span class="op">(</span><span class="st">"shoot"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">shoot_1</span><span class="op">:</span><span class="fu">last_col</span><span class="op">(</span><span class="op">)</span>, </span>
<span>               names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"outcome"</span>, <span class="st">"week"</span><span class="op">)</span>, </span>
<span>               names_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"rsp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">outcome</span>, <span class="va">week</span>, <span class="va">trt</span>, <span class="va">block</span>, <span class="va">rsp</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>block <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">block</span><span class="op">)</span>,</span>
<span>         trt <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">trt</span><span class="op">)</span>,</span>
<span>         outcome <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span>,</span>
<span>         week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">week</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Schauen wir uns in der <a href="#fig-app-exp-lmer-01">Abbildung&nbsp;<span>A.15</span></a> nochmal die Daten an. Wir haben einen Effekt zwischen den Behandlungen an jedem Messtermin. Die Pflanzen an den jeweiligen Messterminen sind aber nicht unabhängig voneinander. Wir messen ja immer wieder die gleiche Pflanze. So sind die Messtermine untereinander korreliert. Um diese Korrelation oder Abhängigkeit der Mestermine zu modellieren, nutzen wir lineare gemischte Modelle.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cutting_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">week</span>, <span class="va">rsp</span>, color <span class="op">=</span> <span class="va">trt</span>, linetype <span class="op">=</span> <span class="va">block</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_smooth</span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_okabeito</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-exp-lmer-01" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-exp-lmer-01-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.15— Abbildung der vier Outcomes über die acht Messtermine mit den vier Behandlungen und den zwei Blöcken.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In R nutzen wir das Paket <code>lme4</code> mit der Funktion <code>lmer()</code> um ein lineares gemisches Modell mit Normalverteilungsannahme zu fitten. Der vordere Teil des Modells ist gleich wie in einem normalen linearen Modell. Was sich hier ändert ist der zufällige Effekt, den wir durch <code>(1|week)</code> beschreiben. Unsere Wochen sind untereinander korreliert und deshalb wandert der Faktor Woche in den zufälligen Term.</p>
<div class="cell">
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lmer_fit</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">rsp</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="va">block</span> <span class="op">+</span> <span class="va">trt</span><span class="op">:</span><span class="va">block</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">week</span><span class="op">)</span>, </span>
<span>                 data <span class="op">=</span> <span class="va">cutting_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Schauen wir einmal an, wie gut unser Modell funktioniert hat. Wieviel der Varianz kann denn unser Modell erklären? Wir nutzen dazu die Funktion <code>r2()</code> aus dem R Paket <code>performance</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lmer_fit</span> <span class="op">%&gt;%</span> <span class="va">r2</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.940
     Marginal R2: 0.470</code></pre>
</div>
</div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="">Das <span class="math inline">\(R^2_{conditional}\)</span> ist der erklärte Anteil der Varianz von den festen und zufälligen Effekten zusammen. Das <span class="math inline">\(R^2_{marginal}\)</span> ist der erklärte Anteil der Varianz von den festen Effekten alleine.</span></div></div>
<p>Das <span class="math inline">\(R^2_{conditional}\)</span> ist der erklärte Anteil der Varianz von den festen und zufälligen Effekten zusammen. Da wir hier ein <span class="math inline">\(R^2\)</span> von fast 95% haben, können wir mit unserem Modell fast die gesamte Variabilität in unserem Experiment erklären. Das ist selten zu beobachten, aber sehr schön. Das <span class="math inline">\(R^2_{marginal}\)</span> ist der erklärte Anteil der Varianz von den festen Effekten alleine. Hier haben wir dann gut 50% erklärte Varianz. Damit wissen wir immerhin, dass gut die Hälfte der Variabilität in unseren Daten von unserer behandlung kommt, unabhängig von dem zufälligen Effekt.</p>
<p>Wir können dann noch den Intraclass Correlation Coefficient (abk. <em>ICC</em>) berechnen. Der <em>ICC</em> beschreibt den Anteil der Varianz, der durch die Gruppierungsstruktur in der Stichprobe erklärt wird. Wir können den Wert direkt aus der Summary des <code>lmer</code> Objektes berechnen.</p>
<div class="cell">
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lmer_fit</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: rsp ~ trt + block + trt:block + (1 | week)
   Data: cutting_tbl

REML criterion at convergence: 1067.5

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-3.59023 -0.52072 -0.00942  0.49560  4.68315 

Random effects:
 Groups   Name        Variance Std.Dev.
 week     (Intercept) 109.134  10.4467 
 Residual              13.818   3.7173 
Number of obs: 192, groups:  week, 8

Fixed effects:
                       Estimate Std. Error  t value
(Intercept)           47.284722   3.770618  12.5403
trtnodium_3rd        -21.298611   1.073088 -19.8480
trtnodium_5th        -15.576389   1.073088 -14.5155
trtstrong            -29.034722   1.073088 -27.0572
block2                -0.014028   1.073088  -0.0131
trtnodium_3rd:block2  -2.194167   1.517575  -1.4458
trtnodium_5th:block2  -1.576111   1.517575  -1.0386
trtstrong:block2       2.979444   1.517575   1.9633

Correlation of Fixed Effects:
            (Intr) trtn_3 trtn_5 trtstr block2 tr_3:2 tr_5:2
trtnodm_3rd -0.142                                          
trtnodm_5th -0.142  0.500                                   
trtstrong   -0.142  0.500  0.500                            
block2      -0.142  0.500  0.500  0.500                     
trtndm_3r:2  0.101 -0.707 -0.354 -0.354 -0.707              
trtndm_5t:2  0.101 -0.354 -0.707 -0.354 -0.707  0.500       
trtstrng:b2  0.101 -0.354 -0.354 -0.707 -0.707  0.500  0.500</code></pre>
</div>
</div>
<p>Dafür nehmen wir die Varianz der Gruppe <code>week</code> und teilen die Varianz durch die gesamte Varianz bestehend aus den Residuen plus der Varianz der Gruppe. Damit erfahren wir dann, dass in der zufälligen Effekten unsere Gruppe <code>week</code> fast 90% der Varianz erklärt. Was wiederum ein wirklich guter Wert ist.</p>
<p><span class="math display">\[
ICC = 109.134/(109.134 + 13.818) = 0.888
\]</span></p>
<p>Natürlich können wir das ICC auch direkt in R mit einer Funktion berechnen lassen. Wir nutzen nur den adjustierten ICC und ignorieren in diesem Fall den anderen Wert.</p>
<div class="cell">
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lmer_fit</span> <span class="op">%&gt;%</span> <span class="va">icc</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.888
  Unadjusted ICC: 0.471</code></pre>
</div>
</div>
<p>Jetzt können wir noch flott die paarweisen Vergleiche rechnen, denn praktischerweose ändert sich hier nichts mehr. Wir können die den Fit aus unserem linearen gemischten Modell einfach in die Funktionalität von <code>emmeans</code> pipen und dann geht alles seinen normalen Gang.</p>
<div class="cell">
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">emm_obj</span> <span class="op">&lt;-</span> <span class="va">lmer_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span>specs <span class="op">=</span> <span class="op">~</span> <span class="va">trt</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir machen auch hier wieder so weiter wie wir es schon gewöhnt sind. Einmal rechnen wir die paarweisen Vergleiche mit Bonferroni adjustierten <span class="math inline">\(p\)</span>-Werten. Spannend ist jetzt, dass wir hier <em>über alle Messzeitpunkte hinweg</em> einen Unterschied zwischen allen Behandlungen sehen.</p>
<div class="cell">
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">emm_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"pairwise"</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                estimate    SE  df t.ratio p.value
 control - nodium_3rd       22.40 0.759 177  29.515  &lt;.0001
 control - nodium_5th       16.36 0.759 177  21.567  &lt;.0001
 control - strong           27.55 0.759 177  36.301  &lt;.0001
 nodium_3rd - nodium_5th    -6.03 0.759 177  -7.949  &lt;.0001
 nodium_3rd - strong         5.15 0.759 177   6.786  &lt;.0001
 nodium_5th - strong        11.18 0.759 177  14.735  &lt;.0001

Results are averaged over the levels of: block 
Degrees-of-freedom method: kenward-roger 
P value adjustment: bonferroni method for 6 tests </code></pre>
</div>
</div>
<p>Dann lassen wir uns noch das <em>Compact letter display</em> für die Trieblänge wiedergeben. Auch hier sehen wir, dass sich alle Behandlungen voneinander über alle Zeitpunkte hinweg voneinander unterscheiden. Das stimmt dann auch mit unserer Abbildung überein, die Geraden der Behandlungen laufen ja alle nebeneinander mit Abstand.</p>
<div class="cell">
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">emm_obj</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">cld</span><span class="op">(</span>Letters <span class="op">=</span> <span class="va">letters</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> trt        emmean   SE   df lower.CL upper.CL .group
 strong       19.7 3.73 7.22     7.41     32.1  a    
 nodium_3rd   24.9 3.73 7.22    12.56     37.2   b   
 nodium_5th   30.9 3.73 7.22    18.59     43.2    c  
 control      47.3 3.73 7.22    34.95     59.6     d 

Results are averaged over the levels of: block 
Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 4 estimates 
P value adjustment: bonferroni method for 6 tests 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Und dann nochmal der Vergleich zu der Kontrolle, falls das mehr gewünscht sein sollte. Auch hier sehen wir, dass alle Vergleiche zu der Kontrolle signifikant sind. Über alle Messzeitpunkte hinweg ist die Kontrolle immer Größer als die Pflanzen mit den Rückschnittbehandlungen.</p>
<div class="cell">
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">emm_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"trt.vs.ctrlk"</span>, ref <span class="op">=</span> <span class="fl">1</span>, </span>
<span>           adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast             estimate    SE  df t.ratio p.value
 nodium_3rd - control    -22.4 0.759 177 -29.515  &lt;.0001
 nodium_5th - control    -16.4 0.759 177 -21.567  &lt;.0001
 strong - control        -27.5 0.759 177 -36.301  &lt;.0001

Results are averaged over the levels of: block 
Degrees-of-freedom method: kenward-roger 
P value adjustment: bonferroni method for 3 tests </code></pre>
</div>
</div>
</section><section id="sec-app-spinach-metal" class="level2 page-columns page-full" data-number="A.11"><h2 data-number="A.11" class="anchored" data-anchor-id="sec-app-spinach-metal">
<span class="header-section-number">A.11</span> Spurenelemente in Spinatblättern und Stielen</h2>
<p>In der folgenden Datenanalyse schauen wir uns die Konzentrationen von den Spurenelementen Fe, Cd und Zn in Spinat an. Dabei haben wir zum einen in den Blätter und zum anderen in den Stielen gemessen. Daher haben wir insgesamt drei Outcomes an zwei Orten und somit sechs Kombinationen auszuwerten. Wir haben uns darüber hinaus noch sieben Behandlungen in je vier Blöcken als Wiederholung angeschaut. Laden wir also einmal die Daten.</p>
<div class="cell">
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spinach_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/spinach_metal_data.xlsx"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>trt <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">trt</span><span class="op">)</span>,</span>
<span>         sample <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">sample</span><span class="op">)</span>,</span>
<span>         block <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">block</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir haben die Daten im Wide-Format vorliegen, daher müssen wir die Daten über die Funktion <code>pivot_longer()</code> noch in das Long-Format umwandeln. Zum einen brauchen wir das Long-Format für unsere Abbildungen und zum anderen dann auch für unsere Analysen.</p>
<div class="cell">
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spinach_plot_tbl</span> <span class="op">&lt;-</span> <span class="va">spinach_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">fe</span><span class="op">:</span><span class="va">zn</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"rsp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>outcome <span class="op">=</span> <span class="fu">as_factor</span><span class="op">(</span><span class="va">outcome</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spinach_plot_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">head</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  trt   sample block outcome     rsp
  &lt;fct&gt; &lt;fct&gt;  &lt;fct&gt; &lt;fct&gt;     &lt;dbl&gt;
1 1     leaf   1     fe      16.9   
2 1     leaf   1     cd       9.28  
3 1     leaf   1     zn       0.127 
4 1     stem   1     fe       7.95  
5 1     stem   1     cd       7.97  
6 1     stem   1     zn       0.0579</code></pre>
</div>
</div>
<p>Wir sehen, dass wir für jede Outcome/Sample Kombination ein zweifaktorielles Modell für Behandlung und Block rechnen müssen. Schauen wir uns zuerst wie immer einmal die <a href="#fig-app-exp-spinach-01">Abbildung&nbsp;<span>A.16</span></a> in <code>ggplot()</code> an und machen dann mit der Auswertung weiter.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">spinach_plot_tbl</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">trt</span>, <span class="va">rsp</span>, shape <span class="op">=</span> <span class="va">block</span>, color <span class="op">=</span> <span class="va">trt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_jitter</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">outcome</span><span class="op">*</span><span class="va">sample</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Behandlung"</span>, y <span class="op">=</span> <span class="st">"Gemessenes Outcome"</span>,</span>
<span>       shape <span class="op">=</span> <span class="st">"Block"</span>, color <span class="op">=</span> <span class="st">"Behandlung"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_okabeito</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-exp-spinach-01" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-exp-spinach-01-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.16— Abbildung der drei Outcomes in den zwei Samples für die sieben Behandlungen in jeweils vier Blöcken.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Da wir nur eine Beobachtung je Block/Behandlung Kombination haben, können wir später keine Interaktion rechnen. Wir bräiuchten dafür Wiederholungen auf der Ebene der Blöcke. Also nicht nur eine Pflanze pro Block und Behandlung. Im Folgenden gibt es einmal die umständliche Copy&amp;Paste Variante und einmal die etwas komplexere Lösung über <code>map()</code> und <code>nest()</code>.</p>
<section id="eisen-fe-und-blatt" class="level3 page-columns page-full" data-number="A.11.1"><h3 data-number="A.11.1" class="anchored" data-anchor-id="eisen-fe-und-blatt">
<span class="header-section-number">A.11.1</span> Eisen (Fe) und Blatt</h3>
<p>Machen wir es uns erstmal einfach. Wir müssen ja für jede der sechs Outcome/Sample Kombinationen eine ANOVA rechnen, dann rechnen wir einen multiplen Vergleich und lassen uns das <em>Compact letter display</em> wiedergeben. Das machen wir jetzt alles einmal für die Kombination Eisen und Blatt.</p>
<p>Also brauchen wir als erstes unseren Datensatz mit nur dem Outcome gleich <code>fe</code> und das Sample gleich <code>leaf</code>. Das Selektieren machen wir dann über die Funktion <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fe_leaf_tbl</span> <span class="op">&lt;-</span> <span class="va">spinach_plot_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">==</span> <span class="st">"fe"</span> <span class="op">&amp;</span> <span class="va">sample</span> <span class="op">==</span> <span class="st">"leaf"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dan müssen wir das lineare Modell schätzen. Das Schätzen der Koeffizienten übernimmt wie immer die Funktion <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>. Wir nehmen hier an, dass unsere Konzentrationen ungefähr normalverteilt sind. Wir können den Interaktionsterm <code>trt:block</code> nicht mit ins Modell nehmen, da wir nur eine Beobachtung je Behandlung/Block Kombination haben.</p>
<div class="cell">
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fe_leaf_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">rsp</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="va">block</span>, data <span class="op">=</span> <span class="va">fe_leaf_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Jetzt können wir die ANOVA rechnen und schauen was wir da haben.</p>
<div class="cell">
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fe_leaf_fit</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: rsp
          Df   Sum Sq  Mean Sq  F value        Pr(&gt;F)    
trt        6 1015.454 169.2424 19.05310 0.00000067589 ***
block      3   84.352  28.1174  3.16542      0.049752 *  
Residuals 18  159.888   8.8827                           
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Wir haben einen ganz schwachen signifikanten Effekt des Blocks und einen starken signifikanten Effekt der Behandlung. Der Effekt des Blocks ist nicht so schön, wir würden eigentlich erwarten, dass der Block keinen Effekt hat. Wir haben ja die Zuordnung der Behandlungen zu den Blöcken zufällig durchgeführt. Da sollte also eigentlich kein Effekt des Blocks auftreten. Schauen wir nochmal wie stark die Effekte sind in dem wir uns das <span class="math inline">\(\eta^2\)</span> berechnen.</p>
<div class="cell">
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fe_leaf_fit</span> <span class="op">%&gt;%</span> <span class="fu">eta_squared</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Effect Size for ANOVA (Type I)

Parameter | Eta2 (partial) |       95% CI
-----------------------------------------
trt       |           0.86 | [0.73, 1.00]
block     |           0.35 | [0.00, 1.00]

- One-sided CIs: upper bound fixed at [1.00].</code></pre>
</div>
</div>
<p>Der Effekt der behandlung it auf jeden Fall größer als der Effelt des Blocks. Gut 86% der Vrainz wird durch die Behandlung erklärt, dass passt dann soweit.</p>
<p>Wir rechnen jetzt mit der Funktion <code>emmeans()</code> weiter und berücksichtigen dabei die unterschiedlichen Mittelwerte der Blöcke für die einzelnen Behandlungen.</p>
<div class="cell">
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fe_leaf_emm</span> <span class="op">&lt;-</span> <span class="va">fe_leaf_fit</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">emmeans</span><span class="op">(</span><span class="op">~</span> <span class="va">trt</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Jetzt können wir un die paarweisen Vergleich über die Funktion <code>contrast()</code> wiedergeben lassen. Wir sehen, dass wir einiges an signifikanten Ergebnissen vorliegen haben. Du kannst die Ausgabe in ein Tibble mit <code>as_tibble()</code> umwandeln und dir dann mit der Funktion <code>print(n = 21)</code> alle Zeilen ausgeben lassen.</p>
<div class="cell">
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fe_leaf_emm</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">contrast</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"pairwise"</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast    estimate   SE df t.ratio p.value
 trt1 - trt2   -7.844 2.11 18  -3.722  0.0328
 trt1 - trt3  -12.156 2.11 18  -5.768  0.0004
 trt1 - trt4  -17.429 2.11 18  -8.270  &lt;.0001
 trt1 - trt5  -11.218 2.11 18  -5.323  0.0010
 trt1 - trt6  -16.877 2.11 18  -8.008  &lt;.0001
 trt1 - trt7  -18.222 2.11 18  -8.646  &lt;.0001
 trt2 - trt3   -4.312 2.11 18  -2.046  1.0000
 trt2 - trt4   -9.585 2.11 18  -4.548  0.0052
 trt2 - trt5   -3.374 2.11 18  -1.601  1.0000
 trt2 - trt6   -9.033 2.11 18  -4.286  0.0093
 trt2 - trt7  -10.378 2.11 18  -4.924  0.0023
 trt3 - trt4   -5.273 2.11 18  -2.502  0.4664
 trt3 - trt5    0.938 2.11 18   0.445  1.0000
 trt3 - trt6   -4.721 2.11 18  -2.240  0.7970
 trt3 - trt7   -6.066 2.11 18  -2.878  0.2101
 trt4 - trt5    6.211 2.11 18   2.947  0.1809
 [ reached getOption("max.print") -- omitted 5 rows ]

Results are averaged over the levels of: block 
P value adjustment: bonferroni method for 21 tests </code></pre>
</div>
</div>
<p>Schauen wir uns für diesen Vergleich dann noch das <em>Compact letter display</em> an. Bitte beachte, dass du dir mit der Funktion <code>arrange()</code> immer die Reihenfolge der Behandlungen ausgeben lassen kannst. Sonst ist die Ausgabe nach der Spalte <code>.group</code> sortiert und nicht nach den Behandlungen. Wenn die Buchstaben nicht gleich sind, dann unterscheiden sich die Behandlungen.</p>
<div class="cell">
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fe_leaf_emm</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">cld</span><span class="op">(</span>Letters <span class="op">=</span> <span class="va">letters</span>, adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">trt</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> trt emmean   SE df lower.CL upper.CL .group
 1     11.8 1.49 18     8.66     14.9  a    
 2     19.6 1.49 18    16.50     22.8   b   
 3     23.9 1.49 18    20.81     27.1   b   
 4     29.2 1.49 18    26.09     32.3    c  
 5     23.0 1.49 18    19.88     26.1   b   
 6     28.7 1.49 18    25.53     31.8    c  
 7     30.0 1.49 18    26.88     33.1    c  

Results are averaged over the levels of: block 
Confidence level used: 0.95 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Auch hier schauen wir uns einmal die Korrelation zwischen den Outcomes in der <a href="#fig-app-exp-spinach-02">Abbildung&nbsp;<span>A.17</span></a> an. Wir sehen in der <a href="#fig-app-exp-spinach-02-1">Abbildung&nbsp;<span>A.17 (a)</span></a> die Korrelation zwischen den beiden Outcomes Fe und Zn zusammen in den Blättern und den Stielen. Wir würden meinen, dass wir eine positive Korrelation vorliegen haben. Wir sehen, dass mit mehr Zn auch mehr Fe auftritt. Was uns aber etwas stutzig werden lässt, sind die beiden Punktewolken in der linken unteren Abbildung. Daher einmal schnell aufgetrennt für die Blätter in <a href="#fig-app-exp-spinach-02-2">Abbildung&nbsp;<span>A.17 (b)</span></a> und für die Stiele in <a href="#fig-app-exp-spinach-02-3">Abbildung&nbsp;<span>A.17 (c)</span></a>. Wir sehen, dass wir nichts sehen. Denn getrennt für die Blätter und Stiele haben wir dann keine Korrelation mehr für die beiden Outcomes vorliegen.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spinach_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">fe</span>, <span class="va">zn</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pairs.panels</span><span class="op">(</span>smooth <span class="op">=</span> <span class="cn">TRUE</span>, density <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"kendall"</span>, lm <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>               cor <span class="op">=</span> <span class="cn">TRUE</span>, ellipses <span class="op">=</span> <span class="cn">FALSE</span>, stars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">spinach_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">sample</span> <span class="op">==</span> <span class="st">"leaf"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">fe</span>, <span class="va">zn</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pairs.panels</span><span class="op">(</span>smooth <span class="op">=</span> <span class="cn">TRUE</span>, density <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"kendall"</span>, lm <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>               cor <span class="op">=</span> <span class="cn">TRUE</span>, ellipses <span class="op">=</span> <span class="cn">FALSE</span>, stars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>    </span>
<span></span>
<span><span class="va">spinach_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">sample</span> <span class="op">==</span> <span class="st">"stem"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">fe</span>, <span class="va">zn</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pairs.panels</span><span class="op">(</span>smooth <span class="op">=</span> <span class="cn">TRUE</span>, density <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"kendall"</span>, lm <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>               cor <span class="op">=</span> <span class="cn">TRUE</span>, ellipses <span class="op">=</span> <span class="cn">FALSE</span>, stars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-app-exp-spinach-02" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-app-exp-spinach-02-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-exp-spinach-02-1.png" class="img-fluid figure-img" data-ref-parent="fig-app-exp-spinach-02" width="576"></p>
<p></p><figcaption class="figure-caption">(a) Blätter und Stiele.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-app-exp-spinach-02-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-exp-spinach-02-2.png" class="img-fluid figure-img" data-ref-parent="fig-app-exp-spinach-02" width="576"></p>
<p></p><figcaption class="figure-caption">(b) Nur Blätter.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-app-exp-spinach-02-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-exp-spinach-02-3.png" class="img-fluid figure-img" data-ref-parent="fig-app-exp-spinach-02" width="576"></p>
<p></p><figcaption class="figure-caption">(c) Nur Stiele.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.17— Korrelation und Verteilung zwischen den Outcomes Fe und Zn.</figcaption><p></p>
</figure>
</div>
</div>
</section><section id="und-alles-aufeinmal" class="level3" data-number="A.11.2"><h3 data-number="A.11.2" class="anchored" data-anchor-id="und-alles-aufeinmal">
<span class="header-section-number">A.11.2</span> Und alles aufeinmal…</h3>
<p>Nun gut, jetzt haben wir unsere Analyse für das Blatt und den Eisengehalt gerechnet. Wir müssten jetzt die Analyse nochmal für alle anderen fünf Kombinationen durchführen. Das würde einiges an Zeit kosten und auch sehr viel Copy&amp;Paste Aufwand. Kann man machen, aber wir können die Analyse auch in einem Rutsch durchführen. Dafür nutzen wir die Funktion <code>nest()</code> und dann anschließend die Funktion <code>map()</code> um auf den genesteten Daten die Analysen zu rechnen.</p>
<p>Im ersten Schritt müssen wir unsere Daten gruppieren. Wir haben dann die sechs Kombinationen aus Outcome und Sample vorliegen. Dann nesten wir den Datensatz in sechs Zeilen. Wir klappen sozusagen die Daten für jede der sechs Kombinationen zusammen. Alles fällt dann in eine Zelle zusammen.</p>
<div class="cell">
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spinach_nest_tbl</span> <span class="op">&lt;-</span> <span class="va">spinach_plot_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">sample</span>, <span class="va">outcome</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">nest</span><span class="op">(</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Schauen wir uns den genesteten Datensatz einmal an. Wir sehen, dass wir die gesamten Daten in der Spalte <code>data</code> zusammengefaltet haben. Wir haben also sechs Tibbles mit den Daten der jeweiligen Outcome/Sample Kombinationen in der Spalte <code>data</code> vorliegen.</p>
<div class="cell">
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spinach_nest_tbl</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
# Groups:   sample, outcome [6]
  sample outcome data             
  &lt;fct&gt;  &lt;fct&gt;   &lt;list&gt;           
1 leaf   fe      &lt;tibble [28 × 3]&gt;
2 leaf   cd      &lt;tibble [28 × 3]&gt;
3 leaf   zn      &lt;tibble [28 × 3]&gt;
4 stem   fe      &lt;tibble [28 × 3]&gt;
5 stem   cd      &lt;tibble [28 × 3]&gt;
6 stem   zn      &lt;tibble [28 × 3]&gt;</code></pre>
</div>
</div>
<p>Wir können jetzt auf den Tibbles in der Spalte <code>data</code> weiter rechnen. Wir nutzen für das Weiterrechnen die Funktion <code>map()</code>, die in jeder Zeile der Spalte <code>.data</code> die gleiche Funktion ausführt. Unser Ergebnis speichern wir dann in einer neuen Spalte und dafür nutzen wir die Funktion <code>mutate()</code>.</p>
<p>Konkret erstellen wir uns jetzt eine neue Spalte <code>model</code> in der das lineare Modell der Funktion <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> abliegt.</p>
<div class="cell">
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spinach_model_tbl</span> <span class="op">&lt;-</span> <span class="va">spinach_nest_tbl</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>model <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">rsp</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="va">block</span>, data <span class="op">=</span> <span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Im weiteren Schritt rechnen wir jetzt auf der Spalte <code>model</code> eine ANOVA und lassen uns dann die schönere Ausgabe über die Funktion <code>model_parameters()</code> wiedergeben. Der wichtigste Tiel ist die Funktion <code>unnest()</code> die uns die Zellen mit den ANOVA Ergebnissen dann wieder ausklappt. Der Rest ist dann noch filtern und anpassen. Ich möchte das die Ausgabe reduziert ist und die p-Werte sollen auch schön formatiert werden.</p>
<div class="cell">
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spinach_model_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>anova <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">model</span>, <span class="va">anova</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>parameter <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">anova</span>, <span class="va">model_parameters</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">sample</span>, <span class="va">outcome</span>, <span class="va">parameter</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">unnest</span><span class="op">(</span><span class="va">parameter</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Parameter</span> <span class="op">!=</span> <span class="st">"Residuals"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">sample</span>, <span class="va">outcome</span>, <span class="va">Parameter</span>, <span class="va">p</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>p <span class="op">=</span> <span class="fu">pvalue</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
# Groups:   sample, outcome [6]
   sample outcome Parameter p     
   &lt;fct&gt;  &lt;fct&gt;   &lt;chr&gt;     &lt;chr&gt; 
 1 leaf   fe      trt       &lt;0.001
 2 leaf   fe      block     0.050 
 3 leaf   cd      trt       0.047 
 4 leaf   cd      block     &lt;0.001
 5 leaf   zn      trt       0.424 
 6 leaf   zn      block     0.290 
 7 stem   fe      trt       0.021 
 8 stem   fe      block     0.016 
 9 stem   cd      trt       0.325 
10 stem   cd      block     &lt;0.001
11 stem   zn      trt       0.512 
12 stem   zn      block     &lt;0.001</code></pre>
</div>
</div>
<p>Auch können wir un die <span class="math inline">\(\eta^2\)</span> für die Modelle berechnen lassen. Die Funktion <code>unnest()</code> klappt uns dann die Ergebnisse wieder aus. Dann müssen wir noch etwas aufräumen und schon haben wir für alle Kombinationen dann den Anteil der erklärten Varianz.</p>
<div class="cell">
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spinach_model_tbl</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>eta <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">model</span>, <span class="va">eta_squared</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">unnest</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">clean_names</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">sample</span>, <span class="va">outcome</span>, <span class="va">eta2_partial</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
# Groups:   sample, outcome [6]
   sample outcome eta2_partial
   &lt;fct&gt;  &lt;fct&gt;          &lt;dbl&gt;
 1 leaf   fe             0.864
 2 leaf   fe             0.345
 3 leaf   cd             0.475
 4 leaf   cd             0.775
 5 leaf   zn             0.260
 6 leaf   zn             0.183
 7 stem   fe             0.529
 8 stem   fe             0.430
 9 stem   cd             0.295
10 stem   cd             0.652
11 stem   zn             0.232
12 stem   zn             0.589</code></pre>
</div>
</div>
<p>Im letzten Schritt bauen wir uns die Spalten für die Funktion <code>emmeans()</code>, dann die Kontraste und das <em>Compact letter display</em>. Hier nutzen wir die Schreibweise <code>map(&lt;Spalte&gt;, &lt;Funktion&gt;, &lt;Optionen&gt;)</code>. Daher definieren wir erst welche Spalte <code>map()</code> bearbeiten soll. Dann die Funktion die <code>map()</code> nutzen soll und anschließend die Optionen für die Funktion. Wir können hier auch mehrere Optionen nacheinander angeben.</p>
<div class="cell">
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spinach_emm_tbl</span> <span class="op">&lt;-</span> <span class="va">spinach_model_tbl</span> <span class="op">%&gt;%</span>  </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>emm <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">model</span>, <span class="va">emmeans</span>, <span class="op">~</span><span class="va">trt</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>contrast <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">emm</span>, <span class="va">contrast</span>, method <span class="op">=</span> <span class="st">"pairwise"</span>, </span>
<span>                        adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cld <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">emm</span>, <span class="va">cld</span>, Letters <span class="op">=</span> <span class="va">letters</span>, adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Jetzt lassen wir uns die Spalte <code>contrast</code> wiedergeben. Wir müssen aber vorher die Spalte noch in ein Tibble umwandeln. Dann wollen wir noch die p-Werte schöner haben. Wichtig ist auch immer, dass wir über die Funktion <code>select()</code> die für uns wichtigen Spalten auswählen.</p>
<div class="cell">
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spinach_emm_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>contrast <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">contrast</span>, <span class="va">as_tibble</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">unnest</span><span class="op">(</span><span class="va">contrast</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">sample</span>, <span class="va">outcome</span>, <span class="va">contrast</span>, <span class="va">p.value</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>p.value <span class="op">=</span> <span class="fu">pvalue</span><span class="op">(</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 126 × 4
# Groups:   sample, outcome [6]
   sample outcome contrast    p.value
   &lt;fct&gt;  &lt;fct&gt;   &lt;chr&gt;       &lt;chr&gt;  
 1 leaf   fe      trt1 - trt2 0.002  
 2 leaf   fe      trt1 - trt3 &lt;0.001 
 3 leaf   fe      trt1 - trt4 &lt;0.001 
 4 leaf   fe      trt1 - trt5 &lt;0.001 
 5 leaf   fe      trt1 - trt6 &lt;0.001 
 6 leaf   fe      trt1 - trt7 &lt;0.001 
 7 leaf   fe      trt2 - trt3 0.056  
 8 leaf   fe      trt2 - trt4 &lt;0.001 
 9 leaf   fe      trt2 - trt5 0.127  
10 leaf   fe      trt2 - trt6 &lt;0.001 
# … with 116 more rows</code></pre>
</div>
</div>
<p>Nachdem wir uns die Kontraste für die paarweisen Vergleiche wiedergeben haben lassen, wollen wir jetzt noch die ganzen <em>Compact letter displays</em> haben. Auch hier nutzen wir dann die Funktion <code>unnest()</code> und wolle dann nicht alle Spalten haben.</p>
<div class="cell">
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">spinach_emm_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cld <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">cld</span>, <span class="va">arrange</span>, <span class="va">trt</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">unnest</span><span class="op">(</span><span class="va">cld</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">sample</span>, <span class="va">outcome</span>, <span class="va">trt</span>, <span class="va">.group</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 42 × 4
# Groups:   sample, outcome [6]
   sample outcome trt   .group
   &lt;fct&gt;  &lt;fct&gt;   &lt;fct&gt; &lt;chr&gt; 
 1 leaf   fe      1     " a  "
 2 leaf   fe      2     "  b "
 3 leaf   fe      3     "  b "
 4 leaf   fe      4     "   c"
 5 leaf   fe      5     "  b "
 6 leaf   fe      6     "   c"
 7 leaf   fe      7     "   c"
 8 leaf   cd      1     " a  "
 9 leaf   cd      2     "  bc"
10 leaf   cd      3     "  bc"
11 leaf   cd      4     " ab "
12 leaf   cd      5     "   c"
13 leaf   cd      6     " abc"
14 leaf   cd      7     "  bc"
15 leaf   zn      1     " a"  
# … with 27 more rows</code></pre>
</div>
</div>
<p>Mit der Option <code>print(n = 15)</code> kannst du dir die ersten fünfzehn Zeilen ausgeben lassen. du musst also schauen, wie viele Zeilen dein Tibble hat und dann kannst du dir das ganze Tibble über die Funktion <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> ausgeben lassen. Ich nutze immer diese Art der Ausgabe mit <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> da es sicherer ist, als sich immer den ganzen Datensatz wiedergeben zu lassen. Mit sicherer meine ich, dass ich mir nicht die ganze R Console mit der Ausgabe zubaue.</p>
</section></section><section id="sec-app-logger" class="level2" data-number="A.12"><h2 data-number="A.12" class="anchored" data-anchor-id="sec-app-logger">
<span class="header-section-number">A.12</span> Daten eines automatischen Loggers</h2>
<div class="cell">
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">log_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/log_data.xlsx"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>date <span class="op">=</span> <span class="fu">as_date</span><span class="op">(</span><span class="va">date</span>, format <span class="op">=</span> <span class="st">'%d.%m.%Y'</span><span class="op">)</span>,</span>
<span>         date_time <span class="op">=</span> <span class="fu">as_datetime</span><span class="op">(</span><span class="fu">str_c</span><span class="op">(</span><span class="va">date</span>, <span class="st">" "</span>, <span class="va">time</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">date_time</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Insgesamt hat unsere Datei <span class="math inline">\(n = 35761\)</span> Beobachtungen für die Zeit vom 21. November 2022 bis zum 16. Dezember 2022.</p>
<div class="cell">
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">log_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35,761 × 6
   date_time           date       time       co2  temp  relh
   &lt;dttm&gt;              &lt;date&gt;     &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 2022-11-21 12:30:00 2022-11-21 12:30:00   896  18.2  61.7
 2 2022-11-21 12:31:00 2022-11-21 12:31:00   893  18.2  66.3
 3 2022-11-21 12:32:00 2022-11-21 12:32:00   893  18.4  67.8
 4 2022-11-21 12:33:00 2022-11-21 12:33:00   939  18.6  70  
 5 2022-11-21 12:34:00 2022-11-21 12:34:00   939  18.8  70.6
 6 2022-11-21 12:35:00 2022-11-21 12:35:00   975  19    70.3
 7 2022-11-21 12:36:00 2022-11-21 12:36:00   980  19.2  71.6
 8 2022-11-21 12:37:00 2022-11-21 12:37:00   986  19.4  71.8
 9 2022-11-21 12:38:00 2022-11-21 12:38:00   994  19.5  71.9
10 2022-11-21 12:39:00 2022-11-21 12:39:00   986  19.7  72.2
# … with 35,751 more rows</code></pre>
</div>
</div>
<p>Wir wollen dann auch die Outcomes nochmal anders benennen.</p>
<div class="cell">
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">log_plot_tbl</span> <span class="op">&lt;-</span> <span class="va">log_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">co2</span><span class="op">:</span><span class="va">relh</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"outcome"</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">"rsp"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">outcome</span>, </span>
<span>                          labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CO2"</span>, <span class="st">"Temperatur"</span>, <span class="st">"Rel. Luftfeuchtigkeit"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-app-log-01">Abbildung&nbsp;<span>A.18</span></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">log_plot_tbl</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">date_time</span>, <span class="va">rsp</span>, color <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">outcome</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_datetime</span><span class="op">(</span>date_labels <span class="op">=</span> <span class="st">"%b %d"</span>, date_breaks <span class="op">=</span> <span class="st">"3 day"</span>,</span>
<span>                   date_minor_breaks <span class="op">=</span> <span class="st">"1 day"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Datum"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-log-01" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-log-01-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.18— Abbildung der drei Outcomes über alle Messpunkte.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">log_plot_sum_tbl</span> <span class="op">&lt;-</span> <span class="va">log_plot_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">date</span>, <span class="va">outcome</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rsp</span><span class="op">)</span>,</span>
<span>            median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">rsp</span><span class="op">)</span>,</span>
<span>            sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">rsp</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-app-log-02">Abbildung&nbsp;<span>A.19</span></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">log_plot_sum_tbl</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">date</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">mean</span> <span class="op">-</span> <span class="va">sd</span>, </span>
<span>                  ymax <span class="op">=</span> <span class="va">mean</span> <span class="op">+</span> <span class="va">sd</span>, </span>
<span>                  fill <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">outcome</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_date</span><span class="op">(</span>date_labels <span class="op">=</span> <span class="st">"%b %d"</span>, date_breaks <span class="op">=</span> <span class="st">"3 day"</span>,</span>
<span>               date_minor_breaks <span class="op">=</span> <span class="st">"1 day"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Datum"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-log-02" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-log-02-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.19— Abbildung der drei Outcomes gemittelt für jeden Tag mit der Standardabweichung für den jeweiligen Tag über alle Zeitpunkte.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">log_plot_filter_tbl</span> <span class="op">&lt;-</span> <span class="va">log_plot_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="st">"12:00:00"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-app-log-03">Abbildung&nbsp;<span>A.20</span></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">log_plot_filter_tbl</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">date</span>, <span class="va">rsp</span>, color <span class="op">=</span> <span class="va">outcome</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">outcome</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_date</span><span class="op">(</span>date_labels <span class="op">=</span> <span class="st">"%b %d"</span>, date_breaks <span class="op">=</span> <span class="st">"3 day"</span>,</span>
<span>               date_minor_breaks <span class="op">=</span> <span class="st">"1 day"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Datum"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-app-log-03" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="app-example-analysis_files/figure-html/fig-app-log-03-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;A.20— Abbildung der drei Outcomes für den Zeitpunkt 12:00:00.</figcaption><p></p>
</figure>
</div>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./classification-neural-networks.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Neural networks</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./app-r-tutorial.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Tutorium in R</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>
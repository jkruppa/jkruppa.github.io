<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>35&nbsp; Der U-Test – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-tests-kruskal.html" rel="next">
<link href="./stat-tests-anova-manova.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="35&nbsp; Der U-Test – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-utest.html"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der U-Test</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der U-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#allgemeiner-hintergrund" id="toc-allgemeiner-hintergrund" class="nav-link active" data-scroll-target="#allgemeiner-hintergrund"><span class="header-section-number">35.1</span> Allgemeiner Hintergrund</a></li>
  <li><a href="#das-problem" id="toc-das-problem" class="nav-link" data-scroll-target="#das-problem"><span class="header-section-number">35.2</span> Das Problem…</a>
  <ul class="collapse">
  <li><a href="#der-gruppengröße" id="toc-der-gruppengröße" class="nav-link" data-scroll-target="#der-gruppengröße"><span class="header-section-number">35.2.1</span> …der Gruppengröße</a></li>
  <li><a href="#der-hypothesen" id="toc-der-hypothesen" class="nav-link" data-scroll-target="#der-hypothesen"><span class="header-section-number">35.2.2</span> …der Hypothesen</a></li>
  <li><a href="#des-effekts" id="toc-des-effekts" class="nav-link" data-scroll-target="#des-effekts"><span class="header-section-number">35.2.3</span> …des Effekts</a></li>
  </ul></li>
  <li><a href="#die-lösung" id="toc-die-lösung" class="nav-link" data-scroll-target="#die-lösung"><span class="header-section-number">35.3</span> Die Lösung</a></li>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">35.4</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">35.5</span> Daten</a></li>
  <li><a href="#hypothesen" id="toc-hypothesen" class="nav-link" data-scroll-target="#hypothesen"><span class="header-section-number">35.6</span> Hypothesen</a></li>
  <li><a href="#der-u-test" id="toc-der-u-test" class="nav-link" data-scroll-target="#der-u-test"><span class="header-section-number">35.7</span> Der U-Test</a>
  <ul class="collapse">
  <li><a href="#mit-unabhängigen-beobachtungen" id="toc-mit-unabhängigen-beobachtungen" class="nav-link" data-scroll-target="#mit-unabhängigen-beobachtungen"><span class="header-section-number">35.7.1</span> … mit unabhängigen Beobachtungen</a></li>
  <li><a href="#mit-abhängigen-beobachtungen" id="toc-mit-abhängigen-beobachtungen" class="nav-link" data-scroll-target="#mit-abhängigen-beobachtungen"><span class="header-section-number">35.7.2</span> … mit abhängigen Beobachtungen</a></li>
  </ul></li>
  <li><a href="#ergebnisse-mit-tidyplots" id="toc-ergebnisse-mit-tidyplots" class="nav-link" data-scroll-target="#ergebnisse-mit-tidyplots"><span class="header-section-number">35.8</span> Ergebnisse mit <code>{tidyplots}</code></a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-utest.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-utest.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-tests-preface-app.html">Statistische Gruppenvergleiche</a></li><li class="breadcrumb-item"><a href="./stat-tests-utest.html"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der U-Test</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-utest" class="quarto-section-identifier"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der U-Test</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 07. June 2025 um 11:10:34</em></p>
<blockquote class="blockquote">
<p><em>“Statisticians, like artists, have the bad habit of falling in love with their models.” — George Box</em></p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/caution.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/caution.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stand des Kapitels: Baustelle (seit 06.2025)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dieses Kapitel wird überarbeitet. Ziel ist es die Nichtparametrik zum Start des Wintersemesters 2025/26 überarbeitet zu haben. Da ich hier direkt im Kapitel arbeite, kann es sein, dass mal die ein oder andere Funktion nicht funktioniert oder aber Teile im Nichts enden. Wird dann repariert.</p>
</div>
</div>
<section id="allgemeiner-hintergrund" class="level2" data-number="35.1">
<h2 data-number="35.1" class="anchored" data-anchor-id="allgemeiner-hintergrund"><span class="header-section-number">35.1</span> Allgemeiner Hintergrund</h2>
<p>Der U-Test ist auch unter den Namen Wilcoxon-Mann-Whitney-Test, Mann-Whitney-U-Test oder Wilcoxon-Rangsummentest bekannt. Aus Gründen der Kürze werde ich hier immer von dem U-Test schreiben. Der U-Test wird häufig noch in den Grundlagenwissenschaften wie Zellforschung oder bie Mäusemodellen verwendet. Gerne auch bei genetischen Knockout-Experimenten mit einer kleinen Anzahl an Mäusen. In den Agrarwissenschaften treffen wir den U-Test nicht ganz so häufig, da wir meistens dann doch auf einem normalverteilten Messwert den ANOVA Pfad durchrechnen wollen.</p>
<p>Wann nutzen wir den Wilcoxon-Mann-Whitney-Test? Wir nutzen den Wilcoxon-Mann-Whitney-Test wenn wir zwei Verteilungen miteinander vergleichen wollen. Das ist jetzt sehr abstrakt und auch eins der Probleme des U-Tests. Wir würden sagen, dass wenn wir zwei Gruppen haben und ein nicht normalverteiltes <span class="math inline">\(y\)</span>, dann nutzen wir einen U-Test. Das ist aber stark verkürzt, mittlerweile haben wir in unserer statistischen Toolbox auch über das statistsiche Modellieren eine Lösungen für eine Vielzahl von Verteilungen. Keine Normalverteilung heißt nicht automatisch jetzt aber Nichtparametrik. Das war vielleicht Anfang der 90ziger so. Wir haben heute mehr Möglichkeiten — im Prinzip meine ich damit, dass der U-Test seine Nische verdient hat, aber eigentlich etwas veraltet ist mit seinen Problemen. Haben wir ein normalverteiltes <span class="math inline">\(y\)</span> rechnen wir meist einen t-Test. Wir könnten aber auch einen Wilcoxon-Mann-Whitney-Test auf einer Normalverteilung rechnen.</p>
<p>Was ist jetzt der Unterschied zwischen einem UTest und einem t-Test? Der t-Test vergleicht die Mittelwerte zweier Normalverteilungen, also zum Beispiel die Verteilung der Sprungweiten der Hundeflöhe gegen die Verteilung der Sprungweiten der Katzenflöhe. Dazu nutzt der t-Test die Mittelwerte und die Standardabweichung. Beides sind Parameter einer Verteilung und somit ist der t-Test ein parametrischer Test. Der Wilcoxon-Mann-Whitney-Test ist die nichtparametrische Variante in dem wir die Zahlen in Ränge umwandeln, also sortieren, und mit den Rängen der Zahlen rechnen. Die deskriptiven Maßzahlen wären dann Median, Quantile und Quartile. Also im Prinzip eine Rangtransformation und dann anschließend ein statistischer Test der Ränge. In der folgenden Abbildung habe ich dir einmal den Zusammenhhang zwischen den originalen Messwerten und der Rangtransformation dargestellt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ranked-00" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ranked-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-utest_files/figure-html/fig-ranked-00-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;35.1— Zusammenhang zwischen den originalen Messwerten und den rangierten Messwerten nach der Rangtransformation. Nach dem Rangieren haben alle Messwerte den gleichen Abstand."><img src="stat-tests-utest_files/figure-html/fig-ranked-00-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ranked-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;35.1— Zusammenhang zwischen den originalen Messwerten und den rangierten Messwerten nach der Rangtransformation. Nach dem Rangieren haben alle Messwerte den gleichen Abstand.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wenn wir von der Rangtransformation sprechen, dann treten auch häufiger Bindungen in den Messwerten auf. Bindungen sind kein Problem und können bei der Auswertung berücksichtigt werden. Je mehr Kommastellen ein kontinuierlicher Messwert hat, desto weniger Binden können natürlich auftreten. Bei ordinalen Daten wie Noten ist das natürlich nicht so einfach möglich.</p>
<dl>
<dt>Was sind Bindungen?</dt>
<dd>
<p>Bindungen treten bei der Rangtransformation auf, wenn wir gleiche originale Messwerte haben. Dann müssen wir zwei Messwerten den gleichen Rang geben. Wenn dieser Fall auftritt, dann sprechen wir von Bindungen in den Daten. Die nichtparametrischen Algorithmen haben dafür implementierte Lösungen.</p>
</dd>
</dl>
<p>Steigen wir also einmal mit einem plakativen Beispiel aus der Studie von <span class="citation" data-cites="sugimoto2023hyperactive">Sugimoto et al. (<a href="#ref-sugimoto2023hyperactive" role="doc-biblioref">2023</a>)</span> in die Thematik des U-Test ein. Ich habe die folgende Abbildung einmal mitgebracht in der wir die Mittewerte sowie die Standardabwichung von verschiedenen Messwerten für eien Wildtyp (WT) sowie einer genetischen Variante (Rag2) sehen. Die Sterne geben die Signifikanz des Vergleichs zwischen den Gruppen an.</p>
<div id="fig-utest-intro" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-utest-intro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/sugimoto_cell_mice.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;35.2— Left: Number of GFP+ MLL-AF9 cells in peripheral blood of WT and Rag2−/− mice. PB was collected 11 days after transplantation. Data are shown as means ± s.e.m. [n = 6 (male: n = 3, female: n = 3) for each group]. **P < 0.01；two-tailed Mann–Whitney test. Middle/right: Weight and size of spleens collected from WT or Rag2−/− mice 11 days after transplantation. Data are shown as means ± s.e.m. (n = 3 for each group, male). ***P < 0.001, ****P < 0.0001; two-tailed Student’s t test. Quelle: @sugimoto2023hyperactive"><img src="images/sugimoto_cell_mice.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-utest-intro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;35.2— <em>Left: Number of GFP+ MLL-AF9 cells in peripheral blood of WT and Rag2−/− mice. PB was collected 11 days after transplantation. Data are shown as means ± s.e.m. [n = 6 (male: n = 3, female: n = 3) for each group]. **P &lt; 0.01；two-tailed Mann–Whitney test. Middle/right: Weight and size of spleens collected from WT or Rag2−/− mice 11 days after transplantation. Data are shown as means ± s.e.m. (n = 3 for each group, male). ***P &lt; 0.001, ****P &lt; 0.0001; two-tailed Student’s t test.</em> Quelle: <span class="citation" data-cites="sugimoto2023hyperactive">Sugimoto et al. (<a href="#ref-sugimoto2023hyperactive" role="doc-biblioref">2023</a>)</span>
</figcaption>
</figure>
</div>
<p>Nachdem wir uns die <a href="#fig-utest-intro" class="quarto-xref">Abbildung&nbsp;<span>35.2</span></a> einmal genauer angeschaut haben, stellt sich die Frage warum wird in der Abbildung ganz links ein Mann-Whitney oder U-Test gerechnet und in den beiden anderen Abbildungen ein Student t-Test? Warum nicht auf alles ein U-Test rechnen? Immerhin würde ja auf das Gewicht und die Größe der Milz (eng. <em>spleen</em>) auch ein U-Test als statistischer Test auch gehen. Wir haben hier unterschiedliche Fallzahlen in den Gruppen. In der linken Abbildung haben wir pro Gruppe sechs Mäuse und in der mittleren sowie rechten Abbidlung nur drei Mäuse pro Gruppe. Macht das einen Unterschied? Ja, für den U-Test macht das einen gewaltigen Unterschied, wie wir gleich einmal sehen werden.</p>
</section>
<section id="das-problem" class="level2" data-number="35.2">
<h2 data-number="35.2" class="anchored" data-anchor-id="das-problem"><span class="header-section-number">35.2</span> Das Problem…</h2>
<p>Es gibt ein paar Probleme, wenn wir uns mit dem U-Test im Allgemeinen beschäftigen wollen. Diese Probleme sind eigentlich nicht weitläufig bekannt. Mir waren die Probleme auch nicht bekannt bis ich angefangen habe dieses Kapitel zu schreiben. Deshalb gehen wir mal die Probleme durch und leider gibt es nicht so richtig eine Lösung dafür. Es sind Probleme, die aus dem Algorithmus und der Transformation in Ränge entstehen.</p>
<section id="der-gruppengröße" class="level3" data-number="35.2.1">
<h3 data-number="35.2.1" class="anchored" data-anchor-id="der-gruppengröße"><span class="header-section-number">35.2.1</span> …der Gruppengröße</h3>
<blockquote class="blockquote">
<p><em>“Statistik fängt erst ab einer Gruppengröße von n gleich sieben überhaupt an.” — Ein anonymer Nichtparametriker</em></p>
</blockquote>
<p>Um das Problem der geringen Gruppengröße zu verstehen, müssen wir erstmal den Zusammenhang zwischen einem signifikanten Ergebnis und der Mittelwertsdifferenz als ein statistsiches Maß für den Effekt verstehen. Je größer der Effekt, desto eher sollte ein Vergleich zwischen zwei Gruppen signifikant unterschiedlich sein. In der folgenden Abbildung habe ich dir einmal den Zusammenhang zwischen der Mittelwerstdifferenz <span class="math inline">\(\Delta\)</span> und der Signifikanz dargestellt. Wie du siehst überlappen die Verteilungend der beiden Gruppen, wenn die Differenz der Mittelwerte klein ist. Je größer der Unterschied desto größer ist die Mittelwertsdifferenz. Soweit so klar. Damit sollten wir auch kleinere p-Werte erhalten, je größer die Mittelwertsdifferenz wird. Ich habe dir mal beispielhafte p-Werte in der Abbidung ergänzt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-utest-intro-sim-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-utest-intro-sim-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-utest_files/figure-html/fig-ggplot-utest-intro-sim-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;35.3— Darstellung des Zusammenhangs zwischen der Mittelwertsdifferenz und der zu erwartenden Signifikanz aus einem statistischen Tests für einen Zweigruppenvergleich. Die p-Werte sind abgeschätzt. (A) Die Mittelwertsdifferenz ist klein, es ist kein signifikanter Unterschied zu erwarten. Der p-Wert ist groß. (B) Die Mittelwertsdifferenz ist moderat, es ist ein kleiner p-Wert zu erwarten. (C) Die Mittelwertsdifferenz ist groß, damit ist der p-Wert kleiner als 0.001 und hoch signifikant. [Zum Vergrößern anklicken]"><img src="stat-tests-utest_files/figure-html/fig-ggplot-utest-intro-sim-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1152"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-utest-intro-sim-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;35.3— Darstellung des Zusammenhangs zwischen der Mittelwertsdifferenz und der zu erwartenden Signifikanz aus einem statistischen Tests für einen Zweigruppenvergleich. Die p-Werte sind abgeschätzt. <strong>(A)</strong> Die Mittelwertsdifferenz ist klein, es ist kein signifikanter Unterschied zu erwarten. Der p-Wert ist groß. <strong>(B)</strong> Die Mittelwertsdifferenz ist moderat, es ist ein kleiner p-Wert zu erwarten. <strong>(C)</strong> Die Mittelwertsdifferenz ist groß, damit ist der p-Wert kleiner als <span class="math inline">\(0.001\)</span> und hoch signifikant. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wenn wir jetzt den Zusammenhang zwischen der Mittelwertsdifferenz und dem p-Wert verstanden haben, können wir jetzt zum Problem der geringen Fallzahl in den Gruppen kommen. Wenn die Mittelwertsdifferenz ansteigt, dann sollte der p-Wert fallen. Wie du in folgender Abbildung links auch siehst, ist das der Fall. Für alle Kombinationen der Fallzahlen in den beiden Gruppen <span class="math inline">\(n_1\)</span> und <span class="math inline">\(n_2\)</span> fallen die p-Werte mit steigendem Effekt. Nur haben die p-Werte ein Plateau unter das sie nicht fallen können. Und bei einer Gruppengröße von 3 und 3 oder 4 und 3 können die p-Werte nicht kleiner als 0.05 werden egal wie groß die Mittelwertsdifferenz wird. Daher können wir mit diesen beiden Fallzahlkombinationen keinen signifkanten Unterschied nachweisen. Das sehen wir auch nochmal in der anderen Abbildung rechts, hier siehst du die minimalen p-Werte. Die p-Werte können in einem U-Test nicht unter gewisse Schranken fallen, abhängig von der Gruppenfallzahl.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-utest-intro-sim-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-utest-intro-sim-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-utest_files/figure-html/fig-ggplot-utest-intro-sim-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Abbildung&nbsp;35.4— Zusammenhang zwischen der Mittelwertsdifferenz und dem mittleren p-Wert aus einer Simulationsstudie abhängig von der Fallzahl in zwei Gruppen n_1 und n_2. Die graue Linie zeigt das 5% Signifikanzniveau an. (A) Mit steigender Mittelwertsdifferenz fallen die mittleren p-Werte. Die p-Werte erreichen je nach Fallzahlkombination ein Plateau. (B) Kleinst möglicher p-Wert in den Simulationen für jede Fallzahlkombinationen. [Zum Vergrößern anklicken]"><img src="stat-tests-utest_files/figure-html/fig-ggplot-utest-intro-sim-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-utest-intro-sim-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;35.4— Zusammenhang zwischen der Mittelwertsdifferenz und dem mittleren p-Wert aus einer Simulationsstudie abhängig von der Fallzahl in zwei Gruppen <span class="math inline">\(n_1\)</span> und <span class="math inline">\(n_2\)</span>. Die graue Linie zeigt das 5% Signifikanzniveau an. <strong>(A)</strong> Mit steigender Mittelwertsdifferenz fallen die mittleren p-Werte. Die p-Werte erreichen je nach Fallzahlkombination ein Plateau. <strong>(B)</strong> Kleinst möglicher p-Wert in den Simulationen für jede Fallzahlkombinationen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt verstehen wir auch warum <span class="citation" data-cites="sugimoto2023hyperactive">Sugimoto et al. (<a href="#ref-sugimoto2023hyperactive" role="doc-biblioref">2023</a>)</span> in der <a href="#fig-utest-intro" class="quarto-xref">Abbildung&nbsp;<span>35.2</span></a> auf einen Student t-Test für die Gruppengröße <span class="math inline">\(n_1 = 3\)</span> und <span class="math inline">\(n_2 = 3\)</span> umgeschwenkt ist. Trotz des riesigen Effekts in den Barplots und damit dem Mittelwertsunterschied, wäre ein Mann-Whitney Test nie signifikant geworden. Der p-Werte wäre dann hier auf 10% begrenzt, egal wie groß der eigentliche Effekt ist. Diese harte Grenze kennt der t-Test nicht, deshalb wurde hier dann der t-Test als Ausweg gewählt.</p>
</section>
<section id="der-hypothesen" class="level3" data-number="35.2.2">
<h3 data-number="35.2.2" class="anchored" data-anchor-id="der-hypothesen"><span class="header-section-number">35.2.2</span> …der Hypothesen</h3>
<p>Das Problem mit den <a href="https://statistikguru.de/spss/mann-whitney-u-test/mann-whitney-u-test-hypothesen.html">Mann-Whitney-U-Test und den Hypothesen</a> hat mich etwas überraschend getroffen. Ich dachte lange immer, dass der U-Test eben die Mediane miteinander vergleicht. Das macht ja auch irgendwie Sinn, denn die Mediane müssen ja auch einen Test haben und basieren ja auch auf Rängen. Oder wie es so schön sinnig in der Veröffentlichung <a href="https://www.tandfonline.com/doi/full/10.1080/00031305.2017.1305291#d1e1503">The Wilcoxon–Mann–Whitney Procedure Fails as a Test of Medians</a> von <span class="citation" data-cites="divine2018wilcoxon">Divine et al. (<a href="#ref-divine2018wilcoxon" role="doc-biblioref">2018</a>)</span> geschrieben steht.</p>
<blockquote class="blockquote">
<p><em>“A major impetus to reporting medians with Mann-Whitney-U-tests results is likely the major utility of reporting a summary statistic that reflects the same scale as the data being analyzed.” — <span class="citation" data-cites="divine2018wilcoxon">Divine et al. (<a href="#ref-divine2018wilcoxon" role="doc-biblioref">2018</a>)</span></em></p>
</blockquote>
<p>Gut, was testet den nun der U-Test? <a href="https://de.wikipedia.org/wiki/Wilcoxon-Mann-Whitney-Test#Annahmen">Kommt auf die Annahmen an die Daten und damit dem U-Test an</a>. Oder konkreter an die beiden Verteilungsformen, die du miteinander vergleichst. Der U-Test kann nämlich unterschiedliche Nullhypothesen haben, je nachdem welche Annahmen du an deine Daten hast. Und hier kommt der schlechte Witz. Meistens hast du so wenig Beobachtungen, dass du selber keine Visualisierung der Verteilung erstellen kannst.</p>
<section id="gleiche-verteilungsform-unterschiedliche-lage" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="gleiche-verteilungsform-unterschiedliche-lage">Gleiche Verteilungsform, unterschiedliche Lage</h4>
<p>Weil die beiden Verteilungsfunktionen bis auf Verschiebung gleich sind, muss insbesondere Varianzhomogenität zwischen den beiden Gruppen gelten. Wenn wir also gleiche Verteilungen haben, die auch damit varianzhomogen sind, können wir folgende Hypothesen aufstellen. Ich habe dir den Fall einmal in der folgenden Abbildung dargestellt. Die Annahmen sind sehr restriktiv. Nach <span class="citation" data-cites="conroy2012hypotheses">Conroy (<a href="#ref-conroy2012hypotheses" role="doc-biblioref">2012</a>)</span> mit <a href="https://journals.sagepub.com/doi/10.1177/1536867X1201200202">What Hypotheses do “Nonparametric” Two-Group Tests Actually Test?</a> sollte daher der U-Test nicht für den Vergleich von Medianen genutzt werden.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-utest-intro-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-utest-intro-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-utest_files/figure-html/fig-ggplot-utest-intro-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Abbildung&nbsp;35.5— Der U-Test kann unter der Annahme der gleichen Verteilungsform und damit angenommener Varianzhomogenität die Verschiebung a in den Medianen testen. Die Annahmen sind sehr restriktiv und treten nicht oft auf. [Zum Vergrößern anklicken]"><img src="stat-tests-utest_files/figure-html/fig-ggplot-utest-intro-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-utest-intro-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;35.5— Der U-Test kann unter der Annahme der gleichen Verteilungsform und damit angenommener Varianzhomogenität die Verschiebung a in den Medianen testen. Die Annahmen sind sehr restriktiv und treten nicht oft auf. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Damit ergeben sich dann die folgenden Hypothesenpaare für den Vergleich der Mediane.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Prosa</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Formel</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><span class="math inline">\(H_0:\)</span> <em>Die Gleichheit der Mediane der zwei Gruppen liegt vor. Die Verschiebung der Mediane ist Null.</em></p>
<p><span class="math inline">\(H_A:\)</span> <em>Die Mediane der zwei Gruppen unterscheiden sich. Die Verschiebung der Mediane ist ungleich Null.</em></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><span class="math display">\[
H_0: a = 0
\]</span></p>
<p><span class="math display">\[
H_A: a \neq 0
\]</span></p>
</div>
</div>
</div>
<p>Die Problematik ist recht umfangreich und der U-Test kann auch bei gleichen Medianen signifkante Ergebnisse liefern. <span class="citation" data-cites="hart2001mann">Hart (<a href="#ref-hart2001mann" role="doc-biblioref">2001</a>)</span> diskutiert in <a href="https://www.bmj.com/content/bmj/323/7309/391.full.pdf?casa_token=GFRQ5vdBejMAAAAA:uWLUlyNzp0rDKrXcco4fvr4L35PvzDO9Y-SPDKTIUGNgcMvgtmcctzE5tIz82XB5t8TydVC7okvjDA">Mann-Whitney test is not just a test of medians: differences in spread can be important</a> nochmal einige Sonderfälle. Also verbleibe ich dabei, der U-Test testet ursprünglich nicht die Unterschiede in den Median. Außer die Sterne stehen günstig, was aber keine Grundlage für sauberes wissenschaftliches Arbeiten ist.</p>
</section>
<section id="unterschiedliche-verteilungsform-unterschiedliche-lage" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="unterschiedliche-verteilungsform-unterschiedliche-lage">Unterschiedliche Verteilungsform, unterschiedliche Lage</h4>
<p>Nachdem wir uns nun davon verabschiedet haben, dass wir mit dem U-Test Mediane vergleichen, kommen wir nun zu den echten Hypothesen. Oder andersherum nur in sehr seltenen Fällen die Interpretation eines Vergleiches der Mediane erlaubt. Was ist also die Nullhypothese und die Alternativhypothese, die wir mit dem U-Test überprüfen wollen? Ich habe einmal ein schönes Zitat aus Guidelines von GraphPad mitgebracht sowie dann die Hypothesen auch einmal mathematisch aufgeschrieben.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Prosa</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Formel</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Der U-Test beantwortet folgende Frage an die Daten.</p>
<blockquote class="blockquote">
<p><em>“If the groups are sampled from populations with identical distributions, what is the chance that random sampling would result in a sum of ranks as far apart (or more so) as observed in this experiment?” — <a href="https://www.graphpad.com/guides/prism/5/user-guide/prism5help.html?stat_nonparametric_tests_dont_compa.htm">The Mann-Whitney test doesn’t really compare medians</a></em></p>
</blockquote>
<p>Damit haben wir dann in Prosa folgendes Hypothesenpaar vorliegen.</p>
<p><span class="math inline">\(H_0:\)</span> <em>Es ist gleich wahrscheinlich, dass ein zufällig aus der einen Population ausgewählter Wert größer oder kleiner ist als ein zufällig ausgewählter Wert aus der anderen Population</em></p>
<p><span class="math inline">\(H_A:\)</span> <em>Es ist</em> <strong><em>nicht</em></strong> <em>gleich wahrscheinlich, dass ein zufällig aus der einen Population ausgewählter Wert größer oder kleiner ist als ein zufällig ausgewählter Wert aus der anderen Population</em></p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>In der Formel wird es schon etwas wilder und ich muss sagen, dass mir die Formel das Verständnis nicht leichter macht. Wir vergleichen hier zwei Populationen <span class="math inline">\(X\)</span> und <span class="math inline">\(Y\)</span> miteinander.</p>
<p><span class="math display">\[
H_0:  Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y) = 0.5
\]</span></p>
<p><span class="math display">\[
H_A:  Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y) \neq 0.5
\]</span></p>
<p>In dem R Paket <code>{nparcomp}</code> bezeichnen wir den Wert für <span class="math inline">\(Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y)\)</span> auch als relativen Effekt.</p>
</div>
</div>
</div>
<p>Da mir die Nullhypothese mit <span class="math inline">\(Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y) = 0.5\)</span> nicht ganz einleuchtete habe ich einmal die Sachlage visualisiert und in R nachgerechnet. Ich verstehe den Zusammenhang sonst nicht. Die Nullhypothese besagt ja, dass <em>es gleich wahrscheinlich ist, dass ein zufällig aus der einen Population ausgewählter Wert größer oder kleiner ist als ein zufällig ausgewählter Wert aus der anderen Population</em>. Daher baue ich mit einfach mal zwei Vaktoren <code>X</code> und <code>Y</code> mit jeweils den gleichen Zahlen mit <span class="math inline">\(X = Y = {1, 2, 3, 4}\)</span>. Jetzt müsste ja auch der obigen Formel der Wert <span class="math inline">\(0.5\)</span> rauskommen, denn die Nullhypothese ist ja wahr. Die Werte sind ja gleich.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Visualisierung</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><code>{base}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Beispiel</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Was habe ich in der folgenden Abbildung einmal den Zusammenhang der Formel mit den Werten dargestellt. Wir haben insgesamt 16 Wertepaare für unsere 4 Zahlen pro Gruppe. Davon sind vier Wertepaar gleich, dargestellt in grün. Hier kriegen wir dann den Wert für <span class="math inline">\(\cfrac{1}{2} Pr(X = Y)\)</span> mit <span class="math inline">\(0.125\)</span> raus. Dann haben wir noch sechs Wertepaare wo X kleiner ist als Y. Daher haben wir hier die Werte für <span class="math inline">\(Pr(X&lt;Y)\)</span> mit <span class="math inline">\(0.375\)</span> raus. Jetzt müssen wir noch die beiden Werte addieren und sehen, dass wir auf die <span class="math inline">\(0.5\)</span> kommen. Das sieht doch gut aus. Was es jetzt uns sagt, ist nochmal eine andere Sache, aber immerhin haben wir mal verstanden, wie die Wahrscheinlichkeiten berechnet werden. Am Ende ist es dann doch nur ein Spiel der wilden Kombinatorik. Mehr zum Spielen im folgenden Tab.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-utest-intro-03" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-utest-intro-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-utest_files/figure-html/fig-ggplot-utest-intro-03-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Abbildung&nbsp;35.6— Beispielhafte Berechnung der Wahrscheinlichkeit für die Nullhypothese in einem U-Test mit vier Werten für X und Y sowie den entsprechenden sechszehn Wertepaaren. Die Nullhypothese gilt, die Werte von X und Y sind gleich. Bindungen werden ignoriert, es handelt sich ja nicht um Ränge per se. Die grünen Linien zeigen Wertepaare die gleich sind. Die roten Linien Wertepaare wo X kleiner als Y ist. [Zum Vergrößern anklicken]"><img src="stat-tests-utest_files/figure-html/fig-ggplot-utest-intro-03-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-utest-intro-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;35.6— Beispielhafte Berechnung der Wahrscheinlichkeit für die Nullhypothese in einem U-Test mit vier Werten für X und Y sowie den entsprechenden sechszehn Wertepaaren. Die Nullhypothese gilt, die Werte von X und Y sind gleich. Bindungen werden ignoriert, es handelt sich ja nicht um Ränge per se. Die grünen Linien zeigen Wertepaare die gleich sind. Die roten Linien Wertepaare wo X kleiner als Y ist. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Du findest in dem Tutorium <a href="https://www.statstutor.ac.uk/resources/uploaded/mannwhitney.pdf">The Mann-Whitney U Test</a> nochmal ein anschauliches Beispiel. Und auch in der Arbeit von <span class="citation" data-cites="conroy2012hypotheses">Conroy (<a href="#ref-conroy2012hypotheses" role="doc-biblioref">2012</a>)</span> wird versucht die Nullhypothese als Wertepaare über einen Kugelplot zu visualisieren.</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Wir können uns auch einmal die Sachlage in R nachbauen. Wir haben dann die zwei Vektoren <code>x</code> und <code>y</code> mit beliebigen Werten. Ich nehme hier mal wieder die Werte <code>1, 2, 3, 4</code> für beide Vektoren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die Funktion <code>crossing()</code> gibt uns jetzt jedes paarweise Wertepaar der Kombinartion von <code>x</code> und <code>y</code> wieder. Dann können wir berechnen welche Wertepaare gleich sind, als <code>x == y</code> sowie die Wertepaare, wo <code>x</code> kleiner ist als <code>y</code>. Dann schauen wir uns einmal die Ausgabe an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pair_tbl <span class="ot">&lt;-</span> <span class="fu">crossing</span>(x, y) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_x_equal_y =</span> (x <span class="sc">==</span> y),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_x_less_y =</span> (x <span class="sc">&lt;</span> y)) </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>pair_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 4
       x     y p_x_equal_y p_x_less_y
   &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;       &lt;lgl&gt;     
 1     1     1 TRUE        FALSE     
 2     1     2 FALSE       TRUE      
 3     1     3 FALSE       TRUE      
 4     1     4 FALSE       TRUE      
 5     2     1 FALSE       FALSE     
 6     2     2 TRUE        FALSE     
 7     2     3 FALSE       TRUE      
 8     2     4 FALSE       TRUE      
 9     3     1 FALSE       FALSE     
10     3     2 FALSE       FALSE     
11     3     3 TRUE        FALSE     
12     3     4 FALSE       TRUE      
13     4     1 FALSE       FALSE     
14     4     2 FALSE       FALSE     
15     4     3 FALSE       FALSE     
16     4     4 TRUE        FALSE     </code></pre>
</div>
</div>
<p>Jetzt können wir noch die Mittelwerte berechnen, was bei Wahrscheinlichkeiten nichts anders ist als die Wahrscheinlichkeit für <code>TRUE</code> zu erhalten. Wir sehen, dass wir auf die gleichen Wert kommen. Jetzt kannst du auch mit anderen Kombinationen der Vektoren spielen und sehen, wie sich die Werte und deren Summe ändern.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pair_tbl <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(p_x_less_y),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mean</span>(p_x_equal_y)<span class="sc">/</span><span class="dv">2</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  `mean(p_x_less_y)` `mean(p_x_equal_y)/2`
               &lt;dbl&gt;                 &lt;dbl&gt;
1              0.375                 0.125</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>Dann können wir mal den Wert für <span class="math inline">\(Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y)\)</span> einmal für unser Datenbeispiel zu den Sprungweiten berechnen. Du findest die Daten nochmal weiter unten zum selber laden. Wir nutzen dazu den R Code aus dem vorherigen Tab. Zuerst müssen wir einmal die Sprungweiten über die beiden Floharten rangieren. Dann wieder die beiden Floharten separieren damit wir dann mit den Spalten der Ränge weiterrechnen können.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fac1_ranks_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ranked_jump_length =</span> <span class="fu">rank</span>(jump_length)) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, ranked_jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> animal,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> ranked_jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>fac1_ranks_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
    dog   cat
  &lt;dbl&gt; &lt;dbl&gt;
1     7     2
2    12     1
3    14     5
4     6     3
5    13     4
6    11    10
7     9     8</code></pre>
</div>
</div>
<p>Jetzt setzen wir die Ränge der beiden Spalten einmal in die Funktion <code>crossing()</code> und rechnen einmal die Werte für <span class="math inline">\(Pr(X &lt; Y)\)</span> und <span class="math inline">\(\cfrac{1}{2} Pr(X = Y)\)</span> aus. Wie wir sehen, ist eine der Wahrscheinlichkeiten null. Die Summierung der beiden Werte spare ich mir, dass geht ja auch so recht flott im Kopf.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">dog =</span> fac1_ranks_tbl<span class="sc">$</span>dog, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">cat =</span> fac1_ranks_tbl<span class="sc">$</span>cat) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_x_equal_y =</span> (dog <span class="sc">==</span> cat),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_x_less_y =</span> (dog <span class="sc">&lt;</span> cat)) <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(p_x_less_y),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mean</span>(p_x_equal_y)<span class="sc">/</span><span class="dv">2</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  `mean(p_x_less_y)` `mean(p_x_equal_y)/2`
               &lt;dbl&gt;                 &lt;dbl&gt;
1              0.102                     0</code></pre>
</div>
</div>
<p>Was wissen wir also? Wenn wir alle 49 Wertepaare jeder Sprungweite eines Katzenflohs mit jeder Sprungweite eines Hundeflohs vergleichen, dann springen in 10.2% der Wertepaare die Hundeflöhe kürzer (oder gleich) weit wie die Katzenflöhe. Oder andersherum springen in fast 90% der Wertepaare die Hundeflöhe weiter als die Katzenflöhe.</p>
</div>
</div>
</div>
</section>
</section>
<section id="des-effekts" class="level3" data-number="35.2.3">
<h3 data-number="35.2.3" class="anchored" data-anchor-id="des-effekts"><span class="header-section-number">35.2.3</span> …des Effekts</h3>
<p>Was ist der Effekt eines nichtparametrischen Tests? Oder andersherum, wenn wir eine Rangtransformation durchführen, dann verwandeln wir ja alle Zahlen mit einer Einheit in einen einheitslosen Rang. Damit rechnen wir also auf den Rängen des Messwertes. Wenn wir aber nun einheitslose Ränge haben, dann haben wir auch nur einheitslose Rangdifferenzen. Dazu kommt je mehr Beobachtungen desto mehr Ränge desto größer die Rangdifferenzen. Wir haben zwar dann die Möglichkeit wieder eine Art Cohen`s d oder eben r zu berechnen, aber hat dieser Wert wieder keien Einheit und ist auch schwer zu interpretieren. Es gibt wieder viele Arten dies zu tun und je nach Quelle haben wir dann ein anderes Adjektiv wie “kleiner”, “mittler” oder “starker” Effekt. Solche Worte können wir dann aber nicht mit Kosten/Nutzenrechnungen verbinden. Am Ende hat eben dann der nichtparametrische U-Test kein Effektmaß mit dem sich praktisch und relevant arbeiten lässt.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/personal_opinion.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="images/personal_opinion.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>“Es gibt Gründe die Nichtparametrik als den Ausweg für die Nichtnormalverteilung zu sehen. In gewissen Anwendungsfeldern mag das auch so stimmen. Wenn du wirklich nicht an einem Effektmaß interessiert bist und nur einen p-Wert brauchst, dann ist die Nichtparametrik eine Lösung. Heutzutage wollen wir aber auch immer wissen, ist der Effekt relevant? Und die Frage ohne ein Effektmaß zu beantworten sehe ich als unmöglich an.” — Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.</em></p>
</blockquote>
</div>
</div>
</div>
</section>
</section>
<section id="die-lösung" class="level2" data-number="35.3">
<h2 data-number="35.3" class="anchored" data-anchor-id="die-lösung"><span class="header-section-number">35.3</span> Die Lösung</h2>
<p><a href="https://lindeloev.github.io/tests-as-linear/simulations/simulate_wilcoxon.html">Wilcoxon is (almost) a one-sample t-test on signed ranks</a></p>
<p><a href="https://lindeloev.github.io/tests-as-linear/#1_the_simplicity_underlying_common_tests">Nichtparametrik als Rangtransformation</a></p>
<p><span class="citation" data-cites="zimmerman1993relative">Zimmerman &amp; Zumbo (<a href="#ref-zimmerman1993relative" role="doc-biblioref">1993</a>)</span> <a href="https://www.proquest.com/docview/1299992501?pq-origsite=gscholar&amp;fromopenview=true&amp;sourcetype=Scholarly%20Journals&amp;imgSeq=1">Relative Power of the Wilcoxon Test, the Friedman Test, and Repeated-Measures ANOVA on Ranks</a></p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>p_t_u_tbl <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>), \(n_val){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, \(...){</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    sim_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(n_val, <span class="dv">5</span>, <span class="dv">2</span>), <span class="fu">rnorm</span>(n_val, <span class="dv">5</span>, <span class="dv">2</span>)),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">x =</span> <span class="fu">gl</span>(<span class="dv">2</span>, n_val, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>)))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    wilcox_p <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(y <span class="sc">~</span> x, <span class="at">data =</span> sim_tbl)<span class="sc">$</span>p.value</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    ttest_p <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y <span class="sc">~</span> x, <span class="at">data =</span> sim_tbl)<span class="sc">$</span>p.value</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">n =</span> <span class="fu">as_factor</span>(n_val),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">wilcox =</span> wilcox_p,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">ttest =</span> ttest_p,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">dev =</span> ttest <span class="sc">-</span> wilcox)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.progress =</span> <span class="cn">TRUE</span>) </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(p_t_u_tbl, <span class="fu">aes</span>(<span class="at">x =</span> wilcox, <span class="at">y =</span> ttest, <span class="at">color =</span> n)) <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.20</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(p_t_u_tbl, <span class="fu">aes</span>(<span class="at">x =</span> wilcox, <span class="at">y =</span> dev, <span class="at">color =</span> n)) <span class="sc">+</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point() +</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="genutzte-r-pakete" class="level2" data-number="35.4">
<h2 data-number="35.4" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">35.4</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, broom, tidyplots, rstatix,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>               readxl, coin, ggpubr, nparcomp,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>               conflicted)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(rstatix<span class="sc">::</span>wilcox_test)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="35.5">
<h2 data-number="35.5" class="anchored" data-anchor-id="daten"><span class="header-section-number">35.5</span> Daten</h2>
<p>In den folgendne Abschnitten brauchen wir dann zwei Datensätze. Der erste Datensatz beschreibt Hunde- und Katzenflöhe, die springen und deren Sprungweite dann gemessen wurde. Wir haben hier verschiedene Flöhe vorliegen, die nur einmal springen. Wir können aber auch den Fall haben, dass wir uns wiederholt einen Floh anschauen. Der zweite Datensatz betrachtet Hundeflöhe, die vor der Fütterung und nach der Fütterung gesprungen sind.</p>
<section id="unabhängige-messungen" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="unabhängige-messungen">Unabhängige Messungen</h4>
<p>Beginnen wir also mit unserem einfaktoriellen Datensatz mit zwei Gruppen. Wir haben hier die Sprungweite in [cm] von Hunde- und Katzenflöhen gemessen. Unser Faktor ist hierbei die Flohart. Entweder ein Hundefloh oder eben ein Katzenfloh. Wir wollen jetzt wissen, ob sich die beiden Floharten hinsichtlich ihrer Sprungweite unterscheiden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/flea_dog_cat.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Tabelle siehst du dann einmal einen Auszug aus den Daten der Sprungweiten für die beiden Floharten. Dabei ist dann die Spalte <code>animal</code> unser Faktor über den wir den Gruppenvergleich für die Sprungweiten als Messwert rechnen wollen.</p>
<div class="cell">
<div id="tbl-1fac-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-1fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;35.1— Tabelle der Sprungweiten in [cm] als Messwert <span class="math inline">\(y\)</span> von Hunde-, Katzen- und Fuchsflöhen. Der Datensatz ist einfaktoriell, da wir nur einen Faktor vorliegen haben.
</figcaption>
<div aria-describedby="tbl-1fac-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_jzn1xvmm7te5j9oxbw6o</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_jzn1xvmm7te5j9oxbw6o" style="table-layout: fixed; width: 67% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">animal</th>
                <th scope="col">jump_length</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>dog</td>
                  <td>5.7 </td>
                </tr>
                <tr>
                  <td>dog</td>
                  <td>8.9 </td>
                </tr>
                <tr>
                  <td>dog</td>
                  <td>11.8</td>
                </tr>
                <tr>
                  <td>...</td>
                  <td>... </td>
                </tr>
                <tr>
                  <td>cat</td>
                  <td>4.3 </td>
                </tr>
                <tr>
                  <td>cat</td>
                  <td>7.9 </td>
                </tr>
                <tr>
                  <td>cat</td>
                  <td>6.1 </td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_waw0p1h5e3s5atzska6d(i, j, css_id) {
        var table = document.getElementById("tinytable_jzn1xvmm7te5j9oxbw6o");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_jzn1xvmm7te5j9oxbw6o');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_waw0p1h5e3s5atzska6d(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_jzn1xvmm7te5j9oxbw6o");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Dann wollen wir uns auch einmal die Daten visualisieren. Ich nutze dazu dann einmal den Boixplot sowie den Violinplot. Die Daten sehen einigermaßen normalverteilt aus, so dass wir hier auch einen t-Test rechnen könnten. Wie immer geht es hier auch um die Demonstration der Algorithmen, also nutzen wir hier auch diese Daten für den U-Test. Der U-Test funktioniert auch super auf noormalverteilten Daten.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-utest-jump" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-utest-jump-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-utest_files/figure-html/fig-ggplot-utest-jump-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Abbildung&nbsp;35.7— Darstellung der Sprungweiten in [cm] gruppiert nach Hunde- und Katzenflöhen. Die graue Raute stellt den entsprechnenden Mittelwert der Sprungweiten dar. (A) Einfaktorieller Boxplot. (B) Violinplot mit Dotplot. [Zum Vergrößern anklicken]"><img src="stat-tests-utest_files/figure-html/fig-ggplot-utest-jump-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-utest-jump-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;35.7— Darstellung der Sprungweiten in [cm] gruppiert nach Hunde- und Katzenflöhen. Die graue Raute stellt den entsprechnenden Mittelwert der Sprungweiten dar. <strong>(A)</strong> Einfaktorieller Boxplot. <strong>(B)</strong> Violinplot mit Dotplot. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="abhängige-messungen" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="abhängige-messungen">Abhängige Messungen</h4>
<p>Der U-Test erlaubt auch abhängige Daten zu analysieren. Das heißt wir haben die gleichen sieben Hundeflöhe wiederholt gemessen. Einmal haben wir einen Hundefloh gemessen bevor er was gegessen hat, also hungrig ist, und einmal nachdem der gleiche Floh sich satt gegessen hat. Daher haben wir hier abhängige oder verbundene Bebachtungen. Im folgenden einmal der Datensatz eingelesen im Wide-Format.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>paired_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/flea_dog_cat_repeated.xlsx"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wie du sehen kannst haben wir die sieben Flöhe wiederholt gemessen. Die Daten sind nicht im <code>tidy</code>-Format, da nicht jede Zeile nur eine Messunfg für eine Beobachtung beinhaltet. Das ändern wir dann einmal gleich in Long-Format.</p>
<div class="cell">
<div id="tbl-data-ttest-paired-01" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-data-ttest-paired-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;35.2— Tabelle der Sprunglängen [cm] von fünf Hundeflöhen zu zwei Zeitpunkten. Einmal wurde die Sprungweite mit den hungrigen Flöhen und einmal mit den gleichen satten Flöhen bestimmt.
</figcaption>
<div aria-describedby="tbl-data-ttest-paired-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_qnyje6o4ubxo3g9m4tw2</title>
    <style>
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-striped" id="tinytable_qnyje6o4ubxo3g9m4tw2" style="table-layout: fixed; width: 67% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">id</th>
                <th scope="col">hungrig</th>
                <th scope="col">satt</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>5.2</td>
                  <td>6.1</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>4.1</td>
                  <td>5.2</td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>3.5</td>
                  <td>3.9</td>
                </tr>
                <tr>
                  <td>4</td>
                  <td>3.2</td>
                  <td>4.1</td>
                </tr>
                <tr>
                  <td>5</td>
                  <td>4.6</td>
                  <td>5.3</td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_dma3xvfm6h6734ik8hnq(i, j, css_id) {
        var table = document.getElementById("tinytable_qnyje6o4ubxo3g9m4tw2");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_qnyje6o4ubxo3g9m4tw2');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_dma3xvfm6h6734ik8hnq(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_qnyje6o4ubxo3g9m4tw2");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

    </script>

  


</div>
</div>
</figure>
</div>
</div>
<p>Dann hier nochmal die Long-Formatvariante mit der Funktion <code>pivot_longer()</code>. Wir brauchen das Long-Format für die Auswertung in den unteren Abschnitten für das R Paket <code>{rstatix}</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>paired_long_tbl <span class="ot">&lt;-</span> paired_tbl <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> hungrig<span class="sc">:</span>satt,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"trt"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Manchmal ist es schwer zu verstehen, was jetzt wiederholt oder gepaart heißen soll. Deshalb hier nochmal die Visualiserung der Daten für die beiden Sprünge vor und nach der Fütterung. Ich habe die Messungen, die zusammengehören mit einer Linie verbunden. Dazu dann auch noch die jeweiligen IDs der Flöhe ergänzt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-example-paired" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-example-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-utest_files/figure-html/fig-example-paired-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Abbildung&nbsp;35.8— Dotplot der Sprungweiten [cm] für Hundeflöhe in zwei verschiedenen Ernährungszuständen gemessen an zwei Zeitpunkten. Die Linien verbinden die Messung an dem gleichen Floh."><img src="stat-tests-utest_files/figure-html/fig-example-paired-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-example-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;35.8— Dotplot der Sprungweiten [cm] für Hundeflöhe in zwei verschiedenen Ernährungszuständen gemessen an zwei Zeitpunkten. Die Linien verbinden die Messung an dem gleichen Floh.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="hypothesen" class="level2" data-number="35.6">
<h2 data-number="35.6" class="anchored" data-anchor-id="hypothesen"><span class="header-section-number">35.6</span> Hypothesen</h2>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Achtung, bitte beachten!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Wahl der Nullhypothese durch die Annahmen an die Verteilungsfromen der beiden zu vergleichenden Gruppen hat natürlich einen gewaltigen Einfluss auf die Interpretation des p-Wertes. Also wenn man es statistisch genau nimmt. Deshalb hier auch einmal die simpelste Prosavariante für Einsteiger.</p>
</div>
</div>
<p>Bitte lesen nochmal oben den Abschnitt zu dem Problem der Nullhypothese im U-Test nach. Je nachdem wie tief du jetzt hier einsteigen willst, habe ich dir mal die drei Varianten angebenen. Am Ende findest du die simpelste Prosavariante gar nicht so selten in Tutorien. Die fortgeschrittene Variante trifft es schon sehr gut. Die mathematische Formel mag dann mehr Fragen als Antworten liefern. Die praktische Interpretation der Nullhypothese eines U-Test bleibt mir aktuell noch verschlossen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Simpelste Prosa</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Fortgeschrittene Prosa</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Formel</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Wenn wir nur den p-Wert betrachten, dann können wir auch folgende simple Aussage über den U-Test machen. Das ist jetzt genau so wahr wie falsch aber hilfreich.</p>
<p><span class="math inline">\(H_0:\)</span> <em>Die beiden Gruppen sind gleich in ihrem Messwert.</em></p>
<p><span class="math inline">\(H_A:\)</span> <em>Es liegt ein Unterschied im Messwert zwischen den Gruppen vor.</em></p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Hier dann die richtige Interpretation der Nullhypothese. Obwohl ich mir sicher bin, dass die praktische Relevanz der Nullhypothese hier auch nicht sehr viel klarer wird.</p>
<p><span class="math inline">\(H_0:\)</span> <em>Es ist gleich wahrscheinlich, dass ein zufällig aus der einen Population ausgewählter Wert größer oder kleiner ist als ein zufällig ausgewählter Wert aus der anderen Population</em></p>
<p><span class="math inline">\(H_A:\)</span> <em>Es ist</em> <strong><em>nicht</em></strong> <em>gleich wahrscheinlich, dass ein zufällig aus der einen Population ausgewählter Wert größer oder kleiner ist als ein zufällig ausgewählter Wert aus der anderen Population</em></p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Wir vergleichen hier zwei Populationen oder Gruppen <span class="math inline">\(X\)</span> und <span class="math inline">\(Y\)</span> miteinander. Die Formel repräsentiert die fortgeschrittene Prosa in dem vorherigen Tab. Bitte nochmal oben nachschauen, wenn du die Nullhypothese verstehen willst.</p>
<p><span class="math display">\[
H_0:  Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y) = 0.5
\]</span></p>
<p><span class="math display">\[
H_A:  Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y) \neq 0.5
\]</span></p>
<p>In dem R Paket <code>{nparcomp}</code> bezeichnen wir den Wert für <span class="math inline">\(Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y)\)</span> auch als relativen Effekt. Faktisch ist es der Anteil an allen Wertepaaren, die kleiner oder gleich in der einen Gruppe <span class="math inline">\(X\)</span> sind als in der anderen Gruppe <span class="math inline">\(Y\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="der-u-test" class="level2" data-number="35.7">
<h2 data-number="35.7" class="anchored" data-anchor-id="der-u-test"><span class="header-section-number">35.7</span> Der U-Test</h2>
<p>Dann kommen wir zu der Implementierung des U-Tests in R. Wie immer gibt es reiche Auswahl an R Paketen, die für dich den U-Test auf unabhängigen wie auch abhängigen Daten rechnen. Wenn ich die Wahl habe, dann nehme ich die Funktionen aus dem R Paket <code>{rstatix}</code>. Das Paket hat eigentlich alles was man braucht um einen U-Test zu rechnen. Intern basiert das Paket auf dem Paket <code>{coin}</code> was von der Anwendung etwas veraltet ist. Ein neueres Paket ist die Implementierung in dem R Paket <code>{nparcomp}</code>. Hier wirst du mit viel Informationen versorgt aber dann inhaltlich etwas alleine gelassen, was die Interpretation angeht. Wir schauen aber auch hier einmal rein.</p>
<section id="mit-unabhängigen-beobachtungen" class="level3" data-number="35.7.1">
<h3 data-number="35.7.1" class="anchored" data-anchor-id="mit-unabhängigen-beobachtungen"><span class="header-section-number">35.7.1</span> … mit unabhängigen Beobachtungen</h3>
<p>Am häufigsten wirst du wohl den U-Test mit zwei Gruppen rechnen, die voneinander unabhängig sind. Das heißt, du misst deinen Messwert <span class="math inline">\(y\)</span> in zwei Gruppen und jede Messung ist unabhängig von der anderen. Wir haben so einen Fall in unserem Datensatz zu den Sprungweiten der Hunde- und Katzenflöhe vorleigen. Wir haben sieben Hundeflöhe und sieben Katzenflöhe einmal gemessen und die Sprungweiten in dem Datensatz <code>fac1_tbl</code> gespeichert. Wir schauen uns für die unabhängigen Beobachtungen auch einmal die theoretische Berechung an, bevor wir uns dann in den anderen Tabs mit der Implementierung in R beschäftigen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Theorie</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false"><code>{stats}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false"><code>{coin}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false"><code>{rstatix}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false"><code>{nparcomp}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Der Wilcoxon-Mann-Whitney-Test berechnet die U Teststatistik auf den Rängend der Daten. Es gibt genau soviele Ränge wie es Beobachtungen im Datensatz gibt. Wir haben vierzehn Beobachtungen in unseren Daten zu der Sprungweite in [cm] von den Hunde- und Katzenflöhen. Somit müssen wir auch vierzehn Ränge vergeben. Die <a href="#tbl-utest-rank" class="quarto-xref">Tabelle&nbsp;<span>35.3</span></a> zeigt das Vorgehen der Rangvergabe. Wir sortieren als erstes das <span class="math inline">\(y\)</span> aufsteigend. In unserem Fall ist das <span class="math inline">\(y\)</span> die Sprunglänge. Dann vergeben wir die Ränge jweiles zugehörig zu der Position der Sprunglänge und der Tierart. Abschließend addieren wir die Rangsummmen für <code>cat</code> und <code>dog</code> zu den Rangsummen <span class="math inline">\(R_{cat}\)</span> und <span class="math inline">\(R_{dog}\)</span>.</p>
<div id="tbl-utest-rank" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-utest-rank-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;35.3— Datentablle absteigend sortiert nach der Sprunglänge in [cm]. Die Level <code>cat</code> und <code>dog</code> haben jeweils die entsprechenden Ränge zugeordnet bekommen und die Rangsummen wurden berechnet
</figcaption>
<div aria-describedby="tbl-utest-rank-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Rank</th>
<th style="text-align: center;">animal</th>
<th style="text-align: center;">jump_length</th>
<th style="text-align: center;">Ränge <code>cat</code></th>
<th style="text-align: center;">Ränge <code>dog</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">cat</td>
<td style="text-align: center;">2.2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">cat</td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">cat</td>
<td style="text-align: center;">4.1</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">cat</td>
<td style="text-align: center;">4.3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">cat</td>
<td style="text-align: center;">5.4</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.6</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.7</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">7</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">cat</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">dog</td>
<td style="text-align: center;">7.6</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">9</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;">cat</td>
<td style="text-align: center;">7.9</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">11</td>
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.2</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">11</td>
</tr>
<tr class="even">
<td style="text-align: center;">12</td>
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">12</td>
</tr>
<tr class="odd">
<td style="text-align: center;">13</td>
<td style="text-align: center;">dog</td>
<td style="text-align: center;">9.1</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">13</td>
</tr>
<tr class="even">
<td style="text-align: center;">14</td>
<td style="text-align: center;">dog</td>
<td style="text-align: center;">11.8</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">14</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Rangsummen</td>
<td style="text-align: center;"><span class="math inline">\(R_{cat} = 33\)</span></td>
<td style="text-align: center;"><span class="math inline">\(R_{dog} = 72\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Gruppengröße</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">7</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Die Formel für die U Statistik sieht ein wenig wild aus, aber wir können eigentlich relativ einfach alle Zahlen einsetzen. Dann musst du dich etwas konzentrieren bei der Rechnung.</p>
<p><span class="math display">\[
U_{D} = n_1n_2 + \cfrac{n_1(n_1+1)}{2}-R_1
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(R_1\)</span> der <em>größeren</em> der beiden Rangsummen,</li>
<li><span class="math inline">\(n_1\)</span> die Fallzahl der <em>größeren</em> der beiden Rangsummen</li>
<li><span class="math inline">\(n_2\)</span> die Fallzahl der <em>kleineren</em> der beiden Rangsummen</li>
</ul>
<p>Wir setzen nun die Zahlen ein. Da wir ein balanciertes Design vorliegen haben sind die Fallzahlen <span class="math inline">\(n_1 = n_2 = 7\)</span> gleich. Wir müssen nur schauen, dass wir mit <span class="math inline">\(R_1\)</span> die passende Rangsumme wählen. In unserem Fall ist <span class="math inline">\(R_1 = R_{dog} = 72\)</span>.</p>
<p><span class="math display">\[
U_{D} = 7 \cdot 7 + \cfrac{7(7+1)}{2}-72 = 5
\]</span></p>
<p>Der kritische Wert für die U Statistik ist <span class="math inline">\(U_{\alpha = 5\%} = 8\)</span> für <span class="math inline">\(n_1 = 7\)</span> und <span class="math inline">\(n_2 = 7\)</span>. Bei der Entscheidung mit der berechneten Teststatistik <span class="math inline">\(U_{D}\)</span> gilt, wenn <span class="math inline">\(U_{D} \leq U_{\alpha = 5\%}\)</span> wird die Nullhypothese (H<span class="math inline">\(_0\)</span>) abgelehnt. Da in unserem Fall das <span class="math inline">\(U_{D}\)</span> mit <span class="math inline">\(5\)</span> kleiner ist als das <span class="math inline">\(U_{\alpha = 5\%} = 8\)</span> können wir die Nullhypothese ablehnen. Wir haben ein signifkianten Unterschied in den Medianen zwischen den beiden Tierarten im Bezug auf die Sprungweite in [cm] von Flöhen.</p>
<p>Bei grosser Stichprobe, wenn <span class="math inline">\(n_1 + n_2 &gt; 30\)</span> ist, können wir die U Statistik auch standariseren und damit in den z-Wert transformieren.</p>
<p><span class="math display">\[
z_{D} = \cfrac{U_{D} - \bar{U}}{s_U} = \cfrac{U_{D} - \cfrac{n_1 \cdot n_2}{2}}{\sqrt{\cfrac{n_1 \cdot n_2 (n_1 + n_2 +1)}{12}}}
\]</span></p>
<p>mit</p>
<ul>
<li><span class="math inline">\(\bar{U}\)</span> dem Mittelwert der U-Verteilung ohne Unterschied zwischen den Gruppen</li>
<li><span class="math inline">\(s_U\)</span> Standardfehler des U-Wertes</li>
<li><span class="math inline">\(n_1\)</span> Stichprobengrösse der Gruppe mit der grösseren Rangsumme</li>
<li><span class="math inline">\(n_2\)</span> Stichprobengrösse der Gruppe mit der kleineren Rangsumme</li>
</ul>
<p>Wir setzen dafür ebenfalls die berechnete U Statistik ein und müssen dann wieder konzentriert rechnen.</p>
<p><span class="math display">\[
z_{D} = \cfrac{5 - \cfrac{7 \cdot 7}{2}}{\sqrt{\cfrac{7 \cdot 7 (7 + 7 +1)}{12}}} = \cfrac{-19.5}{7.83} = |-2.46|
\]</span></p>
<p>Der kritische Wert für die z-Statistik ist <span class="math inline">\(z_{\alpha = 5\%} = 1.96\)</span>. Bei der Entscheidung mit der berechneten Teststatistik <span class="math inline">\(z_{D}\)</span> gilt, wenn <span class="math inline">\(z_{D} \geq z_{\alpha = 5\%}\)</span> wird die Nullhypothese (H<span class="math inline">\(_0\)</span>) abgelehnt. Wir haben eine berechnete z Statistik von <span class="math inline">\(z_{D} = 2.46\)</span>. Damit ist <span class="math inline">\(z_{D}\)</span> größer als <span class="math inline">\(z_{\alpha = 5\%} = 1.96\)</span> und wir können die Nullhypothese ablehnen. Wir haben einen signifkanten Unterschied zwischen den Medianen der beiden Floharten im Bezug auf die Sprunglänge in [cm].</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Die Standardimplementierung in R ist die Funktion <code>wilxoc.test()</code>. Leider kann der <code>wilxoc.test()</code> nicht mit Bindungen in den Daten umgehen. Daher würde ich die Funktion nicht empfehlen, da du im Zweifel dann nochmal die Funktion aus <code>{coin}</code> anwenden musst. Dann hast du doppelte Arbeit. Wir haben hier aber keien Bindungen in den Daten vorliegen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  jump_length by animal
W = 44, p-value = 0.01107
alternative hypothesis: true location shift is not equal to 0
95 percent confidence interval:
 1.0 5.9
sample estimates:
difference in location 
                   3.5 </code></pre>
</div>
</div>
<p>Der U-Test liefert uns ein signifikantes Ergebnis, da der p-Wert kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%. Wir lehnen die Nullhypothese ab. Die Sprungweiten unterscheiden sich zwischen den Hunde- und Katzenflöhen.</p>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>Ich muss jetzt gleich die Funktion <code>wilcox_test()</code> aus dem R Paket <code>{coin}</code> einmal explizit laden, da die Funktion in <code>{rstatix}</code> genauso heißt. Später musst du das natürlich nicht so machen. Wir können uns in der Funktion <code>wilcox_test()</code> auch die 95% Konfidenzintervalle wiedergeben lassen. Wir erhalten hier ein 95% Konfidenzintervall für die möglichen Verschiebung <span class="math inline">\(a\)</span> in den Messwerten. Aber Achtung, dann interpretieren wir den U-Test als Mediantest, was spezielle Anforderungen an die Verteilungen der beiden Gruppen hat. Mehr dazu in dem obigen Abschnitt zu den Problemen der Hypothesen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>coin<span class="sc">::</span><span class="fu">wilcox_test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">conf.int =</span> <span class="cn">TRUE</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic Wilcoxon-Mann-Whitney Test

data:  jump_length by animal (dog, cat)
Z = 2.4916, p-value = 0.01272
alternative hypothesis: true mu is not equal to 0
95 percent confidence interval:
 1.2 5.7
sample estimates:
difference in location 
                   3.5 </code></pre>
</div>
</div>
<p>Der U-Test liefert uns ein signifikantes Ergebnis, da der p-Wert kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%. Wir lehnen die Nullhypothese ab. Die Sprungweiten unterscheiden sich zwischen den Hunde- und Katzenflöhen.</p>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<p>Wir können den <a href="https://www.datanovia.com/en/lessons/wilcoxon-test-in-r/">Wilcoxon Test in R</a> auch mit der Funktion <code>wilcox_test()</code> aus dem R Paket <code>{rstatix}</code> rechnen. Wir verlieren hier aber die Möglichkeit das 95% Konfidenzintervall berechnen zu können. Ansonsten ist die Funktion nichts anderes als der Aufruf der gleichnamigen Funktion in <code>{coin}</code>. Wir erhalten als Wiedergabe eine praktische Datentabelle und ich habe mal etwas vorgefiltert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>rstatix<span class="sc">::</span><span class="fu">wilcox_test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, p)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  group1 group2      p
  &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;
1 dog    cat    0.0111</code></pre>
</div>
</div>
<p>Der U-Test liefert uns ein signifikantes Ergebnis, da der p-Wert kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%. Wir lehnen die Nullhypothese ab. Die Sprungweiten unterscheiden sich zwischen den Hunde- und Katzenflöhen.</p>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<p>Als letztes möchte ich noch die neuste Implementierung der Nichtparametrik mit dem R Paket <code>{nparcomp}</code> vorstellen. Wir haben hier die Implementierung des U-Tests in der Funktion <code>npar.t.test()</code>. Interessanterweise steht hier schon der t-Test mit im Namen. Es handelt sich hier um die Implementierung des nichtparametrischen t-Tests. Oder sehr vereinfacht ausgedrückt, die Anwendung des t-Tests auf rangtransformierte Messwerte. Leider hat die Funktion die unangenehme Eigenschaften alles möglich wiederzugeben, auch wenn man nur den p-Wert braucht. Daher hier dann mehr Code, damit die Funktion ruhig ist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>npar_obj <span class="ot">&lt;-</span> <span class="fu">npar.t.test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">info =</span> <span class="cn">TRUE</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 #------Nonparametric Test Procedures and Confidence Intervals for relative  effects-----# 
 
 - Alternative Hypothesis:  True relative effect p is less or equal than 1/2 
 - Confidence level: 95 % 
 - Method = Logit - Transformation 
 
 #---------------------------Interpretation----------------------------------# 
 p(a,b) &gt; 1/2 : b tends to be larger than a 
 #---------------------------------------------------------------------------# 
 </code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>npar_obj<span class="sc">$</span>Analysis</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Effect Estimator Lower Upper      T p.Value
1 p(dog,cat)     0.102 0.018 0.412 -2.345   0.019</code></pre>
</div>
</div>
<p>Der U-Test liefert uns ein signifikantes Ergebnis, da der p-Wert kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%. Wir lehnen die Nullhypothese ab. Die Sprungweiten unterscheiden sich zwischen den Hunde- und Katzenflöhen.</p>
<p>Darüber hinaus erhalten wir auch als Effektschätzer die Wahrscheinlichkeit <span class="math inline">\(Pr(dog, cat)\)</span> als <code>p(dog, cat)</code> wiedergeben. Wenn wir eine Wahrscheinlichkeit von <span class="math inline">\(0.5\)</span> vorliegen haben, dann gilt die Nullhypothese. Hier haben wir einen Wert von <span class="math inline">\(0.102\)</span> und damit springen die Hundeflöhe <code>a</code> weiter als die Katzenflöhe <code>b</code>. Die Sprungweiten sind bei den Hunden größer als bei den Katzen, da <code>p(dog, cat)</code> kleiner ist als <code>1/2</code>. Was wir auch sagen können ist, dass nur in 10.2% der Wertepaare aller Sprungweiten der Hunde- und Katzenflöhe, die Hunde kürzer springen. Mit Wertepaaren meine ich, dass wir jeden Wert der Sprungweite der Hundeflöhe mit jedem Wert der Katzenflöhe vergleichen. Wir wissen aber nicht um wie viel kürzer in einer wie auch immer gearteten Einheit. Ohne handfeste biologisch definierte Relevanz auf der Sprungweite hat dann das 95% Konfidenzintervall auch keine direkte Bedeutung.</p>
</div>
</div>
</div>
<p>Wie du sehen kannst kommt bei allen Implementierungen des U-Tests im Prinzip das gleiche raus. Der U-Test liefert uns ein signifikantes Ergebnis, da der p-Wert kleiner ist als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%. Wir haben nur leichte Fluktuationen im p-Wert durch die Art des Algorithmus hinter dem U-Test des jeweiligen Pakets. Am Ende unterscheiden sich die Sprungweiten zwischen den Hunde- und Katzenflöhen. Jetzt bleibt noch die Frage, wie groß der Effekt ist.</p>
<section id="effektschätzer" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="effektschätzer">Effektschätzer</h4>
<p>Als Effektschätzer nutzen wir den rangbiserialer Korrelationskoeffizient <span class="math inline">\(r\)</span>. Mehr dazu auch in der Veröffentlichung von <span class="citation" data-cites="tomczak2014need">Tomczak &amp; Tomczak (<a href="#ref-tomczak2014need" role="doc-biblioref">2014</a>)</span>. Wir nutzen hier die Implementierung in <code>{rstatix}</code> mit der Funktion <code>wilcox_effsize()</code>. Praktischerweise erhalten wir dann auch gleich die Interpretation mit angegeben. Dann können wir die Abschätzung dann auch gleich mit übernehmen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox_effsize</span>(jump_length <span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(effsize, magnitude)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  effsize magnitude
    &lt;dbl&gt; &lt;ord&gt;    
1   0.666 large    </code></pre>
</div>
</div>
<p>Leider kannst du mit dem Wert von <span class="math inline">\(0.66\)</span> nicht weiterrechnen. Der <span class="math inline">\(r\)</span>-Wert ist einheitlos und kann nicht in eine Kosten/Nutzenrechnung überführt werden. Daher hast du nur die Information, dass der Effekt zwischen den Sprungweiten der Hunde- un Katzenflöhe groß ist.</p>
<p>Bitte nutze die Verschiebung der Mediane nur als Effektschätzer, wenn du dir sicher bist, dass die beiden Verteilungsformen der Gruppen gleich sind und Varianhomogenität zwischen deinen Gruppen vorliegt. Ansonsten ist die Medianverschiebung aus dem R Paket <code>{coin}</code> kein äquivalenter Effektschätzer.</p>
<p>Wir können natürlich auch als Effekctschätzer den relativen Effekt <span class="math inline">\(p(a,b)\)</span> händisch berechnen, wenn wir nicht das R Paket <code>{nparcomp}</code> nutzen wollen. Aber auch hier stellt sich die Frage, was wir mit dem Wissen machen welcher prozentualer Anteil der Messwerte in der einen Gruppe kleiner oder gleich als in der anderen Gruppe ist. Wir wissen ja am Ende wiederum nicht um wieviel kleiner. Eine Transformation in Ränge hat eben dann auch Nachteile.</p>
</section>
<section id="parametrische-lösung-der-t-test" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="parametrische-lösung-der-t-test">Parametrische Lösung: Der t-Test</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ranked_jump_length =</span> <span class="fu">rank</span>(jump_length)) <span class="sc">|&gt;</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(ranked_jump_length <span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, statistic, p)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  group1 group2 statistic       p
  &lt;chr&gt;  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;
1 dog    cat         3.31 0.00624</code></pre>
</div>
</div>
</section>
</section>
<section id="mit-abhängigen-beobachtungen" class="level3" data-number="35.7.2">
<h3 data-number="35.7.2" class="anchored" data-anchor-id="mit-abhängigen-beobachtungen"><span class="header-section-number">35.7.2</span> … mit abhängigen Beobachtungen</h3>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true"><code>{stats}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false"><code>{coin}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false"><code>{rstatix}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false"><code>{nparcomp}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p><code>wilxoc.test()</code></p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(paired_tbl<span class="sc">$</span>hungrig, paired_tbl<span class="sc">$</span>satt, <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(paired_tbl$hungrig, paired_tbl$satt, paired =
TRUE, : requested conf.level not achievable</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(paired_tbl$hungrig, paired_tbl$satt, paired =
TRUE, : cannot compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(paired_tbl$hungrig, paired_tbl$satt, paired =
TRUE, : cannot compute exact confidence interval with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  paired_tbl$hungrig and paired_tbl$satt
V = 0, p-value = 0.05791
alternative hypothesis: true location shift is not equal to 0
90 percent confidence interval:
 -1.1 -0.4
sample estimates:
(pseudo)median 
    -0.8000017 </code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p><code>wilcox_test()</code></p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcoxsign_test</span>(paired_tbl<span class="sc">$</span>hungrig <span class="sc">~</span> paired_tbl<span class="sc">$</span>satt, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">paired =</span> <span class="cn">TRUE</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic Wilcoxon-Pratt Signed-Rank Test

data:  y by x (pos, neg) 
     stratified by block
Z = -2.0319, p-value = 0.04217
alternative hypothesis: true mu is not equal to 0</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p><a href="https://www.datanovia.com/en/lessons/wilcoxon-test-in-r/">Wilcoxon Test in R</a></p>
<p><code>wilcox_test()</code></p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>rstatix<span class="sc">::</span><span class="fu">wilcox_test</span>(jump_length <span class="sc">~</span> trt, <span class="at">data =</span> paired_long_tbl, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, p)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  group1  group2      p
  &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;
1 hungrig satt   0.0579</code></pre>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<p><code>npar.t.test.paired()</code></p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>npar_obj <span class="ot">&lt;-</span> <span class="fu">npar.t.test.paired</span>(jump_length <span class="sc">~</span> trt, <span class="at">data =</span> paired_long_tbl,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">plot.simci =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
 #----------------Nonparametric Paired t Test-------------------------------------------# 
 
 - Sample Size:  5 
 - Factor Levels:  hungrig satt 
 - H0:  p=1/2 
 - Alternative Hypothesis:  True relative effect is less or greater than 1/2 
 - Confidence Level: 95 % 
 - Method: Brunner-Munzel (BM), Permutation (PERM) 
 
 #--------------------------------------------------------------------------------------# 
 </code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>npar_obj<span class="sc">$</span>Analysis</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Lower p.hat Upper     T p.value
BM   0.656  0.76 0.864 6.949   0.002
PERM 0.500  0.76 1.020 6.949   0.000</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="parametrische-lösung-der-paired-t-test" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="parametrische-lösung-der-paired-t-test">Parametrische Lösung: Der paired t-Test</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>paired_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ranked_jump_length =</span> <span class="fu">rank</span>(jump_length)) <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(ranked_jump_length <span class="sc">~</span> trt, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, statistic, p)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  group1  group2 statistic       p
  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;
1 hungrig satt       -6.04 0.00378</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="ergebnisse-mit-tidyplots" class="level2" data-number="35.8">
<h2 data-number="35.8" class="anchored" data-anchor-id="ergebnisse-mit-tidyplots"><span class="header-section-number">35.8</span> Ergebnisse mit <code>{tidyplots}</code></h2>
<p>Häufig wollen wir nicht nur den p-Wert aus einem U-Test berichten sondern natürlich auch gleich die richtige Abbildung dazu haben. Hier gibt es mit dem R Paket <code>{tidyplots}</code> eine gute Möglichkeit. Das R Paket verbindet dabei die Funktionalität von <code>{ggplot}</code> und <code>{ggpubr}</code>. Dabei bleibt es aber dann sehr einfahc zu bedienen. Insbesondere in dem Fall, dass du nur zwei Gruppen in einem U-Test miteinander vergleichen willst.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alternativen zu <code>{tidyplots}</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Das R Paket <code>{ggpubr}</code> bietet auch noch andere Alternativen für die Darstellung von statistischen Vergleichen in deinen Daten unter <a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr: ‘ggplot2’ Based Publication Ready Plots</a>. Vielleicht findest du da auch noch eine bessere Abbildung als hier. Da wir hier sehr viel ähnliches haben, bleibe ich bei <code>{tidyplots}</code>.</p>
</div>
</div>
<p>Neben den p-Werten, die ich hier mit der Funktion <code>add_test_pvalue()</code> ergänze kannst du auch Sterne mit der Funktion <code>add_test_asterisks()</code> nutzen. Das liegt dann ganz bei dir. Es gibt auch die Möglichkeit nicht signifikante Ergebnisse auszublenden. Mehr dazu findest du dann auf der <a href="https://jbengler.github.io/tidyplots/articles/Visualizing-data.html#statistical-comparison">Hilfeseite zu den statistischen Vergleichen in <code>{tidyplots}</code></a>. Ich zeige hier dir nur die Standardanwendung. Wir rechnen hier immer den U-Test aus dem R Paket <code>{rstatix}</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Barplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Boxplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Gepaarter Dotplot</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>Die Standardabbildung ist sicherlich der Barplot zusammen mit der Standardabweichung als Fehlerbalken. Dann habe ich noch die einzelnen Beobachtungen ergänzt. Die Klammer über den beiden Säulen gibt den Vergleich an und die Zahl ist der p-Wert aus einem U-Test. Wir sehen hier, dass sich die beiden Floharten in den Sprungweiten signifikant unterscheiden. Der p-Wert ist kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>() <span class="sc">|&gt;</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_mean_bar</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">width =</span> <span class="fl">0.4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_sd_errorbar</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_test_pvalue</span>(<span class="at">method =</span> <span class="st">"wilcox_test"</span>, <span class="at">hide_info =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Flohart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"dog"</span> <span class="ot">=</span> <span class="st">"Hund"</span>, <span class="st">"cat"</span> <span class="ot">=</span> <span class="st">"Katze"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-tidyplot-barplot-ttest" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyplot-barplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-utest_files/figure-html/fig-tidyplot-barplot-ttest-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Abbildung&nbsp;35.9— Einfaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem U-Test."><img src="stat-tests-utest_files/figure-html/fig-tidyplot-barplot-ttest-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="336"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyplot-barplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;35.9— Einfaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem U-Test.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Es gibt auch gute Gründe ienmal den Boxplot zu wählen, wenn wir etwas besser die Verteilung der Sprungweiten darstellen wollen. Ich habe dann noch die einzelnen Beobachtungen ergänzt. Die Klammer über den beiden Säulen gibt den Vergleich an und die Zahl ist der p-Wert aus einem U-Test. Wir sehen hier, dass sich die beiden Floharten in den Sprungweiten signifikant unterscheiden. Der p-Wert ist kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>() <span class="sc">|&gt;</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">box_width =</span> <span class="fl">0.3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_test_pvalue</span>(<span class="at">method =</span> <span class="st">"wilcox_test"</span>, <span class="at">hide_info =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Flohart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"dog"</span> <span class="ot">=</span> <span class="st">"Hund"</span>, <span class="st">"cat"</span> <span class="ot">=</span> <span class="st">"Katze"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-tidyplot-boxplot-ttest" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyplot-boxplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-utest_files/figure-html/fig-tidyplot-boxplot-ttest-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Abbildung&nbsp;35.10— Einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem U-Test."><img src="stat-tests-utest_files/figure-html/fig-tidyplot-boxplot-ttest-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="336"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyplot-boxplot-ttest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;35.10— Einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem U-Test.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>Am Ende wollen wir uns dann nochmal den gepaarten U-Test als Wilcoxon Test anschauen. Hier ist dann die Abbildung realtiv einfach. Wir können da die Daten <code>paired_tbl</code> aus dem gepaarten U-Test nutzen nachdem wir die Daten in das Long-Format überführt haben. Etwas schwieriger ist dann der p-Wert, den p-Wert müssen wir dann erst selber errechnen und dann ergänzen. Also fangen wir einmal an die Daten in das Long-Format zu überführen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>paired_long_tbl <span class="ot">&lt;-</span> paired_tbl <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> satt<span class="sc">:</span>hungrig,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"trt"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt können wir den gepaarten U-Test rechnen und zwar aus dem R Paket <code>{rstatix}</code>. Dann müssen wir noch alles so umbauen, dass wir die Informationen dann in <code>{tidyplots}</code> auch nutzen können.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>stats_tbl <span class="ot">&lt;-</span> paired_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id) <span class="sc">|&gt;</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox_test</span>(jump_length <span class="sc">~</span> trt, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_xy_position</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir butzen hier die Funktion <code>stat_pvalue_manual()</code> um händisch die p-Werte zu den Dotplot mit den Mittelwert und Standardabweichung zu ergänzen. Die Verbindungen zwischen den Beobachtungen haben wir dann durch <code>add_line()</code> erzeugt. Ich gebe zu, dass ist etwas komplizierter. Wenn du dann die Sterne haben willst, dann musst due das Label auf <code>"p.signif"</code> setzen. Dann werden statt der p-Werte <code>"p"</code> dir die Sterne <code>*</code> angezeigt. Wir sehen hier, dass sich die beiden Fütterungslevel in den Sprungweiten signifikant unterscheiden. Der p-Wert ist kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>paired_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidyplot</span>(<span class="at">x =</span> trt, <span class="at">y =</span> jump_length, <span class="at">color =</span> trt, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_line</span>(<span class="at">group =</span> id, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>() <span class="sc">|&gt;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_mean_dash</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_sd_errorbar</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add</span>(<span class="fu">stat_pvalue_manual</span>(stats_tbl, <span class="at">size =</span> <span class="dv">7</span><span class="sc">/</span>.pt, <span class="at">label =</span> <span class="st">"p"</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bracket.nudge.y =</span> <span class="fl">0.1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Fütterung"</span>) <span class="sc">|&gt;</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reorder_x_axis_labels</span>(<span class="st">"hungrig"</span>, <span class="st">"satt"</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"satt"</span> <span class="ot">=</span> <span class="st">"gefüttert"</span>, <span class="st">"hungrig"</span> <span class="ot">=</span> <span class="st">"ungefüttert"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-tidyplot-barplot-ttest-paired" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-tidyplot-barplot-ttest-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-tests-utest_files/figure-html/fig-tidyplot-barplot-ttest-paired-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Abbildung&nbsp;35.11— Dotplot mit Mittelwert und Standardabweichung für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem gepaarten U-Test. Gleiche Messungen an gleichen Flöhen sind mit einer Linie verbunden."><img src="stat-tests-utest_files/figure-html/fig-tidyplot-barplot-ttest-paired-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="336"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tidyplot-barplot-ttest-paired-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;35.11— Dotplot mit Mittelwert und Standardabweichung für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem gepaarten U-Test. Gleiche Messungen an gleichen Flöhen sind mit einer Linie verbunden.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-conroy2012hypotheses" class="csl-entry" role="listitem">
Conroy, R. M. (2012). What hypotheses do <span>„nonparametric“</span> two-group tests actually test? <em>The Stata Journal</em>, <em>12</em>(2), 182–190.
</div>
<div id="ref-divine2018wilcoxon" class="csl-entry" role="listitem">
Divine, G. W., Norton, H. J., Barón, A. E., &amp; Juarez-Colunga, E. (2018). The Wilcoxon–Mann–Whitney procedure fails as a test of medians. <em>The American Statistician</em>, <em>72</em>(3), 278–286.
</div>
<div id="ref-hart2001mann" class="csl-entry" role="listitem">
Hart, A. (2001). Mann-Whitney test is not just a test of medians: differences in spread can be important. <em>Bmj</em>, <em>323</em>(7309), 391–393.
</div>
<div id="ref-sugimoto2023hyperactive" class="csl-entry" role="listitem">
Sugimoto, E., Li, J., Hayashi, Y., Iida, K., Asada, S., Fukushima, T., Tamura, M., Shikata, S., Zhang, W., Yamamoto, K., et al. (2023). Hyperactive Natural Killer cells in Rag2 knockout mice inhibit the development of acute myeloid leukemia. <em>Communications Biology</em>, <em>6</em>(1), 1294.
</div>
<div id="ref-tomczak2014need" class="csl-entry" role="listitem">
Tomczak, M., &amp; Tomczak, E. (2014). <em>The need to report effect size estimates revisited. An overview of some recommended measures of effect size</em>.
</div>
<div id="ref-zimmerman1993relative" class="csl-entry" role="listitem">
Zimmerman, D. W., &amp; Zumbo, B. D. (1993). Relative power of the Wilcoxon test, the Friedman test, and repeated-measures ANOVA on ranks. <em>The Journal of Experimental Education</em>, <em>62</em>(1), 75–86.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-tests-anova-manova.html" class="pagination-link" aria-label="Die MANOVA">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-tests-kruskal.html" class="pagination-link" aria-label="Der Kruskal-Wallis-Test">
        <span class="nav-page-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb49" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc, performance, parameters,</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="in">               latex2exp, see, patchwork, mfp, multcomp, emmeans, janitor, effectsize,</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="in">               broom, ggmosaic, tinytable, ggrepel, tidyplots,</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="in">               conflicted)</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="in">cb_pal &lt;- c("#000000", "#E69F00", "#56B4E9", </span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="in">            "#009E73", "#F0E442", "#F5C710", </span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="in">            "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- cb_pal</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="in">## </span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="in">fac1_tbl &lt;- read_excel("data/flea_dog_cat.xlsx") |&gt; </span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="in">  select(animal, jump_length) |&gt; </span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(animal = as_factor(animal))</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: sim-utest-samplesize</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"simulation/sim-stat-tests-utest.R"</span>)</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"images/R/stat-tests-utest.R"</span>)</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a><span class="fu"># Der U-Test {#sec-utest}</span></span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-tests-utest.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Statisticians, like artists, have the bad habit of falling in love with their models." --- George Box*</span></span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/caution.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution appearance="simple"}</span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stand des Kapitels: Baustelle (seit 06.2025)</span></span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a>Dieses Kapitel wird überarbeitet. Ziel ist es die Nichtparametrik zum Start des Wintersemesters 2025/26 überarbeitet zu haben. Da ich hier direkt im Kapitel arbeite, kann es sein, dass mal die ein oder andere Funktion nicht funktioniert oder aber Teile im Nichts enden. Wird dann repariert.</span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a><span class="fu">## Allgemeiner Hintergrund</span></span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a>Der U-Test ist auch unter den Namen Wilcoxon-Mann-Whitney-Test, Mann-Whitney-U-Test oder Wilcoxon-Rangsummentest bekannt. Aus Gründen der Kürze werde ich hier immer von dem U-Test schreiben. Der U-Test wird häufig noch in den Grundlagenwissenschaften wie Zellforschung oder bie Mäusemodellen verwendet. Gerne auch bei genetischen Knockout-Experimenten mit einer kleinen Anzahl an Mäusen. In den Agrarwissenschaften treffen wir den U-Test nicht ganz so häufig, da wir meistens dann doch auf einem normalverteilten Messwert den ANOVA Pfad durchrechnen wollen.</span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a>Wann nutzen wir den Wilcoxon-Mann-Whitney-Test? Wir nutzen den Wilcoxon-Mann-Whitney-Test wenn wir zwei Verteilungen miteinander vergleichen wollen. Das ist jetzt sehr abstrakt und auch eins der Probleme des U-Tests. Wir würden sagen, dass wenn wir zwei Gruppen haben und ein nicht normalverteiltes $y$, dann nutzen wir einen U-Test. Das ist aber stark verkürzt, mittlerweile haben wir in unserer statistischen Toolbox auch über das statistsiche Modellieren eine Lösungen für eine Vielzahl von Verteilungen. Keine Normalverteilung heißt nicht automatisch jetzt aber Nichtparametrik. Das war vielleicht Anfang der 90ziger so. Wir haben heute mehr Möglichkeiten --- im Prinzip meine ich damit, dass der U-Test seine Nische verdient hat, aber eigentlich etwas veraltet ist mit seinen Problemen. Haben wir ein normalverteiltes $y$ rechnen wir meist einen t-Test. Wir könnten aber auch einen Wilcoxon-Mann-Whitney-Test auf einer Normalverteilung rechnen.</span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a>Was ist jetzt der Unterschied zwischen einem UTest und einem t-Test? Der t-Test vergleicht die Mittelwerte zweier Normalverteilungen, also zum Beispiel die Verteilung der Sprungweiten der Hundeflöhe gegen die Verteilung der Sprungweiten der Katzenflöhe. Dazu nutzt der t-Test die Mittelwerte und die Standardabweichung. Beides sind Parameter einer Verteilung und somit ist der t-Test ein parametrischer Test. Der Wilcoxon-Mann-Whitney-Test ist die nichtparametrische Variante in dem wir die Zahlen in Ränge umwandeln, also sortieren, und mit den Rängen der Zahlen rechnen. Die deskriptiven Maßzahlen wären dann Median, Quantile und Quartile. Also im Prinzip eine Rangtransformation und dann anschließend ein statistischer Test der Ränge. In der folgenden Abbildung habe ich dir einmal den Zusammenhhang zwischen den originalen Messwerten und der Rangtransformation dargestellt.</span>
<span id="cb49-62"><a href="#cb49-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-65"><a href="#cb49-65" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-66"><a href="#cb49-66" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb49-67"><a href="#cb49-67" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-68"><a href="#cb49-68" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-69"><a href="#cb49-69" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ranked-00</span></span>
<span id="cb49-70"><a href="#cb49-70" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb49-71"><a href="#cb49-71" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb49-72"><a href="#cb49-72" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb49-73"><a href="#cb49-73" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Zusammenhang zwischen den originalen Messwerten und den rangierten Messwerten nach der Rangtransformation. Nach dem Rangieren haben alle Messwerte den gleichen Abstand."</span></span>
<span id="cb49-74"><a href="#cb49-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-75"><a href="#cb49-75" aria-hidden="true" tabindex="-1"></a>p_rank_intro</span>
<span id="cb49-76"><a href="#cb49-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-77"><a href="#cb49-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-78"><a href="#cb49-78" aria-hidden="true" tabindex="-1"></a>Wenn wir von der Rangtransformation sprechen, dann treten auch häufiger Bindungen in den Messwerten auf. Bindungen sind kein Problem und können bei der Auswertung berücksichtigt werden. Je mehr Kommastellen ein kontinuierlicher Messwert hat, desto weniger Binden können natürlich auftreten. Bei ordinalen Daten wie Noten ist das natürlich nicht so einfach möglich.</span>
<span id="cb49-79"><a href="#cb49-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-80"><a href="#cb49-80" aria-hidden="true" tabindex="-1"></a>Was sind Bindungen?</span>
<span id="cb49-81"><a href="#cb49-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-82"><a href="#cb49-82" aria-hidden="true" tabindex="-1"></a>:   Bindungen treten bei der Rangtransformation auf, wenn wir gleiche originale Messwerte haben. Dann müssen wir zwei Messwerten den gleichen Rang geben. Wenn dieser Fall auftritt, dann sprechen wir von Bindungen in den Daten. Die nichtparametrischen Algorithmen haben dafür implementierte Lösungen.</span>
<span id="cb49-83"><a href="#cb49-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-84"><a href="#cb49-84" aria-hidden="true" tabindex="-1"></a>Steigen wir also einmal mit einem plakativen Beispiel aus der Studie von @sugimoto2023hyperactive in die Thematik des U-Test ein. Ich habe die folgende Abbildung einmal mitgebracht in der wir die Mittewerte sowie die Standardabwichung von verschiedenen Messwerten für eien Wildtyp (WT) sowie einer genetischen Variante (Rag2) sehen. Die Sterne geben die Signifikanz des Vergleichs zwischen den Gruppen an.</span>
<span id="cb49-85"><a href="#cb49-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-86"><a href="#cb49-86" aria-hidden="true" tabindex="-1"></a><span class="al">![*Left: Number of GFP+ MLL-AF9 cells in peripheral blood of WT and Rag2−/− mice. PB was collected 11 days after transplantation. Data are shown as means ± s.e.m. \[n = 6 (male: n = 3, female: n = 3) for each group\]. \*\*P \&lt; 0.01；two-tailed Mann–Whitney test. Middle/right: Weight and size of spleens collected from WT or Rag2−/− mice 11 days after transplantation. Data are shown as means ± s.e.m. (n = 3 for each group, male). \*\*\*P \&lt; 0.001, \*\*\*\*P \&lt; 0.0001; two-tailed Student’s t test.* Quelle: @sugimoto2023hyperactive](images/sugimoto_cell_mice.png)</span>{#fig-utest-intro fig-align="center" width="100%"}</span>
<span id="cb49-87"><a href="#cb49-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-88"><a href="#cb49-88" aria-hidden="true" tabindex="-1"></a>Nachdem wir uns die @fig-utest-intro einmal genauer angeschaut haben, stellt sich die Frage warum wird in der Abbildung ganz links ein Mann-Whitney oder U-Test gerechnet und in den beiden anderen Abbildungen ein Student t-Test? Warum nicht auf alles ein U-Test rechnen? Immerhin würde ja auf das Gewicht und die Größe der Milz (eng. *spleen*) auch ein U-Test als statistischer Test auch gehen. Wir haben hier unterschiedliche Fallzahlen in den Gruppen. In der linken Abbildung haben wir pro Gruppe sechs Mäuse und in der mittleren sowie rechten Abbidlung nur drei Mäuse pro Gruppe. Macht das einen Unterschied? Ja, für den U-Test macht das einen gewaltigen Unterschied, wie wir gleich einmal sehen werden.</span>
<span id="cb49-89"><a href="#cb49-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-90"><a href="#cb49-90" aria-hidden="true" tabindex="-1"></a><span class="fu">## Das Problem...</span></span>
<span id="cb49-91"><a href="#cb49-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-92"><a href="#cb49-92" aria-hidden="true" tabindex="-1"></a>Es gibt ein paar Probleme, wenn wir uns mit dem U-Test im Allgemeinen beschäftigen wollen. Diese Probleme sind eigentlich nicht weitläufig bekannt. Mir waren die Probleme auch nicht bekannt bis ich angefangen habe dieses Kapitel zu schreiben. Deshalb gehen wir mal die Probleme durch und leider gibt es nicht so richtig eine Lösung dafür. Es sind Probleme, die aus dem Algorithmus und der Transformation in Ränge entstehen.</span>
<span id="cb49-93"><a href="#cb49-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-94"><a href="#cb49-94" aria-hidden="true" tabindex="-1"></a><span class="fu">### ...der Gruppengröße</span></span>
<span id="cb49-95"><a href="#cb49-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-96"><a href="#cb49-96" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Statistik fängt erst ab einer Gruppengröße von n gleich sieben überhaupt an." --- Ein anonymer Nichtparametriker*</span></span>
<span id="cb49-97"><a href="#cb49-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-98"><a href="#cb49-98" aria-hidden="true" tabindex="-1"></a>Um das Problem der geringen Gruppengröße zu verstehen, müssen wir erstmal den Zusammenhang zwischen einem signifikanten Ergebnis und der Mittelwertsdifferenz als ein statistsiches Maß für den Effekt verstehen. Je größer der Effekt, desto eher sollte ein Vergleich zwischen zwei Gruppen signifikant unterschiedlich sein. In der folgenden Abbildung habe ich dir einmal den Zusammenhang zwischen der Mittelwerstdifferenz $\Delta$ und der Signifikanz dargestellt. Wie du siehst überlappen die Verteilungend der beiden Gruppen, wenn die Differenz der Mittelwerte klein ist. Je größer der Unterschied desto größer ist die Mittelwertsdifferenz. Soweit so klar. Damit sollten wir auch kleinere p-Werte erhalten, je größer die Mittelwertsdifferenz wird. Ich habe dir mal beispielhafte p-Werte in der Abbidung ergänzt.</span>
<span id="cb49-99"><a href="#cb49-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-102"><a href="#cb49-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-103"><a href="#cb49-103" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-104"><a href="#cb49-104" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb49-105"><a href="#cb49-105" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-106"><a href="#cb49-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-utest-intro-sim-02</span></span>
<span id="cb49-107"><a href="#cb49-107" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb49-108"><a href="#cb49-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb49-109"><a href="#cb49-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb49-110"><a href="#cb49-110" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung des Zusammenhangs zwischen der Mittelwertsdifferenz und der zu erwartenden Signifikanz aus einem statistischen Tests für einen Zweigruppenvergleich. Die p-Werte sind abgeschätzt. **(A)** Die Mittelwertsdifferenz ist klein, es ist kein signifikanter Unterschied zu erwarten. Der p-Wert ist groß. **(B)** Die Mittelwertsdifferenz ist moderat, es ist ein kleiner p-Wert zu erwarten. **(C)** Die Mittelwertsdifferenz ist groß, damit ist der p-Wert kleiner als $0.001$ und hoch signifikant. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb49-111"><a href="#cb49-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-112"><a href="#cb49-112" aria-hidden="true" tabindex="-1"></a>p_small_d <span class="sc">+</span> p_mid_d <span class="sc">+</span> p_high_d <span class="sc">+</span></span>
<span id="cb49-113"><a href="#cb49-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb49-114"><a href="#cb49-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb49-115"><a href="#cb49-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb49-116"><a href="#cb49-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-117"><a href="#cb49-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-118"><a href="#cb49-118" aria-hidden="true" tabindex="-1"></a>Wenn wir jetzt den Zusammenhang zwischen der Mittelwertsdifferenz und dem p-Wert verstanden haben, können wir jetzt zum Problem der geringen Fallzahl in den Gruppen kommen. Wenn die Mittelwertsdifferenz ansteigt, dann sollte der p-Wert fallen. Wie du in folgender Abbildung links auch siehst, ist das der Fall. Für alle Kombinationen der Fallzahlen in den beiden Gruppen $n_1$ und $n_2$ fallen die p-Werte mit steigendem Effekt. Nur haben die p-Werte ein Plateau unter das sie nicht fallen können. Und bei einer Gruppengröße von 3 und 3 oder 4 und 3 können die p-Werte nicht kleiner als 0.05 werden egal wie groß die Mittelwertsdifferenz wird. Daher können wir mit diesen beiden Fallzahlkombinationen keinen signifkanten Unterschied nachweisen. Das sehen wir auch nochmal in der anderen Abbildung rechts, hier siehst du die minimalen p-Werte. Die p-Werte können in einem U-Test nicht unter gewisse Schranken fallen, abhängig von der Gruppenfallzahl.</span>
<span id="cb49-119"><a href="#cb49-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-122"><a href="#cb49-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-123"><a href="#cb49-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-124"><a href="#cb49-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb49-125"><a href="#cb49-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-126"><a href="#cb49-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-utest-intro-sim-01</span></span>
<span id="cb49-127"><a href="#cb49-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb49-128"><a href="#cb49-128" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb49-129"><a href="#cb49-129" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb49-130"><a href="#cb49-130" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Zusammenhang zwischen der Mittelwertsdifferenz und dem mittleren p-Wert aus einer Simulationsstudie abhängig von der Fallzahl in zwei Gruppen $n_1$ und $n_2$. Die graue Linie zeigt das 5% Signifikanzniveau an. **(A)** Mit steigender Mittelwertsdifferenz fallen die mittleren p-Werte. Die p-Werte erreichen je nach Fallzahlkombination ein Plateau. **(B)** Kleinst möglicher p-Wert in den Simulationen für jede Fallzahlkombinationen. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb49-131"><a href="#cb49-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-132"><a href="#cb49-132" aria-hidden="true" tabindex="-1"></a>p1_sample <span class="sc">+</span> p2_sample <span class="sc">+</span></span>
<span id="cb49-133"><a href="#cb49-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb49-134"><a href="#cb49-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb49-135"><a href="#cb49-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb49-136"><a href="#cb49-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-137"><a href="#cb49-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-138"><a href="#cb49-138" aria-hidden="true" tabindex="-1"></a>Jetzt verstehen wir auch warum @sugimoto2023hyperactive in der @fig-utest-intro auf einen Student t-Test für die Gruppengröße $n_1 = 3$ und $n_2 = 3$ umgeschwenkt ist. Trotz des riesigen Effekts in den Barplots und damit dem Mittelwertsunterschied, wäre ein Mann-Whitney Test nie signifikant geworden. Der p-Werte wäre dann hier auf 10% begrenzt, egal wie groß der eigentliche Effekt ist. Diese harte Grenze kennt der t-Test nicht, deshalb wurde hier dann der t-Test als Ausweg gewählt.</span>
<span id="cb49-139"><a href="#cb49-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-140"><a href="#cb49-140" aria-hidden="true" tabindex="-1"></a><span class="fu">### ...der Hypothesen</span></span>
<span id="cb49-141"><a href="#cb49-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-142"><a href="#cb49-142" aria-hidden="true" tabindex="-1"></a>Das Problem mit den <span class="co">[</span><span class="ot">Mann-Whitney-U-Test und den Hypothesen</span><span class="co">](https://statistikguru.de/spss/mann-whitney-u-test/mann-whitney-u-test-hypothesen.html)</span> hat mich etwas überraschend getroffen. Ich dachte lange immer, dass der U-Test eben die Mediane miteinander vergleicht. Das macht ja auch irgendwie Sinn, denn die Mediane müssen ja auch einen Test haben und basieren ja auch auf Rängen. Oder wie es so schön sinnig in der Veröffentlichung <span class="co">[</span><span class="ot">The Wilcoxon–Mann–Whitney Procedure Fails as a Test of Medians</span><span class="co">](https://www.tandfonline.com/doi/full/10.1080/00031305.2017.1305291#d1e1503)</span> von @divine2018wilcoxon geschrieben steht.</span>
<span id="cb49-143"><a href="#cb49-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-144"><a href="#cb49-144" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"A major impetus to reporting medians with Mann-Whitney-U-tests results is likely the major utility of reporting a summary statistic that reflects the same scale as the data being analyzed." --- @divine2018wilcoxon*</span></span>
<span id="cb49-145"><a href="#cb49-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-146"><a href="#cb49-146" aria-hidden="true" tabindex="-1"></a>Gut, was testet den nun der U-Test? <span class="co">[</span><span class="ot">Kommt auf die Annahmen an die Daten und damit dem U-Test an</span><span class="co">](https://de.wikipedia.org/wiki/Wilcoxon-Mann-Whitney-Test#Annahmen)</span>. Oder konkreter an die beiden Verteilungsformen, die du miteinander vergleichst. Der U-Test kann nämlich unterschiedliche Nullhypothesen haben, je nachdem welche Annahmen du an deine Daten hast. Und hier kommt der schlechte Witz. Meistens hast du so wenig Beobachtungen, dass du selber keine Visualisierung der Verteilung erstellen kannst.</span>
<span id="cb49-147"><a href="#cb49-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-148"><a href="#cb49-148" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gleiche Verteilungsform, unterschiedliche Lage {.unnumbered .unlisted}</span></span>
<span id="cb49-149"><a href="#cb49-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-150"><a href="#cb49-150" aria-hidden="true" tabindex="-1"></a>Weil die beiden Verteilungsfunktionen bis auf Verschiebung gleich sind, muss insbesondere Varianzhomogenität zwischen den beiden Gruppen gelten. Wenn wir also gleiche Verteilungen haben, die auch damit varianzhomogen sind, können wir folgende Hypothesen aufstellen. Ich habe dir den Fall einmal in der folgenden Abbildung dargestellt. Die Annahmen sind sehr restriktiv. Nach @conroy2012hypotheses mit <span class="co">[</span><span class="ot">What Hypotheses do “Nonparametric” Two-Group Tests Actually Test?</span><span class="co">](https://journals.sagepub.com/doi/10.1177/1536867X1201200202)</span> sollte daher der U-Test nicht für den Vergleich von Medianen genutzt werden.</span>
<span id="cb49-151"><a href="#cb49-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-154"><a href="#cb49-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-155"><a href="#cb49-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-156"><a href="#cb49-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb49-157"><a href="#cb49-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-158"><a href="#cb49-158" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-utest-intro-02</span></span>
<span id="cb49-159"><a href="#cb49-159" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb49-160"><a href="#cb49-160" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb49-161"><a href="#cb49-161" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb49-162"><a href="#cb49-162" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Der U-Test kann unter der Annahme der gleichen Verteilungsform und damit angenommener Varianzhomogenität die Verschiebung a in den Medianen testen. Die Annahmen sind sehr restriktiv und treten nicht oft auf. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb49-163"><a href="#cb49-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-164"><a href="#cb49-164" aria-hidden="true" tabindex="-1"></a>p_shift </span>
<span id="cb49-165"><a href="#cb49-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-166"><a href="#cb49-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-167"><a href="#cb49-167" aria-hidden="true" tabindex="-1"></a>Damit ergeben sich dann die folgenden Hypothesenpaare für den Vergleich der Mediane.</span>
<span id="cb49-168"><a href="#cb49-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-169"><a href="#cb49-169" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb49-170"><a href="#cb49-170" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prosa</span></span>
<span id="cb49-171"><a href="#cb49-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-172"><a href="#cb49-172" aria-hidden="true" tabindex="-1"></a>$H_0:$ *Die Gleichheit der Mediane der zwei Gruppen liegt vor. Die Verschiebung der Mediane ist Null.*</span>
<span id="cb49-173"><a href="#cb49-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-174"><a href="#cb49-174" aria-hidden="true" tabindex="-1"></a>$H_A:$ *Die Mediane der zwei Gruppen unterscheiden sich. Die Verschiebung der Mediane ist ungleich Null.*</span>
<span id="cb49-175"><a href="#cb49-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-176"><a href="#cb49-176" aria-hidden="true" tabindex="-1"></a><span class="fu">## Formel</span></span>
<span id="cb49-177"><a href="#cb49-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-178"><a href="#cb49-178" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-179"><a href="#cb49-179" aria-hidden="true" tabindex="-1"></a>H_0: a = 0</span>
<span id="cb49-180"><a href="#cb49-180" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-181"><a href="#cb49-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-182"><a href="#cb49-182" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-183"><a href="#cb49-183" aria-hidden="true" tabindex="-1"></a>H_A: a \neq 0</span>
<span id="cb49-184"><a href="#cb49-184" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-185"><a href="#cb49-185" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-186"><a href="#cb49-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-187"><a href="#cb49-187" aria-hidden="true" tabindex="-1"></a>Die Problematik ist recht umfangreich und der U-Test kann auch bei gleichen Medianen signifkante Ergebnisse liefern. @hart2001mann diskutiert in <span class="co">[</span><span class="ot">Mann-Whitney test is not just a test of medians: differences in spread can be important</span><span class="co">](https://www.bmj.com/content/bmj/323/7309/391.full.pdf?casa_token=GFRQ5vdBejMAAAAA:uWLUlyNzp0rDKrXcco4fvr4L35PvzDO9Y-SPDKTIUGNgcMvgtmcctzE5tIz82XB5t8TydVC7okvjDA)</span> nochmal einige Sonderfälle. Also verbleibe ich dabei, der U-Test testet ursprünglich nicht die Unterschiede in den Median. Außer die Sterne stehen günstig, was aber keine Grundlage für sauberes wissenschaftliches Arbeiten ist.</span>
<span id="cb49-188"><a href="#cb49-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-189"><a href="#cb49-189" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Unterschiedliche Verteilungsform, unterschiedliche Lage {.unnumbered .unlisted}</span></span>
<span id="cb49-190"><a href="#cb49-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-191"><a href="#cb49-191" aria-hidden="true" tabindex="-1"></a>Nachdem wir uns nun davon verabschiedet haben, dass wir mit dem U-Test Mediane vergleichen, kommen wir nun zu den echten Hypothesen. Oder andersherum nur in sehr seltenen Fällen die Interpretation eines Vergleiches der Mediane erlaubt. Was ist also die Nullhypothese und die Alternativhypothese, die wir mit dem U-Test überprüfen wollen? Ich habe einmal ein schönes Zitat aus Guidelines von GraphPad mitgebracht sowie dann die Hypothesen auch einmal mathematisch aufgeschrieben.</span>
<span id="cb49-192"><a href="#cb49-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-193"><a href="#cb49-193" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb49-194"><a href="#cb49-194" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prosa</span></span>
<span id="cb49-195"><a href="#cb49-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-196"><a href="#cb49-196" aria-hidden="true" tabindex="-1"></a>Der U-Test beantwortet folgende Frage an die Daten.</span>
<span id="cb49-197"><a href="#cb49-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-198"><a href="#cb49-198" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"If the groups are sampled from populations with identical distributions, what is the chance that random sampling would result in a sum of ranks as far apart (or more so) as observed in this experiment?" --- [The Mann-Whitney test doesn't really compare medians](https://www.graphpad.com/guides/prism/5/user-guide/prism5help.html?stat_nonparametric_tests_dont_compa.htm)*</span></span>
<span id="cb49-199"><a href="#cb49-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-200"><a href="#cb49-200" aria-hidden="true" tabindex="-1"></a>Damit haben wir dann in Prosa folgendes Hypothesenpaar vorliegen.</span>
<span id="cb49-201"><a href="#cb49-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-202"><a href="#cb49-202" aria-hidden="true" tabindex="-1"></a>$H_0:$ *Es ist gleich wahrscheinlich, dass ein zufällig aus der einen Population ausgewählter Wert größer oder kleiner ist als ein zufällig ausgewählter Wert aus der anderen Population*</span>
<span id="cb49-203"><a href="#cb49-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-204"><a href="#cb49-204" aria-hidden="true" tabindex="-1"></a>$H_A:$ *Es ist* ***nicht*** *gleich wahrscheinlich, dass ein zufällig aus der einen Population ausgewählter Wert größer oder kleiner ist als ein zufällig ausgewählter Wert aus der anderen Population*</span>
<span id="cb49-205"><a href="#cb49-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-206"><a href="#cb49-206" aria-hidden="true" tabindex="-1"></a><span class="fu">## Formel</span></span>
<span id="cb49-207"><a href="#cb49-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-208"><a href="#cb49-208" aria-hidden="true" tabindex="-1"></a>In der Formel wird es schon etwas wilder und ich muss sagen, dass mir die Formel das Verständnis nicht leichter macht. Wir vergleichen hier zwei Populationen $X$ und $Y$ miteinander.</span>
<span id="cb49-209"><a href="#cb49-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-210"><a href="#cb49-210" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-211"><a href="#cb49-211" aria-hidden="true" tabindex="-1"></a>H_0:  Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y) = 0.5</span>
<span id="cb49-212"><a href="#cb49-212" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-213"><a href="#cb49-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-214"><a href="#cb49-214" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-215"><a href="#cb49-215" aria-hidden="true" tabindex="-1"></a>H_A:  Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y) \neq 0.5</span>
<span id="cb49-216"><a href="#cb49-216" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-217"><a href="#cb49-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-218"><a href="#cb49-218" aria-hidden="true" tabindex="-1"></a>In dem R Paket <span class="in">`{nparcomp}`</span> bezeichnen wir den Wert für $Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y)$ auch als relativen Effekt.</span>
<span id="cb49-219"><a href="#cb49-219" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-220"><a href="#cb49-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-221"><a href="#cb49-221" aria-hidden="true" tabindex="-1"></a>Da mir die Nullhypothese mit $Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y) = 0.5$ nicht ganz einleuchtete habe ich einmal die Sachlage visualisiert und in R nachgerechnet. Ich verstehe den Zusammenhang sonst nicht. Die Nullhypothese besagt ja, dass *es gleich wahrscheinlich ist, dass ein zufällig aus der einen Population ausgewählter Wert größer oder kleiner ist als ein zufällig ausgewählter Wert aus der anderen Population*. Daher baue ich mit einfach mal zwei Vaktoren <span class="in">`X`</span> und <span class="in">`Y`</span> mit jeweils den gleichen Zahlen mit $X = Y = {1, 2, 3, 4}$. Jetzt müsste ja auch der obigen Formel der Wert $0.5$ rauskommen, denn die Nullhypothese ist ja wahr. Die Werte sind ja gleich.</span>
<span id="cb49-222"><a href="#cb49-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-223"><a href="#cb49-223" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb49-224"><a href="#cb49-224" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualisierung</span></span>
<span id="cb49-225"><a href="#cb49-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-226"><a href="#cb49-226" aria-hidden="true" tabindex="-1"></a>Was habe ich in der folgenden Abbildung einmal den Zusammenhang der Formel mit den Werten dargestellt. Wir haben insgesamt 16 Wertepaare für unsere 4 Zahlen pro Gruppe. Davon sind vier Wertepaar gleich, dargestellt in grün. Hier kriegen wir dann den Wert für $\cfrac{1}{2} Pr(X = Y)$ mit $0.125$ raus. Dann haben wir noch sechs Wertepaare wo X kleiner ist als Y. Daher haben wir hier die Werte für $Pr(X&lt;Y)$ mit $0.375$ raus. Jetzt müssen wir noch die beiden Werte addieren und sehen, dass wir auf die $0.5$ kommen. Das sieht doch gut aus. Was es jetzt uns sagt, ist nochmal eine andere Sache, aber immerhin haben wir mal verstanden, wie die Wahrscheinlichkeiten berechnet werden. Am Ende ist es dann doch nur ein Spiel der wilden Kombinatorik. Mehr zum Spielen im folgenden Tab.</span>
<span id="cb49-227"><a href="#cb49-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-230"><a href="#cb49-230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-231"><a href="#cb49-231" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-232"><a href="#cb49-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb49-233"><a href="#cb49-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-234"><a href="#cb49-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-utest-intro-03</span></span>
<span id="cb49-235"><a href="#cb49-235" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb49-236"><a href="#cb49-236" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb49-237"><a href="#cb49-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb49-238"><a href="#cb49-238" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafte Berechnung der Wahrscheinlichkeit für die Nullhypothese in einem U-Test mit vier Werten für X und Y sowie den entsprechenden sechszehn Wertepaaren. Die Nullhypothese gilt, die Werte von X und Y sind gleich. Bindungen werden ignoriert, es handelt sich ja nicht um Ränge per se. Die grünen Linien zeigen Wertepaare die gleich sind. Die roten Linien Wertepaare wo X kleiner als Y ist. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb49-239"><a href="#cb49-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-240"><a href="#cb49-240" aria-hidden="true" tabindex="-1"></a>p_hypo_null </span>
<span id="cb49-241"><a href="#cb49-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-242"><a href="#cb49-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-243"><a href="#cb49-243" aria-hidden="true" tabindex="-1"></a>Du findest in dem Tutorium <span class="co">[</span><span class="ot">The Mann-Whitney U Test</span><span class="co">](https://www.statstutor.ac.uk/resources/uploaded/mannwhitney.pdf)</span> nochmal ein anschauliches Beispiel. Und auch in der Arbeit von @conroy2012hypotheses wird versucht die Nullhypothese als Wertepaare über einen Kugelplot zu visualisieren.</span>
<span id="cb49-244"><a href="#cb49-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-245"><a href="#cb49-245" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{base}`</span></span>
<span id="cb49-246"><a href="#cb49-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-247"><a href="#cb49-247" aria-hidden="true" tabindex="-1"></a>Wir können uns auch einmal die Sachlage in R nachbauen. Wir haben dann die zwei Vektoren <span class="in">`x`</span> und <span class="in">`y`</span> mit beliebigen Werten. Ich nehme hier mal wieder die Werte <span class="in">`1, 2, 3, 4`</span> für beide Vektoren.</span>
<span id="cb49-248"><a href="#cb49-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-251"><a href="#cb49-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-252"><a href="#cb49-252" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb49-253"><a href="#cb49-253" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb49-254"><a href="#cb49-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-255"><a href="#cb49-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-256"><a href="#cb49-256" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`crossing()`</span> gibt uns jetzt jedes paarweise Wertepaar der Kombinartion von <span class="in">`x`</span> und <span class="in">`y`</span> wieder. Dann können wir berechnen welche Wertepaare gleich sind, als <span class="in">`x == y`</span> sowie die Wertepaare, wo <span class="in">`x`</span> kleiner ist als <span class="in">`y`</span>. Dann schauen wir uns einmal die Ausgabe an.</span>
<span id="cb49-257"><a href="#cb49-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-260"><a href="#cb49-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-261"><a href="#cb49-261" aria-hidden="true" tabindex="-1"></a>pair_tbl <span class="ot">&lt;-</span> <span class="fu">crossing</span>(x, y) <span class="sc">|&gt;</span> </span>
<span id="cb49-262"><a href="#cb49-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_x_equal_y =</span> (x <span class="sc">==</span> y),</span>
<span id="cb49-263"><a href="#cb49-263" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_x_less_y =</span> (x <span class="sc">&lt;</span> y)) </span>
<span id="cb49-264"><a href="#cb49-264" aria-hidden="true" tabindex="-1"></a>pair_tbl</span>
<span id="cb49-265"><a href="#cb49-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-266"><a href="#cb49-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-267"><a href="#cb49-267" aria-hidden="true" tabindex="-1"></a>Jetzt können wir noch die Mittelwerte berechnen, was bei Wahrscheinlichkeiten nichts anders ist als die Wahrscheinlichkeit für <span class="in">`TRUE`</span> zu erhalten. Wir sehen, dass wir auf die gleichen Wert kommen. Jetzt kannst du auch mit anderen Kombinationen der Vektoren spielen und sehen, wie sich die Werte und deren Summe ändern.</span>
<span id="cb49-268"><a href="#cb49-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-271"><a href="#cb49-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-272"><a href="#cb49-272" aria-hidden="true" tabindex="-1"></a>pair_tbl <span class="sc">|&gt;</span> </span>
<span id="cb49-273"><a href="#cb49-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(p_x_less_y),</span>
<span id="cb49-274"><a href="#cb49-274" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mean</span>(p_x_equal_y)<span class="sc">/</span><span class="dv">2</span>) </span>
<span id="cb49-275"><a href="#cb49-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-276"><a href="#cb49-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-277"><a href="#cb49-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-278"><a href="#cb49-278" aria-hidden="true" tabindex="-1"></a><span class="fu">## Beispiel</span></span>
<span id="cb49-279"><a href="#cb49-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-280"><a href="#cb49-280" aria-hidden="true" tabindex="-1"></a>Dann können wir mal den Wert für $Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y)$ einmal für unser Datenbeispiel zu den Sprungweiten berechnen. Du findest die Daten nochmal weiter unten zum selber laden. Wir nutzen dazu den R Code aus dem vorherigen Tab. Zuerst müssen wir einmal die Sprungweiten über die beiden Floharten rangieren. Dann wieder die beiden Floharten separieren damit wir dann mit den Spalten der Ränge weiterrechnen können.</span>
<span id="cb49-281"><a href="#cb49-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-284"><a href="#cb49-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-285"><a href="#cb49-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-286"><a href="#cb49-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-287"><a href="#cb49-287" aria-hidden="true" tabindex="-1"></a>fac1_ranks_tbl <span class="ot">&lt;-</span> fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb49-288"><a href="#cb49-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ranked_jump_length =</span> <span class="fu">rank</span>(jump_length)) <span class="sc">|&gt;</span></span>
<span id="cb49-289"><a href="#cb49-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, ranked_jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb49-290"><a href="#cb49-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> animal,</span>
<span id="cb49-291"><a href="#cb49-291" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> ranked_jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb49-292"><a href="#cb49-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>()</span>
<span id="cb49-293"><a href="#cb49-293" aria-hidden="true" tabindex="-1"></a>fac1_ranks_tbl</span>
<span id="cb49-294"><a href="#cb49-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-295"><a href="#cb49-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-296"><a href="#cb49-296" aria-hidden="true" tabindex="-1"></a>Jetzt setzen wir die Ränge der beiden Spalten einmal in die Funktion <span class="in">`crossing()`</span> und rechnen einmal die Werte für $Pr(X &lt; Y)$ und $\cfrac{1}{2} Pr(X = Y)$ aus. Wie wir sehen, ist eine der Wahrscheinlichkeiten null. Die Summierung der beiden Werte spare ich mir, dass geht ja auch so recht flott im Kopf.</span>
<span id="cb49-297"><a href="#cb49-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-300"><a href="#cb49-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-301"><a href="#cb49-301" aria-hidden="true" tabindex="-1"></a><span class="fu">crossing</span>(<span class="at">dog =</span> fac1_ranks_tbl<span class="sc">$</span>dog, </span>
<span id="cb49-302"><a href="#cb49-302" aria-hidden="true" tabindex="-1"></a>         <span class="at">cat =</span> fac1_ranks_tbl<span class="sc">$</span>cat) <span class="sc">|&gt;</span> </span>
<span id="cb49-303"><a href="#cb49-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_x_equal_y =</span> (dog <span class="sc">==</span> cat),</span>
<span id="cb49-304"><a href="#cb49-304" aria-hidden="true" tabindex="-1"></a>         <span class="at">p_x_less_y =</span> (dog <span class="sc">&lt;</span> cat)) <span class="sc">|&gt;</span> </span>
<span id="cb49-305"><a href="#cb49-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(p_x_less_y),</span>
<span id="cb49-306"><a href="#cb49-306" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mean</span>(p_x_equal_y)<span class="sc">/</span><span class="dv">2</span>) </span>
<span id="cb49-307"><a href="#cb49-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-308"><a href="#cb49-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-309"><a href="#cb49-309" aria-hidden="true" tabindex="-1"></a>Was wissen wir also? Wenn wir alle 49 Wertepaare jeder Sprungweite eines Katzenflohs mit jeder Sprungweite eines Hundeflohs vergleichen, dann springen in 10.2% der Wertepaare die Hundeflöhe kürzer (oder gleich) weit wie die Katzenflöhe. Oder andersherum springen in fast 90% der Wertepaare die Hundeflöhe weiter als die Katzenflöhe.</span>
<span id="cb49-310"><a href="#cb49-310" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-311"><a href="#cb49-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-312"><a href="#cb49-312" aria-hidden="true" tabindex="-1"></a><span class="fu">### ...des Effekts</span></span>
<span id="cb49-313"><a href="#cb49-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-314"><a href="#cb49-314" aria-hidden="true" tabindex="-1"></a>Was ist der Effekt eines nichtparametrischen Tests? Oder andersherum, wenn wir eine Rangtransformation durchführen, dann verwandeln wir ja alle Zahlen mit einer Einheit in einen einheitslosen Rang. Damit rechnen wir also auf den Rängen des Messwertes. Wenn wir aber nun einheitslose Ränge haben, dann haben wir auch nur einheitslose Rangdifferenzen. Dazu kommt je mehr Beobachtungen desto mehr Ränge desto größer die Rangdifferenzen. Wir haben zwar dann die Möglichkeit wieder eine Art Cohen<span class="sc">\`</span>s d oder eben r zu berechnen, aber hat dieser Wert wieder keien Einheit und ist auch schwer zu interpretieren. Es gibt wieder viele Arten dies zu tun und je nach Quelle haben wir dann ein anderes Adjektiv wie "kleiner", "mittler" oder "starker" Effekt. Solche Worte können wir dann aber nicht mit Kosten/Nutzenrechnungen verbinden. Am Ende hat eben dann der nichtparametrische U-Test kein Effektmaß mit dem sich praktisch und relevant arbeiten lässt.</span>
<span id="cb49-315"><a href="#cb49-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-316"><a href="#cb49-316" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb49-317"><a href="#cb49-317" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/personal_opinion.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb49-318"><a href="#cb49-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-319"><a href="#cb49-319" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Es gibt Gründe die Nichtparametrik als den Ausweg für die Nichtnormalverteilung zu sehen. In gewissen Anwendungsfeldern mag das auch so stimmen. Wenn du wirklich nicht an einem Effektmaß interessiert bist und nur einen p-Wert brauchst, dann ist die Nichtparametrik eine Lösung. Heutzutage wollen wir aber auch immer wissen, ist der Effekt relevant? Und die Frage ohne ein Effektmaß zu beantworten sehe ich als unmöglich an." --- Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.*</span></span>
<span id="cb49-320"><a href="#cb49-320" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb49-321"><a href="#cb49-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-322"><a href="#cb49-322" aria-hidden="true" tabindex="-1"></a><span class="fu">## Die Lösung</span></span>
<span id="cb49-323"><a href="#cb49-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-324"><a href="#cb49-324" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Wilcoxon is (almost) a one-sample t-test on signed ranks</span><span class="co">](https://lindeloev.github.io/tests-as-linear/simulations/simulate_wilcoxon.html)</span></span>
<span id="cb49-325"><a href="#cb49-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-326"><a href="#cb49-326" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Nichtparametrik als Rangtransformation</span><span class="co">](https://lindeloev.github.io/tests-as-linear/#1_the_simplicity_underlying_common_tests)</span></span>
<span id="cb49-327"><a href="#cb49-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-328"><a href="#cb49-328" aria-hidden="true" tabindex="-1"></a>@zimmerman1993relative <span class="co">[</span><span class="ot">Relative Power of the Wilcoxon Test, the Friedman Test, and Repeated-Measures ANOVA on Ranks</span><span class="co">](https://www.proquest.com/docview/1299992501?pq-origsite=gscholar&amp;fromopenview=true&amp;sourcetype=Scholarly%20Journals&amp;imgSeq=1)</span></span>
<span id="cb49-329"><a href="#cb49-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-332"><a href="#cb49-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-333"><a href="#cb49-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb49-334"><a href="#cb49-334" aria-hidden="true" tabindex="-1"></a>p_t_u_tbl <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>), \(n_val){</span>
<span id="cb49-335"><a href="#cb49-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, \(...){</span>
<span id="cb49-336"><a href="#cb49-336" aria-hidden="true" tabindex="-1"></a>    sim_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(n_val, <span class="dv">5</span>, <span class="dv">2</span>), <span class="fu">rnorm</span>(n_val, <span class="dv">5</span>, <span class="dv">2</span>)),</span>
<span id="cb49-337"><a href="#cb49-337" aria-hidden="true" tabindex="-1"></a>                      <span class="at">x =</span> <span class="fu">gl</span>(<span class="dv">2</span>, n_val, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>)))</span>
<span id="cb49-338"><a href="#cb49-338" aria-hidden="true" tabindex="-1"></a>    wilcox_p <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(y <span class="sc">~</span> x, <span class="at">data =</span> sim_tbl)<span class="sc">$</span>p.value</span>
<span id="cb49-339"><a href="#cb49-339" aria-hidden="true" tabindex="-1"></a>    ttest_p <span class="ot">&lt;-</span> <span class="fu">t.test</span>(y <span class="sc">~</span> x, <span class="at">data =</span> sim_tbl)<span class="sc">$</span>p.value</span>
<span id="cb49-340"><a href="#cb49-340" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">n =</span> <span class="fu">as_factor</span>(n_val),</span>
<span id="cb49-341"><a href="#cb49-341" aria-hidden="true" tabindex="-1"></a>           <span class="at">wilcox =</span> wilcox_p,</span>
<span id="cb49-342"><a href="#cb49-342" aria-hidden="true" tabindex="-1"></a>           <span class="at">ttest =</span> ttest_p,</span>
<span id="cb49-343"><a href="#cb49-343" aria-hidden="true" tabindex="-1"></a>           <span class="at">dev =</span> ttest <span class="sc">-</span> wilcox)</span>
<span id="cb49-344"><a href="#cb49-344" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb49-345"><a href="#cb49-345" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.progress =</span> <span class="cn">TRUE</span>) </span>
<span id="cb49-346"><a href="#cb49-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-347"><a href="#cb49-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-348"><a href="#cb49-348" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(p_t_u_tbl, <span class="fu">aes</span>(<span class="at">x =</span> wilcox, <span class="at">y =</span> ttest, <span class="at">color =</span> n)) <span class="sc">+</span></span>
<span id="cb49-349"><a href="#cb49-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-350"><a href="#cb49-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb49-351"><a href="#cb49-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb49-352"><a href="#cb49-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb49-353"><a href="#cb49-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb49-354"><a href="#cb49-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.20</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.2</span>))</span>
<span id="cb49-355"><a href="#cb49-355" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-356"><a href="#cb49-356" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(p_t_u_tbl, <span class="fu">aes</span>(<span class="at">x =</span> wilcox, <span class="at">y =</span> dev, <span class="at">color =</span> n)) <span class="sc">+</span></span>
<span id="cb49-357"><a href="#cb49-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-358"><a href="#cb49-358" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point() +</span></span>
<span id="cb49-359"><a href="#cb49-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"line"</span>) </span>
<span id="cb49-360"><a href="#cb49-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-361"><a href="#cb49-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-362"><a href="#cb49-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-363"><a href="#cb49-363" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb49-364"><a href="#cb49-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-365"><a href="#cb49-365" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb49-366"><a href="#cb49-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-367"><a href="#cb49-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb49-368"><a href="#cb49-368" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb49-369"><a href="#cb49-369" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb49-370"><a href="#cb49-370" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, broom, tidyplots, rstatix,</span></span>
<span id="cb49-371"><a href="#cb49-371" aria-hidden="true" tabindex="-1"></a><span class="in">               readxl, coin, ggpubr, nparcomp,</span></span>
<span id="cb49-372"><a href="#cb49-372" aria-hidden="true" tabindex="-1"></a><span class="in">               conflicted)</span></span>
<span id="cb49-373"><a href="#cb49-373" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(rstatix::wilcox_test)</span></span>
<span id="cb49-374"><a href="#cb49-374" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb49-375"><a href="#cb49-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-376"><a href="#cb49-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-377"><a href="#cb49-377" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb49-378"><a href="#cb49-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-379"><a href="#cb49-379" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb49-380"><a href="#cb49-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-381"><a href="#cb49-381" aria-hidden="true" tabindex="-1"></a>In den folgendne Abschnitten brauchen wir dann zwei Datensätze. Der erste Datensatz beschreibt Hunde- und Katzenflöhe, die springen und deren Sprungweite dann gemessen wurde. Wir haben hier verschiedene Flöhe vorliegen, die nur einmal springen. Wir können aber auch den Fall haben, dass wir uns wiederholt einen Floh anschauen. Der zweite Datensatz betrachtet Hundeflöhe, die vor der Fütterung und nach der Fütterung gesprungen sind.</span>
<span id="cb49-382"><a href="#cb49-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-383"><a href="#cb49-383" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Unabhängige Messungen {.unnumbered .unlisted}</span></span>
<span id="cb49-384"><a href="#cb49-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-385"><a href="#cb49-385" aria-hidden="true" tabindex="-1"></a>Beginnen wir also mit unserem einfaktoriellen Datensatz mit zwei Gruppen. Wir haben hier die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> von Hunde- und Katzenflöhen gemessen. Unser Faktor ist hierbei die Flohart. Entweder ein Hundefloh oder eben ein Katzenfloh. Wir wollen jetzt wissen, ob sich die beiden Floharten hinsichtlich ihrer Sprungweite unterscheiden.</span>
<span id="cb49-386"><a href="#cb49-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-389"><a href="#cb49-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-390"><a href="#cb49-390" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-391"><a href="#cb49-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-392"><a href="#cb49-392" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/flea_dog_cat.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-393"><a href="#cb49-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb49-394"><a href="#cb49-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span>
<span id="cb49-395"><a href="#cb49-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-396"><a href="#cb49-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-397"><a href="#cb49-397" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle siehst du dann einmal einen Auszug aus den Daten der Sprungweiten für die beiden Floharten. Dabei ist dann die Spalte <span class="in">`animal`</span> unser Faktor über den wir den Gruppenvergleich für die Sprungweiten als Messwert rechnen wollen.</span>
<span id="cb49-398"><a href="#cb49-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-401"><a href="#cb49-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-402"><a href="#cb49-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb49-403"><a href="#cb49-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-404"><a href="#cb49-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-405"><a href="#cb49-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-1fac-table</span></span>
<span id="cb49-406"><a href="#cb49-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle der Sprungweiten in [cm] als Messwert $y$ von Hunde-, Katzen- und Fuchsflöhen. Der Datensatz ist einfaktoriell, da wir nur einen Faktor vorliegen haben."</span></span>
<span id="cb49-407"><a href="#cb49-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-408"><a href="#cb49-408" aria-hidden="true" tabindex="-1"></a>fac1_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/flea_dog_cat.xlsx"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-409"><a href="#cb49-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, jump_length) </span>
<span id="cb49-410"><a href="#cb49-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-411"><a href="#cb49-411" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb49-412"><a href="#cb49-412" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(fac1_raw_tbl)),</span>
<span id="cb49-413"><a href="#cb49-413" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(fac1_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb49-414"><a href="#cb49-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb49-415"><a href="#cb49-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-416"><a href="#cb49-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-417"><a href="#cb49-417" aria-hidden="true" tabindex="-1"></a>Dann wollen wir uns auch einmal die Daten visualisieren. Ich nutze dazu dann einmal den Boixplot sowie den Violinplot. Die Daten sehen einigermaßen normalverteilt aus, so dass wir hier auch einen t-Test rechnen könnten. Wie immer geht es hier auch um die Demonstration der Algorithmen, also nutzen wir hier auch diese Daten für den U-Test. Der U-Test funktioniert auch super auf noormalverteilten Daten.</span>
<span id="cb49-418"><a href="#cb49-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-421"><a href="#cb49-421" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-422"><a href="#cb49-422" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-423"><a href="#cb49-423" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb49-424"><a href="#cb49-424" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-425"><a href="#cb49-425" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-utest-jump</span></span>
<span id="cb49-426"><a href="#cb49-426" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb49-427"><a href="#cb49-427" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb49-428"><a href="#cb49-428" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb49-429"><a href="#cb49-429" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung der Sprungweiten in [cm] gruppiert nach Hunde- und Katzenflöhen. Die graue Raute stellt den entsprechnenden Mittelwert der Sprungweiten dar. **(A)** Einfaktorieller Boxplot. **(B)** Violinplot mit Dotplot. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb49-430"><a href="#cb49-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-431"><a href="#cb49-431" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb49-432"><a href="#cb49-432" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb49-433"><a href="#cb49-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-434"><a href="#cb49-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb49-435"><a href="#cb49-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb49-436"><a href="#cb49-436" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb49-437"><a href="#cb49-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb49-438"><a href="#cb49-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb49-439"><a href="#cb49-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb49-440"><a href="#cb49-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-441"><a href="#cb49-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-442"><a href="#cb49-442" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb49-443"><a href="#cb49-443" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb49-444"><a href="#cb49-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-445"><a href="#cb49-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violindot</span>(<span class="at">dots_size =</span> <span class="dv">7</span>, <span class="at">trim =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb49-446"><a href="#cb49-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, </span>
<span id="cb49-447"><a href="#cb49-447" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb49-448"><a href="#cb49-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flohart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb49-449"><a href="#cb49-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb49-450"><a href="#cb49-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() </span>
<span id="cb49-451"><a href="#cb49-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-452"><a href="#cb49-452" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span></span>
<span id="cb49-453"><a href="#cb49-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb49-454"><a href="#cb49-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb49-455"><a href="#cb49-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb49-456"><a href="#cb49-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-457"><a href="#cb49-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-458"><a href="#cb49-458" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Abhängige Messungen {.unnumbered .unlisted}</span></span>
<span id="cb49-459"><a href="#cb49-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-460"><a href="#cb49-460" aria-hidden="true" tabindex="-1"></a>Der U-Test erlaubt auch abhängige Daten zu analysieren. Das heißt wir haben die gleichen sieben Hundeflöhe wiederholt gemessen. Einmal haben wir einen Hundefloh gemessen bevor er was gegessen hat, also hungrig ist, und einmal nachdem der gleiche Floh sich satt gegessen hat. Daher haben wir hier abhängige oder verbundene Bebachtungen. Im folgenden einmal der Datensatz eingelesen im Wide-Format.</span>
<span id="cb49-461"><a href="#cb49-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-464"><a href="#cb49-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-465"><a href="#cb49-465" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-466"><a href="#cb49-466" aria-hidden="true" tabindex="-1"></a>paired_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/flea_dog_cat_repeated.xlsx"</span>) </span>
<span id="cb49-467"><a href="#cb49-467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-468"><a href="#cb49-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-469"><a href="#cb49-469" aria-hidden="true" tabindex="-1"></a>Wie du sehen kannst haben wir die sieben Flöhe wiederholt gemessen. Die Daten sind nicht im <span class="in">`tidy`</span>-Format, da nicht jede Zeile nur eine Messunfg für eine Beobachtung beinhaltet. Das ändern wir dann einmal gleich in Long-Format.</span>
<span id="cb49-470"><a href="#cb49-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-473"><a href="#cb49-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-474"><a href="#cb49-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-475"><a href="#cb49-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb49-476"><a href="#cb49-476" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle  der Sprunglängen [cm] von fünf Hundeflöhen zu zwei Zeitpunkten. Einmal wurde die Sprungweite mit den hungrigen Flöhen und einmal mit den gleichen satten Flöhen bestimmt."</span></span>
<span id="cb49-477"><a href="#cb49-477" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-data-ttest-paired-01</span></span>
<span id="cb49-478"><a href="#cb49-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-479"><a href="#cb49-479" aria-hidden="true" tabindex="-1"></a>paired_tbl <span class="sc">|&gt;</span> </span>
<span id="cb49-480"><a href="#cb49-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tt</span>(<span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">align =</span> <span class="st">"c"</span>, <span class="at">theme =</span> <span class="st">"striped"</span>)</span>
<span id="cb49-481"><a href="#cb49-481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-482"><a href="#cb49-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-483"><a href="#cb49-483" aria-hidden="true" tabindex="-1"></a>Dann hier nochmal die Long-Formatvariante mit der Funktion <span class="in">`pivot_longer()`</span>. Wir brauchen das Long-Format für die Auswertung in den unteren Abschnitten für das R Paket <span class="in">`{rstatix}`</span>.</span>
<span id="cb49-484"><a href="#cb49-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-487"><a href="#cb49-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-488"><a href="#cb49-488" aria-hidden="true" tabindex="-1"></a>paired_long_tbl <span class="ot">&lt;-</span> paired_tbl <span class="sc">|&gt;</span> </span>
<span id="cb49-489"><a href="#cb49-489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> hungrig<span class="sc">:</span>satt,</span>
<span id="cb49-490"><a href="#cb49-490" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb49-491"><a href="#cb49-491" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"trt"</span>) </span>
<span id="cb49-492"><a href="#cb49-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-493"><a href="#cb49-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-494"><a href="#cb49-494" aria-hidden="true" tabindex="-1"></a>Manchmal ist es schwer zu verstehen, was jetzt wiederholt oder gepaart heißen soll. Deshalb hier nochmal die Visualiserung der Daten für die beiden Sprünge vor und nach der Fütterung. Ich habe die Messungen, die zusammengehören mit einer Linie verbunden. Dazu dann auch noch die jeweiligen IDs der Flöhe ergänzt.</span>
<span id="cb49-495"><a href="#cb49-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-498"><a href="#cb49-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-499"><a href="#cb49-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-500"><a href="#cb49-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb49-501"><a href="#cb49-501" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb49-502"><a href="#cb49-502" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb49-503"><a href="#cb49-503" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb49-504"><a href="#cb49-504" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dotplot der Sprungweiten [cm] für Hundeflöhe in zwei verschiedenen Ernährungszuständen gemessen an zwei Zeitpunkten. Die Linien verbinden die Messung an dem gleichen Floh."</span></span>
<span id="cb49-505"><a href="#cb49-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-example-paired</span></span>
<span id="cb49-506"><a href="#cb49-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-507"><a href="#cb49-507" aria-hidden="true" tabindex="-1"></a>paired_tbl <span class="sc">|&gt;</span> </span>
<span id="cb49-508"><a href="#cb49-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> hungrig<span class="sc">:</span>satt,</span>
<span id="cb49-509"><a href="#cb49-509" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb49-510"><a href="#cb49-510" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"trt"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-511"><a href="#cb49-511" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(trt, jump_length, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb49-512"><a href="#cb49-512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-513"><a href="#cb49-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id), <span class="at">color =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb49-514"><a href="#cb49-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb49-515"><a href="#cb49-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb49-516"><a href="#cb49-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> id), <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="fl">0.05</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb49-517"><a href="#cb49-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb49-518"><a href="#cb49-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Ernährungszustand"</span>,</span>
<span id="cb49-519"><a href="#cb49-519" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>)</span>
<span id="cb49-520"><a href="#cb49-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-521"><a href="#cb49-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-522"><a href="#cb49-522" aria-hidden="true" tabindex="-1"></a><span class="fu">## Hypothesen</span></span>
<span id="cb49-523"><a href="#cb49-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-524"><a href="#cb49-524" aria-hidden="true" tabindex="-1"></a>::: callout-warning</span>
<span id="cb49-525"><a href="#cb49-525" aria-hidden="true" tabindex="-1"></a><span class="fu">## Achtung, bitte beachten!</span></span>
<span id="cb49-526"><a href="#cb49-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-527"><a href="#cb49-527" aria-hidden="true" tabindex="-1"></a>Die Wahl der Nullhypothese durch die Annahmen an die Verteilungsfromen der beiden zu vergleichenden Gruppen hat natürlich einen gewaltigen Einfluss auf die Interpretation des p-Wertes. Also wenn man es statistisch genau nimmt. Deshalb hier auch einmal die simpelste Prosavariante für Einsteiger.</span>
<span id="cb49-528"><a href="#cb49-528" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-529"><a href="#cb49-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-530"><a href="#cb49-530" aria-hidden="true" tabindex="-1"></a>Bitte lesen nochmal oben den Abschnitt zu dem Problem der Nullhypothese im U-Test nach. Je nachdem wie tief du jetzt hier einsteigen willst, habe ich dir mal die drei Varianten angebenen. Am Ende findest du die simpelste Prosavariante gar nicht so selten in Tutorien. Die fortgeschrittene Variante trifft es schon sehr gut. Die mathematische Formel mag dann mehr Fragen als Antworten liefern. Die praktische Interpretation der Nullhypothese eines U-Test bleibt mir aktuell noch verschlossen.</span>
<span id="cb49-531"><a href="#cb49-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-532"><a href="#cb49-532" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb49-533"><a href="#cb49-533" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simpelste Prosa</span></span>
<span id="cb49-534"><a href="#cb49-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-535"><a href="#cb49-535" aria-hidden="true" tabindex="-1"></a>Wenn wir nur den p-Wert betrachten, dann können wir auch folgende simple Aussage über den U-Test machen. Das ist jetzt genau so wahr wie falsch aber hilfreich.</span>
<span id="cb49-536"><a href="#cb49-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-537"><a href="#cb49-537" aria-hidden="true" tabindex="-1"></a>$H_0:$ *Die beiden Gruppen sind gleich in ihrem Messwert.*</span>
<span id="cb49-538"><a href="#cb49-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-539"><a href="#cb49-539" aria-hidden="true" tabindex="-1"></a>$H_A:$ *Es liegt ein Unterschied im Messwert zwischen den Gruppen vor.*</span>
<span id="cb49-540"><a href="#cb49-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-541"><a href="#cb49-541" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fortgeschrittene Prosa</span></span>
<span id="cb49-542"><a href="#cb49-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-543"><a href="#cb49-543" aria-hidden="true" tabindex="-1"></a>Hier dann die richtige Interpretation der Nullhypothese. Obwohl ich mir sicher bin, dass die praktische Relevanz der Nullhypothese hier auch nicht sehr viel klarer wird.</span>
<span id="cb49-544"><a href="#cb49-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-545"><a href="#cb49-545" aria-hidden="true" tabindex="-1"></a>$H_0:$ *Es ist gleich wahrscheinlich, dass ein zufällig aus der einen Population ausgewählter Wert größer oder kleiner ist als ein zufällig ausgewählter Wert aus der anderen Population*</span>
<span id="cb49-546"><a href="#cb49-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-547"><a href="#cb49-547" aria-hidden="true" tabindex="-1"></a>$H_A:$ *Es ist* ***nicht*** *gleich wahrscheinlich, dass ein zufällig aus der einen Population ausgewählter Wert größer oder kleiner ist als ein zufällig ausgewählter Wert aus der anderen Population*</span>
<span id="cb49-548"><a href="#cb49-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-549"><a href="#cb49-549" aria-hidden="true" tabindex="-1"></a><span class="fu">## Formel</span></span>
<span id="cb49-550"><a href="#cb49-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-551"><a href="#cb49-551" aria-hidden="true" tabindex="-1"></a>Wir vergleichen hier zwei Populationen oder Gruppen $X$ und $Y$ miteinander. Die Formel repräsentiert die fortgeschrittene Prosa in dem vorherigen Tab. Bitte nochmal oben nachschauen, wenn du die Nullhypothese verstehen willst.</span>
<span id="cb49-552"><a href="#cb49-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-553"><a href="#cb49-553" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-554"><a href="#cb49-554" aria-hidden="true" tabindex="-1"></a>H_0:  Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y) = 0.5</span>
<span id="cb49-555"><a href="#cb49-555" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-556"><a href="#cb49-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-557"><a href="#cb49-557" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-558"><a href="#cb49-558" aria-hidden="true" tabindex="-1"></a>H_A:  Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y) \neq 0.5</span>
<span id="cb49-559"><a href="#cb49-559" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-560"><a href="#cb49-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-561"><a href="#cb49-561" aria-hidden="true" tabindex="-1"></a>In dem R Paket <span class="in">`{nparcomp}`</span> bezeichnen wir den Wert für $Pr(X&lt;Y) + \cfrac{1}{2} Pr(X = Y)$ auch als relativen Effekt. Faktisch ist es der Anteil an allen Wertepaaren, die kleiner oder gleich in der einen Gruppe $X$ sind als in der anderen Gruppe $Y$.</span>
<span id="cb49-562"><a href="#cb49-562" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-563"><a href="#cb49-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-564"><a href="#cb49-564" aria-hidden="true" tabindex="-1"></a><span class="fu">## Der U-Test</span></span>
<span id="cb49-565"><a href="#cb49-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-566"><a href="#cb49-566" aria-hidden="true" tabindex="-1"></a>Dann kommen wir zu der Implementierung des U-Tests in R. Wie immer gibt es reiche Auswahl an R Paketen, die für dich den U-Test auf unabhängigen wie auch abhängigen Daten rechnen. Wenn ich die Wahl habe, dann nehme ich die Funktionen aus dem R Paket <span class="in">`{rstatix}`</span>. Das Paket hat eigentlich alles was man braucht um einen U-Test zu rechnen. Intern basiert das Paket auf dem Paket <span class="in">`{coin}`</span> was von der Anwendung etwas veraltet ist. Ein neueres Paket ist die Implementierung in dem R Paket <span class="in">`{nparcomp}`</span>. Hier wirst du mit viel Informationen versorgt aber dann inhaltlich etwas alleine gelassen, was die Interpretation angeht. Wir schauen aber auch hier einmal rein.</span>
<span id="cb49-567"><a href="#cb49-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-568"><a href="#cb49-568" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... mit unabhängigen Beobachtungen</span></span>
<span id="cb49-569"><a href="#cb49-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-570"><a href="#cb49-570" aria-hidden="true" tabindex="-1"></a>Am häufigsten wirst du wohl den U-Test mit zwei Gruppen rechnen, die voneinander unabhängig sind. Das heißt, du misst deinen Messwert $y$ in zwei Gruppen und jede Messung ist unabhängig von der anderen. Wir haben so einen Fall in unserem Datensatz zu den Sprungweiten der Hunde- und Katzenflöhe vorleigen. Wir haben sieben Hundeflöhe und sieben Katzenflöhe einmal gemessen und die Sprungweiten in dem Datensatz <span class="in">`fac1_tbl`</span> gespeichert. Wir schauen uns für die unabhängigen Beobachtungen auch einmal die theoretische Berechung an, bevor wir uns dann in den anderen Tabs mit der Implementierung in R beschäftigen.</span>
<span id="cb49-571"><a href="#cb49-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-572"><a href="#cb49-572" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb49-573"><a href="#cb49-573" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theorie</span></span>
<span id="cb49-574"><a href="#cb49-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-575"><a href="#cb49-575" aria-hidden="true" tabindex="-1"></a>Der Wilcoxon-Mann-Whitney-Test berechnet die U Teststatistik auf den Rängend der Daten. Es gibt genau soviele Ränge wie es Beobachtungen im Datensatz gibt. Wir haben vierzehn Beobachtungen in unseren Daten zu der Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> von den Hunde- und Katzenflöhen. Somit müssen wir auch vierzehn Ränge vergeben. Die @tbl-utest-rank zeigt das Vorgehen der Rangvergabe. Wir sortieren als erstes das $y$ aufsteigend. In unserem Fall ist das $y$ die Sprunglänge. Dann vergeben wir die Ränge jweiles zugehörig zu der Position der Sprunglänge und der Tierart. Abschließend addieren wir die Rangsummmen für <span class="in">`cat`</span> und <span class="in">`dog`</span> zu den Rangsummen $R_{cat}$ und $R_{dog}$.</span>
<span id="cb49-576"><a href="#cb49-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-577"><a href="#cb49-577" aria-hidden="true" tabindex="-1"></a>| Rank | animal | jump_length  |  Ränge <span class="in">`cat`</span>   |  Ränge <span class="in">`dog`</span>   |</span>
<span id="cb49-578"><a href="#cb49-578" aria-hidden="true" tabindex="-1"></a>|:----:|:------:|:------------:|:--------------:|:--------------:|</span>
<span id="cb49-579"><a href="#cb49-579" aria-hidden="true" tabindex="-1"></a>|  1   |  cat   |     2.2      |       1        |                |</span>
<span id="cb49-580"><a href="#cb49-580" aria-hidden="true" tabindex="-1"></a>|  2   |  cat   |     3.2      |       2        |                |</span>
<span id="cb49-581"><a href="#cb49-581" aria-hidden="true" tabindex="-1"></a>|  3   |  cat   |     4.1      |       3        |                |</span>
<span id="cb49-582"><a href="#cb49-582" aria-hidden="true" tabindex="-1"></a>|  4   |  cat   |     4.3      |       4        |                |</span>
<span id="cb49-583"><a href="#cb49-583" aria-hidden="true" tabindex="-1"></a>|  5   |  cat   |     5.4      |       5        |                |</span>
<span id="cb49-584"><a href="#cb49-584" aria-hidden="true" tabindex="-1"></a>|  6   |  dog   |     5.6      |                |       6        |</span>
<span id="cb49-585"><a href="#cb49-585" aria-hidden="true" tabindex="-1"></a>|  7   |  dog   |     5.7      |                |       7        |</span>
<span id="cb49-586"><a href="#cb49-586" aria-hidden="true" tabindex="-1"></a>|  8   |  cat   |     6.1      |       8        |                |</span>
<span id="cb49-587"><a href="#cb49-587" aria-hidden="true" tabindex="-1"></a>|  9   |  dog   |     7.6      |                |       9        |</span>
<span id="cb49-588"><a href="#cb49-588" aria-hidden="true" tabindex="-1"></a>|  10  |  cat   |     7.9      |       10       |                |</span>
<span id="cb49-589"><a href="#cb49-589" aria-hidden="true" tabindex="-1"></a>|  11  |  dog   |     8.2      |                |       11       |</span>
<span id="cb49-590"><a href="#cb49-590" aria-hidden="true" tabindex="-1"></a>|  12  |  dog   |     8.9      |                |       12       |</span>
<span id="cb49-591"><a href="#cb49-591" aria-hidden="true" tabindex="-1"></a>|  13  |  dog   |     9.1      |                |       13       |</span>
<span id="cb49-592"><a href="#cb49-592" aria-hidden="true" tabindex="-1"></a>|  14  |  dog   |     11.8     |                |       14       |</span>
<span id="cb49-593"><a href="#cb49-593" aria-hidden="true" tabindex="-1"></a>|      |        |  Rangsummen  | $R_{cat} = 33$ | $R_{dog} = 72$ |</span>
<span id="cb49-594"><a href="#cb49-594" aria-hidden="true" tabindex="-1"></a>|      |        | Gruppengröße |       7        |       7        |</span>
<span id="cb49-595"><a href="#cb49-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-596"><a href="#cb49-596" aria-hidden="true" tabindex="-1"></a>: Datentablle absteigend sortiert nach der Sprunglänge in <span class="sc">\[</span>cm<span class="sc">\]</span>. Die Level <span class="in">`cat`</span> und <span class="in">`dog`</span> haben jeweils die entsprechenden Ränge zugeordnet bekommen und die Rangsummen wurden berechnet {#tbl-utest-rank}</span>
<span id="cb49-597"><a href="#cb49-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-598"><a href="#cb49-598" aria-hidden="true" tabindex="-1"></a>Die Formel für die U Statistik sieht ein wenig wild aus, aber wir können eigentlich relativ einfach alle Zahlen einsetzen. Dann musst du dich etwas konzentrieren bei der Rechnung.</span>
<span id="cb49-599"><a href="#cb49-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-600"><a href="#cb49-600" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-601"><a href="#cb49-601" aria-hidden="true" tabindex="-1"></a>U_{D} = n_1n_2 + \cfrac{n_1(n_1+1)}{2}-R_1</span>
<span id="cb49-602"><a href="#cb49-602" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-603"><a href="#cb49-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-604"><a href="#cb49-604" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb49-605"><a href="#cb49-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-606"><a href="#cb49-606" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$R_1$ der *größeren* der beiden Rangsummen,</span>
<span id="cb49-607"><a href="#cb49-607" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$n_1$ die Fallzahl der *größeren* der beiden Rangsummen</span>
<span id="cb49-608"><a href="#cb49-608" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$n_2$ die Fallzahl der *kleineren* der beiden Rangsummen</span>
<span id="cb49-609"><a href="#cb49-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-610"><a href="#cb49-610" aria-hidden="true" tabindex="-1"></a>Wir setzen nun die Zahlen ein. Da wir ein balanciertes Design vorliegen haben sind die Fallzahlen $n_1 = n_2 = 7$ gleich. Wir müssen nur schauen, dass wir mit $R_1$ die passende Rangsumme wählen. In unserem Fall ist $R_1 = R_{dog} = 72$.</span>
<span id="cb49-611"><a href="#cb49-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-612"><a href="#cb49-612" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-613"><a href="#cb49-613" aria-hidden="true" tabindex="-1"></a>U_{D} = 7 \cdot 7 + \cfrac{7(7+1)}{2}-72 = 5</span>
<span id="cb49-614"><a href="#cb49-614" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-615"><a href="#cb49-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-616"><a href="#cb49-616" aria-hidden="true" tabindex="-1"></a>Der kritische Wert für die U Statistik ist $U_{\alpha = 5\%} = 8$ für $n_1 = 7$ und $n_2 = 7$. Bei der Entscheidung mit der berechneten Teststatistik $U_{D}$ gilt, wenn $U_{D} \leq U_{\alpha = 5\%}$ wird die Nullhypothese (H$_0$) abgelehnt. Da in unserem Fall das $U_{D}$ mit $5$ kleiner ist als das $U_{\alpha = 5\%} = 8$ können wir die Nullhypothese ablehnen. Wir haben ein signifkianten Unterschied in den Medianen zwischen den beiden Tierarten im Bezug auf die Sprungweite in <span class="sc">\[</span>cm<span class="sc">\]</span> von Flöhen.</span>
<span id="cb49-617"><a href="#cb49-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-618"><a href="#cb49-618" aria-hidden="true" tabindex="-1"></a>Bei grosser Stichprobe, wenn $n_1 + n_2 &gt; 30$ ist, können wir die U Statistik auch standariseren und damit in den z-Wert transformieren.</span>
<span id="cb49-619"><a href="#cb49-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-620"><a href="#cb49-620" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-621"><a href="#cb49-621" aria-hidden="true" tabindex="-1"></a>z_{D} = \cfrac{U_{D} - \bar{U}}{s_U} = \cfrac{U_{D} - \cfrac{n_1 \cdot n_2}{2}}{\sqrt{\cfrac{n_1 \cdot n_2 (n_1 + n_2 +1)}{12}}}</span>
<span id="cb49-622"><a href="#cb49-622" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-623"><a href="#cb49-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-624"><a href="#cb49-624" aria-hidden="true" tabindex="-1"></a>mit</span>
<span id="cb49-625"><a href="#cb49-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-626"><a href="#cb49-626" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\bar{U}$ dem Mittelwert der U-Verteilung ohne Unterschied zwischen den Gruppen</span>
<span id="cb49-627"><a href="#cb49-627" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$s_U$ Standardfehler des U-Wertes</span>
<span id="cb49-628"><a href="#cb49-628" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$n_1$ Stichprobengrösse der Gruppe mit der grösseren Rangsumme</span>
<span id="cb49-629"><a href="#cb49-629" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$n_2$ Stichprobengrösse der Gruppe mit der kleineren Rangsumme</span>
<span id="cb49-630"><a href="#cb49-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-631"><a href="#cb49-631" aria-hidden="true" tabindex="-1"></a>Wir setzen dafür ebenfalls die berechnete U Statistik ein und müssen dann wieder konzentriert rechnen.</span>
<span id="cb49-632"><a href="#cb49-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-633"><a href="#cb49-633" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-634"><a href="#cb49-634" aria-hidden="true" tabindex="-1"></a>z_{D} = \cfrac{5 - \cfrac{7 \cdot 7}{2}}{\sqrt{\cfrac{7 \cdot 7 (7 + 7 +1)}{12}}} = \cfrac{-19.5}{7.83} = |-2.46|</span>
<span id="cb49-635"><a href="#cb49-635" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb49-636"><a href="#cb49-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-637"><a href="#cb49-637" aria-hidden="true" tabindex="-1"></a>Der kritische Wert für die z-Statistik ist $z_{\alpha = 5\%} = 1.96$. Bei der Entscheidung mit der berechneten Teststatistik $z_{D}$ gilt, wenn $z_{D} \geq z_{\alpha = 5\%}$ wird die Nullhypothese (H$_0$) abgelehnt. Wir haben eine berechnete z Statistik von $z_{D} = 2.46$. Damit ist $z_{D}$ größer als $z_{\alpha = 5\%} = 1.96$ und wir können die Nullhypothese ablehnen. Wir haben einen signifkanten Unterschied zwischen den Medianen der beiden Floharten im Bezug auf die Sprunglänge in <span class="sc">\[</span>cm<span class="sc">\]</span>.</span>
<span id="cb49-638"><a href="#cb49-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-639"><a href="#cb49-639" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{stats}`</span></span>
<span id="cb49-640"><a href="#cb49-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-641"><a href="#cb49-641" aria-hidden="true" tabindex="-1"></a>Die Standardimplementierung in R ist die Funktion <span class="in">`wilxoc.test()`</span>. Leider kann der <span class="in">`wilxoc.test()`</span> nicht mit Bindungen in den Daten umgehen. Daher würde ich die Funktion nicht empfehlen, da du im Zweifel dann nochmal die Funktion aus <span class="in">`{coin}`</span> anwenden musst. Dann hast du doppelte Arbeit. Wir haben hier aber keien Bindungen in den Daten vorliegen.</span>
<span id="cb49-642"><a href="#cb49-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-645"><a href="#cb49-645" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-646"><a href="#cb49-646" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, </span>
<span id="cb49-647"><a href="#cb49-647" aria-hidden="true" tabindex="-1"></a>            <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-648"><a href="#cb49-648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-649"><a href="#cb49-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-650"><a href="#cb49-650" aria-hidden="true" tabindex="-1"></a>Der U-Test liefert uns ein signifikantes Ergebnis, da der p-Wert kleiner ist als das Signifikanzniveau $\alpha$ gleich 5%. Wir lehnen die Nullhypothese ab. Die Sprungweiten unterscheiden sich zwischen den Hunde- und Katzenflöhen.</span>
<span id="cb49-651"><a href="#cb49-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-652"><a href="#cb49-652" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{coin}`</span></span>
<span id="cb49-653"><a href="#cb49-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-654"><a href="#cb49-654" aria-hidden="true" tabindex="-1"></a>Ich muss jetzt gleich die Funktion <span class="in">`wilcox_test()`</span> aus dem R Paket <span class="in">`{coin}`</span> einmal explizit laden, da die Funktion in <span class="in">`{rstatix}`</span> genauso heißt. Später musst du das natürlich nicht so machen. Wir können uns in der Funktion <span class="in">`wilcox_test()`</span> auch die 95% Konfidenzintervalle wiedergeben lassen. Wir erhalten hier ein 95% Konfidenzintervall für die möglichen Verschiebung $a$ in den Messwerten. Aber Achtung, dann interpretieren wir den U-Test als Mediantest, was spezielle Anforderungen an die Verteilungen der beiden Gruppen hat. Mehr dazu in dem obigen Abschnitt zu den Problemen der Hypothesen.</span>
<span id="cb49-655"><a href="#cb49-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-658"><a href="#cb49-658" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-659"><a href="#cb49-659" aria-hidden="true" tabindex="-1"></a>coin<span class="sc">::</span><span class="fu">wilcox_test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl, </span>
<span id="cb49-660"><a href="#cb49-660" aria-hidden="true" tabindex="-1"></a>                  <span class="at">conf.int =</span> <span class="cn">TRUE</span>) </span>
<span id="cb49-661"><a href="#cb49-661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-662"><a href="#cb49-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-663"><a href="#cb49-663" aria-hidden="true" tabindex="-1"></a>Der U-Test liefert uns ein signifikantes Ergebnis, da der p-Wert kleiner ist als das Signifikanzniveau $\alpha$ gleich 5%. Wir lehnen die Nullhypothese ab. Die Sprungweiten unterscheiden sich zwischen den Hunde- und Katzenflöhen.</span>
<span id="cb49-664"><a href="#cb49-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-665"><a href="#cb49-665" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{rstatix}`</span></span>
<span id="cb49-666"><a href="#cb49-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-667"><a href="#cb49-667" aria-hidden="true" tabindex="-1"></a>Wir können den <span class="co">[</span><span class="ot">Wilcoxon Test in R</span><span class="co">](https://www.datanovia.com/en/lessons/wilcoxon-test-in-r/)</span> auch mit der Funktion <span class="in">`wilcox_test()`</span> aus dem R Paket <span class="in">`{rstatix}`</span> rechnen. Wir verlieren hier aber die Möglichkeit das 95% Konfidenzintervall berechnen zu können. Ansonsten ist die Funktion nichts anderes als der Aufruf der gleichnamigen Funktion in <span class="in">`{coin}`</span>. Wir erhalten als Wiedergabe eine praktische Datentabelle und ich habe mal etwas vorgefiltert.</span>
<span id="cb49-668"><a href="#cb49-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-671"><a href="#cb49-671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-672"><a href="#cb49-672" aria-hidden="true" tabindex="-1"></a>rstatix<span class="sc">::</span><span class="fu">wilcox_test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb49-673"><a href="#cb49-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, p)</span>
<span id="cb49-674"><a href="#cb49-674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-675"><a href="#cb49-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-676"><a href="#cb49-676" aria-hidden="true" tabindex="-1"></a>Der U-Test liefert uns ein signifikantes Ergebnis, da der p-Wert kleiner ist als das Signifikanzniveau $\alpha$ gleich 5%. Wir lehnen die Nullhypothese ab. Die Sprungweiten unterscheiden sich zwischen den Hunde- und Katzenflöhen.</span>
<span id="cb49-677"><a href="#cb49-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-678"><a href="#cb49-678" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{nparcomp}`</span></span>
<span id="cb49-679"><a href="#cb49-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-680"><a href="#cb49-680" aria-hidden="true" tabindex="-1"></a>Als letztes möchte ich noch die neuste Implementierung der Nichtparametrik mit dem R Paket <span class="in">`{nparcomp}`</span> vorstellen. Wir haben hier die Implementierung des U-Tests in der Funktion <span class="in">`npar.t.test()`</span>. Interessanterweise steht hier schon der t-Test mit im Namen. Es handelt sich hier um die Implementierung des nichtparametrischen t-Tests. Oder sehr vereinfacht ausgedrückt, die Anwendung des t-Tests auf rangtransformierte Messwerte. Leider hat die Funktion die unangenehme Eigenschaften alles möglich wiederzugeben, auch wenn man nur den p-Wert braucht. Daher hier dann mehr Code, damit die Funktion ruhig ist.</span>
<span id="cb49-681"><a href="#cb49-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-684"><a href="#cb49-684" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-685"><a href="#cb49-685" aria-hidden="true" tabindex="-1"></a>npar_obj <span class="ot">&lt;-</span> <span class="fu">npar.t.test</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> fac1_tbl,</span>
<span id="cb49-686"><a href="#cb49-686" aria-hidden="true" tabindex="-1"></a>                        <span class="at">info =</span> <span class="cn">TRUE</span>) </span>
<span id="cb49-687"><a href="#cb49-687" aria-hidden="true" tabindex="-1"></a>npar_obj<span class="sc">$</span>Analysis</span>
<span id="cb49-688"><a href="#cb49-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-689"><a href="#cb49-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-690"><a href="#cb49-690" aria-hidden="true" tabindex="-1"></a>Der U-Test liefert uns ein signifikantes Ergebnis, da der p-Wert kleiner ist als das Signifikanzniveau $\alpha$ gleich 5%. Wir lehnen die Nullhypothese ab. Die Sprungweiten unterscheiden sich zwischen den Hunde- und Katzenflöhen.</span>
<span id="cb49-691"><a href="#cb49-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-692"><a href="#cb49-692" aria-hidden="true" tabindex="-1"></a>Darüber hinaus erhalten wir auch als Effektschätzer die Wahrscheinlichkeit $Pr(dog, cat)$ als <span class="in">`p(dog, cat)`</span> wiedergeben. Wenn wir eine Wahrscheinlichkeit von $0.5$ vorliegen haben, dann gilt die Nullhypothese. Hier haben wir einen Wert von $0.102$ und damit springen die Hundeflöhe <span class="in">`a`</span> weiter als die Katzenflöhe <span class="in">`b`</span>. Die Sprungweiten sind bei den Hunden größer als bei den Katzen, da <span class="in">`p(dog, cat)`</span> kleiner ist als <span class="in">`1/2`</span>. Was wir auch sagen können ist, dass nur in 10.2% der Wertepaare aller Sprungweiten der Hunde- und Katzenflöhe, die Hunde kürzer springen. Mit Wertepaaren meine ich, dass wir jeden Wert der Sprungweite der Hundeflöhe mit jedem Wert der Katzenflöhe vergleichen. Wir wissen aber nicht um wie viel kürzer in einer wie auch immer gearteten Einheit. Ohne handfeste biologisch definierte Relevanz auf der Sprungweite hat dann das 95% Konfidenzintervall auch keine direkte Bedeutung.</span>
<span id="cb49-693"><a href="#cb49-693" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-694"><a href="#cb49-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-695"><a href="#cb49-695" aria-hidden="true" tabindex="-1"></a>Wie du sehen kannst kommt bei allen Implementierungen des U-Tests im Prinzip das gleiche raus. Der U-Test liefert uns ein signifikantes Ergebnis, da der p-Wert kleiner ist als das Signifikanzniveau $\alpha$ gleich 5%. Wir haben nur leichte Fluktuationen im p-Wert durch die Art des Algorithmus hinter dem U-Test des jeweiligen Pakets. Am Ende unterscheiden sich die Sprungweiten zwischen den Hunde- und Katzenflöhen. Jetzt bleibt noch die Frage, wie groß der Effekt ist.</span>
<span id="cb49-696"><a href="#cb49-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-697"><a href="#cb49-697" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Effektschätzer {.unnumbered .unlisted}</span></span>
<span id="cb49-698"><a href="#cb49-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-699"><a href="#cb49-699" aria-hidden="true" tabindex="-1"></a>Als Effektschätzer nutzen wir den rangbiserialer Korrelationskoeffizient $r$. Mehr dazu auch in der Veröffentlichung von @tomczak2014need. Wir nutzen hier die Implementierung in <span class="in">`{rstatix}`</span> mit der Funktion <span class="in">`wilcox_effsize()`</span>. Praktischerweise erhalten wir dann auch gleich die Interpretation mit angegeben. Dann können wir die Abschätzung dann auch gleich mit übernehmen.</span>
<span id="cb49-700"><a href="#cb49-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-703"><a href="#cb49-703" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-704"><a href="#cb49-704" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb49-705"><a href="#cb49-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox_effsize</span>(jump_length <span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb49-706"><a href="#cb49-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(effsize, magnitude)</span>
<span id="cb49-707"><a href="#cb49-707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-708"><a href="#cb49-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-709"><a href="#cb49-709" aria-hidden="true" tabindex="-1"></a>Leider kannst du mit dem Wert von $0.66$ nicht weiterrechnen. Der $r$-Wert ist einheitlos und kann nicht in eine Kosten/Nutzenrechnung überführt werden. Daher hast du nur die Information, dass der Effekt zwischen den Sprungweiten der Hunde- un Katzenflöhe groß ist.</span>
<span id="cb49-710"><a href="#cb49-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-711"><a href="#cb49-711" aria-hidden="true" tabindex="-1"></a>Bitte nutze die Verschiebung der Mediane nur als Effektschätzer, wenn du dir sicher bist, dass die beiden Verteilungsformen der Gruppen gleich sind und Varianhomogenität zwischen deinen Gruppen vorliegt. Ansonsten ist die Medianverschiebung aus dem R Paket <span class="in">`{coin}`</span> kein äquivalenter Effektschätzer.</span>
<span id="cb49-712"><a href="#cb49-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-713"><a href="#cb49-713" aria-hidden="true" tabindex="-1"></a>Wir können natürlich auch als Effekctschätzer den relativen Effekt $p(a,b)$ händisch berechnen, wenn wir nicht das R Paket <span class="in">`{nparcomp}`</span> nutzen wollen. Aber auch hier stellt sich die Frage, was wir mit dem Wissen machen welcher prozentualer Anteil der Messwerte in der einen Gruppe kleiner oder gleich als in der anderen Gruppe ist. Wir wissen ja am Ende wiederum nicht um wieviel kleiner. Eine Transformation in Ränge hat eben dann auch Nachteile.</span>
<span id="cb49-714"><a href="#cb49-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-715"><a href="#cb49-715" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parametrische Lösung: Der t-Test {.unnumbered .unlisted}</span></span>
<span id="cb49-716"><a href="#cb49-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-719"><a href="#cb49-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-720"><a href="#cb49-720" aria-hidden="true" tabindex="-1"></a>fac1_tbl <span class="sc">|&gt;</span> </span>
<span id="cb49-721"><a href="#cb49-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ranked_jump_length =</span> <span class="fu">rank</span>(jump_length)) <span class="sc">|&gt;</span> </span>
<span id="cb49-722"><a href="#cb49-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(ranked_jump_length <span class="sc">~</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb49-723"><a href="#cb49-723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, statistic, p)</span>
<span id="cb49-724"><a href="#cb49-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-725"><a href="#cb49-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-726"><a href="#cb49-726" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... mit abhängigen Beobachtungen</span></span>
<span id="cb49-727"><a href="#cb49-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-728"><a href="#cb49-728" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb49-729"><a href="#cb49-729" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{stats}`</span></span>
<span id="cb49-730"><a href="#cb49-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-731"><a href="#cb49-731" aria-hidden="true" tabindex="-1"></a><span class="in">`wilxoc.test()`</span></span>
<span id="cb49-732"><a href="#cb49-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-735"><a href="#cb49-735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-736"><a href="#cb49-736" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(paired_tbl<span class="sc">$</span>hungrig, paired_tbl<span class="sc">$</span>satt, <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb49-737"><a href="#cb49-737" aria-hidden="true" tabindex="-1"></a>            <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-738"><a href="#cb49-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-739"><a href="#cb49-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-740"><a href="#cb49-740" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{coin}`</span></span>
<span id="cb49-741"><a href="#cb49-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-742"><a href="#cb49-742" aria-hidden="true" tabindex="-1"></a><span class="in">`wilcox_test()`</span></span>
<span id="cb49-743"><a href="#cb49-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-746"><a href="#cb49-746" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-747"><a href="#cb49-747" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcoxsign_test</span>(paired_tbl<span class="sc">$</span>hungrig <span class="sc">~</span> paired_tbl<span class="sc">$</span>satt, </span>
<span id="cb49-748"><a href="#cb49-748" aria-hidden="true" tabindex="-1"></a>                <span class="at">paired =</span> <span class="cn">TRUE</span>) </span>
<span id="cb49-749"><a href="#cb49-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-750"><a href="#cb49-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-751"><a href="#cb49-751" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{rstatix}`</span></span>
<span id="cb49-752"><a href="#cb49-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-753"><a href="#cb49-753" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Wilcoxon Test in R</span><span class="co">](https://www.datanovia.com/en/lessons/wilcoxon-test-in-r/)</span></span>
<span id="cb49-754"><a href="#cb49-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-755"><a href="#cb49-755" aria-hidden="true" tabindex="-1"></a><span class="in">`wilcox_test()`</span></span>
<span id="cb49-756"><a href="#cb49-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-759"><a href="#cb49-759" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-760"><a href="#cb49-760" aria-hidden="true" tabindex="-1"></a>rstatix<span class="sc">::</span><span class="fu">wilcox_test</span>(jump_length <span class="sc">~</span> trt, <span class="at">data =</span> paired_long_tbl, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-761"><a href="#cb49-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, p)</span>
<span id="cb49-762"><a href="#cb49-762" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-763"><a href="#cb49-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-764"><a href="#cb49-764" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{nparcomp}`</span></span>
<span id="cb49-765"><a href="#cb49-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-766"><a href="#cb49-766" aria-hidden="true" tabindex="-1"></a><span class="in">`npar.t.test.paired()`</span></span>
<span id="cb49-767"><a href="#cb49-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-770"><a href="#cb49-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-771"><a href="#cb49-771" aria-hidden="true" tabindex="-1"></a>npar_obj <span class="ot">&lt;-</span> <span class="fu">npar.t.test.paired</span>(jump_length <span class="sc">~</span> trt, <span class="at">data =</span> paired_long_tbl,</span>
<span id="cb49-772"><a href="#cb49-772" aria-hidden="true" tabindex="-1"></a>                               <span class="at">plot.simci =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-773"><a href="#cb49-773" aria-hidden="true" tabindex="-1"></a>npar_obj<span class="sc">$</span>Analysis</span>
<span id="cb49-774"><a href="#cb49-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-775"><a href="#cb49-775" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-776"><a href="#cb49-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-777"><a href="#cb49-777" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Parametrische Lösung: Der paired t-Test {.unnumbered .unlisted}</span></span>
<span id="cb49-778"><a href="#cb49-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-781"><a href="#cb49-781" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-782"><a href="#cb49-782" aria-hidden="true" tabindex="-1"></a>paired_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb49-783"><a href="#cb49-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ranked_jump_length =</span> <span class="fu">rank</span>(jump_length)) <span class="sc">|&gt;</span> </span>
<span id="cb49-784"><a href="#cb49-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t_test</span>(ranked_jump_length <span class="sc">~</span> trt, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-785"><a href="#cb49-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group1, group2, statistic, p)</span>
<span id="cb49-786"><a href="#cb49-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-787"><a href="#cb49-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-788"><a href="#cb49-788" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ergebnisse mit `{tidyplots}`</span></span>
<span id="cb49-789"><a href="#cb49-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-790"><a href="#cb49-790" aria-hidden="true" tabindex="-1"></a>Häufig wollen wir nicht nur den p-Wert aus einem U-Test berichten sondern natürlich auch gleich die richtige Abbildung dazu haben. Hier gibt es mit dem R Paket <span class="in">`{tidyplots}`</span> eine gute Möglichkeit. Das R Paket verbindet dabei die Funktionalität von <span class="in">`{ggplot}`</span> und <span class="in">`{ggpubr}`</span>. Dabei bleibt es aber dann sehr einfahc zu bedienen. Insbesondere in dem Fall, dass du nur zwei Gruppen in einem U-Test miteinander vergleichen willst.</span>
<span id="cb49-791"><a href="#cb49-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-792"><a href="#cb49-792" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb49-793"><a href="#cb49-793" aria-hidden="true" tabindex="-1"></a><span class="fu">## Alternativen zu `{tidyplots}`</span></span>
<span id="cb49-794"><a href="#cb49-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-795"><a href="#cb49-795" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{ggpubr}`</span> bietet auch noch andere Alternativen für die Darstellung von statistischen Vergleichen in deinen Daten unter <span class="co">[</span><span class="ot">ggpubr: ‘ggplot2’ Based Publication Ready Plots</span><span class="co">](https://rpkgs.datanovia.com/ggpubr/)</span>. Vielleicht findest du da auch noch eine bessere Abbildung als hier. Da wir hier sehr viel ähnliches haben, bleibe ich bei <span class="in">`{tidyplots}`</span>.</span>
<span id="cb49-796"><a href="#cb49-796" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-797"><a href="#cb49-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-798"><a href="#cb49-798" aria-hidden="true" tabindex="-1"></a>Neben den p-Werten, die ich hier mit der Funktion <span class="in">`add_test_pvalue()`</span> ergänze kannst du auch Sterne mit der Funktion <span class="in">`add_test_asterisks()`</span> nutzen. Das liegt dann ganz bei dir. Es gibt auch die Möglichkeit nicht signifikante Ergebnisse auszublenden. Mehr dazu findest du dann auf der <span class="co">[</span><span class="ot">Hilfeseite zu den statistischen Vergleichen in `{tidyplots}`</span><span class="co">](https://jbengler.github.io/tidyplots/articles/Visualizing-data.html#statistical-comparison)</span>. Ich zeige hier dir nur die Standardanwendung. Wir rechnen hier immer den U-Test aus dem R Paket <span class="in">`{rstatix}`</span>.</span>
<span id="cb49-799"><a href="#cb49-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-800"><a href="#cb49-800" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb49-801"><a href="#cb49-801" aria-hidden="true" tabindex="-1"></a><span class="fu">## Barplot</span></span>
<span id="cb49-802"><a href="#cb49-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-803"><a href="#cb49-803" aria-hidden="true" tabindex="-1"></a>Die Standardabbildung ist sicherlich der Barplot zusammen mit der Standardabweichung als Fehlerbalken. Dann habe ich noch die einzelnen Beobachtungen ergänzt. Die Klammer über den beiden Säulen gibt den Vergleich an und die Zahl ist der p-Wert aus einem U-Test. Wir sehen hier, dass sich die beiden Floharten in den Sprungweiten signifikant unterscheiden. Der p-Wert ist kleiner als das Signifikanzniveau $\alpha$ gleich 5%.</span>
<span id="cb49-804"><a href="#cb49-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-807"><a href="#cb49-807" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-808"><a href="#cb49-808" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-809"><a href="#cb49-809" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb49-810"><a href="#cb49-810" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-811"><a href="#cb49-811" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-tidyplot-barplot-ttest</span></span>
<span id="cb49-812"><a href="#cb49-812" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb49-813"><a href="#cb49-813" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb49-814"><a href="#cb49-814" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3.5</span></span>
<span id="cb49-815"><a href="#cb49-815" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Einfaktorieller Barplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem U-Test."</span></span>
<span id="cb49-816"><a href="#cb49-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-817"><a href="#cb49-817" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb49-818"><a href="#cb49-818" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb49-819"><a href="#cb49-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-820"><a href="#cb49-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_mean_bar</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">width =</span> <span class="fl">0.4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-821"><a href="#cb49-821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_sd_errorbar</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-822"><a href="#cb49-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_test_pvalue</span>(<span class="at">method =</span> <span class="st">"wilcox_test"</span>, <span class="at">hide_info =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-823"><a href="#cb49-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb49-824"><a href="#cb49-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-825"><a href="#cb49-825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Flohart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-826"><a href="#cb49-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-827"><a href="#cb49-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"dog"</span> <span class="ot">=</span> <span class="st">"Hund"</span>, <span class="st">"cat"</span> <span class="ot">=</span> <span class="st">"Katze"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb49-828"><a href="#cb49-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span>
<span id="cb49-829"><a href="#cb49-829" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-830"><a href="#cb49-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-831"><a href="#cb49-831" aria-hidden="true" tabindex="-1"></a><span class="fu">## Boxplot</span></span>
<span id="cb49-832"><a href="#cb49-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-833"><a href="#cb49-833" aria-hidden="true" tabindex="-1"></a>Es gibt auch gute Gründe ienmal den Boxplot zu wählen, wenn wir etwas besser die Verteilung der Sprungweiten darstellen wollen. Ich habe dann noch die einzelnen Beobachtungen ergänzt. Die Klammer über den beiden Säulen gibt den Vergleich an und die Zahl ist der p-Wert aus einem U-Test. Wir sehen hier, dass sich die beiden Floharten in den Sprungweiten signifikant unterscheiden. Der p-Wert ist kleiner als das Signifikanzniveau $\alpha$ gleich 5%.</span>
<span id="cb49-834"><a href="#cb49-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-837"><a href="#cb49-837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-838"><a href="#cb49-838" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-839"><a href="#cb49-839" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb49-840"><a href="#cb49-840" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-841"><a href="#cb49-841" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-tidyplot-boxplot-ttest</span></span>
<span id="cb49-842"><a href="#cb49-842" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb49-843"><a href="#cb49-843" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb49-844"><a href="#cb49-844" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3.5</span></span>
<span id="cb49-845"><a href="#cb49-845" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Einfaktorieller Boxplot für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem U-Test."</span></span>
<span id="cb49-846"><a href="#cb49-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-847"><a href="#cb49-847" aria-hidden="true" tabindex="-1"></a><span class="fu">tidyplot</span>(<span class="at">data =</span> fac1_tbl, </span>
<span id="cb49-848"><a href="#cb49-848" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal) <span class="sc">|&gt;</span> </span>
<span id="cb49-849"><a href="#cb49-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-850"><a href="#cb49-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">box_width =</span> <span class="fl">0.3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-851"><a href="#cb49-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_test_pvalue</span>(<span class="at">method =</span> <span class="st">"wilcox_test"</span>, <span class="at">hide_info =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-852"><a href="#cb49-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb49-853"><a href="#cb49-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-854"><a href="#cb49-854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Flohart"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-855"><a href="#cb49-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-856"><a href="#cb49-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"dog"</span> <span class="ot">=</span> <span class="st">"Hund"</span>, <span class="st">"cat"</span> <span class="ot">=</span> <span class="st">"Katze"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb49-857"><a href="#cb49-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span>
<span id="cb49-858"><a href="#cb49-858" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-859"><a href="#cb49-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-860"><a href="#cb49-860" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gepaarter Dotplot</span></span>
<span id="cb49-861"><a href="#cb49-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-862"><a href="#cb49-862" aria-hidden="true" tabindex="-1"></a>Am Ende wollen wir uns dann nochmal den gepaarten U-Test als Wilcoxon Test anschauen. Hier ist dann die Abbildung realtiv einfach. Wir können da die Daten <span class="in">`paired_tbl`</span> aus dem gepaarten U-Test nutzen nachdem wir die Daten in das Long-Format überführt haben. Etwas schwieriger ist dann der p-Wert, den p-Wert müssen wir dann erst selber errechnen und dann ergänzen. Also fangen wir einmal an die Daten in das Long-Format zu überführen.</span>
<span id="cb49-863"><a href="#cb49-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-866"><a href="#cb49-866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-867"><a href="#cb49-867" aria-hidden="true" tabindex="-1"></a>paired_long_tbl <span class="ot">&lt;-</span> paired_tbl <span class="sc">|&gt;</span> </span>
<span id="cb49-868"><a href="#cb49-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> satt<span class="sc">:</span>hungrig,</span>
<span id="cb49-869"><a href="#cb49-869" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"jump_length"</span>,</span>
<span id="cb49-870"><a href="#cb49-870" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"trt"</span>)</span>
<span id="cb49-871"><a href="#cb49-871" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-872"><a href="#cb49-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-873"><a href="#cb49-873" aria-hidden="true" tabindex="-1"></a>Jetzt können wir den gepaarten U-Test rechnen und zwar aus dem R Paket <span class="in">`{rstatix}`</span>. Dann müssen wir noch alles so umbauen, dass wir die Informationen dann in <span class="in">`{tidyplots}`</span> auch nutzen können.</span>
<span id="cb49-874"><a href="#cb49-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-877"><a href="#cb49-877" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-878"><a href="#cb49-878" aria-hidden="true" tabindex="-1"></a>stats_tbl <span class="ot">&lt;-</span> paired_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb49-879"><a href="#cb49-879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id) <span class="sc">|&gt;</span> </span>
<span id="cb49-880"><a href="#cb49-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wilcox_test</span>(jump_length <span class="sc">~</span> trt, <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-881"><a href="#cb49-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb49-882"><a href="#cb49-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_xy_position</span>()</span>
<span id="cb49-883"><a href="#cb49-883" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-884"><a href="#cb49-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-885"><a href="#cb49-885" aria-hidden="true" tabindex="-1"></a>Wir butzen hier die Funktion <span class="in">`stat_pvalue_manual()`</span> um händisch die p-Werte zu den Dotplot mit den Mittelwert und Standardabweichung zu ergänzen. Die Verbindungen zwischen den Beobachtungen haben wir dann durch <span class="in">`add_line()`</span> erzeugt. Ich gebe zu, dass ist etwas komplizierter. Wenn du dann die Sterne haben willst, dann musst due das Label auf <span class="in">`"p.signif"`</span> setzen. Dann werden statt der p-Werte <span class="in">`"p"`</span> dir die Sterne <span class="in">`*`</span> angezeigt. Wir sehen hier, dass sich die beiden Fütterungslevel in den Sprungweiten signifikant unterscheiden. Der p-Wert ist kleiner als das Signifikanzniveau $\alpha$ gleich 5%.</span>
<span id="cb49-886"><a href="#cb49-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-889"><a href="#cb49-889" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb49-890"><a href="#cb49-890" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb49-891"><a href="#cb49-891" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb49-892"><a href="#cb49-892" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb49-893"><a href="#cb49-893" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-tidyplot-barplot-ttest-paired</span></span>
<span id="cb49-894"><a href="#cb49-894" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb49-895"><a href="#cb49-895" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb49-896"><a href="#cb49-896" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 3.5</span></span>
<span id="cb49-897"><a href="#cb49-897" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dotplot mit Mittelwert und Standardabweichung für die Sprungweiten in [cm] gruppiert nach den Floharten mit mehr Optionen und angepassten Beschriftungen sowie den p-Wert aus einem gepaarten U-Test. Gleiche Messungen an gleichen Flöhen sind mit einer Linie verbunden."</span></span>
<span id="cb49-898"><a href="#cb49-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-899"><a href="#cb49-899" aria-hidden="true" tabindex="-1"></a>paired_long_tbl <span class="sc">|&gt;</span> </span>
<span id="cb49-900"><a href="#cb49-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidyplot</span>(<span class="at">x =</span> trt, <span class="at">y =</span> jump_length, <span class="at">color =</span> trt, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-901"><a href="#cb49-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_line</span>(<span class="at">group =</span> id, <span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-902"><a href="#cb49-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_data_points</span>() <span class="sc">|&gt;</span></span>
<span id="cb49-903"><a href="#cb49-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_mean_dash</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-904"><a href="#cb49-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_sd_errorbar</span>(<span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-905"><a href="#cb49-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add</span>(<span class="fu">stat_pvalue_manual</span>(stats_tbl, <span class="at">size =</span> <span class="dv">7</span><span class="sc">/</span>.pt, <span class="at">label =</span> <span class="st">"p"</span>,</span>
<span id="cb49-906"><a href="#cb49-906" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bracket.nudge.y =</span> <span class="fl">0.1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb49-907"><a href="#cb49-907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">remove_legend</span>() <span class="sc">|&gt;</span> </span>
<span id="cb49-908"><a href="#cb49-908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_font</span>(<span class="at">fontsize =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-909"><a href="#cb49-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_x_axis_title</span>(<span class="st">"Fütterung"</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-910"><a href="#cb49-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_y_axis_title</span>(<span class="st">"Sprungweite in [cm]"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-911"><a href="#cb49-911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reorder_x_axis_labels</span>(<span class="st">"hungrig"</span>, <span class="st">"satt"</span>) <span class="sc">|&gt;</span>  </span>
<span id="cb49-912"><a href="#cb49-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_x_axis_labels</span>(<span class="at">new_names =</span> <span class="fu">c</span>(<span class="st">"satt"</span> <span class="ot">=</span> <span class="st">"gefüttert"</span>, <span class="st">"hungrig"</span> <span class="ot">=</span> <span class="st">"ungefüttert"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb49-913"><a href="#cb49-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_size</span>(<span class="at">width =</span> <span class="cn">NA</span>, <span class="at">height =</span> <span class="cn">NA</span>) </span>
<span id="cb49-914"><a href="#cb49-914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-915"><a href="#cb49-915" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-916"><a href="#cb49-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-917"><a href="#cb49-917" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-tests-utest.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-tests-utest.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
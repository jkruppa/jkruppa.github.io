<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>60&nbsp; Lineare gemischte Modelle – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-modeling-gee.html" rel="next">
<link href="./stat-modeling-prob-model.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<meta name="mermaid-theme" content="neutral">
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="60&nbsp; Lineare gemischte Modelle – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-modeling-preface.html">Statistisches Modellieren</a></li><li class="breadcrumb-item"><a href="./stat-modeling-mixed.html"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der U-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Chi-Quadrat-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-marginal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Marginal effect models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">60.1</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">60.2</span> Daten</a></li>
  <li><a href="#visualisierung" id="toc-visualisierung" class="nav-link" data-scroll-target="#visualisierung"><span class="header-section-number">60.3</span> Visualisierung</a>
  <ul class="collapse">
  <li><a href="#schuldaten" id="toc-schuldaten" class="nav-link" data-scroll-target="#schuldaten"><span class="header-section-number">60.3.1</span> Schuldaten</a></li>
  <li><a href="#weizendaten" id="toc-weizendaten" class="nav-link" data-scroll-target="#weizendaten"><span class="header-section-number">60.3.2</span> Weizendaten</a></li>
  <li><a href="#wurmdaten" id="toc-wurmdaten" class="nav-link" data-scroll-target="#wurmdaten"><span class="header-section-number">60.3.3</span> Wurmdaten</a></li>
  </ul></li>
  <li><a href="#modellierung" id="toc-modellierung" class="nav-link" data-scroll-target="#modellierung"><span class="header-section-number">60.4</span> Modellierung</a>
  <ul class="collapse">
  <li><a href="#mitteln-über-einen-zufälligen-effekt" id="toc-mitteln-über-einen-zufälligen-effekt" class="nav-link" data-scroll-target="#mitteln-über-einen-zufälligen-effekt"><span class="header-section-number">60.4.1</span> Mitteln über einen zufälligen Effekt</a></li>
  <li><a href="#mit-dem-r-paket-lme4" id="toc-mit-dem-r-paket-lme4" class="nav-link" data-scroll-target="#mit-dem-r-paket-lme4"><span class="header-section-number">60.4.2</span> … mit dem R Paket <code>{lme4}</code></a></li>
  <li><a href="#mit-dem-r-paket-glmmtb" id="toc-mit-dem-r-paket-glmmtb" class="nav-link" data-scroll-target="#mit-dem-r-paket-glmmtb"><span class="header-section-number">60.4.3</span> … mit dem R Paket <code>{glmmTB}</code></a></li>
  <li><a href="#mit-dem-r-paket-multilevelmod" id="toc-mit-dem-r-paket-multilevelmod" class="nav-link" data-scroll-target="#mit-dem-r-paket-multilevelmod"><span class="header-section-number">60.4.4</span> … mit dem R Paket <code>{multilevelmod}</code></a></li>
  </ul></li>
  <li><a href="#sec-mult-comp-lmer-reg" id="toc-sec-mult-comp-lmer-reg" class="nav-link" data-scroll-target="#sec-mult-comp-lmer-reg"><span class="header-section-number">60.5</span> Gruppenvergleich</a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-mixed.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-mixed.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-modeling-preface.html">Statistisches Modellieren</a></li><li class="breadcrumb-item"><a href="./stat-modeling-mixed.html"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-mixed" class="quarto-section-identifier"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 29. March 2025 um 11:23:03</em></p>
<blockquote class="blockquote">
<p><em>“Wer die Arbeit kennt und sich nicht drückt, der ist verrückt.” — Tick, Trick und Track</em></p>
</blockquote>
<p>In diesem Kapitel vollen wir die Grundzüge der lineare gemischten Modell (eng. <em>linear mixed models</em>, abk. <em>lmm</em>) zu versuchen zu verstehen. Wir immer, es gibt dazu auch hervorragende Literatur wie das sehr ausführliche Buch von <span class="citation" data-cites="zuur2009mixed">Zuur et al. (<a href="#ref-zuur2009mixed" role="doc-biblioref">2009</a>)</span> oder <span class="citation" data-cites="roback2021beyond">Roback &amp; Legler (<a href="#ref-roback2021beyond" role="doc-biblioref">2021</a>)</span> mit dem freien Onlinebuch <a href="https://bookdown.org/roback/bookdown-BeyondMLR/">Beyond Multiple Linear Regression - Applied Generalized Linear Models and Multilevel Models in R</a>. Auch liefert <span class="citation" data-cites="salinas2023generalized">Salinas Ruı́z et al. (<a href="#ref-salinas2023generalized" role="doc-biblioref">2023</a>)</span> mit dem Open Access Buch <a href="https://link.springer.com/book/10.1007/978-3-031-32800-8">Generalized Linear Mixed Models with Applications in Agriculture and Biology</a> eine gute Quelle zum Weiterlesen. Wir fangen jetzt aber erstmal an zu verstehen, wie eigentlich ein Experiment aussehen muss, damit wir ein lineares gemischtes Modell rechnen wollen. Dabei ist der erste wichtige Punkt, das wir hier mit den gemischten Modellen hierarchische Daten abbilden. Es gibt also eine Hierarchie zwischen den Daten und damit auch eine Abhängigkeit innerhalb der Daten. Eine Abhängigkeit ist in der Statistik eine Korrelationsstruktur. Hier konzentrieren wir uns auf agrarwissenschaftliche Daten. Wir haben dabei in den Agarwissenschaften unser <span class="math inline">\(x\)</span> als Faktoren <span class="math inline">\(f\)</span> vorliegen. Für das <span class="math inline">\(y\)</span> können aber jeden Messwert als Outcome abbilden den wir wollen. Dafür gibt es dann zum Beispiel die Funktion <code>glmer()</code>, die das Äquivalent zu der Funktion <code>glm()</code> ist.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/angel_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Dieses Kapitel ist mathematisch und statistisch teilweise inkorrekt. Insbesondere die Modelle unterschlagen Fehlerterme und andere Aspekte der Korrelationstruktur von hierarischen Daten. Aber wie immer… erst einfach verstehen, dann komplizierter nachlesen.</p>
</blockquote>
</div>
</div>
</div>
<p>Wir haben also folgendes, mehrfaktorielles Modell vorliegen. Diese Faktoren haben teilweise eine Hierarchie, die wir dann modellieren wollen.</p>
<p><span class="math display">\[
y \sim f_1 + f_2 + z_1 + z_2
\]</span></p>
<p>Und eigentlich haben wir ja gar nicht vier <em>gleichwertige</em> Faktoren vorliegen, sondern meistens unsere Behandlungsfaktor <span class="math inline">\(f_1\)</span> und <span class="math inline">\(f_2\)</span> an dem wir interessiert sind und dann noch bis zu zwei weitere Faktoren <span class="math inline">\(z_1\)</span> und <span class="math inline">\(z_2\)</span>, die eine weitere Gruppierung repräsentieren. Wir können auch noch mehr Faktoren vorliegen haben, aber ich empfehle ein Design immer auf maximal vier Faktoren zu begrenzen. Unsere beiden Faktoren <span class="math inline">\(z_1\)</span> und <span class="math inline">\(z_2\)</span> beschreiben jetzt aber nicht noch mehr Behandlungen sondern stellen ein Feld, einen Block oder aber einen Stall dar. Wir haben es also mit Faktoren für eine “Position” zu tun. Die Position kann auch eine zeitliche Komponente sein. Deshalb schreiben wir etwas allgemeiner für die Faktoren <span class="math inline">\(z_1\)</span> und <span class="math inline">\(z_2\)</span> auch als “zufällige” Effekte. Wie schon erwähnt es handelt sich nicht ausschließlich um Blöcke, es können auch andere Positionen in Raum und Zeit sein. Es geht immer mehr und manchmal braucht man auch mehr Faktoren, aber in unserem Kontext hier würde ich anraten sich auf eher auf drei Faktoren zu begrenzen. Also entweder zwei Behandlungsfaktoren <span class="math inline">\(f_1\)</span> sowie <span class="math inline">\(f_2\)</span> und ein Positionsfaktor <span class="math inline">\(z_1\)</span> oder aber ein Behandlungsfaktor <span class="math inline">\(f_1\)</span> und zwei Positionsfaktoren <span class="math inline">\(z_1\)</span> sowie <span class="math inline">\(z_2\)</span>.</p>
<p>Als wäre das nicht kompliziert genug, haben wir meistens auch noch verschachtelte (eng. <em>nested</em>) Daten vorliegen. Damit meine ich, dass wir den Faktor <span class="math inline">\(z_1\)</span> in jedem Level des Faktors <span class="math inline">\(z_2\)</span> vorliegen haben. Wir können eben verschiedene Standorte als Faktor <span class="math inline">\(z_2\)</span> betrachten und an jedem der Standorte haben wir Blöcke <span class="math inline">\(z_1\)</span> vorliegen. Mehr dazu findest du dann auch in dem Kapitel <a href="experimental-design-r.html">Versuchsplanung in R</a> und gleich nochmal weiter unten im Text.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Welche R Implementierung verwenden?
</div>
</div>
<div class="callout-body-container callout-body">
<p>In diesem Kapitel werden wir <em>nicht</em> die Implementierung von linearen gemischten Modellen in dem R Paket <code>{nlme}</code> verwenden. Das Paket <code>{nlme}</code> hat sinnvolle Funktionen und je nach Fragestellung haben diese auch eine Berechtigung. Es gibt aber neuere R Pakete wie <code>{lme4}</code> oder <code>{glmmTMB}</code>, die wir dann hier in dem Kapitel nutzen wollen wenn es um statistsiche Analyse mit linearen gemischten Modellen geht..</p>
</div>
</div>
<p>Was ist nun das Besondere an einem linearen gemischten Modell? Wie der Name schon sagt, haben wir irgendwas gemischt. Glücklicherweise mischen wir nur zwei Dinge miteinander. Wir mischen hier feste Effekte (eng. <em>fixed effect</em>) und zufällige Effekte (eng. <em>random effect</em>) miteinander. Bis jetzt kennst du eigentlich nur feste Effekte. Immer wenn wir ein Modell gebaut haben, dann haben wir das Modell mit festen Effekten gebaut. Wir haben dabei Fakotoren als feste Effekte modelliert. Was ist also nun der Unterschied zwischen der Wahl einen Faktor als festen Effekt oder zufälligen Effekt anzusehen? Zuerst ist dies eine Modellierungsentscheidung. Wir müssen uns also zwischen Arten von Modellen unterscheiden. Daher können wir auch verschiedene Modelle mit unterschiedlichen Anzahlen an Faktoren bauen und dann diese Modelle vergleichen. Welcher Faktor jetzt als fester Effekt und welcher als zufälliger Effekt gilt, liegt dabei an uns.</p>
<p>Die Idee hinter dem Modell mit <strong>festen Effekten</strong> ist, dass die beobachteten Effektgrößen von Block zu Block variieren können, was aber nur auf den Varianz der Blöcke zurückzuführen ist. In Wirklichkeit sind die wahren Effektgrößen alle gleich: Sie sind fix. Alle Blöcke haben den gleichen Mittelwert und variieren nur in der Varianz. Wir sehen aber diesen wahren Mittelwert nicht, da sich alle Blöcke eben immer leicht unterscheiden. Mehr dazu auch in <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/pooling-es.html#fem">The Fixed-Effect Model</a>)</p>
<p>Das Modell der <strong>zufälligen Effekte</strong> geht davon aus, dass es nicht nur eine wahre Effektgröße gibt, sondern eine Verteilung der wahren Effektgrößen. Jeder unserer Blöcke kann also einen anderen wahren Mittelwert haben. Das Ziel des Modells mit zufälligen Effekten ist es daher nicht, die eine wahre Effektgröße aller Blöcke zu schätzen, sondern den Mittelwert der Verteilung der wahren Effekte. Mehr dazu auch in <a href="https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/pooling-es.html#rem">The Random-Effect Model</a>)</p>
<p>Dabei verbinden die gemischten Modelle die Vorteile eines Modells mit festen Effekt sowie eines Modells mit zufälligen Effekten. Lineare gemischte Modelle schätzen nun die subjektspezifischen Auswirkungen (eng. <em>subject-specific</em>) auf die Varianz eines Versuches. Dabei kommt es häufig darauf an unter welchen Umständen eine Beobachtung gemessen wurde. Stehen die Pflanze zusammen auf einem Feld? Sind die Ferkel alle Nachkommen einer Sau? Daher erweitern wir unser lineare Modell um einen zufälligen Effekt <span class="math inline">\(z\)</span> und schreiben wie folgt.</p>
<p><span class="math display">\[
y \sim f_1 + 1|z_1
\]</span></p>
<p>Wir schreiben in R den Term für da zufällige Modell in der Form <span class="math inline">\(z_0|z_1\)</span>. Meist setzen wir den Intercept <span class="math inline">\(z_0\)</span> für den zufälligen Effekt auf <code>1</code>. Wenn wir darstellen wollen, das ein zufälliger Faktor in einem anderen zufälligen Fakotr genestet ist, dann schreiben wir <code>1|z_1/z_2</code>.</p>
<p><span class="math display">\[
y \sim f_1 + 1|z_1/z_2
\]</span></p>
<p>Das heißt, dass der zufällige Blockfaktor <span class="math inline">\(z_1\)</span> in den zufälligen Blockfaktor <span class="math inline">\(z_2\)</span> genestet ist. Das klingt jetzt etwas schräg, also einmal ein Beispiel. Wir haben eine Schule, dann sind die Schulklassen dieser Schule in der Schule genestet. Es gibt diese spezifischen Klassen mit den Schülern schlichtweg nicht in anderen Schulen. Wir sagen genestet (eng. <em>nested</em>), wenn wir sagen wollen, dass ein Faktor in einen anderen Faktor verschränkt ist. Die Klassen einer Schule sind in der Schule genestet.</p>
<p>In der <a href="#fig-mermaid-r-mixed-01" class="quarto-xref">Abbildung&nbsp;<span>60.1</span></a> siehst du einmal exemplarisch die Darstellung eines experimentellen Designs mit drei Faktoren. Die Behandlung ist dabei ein fester Effekt und die beiden Faktoren für die Tische und die Gewächshäuser sind zufällige Effekte. Damit wir in der Folge nicht immer so sehr durcheinander kommen, habe ich die festen Effekt als blau Kästen und die zufälligen Effekte als orange Kästen gesetzt.</p>
<div class="cell" data-fig-width="6" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-mermaid-r-mixed-01" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mermaid-r-mixed-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-mermaid-r-mixed-01">flowchart LR
    C(Behandlungen):::fixed --- D(((nested))) --&gt; E(Tische):::random --- F(((nested))) --&gt; G(Gewächshäuser):::random
    classDef fixed fill:#56B4E9,stroke:#333,stroke-width:0.75px
    classDef random fill:#E69F00,stroke:#333,stroke-width:0.75px
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mermaid-r-mixed-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.1— Beispiel für drei Faktoren und deren Abhänigigkeitsstruktur untereinander. Die Behandlungen sind in den Tischen genested und die Tische in den Gewächshäusern. Die festen Effekte sind als blaue Kästen und die zufälligen als orange Kästen eingefärbt.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Okay, das ist jetzt bis hierher sehr abstrakt. Machen wir das mal konkret mit einem Beispiel mit drei Behandlungen gegen Blattläuse auf jeweils vier Tischen in drei Gewächshäusern. Pro Behandlung nehmen wir fünf Pflanzen. Damit ergibt sich folgendes Schema der Abhängigkeiten mit den jeweiligen Anzahlen.</p>
<p><span class="math display">\[
\overbrace{\mbox{Gewächshauser}}^{n_g = 3} \xrightarrow[alle]{beinhaltet} \underbrace{\mbox{Tische}}_{n_t = 4} \xrightarrow[alle]{beinhaltet} \overbrace{\mbox{Behandlungen}}^{n_b = 3} \xrightarrow[alle]{beinhaltet} \underbrace{\mbox{Beobachtungen}}_{n_w = 5}
\]</span></p>
<p>Wie du an dem obigen Beispiel sehen kannst, kommen wir bei linearen gemischten Modellen sehr schnell auf sehr große Fallzahlen. Wir haben im obigen, kleinen Beispiel alleine schon eine Fallzahl von <span class="math inline">\(n_{gesamt} = 3 \times 4 \times 3 \times 5 = 180\)</span> Pflanzen. Und damit ist eigentlich unser Beispiel sehr klein gewählt. Eigentlich brauchen wir für einen zufälligen Effekt als Daumenregel immer mehr als fünf Level für eine gute Modellschätzung.</p>
<p>Wie immer ist dieses Kapitel nur ein kleiner Teil von möglichen Orten um etwas über lineare gemischte Modelle zu lernen. In dem folgenden Kasten habe ich dir eine weitreichende Sammlung an Ideen und Tutorien zusammengesucht. Vielleicht findest du ja noch mehr Informationen dort. Für eine Analyse im Rahmen einer Abschlussarbeit sollte das Wissen hier aber reichen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien zu gemischten Modellen
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wie immer und natürlich im Besonderen bei linearen gemischten Modellen, gibt es eine Reihe von tollen Hilfen. Daher hier einmal eine lose Sammlung an Ideen und Tutorien, die mir geholfen haben dieses Kapitel hier zu schreiben. Fast jede Quelle hat dann nochmal Referezen zu weiteren Informationen und Hilfen.</p>
<ul>
<li><a href="https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#should-i-treat-factor-xxx-as-fixed-or-random">GLMM FAQ – Ben Bolker and others</a> ist meine Anlaufstelle, wenn ich mal was nachlesen muss. Eine sehr hilfreiche und umfangreiche Sammlung.</li>
<li><a href="https://m-clark.github.io/mixed-models-with-R/">Mixed Models with R – Getting started with random effects</a> ist ein freies Buch, was ich auch immer mal wieder anschaue, wenn ich Fragen rund um das gemischte Modell habe. Dies ist hier nur ein Kapitel mit einer Zusammenfassung und eben kein ganzes Buch.</li>
<li>Teile dieses Kapitel basieren auf dem tollen <a href="https://ourcodingclub.github.io/tutorials/mixed-models/">Tutorium von Gabriela K Hajduk</a>. Die früheren Versionen mehr als die aktuelle Version, aber ich finde das Tutorium immer noch toll. Auch hier findest du sehr viel mehr Informationen und dann auch Links zu weiteren Quellen.</li>
<li>Ideen und weitere Erklärungen sind auch beim <a href="https://rlbarter.github.io/Practical-Statistics/2017/03/03/fixed-mixed-and-random-effects/">Tutorium von Sara Stoudt</a> zu finden. Hier musst du dich aber mehr Einarbeiten, da der Artikel etwas mehr mathematisch aufgebaut ist.</li>
<li>Als weiteres Tutorium für die Auswertung von linearen gemischten Modellen und allgemein dem Modellieren von agarwissenschaftlichen Daten kann ich die Seite <a href="https://schmidtpaul.github.io/dsfair_quarto/">Data Science for Agriculture in R</a> sehr empfehlen. Dort findest du dann auch die Abwendung der R Pakete aus diesem Kapitel. Und natürlich die verwandte Seite <a href="https://schmidtpaul.github.io/MMFAIR/">Mixed Models for Agriculture in R</a> auf der gerade viele Beispiele gesammelt werden. Ein Großteil der Seite aber noch <em>under construction</em> (Stand Ende 2023) und teilweise zu detailliert für Abschlussarbeiten.</li>
<li><a href="https://cran.r-project.org/web/packages/broom.mixed/vignettes/broom_mixed_intro.html">Introduction to <code>{broom.mixed}</code></a> hilft dabei die Ausgaben der verschiedenen R Pakte, die es zu gemischten Modellen gibt zu vereinheitlichen. Wir erhalten dann immer die gleiche <code>tidy()</code>-Ausgabe und nicht immer was anderes von den Funktionen wiedergegeben.</li>
<li><a href="https://bodo-winter.net/tutorials.html">Linear Models and Mixed Models with R</a> sind zwei PDF Dateien von <span class="citation" data-cites="winter2013linear">Winter (<a href="#ref-winter2013linear" role="doc-biblioref">2013</a>)</span> in denen er nochmal sehr schön erklärt wie lineare gemischte Modelle in R funktionieren.</li>
<li>Das Tutorium <a href="https://tdunn.ca/posts/2020-03-15-ordinal-regression-in-r-part-1/">Ordinal regression in R: part 1</a> liefert nochmal ein lineares gemischtes Modell für ordinale Daten oder eben Bonituren. Dafür dann gerne auch am Ende des Kapitels die beispielhafte Auswertung anschauen.</li>
</ul>
</div>
</div>
<section id="genutzte-r-pakete" class="level2" data-number="60.1">
<h2 data-number="60.1" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">60.1</span> Genutzte R Pakete</h2>
<p>Normalerweise nutze ich <em>nur</em> R Pakete, die auch auf CRAN oder eben per <code>p_load()</code> zu installieren sind. In diesem Kapitel brauche ich aber noch ein extra Paket, da die Ausgaben von linearen gemischten Modellen sehr unordentlich sind. Das R Paket <code>{mixedup}</code> hilft mir hier. Deshalb installiere ich einmal wie folgt <code>{mixedup}</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">'m-clark/mixedup'</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir wollen folgende R Pakete ganz normal in diesem Kapitel nutzen. Es sind eine Menge geworden, aber das zeigt auch mal wieder, dass gemischte Modelle nicht unbedingt das einfachtse Modell sind.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, broom, see, simstudy,</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>               multcomp, emmeans, lme4, broom.mixed, readxl,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>               parameters, ggridges, scales, performance, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>               ggdist, gghalves, glmmTMB, lmerTest, mixedup,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>               multilevelmod, agridat, desplot, modelsummary,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>               ggbeeswarm, ordinal, janitor, RVAideMemoire, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>               conflicted)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(lme4<span class="sc">::</span>lmer)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="60.2">
<h2 data-number="60.2" class="anchored" data-anchor-id="daten"><span class="header-section-number">60.2</span> Daten</h2>
<p>Als erstes Beispiel nehmen wir einen Datensatz zu den Testergebnissen von Schülern an amerikanischen Schulen. Jetzt ist das kein Beispiel, welches du vielleicht in einem biologischen oder agrarwissenschaftlichen Umfeld erwarten würdest. Ich mache das aber hier bewusst, da wir uns alle sehr gut die Abhängigkeiten von Schülerleistungen von der jeweiligen Klasse und dem Standort der Schule vorstellen können. Jedem wird klar sein, dass ein Testergebnis aus einer Klausur <em>nicht</em> unabhängig davon ist, auf welche Schule der Schüler geht oder in welcher Klasse er unterrichtet wird. Schüler in einer gemeinsamen Klasse oder Schule werden sich ähnlicher sein als Schüler in unterschiedlichen Klassen oder Schulen.</p>
<p>In der <a href="#fig-mermaid-r-mixed-school" class="quarto-xref">Abbildung&nbsp;<span>60.2</span></a> siehst du einmal das Abhängigkeitsverhältnis in unserem Schuldatenbeispiel. Wir wenden in den verschiedenen Klassen als Behandlung <code>trt</code> eines von drei Lehrmethoden <em>Frontal</em>, <em>Flipped Classroom</em> oder <em>HyperFlex</em> an. Dabei wird natürlich eine ganze Klasse nach der entsprechenden Lehrmethode unterrichtet. Pro Schule finden sich drei Klassen und eine Klasse ist dann in einer der neun Schulen genestet.</p>
<div class="cell" data-fig-width="6" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-mermaid-r-mixed-school" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mermaid-r-mixed-school-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-mermaid-r-mixed-school">flowchart LR
    C(trt):::fixed --- D(((nested))) --&gt; E(class):::random --- F(((nested))) --&gt; G(school):::random
    classDef fixed fill:#56B4E9,stroke:#333,stroke-width:0.75px
    classDef random fill:#E69F00,stroke:#333,stroke-width:0.75px
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mermaid-r-mixed-school-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.2— In unseren Schuldaten haben wir verschiedene Schulen <code>school</code> und Klassen <code>class</code> mit zwei innovativen Lehrmethoden unterrichtet. Eine Kontrollgruppe soll die Ergebnisse eines Leistungstests absichern. Daher sind die Lehrmethoden <code>trt</code> in dem Faktor <code>class</code> genestet. Der Faktor <code>class</code> ist dann wiederum in jedem Faktor <code>school</code> genestet.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In dem folgenden Kasten werden einmal die Schuldaten simuliert. Daher können wir dann einmal nachvollziehen, welche Werte wir jeweils für die Effekte der Schule, der Klasse und der Lehrform gesetzt haben. Wir sehen dann auch mal, welche zufälligen Effekte wir eigentlich setzen müssen und wie wir dann die Modelle miteinander vergleichen. Du kannst den Kasten gerne überspringen und dann einfach mit der Visualisierung und Auswertung der Daten weitermachen.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Generierung von Schuldaten (3-faktoriell)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Warum sollte man Daten simulieren? Reichen da nicht echte Daten? Wir können an den simulierten Daten die Werte zurückverfolgen, wir wir bei der Erstellung voreingestellt haben. Damit können wir dann auch bewerten, wie gut die statistischen Methoden funktioniert haben. Wir machen es uns aber auch etwas einfacher und bauen uns kein kompliziertes Beispiel. Umfangreich ist es nur, da Daten für ein gemischtes Modell eben auch umfangreich <em>sind</em>.</p>
<p>Aus Gründen der Einfachheit haben wir immer ein balanciertes Design vorliegen. Wir haben also immer in allen Faktorkombinationen die gleiche Anzahl an Beobachtungen <code>n_reps</code> vorliegen. In der Anwendung mag es Unterschiede geben, so hat eine Sau sicherlich nicht immer exakt zwölf Ferkel, aber in unseren Beispielen macht es keinen Unterschied. Balanciert oder unbalanciert ist bei gemischten Modellen eher nachrangig wichtig. Das <a href="https://kgoldfeld.github.io/simstudy/articles/clustered.html">R Paket <code>{simstudy}</code></a> erlaubt die Simulation von komplexeren Gruppenstrukturen mit auch unbalancierten Daten. Am Ende wäre es dann mit <code>{simstudy}</code> vermutlich einfacher gewesen… hier können wir dann auch unterschiedlich Klassengrößen und Anzahlen simulieren.</p>
<p>Im Folgenden setze ich einmal Werte für die Schulanzahl, Klassenzahl pro Schule sowie die Anzahl an Behandlungen. Dann müssen wir noch definieren wie viele Schüler dann pro Klasse zu finden sind. Wenn wir das haben, dann können wir auch die Effekte der Klassen, Schulen und der Lehrformate festlegen. Dabei sind die Effekt der zufälligen Effekte der Klassen und Schule dann die zusätzliche Varianz abgebildet durch die Standardabweichungen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(spatstat.random)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231208</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sample sizes</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>n_school <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>n_class_per_school <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>n_class <span class="ot">&lt;-</span> n_school <span class="sc">*</span> n_class_per_school</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>n_trt <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>n_reps <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># effects and standard deviation</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>sd_school <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>sd_class <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>sd_error <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>eff_trt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">frontal =</span> <span class="dv">10</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">flipped =</span> <span class="sc">-</span><span class="dv">10</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">hyflex =</span> <span class="dv">30</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns schon das Grid für die Daten erstellen. Dabei müssen wir dann mehrfach <code>expand_grid()</code> nutzen um erst die Schulen zu erschaffen, dann die Lehrformate den Schulen zuordnen und dann die Klassen pro Schule erschaffen. Ende müssen wir noch den Datensatz mit der Anzahl an Schülern pro Klasse erweitern. Dann beschreibt jede Zeile genau einen Schüler. Neben der Zuordnung jedes einzelnen Schülern zu einem Lehrformat, Klasse und Schule, müssen wir noch die Effekte <span class="math inline">\(s_0\)</span>, <span class="math inline">\(c_0\)</span> und <span class="math inline">\(t_{eff}\)</span>, die jeder Schüler durch eben jene Zuordnung erhält, ergänzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>school_grid_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">s_id =</span> <span class="dv">1</span><span class="sc">:</span>n_school,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">s_0 =</span> <span class="fu">rnorm</span>(n_school, <span class="dv">0</span>, sd_school)) <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">trt =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_trt, n_trt),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">t_eff =</span> <span class="fu">rep</span>(eff_trt, n_trt)) <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">c_per_s =</span> <span class="dv">1</span><span class="sc">:</span>n_class_per_school) <span class="sc">|&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c_id =</span> <span class="dv">1</span><span class="sc">:</span>n_class,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">c_0 =</span> <span class="fu">rnorm</span>(n_class, <span class="dv">0</span>, sd_class)) <span class="sc">|&gt;</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">reps =</span> <span class="dv">1</span><span class="sc">:</span>n_reps)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt können wir unseren Testscore berechnen, der sich aus den einzelnen Effekten der Schule <span class="math inline">\(s_0\)</span>, der Klasse <span class="math inline">\(c_0\)</span> sowie dem Lehrformat <span class="math inline">\(t_{eff}\)</span> ergibt, berechnen. Am Ende addieren wir auf jeden Wert noch einen Fehler und runden die Werte des Tests auf zwei Stellen. Dann bauen wir uns noch die Faktorlevel für die Schulen, Klassen und dem Lehrformat.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>school_tbl <span class="ot">&lt;-</span> school_grid_tbl <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(trt) <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">test =</span> <span class="fu">round</span>(<span class="dv">50</span> <span class="sc">+</span> s_0 <span class="sc">+</span> c_0 <span class="sc">+</span> t_eff <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="dv">0</span>, sd_error), <span class="dv">2</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">s_id =</span> <span class="fu">factor</span>(s_id, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Springfield School"</span>, <span class="st">"Jacksonville High"</span>, <span class="st">"Franklin Country"</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Clinton Christian"</span>, <span class="st">"Arlington Academy"</span>, <span class="st">"Georgetown High"</span>, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Greenville School"</span>, <span class="st">"Bristol Country"</span>, <span class="st">"Dover Tech Center"</span>)),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">c_id =</span> <span class="fu">as_factor</span>(c_id),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">c_per_s =</span> <span class="fu">factor</span>(c_per_s, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1a"</span>, <span class="st">"1b"</span>, <span class="st">"1c"</span>)),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt =</span> <span class="fu">factor</span>(trt, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Frontal"</span>, <span class="st">"Flipped classroom"</span>, <span class="st">"HyFlex"</span>))) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann schreiben wir die Daten noch in eine Exceldatei <code>school_testing.xlsx</code> und können diese dann im weiteren Verlauf der Analyse nutzen. Auch hier passen wir etwas die Namen der Spalten an, damit die Spalten etwas mehr Aussagekraft haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>school_tbl <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">school_id =</span> s_id, <span class="at">class_in_school_id =</span> c_per_s, <span class="at">class_id =</span> c_id, trt, test) <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_xlsx</span>(<span class="st">"data/school_testing.xlsx"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>Die Schuldaten liegen dann in dem Datensatz <code>school_testing.xlsx</code> vor. Wir müssen hier dann nur noch die Faktoren bilden, damit wir dann auch die Visualisierungen sauber hinkriegen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>school_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/school_testing.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">school_id =</span> <span class="fu">as_factor</span>(school_id),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">class_in_school_id =</span> <span class="fu">as_factor</span>(class_in_school_id),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">class_id =</span> <span class="fu">as_factor</span>(class_id),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt =</span> <span class="fu">as_factor</span>(trt)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Es ergibt sich dann der Datensatz der Schuldaten wie in <a href="#tbl-school" class="quarto-xref">Tabelle&nbsp;<span>60.1</span></a> gekürzt gezeigt.</p>
<div class="cell">
<div id="tbl-school" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-school-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;60.1— Datensatz der Testscores für die Schüler an verschiedenen Schulen und Klassen. Die Schüler wurden in den Klassen jewiels mit einem von drei Lehrformaten unterrichtet. Die Klassen und Schulen sind die zufälligen Effekte. Das Lehrformat ist der feste Effekt.
</figcaption>
<div aria-describedby="tbl-school-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 29%">
<col style="width: 29%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">school_id</th>
<th style="text-align: center;">class_in_school_id</th>
<th style="text-align: center;">class_id</th>
<th style="text-align: center;">trt</th>
<th style="text-align: center;">test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Springfield School</td>
<td style="text-align: center;">1a</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">Frontal</td>
<td style="text-align: center;">59.75</td>
</tr>
<tr class="even">
<td style="text-align: center;">Springfield School</td>
<td style="text-align: center;">1a</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">Frontal</td>
<td style="text-align: center;">60.29</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Springfield School</td>
<td style="text-align: center;">1a</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">Frontal</td>
<td style="text-align: center;">63.43</td>
</tr>
<tr class="even">
<td style="text-align: center;">Springfield School</td>
<td style="text-align: center;">1a</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">Frontal</td>
<td style="text-align: center;">65.36</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">Dover Tech Center</td>
<td style="text-align: center;">1c</td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">HyFlex</td>
<td style="text-align: center;">107.29</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Dover Tech Center</td>
<td style="text-align: center;">1c</td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">HyFlex</td>
<td style="text-align: center;">108.62</td>
</tr>
<tr class="even">
<td style="text-align: center;">Dover Tech Center</td>
<td style="text-align: center;">1c</td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">HyFlex</td>
<td style="text-align: center;">107</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Dover Tech Center</td>
<td style="text-align: center;">1c</td>
<td style="text-align: center;">27</td>
<td style="text-align: center;">HyFlex</td>
<td style="text-align: center;">108.52</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In der <a href="#tbl-mixed-simple-2fac" class="quarto-xref">Tabelle&nbsp;<span>60.2</span></a> im folgenden Kasten findest du den <em>einfachst möglichen</em> Datensatz für nur zwei Schülern pro Klasse sowie insgesamt nur zwei Klassen für zwei Schulen. Damit kannst du dir einmal denn Aufbau visualisieren und siehst auch einmal wie sich die Effekte der Klassen, Schule und Lehrformat für jeden der sechzehn Schüler zusammensetzt. Jede Zeile repräsentiert ja einen Schüler.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Einfachst möglicher Schuldatensatz (3-faktoriell)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="tbl-mixed-simple-2fac" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mixed-simple-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;60.2— Kurzform eines dreifaktoriellen Datensatzes mit zwei zufälligen Effekten für <code>school</code> und <code>class</code> sowie einem Bahandlungsfaktor <code>trt</code>. Die zufälligen Effekte sind normalverteilt mit <span class="math inline">\(\mathcal{N}(0, s^2)\)</span>. Pro Behandlung haben wir dann nur zwei Wiederholungen. Dennoch erreichen wir eine Fallzahl von sechzehn Beobachtungen daher Schülern.
</figcaption>
<div aria-describedby="tbl-mixed-simple-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">school</th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{eff_{school}}\)</span></th>
<th style="text-align: center;">class</th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{eff_{class}}\)</span></th>
<th style="text-align: center;">trt</th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{eff_{trt}}\)</span></th>
<th style="text-align: center;">reps</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(0.23\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(-0.14\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(10\)</span></td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(0.23\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(-0.14\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(10\)</span></td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(0.23\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(-0.14\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(5\)</span></td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(0.23\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(-0.14\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(5\)</span></td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(0.23\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(0.21\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(10\)</span></td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(0.23\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(0.21\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(10\)</span></td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(0.23\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(0.21\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(5\)</span></td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(0.23\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(0.21\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(5\)</span></td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(0.71\)</span></td>
<td style="text-align: center;">3</td>
<td style="text-align: center;"><span class="math inline">\(-0.83\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(10\)</span></td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(0.71\)</span></td>
<td style="text-align: center;">3</td>
<td style="text-align: center;"><span class="math inline">\(-0.83\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(10\)</span></td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(0.71\)</span></td>
<td style="text-align: center;">3</td>
<td style="text-align: center;"><span class="math inline">\(-0.83\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(5\)</span></td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(0.71\)</span></td>
<td style="text-align: center;">3</td>
<td style="text-align: center;"><span class="math inline">\(-0.83\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(5\)</span></td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(0.71\)</span></td>
<td style="text-align: center;">4</td>
<td style="text-align: center;"><span class="math inline">\(0.59\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(10\)</span></td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(0.71\)</span></td>
<td style="text-align: center;">4</td>
<td style="text-align: center;"><span class="math inline">\(0.59\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(10\)</span></td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(0.71\)</span></td>
<td style="text-align: center;">4</td>
<td style="text-align: center;"><span class="math inline">\(0.59\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(5\)</span></td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(0.71\)</span></td>
<td style="text-align: center;">4</td>
<td style="text-align: center;"><span class="math inline">\(0.59\)</span></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(5\)</span></td>
<td style="text-align: center;">2</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
<p>Dann einmal den Datenklassiker <code>yates.oats</code> schlechthin als <em>das</em> <a href="https://kwstat.github.io/agridat/reference/yates.oats.html">Split-plot experiment of oats</a> aus dem R Paket <code>{agridat}</code>. Warum ist es der Klassiker? Weil es im Prinzip das erste Split plot Experiment war. Deshalb ist es nicht schlechter als andere. Ich nutze es hier, weil es gut funktioniert und wir uns einmal eine Auswertung eines komplexeren Datensatzes mit einem linearen gemischten Modell anschauen können. Wir haben insgesamt die mittleren Ertragswerte von Hafer für 72 Parzellen vorliegen. Im weiteren haben wir zwei Behandlungsfaktoren mit der Stickstoffgabe <code>nitro</code> und der Sorte <code>gen</code>. Da wir ein Split plot Experiment vorliegen haben, brauchen wir natürlich die Reihen- und Spaltenpositionen sowie die Information über den Block. Alle drei Positionsfaktoren werden wir dann versuchen als zufällige Effekte in das gemischte Modell zu nehmen. In der <a href="#fig-mermaid-oats" class="quarto-xref">Abbildung&nbsp;<span>60.3</span></a> siehst du einmal das Abhängigkeitsverhältnis in den Daten.</p>
<div class="cell" data-fig-width="6" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-mermaid-oats" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mermaid-oats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-mermaid-oats">flowchart LR
    A(nitro):::fixed --- B(((nestet))) --&gt; C(gen):::fixed --- D(((nestet))) --&gt; E(cols/rows) --- F(block):::random
    classDef fixed fill:#56B4E9,stroke:#333,stroke-width:0.75px
    classDef random fill:#E69F00,stroke:#333,stroke-width:0.75px
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mermaid-oats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.3— Abhängigkeitsstruktur des <em>split plot design</em>. Der Faktor <code>gen</code> ist in den Spalten <code>cols/rows</code> der Blöcke randomisiert und der zweite Faktor <code>nitro</code> innerhalb des anderen Faktors.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Ich erweitere noch den Datensatz um die einzelnen Pflanzenwerte indem ich für jeden <code>yield</code>-Wert als Mittelwert noch zwölf Pflanzen für die Parzelle simuliere. Damit baue ich die Daten sozusagen wieder zurück und komme auf meine individuellen Werte für jede der 72 Parzellen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(yates.oats)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>oats_tbl <span class="ot">&lt;-</span> yates.oats <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nitro =</span> <span class="fu">as_factor</span>(nitro),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">row =</span> <span class="fu">as_factor</span>(row),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">as_factor</span>(col)) <span class="sc">|&gt;</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">plant_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">plant_yield =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="fu">n</span>(), yield, <span class="dv">2</span>), <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(row, col, block, nitro, gen, plant_id, plant_yield)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#tbl-yates" class="quarto-xref">Tabelle&nbsp;<span>60.3</span></a> siehst du nochmal einen Ausschnitt aus den Daten. Wir fokussieren uns hier auf das Outcome <code>yield</code> was wir als normalverteilt annehmen. Die anderen möglichen Outcomes ignorieren wir dann erstmal. Wir brauchen dann auch die Informationen für die Position auf dem Feld <code>row</code> und <code>col</code> um dann einen gute Abbildung des Designs über das R Paket <code>{desplot}</code> zu erstellen.</p>
<div class="cell">
<div id="tbl-yates" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-yates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;60.3— Haferdatensatz im Split plot Design für zwei Behandlungsfaktoren <code>nitro</code> und <code>gen</code> sowie drei Positionsfaktoren <code>row</code>, <code>col</code> und <code>block</code>. Wir schauen uns hier nur das Outcome Haferertrag <code>yield</code> an.
</figcaption>
<div aria-describedby="tbl-yates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">row</th>
<th style="text-align: center;">col</th>
<th style="text-align: center;">block</th>
<th style="text-align: center;">nitro</th>
<th style="text-align: center;">gen</th>
<th style="text-align: center;">plant_id</th>
<th style="text-align: center;">plant_yield</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">16</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">B1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">GoldenRain</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">81.69</td>
</tr>
<tr class="even">
<td style="text-align: center;">16</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">B1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">GoldenRain</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">78.75</td>
</tr>
<tr class="odd">
<td style="text-align: center;">16</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">B1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">GoldenRain</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">81.68</td>
</tr>
<tr class="even">
<td style="text-align: center;">16</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">B1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">GoldenRain</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">75.71</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">B6</td>
<td style="text-align: center;">0.6</td>
<td style="text-align: center;">Victory</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">100.22</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">B6</td>
<td style="text-align: center;">0.6</td>
<td style="text-align: center;">Victory</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">101.27</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">B6</td>
<td style="text-align: center;">0.6</td>
<td style="text-align: center;">Victory</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">101.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">B6</td>
<td style="text-align: center;">0.6</td>
<td style="text-align: center;">Victory</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">101.41</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Neben einem normalverteilten Outcome wollen wir uns danna auch noch eine andere häufige Art von einem Outcome anschauen. Wir betrachten nämlich noch Zähldaten oder Abundanz von Arten. Wir nutzen hier auch einen Datensatz aus dem R Paket <code>{agridat}</code> und zwar den Datensatz zu <a href="https://kwstat.github.io/agridat/reference/cochran.wireworms.html">Wireworms controlled by fumigants in a latin square</a>. Es geht hier also um die Verwendung von fünf Insektiziden in einem Feld mit <span class="math inline">\(5 \times 5\)</span> großen Parzellen. In jedem der Parzellen haben wir dann die Würmer an zehn Punkten gezählt. Die zehn Zählpunkte habe ich mir ausgedacht, aber dann aber wir später ein paar mehr Beobachtungen zum darstellen. Wie du siehst, haben wir hier ein <em>latin square design</em> vorliegen, welches ich dir nochmal in der <a href="#fig-mermaid-worms" class="quarto-xref">Abbildung&nbsp;<span>60.4</span></a> dargestellt habe.</p>
<div class="cell" data-fig-width="6" data-layout-align="default">
<div class="cell-output-display">
<div id="fig-mermaid-worms" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mermaid-worms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>
<pre class="mermaid mermaid-js" data-label="fig-mermaid-worms">flowchart LR
    A(trt):::fixed --- B(((nested))) --&gt; C(rows):::random
    B(((nested))) --&gt; D(cols):::random
    C --- F(block)
    D --- F
    classDef fixed fill:#56B4E9,stroke:#333,stroke-width:0.75px
    classDef random fill:#E69F00,stroke:#333,stroke-width:0.75px
</pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mermaid-worms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.4— Schematische Darstellung der Abhängigkeitsstruktur im latin suare design für unsere Wurmdaten. Die Behandlungen werden in <code>rows</code> und <code>cols</code> genestet, die einem quadratischen Block mit den Längen der Anzahl der Level der Behandlungen entsprechen.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Im Folgenden habe ich einmal die Daten geladen und die Mittelwerte der Parzellen <code>worms</code> wieder auf die ursprünglichen, ausgedachten zehn Zählpunkte erweitert. Auch hier müssen wir dann unsere Daten wieder entsprechend mit Faktoren versehen, damit wir die Daten dann richtig im R Paket <code>{desplot}</code> abbilden können.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cochran.wireworms)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>wireworms_tbl <span class="ot">&lt;-</span> cochran.wireworms <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">as_factor</span>(col),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">row =</span> <span class="fu">as_factor</span>(row)) <span class="sc">|&gt;</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">site_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count_worms =</span> <span class="fu">rpois</span>(<span class="fu">n</span>(), worms))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Du erhälst dann folgenden Auszug in der <a href="#tbl-worms" class="quarto-xref">Tabelle&nbsp;<span>60.4</span></a> von den Wurmdaten. Hier sind dann die Namen der Behandlungen etwas kurz, aber wir belassen es mal bei den Namen. Du kannst dir hier eben fünf Insektizide vorstellen, die wir dann miteinander vergleichen würden. Zu den Gruppenvergleichen findest du dann ganz am Ende des Kapitels nochmal einen eignene Abschnitt sowie dann auch zwei Anwendungsbeispiele.</p>
<div class="cell">
<div id="tbl-worms" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-worms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;60.4— Auszug aus den Wurmdaten in einem <em>latin square design</em> für fünf verschiedene Insektizide.
</figcaption>
<div aria-describedby="tbl-worms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">row</th>
<th style="text-align: center;">col</th>
<th style="text-align: center;">trt</th>
<th style="text-align: center;">worms</th>
<th style="text-align: center;">site_id</th>
<th style="text-align: center;">count_worms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">P</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">P</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">P</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">P</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">O</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">14</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">O</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">O</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">11</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">O</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">9</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In der folgenden Box findest du noch mehr Daten und experimentelle Designs aus dem <a href="https://kwstat.github.io/agridat/reference/index.html">R Paket <code>{agridat}</code></a>. Dort findest du dann noch mehr Inspirationen wie Daten aussehen könnten, die mit einem linearen gemischten Modell ausgewertet werden. Nicht alle der dortigen Daten können nur mit einem gemischten Modell ausgewertet werden, es gibt auch eine Reihe an einfacheren Datensätzen. Ich habe hier jetzt zwei der über hundert Datensätze ausgewählt, die ich relativ repräsentativ finde.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Daten zu gemischten Modellen
</div>
</div>
<div class="callout-body-container callout-body">
<p>Alle Daten hier stammen aus dem <a href="https://kwstat.github.io/agridat/reference/index.html">R Paket <code>{agridat}</code></a> und lassen sich somit mit der Funktion <code>data()</code> laden. Die Daten liegen meistens nicht als <code>tibble()</code> vor, so dass manchmal noch etwas Datenaufbereitung notwendig ist.</p>
<ul>
<li><a href="https://kwstat.github.io/agridat/reference/becker.chicken.html">Mating crosses of chickens</a></li>
<li><a href="https://kwstat.github.io/agridat/reference/depalluel.sheep.html">Latin square of four breeds of sheep with four diets</a></li>
<li><a href="https://kwstat.github.io/agridat/reference/harville.lamb.html">Birth weight of lambs from different lines/sires</a></li>
<li><a href="https://kwstat.github.io/agridat/reference/urquhart.feedlot.html">Weight gain calves in a feedlot</a></li>
<li><a href="https://kwstat.github.io/agridat/reference/harvey.lsmeans.html">Average daily gain of 65 steers for 3 lines, 9 sires.</a></li>
<li><a href="https://kwstat.github.io/agridat/reference/edwards.oats.html">Multi-environment trial of oats in United States, 5 locations, 7 years.</a></li>
</ul>
<p>Es gibt natürlich noch mehr Datensätze, die du dann mit einem gemischten Modell auswerten kannst, aber das ist hier einmal eine Auswahl an möglichen Datensätzen zum üben.</p>
</div>
</div>
</section>
<section id="visualisierung" class="level2" data-number="60.3">
<h2 data-number="60.3" class="anchored" data-anchor-id="visualisierung"><span class="header-section-number">60.3</span> Visualisierung</h2>
<p>Der wichtigste Teil in einer Analyse ist die Visualisierung der Zusammenhänge. Das ist noch wahrer bei ser komplexen Modellen wie es die linearen gemischten Modelle sind. Wir müssen erstmal verstehen welche Gruppenstrukturen wir in den Daten haben und welchen Einfluss diese auf die jeweiligen Outcomes haben. Häufig müssen wir dazu dann aber mehrere Abbildungen erstellen, den bei so vielen Faktoren reichen dann einfache 2D Abbidlungen dann meistens nicht mehr aus. Ich versuche hier dann einmal zu zeigen, wie du das meiste aus <code>{ggplot}</code> rausholen kannst, um dir komplexe Daten zu visualisieren.</p>
<p>Wie bringen wir also möglichst viele informative Abbildungen sinnvoll zusammen? Wir nutzen dazu das <a href="https://erocoar.github.io/gghalves/">R Paket<code>{gghalves}</code></a>. Wir können mit <code>{gghalves}</code> halbe Plots erstellen und diese dann miteinander kombinieren für ein Faktorlevel kombinieren. Dabei setzen wir dann in die Mitte Boxplots. Links von den Boxplots zeichnen wir die einzelnen Beobachtungen als Punkte mit <code>stat_dots()</code> und die Verteilung der einzelnen Beobachtungen zeichnen wir mit dem <a href="https://mjskay.github.io/ggdist/">R Paket <code>{ggdist}</code></a> auf die rechte Seite. Das Tutorium <a href="https://www.cedricscherer.com/2021/06/06/visualizing-distributions-with-raincloud-plots-and-how-to-create-them-with-ggplot2/">Visualizing Distributions with Raincloud Plots</a> liefert dann noch mehr Anleitungen für noch mehr Varianten. Wie du aber schon am R Code siehst, ist das eine etwas komplexere Abbildung geworden.</p>
<p>Damit wir den ganzen R Code nicht die ganze zeit kopieren müssen, habe ich im folgenden Chunk einmal ein <code>{ggplot}</code>-Template erstellt, welches ich dann immer wieder mit neuen Daten und einem <code>aes()</code>-Aufruf versehen werde. Das kürzt dann doch ziemlich den Code zusammen. Insbesondere da wir ja sehr viele Abbildungen für unsere drei Datensätz bauen müssen. Du kannst natürlich auch immer dreimal die einzelnen Abbildungen bauen oder aber mit <code>facet_wrap()</code> arbeiten um den dritten Faktor darzustellen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> .<span class="dv">5</span>, <span class="at">width =</span> .<span class="dv">6</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">.width =</span> <span class="dv">0</span>, <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">point_colour =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dots</span>(<span class="at">side =</span> <span class="st">"left"</span>, <span class="at">justification =</span> <span class="fl">1.12</span>, <span class="at">binwidth =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">2.9</span>), <span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Beginnen wir uns nun einmal die drei Datensätze zu visualisieren und nutzen dann die Abbildungen um etwas über die hierarchischen Strukturen in den Daten zu erfahren. Aus den Rückschlüssen können wir dann entscheiden, wie wir unsere lineare gemischten Modelle bauen müssen.</p>
<section id="schuldaten" class="level3" data-number="60.3.1">
<h3 data-number="60.3.1" class="anchored" data-anchor-id="schuldaten"><span class="header-section-number">60.3.1</span> Schuldaten</h3>
<p>Dann schauen wir uns einmal in den folgenden beiden Tabs die Schuldaten und damit die Effekte der Schulen und der jeweils drei Klassen auf die Testergebnisse der Schüler an. Es ist immer wichtig sich alle möglichen Kombinationen von Faktoren anzuschauen um dann auch eine Idee für das gemischte Modell im Anschluss zu finden. Sonst stochert man sehr im Nebel rum und mit den Abbildungen hat man dann einen Hinweis, wohin es gehen könnte.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Effekt der Schule</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Effekt der Klassen</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>In der folgenden <a href="#fig-mixed-school-1" class="quarto-xref">Abbildung&nbsp;<span>60.5</span></a> sehen wir einmal die Effekte der Schule aufgeteilt nach den Lehrformaten auf die Testergebnisse der jeweiligen Schüler. Es fällt sofort ein Effekt der Schulen auf die Testergebnisse auf. Zum Beispiel hat die <em>Greenville School</em> im Frontalunterricht sehr viel schlechte Testergebnisse als die beiden anderen Schulen mit Frontalunterricht. Ähnliches, aber im positiven Sinne, sehen wir bei der <em>Arlington Academy</em>, die gegen den Trend der beiden anderen Schulen, bessere Ergebnisse bei dem Lehrformat Flipped Classroom erreicht. Somit müssen wir in unserer Analyse die Schule mit berücksichtigen, es macht eben einen Unetrschied, auf welche Schule ein Schüler gegangen ist.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  school_tbl <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> test, <span class="at">color =</span> school_id) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lehrformat"</span>, <span class="at">y =</span> <span class="st">"Testscore"</span>, <span class="at">color =</span> <span class="st">"Schule"</span>) <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mixed-school-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixed-school-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-school-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;60.5— Dreifachplot der Testergebnisse der Schüler zusammen über alle drei Klassen in den jeweiligen neun Schulen aufgetrennt nach dem Lehrformat. Teilweise sind starke Effekte der Schulen auf die Testergebnisse der Schüler zu erkennen."><img src="stat-modeling-mixed_files/figure-html/fig-mixed-school-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixed-school-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.5— Dreifachplot der Testergebnisse der Schüler zusammen über alle drei Klassen in den jeweiligen neun Schulen aufgetrennt nach dem Lehrformat. Teilweise sind starke Effekte der Schulen auf die Testergebnisse der Schüler zu erkennen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Jetzt schauen wir uns noch den Effekt der Klasse an und fragen uns in der <a href="#fig-mixed-school-3" class="quarto-xref">Abbildung&nbsp;<span>60.6</span></a>, ob wir auch einen starken Effekt der Klassen auf die Testergebnisse haben. Hier sehen wir zwar auch Unterschiede zwischen den Klassen, aber die Effekt sind in den Lehrformaten eher gleichmäßig vertreten. Die kleine Gruppe bei dem Lehrformat Frontal gehört zur einer Schule und nicht zu einer einzelnen Klasse. Damit könnten wir die Klasse eher ignorieren, wenn wir unser Modell bauen. Es macht nicht so einen großen Unterschied in welche Klasse ein Schüler gegangen ist.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  school_tbl <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> test, <span class="at">color =</span> class_in_school_id) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lehrformat"</span>, <span class="at">y =</span> <span class="st">"Testscore"</span>, <span class="at">color =</span> <span class="st">"Klasse"</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mixed-school-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixed-school-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-school-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;60.6— Dreifachplot der Testergebnisse der Schüler zusammen über alle Schulen in den jeweiligen drei Klassen aufgetrennt nach dem Lehrformat. Die Effekte der einzelnen Klassen sind nicht so stark ausgeprägt. Der Effekt der Schulen scheint in diesem Fall stärker zu sein."><img src="stat-modeling-mixed_files/figure-html/fig-mixed-school-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixed-school-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.6— Dreifachplot der Testergebnisse der Schüler zusammen über alle Schulen in den jeweiligen drei Klassen aufgetrennt nach dem Lehrformat. Die Effekte der einzelnen Klassen sind nicht so stark ausgeprägt. Der Effekt der Schulen scheint in diesem Fall stärker zu sein.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Gerade haben wir gesehen, dass die Schulen mehr der Varianz in den Testergebnissen der Schüler erklären als die Klassen. Brauchen wir eigentlich nur die Schulen oder reichen auch die Informationen die in den einzelnen Klassen stecken? Wir haben ja unsere Daten so gebaut, dass wir immer nur drei Klassen pro Schule haben und jeweils eine der drei Klassen ein Lehrformat erhält. Damit könnte es sein, dass wir mit dem Faktor <code>class_id</code> auch die Varianz der Schulen <code>scholl_id</code> mit abbilden könnten. Das funktioniert hier aber nur, da die immer die gleiche Anzahl an Klassen mit der gleichen Anzahl an Lehrformaten in einer Schule verschachtelt ist. Schauen wir dazu einmal in die <a href="#fig-mixed-school-2" class="quarto-xref">Abbildung&nbsp;<span>60.7</span></a>. Wie wir sehen, scheinen die einzelnen Klassen die jeweiligen Schulen mit abzubilden. Die Klasse 19, 20 und 21 ist beim Forntalunterreicht schlechter. Dies wird die Schule <em>Greenville School</em> sein. Wir können also alleine durch die Information zu den einzlenen Klassen die Varianz der Schulen erklären! Mal schauen, was das dann später für unser lineares gemischtes Modell bedeutet.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(school_tbl, <span class="fu">aes</span>(<span class="at">x =</span> class_id, <span class="at">y =</span> test, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Individuelle Klassen ID"</span>, <span class="at">y =</span> <span class="st">"Testscore"</span>, <span class="at">fill =</span> <span class="st">"Lehrformat"</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mixed-school-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixed-school-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-school-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;60.7— Boxplot der Testergebnisse der drei Lehrformate aufgeteilt nach den individuellen Klassen. Da immer nur drei Klassen pro Schule erhoben wurden, bilden die individuellen Klassen auch den Effekt der Schulen mit ab."><img src="stat-modeling-mixed_files/figure-html/fig-mixed-school-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixed-school-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.7— Boxplot der Testergebnisse der drei Lehrformate aufgeteilt nach den individuellen Klassen. Da immer nur drei Klassen pro Schule erhoben wurden, bilden die individuellen Klassen auch den Effekt der Schulen mit ab.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="weizendaten" class="level3" data-number="60.3.2">
<h3 data-number="60.3.2" class="anchored" data-anchor-id="weizendaten"><span class="header-section-number">60.3.2</span> Weizendaten</h3>
<p>Bei den Weizendaten haben wir auch die Positionen der einzelnen Parzellen durch die Faktoren <code>row</code> und <code>col</code>. Damit wissen wir an welcher Stelle die jeweiligen Parzellen auf dem Feld zu finden sind. Damit wissen wir dann auch, welche Behandlung mit Stickstoff und welche Weizenlinie wo aufgebracht wurde. In der <a href="#fig-mixed-desplot-yates" class="quarto-xref">Abbildung&nbsp;<span>60.8</span></a> sehen wir die Visualisierung des experimentellen Designs mit dem R Paket <code>{desplot}</code>. Wir sehen klar die Struktur der sechs Blöcke. In jedem Block finden sich die drei Sorten. In jeder Sorte wurde dann unterschiedlich mit Stickstoff gedüngt. Wir haben hier aber keine echte Spaltanlage vorliegen, da die Stickstoffbehandlung als Subplot quadratisch angeordnet ist. Später brauchen wir die Informationen um unser lineares gemischtes Modell sauber zu definieren.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">desplot</span>(oats_tbl, block <span class="sc">~</span> col<span class="sc">*</span>row, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">num =</span> nitro, <span class="at">col =</span> gen,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">aspect =</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">3</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">""</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mixed-desplot-yates" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixed-desplot-yates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-desplot-yates-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Abbildung&nbsp;60.8— Visualisierung des experimentellen Designs des Split plots für die Weizendaten. In sechs Blöcken wurden die drei Sorten aufgebracht. In jeder Sorte wurden wiederum die Sticktoffmengen randomisiert. Es kiegt keine echte Spaltanlage vor, da die Subplots innberhalb der Blöcke quadratisch angeordnet sind."><img src="stat-modeling-mixed_files/figure-html/fig-mixed-desplot-yates-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixed-desplot-yates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.8— Visualisierung des experimentellen Designs des Split plots für die Weizendaten. In sechs Blöcken wurden die drei Sorten aufgebracht. In jeder Sorte wurden wiederum die Sticktoffmengen randomisiert. Es kiegt keine echte Spaltanlage vor, da die Subplots innberhalb der Blöcke quadratisch angeordnet sind.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In den folgenden Tabs schauen wir uns dann einmal die Effekte der Weizenlinien sowie der Stickstoffdüngung auf den Ertrag an. Dabei trennen wir dann die Abbildung für die Blöcke auf. Auch hier wollen wir uns erstmal einen Überblick verschaffen und schauen, ob wir überhaupt einen Effekt von den Behandlungen haben oder aber ob die Blöcke sich einigermaßen gleich verhalten. Auch könnte es sein, dass die genetische Linien des Weizen an unterschiedlichen Standorten der Blöcke dann auf einmal doch andere Erträge bringen. All das wollen wir uns einmal in den folgenden Abbildungen anschauen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Effekt der Linie <code>gen</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Effekt des Stickstoff <code>nitro</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Effekt von <code>gen</code> in <code>block</code></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>In der <a href="#fig-mixed-yates-1-gen" class="quarto-xref">Abbildung&nbsp;<span>60.9</span></a> sehen wir die Ausiwkungend der Sorte des Weizens auf den Ertrag aufgeteilt nach den sechs Blöcken. Klar ist zu erkennen, dass der Block 4 teilweise zu sehr viel höheren Erträgen führt. Auch haben wir bei der Sorte <code>Victory</code> einzelne Gruppen von Pflanzen, die anscheinend mehr Ertrag im Block 4 produzieren. Hier liegt also eine klare Wechselwirkung zwischen den Blöcken und der Sorte vor. Der Block muss auf jeden Fall mit in das lineare gemischte Modell. Die Effekt über die Sorten hinweg deuten auf keinen Trend hin, im Mittel sind alle Sorten des Weizen gleich im Bezug auf den Ertrag.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  oats_tbl <span class="sc">+</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> gen, <span class="at">y =</span> plant_yield, <span class="at">color =</span> block) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Genetische Linie"</span>, <span class="at">y =</span> <span class="st">"Ertrag"</span>, <span class="at">color =</span> <span class="st">"Block"</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mixed-yates-1-gen" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixed-yates-1-gen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-yates-1-gen-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Abbildung&nbsp;60.9— Betrachtung der Auswirkungen der Sorte gen des Weizens auf den Ertrag, aufgeteilt nach den Blöcken. Einige Blöcke haben klar mehr Ertrag als andere Blöcke, wie auch schon bei den Stickstoffdüngungen."><img src="stat-modeling-mixed_files/figure-html/fig-mixed-yates-1-gen-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixed-yates-1-gen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.9— Betrachtung der Auswirkungen der Sorte <code>gen</code> des Weizens auf den Ertrag, aufgeteilt nach den Blöcken. Einige Blöcke haben klar mehr Ertrag als andere Blöcke, wie auch schon bei den Stickstoffdüngungen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Betrachten wir in der <a href="#fig-mixed-yates-1-nitro" class="quarto-xref">Abbildung&nbsp;<span>60.10</span></a> den Ertrag in Abhängigkeit von der Stickstoffdüngung. Auch hier teilen wir die Daten wieder nach den Blöcken auf. Zuerst sehen wir einen klaren Trend. mit der Zunahme der Stickstoffkonzentration nimmt auch der Ertrag zu. Dennoch haben wir auch hier ein klares Problem mit dem Block 4. Der Block 4 hat immer am meisten Ertrag über alle Stickstoffstufen. In der Dosis <code>0.4</code> gibt es sogar eine Gruppe von Beobachtungen, die eindeutig am meisten Ertrag im Block 4 liefert. Auch hier sehen wir wieder eine Abhängigkeit des Ertrags von dem Block. Gehen wir also mal der Struktur der Daten weiter nach.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  oats_tbl <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> nitro, <span class="at">y =</span> plant_yield, <span class="at">color =</span> block) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Stickstoffkonzentration"</span>, <span class="at">y =</span> <span class="st">"Ertrag"</span>, <span class="at">color =</span> <span class="st">"Block"</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mixed-yates-1-nitro" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixed-yates-1-nitro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-yates-1-nitro-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Abbildung&nbsp;60.10— Betrachtung der Auswirkungen der Stickstoffdüngung nitro des Weizens auf den Ertrag, aufgeteilt nach den Blöcken. Einige Blöcke haben klar mehr Ertrag als andere Blöcke, wie auch schon bei den Sorten."><img src="stat-modeling-mixed_files/figure-html/fig-mixed-yates-1-nitro-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixed-yates-1-nitro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.10— Betrachtung der Auswirkungen der Stickstoffdüngung <code>nitro</code> des Weizens auf den Ertrag, aufgeteilt nach den Blöcken. Einige Blöcke haben klar mehr Ertrag als andere Blöcke, wie auch schon bei den Sorten.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>Abschließend schauen wir nochmal in der <a href="#fig-mixed-yates-1-gen-block" class="quarto-xref">Abbildung&nbsp;<span>60.11</span></a> auf die Wechselwirkung zwischen den Blöcken und den Sorten. Hier sehen wir endlich unsere kleinen Gruppen, die wir auch schon in den beiden anderen Abbildungen gesehen haben klar zugeordnet. Die Sorten spalten sich klar über die Blöcke und Stickstoffgaben auf. Es macht also einen Unterschied wo wir die einzelnen Sorten gepflanzt haben. Die Blöcke und Sorten interagieren klar miteinander. Wir können also sagen, dass die Sorten in den Blöcken auf jeden Fall <em>genestet</em> sind. Wir werden also diese Struktur auf jeden Fall berücksichtigen müssen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  oats_tbl <span class="sc">+</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> nitro, <span class="at">y =</span> plant_yield, <span class="at">color =</span> block) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Stickstoffkonzentration"</span>, <span class="at">y =</span> <span class="st">"Ertrag"</span>, <span class="at">color =</span> <span class="st">"Block"</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> gen)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mixed-yates-1-gen-block" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixed-yates-1-gen-block-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-yates-1-gen-block-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Abbildung&nbsp;60.11— Betrachtung der Auswirkungen der Stickstoffdüngung nitro des Weizens auf den Ertrag, aufgeteilt nach den Blöcken und den Sorten des Weizens. Klar ist zu erkennen, dass einige Sorten in einigen Blöcken klar mehr Ertrag haben."><img src="stat-modeling-mixed_files/figure-html/fig-mixed-yates-1-gen-block-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixed-yates-1-gen-block-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.11— Betrachtung der Auswirkungen der Stickstoffdüngung <code>nitro</code> des Weizens auf den Ertrag, aufgeteilt nach den Blöcken und den Sorten des Weizens. Klar ist zu erkennen, dass einige Sorten in einigen Blöcken klar mehr Ertrag haben.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Jetzt wollen wir nochmal schauen, ob wir auch eine Interaktion zwischen der Stickstoffdüngung, den Weizensorten und den Blöcken vorliegen haben. Insbesondere müssen wir natürlich schauen, wie sich unsere beiden Behandlungen <code>nitro</code> und <code>gen</code> untereinander verhalten. Wenn wir hier auch eine Interaktion vorliegen haben, dann müssen wir diese Interaktion auch im Modell abbilden. Zuerst erschaffen wir uns aber die Mittelwerte über alle Faktorenkombinationen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>stat_oats_tbl <span class="ot">&lt;-</span> oats_tbl <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nitro, gen, block) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(plant_yield))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann sind wir wieder etwas faul und bauen uns erstmal ein <code>{ggplot}</code>-Template für die Interaktionsabbildungen. Sonst produzieren wir wieder sehr viel redunanten Code, was wir uns hier dann sparen können. Wir werden uns einfach die Mittelwerte über die Stickstoffgaben getrennt für die Sorten und die Blöcke einmal anschauen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>gg_inter_template <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)) <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#fig-mixed-yates-1-inter" class="quarto-xref">Abbildung&nbsp;<span>60.12</span></a> sehen wir einmal die Interaktionsplots für die verschiedenen möglichen Interaktionen zwischen den Faktoren der Stickstoffdüngung, der Weizensorte und den Blöcken. <a href="#fig-mixed-yates-1-inter-1" class="quarto-xref">Abbildung&nbsp;<span>60.12 (a)</span></a> zeigt klar, dass es keine Interaktion zwischen der Stickstoffdüngung und den Sorten gibt. Die Graden laufen parallel zueinander. Wir haben einen mittleren Effekt der Stickstoffdüngung, da wir einen Anstieg beobachten. Dennoch ist die Ordnung der Sorten pro Level der Stickstoffdüngung gleich. Würden sich die Graden überschneiden, hätten wir eine Interaktion vorliegen. Da die Graden das nicht tun, können wir also von keiner Interaktion zwischen <code>nitro</code> und <code>gen</code> ausgehen. Wir sehen aber auch in den beiden anderen Abbildungen, dass wir auf jeden Fall den Block mit modellieren müssen. Der Block hat zumindest einen visuellen Einfluss auf den Ertrag.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>gg_inter_template <span class="sc">%+%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  oats_tbl <span class="sc">+</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> nitro, <span class="at">y =</span> plant_yield, <span class="at">color =</span> gen, <span class="at">group =</span> gen) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Stickstoffkonzentration"</span>, <span class="at">y =</span> <span class="st">"Ertrag"</span>, <span class="at">color =</span> <span class="st">"Sorte"</span>) </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>gg_inter_template <span class="sc">%+%</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  oats_tbl <span class="sc">+</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> nitro, <span class="at">y =</span> plant_yield, <span class="at">color =</span> gen, <span class="at">group =</span> gen) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Stickstoffkonzentration"</span>, <span class="at">y =</span> <span class="st">"Ertrag"</span>, <span class="at">color =</span> <span class="st">"Sorte"</span>) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> block)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>gg_inter_template <span class="sc">%+%</span> </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  oats_tbl <span class="sc">+</span> </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> nitro, <span class="at">y =</span> plant_yield, <span class="at">color =</span> block, <span class="at">group =</span> block) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Stickstoffkonzentration"</span>, <span class="at">y =</span> <span class="st">"Ertrag"</span>, <span class="at">color =</span> <span class="st">"Block"</span>) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> gen) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-mixed-yates-1-inter" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixed-yates-1-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mixed-yates-1-inter" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-mixed-yates-1-inter-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mixed-yates-1-inter-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-yates-1-inter-1.png" class="lightbox" data-gallery="fig-mixed-yates-1-inter" title="Abbildung&nbsp;60.12&nbsp;(a)— Interaktion nitro:gen"><img src="stat-modeling-mixed_files/figure-html/fig-mixed-yates-1-inter-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-mixed-yates-1-inter" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mixed-yates-1-inter-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Interaktion <code>nitro:gen</code>
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mixed-yates-1-inter" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-mixed-yates-1-inter-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mixed-yates-1-inter-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-yates-1-inter-2.png" class="lightbox" data-gallery="fig-mixed-yates-1-inter" title="Abbildung&nbsp;60.12&nbsp;(b)— Interaktion nitro:gen:block"><img src="stat-modeling-mixed_files/figure-html/fig-mixed-yates-1-inter-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-mixed-yates-1-inter" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mixed-yates-1-inter-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Interaktion <code>nitro:gen:block</code>
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mixed-yates-1-inter" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-mixed-yates-1-inter-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mixed-yates-1-inter-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-yates-1-inter-3.png" class="lightbox" data-gallery="fig-mixed-yates-1-inter" title="Abbildung&nbsp;60.12&nbsp;(c)— Interaktion nitro:block:gen"><img src="stat-modeling-mixed_files/figure-html/fig-mixed-yates-1-inter-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-mixed-yates-1-inter" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mixed-yates-1-inter-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Interaktion <code>nitro:block:gen</code>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixed-yates-1-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.12— Interaktionsplot der Mittelwerte für die Stickstoffbehandlung <code>nitro</code>, den Sorten des Weizens <code>gen</code> sowie den Blöcken <code>block</code>. Dargestellt sind die Mittelwerte für die jeweilige Faktorkombination. Wenn wir <em>keine</em> Interaktion erwarten, dann laufen die Graden parallel zueinander.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="wurmdaten" class="level3" data-number="60.3.3">
<h3 data-number="60.3.3" class="anchored" data-anchor-id="wurmdaten"><span class="header-section-number">60.3.3</span> Wurmdaten</h3>
<p>In den vorherigen Datensätzen haben wir uns ein eher normalverteiltes Outcome angeschaut. In den Wurmdaten wollen wir uns einmal Zähldaten anschauen. Das hat natürlich auf den Plot des experimentellen Designs erstmal keinen Einfluss. Wir haben die Informationen zu den Reihen und den Spalten und können daran dann unser Latinsquare Design einmal in dem R Paket <code>{desplot}</code> in der <a href="#fig-mixed-desplot-wireworms" class="quarto-xref">Abbildung&nbsp;<span>60.13</span></a> darstellen. In einem Latinsquare Design ist jede unserer fünf Behandlungen genau einmal in jeder Reihe oder Spalte vertreten. Ich habe einmal die Parzellen nach den Behandlungen eingefärbt. Nochmal zur Erinnerung, die Buchstaben haben hier keine tiefere Bedeutung. Die Buchstaben stellen eben nur die fünf verschiedenen Insektiziede gegen den Wurmbefall dar.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">desplot</span>(wireworms_tbl, trt <span class="sc">~</span> col <span class="sc">*</span> row,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> trt, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">show.key =</span> <span class="cn">FALSE</span>,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">""</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mixed-desplot-wireworms" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixed-desplot-wireworms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-desplot-wireworms-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Abbildung&nbsp;60.13— Latinsquare Design der Insektizidbehandlung auf einem 5 \times 5 großen Versuchsfeld. Jede Behandlung ist genau einmal in jeder Reihe und jeder Spalte vertreten. Die Buchstaben sind willkürlich gewählt."><img src="stat-modeling-mixed_files/figure-html/fig-mixed-desplot-wireworms-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixed-desplot-wireworms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.13— Latinsquare Design der Insektizidbehandlung auf einem <span class="math inline">\(5 \times 5\)</span> großen Versuchsfeld. Jede Behandlung ist genau einmal in jeder Reihe und jeder Spalte vertreten. Die Buchstaben sind willkürlich gewählt.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt schauen wir uns in der <a href="#fig-mixed-wireworm-1" class="quarto-xref">Abbildung&nbsp;<span>60.14</span></a> nochmal die Effekte der Spalte und der Reihe auf die Anzahl der Würmer an. Hier muss man natürlich bedenken, dass die Reihen und die Spalten verschoben die gleichen Effekte haben. Den jede Spalte ist auch ein Teil einer Reihe und umgekehrt. Wir sehen aber sofort das es Problem mit der Spalte <code>1</code> sowie dann mit der Reihe <code>1</code> gibt. Hier haben wir bei der Insektizidbehandlung <code>N</code> sehr viel mehr Würmer als in den anderen Parzellen. Teilweise sehen wir auch Abweichungen nach oben bei den anderen Behandlungen, je nachdem welche Parzelle wir betrachten. Hier müssen wir auf jeden Fall unser Modell so anpassen, dass die Spalten und Reihen im Modell berücksichtigt werden.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  wireworms_tbl <span class="sc">+</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> count_worms, <span class="at">color =</span> col) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Insektizidbehandlung"</span>, <span class="at">y =</span> <span class="st">"Anzahl Würmer"</span>, <span class="at">color =</span> <span class="st">"Spalte (col)"</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">4.9</span>), <span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)) </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  wireworms_tbl <span class="sc">+</span> </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> count_worms, <span class="at">color =</span> row) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Insektizidbehandlung"</span>, <span class="at">y =</span> <span class="st">"Anzahl Würmer"</span>, <span class="at">color =</span> <span class="st">"Reihe (row)"</span>) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">4.9</span>), <span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-mixed-wireworm-1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixed-wireworm-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mixed-wireworm-1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-mixed-wireworm-1-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mixed-wireworm-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-wireworm-1-1.png" class="lightbox" data-gallery="fig-mixed-wireworm-1" title="Abbildung&nbsp;60.14&nbsp;(a)— Spalte (col)"><img src="stat-modeling-mixed_files/figure-html/fig-mixed-wireworm-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-mixed-wireworm-1" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mixed-wireworm-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Spalte (<code>col</code>)
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mixed-wireworm-1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-mixed-wireworm-1-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-mixed-wireworm-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-wireworm-1-2.png" class="lightbox" data-gallery="fig-mixed-wireworm-1" title="Abbildung&nbsp;60.14&nbsp;(b)— Reihe (row)"><img src="stat-modeling-mixed_files/figure-html/fig-mixed-wireworm-1-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-mixed-wireworm-1" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mixed-wireworm-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Reihe (<code>row</code>)
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixed-wireworm-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.14— Betrachtung der Auswirkung der verschiedenen Insketizidbehandlung auf die Anzahl von Würmern aufgeteilt für die Spalten und Reihen in einem Latinsquare Design. Teilweise sind die Effekte der Position <code>col</code> und <code>row</code> auf die Würmeranzahlen klar ersichtlich.
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="modellierung" class="level2" data-number="60.4">
<h2 data-number="60.4" class="anchored" data-anchor-id="modellierung"><span class="header-section-number">60.4</span> Modellierung</h2>
<p>Nachdem wir uns jetzt ausführlich mit der Visualisierung beschäftigt haben, werden wir uns jetzt einmal mit der Modellierung der lineare Modelle befassen. Häufig sind die Modelle sehr komplex und auch ich weiß dann immer nicht, was soll wie in ein Modell rein, deshalb muss ich auch am Ende immer verschiedene Modelle miteinander vergleichen. Das beste Modell sollte so wenige Faktoren und Interaktionen enthalten wie möglich, aber dennoch alle Quellen von möglicher Varianz abdecken. Daher lohnt es sich immer auch ein sehr einfaches Modell mit in die Analyse zu nehmen und zu schauen, ob es nicht auch mit einem einfachen Modell klappen würde. Nicht immer ist ein lineares gemischtes Modell die beste Lösung. Manchmal passt dann auch ein einfaches Modell mit nur festen Effekten.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Mindestanzahl an Leveln für einen zufälligen Effekt
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir brauchen mindestens 5 bis 6 Level für einen Faktor, den wir als zufälligen Effekt deklarieren. Das würde hier aber leider die Beispiele sehr komplex machen… deshalb hier mit weniger Leveln und dafür dann nicht so guten Ergebnissen.</p>
</div>
</div>
<p>Wir immer in R haben wir auch eine ganze Reihe von Paketen zu Verfügung um ein lineares gemischtes Modell zu schätzen. Damit die Sachlage hier nicht ausartet, konzentriere ich mich auf die großen zwei Pakete plus eine etwas andere Implementierung. Zum einen hat <span class="citation" data-cites="bates2014fitting">Bates et al. (<a href="#ref-bates2014fitting" role="doc-biblioref">2014</a>)</span> das <a href="https://cran.r-project.org/web/packages/lme4/vignettes/lmer.pdf">R Paket <code>{lme4}</code></a> entwickelt, welches uns erlaubt lineare gemischte Modelle in R anzuwenden. Es gibt noch das ältere R Paket <code>{nlme}</code> was ich aber nicht mehr für lineare gemischte Modelle nutze. Wir nutzen aber gerne die Funktion <code>gls()</code> aus dem R Paket <code>{nlme}</code>, wenn wir eine lineare Regression mit heterogenen Varianzen rechnen wollen. Eine andere Implementierung mit mehr Möglichkeiten, wenn es um nicht normalverteilte Daten geht, ist das <a href="https://glmmtmb.github.io/glmmTMB/index.html">R Paket <code>{glmmTMB}</code></a>. Wir haben hier insbesondere die Möglichkeit mehr Varianzstrukturen in den Daten abzubilden. Dazu dann gerne mehr in den Vignetten des R Pakets unter <a href="https://cran.r-project.org/web/packages/glmmTMB/vignettes/covstruct.html">Covariance structures with glmmTMB</a>. Du musst dich aber nicht tiefer Einlesen, im prinzip sind die Regeln ähnlich wie bei einem <code>glm()</code>. Mehr dazu dann aber gleich in dem entsprechenden Abschnitt zu dem R Paket <code>{glmmTMB}</code>. Teilweise sind die Ausgaben der verschiedenen R Paket schlecht miteinander zu vergleichen, da man nicht weiß, wo was wiedergegeben wird. Hier hilft das <a href="https://m-clark.github.io/mixedup/">R Paket <code>{mixedup}</code></a>, welches einem die Arbeit abnimmt gewisse Information aus einem Fit zu einem linearen gemischten Modell zu extrahieren. Abschließend schauen wir uns noch die Implementierung der linearen gemischten Modell in dem <a href="https://multilevelmod.tidymodels.org/articles/multilevelmod.html">R Paket <code>{multilevelmod}</code></a> an, da wir hier noch einfacher ein gemischtes Modell auswählen können. Wichtig ist hier zu wissen, dass die Funktionen aus <code>{glmmTMB}</code> nicht implementiert sind. Daher musst du dann schauen, was du brauchst und danach entscheiden. Ich stelle alle Varianten hier dann einmal vor.</p>
<p>In der folgenden Tabelle findest du nochmal die Schreibweise für die zufälligen Effekte in einem linearen gemischten Modell in R. Glücklicherweise ist die Schreibweise mittlerweile in R bindend und alle neueren Pakete nutzen auch diese Formelschreibweise der zufälligen Effekte. Im Allgmeinen definieren wir einen zufälligen Effekt mit <code>(1 | random)</code>. Wir wollen damit einen festen Mittelwert für jedes Level des zufälligen Faktors schätzen. Diese Schreibweise ist damit dann auch der Standard. Wenn du noch eine kontinuierliche Variable <code>c_1</code> in den Daten hättest, die sich innerhalb der zufälligen Effekte ändert, dann könntest du auch einen variierenden Mittelwert der zufälligen Effekte für die zusätzliche Variable mit <code>(c_1 | random)</code>schätzen. Aber dieser Fall tritt eher selten auf.</p>
<table class="caption-top table">
<caption>Bedeutung der Formelschreibweise der zufälligen Effekte in einem linearen gemischten Modell in <code>{lmer}</code> und <code>{glmmTMB}</code>. Mehr zu der Bedeutung dann in der Veröffentlichung von <span class="citation" data-cites="bates2014fitting">Bates et al. (<a href="#ref-bates2014fitting" role="doc-biblioref">2014</a>)</span>. Glücklicherweise ist die Schreibweise mittlerweile in R bindend und alle neueren Pakete nutzen auch diese Formelschreibweise der zufälligen Effekte.</caption>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Formula</th>
<th>Bedeutung</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\((1\; |\; g)\)</span></td>
<td>Zufälliger <span class="math inline">\(y\)</span>-Achsenabschnitt mit festen Mittelwert (eng. <em>Random intercept with fixed mean</em>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\((1\; |\; g_1/g_2)\)</span></td>
<td>Der <span class="math inline">\(y\)</span>-Achsenabschnitt variiert in <span class="math inline">\(g_1\)</span> und <span class="math inline">\(g_2\)</span> innerhalb von <span class="math inline">\(g_1\)</span> (eng. <em>Intercept varying among g1 and g2 within g1</em>)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\((1\; |\; g_1) + (1\; |\; g_2)\)</span></td>
<td>Der <span class="math inline">\(y\)</span>-Achsenabschnitt variiert zwischen <span class="math inline">\(g_1\)</span> und <span class="math inline">\(g_2\)</span> (eng. <em>Intercept varying among g1 and g2</em>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(x + (x\; |\; g)\)</span></td>
<td>Korrelierter zufälliger <span class="math inline">\(y\)</span>-Achsenabschnitt und Steigung (eng. <em>Correlated random intercept and slope</em>)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x + (x\; ||\; g)\)</span></td>
<td>Unkorrelierter zufälliger <span class="math inline">\(y\)</span>-Achsenabschnitt und Steigung (eng. <em>Uncorrelated random intercept and slope</em>)</td>
</tr>
</tbody>
</table>
<p>Manchmal ist es etwas schwierig sich vorzustellen was die Formelschreiweise genau bedeutet. Daher habe ich nochmal die jeweilige Bedeutung visulaisiert. <a href="https://bookdown.org/steve_midway/DAR/random-effects.html">Die Quelle der Abbdilung ist das Openbook von Steve Midway</a> und geht nochmal mit tollen Beispielen auf die verschiedenen Fälle ein.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-anova-repeated-fac3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-anova-repeated-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-ggplot-anova-repeated-fac3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Abbildung&nbsp;60.15— Visualisierung der verschiedenen Modelle eines linearen Modells und linearen gemischten Modellen mit Messweiderholungen mit drei Individuen. (A) Klassisches lineares Modell mit zwei Parametern für den y-Achsenabschnitt \alpha und der Steigung \beta. (B) Gemischtes Modell mit einem festen y-Achsenabschnitt \alpha sowie variable Steigungen für die Individuen. (C) Ein gemischtes Modell mit variablen y-Achsenabschnitt \alpha sowie einer festen Steigung \beta. (D) Ein gemischtes Modell mit einem variablen y-Achsenabschnitt \alpha sowie variabler Steigung \beta [Zum Vergrößern anklicken]"><img src="stat-modeling-mixed_files/figure-html/fig-ggplot-anova-repeated-fac3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="912"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-anova-repeated-fac3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.15— Visualisierung der verschiedenen Modelle eines linearen Modells und linearen gemischten Modellen mit Messweiderholungen mit drei Individuen. <strong>(A)</strong> Klassisches lineares Modell mit zwei Parametern für den y-Achsenabschnitt <span class="math inline">\(\alpha\)</span> und der Steigung <span class="math inline">\(\beta\)</span>. <strong>(B)</strong> Gemischtes Modell mit einem festen y-Achsenabschnitt <span class="math inline">\(\alpha\)</span> sowie variable Steigungen für die Individuen. <strong>(C)</strong> Ein gemischtes Modell mit variablen y-Achsenabschnitt <span class="math inline">\(\alpha\)</span> sowie einer festen Steigung <span class="math inline">\(\beta\)</span>. <strong>(D)</strong> Ein gemischtes Modell mit einem variablen y-Achsenabschnitt <span class="math inline">\(\alpha\)</span> sowie variabler Steigung <span class="math inline">\(\beta\)</span> <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<section id="mitteln-über-einen-zufälligen-effekt" class="level3" data-number="60.4.1">
<h3 data-number="60.4.1" class="anchored" data-anchor-id="mitteln-über-einen-zufälligen-effekt"><span class="header-section-number">60.4.1</span> Mitteln über einen zufälligen Effekt</h3>
<p>Manchmal können wir das auch mit den gemischten Modellen einfach lassen und über eine Faktor mitteln und dann ist auch gut. Damit haben wir dann die individuelle Variabilität “weggemittelt”. Das funktioniert in einem balancierten Design teilweise hervorragend und ist auf jeden Fall immer einen Versuch wert. Bei komplexeren Designs lässt sich manchmal dann leider nicht gut festlegen über welchen Faktor am besten gemittelt werden sollte. Dann hilft eben doch nur ein komplexeres gemischtes Modell. Haben wir aber über einen Faktor gemittelt, können wir alles nur mit festen Effekten in einem <code>lm()</code> oder <code>glm()</code> lösen. Das macht uns dann das Modellieren sehr viel einfacher. Deshalb hier einmal als Beispiel das Mitteln über die einzelnen Klassen und damit auch über die Schüler. Wir kriegen dann einen Mittelwert pro Klasse und nehmen damit die individuelle Varianz aus unseren Daten raus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mean_school_tbl <span class="ot">&lt;-</span> school_tbl <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(school_id, trt, class_id) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_test =</span> <span class="fu">mean</span>(test))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Nachdem wir über den Faktor <code>class_id</code> gemittelt haben, können wir dann einfach ein lineares Modell mit der Funktion <code>lm()</code> rechnen. Dann schaue ich gleich nochmal im Abschnitt zu dem R Paket <code>lme4()</code> wie gut unser Modell abschneidet. Wir werden vermutlich einen kleineren Fehler haben, da wir natürlich auch Variabilität wegmitteln. Aber das ist ja auch das Ziel der Übung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mean_lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(mean_test <span class="sc">~</span> trt <span class="sc">+</span> school_id <span class="sc">+</span> trt<span class="sc">:</span>school_id, <span class="at">data =</span> mean_school_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ich kann immer nur empfehlen, einmal den Schritt zu machen und über die individuellen Pflanzen oder Beobachtungen zu mitteln. Häufig lässt sich damit dann ein gemischtes Modell vermeiden, was dann auch die Interpretation der Ergebnisse und deren Darstellung einfacher macht.</p>
</section>
<section id="mit-dem-r-paket-lme4" class="level3" data-number="60.4.2">
<h3 data-number="60.4.2" class="anchored" data-anchor-id="mit-dem-r-paket-lme4"><span class="header-section-number">60.4.2</span> … mit dem R Paket <code>{lme4}</code></h3>
<p>Das <a href="https://cran.r-project.org/web/packages/lme4/vignettes/lmer.pdf">R Paket <code>{lme4}</code></a> von <span class="citation" data-cites="bates2014fitting">Bates et al. (<a href="#ref-bates2014fitting" role="doc-biblioref">2014</a>)</span> ist das Standardpaket, welches uns erlaubt lineare gemischte Modelle in R anzuwenden. Hier gibt es dann auch mit der Hilfeseite <a href="https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#should-i-treat-factor-xxx-as-fixed-or-random">GLMM FAQ – Ben Bolker and others</a> auch umfangreiche Informationen und Ratschläge für die Nutzung. Auch hier musst du dort nicht alles nachlesen um ein lineares gemischtes Modell in R rechnen zu können. Manchmal kommt es aber zu Problemen im Fit des Modells, so dass hier dann Hilfe zu finden ist. Im Folgenden schauen wir uns einmal die Implementierung von <code>{lme4}</code> für die Schuldaten an. Wir nutzen dazu die Hauptfunktion <code>lmer()</code>, wenn wir normalverteilte Daten als Outcome vorliegen haben. Mit einem Testscore können wir davon ausgehen, dass dieser normalverteilt ist. Wir rechnen jetzt verschiedene Modelle in den folgenden Tabs und schauen dann im Anschluss einmal, welches der Modelle das beste Modell ist. Das beste Modell könnten wir dann zum Beispiel in einem Gruppenvergleich weiter nutzen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true"><code>lmer()</code> 2-faktoriell ungenested</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false"><code>lmer()</code> 3-faktoriell ungenested</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false"><code>lmer()</code> 3-faktoriell genested</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Beginnen wollen wir mit dem einfachsten linearen gemischten Modell. Wir haben hier nur einen festen Effekt <code>trt</code> sowie einen zufälligen Effekt <code>school_id</code> vorliegen. Damit ignorieren wir die Varianzen aus den Klassen. Wir schauen also, ob wir mit einem etwas simpleren Modell schon ein gutes Ergebnis erhalten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>lmer_2fac_fit <span class="ot">&lt;-</span> <span class="fu">lmer</span>(test <span class="sc">~</span> trt <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">|</span> school_id), </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> school_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wie gut hat nun das Modell geklappt? Fangen wir einmal mit einem <span class="math inline">\(R^2\)</span> an. Ähnlich wie das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> gibt der <em>Intraclass Correlation Coefficient</em> (abk. <em>ICC</em>) Aufschluss über die erklärte Varianz und kann als “der Anteil der Varianz, der durch die Gruppierungsstruktur in den Daten erklärt wird” interpretiert werden. Damit haben wir dann auch eine Maßzahl, wie gut unser gemischtes Modell funktioniert hat. Uns interessiert hier nur das adjustierte ICC.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lmer_2fac_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.880
  Unadjusted ICC: 0.213</code></pre>
</div>
</div>
<p>Das sieht gar nicht schlecht aus für einen ersten Versuch. Mit einem ICC von <span class="math inline">\(0.88\)</span> sind wir schon ziemlich weit oben an der Grenze. Jetzt müssen wir noch schauen, wie die anderen Maßzahlen aussehen. Eventuell reicht dieses einfache Modell schon aus um unsere Daten zu modellieren und zu erklären. Wir nutzen hier die Funktion <a href="https://easystats.github.io/performance/reference/model_performance.lm.html"><code>model_performance()</code> aus dem R Paket <code>{performance}</code></a> um zu schauen, wie gut unser Modell dann zu den Daten gepasst hat.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>lmer_2fac_fit <span class="sc">|&gt;</span> <span class="fu">model_performance</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
--------------------------------------------------------------------------------
3154.459 | 3154.572 | 3175.917 |      0.971 |      0.758 | 0.880 | 4.271 | 4.307</code></pre>
</div>
</div>
<p>Hier schauen wir einmal auf das <code>R2 (marg.)</code>, was auch eine andere Art des Bestimmtheitsmaßes für die festen Effekte ist. Also auch hier jetzt die Frage, wieviel Prozent der Varianz erklären meine festen Effekte? Hier liefert dann das <code>R2 (marg.)</code> eine Antwort. Das <code>R2 (cond.)</code> berücksichtigt sowohl die festen als auch die zufälligen Effekte bei der Berechnung des <span class="math inline">\(R^2\)</span>. Damit haben wir hier die erklärte Varianz von festen und zufälligen Effekten bei <span class="math inline">\(0.97\)</span>, also über <span class="math inline">\(97\%\)</span>. Hier haben wir ein echt gutes Modell vorliegen. Die anderen Maßzahlen brauchen wir nur für einen direkten Vergleich von Modellen.</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Nachdem wir schon recht gute Ergebnisse mit dem simplen gemischten Modell mit nur einem zufälligen Effekt erreicht haben, nehmen wir jetzt noch neben dem Effekt der Schule den Effekt der Klassen <code>class_in_school_id</code> als zufälligen Effekt mit ins Modell. Dann wollen wir mal schauen, ob dieses Modell dann besser ist als das einfache Modell. Unser einfaches Modell ist schon so gut, dass wir hier kaum noch Steigerungen hinkriegen und wir müssen uns dann am Ende fragen, ob nicht ein einfacheres Modell nicht auch reichen würde.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>lmer_3fac_fit <span class="ot">&lt;-</span> <span class="fu">lmer</span>(test <span class="sc">~</span> trt <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">|</span> class_in_school_id) <span class="sc">+</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">|</span> school_id), </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> school_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Auch hier berechnen wir dann einmal den <em>Intraclass Correlation Coefficient</em> (abk. <em>ICC</em>) um mehr über die erklärte Varianz der zufälligen Effekte zu erfahren. Der ICC steigt noch um einen winzigen Betrag gegenüber dem simpleren Modell mit nur einem zufälligen Effekt. Ob sicher hier der Umstieg lohnt, muss man dann nochmal überlegen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>lmer_3fac_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.891
  Unadjusted ICC: 0.216</code></pre>
</div>
</div>
<p>Dann schauen wir uns nochmal die Werte für <code>R2 (cond.)</code> und <code>R2 (marg.)</code> an und sehen, dass wir hier auch nur eine kleine Steigerung in den Werten haben. Wir erklären zwar noch mehr Varianz, aber der Anteil ist doch recht gering.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>lmer_3fac_fit <span class="sc">|&gt;</span> <span class="fu">model_performance</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
--------------------------------------------------------------------------------
3115.541 | 3115.699 | 3141.291 |      0.974 |      0.757 | 0.891 | 4.077 | 4.119</code></pre>
</div>
</div>
<p>Am Ende musst du dann überlegen, ob sich hier noch eine weitere Modellierung lohnt. Wir kommen zwar noch höher mit den Werten für das Bestimmtheitsmaß, aber dann wird auch das Modell auch um einiges komplizierter. Daher kannst du dir als letztes noch das genestete Modell einmal anschauen.</p>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>Jetzt bleibt uns eigentlich nur noch als Modell ein genestetes gemischtes Modell übrig indem wir dann die Klassen in den Schulen genestet modellieren. Das entspricht dann natürlich exakt der Abhängigkeitsstruktur, wie wir auch unsere Daten gebaut haben. Also sollten wir mit dem folgenden Modell auch fast die gesamte Varianz erklären. Im echten Leben kennen wir natürlich nicht die Art und Weise wie die Daten entstanden sind. Deshalb hier als Demonstration das Modell mit einem genesteten, zufälligen Term für die Klassen in den Schulen dargestellt durch <code>(1 | class_id/school_id)</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>lmer_3fac_nested_fit <span class="ot">&lt;-</span> <span class="fu">lmer</span>(test <span class="sc">~</span> trt <span class="sc">+</span>  </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                               (<span class="dv">1</span> <span class="sc">|</span> class_id<span class="sc">/</span>school_id), </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> school_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Auch heir schauen wir dann einmal den <em>Intraclass Correlation Coefficient</em> (abk. <em>ICC</em>) an und sehen, dass der Wert fast Eins ist. Das wundert uns natürlich nicht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>lmer_3fac_nested_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.967
  Unadjusted ICC: 0.195</code></pre>
</div>
</div>
<p>Und dann sehen wir auch, dass wir mit unseren Modell mit den genesteten zufälligen Effekten ein <code>R2 (cond.)</code> von über <span class="math inline">\(99\%\)</span> erreichen. Damit bildet unser genestetes Modell exakt die Abhängigkeitsstruktur wieder, mit der wir auch die Daten gebaut haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>lmer_3fac_nested_fit <span class="sc">|&gt;</span> <span class="fu">model_performance</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |  RMSE | Sigma
--------------------------------------------------------------------------------
2458.714 | 2458.871 | 2484.463 |      0.993 |      0.798 | 0.967 | 1.968 | 2.019</code></pre>
</div>
</div>
<p>Damit habe ich gezeigt, dass wir auch ein perfektes Modell erhalten können, wenn wir wissen wie die Daten erschaffen wurden. Unsere anderen Modelle sind noch so gut, da ich ein sehr balanciertes Design für die Erstellung der Schuldaten gewählt habe. Wenn die Klassen unterschiedliche groß wären und auch unterschiedliche Anzahlen von Klassen pro Schule vorliegen würden, dann sehen die anderen Modelle bedeutend schlechter aus.</p>
</div>
</div>
</div>
<p>Manchmal möchten wir dann doch noch mehr Informationen als den <em>Intraclass Correlation Coefficient</em> (abk. <em>ICC</em>) oder das <code>R2 (cond.)</code> oder das <code>R2 (marg.)</code> aus dem linearen gemischten Modell extrahieren. Da mir das aber dann aktuell zu weit geht und hier auch nicht mehr erklärt, verweise ich auf die folgenden Funktionen aus dem R Paket <code>{mixedup}</code>. Du erhälst mit den Funktionen die Effekte für die zufälligen wie auch festen Effekte und das auch übergreifend für andere Pakte. Manchmal ist auch die Funktion <code>summary()</code> sehr klobig für ein <code>lmer()</code>-Objekt, da hilft dann die Funktion <code>summarize_model()</code>. In seltenen Fällen bist du dann auch an der Varianzstruktur und deren Schätzern interessiert, dafür gibt es dann auch noch die Funktion <code>extract_vc()</code>. Ich führe die Funktionen hier jetzt nicht aus, da wir einfach nur Output produzieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_random_effects</span>(lmer_2fac_fit)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_fixed_effects</span>(lmer_2fac_fit)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize_model</span>(lmer_2fac_fit)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_vc</span>(lmer_2fac_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir schauen uns dann einmal in einer Übersichtstabelle die drei Modelle an. Im folgenden Kasten findest du den Modellvergleich mit dem R Paket <code>{modelsummary}</code>. Wir können hier verschiedenste Sachen anschauen. Wichtig ist zum Beispiel ganz am Ende der <span class="math inline">\(RMSE\)</span>. Je kleiner der <em>root mean square error</em> ist, desto besser ist das Modell. Hier sehen wir, dass wir das beste Modell mit <code>lmer_3fac_nested_fit</code> vorliegen haben. Der <span class="math inline">\(RSME\)</span> ist mit 1.97 am kleinsten. Danach kommt aber schon das simple lineare Modell mit nur den festen Effekten. Da das <code>lm</code>-Modell auch fast <span class="math inline">\(96.5\%\)</span> der Varianz erklärt können wir auch das <code>lm</code>-Modell hier nehmen und haben dann ein einfacheres Modell, was wir dann auch einfacher beschreiben können. Da musst du dann abwägen, aber es muss ja nicht immer komplex sein. Ein gutes, solides Modell reicht ja auch.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modellvergleich mit <code>modelsummary()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"lm (mean model)"</span> <span class="ot">=</span> mean_lm_fit, </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"lmer 2-fakoriell"</span> <span class="ot">=</span> lmer_2fac_fit, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"lmer 3-fakoriell genested"</span> <span class="ot">=</span> lmer_3fac_nested_fit,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"lmer 3-fakoriell ungenested"</span> <span class="ot">=</span> lmer_3fac_fit),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"conf.int"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"s.e. = {std.error}"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_x2ati74m061clzacp639</title>
    <style>
.table td.tinytable_css_kr67ig3ifqdsjt16vyb5, .table th.tinytable_css_kr67ig3ifqdsjt16vyb5 {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_4m5f30kn983fxutyfllk, .table th.tinytable_css_4m5f30kn983fxutyfllk {    text-align: left; }
.table td.tinytable_css_pvboo8qjdudtcd3xoibr, .table th.tinytable_css_pvboo8qjdudtcd3xoibr {    text-align: center; }
.table td.tinytable_css_7wsxmhbqvbriojl540wj, .table th.tinytable_css_7wsxmhbqvbriojl540wj {    text-align: center; }
.table td.tinytable_css_y6thbepse7xrfbdy3m30, .table th.tinytable_css_y6thbepse7xrfbdy3m30 {    text-align: center; }
.table td.tinytable_css_zqmzpcvuzd3nbxs69h69, .table th.tinytable_css_zqmzpcvuzd3nbxs69h69 {    text-align: center; }
.table td.tinytable_css_qyig6p7d4q0241gxlrwg, .table th.tinytable_css_qyig6p7d4q0241gxlrwg {    border-bottom: solid 0.05em black; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_x2ati74m061clzacp639" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">lm (mean model)</th>
                <th scope="col">lmer 2-fakoriell</th>
                <th scope="col">lmer 3-fakoriell genested</th>
                <th scope="col">lmer 3-fakoriell ungenested</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)                      </td>
                  <td>66.341            </td>
                  <td>60.683           </td>
                  <td>60.683            </td>
                  <td>60.683           </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>[60.709, 71.973]  </td>
                  <td>[47.419, 73.948] </td>
                  <td>[53.547, 67.819]  </td>
                  <td>[47.306, 74.060] </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>s.e. = 2.681      </td>
                  <td>s.e. = 6.752     </td>
                  <td>s.e. = 3.633      </td>
                  <td>s.e. = 6.810     </td>
                </tr>
                <tr>
                  <td>trtFlipped classroom             </td>
                  <td>-39.715           </td>
                  <td>-28.335          </td>
                  <td>-28.335           </td>
                  <td>-28.335          </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>[-47.680, -31.750]</td>
                  <td>[-47.093, -9.576]</td>
                  <td>[-38.426, -18.243]</td>
                  <td>[-47.093, -9.576]</td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>s.e. = 3.791      </td>
                  <td>s.e. = 9.549     </td>
                  <td>s.e. = 5.137      </td>
                  <td>s.e. = 9.549     </td>
                </tr>
                <tr>
                  <td>trtHyFlex                        </td>
                  <td>32.491            </td>
                  <td>25.569           </td>
                  <td>25.569            </td>
                  <td>25.569           </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>[24.526, 40.457]  </td>
                  <td>[6.810, 44.327]  </td>
                  <td>[15.477, 35.660]  </td>
                  <td>[6.810, 44.327]  </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>s.e. = 3.791      </td>
                  <td>s.e. = 9.549     </td>
                  <td>s.e. = 5.137      </td>
                  <td>s.e. = 9.549     </td>
                </tr>
                <tr>
                  <td>school_idClinton Christian       </td>
                  <td>0.542             </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>[-7.423, 8.507]   </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>s.e. = 3.791      </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>school_idGreenville School       </td>
                  <td>-17.515           </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>[-25.480, -9.550] </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>s.e. = 3.791      </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>school_idJacksonville High       </td>
                  <td>-2.892            </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>[-10.857, 5.073]  </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>s.e. = 3.791      </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>school_idArlington Academy       </td>
                  <td>20.060            </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>[12.095, 28.025]  </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>s.e. = 3.791      </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>school_idFranklin Country        </td>
                  <td>-13.406           </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>[-21.371, -5.441] </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>s.e. = 3.791      </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>school_idGeorgetown High         </td>
                  <td>-24.335           </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>[-32.300, -16.370]</td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>                                 </td>
                  <td>s.e. = 3.791      </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>SD (Observations)                </td>
                  <td>                  </td>
                  <td>4.307            </td>
                  <td>2.019             </td>
                  <td>4.119            </td>
                </tr>
                <tr>
                  <td>SD (Intercept school_id)         </td>
                  <td>                  </td>
                  <td>11.682           </td>
                  <td>                  </td>
                  <td>11.683           </td>
                </tr>
                <tr>
                  <td>SD (Intercept school_idclass_id) </td>
                  <td>                  </td>
                  <td>                 </td>
                  <td>10.528            </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>SD (Intercept class_id)          </td>
                  <td>                  </td>
                  <td>                 </td>
                  <td>2.776             </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>SD (Intercept class_in_school_id)</td>
                  <td>                  </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>1.529            </td>
                </tr>
                <tr>
                  <td>Num.Obs.                         </td>
                  <td>27                </td>
                  <td>540              </td>
                  <td>540               </td>
                  <td>540              </td>
                </tr>
                <tr>
                  <td>R2                               </td>
                  <td>0.976             </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>R2 Adj.                          </td>
                  <td>0.965             </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>R2 Marg.                         </td>
                  <td>                  </td>
                  <td>0.758            </td>
                  <td>0.798             </td>
                  <td>0.757            </td>
                </tr>
                <tr>
                  <td>R2 Cond.                         </td>
                  <td>                  </td>
                  <td>0.971            </td>
                  <td>0.993             </td>
                  <td>0.974            </td>
                </tr>
                <tr>
                  <td>AIC                              </td>
                  <td>168.6             </td>
                  <td>3154.5           </td>
                  <td>2458.7            </td>
                  <td>3115.5           </td>
                </tr>
                <tr>
                  <td>BIC                              </td>
                  <td>181.5             </td>
                  <td>3175.9           </td>
                  <td>2484.5            </td>
                  <td>3141.3           </td>
                </tr>
                <tr>
                  <td>ICC                              </td>
                  <td>                  </td>
                  <td>0.9              </td>
                  <td>1.0               </td>
                  <td>0.9              </td>
                </tr>
                <tr>
                  <td>Log.Lik.                         </td>
                  <td>-74.294           </td>
                  <td>                 </td>
                  <td>                  </td>
                  <td>                 </td>
                </tr>
                <tr>
                  <td>RMSE                             </td>
                  <td>3.79              </td>
                  <td>4.27             </td>
                  <td>1.97              </td>
                  <td>4.08             </td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_p5wxir3mvnugnkxqmlbs(i, j, css_id) {
        var table = document.getElementById("tinytable_x2ati74m061clzacp639");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_x2ati74m061clzacp639');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_p5wxir3mvnugnkxqmlbs(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_x2ati74m061clzacp639");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(0, 0, 'tinytable_css_kr67ig3ifqdsjt16vyb5') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(0, 1, 'tinytable_css_kr67ig3ifqdsjt16vyb5') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(0, 2, 'tinytable_css_kr67ig3ifqdsjt16vyb5') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(0, 3, 'tinytable_css_kr67ig3ifqdsjt16vyb5') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(0, 4, 'tinytable_css_kr67ig3ifqdsjt16vyb5') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(0, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(1, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(2, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(3, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(4, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(5, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(6, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(7, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(8, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(9, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(10, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(11, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(12, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(13, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(14, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(15, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(16, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(17, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(18, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(19, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(20, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(21, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(22, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(23, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(24, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(25, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(26, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(27, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(28, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(29, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(30, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(31, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(32, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(33, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(34, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(35, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(36, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(37, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(38, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(39, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(40, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(41, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(42, 0, 'tinytable_css_4m5f30kn983fxutyfllk') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(0, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(1, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(2, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(3, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(4, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(5, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(6, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(7, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(8, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(9, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(10, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(11, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(12, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(13, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(14, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(15, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(16, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(17, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(18, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(19, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(20, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(21, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(22, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(23, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(24, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(25, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(26, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(27, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(28, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(29, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(30, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(31, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(32, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(33, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(34, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(35, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(36, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(37, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(38, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(39, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(40, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(41, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(42, 1, 'tinytable_css_pvboo8qjdudtcd3xoibr') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(0, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(1, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(2, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(3, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(4, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(5, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(6, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(7, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(8, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(9, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(10, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(11, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(12, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(13, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(14, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(15, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(16, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(17, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(18, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(19, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(20, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(21, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(22, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(23, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(24, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(25, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(26, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(27, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(28, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(29, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(30, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(31, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(32, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(33, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(34, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(35, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(36, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(37, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(38, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(39, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(40, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(41, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(42, 2, 'tinytable_css_7wsxmhbqvbriojl540wj') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(0, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(1, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(2, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(3, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(4, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(5, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(6, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(7, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(8, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(9, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(10, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(11, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(12, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(13, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(14, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(15, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(16, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(17, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(18, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(19, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(20, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(21, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(22, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(23, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(24, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(25, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(26, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(27, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(28, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(29, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(30, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(31, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(32, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(33, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(34, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(35, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(36, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(37, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(38, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(39, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(40, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(41, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(42, 3, 'tinytable_css_y6thbepse7xrfbdy3m30') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(0, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(1, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(2, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(3, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(4, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(5, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(6, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(7, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(8, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(9, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(10, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(11, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(12, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(13, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(14, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(15, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(16, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(17, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(18, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(19, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(20, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(21, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(22, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(23, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(24, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(25, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(26, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(27, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(28, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(29, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(30, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(31, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(32, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(33, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(34, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(35, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(36, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(37, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(38, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(39, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(40, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(41, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(42, 4, 'tinytable_css_zqmzpcvuzd3nbxs69h69') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(32, 0, 'tinytable_css_qyig6p7d4q0241gxlrwg') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(32, 1, 'tinytable_css_qyig6p7d4q0241gxlrwg') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(32, 2, 'tinytable_css_qyig6p7d4q0241gxlrwg') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(32, 3, 'tinytable_css_qyig6p7d4q0241gxlrwg') })
window.addEventListener('load', function () { styleCell_tinytable_p5wxir3mvnugnkxqmlbs(32, 4, 'tinytable_css_qyig6p7d4q0241gxlrwg') })
    </script>

  


</div>
</div>
</div>
</div>
</div>
<p>Und dann nochmal die visuelle Überprüfung mit <code>check_model()</code>. Hier schauen wir einmal, ob unser lineares gemischtes Modell dann auch funktioniert hat. Das praktische an der Funktion ist, dass wir in den Überschriften zu den einzelnen Abbildungen immer lesen könne, was wir in den Abbildungen sehen müssen, wenn die Annahme erfüllt sein soll. Wir haben hier also eine wunderbare visuelle Überprüfung des Modells. Ich mache das ganze jetzt nur für das Modell <code>lmer_2fac_fit</code>, was etwas willkürlich ist, aber sonst haben wir hier zig Abbildungen. Du kannst dann ja einfach selber bei den anderen Modellen schauen.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modellüberprüfung mit <code>check_model()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lmer_2fac_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mixed-school-model-check" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixed-school-model-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-school-model-check-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Abbildung&nbsp;60.16— Überprüfung des Modells mit der Funktion check_model() aus dem R Paket {performance}. Eine Reihe von Annahmen an das Modell wird in verschiedenen Abbildungen visuell überprüft. Unter den Überschriften steht die Annahme an die Abbildung und wann die Annahme in der Überschrift als erfüllt gilt."><img src="stat-modeling-mixed_files/figure-html/fig-mixed-school-model-check-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixed-school-model-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.16— Überprüfung des Modells mit der Funktion <code>check_model()</code> aus dem R Paket <code>{performance}</code>. Eine Reihe von Annahmen an das Modell wird in verschiedenen Abbildungen visuell überprüft. Unter den Überschriften steht die Annahme an die Abbildung und wann die Annahme in der Überschrift als erfüllt gilt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Bei den Schuldaten sind wir von einem normalverteilten Outcome <code>testscore</code> ausgegangen. Das R Paket <code>{lme4}</code> hat auch die Möglichkeit mit nicht normalverteilten Daten über die Funktion <code>glmer()</code> umzugehen. Da schauen wir aber gleich mal rein und zwar bei den Würmerdaten und stellen dabei auch das R Paket <code>{glmmTMB}</code> als Alternative vor. Du könnest aber den folgenden Abschnitt auch einfach mit einem <code>glmer()</code> rechnen aus dem Paket <code>{lme4}</code> rechnen, aber das R Paket <code>{glmmTMB}</code> hat ein paar Vorteile bei der Modellierung von nicht-normalverteilten Daten.</p>
</section>
<section id="mit-dem-r-paket-glmmtb" class="level3" data-number="60.4.3">
<h3 data-number="60.4.3" class="anchored" data-anchor-id="mit-dem-r-paket-glmmtb"><span class="header-section-number">60.4.3</span> … mit dem R Paket <code>{glmmTB}</code></h3>
<p>Hier schauen wir uns einmal den Datensatz zu den Würmern an. Wir haben hier kein normalverteiltes Outcome mehr vorliegen sondern zählen ja die Würmer. Wenn wir Zähldaten vorliegen haben, dann nutzen wir die Poissonverteilung um die Daten auszuwerten. Dazu müssen wir dann aber die Funktion <code>glmer()</code> verwenden, welche uns erlaubt auch eine andere Verteilung für das Outcome zu nutzen. Die Funktion <code>glmer()</code> ist in dem R Paket <code>{lme4}</code> implementiert und funktioniert nur, wenn du keine Overdispersion in den Daten vorliegen hast. Overdispersion bedeutet, dass die Varianz mit dem Mittelwert überproportional ansteigt. In einer Poissonverteilung steigt die Varianz der Daten mit dem Mittelwert der Zähldaten in einem 1:1 Verhältnis an. Wenn du ein größeres Verhältnis hast, also mit steigenden Mittelwert proportional größere Varianzen, dann liegt Overdispersion vor. Dafür haben wir dann gleich die Funktion <code>check_overdispersion()</code>. Wichtig ist, dass du keine Poissonregression rechnen kannst, wenn du Overdispersion vorliegen hast. Dann musst du deine Poissonregression für die Overdispersion adjustieren indem du eine andere Verteilungsfamilie wählst. Leider sind in <code>{lme4}</code> keine anderen Poissonfamilien implementiert, so dass wir dann auf das <a href="https://glmmtmb.github.io/glmmTMB/index.html">R Paket <code>{glmmTMB}</code></a> ausweichen. In dem R Paket <code>{glmmTMB}</code> gibt es eine reichhaltige Auswahl an Kovarianzstrukturen und Möglichkeiten Abhängigkeiten zu modellieren. Mehr dazu findest du auf der Hilfeseite zu <a href="https://cran.r-project.org/web/packages/glmmTMB/vignettes/covstruct.html">Covariance structures with glmmTMB</a> und auf der Seite zu <a href="https://cran.r-project.org/web/packages/glmmTMB/">glmmTMB: Generalized Linear Mixed Models using Template Model Builder</a>. Auf der letzteren Seite findest du dann auch die Vignetten mit den jeweiligen Hilfsthemen. Leider kann <code>{glmmTB}</code> auch nicht alles modellieren, wenn es um die möglichen Fehler<em>quellen</em> geht und auch hier verweise ich einmal auf eine Hilfeseite zu <a href="https://schmidtpaul.github.io/MMFAIR/glmmtmbdispformula0.html">Covariance structures for the error term with glmmTMB - a workaround</a>. Wie immer du musst das nicht alles lesen. Es ist auch eine Sammlung an Hilfen hier für den Fall, dass es mal jemand braucht.</p>
<p>In den beiden folgenden Tabs wollen wir dann einmal verschiedene Varianten durchprobieren. Zuerst rechnen wir das naive fixe Effekt Modell mit einem <code>glm()</code> und einer Quasipoissonverteilung. Dann probieren wir ein gemischtes Modell mit <code>glmer()</code> und einer Poissonfamilie und schauen, ob wir Overdispersion vorliegen haben. Parallel dazu rechnen wir dann in dem anderen Tab die Poissonregression unter der Annahme von Overdispersion mit <code>glmmTMB()</code> und der Option <code>famliy = nbinom1</code>, was faktisch einer Quasipoissonverteilung entspricht.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true"><code>glm</code> mit <code>family = quasipoisson</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false"><code>glmer()</code> mit <code>family = poisson</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false"><code>glmmTMB()</code> mit <code>family = nbinom1</code></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Dieser Tab ist sehr kurz. Wir rechnen einfach eine Poissonregression unter der Annahme von Overdispersion. Deshalb nutzen wir hier auch gleich eine Quasipoissonverteilung, die es uns erlaubt für das Auftreten von einer Overdispersion zu adjustieren. Mehr zu der einfachen Poissonregression gibt es dann in dem <a href="eda-distribution.html#sec-poisson">Kapitel Poissonregression</a>. Dort kannst du dann auch noch mehr zum Thema Poissonregression nachlesen. Wir rechnen also eine Poissonregression und nutzen dafür ein <code>glm()</code> und die Option <code>family = "quasipoisson"</code>. Wir nehmen dabei als Effekte die Behandlung <code>trt</code> sowie die Positionen <code>row</code> und <code>col</code> mit in das Modell. Ich verzichte auf Interaktionen, da das Modell schon so recht groß ist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>glm_quasipoisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count_worms <span class="sc">~</span> trt <span class="sc">+</span> row <span class="sc">+</span> col, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> wireworms_tbl, <span class="at">family =</span> <span class="st">"quasipoisson"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> ist in einem <code>glm</code>-Modell nicht so einfach. Deshalb nutzen wir folgende Funktion um uns sowas ähnliches wiedergeben zu lassen. Wir interpretieren aber das <span class="math inline">\(R^2\)</span> ganz gewohnt als den Anteil der erklärten Varianz in dem Outcome durch das Modell.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_efron</span>(glm_quasipoisson_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5286153</code></pre>
</div>
</div>
<p>Dieses Modell nehmen wir dann als simple Alternative mit in den Vergleich zu den anderen gemischten Modellen. Manchmal reicht auch ein einfaches Modell und es muss nicht immer ein komplexes Modell sein.</p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Jetzt aber einmal ein lineares gemischtes Modell mit der Poissonfamilie für die Auswertung der Zähldaten. Daher haben wir dann einen fixen Effekt für die Behandlung <code>trt</code> sowie die beiden zufälligen Effekte für die Positionen der Parzellen mit <code>(1 | row)</code> und <code>(1 | col)</code>. Dann wählen wir noch die Poissonfamilie aus und können das Modell einmal rechnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>glmer_poisson_fit <span class="ot">&lt;-</span> <span class="fu">glmer</span>(count_worms <span class="sc">~</span> trt <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>row) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>col), </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> wireworms_tbl, <span class="at">family =</span> <span class="st">"poisson"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Bevor wir überhaupt etwas machen, schauen wir erstmal ob Overdispersion in unseren Daten vorliegt. Wenn unser Modell Overdispersion anzeigt, dann können wir das Modell gleich lassen. Das ist sehr wichtig zu wissen, ein Modell mit einer Poissonfamilie und Overdispersion wird dir immer falsche Ergebnisse liefern. Insbesondere wenn es dir um die Gruppenvergleiche geht. Die Nichtberücksichtigung der Overdispersion lässt deine Fehler zu klein werden und damit findest du zu viele falsche signifikante Ergebnisse.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>glmer_poisson_fit  <span class="sc">|&gt;</span> <span class="fu">check_overdispersion</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

       dispersion ratio =   1.624
  Pearson's Chi-Squared = 394.713
                p-value = &lt; 0.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Overdispersion detected.</code></pre>
</div>
</div>
<p>Wir haben sehr starke Overdispersion vorliegen und gehen daher in den anderen Tab und rechnen eine Quasipoisson Regression in einem linearen gemischten Modell. Hier nutzen wir dann das R Paket <code>{glmmTMB}</code>. Nur wenn du keine Overdispersion vorliegen hast, dann kannst du eine eine reine Poissonregression rechnen.</p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Da wir in <code>{lme4}</code> keine Quasipoissonverteilung auswählen können, nutzen wir das <a href="https://glmmtmb.github.io/glmmTMB/index.html">R Paket <code>{glmmTMB}</code></a> mit der Verteilungsfamilie <code>nbinom1</code>, was einer Parametrisierung einer Quasipoissonverteilung entspricht. Mehr dazu dann auch auf der Hilfeseite zu <a href="https://cran.r-project.org/web/packages/glmmTMB/vignettes/covstruct.html">Covariance structures with glmmTMB</a>. Eigentlich spricht nichts dagegen gleich das R Paket <code>{glmmTMB}</code> zu nutzen, wenn du mit nicht normalverteilten Outcomes arbeitest. Auch bei einem normalverteilten Outcome liefert dir <code>{glmmTMB}</code> auch <span class="math inline">\(p\)</span>-Werte aus einer ANOVA. Es macht also doch Sinn sich mal andere Pakete anzuschauen.</p>
<p>Um das Modell zu rechnen nutzen wir die Funktion <code>glmmTMB()</code> und der Rest bleibt glücklicherweise gleich. Wir ändern hier nur die Option <code>family = nbinom1</code> und können dann einmal das Modell rechnen. Und ja, es gebe noch andere Möglichkeiten, aber wir bleiben hier mal bei einer. Am Ende kannst du dann auch verschiedene Familien durch testen und schauen, wo du den kleinsten Fehler am Ende erhälst. Dafür bietet sich ja das Paket <code>{modelsummary}</code> gerade an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>glmmTMB_nbinom1_fit <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(count_worms <span class="sc">~</span> trt <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>row) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>col), </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> wireworms_tbl, <span class="at">family =</span> nbinom1) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Auch hier können wir einmal den <em>Intraclass Correlation Coefficient</em> (abk. <em>ICC</em>) schätzen und sehen, dass nicht viel Varianz durch unser Modell erklärt wird. Das ist etwas bedauerlich, aber manchmal kann man nicht mehr aus den Daten herausholen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>glmmTMB_nbinom1_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.248
  Unadjusted ICC: 0.111</code></pre>
</div>
</div>
<p>Dann schauen wir nochmal in das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> und sehen, dass wir auch hier eher bescheidene Werte erhalten. Wir können mit den festen und zufälligen Effekten zusammen nur <span class="math inline">\(66.9\%\)</span> der Varianz in den Wurmanzahlen erklären. Das ist auch hier kein guter Wert, aber wie immer besser als gar nichts.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>glmmTMB_nbinom1_fit <span class="sc">|&gt;</span> <span class="fu">r2</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: mu of 4.7 is too close to zero, estimate of random effect variances may
  be unreliable.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.662
     Marginal R2: 0.551</code></pre>
</div>
</div>
<p>Wir nehmen dann auch das Modell hier mit in den Vergleich und schauen einmal welches Modell das beste Modell ist. Wie immer kann ein komplexeres Modell zwar besser sein, aber am Ende wollen wir dann doch eher ein einfaches Modell haben.</p>
</div>
</div>
</div>
<p>Dann wollen wir uns mal die drei Modelle anschauen und entscheiden, welches der drei Modelle das beste Modell ist. Wir wissen aber schon, dass wir Overdispersion in den Daten vorliegen haben und deshalb keine einfache Poissonregression rechnen dürfen. Daher fällt das <code>glmer()</code>-Modell mit der Poissonfamilie aus der Betrachtung. Dann bleibt nur noch das reine fixe Effekt Modell in <code>glm()</code> oder eben das gemischte Modell aus <code>glmmTMB()</code> mit einer Quasipoissonverteilung übrig. Im folgenden Kasten findest du den Modellvergleich mit dem R Paket <code>{modelsummary}</code>. Leider liefert die Funktion <code>glm()</code> keine Bestimmtheitsmaße <span class="math inline">\(R^2\)</span> für unser Modell, aber da haben wir ja oben händisch den Wert von <span class="math inline">\(R^2 = 0.53\)</span> berechnet. Von den reinen Werten her, wäre sogar das <code>glmer()</code> das beste Modell, aber die statistischen Gütezahlen gelten nur, wenn es eben die Annahmen an das Modell auch passen. Und die Grundannahme an das <code>glmer()</code>-Modell ist eben, dass mit einer Poissonverteilung keine Overdispersion vorliegt. Somit ist dann tatsächlich unser <code>glmmTMB()</code>-Modell das Beste. Der <code>RMSE</code> ist klein, wie bei den anderen Modellen, und darüber hinaus haben wir dann noch relativ hohe Werte für das Bestimmtheitsmaße <span class="math inline">\(R^2\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modellvergleich mit <code>modelsummary()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"glm quasipoisson"</span> <span class="ot">=</span> glm_quasipoisson_fit,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"glmer poisson"</span> <span class="ot">=</span> glmer_poisson_fit, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"glmmTMB nbinom1"</span> <span class="ot">=</span> glmmTMB_nbinom1_fit),</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"conf.int"</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"s.e. = {std.error}"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_upjbwr4x33rg2md3mdc6</title>
    <style>
.table td.tinytable_css_is9y8smvv2m8nw67j3t5, .table th.tinytable_css_is9y8smvv2m8nw67j3t5 {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_ig09rzaytg8r7p4l0scb, .table th.tinytable_css_ig09rzaytg8r7p4l0scb {    text-align: left; }
.table td.tinytable_css_x7qtwiazupza79373ry5, .table th.tinytable_css_x7qtwiazupza79373ry5 {    text-align: center; }
.table td.tinytable_css_3qxxrms9cah6dxuaigec, .table th.tinytable_css_3qxxrms9cah6dxuaigec {    text-align: center; }
.table td.tinytable_css_bmlwyantp9kz9qginu1r, .table th.tinytable_css_bmlwyantp9kz9qginu1r {    text-align: center; }
.table td.tinytable_css_ib2tzz7rw3v1ciiyeue4, .table th.tinytable_css_ib2tzz7rw3v1ciiyeue4 {    border-bottom: solid 0.05em black; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_upjbwr4x33rg2md3mdc6" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">glm quasipoisson</th>
                <th scope="col">glmer poisson</th>
                <th scope="col">glmmTMB nbinom1</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)       </td>
                  <td>-0.041          </td>
                  <td>0.083          </td>
                  <td>-0.037         </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>-0.041          </td>
                  <td>0.083          </td>
                  <td>0.678          </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[-0.460, 0.349] </td>
                  <td>[-0.311, 0.477]</td>
                  <td>[-0.491, 0.417]</td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[-0.460, 0.349] </td>
                  <td>[-0.311, 0.477]</td>
                  <td>[0.421, 1.091] </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>s.e. = 0.206    </td>
                  <td>s.e. = 0.201   </td>
                  <td>s.e. = 0.232   </td>
                </tr>
                <tr>
                  <td>trtM              </td>
                  <td>1.741           </td>
                  <td>1.728          </td>
                  <td>1.852          </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[1.391, 2.120]  </td>
                  <td>[1.447, 2.010] </td>
                  <td>[1.467, 2.237] </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>s.e. = 0.185    </td>
                  <td>s.e. = 0.144   </td>
                  <td>s.e. = 0.196   </td>
                </tr>
                <tr>
                  <td>trtN              </td>
                  <td>1.709           </td>
                  <td>1.715          </td>
                  <td>1.849          </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[1.362, 2.086]  </td>
                  <td>[1.435, 1.995] </td>
                  <td>[1.463, 2.235] </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>s.e. = 0.184    </td>
                  <td>s.e. = 0.143   </td>
                  <td>s.e. = 0.197   </td>
                </tr>
                <tr>
                  <td>trtO              </td>
                  <td>1.577           </td>
                  <td>1.575          </td>
                  <td>1.704          </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[1.224, 1.959]  </td>
                  <td>[1.291, 1.858] </td>
                  <td>[1.314, 2.093] </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>s.e. = 0.187    </td>
                  <td>s.e. = 0.145   </td>
                  <td>s.e. = 0.199   </td>
                </tr>
                <tr>
                  <td>trtP              </td>
                  <td>1.463           </td>
                  <td>1.450          </td>
                  <td>1.589          </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[1.102, 1.850]  </td>
                  <td>[1.161, 1.738] </td>
                  <td>[1.197, 1.981] </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>s.e. = 0.190    </td>
                  <td>s.e. = 0.147   </td>
                  <td>s.e. = 0.200   </td>
                </tr>
                <tr>
                  <td>row2              </td>
                  <td>0.022           </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[-0.256, 0.302] </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>s.e. = 0.142    </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>row3              </td>
                  <td>0.387           </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[0.131, 0.647]  </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>s.e. = 0.131    </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>row4              </td>
                  <td>0.877           </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[0.641, 1.121]  </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>s.e. = 0.122    </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>row5              </td>
                  <td>0.423           </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[0.164, 0.685]  </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>s.e. = 0.133    </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>col2              </td>
                  <td>-0.322          </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[-0.553, -0.094]</td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>s.e. = 0.117    </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>col3              </td>
                  <td>-0.332          </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[-0.566, -0.102]</td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>s.e. = 0.118    </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>col4              </td>
                  <td>-0.272          </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[-0.497, -0.047]</td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>s.e. = 0.115    </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>col5              </td>
                  <td>-0.206          </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>[-0.439, 0.024] </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>s.e. = 0.118    </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>SD (Intercept col)</td>
                  <td>                </td>
                  <td>0.118          </td>
                  <td>0.099          </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>                </td>
                  <td>               </td>
                  <td>[0.032, 0.309] </td>
                </tr>
                <tr>
                  <td>SD (Intercept row)</td>
                  <td>                </td>
                  <td>0.318          </td>
                  <td>0.302          </td>
                </tr>
                <tr>
                  <td>                  </td>
                  <td>                </td>
                  <td>               </td>
                  <td>[0.156, 0.588] </td>
                </tr>
                <tr>
                  <td>Num.Obs.          </td>
                  <td>250             </td>
                  <td>250            </td>
                  <td>250            </td>
                </tr>
                <tr>
                  <td>R2 Marg.          </td>
                  <td>                </td>
                  <td>0.581          </td>
                  <td>0.551          </td>
                </tr>
                <tr>
                  <td>R2 Cond.          </td>
                  <td>                </td>
                  <td>0.736          </td>
                  <td>0.662          </td>
                </tr>
                <tr>
                  <td>AIC               </td>
                  <td>                </td>
                  <td>1189.9         </td>
                  <td>1156.5         </td>
                </tr>
                <tr>
                  <td>BIC               </td>
                  <td>                </td>
                  <td>1214.6         </td>
                  <td>1184.7         </td>
                </tr>
                <tr>
                  <td>ICC               </td>
                  <td>                </td>
                  <td>0.4            </td>
                  <td>0.2            </td>
                </tr>
                <tr>
                  <td>F                 </td>
                  <td>16.038          </td>
                  <td>               </td>
                  <td>               </td>
                </tr>
                <tr>
                  <td>RMSE              </td>
                  <td>2.67            </td>
                  <td>2.68           </td>
                  <td>2.69           </td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(i, j, css_id) {
        var table = document.getElementById("tinytable_upjbwr4x33rg2md3mdc6");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_upjbwr4x33rg2md3mdc6');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_z9a8rlgtpg4ilkkzahgc(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_upjbwr4x33rg2md3mdc6");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(0, 0, 'tinytable_css_is9y8smvv2m8nw67j3t5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(0, 1, 'tinytable_css_is9y8smvv2m8nw67j3t5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(0, 2, 'tinytable_css_is9y8smvv2m8nw67j3t5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(0, 3, 'tinytable_css_is9y8smvv2m8nw67j3t5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(0, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(1, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(2, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(3, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(4, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(5, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(6, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(7, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(8, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(9, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(10, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(11, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(12, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(13, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(14, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(15, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(16, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(17, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(18, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(19, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(20, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(21, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(22, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(23, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(24, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(25, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(26, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(27, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(28, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(29, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(30, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(31, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(32, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(33, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(34, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(35, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(36, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(37, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(38, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(39, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(40, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(41, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(42, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(43, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(44, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(45, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(46, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(47, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(48, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(49, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(50, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(51, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(52, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(53, 0, 'tinytable_css_ig09rzaytg8r7p4l0scb') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(0, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(1, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(2, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(3, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(4, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(5, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(6, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(7, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(8, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(9, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(10, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(11, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(12, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(13, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(14, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(15, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(16, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(17, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(18, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(19, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(20, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(21, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(22, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(23, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(24, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(25, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(26, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(27, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(28, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(29, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(30, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(31, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(32, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(33, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(34, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(35, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(36, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(37, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(38, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(39, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(40, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(41, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(42, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(43, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(44, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(45, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(46, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(47, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(48, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(49, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(50, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(51, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(52, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(53, 1, 'tinytable_css_x7qtwiazupza79373ry5') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(0, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(1, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(2, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(3, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(4, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(5, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(6, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(7, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(8, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(9, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(10, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(11, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(12, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(13, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(14, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(15, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(16, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(17, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(18, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(19, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(20, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(21, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(22, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(23, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(24, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(25, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(26, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(27, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(28, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(29, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(30, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(31, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(32, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(33, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(34, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(35, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(36, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(37, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(38, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(39, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(40, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(41, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(42, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(43, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(44, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(45, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(46, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(47, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(48, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(49, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(50, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(51, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(52, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(53, 2, 'tinytable_css_3qxxrms9cah6dxuaigec') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(0, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(1, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(2, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(3, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(4, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(5, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(6, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(7, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(8, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(9, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(10, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(11, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(12, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(13, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(14, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(15, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(16, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(17, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(18, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(19, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(20, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(21, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(22, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(23, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(24, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(25, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(26, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(27, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(28, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(29, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(30, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(31, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(32, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(33, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(34, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(35, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(36, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(37, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(38, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(39, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(40, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(41, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(42, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(43, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(44, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(45, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(46, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(47, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(48, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(49, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(50, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(51, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(52, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(53, 3, 'tinytable_css_bmlwyantp9kz9qginu1r') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(45, 0, 'tinytable_css_ib2tzz7rw3v1ciiyeue4') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(45, 1, 'tinytable_css_ib2tzz7rw3v1ciiyeue4') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(45, 2, 'tinytable_css_ib2tzz7rw3v1ciiyeue4') })
window.addEventListener('load', function () { styleCell_tinytable_z9a8rlgtpg4ilkkzahgc(45, 3, 'tinytable_css_ib2tzz7rw3v1ciiyeue4') })
    </script>

  


</div>
</div>
</div>
</div>
</div>
<p>Abschließend überprüfen wir in der <a href="#fig-mixed-school-model-check-pois" class="quarto-xref">Abbildung&nbsp;<span>60.17</span></a> nochmal, ob auch alle Annahmen an das Modell stimmen. Hierzu nutzen wir dann wieder eine visuelle Überprüfung mit der Funktion <code>check_model()</code>. Das Modell sieht einigermaßen okay aus. Die visuelle Überprüfung der Overdispersion ist nicht so super, aber wir sehen ja auch in der obigen Analyse, dass wir eigentlich keine Overdisperion mehr in den Daten vorliegen haben. Bei nicht normalverteilten Outcomes ist die Einschätzung der Modellgüte manchmal etwas schwierig. Aber wir hier bei dem <code>glmmTMB()</code>-Modell, es ist das beste was wir haben. Mehr geben dann die Daten einfach nicht her.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modellüberprüfung mit <code>check_model()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(glmmTMB_nbinom1_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mixed-school-model-check-pois" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mixed-school-model-check-pois-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-mixed-school-model-check-pois-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Abbildung&nbsp;60.17— Überprüfung des Modells mit der Funktion check_model() aus dem R Paket {performance}. Eine Reihe von Annahmen an das Modell wird in verschiedenen Abbildungen visuell überprüft. Unter den Überschriften steht die Annahme an die Abbildung und wann die Annahme in der Überschrift als erfüllt gilt."><img src="stat-modeling-mixed_files/figure-html/fig-mixed-school-model-check-pois-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mixed-school-model-check-pois-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.17— Überprüfung des Modells mit der Funktion <code>check_model()</code> aus dem R Paket <code>{performance}</code>. Eine Reihe von Annahmen an das Modell wird in verschiedenen Abbildungen visuell überprüft. Unter den Überschriften steht die Annahme an die Abbildung und wann die Annahme in der Überschrift als erfüllt gilt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="mit-dem-r-paket-multilevelmod" class="level3" data-number="60.4.4">
<h3 data-number="60.4.4" class="anchored" data-anchor-id="mit-dem-r-paket-multilevelmod"><span class="header-section-number">60.4.4</span> … mit dem R Paket <code>{multilevelmod}</code></h3>
<p>Das R Paket <code>{parsnip}</code> erlaubt verschiedene Modellierungen sehr schon zu vereinheitlichen. Wir nutzen die Idee auch sehr in den Kapitel zur Klassifikation. Hier stelle ich einmal das <a href="https://parsnip.tidymodels.org/reference/linear_reg.html">R Paket <code>{parsnip}</code> mit dem Fokus auf die lineare Regression</a> vor. Leider ist <code>{glmmTMB}</code> nicht in dem Paket eingebaut, so dass wir hier wieder extra analysieren müssen. Aber gut, man kann nicht alles haben. Um den folgenden Prozess einmal durchlaufen zu lassen, brauchen wir noch das <a href="https://multilevelmod.tidymodels.org/articles/multilevelmod.html">R Paket <code>{multilevelmod}</code></a>, welches uns erlaubt in <code>{parsnip}</code> dann auch lineare gemischte Modelle anzuwenden.</p>
<p>Im Folgenden einmal als Beispiel die Weizendaten <code>oats_tbl</code>, die wir dann auch gleich nochmal in dem Gruppenvergleich nutzen. Hier als erstmal zwei lineare Regression. Wir rechnen jetzt einmal ein lineares gemischtes Modell und nutzen dafür die Funktion <code>set_engine("lmer")</code>. Danach rechnen wir dann als Vergleich dazu ein simples lineares Modell mit <code>set_engine("lm")</code>. Wir du siehst, ist die <em>engine</em> unabhängig vom Formelaufruf. Das heißt, wir können die <em>engine</em> jetzt immer wieder verwenden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>oats_lmer_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lmer"</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>oats_lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt können wir mit der Funktion <code>fit()</code> verschiedene Modell anpassen. Ich habe mich jetzt für ein <code>lm()</code>-Modell sowie zwei <code>lmer()</code>-Modelle entschieden. Einmal ein <code>lmer()</code>-Modell mit Interaktionsterm und einmal ohne. Wir haben ja in der obigen Abbildung gesehen, dass wir eigentlich keine Interaktion zwischen den Behandlungen <code>nitro</code> und den Sorten <code>gen</code> vorliegen haben. Dann brauchen wir noch die Funktion <code>extract_fit_engine()</code> damit wir die Ausgabe der Funktion <code>fit()</code> auch für andere Pakete korrekt anwenden können.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>oats_lm_fit <span class="ot">&lt;-</span> oats_lm_spec <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(plant_yield <span class="sc">~</span> nitro <span class="sc">+</span> gen <span class="sc">+</span> block, <span class="at">data =</span> oats_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>()  </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>oats_lmer_fit <span class="ot">&lt;-</span> oats_lmer_spec <span class="sc">|&gt;</span> </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(plant_yield <span class="sc">~</span> nitro <span class="sc">+</span> gen <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>gen), <span class="at">data =</span> oats_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>()  </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>oats_lmer_int_fit <span class="ot">&lt;-</span> oats_lmer_spec <span class="sc">|&gt;</span> </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(plant_yield <span class="sc">~</span> nitro <span class="sc">+</span> gen <span class="sc">+</span> nitro<span class="sc">:</span>gen <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>gen), <span class="at">data =</span> oats_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>()  </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Damit sich hier nicht alles doppelt, einmal als Beispiel die Ausgabe des <em>Intraclass Correlation Coefficient</em> (abk. <em>ICC</em>) für das klassische lineare gemischte Modell. Wir sehen, dass die zufälligen Effekte sehr viel der Varianz in den Daten erklären. Das stimmt dann auch mit der Abbildung von oben überein. Die Blocke sind dort sehr variablen, was den Ertrag vom Weizen angeht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>oats_lmer_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.749
  Unadjusted ICC: 0.461</code></pre>
</div>
</div>
<p>Und dann nochmal als Übersicht die Ergebnisse der Ausgabe der Funktion <code>model_performance()</code>. Auch das funktioniert wunderbar.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>oats_lmer_fit <span class="sc">|&gt;</span> <span class="fu">model_performance</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma
----------------------------------------------------------------------------------
6666.443 | 6666.654 | 6709.297 |      0.846 |      0.385 | 0.749 | 10.850 | 10.983</code></pre>
</div>
</div>
<p>Im folgenden Kasten findest du den Modellvergleich mit dem R Paket <code>{modelsummary}</code>. Auch hier sehen wir, dass das <code>glmer</code>-Modell mit und ohne Interaktion ungefähr den gleichen <code>RMSE</code> produziert. Der <code>RMSE</code> ist auch kleiner als beim <code>lm()</code>-Modell, deshalb ist das gemischte Modell vorzuziehen. Je kleiner das Modell ist, desto besser, deshalb wäre hier das Modell ohne Interaktion vorzuziehen. Da die Bestimmtheitsmaße <span class="math inline">\(R^2\)</span> zwischen den gemischten Modellen auch ungefähr gleich sind, passt es auch hier. Den etwas geringeren ICC-Wert nehmen wir dann in kauf, wenn dafür unser Modell etwas simpler ist.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modellvergleich mit <code>modelsummary()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"lm"</span> <span class="ot">=</span> oats_lm_fit, </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"lmer ohne Interaktion"</span> <span class="ot">=</span> oats_lmer_fit,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"lmer mit Interaktion"</span> <span class="ot">=</span> oats_lmer_int_fit),</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"conf.int"</span>,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"s.e. = {std.error}"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
 

  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tinytable_gz8ae26rj0dtvy2r0wo1</title>
    <style>
.table td.tinytable_css_h7v1k26o1myaipgzqqy9, .table th.tinytable_css_h7v1k26o1myaipgzqqy9 {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_6k5xwwie6549yexz0s0y, .table th.tinytable_css_6k5xwwie6549yexz0s0y {    text-align: left; }
.table td.tinytable_css_x0w0j28p2eilbu1c21ci, .table th.tinytable_css_x0w0j28p2eilbu1c21ci {    text-align: center; }
.table td.tinytable_css_4ln5n3vh4nv5x8ejft7h, .table th.tinytable_css_4ln5n3vh4nv5x8ejft7h {    text-align: center; }
.table td.tinytable_css_j7lxq16u4966xo5t2o1g, .table th.tinytable_css_j7lxq16u4966xo5t2o1g {    text-align: center; }
.table td.tinytable_css_ur2cmlsuendmn6kc4ngt, .table th.tinytable_css_ur2cmlsuendmn6kc4ngt {    border-bottom: solid 0.05em black; }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
  

  
    <div class="container">
      <table class="table table-borderless" id="tinytable_gz8ae26rj0dtvy2r0wo1" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">lm</th>
                <th scope="col">lmer ohne Interaktion</th>
                <th scope="col">lmer mit Interaktion</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)             </td>
                  <td>66.892          </td>
                  <td>79.855          </td>
                  <td>79.914          </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>[63.728, 70.055]</td>
                  <td>[64.528, 95.181]</td>
                  <td>[64.487, 95.340]</td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>s.e. = 1.612    </td>
                  <td>s.e. = 7.809    </td>
                  <td>s.e. = 7.860    </td>
                </tr>
                <tr>
                  <td>nitro0.2                </td>
                  <td>19.543          </td>
                  <td>19.543          </td>
                  <td>18.693          </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>[16.845, 22.241]</td>
                  <td>[17.469, 21.617]</td>
                  <td>[15.157, 22.230]</td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>s.e. = 1.375    </td>
                  <td>s.e. = 1.057    </td>
                  <td>s.e. = 1.802    </td>
                </tr>
                <tr>
                  <td>nitro0.4                </td>
                  <td>34.754          </td>
                  <td>34.754          </td>
                  <td>34.696          </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>[32.056, 37.452]</td>
                  <td>[32.679, 36.828]</td>
                  <td>[31.160, 38.233]</td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>s.e. = 1.375    </td>
                  <td>s.e. = 1.057    </td>
                  <td>s.e. = 1.802    </td>
                </tr>
                <tr>
                  <td>nitro0.6                </td>
                  <td>44.014          </td>
                  <td>44.014          </td>
                  <td>44.685          </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>[41.316, 46.712]</td>
                  <td>[41.940, 46.089]</td>
                  <td>[41.149, 48.222]</td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>s.e. = 1.375    </td>
                  <td>s.e. = 1.057    </td>
                  <td>s.e. = 1.802    </td>
                </tr>
                <tr>
                  <td>genMarvellous           </td>
                  <td>5.294           </td>
                  <td>5.294           </td>
                  <td>6.776           </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>[2.958, 7.631]  </td>
                  <td>[-8.619, 19.208]</td>
                  <td>[-7.471, 21.023]</td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>s.e. = 1.190    </td>
                  <td>s.e. = 7.089    </td>
                  <td>s.e. = 7.259    </td>
                </tr>
                <tr>
                  <td>genVictory              </td>
                  <td>-6.580          </td>
                  <td>-6.580          </td>
                  <td>-8.239          </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>[-8.916, -4.244]</td>
                  <td>[-20.493, 7.333]</td>
                  <td>[-22.486, 6.008]</td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>s.e. = 1.190    </td>
                  <td>s.e. = 7.089    </td>
                  <td>s.e. = 7.259    </td>
                </tr>
                <tr>
                  <td>blockB2                 </td>
                  <td>5.247           </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>[1.943, 8.552]  </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>s.e. = 1.683    </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>blockB3                 </td>
                  <td>4.963           </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>[1.659, 8.267]  </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>s.e. = 1.683    </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>blockB4                 </td>
                  <td>44.214          </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>[40.910, 47.518]</td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>s.e. = 1.683    </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>blockB5                 </td>
                  <td>7.057           </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>[3.753, 10.362] </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>s.e. = 1.683    </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>blockB6                 </td>
                  <td>16.294          </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>[12.990, 19.599]</td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>s.e. = 1.683    </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>nitro0.2 × genMarvellous</td>
                  <td>                </td>
                  <td>                </td>
                  <td>2.967           </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>                </td>
                  <td>                </td>
                  <td>[-2.035, 7.968] </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>                </td>
                  <td>                </td>
                  <td>s.e. = 2.548    </td>
                </tr>
                <tr>
                  <td>nitro0.4 × genMarvellous</td>
                  <td>                </td>
                  <td>                </td>
                  <td>-4.681          </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>                </td>
                  <td>                </td>
                  <td>[-9.682, 0.321] </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>                </td>
                  <td>                </td>
                  <td>s.e. = 2.548    </td>
                </tr>
                <tr>
                  <td>nitro0.6 × genMarvellous</td>
                  <td>                </td>
                  <td>                </td>
                  <td>-4.213          </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>                </td>
                  <td>                </td>
                  <td>[-9.214, 0.788] </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>                </td>
                  <td>                </td>
                  <td>s.e. = 2.548    </td>
                </tr>
                <tr>
                  <td>nitro0.2 × genVictory   </td>
                  <td>                </td>
                  <td>                </td>
                  <td>-0.418          </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>                </td>
                  <td>                </td>
                  <td>[-5.419, 4.584] </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>                </td>
                  <td>                </td>
                  <td>s.e. = 2.548    </td>
                </tr>
                <tr>
                  <td>nitro0.4 × genVictory   </td>
                  <td>                </td>
                  <td>                </td>
                  <td>4.853           </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>                </td>
                  <td>                </td>
                  <td>[-0.148, 9.855] </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>                </td>
                  <td>                </td>
                  <td>s.e. = 2.548    </td>
                </tr>
                <tr>
                  <td>nitro0.6 × genVictory   </td>
                  <td>                </td>
                  <td>                </td>
                  <td>2.200           </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>                </td>
                  <td>                </td>
                  <td>[-2.801, 7.202] </td>
                </tr>
                <tr>
                  <td>                        </td>
                  <td>                </td>
                  <td>                </td>
                  <td>s.e. = 2.548    </td>
                </tr>
                <tr>
                  <td>SD (Observations)       </td>
                  <td>                </td>
                  <td>10.983          </td>
                  <td>10.810          </td>
                </tr>
                <tr>
                  <td>SD (Intercept genblock) </td>
                  <td>                </td>
                  <td>12.175          </td>
                  <td>12.179          </td>
                </tr>
                <tr>
                  <td>SD (Intercept block)    </td>
                  <td>                </td>
                  <td>14.580          </td>
                  <td>14.580          </td>
                </tr>
                <tr>
                  <td>Num.Obs.                </td>
                  <td>864             </td>
                  <td>864             </td>
                  <td>864             </td>
                </tr>
                <tr>
                  <td>R2                      </td>
                  <td>0.721           </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>R2 Adj.                 </td>
                  <td>0.718           </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>R2 Marg.                </td>
                  <td>                </td>
                  <td>0.385           </td>
                  <td>0.391           </td>
                </tr>
                <tr>
                  <td>R2 Cond.                </td>
                  <td>                </td>
                  <td>0.846           </td>
                  <td>0.851           </td>
                </tr>
                <tr>
                  <td>AIC                     </td>
                  <td>7059.9          </td>
                  <td>6666.4          </td>
                  <td>6625.8          </td>
                </tr>
                <tr>
                  <td>BIC                     </td>
                  <td>7117.0          </td>
                  <td>6709.3          </td>
                  <td>6697.2          </td>
                </tr>
                <tr>
                  <td>ICC                     </td>
                  <td>                </td>
                  <td>0.7             </td>
                  <td>0.8             </td>
                </tr>
                <tr>
                  <td>Log.Lik.                </td>
                  <td>-3517.948       </td>
                  <td>                </td>
                  <td>                </td>
                </tr>
                <tr>
                  <td>RMSE                    </td>
                  <td>14.19           </td>
                  <td>10.85           </td>
                  <td>10.64           </td>
                </tr>
        </tbody>
      </table>
    </div>

    <script>
      function styleCell_tinytable_6qcczms5tfejjuzrd4ih(i, j, css_id) {
        var table = document.getElementById("tinytable_gz8ae26rj0dtvy2r0wo1");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_gz8ae26rj0dtvy2r0wo1');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_6qcczms5tfejjuzrd4ih(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_gz8ae26rj0dtvy2r0wo1");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(0, 0, 'tinytable_css_h7v1k26o1myaipgzqqy9') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(0, 1, 'tinytable_css_h7v1k26o1myaipgzqqy9') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(0, 2, 'tinytable_css_h7v1k26o1myaipgzqqy9') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(0, 3, 'tinytable_css_h7v1k26o1myaipgzqqy9') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(0, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(1, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(2, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(3, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(4, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(5, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(6, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(7, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(8, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(9, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(10, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(11, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(12, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(13, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(14, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(15, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(16, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(17, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(18, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(19, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(20, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(21, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(22, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(23, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(24, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(25, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(26, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(27, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(28, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(29, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(30, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(31, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(32, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(33, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(34, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(35, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(36, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(37, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(38, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(39, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(40, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(41, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(42, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(43, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(44, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(45, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(46, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(47, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(48, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(49, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(50, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(51, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(52, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(53, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(54, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(55, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(56, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(57, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(58, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(59, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(60, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(61, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(62, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(63, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(64, 0, 'tinytable_css_6k5xwwie6549yexz0s0y') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(0, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(1, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(2, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(3, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(4, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(5, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(6, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(7, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(8, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(9, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(10, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(11, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(12, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(13, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(14, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(15, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(16, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(17, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(18, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(19, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(20, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(21, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(22, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(23, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(24, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(25, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(26, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(27, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(28, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(29, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(30, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(31, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(32, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(33, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(34, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(35, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(36, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(37, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(38, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(39, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(40, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(41, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(42, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(43, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(44, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(45, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(46, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(47, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(48, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(49, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(50, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(51, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(52, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(53, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(54, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(55, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(56, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(57, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(58, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(59, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(60, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(61, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(62, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(63, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(64, 1, 'tinytable_css_x0w0j28p2eilbu1c21ci') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(0, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(1, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(2, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(3, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(4, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(5, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(6, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(7, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(8, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(9, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(10, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(11, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(12, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(13, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(14, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(15, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(16, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(17, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(18, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(19, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(20, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(21, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(22, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(23, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(24, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(25, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(26, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(27, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(28, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(29, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(30, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(31, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(32, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(33, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(34, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(35, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(36, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(37, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(38, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(39, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(40, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(41, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(42, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(43, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(44, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(45, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(46, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(47, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(48, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(49, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(50, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(51, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(52, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(53, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(54, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(55, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(56, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(57, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(58, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(59, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(60, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(61, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(62, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(63, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(64, 2, 'tinytable_css_4ln5n3vh4nv5x8ejft7h') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(0, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(1, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(2, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(3, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(4, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(5, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(6, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(7, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(8, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(9, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(10, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(11, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(12, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(13, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(14, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(15, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(16, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(17, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(18, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(19, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(20, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(21, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(22, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(23, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(24, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(25, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(26, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(27, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(28, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(29, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(30, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(31, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(32, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(33, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(34, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(35, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(36, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(37, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(38, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(39, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(40, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(41, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(42, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(43, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(44, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(45, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(46, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(47, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(48, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(49, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(50, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(51, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(52, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(53, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(54, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(55, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(56, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(57, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(58, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(59, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(60, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(61, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(62, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(63, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(64, 3, 'tinytable_css_j7lxq16u4966xo5t2o1g') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(54, 0, 'tinytable_css_ur2cmlsuendmn6kc4ngt') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(54, 1, 'tinytable_css_ur2cmlsuendmn6kc4ngt') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(54, 2, 'tinytable_css_ur2cmlsuendmn6kc4ngt') })
window.addEventListener('load', function () { styleCell_tinytable_6qcczms5tfejjuzrd4ih(54, 3, 'tinytable_css_ur2cmlsuendmn6kc4ngt') })
    </script>

  


</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="sec-mult-comp-lmer-reg" class="level2" data-number="60.5">
<h2 data-number="60.5" class="anchored" data-anchor-id="sec-mult-comp-lmer-reg"><span class="header-section-number">60.5</span> Gruppenvergleich</h2>
<p>Vielleicht bist du direkt aus dem Kapitel zu den multiplen Vergleichen hierher gesprungen. Wenn ja, dann musst du eventuell nochmal weiter oben anfangen zu lesen, denn hier geht es eher um die schnelle Variante, den Gruppenvergleich mit einem linearen gemischten Modell durchzuführen. Details stehen in dem Kapitel. Wir nutzen hier einmal das R Paket <code>{lme4}</code> zusammen mit dem <a href="https://www.jstatsoft.org/article/view/v082i13">R Paket <code>{lmerTest}</code></a>, welches uns dann auch erlaubt statistische Tests mit einem <span class="math inline">\(p\)</span>-Wert zurechnen. Leider ist das in der ursprünglichen Version so nicht implementiert und deshalb müssen wir noch ein zusätzliches Paket laden. In dem R Paket <code>{glmmTMB}</code> funktioniert soweit alles wie es soll, nur das wir hier dann noch das R Paket <code>{car}</code> benötigen um die ANOVA zu rechnen. Wir ignorieren hier das Bestimmtheitsmaß oder die Modellgüte. Wir ziehen hier einmal stumpf den Prozess des Testens durch. Der Gruppenvergleich läuft dann wie gewohnt in <code>{emmeans}</code> ab. Mehr dazu dann auch in den beiden Anwendungsbeispielen in den grünen Kästen im Anschluss.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Welches R Paket mit welchem Endpunkt?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Manchmal ist es etwas verwirrend, welches R Paket für die gemischten linearen Modellen mit welcher Funktion für welchen Endpunkt oder Outcome geeignet ist. Hier mal eine schnelle Übersicht, damit du dich orientieren kannst.</p>
<ul>
<li>Wenn dein Outcome normalverteilt ist, wie zum Beispiel das Trocken- oder Frischgewicht, dann hilft die Funktion <code>lmer()</code> aus dem R Paket <code>{lme4}</code> weiter.</li>
<li>Wenn du Zähldaten hast dann nutzt die Funktion <code>glmer()</code> aus dem R Paket <code>lme4</code> oder eben die Funktion <code>glmmTMB()</code> aus dem gleichnamigen R Paket mit der entsprechenden Option für die Verteilungsfamilie.</li>
<li>Wenn du Boniturdaten oder aber ein ordinales Outcome vorliegen hast, dann kannst du die Funktion <code>clmm()</code> aus dem R Paket <code>{ordinal}</code> nutzen. Du brauchst hier noch zusätzlich die Funktion <code>Anova.clmm()</code> aus dem R Paket <code>{RVAideMemoire}</code> um die ANOVA rechnen zu können.</li>
</ul>
<p>Alle drei Varianten zeige ich dir in den grünen Kästen zu den beispielhaften Anwendungen am Ende des Kapitels.</p>
</div>
</div>
<p>Ich zeige dir jetzt einmal in den beiden Tabs die Gruppenvergleiche für das R Paket <code>{lme4}</code> und der Funktion <code>lmer()</code> sowie dann den Gruppenvergleich mit dem R Paket <code>{glmmTMB}</code> und der gleichnamigen Funktion. Du kannst die Funktion <code>lmer()</code> ohne weiteres durch die Funktion <code>glmer()</code> ersetzen. Ich würde aber in dem Fall immer zu dem Paket <code>{glmmTMB}</code> wechseln. Für nicht-normalverteilte Outcomes ist <code>{glmmTMB}</code> einfach besser, da wir in dem Paket mehr Möglichkeiten haben die Daten zu modellieren. Wir nutzen hier als Beispiel die Weizendaten mit der Behandlung <code>nitro</code> sowie den Sorten <code>gen</code> und verschiedenen Blöcken im Split Plot Design. Wir wissen dass die Blöcke und die Sorten miteinander interagieren und packen deshalb diese genestete Struktur nochmal in den zufälligen Effekt mit <code>(1|block/gen)</code>. Wir brauchen hier den Interaktionsterm, damit wir anschließend in <code>{emmeans}</code> uns alle Faktorkombinationen anzeigen lassen können. Jedenfalls ist es dann so einfacher und wir verlieren nichts.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Gruppenvergleich mit <code>lmer()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Gruppenvergleich mit <code>glmmTMB()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Jetzt müssen wir die Funktion <code>lmer()</code> aus dem R Paket <code>{lmerTest}</code> nutzen, damit wir dann später die ANOVA mit <span class="math inline">\(p\)</span>-Werten erhalten. Ich nutze das Paket <code>{lmerTest}</code> sehr punktuell, deshalb lade ich mit dem Aufruf <code>lmerTest::lmer()</code> nur einmal die Funktion <code>lmer()</code> aus dem Paket. Wenn ich sonst <code>lmer()</code> nutze, ist es wieder die Funktion aus dem Paket <code>{lme4}</code>. Sonst kriegt man auch Probleme mit dem R Paket <code>{conflicted}</code>, was zurecht möchte, dass wir uns für eine Funktion aus einem Paket entscheiden. Wenn wir das haben, dann können wir wie gewohnt das Modell anpassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span><span class="fu">lmer</span>(plant_yield <span class="sc">~</span> nitro <span class="sc">+</span> gen <span class="sc">+</span> nitro<span class="sc">:</span>gen <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>gen), <span class="at">data =</span> oats_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Und schon können wir die ANOVA rechnen und erhalten dann auch über die Funktion <code>model_parameters()</code> eine schönere Ausgabe wieder. Obwohl es in unserer Abbildung nicht so aussah, haben wir eine signifikante Interaktion in unseren Daten vorliegen. Wir werden daher dann die Daten getrennt einmal auswerten. Auch um ein wenig Platz zu sparen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter | Sum_Squares | df | Mean_Square |      F |      p
------------------------------------------------------------
nitro     |    2.40e+05 |  3 |    79973.41 | 684.31 | &lt; .001
gen       |      329.19 |  2 |      164.59 |   1.41 | 0.289 
nitro:gen |     3870.16 |  6 |      645.03 |   5.52 | &lt; .001

Anova Table (Type 3 tests)</code></pre>
</div>
</div>
<p>Einmal die paarweisen Vergleich für unsere Behandlung <code>nitro</code>. Wir sehen, dass alle Vergleiche signifikant sind. Das haben wir aber schon aus der obigen Abbildung erwartet.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> nitro) <span class="sc">|&gt;</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            estimate   SE  df t.ratio p.value
 nitro0 - nitro0.2     -19.54 1.04 837 -18.787  &lt;.0001
 nitro0 - nitro0.4     -34.75 1.04 837 -33.409  &lt;.0001
 nitro0 - nitro0.6     -44.01 1.04 837 -42.312  &lt;.0001
 nitro0.2 - nitro0.4   -15.21 1.04 837 -14.622  &lt;.0001
 nitro0.2 - nitro0.6   -24.47 1.04 837 -23.525  &lt;.0001
 nitro0.4 - nitro0.6    -9.26 1.04 837  -8.902  &lt;.0001

Results are averaged over the levels of: gen 
Degrees-of-freedom method: kenward-roger 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
</div>
<p>Dann die Vergleiche für die Sorten. Hier haben wir dann keinen signifikanten Unterschied mehr vorliegen. Auch das überrascht uns jetzt nicht sehr. Auch in der obigen Abbildung haben sich die Sorten kaum Unterschiede was den Ertrag anging.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> gen) <span class="sc">|&gt;</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                estimate   SE df t.ratio p.value
 GoldenRain - Marvellous    -5.29 7.09 10  -0.747  0.7423
 GoldenRain - Victory        6.58 7.09 10   0.928  0.6358
 Marvellous - Victory       11.87 7.09 10   1.675  0.2614

Results are averaged over the levels of: nitro 
Degrees-of-freedom method: kenward-roger 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>Abschließend machen wir dann noch das <em>compact letter display</em> fertig. Hier dann mit allen Faktorkombinationen von der Stickstoffdüngung <code>nitro</code> und den Sorten <code>gen</code>, wenn du <code>nitro * gen</code> durchlaufen lässt. Für mich ist die Ausgabe dann zu groß, deshalb hier nur die Anwendung für <code>nitro</code> getrennt für alle Sorten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> nitro <span class="sc">|</span> gen) <span class="sc">|&gt;</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>gen = GoldenRain:
 nitro emmean   SE   df lower.CL upper.CL .group
 0       79.9 7.86 9.27     62.2     97.6  a    
 0.2     98.6 7.86 9.27     80.9    116.3   b   
 0.4    114.6 7.86 9.27     96.9    132.3    c  
 0.6    124.6 7.86 9.27    106.9    142.3     d 

gen = Marvellous:
 nitro emmean   SE   df lower.CL upper.CL .group
 0       86.7 7.86 9.27     69.0    104.4  a    
 0.2    108.3 7.86 9.27     90.6    126.1   b   
 0.4    116.7 7.86 9.27     99.0    134.4    c  
 0.6    127.2 7.86 9.27    109.5    144.9     d 

gen = Victory:
 nitro emmean   SE   df lower.CL upper.CL .group
 0       71.7 7.86 9.27     54.0     89.4  a    
 0.2     90.0 7.86 9.27     72.2    107.7   b   
 0.4    111.2 7.86 9.27     93.5    128.9    c  
 0.6    118.6 7.86 9.27    100.9    136.3     d 

Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Und damit sind wir dann auch schon mit dem Gruppenvergleich mit <code>lmer()</code> durch. Die ANOVA und das <em>compact letter display</em> lässt sich schnell und einfach erstellen. Wir müssen eben nur darauf achten, dass wir das richtige Helferpaket mit <code>{lmerTest}</code> für die Modellierung des linearen gemischten Modell nutzen.</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Dann rechnen wir nochmal flux das lineare gemischte Modell mit der Funktion <code>glmmTMB()</code>. Eigentlich ist alles genauso wie in dem andern Tab mit der Funktion <code>lmer()</code>. Wir brauchen hier aber keine Helferfunktionen. Die Funktion <code>glmmTMB()</code> kann das Modell so schätzen, dass wir auch eine ANOVA rechnen können. Wir müssen aber nur gleiche eine spezielle Implementierung wählen, aber das ist auch kein Problem.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>glmmTMB_fit <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(plant_yield <span class="sc">~</span> nitro <span class="sc">+</span> gen <span class="sc">+</span> nitro<span class="sc">:</span>gen <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>gen), <span class="at">data =</span> oats_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Und schon können wir die ANOVA rechnen und erhalten dann auch über die Funktion <code>model_parameters()</code> eine schönere Ausgabe wieder. Hier müssen wir die Funktion <code>Anova()</code> aus dem R Paket <code>{car}</code> nutzen. Obwohl es in unserer Abbildung nicht so aussah, haben wir eine signifikante Interaktion in unseren Daten vorliegen. Wir werden daher dann die Daten getrennt einmal auswerten. Auch um ein wenig Platz zu sparen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>glmmTMB_fit <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  car<span class="sc">::</span><span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter |    Chi2 | df |      p
---------------------------------
nitro     | 2075.02 |  3 | &lt; .001
gen       |    3.38 |  2 | 0.185 
nitro:gen |   33.47 |  6 | &lt; .001

Anova Table (Type 2 tests)</code></pre>
</div>
</div>
<p>Einmal die paarweisen Vergleich für unsere Behandlung <code>nitro</code>. Wir sehen, dass alle Vergleiche signifikant sind. Das haben wir aber schon aus der obigen Abbildung erwartet. Also auch hier nichts anderes zu dem anderen Tab.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>glmmTMB_fit <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> nitro) <span class="sc">|&gt;</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast            estimate   SE  df t.ratio p.value
 nitro0 - nitro0.2     -19.54 1.03 849 -18.888  &lt;.0001
 nitro0 - nitro0.4     -34.75 1.03 849 -33.588  &lt;.0001
 nitro0 - nitro0.6     -44.01 1.03 849 -42.539  &lt;.0001
 nitro0.2 - nitro0.4   -15.21 1.03 849 -14.701  &lt;.0001
 nitro0.2 - nitro0.6   -24.47 1.03 849 -23.651  &lt;.0001
 nitro0.4 - nitro0.6    -9.26 1.03 849  -8.950  &lt;.0001

Results are averaged over the levels of: gen 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
</div>
<p>Dann die Vergleiche für die Sorten. Hier haben wir dann keinen signifikanten Unterschied mehr vorliegen. Auch das überrascht uns jetzt nicht sehr. Auch in der obigen Abbildung haben sich die Sorten kaum Unterschiede was den Ertrag anging.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>glmmTMB_fit <span class="sc">|&gt;</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> gen) <span class="sc">|&gt;</span> </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                estimate   SE  df t.ratio p.value
 GoldenRain - Marvellous    -5.29 6.47 849  -0.818  0.6919
 GoldenRain - Victory        6.58 6.47 849   1.017  0.5664
 Marvellous - Victory       11.87 6.47 849   1.835  0.1589

Results are averaged over the levels of: nitro 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>Abschließend machen wir dann noch das <em>compact letter display</em> fertig. Für mich ist die Ausgabe dann zu groß, wenn ich mit <code>nitro * gen</code> alle Faktorkombinationen anzeigen lasse, deshalb hier nur die Anwendung für <code>nitro</code> getrennt für alle Sorten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>glmmTMB_fit <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> nitro <span class="sc">|</span> gen) <span class="sc">|&gt;</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>gen = GoldenRain:
 nitro emmean   SE  df lower.CL upper.CL .group
 0       79.9 7.19 849     65.8     94.0  a    
 0.2     98.6 7.19 849     84.5    112.7   b   
 0.4    114.6 7.19 849    100.5    128.7    c  
 0.6    124.6 7.19 849    110.5    138.7     d 

gen = Marvellous:
 nitro emmean   SE  df lower.CL upper.CL .group
 0       86.7 7.19 849     72.6    100.8  a    
 0.2    108.3 7.19 849     94.2    122.5   b   
 0.4    116.7 7.19 849    102.6    130.8    c  
 0.6    127.2 7.19 849    113.1    141.3     d 

gen = Victory:
 nitro emmean   SE  df lower.CL upper.CL .group
 0       71.7 7.19 849     57.6     85.8  a    
 0.2     90.0 7.19 849     75.8    104.1   b   
 0.4    111.2 7.19 849     97.1    125.3    c  
 0.6    118.6 7.19 849    104.5    132.7     d 

Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Auch hier sehen wir dann die Unterschiede in den einzelnen Sorten. Alle sind soweit signifikant. Damit sind wir auch mit der Implementierung von <code>{glmmTMB}</code> durch. Die ANOVA und das <em>compact letter display</em> lässt sich schnell und einfach erstellen.</p>
</div>
</div>
</div>
<p>In den folgenden grünen Kästen schauen wir uns jetzt drei Anwenundungsbeispiele für einen Gruppenvergleich mit linearen gemischten Modellen an. Zum einen betrachten wir ein dreifaktorieller Gruppenvergleich für das Gewicht von Brokkoliköpfen und zum anderen ein weiterer dreifaktorieller Gruppenvergleich für Thripsenbefall. Dann betrachten wir noch ein ordinales Modell mit den Boniturnoten bei Schweinen. Alle Auswertungen sind vollständig und haben auch teilweise erklärenden Text. Im Zweifel musst du dann nochmal in diesem Kapitel nachschlagen, wenn dir Teile unklar sind.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Anwendungsbeispiel: Gruppenvergleich für Brokkolikopfgewicht (3-faktoriell)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Im folgenden Beispiel schauen wir uns nochmal ein praktische Auswertung von einem agrarwissenschaftlichen Beispiel mit Brokkoli an. Wir haben uns in diesem Experiment verschiedene Dosen <code>fert_amount</code> von einem Dünger aufgebracht sowie verschiedene Zeitpunkte der Düngung <code>fert_time</code> berücksichtigt. Auch hier haben wir einige Besonderheiten in den Daten, da nicht jede Faktorkombination vorliegt. Wir ignorieren aber diese Probleme und rechnen einfach stumpf unseren Gruppenvergleich und ignorieren die fehlenden Faktorkombinationen. Wir haben aber mit den Gewicht ein normalverteiltes Outcome vorliegen und haben die Pflanzen in Blöcken randomisiert. Leider kennen wir nicht das experimentelle Design und müssen daher etwas blind modellieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>broc_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/broccoli_weight.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fert_time =</span> <span class="fu">factor</span>(fert_time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"early"</span>, <span class="st">"late"</span>)),</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">fert_amount =</span> <span class="fu">as_factor</span>(fert_amount),</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">block =</span> <span class="fu">as_factor</span>(block)) <span class="sc">|&gt;</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>stem_hollowness) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt wollen wir einmal das Modell auftellen. Wir nehmen die beiden Behandlungen als festen Effekt mit einem Interaktionsterm in das gemischte Modell. Den Block nehmen wir dann als zufälligen Effekt mit rein. Wir nutze hier dann das R Paket <code>{lmerTest}</code> um das lineare gemischte Modell zu rechnen, da wir dann besser die Gruppenvergleiche und die ANOVA rechnen können. Mit der Funktion asu dem R Paket <code>{lme4}</code> kriegen wir aus der ANOVA keine <span class="math inline">\(p\)</span>-Werte.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span><span class="fu">lmer</span>(weight <span class="sc">~</span> fert_time <span class="sc">+</span> fert_amount <span class="sc">+</span> fert_time<span class="sc">:</span>fert_amount <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> block), </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> broc_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann berechnen wir auch einmal die <span class="math inline">\(R^2\)</span>-Werte für unser Modell. Hier gibt es dann nochmal mehr Informationen auf <a href="https://easystats.github.io/performance/articles/r2.html#marginal-vs--conditional-r2"><span class="math inline">\(R^2\)</span> for Mixed Models – Marginal vs.&nbsp;Conditional</a>. Wichtig ist, dass das <code>Conditional R2</code>, die gesamte erklärte Varianz von festen und zufälligen Effekten beschriebt und das <code>Marginal R2</code> nur die erklärte Varianz aus den festen Effekten. Tja, das Modell ist nun echt nicht gerade das beste Modell nach dem Bestimmtheitsmaß. Die festen Effekte, also unsere Behandlungen, erklären kaum etwas von der Varianz. Aber schauen wir mal weiter.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> <span class="fu">r2</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.246
     Marginal R2: 0.081</code></pre>
</div>
</div>
<p>Der <a href="https://easystats.github.io/performance/reference/icc.html">Intraclass Correlation Coefficient (ICC)</a> ist dann das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> für die zufälligen Effekte. Auch hier sehen wir eher maue Werte. Wir haben anscheinend sehr viel Varianz in den Daten, die wir nicht durch unsere Faktoren erklären können.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.180
  Unadjusted ICC: 0.165</code></pre>
</div>
</div>
<p>Mit der Funktion <code>model_performance()</code> können wir uns dann nochmal alles zusammen anschauen. Viele der Werte sind nur wichtig, wenn wir Modelle miteinander vergleichen. Das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> als einzelner Wert ist da schon wichtiger.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_performance</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC       |      AICc |       BIC | R2 (cond.) | R2 (marg.) |   ICC |    RMSE |   Sigma
---------------------------------------------------------------------------------------
20281.884 | 20282.001 | 20330.022 |      0.246 |      0.081 | 0.180 | 165.876 | 166.410</code></pre>
</div>
</div>
<p>Jetzt rechnen wir in den beiden folgenden Tabs einmal die ANOVA und dann auch den multiplen Gruppenvergleich mit <code>{emmeans}</code>. Da wir hier normalveteilte Daten haben, können wir dann einfach die Standardverfahren nehmen. Eventuell müssten wir bei dem Gruppenvergleich mit <code>emmeans()</code> nochmal für die multiplen Vergleiche adjustieren, aber da erfährst du dann mehr in dem Kapitel zu den <a href="stat-tests-posthoc2.html">Multiple Vergleichen oder Post-hoc Tests</a>. Bei den gemischten Modellen müssen wir nicht für Varianzheterogenität adjustieren, das machen dann die Modelle intern schon.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">ANOVA mit <code>anova()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Gruppenvergleich mit <code>emmeans()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Wir rechnen hier einmal die ANOVA und erhalten Dank der Nutzung des R Paketes <code>{lmerTest}</code> auch die <span class="math inline">\(p\)</span>-Werte. Wenn du nicht das R Paket <code>{lmerTest}</code> nutzt, wird per Standardeinstellung kein Test gerechnet. Wir machen dann die Ausgabe nochmal schöner und fertig sind wir.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter             | Sum_Squares | df | Mean_Square |     F |      p
-----------------------------------------------------------------------
fert_time             |    2.89e+06 |  2 |    1.44e+06 | 52.11 | &lt; .001
fert_amount           |    2.13e+06 |  2 |    1.07e+06 | 38.48 | &lt; .001
fert_time:fert_amount |    27123.13 |  2 |    13561.57 |  0.49 | 0.613 

Anova Table (Type 3 tests)</code></pre>
</div>
</div>
<p>Wir sehen, dass der Effekt der Düngerzeit und die Menge des Düngers signifikant ist, jedoch wir keinen signifikanten Einfluss durch die Interaktion haben. Wir haben aber also keine Interaktion vorliegen. Wir sehen hier den Block nicht mehr, da der Effekt des Blocks in den zufälligen Effekt ist und hier nicht mehr gezeigt wird. Für die ANOVA der zufälligen Effekte können wir dann die Funktion <code>ranova()</code> nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ranova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">drop =</span> <span class="st">"&lt;none&gt;"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   |      AIC | Log_Likelihood | df |      p
-----------------------------------------------------
(1 | block) | 20503.99 |      -10243.99 |  8 | &lt; .001

Anova Table (Type 1 tests)</code></pre>
</div>
</div>
<p>Nun können wir auch erkennen, dass wir einen signifikanten Effekt des Blocks haben. Du kannst aber die Ausgabe der zufälligen ANOVA nicht mit der obigen ANOVA vergleichen. Wir erhalten aus der ANOVA keine Informationen über die erklärte Varianz. Diese Information erhalten wir dann oben aus der Funktion <code>icc()</code>. Dann können wir auch in dem anderem Tab mit dem Gruppebvergleich in <code>{emmeans}</code> weitermachen.</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Im Folgenden rechnen wir einmal über alle Faktorkombinationen von <code>fert_time</code> und <code>fert_amount</code> einen Gruppenvergleich. Dafür nutzen wir die Option <code>fert_time * fert_amount</code>. Wenn du die Analyse <em>getrennt</em> für die Menge und den Zeitpunkt durchführen willst, dann nutze die Option <code>fert_time | fert_amount</code>. Dann adjustieren wir noch nach Bonferroni und sind schon fertig.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> fert_time <span class="sc">*</span> fert_amount) <span class="sc">|&gt;</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>emm_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> fert_time fert_amount emmean   SE   df lower.CL upper.CL .group
 none      0              169 51.7 9.08    -9.82      347  a    
 late      150            400 40.5 3.44   167.50      633   b   
 early     150            432 40.5 3.42   198.20      665   bc  
 late      225            467 40.5 3.44   234.22      700    cd 
 early     225            497 39.7 3.18   250.86      743     de
 late      300            506 40.6 3.46   273.96      738     de
 early     300            517 40.6 3.45   285.45      750      e
 early     0           nonEst   NA   NA       NA       NA       
 late      0           nonEst   NA   NA       NA       NA       
 none      150         nonEst   NA   NA       NA       NA       
 none      225         nonEst   NA   NA       NA       NA       
 none      300         nonEst   NA   NA       NA       NA       

Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 7 estimates 
P value adjustment: bonferroni method for 21 tests 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Das <code>emm_obj</code> Objekt werden wir dann gleich einmal in <code>{ggplot}</code> visualisieren. Die <code>emmean</code> stellt den mittleren Gewicht des Brokkoli je Faktorkombination dar unter Berücksichtigung der Varianz der Blöcke als zufälligen Effekt. Du siehst ja auch, dass wir hier keine homogen Varianzen <span class="math inline">\(SE\)</span> haben. Dann können wir zum Abschluss auch das <em>compact letter display</em> anhand der Abbildung interpretieren. Einige der Vergleiche konnten nicht gerechnet werden, da wir die Faktorkombination nicht in den Daten vorliegen haben.</p>
</div>
</div>
</div>
<p>In der <a href="#fig-log-mod-gaussian-broc" class="quarto-xref">Abbildung&nbsp;<span>60.18</span></a> siehst du das Ergebnis der Auswertung in einem Säulendiagramm und in der <a href="#fig-log-mod-gaussian-broc-half" class="quarto-xref">Abbildung&nbsp;<span>60.19</span></a> die Ergebnisse in einem Dot-Boxplot. Wir sehen einen klaren Effekt der Düngezeitpunkte sowie der Düngermenge auf das Gewicht von Brokkoli. Wenn wir ein mittleres Gewicht von <span class="math inline">\(500g\)</span> für den Handel erreichen wollen, dann erhalten wir das Zielgewicht nur bei einer Düngemenge von <span class="math inline">\(300mg/l\)</span>. Hier stellt sich dann die Frage, ob wir bei <span class="math inline">\(225mg/l\)</span> und einem frühen Zeitpunkt der Düngung nicht auch genug Brokkoli erhalten. Das Ziel ist es ja eigentlich in einen Zielbereich zu kommen. Die Köpfe sollen ja nicht zu schwer und auch nicht zu leicht sein. Aber diese Frage und andere Fragen der biologischen Anwendung lassen wir dann hier einmal offen, denn das Beispiel soll ja nur ein Beispiel sein. Besonders spannend ist hier der Unterschied in den beiden Abbildungen. Schau dir dazu einmal die beiden verschiedenen Tabs an.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Barplots</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Dotplots und Boxplots</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>Im Folgenden einmal die Barplots mit den Mittelwerten und dem Standardfehler. Hier sieht es so aus, also ob die Düngezeitpunkte relativ verlässlich ein Zielgewicht von <span class="math inline">\(500g\)</span> im Mittel erreichen würden. Das stimmt auch, wenn wir uns auf den Mittelwert beziehen. Auch der Standardfehler ist relativ klein, da wir ja so viele Beobachtungen vorliegen haben. Schau dir dazu dann einmal den Dot-Boxplot in dem anderen Tab an.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fert_time, <span class="at">y =</span> emmean, <span class="at">fill =</span> fert_amount)) <span class="sc">+</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mittleres Gewicht [g] des Brokkoli"</span>, <span class="at">x =</span> <span class="st">"Düngezeitpunkt"</span>,</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Düngemenge [mg/l]"</span>) <span class="sc">+</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">500</span>, <span class="at">by =</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">500</span>, <span class="at">size =</span> <span class="fl">0.75</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> SE <span class="sc">+</span> <span class="fl">0.01</span>),  </span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>SE, <span class="at">ymax =</span> emmean<span class="sc">+</span>SE),</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-log-mod-gaussian-broc" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-mod-gaussian-broc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-log-mod-gaussian-broc-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Abbildung&nbsp;60.18— Säulendigramm der mittleren Brokkoligewichte aus einem linearen gemischten Modell. Das lmer()-Modell berechnet das mittler Gewicht des Brokkoli in jeder Faktorkombination. Das compact letter display wird dann in {emmeans} generiert. Wir nutzen hier den Standardfehler, da die Standardabweichung mit der großen Fallzahl rießig wäre. Wir haben noch ein Mindestgewicht von 500g ergänzt."><img src="stat-modeling-mixed_files/figure-html/fig-log-mod-gaussian-broc-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-mod-gaussian-broc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.18— Säulendigramm der mittleren Brokkoligewichte aus einem linearen gemischten Modell. Das <code>lmer()</code>-Modell berechnet das mittler Gewicht des Brokkoli in jeder Faktorkombination. Das <em>compact letter display</em> wird dann in <code>{emmeans}</code> generiert. Wir nutzen hier den Standardfehler, da die Standardabweichung mit der großen Fallzahl rießig wäre. Wir haben noch ein Mindestgewicht von 500g ergänzt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Als erstes müssen wir nochmal das <code>emm_obj</code> in einen <code>tibble</code> umwandeln, damit wir dann das <em>compact letter display</em> direkt in die Grafik setzen können. Wir entfernen dann noch alle Faktorkombinationen, die wir nicht brauchen, damit wir dann auch gleich die Positionen richtig setzen können. Wichtig ist auch, dass die Faktoren richtig sortiert sind, sonst passt es gleich nicht mit dem Zufügen des <em>compact letter display</em> zu der Position.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>emm_cld_tbl <span class="ot">&lt;-</span> emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(fert_time, fert_amount) <span class="sc">|&gt;</span> </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die Positionen für das <em>compact letter display</em> berechnen wir uns aus dem Wert des <span class="math inline">\(3^{rd}\)</span> Quantile. Dann ergänzen wir noch die Werte für das <em>compact letter display</em> und fertig sind wir. Aber auch hier lieber einmal doppelt schauen, dass wir auch wirklich die richtigen Buchstaben zu den richtigen Faktorkombinationen ergänzt haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>cld_pos_tbl <span class="ot">&lt;-</span> broc_tbl <span class="sc">|&gt;</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fert_time, fert_amount) <span class="sc">|&gt;</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">quant_3rd =</span> <span class="fu">quantile</span>(weight, <span class="fl">0.75</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">group =</span> emm_cld_tbl<span class="sc">$</span>.group)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt stellen wir den Dot-Boxplot einmal in der folgenden Abbildung dar. Dazu nutzen wir das R Paket <code>{gghalves}</code> und die entsprechenden Funktionen. Wir müssen hier relativ viel machen, damit der Plot gut aussieht. Aber das meiste ist einfach nur Code wiederverwendet. Spannend ist hier die Variabilität in den Daten. Wir sehen hier, das unsere Brokkoliköpfe bei weitem nicht so nahe an dem Zielbereich sind, wie die Barplots suggerieren. Wir wollen eigentlich ziemlich eng um die <span class="math inline">\(500g\)</span> sein, sonnst muss der Supermarkt wild packen um immer die gleiche Packungsgröße zu haben. Jetzt wirken die Unterschiede zwischen den Zeitpunkten und den Mengen auch schon wieder etwas anders. Auch mit weniger Dünger können wir relativ große Brokkoli erhalten. Das plazieren der Buchstaben wäre vermutlich mit <code>annotate()</code> einfacher gewesen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(broc_tbl, <span class="fu">aes</span>(<span class="at">x =</span> fert_time, <span class="at">y =</span> weight, <span class="at">fill =</span> fert_amount)) <span class="sc">+</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mittleres Gewicht [g] des Brokkoli"</span>, <span class="at">x =</span> <span class="st">"Düngezeitpunkt"</span>,</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Düngemenge [mg/l]"</span>) <span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">500</span>, <span class="at">size =</span> <span class="fl">0.75</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_half_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> fert_amount), </span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">transformation =</span> <span class="fu">position_quasirandom</span>(<span class="at">width =</span> <span class="fl">0.05</span>),</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">side =</span> <span class="st">"l"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_half_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> fert_amount), </span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">side =</span> <span class="st">"r"</span>, <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">outlier.size =</span> <span class="fl">0.8</span>,</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> cld_pos_tbl, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_trim</span>(group), <span class="at">y =</span> quant_3rd <span class="sc">+</span> <span class="dv">70</span>),</span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span> <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-log-mod-gaussian-broc-half" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-mod-gaussian-broc-half-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-log-mod-gaussian-broc-half-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Abbildung&nbsp;60.19— Dotplots und Boxplots der mittleren Brokkoligewichte aus einem linearen gemischten Modell. Das lmer()-Modell berechnet das mittler Gewicht des Brokkoli in jeder Faktorkombination. Das compact letter display wird dann in {emmeans} generiert. Wir haben noch ein Mindestgewicht von 500g ergänzt."><img src="stat-modeling-mixed_files/figure-html/fig-log-mod-gaussian-broc-half-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-mod-gaussian-broc-half-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.19— Dotplots und Boxplots der mittleren Brokkoligewichte aus einem linearen gemischten Modell. Das <code>lmer()</code>-Modell berechnet das mittler Gewicht des Brokkoli in jeder Faktorkombination. Das <em>compact letter display</em> wird dann in <code>{emmeans}</code> generiert. Wir haben noch ein Mindestgewicht von 500g ergänzt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Anwendungsbeispiel: Gruppenvergleich für Thripsenbefall (3-faktoriell)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Im folgenden Beispiel schauen wir uns nochmal ein praktische Auswertung von einem agrarwissenschaftlichen Beispiel mit jungen Apfelbäumen an. Wir haben uns in diesem Experiment verschiedene Dosen <code>trt</code> von einem Insektizid aufgebracht sowie verschiedene Startanzahlen von Raubmilben als biologische Alternative untersucht. Dann haben wir noch fünf Zeitpunkte bestimmt, an denen wir die Anzahl an Thripsen auf den Blättern gezählt haben. Wir haben nicht die Blätter per se gezählt sondern Fallen waagerecht aufgestellt. Dann haben wir geschaut, wie viele Thripsen wir über <code>above</code> und unter <code>below</code> von den Fallen gefunden haben. In unserem Fall beschränken wir uns auf die obere Anzahl an Thripsen und schauen uns auch nur die Behandlung mit dem Insektizid an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>insects_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/insects_count.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timepoint =</span> <span class="fu">factor</span>(timepoint, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1 Tag"</span>, <span class="st">"4 Tag"</span>, <span class="st">"7 Tag"</span>, <span class="st">"11 Tag"</span>, <span class="st">"14 Tag"</span>)),</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">rep =</span> <span class="fu">as_factor</span>(rep),</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt =</span> <span class="fu">as_factor</span>(trt)) <span class="sc">|&gt;</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(timepoint, trt, rep, <span class="at">thripse =</span> thripse_above, <span class="at">mite =</span> mite_above) <span class="sc">|&gt;</span> </span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"10ml"</span>, <span class="st">"30ml"</span>, <span class="st">"60ml"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Warum bietet sich hier ein lineares gemischtes Modell an? Wir haben hier eine Wiederholung vorliegen, die wir dann als zufälligen Effekt modellieren können. Wir können daher die Poissonregression mit <code>glmer()</code> rechnen. Auch hier wieder darauf achten, dass wir dann als Option <code>family = poisson</code> wählen. Es hängt jetzt davon ab, ob du in deinen Daten Overdispersion vorliegen hast oder nicht, ob wir <code>glmer()</code> nutzen können. In den beiden folgenden Tabs, rechne ich dann mal beide Modelle. Einmal ohne die Berücksichtigung von Overdispersion mit <code>glmer()</code> aus dem R Paket <code>{lme4}</code> und einmal mit Berücksichtigung der Overdispersion mit <code>glmmTMB()</code> aus dem gleichnamigen R Paket.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true"><code>glmer()</code> mit <code>family = poisson</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false"><code>glmmTMB()</code> mit <code>family = nbinom1</code></a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>Als Erstes rechnen wir eine normale Poissonregression mit <code>glmer()</code> und schauen einmal, ob wir Overdispersion vorliegen haben. Wenn wir Overdispersion vorliegen haben, dann können wir keine Poissonregression rechnen, sondern müssen auf eine Quasipoisson Regression ausweichen. Das ist aber sehr einfach, wie du im anderen Tab sehen wirst.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>insects_poisson_fit <span class="ot">&lt;-</span> <span class="fu">glmer</span>(thripse <span class="sc">~</span> trt <span class="sc">+</span> timepoint <span class="sc">+</span> trt<span class="sc">:</span>timepoint <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> rep), </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> insects_tbl, </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">family =</span> poisson) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Bevor wir uns das Modell mit <code>summary()</code> überhaupt anschauen, wollen wir erstmal überprüfen, ob wir überhaupt Overdispersion vorliegen haben. Wenn ja, dann können wir uns die <code>summary()</code> hier gleich sparen und wir können dann mit dem Modell auch keine Gruppenvergleiche rechnen. Also einmal geguckt, was die Overdispersion macht.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>insects_poisson_fit <span class="sc">|&gt;</span> <span class="fu">check_overdispersion</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

       dispersion ratio =   18.796
  Pearson's Chi-Squared = 2518.668
                p-value =  &lt; 0.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Overdispersion detected.</code></pre>
</div>
</div>
<p>Wir haben sehr starke Overdispersion vorliegen und gehen daher in den anderen Tab und rechnen eine Quasipoisson Regression mit dem R Paket <code>{glmmTMB}</code>. Nur wenn du keine Overdispersion vorliegen hast, dann kannst du eine eine Poissonregression mit <code>glmer()</code> rechnen.</p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>Da wir in <code>{lme4}</code> keine Quasipoissonverteilung auswählen können, nutzen wir das <a href="https://glmmtmb.github.io/glmmTMB/index.html">R Paket <code>{glmmTMB}</code></a> mit der Verteilungsfamilie <code>nbinom1</code>, was einer Parametrisierung einer Quasipoissonverteilung entspricht. Meistens nutze ich gleich die <code>glmmTMB()</code> Funktion, da wir in biologischen Daten sehr häufig Overdispersion vorliegen haben. Dann kann man sich eine Runde gleich sparen. Aber am Ende kannst du dann auch die Modelle miteinander vergleichen und auch berichten wie groß deine Overdispersion ist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(thripse <span class="sc">~</span> trt <span class="sc">+</span> timepoint <span class="sc">+</span> trt<span class="sc">:</span>timepoint <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>rep), </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">data =</span> insects_tbl,</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">family =</span> nbinom1) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Im Folgedne schauen wir nochmal, ob wir in unserem neuen Modell in <code>glmmTMB()</code> noch Overdispersion vorliegen haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="sc">|&gt;</span> <span class="fu">check_overdispersion</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

 dispersion ratio = 0.814
          p-value = 0.712</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No overdispersion detected.</code></pre>
</div>
</div>
<p>Das passt soweit. Wir haben keine Overdispersion mehr. Dann berechnen wir auch einmal die <span class="math inline">\(R^2\)</span>-Werte für unser Modell. Hier gibt es dann nochmal mehr Informationen auf <a href="https://easystats.github.io/performance/articles/r2.html#marginal-vs--conditional-r2"><span class="math inline">\(R^2\)</span> for Mixed Models – Marginal vs.&nbsp;Conditional</a>. Wichtig ist, dass das <code>Conditional R2</code>, die gesamte erklärte Varianz von festen und zufälligen Effekten beschriebt und das <code>Marginal R2</code> nur die erklärte Varianz aus den festen Effekten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="sc">|&gt;</span> <span class="fu">r2</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.407
     Marginal R2: 0.176</code></pre>
</div>
</div>
<p>Tja, das Modell ist nun echt nicht gerade das beste Modell nach dem Bestimmtheitsmaß. Die festen Effekte, also unsere Behandlungen, erklären kaum etwas von der Varianz. Aber schauen wir mal weiter. Der <a href="https://easystats.github.io/performance/reference/icc.html">Intraclass Correlation Coefficient (ICC)</a> beschreibt nun die erklärte Varianz durch unsere zufälligen Effekte.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

    Adjusted ICC: 0.280
  Unadjusted ICC: 0.230</code></pre>
</div>
</div>
<p>Auch hier sind die Ergebnisse eher mau aus. Du kannst dir die gesamte Übersicht auch gleich in der Funktion <code>model_performance()</code> wiedergeben lassen. Das spart dann ein wenig Zeit und Code.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_performance</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC      |     AICc |      BIC | R2 (cond.) | R2 (marg.) |   ICC |   RMSE |  Sigma | Score_log | Score_spherical
----------------------------------------------------------------------------------------------------------------
1282.606 | 1287.242 | 1333.786 |      0.407 |      0.176 | 0.280 | 23.535 | 21.910 |    -4.414 |           0.063</code></pre>
</div>
</div>
<p>Wir haben hier auf jeden Fall Overdispersion vorliegen. Daher nutze ich dann auch das Modell hier in <code>glmmTMB()</code> mit der Annahme an eine Quasipoissonverteilung. Dann stimmt es auch mit unseren Varianzen und wir produzieren nicht zufällig zu viele signifikante Ergebnisse, die es dann gar nicht gibt.</p>
</div>
</div>
</div>
<p>Ich habe mich gerade in den obigen Tabs für eine Quasipoissonregression in einem linearen gemischten Modell mit <code>glmmTMB()</code> entschieden, da wir Overdispersion vorliegen haben. Damit mache ich dann mit dem <code>insects_quasipoisson_fit</code> Modell weiter. In den beiden folgenden Tabs findest du dann einmal das Ergebnis für die ANOVA und einmal für den Gruppenvergleich mit dem R Paket <code>{emmeans}</code>. Bitte beachte, dass die ANOVA für ein <code>glmmTMB()</code>-Objekt nicht ganz gleich wie für ein <code>lm()</code>-Objekt ist. Du kannst aber die ANOVA erstmal ganz normal interpretieren, nur haben wir hier nicht die Möglichkeit ein <span class="math inline">\(\eta^2\)</span> zu bestimmen. Dann nutzen wir <code>{emmeans}</code> für den Gruppenvergleich. Nochmal, weil wir Overdispersion festgestellt haben, nutzen wir das Objekt <code>insects_quasipoisson_fit</code> mit der Berücksichtigung der Overdispersion.</p>
<p>Im Folgenden rechnen wir einmal über alle Faktorkombinationen von <code>trt</code> und <code>timepoint</code> einen Gruppenvergleich. Dafür nutzen wir die Opition <code>trt * timepoint</code>. Wenn du die Analyse <em>getrennt</em> für die Zeitpunkte durchführen willst, dann nutze die Option <code>trt | timepoint</code>. Wir wollen die Wahrscheinlichkeiten für das Auftreten einer Beschädigung von wiedergegeben bekommen, deshalb die Option <code>regrid = "response</code>. Dann adjustieren wir noch nach Bonferroni und sind fertig.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> insects_quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt <span class="sc">*</span> timepoint, <span class="at">type =</span> <span class="st">"response"</span>) <span class="sc">|&gt;</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>emm_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> trt  timepoint response    SE  df asymp.LCL asymp.UCL .group
 60ml 4 Tag         10.6  3.76 Inf      3.72      30.0  a    
 60ml 14 Tag        10.6  4.00 Inf      3.50      32.1  ab   
 60ml 11 Tag        15.7  5.34 Inf      5.80      42.6  abc  
 30ml 11 Tag        19.3  6.42 Inf      7.28      51.3  abc  
 60ml 7 Tag         19.7  6.30 Inf      7.69      50.4  abc  
 30ml 14 Tag        20.0  6.42 Inf      7.82      51.3  abc  
 60ml 1 Tag         20.0  6.18 Inf      8.11      49.5  abc  
 30ml 4 Tag         20.8  6.55 Inf      8.25      52.5  abc  
 30ml 1 Tag         22.7  7.19 Inf      8.93      57.5  abc  
 10ml 4 Tag         23.3  7.03 Inf      9.64      56.5  abc  
 10ml 14 Tag        30.8  8.52 Inf     13.70      69.4  abc  
 30ml 7 Tag         32.0  9.02 Inf     14.00      73.2  abc  
 10ml 1 Tag         40.3 10.29 Inf     19.03      85.2   bc  
 10ml 7 Tag         40.7 10.48 Inf     19.09      86.7   bc  
 10ml 11 Tag        43.6 10.83 Inf     21.06      90.4    c  

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 15 estimates 
Intervals are back-transformed from the log scale 
P value adjustment: bonferroni method for 105 tests 
Tests are performed on the log scale 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Das <code>emm_obj</code> Objekt werden wir dann gleich einmal in <code>{ggplot}</code> visualisieren. Die <code>response</code> stellt die mittlere Anzahl an Thripsen je Faktorkombination dar. Dann können wir auch das <em>compact letter display</em> anhand der Abbildung interpretieren. Ich stelle die Abbildung wieder einmal als Barplot und einmal als Dot-Boxplot in den beiden Tabs dar.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Barplots</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Dotplots und Boxplots</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>In der <a href="#fig-log-mod-pois-insect" class="quarto-xref">Abbildung&nbsp;<span>60.20</span></a> siehst du das Ergebnis der Auswertung in einem Säulendiagramm. Hier unbedingt <code>SE</code> als den Standardfehler für die Fehlerbalken nutzen, da wir sonst Fehlerbalken größer und kleiner als <span class="math inline">\(0\)</span> erhalten, wenn wir die Standardabweichung nutzen würden. Das ist in unserem Fall nicht so das Problem, aber wenn du eher kleine Anzahlen zählst, kann das schnell zu Werten kleiner Null führen. Wir sehen einen klaren Effekt der Behandlung <code>60ml</code>. Die Zeit hat keinen Effekt, was ja schon aus der ANOVA klar war, die Säulen sehen für jeden Zeitpunkt vollkommen gleich aus. Gut etwas Unterschied ist ja immer.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> timepoint, <span class="at">y =</span> response, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mittlere Anzahl an Thripsen"</span>, <span class="at">x =</span> <span class="st">"Messzeitpunkte der Zählungen"</span>,</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Dosis"</span>) <span class="sc">+</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.8</span>, </span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_trim</span>(.group), <span class="at">y =</span> response <span class="sc">+</span> SE <span class="sc">+</span> <span class="dv">1</span>), <span class="at">size =</span> <span class="dv">3</span>,  </span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> response<span class="sc">-</span>SE, <span class="at">ymax =</span> response<span class="sc">+</span>SE),</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-log-mod-pois-insect" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-mod-pois-insect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-log-mod-pois-insect-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Abbildung&nbsp;60.20— Säulendigramm der mittleren Zahl der Thripsen aus einer Quasipoissonregression mit einem gemischten Modell. Das glmmTMB()-Modell berechnet die mittlere Anzahl in jeder Faktorkombination. Das compact letter display wird dann in {emmeans} generiert."><img src="stat-modeling-mixed_files/figure-html/fig-log-mod-pois-insect-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-mod-pois-insect-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.20— Säulendigramm der mittleren Zahl der Thripsen aus einer Quasipoissonregression mit einem gemischten Modell. Das <code>glmmTMB()</code>-Modell berechnet die mittlere Anzahl in jeder Faktorkombination. Das <em>compact letter display</em> wird dann in <code>{emmeans}</code> generiert.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>Damit wir uns gleich einmal die Daten in einem Dotplot und Boxplot anschauen können, brauchen wir noch die Positionen für das <em>compact letter display</em> in unser Abbildung. Daher brauchen wir erstmal das <em>compact letter display</em> und entfernen alle Faktorkombinationen, die keine Werte haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>emm_cld_tbl <span class="ot">&lt;-</span> emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(timepoint, trt)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt berechnen wir uns noch die Position. Ich setze hier das <em>compact letter display</em> auf die Position des dritten Quartils, was ausreichen sollte und nicht zu weit weg ist. Damit haben wir dann die Buchstaben nahe genug an den Boxen der Boxplots.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>cld_pos_tbl <span class="ot">&lt;-</span> insects_tbl <span class="sc">|&gt;</span> </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(timepoint, trt) <span class="sc">|&gt;</span> </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">quant_3rd =</span> <span class="fu">quantile</span>(thripse, <span class="fl">0.75</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">group =</span> emm_cld_tbl<span class="sc">$</span>.group)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#fig-log-mod-pois-insect-dotbox" class="quarto-xref">Abbildung&nbsp;<span>60.21</span></a> siehst du dann einmal das Ergebnis des Dot-Boxplot. Im Gegensatz zu dem anderen Beispiel sind die Daten hier etwas übersichtlicher was die Dotplots angeht. Dennoch sieht man hier teilweise sehr viel mehr. Zum einen wird die große Variabilität in den Daten klar. Teilweise sind die Unterschiede nur durch wenige Beobachtungen zu erklären, die die mittleren Raten nach oben ziehen. So sind in bei allen Dosen immer wieder sehr wenige Thrispen zu beobachten. Die Unterschiede kommen dann von wenigen großen Zählungen. Wenn diese ausbleiben, dann haben wir eher einen Unterschied. Die Aussagekraft von den Dot-Boxplots sind auf jeden Fall sehr viel höher als bei den einfachen Barplots.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(insects_tbl, <span class="fu">aes</span>(<span class="at">x =</span> timepoint, <span class="at">y =</span> thripse, <span class="at">fill =</span> trt)) <span class="sc">+</span> </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mittlere Anzahl an Thripsen"</span>, <span class="at">x =</span> <span class="st">"Messzeitpunkte der Zählungen"</span>,</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Dosis"</span>) <span class="sc">+</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_half_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> trt), </span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">transformation =</span> <span class="fu">position_quasirandom</span>(<span class="at">width =</span> <span class="fl">0.05</span>),</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">side =</span> <span class="st">"l"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_half_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> trt), </span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">side =</span> <span class="st">"r"</span>, <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">outlier.size =</span> <span class="fl">0.8</span>,</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span> </span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> cld_pos_tbl, <span class="fu">aes</span>(<span class="at">label =</span> group, <span class="at">y =</span> quant_3rd <span class="sc">+</span> <span class="dv">5</span>),</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span> <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-log-mod-pois-insect-dotbox" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-mod-pois-insect-dotbox-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-log-mod-pois-insect-dotbox-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Abbildung&nbsp;60.21— Dotplots und Boxplots der mittleren Zahl der Thripsen aus einer Quasipoissonregression mit einem gemischten Modell. Das glmmTMB()-Modell berechnet die mittlere Anzahl in jeder Faktorkombination. Durch die Darstellung in Dotplot und Boxplot ist die große Heterogenität in den Daten zu sehen. Das compact letter display wird dann in {emmeans} generiert."><img src="stat-modeling-mixed_files/figure-html/fig-log-mod-pois-insect-dotbox-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-mod-pois-insect-dotbox-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.21— Dotplots und Boxplots der mittleren Zahl der Thripsen aus einer Quasipoissonregression mit einem gemischten Modell. Das <code>glmmTMB()</code>-Modell berechnet die mittlere Anzahl in jeder Faktorkombination. Durch die Darstellung in Dotplot und Boxplot ist die große Heterogenität in den Daten zu sehen. Das <em>compact letter display</em> wird dann in <code>{emmeans}</code> generiert.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Anwendungsbeispiel: Gruppenvergleich für Boniturnoten von Schweinen (3-faktoriell)
</div>
</div>
<div class="callout-body-container callout-body">
<p>In dem folgenden agrawissenschaftlichen Beispiel wollen wir uns einmal die Auswertung von verschiedenen Schweinerassen im Bezug auf ihre Fußgesundheit in zwei Platzangeboten in Ställen anschauen. Die Ställe haben dabei zwei Arten von Belegung vorliegen, nämlich einmal eine weite Belegung und einmal eine enge Belegung. Darüber hinaus ist die Studie in verschiedenen Ställen und und verschiedenen Orten durchgeführt worden. Es ergibt sich also ein recht komplexer Datensatz. Dabei sind die Ställe <code>barn</code> auf den Höfe <code>location</code> genestet. Darüber hinaus haben wir eine Behandlung <code>spacing</code> sowie die verschiedenen Schweinerassen <code>breed</code>. Ich habe hier nur eine Auswahl an Schweinerassen getroffen, da mir sonst das <code>clmm()</code>-Modell zu lange dauert bis es gerechnet ist. Wir brauchen dann später für unser <code>clmm()</code>-Modell das Outcome noch als geordneten Faktor. Wenn du den Code nutzt, dann kannst du gerne alle Schweinerassen mit in das Modell nehmen. Ebenfalls hilfreich ist das Tutorium <a href="https://tdunn.ca/posts/2020-03-15-ordinal-regression-in-r-part-1/">Ordinal regression in R: part 1</a> auf das ich gerne verweisen möchte. Am Ende haben wir einen sehr großen Datensatz mit 2840 bonitierten Schweinen. Das sind wirklich eine Menge Schweine.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/bonitur_pig.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">breed =</span> <span class="fu">as_factor</span>(breed),</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">spacing =</span> <span class="fu">factor</span>(spacing, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Weite Belegung"</span>, <span class="st">"Enge Belegung"</span>)),</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">location =</span> <span class="fu">as_factor</span>(location),</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">barn =</span> <span class="fu">as_factor</span>(barn),</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">foot_inflamed_fct =</span> <span class="fu">ordered</span>(foot_inflamed)) <span class="sc">|&gt;</span> </span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(breed <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Vietnamese Pot-bellied"</span>, <span class="st">"Welsh"</span>, <span class="st">"Belarus Black Pied"</span>, <span class="st">"Saddleback"</span>, </span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"American Yorkshire"</span>, <span class="st">"Bentheim Black Pied"</span>, <span class="st">"Mangalica"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die Daten sehen wir dann auch nochmal in der <a href="#fig-clm-pig-violin" class="quarto-xref">Abbildung&nbsp;<span>60.22</span></a> als Violinplot visualisiert. Wir sehen, dass wir bei der Anzahl an Beobachtungen dann nichts mehr sehen. Die Violinplots mögen sich unterscheiden, aber so richtig gut erkennen, können wir hier eigentlich nicht. Auch lassen sich hier schwer halbe Abbildungen erstellen. Wir haben teilweise so viele Beobachtungen mit geringen Noten, dass wir kaum etwas erkennen können.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pig_tbl, <span class="fu">aes</span>(breed, foot_inflamed, <span class="at">fill =</span> breed)) <span class="sc">+</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> spacing, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Schweinerasse"</span>, <span class="at">y =</span> <span class="st">"Boniturnote"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-clm-pig-violin" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-clm-pig-violin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-clm-pig-violin-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Abbildung&nbsp;60.22— Violinplot der Boniturnoten für die Fußgesundheit der Schweinerassen aufgeteilt nach dem Platzangebot. Klar ist die sehr schiefe Verteilung der Boniturnoten zu erkennen."><img src="stat-modeling-mixed_files/figure-html/fig-clm-pig-violin-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-clm-pig-violin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.22— Violinplot der Boniturnoten für die Fußgesundheit der Schweinerassen aufgeteilt nach dem Platzangebot. Klar ist die sehr schiefe Verteilung der Boniturnoten zu erkennen.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir rechnen jetzt eine ordinale gemischte Regression mit der Funktion <code>clmm()</code>. Wir schreiben das Modell wie wir es schon kennen mit zwei festen und einem genesteten zufälligen Effekt. Wir betrachten auch die Interaktion zwischen den Schweinerassen und dem Platzangebot. Mich würde wundern wenn alle Schweinerassen auf das Platzangebot gleich reagieren würden. Dann müssen wir noch sichergehen das unser Outcome als Faktor mit der Spalte <code>foot_inflamed_fct</code> kodiert ist, damit wir das Modell rechnen können.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>clmm_fit <span class="ot">&lt;-</span> <span class="fu">clmm</span>(foot_inflamed_fct <span class="sc">~</span> breed <span class="sc">+</span> spacing <span class="sc">+</span> breed<span class="sc">:</span>spacing <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> location<span class="sc">/</span>barn), </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> pig_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir nutzen das Modell <code>clmm_fit</code> direkt für den Gruppenvergleich und übergehen einmal die Modelldiagnostik hier. Jetzt rechnen wir in den beiden folgenden Tabs einmal die ANOVA und dann auch den multiplen Gruppenvergleich mit <code>{emmeans}</code>. Da wir hier ordinale Daten haben, können wir dann nicht einfach die Standardverfahren nehmen. Wir entscheiden uns dann für den Standardfehler bei der Darstellung.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">ANOVA mit <code>anova()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Gruppenvergleich mit <code>emmeans()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>Wir rechnen hier einmal die ANOVA mit der Funktion <code>Anova.clmm()</code> aus dem R Paket <code>{RVAideMemoire}</code>. In dem Paket <code>{ordinal}</code> ist keine ANOVA für den Gruppenvergleich implementiert. Wir machen dann die Ausgabe nochmal schöner und fertig sind wir.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>clmm_fit <span class="sc">|&gt;</span> </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova.clmm</span>() <span class="sc">|&gt;</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter     |   Chi2 | df |      p
------------------------------------
breed         | 158.00 |  6 | &lt; .001
spacing       | 184.31 |  1 | &lt; .001
breed:spacing |  30.62 |  6 | &lt; .001

Anova Table (Type 2 tests)</code></pre>
</div>
</div>
<p>Wir sehen, dass die Schweinerasse signifikant ist. Ebenso hat der Abstand in den Ställen einen signifikanten Einfluss auf die Fußgesundheit. Wie es auch zu erwarten war, verhalten sich natürlich nicht alle Schweinerassen identisch im Bezug auf das Platzangebot und der Fußgesundheit. Es wäre auch sehr komisch, wenn wir hier keine Interaktion gehabt hätten. Wir werten also gleich mal die Boniturnoten getrennt für das Platzangebot aus. Auch hier müssen wir uns Fragen was ist mehr von Interesse, ich entscheide mich hier für die Rassen.</p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<p>Im Folgenden rechnen wir einmal für den Faktor <code>breed</code> getrennt für die beiden Platzangebote <code>spacing</code> einen Gruppenvergleich. Immerhin haben wir eine Interaktion vorliegen. Wir setzen hier die Option <code>mean.class</code> damit wir dann die mittleren Noten wiedergegeben bekommen. Mit den mittleren Noten können wir dann ein Säulendiagramm erstellen. Dann adjustieren wir <em>nicht</em> und sind auch schon fertig. Warum adjustieren wir hier nicht? Wenn du hier adjustierst ist am Ende nichts mehr signifikant, da du so viele Gruppenvergleiche rechnest, das hier die <span class="math inline">\(p\)</span>-Werte nicht klein genug werden. Irgendwo ist dann auch eine Grenze. Die Effekte sind hier nicht stark genug sein um sie dann noch signifikant nachzuweisen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> clmm_fit <span class="sc">|&gt;</span> </span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> breed <span class="sc">|</span> spacing, <span class="at">mode =</span> <span class="st">"mean.class"</span>) <span class="sc">|&gt;</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>emm_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>spacing = Weite Belegung:
 breed                  mean.class     SE  df asymp.LCL asymp.UCL .group
 American Yorkshire           1.10 0.0843 Inf     0.933      1.26  a    
 Mangalica                    1.13 0.1044 Inf     0.922      1.33  a    
 Saddleback                   1.19 0.1486 Inf     0.895      1.48  a    
 Welsh                        1.19 0.1516 Inf     0.892      1.49  a    
 Vietnamese Pot-bellied       1.20 0.1574 Inf     0.889      1.51  a    
 Belarus Black Pied           1.52 0.3692 Inf     0.795      2.24  a    
 Bentheim Black Pied          1.82 0.5319 Inf     0.777      2.86  a    

spacing = Enge Belegung:
 breed                  mean.class     SE  df asymp.LCL asymp.UCL .group
 American Yorkshire           1.16 0.1326 Inf     0.903      1.42  ab   
 Mangalica                    1.63 0.4327 Inf     0.782      2.48  a    
 Welsh                        2.04 0.6361 Inf     0.793      3.29  ab   
 Saddleback                   2.11 0.6683 Inf     0.798      3.42  abc  
 Bentheim Black Pied          2.41 0.7771 Inf     0.884      3.93   bcd 
 Vietnamese Pot-bellied       2.76 0.8871 Inf     1.017      4.49    cd 
 Belarus Black Pied           2.84 0.9110 Inf     1.053      4.62     d 

Confidence level used: 0.95 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Das <code>emm_obj</code> Objekt werden wir dann gleich einmal in <code>{ggplot}</code> visualisieren. Die <code>mean.class</code> stellt den mittleren Noten der Fußgesundheit für die Menge die Rassen getrennt nach dem Platzangebot dar. Wir nutzen dann auch hier die Standardfehler für die Abbildungen, da wir sonst schnelle Werte kleiner 0 und größer 9 erhalten. Dann können wir zum Abschluss auch das <em>compact letter display</em> anhand der Abbildung interpretieren.</p>
</div>
</div>
</div>
<p>In der <a href="#fig-log-mod-ordinal-broc" class="quarto-xref">Abbildung&nbsp;<span>60.23</span></a> siehst du das Ergebnis der Auswertung in einem Säulendiagramm. In unserem Fall ist die weite Belegung nicht signifikant über die Rassen. Bei der engen Belegung sehen wir schon einige Unterschiede in der Benotung der Fußgesundheit. Die große Frage bleibt hier, ist der Effekt den wir sehen überhaupt relevant oder nicht? Immerhin haben wir sehr geringe mittlere Boniturnoten, die eventuell darüber hinwegtäuschen wie stark der Effekt eigentlich ist. Als Faustformel sage ich mir immer, dass ich eigentlich immer einen Notenschritt als Änderung sehen möchte. Sonst ist es eigentlich zu wenig um von einer Relevanz zu sprechen. Aber das ist eher eine Diskussion im Kontext der wissenschaftlichen Fragestellung als eine statistische Diskussion.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> mean.class, <span class="at">fill =</span> breed)) <span class="sc">+</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mittlere Boniturnote"</span>, <span class="at">x =</span> <span class="st">"Schweinerasse"</span>) <span class="sc">+</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_trim</span>(.group), <span class="at">y =</span> mean.class <span class="sc">+</span> SE <span class="sc">+</span> <span class="fl">0.01</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>,</span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean.class<span class="sc">-</span>SE, <span class="at">ymax =</span> mean.class<span class="sc">+</span>SE),</span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> spacing, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">4</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-log-mod-ordinal-broc" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-mod-ordinal-broc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-mixed_files/figure-html/fig-log-mod-ordinal-broc-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Abbildung&nbsp;60.23— Säulendigramm der mittleren Boniturnote der Fußgesundheit aus einer ordinalen gemischten Regression. Das clmm()-Modell berechnet das mittlere Boniturnote für den Faktor breed getrennt für die beiden Platzangebote spacing. Das compact letter display wird dann in {emmeans} generiert. Fraglich bleibt, ob die Unterschiede wirklich relevant sind, da die mittleren Boniturnoten sehr nahe beieinander liegen."><img src="stat-modeling-mixed_files/figure-html/fig-log-mod-ordinal-broc-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-mod-ordinal-broc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;60.23— Säulendigramm der mittleren Boniturnote der Fußgesundheit aus einer ordinalen gemischten Regression. Das <code>clmm()</code>-Modell berechnet das mittlere Boniturnote für den Faktor <code>breed</code> getrennt für die beiden Platzangebote <code>spacing</code>. Das <em>compact letter display</em> wird dann in <code>{emmeans}</code> generiert. Fraglich bleibt, ob die Unterschiede wirklich relevant sind, da die mittleren Boniturnoten sehr nahe beieinander liegen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-bates2014fitting" class="csl-entry" role="listitem">
Bates, D., Mächler, M., Bolker, B., &amp; Walker, S. (2014). Fitting linear mixed-effects models using lme4. <em>arXiv preprint arXiv:1406.5823</em>.
</div>
<div id="ref-roback2021beyond" class="csl-entry" role="listitem">
Roback, P., &amp; Legler, J. (2021). <em>Beyond multiple linear regression: applied generalized linear models and multilevel models in R</em>. CRC Press.
</div>
<div id="ref-salinas2023generalized" class="csl-entry" role="listitem">
Salinas Ruı́z, J., Montesinos López, O. A., Hernández Ramı́rez, G., &amp; Crossa Hiriart, J. (2023). <em>Generalized Linear Mixed Models with Applications in Agriculture and Biology</em>. Springer Nature.
</div>
<div id="ref-winter2013linear" class="csl-entry" role="listitem">
Winter, B. (2013). Linear models and linear mixed effects models in R with linguistic applications. <em>arXiv preprint arXiv:1308.5499</em>.
</div>
<div id="ref-zuur2009mixed" class="csl-entry" role="listitem">
Zuur, A. F., Ieno, E. N., Walker, N. J., Saveliev, A. A., Smith, G. M., et al. (2009). <em>Mixed effects models and extensions in ecology with R</em> (Bd. 574). Springer.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-modeling-prob-model.html" class="pagination-link" aria-label="Linear Probability Model">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-modeling-gee.html" class="pagination-link" aria-label="Generalized Estimating Equations (GEE)">
        <span class="nav-page-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb130" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, simstudy, writexl,</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="in">               see, patchwork, conflicted)</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="in">source("stat-modeling-mixed_plot/stat-modeling-mixed-plots.R")</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(patchwork::area)</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="fu"># Lineare gemischte Modelle {#sec-mixed}</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-modeling-mixed.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Wer die Arbeit kennt und sich nicht drückt, der ist verrückt." --- Tick, Trick und Track*</span></span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel vollen wir die Grundzüge der lineare gemischten Modell (eng. *linear mixed models*, abk. *lmm*) zu versuchen zu verstehen. Wir immer, es gibt dazu auch hervorragende Literatur wie das sehr ausführliche Buch von @zuur2009mixed oder @roback2021beyond mit dem freien Onlinebuch <span class="co">[</span><span class="ot">Beyond Multiple Linear Regression - Applied Generalized Linear Models and Multilevel Models in R</span><span class="co">](https://bookdown.org/roback/bookdown-BeyondMLR/)</span>. Auch liefert @salinas2023generalized mit dem Open Access Buch <span class="co">[</span><span class="ot">Generalized Linear Mixed Models with Applications in Agriculture and Biology</span><span class="co">](https://link.springer.com/book/10.1007/978-3-031-32800-8)</span> eine gute Quelle zum Weiterlesen. Wir fangen jetzt aber erstmal an zu verstehen, wie eigentlich ein Experiment aussehen muss, damit wir ein lineares gemischtes Modell rechnen wollen. Dabei ist der erste wichtige Punkt, das wir hier mit den gemischten Modellen hierarchische Daten abbilden. Es gibt also eine Hierarchie zwischen den Daten und damit auch eine Abhängigkeit innerhalb der Daten. Eine Abhängigkeit ist in der Statistik eine Korrelationsstruktur. Hier konzentrieren wir uns auf agrarwissenschaftliche Daten. Wir haben dabei in den Agarwissenschaften unser $x$ als Faktoren $f$ vorliegen. Für das $y$ können aber jeden Messwert als Outcome abbilden den wir wollen. Dafür gibt es dann zum Beispiel die Funktion <span class="in">`glmer()`</span>, die das Äquivalent zu der Funktion <span class="in">`glm()`</span> ist.</span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="center"}</span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Dieses Kapitel ist mathematisch und statistisch teilweise inkorrekt. Insbesondere die Modelle unterschlagen Fehlerterme und andere Aspekte der Korrelationstruktur von hierarischen Daten. Aber wie immer... erst einfach verstehen, dann komplizierter nachlesen.</span></span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a>Wir haben also folgendes, mehrfaktorielles Modell vorliegen. Diese Faktoren haben teilweise eine Hierarchie, die wir dann modellieren wollen.</span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb130-27"><a href="#cb130-27" aria-hidden="true" tabindex="-1"></a>y \sim f_1 + f_2 + z_1 + z_2</span>
<span id="cb130-28"><a href="#cb130-28" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb130-29"><a href="#cb130-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-30"><a href="#cb130-30" aria-hidden="true" tabindex="-1"></a>Und eigentlich haben wir ja gar nicht vier *gleichwertige* Faktoren vorliegen, sondern meistens unsere Behandlungsfaktor $f_1$ und $f_2$ an dem wir interessiert sind und dann noch bis zu zwei weitere Faktoren $z_1$ und $z_2$, die eine weitere Gruppierung repräsentieren. Wir können auch noch mehr Faktoren vorliegen haben, aber ich empfehle ein Design immer auf maximal vier Faktoren zu begrenzen. Unsere beiden Faktoren $z_1$ und $z_2$ beschreiben jetzt aber nicht noch mehr Behandlungen sondern stellen ein Feld, einen Block oder aber einen Stall dar. Wir haben es also mit Faktoren für eine "Position" zu tun. Die Position kann auch eine zeitliche Komponente sein. Deshalb schreiben wir etwas allgemeiner für die Faktoren $z_1$ und $z_2$ auch als "zufällige" Effekte. Wie schon erwähnt es handelt sich nicht ausschließlich um Blöcke, es können auch andere Positionen in Raum und Zeit sein. Es geht immer mehr und manchmal braucht man auch mehr Faktoren, aber in unserem Kontext hier würde ich anraten sich auf eher auf drei Faktoren zu begrenzen. Also entweder zwei Behandlungsfaktoren $f_1$ sowie $f_2$ und ein Positionsfaktor $z_1$ oder aber ein Behandlungsfaktor $f_1$ und zwei Positionsfaktoren $z_1$ sowie $z_2$.</span>
<span id="cb130-31"><a href="#cb130-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-32"><a href="#cb130-32" aria-hidden="true" tabindex="-1"></a>Als wäre das nicht kompliziert genug, haben wir meistens auch noch verschachtelte (eng. *nested*) Daten vorliegen. Damit meine ich, dass wir den Faktor $z_1$ in jedem Level des Faktors $z_2$ vorliegen haben. Wir können eben verschiedene Standorte als Faktor $z_2$ betrachten und an jedem der Standorte haben wir Blöcke $z_1$ vorliegen. Mehr dazu findest du dann auch in dem Kapitel <span class="co">[</span><span class="ot">Versuchsplanung in R</span><span class="co">](#sec-experimental-design-r)</span> und gleich nochmal weiter unten im Text.</span>
<span id="cb130-33"><a href="#cb130-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-34"><a href="#cb130-34" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb130-35"><a href="#cb130-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## Welche R Implementierung verwenden?</span></span>
<span id="cb130-36"><a href="#cb130-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-37"><a href="#cb130-37" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel werden wir *nicht* die Implementierung von linearen gemischten Modellen in dem R Paket <span class="in">`{nlme}`</span> verwenden. Das Paket <span class="in">`{nlme}`</span> hat sinnvolle Funktionen und je nach Fragestellung haben diese auch eine Berechtigung. Es gibt aber neuere R Pakete wie <span class="in">`{lme4}`</span> oder <span class="in">`{glmmTMB}`</span>, die wir dann hier in dem Kapitel nutzen wollen wenn es um statistsiche Analyse mit linearen gemischten Modellen geht..</span>
<span id="cb130-38"><a href="#cb130-38" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-39"><a href="#cb130-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-40"><a href="#cb130-40" aria-hidden="true" tabindex="-1"></a>Was ist nun das Besondere an einem linearen gemischten Modell? Wie der Name schon sagt, haben wir irgendwas gemischt. Glücklicherweise mischen wir nur zwei Dinge miteinander. Wir mischen hier feste Effekte (eng. *fixed effect*) und zufällige Effekte (eng. *random effect*) miteinander. Bis jetzt kennst du eigentlich nur feste Effekte. Immer wenn wir ein Modell gebaut haben, dann haben wir das Modell mit festen Effekten gebaut. Wir haben dabei Fakotoren als feste Effekte modelliert. Was ist also nun der Unterschied zwischen der Wahl einen Faktor als festen Effekt oder zufälligen Effekt anzusehen? Zuerst ist dies eine Modellierungsentscheidung. Wir müssen uns also zwischen Arten von Modellen unterscheiden. Daher können wir auch verschiedene Modelle mit unterschiedlichen Anzahlen an Faktoren bauen und dann diese Modelle vergleichen. Welcher Faktor jetzt als fester Effekt und welcher als zufälliger Effekt gilt, liegt dabei an uns.</span>
<span id="cb130-41"><a href="#cb130-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-42"><a href="#cb130-42" aria-hidden="true" tabindex="-1"></a>Die Idee hinter dem Modell mit **festen Effekten** ist, dass die beobachteten Effektgrößen von Block zu Block variieren können, was aber nur auf den Varianz der Blöcke zurückzuführen ist. In Wirklichkeit sind die wahren Effektgrößen alle gleich: Sie sind fix. Alle Blöcke haben den gleichen Mittelwert und variieren nur in der Varianz. Wir sehen aber diesen wahren Mittelwert nicht, da sich alle Blöcke eben immer leicht unterscheiden. Mehr dazu auch in <span class="co">[</span><span class="ot">The Fixed-Effect Model</span><span class="co">](https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/pooling-es.html#fem)</span>)</span>
<span id="cb130-43"><a href="#cb130-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-44"><a href="#cb130-44" aria-hidden="true" tabindex="-1"></a>Das Modell der **zufälligen Effekte** geht davon aus, dass es nicht nur eine wahre Effektgröße gibt, sondern eine Verteilung der wahren Effektgrößen. Jeder unserer Blöcke kann also einen anderen wahren Mittelwert haben. Das Ziel des Modells mit zufälligen Effekten ist es daher nicht, die eine wahre Effektgröße aller Blöcke zu schätzen, sondern den Mittelwert der Verteilung der wahren Effekte. Mehr dazu auch in <span class="co">[</span><span class="ot">The Random-Effect Model</span><span class="co">](https://bookdown.org/MathiasHarrer/Doing_Meta_Analysis_in_R/pooling-es.html#rem)</span>)</span>
<span id="cb130-45"><a href="#cb130-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-46"><a href="#cb130-46" aria-hidden="true" tabindex="-1"></a>Dabei verbinden die gemischten Modelle die Vorteile eines Modells mit festen Effekt sowie eines Modells mit zufälligen Effekten. Lineare gemischte Modelle schätzen nun die subjektspezifischen Auswirkungen (eng. *subject-specific*) auf die Varianz eines Versuches. Dabei kommt es häufig darauf an unter welchen Umständen eine Beobachtung gemessen wurde. Stehen die Pflanze zusammen auf einem Feld? Sind die Ferkel alle Nachkommen einer Sau? Daher erweitern wir unser lineare Modell um einen zufälligen Effekt $z$ und schreiben wie folgt.</span>
<span id="cb130-47"><a href="#cb130-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-48"><a href="#cb130-48" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb130-49"><a href="#cb130-49" aria-hidden="true" tabindex="-1"></a>y \sim f_1 + 1|z_1</span>
<span id="cb130-50"><a href="#cb130-50" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb130-51"><a href="#cb130-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-52"><a href="#cb130-52" aria-hidden="true" tabindex="-1"></a>Wir schreiben in R den Term für da zufällige Modell in der Form $z_0|z_1$. Meist setzen wir den Intercept $z_0$ für den zufälligen Effekt auf <span class="in">`1`</span>. Wenn wir darstellen wollen, das ein zufälliger Faktor in einem anderen zufälligen Fakotr genestet ist, dann schreiben wir <span class="in">`1|z_1/z_2`</span>.</span>
<span id="cb130-53"><a href="#cb130-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-54"><a href="#cb130-54" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb130-55"><a href="#cb130-55" aria-hidden="true" tabindex="-1"></a>y \sim f_1 + 1|z_1/z_2</span>
<span id="cb130-56"><a href="#cb130-56" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb130-57"><a href="#cb130-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-58"><a href="#cb130-58" aria-hidden="true" tabindex="-1"></a>Das heißt, dass der zufällige Blockfaktor $z_1$ in den zufälligen Blockfaktor $z_2$ genestet ist. Das klingt jetzt etwas schräg, also einmal ein Beispiel. Wir haben eine Schule, dann sind die Schulklassen dieser Schule in der Schule genestet. Es gibt diese spezifischen Klassen mit den Schülern schlichtweg nicht in anderen Schulen. Wir sagen genestet (eng. *nested*), wenn wir sagen wollen, dass ein Faktor in einen anderen Faktor verschränkt ist. Die Klassen einer Schule sind in der Schule genestet.</span>
<span id="cb130-59"><a href="#cb130-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-60"><a href="#cb130-60" aria-hidden="true" tabindex="-1"></a>In der @fig-mermaid-r-mixed-01 siehst du einmal exemplarisch die Darstellung eines experimentellen Designs mit drei Faktoren. Die Behandlung ist dabei ein fester Effekt und die beiden Faktoren für die Tische und die Gewächshäuser sind zufällige Effekte. Damit wir in der Folge nicht immer so sehr durcheinander kommen, habe ich die festen Effekt als blau Kästen und die zufälligen Effekte als orange Kästen gesetzt.</span>
<span id="cb130-61"><a href="#cb130-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-64"><a href="#cb130-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb130-65"><a href="#cb130-65" aria-hidden="true" tabindex="-1"></a><span class="in">%%| label: fig-mermaid-r-mixed-01</span></span>
<span id="cb130-66"><a href="#cb130-66" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-width: 6</span></span>
<span id="cb130-67"><a href="#cb130-67" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-cap: "Beispiel für drei Faktoren und deren Abhänigigkeitsstruktur untereinander. Die Behandlungen sind in den Tischen genested und die Tische in den Gewächshäusern. Die festen Effekte sind als blaue Kästen und die zufälligen als orange Kästen eingefärbt."</span></span>
<span id="cb130-68"><a href="#cb130-68" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart LR</span></span>
<span id="cb130-69"><a href="#cb130-69" aria-hidden="true" tabindex="-1"></a><span class="in">    C(Behandlungen):::fixed --- D(((nested))) --&gt; E(Tische):::random --- F(((nested))) --&gt; G(Gewächshäuser):::random</span></span>
<span id="cb130-70"><a href="#cb130-70" aria-hidden="true" tabindex="-1"></a><span class="in">    classDef fixed fill:#56B4E9,stroke:#333,stroke-width:0.75px</span></span>
<span id="cb130-71"><a href="#cb130-71" aria-hidden="true" tabindex="-1"></a><span class="in">    classDef random fill:#E69F00,stroke:#333,stroke-width:0.75px</span></span>
<span id="cb130-72"><a href="#cb130-72" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-73"><a href="#cb130-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-74"><a href="#cb130-74" aria-hidden="true" tabindex="-1"></a>Okay, das ist jetzt bis hierher sehr abstrakt. Machen wir das mal konkret mit einem Beispiel mit drei Behandlungen gegen Blattläuse auf jeweils vier Tischen in drei Gewächshäusern. Pro Behandlung nehmen wir fünf Pflanzen. Damit ergibt sich folgendes Schema der Abhängigkeiten mit den jeweiligen Anzahlen.</span>
<span id="cb130-75"><a href="#cb130-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-76"><a href="#cb130-76" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb130-77"><a href="#cb130-77" aria-hidden="true" tabindex="-1"></a>\overbrace{\mbox{Gewächshauser}}^{n_g = 3} \xrightarrow<span class="co">[</span><span class="ot">alle</span><span class="co">]</span>{beinhaltet} \underbrace{\mbox{Tische}}_{n_t = 4} \xrightarrow[alle]{beinhaltet} \overbrace{\mbox{Behandlungen}}^{n_b = 3} \xrightarrow[alle]{beinhaltet} \underbrace{\mbox{Beobachtungen}}_{n_w = 5}</span>
<span id="cb130-78"><a href="#cb130-78" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb130-79"><a href="#cb130-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-80"><a href="#cb130-80" aria-hidden="true" tabindex="-1"></a>Wie du an dem obigen Beispiel sehen kannst, kommen wir bei linearen gemischten Modellen sehr schnell auf sehr große Fallzahlen. Wir haben im obigen, kleinen Beispiel alleine schon eine Fallzahl von $n_{gesamt} = 3 \times 4 \times 3 \times 5 = 180$ Pflanzen. Und damit ist eigentlich unser Beispiel sehr klein gewählt. Eigentlich brauchen wir für einen zufälligen Effekt als Daumenregel immer mehr als fünf Level für eine gute Modellschätzung.</span>
<span id="cb130-81"><a href="#cb130-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-82"><a href="#cb130-82" aria-hidden="true" tabindex="-1"></a>Wie immer ist dieses Kapitel nur ein kleiner Teil von möglichen Orten um etwas über lineare gemischte Modelle zu lernen. In dem folgenden Kasten habe ich dir eine weitreichende Sammlung an Ideen und Tutorien zusammengesucht. Vielleicht findest du ja noch mehr Informationen dort. Für eine Analyse im Rahmen einer Abschlussarbeit sollte das Wissen hier aber reichen.</span>
<span id="cb130-83"><a href="#cb130-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-84"><a href="#cb130-84" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb130-85"><a href="#cb130-85" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Tutorien zu gemischten Modellen</span></span>
<span id="cb130-86"><a href="#cb130-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-87"><a href="#cb130-87" aria-hidden="true" tabindex="-1"></a>Wie immer und natürlich im Besonderen bei linearen gemischten Modellen, gibt es eine Reihe von tollen Hilfen. Daher hier einmal eine lose Sammlung an Ideen und Tutorien, die mir geholfen haben dieses Kapitel hier zu schreiben. Fast jede Quelle hat dann nochmal Referezen zu weiteren Informationen und Hilfen.</span>
<span id="cb130-88"><a href="#cb130-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-89"><a href="#cb130-89" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">GLMM FAQ -- Ben Bolker and others</span><span class="co">](https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#should-i-treat-factor-xxx-as-fixed-or-random)</span> ist meine Anlaufstelle, wenn ich mal was nachlesen muss. Eine sehr hilfreiche und umfangreiche Sammlung.</span>
<span id="cb130-90"><a href="#cb130-90" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Mixed Models with R -- Getting started with random effects</span><span class="co">](https://m-clark.github.io/mixed-models-with-R/)</span> ist ein freies Buch, was ich auch immer mal wieder anschaue, wenn ich Fragen rund um das gemischte Modell habe. Dies ist hier nur ein Kapitel mit einer Zusammenfassung und eben kein ganzes Buch.</span>
<span id="cb130-91"><a href="#cb130-91" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Teile dieses Kapitel basieren auf dem tollen <span class="co">[</span><span class="ot">Tutorium von Gabriela K Hajduk</span><span class="co">](https://ourcodingclub.github.io/tutorials/mixed-models/)</span>. Die früheren Versionen mehr als die aktuelle Version, aber ich finde das Tutorium immer noch toll. Auch hier findest du sehr viel mehr Informationen und dann auch Links zu weiteren Quellen.</span>
<span id="cb130-92"><a href="#cb130-92" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ideen und weitere Erklärungen sind auch beim <span class="co">[</span><span class="ot">Tutorium von Sara Stoudt</span><span class="co">](https://rlbarter.github.io/Practical-Statistics/2017/03/03/fixed-mixed-and-random-effects/)</span> zu finden. Hier musst du dich aber mehr Einarbeiten, da der Artikel etwas mehr mathematisch aufgebaut ist.</span>
<span id="cb130-93"><a href="#cb130-93" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Als weiteres Tutorium für die Auswertung von linearen gemischten Modellen und allgemein dem Modellieren von agarwissenschaftlichen Daten kann ich die Seite <span class="co">[</span><span class="ot">Data Science for Agriculture in R</span><span class="co">](https://schmidtpaul.github.io/dsfair_quarto/)</span> sehr empfehlen. Dort findest du dann auch die Abwendung der R Pakete aus diesem Kapitel. Und natürlich die verwandte Seite <span class="co">[</span><span class="ot">Mixed Models for Agriculture in R</span><span class="co">](https://schmidtpaul.github.io/MMFAIR/)</span> auf der gerade viele Beispiele gesammelt werden. Ein Großteil der Seite aber noch *under construction* (Stand Ende 2023) und teilweise zu detailliert für Abschlussarbeiten.</span>
<span id="cb130-94"><a href="#cb130-94" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Introduction to `{broom.mixed}`</span><span class="co">](https://cran.r-project.org/web/packages/broom.mixed/vignettes/broom_mixed_intro.html)</span> hilft dabei die Ausgaben der verschiedenen R Pakte, die es zu gemischten Modellen gibt zu vereinheitlichen. Wir erhalten dann immer die gleiche <span class="in">`tidy()`</span>-Ausgabe und nicht immer was anderes von den Funktionen wiedergegeben.</span>
<span id="cb130-95"><a href="#cb130-95" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Linear Models and Mixed Models with R</span><span class="co">](https://bodo-winter.net/tutorials.html)</span> sind zwei PDF Dateien von @winter2013linear in denen er nochmal sehr schön erklärt wie lineare gemischte Modelle in R funktionieren.</span>
<span id="cb130-96"><a href="#cb130-96" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das Tutorium <span class="co">[</span><span class="ot">Ordinal regression in R: part 1</span><span class="co">](https://tdunn.ca/posts/2020-03-15-ordinal-regression-in-r-part-1/)</span> liefert nochmal ein lineares gemischtes Modell für ordinale Daten oder eben Bonituren. Dafür dann gerne auch am Ende des Kapitels die beispielhafte Auswertung anschauen.</span>
<span id="cb130-97"><a href="#cb130-97" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-98"><a href="#cb130-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-99"><a href="#cb130-99" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb130-100"><a href="#cb130-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-101"><a href="#cb130-101" aria-hidden="true" tabindex="-1"></a>Normalerweise nutze ich *nur* R Pakete, die auch auf CRAN oder eben per <span class="in">`p_load()`</span> zu installieren sind. In diesem Kapitel brauche ich aber noch ein extra Paket, da die Ausgaben von linearen gemischten Modellen sehr unordentlich sind. Das R Paket <span class="in">`{mixedup}`</span> hilft mir hier. Deshalb installiere ich einmal wie folgt <span class="in">`{mixedup}`</span>.</span>
<span id="cb130-102"><a href="#cb130-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-105"><a href="#cb130-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-106"><a href="#cb130-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb130-107"><a href="#cb130-107" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">'m-clark/mixedup'</span>)</span>
<span id="cb130-108"><a href="#cb130-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-109"><a href="#cb130-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-110"><a href="#cb130-110" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete ganz normal in diesem Kapitel nutzen. Es sind eine Menge geworden, aber das zeigt auch mal wieder, dass gemischte Modelle nicht unbedingt das einfachtse Modell sind.</span>
<span id="cb130-111"><a href="#cb130-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-112"><a href="#cb130-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb130-113"><a href="#cb130-113" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb130-114"><a href="#cb130-114" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb130-115"><a href="#cb130-115" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, broom, see, simstudy,</span></span>
<span id="cb130-116"><a href="#cb130-116" aria-hidden="true" tabindex="-1"></a><span class="in">               multcomp, emmeans, lme4, broom.mixed, readxl,</span></span>
<span id="cb130-117"><a href="#cb130-117" aria-hidden="true" tabindex="-1"></a><span class="in">               parameters, ggridges, scales, performance, </span></span>
<span id="cb130-118"><a href="#cb130-118" aria-hidden="true" tabindex="-1"></a><span class="in">               ggdist, gghalves, glmmTMB, lmerTest, mixedup,</span></span>
<span id="cb130-119"><a href="#cb130-119" aria-hidden="true" tabindex="-1"></a><span class="in">               multilevelmod, agridat, desplot, modelsummary,</span></span>
<span id="cb130-120"><a href="#cb130-120" aria-hidden="true" tabindex="-1"></a><span class="in">               ggbeeswarm, ordinal, janitor, RVAideMemoire, </span></span>
<span id="cb130-121"><a href="#cb130-121" aria-hidden="true" tabindex="-1"></a><span class="in">               conflicted)</span></span>
<span id="cb130-122"><a href="#cb130-122" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb130-123"><a href="#cb130-123" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb130-124"><a href="#cb130-124" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(lme4::lmer)</span></span>
<span id="cb130-125"><a href="#cb130-125" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb130-126"><a href="#cb130-126" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb130-127"><a href="#cb130-127" aria-hidden="true" tabindex="-1"></a><span class="in">theme_set(theme_minimal(base_size = 12))</span></span>
<span id="cb130-128"><a href="#cb130-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-129"><a href="#cb130-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-130"><a href="#cb130-130" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb130-131"><a href="#cb130-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-132"><a href="#cb130-132" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb130-133"><a href="#cb130-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-134"><a href="#cb130-134" aria-hidden="true" tabindex="-1"></a>Als erstes Beispiel nehmen wir einen Datensatz zu den Testergebnissen von Schülern an amerikanischen Schulen. Jetzt ist das kein Beispiel, welches du vielleicht in einem biologischen oder agrarwissenschaftlichen Umfeld erwarten würdest. Ich mache das aber hier bewusst, da wir uns alle sehr gut die Abhängigkeiten von Schülerleistungen von der jeweiligen Klasse und dem Standort der Schule vorstellen können. Jedem wird klar sein, dass ein Testergebnis aus einer Klausur *nicht* unabhängig davon ist, auf welche Schule der Schüler geht oder in welcher Klasse er unterrichtet wird. Schüler in einer gemeinsamen Klasse oder Schule werden sich ähnlicher sein als Schüler in unterschiedlichen Klassen oder Schulen.</span>
<span id="cb130-135"><a href="#cb130-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-136"><a href="#cb130-136" aria-hidden="true" tabindex="-1"></a>In der @fig-mermaid-r-mixed-school siehst du einmal das Abhängigkeitsverhältnis in unserem Schuldatenbeispiel. Wir wenden in den verschiedenen Klassen als Behandlung <span class="in">`trt`</span> eines von drei Lehrmethoden *Frontal*, *Flipped Classroom* oder *HyperFlex* an. Dabei wird natürlich eine ganze Klasse nach der entsprechenden Lehrmethode unterrichtet. Pro Schule finden sich drei Klassen und eine Klasse ist dann in einer der neun Schulen genestet.</span>
<span id="cb130-137"><a href="#cb130-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-140"><a href="#cb130-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb130-141"><a href="#cb130-141" aria-hidden="true" tabindex="-1"></a><span class="in">%%| label: fig-mermaid-r-mixed-school</span></span>
<span id="cb130-142"><a href="#cb130-142" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-width: 6</span></span>
<span id="cb130-143"><a href="#cb130-143" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-cap: "In unseren Schuldaten haben wir verschiedene Schulen `school` und Klassen `class` mit zwei innovativen Lehrmethoden unterrichtet. Eine Kontrollgruppe soll die Ergebnisse eines Leistungstests absichern. Daher sind die Lehrmethoden `trt` in dem Faktor `class` genestet. Der Faktor `class` ist dann wiederum in jedem Faktor `school` genestet."</span></span>
<span id="cb130-144"><a href="#cb130-144" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart LR</span></span>
<span id="cb130-145"><a href="#cb130-145" aria-hidden="true" tabindex="-1"></a><span class="in">    C(trt):::fixed --- D(((nested))) --&gt; E(class):::random --- F(((nested))) --&gt; G(school):::random</span></span>
<span id="cb130-146"><a href="#cb130-146" aria-hidden="true" tabindex="-1"></a><span class="in">    classDef fixed fill:#56B4E9,stroke:#333,stroke-width:0.75px</span></span>
<span id="cb130-147"><a href="#cb130-147" aria-hidden="true" tabindex="-1"></a><span class="in">    classDef random fill:#E69F00,stroke:#333,stroke-width:0.75px</span></span>
<span id="cb130-148"><a href="#cb130-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-149"><a href="#cb130-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-150"><a href="#cb130-150" aria-hidden="true" tabindex="-1"></a>In dem folgenden Kasten werden einmal die Schuldaten simuliert. Daher können wir dann einmal nachvollziehen, welche Werte wir jeweils für die Effekte der Schule, der Klasse und der Lehrform gesetzt haben. Wir sehen dann auch mal, welche zufälligen Effekte wir eigentlich setzen müssen und wie wir dann die Modelle miteinander vergleichen. Du kannst den Kasten gerne überspringen und dann einfach mit der Visualisierung und Auswertung der Daten weitermachen.</span>
<span id="cb130-151"><a href="#cb130-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-152"><a href="#cb130-152" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution collapse="true"}</span>
<span id="cb130-153"><a href="#cb130-153" aria-hidden="true" tabindex="-1"></a><span class="fu">## Generierung von Schuldaten (3-faktoriell)</span></span>
<span id="cb130-154"><a href="#cb130-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-155"><a href="#cb130-155" aria-hidden="true" tabindex="-1"></a>Warum sollte man Daten simulieren? Reichen da nicht echte Daten? Wir können an den simulierten Daten die Werte zurückverfolgen, wir wir bei der Erstellung voreingestellt haben. Damit können wir dann auch bewerten, wie gut die statistischen Methoden funktioniert haben. Wir machen es uns aber auch etwas einfacher und bauen uns kein kompliziertes Beispiel. Umfangreich ist es nur, da Daten für ein gemischtes Modell eben auch umfangreich *sind*.</span>
<span id="cb130-156"><a href="#cb130-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-157"><a href="#cb130-157" aria-hidden="true" tabindex="-1"></a>Aus Gründen der Einfachheit haben wir immer ein balanciertes Design vorliegen. Wir haben also immer in allen Faktorkombinationen die gleiche Anzahl an Beobachtungen <span class="in">`n_reps`</span> vorliegen. In der Anwendung mag es Unterschiede geben, so hat eine Sau sicherlich nicht immer exakt zwölf Ferkel, aber in unseren Beispielen macht es keinen Unterschied. Balanciert oder unbalanciert ist bei gemischten Modellen eher nachrangig wichtig. Das <span class="co">[</span><span class="ot">R Paket `{simstudy}`</span><span class="co">](https://kgoldfeld.github.io/simstudy/articles/clustered.html)</span> erlaubt die Simulation von komplexeren Gruppenstrukturen mit auch unbalancierten Daten. Am Ende wäre es dann mit <span class="in">`{simstudy}`</span> vermutlich einfacher gewesen... hier können wir dann auch unterschiedlich Klassengrößen und Anzahlen simulieren.</span>
<span id="cb130-158"><a href="#cb130-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-159"><a href="#cb130-159" aria-hidden="true" tabindex="-1"></a>Im Folgenden setze ich einmal Werte für die Schulanzahl, Klassenzahl pro Schule sowie die Anzahl an Behandlungen. Dann müssen wir noch definieren wie viele Schüler dann pro Klasse zu finden sind. Wenn wir das haben, dann können wir auch die Effekte der Klassen, Schulen und der Lehrformate festlegen. Dabei sind die Effekt der zufälligen Effekte der Klassen und Schule dann die zusätzliche Varianz abgebildet durch die Standardabweichungen.</span>
<span id="cb130-160"><a href="#cb130-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-163"><a href="#cb130-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-164"><a href="#cb130-164" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(spatstat.random)</span>
<span id="cb130-165"><a href="#cb130-165" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb130-166"><a href="#cb130-166" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231208</span>)</span>
<span id="cb130-167"><a href="#cb130-167" aria-hidden="true" tabindex="-1"></a><span class="co"># sample sizes</span></span>
<span id="cb130-168"><a href="#cb130-168" aria-hidden="true" tabindex="-1"></a>n_school <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb130-169"><a href="#cb130-169" aria-hidden="true" tabindex="-1"></a>n_class_per_school <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb130-170"><a href="#cb130-170" aria-hidden="true" tabindex="-1"></a>n_class <span class="ot">&lt;-</span> n_school <span class="sc">*</span> n_class_per_school</span>
<span id="cb130-171"><a href="#cb130-171" aria-hidden="true" tabindex="-1"></a>n_trt <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb130-172"><a href="#cb130-172" aria-hidden="true" tabindex="-1"></a>n_reps <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb130-173"><a href="#cb130-173" aria-hidden="true" tabindex="-1"></a><span class="co"># effects and standard deviation</span></span>
<span id="cb130-174"><a href="#cb130-174" aria-hidden="true" tabindex="-1"></a>sd_school <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb130-175"><a href="#cb130-175" aria-hidden="true" tabindex="-1"></a>sd_class <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb130-176"><a href="#cb130-176" aria-hidden="true" tabindex="-1"></a>sd_error <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb130-177"><a href="#cb130-177" aria-hidden="true" tabindex="-1"></a>eff_trt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">frontal =</span> <span class="dv">10</span>,</span>
<span id="cb130-178"><a href="#cb130-178" aria-hidden="true" tabindex="-1"></a>             <span class="at">flipped =</span> <span class="sc">-</span><span class="dv">10</span>,</span>
<span id="cb130-179"><a href="#cb130-179" aria-hidden="true" tabindex="-1"></a>             <span class="at">hyflex =</span> <span class="dv">30</span>)</span>
<span id="cb130-180"><a href="#cb130-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-181"><a href="#cb130-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-182"><a href="#cb130-182" aria-hidden="true" tabindex="-1"></a>Dann können wir uns schon das Grid für die Daten erstellen. Dabei müssen wir dann mehrfach <span class="in">`expand_grid()`</span> nutzen um erst die Schulen zu erschaffen, dann die Lehrformate den Schulen zuordnen und dann die Klassen pro Schule erschaffen. Ende müssen wir noch den Datensatz mit der Anzahl an Schülern pro Klasse erweitern. Dann beschreibt jede Zeile genau einen Schüler. Neben der Zuordnung jedes einzelnen Schülern zu einem Lehrformat, Klasse und Schule, müssen wir noch die Effekte $s_0$, $c_0$ und $t_{eff}$, die jeder Schüler durch eben jene Zuordnung erhält, ergänzen.</span>
<span id="cb130-183"><a href="#cb130-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-186"><a href="#cb130-186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-187"><a href="#cb130-187" aria-hidden="true" tabindex="-1"></a>school_grid_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">s_id =</span> <span class="dv">1</span><span class="sc">:</span>n_school,</span>
<span id="cb130-188"><a href="#cb130-188" aria-hidden="true" tabindex="-1"></a>                          <span class="at">s_0 =</span> <span class="fu">rnorm</span>(n_school, <span class="dv">0</span>, sd_school)) <span class="sc">|&gt;</span> </span>
<span id="cb130-189"><a href="#cb130-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">trt =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_trt, n_trt),</span>
<span id="cb130-190"><a href="#cb130-190" aria-hidden="true" tabindex="-1"></a>             <span class="at">t_eff =</span> <span class="fu">rep</span>(eff_trt, n_trt)) <span class="sc">|&gt;</span> </span>
<span id="cb130-191"><a href="#cb130-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">c_per_s =</span> <span class="dv">1</span><span class="sc">:</span>n_class_per_school) <span class="sc">|&gt;</span></span>
<span id="cb130-192"><a href="#cb130-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c_id =</span> <span class="dv">1</span><span class="sc">:</span>n_class,</span>
<span id="cb130-193"><a href="#cb130-193" aria-hidden="true" tabindex="-1"></a>         <span class="at">c_0 =</span> <span class="fu">rnorm</span>(n_class, <span class="dv">0</span>, sd_class)) <span class="sc">|&gt;</span> </span>
<span id="cb130-194"><a href="#cb130-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">reps =</span> <span class="dv">1</span><span class="sc">:</span>n_reps)</span>
<span id="cb130-195"><a href="#cb130-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-196"><a href="#cb130-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-197"><a href="#cb130-197" aria-hidden="true" tabindex="-1"></a>Jetzt können wir unseren Testscore berechnen, der sich aus den einzelnen Effekten der Schule $s_0$, der Klasse $c_0$ sowie dem Lehrformat $t_{eff}$ ergibt, berechnen. Am Ende addieren wir auf jeden Wert noch einen Fehler und runden die Werte des Tests auf zwei Stellen. Dann bauen wir uns noch die Faktorlevel für die Schulen, Klassen und dem Lehrformat.</span>
<span id="cb130-198"><a href="#cb130-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-201"><a href="#cb130-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-202"><a href="#cb130-202" aria-hidden="true" tabindex="-1"></a>school_tbl <span class="ot">&lt;-</span> school_grid_tbl <span class="sc">|&gt;</span> </span>
<span id="cb130-203"><a href="#cb130-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(trt) <span class="sc">|&gt;</span> </span>
<span id="cb130-204"><a href="#cb130-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">test =</span> <span class="fu">round</span>(<span class="dv">50</span> <span class="sc">+</span> s_0 <span class="sc">+</span> c_0 <span class="sc">+</span> t_eff <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="dv">0</span>, sd_error), <span class="dv">2</span>),</span>
<span id="cb130-205"><a href="#cb130-205" aria-hidden="true" tabindex="-1"></a>         <span class="at">s_id =</span> <span class="fu">factor</span>(s_id, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Springfield School"</span>, <span class="st">"Jacksonville High"</span>, <span class="st">"Franklin Country"</span>, </span>
<span id="cb130-206"><a href="#cb130-206" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Clinton Christian"</span>, <span class="st">"Arlington Academy"</span>, <span class="st">"Georgetown High"</span>, </span>
<span id="cb130-207"><a href="#cb130-207" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"Greenville School"</span>, <span class="st">"Bristol Country"</span>, <span class="st">"Dover Tech Center"</span>)),</span>
<span id="cb130-208"><a href="#cb130-208" aria-hidden="true" tabindex="-1"></a>         <span class="at">c_id =</span> <span class="fu">as_factor</span>(c_id),</span>
<span id="cb130-209"><a href="#cb130-209" aria-hidden="true" tabindex="-1"></a>         <span class="at">c_per_s =</span> <span class="fu">factor</span>(c_per_s, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1a"</span>, <span class="st">"1b"</span>, <span class="st">"1c"</span>)),</span>
<span id="cb130-210"><a href="#cb130-210" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt =</span> <span class="fu">factor</span>(trt, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Frontal"</span>, <span class="st">"Flipped classroom"</span>, <span class="st">"HyFlex"</span>))) </span>
<span id="cb130-211"><a href="#cb130-211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-212"><a href="#cb130-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-213"><a href="#cb130-213" aria-hidden="true" tabindex="-1"></a>Dann schreiben wir die Daten noch in eine Exceldatei <span class="in">`school_testing.xlsx`</span> und können diese dann im weiteren Verlauf der Analyse nutzen. Auch hier passen wir etwas die Namen der Spalten an, damit die Spalten etwas mehr Aussagekraft haben.</span>
<span id="cb130-214"><a href="#cb130-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-217"><a href="#cb130-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-218"><a href="#cb130-218" aria-hidden="true" tabindex="-1"></a>school_tbl <span class="sc">|&gt;</span> </span>
<span id="cb130-219"><a href="#cb130-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">school_id =</span> s_id, <span class="at">class_in_school_id =</span> c_per_s, <span class="at">class_id =</span> c_id, trt, test) <span class="sc">|&gt;</span> </span>
<span id="cb130-220"><a href="#cb130-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_xlsx</span>(<span class="st">"data/school_testing.xlsx"</span>)</span>
<span id="cb130-221"><a href="#cb130-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-222"><a href="#cb130-222" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-223"><a href="#cb130-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-224"><a href="#cb130-224" aria-hidden="true" tabindex="-1"></a>Die Schuldaten liegen dann in dem Datensatz <span class="in">`school_testing.xlsx`</span> vor. Wir müssen hier dann nur noch die Faktoren bilden, damit wir dann auch die Visualisierungen sauber hinkriegen.</span>
<span id="cb130-225"><a href="#cb130-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-228"><a href="#cb130-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-229"><a href="#cb130-229" aria-hidden="true" tabindex="-1"></a>school_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/school_testing.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb130-230"><a href="#cb130-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">school_id =</span> <span class="fu">as_factor</span>(school_id),</span>
<span id="cb130-231"><a href="#cb130-231" aria-hidden="true" tabindex="-1"></a>         <span class="at">class_in_school_id =</span> <span class="fu">as_factor</span>(class_in_school_id),</span>
<span id="cb130-232"><a href="#cb130-232" aria-hidden="true" tabindex="-1"></a>         <span class="at">class_id =</span> <span class="fu">as_factor</span>(class_id),</span>
<span id="cb130-233"><a href="#cb130-233" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt =</span> <span class="fu">as_factor</span>(trt)) </span>
<span id="cb130-234"><a href="#cb130-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-235"><a href="#cb130-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-236"><a href="#cb130-236" aria-hidden="true" tabindex="-1"></a>Es ergibt sich dann der Datensatz der Schuldaten wie in @tbl-school gekürzt gezeigt.</span>
<span id="cb130-237"><a href="#cb130-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-240"><a href="#cb130-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-241"><a href="#cb130-241" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb130-242"><a href="#cb130-242" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-243"><a href="#cb130-243" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-244"><a href="#cb130-244" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-school</span></span>
<span id="cb130-245"><a href="#cb130-245" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Datensatz der Testscores für die Schüler an verschiedenen Schulen und Klassen. Die Schüler wurden in den Klassen jewiels mit einem von drei Lehrformaten unterrichtet. Die Klassen und Schulen sind die zufälligen Effekte. Das Lehrformat ist der feste Effekt."</span></span>
<span id="cb130-246"><a href="#cb130-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-247"><a href="#cb130-247" aria-hidden="true" tabindex="-1"></a>school_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/school_testing.xlsx"</span>) </span>
<span id="cb130-248"><a href="#cb130-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-249"><a href="#cb130-249" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(school_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>),</span>
<span id="cb130-250"><a href="#cb130-250" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(school_raw_tbl)),</span>
<span id="cb130-251"><a href="#cb130-251" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(school_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb130-252"><a href="#cb130-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb130-253"><a href="#cb130-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-254"><a href="#cb130-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-255"><a href="#cb130-255" aria-hidden="true" tabindex="-1"></a>In der @tbl-mixed-simple-2fac im folgenden Kasten findest du den *einfachst möglichen* Datensatz für nur zwei Schülern pro Klasse sowie insgesamt nur zwei Klassen für zwei Schulen. Damit kannst du dir einmal denn Aufbau visualisieren und siehst auch einmal wie sich die Effekte der Klassen, Schule und Lehrformat für jeden der sechzehn Schüler zusammensetzt. Jede Zeile repräsentiert ja einen Schüler.</span>
<span id="cb130-256"><a href="#cb130-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-257"><a href="#cb130-257" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb130-258"><a href="#cb130-258" aria-hidden="true" tabindex="-1"></a><span class="fu">## Einfachst möglicher Schuldatensatz (3-faktoriell)</span></span>
<span id="cb130-259"><a href="#cb130-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-260"><a href="#cb130-260" aria-hidden="true" tabindex="-1"></a>| school | $\boldsymbol{eff_{school}}$ | class | $\boldsymbol{eff_{class}}$ | trt | $\boldsymbol{eff_{trt}}$ | reps |</span>
<span id="cb130-261"><a href="#cb130-261" aria-hidden="true" tabindex="-1"></a>|:--:|:--:|:--:|:--:|:--:|:--:|:--:|</span>
<span id="cb130-262"><a href="#cb130-262" aria-hidden="true" tabindex="-1"></a>| 1 | $0.23$ | 1 | $-0.14$ | 1 | $10$ | 1 |</span>
<span id="cb130-263"><a href="#cb130-263" aria-hidden="true" tabindex="-1"></a>| 1 | $0.23$ | 1 | $-0.14$ | 1 | $10$ | 2 |</span>
<span id="cb130-264"><a href="#cb130-264" aria-hidden="true" tabindex="-1"></a>| 1 | $0.23$ | 1 | $-0.14$ | 2 | $5$ | 1 |</span>
<span id="cb130-265"><a href="#cb130-265" aria-hidden="true" tabindex="-1"></a>| 1 | $0.23$ | 1 | $-0.14$ | 2 | $5$ | 2 |</span>
<span id="cb130-266"><a href="#cb130-266" aria-hidden="true" tabindex="-1"></a>| 1 | $0.23$ | 2 | $0.21$ | 1 | $10$ | 1 |</span>
<span id="cb130-267"><a href="#cb130-267" aria-hidden="true" tabindex="-1"></a>| 1 | $0.23$ | 2 | $0.21$ | 1 | $10$ | 2 |</span>
<span id="cb130-268"><a href="#cb130-268" aria-hidden="true" tabindex="-1"></a>| 1 | $0.23$ | 2 | $0.21$ | 2 | $5$ | 1 |</span>
<span id="cb130-269"><a href="#cb130-269" aria-hidden="true" tabindex="-1"></a>| 1 | $0.23$ | 2 | $0.21$ | 2 | $5$ | 2 |</span>
<span id="cb130-270"><a href="#cb130-270" aria-hidden="true" tabindex="-1"></a>| 2 | $0.71$ | 3 | $-0.83$ | 1 | $10$ | 1 |</span>
<span id="cb130-271"><a href="#cb130-271" aria-hidden="true" tabindex="-1"></a>| 2 | $0.71$ | 3 | $-0.83$ | 1 | $10$ | 2 |</span>
<span id="cb130-272"><a href="#cb130-272" aria-hidden="true" tabindex="-1"></a>| 2 | $0.71$ | 3 | $-0.83$ | 2 | $5$ | 1 |</span>
<span id="cb130-273"><a href="#cb130-273" aria-hidden="true" tabindex="-1"></a>| 2 | $0.71$ | 3 | $-0.83$ | 2 | $5$ | 2 |</span>
<span id="cb130-274"><a href="#cb130-274" aria-hidden="true" tabindex="-1"></a>| 2 | $0.71$ | 4 | $0.59$ | 1 | $10$ | 1 |</span>
<span id="cb130-275"><a href="#cb130-275" aria-hidden="true" tabindex="-1"></a>| 2 | $0.71$ | 4 | $0.59$ | 1 | $10$ | 2 |</span>
<span id="cb130-276"><a href="#cb130-276" aria-hidden="true" tabindex="-1"></a>| 2 | $0.71$ | 4 | $0.59$ | 2 | $5$ | 1 |</span>
<span id="cb130-277"><a href="#cb130-277" aria-hidden="true" tabindex="-1"></a>| 2 | $0.71$ | 4 | $0.59$ | 2 | $5$ | 2 |</span>
<span id="cb130-278"><a href="#cb130-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-279"><a href="#cb130-279" aria-hidden="true" tabindex="-1"></a>: Kurzform eines dreifaktoriellen Datensatzes mit zwei zufälligen Effekten für <span class="in">`school`</span> und <span class="in">`class`</span> sowie einem Bahandlungsfaktor <span class="in">`trt`</span>. Die zufälligen Effekte sind normalverteilt mit $\mathcal{N}(0, s^2)$. Pro Behandlung haben wir dann nur zwei Wiederholungen. Dennoch erreichen wir eine Fallzahl von sechzehn Beobachtungen daher Schülern. {#tbl-mixed-simple-2fac}</span>
<span id="cb130-280"><a href="#cb130-280" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-281"><a href="#cb130-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-282"><a href="#cb130-282" aria-hidden="true" tabindex="-1"></a>Dann einmal den Datenklassiker <span class="in">`yates.oats`</span> schlechthin als *das* <span class="co">[</span><span class="ot">Split-plot experiment of oats</span><span class="co">](https://kwstat.github.io/agridat/reference/yates.oats.html)</span> aus dem R Paket <span class="in">`{agridat}`</span>. Warum ist es der Klassiker? Weil es im Prinzip das erste Split plot Experiment war. Deshalb ist es nicht schlechter als andere. Ich nutze es hier, weil es gut funktioniert und wir uns einmal eine Auswertung eines komplexeren Datensatzes mit einem linearen gemischten Modell anschauen können. Wir haben insgesamt die mittleren Ertragswerte von Hafer für 72 Parzellen vorliegen. Im weiteren haben wir zwei Behandlungsfaktoren mit der Stickstoffgabe <span class="in">`nitro`</span> und der Sorte <span class="in">`gen`</span>. Da wir ein Split plot Experiment vorliegen haben, brauchen wir natürlich die Reihen- und Spaltenpositionen sowie die Information über den Block. Alle drei Positionsfaktoren werden wir dann versuchen als zufällige Effekte in das gemischte Modell zu nehmen. In der @fig-mermaid-oats siehst du einmal das Abhängigkeitsverhältnis in den Daten.</span>
<span id="cb130-283"><a href="#cb130-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-286"><a href="#cb130-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb130-287"><a href="#cb130-287" aria-hidden="true" tabindex="-1"></a><span class="in">%%| label: fig-mermaid-oats</span></span>
<span id="cb130-288"><a href="#cb130-288" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-width: 6</span></span>
<span id="cb130-289"><a href="#cb130-289" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-cap: "Abhängigkeitsstruktur des *split plot design*. Der Faktor `gen` ist in den Spalten `cols/rows` der Blöcke randomisiert und der zweite Faktor `nitro` innerhalb des anderen Faktors."</span></span>
<span id="cb130-290"><a href="#cb130-290" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart LR</span></span>
<span id="cb130-291"><a href="#cb130-291" aria-hidden="true" tabindex="-1"></a><span class="in">    A(nitro):::fixed --- B(((nestet))) --&gt; C(gen):::fixed --- D(((nestet))) --&gt; E(cols/rows) --- F(block):::random</span></span>
<span id="cb130-292"><a href="#cb130-292" aria-hidden="true" tabindex="-1"></a><span class="in">    classDef fixed fill:#56B4E9,stroke:#333,stroke-width:0.75px</span></span>
<span id="cb130-293"><a href="#cb130-293" aria-hidden="true" tabindex="-1"></a><span class="in">    classDef random fill:#E69F00,stroke:#333,stroke-width:0.75px</span></span>
<span id="cb130-294"><a href="#cb130-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-295"><a href="#cb130-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-296"><a href="#cb130-296" aria-hidden="true" tabindex="-1"></a>Ich erweitere noch den Datensatz um die einzelnen Pflanzenwerte indem ich für jeden <span class="in">`yield`</span>-Wert als Mittelwert noch zwölf Pflanzen für die Parzelle simuliere. Damit baue ich die Daten sozusagen wieder zurück und komme auf meine individuellen Werte für jede der 72 Parzellen.</span>
<span id="cb130-297"><a href="#cb130-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-300"><a href="#cb130-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-301"><a href="#cb130-301" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(yates.oats)</span>
<span id="cb130-302"><a href="#cb130-302" aria-hidden="true" tabindex="-1"></a>oats_tbl <span class="ot">&lt;-</span> yates.oats <span class="sc">|&gt;</span> </span>
<span id="cb130-303"><a href="#cb130-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-304"><a href="#cb130-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nitro =</span> <span class="fu">as_factor</span>(nitro),</span>
<span id="cb130-305"><a href="#cb130-305" aria-hidden="true" tabindex="-1"></a>         <span class="at">row =</span> <span class="fu">as_factor</span>(row),</span>
<span id="cb130-306"><a href="#cb130-306" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">as_factor</span>(col)) <span class="sc">|&gt;</span> </span>
<span id="cb130-307"><a href="#cb130-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">plant_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">|&gt;</span> </span>
<span id="cb130-308"><a href="#cb130-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">plant_yield =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="fu">n</span>(), yield, <span class="dv">2</span>), <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb130-309"><a href="#cb130-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(row, col, block, nitro, gen, plant_id, plant_yield)</span>
<span id="cb130-310"><a href="#cb130-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-311"><a href="#cb130-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-312"><a href="#cb130-312" aria-hidden="true" tabindex="-1"></a>In der @tbl-yates siehst du nochmal einen Ausschnitt aus den Daten. Wir fokussieren uns hier auf das Outcome <span class="in">`yield`</span> was wir als normalverteilt annehmen. Die anderen möglichen Outcomes ignorieren wir dann erstmal. Wir brauchen dann auch die Informationen für die Position auf dem Feld <span class="in">`row`</span> und <span class="in">`col`</span> um dann einen gute Abbildung des Designs über das R Paket <span class="in">`{desplot}`</span> zu erstellen.</span>
<span id="cb130-313"><a href="#cb130-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-316"><a href="#cb130-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-317"><a href="#cb130-317" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb130-318"><a href="#cb130-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-319"><a href="#cb130-319" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-320"><a href="#cb130-320" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-yates</span></span>
<span id="cb130-321"><a href="#cb130-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Haferdatensatz im Split plot Design für zwei Behandlungsfaktoren `nitro` und `gen` sowie drei Positionsfaktoren `row`, `col` und `block`. Wir schauen uns hier nur das Outcome Haferertrag `yield` an."</span></span>
<span id="cb130-322"><a href="#cb130-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-323"><a href="#cb130-323" aria-hidden="true" tabindex="-1"></a>yates_raw_tbl <span class="ot">&lt;-</span> oats_tbl <span class="sc">|&gt;</span> </span>
<span id="cb130-324"><a href="#cb130-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gen =</span> <span class="fu">as.character</span>(gen),</span>
<span id="cb130-325"><a href="#cb130-325" aria-hidden="true" tabindex="-1"></a>         <span class="at">block =</span> <span class="fu">as.character</span>(block),</span>
<span id="cb130-326"><a href="#cb130-326" aria-hidden="true" tabindex="-1"></a>         <span class="at">nitro =</span> <span class="fu">as.character</span>(nitro),</span>
<span id="cb130-327"><a href="#cb130-327" aria-hidden="true" tabindex="-1"></a>         <span class="at">row =</span> <span class="fu">as.character</span>(row),</span>
<span id="cb130-328"><a href="#cb130-328" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">as.character</span>(col)) <span class="sc">|&gt;</span> </span>
<span id="cb130-329"><a href="#cb130-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb130-330"><a href="#cb130-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-331"><a href="#cb130-331" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(yates_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>),</span>
<span id="cb130-332"><a href="#cb130-332" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(yates_raw_tbl)),</span>
<span id="cb130-333"><a href="#cb130-333" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(yates_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb130-334"><a href="#cb130-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb130-335"><a href="#cb130-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-336"><a href="#cb130-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-337"><a href="#cb130-337" aria-hidden="true" tabindex="-1"></a>Neben einem normalverteilten Outcome wollen wir uns danna auch noch eine andere häufige Art von einem Outcome anschauen. Wir betrachten nämlich noch Zähldaten oder Abundanz von Arten. Wir nutzen hier auch einen Datensatz aus dem R Paket <span class="in">`{agridat}`</span> und zwar den Datensatz zu <span class="co">[</span><span class="ot">Wireworms controlled by fumigants in a latin square</span><span class="co">](https://kwstat.github.io/agridat/reference/cochran.wireworms.html)</span>. Es geht hier also um die Verwendung von fünf Insektiziden in einem Feld mit $5 \times 5$ großen Parzellen. In jedem der Parzellen haben wir dann die Würmer an zehn Punkten gezählt. Die zehn Zählpunkte habe ich mir ausgedacht, aber dann aber wir später ein paar mehr Beobachtungen zum darstellen. Wie du siehst, haben wir hier ein *latin square design* vorliegen, welches ich dir nochmal in der @fig-mermaid-worms dargestellt habe.</span>
<span id="cb130-338"><a href="#cb130-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-341"><a href="#cb130-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb130-342"><a href="#cb130-342" aria-hidden="true" tabindex="-1"></a><span class="in">%%| label: fig-mermaid-worms</span></span>
<span id="cb130-343"><a href="#cb130-343" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-width: 6</span></span>
<span id="cb130-344"><a href="#cb130-344" aria-hidden="true" tabindex="-1"></a><span class="in">%%| fig-cap: "Schematische Darstellung der Abhängigkeitsstruktur im latin suare design für unsere Wurmdaten. Die Behandlungen werden in `rows` und `cols` genestet, die einem quadratischen Block mit den Längen der Anzahl der Level der Behandlungen entsprechen."</span></span>
<span id="cb130-345"><a href="#cb130-345" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart LR</span></span>
<span id="cb130-346"><a href="#cb130-346" aria-hidden="true" tabindex="-1"></a><span class="in">    A(trt):::fixed --- B(((nested))) --&gt; C(rows):::random</span></span>
<span id="cb130-347"><a href="#cb130-347" aria-hidden="true" tabindex="-1"></a><span class="in">    B(((nested))) --&gt; D(cols):::random</span></span>
<span id="cb130-348"><a href="#cb130-348" aria-hidden="true" tabindex="-1"></a><span class="in">    C --- F(block)</span></span>
<span id="cb130-349"><a href="#cb130-349" aria-hidden="true" tabindex="-1"></a><span class="in">    D --- F</span></span>
<span id="cb130-350"><a href="#cb130-350" aria-hidden="true" tabindex="-1"></a><span class="in">    classDef fixed fill:#56B4E9,stroke:#333,stroke-width:0.75px</span></span>
<span id="cb130-351"><a href="#cb130-351" aria-hidden="true" tabindex="-1"></a><span class="in">    classDef random fill:#E69F00,stroke:#333,stroke-width:0.75px</span></span>
<span id="cb130-352"><a href="#cb130-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-353"><a href="#cb130-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-354"><a href="#cb130-354" aria-hidden="true" tabindex="-1"></a>Im Folgenden habe ich einmal die Daten geladen und die Mittelwerte der Parzellen <span class="in">`worms`</span> wieder auf die ursprünglichen, ausgedachten zehn Zählpunkte erweitert. Auch hier müssen wir dann unsere Daten wieder entsprechend mit Faktoren versehen, damit wir die Daten dann richtig im R Paket <span class="in">`{desplot}`</span> abbilden können.</span>
<span id="cb130-355"><a href="#cb130-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-358"><a href="#cb130-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-359"><a href="#cb130-359" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cochran.wireworms)</span>
<span id="cb130-360"><a href="#cb130-360" aria-hidden="true" tabindex="-1"></a>wireworms_tbl <span class="ot">&lt;-</span> cochran.wireworms <span class="sc">|&gt;</span> </span>
<span id="cb130-361"><a href="#cb130-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-362"><a href="#cb130-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt),</span>
<span id="cb130-363"><a href="#cb130-363" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">as_factor</span>(col),</span>
<span id="cb130-364"><a href="#cb130-364" aria-hidden="true" tabindex="-1"></a>         <span class="at">row =</span> <span class="fu">as_factor</span>(row)) <span class="sc">|&gt;</span> </span>
<span id="cb130-365"><a href="#cb130-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_grid</span>(<span class="at">site_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb130-366"><a href="#cb130-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count_worms =</span> <span class="fu">rpois</span>(<span class="fu">n</span>(), worms))</span>
<span id="cb130-367"><a href="#cb130-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-368"><a href="#cb130-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-369"><a href="#cb130-369" aria-hidden="true" tabindex="-1"></a>Du erhälst dann folgenden Auszug in der @tbl-worms von den Wurmdaten. Hier sind dann die Namen der Behandlungen etwas kurz, aber wir belassen es mal bei den Namen. Du kannst dir hier eben fünf Insektizide vorstellen, die wir dann miteinander vergleichen würden. Zu den Gruppenvergleichen findest du dann ganz am Ende des Kapitels nochmal einen eignene Abschnitt sowie dann auch zwei Anwendungsbeispiele.</span>
<span id="cb130-370"><a href="#cb130-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-373"><a href="#cb130-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-374"><a href="#cb130-374" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb130-375"><a href="#cb130-375" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-376"><a href="#cb130-376" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-377"><a href="#cb130-377" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-worms</span></span>
<span id="cb130-378"><a href="#cb130-378" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Auszug aus den Wurmdaten in einem *latin square design* für fünf verschiedene Insektizide."</span></span>
<span id="cb130-379"><a href="#cb130-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-380"><a href="#cb130-380" aria-hidden="true" tabindex="-1"></a>worm_raw_tbl <span class="ot">&lt;-</span> wireworms_tbl <span class="sc">|&gt;</span> </span>
<span id="cb130-381"><a href="#cb130-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as.character</span>(trt),</span>
<span id="cb130-382"><a href="#cb130-382" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">as.character</span>(col),</span>
<span id="cb130-383"><a href="#cb130-383" aria-hidden="true" tabindex="-1"></a>         <span class="at">row =</span> <span class="fu">as.character</span>(row)) <span class="sc">|&gt;</span> </span>
<span id="cb130-384"><a href="#cb130-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb130-385"><a href="#cb130-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-386"><a href="#cb130-386" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(worm_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>),</span>
<span id="cb130-387"><a href="#cb130-387" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(worm_raw_tbl)),</span>
<span id="cb130-388"><a href="#cb130-388" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(worm_raw_tbl, <span class="at">n =</span> <span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb130-389"><a href="#cb130-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb130-390"><a href="#cb130-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-391"><a href="#cb130-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-392"><a href="#cb130-392" aria-hidden="true" tabindex="-1"></a>In der folgenden Box findest du noch mehr Daten und experimentelle Designs aus dem <span class="co">[</span><span class="ot">R Paket `{agridat}`</span><span class="co">](https://kwstat.github.io/agridat/reference/index.html)</span>. Dort findest du dann noch mehr Inspirationen wie Daten aussehen könnten, die mit einem linearen gemischten Modell ausgewertet werden. Nicht alle der dortigen Daten können nur mit einem gemischten Modell ausgewertet werden, es gibt auch eine Reihe an einfacheren Datensätzen. Ich habe hier jetzt zwei der über hundert Datensätze ausgewählt, die ich relativ repräsentativ finde.</span>
<span id="cb130-393"><a href="#cb130-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-394"><a href="#cb130-394" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb130-395"><a href="#cb130-395" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Daten zu gemischten Modellen</span></span>
<span id="cb130-396"><a href="#cb130-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-397"><a href="#cb130-397" aria-hidden="true" tabindex="-1"></a>Alle Daten hier stammen aus dem <span class="co">[</span><span class="ot">R Paket `{agridat}`</span><span class="co">](https://kwstat.github.io/agridat/reference/index.html)</span> und lassen sich somit mit der Funktion <span class="in">`data()`</span> laden. Die Daten liegen meistens nicht als <span class="in">`tibble()`</span> vor, so dass manchmal noch etwas Datenaufbereitung notwendig ist.</span>
<span id="cb130-398"><a href="#cb130-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-399"><a href="#cb130-399" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Mating crosses of chickens</span><span class="co">](https://kwstat.github.io/agridat/reference/becker.chicken.html)</span></span>
<span id="cb130-400"><a href="#cb130-400" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Latin square of four breeds of sheep with four diets</span><span class="co">](https://kwstat.github.io/agridat/reference/depalluel.sheep.html)</span></span>
<span id="cb130-401"><a href="#cb130-401" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Birth weight of lambs from different lines/sires</span><span class="co">](https://kwstat.github.io/agridat/reference/harville.lamb.html)</span></span>
<span id="cb130-402"><a href="#cb130-402" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Weight gain calves in a feedlot</span><span class="co">](https://kwstat.github.io/agridat/reference/urquhart.feedlot.html)</span></span>
<span id="cb130-403"><a href="#cb130-403" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Average daily gain of 65 steers for 3 lines, 9 sires.</span><span class="co">](https://kwstat.github.io/agridat/reference/harvey.lsmeans.html)</span></span>
<span id="cb130-404"><a href="#cb130-404" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Multi-environment trial of oats in United States, 5 locations, 7 years.</span><span class="co">](https://kwstat.github.io/agridat/reference/edwards.oats.html)</span></span>
<span id="cb130-405"><a href="#cb130-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-406"><a href="#cb130-406" aria-hidden="true" tabindex="-1"></a>Es gibt natürlich noch mehr Datensätze, die du dann mit einem gemischten Modell auswerten kannst, aber das ist hier einmal eine Auswahl an möglichen Datensätzen zum üben.</span>
<span id="cb130-407"><a href="#cb130-407" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-408"><a href="#cb130-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-409"><a href="#cb130-409" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualisierung</span></span>
<span id="cb130-410"><a href="#cb130-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-411"><a href="#cb130-411" aria-hidden="true" tabindex="-1"></a>Der wichtigste Teil in einer Analyse ist die Visualisierung der Zusammenhänge. Das ist noch wahrer bei ser komplexen Modellen wie es die linearen gemischten Modelle sind. Wir müssen erstmal verstehen welche Gruppenstrukturen wir in den Daten haben und welchen Einfluss diese auf die jeweiligen Outcomes haben. Häufig müssen wir dazu dann aber mehrere Abbildungen erstellen, den bei so vielen Faktoren reichen dann einfache 2D Abbidlungen dann meistens nicht mehr aus. Ich versuche hier dann einmal zu zeigen, wie du das meiste aus <span class="in">`{ggplot}`</span> rausholen kannst, um dir komplexe Daten zu visualisieren.</span>
<span id="cb130-412"><a href="#cb130-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-413"><a href="#cb130-413" aria-hidden="true" tabindex="-1"></a>Wie bringen wir also möglichst viele informative Abbildungen sinnvoll zusammen? Wir nutzen dazu das <span class="co">[</span><span class="ot">R Paket`{gghalves}`</span><span class="co">](https://erocoar.github.io/gghalves/)</span>. Wir können mit <span class="in">`{gghalves}`</span> halbe Plots erstellen und diese dann miteinander kombinieren für ein Faktorlevel kombinieren. Dabei setzen wir dann in die Mitte Boxplots. Links von den Boxplots zeichnen wir die einzelnen Beobachtungen als Punkte mit <span class="in">`stat_dots()`</span> und die Verteilung der einzelnen Beobachtungen zeichnen wir mit dem <span class="co">[</span><span class="ot">R Paket `{ggdist}`</span><span class="co">](https://mjskay.github.io/ggdist/)</span> auf die rechte Seite. Das Tutorium <span class="co">[</span><span class="ot">Visualizing Distributions with Raincloud Plots</span><span class="co">](https://www.cedricscherer.com/2021/06/06/visualizing-distributions-with-raincloud-plots-and-how-to-create-them-with-ggplot2/)</span> liefert dann noch mehr Anleitungen für noch mehr Varianten. Wie du aber schon am R Code siehst, ist das eine etwas komplexere Abbildung geworden.</span>
<span id="cb130-414"><a href="#cb130-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-415"><a href="#cb130-415" aria-hidden="true" tabindex="-1"></a>Damit wir den ganzen R Code nicht die ganze zeit kopieren müssen, habe ich im folgenden Chunk einmal ein <span class="in">`{ggplot}`</span>-Template erstellt, welches ich dann immer wieder mit neuen Daten und einem <span class="in">`aes()`</span>-Aufruf versehen werde. Das kürzt dann doch ziemlich den Code zusammen. Insbesondere da wir ja sehr viele Abbildungen für unsere drei Datensätz bauen müssen. Du kannst natürlich auch immer dreimal die einzelnen Abbildungen bauen oder aber mit <span class="in">`facet_wrap()`</span> arbeiten um den dritten Faktor darzustellen.</span>
<span id="cb130-416"><a href="#cb130-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-419"><a href="#cb130-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-420"><a href="#cb130-420" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb130-421"><a href="#cb130-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> .<span class="dv">5</span>, <span class="at">width =</span> .<span class="dv">6</span>, </span>
<span id="cb130-422"><a href="#cb130-422" aria-hidden="true" tabindex="-1"></a>               <span class="at">.width =</span> <span class="dv">0</span>, <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>, </span>
<span id="cb130-423"><a href="#cb130-423" aria-hidden="true" tabindex="-1"></a>               <span class="at">point_colour =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb130-424"><a href="#cb130-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb130-425"><a href="#cb130-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dots</span>(<span class="at">side =</span> <span class="st">"left"</span>, <span class="at">justification =</span> <span class="fl">1.12</span>, <span class="at">binwidth =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb130-426"><a href="#cb130-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">2.9</span>), <span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb130-427"><a href="#cb130-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb130-428"><a href="#cb130-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) </span>
<span id="cb130-429"><a href="#cb130-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-430"><a href="#cb130-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-431"><a href="#cb130-431" aria-hidden="true" tabindex="-1"></a>Beginnen wir uns nun einmal die drei Datensätze zu visualisieren und nutzen dann die Abbildungen um etwas über die hierarchischen Strukturen in den Daten zu erfahren. Aus den Rückschlüssen können wir dann entscheiden, wie wir unsere lineare gemischten Modelle bauen müssen.</span>
<span id="cb130-432"><a href="#cb130-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-433"><a href="#cb130-433" aria-hidden="true" tabindex="-1"></a><span class="fu">### Schuldaten</span></span>
<span id="cb130-434"><a href="#cb130-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-435"><a href="#cb130-435" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns einmal in den folgenden beiden Tabs die Schuldaten und damit die Effekte der Schulen und der jeweils drei Klassen auf die Testergebnisse der Schüler an. Es ist immer wichtig sich alle möglichen Kombinationen von Faktoren anzuschauen um dann auch eine Idee für das gemischte Modell im Anschluss zu finden. Sonst stochert man sehr im Nebel rum und mit den Abbildungen hat man dann einen Hinweis, wohin es gehen könnte.</span>
<span id="cb130-436"><a href="#cb130-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-437"><a href="#cb130-437" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb130-438"><a href="#cb130-438" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effekt der Schule</span></span>
<span id="cb130-439"><a href="#cb130-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-440"><a href="#cb130-440" aria-hidden="true" tabindex="-1"></a>In der folgenden @fig-mixed-school-1 sehen wir einmal die Effekte der Schule aufgeteilt nach den Lehrformaten auf die Testergebnisse der jeweiligen Schüler. Es fällt sofort ein Effekt der Schulen auf die Testergebnisse auf. Zum Beispiel hat die *Greenville School* im Frontalunterricht sehr viel schlechte Testergebnisse als die beiden anderen Schulen mit Frontalunterricht. Ähnliches, aber im positiven Sinne, sehen wir bei der *Arlington Academy*, die gegen den Trend der beiden anderen Schulen, bessere Ergebnisse bei dem Lehrformat Flipped Classroom erreicht. Somit müssen wir in unserer Analyse die Schule mit berücksichtigen, es macht eben einen Unetrschied, auf welche Schule ein Schüler gegangen ist.</span>
<span id="cb130-441"><a href="#cb130-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-444"><a href="#cb130-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-445"><a href="#cb130-445" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-446"><a href="#cb130-446" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-447"><a href="#cb130-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-448"><a href="#cb130-448" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-449"><a href="#cb130-449" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5.5</span></span>
<span id="cb130-450"><a href="#cb130-450" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb130-451"><a href="#cb130-451" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dreifachplot der Testergebnisse der Schüler zusammen über alle drei Klassen in den jeweiligen neun Schulen aufgetrennt nach dem Lehrformat. Teilweise sind starke Effekte der Schulen auf die Testergebnisse der Schüler zu erkennen."</span></span>
<span id="cb130-452"><a href="#cb130-452" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mixed-school-1</span></span>
<span id="cb130-453"><a href="#cb130-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-454"><a href="#cb130-454" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb130-455"><a href="#cb130-455" aria-hidden="true" tabindex="-1"></a>  school_tbl <span class="sc">+</span> </span>
<span id="cb130-456"><a href="#cb130-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> test, <span class="at">color =</span> school_id) <span class="sc">+</span></span>
<span id="cb130-457"><a href="#cb130-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lehrformat"</span>, <span class="at">y =</span> <span class="st">"Testscore"</span>, <span class="at">color =</span> <span class="st">"Schule"</span>) <span class="sc">+</span></span>
<span id="cb130-458"><a href="#cb130-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>))</span>
<span id="cb130-459"><a href="#cb130-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-460"><a href="#cb130-460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-461"><a href="#cb130-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-462"><a href="#cb130-462" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effekt der Klassen</span></span>
<span id="cb130-463"><a href="#cb130-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-464"><a href="#cb130-464" aria-hidden="true" tabindex="-1"></a>Jetzt schauen wir uns noch den Effekt der Klasse an und fragen uns in der @fig-mixed-school-3, ob wir auch einen starken Effekt der Klassen auf die Testergebnisse haben. Hier sehen wir zwar auch Unterschiede zwischen den Klassen, aber die Effekt sind in den Lehrformaten eher gleichmäßig vertreten. Die kleine Gruppe bei dem Lehrformat Frontal gehört zur einer Schule und nicht zu einer einzelnen Klasse. Damit könnten wir die Klasse eher ignorieren, wenn wir unser Modell bauen. Es macht nicht so einen großen Unterschied in welche Klasse ein Schüler gegangen ist.</span>
<span id="cb130-465"><a href="#cb130-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-468"><a href="#cb130-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-469"><a href="#cb130-469" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-470"><a href="#cb130-470" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-471"><a href="#cb130-471" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-472"><a href="#cb130-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-473"><a href="#cb130-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5.5</span></span>
<span id="cb130-474"><a href="#cb130-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb130-475"><a href="#cb130-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dreifachplot der Testergebnisse der Schüler zusammen über alle Schulen in den jeweiligen drei Klassen aufgetrennt nach dem Lehrformat. Die Effekte der einzelnen Klassen sind nicht so stark ausgeprägt. Der Effekt der Schulen scheint in diesem Fall stärker zu sein."</span></span>
<span id="cb130-476"><a href="#cb130-476" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mixed-school-3</span></span>
<span id="cb130-477"><a href="#cb130-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-478"><a href="#cb130-478" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb130-479"><a href="#cb130-479" aria-hidden="true" tabindex="-1"></a>  school_tbl <span class="sc">+</span> </span>
<span id="cb130-480"><a href="#cb130-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> test, <span class="at">color =</span> class_in_school_id) <span class="sc">+</span></span>
<span id="cb130-481"><a href="#cb130-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Lehrformat"</span>, <span class="at">y =</span> <span class="st">"Testscore"</span>, <span class="at">color =</span> <span class="st">"Klasse"</span>) <span class="sc">+</span></span>
<span id="cb130-482"><a href="#cb130-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>))</span>
<span id="cb130-483"><a href="#cb130-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-484"><a href="#cb130-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-485"><a href="#cb130-485" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-486"><a href="#cb130-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-487"><a href="#cb130-487" aria-hidden="true" tabindex="-1"></a>Gerade haben wir gesehen, dass die Schulen mehr der Varianz in den Testergebnissen der Schüler erklären als die Klassen. Brauchen wir eigentlich nur die Schulen oder reichen auch die Informationen die in den einzelnen Klassen stecken? Wir haben ja unsere Daten so gebaut, dass wir immer nur drei Klassen pro Schule haben und jeweils eine der drei Klassen ein Lehrformat erhält. Damit könnte es sein, dass wir mit dem Faktor <span class="in">`class_id`</span> auch die Varianz der Schulen <span class="in">`scholl_id`</span> mit abbilden könnten. Das funktioniert hier aber nur, da die immer die gleiche Anzahl an Klassen mit der gleichen Anzahl an Lehrformaten in einer Schule verschachtelt ist. Schauen wir dazu einmal in die @fig-mixed-school-2. Wie wir sehen, scheinen die einzelnen Klassen die jeweiligen Schulen mit abzubilden. Die Klasse 19, 20 und 21 ist beim Forntalunterreicht schlechter. Dies wird die Schule *Greenville School* sein. Wir können also alleine durch die Information zu den einzlenen Klassen die Varianz der Schulen erklären! Mal schauen, was das dann später für unser lineares gemischtes Modell bedeutet.</span>
<span id="cb130-488"><a href="#cb130-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-491"><a href="#cb130-491" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-492"><a href="#cb130-492" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-493"><a href="#cb130-493" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-494"><a href="#cb130-494" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-495"><a href="#cb130-495" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-496"><a href="#cb130-496" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb130-497"><a href="#cb130-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb130-498"><a href="#cb130-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Boxplot der Testergebnisse der drei Lehrformate aufgeteilt nach den individuellen Klassen. Da immer nur drei Klassen pro Schule erhoben wurden, bilden die individuellen Klassen auch den Effekt der Schulen mit ab."</span></span>
<span id="cb130-499"><a href="#cb130-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mixed-school-2</span></span>
<span id="cb130-500"><a href="#cb130-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-501"><a href="#cb130-501" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(school_tbl, <span class="fu">aes</span>(<span class="at">x =</span> class_id, <span class="at">y =</span> test, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb130-502"><a href="#cb130-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb130-503"><a href="#cb130-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Individuelle Klassen ID"</span>, <span class="at">y =</span> <span class="st">"Testscore"</span>, <span class="at">fill =</span> <span class="st">"Lehrformat"</span>) <span class="sc">+</span></span>
<span id="cb130-504"><a href="#cb130-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb130-505"><a href="#cb130-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb130-506"><a href="#cb130-506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-507"><a href="#cb130-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-508"><a href="#cb130-508" aria-hidden="true" tabindex="-1"></a><span class="fu">### Weizendaten</span></span>
<span id="cb130-509"><a href="#cb130-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-510"><a href="#cb130-510" aria-hidden="true" tabindex="-1"></a>Bei den Weizendaten haben wir auch die Positionen der einzelnen Parzellen durch die Faktoren <span class="in">`row`</span> und <span class="in">`col`</span>. Damit wissen wir an welcher Stelle die jeweiligen Parzellen auf dem Feld zu finden sind. Damit wissen wir dann auch, welche Behandlung mit Stickstoff und welche Weizenlinie wo aufgebracht wurde. In der @fig-mixed-desplot-yates sehen wir die Visualisierung des experimentellen Designs mit dem R Paket <span class="in">`{desplot}`</span>. Wir sehen klar die Struktur der sechs Blöcke. In jedem Block finden sich die drei Sorten. In jeder Sorte wurde dann unterschiedlich mit Stickstoff gedüngt. Wir haben hier aber keine echte Spaltanlage vorliegen, da die Stickstoffbehandlung als Subplot quadratisch angeordnet ist. Später brauchen wir die Informationen um unser lineares gemischtes Modell sauber zu definieren.</span>
<span id="cb130-511"><a href="#cb130-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-514"><a href="#cb130-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-515"><a href="#cb130-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-516"><a href="#cb130-516" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-517"><a href="#cb130-517" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-518"><a href="#cb130-518" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-519"><a href="#cb130-519" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5.5</span></span>
<span id="cb130-520"><a href="#cb130-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb130-521"><a href="#cb130-521" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung des experimentellen Designs des Split plots für die Weizendaten. In sechs Blöcken wurden die drei Sorten aufgebracht. In jeder Sorte wurden wiederum die Sticktoffmengen randomisiert. Es kiegt keine echte Spaltanlage vor, da die Subplots innberhalb der Blöcke quadratisch angeordnet sind."</span></span>
<span id="cb130-522"><a href="#cb130-522" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mixed-desplot-yates</span></span>
<span id="cb130-523"><a href="#cb130-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-524"><a href="#cb130-524" aria-hidden="true" tabindex="-1"></a><span class="fu">desplot</span>(oats_tbl, block <span class="sc">~</span> col<span class="sc">*</span>row, </span>
<span id="cb130-525"><a href="#cb130-525" aria-hidden="true" tabindex="-1"></a>        <span class="at">num =</span> nitro, <span class="at">col =</span> gen,</span>
<span id="cb130-526"><a href="#cb130-526" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">aspect =</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">3</span>,</span>
<span id="cb130-527"><a href="#cb130-527" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb130-528"><a href="#cb130-528" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-529"><a href="#cb130-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-530"><a href="#cb130-530" aria-hidden="true" tabindex="-1"></a>In den folgenden Tabs schauen wir uns dann einmal die Effekte der Weizenlinien sowie der Stickstoffdüngung auf den Ertrag an. Dabei trennen wir dann die Abbildung für die Blöcke auf. Auch hier wollen wir uns erstmal einen Überblick verschaffen und schauen, ob wir überhaupt einen Effekt von den Behandlungen haben oder aber ob die Blöcke sich einigermaßen gleich verhalten. Auch könnte es sein, dass die genetische Linien des Weizen an unterschiedlichen Standorten der Blöcke dann auf einmal doch andere Erträge bringen. All das wollen wir uns einmal in den folgenden Abbildungen anschauen.</span>
<span id="cb130-531"><a href="#cb130-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-532"><a href="#cb130-532" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb130-533"><a href="#cb130-533" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effekt der Linie `gen`</span></span>
<span id="cb130-534"><a href="#cb130-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-535"><a href="#cb130-535" aria-hidden="true" tabindex="-1"></a>In der @fig-mixed-yates-1-gen sehen wir die Ausiwkungend der Sorte des Weizens auf den Ertrag aufgeteilt nach den sechs Blöcken. Klar ist zu erkennen, dass der Block 4 teilweise zu sehr viel höheren Erträgen führt. Auch haben wir bei der Sorte <span class="in">`Victory`</span> einzelne Gruppen von Pflanzen, die anscheinend mehr Ertrag im Block 4 produzieren. Hier liegt also eine klare Wechselwirkung zwischen den Blöcken und der Sorte vor. Der Block muss auf jeden Fall mit in das lineare gemischte Modell. Die Effekt über die Sorten hinweg deuten auf keinen Trend hin, im Mittel sind alle Sorten des Weizen gleich im Bezug auf den Ertrag.</span>
<span id="cb130-536"><a href="#cb130-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-539"><a href="#cb130-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-540"><a href="#cb130-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-541"><a href="#cb130-541" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-542"><a href="#cb130-542" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-543"><a href="#cb130-543" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-544"><a href="#cb130-544" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5.5</span></span>
<span id="cb130-545"><a href="#cb130-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb130-546"><a href="#cb130-546" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Betrachtung der Auswirkungen der Sorte `gen` des Weizens auf den Ertrag, aufgeteilt nach den Blöcken. Einige Blöcke haben klar mehr Ertrag als andere Blöcke, wie auch schon bei den Stickstoffdüngungen."</span></span>
<span id="cb130-547"><a href="#cb130-547" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mixed-yates-1-gen</span></span>
<span id="cb130-548"><a href="#cb130-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-549"><a href="#cb130-549" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb130-550"><a href="#cb130-550" aria-hidden="true" tabindex="-1"></a>  oats_tbl <span class="sc">+</span> </span>
<span id="cb130-551"><a href="#cb130-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> gen, <span class="at">y =</span> plant_yield, <span class="at">color =</span> block) <span class="sc">+</span></span>
<span id="cb130-552"><a href="#cb130-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Genetische Linie"</span>, <span class="at">y =</span> <span class="st">"Ertrag"</span>, <span class="at">color =</span> <span class="st">"Block"</span>) <span class="sc">+</span></span>
<span id="cb130-553"><a href="#cb130-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>))</span>
<span id="cb130-554"><a href="#cb130-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-555"><a href="#cb130-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-556"><a href="#cb130-556" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effekt des Stickstoff `nitro`</span></span>
<span id="cb130-557"><a href="#cb130-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-558"><a href="#cb130-558" aria-hidden="true" tabindex="-1"></a>Betrachten wir in der @fig-mixed-yates-1-nitro den Ertrag in Abhängigkeit von der Stickstoffdüngung. Auch hier teilen wir die Daten wieder nach den Blöcken auf. Zuerst sehen wir einen klaren Trend. mit der Zunahme der Stickstoffkonzentration nimmt auch der Ertrag zu. Dennoch haben wir auch hier ein klares Problem mit dem Block 4. Der Block 4 hat immer am meisten Ertrag über alle Stickstoffstufen. In der Dosis <span class="in">`0.4`</span> gibt es sogar eine Gruppe von Beobachtungen, die eindeutig am meisten Ertrag im Block 4 liefert. Auch hier sehen wir wieder eine Abhängigkeit des Ertrags von dem Block. Gehen wir also mal der Struktur der Daten weiter nach.</span>
<span id="cb130-559"><a href="#cb130-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-562"><a href="#cb130-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-563"><a href="#cb130-563" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-564"><a href="#cb130-564" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-565"><a href="#cb130-565" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-566"><a href="#cb130-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-567"><a href="#cb130-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5.5</span></span>
<span id="cb130-568"><a href="#cb130-568" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb130-569"><a href="#cb130-569" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Betrachtung der Auswirkungen der Stickstoffdüngung `nitro` des Weizens auf den Ertrag, aufgeteilt nach den Blöcken. Einige Blöcke haben klar mehr Ertrag als andere Blöcke, wie auch schon bei den Sorten."</span></span>
<span id="cb130-570"><a href="#cb130-570" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mixed-yates-1-nitro</span></span>
<span id="cb130-571"><a href="#cb130-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-572"><a href="#cb130-572" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb130-573"><a href="#cb130-573" aria-hidden="true" tabindex="-1"></a>  oats_tbl <span class="sc">+</span> </span>
<span id="cb130-574"><a href="#cb130-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> nitro, <span class="at">y =</span> plant_yield, <span class="at">color =</span> block) <span class="sc">+</span></span>
<span id="cb130-575"><a href="#cb130-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Stickstoffkonzentration"</span>, <span class="at">y =</span> <span class="st">"Ertrag"</span>, <span class="at">color =</span> <span class="st">"Block"</span>) <span class="sc">+</span></span>
<span id="cb130-576"><a href="#cb130-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>))</span>
<span id="cb130-577"><a href="#cb130-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-578"><a href="#cb130-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-579"><a href="#cb130-579" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effekt von `gen` in `block`</span></span>
<span id="cb130-580"><a href="#cb130-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-581"><a href="#cb130-581" aria-hidden="true" tabindex="-1"></a>Abschließend schauen wir nochmal in der @fig-mixed-yates-1-gen-block auf die Wechselwirkung zwischen den Blöcken und den Sorten. Hier sehen wir endlich unsere kleinen Gruppen, die wir auch schon in den beiden anderen Abbildungen gesehen haben klar zugeordnet. Die Sorten spalten sich klar über die Blöcke und Stickstoffgaben auf. Es macht also einen Unterschied wo wir die einzelnen Sorten gepflanzt haben. Die Blöcke und Sorten interagieren klar miteinander. Wir können also sagen, dass die Sorten in den Blöcken auf jeden Fall *genestet* sind. Wir werden also diese Struktur auf jeden Fall berücksichtigen müssen.</span>
<span id="cb130-582"><a href="#cb130-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-585"><a href="#cb130-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-586"><a href="#cb130-586" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-587"><a href="#cb130-587" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-588"><a href="#cb130-588" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-589"><a href="#cb130-589" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-590"><a href="#cb130-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5.5</span></span>
<span id="cb130-591"><a href="#cb130-591" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb130-592"><a href="#cb130-592" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Betrachtung der Auswirkungen der Stickstoffdüngung `nitro` des Weizens auf den Ertrag, aufgeteilt nach den Blöcken und den Sorten des Weizens. Klar ist zu erkennen, dass einige Sorten in einigen Blöcken klar mehr Ertrag haben."</span></span>
<span id="cb130-593"><a href="#cb130-593" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mixed-yates-1-gen-block</span></span>
<span id="cb130-594"><a href="#cb130-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-595"><a href="#cb130-595" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb130-596"><a href="#cb130-596" aria-hidden="true" tabindex="-1"></a>  oats_tbl <span class="sc">+</span> </span>
<span id="cb130-597"><a href="#cb130-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> nitro, <span class="at">y =</span> plant_yield, <span class="at">color =</span> block) <span class="sc">+</span></span>
<span id="cb130-598"><a href="#cb130-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Stickstoffkonzentration"</span>, <span class="at">y =</span> <span class="st">"Ertrag"</span>, <span class="at">color =</span> <span class="st">"Block"</span>) <span class="sc">+</span></span>
<span id="cb130-599"><a href="#cb130-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)) <span class="sc">+</span></span>
<span id="cb130-600"><a href="#cb130-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> gen)</span>
<span id="cb130-601"><a href="#cb130-601" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-602"><a href="#cb130-602" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-603"><a href="#cb130-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-604"><a href="#cb130-604" aria-hidden="true" tabindex="-1"></a>Jetzt wollen wir nochmal schauen, ob wir auch eine Interaktion zwischen der Stickstoffdüngung, den Weizensorten und den Blöcken vorliegen haben. Insbesondere müssen wir natürlich schauen, wie sich unsere beiden Behandlungen <span class="in">`nitro`</span> und <span class="in">`gen`</span> untereinander verhalten. Wenn wir hier auch eine Interaktion vorliegen haben, dann müssen wir diese Interaktion auch im Modell abbilden. Zuerst erschaffen wir uns aber die Mittelwerte über alle Faktorenkombinationen.</span>
<span id="cb130-605"><a href="#cb130-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-608"><a href="#cb130-608" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-609"><a href="#cb130-609" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-610"><a href="#cb130-610" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-611"><a href="#cb130-611" aria-hidden="true" tabindex="-1"></a>stat_oats_tbl <span class="ot">&lt;-</span> oats_tbl <span class="sc">|&gt;</span> </span>
<span id="cb130-612"><a href="#cb130-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(nitro, gen, block) <span class="sc">|&gt;</span> </span>
<span id="cb130-613"><a href="#cb130-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(plant_yield))</span>
<span id="cb130-614"><a href="#cb130-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-615"><a href="#cb130-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-616"><a href="#cb130-616" aria-hidden="true" tabindex="-1"></a>Dann sind wir wieder etwas faul und bauen uns erstmal ein <span class="in">`{ggplot}`</span>-Template für die Interaktionsabbildungen. Sonst produzieren wir wieder sehr viel redunanten Code, was wir uns hier dann sparen können. Wir werden uns einfach die Mittelwerte über die Stickstoffgaben getrennt für die Sorten und die Blöcke einmal anschauen.</span>
<span id="cb130-617"><a href="#cb130-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-620"><a href="#cb130-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-621"><a href="#cb130-621" aria-hidden="true" tabindex="-1"></a>gg_inter_template <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb130-622"><a href="#cb130-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb130-623"><a href="#cb130-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>) <span class="sc">+</span></span>
<span id="cb130-624"><a href="#cb130-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)) <span class="sc">+</span></span>
<span id="cb130-625"><a href="#cb130-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb130-626"><a href="#cb130-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) </span>
<span id="cb130-627"><a href="#cb130-627" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-628"><a href="#cb130-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-629"><a href="#cb130-629" aria-hidden="true" tabindex="-1"></a>In der @fig-mixed-yates-1-inter sehen wir einmal die Interaktionsplots für die verschiedenen möglichen Interaktionen zwischen den Faktoren der Stickstoffdüngung, der Weizensorte und den Blöcken. @fig-mixed-yates-1-inter-1 zeigt klar, dass es keine Interaktion zwischen der Stickstoffdüngung und den Sorten gibt. Die Graden laufen parallel zueinander. Wir haben einen mittleren Effekt der Stickstoffdüngung, da wir einen Anstieg beobachten. Dennoch ist die Ordnung der Sorten pro Level der Stickstoffdüngung gleich. Würden sich die Graden überschneiden, hätten wir eine Interaktion vorliegen. Da die Graden das nicht tun, können wir also von keiner Interaktion zwischen <span class="in">`nitro`</span> und <span class="in">`gen`</span> ausgehen. Wir sehen aber auch in den beiden anderen Abbildungen, dass wir auf jeden Fall den Block mit modellieren müssen. Der Block hat zumindest einen visuellen Einfluss auf den Ertrag.</span>
<span id="cb130-630"><a href="#cb130-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-633"><a href="#cb130-633" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-634"><a href="#cb130-634" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-635"><a href="#cb130-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-636"><a href="#cb130-636" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-637"><a href="#cb130-637" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-638"><a href="#cb130-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb130-639"><a href="#cb130-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb130-640"><a href="#cb130-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Interaktionsplot der Mittelwerte für die Stickstoffbehandlung `nitro`, den Sorten des Weizens `gen` sowie den Blöcken `block`. Dargestellt sind die Mittelwerte für die jeweilige Faktorkombination. Wenn wir *keine* Interaktion erwarten, dann laufen die Graden parallel zueinander."</span></span>
<span id="cb130-641"><a href="#cb130-641" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mixed-yates-1-inter</span></span>
<span id="cb130-642"><a href="#cb130-642" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb130-643"><a href="#cb130-643" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Interaktion `nitro:gen`"</span></span>
<span id="cb130-644"><a href="#cb130-644" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Interaktion `nitro:gen:block`"</span></span>
<span id="cb130-645"><a href="#cb130-645" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Interaktion `nitro:block:gen`"</span></span>
<span id="cb130-646"><a href="#cb130-646" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-nrow: 1</span></span>
<span id="cb130-647"><a href="#cb130-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-648"><a href="#cb130-648" aria-hidden="true" tabindex="-1"></a>gg_inter_template <span class="sc">%+%</span> </span>
<span id="cb130-649"><a href="#cb130-649" aria-hidden="true" tabindex="-1"></a>  oats_tbl <span class="sc">+</span> </span>
<span id="cb130-650"><a href="#cb130-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> nitro, <span class="at">y =</span> plant_yield, <span class="at">color =</span> gen, <span class="at">group =</span> gen) <span class="sc">+</span></span>
<span id="cb130-651"><a href="#cb130-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Stickstoffkonzentration"</span>, <span class="at">y =</span> <span class="st">"Ertrag"</span>, <span class="at">color =</span> <span class="st">"Sorte"</span>) </span>
<span id="cb130-652"><a href="#cb130-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-653"><a href="#cb130-653" aria-hidden="true" tabindex="-1"></a>gg_inter_template <span class="sc">%+%</span> </span>
<span id="cb130-654"><a href="#cb130-654" aria-hidden="true" tabindex="-1"></a>  oats_tbl <span class="sc">+</span> </span>
<span id="cb130-655"><a href="#cb130-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> nitro, <span class="at">y =</span> plant_yield, <span class="at">color =</span> gen, <span class="at">group =</span> gen) <span class="sc">+</span></span>
<span id="cb130-656"><a href="#cb130-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Stickstoffkonzentration"</span>, <span class="at">y =</span> <span class="st">"Ertrag"</span>, <span class="at">color =</span> <span class="st">"Sorte"</span>) <span class="sc">+</span></span>
<span id="cb130-657"><a href="#cb130-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> block)</span>
<span id="cb130-658"><a href="#cb130-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-659"><a href="#cb130-659" aria-hidden="true" tabindex="-1"></a>gg_inter_template <span class="sc">%+%</span> </span>
<span id="cb130-660"><a href="#cb130-660" aria-hidden="true" tabindex="-1"></a>  oats_tbl <span class="sc">+</span> </span>
<span id="cb130-661"><a href="#cb130-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> nitro, <span class="at">y =</span> plant_yield, <span class="at">color =</span> block, <span class="at">group =</span> block) <span class="sc">+</span></span>
<span id="cb130-662"><a href="#cb130-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Stickstoffkonzentration"</span>, <span class="at">y =</span> <span class="st">"Ertrag"</span>, <span class="at">color =</span> <span class="st">"Block"</span>) <span class="sc">+</span></span>
<span id="cb130-663"><a href="#cb130-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> gen) </span>
<span id="cb130-664"><a href="#cb130-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-665"><a href="#cb130-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-666"><a href="#cb130-666" aria-hidden="true" tabindex="-1"></a><span class="fu">### Wurmdaten</span></span>
<span id="cb130-667"><a href="#cb130-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-668"><a href="#cb130-668" aria-hidden="true" tabindex="-1"></a>In den vorherigen Datensätzen haben wir uns ein eher normalverteiltes Outcome angeschaut. In den Wurmdaten wollen wir uns einmal Zähldaten anschauen. Das hat natürlich auf den Plot des experimentellen Designs erstmal keinen Einfluss. Wir haben die Informationen zu den Reihen und den Spalten und können daran dann unser Latinsquare Design einmal in dem R Paket <span class="in">`{desplot}`</span> in der @fig-mixed-desplot-wireworms darstellen. In einem Latinsquare Design ist jede unserer fünf Behandlungen genau einmal in jeder Reihe oder Spalte vertreten. Ich habe einmal die Parzellen nach den Behandlungen eingefärbt. Nochmal zur Erinnerung, die Buchstaben haben hier keine tiefere Bedeutung. Die Buchstaben stellen eben nur die fünf verschiedenen Insektiziede gegen den Wurmbefall dar.</span>
<span id="cb130-669"><a href="#cb130-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-672"><a href="#cb130-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-673"><a href="#cb130-673" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-674"><a href="#cb130-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-675"><a href="#cb130-675" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-676"><a href="#cb130-676" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-677"><a href="#cb130-677" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb130-678"><a href="#cb130-678" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb130-679"><a href="#cb130-679" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Latinsquare Design der Insektizidbehandlung auf einem $5 \\times 5$ großen Versuchsfeld. Jede Behandlung ist genau einmal in jeder Reihe und jeder Spalte vertreten. Die Buchstaben sind willkürlich gewählt."</span></span>
<span id="cb130-680"><a href="#cb130-680" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mixed-desplot-wireworms</span></span>
<span id="cb130-681"><a href="#cb130-681" aria-hidden="true" tabindex="-1"></a><span class="fu">desplot</span>(wireworms_tbl, trt <span class="sc">~</span> col <span class="sc">*</span> row,</span>
<span id="cb130-682"><a href="#cb130-682" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> trt, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">show.key =</span> <span class="cn">FALSE</span>,</span>
<span id="cb130-683"><a href="#cb130-683" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">""</span>) </span>
<span id="cb130-684"><a href="#cb130-684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-685"><a href="#cb130-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-686"><a href="#cb130-686" aria-hidden="true" tabindex="-1"></a>Jetzt schauen wir uns in der @fig-mixed-wireworm-1 nochmal die Effekte der Spalte und der Reihe auf die Anzahl der Würmer an. Hier muss man natürlich bedenken, dass die Reihen und die Spalten verschoben die gleichen Effekte haben. Den jede Spalte ist auch ein Teil einer Reihe und umgekehrt. Wir sehen aber sofort das es Problem mit der Spalte <span class="in">`1`</span> sowie dann mit der Reihe <span class="in">`1`</span> gibt. Hier haben wir bei der Insektizidbehandlung <span class="in">`N`</span> sehr viel mehr Würmer als in den anderen Parzellen. Teilweise sehen wir auch Abweichungen nach oben bei den anderen Behandlungen, je nachdem welche Parzelle wir betrachten. Hier müssen wir auf jeden Fall unser Modell so anpassen, dass die Spalten und Reihen im Modell berücksichtigt werden.</span>
<span id="cb130-687"><a href="#cb130-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-690"><a href="#cb130-690" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-691"><a href="#cb130-691" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-692"><a href="#cb130-692" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-693"><a href="#cb130-693" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-694"><a href="#cb130-694" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-695"><a href="#cb130-695" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5.5</span></span>
<span id="cb130-696"><a href="#cb130-696" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb130-697"><a href="#cb130-697" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Betrachtung der Auswirkung der verschiedenen Insketizidbehandlung auf die Anzahl von Würmern aufgeteilt für die Spalten und Reihen in einem Latinsquare Design. Teilweise sind die Effekte der Position `col` und `row` auf die Würmeranzahlen klar ersichtlich."</span></span>
<span id="cb130-698"><a href="#cb130-698" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mixed-wireworm-1</span></span>
<span id="cb130-699"><a href="#cb130-699" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb130-700"><a href="#cb130-700" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Spalte (`col`)"</span></span>
<span id="cb130-701"><a href="#cb130-701" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Reihe (`row`)"</span></span>
<span id="cb130-702"><a href="#cb130-702" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-nrow: 1</span></span>
<span id="cb130-703"><a href="#cb130-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-704"><a href="#cb130-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-705"><a href="#cb130-705" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb130-706"><a href="#cb130-706" aria-hidden="true" tabindex="-1"></a>  wireworms_tbl <span class="sc">+</span> </span>
<span id="cb130-707"><a href="#cb130-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> count_worms, <span class="at">color =</span> col) <span class="sc">+</span></span>
<span id="cb130-708"><a href="#cb130-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Insektizidbehandlung"</span>, <span class="at">y =</span> <span class="st">"Anzahl Würmer"</span>, <span class="at">color =</span> <span class="st">"Spalte (col)"</span>) <span class="sc">+</span></span>
<span id="cb130-709"><a href="#cb130-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">4.9</span>), <span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb130-710"><a href="#cb130-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)) </span>
<span id="cb130-711"><a href="#cb130-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-712"><a href="#cb130-712" aria-hidden="true" tabindex="-1"></a>gg_half_template <span class="sc">%+%</span></span>
<span id="cb130-713"><a href="#cb130-713" aria-hidden="true" tabindex="-1"></a>  wireworms_tbl <span class="sc">+</span> </span>
<span id="cb130-714"><a href="#cb130-714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> count_worms, <span class="at">color =</span> row) <span class="sc">+</span></span>
<span id="cb130-715"><a href="#cb130-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Insektizidbehandlung"</span>, <span class="at">y =</span> <span class="st">"Anzahl Würmer"</span>, <span class="at">color =</span> <span class="st">"Reihe (row)"</span>) <span class="sc">+</span></span>
<span id="cb130-716"><a href="#cb130-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">4.9</span>), <span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb130-717"><a href="#cb130-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)) </span>
<span id="cb130-718"><a href="#cb130-718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-719"><a href="#cb130-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-720"><a href="#cb130-720" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modellierung</span></span>
<span id="cb130-721"><a href="#cb130-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-722"><a href="#cb130-722" aria-hidden="true" tabindex="-1"></a>Nachdem wir uns jetzt ausführlich mit der Visualisierung beschäftigt haben, werden wir uns jetzt einmal mit der Modellierung der lineare Modelle befassen. Häufig sind die Modelle sehr komplex und auch ich weiß dann immer nicht, was soll wie in ein Modell rein, deshalb muss ich auch am Ende immer verschiedene Modelle miteinander vergleichen. Das beste Modell sollte so wenige Faktoren und Interaktionen enthalten wie möglich, aber dennoch alle Quellen von möglicher Varianz abdecken. Daher lohnt es sich immer auch ein sehr einfaches Modell mit in die Analyse zu nehmen und zu schauen, ob es nicht auch mit einem einfachen Modell klappen würde. Nicht immer ist ein lineares gemischtes Modell die beste Lösung. Manchmal passt dann auch ein einfaches Modell mit nur festen Effekten.</span>
<span id="cb130-723"><a href="#cb130-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-724"><a href="#cb130-724" aria-hidden="true" tabindex="-1"></a>::: callout-important</span>
<span id="cb130-725"><a href="#cb130-725" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mindestanzahl an Leveln für einen zufälligen Effekt</span></span>
<span id="cb130-726"><a href="#cb130-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-727"><a href="#cb130-727" aria-hidden="true" tabindex="-1"></a>Wir brauchen mindestens 5 bis 6 Level für einen Faktor, den wir als zufälligen Effekt deklarieren. Das würde hier aber leider die Beispiele sehr komplex machen... deshalb hier mit weniger Leveln und dafür dann nicht so guten Ergebnissen.</span>
<span id="cb130-728"><a href="#cb130-728" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-729"><a href="#cb130-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-730"><a href="#cb130-730" aria-hidden="true" tabindex="-1"></a>Wir immer in R haben wir auch eine ganze Reihe von Paketen zu Verfügung um ein lineares gemischtes Modell zu schätzen. Damit die Sachlage hier nicht ausartet, konzentriere ich mich auf die großen zwei Pakete plus eine etwas andere Implementierung. Zum einen hat @bates2014fitting das <span class="co">[</span><span class="ot">R Paket `{lme4}`</span><span class="co">](https://cran.r-project.org/web/packages/lme4/vignettes/lmer.pdf)</span> entwickelt, welches uns erlaubt lineare gemischte Modelle in R anzuwenden. Es gibt noch das ältere R Paket <span class="in">`{nlme}`</span> was ich aber nicht mehr für lineare gemischte Modelle nutze. Wir nutzen aber gerne die Funktion <span class="in">`gls()`</span> aus dem R Paket <span class="in">`{nlme}`</span>, wenn wir eine lineare Regression mit heterogenen Varianzen rechnen wollen. Eine andere Implementierung mit mehr Möglichkeiten, wenn es um nicht normalverteilte Daten geht, ist das <span class="co">[</span><span class="ot">R Paket `{glmmTMB}`</span><span class="co">](https://glmmtmb.github.io/glmmTMB/index.html)</span>. Wir haben hier insbesondere die Möglichkeit mehr Varianzstrukturen in den Daten abzubilden. Dazu dann gerne mehr in den Vignetten des R Pakets unter <span class="co">[</span><span class="ot">Covariance structures with glmmTMB</span><span class="co">](https://cran.r-project.org/web/packages/glmmTMB/vignettes/covstruct.html)</span>. Du musst dich aber nicht tiefer Einlesen, im prinzip sind die Regeln ähnlich wie bei einem <span class="in">`glm()`</span>. Mehr dazu dann aber gleich in dem entsprechenden Abschnitt zu dem R Paket <span class="in">`{glmmTMB}`</span>. Teilweise sind die Ausgaben der verschiedenen R Paket schlecht miteinander zu vergleichen, da man nicht weiß, wo was wiedergegeben wird. Hier hilft das <span class="co">[</span><span class="ot">R Paket `{mixedup}`</span><span class="co">](https://m-clark.github.io/mixedup/)</span>, welches einem die Arbeit abnimmt gewisse Information aus einem Fit zu einem linearen gemischten Modell zu extrahieren. Abschließend schauen wir uns noch die Implementierung der linearen gemischten Modell in dem <span class="co">[</span><span class="ot">R Paket `{multilevelmod}`</span><span class="co">](https://multilevelmod.tidymodels.org/articles/multilevelmod.html)</span> an, da wir hier noch einfacher ein gemischtes Modell auswählen können. Wichtig ist hier zu wissen, dass die Funktionen aus <span class="in">`{glmmTMB}`</span> nicht implementiert sind. Daher musst du dann schauen, was du brauchst und danach entscheiden. Ich stelle alle Varianten hier dann einmal vor.</span>
<span id="cb130-731"><a href="#cb130-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-732"><a href="#cb130-732" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle findest du nochmal die Schreibweise für die zufälligen Effekte in einem linearen gemischten Modell in R. Glücklicherweise ist die Schreibweise mittlerweile in R bindend und alle neueren Pakete nutzen auch diese Formelschreibweise der zufälligen Effekte. Im Allgmeinen definieren wir einen zufälligen Effekt mit <span class="in">`(1 | random)`</span>. Wir wollen damit einen festen Mittelwert für jedes Level des zufälligen Faktors schätzen. Diese Schreibweise ist damit dann auch der Standard. Wenn du noch eine kontinuierliche Variable <span class="in">`c_1`</span> in den Daten hättest, die sich innerhalb der zufälligen Effekte ändert, dann könntest du auch einen variierenden Mittelwert der zufälligen Effekte für die zusätzliche Variable mit <span class="in">`(c_1 | random)`</span>schätzen. Aber dieser Fall tritt eher selten auf.</span>
<span id="cb130-733"><a href="#cb130-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-734"><a href="#cb130-734" aria-hidden="true" tabindex="-1"></a>| Formula | Bedeutung |</span>
<span id="cb130-735"><a href="#cb130-735" aria-hidden="true" tabindex="-1"></a>|----|----|</span>
<span id="cb130-736"><a href="#cb130-736" aria-hidden="true" tabindex="-1"></a>| $(1\; |\; g)$ | Zufälliger $y$-Achsenabschnitt mit festen Mittelwert (eng. *Random intercept with fixed mean*) |</span>
<span id="cb130-737"><a href="#cb130-737" aria-hidden="true" tabindex="-1"></a>| $(1\; |\; g_1/g_2)$ | Der $y$-Achsenabschnitt variiert in $g_1$ und $g_2$ innerhalb von $g_1$ (eng. *Intercept varying among g1 and g2 within g1*) |</span>
<span id="cb130-738"><a href="#cb130-738" aria-hidden="true" tabindex="-1"></a>| $(1\; |\; g_1) + (1\; |\; g_2)$ | Der $y$-Achsenabschnitt variiert zwischen $g_1$ und $g_2$ (eng. *Intercept varying among g1 and g2*) |</span>
<span id="cb130-739"><a href="#cb130-739" aria-hidden="true" tabindex="-1"></a>| $x + (x\; |\; g)$ | Korrelierter zufälliger $y$-Achsenabschnitt und Steigung (eng. *Correlated random intercept and slope*) |</span>
<span id="cb130-740"><a href="#cb130-740" aria-hidden="true" tabindex="-1"></a>| $x + (x\; ||\; g)$ | Unkorrelierter zufälliger $y$-Achsenabschnitt und Steigung (eng. *Uncorrelated random intercept and slope*) |</span>
<span id="cb130-741"><a href="#cb130-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-742"><a href="#cb130-742" aria-hidden="true" tabindex="-1"></a>: Bedeutung der Formelschreibweise der zufälligen Effekte in einem linearen gemischten Modell in <span class="in">`{lmer}`</span> und <span class="in">`{glmmTMB}`</span>. Mehr zu der Bedeutung dann in der Veröffentlichung von @bates2014fitting. Glücklicherweise ist die Schreibweise mittlerweile in R bindend und alle neueren Pakete nutzen auch diese Formelschreibweise der zufälligen Effekte.</span>
<span id="cb130-743"><a href="#cb130-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-744"><a href="#cb130-744" aria-hidden="true" tabindex="-1"></a>Manchmal ist es etwas schwierig sich vorzustellen was die Formelschreiweise genau bedeutet. Daher habe ich nochmal die jeweilige Bedeutung visulaisiert. <span class="co">[</span><span class="ot">Die Quelle der Abbdilung ist das Openbook von Steve Midway</span><span class="co">](https://bookdown.org/steve_midway/DAR/random-effects.html)</span> und geht nochmal mit tollen Beispielen auf die verschiedenen Fälle ein.</span>
<span id="cb130-745"><a href="#cb130-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-748"><a href="#cb130-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-749"><a href="#cb130-749" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb130-750"><a href="#cb130-750" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb130-751"><a href="#cb130-751" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-752"><a href="#cb130-752" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-753"><a href="#cb130-753" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-anova-repeated-fac3</span></span>
<span id="cb130-754"><a href="#cb130-754" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-755"><a href="#cb130-755" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb130-756"><a href="#cb130-756" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9.5</span></span>
<span id="cb130-757"><a href="#cb130-757" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der verschiedenen Modelle eines linearen Modells und linearen gemischten Modellen mit Messweiderholungen mit drei Individuen. **(A)** Klassisches lineares Modell mit zwei Parametern für den y-Achsenabschnitt $\\alpha$ und der Steigung $\\beta$. **(B)** Gemischtes Modell mit einem festen y-Achsenabschnitt $\\alpha$ sowie variable Steigungen für die Individuen. **(C)** Ein gemischtes Modell mit variablen y-Achsenabschnitt $\\alpha$ sowie einer festen Steigung $\\beta$. **(D)** Ein gemischtes Modell mit einem variablen y-Achsenabschnitt $\\alpha$ sowie variabler Steigung $\\beta$ *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb130-758"><a href="#cb130-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-759"><a href="#cb130-759" aria-hidden="true" tabindex="-1"></a>p4 <span class="sc">+</span> p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span></span>
<span id="cb130-760"><a href="#cb130-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb130-761"><a href="#cb130-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb130-762"><a href="#cb130-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb130-763"><a href="#cb130-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-764"><a href="#cb130-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-765"><a href="#cb130-765" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mitteln über einen zufälligen Effekt</span></span>
<span id="cb130-766"><a href="#cb130-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-767"><a href="#cb130-767" aria-hidden="true" tabindex="-1"></a>Manchmal können wir das auch mit den gemischten Modellen einfach lassen und über eine Faktor mitteln und dann ist auch gut. Damit haben wir dann die individuelle Variabilität "weggemittelt". Das funktioniert in einem balancierten Design teilweise hervorragend und ist auf jeden Fall immer einen Versuch wert. Bei komplexeren Designs lässt sich manchmal dann leider nicht gut festlegen über welchen Faktor am besten gemittelt werden sollte. Dann hilft eben doch nur ein komplexeres gemischtes Modell. Haben wir aber über einen Faktor gemittelt, können wir alles nur mit festen Effekten in einem <span class="in">`lm()`</span> oder <span class="in">`glm()`</span> lösen. Das macht uns dann das Modellieren sehr viel einfacher. Deshalb hier einmal als Beispiel das Mitteln über die einzelnen Klassen und damit auch über die Schüler. Wir kriegen dann einen Mittelwert pro Klasse und nehmen damit die individuelle Varianz aus unseren Daten raus.</span>
<span id="cb130-768"><a href="#cb130-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-771"><a href="#cb130-771" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-772"><a href="#cb130-772" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-773"><a href="#cb130-773" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-774"><a href="#cb130-774" aria-hidden="true" tabindex="-1"></a>mean_school_tbl <span class="ot">&lt;-</span> school_tbl <span class="sc">|&gt;</span> </span>
<span id="cb130-775"><a href="#cb130-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(school_id, trt, class_id) <span class="sc">|&gt;</span> </span>
<span id="cb130-776"><a href="#cb130-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_test =</span> <span class="fu">mean</span>(test))</span>
<span id="cb130-777"><a href="#cb130-777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-778"><a href="#cb130-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-779"><a href="#cb130-779" aria-hidden="true" tabindex="-1"></a>Nachdem wir über den Faktor <span class="in">`class_id`</span> gemittelt haben, können wir dann einfach ein lineares Modell mit der Funktion <span class="in">`lm()`</span> rechnen. Dann schaue ich gleich nochmal im Abschnitt zu dem R Paket <span class="in">`lme4()`</span> wie gut unser Modell abschneidet. Wir werden vermutlich einen kleineren Fehler haben, da wir natürlich auch Variabilität wegmitteln. Aber das ist ja auch das Ziel der Übung.</span>
<span id="cb130-780"><a href="#cb130-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-783"><a href="#cb130-783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-784"><a href="#cb130-784" aria-hidden="true" tabindex="-1"></a>mean_lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(mean_test <span class="sc">~</span> trt <span class="sc">+</span> school_id <span class="sc">+</span> trt<span class="sc">:</span>school_id, <span class="at">data =</span> mean_school_tbl)</span>
<span id="cb130-785"><a href="#cb130-785" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-786"><a href="#cb130-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-787"><a href="#cb130-787" aria-hidden="true" tabindex="-1"></a>Ich kann immer nur empfehlen, einmal den Schritt zu machen und über die individuellen Pflanzen oder Beobachtungen zu mitteln. Häufig lässt sich damit dann ein gemischtes Modell vermeiden, was dann auch die Interpretation der Ergebnisse und deren Darstellung einfacher macht.</span>
<span id="cb130-788"><a href="#cb130-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-789"><a href="#cb130-789" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... mit dem R Paket `{lme4}`</span></span>
<span id="cb130-790"><a href="#cb130-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-791"><a href="#cb130-791" aria-hidden="true" tabindex="-1"></a>Das <span class="co">[</span><span class="ot">R Paket `{lme4}`</span><span class="co">](https://cran.r-project.org/web/packages/lme4/vignettes/lmer.pdf)</span> von @bates2014fitting ist das Standardpaket, welches uns erlaubt lineare gemischte Modelle in R anzuwenden. Hier gibt es dann auch mit der Hilfeseite <span class="co">[</span><span class="ot">GLMM FAQ -- Ben Bolker and others</span><span class="co">](https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#should-i-treat-factor-xxx-as-fixed-or-random)</span> auch umfangreiche Informationen und Ratschläge für die Nutzung. Auch hier musst du dort nicht alles nachlesen um ein lineares gemischtes Modell in R rechnen zu können. Manchmal kommt es aber zu Problemen im Fit des Modells, so dass hier dann Hilfe zu finden ist. Im Folgenden schauen wir uns einmal die Implementierung von <span class="in">`{lme4}`</span> für die Schuldaten an. Wir nutzen dazu die Hauptfunktion <span class="in">`lmer()`</span>, wenn wir normalverteilte Daten als Outcome vorliegen haben. Mit einem Testscore können wir davon ausgehen, dass dieser normalverteilt ist. Wir rechnen jetzt verschiedene Modelle in den folgenden Tabs und schauen dann im Anschluss einmal, welches der Modelle das beste Modell ist. Das beste Modell könnten wir dann zum Beispiel in einem Gruppenvergleich weiter nutzen.</span>
<span id="cb130-792"><a href="#cb130-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-793"><a href="#cb130-793" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb130-794"><a href="#cb130-794" aria-hidden="true" tabindex="-1"></a><span class="fu">## `lmer()` 2-faktoriell ungenested</span></span>
<span id="cb130-795"><a href="#cb130-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-796"><a href="#cb130-796" aria-hidden="true" tabindex="-1"></a>Beginnen wollen wir mit dem einfachsten linearen gemischten Modell. Wir haben hier nur einen festen Effekt <span class="in">`trt`</span> sowie einen zufälligen Effekt <span class="in">`school_id`</span> vorliegen. Damit ignorieren wir die Varianzen aus den Klassen. Wir schauen also, ob wir mit einem etwas simpleren Modell schon ein gutes Ergebnis erhalten.</span>
<span id="cb130-797"><a href="#cb130-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-800"><a href="#cb130-800" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-801"><a href="#cb130-801" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-802"><a href="#cb130-802" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-803"><a href="#cb130-803" aria-hidden="true" tabindex="-1"></a>lmer_2fac_fit <span class="ot">&lt;-</span> <span class="fu">lmer</span>(test <span class="sc">~</span> trt <span class="sc">+</span></span>
<span id="cb130-804"><a href="#cb130-804" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">|</span> school_id), </span>
<span id="cb130-805"><a href="#cb130-805" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> school_tbl)</span>
<span id="cb130-806"><a href="#cb130-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-807"><a href="#cb130-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-808"><a href="#cb130-808" aria-hidden="true" tabindex="-1"></a>Wie gut hat nun das Modell geklappt? Fangen wir einmal mit einem $R^2$ an. Ähnlich wie das Bestimmtheitsmaß $R^2$ gibt der *Intraclass Correlation Coefficient* (abk. *ICC*) Aufschluss über die erklärte Varianz und kann als "der Anteil der Varianz, der durch die Gruppierungsstruktur in den Daten erklärt wird" interpretiert werden. Damit haben wir dann auch eine Maßzahl, wie gut unser gemischtes Modell funktioniert hat. Uns interessiert hier nur das adjustierte ICC.</span>
<span id="cb130-809"><a href="#cb130-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-812"><a href="#cb130-812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-813"><a href="#cb130-813" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-814"><a href="#cb130-814" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-815"><a href="#cb130-815" aria-hidden="true" tabindex="-1"></a>lmer_2fac_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span>
<span id="cb130-816"><a href="#cb130-816" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-817"><a href="#cb130-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-818"><a href="#cb130-818" aria-hidden="true" tabindex="-1"></a>Das sieht gar nicht schlecht aus für einen ersten Versuch. Mit einem ICC von $0.88$ sind wir schon ziemlich weit oben an der Grenze. Jetzt müssen wir noch schauen, wie die anderen Maßzahlen aussehen. Eventuell reicht dieses einfache Modell schon aus um unsere Daten zu modellieren und zu erklären. Wir nutzen hier die Funktion <span class="co">[</span><span class="ot">`model_performance()` aus dem R Paket `{performance}`</span><span class="co">](https://easystats.github.io/performance/reference/model_performance.lm.html)</span> um zu schauen, wie gut unser Modell dann zu den Daten gepasst hat.</span>
<span id="cb130-819"><a href="#cb130-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-822"><a href="#cb130-822" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-823"><a href="#cb130-823" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-824"><a href="#cb130-824" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-825"><a href="#cb130-825" aria-hidden="true" tabindex="-1"></a>lmer_2fac_fit <span class="sc">|&gt;</span> <span class="fu">model_performance</span>()</span>
<span id="cb130-826"><a href="#cb130-826" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-827"><a href="#cb130-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-828"><a href="#cb130-828" aria-hidden="true" tabindex="-1"></a>Hier schauen wir einmal auf das <span class="in">`R2 (marg.)`</span>, was auch eine andere Art des Bestimmtheitsmaßes für die festen Effekte ist. Also auch hier jetzt die Frage, wieviel Prozent der Varianz erklären meine festen Effekte? Hier liefert dann das <span class="in">`R2 (marg.)`</span> eine Antwort. Das <span class="in">`R2 (cond.)`</span> berücksichtigt sowohl die festen als auch die zufälligen Effekte bei der Berechnung des $R^2$. Damit haben wir hier die erklärte Varianz von festen und zufälligen Effekten bei $0.97$, also über $97\%$. Hier haben wir ein echt gutes Modell vorliegen. Die anderen Maßzahlen brauchen wir nur für einen direkten Vergleich von Modellen.</span>
<span id="cb130-829"><a href="#cb130-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-830"><a href="#cb130-830" aria-hidden="true" tabindex="-1"></a><span class="fu">## `lmer()` 3-faktoriell ungenested</span></span>
<span id="cb130-831"><a href="#cb130-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-832"><a href="#cb130-832" aria-hidden="true" tabindex="-1"></a>Nachdem wir schon recht gute Ergebnisse mit dem simplen gemischten Modell mit nur einem zufälligen Effekt erreicht haben, nehmen wir jetzt noch neben dem Effekt der Schule den Effekt der Klassen <span class="in">`class_in_school_id`</span> als zufälligen Effekt mit ins Modell. Dann wollen wir mal schauen, ob dieses Modell dann besser ist als das einfache Modell. Unser einfaches Modell ist schon so gut, dass wir hier kaum noch Steigerungen hinkriegen und wir müssen uns dann am Ende fragen, ob nicht ein einfacheres Modell nicht auch reichen würde.</span>
<span id="cb130-833"><a href="#cb130-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-836"><a href="#cb130-836" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-837"><a href="#cb130-837" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-838"><a href="#cb130-838" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-839"><a href="#cb130-839" aria-hidden="true" tabindex="-1"></a>lmer_3fac_fit <span class="ot">&lt;-</span> <span class="fu">lmer</span>(test <span class="sc">~</span> trt <span class="sc">+</span></span>
<span id="cb130-840"><a href="#cb130-840" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">|</span> class_in_school_id) <span class="sc">+</span> </span>
<span id="cb130-841"><a href="#cb130-841" aria-hidden="true" tabindex="-1"></a>                        (<span class="dv">1</span> <span class="sc">|</span> school_id), </span>
<span id="cb130-842"><a href="#cb130-842" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> school_tbl)</span>
<span id="cb130-843"><a href="#cb130-843" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-844"><a href="#cb130-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-845"><a href="#cb130-845" aria-hidden="true" tabindex="-1"></a>Auch hier berechnen wir dann einmal den *Intraclass Correlation Coefficient* (abk. *ICC*) um mehr über die erklärte Varianz der zufälligen Effekte zu erfahren. Der ICC steigt noch um einen winzigen Betrag gegenüber dem simpleren Modell mit nur einem zufälligen Effekt. Ob sicher hier der Umstieg lohnt, muss man dann nochmal überlegen.</span>
<span id="cb130-846"><a href="#cb130-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-849"><a href="#cb130-849" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-850"><a href="#cb130-850" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-851"><a href="#cb130-851" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-852"><a href="#cb130-852" aria-hidden="true" tabindex="-1"></a>lmer_3fac_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span>
<span id="cb130-853"><a href="#cb130-853" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-854"><a href="#cb130-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-855"><a href="#cb130-855" aria-hidden="true" tabindex="-1"></a>Dann schauen wir uns nochmal die Werte für <span class="in">`R2 (cond.)`</span> und <span class="in">`R2 (marg.)`</span> an und sehen, dass wir hier auch nur eine kleine Steigerung in den Werten haben. Wir erklären zwar noch mehr Varianz, aber der Anteil ist doch recht gering.</span>
<span id="cb130-856"><a href="#cb130-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-859"><a href="#cb130-859" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-860"><a href="#cb130-860" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-861"><a href="#cb130-861" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-862"><a href="#cb130-862" aria-hidden="true" tabindex="-1"></a>lmer_3fac_fit <span class="sc">|&gt;</span> <span class="fu">model_performance</span>()</span>
<span id="cb130-863"><a href="#cb130-863" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-864"><a href="#cb130-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-865"><a href="#cb130-865" aria-hidden="true" tabindex="-1"></a>Am Ende musst du dann überlegen, ob sich hier noch eine weitere Modellierung lohnt. Wir kommen zwar noch höher mit den Werten für das Bestimmtheitsmaß, aber dann wird auch das Modell auch um einiges komplizierter. Daher kannst du dir als letztes noch das genestete Modell einmal anschauen.</span>
<span id="cb130-866"><a href="#cb130-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-867"><a href="#cb130-867" aria-hidden="true" tabindex="-1"></a><span class="fu">## `lmer()` 3-faktoriell genested</span></span>
<span id="cb130-868"><a href="#cb130-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-869"><a href="#cb130-869" aria-hidden="true" tabindex="-1"></a>Jetzt bleibt uns eigentlich nur noch als Modell ein genestetes gemischtes Modell übrig indem wir dann die Klassen in den Schulen genestet modellieren. Das entspricht dann natürlich exakt der Abhängigkeitsstruktur, wie wir auch unsere Daten gebaut haben. Also sollten wir mit dem folgenden Modell auch fast die gesamte Varianz erklären. Im echten Leben kennen wir natürlich nicht die Art und Weise wie die Daten entstanden sind. Deshalb hier als Demonstration das Modell mit einem genesteten, zufälligen Term für die Klassen in den Schulen dargestellt durch <span class="in">`(1 | class_id/school_id)`</span>.</span>
<span id="cb130-870"><a href="#cb130-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-873"><a href="#cb130-873" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-874"><a href="#cb130-874" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-875"><a href="#cb130-875" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-876"><a href="#cb130-876" aria-hidden="true" tabindex="-1"></a>lmer_3fac_nested_fit <span class="ot">&lt;-</span> <span class="fu">lmer</span>(test <span class="sc">~</span> trt <span class="sc">+</span>  </span>
<span id="cb130-877"><a href="#cb130-877" aria-hidden="true" tabindex="-1"></a>                               (<span class="dv">1</span> <span class="sc">|</span> class_id<span class="sc">/</span>school_id), </span>
<span id="cb130-878"><a href="#cb130-878" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> school_tbl)</span>
<span id="cb130-879"><a href="#cb130-879" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-880"><a href="#cb130-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-881"><a href="#cb130-881" aria-hidden="true" tabindex="-1"></a>Auch heir schauen wir dann einmal den *Intraclass Correlation Coefficient* (abk. *ICC*) an und sehen, dass der Wert fast Eins ist. Das wundert uns natürlich nicht.</span>
<span id="cb130-882"><a href="#cb130-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-885"><a href="#cb130-885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-886"><a href="#cb130-886" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-887"><a href="#cb130-887" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-888"><a href="#cb130-888" aria-hidden="true" tabindex="-1"></a>lmer_3fac_nested_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span>
<span id="cb130-889"><a href="#cb130-889" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-890"><a href="#cb130-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-891"><a href="#cb130-891" aria-hidden="true" tabindex="-1"></a>Und dann sehen wir auch, dass wir mit unseren Modell mit den genesteten zufälligen Effekten ein <span class="in">`R2 (cond.)`</span> von über $99\%$ erreichen. Damit bildet unser genestetes Modell exakt die Abhängigkeitsstruktur wieder, mit der wir auch die Daten gebaut haben.</span>
<span id="cb130-892"><a href="#cb130-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-895"><a href="#cb130-895" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-896"><a href="#cb130-896" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-897"><a href="#cb130-897" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-898"><a href="#cb130-898" aria-hidden="true" tabindex="-1"></a>lmer_3fac_nested_fit <span class="sc">|&gt;</span> <span class="fu">model_performance</span>()</span>
<span id="cb130-899"><a href="#cb130-899" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-900"><a href="#cb130-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-901"><a href="#cb130-901" aria-hidden="true" tabindex="-1"></a>Damit habe ich gezeigt, dass wir auch ein perfektes Modell erhalten können, wenn wir wissen wie die Daten erschaffen wurden. Unsere anderen Modelle sind noch so gut, da ich ein sehr balanciertes Design für die Erstellung der Schuldaten gewählt habe. Wenn die Klassen unterschiedliche groß wären und auch unterschiedliche Anzahlen von Klassen pro Schule vorliegen würden, dann sehen die anderen Modelle bedeutend schlechter aus.</span>
<span id="cb130-902"><a href="#cb130-902" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-903"><a href="#cb130-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-904"><a href="#cb130-904" aria-hidden="true" tabindex="-1"></a>Manchmal möchten wir dann doch noch mehr Informationen als den *Intraclass Correlation Coefficient* (abk. *ICC*) oder das <span class="in">`R2 (cond.)`</span> oder das <span class="in">`R2 (marg.)`</span> aus dem linearen gemischten Modell extrahieren. Da mir das aber dann aktuell zu weit geht und hier auch nicht mehr erklärt, verweise ich auf die folgenden Funktionen aus dem R Paket <span class="in">`{mixedup}`</span>. Du erhälst mit den Funktionen die Effekte für die zufälligen wie auch festen Effekte und das auch übergreifend für andere Pakte. Manchmal ist auch die Funktion <span class="in">`summary()`</span> sehr klobig für ein <span class="in">`lmer()`</span>-Objekt, da hilft dann die Funktion <span class="in">`summarize_model()`</span>. In seltenen Fällen bist du dann auch an der Varianzstruktur und deren Schätzern interessiert, dafür gibt es dann auch noch die Funktion <span class="in">`extract_vc()`</span>. Ich führe die Funktionen hier jetzt nicht aus, da wir einfach nur Output produzieren.</span>
<span id="cb130-905"><a href="#cb130-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-908"><a href="#cb130-908" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-909"><a href="#cb130-909" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-910"><a href="#cb130-910" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-911"><a href="#cb130-911" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb130-912"><a href="#cb130-912" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_random_effects</span>(lmer_2fac_fit)</span>
<span id="cb130-913"><a href="#cb130-913" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_fixed_effects</span>(lmer_2fac_fit)</span>
<span id="cb130-914"><a href="#cb130-914" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize_model</span>(lmer_2fac_fit)</span>
<span id="cb130-915"><a href="#cb130-915" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_vc</span>(lmer_2fac_fit)</span>
<span id="cb130-916"><a href="#cb130-916" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-917"><a href="#cb130-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-918"><a href="#cb130-918" aria-hidden="true" tabindex="-1"></a>Wir schauen uns dann einmal in einer Übersichtstabelle die drei Modelle an. Im folgenden Kasten findest du den Modellvergleich mit dem R Paket <span class="in">`{modelsummary}`</span>. Wir können hier verschiedenste Sachen anschauen. Wichtig ist zum Beispiel ganz am Ende der $RMSE$. Je kleiner der *root mean square error* ist, desto besser ist das Modell. Hier sehen wir, dass wir das beste Modell mit <span class="in">`lmer_3fac_nested_fit`</span> vorliegen haben. Der $RSME$ ist mit 1.97 am kleinsten. Danach kommt aber schon das simple lineare Modell mit nur den festen Effekten. Da das <span class="in">`lm`</span>-Modell auch fast $96.5\%$ der Varianz erklärt können wir auch das <span class="in">`lm`</span>-Modell hier nehmen und haben dann ein einfacheres Modell, was wir dann auch einfacher beschreiben können. Da musst du dann abwägen, aber es muss ja nicht immer komplex sein. Ein gutes, solides Modell reicht ja auch.</span>
<span id="cb130-919"><a href="#cb130-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-920"><a href="#cb130-920" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb130-921"><a href="#cb130-921" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modellvergleich mit `modelsummary()`</span></span>
<span id="cb130-922"><a href="#cb130-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-925"><a href="#cb130-925" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-926"><a href="#cb130-926" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-927"><a href="#cb130-927" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-928"><a href="#cb130-928" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"lm (mean model)"</span> <span class="ot">=</span> mean_lm_fit, </span>
<span id="cb130-929"><a href="#cb130-929" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"lmer 2-fakoriell"</span> <span class="ot">=</span> lmer_2fac_fit, </span>
<span id="cb130-930"><a href="#cb130-930" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"lmer 3-fakoriell genested"</span> <span class="ot">=</span> lmer_3fac_nested_fit,</span>
<span id="cb130-931"><a href="#cb130-931" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"lmer 3-fakoriell ungenested"</span> <span class="ot">=</span> lmer_3fac_fit),</span>
<span id="cb130-932"><a href="#cb130-932" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"conf.int"</span>,</span>
<span id="cb130-933"><a href="#cb130-933" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"s.e. = {std.error}"</span>))</span>
<span id="cb130-934"><a href="#cb130-934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-935"><a href="#cb130-935" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-936"><a href="#cb130-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-937"><a href="#cb130-937" aria-hidden="true" tabindex="-1"></a>Und dann nochmal die visuelle Überprüfung mit <span class="in">`check_model()`</span>. Hier schauen wir einmal, ob unser lineares gemischtes Modell dann auch funktioniert hat. Das praktische an der Funktion ist, dass wir in den Überschriften zu den einzelnen Abbildungen immer lesen könne, was wir in den Abbildungen sehen müssen, wenn die Annahme erfüllt sein soll. Wir haben hier also eine wunderbare visuelle Überprüfung des Modells. Ich mache das ganze jetzt nur für das Modell <span class="in">`lmer_2fac_fit`</span>, was etwas willkürlich ist, aber sonst haben wir hier zig Abbildungen. Du kannst dann ja einfach selber bei den anderen Modellen schauen.</span>
<span id="cb130-938"><a href="#cb130-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-939"><a href="#cb130-939" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb130-940"><a href="#cb130-940" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modellüberprüfung mit `check_model()`</span></span>
<span id="cb130-941"><a href="#cb130-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-944"><a href="#cb130-944" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-945"><a href="#cb130-945" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-946"><a href="#cb130-946" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-947"><a href="#cb130-947" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-948"><a href="#cb130-948" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-949"><a href="#cb130-949" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 16</span></span>
<span id="cb130-950"><a href="#cb130-950" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb130-951"><a href="#cb130-951" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Überprüfung des Modells mit der Funktion `check_model()` aus dem R Paket `{performance}`. Eine Reihe von Annahmen an das Modell wird in verschiedenen Abbildungen visuell überprüft. Unter den Überschriften steht die Annahme an die Abbildung und wann die Annahme in der Überschrift als erfüllt gilt."</span></span>
<span id="cb130-952"><a href="#cb130-952" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mixed-school-model-check</span></span>
<span id="cb130-953"><a href="#cb130-953" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(lmer_2fac_fit)</span>
<span id="cb130-954"><a href="#cb130-954" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-955"><a href="#cb130-955" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-956"><a href="#cb130-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-957"><a href="#cb130-957" aria-hidden="true" tabindex="-1"></a>Bei den Schuldaten sind wir von einem normalverteilten Outcome <span class="in">`testscore`</span> ausgegangen. Das R Paket <span class="in">`{lme4}`</span> hat auch die Möglichkeit mit nicht normalverteilten Daten über die Funktion <span class="in">`glmer()`</span> umzugehen. Da schauen wir aber gleich mal rein und zwar bei den Würmerdaten und stellen dabei auch das R Paket <span class="in">`{glmmTMB}`</span> als Alternative vor. Du könnest aber den folgenden Abschnitt auch einfach mit einem <span class="in">`glmer()`</span> rechnen aus dem Paket <span class="in">`{lme4}`</span> rechnen, aber das R Paket <span class="in">`{glmmTMB}`</span> hat ein paar Vorteile bei der Modellierung von nicht-normalverteilten Daten.</span>
<span id="cb130-958"><a href="#cb130-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-959"><a href="#cb130-959" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... mit dem R Paket `{glmmTB}`</span></span>
<span id="cb130-960"><a href="#cb130-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-961"><a href="#cb130-961" aria-hidden="true" tabindex="-1"></a>Hier schauen wir uns einmal den Datensatz zu den Würmern an. Wir haben hier kein normalverteiltes Outcome mehr vorliegen sondern zählen ja die Würmer. Wenn wir Zähldaten vorliegen haben, dann nutzen wir die Poissonverteilung um die Daten auszuwerten. Dazu müssen wir dann aber die Funktion <span class="in">`glmer()`</span> verwenden, welche uns erlaubt auch eine andere Verteilung für das Outcome zu nutzen. Die Funktion <span class="in">`glmer()`</span> ist in dem R Paket <span class="in">`{lme4}`</span> implementiert und funktioniert nur, wenn du keine Overdispersion in den Daten vorliegen hast. Overdispersion bedeutet, dass die Varianz mit dem Mittelwert überproportional ansteigt. In einer Poissonverteilung steigt die Varianz der Daten mit dem Mittelwert der Zähldaten in einem 1:1 Verhältnis an. Wenn du ein größeres Verhältnis hast, also mit steigenden Mittelwert proportional größere Varianzen, dann liegt Overdispersion vor. Dafür haben wir dann gleich die Funktion <span class="in">`check_overdispersion()`</span>. Wichtig ist, dass du keine Poissonregression rechnen kannst, wenn du Overdispersion vorliegen hast. Dann musst du deine Poissonregression für die Overdispersion adjustieren indem du eine andere Verteilungsfamilie wählst. Leider sind in <span class="in">`{lme4}`</span> keine anderen Poissonfamilien implementiert, so dass wir dann auf das <span class="co">[</span><span class="ot">R Paket `{glmmTMB}`</span><span class="co">](https://glmmtmb.github.io/glmmTMB/index.html)</span> ausweichen. In dem R Paket <span class="in">`{glmmTMB}`</span> gibt es eine reichhaltige Auswahl an Kovarianzstrukturen und Möglichkeiten Abhängigkeiten zu modellieren. Mehr dazu findest du auf der Hilfeseite zu <span class="co">[</span><span class="ot">Covariance structures with glmmTMB</span><span class="co">](https://cran.r-project.org/web/packages/glmmTMB/vignettes/covstruct.html)</span> und auf der Seite zu <span class="co">[</span><span class="ot">glmmTMB: Generalized Linear Mixed Models using Template Model Builder</span><span class="co">](https://cran.r-project.org/web/packages/glmmTMB/)</span>. Auf der letzteren Seite findest du dann auch die Vignetten mit den jeweiligen Hilfsthemen. Leider kann <span class="in">`{glmmTB}`</span> auch nicht alles modellieren, wenn es um die möglichen Fehler*quellen* geht und auch hier verweise ich einmal auf eine Hilfeseite zu <span class="co">[</span><span class="ot">Covariance structures for the error term with glmmTMB - a workaround</span><span class="co">](https://schmidtpaul.github.io/MMFAIR/glmmtmbdispformula0.html)</span>. Wie immer du musst das nicht alles lesen. Es ist auch eine Sammlung an Hilfen hier für den Fall, dass es mal jemand braucht.</span>
<span id="cb130-962"><a href="#cb130-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-963"><a href="#cb130-963" aria-hidden="true" tabindex="-1"></a>In den beiden folgenden Tabs wollen wir dann einmal verschiedene Varianten durchprobieren. Zuerst rechnen wir das naive fixe Effekt Modell mit einem <span class="in">`glm()`</span> und einer Quasipoissonverteilung. Dann probieren wir ein gemischtes Modell mit <span class="in">`glmer()`</span> und einer Poissonfamilie und schauen, ob wir Overdispersion vorliegen haben. Parallel dazu rechnen wir dann in dem anderen Tab die Poissonregression unter der Annahme von Overdispersion mit <span class="in">`glmmTMB()`</span> und der Option <span class="in">`famliy = nbinom1`</span>, was faktisch einer Quasipoissonverteilung entspricht.</span>
<span id="cb130-964"><a href="#cb130-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-965"><a href="#cb130-965" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb130-966"><a href="#cb130-966" aria-hidden="true" tabindex="-1"></a><span class="fu">## `glm` mit `family = quasipoisson`</span></span>
<span id="cb130-967"><a href="#cb130-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-968"><a href="#cb130-968" aria-hidden="true" tabindex="-1"></a>Dieser Tab ist sehr kurz. Wir rechnen einfach eine Poissonregression unter der Annahme von Overdispersion. Deshalb nutzen wir hier auch gleich eine Quasipoissonverteilung, die es uns erlaubt für das Auftreten von einer Overdispersion zu adjustieren. Mehr zu der einfachen Poissonregression gibt es dann in dem <span class="co">[</span><span class="ot">Kapitel Poissonregression</span><span class="co">](#sec-poisson)</span>. Dort kannst du dann auch noch mehr zum Thema Poissonregression nachlesen. Wir rechnen also eine Poissonregression und nutzen dafür ein <span class="in">`glm()`</span> und die Option <span class="in">`family = "quasipoisson"`</span>. Wir nehmen dabei als Effekte die Behandlung <span class="in">`trt`</span> sowie die Positionen <span class="in">`row`</span> und <span class="in">`col`</span> mit in das Modell. Ich verzichte auf Interaktionen, da das Modell schon so recht groß ist.</span>
<span id="cb130-969"><a href="#cb130-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-972"><a href="#cb130-972" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-973"><a href="#cb130-973" aria-hidden="true" tabindex="-1"></a>glm_quasipoisson_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(count_worms <span class="sc">~</span> trt <span class="sc">+</span> row <span class="sc">+</span> col, </span>
<span id="cb130-974"><a href="#cb130-974" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> wireworms_tbl, <span class="at">family =</span> <span class="st">"quasipoisson"</span>)</span>
<span id="cb130-975"><a href="#cb130-975" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-976"><a href="#cb130-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-977"><a href="#cb130-977" aria-hidden="true" tabindex="-1"></a>Das Bestimmtheitsmaß $R^2$ ist in einem <span class="in">`glm`</span>-Modell nicht so einfach. Deshalb nutzen wir folgende Funktion um uns sowas ähnliches wiedergeben zu lassen. Wir interpretieren aber das $R^2$ ganz gewohnt als den Anteil der erklärten Varianz in dem Outcome durch das Modell.</span>
<span id="cb130-978"><a href="#cb130-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-981"><a href="#cb130-981" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-982"><a href="#cb130-982" aria-hidden="true" tabindex="-1"></a><span class="fu">r2_efron</span>(glm_quasipoisson_fit)</span>
<span id="cb130-983"><a href="#cb130-983" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-984"><a href="#cb130-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-985"><a href="#cb130-985" aria-hidden="true" tabindex="-1"></a>Dieses Modell nehmen wir dann als simple Alternative mit in den Vergleich zu den anderen gemischten Modellen. Manchmal reicht auch ein einfaches Modell und es muss nicht immer ein komplexes Modell sein.</span>
<span id="cb130-986"><a href="#cb130-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-987"><a href="#cb130-987" aria-hidden="true" tabindex="-1"></a><span class="fu">## `glmer()` mit `family = poisson`</span></span>
<span id="cb130-988"><a href="#cb130-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-989"><a href="#cb130-989" aria-hidden="true" tabindex="-1"></a>Jetzt aber einmal ein lineares gemischtes Modell mit der Poissonfamilie für die Auswertung der Zähldaten. Daher haben wir dann einen fixen Effekt für die Behandlung <span class="in">`trt`</span> sowie die beiden zufälligen Effekte für die Positionen der Parzellen mit <span class="in">`(1 | row)`</span> und <span class="in">`(1 | col)`</span>. Dann wählen wir noch die Poissonfamilie aus und können das Modell einmal rechnen.</span>
<span id="cb130-990"><a href="#cb130-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-993"><a href="#cb130-993" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-994"><a href="#cb130-994" aria-hidden="true" tabindex="-1"></a>glmer_poisson_fit <span class="ot">&lt;-</span> <span class="fu">glmer</span>(count_worms <span class="sc">~</span> trt <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>row) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>col), </span>
<span id="cb130-995"><a href="#cb130-995" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> wireworms_tbl, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb130-996"><a href="#cb130-996" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-997"><a href="#cb130-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-998"><a href="#cb130-998" aria-hidden="true" tabindex="-1"></a>Bevor wir überhaupt etwas machen, schauen wir erstmal ob Overdispersion in unseren Daten vorliegt. Wenn unser Modell Overdispersion anzeigt, dann können wir das Modell gleich lassen. Das ist sehr wichtig zu wissen, ein Modell mit einer Poissonfamilie und Overdispersion wird dir immer falsche Ergebnisse liefern. Insbesondere wenn es dir um die Gruppenvergleiche geht. Die Nichtberücksichtigung der Overdispersion lässt deine Fehler zu klein werden und damit findest du zu viele falsche signifikante Ergebnisse.</span>
<span id="cb130-999"><a href="#cb130-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1002"><a href="#cb130-1002" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1003"><a href="#cb130-1003" aria-hidden="true" tabindex="-1"></a>glmer_poisson_fit  <span class="sc">|&gt;</span> <span class="fu">check_overdispersion</span>()</span>
<span id="cb130-1004"><a href="#cb130-1004" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1005"><a href="#cb130-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1006"><a href="#cb130-1006" aria-hidden="true" tabindex="-1"></a>Wir haben sehr starke Overdispersion vorliegen und gehen daher in den anderen Tab und rechnen eine Quasipoisson Regression in einem linearen gemischten Modell. Hier nutzen wir dann das R Paket <span class="in">`{glmmTMB}`</span>. Nur wenn du keine Overdispersion vorliegen hast, dann kannst du eine eine reine Poissonregression rechnen.</span>
<span id="cb130-1007"><a href="#cb130-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1008"><a href="#cb130-1008" aria-hidden="true" tabindex="-1"></a><span class="fu">## `glmmTMB()` mit `family = nbinom1`</span></span>
<span id="cb130-1009"><a href="#cb130-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1010"><a href="#cb130-1010" aria-hidden="true" tabindex="-1"></a>Da wir in <span class="in">`{lme4}`</span> keine Quasipoissonverteilung auswählen können, nutzen wir das <span class="co">[</span><span class="ot">R Paket `{glmmTMB}`</span><span class="co">](https://glmmtmb.github.io/glmmTMB/index.html)</span> mit der Verteilungsfamilie <span class="in">`nbinom1`</span>, was einer Parametrisierung einer Quasipoissonverteilung entspricht. Mehr dazu dann auch auf der Hilfeseite zu <span class="co">[</span><span class="ot">Covariance structures with glmmTMB</span><span class="co">](https://cran.r-project.org/web/packages/glmmTMB/vignettes/covstruct.html)</span>. Eigentlich spricht nichts dagegen gleich das R Paket <span class="in">`{glmmTMB}`</span> zu nutzen, wenn du mit nicht normalverteilten Outcomes arbeitest. Auch bei einem normalverteilten Outcome liefert dir <span class="in">`{glmmTMB}`</span> auch $p$-Werte aus einer ANOVA. Es macht also doch Sinn sich mal andere Pakete anzuschauen.</span>
<span id="cb130-1011"><a href="#cb130-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1012"><a href="#cb130-1012" aria-hidden="true" tabindex="-1"></a>Um das Modell zu rechnen nutzen wir die Funktion <span class="in">`glmmTMB()`</span> und der Rest bleibt glücklicherweise gleich. Wir ändern hier nur die Option <span class="in">`family = nbinom1`</span> und können dann einmal das Modell rechnen. Und ja, es gebe noch andere Möglichkeiten, aber wir bleiben hier mal bei einer. Am Ende kannst du dann auch verschiedene Familien durch testen und schauen, wo du den kleinsten Fehler am Ende erhälst. Dafür bietet sich ja das Paket <span class="in">`{modelsummary}`</span> gerade an.</span>
<span id="cb130-1013"><a href="#cb130-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1016"><a href="#cb130-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1017"><a href="#cb130-1017" aria-hidden="true" tabindex="-1"></a>glmmTMB_nbinom1_fit <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(count_worms <span class="sc">~</span> trt <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>row) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>col), </span>
<span id="cb130-1018"><a href="#cb130-1018" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> wireworms_tbl, <span class="at">family =</span> nbinom1) </span>
<span id="cb130-1019"><a href="#cb130-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1020"><a href="#cb130-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1021"><a href="#cb130-1021" aria-hidden="true" tabindex="-1"></a>Auch hier können wir einmal den *Intraclass Correlation Coefficient* (abk. *ICC*) schätzen und sehen, dass nicht viel Varianz durch unser Modell erklärt wird. Das ist etwas bedauerlich, aber manchmal kann man nicht mehr aus den Daten herausholen.</span>
<span id="cb130-1022"><a href="#cb130-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1025"><a href="#cb130-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1026"><a href="#cb130-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1027"><a href="#cb130-1027" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1028"><a href="#cb130-1028" aria-hidden="true" tabindex="-1"></a>glmmTMB_nbinom1_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span>
<span id="cb130-1029"><a href="#cb130-1029" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1030"><a href="#cb130-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1031"><a href="#cb130-1031" aria-hidden="true" tabindex="-1"></a>Dann schauen wir nochmal in das Bestimmtheitsmaß $R^2$ und sehen, dass wir auch hier eher bescheidene Werte erhalten. Wir können mit den festen und zufälligen Effekten zusammen nur $66.9\%$ der Varianz in den Wurmanzahlen erklären. Das ist auch hier kein guter Wert, aber wie immer besser als gar nichts.</span>
<span id="cb130-1032"><a href="#cb130-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1035"><a href="#cb130-1035" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1036"><a href="#cb130-1036" aria-hidden="true" tabindex="-1"></a>glmmTMB_nbinom1_fit <span class="sc">|&gt;</span> <span class="fu">r2</span>()</span>
<span id="cb130-1037"><a href="#cb130-1037" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1038"><a href="#cb130-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1039"><a href="#cb130-1039" aria-hidden="true" tabindex="-1"></a>Wir nehmen dann auch das Modell hier mit in den Vergleich und schauen einmal welches Modell das beste Modell ist. Wie immer kann ein komplexeres Modell zwar besser sein, aber am Ende wollen wir dann doch eher ein einfaches Modell haben.</span>
<span id="cb130-1040"><a href="#cb130-1040" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-1041"><a href="#cb130-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1042"><a href="#cb130-1042" aria-hidden="true" tabindex="-1"></a>Dann wollen wir uns mal die drei Modelle anschauen und entscheiden, welches der drei Modelle das beste Modell ist. Wir wissen aber schon, dass wir Overdispersion in den Daten vorliegen haben und deshalb keine einfache Poissonregression rechnen dürfen. Daher fällt das <span class="in">`glmer()`</span>-Modell mit der Poissonfamilie aus der Betrachtung. Dann bleibt nur noch das reine fixe Effekt Modell in <span class="in">`glm()`</span> oder eben das gemischte Modell aus <span class="in">`glmmTMB()`</span> mit einer Quasipoissonverteilung übrig. Im folgenden Kasten findest du den Modellvergleich mit dem R Paket <span class="in">`{modelsummary}`</span>. Leider liefert die Funktion <span class="in">`glm()`</span> keine Bestimmtheitsmaße $R^2$ für unser Modell, aber da haben wir ja oben händisch den Wert von $R^2 = 0.53$ berechnet. Von den reinen Werten her, wäre sogar das <span class="in">`glmer()`</span> das beste Modell, aber die statistischen Gütezahlen gelten nur, wenn es eben die Annahmen an das Modell auch passen. Und die Grundannahme an das <span class="in">`glmer()`</span>-Modell ist eben, dass mit einer Poissonverteilung keine Overdispersion vorliegt. Somit ist dann tatsächlich unser <span class="in">`glmmTMB()`</span>-Modell das Beste. Der <span class="in">`RMSE`</span> ist klein, wie bei den anderen Modellen, und darüber hinaus haben wir dann noch relativ hohe Werte für das Bestimmtheitsmaße $R^2$.</span>
<span id="cb130-1043"><a href="#cb130-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1044"><a href="#cb130-1044" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb130-1045"><a href="#cb130-1045" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modellvergleich mit `modelsummary()`</span></span>
<span id="cb130-1046"><a href="#cb130-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1049"><a href="#cb130-1049" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1050"><a href="#cb130-1050" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1051"><a href="#cb130-1051" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1052"><a href="#cb130-1052" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"glm quasipoisson"</span> <span class="ot">=</span> glm_quasipoisson_fit,</span>
<span id="cb130-1053"><a href="#cb130-1053" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"glmer poisson"</span> <span class="ot">=</span> glmer_poisson_fit, </span>
<span id="cb130-1054"><a href="#cb130-1054" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"glmmTMB nbinom1"</span> <span class="ot">=</span> glmmTMB_nbinom1_fit),</span>
<span id="cb130-1055"><a href="#cb130-1055" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"conf.int"</span>,</span>
<span id="cb130-1056"><a href="#cb130-1056" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"s.e. = {std.error}"</span>))</span>
<span id="cb130-1057"><a href="#cb130-1057" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1058"><a href="#cb130-1058" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-1059"><a href="#cb130-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1060"><a href="#cb130-1060" aria-hidden="true" tabindex="-1"></a>Abschließend überprüfen wir in der @fig-mixed-school-model-check-pois nochmal, ob auch alle Annahmen an das Modell stimmen. Hierzu nutzen wir dann wieder eine visuelle Überprüfung mit der Funktion <span class="in">`check_model()`</span>. Das Modell sieht einigermaßen okay aus. Die visuelle Überprüfung der Overdispersion ist nicht so super, aber wir sehen ja auch in der obigen Analyse, dass wir eigentlich keine Overdisperion mehr in den Daten vorliegen haben. Bei nicht normalverteilten Outcomes ist die Einschätzung der Modellgüte manchmal etwas schwierig. Aber wir hier bei dem <span class="in">`glmmTMB()`</span>-Modell, es ist das beste was wir haben. Mehr geben dann die Daten einfach nicht her.</span>
<span id="cb130-1061"><a href="#cb130-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1062"><a href="#cb130-1062" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb130-1063"><a href="#cb130-1063" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modellüberprüfung mit `check_model()`</span></span>
<span id="cb130-1064"><a href="#cb130-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1067"><a href="#cb130-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1068"><a href="#cb130-1068" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1069"><a href="#cb130-1069" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1070"><a href="#cb130-1070" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-1071"><a href="#cb130-1071" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-1072"><a href="#cb130-1072" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 16</span></span>
<span id="cb130-1073"><a href="#cb130-1073" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb130-1074"><a href="#cb130-1074" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Überprüfung des Modells mit der Funktion `check_model()` aus dem R Paket `{performance}`. Eine Reihe von Annahmen an das Modell wird in verschiedenen Abbildungen visuell überprüft. Unter den Überschriften steht die Annahme an die Abbildung und wann die Annahme in der Überschrift als erfüllt gilt."</span></span>
<span id="cb130-1075"><a href="#cb130-1075" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mixed-school-model-check-pois</span></span>
<span id="cb130-1076"><a href="#cb130-1076" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(glmmTMB_nbinom1_fit)</span>
<span id="cb130-1077"><a href="#cb130-1077" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1078"><a href="#cb130-1078" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-1079"><a href="#cb130-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1080"><a href="#cb130-1080" aria-hidden="true" tabindex="-1"></a><span class="fu">### ... mit dem R Paket `{multilevelmod}`</span></span>
<span id="cb130-1081"><a href="#cb130-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1082"><a href="#cb130-1082" aria-hidden="true" tabindex="-1"></a>Das R Paket <span class="in">`{parsnip}`</span> erlaubt verschiedene Modellierungen sehr schon zu vereinheitlichen. Wir nutzen die Idee auch sehr in den Kapitel zur Klassifikation. Hier stelle ich einmal das <span class="co">[</span><span class="ot">R Paket `{parsnip}` mit dem Fokus auf die lineare Regression</span><span class="co">](https://parsnip.tidymodels.org/reference/linear_reg.html)</span> vor. Leider ist <span class="in">`{glmmTMB}`</span> nicht in dem Paket eingebaut, so dass wir hier wieder extra analysieren müssen. Aber gut, man kann nicht alles haben. Um den folgenden Prozess einmal durchlaufen zu lassen, brauchen wir noch das <span class="co">[</span><span class="ot">R Paket `{multilevelmod}`</span><span class="co">](https://multilevelmod.tidymodels.org/articles/multilevelmod.html)</span>, welches uns erlaubt in <span class="in">`{parsnip}`</span> dann auch lineare gemischte Modelle anzuwenden.</span>
<span id="cb130-1083"><a href="#cb130-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1084"><a href="#cb130-1084" aria-hidden="true" tabindex="-1"></a>Im Folgenden einmal als Beispiel die Weizendaten <span class="in">`oats_tbl`</span>, die wir dann auch gleich nochmal in dem Gruppenvergleich nutzen. Hier als erstmal zwei lineare Regression. Wir rechnen jetzt einmal ein lineares gemischtes Modell und nutzen dafür die Funktion <span class="in">`set_engine("lmer")`</span>. Danach rechnen wir dann als Vergleich dazu ein simples lineares Modell mit <span class="in">`set_engine("lm")`</span>. Wir du siehst, ist die *engine* unabhängig vom Formelaufruf. Das heißt, wir können die *engine* jetzt immer wieder verwenden.</span>
<span id="cb130-1085"><a href="#cb130-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1088"><a href="#cb130-1088" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1089"><a href="#cb130-1089" aria-hidden="true" tabindex="-1"></a>oats_lmer_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-1090"><a href="#cb130-1090" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lmer"</span>)</span>
<span id="cb130-1091"><a href="#cb130-1091" aria-hidden="true" tabindex="-1"></a>oats_lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-1092"><a href="#cb130-1092" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span>
<span id="cb130-1093"><a href="#cb130-1093" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1094"><a href="#cb130-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1095"><a href="#cb130-1095" aria-hidden="true" tabindex="-1"></a>Jetzt können wir mit der Funktion <span class="in">`fit()`</span> verschiedene Modell anpassen. Ich habe mich jetzt für ein <span class="in">`lm()`</span>-Modell sowie zwei <span class="in">`lmer()`</span>-Modelle entschieden. Einmal ein <span class="in">`lmer()`</span>-Modell mit Interaktionsterm und einmal ohne. Wir haben ja in der obigen Abbildung gesehen, dass wir eigentlich keine Interaktion zwischen den Behandlungen <span class="in">`nitro`</span> und den Sorten <span class="in">`gen`</span> vorliegen haben. Dann brauchen wir noch die Funktion <span class="in">`extract_fit_engine()`</span> damit wir die Ausgabe der Funktion <span class="in">`fit()`</span> auch für andere Pakete korrekt anwenden können.</span>
<span id="cb130-1096"><a href="#cb130-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1099"><a href="#cb130-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1100"><a href="#cb130-1100" aria-hidden="true" tabindex="-1"></a>oats_lm_fit <span class="ot">&lt;-</span> oats_lm_spec <span class="sc">|&gt;</span> </span>
<span id="cb130-1101"><a href="#cb130-1101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(plant_yield <span class="sc">~</span> nitro <span class="sc">+</span> gen <span class="sc">+</span> block, <span class="at">data =</span> oats_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb130-1102"><a href="#cb130-1102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>()  </span>
<span id="cb130-1103"><a href="#cb130-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1104"><a href="#cb130-1104" aria-hidden="true" tabindex="-1"></a>oats_lmer_fit <span class="ot">&lt;-</span> oats_lmer_spec <span class="sc">|&gt;</span> </span>
<span id="cb130-1105"><a href="#cb130-1105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(plant_yield <span class="sc">~</span> nitro <span class="sc">+</span> gen <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>gen), <span class="at">data =</span> oats_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb130-1106"><a href="#cb130-1106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>()  </span>
<span id="cb130-1107"><a href="#cb130-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1108"><a href="#cb130-1108" aria-hidden="true" tabindex="-1"></a>oats_lmer_int_fit <span class="ot">&lt;-</span> oats_lmer_spec <span class="sc">|&gt;</span> </span>
<span id="cb130-1109"><a href="#cb130-1109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(plant_yield <span class="sc">~</span> nitro <span class="sc">+</span> gen <span class="sc">+</span> nitro<span class="sc">:</span>gen <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>gen), <span class="at">data =</span> oats_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb130-1110"><a href="#cb130-1110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>()  </span>
<span id="cb130-1111"><a href="#cb130-1111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1112"><a href="#cb130-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1113"><a href="#cb130-1113" aria-hidden="true" tabindex="-1"></a>Damit sich hier nicht alles doppelt, einmal als Beispiel die Ausgabe des *Intraclass Correlation Coefficient* (abk. *ICC*) für das klassische lineare gemischte Modell. Wir sehen, dass die zufälligen Effekte sehr viel der Varianz in den Daten erklären. Das stimmt dann auch mit der Abbildung von oben überein. Die Blocke sind dort sehr variablen, was den Ertrag vom Weizen angeht.</span>
<span id="cb130-1114"><a href="#cb130-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1117"><a href="#cb130-1117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1118"><a href="#cb130-1118" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1119"><a href="#cb130-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1120"><a href="#cb130-1120" aria-hidden="true" tabindex="-1"></a>oats_lmer_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span>
<span id="cb130-1121"><a href="#cb130-1121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1122"><a href="#cb130-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1123"><a href="#cb130-1123" aria-hidden="true" tabindex="-1"></a>Und dann nochmal als Übersicht die Ergebnisse der Ausgabe der Funktion <span class="in">`model_performance()`</span>. Auch das funktioniert wunderbar.</span>
<span id="cb130-1124"><a href="#cb130-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1127"><a href="#cb130-1127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1128"><a href="#cb130-1128" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1129"><a href="#cb130-1129" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1130"><a href="#cb130-1130" aria-hidden="true" tabindex="-1"></a>oats_lmer_fit <span class="sc">|&gt;</span> <span class="fu">model_performance</span>()</span>
<span id="cb130-1131"><a href="#cb130-1131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1132"><a href="#cb130-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1133"><a href="#cb130-1133" aria-hidden="true" tabindex="-1"></a>Im folgenden Kasten findest du den Modellvergleich mit dem R Paket <span class="in">`{modelsummary}`</span>. Auch hier sehen wir, dass das <span class="in">`glmer`</span>-Modell mit und ohne Interaktion ungefähr den gleichen <span class="in">`RMSE`</span> produziert. Der <span class="in">`RMSE`</span> ist auch kleiner als beim <span class="in">`lm()`</span>-Modell, deshalb ist das gemischte Modell vorzuziehen. Je kleiner das Modell ist, desto besser, deshalb wäre hier das Modell ohne Interaktion vorzuziehen. Da die Bestimmtheitsmaße $R^2$ zwischen den gemischten Modellen auch ungefähr gleich sind, passt es auch hier. Den etwas geringeren ICC-Wert nehmen wir dann in kauf, wenn dafür unser Modell etwas simpler ist.</span>
<span id="cb130-1134"><a href="#cb130-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1135"><a href="#cb130-1135" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb130-1136"><a href="#cb130-1136" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modellvergleich mit `modelsummary()`</span></span>
<span id="cb130-1137"><a href="#cb130-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1140"><a href="#cb130-1140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1141"><a href="#cb130-1141" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1142"><a href="#cb130-1142" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1143"><a href="#cb130-1143" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"lm"</span> <span class="ot">=</span> oats_lm_fit, </span>
<span id="cb130-1144"><a href="#cb130-1144" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"lmer ohne Interaktion"</span> <span class="ot">=</span> oats_lmer_fit,</span>
<span id="cb130-1145"><a href="#cb130-1145" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"lmer mit Interaktion"</span> <span class="ot">=</span> oats_lmer_int_fit),</span>
<span id="cb130-1146"><a href="#cb130-1146" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"conf.int"</span>,</span>
<span id="cb130-1147"><a href="#cb130-1147" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"s.e. = {std.error}"</span>))</span>
<span id="cb130-1148"><a href="#cb130-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1149"><a href="#cb130-1149" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-1150"><a href="#cb130-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1151"><a href="#cb130-1151" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gruppenvergleich {#sec-mult-comp-lmer-reg}</span></span>
<span id="cb130-1152"><a href="#cb130-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1153"><a href="#cb130-1153" aria-hidden="true" tabindex="-1"></a>Vielleicht bist du direkt aus dem Kapitel zu den multiplen Vergleichen hierher gesprungen. Wenn ja, dann musst du eventuell nochmal weiter oben anfangen zu lesen, denn hier geht es eher um die schnelle Variante, den Gruppenvergleich mit einem linearen gemischten Modell durchzuführen. Details stehen in dem Kapitel. Wir nutzen hier einmal das R Paket <span class="in">`{lme4}`</span> zusammen mit dem <span class="co">[</span><span class="ot">R Paket `{lmerTest}`</span><span class="co">](https://www.jstatsoft.org/article/view/v082i13)</span>, welches uns dann auch erlaubt statistische Tests mit einem $p$-Wert zurechnen. Leider ist das in der ursprünglichen Version so nicht implementiert und deshalb müssen wir noch ein zusätzliches Paket laden. In dem R Paket <span class="in">`{glmmTMB}`</span> funktioniert soweit alles wie es soll, nur das wir hier dann noch das R Paket <span class="in">`{car}`</span> benötigen um die ANOVA zu rechnen. Wir ignorieren hier das Bestimmtheitsmaß oder die Modellgüte. Wir ziehen hier einmal stumpf den Prozess des Testens durch. Der Gruppenvergleich läuft dann wie gewohnt in <span class="in">`{emmeans}`</span> ab. Mehr dazu dann auch in den beiden Anwendungsbeispielen in den grünen Kästen im Anschluss.</span>
<span id="cb130-1154"><a href="#cb130-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1155"><a href="#cb130-1155" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb130-1156"><a href="#cb130-1156" aria-hidden="true" tabindex="-1"></a><span class="fu">## Welches R Paket mit welchem Endpunkt?</span></span>
<span id="cb130-1157"><a href="#cb130-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1158"><a href="#cb130-1158" aria-hidden="true" tabindex="-1"></a>Manchmal ist es etwas verwirrend, welches R Paket für die gemischten linearen Modellen mit welcher Funktion für welchen Endpunkt oder Outcome geeignet ist. Hier mal eine schnelle Übersicht, damit du dich orientieren kannst.</span>
<span id="cb130-1159"><a href="#cb130-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1160"><a href="#cb130-1160" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wenn dein Outcome normalverteilt ist, wie zum Beispiel das Trocken- oder Frischgewicht, dann hilft die Funktion <span class="in">`lmer()`</span> aus dem R Paket <span class="in">`{lme4}`</span> weiter.</span>
<span id="cb130-1161"><a href="#cb130-1161" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wenn du Zähldaten hast dann nutzt die Funktion <span class="in">`glmer()`</span> aus dem R Paket <span class="in">`lme4`</span> oder eben die Funktion <span class="in">`glmmTMB()`</span> aus dem gleichnamigen R Paket mit der entsprechenden Option für die Verteilungsfamilie.</span>
<span id="cb130-1162"><a href="#cb130-1162" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wenn du Boniturdaten oder aber ein ordinales Outcome vorliegen hast, dann kannst du die Funktion <span class="in">`clmm()`</span> aus dem R Paket <span class="in">`{ordinal}`</span> nutzen. Du brauchst hier noch zusätzlich die Funktion <span class="in">`Anova.clmm()`</span> aus dem R Paket <span class="in">`{RVAideMemoire}`</span> um die ANOVA rechnen zu können.</span>
<span id="cb130-1163"><a href="#cb130-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1164"><a href="#cb130-1164" aria-hidden="true" tabindex="-1"></a>Alle drei Varianten zeige ich dir in den grünen Kästen zu den beispielhaften Anwendungen am Ende des Kapitels.</span>
<span id="cb130-1165"><a href="#cb130-1165" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-1166"><a href="#cb130-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1167"><a href="#cb130-1167" aria-hidden="true" tabindex="-1"></a>Ich zeige dir jetzt einmal in den beiden Tabs die Gruppenvergleiche für das R Paket <span class="in">`{lme4}`</span> und der Funktion <span class="in">`lmer()`</span> sowie dann den Gruppenvergleich mit dem R Paket <span class="in">`{glmmTMB}`</span> und der gleichnamigen Funktion. Du kannst die Funktion <span class="in">`lmer()`</span> ohne weiteres durch die Funktion <span class="in">`glmer()`</span> ersetzen. Ich würde aber in dem Fall immer zu dem Paket <span class="in">`{glmmTMB}`</span> wechseln. Für nicht-normalverteilte Outcomes ist <span class="in">`{glmmTMB}`</span> einfach besser, da wir in dem Paket mehr Möglichkeiten haben die Daten zu modellieren. Wir nutzen hier als Beispiel die Weizendaten mit der Behandlung <span class="in">`nitro`</span> sowie den Sorten <span class="in">`gen`</span> und verschiedenen Blöcken im Split Plot Design. Wir wissen dass die Blöcke und die Sorten miteinander interagieren und packen deshalb diese genestete Struktur nochmal in den zufälligen Effekt mit <span class="in">`(1|block/gen)`</span>. Wir brauchen hier den Interaktionsterm, damit wir anschließend in <span class="in">`{emmeans}`</span> uns alle Faktorkombinationen anzeigen lassen können. Jedenfalls ist es dann so einfacher und wir verlieren nichts.</span>
<span id="cb130-1168"><a href="#cb130-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1169"><a href="#cb130-1169" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb130-1170"><a href="#cb130-1170" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gruppenvergleich mit `lmer()`</span></span>
<span id="cb130-1171"><a href="#cb130-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1172"><a href="#cb130-1172" aria-hidden="true" tabindex="-1"></a>Jetzt müssen wir die Funktion <span class="in">`lmer()`</span> aus dem R Paket <span class="in">`{lmerTest}`</span> nutzen, damit wir dann später die ANOVA mit $p$-Werten erhalten. Ich nutze das Paket <span class="in">`{lmerTest}`</span> sehr punktuell, deshalb lade ich mit dem Aufruf <span class="in">`lmerTest::lmer()`</span> nur einmal die Funktion <span class="in">`lmer()`</span> aus dem Paket. Wenn ich sonst <span class="in">`lmer()`</span> nutze, ist es wieder die Funktion aus dem Paket <span class="in">`{lme4}`</span>. Sonst kriegt man auch Probleme mit dem R Paket <span class="in">`{conflicted}`</span>, was zurecht möchte, dass wir uns für eine Funktion aus einem Paket entscheiden. Wenn wir das haben, dann können wir wie gewohnt das Modell anpassen.</span>
<span id="cb130-1173"><a href="#cb130-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1176"><a href="#cb130-1176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1177"><a href="#cb130-1177" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1178"><a href="#cb130-1178" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1179"><a href="#cb130-1179" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span><span class="fu">lmer</span>(plant_yield <span class="sc">~</span> nitro <span class="sc">+</span> gen <span class="sc">+</span> nitro<span class="sc">:</span>gen <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>gen), <span class="at">data =</span> oats_tbl)</span>
<span id="cb130-1180"><a href="#cb130-1180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1181"><a href="#cb130-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1182"><a href="#cb130-1182" aria-hidden="true" tabindex="-1"></a>Und schon können wir die ANOVA rechnen und erhalten dann auch über die Funktion <span class="in">`model_parameters()`</span> eine schönere Ausgabe wieder. Obwohl es in unserer Abbildung nicht so aussah, haben wir eine signifikante Interaktion in unseren Daten vorliegen. Wir werden daher dann die Daten getrennt einmal auswerten. Auch um ein wenig Platz zu sparen.</span>
<span id="cb130-1183"><a href="#cb130-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1186"><a href="#cb130-1186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1187"><a href="#cb130-1187" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1188"><a href="#cb130-1188" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1189"><a href="#cb130-1189" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1190"><a href="#cb130-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-1191"><a href="#cb130-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span>
<span id="cb130-1192"><a href="#cb130-1192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1193"><a href="#cb130-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1194"><a href="#cb130-1194" aria-hidden="true" tabindex="-1"></a>Einmal die paarweisen Vergleich für unsere Behandlung <span class="in">`nitro`</span>. Wir sehen, dass alle Vergleiche signifikant sind. Das haben wir aber schon aus der obigen Abbildung erwartet.</span>
<span id="cb130-1195"><a href="#cb130-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1198"><a href="#cb130-1198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1199"><a href="#cb130-1199" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1200"><a href="#cb130-1200" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1201"><a href="#cb130-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1202"><a href="#cb130-1202" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1203"><a href="#cb130-1203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> nitro) <span class="sc">|&gt;</span> </span>
<span id="cb130-1204"><a href="#cb130-1204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>()</span>
<span id="cb130-1205"><a href="#cb130-1205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1206"><a href="#cb130-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1207"><a href="#cb130-1207" aria-hidden="true" tabindex="-1"></a>Dann die Vergleiche für die Sorten. Hier haben wir dann keinen signifikanten Unterschied mehr vorliegen. Auch das überrascht uns jetzt nicht sehr. Auch in der obigen Abbildung haben sich die Sorten kaum Unterschiede was den Ertrag anging.</span>
<span id="cb130-1208"><a href="#cb130-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1211"><a href="#cb130-1211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1212"><a href="#cb130-1212" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1213"><a href="#cb130-1213" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1214"><a href="#cb130-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1215"><a href="#cb130-1215" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1216"><a href="#cb130-1216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> gen) <span class="sc">|&gt;</span> </span>
<span id="cb130-1217"><a href="#cb130-1217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>()</span>
<span id="cb130-1218"><a href="#cb130-1218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1219"><a href="#cb130-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1220"><a href="#cb130-1220" aria-hidden="true" tabindex="-1"></a>Abschließend machen wir dann noch das *compact letter display* fertig. Hier dann mit allen Faktorkombinationen von der Stickstoffdüngung <span class="in">`nitro`</span> und den Sorten <span class="in">`gen`</span>, wenn du <span class="in">`nitro * gen`</span> durchlaufen lässt. Für mich ist die Ausgabe dann zu groß, deshalb hier nur die Anwendung für <span class="in">`nitro`</span> getrennt für alle Sorten.</span>
<span id="cb130-1221"><a href="#cb130-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1224"><a href="#cb130-1224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1225"><a href="#cb130-1225" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1226"><a href="#cb130-1226" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1227"><a href="#cb130-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1228"><a href="#cb130-1228" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1229"><a href="#cb130-1229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> nitro <span class="sc">|</span> gen) <span class="sc">|&gt;</span> </span>
<span id="cb130-1230"><a href="#cb130-1230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters)</span>
<span id="cb130-1231"><a href="#cb130-1231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1232"><a href="#cb130-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1233"><a href="#cb130-1233" aria-hidden="true" tabindex="-1"></a>Und damit sind wir dann auch schon mit dem Gruppenvergleich mit <span class="in">`lmer()`</span> durch. Die ANOVA und das *compact letter display* lässt sich schnell und einfach erstellen. Wir müssen eben nur darauf achten, dass wir das richtige Helferpaket mit <span class="in">`{lmerTest}`</span> für die Modellierung des linearen gemischten Modell nutzen.</span>
<span id="cb130-1234"><a href="#cb130-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1235"><a href="#cb130-1235" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gruppenvergleich mit `glmmTMB()`</span></span>
<span id="cb130-1236"><a href="#cb130-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1237"><a href="#cb130-1237" aria-hidden="true" tabindex="-1"></a>Dann rechnen wir nochmal flux das lineare gemischte Modell mit der Funktion <span class="in">`glmmTMB()`</span>. Eigentlich ist alles genauso wie in dem andern Tab mit der Funktion <span class="in">`lmer()`</span>. Wir brauchen hier aber keine Helferfunktionen. Die Funktion <span class="in">`glmmTMB()`</span> kann das Modell so schätzen, dass wir auch eine ANOVA rechnen können. Wir müssen aber nur gleiche eine spezielle Implementierung wählen, aber das ist auch kein Problem.</span>
<span id="cb130-1238"><a href="#cb130-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1241"><a href="#cb130-1241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1242"><a href="#cb130-1242" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1243"><a href="#cb130-1243" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1244"><a href="#cb130-1244" aria-hidden="true" tabindex="-1"></a>glmmTMB_fit <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(plant_yield <span class="sc">~</span> nitro <span class="sc">+</span> gen <span class="sc">+</span> nitro<span class="sc">:</span>gen <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>gen), <span class="at">data =</span> oats_tbl)</span>
<span id="cb130-1245"><a href="#cb130-1245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1246"><a href="#cb130-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1247"><a href="#cb130-1247" aria-hidden="true" tabindex="-1"></a>Und schon können wir die ANOVA rechnen und erhalten dann auch über die Funktion <span class="in">`model_parameters()`</span> eine schönere Ausgabe wieder. Hier müssen wir die Funktion <span class="in">`Anova()`</span> aus dem R Paket <span class="in">`{car}`</span> nutzen. Obwohl es in unserer Abbildung nicht so aussah, haben wir eine signifikante Interaktion in unseren Daten vorliegen. Wir werden daher dann die Daten getrennt einmal auswerten. Auch um ein wenig Platz zu sparen.</span>
<span id="cb130-1248"><a href="#cb130-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1251"><a href="#cb130-1251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1252"><a href="#cb130-1252" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1253"><a href="#cb130-1253" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1254"><a href="#cb130-1254" aria-hidden="true" tabindex="-1"></a>glmmTMB_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1255"><a href="#cb130-1255" aria-hidden="true" tabindex="-1"></a>  car<span class="sc">::</span><span class="fu">Anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-1256"><a href="#cb130-1256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span>
<span id="cb130-1257"><a href="#cb130-1257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1258"><a href="#cb130-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1259"><a href="#cb130-1259" aria-hidden="true" tabindex="-1"></a>Einmal die paarweisen Vergleich für unsere Behandlung <span class="in">`nitro`</span>. Wir sehen, dass alle Vergleiche signifikant sind. Das haben wir aber schon aus der obigen Abbildung erwartet. Also auch hier nichts anderes zu dem anderen Tab.</span>
<span id="cb130-1260"><a href="#cb130-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1263"><a href="#cb130-1263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1264"><a href="#cb130-1264" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1265"><a href="#cb130-1265" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1266"><a href="#cb130-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1267"><a href="#cb130-1267" aria-hidden="true" tabindex="-1"></a>glmmTMB_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1268"><a href="#cb130-1268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> nitro) <span class="sc">|&gt;</span> </span>
<span id="cb130-1269"><a href="#cb130-1269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>()</span>
<span id="cb130-1270"><a href="#cb130-1270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1271"><a href="#cb130-1271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1272"><a href="#cb130-1272" aria-hidden="true" tabindex="-1"></a>Dann die Vergleiche für die Sorten. Hier haben wir dann keinen signifikanten Unterschied mehr vorliegen. Auch das überrascht uns jetzt nicht sehr. Auch in der obigen Abbildung haben sich die Sorten kaum Unterschiede was den Ertrag anging.</span>
<span id="cb130-1273"><a href="#cb130-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1276"><a href="#cb130-1276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1277"><a href="#cb130-1277" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1278"><a href="#cb130-1278" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1279"><a href="#cb130-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1280"><a href="#cb130-1280" aria-hidden="true" tabindex="-1"></a>glmmTMB_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1281"><a href="#cb130-1281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> gen) <span class="sc">|&gt;</span> </span>
<span id="cb130-1282"><a href="#cb130-1282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>()</span>
<span id="cb130-1283"><a href="#cb130-1283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1284"><a href="#cb130-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1285"><a href="#cb130-1285" aria-hidden="true" tabindex="-1"></a>Abschließend machen wir dann noch das *compact letter display* fertig. Für mich ist die Ausgabe dann zu groß, wenn ich mit <span class="in">`nitro * gen`</span> alle Faktorkombinationen anzeigen lasse, deshalb hier nur die Anwendung für <span class="in">`nitro`</span> getrennt für alle Sorten.</span>
<span id="cb130-1286"><a href="#cb130-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1289"><a href="#cb130-1289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1290"><a href="#cb130-1290" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1291"><a href="#cb130-1291" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1292"><a href="#cb130-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1293"><a href="#cb130-1293" aria-hidden="true" tabindex="-1"></a>glmmTMB_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1294"><a href="#cb130-1294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> nitro <span class="sc">|</span> gen) <span class="sc">|&gt;</span> </span>
<span id="cb130-1295"><a href="#cb130-1295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters)</span>
<span id="cb130-1296"><a href="#cb130-1296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1297"><a href="#cb130-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1298"><a href="#cb130-1298" aria-hidden="true" tabindex="-1"></a>Auch hier sehen wir dann die Unterschiede in den einzelnen Sorten. Alle sind soweit signifikant. Damit sind wir auch mit der Implementierung von <span class="in">`{glmmTMB}`</span> durch. Die ANOVA und das *compact letter display* lässt sich schnell und einfach erstellen.</span>
<span id="cb130-1299"><a href="#cb130-1299" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-1300"><a href="#cb130-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1301"><a href="#cb130-1301" aria-hidden="true" tabindex="-1"></a>In den folgenden grünen Kästen schauen wir uns jetzt drei Anwenundungsbeispiele für einen Gruppenvergleich mit linearen gemischten Modellen an. Zum einen betrachten wir ein dreifaktorieller Gruppenvergleich für das Gewicht von Brokkoliköpfen und zum anderen ein weiterer dreifaktorieller Gruppenvergleich für Thripsenbefall. Dann betrachten wir noch ein ordinales Modell mit den Boniturnoten bei Schweinen. Alle Auswertungen sind vollständig und haben auch teilweise erklärenden Text. Im Zweifel musst du dann nochmal in diesem Kapitel nachschlagen, wenn dir Teile unklar sind.</span>
<span id="cb130-1302"><a href="#cb130-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1303"><a href="#cb130-1303" aria-hidden="true" tabindex="-1"></a>::::: callout-tip</span>
<span id="cb130-1304"><a href="#cb130-1304" aria-hidden="true" tabindex="-1"></a><span class="fu">## Anwendungsbeispiel: Gruppenvergleich für Brokkolikopfgewicht (3-faktoriell)</span></span>
<span id="cb130-1305"><a href="#cb130-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1306"><a href="#cb130-1306" aria-hidden="true" tabindex="-1"></a>Im folgenden Beispiel schauen wir uns nochmal ein praktische Auswertung von einem agrarwissenschaftlichen Beispiel mit Brokkoli an. Wir haben uns in diesem Experiment verschiedene Dosen <span class="in">`fert_amount`</span> von einem Dünger aufgebracht sowie verschiedene Zeitpunkte der Düngung <span class="in">`fert_time`</span> berücksichtigt. Auch hier haben wir einige Besonderheiten in den Daten, da nicht jede Faktorkombination vorliegt. Wir ignorieren aber diese Probleme und rechnen einfach stumpf unseren Gruppenvergleich und ignorieren die fehlenden Faktorkombinationen. Wir haben aber mit den Gewicht ein normalverteiltes Outcome vorliegen und haben die Pflanzen in Blöcken randomisiert. Leider kennen wir nicht das experimentelle Design und müssen daher etwas blind modellieren.</span>
<span id="cb130-1307"><a href="#cb130-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1310"><a href="#cb130-1310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1311"><a href="#cb130-1311" aria-hidden="true" tabindex="-1"></a>broc_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/broccoli_weight.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb130-1312"><a href="#cb130-1312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fert_time =</span> <span class="fu">factor</span>(fert_time, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"none"</span>, <span class="st">"early"</span>, <span class="st">"late"</span>)),</span>
<span id="cb130-1313"><a href="#cb130-1313" aria-hidden="true" tabindex="-1"></a>         <span class="at">fert_amount =</span> <span class="fu">as_factor</span>(fert_amount),</span>
<span id="cb130-1314"><a href="#cb130-1314" aria-hidden="true" tabindex="-1"></a>         <span class="at">block =</span> <span class="fu">as_factor</span>(block)) <span class="sc">|&gt;</span></span>
<span id="cb130-1315"><a href="#cb130-1315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>stem_hollowness) </span>
<span id="cb130-1316"><a href="#cb130-1316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1317"><a href="#cb130-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1318"><a href="#cb130-1318" aria-hidden="true" tabindex="-1"></a>Jetzt wollen wir einmal das Modell auftellen. Wir nehmen die beiden Behandlungen als festen Effekt mit einem Interaktionsterm in das gemischte Modell. Den Block nehmen wir dann als zufälligen Effekt mit rein. Wir nutze hier dann das R Paket <span class="in">`{lmerTest}`</span> um das lineare gemischte Modell zu rechnen, da wir dann besser die Gruppenvergleiche und die ANOVA rechnen können. Mit der Funktion asu dem R Paket <span class="in">`{lme4}`</span> kriegen wir aus der ANOVA keine $p$-Werte.</span>
<span id="cb130-1319"><a href="#cb130-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1322"><a href="#cb130-1322" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1323"><a href="#cb130-1323" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1324"><a href="#cb130-1324" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1325"><a href="#cb130-1325" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="ot">&lt;-</span> lmerTest<span class="sc">::</span><span class="fu">lmer</span>(weight <span class="sc">~</span> fert_time <span class="sc">+</span> fert_amount <span class="sc">+</span> fert_time<span class="sc">:</span>fert_amount <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> block), </span>
<span id="cb130-1326"><a href="#cb130-1326" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> broc_tbl) </span>
<span id="cb130-1327"><a href="#cb130-1327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1328"><a href="#cb130-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1329"><a href="#cb130-1329" aria-hidden="true" tabindex="-1"></a>Dann berechnen wir auch einmal die $R^2$-Werte für unser Modell. Hier gibt es dann nochmal mehr Informationen auf <span class="co">[</span><span class="ot">$R^2$ for Mixed Models -- Marginal vs. Conditional</span><span class="co">](https://easystats.github.io/performance/articles/r2.html#marginal-vs--conditional-r2)</span>. Wichtig ist, dass das <span class="in">`Conditional R2`</span>, die gesamte erklärte Varianz von festen und zufälligen Effekten beschriebt und das <span class="in">`Marginal R2`</span> nur die erklärte Varianz aus den festen Effekten. Tja, das Modell ist nun echt nicht gerade das beste Modell nach dem Bestimmtheitsmaß. Die festen Effekte, also unsere Behandlungen, erklären kaum etwas von der Varianz. Aber schauen wir mal weiter.</span>
<span id="cb130-1330"><a href="#cb130-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1333"><a href="#cb130-1333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1334"><a href="#cb130-1334" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> <span class="fu">r2</span>()</span>
<span id="cb130-1335"><a href="#cb130-1335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1336"><a href="#cb130-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1337"><a href="#cb130-1337" aria-hidden="true" tabindex="-1"></a>Der <span class="co">[</span><span class="ot">Intraclass Correlation Coefficient (ICC)</span><span class="co">](https://easystats.github.io/performance/reference/icc.html)</span> ist dann das Bestimmtheitsmaß $R^2$ für die zufälligen Effekte. Auch hier sehen wir eher maue Werte. Wir haben anscheinend sehr viel Varianz in den Daten, die wir nicht durch unsere Faktoren erklären können.</span>
<span id="cb130-1338"><a href="#cb130-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1341"><a href="#cb130-1341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1342"><a href="#cb130-1342" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span>
<span id="cb130-1343"><a href="#cb130-1343" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1344"><a href="#cb130-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1345"><a href="#cb130-1345" aria-hidden="true" tabindex="-1"></a>Mit der Funktion <span class="in">`model_performance()`</span> können wir uns dann nochmal alles zusammen anschauen. Viele der Werte sind nur wichtig, wenn wir Modelle miteinander vergleichen. Das Bestimmtheitsmaß $R^2$ als einzelner Wert ist da schon wichtiger.</span>
<span id="cb130-1346"><a href="#cb130-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1349"><a href="#cb130-1349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1350"><a href="#cb130-1350" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1351"><a href="#cb130-1351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_performance</span>()</span>
<span id="cb130-1352"><a href="#cb130-1352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1353"><a href="#cb130-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1354"><a href="#cb130-1354" aria-hidden="true" tabindex="-1"></a>Jetzt rechnen wir in den beiden folgenden Tabs einmal die ANOVA und dann auch den multiplen Gruppenvergleich mit <span class="in">`{emmeans}`</span>. Da wir hier normalveteilte Daten haben, können wir dann einfach die Standardverfahren nehmen. Eventuell müssten wir bei dem Gruppenvergleich mit <span class="in">`emmeans()`</span> nochmal für die multiplen Vergleiche adjustieren, aber da erfährst du dann mehr in dem Kapitel zu den <span class="co">[</span><span class="ot">Multiple Vergleichen oder Post-hoc Tests</span><span class="co">](#sec-posthoc)</span>. Bei den gemischten Modellen müssen wir nicht für Varianzheterogenität adjustieren, das machen dann die Modelle intern schon.</span>
<span id="cb130-1355"><a href="#cb130-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1356"><a href="#cb130-1356" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb130-1357"><a href="#cb130-1357" aria-hidden="true" tabindex="-1"></a><span class="fu">## ANOVA mit `anova()`</span></span>
<span id="cb130-1358"><a href="#cb130-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1359"><a href="#cb130-1359" aria-hidden="true" tabindex="-1"></a>Wir rechnen hier einmal die ANOVA und erhalten Dank der Nutzung des R Paketes <span class="in">`{lmerTest}`</span> auch die $p$-Werte. Wenn du nicht das R Paket <span class="in">`{lmerTest}`</span> nutzt, wird per Standardeinstellung kein Test gerechnet. Wir machen dann die Ausgabe nochmal schöner und fertig sind wir.</span>
<span id="cb130-1360"><a href="#cb130-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1363"><a href="#cb130-1363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1364"><a href="#cb130-1364" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1365"><a href="#cb130-1365" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1366"><a href="#cb130-1366" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1367"><a href="#cb130-1367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-1368"><a href="#cb130-1368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span>
<span id="cb130-1369"><a href="#cb130-1369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1370"><a href="#cb130-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1371"><a href="#cb130-1371" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass der Effekt der Düngerzeit und die Menge des Düngers signifikant ist, jedoch wir keinen signifikanten Einfluss durch die Interaktion haben. Wir haben aber also keine Interaktion vorliegen. Wir sehen hier den Block nicht mehr, da der Effekt des Blocks in den zufälligen Effekt ist und hier nicht mehr gezeigt wird. Für die ANOVA der zufälligen Effekte können wir dann die Funktion <span class="in">`ranova()`</span> nutzen.</span>
<span id="cb130-1372"><a href="#cb130-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1375"><a href="#cb130-1375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1376"><a href="#cb130-1376" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1377"><a href="#cb130-1377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ranova</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-1378"><a href="#cb130-1378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">drop =</span> <span class="st">"&lt;none&gt;"</span>)</span>
<span id="cb130-1379"><a href="#cb130-1379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1380"><a href="#cb130-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1381"><a href="#cb130-1381" aria-hidden="true" tabindex="-1"></a>Nun können wir auch erkennen, dass wir einen signifikanten Effekt des Blocks haben. Du kannst aber die Ausgabe der zufälligen ANOVA nicht mit der obigen ANOVA vergleichen. Wir erhalten aus der ANOVA keine Informationen über die erklärte Varianz. Diese Information erhalten wir dann oben aus der Funktion <span class="in">`icc()`</span>. Dann können wir auch in dem anderem Tab mit dem Gruppebvergleich in <span class="in">`{emmeans}`</span> weitermachen.</span>
<span id="cb130-1382"><a href="#cb130-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1383"><a href="#cb130-1383" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gruppenvergleich mit `emmeans()`</span></span>
<span id="cb130-1384"><a href="#cb130-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1385"><a href="#cb130-1385" aria-hidden="true" tabindex="-1"></a>Im Folgenden rechnen wir einmal über alle Faktorkombinationen von <span class="in">`fert_time`</span> und <span class="in">`fert_amount`</span> einen Gruppenvergleich. Dafür nutzen wir die Option <span class="in">`fert_time * fert_amount`</span>. Wenn du die Analyse *getrennt* für die Menge und den Zeitpunkt durchführen willst, dann nutze die Option <span class="in">`fert_time | fert_amount`</span>. Dann adjustieren wir noch nach Bonferroni und sind schon fertig.</span>
<span id="cb130-1386"><a href="#cb130-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1389"><a href="#cb130-1389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1390"><a href="#cb130-1390" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> lmer_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1391"><a href="#cb130-1391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> fert_time <span class="sc">*</span> fert_amount) <span class="sc">|&gt;</span></span>
<span id="cb130-1392"><a href="#cb130-1392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb130-1393"><a href="#cb130-1393" aria-hidden="true" tabindex="-1"></a>emm_obj</span>
<span id="cb130-1394"><a href="#cb130-1394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1395"><a href="#cb130-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1396"><a href="#cb130-1396" aria-hidden="true" tabindex="-1"></a>Das <span class="in">`emm_obj`</span> Objekt werden wir dann gleich einmal in <span class="in">`{ggplot}`</span> visualisieren. Die <span class="in">`emmean`</span> stellt den mittleren Gewicht des Brokkoli je Faktorkombination dar unter Berücksichtigung der Varianz der Blöcke als zufälligen Effekt. Du siehst ja auch, dass wir hier keine homogen Varianzen $SE$ haben. Dann können wir zum Abschluss auch das *compact letter display* anhand der Abbildung interpretieren. Einige der Vergleiche konnten nicht gerechnet werden, da wir die Faktorkombination nicht in den Daten vorliegen haben.</span>
<span id="cb130-1397"><a href="#cb130-1397" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-1398"><a href="#cb130-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1399"><a href="#cb130-1399" aria-hidden="true" tabindex="-1"></a>In der @fig-log-mod-gaussian-broc siehst du das Ergebnis der Auswertung in einem Säulendiagramm und in der @fig-log-mod-gaussian-broc-half die Ergebnisse in einem Dot-Boxplot. Wir sehen einen klaren Effekt der Düngezeitpunkte sowie der Düngermenge auf das Gewicht von Brokkoli. Wenn wir ein mittleres Gewicht von $500g$ für den Handel erreichen wollen, dann erhalten wir das Zielgewicht nur bei einer Düngemenge von $300mg/l$. Hier stellt sich dann die Frage, ob wir bei $225mg/l$ und einem frühen Zeitpunkt der Düngung nicht auch genug Brokkoli erhalten. Das Ziel ist es ja eigentlich in einen Zielbereich zu kommen. Die Köpfe sollen ja nicht zu schwer und auch nicht zu leicht sein. Aber diese Frage und andere Fragen der biologischen Anwendung lassen wir dann hier einmal offen, denn das Beispiel soll ja nur ein Beispiel sein. Besonders spannend ist hier der Unterschied in den beiden Abbildungen. Schau dir dazu einmal die beiden verschiedenen Tabs an.</span>
<span id="cb130-1400"><a href="#cb130-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1401"><a href="#cb130-1401" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb130-1402"><a href="#cb130-1402" aria-hidden="true" tabindex="-1"></a><span class="fu">## Barplots</span></span>
<span id="cb130-1403"><a href="#cb130-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1404"><a href="#cb130-1404" aria-hidden="true" tabindex="-1"></a>Im Folgenden einmal die Barplots mit den Mittelwerten und dem Standardfehler. Hier sieht es so aus, also ob die Düngezeitpunkte relativ verlässlich ein Zielgewicht von $500g$ im Mittel erreichen würden. Das stimmt auch, wenn wir uns auf den Mittelwert beziehen. Auch der Standardfehler ist relativ klein, da wir ja so viele Beobachtungen vorliegen haben. Schau dir dazu dann einmal den Dot-Boxplot in dem anderen Tab an.</span>
<span id="cb130-1405"><a href="#cb130-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1408"><a href="#cb130-1408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1409"><a href="#cb130-1409" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-1410"><a href="#cb130-1410" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1411"><a href="#cb130-1411" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1412"><a href="#cb130-1412" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-log-mod-gaussian-broc</span></span>
<span id="cb130-1413"><a href="#cb130-1413" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-1414"><a href="#cb130-1414" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb130-1415"><a href="#cb130-1415" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb130-1416"><a href="#cb130-1416" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Säulendigramm der mittleren Brokkoligewichte aus einem linearen gemischten Modell. Das `lmer()`-Modell berechnet das mittler Gewicht des Brokkoli in jeder Faktorkombination. Das *compact letter display* wird dann in `{emmeans}` generiert. Wir nutzen hier den Standardfehler, da die Standardabweichung mit der großen Fallzahl rießig wäre. Wir haben noch ein Mindestgewicht von 500g ergänzt."</span></span>
<span id="cb130-1417"><a href="#cb130-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1418"><a href="#cb130-1418" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb130-1419"><a href="#cb130-1419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-1420"><a href="#cb130-1420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fert_time, <span class="at">y =</span> emmean, <span class="at">fill =</span> fert_amount)) <span class="sc">+</span></span>
<span id="cb130-1421"><a href="#cb130-1421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb130-1422"><a href="#cb130-1422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mittleres Gewicht [g] des Brokkoli"</span>, <span class="at">x =</span> <span class="st">"Düngezeitpunkt"</span>,</span>
<span id="cb130-1423"><a href="#cb130-1423" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Düngemenge [mg/l]"</span>) <span class="sc">+</span></span>
<span id="cb130-1424"><a href="#cb130-1424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">500</span>, <span class="at">by =</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb130-1425"><a href="#cb130-1425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">500</span>, <span class="at">size =</span> <span class="fl">0.75</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb130-1426"><a href="#cb130-1426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb130-1427"><a href="#cb130-1427" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb130-1428"><a href="#cb130-1428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> emmean <span class="sc">+</span> SE <span class="sc">+</span> <span class="fl">0.01</span>),  </span>
<span id="cb130-1429"><a href="#cb130-1429" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb130-1430"><a href="#cb130-1430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> emmean<span class="sc">-</span>SE, <span class="at">ymax =</span> emmean<span class="sc">+</span>SE),</span>
<span id="cb130-1431"><a href="#cb130-1431" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb130-1432"><a href="#cb130-1432" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb130-1433"><a href="#cb130-1433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb130-1434"><a href="#cb130-1434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb130-1435"><a href="#cb130-1435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1436"><a href="#cb130-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1437"><a href="#cb130-1437" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dotplots und Boxplots</span></span>
<span id="cb130-1438"><a href="#cb130-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1439"><a href="#cb130-1439" aria-hidden="true" tabindex="-1"></a>Als erstes müssen wir nochmal das <span class="in">`emm_obj`</span> in einen <span class="in">`tibble`</span> umwandeln, damit wir dann das *compact letter display* direkt in die Grafik setzen können. Wir entfernen dann noch alle Faktorkombinationen, die wir nicht brauchen, damit wir dann auch gleich die Positionen richtig setzen können. Wichtig ist auch, dass die Faktoren richtig sortiert sind, sonst passt es gleich nicht mit dem Zufügen des *compact letter display* zu der Position.</span>
<span id="cb130-1440"><a href="#cb130-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1443"><a href="#cb130-1443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1444"><a href="#cb130-1444" aria-hidden="true" tabindex="-1"></a>emm_cld_tbl <span class="ot">&lt;-</span> emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb130-1445"><a href="#cb130-1445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-1446"><a href="#cb130-1446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(fert_time, fert_amount) <span class="sc">|&gt;</span> </span>
<span id="cb130-1447"><a href="#cb130-1447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb130-1448"><a href="#cb130-1448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1449"><a href="#cb130-1449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1450"><a href="#cb130-1450" aria-hidden="true" tabindex="-1"></a>Die Positionen für das *compact letter display* berechnen wir uns aus dem Wert des $3^{rd}$ Quantile. Dann ergänzen wir noch die Werte für das *compact letter display* und fertig sind wir. Aber auch hier lieber einmal doppelt schauen, dass wir auch wirklich die richtigen Buchstaben zu den richtigen Faktorkombinationen ergänzt haben.</span>
<span id="cb130-1451"><a href="#cb130-1451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1454"><a href="#cb130-1454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1455"><a href="#cb130-1455" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1456"><a href="#cb130-1456" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1457"><a href="#cb130-1457" aria-hidden="true" tabindex="-1"></a>cld_pos_tbl <span class="ot">&lt;-</span> broc_tbl <span class="sc">|&gt;</span> </span>
<span id="cb130-1458"><a href="#cb130-1458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fert_time, fert_amount) <span class="sc">|&gt;</span> </span>
<span id="cb130-1459"><a href="#cb130-1459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">quant_3rd =</span> <span class="fu">quantile</span>(weight, <span class="fl">0.75</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb130-1460"><a href="#cb130-1460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">group =</span> emm_cld_tbl<span class="sc">$</span>.group)</span>
<span id="cb130-1461"><a href="#cb130-1461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1462"><a href="#cb130-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1463"><a href="#cb130-1463" aria-hidden="true" tabindex="-1"></a>Jetzt stellen wir den Dot-Boxplot einmal in der folgenden Abbildung dar. Dazu nutzen wir das R Paket <span class="in">`{gghalves}`</span> und die entsprechenden Funktionen. Wir müssen hier relativ viel machen, damit der Plot gut aussieht. Aber das meiste ist einfach nur Code wiederverwendet. Spannend ist hier die Variabilität in den Daten. Wir sehen hier, das unsere Brokkoliköpfe bei weitem nicht so nahe an dem Zielbereich sind, wie die Barplots suggerieren. Wir wollen eigentlich ziemlich eng um die $500g$ sein, sonnst muss der Supermarkt wild packen um immer die gleiche Packungsgröße zu haben. Jetzt wirken die Unterschiede zwischen den Zeitpunkten und den Mengen auch schon wieder etwas anders. Auch mit weniger Dünger können wir relativ große Brokkoli erhalten. Das plazieren der Buchstaben wäre vermutlich mit <span class="in">`annotate()`</span> einfacher gewesen.</span>
<span id="cb130-1464"><a href="#cb130-1464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1467"><a href="#cb130-1467" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1468"><a href="#cb130-1468" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-1469"><a href="#cb130-1469" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1470"><a href="#cb130-1470" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1471"><a href="#cb130-1471" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-log-mod-gaussian-broc-half</span></span>
<span id="cb130-1472"><a href="#cb130-1472" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-1473"><a href="#cb130-1473" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb130-1474"><a href="#cb130-1474" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb130-1475"><a href="#cb130-1475" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dotplots und Boxplots der mittleren Brokkoligewichte aus einem linearen gemischten Modell. Das `lmer()`-Modell berechnet das mittler Gewicht des Brokkoli in jeder Faktorkombination. Das *compact letter display* wird dann in `{emmeans}` generiert. Wir haben noch ein Mindestgewicht von 500g ergänzt."</span></span>
<span id="cb130-1476"><a href="#cb130-1476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1477"><a href="#cb130-1477" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(broc_tbl, <span class="fu">aes</span>(<span class="at">x =</span> fert_time, <span class="at">y =</span> weight, <span class="at">fill =</span> fert_amount)) <span class="sc">+</span> </span>
<span id="cb130-1478"><a href="#cb130-1478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mittleres Gewicht [g] des Brokkoli"</span>, <span class="at">x =</span> <span class="st">"Düngezeitpunkt"</span>,</span>
<span id="cb130-1479"><a href="#cb130-1479" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Düngemenge [mg/l]"</span>) <span class="sc">+</span></span>
<span id="cb130-1480"><a href="#cb130-1480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">500</span>, <span class="at">size =</span> <span class="fl">0.75</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb130-1481"><a href="#cb130-1481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_half_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> fert_amount), </span>
<span id="cb130-1482"><a href="#cb130-1482" aria-hidden="true" tabindex="-1"></a>                  <span class="at">transformation =</span> <span class="fu">position_quasirandom</span>(<span class="at">width =</span> <span class="fl">0.05</span>),</span>
<span id="cb130-1483"><a href="#cb130-1483" aria-hidden="true" tabindex="-1"></a>                  <span class="at">side =</span> <span class="st">"l"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb130-1484"><a href="#cb130-1484" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb130-1485"><a href="#cb130-1485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_half_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> fert_amount), </span>
<span id="cb130-1486"><a href="#cb130-1486" aria-hidden="true" tabindex="-1"></a>                    <span class="at">side =</span> <span class="st">"r"</span>, <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">outlier.size =</span> <span class="fl">0.8</span>,</span>
<span id="cb130-1487"><a href="#cb130-1487" aria-hidden="true" tabindex="-1"></a>                    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb130-1488"><a href="#cb130-1488" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> cld_pos_tbl, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_trim</span>(group), <span class="at">y =</span> quant_3rd <span class="sc">+</span> <span class="dv">70</span>),</span>
<span id="cb130-1489"><a href="#cb130-1489" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">hjust =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb130-1490"><a href="#cb130-1490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span> <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb130-1491"><a href="#cb130-1491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) </span>
<span id="cb130-1492"><a href="#cb130-1492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1493"><a href="#cb130-1493" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-1494"><a href="#cb130-1494" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb130-1495"><a href="#cb130-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1496"><a href="#cb130-1496" aria-hidden="true" tabindex="-1"></a>::::: callout-tip</span>
<span id="cb130-1497"><a href="#cb130-1497" aria-hidden="true" tabindex="-1"></a><span class="fu">## Anwendungsbeispiel: Gruppenvergleich für Thripsenbefall (3-faktoriell)</span></span>
<span id="cb130-1498"><a href="#cb130-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1499"><a href="#cb130-1499" aria-hidden="true" tabindex="-1"></a>Im folgenden Beispiel schauen wir uns nochmal ein praktische Auswertung von einem agrarwissenschaftlichen Beispiel mit jungen Apfelbäumen an. Wir haben uns in diesem Experiment verschiedene Dosen <span class="in">`trt`</span> von einem Insektizid aufgebracht sowie verschiedene Startanzahlen von Raubmilben als biologische Alternative untersucht. Dann haben wir noch fünf Zeitpunkte bestimmt, an denen wir die Anzahl an Thripsen auf den Blättern gezählt haben. Wir haben nicht die Blätter per se gezählt sondern Fallen waagerecht aufgestellt. Dann haben wir geschaut, wie viele Thripsen wir über <span class="in">`above`</span> und unter <span class="in">`below`</span> von den Fallen gefunden haben. In unserem Fall beschränken wir uns auf die obere Anzahl an Thripsen und schauen uns auch nur die Behandlung mit dem Insektizid an.</span>
<span id="cb130-1500"><a href="#cb130-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1503"><a href="#cb130-1503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1504"><a href="#cb130-1504" aria-hidden="true" tabindex="-1"></a>insects_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/insects_count.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb130-1505"><a href="#cb130-1505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timepoint =</span> <span class="fu">factor</span>(timepoint, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1 Tag"</span>, <span class="st">"4 Tag"</span>, <span class="st">"7 Tag"</span>, <span class="st">"11 Tag"</span>, <span class="st">"14 Tag"</span>)),</span>
<span id="cb130-1506"><a href="#cb130-1506" aria-hidden="true" tabindex="-1"></a>         <span class="at">rep =</span> <span class="fu">as_factor</span>(rep),</span>
<span id="cb130-1507"><a href="#cb130-1507" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt =</span> <span class="fu">as_factor</span>(trt)) <span class="sc">|&gt;</span></span>
<span id="cb130-1508"><a href="#cb130-1508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(timepoint, trt, rep, <span class="at">thripse =</span> thripse_above, <span class="at">mite =</span> mite_above) <span class="sc">|&gt;</span> </span>
<span id="cb130-1509"><a href="#cb130-1509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trt <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"10ml"</span>, <span class="st">"30ml"</span>, <span class="st">"60ml"</span>))</span>
<span id="cb130-1510"><a href="#cb130-1510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1511"><a href="#cb130-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1512"><a href="#cb130-1512" aria-hidden="true" tabindex="-1"></a>Warum bietet sich hier ein lineares gemischtes Modell an? Wir haben hier eine Wiederholung vorliegen, die wir dann als zufälligen Effekt modellieren können. Wir können daher die Poissonregression mit <span class="in">`glmer()`</span> rechnen. Auch hier wieder darauf achten, dass wir dann als Option <span class="in">`family = poisson`</span> wählen. Es hängt jetzt davon ab, ob du in deinen Daten Overdispersion vorliegen hast oder nicht, ob wir <span class="in">`glmer()`</span> nutzen können. In den beiden folgenden Tabs, rechne ich dann mal beide Modelle. Einmal ohne die Berücksichtigung von Overdispersion mit <span class="in">`glmer()`</span> aus dem R Paket <span class="in">`{lme4}`</span> und einmal mit Berücksichtigung der Overdispersion mit <span class="in">`glmmTMB()`</span> aus dem gleichnamigen R Paket.</span>
<span id="cb130-1513"><a href="#cb130-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1514"><a href="#cb130-1514" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb130-1515"><a href="#cb130-1515" aria-hidden="true" tabindex="-1"></a><span class="fu">## `glmer()` mit `family = poisson`</span></span>
<span id="cb130-1516"><a href="#cb130-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1517"><a href="#cb130-1517" aria-hidden="true" tabindex="-1"></a>Als Erstes rechnen wir eine normale Poissonregression mit <span class="in">`glmer()`</span> und schauen einmal, ob wir Overdispersion vorliegen haben. Wenn wir Overdispersion vorliegen haben, dann können wir keine Poissonregression rechnen, sondern müssen auf eine Quasipoisson Regression ausweichen. Das ist aber sehr einfach, wie du im anderen Tab sehen wirst.</span>
<span id="cb130-1518"><a href="#cb130-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1521"><a href="#cb130-1521" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1522"><a href="#cb130-1522" aria-hidden="true" tabindex="-1"></a>insects_poisson_fit <span class="ot">&lt;-</span> <span class="fu">glmer</span>(thripse <span class="sc">~</span> trt <span class="sc">+</span> timepoint <span class="sc">+</span> trt<span class="sc">:</span>timepoint <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> rep), </span>
<span id="cb130-1523"><a href="#cb130-1523" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> insects_tbl, </span>
<span id="cb130-1524"><a href="#cb130-1524" aria-hidden="true" tabindex="-1"></a>                             <span class="at">family =</span> poisson) </span>
<span id="cb130-1525"><a href="#cb130-1525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1526"><a href="#cb130-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1527"><a href="#cb130-1527" aria-hidden="true" tabindex="-1"></a>Bevor wir uns das Modell mit <span class="in">`summary()`</span> überhaupt anschauen, wollen wir erstmal überprüfen, ob wir überhaupt Overdispersion vorliegen haben. Wenn ja, dann können wir uns die <span class="in">`summary()`</span> hier gleich sparen und wir können dann mit dem Modell auch keine Gruppenvergleiche rechnen. Also einmal geguckt, was die Overdispersion macht.</span>
<span id="cb130-1528"><a href="#cb130-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1531"><a href="#cb130-1531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1532"><a href="#cb130-1532" aria-hidden="true" tabindex="-1"></a>insects_poisson_fit <span class="sc">|&gt;</span> <span class="fu">check_overdispersion</span>()</span>
<span id="cb130-1533"><a href="#cb130-1533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1534"><a href="#cb130-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1535"><a href="#cb130-1535" aria-hidden="true" tabindex="-1"></a>Wir haben sehr starke Overdispersion vorliegen und gehen daher in den anderen Tab und rechnen eine Quasipoisson Regression mit dem R Paket <span class="in">`{glmmTMB}`</span>. Nur wenn du keine Overdispersion vorliegen hast, dann kannst du eine eine Poissonregression mit <span class="in">`glmer()`</span> rechnen.</span>
<span id="cb130-1536"><a href="#cb130-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1537"><a href="#cb130-1537" aria-hidden="true" tabindex="-1"></a><span class="fu">## `glmmTMB()` mit `family = nbinom1`</span></span>
<span id="cb130-1538"><a href="#cb130-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1539"><a href="#cb130-1539" aria-hidden="true" tabindex="-1"></a>Da wir in <span class="in">`{lme4}`</span> keine Quasipoissonverteilung auswählen können, nutzen wir das <span class="co">[</span><span class="ot">R Paket `{glmmTMB}`</span><span class="co">](https://glmmtmb.github.io/glmmTMB/index.html)</span> mit der Verteilungsfamilie <span class="in">`nbinom1`</span>, was einer Parametrisierung einer Quasipoissonverteilung entspricht. Meistens nutze ich gleich die <span class="in">`glmmTMB()`</span> Funktion, da wir in biologischen Daten sehr häufig Overdispersion vorliegen haben. Dann kann man sich eine Runde gleich sparen. Aber am Ende kannst du dann auch die Modelle miteinander vergleichen und auch berichten wie groß deine Overdispersion ist.</span>
<span id="cb130-1540"><a href="#cb130-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1543"><a href="#cb130-1543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1544"><a href="#cb130-1544" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(thripse <span class="sc">~</span> trt <span class="sc">+</span> timepoint <span class="sc">+</span> trt<span class="sc">:</span>timepoint <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>rep), </span>
<span id="cb130-1545"><a href="#cb130-1545" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">data =</span> insects_tbl,</span>
<span id="cb130-1546"><a href="#cb130-1546" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">family =</span> nbinom1) </span>
<span id="cb130-1547"><a href="#cb130-1547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1548"><a href="#cb130-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1549"><a href="#cb130-1549" aria-hidden="true" tabindex="-1"></a>Im Folgedne schauen wir nochmal, ob wir in unserem neuen Modell in <span class="in">`glmmTMB()`</span> noch Overdispersion vorliegen haben.</span>
<span id="cb130-1550"><a href="#cb130-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1553"><a href="#cb130-1553" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1554"><a href="#cb130-1554" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="sc">|&gt;</span> <span class="fu">check_overdispersion</span>()</span>
<span id="cb130-1555"><a href="#cb130-1555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1556"><a href="#cb130-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1557"><a href="#cb130-1557" aria-hidden="true" tabindex="-1"></a>Das passt soweit. Wir haben keine Overdispersion mehr. Dann berechnen wir auch einmal die $R^2$-Werte für unser Modell. Hier gibt es dann nochmal mehr Informationen auf <span class="co">[</span><span class="ot">$R^2$ for Mixed Models -- Marginal vs. Conditional</span><span class="co">](https://easystats.github.io/performance/articles/r2.html#marginal-vs--conditional-r2)</span>. Wichtig ist, dass das <span class="in">`Conditional R2`</span>, die gesamte erklärte Varianz von festen und zufälligen Effekten beschriebt und das <span class="in">`Marginal R2`</span> nur die erklärte Varianz aus den festen Effekten.</span>
<span id="cb130-1558"><a href="#cb130-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1561"><a href="#cb130-1561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1562"><a href="#cb130-1562" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="sc">|&gt;</span> <span class="fu">r2</span>()</span>
<span id="cb130-1563"><a href="#cb130-1563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1564"><a href="#cb130-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1565"><a href="#cb130-1565" aria-hidden="true" tabindex="-1"></a>Tja, das Modell ist nun echt nicht gerade das beste Modell nach dem Bestimmtheitsmaß. Die festen Effekte, also unsere Behandlungen, erklären kaum etwas von der Varianz. Aber schauen wir mal weiter. Der <span class="co">[</span><span class="ot">Intraclass Correlation Coefficient (ICC)</span><span class="co">](https://easystats.github.io/performance/reference/icc.html)</span> beschreibt nun die erklärte Varianz durch unsere zufälligen Effekte.</span>
<span id="cb130-1566"><a href="#cb130-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1569"><a href="#cb130-1569" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1570"><a href="#cb130-1570" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="sc">|&gt;</span> <span class="fu">icc</span>()</span>
<span id="cb130-1571"><a href="#cb130-1571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1572"><a href="#cb130-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1573"><a href="#cb130-1573" aria-hidden="true" tabindex="-1"></a>Auch hier sind die Ergebnisse eher mau aus. Du kannst dir die gesamte Übersicht auch gleich in der Funktion <span class="in">`model_performance()`</span> wiedergeben lassen. Das spart dann ein wenig Zeit und Code.</span>
<span id="cb130-1574"><a href="#cb130-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1577"><a href="#cb130-1577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1578"><a href="#cb130-1578" aria-hidden="true" tabindex="-1"></a>insects_quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1579"><a href="#cb130-1579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_performance</span>()</span>
<span id="cb130-1580"><a href="#cb130-1580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1581"><a href="#cb130-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1582"><a href="#cb130-1582" aria-hidden="true" tabindex="-1"></a>Wir haben hier auf jeden Fall Overdispersion vorliegen. Daher nutze ich dann auch das Modell hier in <span class="in">`glmmTMB()`</span> mit der Annahme an eine Quasipoissonverteilung. Dann stimmt es auch mit unseren Varianzen und wir produzieren nicht zufällig zu viele signifikante Ergebnisse, die es dann gar nicht gibt.</span>
<span id="cb130-1583"><a href="#cb130-1583" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-1584"><a href="#cb130-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1585"><a href="#cb130-1585" aria-hidden="true" tabindex="-1"></a>Ich habe mich gerade in den obigen Tabs für eine Quasipoissonregression in einem linearen gemischten Modell mit <span class="in">`glmmTMB()`</span> entschieden, da wir Overdispersion vorliegen haben. Damit mache ich dann mit dem <span class="in">`insects_quasipoisson_fit`</span> Modell weiter. In den beiden folgenden Tabs findest du dann einmal das Ergebnis für die ANOVA und einmal für den Gruppenvergleich mit dem R Paket <span class="in">`{emmeans}`</span>. Bitte beachte, dass die ANOVA für ein <span class="in">`glmmTMB()`</span>-Objekt nicht ganz gleich wie für ein <span class="in">`lm()`</span>-Objekt ist. Du kannst aber die ANOVA erstmal ganz normal interpretieren, nur haben wir hier nicht die Möglichkeit ein $\eta^2$ zu bestimmen. Dann nutzen wir <span class="in">`{emmeans}`</span> für den Gruppenvergleich. Nochmal, weil wir Overdispersion festgestellt haben, nutzen wir das Objekt <span class="in">`insects_quasipoisson_fit`</span> mit der Berücksichtigung der Overdispersion.</span>
<span id="cb130-1586"><a href="#cb130-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1587"><a href="#cb130-1587" aria-hidden="true" tabindex="-1"></a>Im Folgenden rechnen wir einmal über alle Faktorkombinationen von <span class="in">`trt`</span> und <span class="in">`timepoint`</span> einen Gruppenvergleich. Dafür nutzen wir die Opition <span class="in">`trt * timepoint`</span>. Wenn du die Analyse *getrennt* für die Zeitpunkte durchführen willst, dann nutze die Option <span class="in">`trt | timepoint`</span>. Wir wollen die Wahrscheinlichkeiten für das Auftreten einer Beschädigung von wiedergegeben bekommen, deshalb die Option <span class="in">`regrid = "response`</span>. Dann adjustieren wir noch nach Bonferroni und sind fertig.</span>
<span id="cb130-1588"><a href="#cb130-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1591"><a href="#cb130-1591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1592"><a href="#cb130-1592" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> insects_quasipoisson_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1593"><a href="#cb130-1593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt <span class="sc">*</span> timepoint, <span class="at">type =</span> <span class="st">"response"</span>) <span class="sc">|&gt;</span></span>
<span id="cb130-1594"><a href="#cb130-1594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb130-1595"><a href="#cb130-1595" aria-hidden="true" tabindex="-1"></a>emm_obj</span>
<span id="cb130-1596"><a href="#cb130-1596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1597"><a href="#cb130-1597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1598"><a href="#cb130-1598" aria-hidden="true" tabindex="-1"></a>Das <span class="in">`emm_obj`</span> Objekt werden wir dann gleich einmal in <span class="in">`{ggplot}`</span> visualisieren. Die <span class="in">`response`</span> stellt die mittlere Anzahl an Thripsen je Faktorkombination dar. Dann können wir auch das *compact letter display* anhand der Abbildung interpretieren. Ich stelle die Abbildung wieder einmal als Barplot und einmal als Dot-Boxplot in den beiden Tabs dar.</span>
<span id="cb130-1599"><a href="#cb130-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1600"><a href="#cb130-1600" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb130-1601"><a href="#cb130-1601" aria-hidden="true" tabindex="-1"></a><span class="fu">## Barplots</span></span>
<span id="cb130-1602"><a href="#cb130-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1603"><a href="#cb130-1603" aria-hidden="true" tabindex="-1"></a>In der @fig-log-mod-pois-insect siehst du das Ergebnis der Auswertung in einem Säulendiagramm. Hier unbedingt <span class="in">`SE`</span> als den Standardfehler für die Fehlerbalken nutzen, da wir sonst Fehlerbalken größer und kleiner als $0$ erhalten, wenn wir die Standardabweichung nutzen würden. Das ist in unserem Fall nicht so das Problem, aber wenn du eher kleine Anzahlen zählst, kann das schnell zu Werten kleiner Null führen. Wir sehen einen klaren Effekt der Behandlung <span class="in">`60ml`</span>. Die Zeit hat keinen Effekt, was ja schon aus der ANOVA klar war, die Säulen sehen für jeden Zeitpunkt vollkommen gleich aus. Gut etwas Unterschied ist ja immer.</span>
<span id="cb130-1604"><a href="#cb130-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1607"><a href="#cb130-1607" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1608"><a href="#cb130-1608" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-1609"><a href="#cb130-1609" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1610"><a href="#cb130-1610" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1611"><a href="#cb130-1611" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-log-mod-pois-insect</span></span>
<span id="cb130-1612"><a href="#cb130-1612" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-1613"><a href="#cb130-1613" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb130-1614"><a href="#cb130-1614" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb130-1615"><a href="#cb130-1615" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Säulendigramm der mittleren Zahl der Thripsen aus einer Quasipoissonregression mit einem gemischten Modell. Das `glmmTMB()`-Modell berechnet die mittlere Anzahl in jeder Faktorkombination. Das *compact letter display* wird dann in `{emmeans}` generiert."</span></span>
<span id="cb130-1616"><a href="#cb130-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1617"><a href="#cb130-1617" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb130-1618"><a href="#cb130-1618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-1619"><a href="#cb130-1619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> timepoint, <span class="at">y =</span> response, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb130-1620"><a href="#cb130-1620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb130-1621"><a href="#cb130-1621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mittlere Anzahl an Thripsen"</span>, <span class="at">x =</span> <span class="st">"Messzeitpunkte der Zählungen"</span>,</span>
<span id="cb130-1622"><a href="#cb130-1622" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Dosis"</span>) <span class="sc">+</span></span>
<span id="cb130-1623"><a href="#cb130-1623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="fl">0.8</span>, </span>
<span id="cb130-1624"><a href="#cb130-1624" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb130-1625"><a href="#cb130-1625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_trim</span>(.group), <span class="at">y =</span> response <span class="sc">+</span> SE <span class="sc">+</span> <span class="dv">1</span>), <span class="at">size =</span> <span class="dv">3</span>,  </span>
<span id="cb130-1626"><a href="#cb130-1626" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb130-1627"><a href="#cb130-1627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> response<span class="sc">-</span>SE, <span class="at">ymax =</span> response<span class="sc">+</span>SE),</span>
<span id="cb130-1628"><a href="#cb130-1628" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb130-1629"><a href="#cb130-1629" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb130-1630"><a href="#cb130-1630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb130-1631"><a href="#cb130-1631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1632"><a href="#cb130-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1633"><a href="#cb130-1633" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dotplots und Boxplots</span></span>
<span id="cb130-1634"><a href="#cb130-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1635"><a href="#cb130-1635" aria-hidden="true" tabindex="-1"></a>Damit wir uns gleich einmal die Daten in einem Dotplot und Boxplot anschauen können, brauchen wir noch die Positionen für das *compact letter display* in unser Abbildung. Daher brauchen wir erstmal das *compact letter display* und entfernen alle Faktorkombinationen, die keine Werte haben.</span>
<span id="cb130-1636"><a href="#cb130-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1639"><a href="#cb130-1639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1640"><a href="#cb130-1640" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1641"><a href="#cb130-1641" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1642"><a href="#cb130-1642" aria-hidden="true" tabindex="-1"></a>emm_cld_tbl <span class="ot">&lt;-</span> emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb130-1643"><a href="#cb130-1643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-1644"><a href="#cb130-1644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(timepoint, trt)</span>
<span id="cb130-1645"><a href="#cb130-1645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1646"><a href="#cb130-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1647"><a href="#cb130-1647" aria-hidden="true" tabindex="-1"></a>Jetzt berechnen wir uns noch die Position. Ich setze hier das *compact letter display* auf die Position des dritten Quartils, was ausreichen sollte und nicht zu weit weg ist. Damit haben wir dann die Buchstaben nahe genug an den Boxen der Boxplots.</span>
<span id="cb130-1648"><a href="#cb130-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1651"><a href="#cb130-1651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1652"><a href="#cb130-1652" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1653"><a href="#cb130-1653" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1654"><a href="#cb130-1654" aria-hidden="true" tabindex="-1"></a>cld_pos_tbl <span class="ot">&lt;-</span> insects_tbl <span class="sc">|&gt;</span> </span>
<span id="cb130-1655"><a href="#cb130-1655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(timepoint, trt) <span class="sc">|&gt;</span> </span>
<span id="cb130-1656"><a href="#cb130-1656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">quant_3rd =</span> <span class="fu">quantile</span>(thripse, <span class="fl">0.75</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb130-1657"><a href="#cb130-1657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">group =</span> emm_cld_tbl<span class="sc">$</span>.group)</span>
<span id="cb130-1658"><a href="#cb130-1658" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1659"><a href="#cb130-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1660"><a href="#cb130-1660" aria-hidden="true" tabindex="-1"></a>In der @fig-log-mod-pois-insect-dotbox siehst du dann einmal das Ergebnis des Dot-Boxplot. Im Gegensatz zu dem anderen Beispiel sind die Daten hier etwas übersichtlicher was die Dotplots angeht. Dennoch sieht man hier teilweise sehr viel mehr. Zum einen wird die große Variabilität in den Daten klar. Teilweise sind die Unterschiede nur durch wenige Beobachtungen zu erklären, die die mittleren Raten nach oben ziehen. So sind in bei allen Dosen immer wieder sehr wenige Thrispen zu beobachten. Die Unterschiede kommen dann von wenigen großen Zählungen. Wenn diese ausbleiben, dann haben wir eher einen Unterschied. Die Aussagekraft von den Dot-Boxplots sind auf jeden Fall sehr viel höher als bei den einfachen Barplots.</span>
<span id="cb130-1661"><a href="#cb130-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1664"><a href="#cb130-1664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1665"><a href="#cb130-1665" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-1666"><a href="#cb130-1666" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1667"><a href="#cb130-1667" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1668"><a href="#cb130-1668" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-log-mod-pois-insect-dotbox</span></span>
<span id="cb130-1669"><a href="#cb130-1669" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-1670"><a href="#cb130-1670" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb130-1671"><a href="#cb130-1671" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb130-1672"><a href="#cb130-1672" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Dotplots und Boxplots der mittleren Zahl der Thripsen aus einer Quasipoissonregression mit einem gemischten Modell. Das `glmmTMB()`-Modell berechnet die mittlere Anzahl in jeder Faktorkombination. Durch die Darstellung in Dotplot und Boxplot ist die große Heterogenität in den Daten zu sehen. Das *compact letter display* wird dann in `{emmeans}` generiert."</span></span>
<span id="cb130-1673"><a href="#cb130-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1674"><a href="#cb130-1674" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(insects_tbl, <span class="fu">aes</span>(<span class="at">x =</span> timepoint, <span class="at">y =</span> thripse, <span class="at">fill =</span> trt)) <span class="sc">+</span> </span>
<span id="cb130-1675"><a href="#cb130-1675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mittlere Anzahl an Thripsen"</span>, <span class="at">x =</span> <span class="st">"Messzeitpunkte der Zählungen"</span>,</span>
<span id="cb130-1676"><a href="#cb130-1676" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Dosis"</span>) <span class="sc">+</span></span>
<span id="cb130-1677"><a href="#cb130-1677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_half_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> trt), </span>
<span id="cb130-1678"><a href="#cb130-1678" aria-hidden="true" tabindex="-1"></a>                  <span class="at">transformation =</span> <span class="fu">position_quasirandom</span>(<span class="at">width =</span> <span class="fl">0.05</span>),</span>
<span id="cb130-1679"><a href="#cb130-1679" aria-hidden="true" tabindex="-1"></a>                  <span class="at">side =</span> <span class="st">"l"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb130-1680"><a href="#cb130-1680" aria-hidden="true" tabindex="-1"></a>                  <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb130-1681"><a href="#cb130-1681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_half_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> trt), </span>
<span id="cb130-1682"><a href="#cb130-1682" aria-hidden="true" tabindex="-1"></a>                    <span class="at">side =</span> <span class="st">"r"</span>, <span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">outlier.size =</span> <span class="fl">0.8</span>,</span>
<span id="cb130-1683"><a href="#cb130-1683" aria-hidden="true" tabindex="-1"></a>                    <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span> </span>
<span id="cb130-1684"><a href="#cb130-1684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> cld_pos_tbl, <span class="fu">aes</span>(<span class="at">label =</span> group, <span class="at">y =</span> quant_3rd <span class="sc">+</span> <span class="dv">5</span>),</span>
<span id="cb130-1685"><a href="#cb130-1685" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb130-1686"><a href="#cb130-1686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span> <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb130-1687"><a href="#cb130-1687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) </span>
<span id="cb130-1688"><a href="#cb130-1688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1689"><a href="#cb130-1689" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-1690"><a href="#cb130-1690" aria-hidden="true" tabindex="-1"></a>:::::</span>
<span id="cb130-1691"><a href="#cb130-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1692"><a href="#cb130-1692" aria-hidden="true" tabindex="-1"></a>:::: callout-tip</span>
<span id="cb130-1693"><a href="#cb130-1693" aria-hidden="true" tabindex="-1"></a><span class="fu">## Anwendungsbeispiel: Gruppenvergleich für Boniturnoten von Schweinen (3-faktoriell)</span></span>
<span id="cb130-1694"><a href="#cb130-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1695"><a href="#cb130-1695" aria-hidden="true" tabindex="-1"></a>In dem folgenden agrawissenschaftlichen Beispiel wollen wir uns einmal die Auswertung von verschiedenen Schweinerassen im Bezug auf ihre Fußgesundheit in zwei Platzangeboten in Ställen anschauen. Die Ställe haben dabei zwei Arten von Belegung vorliegen, nämlich einmal eine weite Belegung und einmal eine enge Belegung. Darüber hinaus ist die Studie in verschiedenen Ställen und und verschiedenen Orten durchgeführt worden. Es ergibt sich also ein recht komplexer Datensatz. Dabei sind die Ställe <span class="in">`barn`</span> auf den Höfe <span class="in">`location`</span> genestet. Darüber hinaus haben wir eine Behandlung <span class="in">`spacing`</span> sowie die verschiedenen Schweinerassen <span class="in">`breed`</span>. Ich habe hier nur eine Auswahl an Schweinerassen getroffen, da mir sonst das <span class="in">`clmm()`</span>-Modell zu lange dauert bis es gerechnet ist. Wir brauchen dann später für unser <span class="in">`clmm()`</span>-Modell das Outcome noch als geordneten Faktor. Wenn du den Code nutzt, dann kannst du gerne alle Schweinerassen mit in das Modell nehmen. Ebenfalls hilfreich ist das Tutorium <span class="co">[</span><span class="ot">Ordinal regression in R: part 1</span><span class="co">](https://tdunn.ca/posts/2020-03-15-ordinal-regression-in-r-part-1/)</span> auf das ich gerne verweisen möchte. Am Ende haben wir einen sehr großen Datensatz mit 2840 bonitierten Schweinen. Das sind wirklich eine Menge Schweine.</span>
<span id="cb130-1696"><a href="#cb130-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1699"><a href="#cb130-1699" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1700"><a href="#cb130-1700" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/bonitur_pig.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb130-1701"><a href="#cb130-1701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">breed =</span> <span class="fu">as_factor</span>(breed),</span>
<span id="cb130-1702"><a href="#cb130-1702" aria-hidden="true" tabindex="-1"></a>         <span class="at">spacing =</span> <span class="fu">factor</span>(spacing, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Weite Belegung"</span>, <span class="st">"Enge Belegung"</span>)),</span>
<span id="cb130-1703"><a href="#cb130-1703" aria-hidden="true" tabindex="-1"></a>         <span class="at">location =</span> <span class="fu">as_factor</span>(location),</span>
<span id="cb130-1704"><a href="#cb130-1704" aria-hidden="true" tabindex="-1"></a>         <span class="at">barn =</span> <span class="fu">as_factor</span>(barn),</span>
<span id="cb130-1705"><a href="#cb130-1705" aria-hidden="true" tabindex="-1"></a>         <span class="at">foot_inflamed_fct =</span> <span class="fu">ordered</span>(foot_inflamed)) <span class="sc">|&gt;</span> </span>
<span id="cb130-1706"><a href="#cb130-1706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(breed <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Vietnamese Pot-bellied"</span>, <span class="st">"Welsh"</span>, <span class="st">"Belarus Black Pied"</span>, <span class="st">"Saddleback"</span>, </span>
<span id="cb130-1707"><a href="#cb130-1707" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"American Yorkshire"</span>, <span class="st">"Bentheim Black Pied"</span>, <span class="st">"Mangalica"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb130-1708"><a href="#cb130-1708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb130-1709"><a href="#cb130-1709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1710"><a href="#cb130-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1711"><a href="#cb130-1711" aria-hidden="true" tabindex="-1"></a>Die Daten sehen wir dann auch nochmal in der @fig-clm-pig-violin als Violinplot visualisiert. Wir sehen, dass wir bei der Anzahl an Beobachtungen dann nichts mehr sehen. Die Violinplots mögen sich unterscheiden, aber so richtig gut erkennen, können wir hier eigentlich nicht. Auch lassen sich hier schwer halbe Abbildungen erstellen. Wir haben teilweise so viele Beobachtungen mit geringen Noten, dass wir kaum etwas erkennen können.</span>
<span id="cb130-1712"><a href="#cb130-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1715"><a href="#cb130-1715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1716"><a href="#cb130-1716" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-1717"><a href="#cb130-1717" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1718"><a href="#cb130-1718" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-clm-pig-violin</span></span>
<span id="cb130-1719"><a href="#cb130-1719" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-1720"><a href="#cb130-1720" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb130-1721"><a href="#cb130-1721" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb130-1722"><a href="#cb130-1722" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Violinplot der Boniturnoten für die Fußgesundheit der Schweinerassen aufgeteilt nach dem Platzangebot. Klar ist die sehr schiefe Verteilung der Boniturnoten zu erkennen."</span></span>
<span id="cb130-1723"><a href="#cb130-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1724"><a href="#cb130-1724" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pig_tbl, <span class="fu">aes</span>(breed, foot_inflamed, <span class="at">fill =</span> breed)) <span class="sc">+</span></span>
<span id="cb130-1725"><a href="#cb130-1725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb130-1726"><a href="#cb130-1726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb130-1727"><a href="#cb130-1727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb130-1728"><a href="#cb130-1728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb130-1729"><a href="#cb130-1729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> spacing, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb130-1730"><a href="#cb130-1730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb130-1731"><a href="#cb130-1731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb130-1732"><a href="#cb130-1732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Schweinerasse"</span>, <span class="at">y =</span> <span class="st">"Boniturnote"</span>)</span>
<span id="cb130-1733"><a href="#cb130-1733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1734"><a href="#cb130-1734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1735"><a href="#cb130-1735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1736"><a href="#cb130-1736" aria-hidden="true" tabindex="-1"></a>Wir rechnen jetzt eine ordinale gemischte Regression mit der Funktion <span class="in">`clmm()`</span>. Wir schreiben das Modell wie wir es schon kennen mit zwei festen und einem genesteten zufälligen Effekt. Wir betrachten auch die Interaktion zwischen den Schweinerassen und dem Platzangebot. Mich würde wundern wenn alle Schweinerassen auf das Platzangebot gleich reagieren würden. Dann müssen wir noch sichergehen das unser Outcome als Faktor mit der Spalte <span class="in">`foot_inflamed_fct`</span> kodiert ist, damit wir das Modell rechnen können.</span>
<span id="cb130-1737"><a href="#cb130-1737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1740"><a href="#cb130-1740" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1741"><a href="#cb130-1741" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb130-1742"><a href="#cb130-1742" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: mixed-clmm-model</span></span>
<span id="cb130-1743"><a href="#cb130-1743" aria-hidden="true" tabindex="-1"></a>clmm_fit <span class="ot">&lt;-</span> <span class="fu">clmm</span>(foot_inflamed_fct <span class="sc">~</span> breed <span class="sc">+</span> spacing <span class="sc">+</span> breed<span class="sc">:</span>spacing <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> location<span class="sc">/</span>barn), </span>
<span id="cb130-1744"><a href="#cb130-1744" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> pig_tbl)</span>
<span id="cb130-1745"><a href="#cb130-1745" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1746"><a href="#cb130-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1747"><a href="#cb130-1747" aria-hidden="true" tabindex="-1"></a>Wir nutzen das Modell <span class="in">`clmm_fit`</span> direkt für den Gruppenvergleich und übergehen einmal die Modelldiagnostik hier. Jetzt rechnen wir in den beiden folgenden Tabs einmal die ANOVA und dann auch den multiplen Gruppenvergleich mit <span class="in">`{emmeans}`</span>. Da wir hier ordinale Daten haben, können wir dann nicht einfach die Standardverfahren nehmen. Wir entscheiden uns dann für den Standardfehler bei der Darstellung.</span>
<span id="cb130-1748"><a href="#cb130-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1749"><a href="#cb130-1749" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb130-1750"><a href="#cb130-1750" aria-hidden="true" tabindex="-1"></a><span class="fu">## ANOVA mit `anova()`</span></span>
<span id="cb130-1751"><a href="#cb130-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1752"><a href="#cb130-1752" aria-hidden="true" tabindex="-1"></a>Wir rechnen hier einmal die ANOVA mit der Funktion <span class="in">`Anova.clmm()`</span> aus dem R Paket <span class="in">`{RVAideMemoire}`</span>. In dem Paket <span class="in">`{ordinal}`</span> ist keine ANOVA für den Gruppenvergleich implementiert. Wir machen dann die Ausgabe nochmal schöner und fertig sind wir.</span>
<span id="cb130-1753"><a href="#cb130-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1756"><a href="#cb130-1756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1757"><a href="#cb130-1757" aria-hidden="true" tabindex="-1"></a><span class="co">#| cache: true</span></span>
<span id="cb130-1758"><a href="#cb130-1758" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: mixed-clmm-model-anova</span></span>
<span id="cb130-1759"><a href="#cb130-1759" aria-hidden="true" tabindex="-1"></a>clmm_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1760"><a href="#cb130-1760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Anova.clmm</span>() <span class="sc">|&gt;</span></span>
<span id="cb130-1761"><a href="#cb130-1761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span>
<span id="cb130-1762"><a href="#cb130-1762" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1763"><a href="#cb130-1763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1764"><a href="#cb130-1764" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass die Schweinerasse signifikant ist. Ebenso hat der Abstand in den Ställen einen signifikanten Einfluss auf die Fußgesundheit. Wie es auch zu erwarten war, verhalten sich natürlich nicht alle Schweinerassen identisch im Bezug auf das Platzangebot und der Fußgesundheit. Es wäre auch sehr komisch, wenn wir hier keine Interaktion gehabt hätten. Wir werten also gleich mal die Boniturnoten getrennt für das Platzangebot aus. Auch hier müssen wir uns Fragen was ist mehr von Interesse, ich entscheide mich hier für die Rassen.</span>
<span id="cb130-1765"><a href="#cb130-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1766"><a href="#cb130-1766" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gruppenvergleich mit `emmeans()`</span></span>
<span id="cb130-1767"><a href="#cb130-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1768"><a href="#cb130-1768" aria-hidden="true" tabindex="-1"></a>Im Folgenden rechnen wir einmal für den Faktor <span class="in">`breed`</span> getrennt für die beiden Platzangebote <span class="in">`spacing`</span> einen Gruppenvergleich. Immerhin haben wir eine Interaktion vorliegen. Wir setzen hier die Option <span class="in">`mean.class`</span> damit wir dann die mittleren Noten wiedergegeben bekommen. Mit den mittleren Noten können wir dann ein Säulendiagramm erstellen. Dann adjustieren wir *nicht* und sind auch schon fertig. Warum adjustieren wir hier nicht? Wenn du hier adjustierst ist am Ende nichts mehr signifikant, da du so viele Gruppenvergleiche rechnest, das hier die $p$-Werte nicht klein genug werden. Irgendwo ist dann auch eine Grenze. Die Effekte sind hier nicht stark genug sein um sie dann noch signifikant nachzuweisen.</span>
<span id="cb130-1769"><a href="#cb130-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1772"><a href="#cb130-1772" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1773"><a href="#cb130-1773" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> clmm_fit <span class="sc">|&gt;</span> </span>
<span id="cb130-1774"><a href="#cb130-1774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> breed <span class="sc">|</span> spacing, <span class="at">mode =</span> <span class="st">"mean.class"</span>) <span class="sc">|&gt;</span></span>
<span id="cb130-1775"><a href="#cb130-1775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb130-1776"><a href="#cb130-1776" aria-hidden="true" tabindex="-1"></a>emm_obj</span>
<span id="cb130-1777"><a href="#cb130-1777" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1778"><a href="#cb130-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1779"><a href="#cb130-1779" aria-hidden="true" tabindex="-1"></a>Das <span class="in">`emm_obj`</span> Objekt werden wir dann gleich einmal in <span class="in">`{ggplot}`</span> visualisieren. Die <span class="in">`mean.class`</span> stellt den mittleren Noten der Fußgesundheit für die Menge die Rassen getrennt nach dem Platzangebot dar. Wir nutzen dann auch hier die Standardfehler für die Abbildungen, da wir sonst schnelle Werte kleiner 0 und größer 9 erhalten. Dann können wir zum Abschluss auch das *compact letter display* anhand der Abbildung interpretieren.</span>
<span id="cb130-1780"><a href="#cb130-1780" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb130-1781"><a href="#cb130-1781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1782"><a href="#cb130-1782" aria-hidden="true" tabindex="-1"></a>In der @fig-log-mod-ordinal-broc siehst du das Ergebnis der Auswertung in einem Säulendiagramm. In unserem Fall ist die weite Belegung nicht signifikant über die Rassen. Bei der engen Belegung sehen wir schon einige Unterschiede in der Benotung der Fußgesundheit. Die große Frage bleibt hier, ist der Effekt den wir sehen überhaupt relevant oder nicht? Immerhin haben wir sehr geringe mittlere Boniturnoten, die eventuell darüber hinwegtäuschen wie stark der Effekt eigentlich ist. Als Faustformel sage ich mir immer, dass ich eigentlich immer einen Notenschritt als Änderung sehen möchte. Sonst ist es eigentlich zu wenig um von einer Relevanz zu sprechen. Aber das ist eher eine Diskussion im Kontext der wissenschaftlichen Fragestellung als eine statistische Diskussion.</span>
<span id="cb130-1783"><a href="#cb130-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1786"><a href="#cb130-1786" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb130-1787"><a href="#cb130-1787" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb130-1788"><a href="#cb130-1788" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb130-1789"><a href="#cb130-1789" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb130-1790"><a href="#cb130-1790" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-log-mod-ordinal-broc</span></span>
<span id="cb130-1791"><a href="#cb130-1791" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb130-1792"><a href="#cb130-1792" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb130-1793"><a href="#cb130-1793" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb130-1794"><a href="#cb130-1794" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Säulendigramm der mittleren Boniturnote der Fußgesundheit aus einer ordinalen gemischten Regression. Das `clmm()`-Modell berechnet das mittlere Boniturnote für den Faktor `breed` getrennt für die beiden Platzangebote `spacing`. Das *compact letter display* wird dann in `{emmeans}` generiert. Fraglich bleibt, ob die Unterschiede wirklich relevant sind, da die mittleren Boniturnoten sehr nahe beieinander liegen."</span></span>
<span id="cb130-1795"><a href="#cb130-1795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1796"><a href="#cb130-1796" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb130-1797"><a href="#cb130-1797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb130-1798"><a href="#cb130-1798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> breed, <span class="at">y =</span> mean.class, <span class="at">fill =</span> breed)) <span class="sc">+</span></span>
<span id="cb130-1799"><a href="#cb130-1799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb130-1800"><a href="#cb130-1800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mittlere Boniturnote"</span>, <span class="at">x =</span> <span class="st">"Schweinerasse"</span>) <span class="sc">+</span></span>
<span id="cb130-1801"><a href="#cb130-1801" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb130-1802"><a href="#cb130-1802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">str_trim</span>(.group), <span class="at">y =</span> mean.class <span class="sc">+</span> SE <span class="sc">+</span> <span class="fl">0.01</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>,</span>
<span id="cb130-1803"><a href="#cb130-1803" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb130-1804"><a href="#cb130-1804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean.class<span class="sc">-</span>SE, <span class="at">ymax =</span> mean.class<span class="sc">+</span>SE),</span>
<span id="cb130-1805"><a href="#cb130-1805" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb130-1806"><a href="#cb130-1806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> spacing, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb130-1807"><a href="#cb130-1807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb130-1808"><a href="#cb130-1808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb130-1809"><a href="#cb130-1809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb130-1810"><a href="#cb130-1810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb130-1811"><a href="#cb130-1811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1812"><a href="#cb130-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1813"><a href="#cb130-1813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1814"><a href="#cb130-1814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb130-1815"><a href="#cb130-1815" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb130-1816"><a href="#cb130-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-1817"><a href="#cb130-1817" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-mixed.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-mixed.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
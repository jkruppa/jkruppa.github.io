<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>45&nbsp; Multiple lineare Regression – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-linear-reg-quality.html" rel="next">
<link href="./stat-linear-reg-basic.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="45&nbsp; Multiple lineare Regression – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-linear-reg-preface.html">Grundlagen des Modellierens</a></li><li class="breadcrumb-item"><a href="./stat-modeling-basic.html"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">45.1</span> Genutzte R Pakete</a></li>
  <li><a href="#sec-modell-matrix" id="toc-sec-modell-matrix" class="nav-link" data-scroll-target="#sec-modell-matrix"><span class="header-section-number">45.2</span> Die Modellmatrix in R</a>
  <ul class="collapse">
  <li><a href="#kontinuierliches-x" id="toc-kontinuierliches-x" class="nav-link" data-scroll-target="#kontinuierliches-x"><span class="header-section-number">45.2.1</span> Kontinuierliches <span class="math inline">\(x\)</span></a></li>
  <li><a href="#kategorielles-x-mit-2-leveln" id="toc-kategorielles-x-mit-2-leveln" class="nav-link" data-scroll-target="#kategorielles-x-mit-2-leveln"><span class="header-section-number">45.2.2</span> Kategorielles <span class="math inline">\(x\)</span> mit 2 Leveln</a></li>
  <li><a href="#kategorielles-x-mit-2-leveln-1" id="toc-kategorielles-x-mit-2-leveln-1" class="nav-link" data-scroll-target="#kategorielles-x-mit-2-leveln-1"><span class="header-section-number">45.2.3</span> Kategorielles <span class="math inline">\(x\)</span> mit &gt;2 Leveln</a></li>
  <li><a href="#das-volle-modell" id="toc-das-volle-modell" class="nav-link" data-scroll-target="#das-volle-modell"><span class="header-section-number">45.2.4</span> Das volle Modell</a></li>
  </ul></li>
  <li><a href="#sec-interpret-x" id="toc-sec-interpret-x" class="nav-link" data-scroll-target="#sec-interpret-x"><span class="header-section-number">45.3</span> Interpretation von <span class="math inline">\(x\)</span></a>
  <ul class="collapse">
  <li><a href="#sec-interpret-x-cont" id="toc-sec-interpret-x-cont" class="nav-link" data-scroll-target="#sec-interpret-x-cont"><span class="header-section-number">45.3.1</span> Kontinuierliches <span class="math inline">\(x\)</span></a></li>
  <li><a href="#sec-interpret-x-cat2" id="toc-sec-interpret-x-cat2" class="nav-link" data-scroll-target="#sec-interpret-x-cat2"><span class="header-section-number">45.3.2</span> Kategorielles <span class="math inline">\(x\)</span> mit 2 Leveln</a></li>
  <li><a href="#sec-interpret-x-cat3" id="toc-sec-interpret-x-cat3" class="nav-link" data-scroll-target="#sec-interpret-x-cat3"><span class="header-section-number">45.3.3</span> Kategorielles <span class="math inline">\(x\)</span> mit &gt;2 Leveln</a></li>
  </ul></li>
  <li><a href="#sec-confounder" id="toc-sec-confounder" class="nav-link" data-scroll-target="#sec-confounder"><span class="header-section-number">45.4</span> Adjustierung für Confounder</a></li>
  <li><a href="#sec-vif" id="toc-sec-vif" class="nav-link" data-scroll-target="#sec-vif"><span class="header-section-number">45.5</span> Variance inflation factor (VIF)</a></li>
  <li><a href="#sec-model-basic-compare" id="toc-sec-model-basic-compare" class="nav-link" data-scroll-target="#sec-model-basic-compare"><span class="header-section-number">45.6</span> Vergleich von Modellen</a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-basic.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-basic.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-linear-reg-preface.html">Grundlagen des Modellierens</a></li><li class="breadcrumb-item"><a href="./stat-modeling-basic.html"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-mult-reg-basic" class="quarto-section-identifier"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 21. February 2025 um 10:27:37</em></p>
<blockquote class="blockquote">
<p><em>“All models are approximations. Essentially, all models are wrong, but some are useful. However, the approximate nature of the model must always be borne in mind.” — George E. P. Box</em></p>
</blockquote>
<p>In dem vorherigen Kapitel haben wir uns mit der simplen linearen Regression beschäftigt. In diesem Kapitel wollen wir uns nun mit den Grundlagen der <em>multiplen</em> linearen Regression beschäftigen. Sagen, dass wir ein multiples lineares Modell vorliegen haben, wenn wir mehrere Einflussvariable <span class="math inline">\(x_1\)</span> bis <span class="math inline">\(x_p\)</span> vorliegen haben. Bei dem Outcome <span class="math inline">\(y\)</span>, was einer Verteilung folgt, ändert sich erstmal nichts. Wir wollen jetzt herausfinden, welchen Einfluss oder Effekt die Variablen <span class="math inline">\(x_1, ..., x_p\)</span> auf das Outcome <span class="math inline">\(y\)</span> hat. Sehr simple gesprochen legen wir eine Gerade durch eine <em>mehrdimensionale</em> Punktewolke. Wir konzentrieren uns hier in diesem Kapitel auf nur normalverteilte Outcomes. Später kannst du dann aber auch andere Verteilungsfamilien modellieren.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/angel_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Wenn du jetzt denkst ‘Hä? Was soll denn mehrdimensional bedeuten?’, dann besuche doch einmal die fantastische Seite <a href="https://setosa.io/ev/ordinary-least-squares-regression/">Explained Visually | Ordinary Least Squares Regression</a> um selber zu erfahren, was eine multiple lineare Regression macht. Auf der Seite findest du interaktive Abbildungen, die dir das Konzept der linearen Regression sehr anschaulich nachvollziehen lassen.</p>
</blockquote>
</div>
</div>
</div>
<p>Wir erinnern und nochmal, das ein <em>simples</em> lineares Modell nur ein <span class="math inline">\(x_1\)</span> hat:</p>
<p><span class="math display">\[
y \sim x_1
\]</span></p>
<p>Ein <em>multiples</em> lineares Modell hat von <span class="math inline">\(x_1\)</span> bis <span class="math inline">\(x_p\)</span> Einflussvariablen:</p>
<p><span class="math display">\[
y \sim x_1 + x_2 + ... + x_p
\]</span></p>
<p>Wir brauchen viele der Konzepte aus den vorherigen Kapiteln zur Modellgüte sowie Konfidenzintervallen. Vieles fällt hier zusammen. Schau dir ruhig nochmal die vorherigen Kapitel an, wenn dir etwas unklar ist. Häufig wollen wir auch etwas spezifischer sein. Wir schreiben daher einen Faktor mit einem <span class="math inline">\(f\)</span> wie folgt.</p>
<p><span class="math display">\[
y \sim f_1
\]</span></p>
<p>Wenn wir dann noch einen Block mit hinzunehmen, dann erweitern wir das Modell um einen Blockfaktor mit einem <span class="math inline">\(b\)</span> wie folgt.</p>
<p><span class="math display">\[
y \sim f_1 + b_1
\]</span></p>
<p>Es kann auch sein, dass wir noch einen zufälligen Effekt (eng. <em>random effect</em>) mit in das Modell nehmen wollen. Wir bezeichnen einen zufälligen Effekt mit einem <span class="math inline">\(z\)</span> wie folgt.</p>
<p><span class="math display">\[
y \sim f_1 + z_1
\]</span></p>
<p>Oder konkreter können wir sagen, dass <code>jump_length</code> von <code>animal</code>, <code>sex</code> und <code>weight</code> abhängt und wir diesen Zusammenhang modellieren wollen.</p>
<p><span class="math display">\[
jump\_length \sim animal + sex + weight
\]</span></p>
<p>Das hilft uns jetzt nur bedingt, denn wir wollen ja aus einer Modellierung in R die Koeffizienten der Regression wiederbekommen. Dafür müssen wir uns nochmal klar werden, was die Koeffizienten einer Regression sind. Das sind zum einen der y-Achsenabschnitt <span class="math inline">\(\beta_0\)</span> und die Steigung der einzelnen Variablen mit <span class="math inline">\(\beta_1\)</span> bis <span class="math inline">\(\beta_p\)</span>. Wir erhalten auch bei einem multiplen Regressionsmodell nur einen Vektor mit den Residuen wieder.</p>
<p><span class="math display">\[
y \sim \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_p x_p + \epsilon
\]</span></p>
<p>Dennoch sind die Residuen <span class="math inline">\(\epsilon\)</span> normalverteilt. Wir haben im Mittel einen Abstand der <span class="math inline">\(\epsilon\)</span>’s zur geraden von 0 und eine Streuung von <span class="math inline">\(s^2_{\epsilon}\)</span>.</p>
<p><span class="math display">\[
\epsilon \sim \mathcal{N}(0, s^2_{\epsilon})
\]</span></p>
<p>Wir zeichen im Prinzip eine Gerade durch den <span class="math inline">\(p\)</span>-dimensionellen Raum.</p>
<p>In diesem Kapitel wollen wir uns nun folgende Aspekte einmal genauer anschauen. Wir gehen hier nicht so sehr auf den theoretischen Hintergrund ein, wollen aber verstehen wie wir die Statistik nutzen und anwenden können.</p>
<ul>
<li>Wir besprechen die Modellmatrix in <a href="#sec-modell-matrix" class="quarto-xref"><span>Kapitel 45.2</span></a>. Wir wollen uns Fragen, wie R eigentlich zu den Koeffizienten der Regressionsgleichung kommt.</li>
<li>Wir besprechen die Interpretation der Koeffizienten der linearen Regression in <a href="#sec-interpret-x" class="quarto-xref"><span>Kapitel 45.3</span></a>.</li>
<li>Wir fragen uns, was sind eigentlich Confounder (deu. <em>Verwechsler</em>) im <a href="#sec-confounder" class="quarto-xref"><span>Kapitel 45.4</span></a>.</li>
<li>Wir fragen uns, was ist eigentlich ein Variance Inflation Factor (VIF) für kontinuierliche <span class="math inline">\(x\)</span> in <a href="#sec-vif" class="quarto-xref"><span>Kapitel 45.5</span></a>.</li>
<li>Wir besprechen, wie wir verschiedene Modelle miteinander vergleichen können in <a href="#sec-model-basic-compare" class="quarto-xref"><span>Kapitel 45.6</span></a>.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die multiple lineare Regression
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir immer geht natürlich mehr als ich hier Vorstellen kann. Du findest im Folgenden Tutorien, die mich hier in dem Kapitel inspiriert haben. Ich habe mich ja in diesem Kapitel auf die Durchführbarkeit in R und die allgemeine Verständlichkeit konzentriert. Es geht aber natürlich wie immer auch mathematischer…</p>
<ul>
<li>Wir funktioniert nun so eine lineare Regression und was sind den jetzt eigentlich die Koeffizienten <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span> eigentlich? Hier gibt es die fantastische Seite <a href="https://setosa.io/ev/ordinary-least-squares-regression/">Explained Visually | Ordinary Least Squares Regression</a>, die dir nochmal erlaubt selbe mit Punkten in einem Scatterplot zu spielen und zu sehen wie sich dann die Regressionsgleichung ändert.</li>
<li>Das Buch <a href="https://www.tmwr.org/">Tidy Modeling with R</a> gibt nochmal einen tieferen Einblick in das Modellieren in R. Wir immer, es ist ein Vorschlag aber kein Muss.</li>
</ul>
</div>
</div>
<section id="genutzte-r-pakete" class="level2" data-number="45.1">
<h2 data-number="45.1" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">45.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, broom,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               see, performance, car, parameters,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               conflicted)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(magrittr<span class="sc">::</span>set_names)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="sec-modell-matrix" class="level2" data-number="45.2">
<h2 data-number="45.2" class="anchored" data-anchor-id="sec-modell-matrix"><span class="header-section-number">45.2</span> Die Modellmatrix in R</h2>
<p>Als erstes wollen wir verstehen, wie ein Modell <em>in</em> R aussieht. Dann können wir auch besser verstehen, wie die eigentlichen Koeffizienten aus dem Modell entstehen. Wozu brauche ich das? Eine gute Frage. Du brauchst das Verständnis der Modellmatrix, wenn du verstehen willst <em>wie</em> R in einer linearen Regression zu den Koeffizienten kommt. Wir bauen uns dafür ein sehr simplen Datensatz. Wir bauen uns einen Datensatz mit Schlangen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>snake_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">svl =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">45</span>, <span class="dv">39</span>, <span class="dv">51</span>, <span class="dv">52</span>, <span class="dv">57</span>, <span class="dv">58</span>, <span class="dv">49</span>),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mass =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">10</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="fu">as_factor</span>(<span class="fu">c</span>(<span class="st">"west"</span>,<span class="st">"west"</span>, <span class="st">"west"</span>, <span class="st">"nord"</span>,<span class="st">"nord"</span>,<span class="st">"nord"</span>,<span class="st">"nord"</span>,<span class="st">"nord"</span>)),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">as_factor</span>(<span class="fu">c</span>(<span class="st">"schwarz"</span>, <span class="st">"schwarz"</span>, <span class="st">"rot"</span>, <span class="st">"rot"</span>, <span class="st">"rot"</span>, <span class="st">"blau"</span>, <span class="st">"blau"</span>, <span class="st">"blau"</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#tbl-snakes" class="quarto-xref">Tabelle&nbsp;<span>45.1</span></a> ist der Datensatz <code>snake_tbl</code> nochmal dargestellt. Wir haben die Schlangenlänge <code>svl</code> als Outcome <span class="math inline">\(y\)</span> sowie das Gewicht der Schlangen <code>mass</code>, die Sammelregion <code>region</code> und die Farbe der Schlangen <code>color</code>. Dabei ist <code>mass</code> eine kontinuierliche Variable, <code>region</code> eine kategorielle Variable als Faktor mit zwei Leveln und <code>color</code> eine kategorielle Variable als Faktor mit drei Leveln.</p>
<div class="cell">
<div id="tbl-snakes" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-snakes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.1— Datensatz zu Schlangen ist entlehnt und modifiiert nach Kéry <span class="citation" data-cites="kery2010introduction">(<a href="#ref-kery2010introduction" role="doc-biblioref">2010</a>, p.&nbsp;77)</span>
</figcaption>
<div aria-describedby="tbl-snakes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">svl</th>
<th style="text-align: center;">mass</th>
<th style="text-align: center;">region</th>
<th style="text-align: center;">color</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">40</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">west</td>
<td style="text-align: center;">schwarz</td>
</tr>
<tr class="even">
<td style="text-align: center;">45</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">west</td>
<td style="text-align: center;">schwarz</td>
</tr>
<tr class="odd">
<td style="text-align: center;">39</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">west</td>
<td style="text-align: center;">rot</td>
</tr>
<tr class="even">
<td style="text-align: center;">51</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">rot</td>
</tr>
<tr class="odd">
<td style="text-align: center;">52</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">rot</td>
</tr>
<tr class="even">
<td style="text-align: center;">57</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">blau</td>
</tr>
<tr class="odd">
<td style="text-align: center;">58</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">blau</td>
</tr>
<tr class="even">
<td style="text-align: center;">49</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">blau</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Wir wollen uns nun einmal anschauen, wie ein Modell in R sich zusammensetzt. Je nachdem welche Spalte <span class="math inline">\(x\)</span> wir verwenden um den Zusammenhang zum <span class="math inline">\(y\)</span> aufzuzeigen.</p>
<section id="kontinuierliches-x" class="level3" data-number="45.2.1">
<h3 data-number="45.2.1" class="anchored" data-anchor-id="kontinuierliches-x"><span class="header-section-number">45.2.1</span> Kontinuierliches <span class="math inline">\(x\)</span></h3>
<p>Im ersten Schritt wollen wir uns einmal das Modell mit einem kontinuierlichen <span class="math inline">\(x\)</span> anschauen. Daher bauen wir uns ein lineares Modell mit der Variable <code>mass</code>. Wir erinnern uns, dass <code>mass</code> eine kontinuierliche Variable ist, da wir hier nur Zahlen in der Spalte finden. Die Funktion <code>model.matrix()</code> gibt uns die Modellmatrix wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> mass, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  `(Intercept)`  mass
          &lt;dbl&gt; &lt;dbl&gt;
1             1     6
2             1     8
3             1     5
4             1     7
5             1     9
6             1    11
7             1    12
8             1    10</code></pre>
</div>
</div>
<p>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalte <code>mass</code> als kontinuierliche Variable.</p>
<p>Wir können die Modellmatrix auch mathematisch schreiben und die <span class="math inline">\(y\)</span> Spalte für das Outcome <code>svl</code> ergänzen. Eben so ergänzen wir die <span class="math inline">\(\beta\)</span>-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Gerade.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp; 6 \\
  1 &amp; 8 \\
  1 &amp; 5 \\
  1 &amp; 7 \\
  1 &amp; 9 \\
  1 &amp; 11\\
  1 &amp; 12\\
  1 &amp; 10\\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta_{mass}
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<p>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt mit der Funktion <code>lm()</code> fitten. Wir nutzen dann die Funktion <code>coef()</code> um uns die Koeffizienten aus dem Objekt <code>fit_1</code> wiedergeben zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> mass, <span class="at">data =</span> snake_tbl) </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        mass 
      26.71        2.61 </code></pre>
</div>
</div>
<p>Die Funktion <code>residuals()</code> gibt uns die Residuen der Geraden aus dem Objekt <code>fit_1</code> wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
-2.36 -2.57 -0.75  6.04  1.82  1.61  0.00 -3.79 </code></pre>
</div>
</div>
<p>Wir können jetzt die Koeffizienten in die Modellmatrix ergänzen. Wir haben den Intercept mit <span class="math inline">\(\beta_0 = 26.71\)</span> geschätzt. Weiter ergänzen wir die Koeffizienten aus dem linearen Modell für <code>mass</code> mit <span class="math inline">\(\beta_{mass}=2.61\)</span>. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein. Wir erhalten dann folgende ausgefüllte Gleichung mit den Matrixen.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  26.71 &amp; \phantom{0}6 \cdot 2.61\\
  26.71 &amp; \phantom{0}8 \cdot 2.61\\
  26.71 &amp; \phantom{0}5 \cdot 2.61\\
  26.71 &amp; \phantom{0}7 \cdot 2.61\\
  26.71 &amp; \phantom{0}9 \cdot 2.61\\
  26.71 &amp; 11\cdot 2.61\\
  26.71 &amp; 12\cdot 2.61\\
  26.71 &amp; 10\cdot 2.61\\
\end{pmatrix}
  +
  \begin{pmatrix}
  -2.36\\
  -2.57\\
  -0.75 \\
  +6.04\\
  +1.82\\
  +1.61\\
  \phantom{+}0.00\\
  -3.79\\
\end{pmatrix}
\]</span></p>
<p>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis. Wie du siehst ergänzen wir hier noch eine Reihe von <span class="math inline">\(+\)</span> um den Intercept mit der Steigung zu verbinden. Steht ja auch so in der Gleichung des linearen Modells drin, alles wird mit einem <span class="math inline">\(+\)</span> miteinander verbunden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">6</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">2.36</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">8</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">2.57</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">5</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">0.75</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">7</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">6.04</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">9</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">1.82</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span> <span class="dv">11</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">1.61</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">3.79</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 57 58 49</code></pre>
</div>
</div>
<p>Oh ha! Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Outcome <span class="math inline">\(y\)</span> hat. Das heißt, die ganze Sache hat funktioniert.</p>
</section>
<section id="kategorielles-x-mit-2-leveln" class="level3" data-number="45.2.2">
<h3 data-number="45.2.2" class="anchored" data-anchor-id="kategorielles-x-mit-2-leveln"><span class="header-section-number">45.2.2</span> Kategorielles <span class="math inline">\(x\)</span> mit 2 Leveln</h3>
<p>Im diesem Schritt wollen wir uns einmal das Modell mit einem kategoriellen <span class="math inline">\(x\)</span> mit 2 Leveln anschauen. Wir bauen uns ein Modell mit der Variable <code>region``. Die Funktion</code>model.matrix()` gibt uns die Modelmatrix wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> region, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  `(Intercept)` regionnord
          &lt;dbl&gt;      &lt;dbl&gt;
1             1          0
2             1          0
3             1          0
4             1          1
5             1          1
6             1          1
7             1          1
8             1          1</code></pre>
</div>
</div>
<p>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalte <code>regionnord</code>. In dieser Spalte steht die Dummykodierung für die Variable <code>region</code>. Die ersten drei Schlangen kommen nicht aus der Region <code>nord</code> und werden deshalb mit einen Wert von 0 versehen. Die nächsten vier Schlangen kommen aus der Region <code>nord</code> und erhalten daher eine 1 in der Spalte.</p>
<p>Wir können die Modellmatrix auch mathematisch schreiben und die <span class="math inline">\(y\)</span> Spalte für das Outcome <code>svl</code> ergänzen. Eben so ergänzen wir die <span class="math inline">\(\beta\)</span>-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Gerade.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp;  0  \\
  1 &amp;  0 \\
  1 &amp;  0\\
  1 &amp;  1\\
  1 &amp;  1 \\
  1 &amp;  1 \\
  1 &amp;  1 \\
  1 &amp;  1 \\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta^{region}_{nord} \\
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<p>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <code>coef()</code> um uns die Koeffizienten wiedergeben zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> region, <span class="at">data =</span> snake_tbl) </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)  regionnord 
      41.33       12.07 </code></pre>
</div>
</div>
<p>Die Funktion <code>residuals()</code> gibt uns die Residuen der Geraden aus dem Objekt <code>fit_2</code> wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
-1.33  3.67 -2.33 -2.40 -1.40  3.60  4.60 -4.40 </code></pre>
</div>
</div>
<p>Wir können jetzt die Koeffizienten ergänzen mit <span class="math inline">\(\beta_0 = 41.33\)</span> für den Intercept. Weiter ergänzen wir die Koeffizienten für die Region und das Level <code>nord</code> mit <span class="math inline">\(\beta^{region}_{nord} = 12.07\)</span>. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  41.33 &amp; 0 \cdot 12.07  \\
  41.33 &amp; 0 \cdot 12.07  \\
  41.33 &amp; 0 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
  41.33 &amp; 1 \cdot 12.07  \\
\end{pmatrix} +
  \begin{pmatrix}
  -1.33\\
  +3.67 \\
  -2.33 \\
  -2.40 \\
  -1.40 \\
  +3.60 \\
  +4.60 \\
  -4.40 \\
\end{pmatrix}
\]</span></p>
<p>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">1.33</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">+</span> <span class="fl">3.67</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">2.33</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">2.40</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">1.40</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">+</span> <span class="fl">3.60</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">+</span> <span class="fl">4.60</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">4.40</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 57 58 49</code></pre>
</div>
</div>
<p>Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Outcome <span class="math inline">\(y\)</span> hat.</p>
</section>
<section id="kategorielles-x-mit-2-leveln-1" class="level3" data-number="45.2.3">
<h3 data-number="45.2.3" class="anchored" data-anchor-id="kategorielles-x-mit-2-leveln-1"><span class="header-section-number">45.2.3</span> Kategorielles <span class="math inline">\(x\)</span> mit &gt;2 Leveln</h3>
<p>Im diesem Schritt wollen wir uns einmal das Modell mit einem kategoriellen <span class="math inline">\(x\)</span> mit &gt;2 Leveln anschauen. Wir bauen uns ein Modell mit der Variable <code>color</code>. Die Funktion <code>model.matrix()</code> gibt uns die Modelmatrix wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> color, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  `(Intercept)` colorrot colorblau
          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1             1        0         0
2             1        0         0
3             1        1         0
4             1        1         0
5             1        1         0
6             1        0         1
7             1        0         1
8             1        0         1</code></pre>
</div>
</div>
<p>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalten für <code>color</code>. Die Spalten <code>colorrot</code> und <code>colorblau</code> geben jeweils an, ob die Schlange das Level <code>rot</code> hat oder <code>blau</code> oder keins von beiden. Wenn die Schlange weder rot noch blau ist, dann sind beide Spalten mit einer 0 versehen. Dann ist die Schlange schwarz.</p>
<p>Wir können die Modellmatrix auch mathematisch schreiben und die <span class="math inline">\(y\)</span> Spalte für das Outcome <code>svl</code> ergänzen. Eben so ergänzen wir die <span class="math inline">\(\beta\)</span>-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Gerade.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp; 0 &amp; 0 \\
  1 &amp; 0 &amp; 0\\
  1 &amp; 1 &amp; 0\\
  1 &amp; 1 &amp; 0\\
  1 &amp; 1 &amp; 0\\
  1 &amp; 0 &amp; 1\\
  1 &amp; 0 &amp; 1\\
  1 &amp; 0 &amp; 1\\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta^{color}_{rot} \\
  \beta^{color}_{blau} \\
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<p>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <code>coef()</code> um uns die Koeffizienten wiedergeben zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> color, <span class="at">data =</span> snake_tbl) </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)    colorrot   colorblau 
      42.50        4.83       12.17 </code></pre>
</div>
</div>
<p>Die Funktion <code>residuals()</code> gibt uns die Residuen der Geraden aus dem Objekt <code>fit_3</code> wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
-2.50  2.50 -8.33  3.67  4.67  2.33  3.33 -5.67 </code></pre>
</div>
</div>
<p>Wir können jetzt die Koeffizienten ergänzen mit <span class="math inline">\(\beta_0 = 25\)</span> für den Intercept. Weiter ergänzen wir die Koeffizienten für die Farbe und das Level <code>rot</code> mit <span class="math inline">\(\beta^{color}_{rot} = 4.83\)</span> und für die Farbe und das Level <code>blau</code> mit <span class="math inline">\(\beta^{color}_{blau} = 12.17\)</span>. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  42.50 &amp; 0 \cdot 4.83&amp; 0 \cdot 12.17 \\
  42.50 &amp; 0 \cdot 4.83&amp; 0 \cdot 12.17\\
  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17\\
  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17\\
  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17\\
  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17\\
  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17\\
  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17\\
\end{pmatrix} +
  \begin{pmatrix}
  -2.50 \\
  +2.50 \\
  -8.33 \\
  +3.67 \\
  +4.67 \\
  +2.33 \\
  +3.33 \\
  -5.67 \\
\end{pmatrix}
\]</span></p>
<p>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">-</span> <span class="fl">2.50</span>,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">2.50</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">-</span> <span class="fl">8.33</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">3.67</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">4.67</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">2.33</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">3.33</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">-</span> <span class="fl">5.67</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 33 34 25</code></pre>
</div>
</div>
<p>Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Outcome <span class="math inline">\(y\)</span> hat.</p>
</section>
<section id="das-volle-modell" class="level3" data-number="45.2.4">
<h3 data-number="45.2.4" class="anchored" data-anchor-id="das-volle-modell"><span class="header-section-number">45.2.4</span> Das volle Modell</h3>
<p>Im letzten Schritt wollen wir uns einmal das volle Modell anschauen. Wir bauen uns ein Modell mit allen Variablen in dem Datensatz <code>snake_tbl</code>. Die Funktion <code>model.matrix()</code> gibt uns die Modelmatrix wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> mass <span class="sc">+</span> region <span class="sc">+</span> color, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  `(Intercept)`  mass regionnord colorrot colorblau
          &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1             1     6          0        0         0
2             1     8          0        0         0
3             1     5          0        1         0
4             1     7          1        1         0
5             1     9          1        1         0
6             1    11          1        0         1
7             1    12          1        0         1
8             1    10          1        0         1</code></pre>
</div>
</div>
<p>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalte <code>mass</code> als kontenuierliche Variable. In der Spalte <code>regionnord</code> steht die Dummykodierung für die Variable <code>region</code>. Die ersten drei Schlangen kommen nicht aus der Region <code>nord</code> und werden deshalb mit einen Wert von 0 versehen. Die nächsten vier Schlangen kommen aus der Region <code>nord</code> und erhalten daher eine 1 in der Spalte. Die nächsten beiden Spalten sind etwas komplizierter. Die Spalten <code>colorrot</code> und <code>colorblau</code> geben jeweils an, ob die Schlange das Level <code>rot</code> hat oder <code>blau</code> oder keins von beiden. Wenn die Schlange weder rot noch blau ist, dann sind beide Spalten mit einer 0 versehen. Dann ist die Schlange schwarz.</p>
<p>Wir können die Modellmatrix auch mathematisch schreiben und die <span class="math inline">\(y\)</span> Spalte für das Outcome <code>svl</code> ergänzen. Eben so ergänzen wir die <span class="math inline">\(\beta\)</span>-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Gerade.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp; 6 &amp; 0 &amp; 0 &amp; 0 \\
  1 &amp; 8 &amp; 0 &amp; 0 &amp; 0\\
  1 &amp; 5 &amp; 0 &amp; 1 &amp; 0\\
  1 &amp; 7 &amp; 1 &amp; 1 &amp; 0\\
  1 &amp; 9 &amp; 1 &amp; 1 &amp; 0\\
  1 &amp; 11&amp; 1 &amp; 0 &amp; 1\\
  1 &amp; 12&amp; 1 &amp; 0 &amp; 1\\
  1 &amp; 10&amp; 1 &amp; 0 &amp; 1\\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta_{mass} \\
  \beta^{region}_{nord} \\
  \beta^{color}_{rot} \\
  \beta^{color}_{blau} \\
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<p>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <code>coef()</code> um uns die Koeffizienten wiedergeben zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> mass <span class="sc">+</span> region <span class="sc">+</span> color, <span class="at">data =</span> snake_tbl) </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        mass  regionnord    colorrot   colorblau 
      25.00        2.50        5.00        1.50       -2.83 </code></pre>
</div>
</div>
<p>Die Funktion <code>residuals()</code> gibt uns die Residuen der Geraden aus dem Objekt <code>fit_4</code> wieder.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
 0.00  0.00  0.00  2.00 -2.00  2.33  0.83 -3.17 </code></pre>
</div>
</div>
<p>Wir können jetzt die Koeffizienten ergänzen mit <span class="math inline">\(\beta_0 = 25\)</span> für den Intercept. Weiter ergänzen wir die Koeffizienten für <code>mass</code> mit <span class="math inline">\(\beta_{mass}=2.5\)</span>, für Region und das Level <code>nord</code> mit <span class="math inline">\(\beta^{region}_{nord} = 5\)</span>, für die Farbe und das Level <code>rot</code> mit <span class="math inline">\(\beta^{color}_{rot} = 1.5\)</span> und für die Farbe und das Level <code>blau</code> mit <span class="math inline">\(\beta^{color}_{blau} = -2.83\)</span>. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein.</p>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  59 \\
\end{pmatrix}
=
  \begin{pmatrix}
  25 &amp; \phantom{0}6 \cdot 2.5 &amp; 0 \cdot 5 &amp; 0 \cdot 1.5&amp; 0 \cdot -2.83 \\
  25 &amp; \phantom{0}8 \cdot 2.5 &amp; 0 \cdot 5 &amp; 0 \cdot 1.5&amp; 0 \cdot -2.83\\
  25 &amp; \phantom{0}5 \cdot 2.5 &amp; 0 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83\\
  25 &amp; \phantom{0}7 \cdot 2.5 &amp; 1 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83\\
  25 &amp; \phantom{0}9 \cdot 2.5 &amp; 1 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83\\
  25 &amp; 11\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83\\
  25 &amp; 12\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83\\
  25 &amp; 10\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83\\
\end{pmatrix} +
  \begin{pmatrix}
  \phantom{+}0.00 \\
  \phantom{+}0.00 \\
  \phantom{+}0.00 \\
  +2.00 \\
  -2.00 \\
  +2.33 \\
  +0.83 \\
  -3.17 \\
\end{pmatrix}
\]</span></p>
<p>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">25</span> <span class="sc">+</span>  <span class="dv">6</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">8</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">5</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">7</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">2.00</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">9</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">-</span> <span class="fl">2.00</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span> <span class="dv">11</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">2.33</span>,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.83</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">-</span> <span class="fl">3.17</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 57 58 49</code></pre>
</div>
</div>
<p>Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Outcome <span class="math inline">\(y\)</span> hat. Was haben wir gelernt?</p>
<ul>
<li>In einem Modell gibt es immer ein Faktorlevel weniger als ein Faktor Level hat. Die Information des <em>alphanumerisch</em> ersten Levels steckt dann mit in dem Intercept.</li>
<li>In einem Modell geht eine kontinuierliche Variable als eine Spalte mit ein.</li>
<li>In einem Modell gibt es immer nur eine Spalte für die Residuen und damit nur eine Residue für jede Beobachtung, egal wie viele Variablen ein Modell hat.</li>
</ul>
</section>
</section>
<section id="sec-interpret-x" class="level2" data-number="45.3">
<h2 data-number="45.3" class="anchored" data-anchor-id="sec-interpret-x"><span class="header-section-number">45.3</span> Interpretation von <span class="math inline">\(x\)</span></h2>
<p>Wi interpretiee wir nun das Ergebnis einer linearen Regression? Zum einen nutzen wir häufig das Modell nur um das Modell dann weiter in einem multiplen Vergleich zu nutzen. Hier wollen wir uns jetzt aber wirklich die Koeffizienten aus einer multiplen linearen Regression anschauen udn diese Zahlen einmal interpretieren. Wichtig ist, dass wir ein normalverteiltes <span class="math inline">\(y\)</span> vorliegen haben und uns verschiedene Formen des <span class="math inline">\(x\)</span> anschauen. Wir betrachten ein kontinuierliches <span class="math inline">\(x\)</span>, ein kategorielles <span class="math inline">\(x\)</span> mit zwei Leveln und ein kategorielles <span class="math inline">\(x\)</span> mit drei oder mehr Leveln.</p>
<section id="sec-interpret-x-cont" class="level3" data-number="45.3.1">
<h3 data-number="45.3.1" class="anchored" data-anchor-id="sec-interpret-x-cont"><span class="header-section-number">45.3.1</span> Kontinuierliches <span class="math inline">\(x\)</span></h3>
<p>Bauen wir uns also einmal einen Datensatz mit einem kontinuierlichen <span class="math inline">\(x\)</span> und einem normalverteilten <span class="math inline">\(y\)</span>. Unser <span class="math inline">\(x\)</span> soll von 1 bis 7 laufen. Wir erschaffen uns das <span class="math inline">\(y\)</span> indem wir das <span class="math inline">\(x\)</span> mit 1.5 multiplizieren, den <span class="math inline">\(y\)</span>-Achsenabschnitt von 5 addieren und einen zufälligen Fehler aus einer Normalverteilung mit <span class="math inline">\(\mathcal{N}(0, 1)\)</span> aufaddieren. Wir haben also eine klassische Regressionsgleichung mit <span class="math inline">\(y = 5 + 1.5 \cdot x\)</span>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20137937</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>cont_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">7</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>cont_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
      x     y
  &lt;dbl&gt; &lt;dbl&gt;
1     1  5.93
2     2  8.06
3     3  8.95
4     4 12.1 
5     5 11.9 
6     6 14.9 
7     7 16.3 </code></pre>
</div>
</div>
<p>Wenn wir keinen Fehler addieren würden, dann hätten wir auch eine Linie von Punkten wie an einer Perlschnur aufgereiht. Dann wäre das <span class="math inline">\(R^2 = 1\)</span> und wir hätten keine Varianz in den Daten. Das ist aber in einem biologischen Setting nicht realistisch, dass unser <span class="math inline">\(y\)</span> vollständig von <span class="math inline">\(x\)</span> erklärt wird.</p>
<p>Schauen wir uns nochmal die Modellmatrix an. Hier erwartet uns aber keine Überraschung. Wir schätzen den Intercept und dann kommt der Wert für jedes <span class="math inline">\(x\)</span> in der zweiten Spalte.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(y <span class="sc">~</span> x, <span class="at">data =</span> cont_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) x
1           1 1
2           1 2
3           1 3
4           1 4
5           1 5
6           1 6
7           1 7
attr(,"assign")
[1] 0 1</code></pre>
</div>
</div>
<p>Im Folgenden schätzen wir jetzt das lineare Modell um die Koeffizienten der Geraden zu erhalten. Wir nutzen die Funktion <code>model_parameter()</code> aus dem R Paket <code>{parameters}</code> für die Ausgabe der Koeffizienten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> cont_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Parameter, Coefficient)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient
-------------------------
(Intercept) |        4.32
x           |        1.71</code></pre>
</div>
</div>
<p>Wir erhalten einen Intercept von <span class="math inline">\(4.32\)</span> und eine Steigung von <span class="math inline">\(x\)</span> mit <span class="math inline">\(1.71\)</span>. Wichtig nochmal, wir haben uns hier zufällige Zahlen erstellen lassen. Wenn du oben den Fehler rausnimmst, dann erhälst du auch die exakten Zahlen für den Intercept und die Steigung von <span class="math inline">\(x\)</span> wieder. Wir sehen also, wenn wir ein kontinuierliches <span class="math inline">\(x\)</span> haben, dann können wir das <span class="math inline">\(x\)</span> in dem Sinne einr Steigung interpretieren. Steigt das <span class="math inline">\(x\)</span> um 1 Einheit an, so erhöht sich das <span class="math inline">\(y\)</span> um den Wert der Steigung von <span class="math inline">\(x\)</span>.</p>
<p>In <a href="#fig-stat-modeling-basic-00" class="quarto-xref">Abbildung&nbsp;<span>45.1</span></a> sehen wir den Zusammenhang nochmal graphisch dargestellt. Wir sehen, dass wir die voreingestellten Parameter von <span class="math inline">\(\beta_0 = 5\)</span> und <span class="math inline">\(\beta_1 = 1.5\)</span> fast treffen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-stat-modeling-basic-00" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stat-modeling-basic-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-stat-modeling-basic-00-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;45.1— Graphische Darstellung der Interpretation von einem kontinuierlichen x."><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-basic-00-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stat-modeling-basic-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.1— Graphische Darstellung der Interpretation von einem kontinuierlichen <span class="math inline">\(x\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-interpret-x-cat2" class="level3" data-number="45.3.2">
<h3 data-number="45.3.2" class="anchored" data-anchor-id="sec-interpret-x-cat2"><span class="header-section-number">45.3.2</span> Kategorielles <span class="math inline">\(x\)</span> mit 2 Leveln</h3>
<p>Etwas anders wird der Fall wenn wir ein kategorielles <span class="math inline">\(x\)</span> mit 2 Leveln vorliegen haben. Wir bauen faktisch zwei Punktetürme an zwei <span class="math inline">\(x\)</span> Positionen auf. Dennoch können wir durch diese Punkte eine Gerade zeichnen. Bauen wir uns erst die Daten mit der Funktion <code>rnorm()</code>. Wir haben zwei Gruppen vorliegen, die Gruppe A hat sieben Beobachtungen und einen Mittelwert von 10. Die Gruppe B hat ebenfalls sieben Beobchatungen und einen Mittelwert von 15. Der Effekt zwischen den beiden Gruppen A und B ist die Mittelwertsdifferenz <span class="math inline">\(\Delta_{A-B}\)</span> ist somit 5. Wir erhlalten dann folgenden Datensatz wobei die Werte der Gruppe A um die 10 streuen und die Werte der Gruppe B um die 15 streuen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20339537</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>cat_two_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">A =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">B =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> x, <span class="at">value =</span> y) <span class="sc">|&gt;</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">as_factor</span>(x))</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>cat_two_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 2
   x         y
   &lt;fct&gt; &lt;dbl&gt;
 1 A     10.0 
 2 A     10.8 
 3 A     10.7 
 4 A     11.0 
 5 A      9.25
 6 A      8.98
 7 A      9.71
 8 B     15.1 
 9 B     16.0 
10 B     14.5 
11 B     15.1 
12 B     14.2 
13 B     16.8 
14 B     15.6 </code></pre>
</div>
</div>
<p>Wir wollen uns wieder die Modellmatrix einmal anschauen. Wir sehen hier schon einen Unterschied. Zum einen sehen wir, dass der Intercept für alle Beobachtungen geschätzt wird und in der zweiten Spalte nur <code>xB</code> steht. Somit werden in der zweiten Spalte nur die Beobachtungen in der Gruppe B berücksichtigt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(y <span class="sc">~</span> x, <span class="at">data =</span> cat_two_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) xB
1            1  0
2            1  0
3            1  0
4            1  0
5            1  0
6            1  0
7            1  0
8            1  1
9            1  1
10           1  1
11           1  1
12           1  1
13           1  1
14           1  1
attr(,"assign")
[1] 0 1
attr(,"contrasts")
attr(,"contrasts")$x
[1] "contr.treatment"</code></pre>
</div>
</div>
<p>Wir rechnen einmal das lineare Modell und lassen uns überraschen was als Ergebnis herauskommt. Wir nutzen die Funktion <code>model_parameter()</code> aus dem R Paket <code>{parameters}</code> für die Ausgabe der Koeffizienten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> cat_two_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Parameter, Coefficient)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient
-------------------------
(Intercept) |       10.07
xB          |        5.27</code></pre>
</div>
</div>
<p>Nun erhalten wir als den Intercept 10.07 und die Steigung <code>xB</code> mit 5.27 zurück. Wir sehen, der Intercept ist der Mittelwert der Gruppe A und die das <code>xB</code> ist die Änderung von dem Mittelwert A zu dem Mittelwert B. Wir erhalten die Mittelwertsdifferenz <span class="math inline">\(\Delta_{A-B}\)</span> von 5.27 zurück. In <a href="#tbl-cat-2" class="quarto-xref">Tabelle&nbsp;<span>45.2</span></a> siehst du den Zusammenhang von den Faktorleveln A und B, den jeweiligen Mittelwerte der Level sowie die Differenz zum Mittel von dem ersten Level A.</p>
<div class="cell">
<div id="tbl-cat-2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cat-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.2— Zusammenhang von den Mittelwerten der Level des Faktores <span class="math inline">\(x\)</span> und deren Differenz zu Level A.
</figcaption>
<div aria-describedby="tbl-cat-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Factor x</th>
<th style="text-align: center;">Mean of level</th>
<th style="text-align: center;">Difference to level A</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">10.07</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">15.33</td>
<td style="text-align: center;">5.27</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In <a href="#fig-stat-modeling-basic-01" class="quarto-xref">Abbildung&nbsp;<span>45.2</span></a> kannst du nochmal den visuellen Zusammenhang zwischen den einzelnen Beobachtungen und der sich ergebenen Geraden sehen. Die Gerade geht durch die beiden Mittelwerte der Gruppe A und B. Daher ist die Steigung der Mittlwertsunterschied zwischen der Gruppe A und der Gruppe B. Steigt das <span class="math inline">\(x\)</span> um 1 Einheit an, also springt von Gruppe A zu Gruppe B, so erhöht sich das <span class="math inline">\(y\)</span> um den Mittelwertsunterschied <span class="math inline">\(\Delta_{A-B}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-stat-modeling-basic-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stat-modeling-basic-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-stat-modeling-basic-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;45.2— Graphische Darstellung der Interpretation von einem kategoriellen x mit 2 Leveln."><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-basic-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stat-modeling-basic-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.2— Graphische Darstellung der Interpretation von einem kategoriellen <span class="math inline">\(x\)</span> mit 2 Leveln.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-interpret-x-cat3" class="level3" data-number="45.3.3">
<h3 data-number="45.3.3" class="anchored" data-anchor-id="sec-interpret-x-cat3"><span class="header-section-number">45.3.3</span> Kategorielles <span class="math inline">\(x\)</span> mit &gt;2 Leveln</h3>
<p>Nachdem wir das Problem der Interpretation von einem kategoriellen <span class="math inline">\(x\)</span> mit zwei Leveln verstanden haben, werden wir uns jetzt den Fall für ein kategoriellen <span class="math inline">\(x\)</span> mit drei oder mehr Leveln anschauen. Wir nutzen hier nur drei Level, da es für vier oder fünf Level gleich abläuft. Du kannst das Datenbeispiel gerne auch noch um eine vierte Gruppe erweitern und schauen was sich da ändert.</p>
<p>Unser Datensatz besteht aus drei Gruppen A, B und C mit den Mittelwerten von 10, 15 und 3. Hierbei ist wichtig, dass wir in der Gruppe C nur einen Mittelwert von 3 haben. Also wir haben <em>keinen</em> linearen Anstieg über die drei Gruppen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20339537</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>cat_three_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">A =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">B =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">C =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> x, <span class="at">value =</span> y) <span class="sc">|&gt;</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">as_factor</span>(x))</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>cat_three_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 2
   x         y
   &lt;fct&gt; &lt;dbl&gt;
 1 A     10.0 
 2 A     10.8 
 3 A     10.7 
 4 A     11.0 
 5 A      9.25
 6 A      8.98
 7 A      9.71
 8 B     15.1 
 9 B     16.0 
10 B     14.5 
# ℹ 11 more rows</code></pre>
</div>
</div>
<p>Schauen wir uns einmal die Modellmatrix an. Wir sehen wieder, dass der Intercept über alle Gruppen geschätzt wird und wir Koeffizienten für die Gruppen B und C erhalten. Mit der Modellmatrix wird dann auch das lineare Modell geschätzt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(y <span class="sc">~</span> x, <span class="at">data =</span> cat_three_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) xB xC
1            1  0  0
2            1  0  0
3            1  0  0
4            1  0  0
5            1  0  0
6            1  0  0
7            1  0  0
8            1  1  0
9            1  1  0
10           1  1  0
11           1  1  0
12           1  1  0
13           1  1  0
14           1  1  0
15           1  0  1
16           1  0  1
17           1  0  1
18           1  0  1
19           1  0  1
20           1  0  1
21           1  0  1
attr(,"assign")
[1] 0 1 1
attr(,"contrasts")
attr(,"contrasts")$x
[1] "contr.treatment"</code></pre>
</div>
</div>
<p>Wir rechnen wieder das Modell mit der Funktion <code>lm()</code>. Wir nutzen die Funktion <code>model_parameter()</code> aus dem R Paket <code>{parameters}</code> für die Ausgabe der Koeffizienten zu erhalten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> cat_three_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Parameter, Coefficient)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient
-------------------------
(Intercept) |       10.07
xB          |        5.27
xC          |       -7.41</code></pre>
</div>
</div>
<p>Wir sehen wieder, dass der Intercept der Mittelwert der Gruppe A ist. Wir hatten einen Mittelwert von 10 für die Gruppe A eingestellt und wir erhalten diesen Wert wieder. Die anderen Koeffizienten sind die Änderung zum Mittelwert von der Gruppe A. In <a href="#tbl-cat-3" class="quarto-xref">Tabelle&nbsp;<span>45.3</span></a> ist der Zusammenhang nochmal für alle Level des Faktors <span class="math inline">\(x\)</span> dargestellt. Wir haben für die Gruppe B einen Mittelwert von 15 und für die Gruppe C einen Mittelwert von 3 eingestellt. Wir erhalten diese Mittelwerte wieder, wenn wir die Differenzen zu dem Intercept bilden.</p>
<div class="cell">
<div id="tbl-cat-3" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cat-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.3— Zusammenhang von den Mittelwerten der Level des Faktores <span class="math inline">\(x\)</span> und deren Differenz zu Level A.
</figcaption>
<div aria-describedby="tbl-cat-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Factor x</th>
<th style="text-align: center;">Mean of level</th>
<th style="text-align: center;">Difference to level A</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">10.07</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">15.33</td>
<td style="text-align: center;">5.27</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">2.66</td>
<td style="text-align: center;">-7.41</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Wir sehen den Zusammenhang nochmal in der <a href="#fig-stat-modeling-basic-02" class="quarto-xref">Abbildung&nbsp;<span>45.3</span></a> visualisiert. Wir sehen die Änderung on der Gruppe A zu der Gruppe B sowie die Änderung von der Gruppe A zu der Gruppe C. Die Abbildung ist etwas <em>verwirrend</em> da wir <em>nicht</em> das <span class="math inline">\(x\)</span> um 2 Einheiten erhöhen um auf den Mittelwert von C zu kommen. Wir rechnen sozusagen ausgehend von A die Änderung zu B und C aus. Dabei nehmen wir jedesmal an, dass die Gruppe B und die Gruppe C nur eine Einheit von <span class="math inline">\(x\)</span> von A entfernt ist.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = 1, y = 10.1, xend = 2, yend = 10.1 + 5.27), : All aesthetics have length 1, but the data has 21 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_segment(aes(x = 1, y = 10.1, xend = 3, yend = 10.1 - 7.41), : All aesthetics have length 1, but the data has 21 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-stat-modeling-basic-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stat-modeling-basic-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-stat-modeling-basic-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;45.3— Graphische Darstellung der Interpretation von einem kategoriellen x mit 3 Leveln."><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-basic-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stat-modeling-basic-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.3— Graphische Darstellung der Interpretation von einem kategoriellen <span class="math inline">\(x\)</span> mit 3 Leveln.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-confounder" class="level2" data-number="45.4">
<h2 data-number="45.4" class="anchored" data-anchor-id="sec-confounder"><span class="header-section-number">45.4</span> Adjustierung für Confounder</h2>
<p>Im folgenden Abschnitt wollen wir einmal auf Confounder eingehen. Was sind Confounder? Zum einen gibt es kein gutes deutsches Wort für Confounder. Du könntest Confounder in etwa mit <em>Verzerrer</em> oder <em>Störfakor</em> übersetzen. Zum Anderen können Confounder nur zuammen mit anderen Vriabln in einer multiplen Regression auftreten. Das heißt, wir brauchen mindestens zwei Variablen in einer Regression. Ein Confounder verursacht einen Effekt, den wir eigentlich nicht so erwartet hätten. Wir wollen eigentlich einen Effekt schätzen, aber der Effekt ist viel größer oder kleiner, da der Effekt eigentlich von einder anderen Variable verursacht oder aber verdeckt wird. Wir können einen Confounder in beide Richtungen haben. Wichtig ist hierbei, das wir eigentlich <em>nicht</em> an dem Effekt des Confounders interessiert sind. Wir wollen uns zum Beispiel den Effekt einer Düngung auf das Trockengewicht anschauen, aber der Effekt den wir beobachten wird durch die unterschiedlichen Pflanzorte verursacht.</p>
<p>Schauen wir uns das ganze mal für das Beispiel des Zusammenhangs von dem Flohgewicht mit der Sprungweite an. Dafür benötigen wir den Datensatz <code>flea_dog_cat_length_weight.csv</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>model_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/flea_dog_cat_length_weight.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, sex, weight, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">sex =</span> <span class="fu">as_factor</span>(sex))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#tbl-model-confounder" class="quarto-xref">Tabelle&nbsp;<span>45.4</span></a> ist der Datensatz <code>model_tbl</code> nochmal dargestellt.</p>
<div class="cell">
<div id="tbl-model-confounder" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-confounder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.4— Datensatz für die Confounder Adjustierung. Die Variable <code>jump_length</code> ist das <span class="math inline">\(y\)</span> und die Variable <code>weight</code> das <span class="math inline">\(x\)</span> von Interesse.
</figcaption>
<div aria-describedby="tbl-model-confounder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">weight</th>
<th style="text-align: center;">jump_length</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">6.02</td>
<td style="text-align: center;">15.79</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">5.99</td>
<td style="text-align: center;">18.33</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">8.05</td>
<td style="text-align: center;">17.58</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">6.71</td>
<td style="text-align: center;">14.09</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">6.19</td>
<td style="text-align: center;">18.22</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">8.18</td>
<td style="text-align: center;">13.49</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">8.04</td>
<td style="text-align: center;">27.81</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">9.03</td>
<td style="text-align: center;">24.02</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">7.42</td>
<td style="text-align: center;">24.53</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">9.26</td>
<td style="text-align: center;">24.35</td>
</tr>
<tr class="even">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">8.85</td>
<td style="text-align: center;">24.36</td>
</tr>
<tr class="odd">
<td style="text-align: center;">fox</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">7.89</td>
<td style="text-align: center;">22.13</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Wir können uns jetzt drei verschiedene Modelle anschauen.</p>
<ol type="1">
<li>Das Modell <code>jump_length ~ weight</code>. Wir modellieren die Abhängigkeit von der Sprungweite von dem Gewicht der Flöhe <em>über alle</em> anderen Variablen hinweg.</li>
<li>Das Modell <code>jump_length ~ weight + animal</code>. Wir modellieren die Abhängigkeit von der Sprungweite von dem Gewicht der Flöhe und berücksichtigen die Tierart des Flohes. Ignorieren aber das Geschlecht des Flohes.</li>
<li>Das Modell <code>jump_length ~ weight + animal + sex</code>. Wir modellieren die Abhängigkeit von der Sprungweite von dem Gewicht der Flöhe und berücksichtigen <em>alle</em> Variablen, die wir gemessen haben.</li>
</ol>
<p>Hierbei ist wichtig, dass es natürlich auch Confounder geben kann, die wir gar nicht in den Daten erhoben haben. Also, dass sich Gruppen finden lassen, die wir gar nicht als Variable mit in den Daten erfasst haben. Hier könnte eine Hauptkomponentenanalyse helfen.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<div id="fig-stat-modeling-mult-01" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stat-modeling-mult-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-stat-modeling-mult-01" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-stat-modeling-mult-01-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-stat-modeling-mult-01-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-stat-modeling-mult-01-1.png" class="lightbox" data-gallery="fig-stat-modeling-mult-01" title="Abbildung&nbsp;45.4&nbsp;(a)— jump_length ~ weight"><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-mult-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-stat-modeling-mult-01" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-stat-modeling-mult-01-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) jump_length ~ weight
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-stat-modeling-mult-01" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-stat-modeling-mult-01-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-stat-modeling-mult-01-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-stat-modeling-mult-01-2.png" class="lightbox" data-gallery="fig-stat-modeling-mult-01" title="Abbildung&nbsp;45.4&nbsp;(b)— jump_length ~ weight + animal"><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-mult-01-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-stat-modeling-mult-01" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-stat-modeling-mult-01-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) jump_length ~ weight + animal
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-stat-modeling-mult-01" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-stat-modeling-mult-01-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-stat-modeling-mult-01-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-stat-modeling-mult-01-3.png" class="lightbox" data-gallery="fig-stat-modeling-mult-01" title="Abbildung&nbsp;45.4&nbsp;(c)— jump_length ~ weight + animal + sex"><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-mult-01-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-stat-modeling-mult-01" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-stat-modeling-mult-01-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) jump_length ~ weight + animal + sex
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stat-modeling-mult-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.4— Darstellung des <em>counfounder</em> Effekts anhand des Zusammenhangs der Sprungweite in [cm] und dem Gewicht von Flöhen [mg].
</figcaption>
</figure>
</div>
</div>
<p>In <a href="#fig-stat-modeling-mult-01-1" class="quarto-xref">Abbildung&nbsp;<span>45.4 (a)</span></a> sehen wir die blaue Linie als die Ausgabe von dem Modell <code>jump_length ~ weight</code>. Wir sehen, dass mit dem Anstieg des Gewichtes der Flöhe auch die Sprungweite sich erhöht. Wir würden annehmen, dass wir hier einen signifikanten Unterschied vorliegen haben. Schauen wir uns die Koeffizienten des Modells aus dem <code>lm()</code> einmal an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> weight, <span class="at">data =</span> model_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter   | Coefficient |   SE |        95% CI | t(598) |      p
------------------------------------------------------------------
(Intercept) |        9.79 | 0.77 | [8.28, 11.30] |  12.73 | &lt; .001
weight      |        1.34 | 0.09 | [1.16,  1.53] |  14.16 | &lt; .001</code></pre>
</div>
</div>
<p>Wir sehen, dass wir einen Effekt des Gewichts auf die Sprungweite von <span class="math inline">\(1.34\)</span> vorliegen haben. Auch ist der Effekt und damit die Steigung signifikant.</p>
<p>Erweitern wir nun das Modell um die Tierart und erhalten die <a href="#fig-stat-modeling-mult-01-2" class="quarto-xref">Abbildung&nbsp;<span>45.4 (b)</span></a>. Zum einen sehen wir, dass der globale Effekt nicht so ganz stimmen kann. Die Tierarten haben alle einen unterschiedlichen starken Effekt von dem Gewicht auf die Sprungweite. Auch hier fitten wir einmal das lineare Modell und schauen uns die Koeffizienten an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> weight <span class="sc">+</span> animal, <span class="at">data =</span> model_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter    | Coefficient |   SE |       95% CI | t(596) |      p
------------------------------------------------------------------
(Intercept)  |        7.82 | 0.62 | [6.60, 9.03] |  12.64 | &lt; .001
weight       |        1.27 | 0.07 | [1.13, 1.42] |  17.08 | &lt; .001
animal [dog] |        2.62 | 0.26 | [2.12, 3.13] |  10.23 | &lt; .001
animal [fox] |        4.97 | 0.26 | [4.47, 5.48] |  19.38 | &lt; .001</code></pre>
</div>
</div>
<p>Der Effekt des Gewichtes ist hier in etwa gleich geblieben. Wir sehen aber auch, dass die Sprungweite anscheinend bei Hunden und Füchsen höher ist. Daher haben wir hier einen Effekt on der Tierart. Wir adjustieren für den Confoundereffekt durch die Tierart und erhalten einen besseren Effektschätzer für das Gewicht.</p>
<p>In der letzten <a href="#fig-stat-modeling-mult-01-3" class="quarto-xref">Abbildung&nbsp;<span>45.4 (c)</span></a> wollen wir nochmal das Geschlecht der Flöhe mit in das Modell nehmen. Wir sehen, dass in diesem Fall, das Gewicht gar keinen Einfluss mehr auf die Sprungweite hat. Den Effekt des Gewichtes war nur der Effekt des unterschiedlichen Gewichtes der weiblichen und männlichen Flöhe. Schauen wir auch hier nochmal in des Modell.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> weight <span class="sc">+</span> animal <span class="sc">+</span> sex, <span class="at">data =</span> model_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Coefficient =</span> <span class="fu">round</span>(Coefficient, <span class="dv">2</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient |   SE |         95% CI | t(595) |      p
-------------------------------------------------------------------
(Intercept) |       15.42 | 0.59 | [14.27, 16.58] |  26.23 | &lt; .001
weight      |        0.01 | 0.08 | [-0.16,  0.17] |   0.07 | 0.942 
animaldog   |        2.61 | 0.19 | [ 2.23,  2.99] |  13.50 | &lt; .001
animalfox   |        5.19 | 0.19 | [ 4.81,  5.57] |  26.75 | &lt; .001
sexfemale   |        4.89 | 0.23 | [ 4.44,  5.34] |  21.25 | &lt; .001</code></pre>
</div>
</div>
<p>Nun können wir sehen, dass von unserem ursprünglichen Effekt von dem Gewicht auf die Sprungweite nichts mehr übrigbleibt. Wir haben gar keinen Effekt von dem Gewicht auf die Sprungweite vorliegen. Was wir gesehen haben, war der Effekt des Gewichtes der unterschiedlichen Geschlechter. Wenn wir unser Modell für die Confounder <code>animal</code> und <code>sex</code> adjustieren, haben wir einen unverzerrten Schätzer für <code>weight</code>. Wichtig ist nochmal, dafür müssen wir natürlich auch alle variablen erhoben haben. Hätten wir das Geschlecht der Flöhe nicht bestimt, hätten wir hier eventuell einen falschen Schluß getroffen.</p>
</section>
<section id="sec-vif" class="level2" data-number="45.5">
<h2 data-number="45.5" class="anchored" data-anchor-id="sec-vif"><span class="header-section-number">45.5</span> Variance inflation factor (VIF)</h2>
<p>Wenn wir sehr viele Daten erheben, dann kann es sein, dass die Variablen stark miteinander korrelieren. Wir können aber stark mieinander korrelierte Variablen nicht zusammen in ein Modell nehmen. Die Effekte der beiden Variablen würden sich gegenseitig aufheben. Wir hätten eigentlich zwei getrennt signifikante Variablen. Nehmen wir aber beide Variablen mit ins Modell, sind beide Variablen nicht mehr signifikant.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="images/angel_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Wir kürzen hier stark ab. Wenn du mehr über Variablen in einem Modell wissen willst, gibt es dann in den Kapitel zur Variablen Selektion mehr Informationen. Wenn du nur Outcomes und Blöcke vorliegen hast, dann ist das VIF für dich uninteressant.</p>
</blockquote>
</div>
</div>
</div>
<p>Um Variablen zu finden, die sich sehr ähnlich verhalten, können wir den Variance inflation factor (VIF) nutzen. Wir können den VIF jedoch <em>nicht</em> für kategoriale Daten verwenden. Statistisch gesehen würde es keinen Sinn machen. Die Anwendung ist recht einfach. Wir fitten als erstes unser Modell und dann können wir die Funktion <code>vif()</code> aus dem R Paket <code>{car}</code> verwenden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>gummi_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/gummibears.xlsx"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> semester <span class="sc">+</span> age <span class="sc">+</span> count_color <span class="sc">+</span> count_bears, <span class="at">data =</span> gummi_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir sehen im Folgenden das Eregbnis der Funktion <code>vif()</code>. Wenn der berechnete Wert für den VIF größer als 5 ist, dann liegt mit der Variable <em>ein Problem</em> vor. Wir vermuten dann, dass eine andere variable sehr stark mit dieser Variable korreliert. Wir sehen an den Werten keine Aufälligkeiten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   semester         age count_color count_bears 
   1.051656    1.030493    1.121956    1.173528 </code></pre>
</div>
</div>
<p>Wir können uns mit der Funcktion <code>check_model()</code> aus dem R Paket <code>{performance}</code> auch die Unsicherheit mit angeben lassen. In unserem Beispiel hieft dies gerade nicht sehr viel weiter. Wir bleiben bei den geschätzen Werten und ignorieren das Intervall.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-stat-modeling-vif" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stat-modeling-vif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-stat-modeling-vif-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Abbildung&nbsp;45.5— Graphische Darstellung des VIF mit der Funktion check_model()."><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-vif-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stat-modeling-vif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.5— Graphische Darstellung des VIF mit der Funktion <code>check_model()</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-stat-modeling-vif" class="quarto-xref">Abbildung&nbsp;<span>45.5</span></a> sehen wir nochmal die Visualisierung. Wie immer, manchmal helfen solche Abbildungen, manchmal verwirren die Abbildungen mehr. Wir konzentrieren uns hier auf die Werte des VIF’s und ignorieren die Streuung.</p>
</section>
<section id="sec-model-basic-compare" class="level2" data-number="45.6">
<h2 data-number="45.6" class="anchored" data-anchor-id="sec-model-basic-compare"><span class="header-section-number">45.6</span> Vergleich von Modellen</h2>
<p>Im Folgenden wollen wir einmal verschiedene Modelle miteinander Vergleichen und uns statistisch wiedergeben lassen, was das beste Modell ist. Und hier holen wir auch einmal kurz Luft, denn wir entschieden <em>nur</em> was das statistisch beste Modell ist. Es kann sein, dass ein Modell biologisch mehr Sinn macht und nicht auf Platz 1 der statistischen Maßzahlen steht. Das ist vollkommen in Ordnung. Du musst abweägen, was für sich das beste Modell ist. Im Zweifel komme ruhig nochmal in meine statistische Beratung oder schreibe mir eine Mail.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="images/angel_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p>Wir kürzen hier stark ab bzw. gehen nicht im Detail auf jedes Gütekriterium ein. Wichtig ist, dass du Modelle <em>statistisch</em> vergleichen kannst. Bedenke immmer, dass die <em>statistische</em> Bewertung nicht immer ausreicht! Auch was die Biologie über das Modell sagt ist wichtig.</p>
</blockquote>
</div>
</div>
</div>
<p>Wir bauchen uns jetzt fünf Modelle von <code>fit_1</code> bis <code>fit_5</code>. Jedes dieser Modelle hat andere <span class="math inline">\(x\)</span> aber häufig das gleiche Outcome <code>y</code>. In dem Beispiel am Ende des Kapitels nutzen wir auch verschiedene <span class="math inline">\(y\)</span> dafür aber dann gleiche <span class="math inline">\(x\)</span> in dem Modell. Im Weiteren sortieren wir die Modelle von einfach nach komplex. Ich versuche immmer das einfachste Modell <code>fit_1</code> zu nennen bzw. eher die niedrige Nummer zu geben. Im Idealfall benennst du die Modellobjekte nach den Modellen, die in en Objekten gespeichert sind. Oft sind die Modelle aber sehr groß und die Objekte der Fits haben dann sehr lange Namen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> model_tbl)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> sex, <span class="at">data =</span> model_tbl)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> sex <span class="sc">+</span> weight, <span class="at">data =</span> model_tbl)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> sex <span class="sc">+</span> sex<span class="sc">:</span>weight, <span class="at">data =</span> model_tbl)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>fit_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(jump_length) <span class="sc">~</span> animal <span class="sc">+</span> sex, <span class="at">data =</span> model_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Als Ergänzung zum Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> wollen wir uns noch das <em>Akaike information criterion</em> (abk. <span class="math inline">\(AIC\)</span>) anschauen. Du kannst auch das <span class="math inline">\(R^2\)</span> bzw. das <span class="math inline">\(R^2_{adj}\)</span> für die Modellauswahl nehmen. Das <span class="math inline">\(AIC\)</span> ist neuer und auch für komplexere Modelle geeignet. Es gilt hierbei, je kleiner das <span class="math inline">\(AIC\)</span> ist, desto besser ist das <span class="math inline">\(AIC\)</span>. Wir wollen also Modelle haben, die ein kleines <span class="math inline">\(AIC\)</span> haben. Wir gehen jetzt nicht auf die Berechnung der <span class="math inline">\(AIC\)</span>’s für jedes Modell ein. Wir erhalten nur ein <span class="math inline">\(AIC\)</span> für jedes Modell. Die einzelnen Werte des <span class="math inline">\(AIC\)</span>’s sagen <em>nichts</em> aus. Ein <span class="math inline">\(AIC\)</span> ist ein mathematisches Konstrukt. Wir können aber verwandte Modelle mit dem <span class="math inline">\(AIC\)</span> untereinander vergleichen. Daher berechnen wir ein <span class="math inline">\(\Delta\)</span> über die <span class="math inline">\(AIC\)</span>. Dafür nehmen wir das Modell mit dem niedrigsten <span class="math inline">\(AIC\)</span> und berechnen die jeweiligen Differenzen zu den anderen <span class="math inline">\(i\)</span> Modellen. In unserem Beispiel ist <span class="math inline">\(i\)</span> dann gleich fünf, da wir fünf Modelle haben.</p>
<p><span class="math display">\[
\Delta_i = AIC_i - AIC_{min}
\]</span></p>
<ul>
<li>wenn <span class="math inline">\(\Delta_i &lt; 2\)</span>, gibt es keinen Unterschied zwischen den Modellen. Das <span class="math inline">\(i\)</span>-te Modell ist genauso gut wie das Modell mit dem <span class="math inline">\(AIC_{min}\)</span>.</li>
<li>wenn <span class="math inline">\(2 &lt; \Delta_i &lt; 4\)</span>, dann gibt es eine starke Unterstützung für das <span class="math inline">\(i\)</span>-te Modell. Das <span class="math inline">\(i\)</span>-te Modell ist immer noch ähnlich gut wie das <span class="math inline">\(AIC_{min}\)</span>.</li>
<li>wenn <span class="math inline">\(4 &lt; \Delta_i &lt; 7\)</span>, dann gibt es deutlich weniger Unterstützung für das <span class="math inline">\(i\)</span>-te Modell;</li>
<li>Modelle mit <span class="math inline">\(\Delta_i &gt; 10\)</span> sind im Vergleich zu dem <em>besten</em> <span class="math inline">\(AIC\)</span> Modell nicht zu verwenden.</li>
</ul>
<p>Nehmen wir ein <span class="math inline">\(AIC_1 = AIC_{min} = 100\)</span> und <span class="math inline">\(AIC_2\)</span> ist <span class="math inline">\(100,7\)</span> an. Dann ist <span class="math inline">\(\Delta_2=0,7&lt;2\)</span>, so dass es keinen wesentlichen Unterschied zwischen den Modellen gibt. Wir können uns entscheiden, welches der beiden Modelle wir nehmen. Hier ist dann wichtig, was auch die Biologie sagt oder eben andere Kriterien, wie Kosten und Nutzen. Wenn wir ein <span class="math inline">\(AIC_1 = AIC_{min} = 100000\)</span> und <span class="math inline">\(AIC_2\)</span> ist <span class="math inline">\(100700\)</span> vorliegen haben, dann ist <span class="math inline">\(\Delta_2 = 700 \gg 10\)</span>, also gibt es keinen Grund für das <span class="math inline">\(2\)</span>-te Modell. Das <span class="math inline">\(2\)</span>-te Modell ist substantiell schlechter als das erste Modell. Mehr dazu kannst du unter <a href="https://faculty.washington.edu/skalski/classes/QERM597/papers_xtra/Burnham%20and%20Anderson.pdf">Multimodel Inference: Understanding AIC and BIC in Model Selection</a> nachlesen.</p>
<p>Wir können das <span class="math inline">\(\Delta_i\)</span> auch in eine Wahrscheinlichkeit umrechnen. Wir können <span class="math inline">\(p_i\)</span> berechnen und damit die relative (im Vergleich zu <span class="math inline">\(AIC_{min}\)</span>) Wahrscheinlichkeit, dass das <span class="math inline">\(i\)</span>-te Modell den AIC minimiert.</p>
<p><span class="math display">\[
p_i = \exp\left(\cfrac{-\Delta_i}{2}\right)
\]</span></p>
<p>Zum Beispiel entspricht <span class="math inline">\(\Delta_i = 1.5\)</span> einem <span class="math inline">\(p_i\)</span> von <span class="math inline">\(0.47\)</span> (ziemlich hoch) und ein <span class="math inline">\(\Delta_i = 15\)</span> entspricht einem <span class="math inline">\(p_i =0.0005\)</span> (ziemlich niedrig). Im ersten Fall besteht eine Wahrscheinlichkeit von 47%, dass das <span class="math inline">\(i\)</span>-te Modell tatsächlich eine bessere Beschreibung ist als das Modell, das <span class="math inline">\(AIC_{min}\)</span> ergibt, und im zweiten Fall beträgt diese Wahrscheinlichkeit nur 0,05%. Wir können so einmal nachrechnen, ob sich eine Entscheidung für ein anderes Modell lohnen würde. Neben dem <span class="math inline">\(AIC\)</span> gibt es auch das Bayesian information criterion (<span class="math inline">\(BIC\)</span>). Auch beim <span class="math inline">\(BIC\)</span> gilt, je kleiner das BIC ist, desto besser ist das BIC.</p>
<p>Du siehst schon, es gibt eine Reihe von Möglichkeiten sich mit der Güte oder Qualität eines Modells zu beschäftigen. Wir nutzen die Funktion <code>model_performance()</code> um uns die Informationen über die Güte eines Modells wiedergeben zu lassen. Im folgenden Codeblock habe ich mich nur auf das <span class="math inline">\(AIC\)</span> und das <span class="math inline">\(BIC\)</span> konzentriert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(fit_1) <span class="sc">|&gt;</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AIC, BIC)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
    AIC   BIC
  &lt;dbl&gt; &lt;dbl&gt;
1 3076. 3093.</code></pre>
</div>
</div>
<p>Gut soweit. Du kannst jetzt für jedes der Modelle das <span class="math inline">\(AIC\)</span> berechnen und dann dir die Modelle entsprechend ordnen. Wir müssen das aber nicht tun. Wir können uns auch die Funktion <code>compare_performance()</code> zu nutze machen. Die Funktion gibt uns die <span class="math inline">\(R^2\)</span>-Werte wieder wie auch die <span class="math inline">\(AIC\)</span> sowie die <span class="math inline">\(s^2_{\epsilon}\)</span> als <code>sigma</code> wieder. Wir haben also alles zusammen was wir brauchen. Darüber hinaus kann die Funktion auch die Modelle rangieren. Das nutzen wir natürlich gerne.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>comp_res <span class="ot">&lt;-</span> <span class="fu">compare_performance</span>(fit_1, fit_2, fit_3, fit_4, fit_5, <span class="at">rank =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>comp_res</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name  | Model |    R2 | R2 (adj.) |  RMSE | Sigma | AIC weights | AICc weights | BIC weights | Performance-Score
----------------------------------------------------------------------------------------------------------------
fit_2 |    lm | 0.739 |     0.738 | 1.926 | 1.933 |       0.644 |        0.650 |       0.959 |            82.69%
fit_5 |    lm | 0.731 |     0.729 | 0.099 | 0.099 |    2.58e-09 |     2.61e-09 |    3.84e-09 |            56.58%
fit_3 |    lm | 0.739 |     0.737 | 1.926 | 1.935 |       0.237 |        0.235 |       0.039 |            50.83%
fit_4 |    lm | 0.739 |     0.737 | 1.925 | 1.935 |       0.119 |        0.115 |       0.002 |            45.01%
fit_1 |    lm | 0.316 |     0.314 | 3.118 | 3.126 |   5.42e-126 |    5.57e-126 |   7.27e-125 |             0.00%</code></pre>
</div>
</div>
<p>Anhand der Ausgabe der Funktion <code>compare_performance()</code> sehen wir, dass unser Modell <code>fit_2</code> das beste Modell ist. Zwar ist die Streuung der Residuen nicht die Kleinste aller Modelle (<code>Sigma</code> = 1.933) aber wir haben ein hohes <span class="math inline">\(R^2_{adj}\)</span> und auch ein kleines <span class="math inline">\(AIC\)</span>. Wir würden damit sagen, dass das Modell <code>fit_2</code> mit den Variablen <code>animal</code> und <code>sex</code> für <span class="math inline">\(x\)</span> das Outcome <code>jump_length</code> am besten statistisch beschreibt.</p>
<p>In <a href="#fig-stat-modeling-compare" class="quarto-xref">Abbildung&nbsp;<span>45.6</span></a> sehen wir die Ausgabe der Funktion <code>compare_performance()</code> nochmal visualisiert. Wir können dann die einzelnen Modelle nochmal besser vergleichen. Auch siehst du hier, ob ein Modell in einem Bereich sehr schlecht ist oder aber nur in einem Bereich sehr gut.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-stat-modeling-compare" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stat-modeling-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-stat-modeling-compare-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Abbildung&nbsp;45.6— Graphische Darstellung der Funktion compare_performance() Wir sehen hier die einzelnen Gütekriterien in einer Übersicht dargestellt."><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-compare-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stat-modeling-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.6— Graphische Darstellung der Funktion <code>compare_performance()</code> Wir sehen hier die einzelnen Gütekriterien in einer Übersicht dargestellt.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Zum Ende stellt sich die Frage nach dem statistischen Test. Können wir auch statistisch Testen, ob das Modell <code>fit_1</code> signifikant unterschiedlich ist? Ja wir können die Funktion <code>test_vuong()</code> nutzen um ein Model zu den anderen Modellen zu vergleichen. Wenn du mehrere Modell miteinander vergleichen möchtest, dann muss du die Funktion mehrfach ausführen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_vuong</span>(fit_1, fit_2, fit_3, fit_4, fit_5)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Name  | Model | Omega2 | p (Omega2) |      LR | p (LR)
------------------------------------------------------
fit_1 |    lm |        |            |         |       
fit_2 |    lm |   0.41 |     &lt; .001 |  -18.46 | &lt; .001
fit_3 |    lm |   0.41 |     &lt; .001 |  -18.45 | &lt; .001
fit_4 |    lm |   0.41 |     &lt; .001 |  -18.48 | &lt; .001
fit_5 |    lm |   0.47 |     &lt; .001 | -123.94 | &lt; .001
Each model is compared to fit_1.</code></pre>
</div>
</div>
<p>Nutzen wir die Modellselektion auch einmal an einem konkreten Beispiel. War die Transformation sinnvoll? Wir haben also ein Outcome <span class="math inline">\(y\)</span> vorliegen und wollen wissen, ob wir nicht lieber das Modell mit einem <span class="math inline">\(y\)</span> mit einer <span class="math inline">\(log\)</span>-Transformation rechnen sollten. Wir nutzen dazu den Datensatz mit den Hunde- und Katzenflöhen und die Schlüpfdauer als Outcome. Also wie lange brauchen die Flöhe bis die Flöhe aus den Eiern geschlüpft sind.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>model_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/flea_dog_cat_length_weight.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_hatch_time =</span> <span class="fu">round</span>(<span class="fu">log</span>(hatch_time), <span class="dv">2</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir bauen uns jetzt zwei Modelle. Zum einen das Modell <code>fit_raw</code> mit der <code>hatch_time</code> und den Variablen <code>ainmal</code> und <code>sex</code>. Das zweite Modell enthält die <code>log(hatch_time)</code> also das Outcome <span class="math inline">\(y\)</span> als <span class="math inline">\(log\)</span>-Transformation. Wiederum sind die <span class="math inline">\(x\)</span> variablen die gleichen wie im untransformierten Modell. Wir fitten beide Modelle und speichern die Objekte entsprechend ab.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>fit_raw <span class="ot">&lt;-</span> <span class="fu">lm</span>(hatch_time <span class="sc">~</span> animal <span class="sc">+</span> sex, <span class="at">data =</span> model_tbl)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>fit_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_hatch_time <span class="sc">~</span> animal <span class="sc">+</span> sex, <span class="at">data =</span> model_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die Funktion <code>compare_performance()</code> erlaubt uns wieder die beiden Modelle <code>fit_raw</code> und <code>fit_log</code> miteinander zu vergleichen. Wir erhalten die folgende Ausgabe der Funktion.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>comp_res <span class="ot">&lt;-</span> <span class="fu">compare_performance</span>(fit_raw, fit_log, <span class="at">rank =</span> <span class="cn">TRUE</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>comp_res</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name    | Model |    R2 | R2 (adj.) |    RMSE |   Sigma | AIC weights | AICc weights | BIC weights | Performance-Score
----------------------------------------------------------------------------------------------------------------------
fit_log |    lm | 0.006 |     0.001 |   0.992 |   0.995 |        1.00 |         1.00 |        1.00 |            71.43%
fit_raw |    lm | 0.008 |     0.003 | 789.441 | 792.086 |    0.00e+00 |     0.00e+00 |    0.00e+00 |            28.57%</code></pre>
</div>
</div>
<p>In diesem Beispiel wäre das <span class="math inline">\(log\)</span>-transformierte Modell das bessere statistische Modell. Wir müssen jetzt überlegen, ob wir den Preis dafür bezahlen wollen. Wenn wir nämlich alles mit der <span class="math inline">\(log\)</span>-Transformation rechnen, dann erhalten wir auch alle Koeffizienten auf der <span class="math inline">\(log\)</span>-Skala (eng. <em>log scale</em>). Hier kannst du nur von Fall zu Fall entscheiden.</p>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-kery2010introduction" class="csl-entry" role="listitem">
Kéry M. 2010. Introduction to WinBUGS for ecologists: Bayesian approach to regression, ANOVA, mixed models and related analyses. Academic Press.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-linear-reg-basic.html" class="pagination-link" aria-label="Simple lineare Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-linear-reg-quality.html" class="pagination-link" aria-label="Modelgüte">
        <span class="nav-page-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb76" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, Hmisc)</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Multiple lineare Regression {#sec-mult-reg-basic}</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-modeling-basic.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"All models are approximations. Essentially, all models are wrong, but some are useful. However, the approximate nature of the model must always be borne in mind." --- George E. P. Box*</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>In dem vorherigen Kapitel haben wir uns mit der simplen linearen Regression beschäftigt. In diesem Kapitel wollen wir uns nun mit den Grundlagen der *multiplen* linearen Regression beschäftigen. Sagen, dass wir ein multiples lineares Modell vorliegen haben, wenn wir mehrere Einflussvariable $x_1$ bis $x_p$ vorliegen haben. Bei dem Outcome $y$, was einer Verteilung folgt, ändert sich erstmal nichts. Wir wollen jetzt herausfinden, welchen Einfluss oder Effekt die Variablen $x_1, ..., x_p$ auf das Outcome $y$ hat. Sehr simple gesprochen legen wir eine Gerade durch eine *mehrdimensionale* Punktewolke. Wir konzentrieren uns hier in diesem Kapitel auf nur normalverteilte Outcomes. Später kannst du dann aber auch andere Verteilungsfamilien modellieren.</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="center"}</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Wenn du jetzt denkst 'Hä? Was soll denn mehrdimensional bedeuten?', dann besuche doch einmal die fantastische Seite </span><span class="co">[</span><span class="ot">Explained Visually \| Ordinary Least Squares Regression</span><span class="co">](https://setosa.io/ev/ordinary-least-squares-regression/)</span><span class="at"> um selber zu erfahren, was eine multiple lineare Regression macht. Auf der Seite findest du interaktive Abbildungen, die dir das Konzept der linearen Regression sehr anschaulich nachvollziehen lassen.</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>Wir erinnern und nochmal, das ein *simples* lineares Modell nur ein $x_1$ hat:</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>y \sim x_1</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>Ein *multiples* lineares Modell hat von $x_1$ bis $x_p$ Einflussvariablen:</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>y \sim x_1 + x_2 + ... + x_p</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>Wir brauchen viele der Konzepte aus den vorherigen Kapiteln zur Modellgüte sowie Konfidenzintervallen. Vieles fällt hier zusammen. Schau dir ruhig nochmal die vorherigen Kapitel an, wenn dir etwas unklar ist. Häufig wollen wir auch etwas spezifischer sein. Wir schreiben daher einen Faktor mit einem $f$ wie folgt.</span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a>y \sim f_1</span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a>Wenn wir dann noch einen Block mit hinzunehmen, dann erweitern wir das Modell um einen Blockfaktor mit einem $b$ wie folgt.</span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-40"><a href="#cb76-40" aria-hidden="true" tabindex="-1"></a>y \sim f_1 + b_1</span>
<span id="cb76-41"><a href="#cb76-41" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-42"><a href="#cb76-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-43"><a href="#cb76-43" aria-hidden="true" tabindex="-1"></a>Es kann auch sein, dass wir noch einen zufälligen Effekt (eng. *random effect*) mit in das Modell nehmen wollen. Wir bezeichnen einen zufälligen Effekt mit einem $z$ wie folgt.</span>
<span id="cb76-44"><a href="#cb76-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-45"><a href="#cb76-45" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-46"><a href="#cb76-46" aria-hidden="true" tabindex="-1"></a>y \sim f_1 + z_1</span>
<span id="cb76-47"><a href="#cb76-47" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-48"><a href="#cb76-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-49"><a href="#cb76-49" aria-hidden="true" tabindex="-1"></a>Oder konkreter können wir sagen, dass <span class="in">`jump_length`</span> von <span class="in">`animal`</span>, <span class="in">`sex`</span> und <span class="in">`weight`</span> abhängt und wir diesen Zusammenhang modellieren wollen.</span>
<span id="cb76-50"><a href="#cb76-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-51"><a href="#cb76-51" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-52"><a href="#cb76-52" aria-hidden="true" tabindex="-1"></a>jump<span class="sc">\_</span>length \sim animal + sex + weight </span>
<span id="cb76-53"><a href="#cb76-53" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-54"><a href="#cb76-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-55"><a href="#cb76-55" aria-hidden="true" tabindex="-1"></a>Das hilft uns jetzt nur bedingt, denn wir wollen ja aus einer Modellierung in R die Koeffizienten der Regression wiederbekommen. Dafür müssen wir uns nochmal klar werden, was die Koeffizienten einer Regression sind. Das sind zum einen der y-Achsenabschnitt $\beta_0$ und die Steigung der einzelnen Variablen mit $\beta_1$ bis $\beta_p$. Wir erhalten auch bei einem multiplen Regressionsmodell nur einen Vektor mit den Residuen wieder.</span>
<span id="cb76-56"><a href="#cb76-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-57"><a href="#cb76-57" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-58"><a href="#cb76-58" aria-hidden="true" tabindex="-1"></a>y \sim \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_p x_p + \epsilon</span>
<span id="cb76-59"><a href="#cb76-59" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-60"><a href="#cb76-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-61"><a href="#cb76-61" aria-hidden="true" tabindex="-1"></a>Dennoch sind die Residuen $\epsilon$ normalverteilt. Wir haben im Mittel einen Abstand der $\epsilon$'s zur geraden von 0 und eine Streuung von $s^2_{\epsilon}$.</span>
<span id="cb76-62"><a href="#cb76-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-63"><a href="#cb76-63" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-64"><a href="#cb76-64" aria-hidden="true" tabindex="-1"></a>\epsilon \sim \mathcal{N}(0, s^2_{\epsilon})</span>
<span id="cb76-65"><a href="#cb76-65" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-66"><a href="#cb76-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-67"><a href="#cb76-67" aria-hidden="true" tabindex="-1"></a>Wir zeichen im Prinzip eine Gerade durch den $p$-dimensionellen Raum.</span>
<span id="cb76-68"><a href="#cb76-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-69"><a href="#cb76-69" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel wollen wir uns nun folgende Aspekte einmal genauer anschauen. Wir gehen hier nicht so sehr auf den theoretischen Hintergrund ein, wollen aber verstehen wie wir die Statistik nutzen und anwenden können.</span>
<span id="cb76-70"><a href="#cb76-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-71"><a href="#cb76-71" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wir besprechen die Modellmatrix in @sec-modell-matrix. Wir wollen uns Fragen, wie R eigentlich zu den Koeffizienten der Regressionsgleichung kommt.</span>
<span id="cb76-72"><a href="#cb76-72" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wir besprechen die Interpretation der Koeffizienten der linearen Regression in @sec-interpret-x.</span>
<span id="cb76-73"><a href="#cb76-73" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wir fragen uns, was sind eigentlich Confounder (deu. *Verwechsler*) im @sec-confounder.</span>
<span id="cb76-74"><a href="#cb76-74" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wir fragen uns, was ist eigentlich ein Variance Inflation Factor (VIF) für kontinuierliche $x$ in @sec-vif.</span>
<span id="cb76-75"><a href="#cb76-75" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wir besprechen, wie wir verschiedene Modelle miteinander vergleichen können in @sec-model-basic-compare.</span>
<span id="cb76-76"><a href="#cb76-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-77"><a href="#cb76-77" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb76-78"><a href="#cb76-78" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Tutorien für die multiple lineare Regression</span></span>
<span id="cb76-79"><a href="#cb76-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-80"><a href="#cb76-80" aria-hidden="true" tabindex="-1"></a>Wir immer geht natürlich mehr als ich hier Vorstellen kann. Du findest im Folgenden Tutorien, die mich hier in dem Kapitel inspiriert haben. Ich habe mich ja in diesem Kapitel auf die Durchführbarkeit in R und die allgemeine Verständlichkeit konzentriert. Es geht aber natürlich wie immer auch mathematischer...</span>
<span id="cb76-81"><a href="#cb76-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-82"><a href="#cb76-82" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wir funktioniert nun so eine lineare Regression und was sind den jetzt eigentlich die Koeffizienten $\beta_0$ und $\beta_1$ eigentlich? Hier gibt es die fantastische Seite <span class="co">[</span><span class="ot">Explained Visually \| Ordinary Least Squares Regression</span><span class="co">](https://setosa.io/ev/ordinary-least-squares-regression/)</span>, die dir nochmal erlaubt selbe mit Punkten in einem Scatterplot zu spielen und zu sehen wie sich dann die Regressionsgleichung ändert.</span>
<span id="cb76-83"><a href="#cb76-83" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das Buch <span class="co">[</span><span class="ot">Tidy Modeling with R</span><span class="co">](https://www.tmwr.org/)</span> gibt nochmal einen tieferen Einblick in das Modellieren in R. Wir immer, es ist ein Vorschlag aber kein Muss.</span>
<span id="cb76-84"><a href="#cb76-84" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb76-85"><a href="#cb76-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-86"><a href="#cb76-86" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb76-87"><a href="#cb76-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-88"><a href="#cb76-88" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb76-89"><a href="#cb76-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-90"><a href="#cb76-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb76-91"><a href="#cb76-91" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb76-92"><a href="#cb76-92" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, broom,</span></span>
<span id="cb76-93"><a href="#cb76-93" aria-hidden="true" tabindex="-1"></a><span class="in">               see, performance, car, parameters,</span></span>
<span id="cb76-94"><a href="#cb76-94" aria-hidden="true" tabindex="-1"></a><span class="in">               conflicted)</span></span>
<span id="cb76-95"><a href="#cb76-95" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(magrittr::set_names)</span></span>
<span id="cb76-96"><a href="#cb76-96" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb76-97"><a href="#cb76-97" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb76-98"><a href="#cb76-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-99"><a href="#cb76-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-100"><a href="#cb76-100" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb76-101"><a href="#cb76-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-102"><a href="#cb76-102" aria-hidden="true" tabindex="-1"></a><span class="fu">## Die Modellmatrix in R {#sec-modell-matrix}</span></span>
<span id="cb76-103"><a href="#cb76-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-104"><a href="#cb76-104" aria-hidden="true" tabindex="-1"></a>Als erstes wollen wir verstehen, wie ein Modell *in* R aussieht. Dann können wir auch besser verstehen, wie die eigentlichen Koeffizienten aus dem Modell entstehen. Wozu brauche ich das? Eine gute Frage. Du brauchst das Verständnis der Modellmatrix, wenn du verstehen willst *wie* R in einer linearen Regression zu den Koeffizienten kommt. Wir bauen uns dafür ein sehr simplen Datensatz. Wir bauen uns einen Datensatz mit Schlangen.</span>
<span id="cb76-105"><a href="#cb76-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-108"><a href="#cb76-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-109"><a href="#cb76-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-110"><a href="#cb76-110" aria-hidden="true" tabindex="-1"></a>snake_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb76-111"><a href="#cb76-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">svl =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">45</span>, <span class="dv">39</span>, <span class="dv">51</span>, <span class="dv">52</span>, <span class="dv">57</span>, <span class="dv">58</span>, <span class="dv">49</span>),</span>
<span id="cb76-112"><a href="#cb76-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">mass =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">10</span>),</span>
<span id="cb76-113"><a href="#cb76-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="fu">as_factor</span>(<span class="fu">c</span>(<span class="st">"west"</span>,<span class="st">"west"</span>, <span class="st">"west"</span>, <span class="st">"nord"</span>,<span class="st">"nord"</span>,<span class="st">"nord"</span>,<span class="st">"nord"</span>,<span class="st">"nord"</span>)),</span>
<span id="cb76-114"><a href="#cb76-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">as_factor</span>(<span class="fu">c</span>(<span class="st">"schwarz"</span>, <span class="st">"schwarz"</span>, <span class="st">"rot"</span>, <span class="st">"rot"</span>, <span class="st">"rot"</span>, <span class="st">"blau"</span>, <span class="st">"blau"</span>, <span class="st">"blau"</span>))</span>
<span id="cb76-115"><a href="#cb76-115" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb76-116"><a href="#cb76-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-117"><a href="#cb76-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-118"><a href="#cb76-118" aria-hidden="true" tabindex="-1"></a>In der @tbl-snakes ist der Datensatz <span class="in">`snake_tbl`</span> nochmal dargestellt. Wir haben die Schlangenlänge <span class="in">`svl`</span> als Outcome $y$ sowie das Gewicht der Schlangen <span class="in">`mass`</span>, die Sammelregion <span class="in">`region`</span> und die Farbe der Schlangen <span class="in">`color`</span>. Dabei ist <span class="in">`mass`</span> eine kontinuierliche Variable, <span class="in">`region`</span> eine kategorielle Variable als Faktor mit zwei Leveln und <span class="in">`color`</span> eine kategorielle Variable als Faktor mit drei Leveln.</span>
<span id="cb76-119"><a href="#cb76-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-122"><a href="#cb76-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-123"><a href="#cb76-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-124"><a href="#cb76-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb76-125"><a href="#cb76-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Datensatz zu Schlangen ist entlehnt und modifiiert nach Kéry [-@kery2010introduction, p. 77]</span></span>
<span id="cb76-126"><a href="#cb76-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-snakes</span></span>
<span id="cb76-127"><a href="#cb76-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-128"><a href="#cb76-128" aria-hidden="true" tabindex="-1"></a>snake_tbl <span class="sc">|&gt;</span> </span>
<span id="cb76-129"><a href="#cb76-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb76-130"><a href="#cb76-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-131"><a href="#cb76-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-132"><a href="#cb76-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-133"><a href="#cb76-133" aria-hidden="true" tabindex="-1"></a>Wir wollen uns nun einmal anschauen, wie ein Modell in R sich zusammensetzt. Je nachdem welche Spalte $x$ wir verwenden um den Zusammenhang zum $y$ aufzuzeigen.</span>
<span id="cb76-134"><a href="#cb76-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-135"><a href="#cb76-135" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kontinuierliches $x$</span></span>
<span id="cb76-136"><a href="#cb76-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-137"><a href="#cb76-137" aria-hidden="true" tabindex="-1"></a>Im ersten Schritt wollen wir uns einmal das Modell mit einem kontinuierlichen $x$ anschauen. Daher bauen wir uns ein lineares Modell mit der Variable <span class="in">`mass`</span>. Wir erinnern uns, dass <span class="in">`mass`</span> eine kontinuierliche Variable ist, da wir hier nur Zahlen in der Spalte finden. Die Funktion <span class="in">`model.matrix()`</span> gibt uns die Modellmatrix wieder.</span>
<span id="cb76-138"><a href="#cb76-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-141"><a href="#cb76-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-142"><a href="#cb76-142" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> mass, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb76-143"><a href="#cb76-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-144"><a href="#cb76-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-145"><a href="#cb76-145" aria-hidden="true" tabindex="-1"></a>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalte <span class="in">`mass`</span> als kontinuierliche Variable.</span>
<span id="cb76-146"><a href="#cb76-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-147"><a href="#cb76-147" aria-hidden="true" tabindex="-1"></a>Wir können die Modellmatrix auch mathematisch schreiben und die $y$ Spalte für das Outcome <span class="in">`svl`</span> ergänzen. Eben so ergänzen wir die $\beta$-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Gerade.</span>
<span id="cb76-148"><a href="#cb76-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-149"><a href="#cb76-149" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-150"><a href="#cb76-150" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb76-151"><a href="#cb76-151" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb76-152"><a href="#cb76-152" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb76-153"><a href="#cb76-153" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb76-154"><a href="#cb76-154" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb76-155"><a href="#cb76-155" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb76-156"><a href="#cb76-156" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb76-157"><a href="#cb76-157" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb76-158"><a href="#cb76-158" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb76-159"><a href="#cb76-159" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-160"><a href="#cb76-160" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb76-161"><a href="#cb76-161" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-162"><a href="#cb76-162" aria-hidden="true" tabindex="-1"></a>  1 &amp; 6 <span class="sc">\\</span></span>
<span id="cb76-163"><a href="#cb76-163" aria-hidden="true" tabindex="-1"></a>  1 &amp; 8 <span class="sc">\\</span></span>
<span id="cb76-164"><a href="#cb76-164" aria-hidden="true" tabindex="-1"></a>  1 &amp; 5 <span class="sc">\\</span></span>
<span id="cb76-165"><a href="#cb76-165" aria-hidden="true" tabindex="-1"></a>  1 &amp; 7 <span class="sc">\\</span></span>
<span id="cb76-166"><a href="#cb76-166" aria-hidden="true" tabindex="-1"></a>  1 &amp; 9 <span class="sc">\\</span></span>
<span id="cb76-167"><a href="#cb76-167" aria-hidden="true" tabindex="-1"></a>  1 &amp; 11<span class="sc">\\</span></span>
<span id="cb76-168"><a href="#cb76-168" aria-hidden="true" tabindex="-1"></a>  1 &amp; 12<span class="sc">\\</span></span>
<span id="cb76-169"><a href="#cb76-169" aria-hidden="true" tabindex="-1"></a>  1 &amp; 10<span class="sc">\\</span></span>
<span id="cb76-170"><a href="#cb76-170" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-171"><a href="#cb76-171" aria-hidden="true" tabindex="-1"></a> \times</span>
<span id="cb76-172"><a href="#cb76-172" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-173"><a href="#cb76-173" aria-hidden="true" tabindex="-1"></a>  \beta_0 <span class="sc">\\</span></span>
<span id="cb76-174"><a href="#cb76-174" aria-hidden="true" tabindex="-1"></a>  \beta_{mass} </span>
<span id="cb76-175"><a href="#cb76-175" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb76-176"><a href="#cb76-176" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-177"><a href="#cb76-177" aria-hidden="true" tabindex="-1"></a>  \epsilon_1 <span class="sc">\\</span></span>
<span id="cb76-178"><a href="#cb76-178" aria-hidden="true" tabindex="-1"></a>  \epsilon_2 <span class="sc">\\</span></span>
<span id="cb76-179"><a href="#cb76-179" aria-hidden="true" tabindex="-1"></a>  \epsilon_3 <span class="sc">\\</span></span>
<span id="cb76-180"><a href="#cb76-180" aria-hidden="true" tabindex="-1"></a>  \epsilon_4 <span class="sc">\\</span></span>
<span id="cb76-181"><a href="#cb76-181" aria-hidden="true" tabindex="-1"></a>  \epsilon_5 <span class="sc">\\</span></span>
<span id="cb76-182"><a href="#cb76-182" aria-hidden="true" tabindex="-1"></a>  \epsilon_6 <span class="sc">\\</span></span>
<span id="cb76-183"><a href="#cb76-183" aria-hidden="true" tabindex="-1"></a>  \epsilon_7 <span class="sc">\\</span></span>
<span id="cb76-184"><a href="#cb76-184" aria-hidden="true" tabindex="-1"></a>  \epsilon_8 <span class="sc">\\</span></span>
<span id="cb76-185"><a href="#cb76-185" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-186"><a href="#cb76-186" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-187"><a href="#cb76-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-188"><a href="#cb76-188" aria-hidden="true" tabindex="-1"></a>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt mit der Funktion <span class="in">`lm()`</span> fitten. Wir nutzen dann die Funktion <span class="in">`coef()`</span> um uns die Koeffizienten aus dem Objekt <span class="in">`fit_1`</span> wiedergeben zu lassen.</span>
<span id="cb76-189"><a href="#cb76-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-192"><a href="#cb76-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-193"><a href="#cb76-193" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> mass, <span class="at">data =</span> snake_tbl) </span>
<span id="cb76-194"><a href="#cb76-194" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb76-195"><a href="#cb76-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-196"><a href="#cb76-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-197"><a href="#cb76-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-198"><a href="#cb76-198" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`residuals()`</span> gibt uns die Residuen der Geraden aus dem Objekt <span class="in">`fit_1`</span> wieder.</span>
<span id="cb76-199"><a href="#cb76-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-202"><a href="#cb76-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-203"><a href="#cb76-203" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb76-204"><a href="#cb76-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-205"><a href="#cb76-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-206"><a href="#cb76-206" aria-hidden="true" tabindex="-1"></a>Wir können jetzt die Koeffizienten in die Modellmatrix ergänzen. Wir haben den Intercept mit $\beta_0 = 26.71$ geschätzt. Weiter ergänzen wir die Koeffizienten aus dem linearen Modell für <span class="in">`mass`</span> mit $\beta_{mass}=2.61$. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein. Wir erhalten dann folgende ausgefüllte Gleichung mit den Matrixen.</span>
<span id="cb76-207"><a href="#cb76-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-208"><a href="#cb76-208" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-209"><a href="#cb76-209" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb76-210"><a href="#cb76-210" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb76-211"><a href="#cb76-211" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb76-212"><a href="#cb76-212" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb76-213"><a href="#cb76-213" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb76-214"><a href="#cb76-214" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb76-215"><a href="#cb76-215" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb76-216"><a href="#cb76-216" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb76-217"><a href="#cb76-217" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb76-218"><a href="#cb76-218" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-219"><a href="#cb76-219" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb76-220"><a href="#cb76-220" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-221"><a href="#cb76-221" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; \phantom{0}6 \cdot 2.61<span class="sc">\\</span></span>
<span id="cb76-222"><a href="#cb76-222" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; \phantom{0}8 \cdot 2.61<span class="sc">\\</span></span>
<span id="cb76-223"><a href="#cb76-223" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; \phantom{0}5 \cdot 2.61<span class="sc">\\</span></span>
<span id="cb76-224"><a href="#cb76-224" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; \phantom{0}7 \cdot 2.61<span class="sc">\\</span></span>
<span id="cb76-225"><a href="#cb76-225" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; \phantom{0}9 \cdot 2.61<span class="sc">\\</span></span>
<span id="cb76-226"><a href="#cb76-226" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; 11\cdot 2.61<span class="sc">\\</span></span>
<span id="cb76-227"><a href="#cb76-227" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; 12\cdot 2.61<span class="sc">\\</span></span>
<span id="cb76-228"><a href="#cb76-228" aria-hidden="true" tabindex="-1"></a>  26.71 &amp; 10\cdot 2.61<span class="sc">\\</span></span>
<span id="cb76-229"><a href="#cb76-229" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-230"><a href="#cb76-230" aria-hidden="true" tabindex="-1"></a>  +</span>
<span id="cb76-231"><a href="#cb76-231" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-232"><a href="#cb76-232" aria-hidden="true" tabindex="-1"></a>  -2.36<span class="sc">\\</span></span>
<span id="cb76-233"><a href="#cb76-233" aria-hidden="true" tabindex="-1"></a>  -2.57<span class="sc">\\</span></span>
<span id="cb76-234"><a href="#cb76-234" aria-hidden="true" tabindex="-1"></a>  -0.75 <span class="sc">\\</span></span>
<span id="cb76-235"><a href="#cb76-235" aria-hidden="true" tabindex="-1"></a>  +6.04<span class="sc">\\</span></span>
<span id="cb76-236"><a href="#cb76-236" aria-hidden="true" tabindex="-1"></a>  +1.82<span class="sc">\\</span></span>
<span id="cb76-237"><a href="#cb76-237" aria-hidden="true" tabindex="-1"></a>  +1.61<span class="sc">\\</span></span>
<span id="cb76-238"><a href="#cb76-238" aria-hidden="true" tabindex="-1"></a>  \phantom{+}0.00<span class="sc">\\</span></span>
<span id="cb76-239"><a href="#cb76-239" aria-hidden="true" tabindex="-1"></a>  -3.79<span class="sc">\\</span></span>
<span id="cb76-240"><a href="#cb76-240" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-241"><a href="#cb76-241" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-242"><a href="#cb76-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-243"><a href="#cb76-243" aria-hidden="true" tabindex="-1"></a>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis. Wie du siehst ergänzen wir hier noch eine Reihe von $+$ um den Intercept mit der Steigung zu verbinden. Steht ja auch so in der Gleichung des linearen Modells drin, alles wird mit einem $+$ miteinander verbunden.</span>
<span id="cb76-244"><a href="#cb76-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-247"><a href="#cb76-247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-248"><a href="#cb76-248" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">6</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">2.36</span>,</span>
<span id="cb76-249"><a href="#cb76-249" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">8</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">2.57</span>,</span>
<span id="cb76-250"><a href="#cb76-250" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">5</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">0.75</span>,</span>
<span id="cb76-251"><a href="#cb76-251" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">7</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">6.04</span>,</span>
<span id="cb76-252"><a href="#cb76-252" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span>  <span class="dv">9</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">1.82</span>,</span>
<span id="cb76-253"><a href="#cb76-253" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span> <span class="dv">11</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">1.61</span>,</span>
<span id="cb76-254"><a href="#cb76-254" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb76-255"><a href="#cb76-255" aria-hidden="true" tabindex="-1"></a>  <span class="fl">26.71</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">2.61</span> <span class="sc">-</span> <span class="fl">3.79</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>() </span>
<span id="cb76-256"><a href="#cb76-256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-257"><a href="#cb76-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-258"><a href="#cb76-258" aria-hidden="true" tabindex="-1"></a>Oh ha! Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Outcome $y$ hat. Das heißt, die ganze Sache hat funktioniert.</span>
<span id="cb76-259"><a href="#cb76-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-260"><a href="#cb76-260" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kategorielles $x$ mit 2 Leveln</span></span>
<span id="cb76-261"><a href="#cb76-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-262"><a href="#cb76-262" aria-hidden="true" tabindex="-1"></a>Im diesem Schritt wollen wir uns einmal das Modell mit einem kategoriellen $x$ mit 2 Leveln anschauen. Wir bauen uns ein Modell mit der Variable ``` region``. Die Funktion ``<span class="in">`model.matrix()\`</span> gibt uns die Modelmatrix wieder.</span>
<span id="cb76-263"><a href="#cb76-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-266"><a href="#cb76-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-267"><a href="#cb76-267" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> region, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb76-268"><a href="#cb76-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-269"><a href="#cb76-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-270"><a href="#cb76-270" aria-hidden="true" tabindex="-1"></a>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalte <span class="in">`regionnord`</span>. In dieser Spalte steht die Dummykodierung für die Variable <span class="in">`region`</span>. Die ersten drei Schlangen kommen nicht aus der Region <span class="in">`nord`</span> und werden deshalb mit einen Wert von 0 versehen. Die nächsten vier Schlangen kommen aus der Region <span class="in">`nord`</span> und erhalten daher eine 1 in der Spalte.</span>
<span id="cb76-271"><a href="#cb76-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-272"><a href="#cb76-272" aria-hidden="true" tabindex="-1"></a>Wir können die Modellmatrix auch mathematisch schreiben und die $y$ Spalte für das Outcome <span class="in">`svl`</span> ergänzen. Eben so ergänzen wir die $\beta$-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Gerade.</span>
<span id="cb76-273"><a href="#cb76-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-274"><a href="#cb76-274" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-275"><a href="#cb76-275" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb76-276"><a href="#cb76-276" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb76-277"><a href="#cb76-277" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb76-278"><a href="#cb76-278" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb76-279"><a href="#cb76-279" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb76-280"><a href="#cb76-280" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb76-281"><a href="#cb76-281" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb76-282"><a href="#cb76-282" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb76-283"><a href="#cb76-283" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb76-284"><a href="#cb76-284" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-285"><a href="#cb76-285" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb76-286"><a href="#cb76-286" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-287"><a href="#cb76-287" aria-hidden="true" tabindex="-1"></a>  1 &amp;  0  <span class="sc">\\</span></span>
<span id="cb76-288"><a href="#cb76-288" aria-hidden="true" tabindex="-1"></a>  1 &amp;  0 <span class="sc">\\</span></span>
<span id="cb76-289"><a href="#cb76-289" aria-hidden="true" tabindex="-1"></a>  1 &amp;  0<span class="sc">\\</span></span>
<span id="cb76-290"><a href="#cb76-290" aria-hidden="true" tabindex="-1"></a>  1 &amp;  1<span class="sc">\\</span></span>
<span id="cb76-291"><a href="#cb76-291" aria-hidden="true" tabindex="-1"></a>  1 &amp;  1 <span class="sc">\\</span></span>
<span id="cb76-292"><a href="#cb76-292" aria-hidden="true" tabindex="-1"></a>  1 &amp;  1 <span class="sc">\\</span></span>
<span id="cb76-293"><a href="#cb76-293" aria-hidden="true" tabindex="-1"></a>  1 &amp;  1 <span class="sc">\\</span></span>
<span id="cb76-294"><a href="#cb76-294" aria-hidden="true" tabindex="-1"></a>  1 &amp;  1 <span class="sc">\\</span></span>
<span id="cb76-295"><a href="#cb76-295" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-296"><a href="#cb76-296" aria-hidden="true" tabindex="-1"></a> \times</span>
<span id="cb76-297"><a href="#cb76-297" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-298"><a href="#cb76-298" aria-hidden="true" tabindex="-1"></a>  \beta_0 <span class="sc">\\</span></span>
<span id="cb76-299"><a href="#cb76-299" aria-hidden="true" tabindex="-1"></a>  \beta^{region}_{nord} <span class="sc">\\</span></span>
<span id="cb76-300"><a href="#cb76-300" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb76-301"><a href="#cb76-301" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-302"><a href="#cb76-302" aria-hidden="true" tabindex="-1"></a>  \epsilon_1 <span class="sc">\\</span></span>
<span id="cb76-303"><a href="#cb76-303" aria-hidden="true" tabindex="-1"></a>  \epsilon_2 <span class="sc">\\</span></span>
<span id="cb76-304"><a href="#cb76-304" aria-hidden="true" tabindex="-1"></a>  \epsilon_3 <span class="sc">\\</span></span>
<span id="cb76-305"><a href="#cb76-305" aria-hidden="true" tabindex="-1"></a>  \epsilon_4 <span class="sc">\\</span></span>
<span id="cb76-306"><a href="#cb76-306" aria-hidden="true" tabindex="-1"></a>  \epsilon_5 <span class="sc">\\</span></span>
<span id="cb76-307"><a href="#cb76-307" aria-hidden="true" tabindex="-1"></a>  \epsilon_6 <span class="sc">\\</span></span>
<span id="cb76-308"><a href="#cb76-308" aria-hidden="true" tabindex="-1"></a>  \epsilon_7 <span class="sc">\\</span></span>
<span id="cb76-309"><a href="#cb76-309" aria-hidden="true" tabindex="-1"></a>  \epsilon_8 <span class="sc">\\</span></span>
<span id="cb76-310"><a href="#cb76-310" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-311"><a href="#cb76-311" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-312"><a href="#cb76-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-313"><a href="#cb76-313" aria-hidden="true" tabindex="-1"></a>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <span class="in">`coef()`</span> um uns die Koeffizienten wiedergeben zu lassen.</span>
<span id="cb76-314"><a href="#cb76-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-317"><a href="#cb76-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-318"><a href="#cb76-318" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> region, <span class="at">data =</span> snake_tbl) </span>
<span id="cb76-319"><a href="#cb76-319" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb76-320"><a href="#cb76-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-321"><a href="#cb76-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-322"><a href="#cb76-322" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`residuals()`</span> gibt uns die Residuen der Geraden aus dem Objekt <span class="in">`fit_2`</span> wieder.</span>
<span id="cb76-323"><a href="#cb76-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-326"><a href="#cb76-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-327"><a href="#cb76-327" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb76-328"><a href="#cb76-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-329"><a href="#cb76-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-330"><a href="#cb76-330" aria-hidden="true" tabindex="-1"></a>Wir können jetzt die Koeffizienten ergänzen mit $\beta_0 = 41.33$ für den Intercept. Weiter ergänzen wir die Koeffizienten für die Region und das Level <span class="in">`nord`</span> mit $\beta^{region}_{nord} = 12.07$. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein.</span>
<span id="cb76-331"><a href="#cb76-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-332"><a href="#cb76-332" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-333"><a href="#cb76-333" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb76-334"><a href="#cb76-334" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb76-335"><a href="#cb76-335" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb76-336"><a href="#cb76-336" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb76-337"><a href="#cb76-337" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb76-338"><a href="#cb76-338" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb76-339"><a href="#cb76-339" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb76-340"><a href="#cb76-340" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb76-341"><a href="#cb76-341" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb76-342"><a href="#cb76-342" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-343"><a href="#cb76-343" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb76-344"><a href="#cb76-344" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-345"><a href="#cb76-345" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 0 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb76-346"><a href="#cb76-346" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 0 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb76-347"><a href="#cb76-347" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 0 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb76-348"><a href="#cb76-348" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 1 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb76-349"><a href="#cb76-349" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 1 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb76-350"><a href="#cb76-350" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 1 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb76-351"><a href="#cb76-351" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 1 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb76-352"><a href="#cb76-352" aria-hidden="true" tabindex="-1"></a>  41.33 &amp; 1 \cdot 12.07  <span class="sc">\\</span></span>
<span id="cb76-353"><a href="#cb76-353" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb76-354"><a href="#cb76-354" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-355"><a href="#cb76-355" aria-hidden="true" tabindex="-1"></a>  -1.33<span class="sc">\\</span></span>
<span id="cb76-356"><a href="#cb76-356" aria-hidden="true" tabindex="-1"></a>  +3.67 <span class="sc">\\</span></span>
<span id="cb76-357"><a href="#cb76-357" aria-hidden="true" tabindex="-1"></a>  -2.33 <span class="sc">\\</span></span>
<span id="cb76-358"><a href="#cb76-358" aria-hidden="true" tabindex="-1"></a>  -2.40 <span class="sc">\\</span></span>
<span id="cb76-359"><a href="#cb76-359" aria-hidden="true" tabindex="-1"></a>  -1.40 <span class="sc">\\</span></span>
<span id="cb76-360"><a href="#cb76-360" aria-hidden="true" tabindex="-1"></a>  +3.60 <span class="sc">\\</span></span>
<span id="cb76-361"><a href="#cb76-361" aria-hidden="true" tabindex="-1"></a>  +4.60 <span class="sc">\\</span></span>
<span id="cb76-362"><a href="#cb76-362" aria-hidden="true" tabindex="-1"></a>  -4.40 <span class="sc">\\</span></span>
<span id="cb76-363"><a href="#cb76-363" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-364"><a href="#cb76-364" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-365"><a href="#cb76-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-366"><a href="#cb76-366" aria-hidden="true" tabindex="-1"></a>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</span>
<span id="cb76-367"><a href="#cb76-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-370"><a href="#cb76-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-371"><a href="#cb76-371" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">1.33</span>,</span>
<span id="cb76-372"><a href="#cb76-372" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">+</span> <span class="fl">3.67</span>,</span>
<span id="cb76-373"><a href="#cb76-373" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">2.33</span>,</span>
<span id="cb76-374"><a href="#cb76-374" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">2.40</span>,</span>
<span id="cb76-375"><a href="#cb76-375" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">1.40</span>,</span>
<span id="cb76-376"><a href="#cb76-376" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">+</span> <span class="fl">3.60</span>,</span>
<span id="cb76-377"><a href="#cb76-377" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">+</span> <span class="fl">4.60</span>,</span>
<span id="cb76-378"><a href="#cb76-378" aria-hidden="true" tabindex="-1"></a>  <span class="fl">41.33</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.07</span> <span class="sc">-</span> <span class="fl">4.40</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>() </span>
<span id="cb76-379"><a href="#cb76-379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-380"><a href="#cb76-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-381"><a href="#cb76-381" aria-hidden="true" tabindex="-1"></a>Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Outcome $y$ hat.</span>
<span id="cb76-382"><a href="#cb76-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-383"><a href="#cb76-383" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kategorielles $x$ mit \&gt;2 Leveln</span></span>
<span id="cb76-384"><a href="#cb76-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-385"><a href="#cb76-385" aria-hidden="true" tabindex="-1"></a>Im diesem Schritt wollen wir uns einmal das Modell mit einem kategoriellen $x$ mit <span class="sc">\&gt;</span>2 Leveln anschauen. Wir bauen uns ein Modell mit der Variable <span class="in">`color`</span>. Die Funktion <span class="in">`model.matrix()`</span> gibt uns die Modelmatrix wieder.</span>
<span id="cb76-386"><a href="#cb76-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-389"><a href="#cb76-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-390"><a href="#cb76-390" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> color, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>()</span>
<span id="cb76-391"><a href="#cb76-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-392"><a href="#cb76-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-393"><a href="#cb76-393" aria-hidden="true" tabindex="-1"></a>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalten für <span class="in">`color`</span>. Die Spalten <span class="in">`colorrot`</span> und <span class="in">`colorblau`</span> geben jeweils an, ob die Schlange das Level <span class="in">`rot`</span> hat oder <span class="in">`blau`</span> oder keins von beiden. Wenn die Schlange weder rot noch blau ist, dann sind beide Spalten mit einer 0 versehen. Dann ist die Schlange schwarz.</span>
<span id="cb76-394"><a href="#cb76-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-395"><a href="#cb76-395" aria-hidden="true" tabindex="-1"></a>Wir können die Modellmatrix auch mathematisch schreiben und die $y$ Spalte für das Outcome <span class="in">`svl`</span> ergänzen. Eben so ergänzen wir die $\beta$-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Gerade.</span>
<span id="cb76-396"><a href="#cb76-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-397"><a href="#cb76-397" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-398"><a href="#cb76-398" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb76-399"><a href="#cb76-399" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb76-400"><a href="#cb76-400" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb76-401"><a href="#cb76-401" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb76-402"><a href="#cb76-402" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb76-403"><a href="#cb76-403" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb76-404"><a href="#cb76-404" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb76-405"><a href="#cb76-405" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb76-406"><a href="#cb76-406" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb76-407"><a href="#cb76-407" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-408"><a href="#cb76-408" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb76-409"><a href="#cb76-409" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-410"><a href="#cb76-410" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb76-411"><a href="#cb76-411" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb76-412"><a href="#cb76-412" aria-hidden="true" tabindex="-1"></a>  1 &amp; 1 &amp; 0<span class="sc">\\</span></span>
<span id="cb76-413"><a href="#cb76-413" aria-hidden="true" tabindex="-1"></a>  1 &amp; 1 &amp; 0<span class="sc">\\</span></span>
<span id="cb76-414"><a href="#cb76-414" aria-hidden="true" tabindex="-1"></a>  1 &amp; 1 &amp; 0<span class="sc">\\</span></span>
<span id="cb76-415"><a href="#cb76-415" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 1<span class="sc">\\</span></span>
<span id="cb76-416"><a href="#cb76-416" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 1<span class="sc">\\</span></span>
<span id="cb76-417"><a href="#cb76-417" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 1<span class="sc">\\</span></span>
<span id="cb76-418"><a href="#cb76-418" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-419"><a href="#cb76-419" aria-hidden="true" tabindex="-1"></a> \times</span>
<span id="cb76-420"><a href="#cb76-420" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-421"><a href="#cb76-421" aria-hidden="true" tabindex="-1"></a>  \beta_0 <span class="sc">\\</span></span>
<span id="cb76-422"><a href="#cb76-422" aria-hidden="true" tabindex="-1"></a>  \beta^{color}_{rot} <span class="sc">\\</span></span>
<span id="cb76-423"><a href="#cb76-423" aria-hidden="true" tabindex="-1"></a>  \beta^{color}_{blau} <span class="sc">\\</span></span>
<span id="cb76-424"><a href="#cb76-424" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb76-425"><a href="#cb76-425" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-426"><a href="#cb76-426" aria-hidden="true" tabindex="-1"></a>  \epsilon_1 <span class="sc">\\</span></span>
<span id="cb76-427"><a href="#cb76-427" aria-hidden="true" tabindex="-1"></a>  \epsilon_2 <span class="sc">\\</span></span>
<span id="cb76-428"><a href="#cb76-428" aria-hidden="true" tabindex="-1"></a>  \epsilon_3 <span class="sc">\\</span></span>
<span id="cb76-429"><a href="#cb76-429" aria-hidden="true" tabindex="-1"></a>  \epsilon_4 <span class="sc">\\</span></span>
<span id="cb76-430"><a href="#cb76-430" aria-hidden="true" tabindex="-1"></a>  \epsilon_5 <span class="sc">\\</span></span>
<span id="cb76-431"><a href="#cb76-431" aria-hidden="true" tabindex="-1"></a>  \epsilon_6 <span class="sc">\\</span></span>
<span id="cb76-432"><a href="#cb76-432" aria-hidden="true" tabindex="-1"></a>  \epsilon_7 <span class="sc">\\</span></span>
<span id="cb76-433"><a href="#cb76-433" aria-hidden="true" tabindex="-1"></a>  \epsilon_8 <span class="sc">\\</span></span>
<span id="cb76-434"><a href="#cb76-434" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-435"><a href="#cb76-435" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-436"><a href="#cb76-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-437"><a href="#cb76-437" aria-hidden="true" tabindex="-1"></a>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <span class="in">`coef()`</span> um uns die Koeffizienten wiedergeben zu lassen.</span>
<span id="cb76-438"><a href="#cb76-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-441"><a href="#cb76-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-442"><a href="#cb76-442" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> color, <span class="at">data =</span> snake_tbl) </span>
<span id="cb76-443"><a href="#cb76-443" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb76-444"><a href="#cb76-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-445"><a href="#cb76-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-446"><a href="#cb76-446" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`residuals()`</span> gibt uns die Residuen der Geraden aus dem Objekt <span class="in">`fit_3`</span> wieder.</span>
<span id="cb76-447"><a href="#cb76-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-450"><a href="#cb76-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-451"><a href="#cb76-451" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb76-452"><a href="#cb76-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-453"><a href="#cb76-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-454"><a href="#cb76-454" aria-hidden="true" tabindex="-1"></a>Wir können jetzt die Koeffizienten ergänzen mit $\beta_0 = 25$ für den Intercept. Weiter ergänzen wir die Koeffizienten für die Farbe und das Level <span class="in">`rot`</span> mit $\beta^{color}_{rot} = 4.83$ und für die Farbe und das Level `blau` mit $\beta^{color}_{blau} = 12.17$. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein.</span>
<span id="cb76-455"><a href="#cb76-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-456"><a href="#cb76-456" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-457"><a href="#cb76-457" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb76-458"><a href="#cb76-458" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb76-459"><a href="#cb76-459" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb76-460"><a href="#cb76-460" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb76-461"><a href="#cb76-461" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb76-462"><a href="#cb76-462" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb76-463"><a href="#cb76-463" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb76-464"><a href="#cb76-464" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb76-465"><a href="#cb76-465" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb76-466"><a href="#cb76-466" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-467"><a href="#cb76-467" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb76-468"><a href="#cb76-468" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-469"><a href="#cb76-469" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot 4.83&amp; 0 \cdot 12.17 <span class="sc">\\</span></span>
<span id="cb76-470"><a href="#cb76-470" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot 4.83&amp; 0 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb76-471"><a href="#cb76-471" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb76-472"><a href="#cb76-472" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb76-473"><a href="#cb76-473" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 1 \cdot 4.83&amp; 0 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb76-474"><a href="#cb76-474" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb76-475"><a href="#cb76-475" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb76-476"><a href="#cb76-476" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot 4.83&amp; 1 \cdot 12.17<span class="sc">\\</span></span>
<span id="cb76-477"><a href="#cb76-477" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb76-478"><a href="#cb76-478" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-479"><a href="#cb76-479" aria-hidden="true" tabindex="-1"></a>  -2.50 <span class="sc">\\</span></span>
<span id="cb76-480"><a href="#cb76-480" aria-hidden="true" tabindex="-1"></a>  +2.50 <span class="sc">\\</span></span>
<span id="cb76-481"><a href="#cb76-481" aria-hidden="true" tabindex="-1"></a>  -8.33 <span class="sc">\\</span></span>
<span id="cb76-482"><a href="#cb76-482" aria-hidden="true" tabindex="-1"></a>  +3.67 <span class="sc">\\</span></span>
<span id="cb76-483"><a href="#cb76-483" aria-hidden="true" tabindex="-1"></a>  +4.67 <span class="sc">\\</span></span>
<span id="cb76-484"><a href="#cb76-484" aria-hidden="true" tabindex="-1"></a>  +2.33 <span class="sc">\\</span></span>
<span id="cb76-485"><a href="#cb76-485" aria-hidden="true" tabindex="-1"></a>  +3.33 <span class="sc">\\</span></span>
<span id="cb76-486"><a href="#cb76-486" aria-hidden="true" tabindex="-1"></a>  -5.67 <span class="sc">\\</span></span>
<span id="cb76-487"><a href="#cb76-487" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-488"><a href="#cb76-488" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-489"><a href="#cb76-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-490"><a href="#cb76-490" aria-hidden="true" tabindex="-1"></a>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</span>
<span id="cb76-491"><a href="#cb76-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-494"><a href="#cb76-494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-495"><a href="#cb76-495" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">-</span> <span class="fl">2.50</span>,</span>
<span id="cb76-496"><a href="#cb76-496" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">2.50</span>,</span>
<span id="cb76-497"><a href="#cb76-497" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">-</span> <span class="fl">8.33</span>,</span>
<span id="cb76-498"><a href="#cb76-498" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">3.67</span>,</span>
<span id="cb76-499"><a href="#cb76-499" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">4.67</span>,</span>
<span id="cb76-500"><a href="#cb76-500" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">2.33</span>,</span>
<span id="cb76-501"><a href="#cb76-501" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">+</span> <span class="fl">3.33</span>,</span>
<span id="cb76-502"><a href="#cb76-502" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">4.83</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">12.17</span> <span class="sc">-</span> <span class="fl">5.67</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>()</span>
<span id="cb76-503"><a href="#cb76-503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-504"><a href="#cb76-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-505"><a href="#cb76-505" aria-hidden="true" tabindex="-1"></a>Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Outcome $y$ hat.</span>
<span id="cb76-506"><a href="#cb76-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-507"><a href="#cb76-507" aria-hidden="true" tabindex="-1"></a><span class="fu">### Das volle Modell</span></span>
<span id="cb76-508"><a href="#cb76-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-509"><a href="#cb76-509" aria-hidden="true" tabindex="-1"></a>Im letzten Schritt wollen wir uns einmal das volle Modell anschauen. Wir bauen uns ein Modell mit allen Variablen in dem Datensatz <span class="in">`snake_tbl`</span>. Die Funktion <span class="in">`model.matrix()`</span> gibt uns die Modelmatrix wieder.</span>
<span id="cb76-510"><a href="#cb76-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-513"><a href="#cb76-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-514"><a href="#cb76-514" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> mass <span class="sc">+</span> region <span class="sc">+</span> color, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() </span>
<span id="cb76-515"><a href="#cb76-515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-516"><a href="#cb76-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-517"><a href="#cb76-517" aria-hidden="true" tabindex="-1"></a>In der ersten Spalte ist der Intercept angegeben, danach folgt dann die Spalte <span class="in">`mass`</span> als kontenuierliche Variable. In der Spalte <span class="in">`regionnord`</span> steht die Dummykodierung für die Variable <span class="in">`region`</span>. Die ersten drei Schlangen kommen nicht aus der Region <span class="in">`nord`</span> und werden deshalb mit einen Wert von 0 versehen. Die nächsten vier Schlangen kommen aus der Region <span class="in">`nord`</span> und erhalten daher eine 1 in der Spalte. Die nächsten beiden Spalten sind etwas komplizierter. Die Spalten <span class="in">`colorrot`</span> und <span class="in">`colorblau`</span> geben jeweils an, ob die Schlange das Level <span class="in">`rot`</span> hat oder <span class="in">`blau`</span> oder keins von beiden. Wenn die Schlange weder rot noch blau ist, dann sind beide Spalten mit einer 0 versehen. Dann ist die Schlange schwarz.</span>
<span id="cb76-518"><a href="#cb76-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-519"><a href="#cb76-519" aria-hidden="true" tabindex="-1"></a>Wir können die Modellmatrix auch mathematisch schreiben und die $y$ Spalte für das Outcome <span class="in">`svl`</span> ergänzen. Eben so ergänzen wir die $\beta$-Werte als mögliche Koeefizienten aus der linearen Regression sowie die Residuen als Abweichung von der gefitteten Gerade.</span>
<span id="cb76-520"><a href="#cb76-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-521"><a href="#cb76-521" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-522"><a href="#cb76-522" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb76-523"><a href="#cb76-523" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb76-524"><a href="#cb76-524" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb76-525"><a href="#cb76-525" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb76-526"><a href="#cb76-526" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb76-527"><a href="#cb76-527" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb76-528"><a href="#cb76-528" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb76-529"><a href="#cb76-529" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb76-530"><a href="#cb76-530" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb76-531"><a href="#cb76-531" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-532"><a href="#cb76-532" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb76-533"><a href="#cb76-533" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-534"><a href="#cb76-534" aria-hidden="true" tabindex="-1"></a>  1 &amp; 6 &amp; 0 &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb76-535"><a href="#cb76-535" aria-hidden="true" tabindex="-1"></a>  1 &amp; 8 &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb76-536"><a href="#cb76-536" aria-hidden="true" tabindex="-1"></a>  1 &amp; 5 &amp; 0 &amp; 1 &amp; 0<span class="sc">\\</span></span>
<span id="cb76-537"><a href="#cb76-537" aria-hidden="true" tabindex="-1"></a>  1 &amp; 7 &amp; 1 &amp; 1 &amp; 0<span class="sc">\\</span></span>
<span id="cb76-538"><a href="#cb76-538" aria-hidden="true" tabindex="-1"></a>  1 &amp; 9 &amp; 1 &amp; 1 &amp; 0<span class="sc">\\</span></span>
<span id="cb76-539"><a href="#cb76-539" aria-hidden="true" tabindex="-1"></a>  1 &amp; 11&amp; 1 &amp; 0 &amp; 1<span class="sc">\\</span></span>
<span id="cb76-540"><a href="#cb76-540" aria-hidden="true" tabindex="-1"></a>  1 &amp; 12&amp; 1 &amp; 0 &amp; 1<span class="sc">\\</span></span>
<span id="cb76-541"><a href="#cb76-541" aria-hidden="true" tabindex="-1"></a>  1 &amp; 10&amp; 1 &amp; 0 &amp; 1<span class="sc">\\</span></span>
<span id="cb76-542"><a href="#cb76-542" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-543"><a href="#cb76-543" aria-hidden="true" tabindex="-1"></a> \times</span>
<span id="cb76-544"><a href="#cb76-544" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-545"><a href="#cb76-545" aria-hidden="true" tabindex="-1"></a>  \beta_0 <span class="sc">\\</span></span>
<span id="cb76-546"><a href="#cb76-546" aria-hidden="true" tabindex="-1"></a>  \beta_{mass} <span class="sc">\\</span></span>
<span id="cb76-547"><a href="#cb76-547" aria-hidden="true" tabindex="-1"></a>  \beta^{region}_{nord} <span class="sc">\\</span></span>
<span id="cb76-548"><a href="#cb76-548" aria-hidden="true" tabindex="-1"></a>  \beta^{color}_{rot} <span class="sc">\\</span></span>
<span id="cb76-549"><a href="#cb76-549" aria-hidden="true" tabindex="-1"></a>  \beta^{color}_{blau} <span class="sc">\\</span></span>
<span id="cb76-550"><a href="#cb76-550" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb76-551"><a href="#cb76-551" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-552"><a href="#cb76-552" aria-hidden="true" tabindex="-1"></a>  \epsilon_1 <span class="sc">\\</span></span>
<span id="cb76-553"><a href="#cb76-553" aria-hidden="true" tabindex="-1"></a>  \epsilon_2 <span class="sc">\\</span></span>
<span id="cb76-554"><a href="#cb76-554" aria-hidden="true" tabindex="-1"></a>  \epsilon_3 <span class="sc">\\</span></span>
<span id="cb76-555"><a href="#cb76-555" aria-hidden="true" tabindex="-1"></a>  \epsilon_4 <span class="sc">\\</span></span>
<span id="cb76-556"><a href="#cb76-556" aria-hidden="true" tabindex="-1"></a>  \epsilon_5 <span class="sc">\\</span></span>
<span id="cb76-557"><a href="#cb76-557" aria-hidden="true" tabindex="-1"></a>  \epsilon_6 <span class="sc">\\</span></span>
<span id="cb76-558"><a href="#cb76-558" aria-hidden="true" tabindex="-1"></a>  \epsilon_7 <span class="sc">\\</span></span>
<span id="cb76-559"><a href="#cb76-559" aria-hidden="true" tabindex="-1"></a>  \epsilon_8 <span class="sc">\\</span></span>
<span id="cb76-560"><a href="#cb76-560" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-561"><a href="#cb76-561" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-562"><a href="#cb76-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-563"><a href="#cb76-563" aria-hidden="true" tabindex="-1"></a>Jetzt brauche wir die Koeffizienten aus dem linearen Modell, welches wir wie folgt fitten. Wir nutzen dann die Funktion <span class="in">`coef()`</span> um uns die Koeffizienten wiedergeben zu lassen.</span>
<span id="cb76-564"><a href="#cb76-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-567"><a href="#cb76-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-568"><a href="#cb76-568" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> mass <span class="sc">+</span> region <span class="sc">+</span> color, <span class="at">data =</span> snake_tbl) </span>
<span id="cb76-569"><a href="#cb76-569" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb76-570"><a href="#cb76-570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-571"><a href="#cb76-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-572"><a href="#cb76-572" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`residuals()`</span> gibt uns die Residuen der Geraden aus dem Objekt <span class="in">`fit_4`</span> wieder.</span>
<span id="cb76-573"><a href="#cb76-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-576"><a href="#cb76-576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-577"><a href="#cb76-577" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb76-578"><a href="#cb76-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-579"><a href="#cb76-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-580"><a href="#cb76-580" aria-hidden="true" tabindex="-1"></a>Wir können jetzt die Koeffizienten ergänzen mit $\beta_0 = 25$ für den Intercept. Weiter ergänzen wir die Koeffizienten für <span class="in">`mass`</span> mit $\beta_{mass}=2.5$, für Region und das Level <span class="in">`nord`</span> mit $\beta^{region}_{nord} = 5$, für die Farbe und das Level `rot` mit $\beta^{color}_{rot} = 1.5$ und für die Farbe und das Level `blau` mit $\beta^{color}_{blau} = -2.83$. Ebenfalls setzen wir Werte für die Residuen für jede der Beobachtungen in die Gleichung ein.</span>
<span id="cb76-581"><a href="#cb76-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-582"><a href="#cb76-582" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-583"><a href="#cb76-583" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb76-584"><a href="#cb76-584" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb76-585"><a href="#cb76-585" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb76-586"><a href="#cb76-586" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb76-587"><a href="#cb76-587" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb76-588"><a href="#cb76-588" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb76-589"><a href="#cb76-589" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb76-590"><a href="#cb76-590" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb76-591"><a href="#cb76-591" aria-hidden="true" tabindex="-1"></a>  59 <span class="sc">\\</span></span>
<span id="cb76-592"><a href="#cb76-592" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-593"><a href="#cb76-593" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb76-594"><a href="#cb76-594" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-595"><a href="#cb76-595" aria-hidden="true" tabindex="-1"></a>  25 &amp; \phantom{0}6 \cdot 2.5 &amp; 0 \cdot 5 &amp; 0 \cdot 1.5&amp; 0 \cdot -2.83 <span class="sc">\\</span></span>
<span id="cb76-596"><a href="#cb76-596" aria-hidden="true" tabindex="-1"></a>  25 &amp; \phantom{0}8 \cdot 2.5 &amp; 0 \cdot 5 &amp; 0 \cdot 1.5&amp; 0 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb76-597"><a href="#cb76-597" aria-hidden="true" tabindex="-1"></a>  25 &amp; \phantom{0}5 \cdot 2.5 &amp; 0 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb76-598"><a href="#cb76-598" aria-hidden="true" tabindex="-1"></a>  25 &amp; \phantom{0}7 \cdot 2.5 &amp; 1 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb76-599"><a href="#cb76-599" aria-hidden="true" tabindex="-1"></a>  25 &amp; \phantom{0}9 \cdot 2.5 &amp; 1 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb76-600"><a href="#cb76-600" aria-hidden="true" tabindex="-1"></a>  25 &amp; 11\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb76-601"><a href="#cb76-601" aria-hidden="true" tabindex="-1"></a>  25 &amp; 12\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb76-602"><a href="#cb76-602" aria-hidden="true" tabindex="-1"></a>  25 &amp; 10\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb76-603"><a href="#cb76-603" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb76-604"><a href="#cb76-604" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb76-605"><a href="#cb76-605" aria-hidden="true" tabindex="-1"></a>  \phantom{+}0.00 <span class="sc">\\</span></span>
<span id="cb76-606"><a href="#cb76-606" aria-hidden="true" tabindex="-1"></a>  \phantom{+}0.00 <span class="sc">\\</span></span>
<span id="cb76-607"><a href="#cb76-607" aria-hidden="true" tabindex="-1"></a>  \phantom{+}0.00 <span class="sc">\\</span></span>
<span id="cb76-608"><a href="#cb76-608" aria-hidden="true" tabindex="-1"></a>  +2.00 <span class="sc">\\</span></span>
<span id="cb76-609"><a href="#cb76-609" aria-hidden="true" tabindex="-1"></a>  -2.00 <span class="sc">\\</span></span>
<span id="cb76-610"><a href="#cb76-610" aria-hidden="true" tabindex="-1"></a>  +2.33 <span class="sc">\\</span></span>
<span id="cb76-611"><a href="#cb76-611" aria-hidden="true" tabindex="-1"></a>  +0.83 <span class="sc">\\</span></span>
<span id="cb76-612"><a href="#cb76-612" aria-hidden="true" tabindex="-1"></a>  -3.17 <span class="sc">\\</span></span>
<span id="cb76-613"><a href="#cb76-613" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb76-614"><a href="#cb76-614" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-615"><a href="#cb76-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-616"><a href="#cb76-616" aria-hidden="true" tabindex="-1"></a>Wir können jetzt diese gewaltige Sammlung an Matrixen einmal auflösen. Steht denn nun wirklich rechts das Gleiche wie links von der Gleichung? Wir bauen uns die Zahlen von der rechten Seite der Gleichung einmal in R nach und schauen auf das Ergebnis.</span>
<span id="cb76-617"><a href="#cb76-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-620"><a href="#cb76-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-621"><a href="#cb76-621" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">25</span> <span class="sc">+</span>  <span class="dv">6</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb76-622"><a href="#cb76-622" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">8</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb76-623"><a href="#cb76-623" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">5</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb76-624"><a href="#cb76-624" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">7</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">2.00</span>,</span>
<span id="cb76-625"><a href="#cb76-625" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">9</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">-</span> <span class="fl">2.00</span>,</span>
<span id="cb76-626"><a href="#cb76-626" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span> <span class="dv">11</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">2.33</span>,</span>
<span id="cb76-627"><a href="#cb76-627" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.83</span>,</span>
<span id="cb76-628"><a href="#cb76-628" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">-</span> <span class="fl">3.17</span>) </span>
<span id="cb76-629"><a href="#cb76-629" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-630"><a href="#cb76-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-631"><a href="#cb76-631" aria-hidden="true" tabindex="-1"></a>Die Zahlen, die wir rauskriegen, sind die gleichen Werte die unser Outcome $y$ hat. Was haben wir gelernt?</span>
<span id="cb76-632"><a href="#cb76-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-633"><a href="#cb76-633" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In einem Modell gibt es immer ein Faktorlevel weniger als ein Faktor Level hat. Die Information des *alphanumerisch* ersten Levels steckt dann mit in dem Intercept.</span>
<span id="cb76-634"><a href="#cb76-634" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In einem Modell geht eine kontinuierliche Variable als eine Spalte mit ein.</span>
<span id="cb76-635"><a href="#cb76-635" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In einem Modell gibt es immer nur eine Spalte für die Residuen und damit nur eine Residue für jede Beobachtung, egal wie viele Variablen ein Modell hat.</span>
<span id="cb76-636"><a href="#cb76-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-637"><a href="#cb76-637" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpretation von $x$ {#sec-interpret-x}</span></span>
<span id="cb76-638"><a href="#cb76-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-639"><a href="#cb76-639" aria-hidden="true" tabindex="-1"></a>Wi interpretiee wir nun das Ergebnis einer linearen Regression? Zum einen nutzen wir häufig das Modell nur um das Modell dann weiter in einem multiplen Vergleich zu nutzen. Hier wollen wir uns jetzt aber wirklich die Koeffizienten aus einer multiplen linearen Regression anschauen udn diese Zahlen einmal interpretieren. Wichtig ist, dass wir ein normalverteiltes $y$ vorliegen haben und uns verschiedene Formen des $x$ anschauen. Wir betrachten ein kontinuierliches $x$, ein kategorielles $x$ mit zwei Leveln und ein kategorielles $x$ mit drei oder mehr Leveln.</span>
<span id="cb76-640"><a href="#cb76-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-641"><a href="#cb76-641" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kontinuierliches $x$ {#sec-interpret-x-cont}</span></span>
<span id="cb76-642"><a href="#cb76-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-643"><a href="#cb76-643" aria-hidden="true" tabindex="-1"></a>Bauen wir uns also einmal einen Datensatz mit einem kontinuierlichen $x$ und einem normalverteilten $y$. Unser $x$ soll von 1 bis 7 laufen. Wir erschaffen uns das $y$ indem wir das $x$ mit 1.5 multiplizieren, den $y$-Achsenabschnitt von 5 addieren und einen zufälligen Fehler aus einer Normalverteilung mit $\mathcal{N}(0, 1)$ aufaddieren. Wir haben also eine klassische Regressionsgleichung mit $y = 5 + 1.5 \cdot x$.</span>
<span id="cb76-644"><a href="#cb76-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-647"><a href="#cb76-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-648"><a href="#cb76-648" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20137937</span>)</span>
<span id="cb76-649"><a href="#cb76-649" aria-hidden="true" tabindex="-1"></a>cont_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">7</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb76-650"><a href="#cb76-650" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb76-651"><a href="#cb76-651" aria-hidden="true" tabindex="-1"></a>cont_tbl</span>
<span id="cb76-652"><a href="#cb76-652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-653"><a href="#cb76-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-654"><a href="#cb76-654" aria-hidden="true" tabindex="-1"></a>Wenn wir keinen Fehler addieren würden, dann hätten wir auch eine Linie von Punkten wie an einer Perlschnur aufgereiht. Dann wäre das $R^2 = 1$ und wir hätten keine Varianz in den Daten. Das ist aber in einem biologischen Setting nicht realistisch, dass unser $y$ vollständig von $x$ erklärt wird.</span>
<span id="cb76-655"><a href="#cb76-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-656"><a href="#cb76-656" aria-hidden="true" tabindex="-1"></a>Schauen wir uns nochmal die Modellmatrix an. Hier erwartet uns aber keine Überraschung. Wir schätzen den Intercept und dann kommt der Wert für jedes $x$ in der zweiten Spalte.</span>
<span id="cb76-657"><a href="#cb76-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-660"><a href="#cb76-660" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-661"><a href="#cb76-661" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(y <span class="sc">~</span> x, <span class="at">data =</span> cont_tbl)</span>
<span id="cb76-662"><a href="#cb76-662" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-663"><a href="#cb76-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-664"><a href="#cb76-664" aria-hidden="true" tabindex="-1"></a>Im Folgenden schätzen wir jetzt das lineare Modell um die Koeffizienten der Geraden zu erhalten. Wir nutzen die Funktion <span class="in">`model_parameter()`</span> aus dem R Paket <span class="in">`{parameters}`</span> für die Ausgabe der Koeffizienten.</span>
<span id="cb76-665"><a href="#cb76-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-668"><a href="#cb76-668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-669"><a href="#cb76-669" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> cont_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb76-670"><a href="#cb76-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb76-671"><a href="#cb76-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Parameter, Coefficient)</span>
<span id="cb76-672"><a href="#cb76-672" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-673"><a href="#cb76-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-674"><a href="#cb76-674" aria-hidden="true" tabindex="-1"></a>Wir erhalten einen Intercept von $4.32$ und eine Steigung von $x$ mit $1.71$. Wichtig nochmal, wir haben uns hier zufällige Zahlen erstellen lassen. Wenn du oben den Fehler rausnimmst, dann erhälst du auch die exakten Zahlen für den Intercept und die Steigung von $x$ wieder. Wir sehen also, wenn wir ein kontinuierliches $x$ haben, dann können wir das $x$ in dem Sinne einr Steigung interpretieren. Steigt das $x$ um 1 Einheit an, so erhöht sich das $y$ um den Wert der Steigung von $x$.</span>
<span id="cb76-675"><a href="#cb76-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-676"><a href="#cb76-676" aria-hidden="true" tabindex="-1"></a>In @fig-stat-modeling-basic-00 sehen wir den Zusammenhang nochmal graphisch dargestellt. Wir sehen, dass wir die voreingestellten Parameter von $\beta_0 = 5$ und $\beta_1 = 1.5$ fast treffen.</span>
<span id="cb76-677"><a href="#cb76-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-680"><a href="#cb76-680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-681"><a href="#cb76-681" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-682"><a href="#cb76-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb76-683"><a href="#cb76-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb76-684"><a href="#cb76-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb76-685"><a href="#cb76-685" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb76-686"><a href="#cb76-686" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb76-687"><a href="#cb76-687" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Graphische Darstellung der Interpretation von einem kontinuierlichen $x$. </span></span>
<span id="cb76-688"><a href="#cb76-688" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-stat-modeling-basic-00</span></span>
<span id="cb76-689"><a href="#cb76-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-690"><a href="#cb76-690" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cont_tbl, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb76-691"><a href="#cb76-691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb76-692"><a href="#cb76-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb76-693"><a href="#cb76-693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb76-694"><a href="#cb76-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>), <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb76-695"><a href="#cb76-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">17</span>), <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb76-696"><a href="#cb76-696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="dv">9</span>, <span class="at">label =</span> <span class="st">"y ==  4.32 + 1.71 %.% x"</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb76-697"><a href="#cb76-697" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb76-698"><a href="#cb76-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-699"><a href="#cb76-699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-700"><a href="#cb76-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-701"><a href="#cb76-701" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kategorielles $x$ mit 2 Leveln {#sec-interpret-x-cat2}</span></span>
<span id="cb76-702"><a href="#cb76-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-703"><a href="#cb76-703" aria-hidden="true" tabindex="-1"></a>Etwas anders wird der Fall wenn wir ein kategorielles $x$ mit 2 Leveln vorliegen haben. Wir bauen faktisch zwei Punktetürme an zwei $x$ Positionen auf. Dennoch können wir durch diese Punkte eine Gerade zeichnen. Bauen wir uns erst die Daten mit der Funktion <span class="in">`rnorm()`</span>. Wir haben zwei Gruppen vorliegen, die Gruppe A hat sieben Beobachtungen und einen Mittelwert von 10. Die Gruppe B hat ebenfalls sieben Beobchatungen und einen Mittelwert von 15. Der Effekt zwischen den beiden Gruppen A und B ist die Mittelwertsdifferenz $\Delta_{A-B}$ ist somit 5. Wir erhlalten dann folgenden Datensatz wobei die Werte der Gruppe A um die 10 streuen und die Werte der Gruppe B um die 15 streuen.</span>
<span id="cb76-704"><a href="#cb76-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-707"><a href="#cb76-707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-708"><a href="#cb76-708" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20339537</span>)</span>
<span id="cb76-709"><a href="#cb76-709" aria-hidden="true" tabindex="-1"></a>cat_two_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">A =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb76-710"><a href="#cb76-710" aria-hidden="true" tabindex="-1"></a>                      <span class="at">B =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb76-711"><a href="#cb76-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> x, <span class="at">value =</span> y) <span class="sc">|&gt;</span> </span>
<span id="cb76-712"><a href="#cb76-712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">as_factor</span>(x))</span>
<span id="cb76-713"><a href="#cb76-713" aria-hidden="true" tabindex="-1"></a>cat_two_tbl</span>
<span id="cb76-714"><a href="#cb76-714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-715"><a href="#cb76-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-716"><a href="#cb76-716" aria-hidden="true" tabindex="-1"></a>Wir wollen uns wieder die Modellmatrix einmal anschauen. Wir sehen hier schon einen Unterschied. Zum einen sehen wir, dass der Intercept für alle Beobachtungen geschätzt wird und in der zweiten Spalte nur <span class="in">`xB`</span> steht. Somit werden in der zweiten Spalte nur die Beobachtungen in der Gruppe B berücksichtigt.</span>
<span id="cb76-717"><a href="#cb76-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-720"><a href="#cb76-720" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-721"><a href="#cb76-721" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(y <span class="sc">~</span> x, <span class="at">data =</span> cat_two_tbl)</span>
<span id="cb76-722"><a href="#cb76-722" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-723"><a href="#cb76-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-724"><a href="#cb76-724" aria-hidden="true" tabindex="-1"></a>Wir rechnen einmal das lineare Modell und lassen uns überraschen was als Ergebnis herauskommt. Wir nutzen die Funktion <span class="in">`model_parameter()`</span> aus dem R Paket <span class="in">`{parameters}`</span> für die Ausgabe der Koeffizienten.</span>
<span id="cb76-725"><a href="#cb76-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-728"><a href="#cb76-728" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-729"><a href="#cb76-729" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> cat_two_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb76-730"><a href="#cb76-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb76-731"><a href="#cb76-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Parameter, Coefficient)</span>
<span id="cb76-732"><a href="#cb76-732" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-733"><a href="#cb76-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-734"><a href="#cb76-734" aria-hidden="true" tabindex="-1"></a>Nun erhalten wir als den Intercept 10.07 und die Steigung <span class="in">`xB`</span> mit 5.27 zurück. Wir sehen, der Intercept ist der Mittelwert der Gruppe A und die das <span class="in">`xB`</span> ist die Änderung von dem Mittelwert A zu dem Mittelwert B. Wir erhalten die Mittelwertsdifferenz $\Delta_{A-B}$ von 5.27 zurück. In @tbl-cat-2 siehst du den Zusammenhang von den Faktorleveln A und B, den jeweiligen Mittelwerte der Level sowie die Differenz zum Mittel von dem ersten Level A.</span>
<span id="cb76-735"><a href="#cb76-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-738"><a href="#cb76-738" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-739"><a href="#cb76-739" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-740"><a href="#cb76-740" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb76-741"><a href="#cb76-741" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb76-742"><a href="#cb76-742" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Zusammenhang von den Mittelwerten der Level des Faktores $x$ und deren Differenz zu Level A.</span></span>
<span id="cb76-743"><a href="#cb76-743" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-cat-2</span></span>
<span id="cb76-744"><a href="#cb76-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-745"><a href="#cb76-745" aria-hidden="true" tabindex="-1"></a>cat_two_tbl <span class="sc">|&gt;</span> </span>
<span id="cb76-746"><a href="#cb76-746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(x) <span class="sc">|&gt;</span> </span>
<span id="cb76-747"><a href="#cb76-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(y)) <span class="sc">|&gt;</span> </span>
<span id="cb76-748"><a href="#cb76-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">diff</span>(mean)),</span>
<span id="cb76-749"><a href="#cb76-749" aria-hidden="true" tabindex="-1"></a>         <span class="at">sum =</span> <span class="fu">cumsum</span>(diff)) <span class="sc">|&gt;</span> </span>
<span id="cb76-750"><a href="#cb76-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb76-751"><a href="#cb76-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(x, mean, sum) <span class="sc">|&gt;</span> </span>
<span id="cb76-752"><a href="#cb76-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"Factor x"</span>, <span class="st">"Mean of level"</span>, <span class="st">"Difference to level A"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb76-753"><a href="#cb76-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb76-754"><a href="#cb76-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-755"><a href="#cb76-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-756"><a href="#cb76-756" aria-hidden="true" tabindex="-1"></a>In @fig-stat-modeling-basic-01 kannst du nochmal den visuellen Zusammenhang zwischen den einzelnen Beobachtungen und der sich ergebenen Geraden sehen. Die Gerade geht durch die beiden Mittelwerte der Gruppe A und B. Daher ist die Steigung der Mittlwertsunterschied zwischen der Gruppe A und der Gruppe B. Steigt das $x$ um 1 Einheit an, also springt von Gruppe A zu Gruppe B, so erhöht sich das $y$ um den Mittelwertsunterschied $\Delta_{A-B}$.</span>
<span id="cb76-757"><a href="#cb76-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-760"><a href="#cb76-760" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-761"><a href="#cb76-761" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-762"><a href="#cb76-762" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb76-763"><a href="#cb76-763" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb76-764"><a href="#cb76-764" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb76-765"><a href="#cb76-765" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb76-766"><a href="#cb76-766" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb76-767"><a href="#cb76-767" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Graphische Darstellung der Interpretation von einem kategoriellen $x$ mit 2 Leveln.</span></span>
<span id="cb76-768"><a href="#cb76-768" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-stat-modeling-basic-01</span></span>
<span id="cb76-769"><a href="#cb76-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-770"><a href="#cb76-770" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cat_two_tbl, <span class="fu">aes</span>(x, y, <span class="at">fill =</span> x)) <span class="sc">+</span></span>
<span id="cb76-771"><a href="#cb76-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb76-772"><a href="#cb76-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">10.01</span>, <span class="fl">10.01</span> <span class="sc">+</span> <span class="fl">5.27</span>), </span>
<span id="cb76-773"><a href="#cb76-773" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> cbbPalette[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)], <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb76-774"><a href="#cb76-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>) <span class="sc">+</span></span>
<span id="cb76-775"><a href="#cb76-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb76-776"><a href="#cb76-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb76-777"><a href="#cb76-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="fl">10.01</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="fl">15.27</span>, <span class="dv">16</span>, <span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb76-778"><a href="#cb76-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">10.01</span>, <span class="at">xend =</span> <span class="dv">2</span>, <span class="at">yend =</span> <span class="fl">10.01+5.27</span>)) <span class="sc">+</span></span>
<span id="cb76-779"><a href="#cb76-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">15.7</span>, <span class="at">label =</span> <span class="st">"bar(y)[B] == 10.01 + 5.27"</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb76-780"><a href="#cb76-780" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb76-781"><a href="#cb76-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-782"><a href="#cb76-782" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-783"><a href="#cb76-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-784"><a href="#cb76-784" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kategorielles $x$ mit \&gt;2 Leveln {#sec-interpret-x-cat3}</span></span>
<span id="cb76-785"><a href="#cb76-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-786"><a href="#cb76-786" aria-hidden="true" tabindex="-1"></a>Nachdem wir das Problem der Interpretation von einem kategoriellen $x$ mit zwei Leveln verstanden haben, werden wir uns jetzt den Fall für ein kategoriellen $x$ mit drei oder mehr Leveln anschauen. Wir nutzen hier nur drei Level, da es für vier oder fünf Level gleich abläuft. Du kannst das Datenbeispiel gerne auch noch um eine vierte Gruppe erweitern und schauen was sich da ändert.</span>
<span id="cb76-787"><a href="#cb76-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-788"><a href="#cb76-788" aria-hidden="true" tabindex="-1"></a>Unser Datensatz besteht aus drei Gruppen A, B und C mit den Mittelwerten von 10, 15 und 3. Hierbei ist wichtig, dass wir in der Gruppe C nur einen Mittelwert von 3 haben. Also wir haben *keinen* linearen Anstieg über die drei Gruppen.</span>
<span id="cb76-789"><a href="#cb76-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-792"><a href="#cb76-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-793"><a href="#cb76-793" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20339537</span>)</span>
<span id="cb76-794"><a href="#cb76-794" aria-hidden="true" tabindex="-1"></a>cat_three_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">A =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb76-795"><a href="#cb76-795" aria-hidden="true" tabindex="-1"></a>                        <span class="at">B =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb76-796"><a href="#cb76-796" aria-hidden="true" tabindex="-1"></a>                        <span class="at">C =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">7</span>, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb76-797"><a href="#cb76-797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> x, <span class="at">value =</span> y) <span class="sc">|&gt;</span> </span>
<span id="cb76-798"><a href="#cb76-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">as_factor</span>(x))</span>
<span id="cb76-799"><a href="#cb76-799" aria-hidden="true" tabindex="-1"></a>cat_three_tbl</span>
<span id="cb76-800"><a href="#cb76-800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-801"><a href="#cb76-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-802"><a href="#cb76-802" aria-hidden="true" tabindex="-1"></a>Schauen wir uns einmal die Modellmatrix an. Wir sehen wieder, dass der Intercept über alle Gruppen geschätzt wird und wir Koeffizienten für die Gruppen B und C erhalten. Mit der Modellmatrix wird dann auch das lineare Modell geschätzt.</span>
<span id="cb76-803"><a href="#cb76-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-806"><a href="#cb76-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-807"><a href="#cb76-807" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(y <span class="sc">~</span> x, <span class="at">data =</span> cat_three_tbl)</span>
<span id="cb76-808"><a href="#cb76-808" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-809"><a href="#cb76-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-810"><a href="#cb76-810" aria-hidden="true" tabindex="-1"></a>Wir rechnen wieder das Modell mit der Funktion <span class="in">`lm()`</span>. Wir nutzen die Funktion <span class="in">`model_parameter()`</span> aus dem R Paket <span class="in">`{parameters}`</span> für die Ausgabe der Koeffizienten zu erhalten.</span>
<span id="cb76-811"><a href="#cb76-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-814"><a href="#cb76-814" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-815"><a href="#cb76-815" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> cat_three_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb76-816"><a href="#cb76-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb76-817"><a href="#cb76-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Parameter, Coefficient)</span>
<span id="cb76-818"><a href="#cb76-818" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-819"><a href="#cb76-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-820"><a href="#cb76-820" aria-hidden="true" tabindex="-1"></a>Wir sehen wieder, dass der Intercept der Mittelwert der Gruppe A ist. Wir hatten einen Mittelwert von 10 für die Gruppe A eingestellt und wir erhalten diesen Wert wieder. Die anderen Koeffizienten sind die Änderung zum Mittelwert von der Gruppe A. In @tbl-cat-3 ist der Zusammenhang nochmal für alle Level des Faktors $x$ dargestellt. Wir haben für die Gruppe B einen Mittelwert von 15 und für die Gruppe C einen Mittelwert von 3 eingestellt. Wir erhalten diese Mittelwerte wieder, wenn wir die Differenzen zu dem Intercept bilden.</span>
<span id="cb76-821"><a href="#cb76-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-824"><a href="#cb76-824" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-825"><a href="#cb76-825" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-826"><a href="#cb76-826" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb76-827"><a href="#cb76-827" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Zusammenhang von den Mittelwerten der Level des Faktores $x$ und deren Differenz zu Level A.</span></span>
<span id="cb76-828"><a href="#cb76-828" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-cat-3</span></span>
<span id="cb76-829"><a href="#cb76-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-830"><a href="#cb76-830" aria-hidden="true" tabindex="-1"></a>cat_three_tbl <span class="sc">|&gt;</span> </span>
<span id="cb76-831"><a href="#cb76-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(x) <span class="sc">|&gt;</span> </span>
<span id="cb76-832"><a href="#cb76-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(y)) <span class="sc">|&gt;</span> </span>
<span id="cb76-833"><a href="#cb76-833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">diff</span>(mean)),</span>
<span id="cb76-834"><a href="#cb76-834" aria-hidden="true" tabindex="-1"></a>         <span class="at">sum =</span> <span class="fu">cumsum</span>(diff)) <span class="sc">|&gt;</span> </span>
<span id="cb76-835"><a href="#cb76-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb76-836"><a href="#cb76-836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(x, mean, sum) <span class="sc">|&gt;</span> </span>
<span id="cb76-837"><a href="#cb76-837" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"Factor x"</span>, <span class="st">"Mean of level"</span>, <span class="st">"Difference to level A"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb76-838"><a href="#cb76-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb76-839"><a href="#cb76-839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-840"><a href="#cb76-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-841"><a href="#cb76-841" aria-hidden="true" tabindex="-1"></a>Wir sehen den Zusammenhang nochmal in der @fig-stat-modeling-basic-02 visualisiert. Wir sehen die Änderung on der Gruppe A zu der Gruppe B sowie die Änderung von der Gruppe A zu der Gruppe C. Die Abbildung ist etwas *verwirrend* da wir *nicht* das $x$ um 2 Einheiten erhöhen um auf den Mittelwert von C zu kommen. Wir rechnen sozusagen ausgehend von A die Änderung zu B und C aus. Dabei nehmen wir jedesmal an, dass die Gruppe B und die Gruppe C nur eine Einheit von $x$ von A entfernt ist.</span>
<span id="cb76-842"><a href="#cb76-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-845"><a href="#cb76-845" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-846"><a href="#cb76-846" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-847"><a href="#cb76-847" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb76-848"><a href="#cb76-848" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb76-849"><a href="#cb76-849" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb76-850"><a href="#cb76-850" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb76-851"><a href="#cb76-851" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Graphische Darstellung der Interpretation von einem kategoriellen $x$ mit 3 Leveln.</span></span>
<span id="cb76-852"><a href="#cb76-852" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-stat-modeling-basic-02</span></span>
<span id="cb76-853"><a href="#cb76-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-854"><a href="#cb76-854" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cat_three_tbl, <span class="fu">aes</span>(x, y, <span class="at">color =</span> x)) <span class="sc">+</span></span>
<span id="cb76-855"><a href="#cb76-855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb76-856"><a href="#cb76-856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb76-857"><a href="#cb76-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">10.1</span>, <span class="fl">10.1</span> <span class="sc">+</span> <span class="fl">5.27</span>, <span class="fl">10.1</span> <span class="sc">-</span> <span class="fl">7.41</span>), </span>
<span id="cb76-858"><a href="#cb76-858" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> cbbPalette[<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb76-859"><a href="#cb76-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb76-860"><a href="#cb76-860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb76-861"><a href="#cb76-861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">10.1</span> <span class="sc">-</span> <span class="fl">7.41</span>, <span class="dv">5</span>, <span class="fl">10.1</span>, <span class="fl">10.1</span> <span class="sc">+</span> <span class="fl">5.27</span>), </span>
<span id="cb76-862"><a href="#cb76-862" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb76-863"><a href="#cb76-863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">10.1</span>, <span class="at">xend =</span> <span class="dv">2</span>, <span class="at">yend =</span> <span class="fl">10.1+5.27</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb76-864"><a href="#cb76-864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">10.1</span>, <span class="at">xend =</span> <span class="dv">3</span>, <span class="at">yend =</span> <span class="fl">10.1-7.41</span>), <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb76-865"><a href="#cb76-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">2.1</span>, <span class="at">y =</span> <span class="dv">14</span>, <span class="at">label =</span> <span class="st">"bar(y)[B] == 10.1 + 5.27"</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb76-866"><a href="#cb76-866" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb76-867"><a href="#cb76-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="dv">2</span>, <span class="at">label =</span> <span class="st">"bar(y)[C] == 10.1 - 7.41"</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb76-868"><a href="#cb76-868" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb76-869"><a href="#cb76-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-870"><a href="#cb76-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-871"><a href="#cb76-871" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-872"><a href="#cb76-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-873"><a href="#cb76-873" aria-hidden="true" tabindex="-1"></a><span class="fu">## Adjustierung für Confounder {#sec-confounder}</span></span>
<span id="cb76-874"><a href="#cb76-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-875"><a href="#cb76-875" aria-hidden="true" tabindex="-1"></a>Im folgenden Abschnitt wollen wir einmal auf Confounder eingehen. Was sind Confounder? Zum einen gibt es kein gutes deutsches Wort für Confounder. Du könntest Confounder in etwa mit *Verzerrer* oder *Störfakor* übersetzen. Zum Anderen können Confounder nur zuammen mit anderen Vriabln in einer multiplen Regression auftreten. Das heißt, wir brauchen mindestens zwei Variablen in einer Regression. Ein Confounder verursacht einen Effekt, den wir eigentlich nicht so erwartet hätten. Wir wollen eigentlich einen Effekt schätzen, aber der Effekt ist viel größer oder kleiner, da der Effekt eigentlich von einder anderen Variable verursacht oder aber verdeckt wird. Wir können einen Confounder in beide Richtungen haben. Wichtig ist hierbei, das wir eigentlich *nicht* an dem Effekt des Confounders interessiert sind. Wir wollen uns zum Beispiel den Effekt einer Düngung auf das Trockengewicht anschauen, aber der Effekt den wir beobachten wird durch die unterschiedlichen Pflanzorte verursacht.</span>
<span id="cb76-876"><a href="#cb76-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-877"><a href="#cb76-877" aria-hidden="true" tabindex="-1"></a>Schauen wir uns das ganze mal für das Beispiel des Zusammenhangs von dem Flohgewicht mit der Sprungweite an. Dafür benötigen wir den Datensatz <span class="in">`flea_dog_cat_length_weight.csv`</span>.</span>
<span id="cb76-878"><a href="#cb76-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-881"><a href="#cb76-881" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-882"><a href="#cb76-882" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-883"><a href="#cb76-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-884"><a href="#cb76-884" aria-hidden="true" tabindex="-1"></a>model_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/flea_dog_cat_length_weight.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb76-885"><a href="#cb76-885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(animal, sex, weight, jump_length) <span class="sc">|&gt;</span> </span>
<span id="cb76-886"><a href="#cb76-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal),</span>
<span id="cb76-887"><a href="#cb76-887" aria-hidden="true" tabindex="-1"></a>         <span class="at">sex =</span> <span class="fu">as_factor</span>(sex))</span>
<span id="cb76-888"><a href="#cb76-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-889"><a href="#cb76-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-890"><a href="#cb76-890" aria-hidden="true" tabindex="-1"></a>In der @tbl-model-confounder ist der Datensatz <span class="in">`model_tbl`</span> nochmal dargestellt.</span>
<span id="cb76-891"><a href="#cb76-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-894"><a href="#cb76-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-895"><a href="#cb76-895" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-896"><a href="#cb76-896" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb76-897"><a href="#cb76-897" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Datensatz für die Confounder Adjustierung. Die Variable `jump_length` ist das $y$ und die Variable `weight` das $x$ von Interesse.</span></span>
<span id="cb76-898"><a href="#cb76-898" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-model-confounder</span></span>
<span id="cb76-899"><a href="#cb76-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-900"><a href="#cb76-900" aria-hidden="true" tabindex="-1"></a>model_raw_tbl <span class="ot">&lt;-</span> model_tbl <span class="sc">|&gt;</span> </span>
<span id="cb76-901"><a href="#cb76-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as.character</span>(animal),</span>
<span id="cb76-902"><a href="#cb76-902" aria-hidden="true" tabindex="-1"></a>         <span class="at">sex =</span> <span class="fu">as.character</span>(sex))</span>
<span id="cb76-903"><a href="#cb76-903" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(model_raw_tbl),</span>
<span id="cb76-904"><a href="#cb76-904" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(model_raw_tbl)),</span>
<span id="cb76-905"><a href="#cb76-905" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(model_raw_tbl)) <span class="sc">|&gt;</span> </span>
<span id="cb76-906"><a href="#cb76-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb76-907"><a href="#cb76-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-908"><a href="#cb76-908" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-909"><a href="#cb76-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-910"><a href="#cb76-910" aria-hidden="true" tabindex="-1"></a>Wir können uns jetzt drei verschiedene Modelle anschauen.</span>
<span id="cb76-911"><a href="#cb76-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-912"><a href="#cb76-912" aria-hidden="true" tabindex="-1"></a>1)  Das Modell <span class="in">`jump_length ~ weight`</span>. Wir modellieren die Abhängigkeit von der Sprungweite von dem Gewicht der Flöhe *über alle* anderen Variablen hinweg.</span>
<span id="cb76-913"><a href="#cb76-913" aria-hidden="true" tabindex="-1"></a>2)  Das Modell <span class="in">`jump_length ~ weight + animal`</span>. Wir modellieren die Abhängigkeit von der Sprungweite von dem Gewicht der Flöhe und berücksichtigen die Tierart des Flohes. Ignorieren aber das Geschlecht des Flohes.</span>
<span id="cb76-914"><a href="#cb76-914" aria-hidden="true" tabindex="-1"></a>3)  Das Modell <span class="in">`jump_length ~ weight + animal + sex`</span>. Wir modellieren die Abhängigkeit von der Sprungweite von dem Gewicht der Flöhe und berücksichtigen *alle* Variablen, die wir gemessen haben.</span>
<span id="cb76-915"><a href="#cb76-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-916"><a href="#cb76-916" aria-hidden="true" tabindex="-1"></a>Hierbei ist wichtig, dass es natürlich auch Confounder geben kann, die wir gar nicht in den Daten erhoben haben. Also, dass sich Gruppen finden lassen, die wir gar nicht als Variable mit in den Daten erfasst haben. Hier könnte eine Hauptkomponentenanalyse helfen.</span>
<span id="cb76-917"><a href="#cb76-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-920"><a href="#cb76-920" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-921"><a href="#cb76-921" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-922"><a href="#cb76-922" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb76-923"><a href="#cb76-923" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb76-924"><a href="#cb76-924" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb76-925"><a href="#cb76-925" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb76-926"><a href="#cb76-926" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-stat-modeling-mult-01</span></span>
<span id="cb76-927"><a href="#cb76-927" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung des *counfounder* Effekts anhand des Zusammenhangs der Sprungweite in [cm] und dem Gewicht von Flöhen [mg]."</span></span>
<span id="cb76-928"><a href="#cb76-928" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb76-929"><a href="#cb76-929" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "jump_length ~ weight"</span></span>
<span id="cb76-930"><a href="#cb76-930" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "jump_length ~ weight + animal"</span></span>
<span id="cb76-931"><a href="#cb76-931" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "jump_length ~ weight + animal + sex"</span></span>
<span id="cb76-932"><a href="#cb76-932" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-nrow: 1</span></span>
<span id="cb76-933"><a href="#cb76-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-934"><a href="#cb76-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-935"><a href="#cb76-935" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(model_tbl, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb76-936"><a href="#cb76-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb76-937"><a href="#cb76-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb76-938"><a href="#cb76-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb76-939"><a href="#cb76-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-940"><a href="#cb76-940" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(model_tbl, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal)) <span class="sc">+</span></span>
<span id="cb76-941"><a href="#cb76-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb76-942"><a href="#cb76-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb76-943"><a href="#cb76-943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb76-944"><a href="#cb76-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb76-945"><a href="#cb76-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color  =</span> <span class="st">"Tierart"</span>)</span>
<span id="cb76-946"><a href="#cb76-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-947"><a href="#cb76-947" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(model_tbl, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> jump_length, <span class="at">color =</span> animal, <span class="at">shape =</span> sex)) <span class="sc">+</span></span>
<span id="cb76-948"><a href="#cb76-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb76-949"><a href="#cb76-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb76-950"><a href="#cb76-950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb76-951"><a href="#cb76-951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb76-952"><a href="#cb76-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color  =</span> <span class="st">"Tierart"</span>, <span class="at">shape =</span> <span class="st">"Geschlecht"</span>)</span>
<span id="cb76-953"><a href="#cb76-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-954"><a href="#cb76-954" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-955"><a href="#cb76-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-956"><a href="#cb76-956" aria-hidden="true" tabindex="-1"></a>In @fig-stat-modeling-mult-01-1 sehen wir die blaue Linie als die Ausgabe von dem Modell <span class="in">`jump_length ~ weight`</span>. Wir sehen, dass mit dem Anstieg des Gewichtes der Flöhe auch die Sprungweite sich erhöht. Wir würden annehmen, dass wir hier einen signifikanten Unterschied vorliegen haben. Schauen wir uns die Koeffizienten des Modells aus dem <span class="in">`lm()`</span> einmal an.</span>
<span id="cb76-957"><a href="#cb76-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-960"><a href="#cb76-960" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-961"><a href="#cb76-961" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-962"><a href="#cb76-962" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb76-963"><a href="#cb76-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-964"><a href="#cb76-964" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> weight, <span class="at">data =</span> model_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb76-965"><a href="#cb76-965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span>
<span id="cb76-966"><a href="#cb76-966" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-967"><a href="#cb76-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-968"><a href="#cb76-968" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass wir einen Effekt des Gewichts auf die Sprungweite von $1.34$ vorliegen haben. Auch ist der Effekt und damit die Steigung signifikant.</span>
<span id="cb76-969"><a href="#cb76-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-970"><a href="#cb76-970" aria-hidden="true" tabindex="-1"></a>Erweitern wir nun das Modell um die Tierart und erhalten die @fig-stat-modeling-mult-01-2. Zum einen sehen wir, dass der globale Effekt nicht so ganz stimmen kann. Die Tierarten haben alle einen unterschiedlichen starken Effekt von dem Gewicht auf die Sprungweite. Auch hier fitten wir einmal das lineare Modell und schauen uns die Koeffizienten an.</span>
<span id="cb76-971"><a href="#cb76-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-974"><a href="#cb76-974" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-975"><a href="#cb76-975" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-976"><a href="#cb76-976" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb76-977"><a href="#cb76-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-978"><a href="#cb76-978" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> weight <span class="sc">+</span> animal, <span class="at">data =</span> model_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb76-979"><a href="#cb76-979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>()</span>
<span id="cb76-980"><a href="#cb76-980" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-981"><a href="#cb76-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-982"><a href="#cb76-982" aria-hidden="true" tabindex="-1"></a>Der Effekt des Gewichtes ist hier in etwa gleich geblieben. Wir sehen aber auch, dass die Sprungweite anscheinend bei Hunden und Füchsen höher ist. Daher haben wir hier einen Effekt on der Tierart. Wir adjustieren für den Confoundereffekt durch die Tierart und erhalten einen besseren Effektschätzer für das Gewicht.</span>
<span id="cb76-983"><a href="#cb76-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-984"><a href="#cb76-984" aria-hidden="true" tabindex="-1"></a>In der letzten @fig-stat-modeling-mult-01-3 wollen wir nochmal das Geschlecht der Flöhe mit in das Modell nehmen. Wir sehen, dass in diesem Fall, das Gewicht gar keinen Einfluss mehr auf die Sprungweite hat. Den Effekt des Gewichtes war nur der Effekt des unterschiedlichen Gewichtes der weiblichen und männlichen Flöhe. Schauen wir auch hier nochmal in des Modell.</span>
<span id="cb76-985"><a href="#cb76-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-988"><a href="#cb76-988" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-989"><a href="#cb76-989" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-990"><a href="#cb76-990" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb76-991"><a href="#cb76-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-992"><a href="#cb76-992" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> weight <span class="sc">+</span> animal <span class="sc">+</span> sex, <span class="at">data =</span> model_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb76-993"><a href="#cb76-993" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb76-994"><a href="#cb76-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Coefficient =</span> <span class="fu">round</span>(Coefficient, <span class="dv">2</span>))</span>
<span id="cb76-995"><a href="#cb76-995" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-996"><a href="#cb76-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-997"><a href="#cb76-997" aria-hidden="true" tabindex="-1"></a>Nun können wir sehen, dass von unserem ursprünglichen Effekt von dem Gewicht auf die Sprungweite nichts mehr übrigbleibt. Wir haben gar keinen Effekt von dem Gewicht auf die Sprungweite vorliegen. Was wir gesehen haben, war der Effekt des Gewichtes der unterschiedlichen Geschlechter. Wenn wir unser Modell für die Confounder <span class="in">`animal`</span> und <span class="in">`sex`</span> adjustieren, haben wir einen unverzerrten Schätzer für <span class="in">`weight`</span>. Wichtig ist nochmal, dafür müssen wir natürlich auch alle variablen erhoben haben. Hätten wir das Geschlecht der Flöhe nicht bestimt, hätten wir hier eventuell einen falschen Schluß getroffen.</span>
<span id="cb76-998"><a href="#cb76-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-999"><a href="#cb76-999" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variance inflation factor (VIF) {#sec-vif}</span></span>
<span id="cb76-1000"><a href="#cb76-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1001"><a href="#cb76-1001" aria-hidden="true" tabindex="-1"></a>Wenn wir sehr viele Daten erheben, dann kann es sein, dass die Variablen stark miteinander korrelieren. Wir können aber stark mieinander korrelierte Variablen nicht zusammen in ein Modell nehmen. Die Effekte der beiden Variablen würden sich gegenseitig aufheben. Wir hätten eigentlich zwei getrennt signifikante Variablen. Nehmen wir aber beide Variablen mit ins Modell, sind beide Variablen nicht mehr signifikant.</span>
<span id="cb76-1002"><a href="#cb76-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1003"><a href="#cb76-1003" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb76-1004"><a href="#cb76-1004" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb76-1005"><a href="#cb76-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1006"><a href="#cb76-1006" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Wir kürzen hier stark ab. Wenn du mehr über Variablen in einem Modell wissen willst, gibt es dann in den Kapitel zur Variablen Selektion mehr Informationen. Wenn du nur Outcomes und Blöcke vorliegen hast, dann ist das VIF für dich uninteressant.</span></span>
<span id="cb76-1007"><a href="#cb76-1007" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb76-1008"><a href="#cb76-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1009"><a href="#cb76-1009" aria-hidden="true" tabindex="-1"></a>Um Variablen zu finden, die sich sehr ähnlich verhalten, können wir den Variance inflation factor (VIF) nutzen. Wir können den VIF jedoch *nicht* für kategoriale Daten verwenden. Statistisch gesehen würde es keinen Sinn machen. Die Anwendung ist recht einfach. Wir fitten als erstes unser Modell und dann können wir die Funktion <span class="in">`vif()`</span> aus dem R Paket <span class="in">`{car}`</span> verwenden.</span>
<span id="cb76-1010"><a href="#cb76-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1013"><a href="#cb76-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-1014"><a href="#cb76-1014" aria-hidden="true" tabindex="-1"></a>gummi_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/gummibears.xlsx"</span>)</span>
<span id="cb76-1015"><a href="#cb76-1015" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(height <span class="sc">~</span> semester <span class="sc">+</span> age <span class="sc">+</span> count_color <span class="sc">+</span> count_bears, <span class="at">data =</span> gummi_tbl)</span>
<span id="cb76-1016"><a href="#cb76-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-1017"><a href="#cb76-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1018"><a href="#cb76-1018" aria-hidden="true" tabindex="-1"></a>Wir sehen im Folgenden das Eregbnis der Funktion <span class="in">`vif()`</span>. Wenn der berechnete Wert für den VIF größer als 5 ist, dann liegt mit der Variable *ein Problem* vor. Wir vermuten dann, dass eine andere variable sehr stark mit dieser Variable korreliert. Wir sehen an den Werten keine Aufälligkeiten.</span>
<span id="cb76-1019"><a href="#cb76-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1022"><a href="#cb76-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-1023"><a href="#cb76-1023" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model)</span>
<span id="cb76-1024"><a href="#cb76-1024" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-1025"><a href="#cb76-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1026"><a href="#cb76-1026" aria-hidden="true" tabindex="-1"></a>Wir können uns mit der Funcktion <span class="in">`check_model()`</span> aus dem R Paket <span class="in">`{performance}`</span> auch die Unsicherheit mit angeben lassen. In unserem Beispiel hieft dies gerade nicht sehr viel weiter. Wir bleiben bei den geschätzen Werten und ignorieren das Intervall.</span>
<span id="cb76-1027"><a href="#cb76-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1030"><a href="#cb76-1030" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-1031"><a href="#cb76-1031" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-1032"><a href="#cb76-1032" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb76-1033"><a href="#cb76-1033" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb76-1034"><a href="#cb76-1034" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb76-1035"><a href="#cb76-1035" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb76-1036"><a href="#cb76-1036" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Graphische Darstellung des VIF mit der Funktion `check_model()`.</span></span>
<span id="cb76-1037"><a href="#cb76-1037" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-stat-modeling-vif</span></span>
<span id="cb76-1038"><a href="#cb76-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1039"><a href="#cb76-1039" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(model, <span class="at">check =</span> <span class="st">"vif"</span>)</span>
<span id="cb76-1040"><a href="#cb76-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-1041"><a href="#cb76-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1042"><a href="#cb76-1042" aria-hidden="true" tabindex="-1"></a>In @fig-stat-modeling-vif sehen wir nochmal die Visualisierung. Wie immer, manchmal helfen solche Abbildungen, manchmal verwirren die Abbildungen mehr. Wir konzentrieren uns hier auf die Werte des VIF's und ignorieren die Streuung.</span>
<span id="cb76-1043"><a href="#cb76-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1044"><a href="#cb76-1044" aria-hidden="true" tabindex="-1"></a><span class="fu">## Vergleich von Modellen {#sec-model-basic-compare}</span></span>
<span id="cb76-1045"><a href="#cb76-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1046"><a href="#cb76-1046" aria-hidden="true" tabindex="-1"></a>Im Folgenden wollen wir einmal verschiedene Modelle miteinander Vergleichen und uns statistisch wiedergeben lassen, was das beste Modell ist. Und hier holen wir auch einmal kurz Luft, denn wir entschieden *nur* was das statistisch beste Modell ist. Es kann sein, dass ein Modell biologisch mehr Sinn macht und nicht auf Platz 1 der statistischen Maßzahlen steht. Das ist vollkommen in Ordnung. Du musst abweägen, was für sich das beste Modell ist. Im Zweifel komme ruhig nochmal in meine statistische Beratung oder schreibe mir eine Mail.</span>
<span id="cb76-1047"><a href="#cb76-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1048"><a href="#cb76-1048" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb76-1049"><a href="#cb76-1049" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb76-1050"><a href="#cb76-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1051"><a href="#cb76-1051" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Wir kürzen hier stark ab bzw. gehen nicht im Detail auf jedes Gütekriterium ein. Wichtig ist, dass du Modelle *statistisch* vergleichen kannst. Bedenke immmer, dass die *statistische* Bewertung nicht immer ausreicht! Auch was die Biologie über das Modell sagt ist wichtig.</span></span>
<span id="cb76-1052"><a href="#cb76-1052" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb76-1053"><a href="#cb76-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1054"><a href="#cb76-1054" aria-hidden="true" tabindex="-1"></a>Wir bauchen uns jetzt fünf Modelle von <span class="in">`fit_1`</span> bis <span class="in">`fit_5`</span>. Jedes dieser Modelle hat andere $x$ aber häufig das gleiche Outcome <span class="in">`y`</span>. In dem Beispiel am Ende des Kapitels nutzen wir auch verschiedene $y$ dafür aber dann gleiche $x$ in dem Modell. Im Weiteren sortieren wir die Modelle von einfach nach komplex. Ich versuche immmer das einfachste Modell <span class="in">`fit_1`</span> zu nennen bzw. eher die niedrige Nummer zu geben. Im Idealfall benennst du die Modellobjekte nach den Modellen, die in en Objekten gespeichert sind. Oft sind die Modelle aber sehr groß und die Objekte der Fits haben dann sehr lange Namen.</span>
<span id="cb76-1055"><a href="#cb76-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1058"><a href="#cb76-1058" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-1059"><a href="#cb76-1059" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal, <span class="at">data =</span> model_tbl)</span>
<span id="cb76-1060"><a href="#cb76-1060" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> sex, <span class="at">data =</span> model_tbl)</span>
<span id="cb76-1061"><a href="#cb76-1061" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> sex <span class="sc">+</span> weight, <span class="at">data =</span> model_tbl)</span>
<span id="cb76-1062"><a href="#cb76-1062" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> animal <span class="sc">+</span> sex <span class="sc">+</span> sex<span class="sc">:</span>weight, <span class="at">data =</span> model_tbl)</span>
<span id="cb76-1063"><a href="#cb76-1063" aria-hidden="true" tabindex="-1"></a>fit_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(jump_length) <span class="sc">~</span> animal <span class="sc">+</span> sex, <span class="at">data =</span> model_tbl)</span>
<span id="cb76-1064"><a href="#cb76-1064" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-1065"><a href="#cb76-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1066"><a href="#cb76-1066" aria-hidden="true" tabindex="-1"></a>Als Ergänzung zum Bestimmtheitsmaß $R^2$ wollen wir uns noch das *Akaike information criterion* (abk. $AIC$) anschauen. Du kannst auch das $R^2$ bzw. das $R^2_{adj}$ für die Modellauswahl nehmen. Das $AIC$ ist neuer und auch für komplexere Modelle geeignet. Es gilt hierbei, je kleiner das $AIC$ ist, desto besser ist das $AIC$. Wir wollen also Modelle haben, die ein kleines $AIC$ haben. Wir gehen jetzt nicht auf die Berechnung der $AIC$'s für jedes Modell ein. Wir erhalten nur ein $AIC$ für jedes Modell. Die einzelnen Werte des $AIC$'s sagen *nichts* aus. Ein $AIC$ ist ein mathematisches Konstrukt. Wir können aber verwandte Modelle mit dem $AIC$ untereinander vergleichen. Daher berechnen wir ein $\Delta$ über die $AIC$. Dafür nehmen wir das Modell mit dem niedrigsten $AIC$ und berechnen die jeweiligen Differenzen zu den anderen $i$ Modellen. In unserem Beispiel ist $i$ dann gleich fünf, da wir fünf Modelle haben.</span>
<span id="cb76-1067"><a href="#cb76-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1068"><a href="#cb76-1068" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-1069"><a href="#cb76-1069" aria-hidden="true" tabindex="-1"></a>\Delta_i = AIC_i - AIC_{min}</span>
<span id="cb76-1070"><a href="#cb76-1070" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-1071"><a href="#cb76-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1072"><a href="#cb76-1072" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>wenn $\Delta_i &lt; 2$, gibt es keinen Unterschied zwischen den Modellen. Das $i$-te Modell ist genauso gut wie das Modell mit dem $AIC_{min}$.</span>
<span id="cb76-1073"><a href="#cb76-1073" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>wenn $2 &lt; \Delta_i &lt; 4$, dann gibt es eine starke Unterstützung für das $i$-te Modell. Das $i$-te Modell ist immer noch ähnlich gut wie das $AIC_{min}$.</span>
<span id="cb76-1074"><a href="#cb76-1074" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>wenn $4 &lt; \Delta_i &lt; 7$, dann gibt es deutlich weniger Unterstützung für das $i$-te Modell;</span>
<span id="cb76-1075"><a href="#cb76-1075" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Modelle mit $\Delta_i &gt; 10$ sind im Vergleich zu dem *besten* $AIC$ Modell nicht zu verwenden.</span>
<span id="cb76-1076"><a href="#cb76-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1077"><a href="#cb76-1077" aria-hidden="true" tabindex="-1"></a>Nehmen wir ein $AIC_1 = AIC_{min} = 100$ und $AIC_2$ ist $100,7$ an. Dann ist $\Delta_2=0,7&lt;2$, so dass es keinen wesentlichen Unterschied zwischen den Modellen gibt. Wir können uns entscheiden, welches der beiden Modelle wir nehmen. Hier ist dann wichtig, was auch die Biologie sagt oder eben andere Kriterien, wie Kosten und Nutzen. Wenn wir ein $AIC_1 = AIC_{min} = 100000$ und $AIC_2$ ist $100700$ vorliegen haben, dann ist $\Delta_2 = 700 \gg 10$, also gibt es keinen Grund für das $2$-te Modell. Das $2$-te Modell ist substantiell schlechter als das erste Modell. Mehr dazu kannst du unter <span class="co">[</span><span class="ot">Multimodel Inference: Understanding AIC and BIC in Model Selection</span><span class="co">](https://faculty.washington.edu/skalski/classes/QERM597/papers_xtra/Burnham%20and%20Anderson.pdf)</span> nachlesen.</span>
<span id="cb76-1078"><a href="#cb76-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1079"><a href="#cb76-1079" aria-hidden="true" tabindex="-1"></a>Wir können das $\Delta_i$ auch in eine Wahrscheinlichkeit umrechnen. Wir können $p_i$ berechnen und damit die relative (im Vergleich zu $AIC_{min}$) Wahrscheinlichkeit, dass das $i$-te Modell den AIC minimiert.</span>
<span id="cb76-1080"><a href="#cb76-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1081"><a href="#cb76-1081" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-1082"><a href="#cb76-1082" aria-hidden="true" tabindex="-1"></a>p_i = \exp\left(\cfrac{-\Delta_i}{2}\right)</span>
<span id="cb76-1083"><a href="#cb76-1083" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb76-1084"><a href="#cb76-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1085"><a href="#cb76-1085" aria-hidden="true" tabindex="-1"></a>Zum Beispiel entspricht $\Delta_i = 1.5$ einem $p_i$ von $0.47$ (ziemlich hoch) und ein $\Delta_i = 15$ entspricht einem $p_i =0.0005$ (ziemlich niedrig). Im ersten Fall besteht eine Wahrscheinlichkeit von 47%, dass das $i$-te Modell tatsächlich eine bessere Beschreibung ist als das Modell, das $AIC_{min}$ ergibt, und im zweiten Fall beträgt diese Wahrscheinlichkeit nur 0,05%. Wir können so einmal nachrechnen, ob sich eine Entscheidung für ein anderes Modell lohnen würde. Neben dem $AIC$ gibt es auch das Bayesian information criterion ($BIC$). Auch beim $BIC$ gilt, je kleiner das BIC ist, desto besser ist das BIC.</span>
<span id="cb76-1086"><a href="#cb76-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1087"><a href="#cb76-1087" aria-hidden="true" tabindex="-1"></a>Du siehst schon, es gibt eine Reihe von Möglichkeiten sich mit der Güte oder Qualität eines Modells zu beschäftigen. Wir nutzen die Funktion <span class="in">`model_performance()`</span> um uns die Informationen über die Güte eines Modells wiedergeben zu lassen. Im folgenden Codeblock habe ich mich nur auf das $AIC$ und das $BIC$ konzentriert.</span>
<span id="cb76-1088"><a href="#cb76-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1091"><a href="#cb76-1091" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-1092"><a href="#cb76-1092" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(fit_1) <span class="sc">|&gt;</span> </span>
<span id="cb76-1093"><a href="#cb76-1093" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb76-1094"><a href="#cb76-1094" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AIC, BIC)</span>
<span id="cb76-1095"><a href="#cb76-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-1096"><a href="#cb76-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1097"><a href="#cb76-1097" aria-hidden="true" tabindex="-1"></a>Gut soweit. Du kannst jetzt für jedes der Modelle das $AIC$ berechnen und dann dir die Modelle entsprechend ordnen. Wir müssen das aber nicht tun. Wir können uns auch die Funktion <span class="in">`compare_performance()`</span> zu nutze machen. Die Funktion gibt uns die $R^2$-Werte wieder wie auch die $AIC$ sowie die $s^2_{\epsilon}$ als <span class="in">`sigma`</span> wieder. Wir haben also alles zusammen was wir brauchen. Darüber hinaus kann die Funktion auch die Modelle rangieren. Das nutzen wir natürlich gerne.</span>
<span id="cb76-1098"><a href="#cb76-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1101"><a href="#cb76-1101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-1102"><a href="#cb76-1102" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-1103"><a href="#cb76-1103" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb76-1104"><a href="#cb76-1104" aria-hidden="true" tabindex="-1"></a>comp_res <span class="ot">&lt;-</span> <span class="fu">compare_performance</span>(fit_1, fit_2, fit_3, fit_4, fit_5, <span class="at">rank =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-1105"><a href="#cb76-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1106"><a href="#cb76-1106" aria-hidden="true" tabindex="-1"></a>comp_res</span>
<span id="cb76-1107"><a href="#cb76-1107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-1108"><a href="#cb76-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1109"><a href="#cb76-1109" aria-hidden="true" tabindex="-1"></a>Anhand der Ausgabe der Funktion <span class="in">`compare_performance()`</span> sehen wir, dass unser Modell <span class="in">`fit_2`</span> das beste Modell ist. Zwar ist die Streuung der Residuen nicht die Kleinste aller Modelle (<span class="in">`Sigma`</span> = 1.933) aber wir haben ein hohes $R^2_{adj}$ und auch ein kleines $AIC$. Wir würden damit sagen, dass das Modell <span class="in">`fit_2`</span> mit den Variablen <span class="in">`animal`</span> und <span class="in">`sex`</span> für $x$ das Outcome <span class="in">`jump_length`</span> am besten statistisch beschreibt.</span>
<span id="cb76-1110"><a href="#cb76-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1111"><a href="#cb76-1111" aria-hidden="true" tabindex="-1"></a>In @fig-stat-modeling-compare sehen wir die Ausgabe der Funktion <span class="in">`compare_performance()`</span> nochmal visualisiert. Wir können dann die einzelnen Modelle nochmal besser vergleichen. Auch siehst du hier, ob ein Modell in einem Bereich sehr schlecht ist oder aber nur in einem Bereich sehr gut.</span>
<span id="cb76-1112"><a href="#cb76-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1115"><a href="#cb76-1115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-1116"><a href="#cb76-1116" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-1117"><a href="#cb76-1117" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb76-1118"><a href="#cb76-1118" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb76-1119"><a href="#cb76-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb76-1120"><a href="#cb76-1120" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb76-1121"><a href="#cb76-1121" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Graphische Darstellung der Funktion `compare_performance()` Wir sehen hier die einzelnen Gütekriterien in einer Übersicht dargestellt.</span></span>
<span id="cb76-1122"><a href="#cb76-1122" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-stat-modeling-compare</span></span>
<span id="cb76-1123"><a href="#cb76-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1124"><a href="#cb76-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(comp_res)</span>
<span id="cb76-1125"><a href="#cb76-1125" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-1126"><a href="#cb76-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1127"><a href="#cb76-1127" aria-hidden="true" tabindex="-1"></a>Zum Ende stellt sich die Frage nach dem statistischen Test. Können wir auch statistisch Testen, ob das Modell <span class="in">`fit_1`</span> signifikant unterschiedlich ist? Ja wir können die Funktion <span class="in">`test_vuong()`</span> nutzen um ein Model zu den anderen Modellen zu vergleichen. Wenn du mehrere Modell miteinander vergleichen möchtest, dann muss du die Funktion mehrfach ausführen.</span>
<span id="cb76-1128"><a href="#cb76-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1131"><a href="#cb76-1131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-1132"><a href="#cb76-1132" aria-hidden="true" tabindex="-1"></a><span class="fu">test_vuong</span>(fit_1, fit_2, fit_3, fit_4, fit_5)</span>
<span id="cb76-1133"><a href="#cb76-1133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-1134"><a href="#cb76-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1135"><a href="#cb76-1135" aria-hidden="true" tabindex="-1"></a>Nutzen wir die Modellselektion auch einmal an einem konkreten Beispiel. War die Transformation sinnvoll? Wir haben also ein Outcome $y$ vorliegen und wollen wissen, ob wir nicht lieber das Modell mit einem $y$ mit einer $log$-Transformation rechnen sollten. Wir nutzen dazu den Datensatz mit den Hunde- und Katzenflöhen und die Schlüpfdauer als Outcome. Also wie lange brauchen die Flöhe bis die Flöhe aus den Eiern geschlüpft sind.</span>
<span id="cb76-1136"><a href="#cb76-1136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1139"><a href="#cb76-1139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-1140"><a href="#cb76-1140" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-1141"><a href="#cb76-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1142"><a href="#cb76-1142" aria-hidden="true" tabindex="-1"></a>model_tbl <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(<span class="st">"data/flea_dog_cat_length_weight.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb76-1143"><a href="#cb76-1143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_hatch_time =</span> <span class="fu">round</span>(<span class="fu">log</span>(hatch_time), <span class="dv">2</span>))</span>
<span id="cb76-1144"><a href="#cb76-1144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-1145"><a href="#cb76-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1146"><a href="#cb76-1146" aria-hidden="true" tabindex="-1"></a>Wir bauen uns jetzt zwei Modelle. Zum einen das Modell <span class="in">`fit_raw`</span> mit der <span class="in">`hatch_time`</span> und den Variablen <span class="in">`ainmal`</span> und <span class="in">`sex`</span>. Das zweite Modell enthält die <span class="in">`log(hatch_time)`</span> also das Outcome $y$ als $log$-Transformation. Wiederum sind die $x$ variablen die gleichen wie im untransformierten Modell. Wir fitten beide Modelle und speichern die Objekte entsprechend ab.</span>
<span id="cb76-1147"><a href="#cb76-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1150"><a href="#cb76-1150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-1151"><a href="#cb76-1151" aria-hidden="true" tabindex="-1"></a>fit_raw <span class="ot">&lt;-</span> <span class="fu">lm</span>(hatch_time <span class="sc">~</span> animal <span class="sc">+</span> sex, <span class="at">data =</span> model_tbl)</span>
<span id="cb76-1152"><a href="#cb76-1152" aria-hidden="true" tabindex="-1"></a>fit_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_hatch_time <span class="sc">~</span> animal <span class="sc">+</span> sex, <span class="at">data =</span> model_tbl)</span>
<span id="cb76-1153"><a href="#cb76-1153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-1154"><a href="#cb76-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1155"><a href="#cb76-1155" aria-hidden="true" tabindex="-1"></a>Die Funktion <span class="in">`compare_performance()`</span> erlaubt uns wieder die beiden Modelle <span class="in">`fit_raw`</span> und <span class="in">`fit_log`</span> miteinander zu vergleichen. Wir erhalten die folgende Ausgabe der Funktion.</span>
<span id="cb76-1156"><a href="#cb76-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1159"><a href="#cb76-1159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb76-1160"><a href="#cb76-1160" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb76-1161"><a href="#cb76-1161" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb76-1162"><a href="#cb76-1162" aria-hidden="true" tabindex="-1"></a>comp_res <span class="ot">&lt;-</span> <span class="fu">compare_performance</span>(fit_raw, fit_log, <span class="at">rank =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-1163"><a href="#cb76-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1164"><a href="#cb76-1164" aria-hidden="true" tabindex="-1"></a>comp_res</span>
<span id="cb76-1165"><a href="#cb76-1165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb76-1166"><a href="#cb76-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1167"><a href="#cb76-1167" aria-hidden="true" tabindex="-1"></a>In diesem Beispiel wäre das $log$-transformierte Modell das bessere statistische Modell. Wir müssen jetzt überlegen, ob wir den Preis dafür bezahlen wollen. Wenn wir nämlich alles mit der $log$-Transformation rechnen, dann erhalten wir auch alle Koeffizienten auf der $log$-Skala (eng. *log scale*). Hier kannst du nur von Fall zu Fall entscheiden.</span>
<span id="cb76-1168"><a href="#cb76-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-1169"><a href="#cb76-1169" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-basic.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-basic.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Skript Bio Data Science - 54&nbsp; Hauptkomponentenanalyse</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./experimental-design-preface.html" rel="next">
<link href="./stat-modeling-cluster.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-modeling-preface.html">Statistisches Modellieren</a></li><li class="breadcrumb-item"><a href="./stat-modeling-pca.html"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Hauptkomponentenanalyse</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skript Bio Data Science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Literatur</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Hunden und Katzen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-foxes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats-length-weight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von vielen Flöhen auf Hunden und Katzen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Buchstaben und Zahlen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>purrr</code> Cookbook</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frequentistische Hypothesentests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Pre-Tests oder Vortest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Multiple Vergleiche oder Post-hoc Tests</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen der linearen Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Maßzahlen der Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Imputation fehlender Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Hauptkomponentenanalyse</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelles Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Grundlagen der Versuchsplanung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Fortgeschrittene Versuchsplanung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">Anhang</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spielecke</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
<li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">54.1</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">54.2</span> Daten</a></li>
  <li><a href="#daten-standardisieren" id="toc-daten-standardisieren" class="nav-link" data-scroll-target="#daten-standardisieren"><span class="header-section-number">54.3</span> Daten standardisieren</a></li>
  <li><a href="#das-data.frame-problem" id="toc-das-data.frame-problem" class="nav-link" data-scroll-target="#das-data.frame-problem"><span class="header-section-number">54.4</span> Das <code>data.frame()</code> Problem</a></li>
  <li>
<a href="#hauptkomponentenanalyse" id="toc-hauptkomponentenanalyse" class="nav-link" data-scroll-target="#hauptkomponentenanalyse"><span class="header-section-number">54.5</span> Hauptkomponentenanalyse</a>
  <ul class="collapse">
<li><a href="#pca---principal-component-analysis" id="toc-pca---principal-component-analysis" class="nav-link" data-scroll-target="#pca---principal-component-analysis"><span class="header-section-number">54.5.1</span> PCA - Principal Component Analysis</a></li>
  <li><a href="#ca---correspondence-analysis" id="toc-ca---correspondence-analysis" class="nav-link" data-scroll-target="#ca---correspondence-analysis"><span class="header-section-number">54.5.2</span> CA - Correspondence Analysis</a></li>
  <li><a href="#mca---multiple-correspondence-analysis" id="toc-mca---multiple-correspondence-analysis" class="nav-link" data-scroll-target="#mca---multiple-correspondence-analysis"><span class="header-section-number">54.5.3</span> MCA - Multiple Correspondence Analysis</a></li>
  <li><a href="#famd---factor-analysis-of-mixed-data" id="toc-famd---factor-analysis-of-mixed-data" class="nav-link" data-scroll-target="#famd---factor-analysis-of-mixed-data"><span class="header-section-number">54.5.4</span> FAMD - Factor Analysis of Mixed Data</a></li>
  <li><a href="#mfa---multiple-factor-analysis" id="toc-mfa---multiple-factor-analysis" class="nav-link" data-scroll-target="#mfa---multiple-factor-analysis"><span class="header-section-number">54.5.5</span> MFA - Multiple Factor Analysis</a></li>
  </ul>
</li>
  <li>
<a href="#darstellung-der-ergebnisse" id="toc-darstellung-der-ergebnisse" class="nav-link" data-scroll-target="#darstellung-der-ergebnisse"><span class="header-section-number">54.6</span> Darstellung der Ergebnisse</a>
  <ul class="collapse">
<li><a href="#ebene-der-eigenwerte" id="toc-ebene-der-eigenwerte" class="nav-link" data-scroll-target="#ebene-der-eigenwerte"><span class="header-section-number">54.6.1</span> Ebene der Eigenwerte</a></li>
  <li><a href="#ebene-der-variablen" id="toc-ebene-der-variablen" class="nav-link" data-scroll-target="#ebene-der-variablen"><span class="header-section-number">54.6.2</span> Ebene der Variablen</a></li>
  <li><a href="#ebene-der-individuen" id="toc-ebene-der-individuen" class="nav-link" data-scroll-target="#ebene-der-individuen"><span class="header-section-number">54.6.3</span> Ebene der Individuen</a></li>
  </ul>
</li>
  <li><a href="#multi-dimensional-scaling-mds" id="toc-multi-dimensional-scaling-mds" class="nav-link" data-scroll-target="#multi-dimensional-scaling-mds"><span class="header-section-number">54.7</span> Multi Dimensional Scaling (MDS)</a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-pca-main" class="quarto-section-identifier"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Hauptkomponentenanalyse</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p><em>Version vom August 01, 2023 um 19:21:26</em></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/caution.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
<p>Die Hauptkomponentenanalyse (eng. <em>Principle Component Analysis</em>, abk. PCA) ist ein bedeutendes Verfahren zur Dimensionsreduktion. Wir haben also einen sehr großen Datensatz mit sehr vielen Spalten und wollen Muster in den Beobachtungen finden, die durch die Zeilen definiert sind. Dieses Kapitel umfasst dabei aber nur die notwendigen Verfahren und Anwendungen. Das hat vor allem damit zu tun, dass die Hauptkomponentenanalyse in den Sozialwissenschaften sehr weitreichend genutzt wird. Wir machen hier aber Agrarwissenschaften, also ist es eher ein nebensächlicher Fokus. Ebenso ist die Auswertung von Fragebögen allgemein ein Schwerpunkt der Hauptkomponentenanalyse. Auch werden Fragebögen eher selten in meinem Feld ausgewertet, deshalb hier nur das eine Kapitel, wenn man auch sicherlich viel mehr schreiben könnte.</p>
<p>Das folgende Kapitel basiert zum Teilen auf den <a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/">Articles - Principal Component Methods in R: Practical Guide</a>. Diese Sammlung an Tutorien geben einen wunderbaren Überblick über alle möglichen Methoden zu der Hauptkomponentenanalyse und deren verwandten Algorithmen. Wenn dich dazu mehr interessiert kann ich das Buch von <span class="citation" data-cites="kassambara2017practical">Kassambara (<a href="#ref-kassambara2017practical" role="doc-biblioref">2017</a>)</span> dir sehr ans Herz legen. Dort findest du eine tolle Übersicht über die Hauptkomponentenanalyse in R.</p>
<p>Was ist grob die Idee der Hauptkomponentenanalyse? Wir wollen Geraden durch unsere Datenwolke ziehen und dabei die Varianz minimieren. Das klingt jetzt wie die Regression und damit hast du auch recht. Die Hauptkomponentenanalyse und die lineare Regression sind nah miteinander verwandt. Damit wären wir schon beim ersten Punkt, Hauptkomponenten beschreiben einen Anteil der erklärten Varianz durch die entsprechende Hauptkomponente. Dabei erklärt <em>grundsätzlich</em> die 1. Hauptkomponente die meiste Varianz gefolfgt von 2. Hauptkomponente und so fort. Die Hauptkomponenten sind somit nach dem Anteil der erklärten Varianz sortiert. Das ist eine grundlegende Eigenschaft der Hauptkomponenten. Darüber hinaus sind auch alle Hauptkomponenten untereinander mit 0 korreliert und somit maximal unkorreliert. Die Hauptkomponenten und damit die Geraden durch die Punktwolke stehen orthogonal oder senkrecht aufeinander.</p>
<div id="fig-pca-schema" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/pca/pca_5.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Abbildung&nbsp;54.1— Schematische Darstellung der 1. Hauptkomponente (PC1) durch die Punktewolke mit maximal erklärter Varianz, da minimaler Abstand zu den Punkten. Die 2. Hauptkomponente (PC2) stellt eine <em>mögliche</em> Repräsentation dar. Die 2. Hauptkomponente muss lotrecht auf der 1. Hauptkomponente stehen und dabei die Varianz weiter maximal minimieren. Dabei ist ja eine Drehung um die 1. Hauptkomponente als Achse möglich.</figcaption></figure>
</div>
<p>In der <a href="#fig-pca-schema">Abbildung&nbsp;<span>54.1</span></a> sehen wir einmal dargestellt, was eine Hauptkomponentenanalyse erreichen will. Wir legen zuerst die 1. Hauptkomponente (PC1) so durch die Daten, dass die Varianz durch die 1. Hauptkomponente maximal minimiert wird. Dann berechnen wir die 2. Hauptkomponente (PC2) so, dass die 2. Hauptkomponente senkrecht auf der 1. Hauptkomponente steht. Hier sehen wir nur eine Möglichkeit, den es gebe ja auch noch andere Drehungen der 2. Hauptkomponente die ebenfalls die Bedingung, das Lot zur 1. Hauptkomponente zu sein, erfüllen würde. Es ist ja dann im Prinzip eine Drehung um die 1. Hauptkomponente als zentrale Achse zu sehen. Wir wählen die lotrechte Repräsentation der 2. Hauptkomponente, die am meisten Varianz erklärt, also die Abstände minimiert, die noch nicht durch die 1. Hauptkomponente minimiert wurden. Somit erklärt die 2. Hauptkomponente <em>immer</em> weniger Varianz als die 1. Hauptkomponente.</p>
<p>Gut klingt jetzt erstmal einleuchtend, aber wie geht das mathematisch? Da sieht es schon etwas komplizierter aus.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2045312</span><span class="op">)</span></span>
<span><span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>              y <span class="op">=</span> <span class="fl">0</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = tbl)

Coefficients:
(Intercept)            x  
     -0.101        0.504  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     x    y
x 21.6 10.9
y 10.9  6.1</code></pre>
</div>
</div>
<p><span class="math display">\[
\Sigma =
\begin{pmatrix}
\operatorname{Var}(x) &amp; \operatorname{Cov}(x, y) \\
\operatorname{Cov}(x, y) &amp; \operatorname{Var}(y)
\end{pmatrix} =
\begin{pmatrix}
21.6 &amp; 10.9 \\
10.9 &amp; 6.1
\end{pmatrix}
\]</span></p>
<p>text</p>
<p><span class="math display">\[
\beta_x = \cfrac{\operatorname{Cov}(x, y)}{\operatorname{Var}(x)} = \cfrac{10.9}{21.6} \approx 0.5
\]</span></p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">0.515749</span>, intercept <span class="op">=</span> <span class="op">-</span><span class="fl">0.101</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="op">-</span><span class="fl">1.938928</span>, intercept <span class="op">=</span> <span class="op">-</span><span class="fl">0.101</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">8</span>, y <span class="op">=</span> <span class="fl">6</span>, label <span class="op">=</span> <span class="st">"PC1"</span>, size <span class="op">=</span> <span class="fl">8</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">2.5</span>, y <span class="op">=</span> <span class="fl">9</span>, label <span class="op">=</span> <span class="st">"PC2"</span>, size <span class="op">=</span> <span class="fl">8</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">7</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>           label <span class="op">=</span> <span class="fu">TeX</span><span class="op">(</span><span class="st">r"($y = -0.1 + 0.52 \cdot x$)"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>,</span>
<span>           label <span class="op">=</span> <span class="fu">TeX</span><span class="op">(</span><span class="st">r"($y = -0.1 - 1.94 \cdot x$)"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-cluster-pca-exp" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-cluster-pca-exp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-cluster-pca-exp-1.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-pca-exp" width="480"></p>
<figcaption class="figure-caption">(a) Richtung der Variablen (Spalten)</figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;54.2— Diagramm der PCA für die Variablen (Saplten) und den Beobachtungen (Zeilen) der Datenmatrix.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span><span class="op">$</span><span class="va">rotation</span></span>
<span><span class="va">pca_res</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        PC1        PC2
x 0.8887583 -0.4583762
y 0.4583762  0.8887583</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca_res</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span> <span class="op">/</span> <span class="va">pca_res</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      PC1       PC2 
 0.515749 -1.938928 </code></pre>
</div>
</div>
<p>Das funktioniert nur auf standardisierten Daten. Sonst ist der Intercept nicht 0.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">eigen</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1] 27.2356150  0.4907358

$vectors
           [,1]       [,2]
[1,] -0.8887583  0.4583762
[2,] -0.4583762 -0.8887583</code></pre>
</div>
</div>
<p><a href="https://cran.r-project.org/web/packages/matlib/vignettes/eigen-ex1.html">Eigenvalues and Eigenvectors: Properties</a></p>
<p><a href="https://stackoverflow.com/questions/49368754/adding-orthogonal-regression-line-in-ggplot">Adding orthogonal regression line in ggplot</a></p>
<p>Wir wollen unseren Daten, also die ganze Daten<em>matrix</em> einmal so transformieren, dass wir neue Komponenten aus den Daten extrahieren, die die Daten auf einer anderen Dimension beschreiben. Klingt etwas kryptisch, aber im Prinzip handelt es sich bei der Hauptkomponentenanalyse um eine komplexere Transformation der Daten. Wir nutzen dabei die Varianzstruktur und die Varianz/Kovarianzmatrix als unsere Distanzmatrix für die Variablen und Beobachtungen. Im Prinzip also die Korrelation zwischen den einzelnen Variablen in dem Datensatz. Über diese Korrelation zwischen den Spalten und Zeilen wollen wir die Daten reduzieren. Wird die gesamte Varianz der Daten vielleicht nur von wenigen Spalten verursacht? Dann brauchen wir ja nur diese Hauptkomponenten weiter betrachten. Wir nutzen also die Varianz/Kovarianzmatrix als unsere Ähnlichkeitsmatrix, wie schon bei den Clusteranalysen, um hier unbekannte Zusammenhänge zwischen den Spalten und damit dann Hauptkomponenten aufzuklären.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hauptkomponente, Eigenwert und Varianz kurz zusammengefasst
</div>
</div>
<div class="callout-body-container callout-body">
<p>In einer Hauptkomponentenanalyse ersetzen wir die ursprünglichen Spalten eines Datensatzes durch Hauptkomponenten. Die Hauptkomponenten haben so viele Dimensionen wie es Spalten im ursprünglichen Datensatz gibt. Jede Hauptkomponente hat einen Eigenwert (eng. <em>eigenvalue</em>), der den Anteil der erklärten Varianz der Hauptkomponente in den Daten beschreibt. Wir können die Beobachtungen oder Individuen (abk. <em>ind</em>) in den Zeilen betrachten oder aber die Variablen (abk. <em>var</em>) in den Spalten.</p>
</div>
</div>
<p>Neben der PCA existiert noch das <em>Multidimensional Scaling</em> (abk. MDS). Das MDS ist im Prinzip eine Spezialform der PCA. Im Unterschied zur PCA wird die MDS auf einer Distanzmatrix gerechnet. In einer MDS können wir nicht einfach so unsere Daten reinstecken sondern müssen zuerst die Daten in eine Distanzmatrix umrechnen. Dafür gibt es die Funktion <code><a href="https://rdrr.io/r/stats/dist.html">dist()</a></code> oder <code><a href="https://rdrr.io/r/stats/dist.html">as.dist()</a></code>, wenn wir schon Distanzen vorliegen haben. Daher ist die Anwendung einer MDS nicht besonders komplizierter.</p>
<p>Wenn wir eine PCA in R rechnen wollen, dann haben wir zuerst die Wahl zwischen den Funktionen <code><a href="https://rdrr.io/r/stats/prcomp.html">prcomp()</a></code> und <code><a href="https://rdrr.io/r/stats/princomp.html">princomp()</a></code>. Laut der R-Hilfe hat die Funktion <code><a href="https://rdrr.io/r/stats/prcomp.html">prcomp()</a></code> eine etwas bessere numerische Genauigkeit. Daher ist die Funktion <code><a href="https://rdrr.io/r/stats/prcomp.html">prcomp()</a></code> gegenüber <code><a href="https://rdrr.io/r/stats/princomp.html">princomp()</a></code> vorzuziehen. Es gibt aber noch eine <em>neuere</em> Implementierung der Funktionalität in dem R Paket <code>FactoMineR</code> und der Funktion <code>PCA()</code>. In diesem Kapitel nutzen wir also das R Paket <code>factoextra</code> um sich Faktoranalysen super anzuschauen und durchzuführen. Dur kannst mehr auf der Webseite <a href="http://www.sthda.com/english/wiki/factoextra-r-package-easy-multivariate-data-analyses-and-elegant-visualization">Factoextra R Package: Easy Multivariate Data Analyses and Elegant Visualization</a> mehr über das Paket erfahren.</p>
<p>Es gibt eine <em>natürlich</em> große Anzahl an Quellen wie du in R eine PCA oder ein MDS durchführst. In der folgenden Box findest du eine Sammlung an Tutorien und R Code, der dir als Inspiration dienen mag. Ich werde teile von den Tutorien in der Folge verwenden, kann aber natürlich nichts alles nochmal machen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die Principal Component Analysis
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Wie immer gibt es eine Vielzahl an tollen Tutorien, die die PCA gut erklären. Ich habe hier einmal eine Auswahl zusammengestellt und du kannst dich da ja mal vertiefend mit beschäftigen, wenn du willst. Teile der Tutorien findest du vermutlich hier im Haupttext wieder.</p>
<ul>
<li><a href="http://www.billconnelly.net/?p=697">Principal Component Analysis (PCA) For Dummies</a></li>
<li><a href="https://georgemdallas.wordpress.com/2013/10/30/principal-component-analysis-4-dummies-eigenvectors-eigenvalues-and-dimension-reduction/">Principal Component Analysis 4 Dummies: Eigenvectors, Eigenvalues and Dimension Reduction</a></li>
<li><a href="https://towardsdatascience.com/the-most-gentle-introduction-to-principal-component-analysis-9ffae371e93b">The most gentle introduction to Principal Component Analysis</a></li>
</ul>
</div>
</div>
</div>
<p>Wir wollen uns jetzt die Hauptkomponentenanalyse an zwei Spieldaten anschauen. Eigentlich werden ja auch gerne Fragebögen mit der Hauptkomponentenanalyse ausgewertet, aber hier muss ich nochmal warten bis ich ein gutes Beispiel in den Beratungen hatte. Dann ergänze ich ein Beispiel bei dem Skrippt zu den <a href="https://jkruppa.github.io/application/">Beispielhaften Auswertungen</a>.</p>
<section id="genutzte-r-pakete" class="level2" data-number="54.1"><h2 data-number="54.1" class="anchored" data-anchor-id="genutzte-r-pakete">
<span class="header-section-number">54.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>, <span class="va">magrittr</span>, <span class="va">readxl</span>, <span class="va">patchwork</span>,</span>
<span>               <span class="va">factoextra</span>, <span class="va">FactoMineR</span>, <span class="va">ggpubr</span>,</span>
<span>               <span class="va">janitor</span>, <span class="va">corrplot</span>, <span class="va">conflicted</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"select"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"filter"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"mutate"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflicts_prefer</span><span class="op">(</span><span class="fu">magrittr</span><span class="fu">::</span><span class="va"><a href="https://magrittr.tidyverse.org/reference/aliases.html">set_names</a></span><span class="op">)</span></span>
<span><span class="fu">conflicts_prefer</span><span class="op">(</span><span class="fu">dlookr</span><span class="fu">::</span><span class="va"><a href="https://choonghyunryu.github.io/dlookr/reference/transform.html">transform</a></span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Am Ende des Kapitels findest du nochmal den gesamten R Code in einem Rutsch zum selber durchführen oder aber kopieren.</p>
</section><section id="daten" class="level2 page-columns page-full" data-number="54.2"><h2 data-number="54.2" class="anchored" data-anchor-id="daten">
<span class="header-section-number">54.2</span> Daten</h2>
<p>Beginnen wir mit einem normierten Datensatz aus dem R Paket <code>cluster</code>. Der Datensatz <code>animals</code> wurde von mir noch mit ein paar Tieren ergänzt und schaut sich sechs Eigenschaften von 23 Tieren an. Wir wollen im Folgenden nun herausfinden, ob wir anhand der Eigenschaften in den Spalten die Tiere in den Zeilen in Gruppen einordnen können. Einige der Tiere sind ja näher miteinander verwandt als andere Tiere. Die ursprünglichen Daten liefen noch auf einem <span class="math inline">\(1/2\)</span>-System, das ändern wir dann zu <span class="math inline">\(0/1\)</span> damit wir dann auch besser mit den Daten arbeiten können. Für die Algorithmen ist es egal, aber ich habe lieber <span class="math inline">\(1\)</span> gleich ja und <span class="math inline">\(0\)</span> gleich nein.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">animals_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/cluster_animal.xlsx"</span>, sheet <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">clean_names</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Schauen wir uns einmal den Datensatz in der <a href="#tbl-cluster-01">Tabelle&nbsp;<span>54.1</span></a> an. Wir sehen, dass wir noch einige fehlende Werte in den Daten vorliegen haben. Das ist manchmal ein Problem, deshalb werden wir im Laufe der Analyse die <code>NA</code> Werte mit <code><a href="https://rdrr.io/r/stats/na.fail.html">na.omit()</a></code> entfernen.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-cluster-01" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tabelle&nbsp;54.1— Übersicht über die 23 Tiere mit den sechs Eigenschaften in den Spalten. Eine 1 bedeutet, dass die Eigenschaft vorliegt; eine 0 das die Eigenschaft nicht vorliegt.</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 6%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">warm_blooded</th>
<th style="text-align: center;">fly</th>
<th style="text-align: center;">vertebrate</th>
<th style="text-align: center;">threatened</th>
<th style="text-align: center;">live_in_groups</th>
<th style="text-align: center;">hair</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ant</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">bee</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">centipede</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">chimpanzee</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">cow</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dolphin</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">duck</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">eagle</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">earthworm</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">elephant</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">fly</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">frog</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">herring</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">horse</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">human</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lion</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">lizard</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lobster</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">rabbit</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">salmon</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">spider</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">whale</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Der Tierdatensatz ist schön, da wir es hier nur mit 0/1 Werten zu tun haben. Wir werden später in dem preprocessing der Daten sehen, dass wir alle Spalten in der gleichen Spannweite der Werte wollen. Das klingt immer etwas kryptisch, aber der nächste Datensatz über verschiedene Kreaturen macht es deutlicher.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Eine andere Art die Daten zu Gruppieren kannst du im Tutorium <a href="https://rpubs.com/askieswe/clustering">Clustering Creatures</a> nochmal nachvollziehen.</p>
</div></div><p>Im Folgenen einmal der Datensatz, den wir dann in der gleichen Exceldatei finden nur eben auf dem zweiten Tabellenblatt. Wir reinigen noch die Namen und setzen die <code>creature</code>-Spalte auf Klein geschrieben. Wie du siehst, haben wir dann nur 15 Kreaturen und drei Spalten mit dem Gewicht, der Herzrate und dem maximalen möglichen Alter.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">creature_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/cluster_animal.xlsx"</span>, sheet <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">clean_names</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>creature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="va">creature</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#tbl-cluster-02">Tabelle&nbsp;<span>54.2</span></a> sehen wir nochmal die Daten dargestellt und hier erkennst du auch gut, wo das Problem liegt. Die Masse der Tiere reicht von <span class="math inline">\(6g\)</span> beim Hamster bis <span class="math inline">\(120000000g\)</span> beim Wal. Diese Spannweiten in einer Spalte und zwischen den Spalten führt dann zu Problemen bei den Algorithmen. Deshalb müssen wir hier Daten nochmal normalisieren oder aber standardisieren. Je nachdem was da besser passt.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-cluster-02" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tabelle&nbsp;54.2— Übersicht über die 15 Kreaturen mit den drei Eigenschaften in den Spalten. Wir haben hier sehr große Unterschiede in den Datenwerten. Daher müssen wir vor dem Clustern nochmal normalisieren.</caption>
<thead><tr class="header">
<th style="text-align: center;">creature</th>
<th style="text-align: center;">mass_grams</th>
<th style="text-align: center;">heart_rate_bpm</th>
<th style="text-align: center;">longevity_years</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">human</td>
<td style="text-align: center;">9.0e+04</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">2.0e+03</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="odd">
<td style="text-align: center;">small dog</td>
<td style="text-align: center;">2.0e+03</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: center;">medium dog</td>
<td style="text-align: center;">5.0e+03</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="odd">
<td style="text-align: center;">large dog</td>
<td style="text-align: center;">8.0e+03</td>
<td style="text-align: center;">75</td>
<td style="text-align: center;">17</td>
</tr>
<tr class="even">
<td style="text-align: center;">hamster</td>
<td style="text-align: center;">6.0e+01</td>
<td style="text-align: center;">450</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">chicken</td>
<td style="text-align: center;">1.5e+03</td>
<td style="text-align: center;">275</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;">monkey</td>
<td style="text-align: center;">5.0e+03</td>
<td style="text-align: center;">190</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="odd">
<td style="text-align: center;">horse</td>
<td style="text-align: center;">1.2e+06</td>
<td style="text-align: center;">44</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="even">
<td style="text-align: center;">cow</td>
<td style="text-align: center;">8.0e+05</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">22</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pig</td>
<td style="text-align: center;">1.5e+05</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">25</td>
</tr>
<tr class="even">
<td style="text-align: center;">rabbit</td>
<td style="text-align: center;">1.0e+03</td>
<td style="text-align: center;">205</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">elephant</td>
<td style="text-align: center;">5.0e+06</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="even">
<td style="text-align: center;">giraffe</td>
<td style="text-align: center;">9.0e+05</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">20</td>
</tr>
<tr class="odd">
<td style="text-align: center;">large whale</td>
<td style="text-align: center;">1.2e+08</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">80</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="daten-standardisieren" class="level2" data-number="54.3"><h2 data-number="54.3" class="anchored" data-anchor-id="daten-standardisieren">
<span class="header-section-number">54.3</span> Daten standardisieren</h2>
<p>Die Standardisierung zwingt Variablen in eine <span class="math inline">\(\mathcal{N(0,1)}\)</span> Standardnormalverteilung. Das heißt, wir transformieren alle Variablen auf einen Mittelwert von <span class="math inline">\(0\)</span> und einer Standardabweichung von <span class="math inline">\(1\)</span>. Hier nochmal die Formel für die Standardisierung oder auch <span class="math inline">\(z\)</span>-Transformation.</p>
<p><span class="math display">\[
z = \cfrac{x_i - \bar{x}}{s_x}
\]</span> Wie wir hier sehen ziehen wir von jeder <span class="math inline">\(i\)</span>-ten Beobachtung den Mittlwert von allen Beobachtungen ab. Dann teilen wir noch durch die Standardabweichung alle Beobachtungen. Am Ende ist dann damit unser Mittelwert auf <span class="math inline">\(0\)</span> und unsere Standardabweichung auf <span class="math inline">\(1\)</span>.</p>
<p>Die Standardisierung macht dann auch die Daten sehr schon gleichförmig. Hier nutzen wir auch die Funktion <code><a href="https://rdrr.io/r/base/transform.html">transform()</a></code> aus dem R Paket <code>dlookr</code> mit der Option <code>zscore</code>. Damit wir auch auf jeden Fall sicher gehen, dass wir die richtige Funktion nutzen, schreiben wir <code><a href="https://choonghyunryu.github.io/dlookr/reference/transform.html">dlookr::transform()</a></code> und damit ist sichergestellt, dass wir auch die Funktion <code><a href="https://rdrr.io/r/base/transform.html">transform()</a></code> aus dem R Paket <code>dlookr</code> nutzen.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">std_creature_tbl</span> <span class="op">&lt;-</span> <span class="va">creature_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>mass_grams <span class="op">=</span> <span class="fu">dlookr</span><span class="fu">::</span><span class="fu"><a href="https://choonghyunryu.github.io/dlookr/reference/transform.html">transform</a></span><span class="op">(</span><span class="va">mass_grams</span>, <span class="st">"zscore"</span><span class="op">)</span>,</span>
<span>         heart_rate_bpm <span class="op">=</span> <span class="fu">dlookr</span><span class="fu">::</span><span class="fu"><a href="https://choonghyunryu.github.io/dlookr/reference/transform.html">transform</a></span><span class="op">(</span><span class="va">heart_rate_bpm</span>, <span class="st">"zscore"</span><span class="op">)</span>,</span>
<span>         longevity_years <span class="op">=</span> <span class="fu">dlookr</span><span class="fu">::</span><span class="fu"><a href="https://choonghyunryu.github.io/dlookr/reference/transform.html">transform</a></span><span class="op">(</span><span class="va">longevity_years</span>, <span class="st">"zscore"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">std_creature_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 4
   creature    mass_grams heart_rate_bpm longevity_years
   &lt;chr&gt;       &lt;transfrm&gt; &lt;transfrm&gt;     &lt;transfrm&gt;     
 1 human       -0.2739558 -0.5739180      1.6794647     
 2 cat         -0.2768074  0.2094888     -0.5409814     
 3 small dog   -0.2768074 -0.2257372     -0.7428402     
 4 medium dog  -0.2767102 -0.3127824     -0.5409814     
 5 large dog   -0.2766129 -0.4433502     -0.4602379     
 6 hamster     -0.2768702  2.8208449     -1.0254424     
 7 chicken     -0.2768236  1.2975538     -0.5409814     
 8 monkey      -0.2767102  0.5576696     -0.5409814     
 9 horse       -0.2379870 -0.7131904      0.4683123     
10 cow         -0.2509487 -0.5303954     -0.2583792     
11 pig         -0.2720115 -0.4868728     -0.1372639     
12 rabbit      -0.2768398  0.6882374     -0.7832119     
13 elephant    -0.1148507 -0.8350536      1.6794647     
14 giraffe     -0.2477083 -0.5303954     -0.3391227     
15 large whale  3.6116436 -0.9220988      2.0831822     </code></pre>
</div>
</div>
<p>Die Funktion <code>PCA()</code>, die wir im Folgenden verwenden wollen, wird zwar auch die Daten intern von sich aus standardisieren, wenn die nicht standardisiert wurden. Ich mag es aber nicht, wenn wichtige Schritte in Funktionen begraben werden, deshlab hier nochmal das Beispiel, wie man es macht.</p>
</section><section id="das-data.frame-problem" class="level2" data-number="54.4"><h2 data-number="54.4" class="anchored" data-anchor-id="das-data.frame-problem">
<span class="header-section-number">54.4</span> Das <code>data.frame()</code> Problem</h2>
<p>Leider ist es so, dass fast alle Pakete im Kontext der Clusteranalyse mit den Zeilennamen bzw. <code><a href="https://rdrr.io/r/base/row.names.html">row.names()</a></code> eines <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> arbeiten. Das hat den Grund, dass wir gut das Label in den Zeilennamen parken können, ohne das uns eine Spalte in den Auswertungen stört. Meistens ist das Label ja ein <code>character</code> und soll gar nicht in den Clusteralgorithmus mit rein. Deshalb müssen wir hier einmal unsere <code>tibble()</code> in einen <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> umwandeln. Die <code>tibble()</code> haben aus gutem Grund keine Zeilennamen, die Zeilennamen sind ein Ärgernis und Quelle von Fehlern und aus gutem Grund nicht in einem <code>tibble()</code> drin. Hier brauchen wir die Zeilennamen aber.</p>
<p>Wir bauen uns also einmal einen <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> für unseren Tierdatensatz und setzen die Tiernamen als Zeilennamen bzw. <code><a href="https://rdrr.io/r/base/row.names.html">row.names()</a></code>. Wir entfernen dann auch noch schnell alle fehlenden Werte, denn wir wollen usn hier nicht noch mit der Imputation von fehlenden Werten beschäftigen.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">animals_df</span> <span class="op">&lt;-</span> <span class="va">animals_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">set_rownames</span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">animal</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">animal</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das Ganze machen wir dann auch noch einmal für die normalisierten Kreaturendaten. Wir wollen dann ja nur auf den normalisierten Daten weitermachen.</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">std_creature_df</span> <span class="op">&lt;-</span> <span class="va">std_creature_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">set_rownames</span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">creature</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">creature</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="hauptkomponentenanalyse" class="level2 page-columns page-full" data-number="54.5"><h2 data-number="54.5" class="anchored" data-anchor-id="hauptkomponentenanalyse">
<span class="header-section-number">54.5</span> Hauptkomponentenanalyse</h2>
<div class="column-page">
<div id="fig-pca-overview" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/pca/pca_overview.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Abbildung&nbsp;54.3— Verlauf einer generalisierten Hauptkomponentenanalyse von dem Datensatz über die Varianz/Kovarianzmatrix zu den unkorrelierten Hauptkomponeten und deren Koordinaten unabhängig von den Eigenschaften der Variablen. Abschließend sind die Koordinaten der Hauptkomponenten im Koorelationsplot der 1. und 2. Hauptkomponente dargestellt. Variablen die nahe beieinander sind, sind positiv miteinander korreliert; Variablen in den gegenüberliegenden Quadranten naegativ. Je weiter eine Variable außen liegt, desto höher ist die Aussagekraft. Variablen nahe dem Ursprung, haben eine geringe Bedeutung. Am Beispiel der Variable <code>fly</code> werden nochmal die Koordinaten deutlich.</figcaption></figure>
</div>
</div>
<p>Es gibt viele Implementierungen der Hauptkomponentenanalyse in R. Wir nutzen die Funktion <code>PCA()</code> aus dem R Paket <code>FactoMineR</code> für die Analyse von kontinuierlichen Variablen. Denk immer daran, es kann maximal nur so viele Hauptkomponenten geben, wie wir auch Spalten in den Daten vorliegen haben. Folgende wichtige Funktionen werden wir jetzt einmal nutzen. Es gibt noch mehr, aber das übersteigt die einfache Hauptkomponentenanalyse, die wir uns hier anschauen wollen.</p>
<p>Die zentrale Funktion ist aber die Funktion <code>PCA()</code> womit wir die eigentliche Hauptkomponentenanalyse erstmal durchführen, wenn kontinuierliche Variablen vorliegen. Die Funktion nimmt die Daten und berechnet dann intern die Varianz/Kovarianzmatrix. Die Varianz/Kovarianzmatrix wird dann als Distanzmatrix genutzt um die Hauptkomponenten und deren Eigenwerte zu berechnen.</p>
<p>Neben der Funktion <code>PCA()</code> aus dem R Paket <code>FactoMineR</code> für die Analyse von kontinuierlichen Variablen gibt es noch eine Reihe anderer Funktionen für eine Hauptkomponentenanalyse wenn wir kategoriale Variablen oder eine Mischung vorliegen haben. Hier mal die vollständige Liste.</p>
<ul>
<li>
<a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/">PCA - Principal Component Analysis</a>, zur Analyse eines Datensatzes mit kontinuierlichen Variablen</li>
<li>
<a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/113-ca-correspondence-analysis-in-r-essentials/">CA - Correspondence Analysis (Korrespondenzanalyse)</a>, für die Analyse der Assoziation zwischen zwei kategorialen Variablen.</li>
<li>
<a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/114-mca-multiple-correspondence-analysis-in-r-essentials/">MCA - Multiple Correspondence Analysis</a>, für die Analyse eines Datensatzes mit kategorialen Variablen.</li>
<li>
<a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/115-famd-factor-analysis-of-mixed-data-in-r-essentials/">FAMD - Factor Analysis of Mixed Data (Faktorenanalyse gemischter Daten)</a>, für die Analyse eines Datensatzes, der sowohl kontinuierliche als auch kategoriale Variablen enthält.</li>
<li>
<a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/116-mfa-multiple-factor-analysis-in-r-essentials/">MFA - Multiple Factor Analysis</a>, für die Analyse eines Datensatzes, der in Gruppen strukturierte Variablen enthält.</li>
</ul>
<section id="pca---principal-component-analysis" class="level3" data-number="54.5.1"><h3 data-number="54.5.1" class="anchored" data-anchor-id="pca---principal-component-analysis">
<span class="header-section-number">54.5.1</span> PCA - Principal Component Analysis</h3>
<p>Bei der Nutzung der Funktion <code>PCA()</code> ist für mich wichtig, dass wir nicht gleich irgendwelche Abbildungen erhalten, deshalb ist hier im Skript <code>graph = FALSE</code> gewählt. Mit der Option <code>scale.unit = TRUE</code> musst du die Daten selber nicht standardisieren sondern die Funktion <code>PCA()</code> macht das für dich. Manchmal sind Fragebögen sehr groß mit mehr als Dutzenden von Fragen, da macht es Sinn sich nicht die Anzahl an Fragen als Hauptkomponenten wiedergeben zu lassen. Die Option <code>ncp = 5</code> zum Beispiel schränkt hier die Anzahl auf 5 Hauptkomponenten ein. Bei den Kreaturen macht es keinen Sinn, da erhalten wir natürlich nur drei Hauptkomponenten, da wir nur drei Spalten in dem Datensatz haben.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca_animals</span> <span class="op">&lt;-</span> <span class="fu">PCA</span><span class="op">(</span><span class="va">animals_df</span>, scale.unit <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                   ncp <span class="op">=</span> <span class="fl">5</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca_creature</span> <span class="op">&lt;-</span> <span class="fu">PCA</span><span class="op">(</span><span class="va">std_creature_df</span>, scale.unit <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    ncp <span class="op">=</span> <span class="fl">5</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Folgende Funktionen sind wichtig um die klassische Hauptkomponentenanalyse einmal zu visualisieren und zu bewerten. Die Namen folgen alle einem Schema im Paket <code>FactoMineR</code>, so dass wir hier nur Kleinigkeiten im Namen ändern müssen um alle Funktionen zu nutzen.</p>
<ul>
<li>
<code>get_pca_ind()</code>, <code>get_pca_var()</code>: Extrahiert die Ergebnisse für Individuen bzw. Variablen.</li>
<li>
<code>fviz_pca_ind()</code>, <code>fviz_pca_var()</code>: Visualisierung der Ergebnisse für Individuen bzw. Variablen.</li>
<li>
<code>fviz_pca_biplot()</code>: Erstellt einen Biplot der Individuen und Variablen.</li>
</ul></section><section id="ca---correspondence-analysis" class="level3" data-number="54.5.2"><h3 data-number="54.5.2" class="anchored" data-anchor-id="ca---correspondence-analysis">
<span class="header-section-number">54.5.2</span> CA - Correspondence Analysis</h3>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Spezialfall des <span class="math inline">\(\mathcal{X}^2\)</span>-Test
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die CA-Analyse funktioniert nur auf einer <span class="math inline">\(n \times k\)</span> Tabelle. Daher können wir nur zwei Variablen mit Kategorien miteinander in Verbindung setzen. Eigentlich sehen wir hier eher einen großen <span class="math inline">\(\mathcal{X}^2\)</span>-Test. Deshalb gehe ich aktuell nicht auf die Lösung hier tiefer ein.</p>
</div>
</div>
<p>Wir nutzen die <em>Correspondence Analysis</em> zur Analyse des Zusammenhangs zwischen zwei kategorialen Variablen. Also eher ein großer <span class="math inline">\(\mathcal{X}^2\)</span>-Test mit anderen Mitteln auf einer <span class="math inline">\(n \times k\)</span> Tabelle.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">CA</span><span class="op">(</span><span class="va">tbl</span>, ncp <span class="op">=</span> <span class="fl">5</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir erhalten alle wichtigen Informationen aus einer <em>Correspondence Analysis</em> mit den folgenden Funktionen.</p>
<ul>
<li>
<code>get_ca_row()</code>, <code>get_ca_col()</code>: Extrahiert die Ergebnisse für Zeilen bzw. Spalten.</li>
<li>
<code>fviz_ca_row()</code>, <code>fviz_ca_col()</code>: Visualisierung der Ergebnisse für Zeilen bzw. Spalten.</li>
<li>
<code>fviz_ca_biplot()</code>: Erstellt einen Biplot der Individuen und Variablen.</li>
</ul>
<p>Wir betrachteten den Fall hier nicht weiter, da er wirklich sehr speziell ist und nur selten vorkommt.</p>
</section><section id="mca---multiple-correspondence-analysis" class="level3" data-number="54.5.3"><h3 data-number="54.5.3" class="anchored" data-anchor-id="mca---multiple-correspondence-analysis">
<span class="header-section-number">54.5.3</span> MCA - Multiple Correspondence Analysis</h3>
<p>Wir nutzen die <em>Multiple Correspondence Analysis</em> für die Analyse eines Datensatzes mit kategorialen Variablen.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">MCA</span><span class="op">(</span><span class="va">tbl</span>, ncp <span class="op">=</span> <span class="fl">5</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir erhalten dann wiederum alle wichtigen Informationen und Abbildungen über folgende Funktionen.</p>
<ul>
<li>
<code>get_mca_ind()</code>, <code>get_mca_var()</code>: Extrahiert die Ergebnisse für Individuen bzw. Variablen.</li>
<li>
<code>fviz_mca_ind()</code>, <code>fviz_mca_var()</code>: Visualisierung der Ergebnisse für Individuen bzw. Variablen.</li>
<li>
<code>fviz_mca_biplot()</code>: Erstellt einen Biplot der Individuen und Variablen.</li>
</ul></section><section id="famd---factor-analysis-of-mixed-data" class="level3" data-number="54.5.4"><h3 data-number="54.5.4" class="anchored" data-anchor-id="famd---factor-analysis-of-mixed-data">
<span class="header-section-number">54.5.4</span> FAMD - Factor Analysis of Mixed Data</h3>
<p>Für die Analyse eines Datensatzes, der sowohl kontinuierlichen Variablen als auch kategorialen Variablen enthält nutzen wir die <em>Factor Analysis of Mixed Data</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">FAMD</span><span class="op">(</span><span class="va">tbl</span>, ncp <span class="op">=</span> <span class="fl">5</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Auch hier haben wir die wichtigen Funktionen für die Darstellung einmal dargestellt.</p>
<ul>
<li>
<code>get_famd_ind()</code>, <code>get_famd_var()</code>: Extrahiert die Ergebnisse für Individuen bzw. Variablen.</li>
<li>
<code>fviz_famd_ind()</code>, <code>fviz_famd_var()</code>: Visualisierung der Ergebnisse für Individuen bzw. Variablen.</li>
</ul></section><section id="mfa---multiple-factor-analysis" class="level3" data-number="54.5.5"><h3 data-number="54.5.5" class="anchored" data-anchor-id="mfa---multiple-factor-analysis">
<span class="header-section-number">54.5.5</span> MFA - Multiple Factor Analysis</h3>
<p>Komplexer wird es, wenn wir eine <em>Multiple Factor Analysis</em> durchführen wollen. In diesem Fall ist es die Analyse eines Datensatzes, der in Gruppen strukturierte Variablen enthält.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">MCA</span><span class="op">(</span><span class="va">X</span>, ncp <span class="op">=</span> <span class="fl">5</span>, graph <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Auch gibt es bei der <em>Multiple Factor Analysis</em> ein Set an Funktionen, die wir hauptsählcihc benötigen.</p>
<ul>
<li>
<code>get_mfa_ind()</code>, <code>get_mfa_var()</code>: Extrahiert die Ergebnisse für Individuen bzw. Variablen.</li>
<li>
<code>fviz_mfa_ind()</code>, <code>fviz_mfa_var()</code>: Visualisierung der Ergebnisse für Individuen bzw. Variablen.</li>
</ul>
<p>Weitere Funktionen finden sich dann noch auf der Tutoriumsseite zu der <a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/116-mfa-multiple-factor-analysis-in-r-essentials/">MFA - Multiple Factor Analysis</a>.</p>
</section></section><section id="darstellung-der-ergebnisse" class="level2 page-columns page-full" data-number="54.6"><h2 data-number="54.6" class="anchored" data-anchor-id="darstellung-der-ergebnisse">
<span class="header-section-number">54.6</span> Darstellung der Ergebnisse</h2>
<p>Im Folgenden betrachten wir dann die Hauptkomponentenanalyse auf drei Ebenen. Wir konzentrieren uns hier erstmal nur auf die Beispiele aus der Funktion <code>PCA()</code>. Prinzipiell sind die Analysen für die anderen Funktionen ähnlich und die Interpretation unterscheidet sich nur leicht.</p>
<ol type="1">
<li>
<em>Auf der Ebene der Eigenwerte:</em> Wir entscheiden, wie viele Hauptkomponenten wir eigentlich in die weitere Analyse nehmen wollen.</li>
<li>
<em>Auf der Ebene der Variablen:</em> Wir betrachten die Spalten und schauen wie sich die Spalten zueinander und den Beobachtungen verhalten. In der R Welt enden dann die Funktionen <code>*_var</code>.</li>
<li>
<em>Auf der Eben der Individuen</em>: Wir schauen uns einmal die Zeilen an und versuchen zu verstehen, wie sich die einzelenen Beobachtungen oder Individuen verhalten. Gibt es hier Auffälligkeiten? In der R Welt enden dann die Funktionen <code>*_ind</code>.</li>
</ol>
<section id="ebene-der-eigenwerte" class="level3 page-columns page-full" data-number="54.6.1"><h3 data-number="54.6.1" class="anchored" data-anchor-id="ebene-der-eigenwerte">
<span class="header-section-number">54.6.1</span> Ebene der Eigenwerte</h3>
<p>Die Eigenwerte messen die Menge der von jeder Hauptkomponente beibehaltenen Variation. Damit repräsentieren die Eigenwerte die Varianz/Kovarianzmatrix der Daten. Die Eigenwerte sind für die ersten Hauptkomponenten grundsätzlich groß und für die nachfolgenden Hauptkomponente immer kleiner. Das heißt, die ersten Hauptkomponente beschreiben Variablen mit der größten Variation im Datensatz. Wie schon gesagt, wir erschaffen neue Variablen aus den Daten, die wir Hauptkomponenten nennen. Jede Hauptkomponente hat einen Eigenwert, der beschreibt, wie viel Varianz die Hauptkomponente in den Daten erklären kann.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Auf welcher Matrix basieren die Eigenwerte der Hauptkomponeten?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Wenn du dich ein wenig mit Eigenwerten auskennst, dann weißt du, dass Eigenwerte immer auf einer Matrix berechnet werden. In unserem Fall werden die Eigenwerte der Hauptkomponeten auf der Varianz/Kovarianzmatrix der standardisierten Daten berechnet. Im Folgenden siehst du einmal die Varianz/Kovarianzmatrix <span class="math inline">\(\boldsymbol{\Sigma_x}\)</span> für die Datenmatrix <span class="math inline">\(x\)</span>. Wie du siehst, kann diese Matrix sehr groß werden. Du musst dir vorstellen, dass jedes <span class="math inline">\(x_1\)</span> bis <span class="math inline">\(x_n\)</span> jeweils eine Spalte in deiner Datenmatrix <span class="math inline">\(\boldsymbol{x}\)</span> entspricht. Damit hätte unser Tierdatensatz zum Beispiel <span class="math inline">\(x_1\)</span> bis <span class="math inline">\(x_5\)</span> und die Varianz/Kovarianzmatrix hätte fünf Zeilen und Spalten.</p>
<p><span class="math display">\[
\boldsymbol{\Sigma_x} = \begin{pmatrix}\operatorname{Var}(x_1) &amp; \operatorname{Cov}(x_1,x_2) &amp; \cdots &amp; \operatorname{Cov}(x_1,x_n) \\ \\
\operatorname{Cov}(x_2,x_1)  &amp; \operatorname{Var}(x_2) &amp; \cdots &amp; \operatorname{Cov}(x_2,x_n) \\ \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ \\
\operatorname{Cov}(x_n,x_1) &amp; \operatorname{Cov}(x_n,x_2) &amp; \cdots &amp; \operatorname{Var}(x_n)
\end{pmatrix}
\]</span></p>
<p>Hier einmal das Beispiel der Varianz/Kovarianzmatrix für den Datensatz <code>animals_df</code>. Wie du siehst liegen auf der Diagonalen die Varianzen. In dem Rest der Matrix findest du dann immer die Kovarainz zwischen den Variablen. Achtung, die Kovarianz ist nicht die Korrelation. Zwar bedeutet eine Kovarianz von 0, dass die beiden Variablen nichts miteinander zu tun haben, aber die Kovarianz ist nicht auf 1 skaliert. Wir können auch sehr viel größere Werte für die Kovarianz beobachten.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">animals_df</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               warm_blooded   fly vertebrate threatened live_in_groups  hair
warm_blooded           0.25 -0.03       0.18       0.14           0.10  0.07
fly                   -0.03  0.18      -0.05      -0.02          -0.04 -0.05
vertebrate             0.18 -0.05       0.21       0.10           0.08  0.01
threatened             0.14 -0.02       0.10       0.24           0.06 -0.04
live_in_groups         0.10 -0.04       0.08       0.06           0.24  0.04
hair                   0.07 -0.05       0.01      -0.04           0.04  0.26</code></pre>
</div>
</div>
<p>Für den Fall von zwei Variablen <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span> können wir die Idee der Kovarianz nochmal nachvollziehen. Später rechnen wir dann die Hauptkomponentenanalyse auf der großen Matrix, aber ich kann dir den Zusammenhang leider nur für zwei Variablen erklären, den zweidimensional kriege ich noch hin. Wir können mit folgender Formel die Kovarianzen zwischen den beiden Variablen <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span> berechnen.</p>
<p><span class="math display">\[
\operatorname{Cov}(x_2,x_1) = \sum_{i=1}^n(x_{1i}-\bar{x_1})(x_{2i}-\bar{x_2})
\]</span></p>
<p>Nochmal als Erinnerung, die Formel berechnet die quadrierten Abweichung der Beobachtungen von <span class="math inline">\(x_1\)</span> zum Mittelwert <span class="math inline">\(\bar{x}_1\)</span> und somit die Varianz <span class="math inline">\(\operatorname{Var}(x_1)\)</span> von <span class="math inline">\(x_1\)</span>.</p>
<p><span class="math display">\[
\operatorname{Var}(x_1) = \sum_{i=1}^n(x_{1i}-\bar{x}_1)^2
\]</span></p>
<p>Ebenso berechnet diese Formel die quadrierten Abweichung der Beobachtungen von <span class="math inline">\(x_2\)</span> zum Mittelwert <span class="math inline">\(\bar{x}_2\)</span> und damit die Varianz <span class="math inline">\(\operatorname{Var}(x_2)\)</span> von <span class="math inline">\(x_2\)</span>.</p>
<p><span class="math display">\[
\operatorname{Var}(x_2) = \sum_{i=1}^n(x_{2i}-\bar{x}_2)^2
\]</span></p>
<p>Das Ganze ist natürlich sehr trocken. Deshalb füttern wir einmal die Variablen <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span> mit echten Daten und erschaffen uns den Datensatz <code>cov_tbl</code>. In <a href="#tbl-pca-corr-example">Tabelle&nbsp;<span>54.3</span></a> ist der Zusammenhang nochmal Schritt für Schritt aufgeschlüsselt wie sich die Zahlen grob berechnen. Ich habe ein, zwei Schritte ausgelassen,a ber die ergänzt du fix selber.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cov_tbl</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>x_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.9</span>, <span class="fl">2.0</span>, <span class="fl">2.7</span>, <span class="fl">2.8</span><span class="op">)</span>,</span>
<span>                  x_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">1.8</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>, <span class="fl">2.6</span>, <span class="fl">1.8</span>, <span class="fl">2.7</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann können wir uns einmal den Mittelwert und die Varianz für die beiden Variablen <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span> berechnen und dann direkt in der <a href="#fig-pca-cov">Abbildung&nbsp;<span>54.4</span></a> verwenden.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cov_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">gather</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">key</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key    mean   var
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 x_1    1.77 0.642
2 x_2    1.87 0.339</code></pre>
</div>
</div>
<p>In der folgenden <a href="#fig-pca-cov">Abbildung&nbsp;<span>54.4</span></a> siehst du einmal die Konzepte der Varianz für <span class="math inline">\(x_1\)</span> in Subplot A und <span class="math inline">\(x_2\)</span> in Subplot B dargestellt. Die durchgezogene Linie stellt dabei den Mittelwert für die beiden Variablen dar. Die Varianz berechnet sich jetzt als der quadrierte Abstand von den Beobachtungen zu den Mittelwerten. Der Abstand ist als gestrichelte Linie dargestellt. Faktisch addierst du die sich ergebenden Quadrate auf. Bei der Kovarianz sind es keine Quadrate, sondern Rechtecke. Die berechnest nämlich einmal den Abstand einer Beobachtung zum Mittelwert von <span class="math inline">\(x_1\)</span> und einmal den Abstand zum Mittelwert von <span class="math inline">\(x_2\)</span>. Die beiden Abstände <span class="math inline">\((x_{1i}-\bar{x_1})\)</span> und <span class="math inline">\((x_{2i}-\bar{x_2})\)</span> multiplizierst du und addierst dann diese Rechtecke auf.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pca-cov" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-cov-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Abbildung&nbsp;54.4— Berechnung der Abstände für die Varianz von <span class="math inline">\(x_1\)</span> sowie <span class="math inline">\(x_2\)</span> in der oberen Zeile. In der unteren Zeile die Rechtecke der Berechnung der Kovarianz von <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span>.</figcaption></figure>
</div>
</div>
</div>
<p>In der folgenden <a href="#tbl-pca-corr-example">Tabelle&nbsp;<span>54.3</span></a> siehst du dann das Vorgehen nochmal numerisch. Wichtig ist hierbei, dass wir am Ende die Varianz und die Kovarianz berechnen können indem wir die Summen <span class="math inline">\(\sum\)</span> durch <span class="math inline">\(n-1\)</span> gleich 6 teilen.</p>
<div id="tbl-pca-corr-example" class="anchored">
<table class="table">
<caption>Tabelle&nbsp;54.3— Tabelle zur Berechnung der Varianz sowie der Kovarianz von <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span>.</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 31%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{x_1}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{x_2}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{(x_{2i}-\bar{x}_2)^2}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{(x_{1i}-\bar{x}_1)^2}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{(x_{1i}-\bar{x}_1)(x_{2i}-\bar{x}_2)}\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">0.8</td>
<td style="text-align: center;">0.94</td>
<td style="text-align: center;">0.45</td>
<td style="text-align: center;">0.65</td>
</tr>
<tr class="even">
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">0.60</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.06</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1.3</td>
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">0.33</td>
<td style="text-align: center;">0.33</td>
<td style="text-align: center;">0.33</td>
</tr>
<tr class="even">
<td style="text-align: center;">1.7</td>
<td style="text-align: center;">1.9</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2.6</td>
<td style="text-align: center;">2.0</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.53</td>
<td style="text-align: center;">0.17</td>
</tr>
<tr class="even">
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">0.86</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">-0.07</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">2.8</td>
<td style="text-align: center;">1.06</td>
<td style="text-align: center;">0.69</td>
<td style="text-align: center;">0.85</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\sum\)</span></td>
<td style="text-align: center;">3.86</td>
<td style="text-align: center;">2.05</td>
<td style="text-align: center;">1.97</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\cfrac{\sum}{n-1}\)</span></td>
<td style="text-align: center;">0.64</td>
<td style="text-align: center;">0.34</td>
<td style="text-align: center;">0.33</td>
</tr>
</tbody>
</table>
</div>
<p>Schauen wir mal, ob wir richtig gerechnet haben und die Varianz für <span class="math inline">\(x_1\)</span> mit 0.64, die Varianz von <span class="math inline">\(x_2\)</span> mit 0.34 sowie die Kovarianz von <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span> auch R wiederfinden. Wir nutzen die Funktion <code><a href="https://rdrr.io/r/stats/cor.html">cov()</a></code> um uns die Varianz/Kovarianzmatrix wiedergeben zu lassen.</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cov_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     x_1  x_2
x_1 0.64 0.33
x_2 0.33 0.34</code></pre>
</div>
</div>
<p>Wie wir sehen können wir die Werte in der Varianz/Kovarianzmatrix wiederfinden. Das ist ja mal ein Erfolg. Wir nutzen also die Varianz/Kovarianzmatrix als unsere Ähnlichkeitsmatrix, wie schon bei den Clusteranalysen, um hier unbekannte Zusammenhänge zwischen den Spalten und damit dann Hauptkomponenten aufzuklären.</p>
</div>
</div>
</div>
<p>Mit Hilfe der Eigenwerte lässt sich die Anzahl der Hauptkomponenten bzw. Dimensionen bestimmen, die nach der PCA beibehalten werden sollen. Wir wollen selten alle Hauptkomponenten berücksichtigen. Es geht hier ja auch darum die Dimensionen der Daten zu reduzieren. Wenn wir alle Hauptkomponenten weiterverwenden würden, dann könnten wir auch den ursprünglichen Datensatz nutzen. Die Eigenwerte und der Anteil der Varianzen, die von den Hauptkomponenten beibehalten werden, können mit folgenden Funktionen extrahiert werden.</p>
<ul>
<li>
<code>get_eigenvalue()</code>: Extrahiert die Eigenwerte/Varianzen der Hauptkomponenten</li>
<li>
<code>fviz_eig()</code>: Visualisierung der Eigenwerte</li>
</ul>
<p>Dabei bedeutet ein Eigenwert &gt; 1, dass die Hauptkomponenten mehr Varianz erklären als eine der ursprünglichen Variablen in den standardisierten Daten. Dies wird üblicherweise als Grenzwert für die Beibehaltung der Hauptkomponenten verwendet. Dies trifft nur zu, wenn die Daten standardisiert sind.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">eig_animals</span> <span class="op">&lt;-</span> <span class="fu">get_eigenvalue</span><span class="op">(</span><span class="va">pca_animals</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">eig_animals</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  eigenvalue variance.percent cumulative.variance.percent
       &lt;dbl&gt;            &lt;dbl&gt;                       &lt;dbl&gt;
1      2.54             42.3                         42.3
2      1.24             20.6                         62.9
3      0.848            14.1                         77.1
4      0.723            12.1                         89.1
5      0.515             8.58                        97.7
6      0.137             2.29                       100  </code></pre>
</div>
</div>
<p>Die Summe aller Eigenwerte für die Tiere ergibt eine Gesamtvarianz von 6. Jetzt können wir ganz einfach den Anteil der erklärten Varianz von jedem Eigenwert berechnen. In der zweiten Spalte finden wir dann die Werte der Eigenwerte geteilt durch die Gesamtvarianz. Daher ist <span class="math inline">\(42.35\)</span> gleich <span class="math inline">\(2.54\)</span> geteilt durch <span class="math inline">\(6\)</span>. Der kumulative Prozentsatz der erklärten Variation wird durch Addition der aufeinander folgenden Anteile der erklärten Variation ermittelt.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">eig_creature</span> <span class="op">&lt;-</span> <span class="fu">get_eigenvalue</span><span class="op">(</span><span class="va">pca_creature</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">eig_creature</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  eigenvalue variance.percent cumulative.variance.percent
       &lt;dbl&gt;            &lt;dbl&gt;                       &lt;dbl&gt;
1      1.99             66.2                         66.2
2      0.730            24.3                         90.5
3      0.285             9.49                       100  </code></pre>
</div>
</div>
<p>Die Summe aller Eigenwerte für die Kreaturen ergibt eine Gesamtvarianz von 3. Damit können wir dann auch einfach die anderen Werte in den Spalten nachvollziehen.</p>
<p>Jetzt stellt sich natürlich die Frage, wie viele der Hauptkomponenten sollen den jetzt zukünftig berücksichtigt werden? Leider gibt es keine allgemein anerkannte objektive Methode, um zu entscheiden, wie viele Hauptkomponenten ausreichend sind. Dies hängt von dem jeweiligen Anwendungsbereich und dem jeweiligen Datensatz ab. In der Praxis neigen wir dazu, die ersten paar Hauptkomponenten zu betrachten, um interessante Muster in den Daten zu finden. Dafür nutzen wir den Scree Plot und entscheiden anhand der <em>Beuge</em> in dem Plot. Wenn wir nur wenige Variablen in den Daten haben, dann kann es sein, dass wir nur wenige Hauptkomponenten raus schmeißen. In der <a href="#fig-cluster-pca-3">Abbildung&nbsp;<span>54.5</span></a> siehst du einmal die beiden Scree Plots für die beiden Datensätze.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">fviz_eig</span><span class="op">(</span><span class="va">pca_animals</span>, addlabels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">fviz_eig</span><span class="op">(</span><span class="va">pca_creature</span>, addlabels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-cluster-pca-3" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-pca-3-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-cluster-pca-3-1.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-pca-3" width="480"></p>
<figcaption class="figure-caption">(a) Richtung der Variablen (Spalten)</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-pca-3-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-cluster-pca-3-2.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-pca-3" width="480"></p>
<figcaption class="figure-caption">(b) Verteilung der Beobachtungen (Zeilen).</figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;54.5— Diagramm der PCA für die Variablen (Saplten) und den Beobachtungen (Zeilen) der Datenmatrix.</figcaption><p></p>
</figure>
</div>
</div>
<p>Wir sehen für die Tierdaten, dass die erste Hauptkomponente gut 42% der Varianz in den Daten erklärt, die folgende Hauptkomponente dann nur noch 20% und so weiter. Hier sehen wir dann auch die Beuge und könnten schließen, dass die ersten beiden Hauptkomponenten ausreichen um den Datensatz zu beschreiben. Bei den Kreaturendaten sieht es so aus, als ob wir die Datan alleinig mit der ersten Hauptkomponente erklären könnten. Wir sehen ja, dass gut 62% der Varianz durch die erste Hauptkomponente erklärt wird.</p>
</section><section id="ebene-der-variablen" class="level3 page-columns page-full" data-number="54.6.2"><h3 data-number="54.6.2" class="anchored" data-anchor-id="ebene-der-variablen">
<span class="header-section-number">54.6.2</span> Ebene der Variablen</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>get_*_var()</code> für andere Funktionen aus <code>FactoMineR</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Du kannst einfach das <code>*</code> in <code>get_*_var()</code> durch den klein geschriebenen Funktionaufruf von MCA, FAMD und MFA ersetzen um dir dann auch die Ergebnisse analog zu der PCA herausgeben zu lassen. Die Interpretation ist ähnlich bis gleich.</p>
</div>
</div>
<p>Schauen wir jetzt einmal die Informationen der Variablen also Spalten der Hauptkomponentenanalyse an. Wir erhalten jetzt also die Informationen zu den einzelnen Hauptkomponenten, die ja die Variablen bzw. Spalten der Daten repräsentieren. Wir erhalten die Informationen über die Funktion <code>get_pca_var()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">var_animals</span> <span class="op">&lt;-</span> <span class="fu">get_pca_var</span><span class="op">(</span><span class="va">pca_animals</span><span class="op">)</span></span>
<span><span class="va">var_creature</span> <span class="op">&lt;-</span> <span class="fu">get_pca_var</span><span class="op">(</span><span class="va">pca_creature</span><span class="op">)</span></span>
<span><span class="va">var_creature</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Component Analysis Results for variables
 ===================================================
  Name       Description                                    
1 "$coord"   "Coordinates for the variables"                
2 "$cor"     "Correlations between variables and dimensions"
3 "$cos2"    "Cos2 for the variables"                       
4 "$contrib" "contributions of the variables"               </code></pre>
</div>
</div>
<p>Schauen wir uns einmal an was wir mit den Informationen über die Variablen durch die Funktion <code>get_pca_var()</code> machen können.</p>
<ul>
<li>
<code>coord</code>: Koordinaten der Variablen zur Erstellung eines Streudiagramms. Wir nutzen meistens nur die ersten beiden Hauptkomponenten, da wir sonst kein zweidimensionalen Scatterplot machen können.</li>
<li>
<code>cor</code>: Die Korrelation zwischen den ursprünglichen Variablenwerten in den Zeilen und den neuen Hauptkomponenten in den Spalten.</li>
<li>
<code>cos2</code>: stellt die Qualität der Darstellung der Variablen auf der Faktorkarte dar. Es wird berechnet als die quadrierten Koordinaten: <code>cos2 = coord * coord</code>
</li>
<li>
<code>contrib:</code> enthält die Beiträge (in Prozent) der Variablen zu den Hauptkomponenten. Der Beitrag einer Variablen zu einer bestimmten Hauptkomponente ist (in Prozent): (<code>cos2</code> * 100) / (gesamter <code>cos2</code> der Komponente).</li>
</ul>
<p>Im Folgenden bewerten wir die Qualität einer Variable nach den <code>cos2</code>-Werten oder ihren Beitragswerten zu den Hauptkomponenten dargestellt durch die <code>contrib</code>-Werte. Wir nutzen hier jetzt aber erstmal die <code>cos2</code>-Werte, weil sonst hier alles an Abbildungen explodiert.</p>
<ul>
<li>Ein hoher cos2-Wert deutet auf eine gute Darstellung der Variablen auf der Hauptkomponente hin. In diesem Fall ist die Variable nahe am Umfang des Korrelationskreises positioniert.</li>
<li>Ein niedriger cos2-Wert zeigt an, dass die Variable nicht perfekt durch die PC’s repräsentiert ist. In diesem Fall befindet sich die Variable in der Nähe der Kreismitte.</li>
<li>Für eine bestimmte Variable ist die Summe des cos2 aller Hauptkomponenten gleich eins.</li>
</ul>
<p>In der <a href="#fig-pca-corrplot-cos2">Abbildung&nbsp;<span>54.6</span></a> sehen wir einmal die Zusammenhänge von den <code>cos2</code>-Werten und den jeweiligen Hauptkomponenten. Wir setzen <code>is.corr = FALSE</code>, weil wir keine Korrelation abbiden wollen sondern <code>cos2</code>-Werte.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">corrplot</span><span class="op">(</span><span class="va">var_animals</span><span class="op">$</span><span class="va">cos2</span>, is.corr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">corrplot</span><span class="op">(</span><span class="va">var_creature</span><span class="op">$</span><span class="va">cos2</span>, is.corr <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-corrplot-cos2" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-corrplot-cos2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-corrplot-cos2-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-corrplot-cos2" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-corrplot-cos2-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-corrplot-cos2-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-corrplot-cos2" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;54.6— Zusammenhang von den <code>cos2</code>-Werten und den jeweiligen Hauptkomponenten</figcaption><p></p>
</figure>
</div>
</div>
<p>Wir sehen bei den Tierdaten, dass die die erste Hauptkomponente <code>Dim.1</code> die Variablen <code>warm_blooded</code>, <code>vertebrate</code> und etwas weniger <code>threatened</code> und <code>live_in_groups</code> beschreibt. Die zweite Hauptkomponente <code>Dim.2</code> repräsentiert die Variable <code>hair</code>. Die dritte Hauptkomponente deckt <code>fly</code> ab. Die vierte Hauptkomponente beschreibt dann <code>live_groups</code> etwas stärker als die erste Hauptkomponente. Die fünfte Hauptkomponente können wir fast ignorieren. Bei den Kreaturendaten sehen wir das die erste Hauptkomponente fast alle Variablen repräsentiert. Die zweite Hauptkomponente beschreibt dann noch etwas <code>mass_grams</code> und <code>heart_rate_bpm</code>.</p>
<p>In der <a href="#fig-pca-fviz-cos2">Abbildung&nbsp;<span>54.7</span></a> sehen wir die gleichen Informationen nochmal als Säulendiagramm dargestellt. Hier ist es eventuell numerisch schöner und besser zu sehen, wie sich die <code>cos2</code>-Werte für die <em>erste und zweite</em> Hauptkomponente verhalten. Du musst hier nämlich entscheiden, wie viele Hauptkomponenten du <em>zusammen</em> betrachten willst. Hier habe ich über <code>axes = 1:2</code> die ersten beiden Hauptkomponenten gewählt.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">fviz_cos2</span><span class="op">(</span><span class="va">pca_animals</span>, choice <span class="op">=</span> <span class="st">"var"</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">fviz_cos2</span><span class="op">(</span><span class="va">pca_creature</span>, choice <span class="op">=</span> <span class="st">"var"</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-fviz-cos2" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-fviz-cos2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-fviz-cos2-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-fviz-cos2" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-fviz-cos2-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-fviz-cos2-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-fviz-cos2" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;54.7— Zusammenhang von den <code>cos2</code>-Werten und die ersten beiden Hauptkomponenten <code>Dim.1</code> und <code>Dim.2</code>.</figcaption><p></p>
</figure>
</div>
</div>
<p>Als nächstes wollen wir uns dann mal die ersten beiden Hauptkomponenten <code>Dim.1</code> und <code>Dim.2</code> in einer Abbildung anschauen. In der <a href="#fig-pca-var-1">Abbildung&nbsp;<span>54.8</span></a> sehen wir das Korrelationsdiagramm der Variablen für die ersten beiden Hauptkomponenten. Über die Option <code>axes =</code> kannst du dir auch andere Kombinationen von <em>zwei</em> Hauptkomponenten anschauen. Das Korrelationsdiagramm zeigt die Beziehungen zwischen allen Variablen und kann wie folgt interpretiert werden:</p>
<ul>
<li>Positiv korrelierte Variablen sind zusammen gruppiert.</li>
<li>Negativ korrelierte Variablen befinden sich auf gegenüberliegenden Seiten des Ursprungs der Grafik oder auch den gegenüberliegende Quadranten.</li>
<li>Der Abstand zwischen den Variablen und dem Ursprung misst die Qualität der Variablen im Bezug auf den erklärenden Anteil. Variablen, die vom Ursprung entfernt sind, sind bedeutender als Variablen nahe des Ursprungs.</li>
</ul>
<p>Wenn eine Variable nur durch zwei Hauptkomponenten, also zum Beispiel die <code>Dim.1</code> und die <code>Dim.</code>, perfekt repräsentiert wird, ist die Summe des <code>cos2</code> von diesen beiden Hauptkomponenten gleich eins. In diesem Fall werden die Variablen auf dem Korrelationskreis positioniert und der Pfeil geht damit vom Ursprung direkt zum Kreis. In <a href="#fig-pca-var-1-2">Abbildung&nbsp;<span>54.8 (b)</span></a> sind die Variablen <code>heart_rate_bpm</code> und <code>mass_grams</code> direkt auf dem Korrelationskreis. Daher sind diese beiden Variablen erklärend für einen Großteil der Varianz in den Daten. Für einige der Variablen sind möglicherweise mehr als 2 Komponenten erforderlich, um die Daten perfekt zu repräsentieren. In diesem Fall werden die Variablen innerhalb des Korrelationskreises positioniert, was wir eher in der <a href="#fig-pca-var-1-1">Abbildung&nbsp;<span>54.8 (a)</span></a> sehen. Variablen nahe des Zentrum haben keine Bedeutung für die beiden Hauptkomponenten. Je nach betrachteten Hauptkomponentenpaar kann es natürlich wieder anders aussehen.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">fviz_pca_var</span><span class="op">(</span><span class="va">pca_animals</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">fviz_pca_var</span><span class="op">(</span><span class="va">pca_creature</span>, repel <span class="op">=</span> <span class="cn">TRUE</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-var-1" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-1-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-1-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-1" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-1-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-1-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-1" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;54.8— Korrelationsdiagramm der Variablen.</figcaption><p></p>
</figure>
</div>
</div>
<p>Im Weiteren können wir diee cos2-Werte verwenden um die Qualität der Darstellung abzuschätzen. Es ist möglich, Variablen nach ihren <code>cos2</code>-Werten zu färben, indem du das Argument <code>col.var = "cos2"</code> verwendest und damit einen Farbverlauf erzeugst. Die Option <code>gradient.cols =</code> definiert dabei den Farbverlauf.</p>
<p>In der <a href="#fig-pca-var-2">Abbildung&nbsp;<span>54.9</span></a> siehst du nochmal die Einfärbung. Wie du sehen kannst, hat bei den Tierdaten <code>warm_blooded</code> den größten Einfluss auf die Aufteilung und erklärt auch am meisten Varianz der Daten. Die Variablen <code>fly</code> und <code>live_in_groups</code> helfen nicht um die Daten aufzutrennen und die Varianz zu erklären. Bei den Kreaturendaten sehen wir dann ebenfalls das es zwei Variablen gibt, die viel erklären und eine Variable mit einer schlechteren Qualität.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">fviz_pca_var</span><span class="op">(</span><span class="va">pca_animals</span>, col.var <span class="op">=</span> <span class="st">"cos2"</span>,</span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>, </span>
<span>             repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fviz_pca_var</span><span class="op">(</span><span class="va">pca_creature</span>, col.var <span class="op">=</span> <span class="st">"cos2"</span>,</span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>, </span>
<span>             repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-var-2" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-2-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-2" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-2-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-2-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-2" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;54.9— Korrelationsdiagramm der Variablen eingefärbt nach den cos2-Werten.</figcaption><p></p>
</figure>
</div>
</div>
<p>Wir können auch mit der <code><a href="https://rdrr.io/r/stats/kmeans.html">kmeans()</a></code> Funktion auch versuchen über die Koordinaten Gruppen zu bilden. Wir rechnen also auf den Koordinaten der Variablen eine Clusteranalyse. Faktisch könnten wir hier auch andere Clusteralgorithmen nehmen, aber ich nutze hier mal <code><a href="https://rdrr.io/r/stats/kmeans.html">kmeans()</a></code>. Im Prinzip kannst du den Algorithmus ändern, denn du brauchst später nur einen Faktor mit der Grupenzuordnung.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">grp_animal_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">var_animals</span><span class="op">$</span><span class="va">coord</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"cluster"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_factor</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir machen dann die Gruppenbildung auch für die Kreaturendaten. Hier dann nur zwei Gruppen, denn wir haben ja nur drei Variablen. Da machen dann drei Gruppen keinen Sinn.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">grp_creature_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">var_creature</span><span class="op">$</span><span class="va">coord</span>, centers <span class="op">=</span> <span class="fl">2</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"cluster"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_factor</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann nutzen wir die Gruppen einmal um nach diesen dann unseren Korrelaionsplot einzufärben. Wir sehen jetzt in diesen beiden Beipsielen in der <a href="#fig-pca-var-knn-1">Abbildung&nbsp;<span>54.10</span></a> kein so großen Änderungen oder Überraschungen. Aber je mehr Variablen du hast, desto spannender wird es dann auch.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">fviz_pca_var</span><span class="op">(</span><span class="va">pca_animals</span>, col.var <span class="op">=</span> <span class="va">grp_animal_var</span>, </span>
<span>             palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#0073C2FF"</span>, <span class="st">"#EFC000FF"</span>, <span class="st">"#868686FF"</span><span class="op">)</span>,</span>
<span>             legend.title <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fviz_pca_var</span><span class="op">(</span><span class="va">pca_creature</span>, col.var <span class="op">=</span> <span class="va">grp_creature_var</span>, </span>
<span>             palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#0073C2FF"</span>, <span class="st">"#EFC000FF"</span><span class="op">)</span>,</span>
<span>             legend.title <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-var-knn-1" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-knn-1-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-knn-1-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-knn-1" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-knn-1-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-knn-1-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-knn-1" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;54.10— Korrelationsdiagramm der Variablen eingefärbt den Gruppen aus dem k-NN Algorithmus zur Clusterbildung.</figcaption><p></p>
</figure>
</div>
</div>
<p>Abschließend wollen wir uns noch die Frage stellen, wie stark haben den jetzt die einzelnen Variablen zu den ersten beiden Hauptkomponenten beigetragen? Wir können dazu die Funktion <code>fviz_contrib()</code> nutzen. Die rote gestrichelte Linie in der <a href="#fig-pca-var-cont">Abbildung&nbsp;<span>54.11</span></a> zeigt den erwarteten durchschnittlichen Beitrag an. Wäre der Beitrag der Variablen bei den Tierdaten gleichmäßig, wäre der erwartete Wert <span class="math inline">\(1/n_{var} = 1/6 = 16\%\)</span>. Eine Variable mit einem Beitrag, der über diesem Grenzwert liegt, sehen wir als wichtig für die betrachteten Hauptkomponenten an.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">fviz_contrib</span><span class="op">(</span><span class="va">pca_animals</span>, choice <span class="op">=</span> <span class="st">"var"</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">fviz_contrib</span><span class="op">(</span><span class="va">pca_creature</span>, choice <span class="op">=</span> <span class="st">"var"</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-var-cont" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-cont-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-cont-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-cont" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-cont-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-cont-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-cont" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;54.11— Beitrag der einzelnen Variablen zu den ersten beiden Hauptkomponenten.</figcaption><p></p>
</figure>
</div>
</div>
</section><section id="ebene-der-individuen" class="level3 page-columns page-full" data-number="54.6.3"><h3 data-number="54.6.3" class="anchored" data-anchor-id="ebene-der-individuen">
<span class="header-section-number">54.6.3</span> Ebene der Individuen</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>get_*_ind()</code> für andere Funktionen aus <code>FactoMineR</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Du kannst einfach das <code>*</code> in <code>get_*_ind()</code> durch den klein geschriebenen Funktionaufruf von MCA, FAMD und MFA ersetzen um dir dann auch die Ergebnisse analog zu der PCA herausgeben zu lassen. Die Interpretation ist ähnlich bis gleich.</p>
</div>
</div>
<p>Nachdem wir uns die Informationen von den Variablen und damit die Informationen von den Spalten angeschaut haben, wollen wir uns nochmal die Informationen aus den Zeilen, also den Individuen anschauen. Auch hier können wir ja einfach mal schauen, wie die Individuen untereinander zusammenhängen. Wir arbeiten jetzt also mit den Informationen zu den einzelnen Individuen. Wir erhalten die Informationen über die Funktion <code>get_pca_var()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ind_animals</span> <span class="op">&lt;-</span> <span class="fu">get_pca_ind</span><span class="op">(</span><span class="va">pca_animals</span><span class="op">)</span></span>
<span><span class="va">ind_creature</span> <span class="op">&lt;-</span> <span class="fu">get_pca_ind</span><span class="op">(</span><span class="va">pca_creature</span><span class="op">)</span></span>
<span><span class="va">ind_creature</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Component Analysis Results for individuals
 ===================================================
  Name       Description                       
1 "$coord"   "Coordinates for the individuals" 
2 "$cos2"    "Cos2 for the individuals"        
3 "$contrib" "contributions of the individuals"</code></pre>
</div>
</div>
<p>Nachdem wir die Informationen zu den Individuen extrahiert haben, können wir uns die Koordinaten der einzelnen Individuen, die sich aus der Varianz/Kovarianzmatrix der Individuen ergeben, einmal in der <a href="#fig-pca-ind-1">Abbildung&nbsp;<span>54.12</span></a> anschauen. Wir interpretieren die <code>cos2</code>-Werte analog zu den Variablen. Das heißt, <code>cos2</code>-Werte geben an, wie bedeutend ein Individuum für die beiden Hauptkomponenten <code>Dim.1</code> und <code>Dim.2</code> ist. Wie sehen bei den Tierdaten, dass der Hering nichts zur Aufspaltung der Daten beiträgt. Die Tiere die weiter Außen liegen, haben mehr Informationen. Bei den Kreaturendaten sehen wir klar, dass der Hamster und der Wal nicht zu den anderen Tieren passen will. Beide Tiere pressen förmlich die anderen Tiere in den unteren linken Quadranten zusammen.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">fviz_pca_ind</span><span class="op">(</span><span class="va">pca_animals</span>,</span>
<span>             col.ind <span class="op">=</span> <span class="st">"cos2"</span>, </span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,</span>
<span>             repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">fviz_pca_ind</span><span class="op">(</span><span class="va">pca_creature</span>,</span>
<span>             col.ind <span class="op">=</span> <span class="st">"cos2"</span>, </span>
<span>             gradient.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,</span>
<span>             repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span>add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-ind-1" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-1-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-1-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-1" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-1-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-1-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-1" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;54.12— Streudiagramm der individuellen Beobachtungen für die ersten beiden Hauptkomponenten.</figcaption><p></p>
</figure>
</div>
</div>
<p>Wir können uns dann auch recht schnelle einmal die meisten bedeutenden Individuen für die ersten beiden Hauptkomponenten numerisch in der <a href="#fig-pca-ind-2">Abbildung&nbsp;<span>54.13</span></a> ansehen. Achtung, wir haben hier einige Individuen entfernt, die fehlende Werte in den Zeielne hatten. Da hätten wir vorher mal reagieren sollen, aber wir machen hier ja keine Imputation von fehlenden Werten. Die rote gestrichelte Linie zeigt den erwarteten durchschnittlichen Beitrag an. Wäre der Beitrag der Variablen gleichmäßig, wäre der erwartete Wert <span class="math inline">\(1/n_{ind}\)</span>. Für die ersten beiden Hauptkomponenten kann ein Individuum mit einem Beitrag, der über diesem Grenzwert liegt, als wichtig angesehen werden.</p>
<p>Auch hier sehen wir, dass die Fliege und der Tausendfüßler den größten Einfluss haben. Bei den Kreaturendaten ist es noch auffälliger, da liegt die gesamte Information der Daten in dem Wal und dem Hamster. Der Rest der Daten ist dagegen recht homogen. Hier siehst du auch, wie man die Hauptkomponentenanalyse zum Detektieren von Ausreißern nutzen kannst.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">fviz_contrib</span><span class="op">(</span><span class="va">pca_animals</span>, choice <span class="op">=</span> <span class="st">"ind"</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">fviz_contrib</span><span class="op">(</span><span class="va">pca_creature</span>, choice <span class="op">=</span> <span class="st">"ind"</span>, axes <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-ind-2" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-2-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-2" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-2-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-2-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-2" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;54.13— Beitrag der einzelnen Variablen zu den ersten beiden Hauptkomponenten.</figcaption><p></p>
</figure>
</div>
</div>
<p>Wie schon bei den Variablen können wir auch über das Koordinatensystem der Individuen Gruppen bilden. Wir rechnen auch hier eine Clusteranalyse mit der Funktion <code><a href="https://rdrr.io/r/stats/kmeans.html">kmeans()</a></code>. Wie auch schon vorab, kannst du auch hier dir einen anderen Clusteralgorithmus auswählen um die Gruppen zu bilden. Wir bleiben hier aber bei einem k-NN Algorithmus der uns einen Faktor mit der Gruppenzugehörigkeit wiedergibt.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">grp_animal_ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">ind_animals</span><span class="op">$</span><span class="va">coord</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"cluster"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_factor</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das Ganze dann auch nochmal für den Kreaturendatensatz. Hier können wir dann wiederum mehr als zwei Cluster wählen, da wir ja sehr viele Individuen haben, die wir in Gruppen einteilen können. Die Anzahl an Gruppen ist hier mit <code>k = 4</code> eher zufällig gewählt.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">grp_creature_ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">ind_creature</span><span class="op">$</span><span class="va">coord</span>, centers <span class="op">=</span> <span class="fl">4</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"cluster"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_factor</span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#fig-pca-ind-3">Abbildung&nbsp;<span>54.14</span></a> siehst du die Gruppen aus dm k-NN Algorithmus eingefärbt und Ellipsen um die Gruppen gezeichnet. Mit der Option <code>ellipse.type = "confidence"</code> kannst du dir auch Ellipsen mit dem Konfidenzbereich anzeigen lassen. Wir bleiben hier aber mal bei dem Standard der Funktion, der auch sonst genutzt wird. Ich habe mich dann noch dazu entschieden den Mittelpunkt der Ellipse mit <code>mean.point = FALSE</code> nicht anzeigen zu lassen. Wir können auch das <code>geom.ind</code> zu <code>text</code> ändern, dann werden nicht die Punkte sondern die Label der Individuen angezeigt.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">fviz_pca_ind</span><span class="op">(</span><span class="va">pca_animals</span>,</span>
<span>             geom.ind <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>             col.ind <span class="op">=</span> <span class="va">grp_animal_ind</span>, </span>
<span>             palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span><span class="op">)</span>,</span>
<span>             addEllipses <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>             legend.title <span class="op">=</span> <span class="st">"Groups"</span>, mean.point <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">fviz_pca_ind</span><span class="op">(</span><span class="va">pca_creature</span>,</span>
<span>             geom.ind <span class="op">=</span> <span class="st">"point"</span>, </span>
<span>             col.ind <span class="op">=</span> <span class="va">grp_creature_ind</span>, </span>
<span>             palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span>,</span>
<span>             addEllipses <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>             legend.title <span class="op">=</span> <span class="st">"Groups"</span>, mean.point <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-ind-3" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-3-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-3-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-3" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-3-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-3-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-3" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;54.14— Diagramm der PCA für die Variablen (Saplten) und den Beobachtungen (Zeilen) der Datenmatrix.</figcaption><p></p>
</figure>
</div>
</div>
<p>Tja, sieht dann etwas wild aus. Aber da musst du dann eben mit der Anzahl der Gruppen aus dem k-NN Algorithmus spielen. Auch siehst du, dass einzelne extreme Beobachtungen dir alles zunichte machen können. Hier müsste man überlegen, ob nicht der Wal und der Hamster bei den Kreaturendaten nicht eins zu viel sind. Jetzt stehen wir vor der Frage, passt das so? Was sind den die einzelnen Punkt für Beobachtungen? Da hilft uns dann die Funktion <code>fviz_pca_biplot()</code> weiter. Nicht alle Methoden der Hauptkomponentenanalyse können auch einen Biplot generieren, aber wenn, dann ist der Biplot sehr nützlich. In der <a href="#fig-pca-ind-4">Abbildung&nbsp;<span>54.15</span></a> siehst du den Biplot für die Tierdaten sowie für die Kreaturendaten sowie die Clusterinformationen ergänzt.</p>
<div class="page-columns page-full">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">fviz_pca_biplot</span><span class="op">(</span><span class="va">pca_animals</span>, </span>
<span>                col.ind <span class="op">=</span> <span class="va">grp_animal_ind</span>, </span>
<span>                col.var <span class="op">=</span> <span class="va">grp_animal_var</span>,</span>
<span>                addEllipses <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                palette <span class="op">=</span> <span class="st">"jco"</span>,</span>
<span>                label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"var"</span>, <span class="st">"ind"</span><span class="op">)</span>,</span>
<span>                repel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                legend.title <span class="op">=</span> <span class="st">"Species"</span>, mean.point <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">fviz_pca_biplot</span><span class="op">(</span><span class="va">pca_creature</span>, </span>
<span>                col.ind <span class="op">=</span> <span class="va">grp_creature_ind</span>, </span>
<span>                col.var <span class="op">=</span> <span class="va">grp_creature_var</span>,</span>
<span>                addEllipses <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"var"</span>, <span class="st">"ind"</span><span class="op">)</span>,</span>
<span>                repel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                legend.title <span class="op">=</span> <span class="st">"Species"</span>, mean.point <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-ind-4" class="cell column-page quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-4-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-4-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-4" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-4-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-4-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-4" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;54.15— Biplot für die Individuen und Variablen eingefäerbt nach Clustern.</figcaption><p></p>
</figure>
</div>
</div>
<p>Bei den Tierdaten passe es eigentlich ganz gut mit den Clustern, aber die Inhalte machen teilweise nicht so viel Sinn. Wir haben Tiere zusammen gruppiert, die eigentlich nicht so richtig zusammen passsen. Zwar sind in der einen Gruppe die Insekten aber der Elefant ist zusammen mit dem Wal, dem Delphin und dem Adler sowie der Ente gruppiert. Da reichen anscheinend die Daten und Variablen noch nicht aus um hier eine gute Trennung hinzukriegen. Immerhin passt es auch mit den Säugetieren. Du siehst hier auch gut, wie die Vektoren in die Richtung der passenden Individuen zeigen. So sind die haarigen Individuen dann unten rechts. Das passt ganz gut. Bei den Kreaturendaten siehst du auch schön, wie der Wal die Variable <code>mass_grams</code> nach oben rechst zu sich zieht. Auch die Variable der Lebendauer zieht den Elefanten und den Menschen nach rechts weg.</p>
</section></section><section id="multi-dimensional-scaling-mds" class="level2" data-number="54.7"><h2 data-number="54.7" class="anchored" data-anchor-id="multi-dimensional-scaling-mds">
<span class="header-section-number">54.7</span> Multi Dimensional Scaling (MDS)</h2>
<p>Eine besondere Form der Hauptkomponentenanalyse ist das <em>Multidimensional Scaling</em> (abk. MDS). Im Prinzip sind die Mechanismen sehr ähnlich. Der Hauptunterschied ist aber, das wir für die MDS eine Distanzmatrix benötigen. Wir können dafür die Funktion <code><a href="https://rdrr.io/r/stats/dist.html">dist()</a></code> oder <code><a href="https://rdrr.io/r/stats/dist.html">as.dist()</a></code> nehmen, wenn wir schon Distanzen vorliegen haben. Nehmen wir als plakatives Beispiel einmal die Distanzen von europäischen Städten zueinander. Wir haben die Daten in der Exceldatei <code>distance.xlsx</code> vorliegen. Wir lesen die Daten einmal ein und schauen uns die ersten fünf Spalten und die ersten fünf Zeilen des Daten<em>satzes</em> einmal an.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">distance_tbl</span> <span class="op">&lt;-</span> <span class="fu">read_excel</span><span class="op">(</span><span class="st">"data/distance.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">distance_tbl</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  city      Amsterdam Antwerp Athens Barcelona
  &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
1 Amsterdam         0     160   3082      1639
2 Antwerp         160       0   2766      1465
3 Athens         3082    2766      0      3312
4 Barcelona      1639    1465   3312         0
5 Berlin          649     723   2552      1899</code></pre>
</div>
</div>
<p>Wenn wir jetzt auf diesem Datensatz jetzt ein MDS rechnen wollen, dann müssen wir zum einen alle Spalten mit einem <code>character</code> entfernen. Wir haben dann nur noch einen Datensatz bzw. Datenmatrix mit den Distanzen vorliegen. Dann kann wir das <code>tibble</code> in einen <code>dist</code>-Objekt mit der Funktion <code><a href="https://rdrr.io/r/stats/dist.html">as.dist()</a></code> umwandeln. Die eigentliche Berechnung für das <em>Multidimensional Scaling</em> findet in der Funktion <code><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale()</a></code> statt. Mit der Option <code>k = 2</code> legen wir fest, dass wir nur zwei Hauptkomponenten bzw. Dimensionen bestimmen wollen. Wir machen also aus unserem 37x37 großen Datenmatrix durch <em>Multidimensional Scaling</em> eine Reduktion auf zwei Dimensionen bzw. Spalten.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mds</span> <span class="op">&lt;-</span> <span class="va">distance_tbl</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">city</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>          </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>V1 <span class="op">=</span> <span class="op">-</span><span class="va">V1</span>,</span>
<span>         V2 <span class="op">=</span> <span class="op">-</span><span class="va">V2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mds</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dim.1"</span>, <span class="st">"Dim.2"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <a href="#fig-mds-1">Abbildung&nbsp;<span>54.16</span></a> sehen wir das Ergebnis der Dimensionsreduktion auf zwei Dimensionen. Wir erhalten die Zusammenhänge bzw. Distanzen aus der Datenmatrix in einem Scatterplot. Ein Scatterplot ist ja nichts anders als die Darstellung von zwei Dimensionen. Wie wir sehen können nimmt die Anordnung der Orte in etwa die Positionen von den Orten auf der Landkarte in Europa ein. Natürlich stimmen die Relationen nicht perfekt, aber das Abbild ist schon recht nahe dran. Wir können also auf diese Art und Weise auch Ausreißer bestimmen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggscatter</span><span class="op">(</span><span class="va">mds</span>, x <span class="op">=</span> <span class="st">"Dim.1"</span>, y <span class="op">=</span> <span class="st">"Dim.2"</span>, </span>
<span>          label <span class="op">=</span> <span class="va">distance_tbl</span><span class="op">$</span><span class="va">city</span>,</span>
<span>          size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mds-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-mds-1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Abbildung&nbsp;54.16— Scatterplot der zwei Dimensionen nach dem <em>Multidimensional Scaling</em> für den Abstand europäischer Städte.</figcaption></figure>
</div>
</div>
</div>
<p>Wenn wir keine Distanzmatrix wie im obigen Beispiel zu den Entfernungen der europäischen Städte vorliegen haben, dann können wir uns die Distanzen auch mit der Funktion <code><a href="https://rdrr.io/r/stats/dist.html">dist()</a></code> berechnen lassen. Wir nutzen jetzt mal als Echtdaten die Daten der Gummibärchen. Mal sehen, ob wir hier irgendwelche Gruppen erkennen. Die Hilfeseite der Funktion <code><a href="https://rdrr.io/r/stats/dist.html">?dist</a></code> zeigt welche mathematischen Distanzmaße wir auf die Daten anwenden können. In unseren Fall berechnen wir die euklidische Distanz zwischen den Beobachtungen. Dann rufen wir über die Funkion <code>cmdsscale</code> das <em>Multidimensional Scaling</em> auf.</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mds</span> <span class="op">&lt;-</span> <span class="va">animals_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span> <span class="op">%&gt;%</span>          </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">set_names</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Dim.1"</span>, <span class="st">"Dim.2"</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das Ergebnis des <em>Multidimensional Scaling</em> hat keine Bedeutung für uns. Wir können die Zahlen nicht interpretieren. Was wir können ist das Ergebnis in einem Scatterplot wie in <a href="#fig-mds-2">Abbildung&nbsp;<span>54.17</span></a> zu visualisieren.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggscatter</span><span class="op">(</span><span class="va">mds</span>, x <span class="op">=</span> <span class="st">"Dim.1"</span>, y <span class="op">=</span> <span class="st">"Dim.2"</span>, </span>
<span>          label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">animals_df</span><span class="op">)</span>,</span>
<span>          size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mds-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-mds-2-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Abbildung&nbsp;54.17— Scatterplot der zwei Dimensionen nach dem <em>Multidimensional Scaling</em> für den Gummibärchendatensatz.</figcaption></figure>
</div>
</div>
</div>
<p>Na endlich, wir sehen mal eine Gruppe von Beobachtungen oder Ausreißern, die nicht in der Wolke aller Beobachtungen liegen. Beobachtungen mit einem Wert kleiner <span class="math inline">\(-20\)</span> in der 2. Dimension könnten wir dann als Ausreißer entfernen. Der Rest bildet dann eine recht homogene Gruppe. Wir können uns aber auch das <span class="math inline">\(k\)</span>-NN Verfahren aus dem <a href="classification-knn.html"><span>Kapitel&nbsp;62</span></a> nutzen um Cluster in den Daten zu finden. Das heißt wir nutzen das maschinelle Lernverfahren <span class="math inline">\(k-NN\)</span> um uns <span class="math inline">\(k\)</span> Cluster bestimmen zu lassen. Dafür nutzen wir die Funktion <code><a href="https://rdrr.io/r/stats/kmeans.html">kmeans()</a></code> und ziehen uns über die Funktion <code>pluck()</code> die Cluster raus. Daher erhalten wir einen Vektor mit Zahlen, die beschreiben in welchem Cluster die jeweilige <span class="math inline">\(i\)</span>-te Beobachtung ist.</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># K-means clustering</span></span>
<span><span class="va">clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">mds</span>, centers <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"cluster"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir wollen jetzt unser MDS Ergebnis von den Gummibärchen um eine Spalte für die Clusterergebnisse von <span class="math inline">\(k\)</span>-NN ergänzen.</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mds</span> <span class="op">&lt;-</span> <span class="va">mds</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>groups <span class="op">=</span> <span class="va">clust</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nun sehen in <a href="#fig-mds-3">Abbildung&nbsp;<span>54.18</span></a> die gleiche Abbildung wie oben nur ergänzt um die farbliche Hinterlegung der <span class="math inline">\(k=5\)</span> Clustern aus dem <span class="math inline">\(k\)</span>-NN Algorithmus. Wir können jetzt die Ausreißer numerisch feststellen und dann aus den Daten entfernen, wenn wir dies wollen würden. Entweder machen wir das über die Clusterzuordnung vom gelben Cluster 2 über die Funktion <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> oder aber wir suchen uns die Beobachtungen und damit Zeilen raus, die wir nicht mehr in den Daten wollen. Die Nummern stehen ja dabei.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggscatter</span><span class="op">(</span><span class="va">mds</span>, x <span class="op">=</span> <span class="st">"Dim.1"</span>, y <span class="op">=</span> <span class="st">"Dim.2"</span>, </span>
<span>          label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">animals_df</span><span class="op">)</span>,</span>
<span>          color <span class="op">=</span> <span class="st">"groups"</span>,</span>
<span>          palette <span class="op">=</span> <span class="st">"jco"</span>,</span>
<span>          size <span class="op">=</span> <span class="fl">1</span>, </span>
<span>          ellipse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          ellipse.type <span class="op">=</span> <span class="st">"convex"</span>,</span>
<span>          repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mds-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="stat-modeling-pca_files/figure-html/fig-mds-3-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Abbildung&nbsp;54.18— Scatterplot der zwei Dimensionen nach dem <em>Multidimensional Scaling</em> für den Gummibärchendatensatz mit den <span class="math inline">\(k=5\)</span> Clustern aus dem <span class="math inline">\(k\)</span>-NN Algorithmus.</figcaption></figure>
</div>
</div>
</div>
</section><section id="referenzen" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-kassambara2017practical" class="csl-entry" role="listitem">
Kassambara, Alboukadel. 2017. <em>Practical guide to principal component methods in R: PCA, M (CA), FAMD, MFA, HCPC, factoextra</em>. Bd. 2. Sthda.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./stat-modeling-cluster.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./experimental-design-preface.html" class="pagination-link">
        <span class="nav-page-text">Experimentelles Design</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>
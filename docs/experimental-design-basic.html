<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Skript Bio Data Science - 55&nbsp; Einfache Designs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./experimental-design-advanced.html" rel="next">
<link href="./experimental-design-r.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken"
  }
}</script><meta name="mermaid-theme" content="neutral">
<script src="site_libs/quarto-diagram/mermaid.min.js"></script><script src="site_libs/quarto-diagram/mermaid-init.js"></script><link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./experimental-design-preface.html">Experimentelles Design</a></li><li class="breadcrumb-item"><a href="./experimental-design-basic.html"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Einfache Designs</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Skript Bio Data Science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Literatur</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Buchstaben und Zahlen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ein <code>purrr</code> Cookbook</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Frequentistische Hypothesentests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Pre-Tests oder Vortest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Multiple Vergleiche oder Post-hoc Tests</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen der linearen Regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Maßzahlen der Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Imputation fehlender Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelles Design</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
<li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">55.1</span> Genutzte R Pakete</a></li>
  <li>
<a href="#sec-crd" id="toc-sec-crd" class="nav-link" data-scroll-target="#sec-crd"><span class="header-section-number">55.2</span> Complete randomized design (CRD)</a>
  <ul class="collapse">
<li><a href="#mit-expand_grid" id="toc-mit-expand_grid" class="nav-link" data-scroll-target="#mit-expand_grid"><span class="header-section-number">55.2.1</span> … mit <code>expand_grid()</code></a></li>
  <li><a href="#mit-agricolae" id="toc-mit-agricolae" class="nav-link" data-scroll-target="#mit-agricolae"><span class="header-section-number">55.2.2</span> … mit <code>agricolae</code></a></li>
  </ul>
</li>
  <li>
<a href="#sec-rcbd" id="toc-sec-rcbd" class="nav-link" data-scroll-target="#sec-rcbd"><span class="header-section-number">55.3</span> Randomized complete block design (RCBD)</a>
  <ul class="collapse">
<li><a href="#mit-expand_grid-1" id="toc-mit-expand_grid-1" class="nav-link" data-scroll-target="#mit-expand_grid-1"><span class="header-section-number">55.3.1</span> … mit <code>expand_grid()</code></a></li>
  <li><a href="#mit-agricolae-1" id="toc-mit-agricolae-1" class="nav-link" data-scroll-target="#mit-agricolae-1"><span class="header-section-number">55.3.2</span> … mit <code>agricolae</code></a></li>
  </ul>
</li>
  <li>
<a href="#sec-lsd" id="toc-sec-lsd" class="nav-link" data-scroll-target="#sec-lsd"><span class="header-section-number">55.4</span> Latin square design (LSD)</a>
  <ul class="collapse">
<li><a href="#mit-agricolae-2" id="toc-mit-agricolae-2" class="nav-link" data-scroll-target="#mit-agricolae-2"><span class="header-section-number">55.4.1</span> … mit <code>agricolae</code></a></li>
  <li><a href="#mit-dae" id="toc-mit-dae" class="nav-link" data-scroll-target="#mit-dae"><span class="header-section-number">55.4.2</span> … mit <code>dae</code></a></li>
  </ul>
</li>
  <li>
<a href="#spezialf%C3%A4lle" id="toc-spezialfälle" class="nav-link" data-scroll-target="#spezialf%C3%A4lle"><span class="header-section-number">55.5</span> Spezialfälle</a>
  <ul class="collapse">
<li><a href="#sec-alpha" id="toc-sec-alpha" class="nav-link" data-scroll-target="#sec-alpha"><span class="header-section-number">55.5.1</span> Alpha design</a></li>
  <li><a href="#sec-augment" id="toc-sec-augment" class="nav-link" data-scroll-target="#sec-augment"><span class="header-section-number">55.5.2</span> Augmented design</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-experimental-design-basic" class="quarto-section-identifier"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p><em>Version vom September 04, 2023 um 10:54:37</em></p>
<blockquote class="blockquote">
<p><em>“This is my favorite part about analytics: Taking boring flat data and bringing it to life through visualization.” — John Tukey”</em></p>
</blockquote>
<p>In diesem Kapitel wollen wir uns mit der Erstellung von einfachen experimentellen Designs beschäftigen. Dementsprechend schauen wir uns nur die drei folgenden Designs hier in diesem Kapitel an.</p>
<ul>
<li><a href="#sec-crd">Complete randomized design (CRD)</a></li>
<li><a href="#sec-rcbd">Randomized complete block design (RCBD)</a></li>
<li><a href="#sec-lsd">Latin square design (LSD)</a></li>
</ul>
<p>Als Spezialfälle dann noch folgende Designs am Ende des Kapitels.</p>
<ul>
<li><a href="#sec-alpha">Alpha design</a></li>
<li><a href="#sec-augment">Augmented design</a></li>
</ul>
<p>Dabei werden wir verschiedene Wege gehen. Leider geht es hier wirklich nicht mehr ohne eine Idee der Programmierung in R. Sonst kannst du leider dem Kapitel nicht folgen. Bitte schau auch nochmal in das vorherige Kapitel zur <a href="experimental-design-r.html">Versuchsplanung in R</a>. Wir schauen uns jetzt einmal die einfache Umsetzung händisch an, dann einmal in dem R Paket <code>agricolae</code> und abschließend in dem R Paket <code>dae</code>. Nicht immer ist alles möglich, mal ist es dann händisch zu kompliziert oder aber eines der Pakete bietet das experimentelle Design nicht an - oder ich habe es nicht gefunden.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Ein Teil der Beispiele basiert auf <a href="https://schmidtpaul.github.io/DSFAIR/DesigningExperiments.html">DSFAIR von P. Schmidt</a> und wurde von mir angepasst und vereinfacht. Hier findet sich auch weiterführende Literatur und weitere Beispiele.</p>
</div></div><p>In dem nachfolgenden Kapitel zu den fortgeschrittenen Designs findest du dann noch mehr experimentelle Designs und wie du diese Designs in R generieren kannst. Dieses Kapitel sollte aber ausreichen um einfache Projekte im Rahmen einer Abschlussarbeit oder einem Studienprojekt zu planen.</p>
<p>Auch findest du im <a href="https://www.statforbiology.com/_statbookeng/designing-experiments#selecting-the-units-within-the-field">Chapter 2 Designing experiments</a> aus <a href="https://www.statforbiology.com/_statbookeng/">Experimental methods in agriculture</a> noch schöne Beispiele und photographische Abbildungen für experimentelle Designs.</p>
<section id="genutzte-r-pakete" class="level2" data-number="55.1"><h2 data-number="55.1" class="anchored" data-anchor-id="genutzte-r-pakete">
<span class="header-section-number">55.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2034</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>, <span class="va">magrittr</span>, <span class="va">dae</span>, <span class="va">agricolae</span>,</span>
<span>               <span class="va">conflicted</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"select"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"filter"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"mutate"</span>, <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="fu">conflict_prefer</span><span class="op">(</span><span class="st">"set_names"</span>, <span class="st">"magrittr"</span><span class="op">)</span></span>
<span><span class="va">cbbPalette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#999999"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Am Ende des Kapitels findest du nochmal den gesamten R Code in einem Rutsch zum selber durchführen oder aber kopieren.</p>
</section><section id="sec-crd" class="level2" data-number="55.2"><h2 data-number="55.2" class="anchored" data-anchor-id="sec-crd">
<span class="header-section-number">55.2</span> Complete randomized design (CRD)</h2>
<p>Das komplett randomisierte Design ist sicherlich das einfachste Design. Aber auch das praktischste, wenn du ein gar nicht so komplexes Experiment hast. Im PRinzip hast du nur eine Behandlung mit unterschiedlichen Gruppen. Oder allgemeiner gesprochen, du hast einen Faktor <span class="math inline">\(f_1\)</span>, der deine Behandlungen beinhaltet. Du kannst viele Behandlungen haben, die dann als Level des Faktors dargestellt werden. Wir gehen jetzt das <em>complete randomized design</em> einmal an einem Beispiel durch. Hier einmal für eine Behandlung <code>trt</code> mit vier Leveln oder auch Gruppen <code>ctrl</code>, <code>A</code>, <code>B</code> und <code>C</code> sowie als Outcome das Trockengewicht <code>drymatter</code>. Das Outcome müssen wir gar nicht weiter beachten, es dient nur als Gedankenstütze.</p>
<p>Wir haben also folgendes Modell, was wir dann in einem Design abbilden wollen.</p>
<p><span class="math display">\[
drymatter \sim \overbrace{trt}^{f_1}
\]</span></p>
<p>mit</p>
<ul>
<li>dem Faktor Behandlung <code>trt</code> und den vier Behandlungsstufen als Level <code>ctrl</code>, <code>A</code>, <code>B</code> und <code>C</code>.</li>
</ul>
<p>Jetzt ist nur noch die Frage, wie oft wollen wir jede Behandlung wiederholen (eng. <em>replicate</em>). Wir entscheiden uns dafür jeweils 4 Pflanzen pro Behandlungsgruppe zu verwenden. Damit haben wir vier Wiederholungen für vier Behandlungsgruppen und somit insgesamt zwanzig Pflanzen oder auch Beobachtungen.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modell zur Auswertung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir rechnen ein simples lineares Modell für die statistische Analyse.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">drymatter</span> <span class="op">~</span> <span class="va">trt</span>, data <span class="op">=</span> <span class="va">crd_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Randomisierung kurz und schmerzlos
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Wenn du für deine zwanzig Pflanzen nur ein Randomisierungmuster brauchst, dann empfehle ich dir die Folgende schnelle Art und Weise. Du nimmst die Zahlen von 1 bis 20 und mischt die Zahlen einmal mit der Funktion <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code> durch. Dann erstellst du dir als dein Grid für deine Pflanzen mit einer <span class="math inline">\(4 \times 5\)</span>-Matrix und pflanzt nach diesem Grid die Pflanzen ein. Das war es dann und du bist durch.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">5</span>,</span>
<span>         dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu">str_c</span><span class="op">(</span><span class="st">"Reihe"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span>,</span>
<span>                         <span class="fu">str_c</span><span class="op">(</span><span class="st">"Spalte"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Spalte-1 Spalte-2 Spalte-3 Spalte-4 Spalte-5
Reihe-1       20        5        6       18       12
Reihe-2       11        1        8       15       10
Reihe-3        9        3       14       17       16
Reihe-4       13        2        7       19        4</code></pre>
</div>
</div>
</div>
</div>
</div>
<section id="mit-expand_grid" class="level3" data-number="55.2.1"><h3 data-number="55.2.1" class="anchored" data-anchor-id="mit-expand_grid">
<span class="header-section-number">55.2.1</span> … mit <code>expand_grid()</code>
</h3>
<p>Warum kompliziert, wenn es auch einfach geht. Wir nutzen hier einmal die Funktion <code>expand_grid()</code> um uns das <em>complete randomized design</em> zu erstellen. Die Randomisierung kommt dann über das <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code> und der Pflanzenidentifikationsnummer <code>pid</code>. Das geht super einfach und wir brauchen auch gar keine anderen höheren Funktionen von komplexeren R Paketen. Die Spalte <code>trt_rep</code> wird uns später helfen die Beobachtung dann in dem Grid der Pflanzenposition auf dem Tisch wiederzufinden.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">crd_long_tbl</span> <span class="op">&lt;-</span> <span class="fu">expand_grid</span><span class="op">(</span>trt <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, rep <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">trt</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ctrl"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         rep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">rep</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/roman.html">as.roman</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         trt_rep <span class="op">=</span> <span class="fu">str_c</span><span class="op">(</span><span class="va">trt</span>, <span class="st">"."</span>, <span class="va">rep</span><span class="op">)</span>,</span>
<span>         pid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co">## Randomsierung über alles</span>s</span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">pid</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">crd_long_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 x 4
     pid trt   rep   trt_rep 
   &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;chr&gt;   
 1     8 ctrl  I     ctrl.I  
 2     9 ctrl  II    ctrl.II 
 3     7 ctrl  III   ctrl.III
 4    12 ctrl  IV    ctrl.IV 
 5    10 A     I     A.I     
 6    16 A     II    A.II    
 7    14 A     III   A.III   
 8     4 A     IV    A.IV    
 9     3 B     I     B.I     
10    15 B     II    B.II    
11     1 B     III   B.III   
12    11 B     IV    B.IV    
13     5 C     I     C.I     
14    13 C     II    C.II    
15     6 C     III   C.III   
16     2 C     IV    C.IV    </code></pre>
</div>
</div>
<p>Dann kannst du dir die Datei mit der Funktion <code>write_xlsx()</code> aus dem R Paket <code>writexl</code> raus schreiben und dann entsprechend mit deinen Messwerten für das Trockengewicht ergänzen.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">crd_long_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">write_xlsx</span><span class="op">(</span><span class="st">"template_sheet.xlsx"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Für die Visualisierung fehlt uns jetzt noch die Positionsangaben auf dem Feld. Daher bauen wir uns einmal ein Grid der Reihen <code>rows</code> und der Spalten <code>cols</code>. Das Grid können wir dann mit den nach den Pflanzen-ID’s sortieren Design zusammenbringen. Damit haben wir dann eigentlich schon fast alles zusammen.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">crd_plot_tbl</span> <span class="op">&lt;-</span> <span class="va">crd_long_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">pid</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">bind_cols</span><span class="op">(</span><span class="fu">expand_grid</span><span class="op">(</span>row <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">crd_plot_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 x 6
     pid trt   rep   trt_rep    row   col
   &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;chr&gt;    &lt;int&gt; &lt;int&gt;
 1     1 B     III   B.III        1     1
 2     2 C     IV    C.IV         1     2
 3     3 B     I     B.I          1     3
 4     4 A     IV    A.IV         1     4
 5     5 C     I     C.I          2     1
 6     6 C     III   C.III        2     2
 7     7 ctrl  III   ctrl.III     2     3
 8     8 ctrl  I     ctrl.I       2     4
 9     9 ctrl  II    ctrl.II      3     1
10    10 A     I     A.I          3     2
11    11 B     IV    B.IV         3     3
12    12 ctrl  IV    ctrl.IV      3     4
13    13 C     II    C.II         4     1
14    14 A     III   A.III        4     2
15    15 B     II    B.II         4     3
16    16 A     II    A.II         4     4</code></pre>
</div>
</div>
<p>Jetzt können wir uns einmal das Grid der Pflanzungen in der <a href="#fig-exp-basic-1">Abbildung&nbsp;<span>55.1</span></a> einmal anschauen. Wir nutzen hier die Möglichkeiten des R Pakets <code>desplot</code>. Hier wird es dann nochmal klarer wo die Pflanzen eigentlich hin sollen. Du kannst dir dann den Tisch so einteilen, dass eben oben links die vierte Wiederholung der Behandlung <code>B</code> steht. Dann steht rechts daneben die zweite Wiederholung der Behandlung <code>C</code>. Nach der Ernte bestimmst du dann das Trockengewicht und trägst es in die Exceltabelle ein.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">desplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">crd_plot_tbl</span>, </span>
<span>        form <span class="op">=</span> <span class="va">trt</span> <span class="op">~</span> <span class="va">col</span> <span class="op">+</span> <span class="va">row</span>,</span>
<span>        text <span class="op">=</span> <span class="va">trt_rep</span>, cex <span class="op">=</span> <span class="fl">1</span>, show.key <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>        shorten <span class="op">=</span> <span class="st">"no"</span>, flip <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Pflanzschema für ein complete randomized design"</span><span class="op">)</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exp-basic-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="experimental-design-basic_files/figure-html/fig-exp-basic-1-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;55.1— Schema der Pflanzungen nach den Behandlungen für das <em>complete randomized design</em>.</figcaption></figure>
</div>
</div>
</div>
<p>Das war jetzt die schnelle Variante mit <code>expand_grid()</code> und der anschließenden Visualisierung mit einem Plan für die Positionen der jeweiligen Beobachtungen.</p>
</section><section id="mit-agricolae" class="level3" data-number="55.2.2"><h3 data-number="55.2.2" class="anchored" data-anchor-id="mit-agricolae">
<span class="header-section-number">55.2.2</span> … mit <code>agricolae</code>
</h3>
<p>Als Alternative bietet sich dann auch das R Paket <code>agricolae</code> an, obwohl ich für so einfaches Design nicht <code>agricolae</code> empfehlen kann. Wir haben nämlich so ein paar gewünschte Eigenschaften und damit musst du etwas programmieren um gut mit dem Paket umgehen zu können. Wir nutzen hier die Funktion <code>design.crd()</code> um uns das Design eines <em>complete randomized design</em> zu erstellen. Die Funktion benötigt einen Vektor mit den Namen der Behandlungslevel. Also in unserem Fall eben <code>ctrl</code>, <code>A</code>, <code>B</code> und <code>C</code>. Dann noch einen Vektor <code>r</code> mit den Wiederholungen pro Behandlungslevel. Hier ist Funktion <code>design.crd()</code> etwas besser, denn wir können hier auch unbalancierte Designs abbilden. Der Nachteil ist, dass wir faktisch danach keine andere Funktion mehr aus den anderen Paketen nutzen können. Deshalb ist es sinniger, balanciert zu planen und dann eben die Pflanzen später zu entfernen.</p>
<p>Hier einmal die simple Anwendung der Funktion zum erstellen eines <em>complete randomized design</em> mit vier Behandlungen und fünf Wiederholungen pro Behandlung.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">crd_obj</span> <span class="op">&lt;-</span> <span class="fu">design.crd</span><span class="op">(</span>trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ctrl"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, </span>
<span>                      r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Jetzt kommt leider der etwas aufwenidigere Teil. Das Paket <code>agricolae</code> ist schon etwas älter und damit auch teilweise nicht mehr so kompatibel und auf dem Stand der Zeit. Wir bauen uns daher jetzt noch ein paar Sachen zurecht. Am Ende wollen wie ein sauberes <code>tibble</code> mit anständigen Namen und einer Variable <code>trt_rep</code>, die uns sagt welche Behandlung und Wiederholung wir vorliegen haben.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">crd_book_tbl</span> <span class="op">&lt;-</span> <span class="va">crd_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"book"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">set_names</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"plots"</span>, <span class="st">"r"</span>, <span class="st">"trt"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>trt_rep <span class="op">=</span> <span class="fu">str_c</span><span class="op">(</span><span class="va">trt</span>, <span class="st">"."</span>, <span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">crd_book_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 x 4
   plots     r trt   trt_rep
   &lt;dbl&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;  
 1   101     1 ctrl  ctrl.1 
 2   102     1 C     C.1    
 3   103     2 C     C.2    
 4   104     2 ctrl  ctrl.2 
 5   105     1 A     A.1    
 6   106     1 B     B.1    
 7   107     3 ctrl  ctrl.3 
 8   108     2 A     A.2    
 9   109     3 C     C.3    
10   110     3 A     A.3    
11   111     4 A     A.4    
12   112     4 C     C.4    
13   113     2 B     B.2    
14   114     5 C     C.5    
15   115     4 ctrl  ctrl.4 
16   116     5 ctrl  ctrl.5 
17   117     3 B     B.3    
18   118     5 A     A.5    
19   119     4 B     B.4    
20   120     5 B     B.5    </code></pre>
</div>
</div>
<p>Schön ist was anderes, da hast du recht, aber wir können uns dann auch noch das Pflanzgrid einmal als Abbildung wiedergeben lassen. Da die Ausgabe der Funktion <code>design.crd()</code> schon permutiert ist, müssen wir hier nur die Informationen zu den Zeilen und Spalten ergänzen. Im Prinzip kannst du entscheiden, wie du die Wiederholungen <code>cols</code> oder Behandlungen <code>rows</code> anordnest. Du kannst am Ende aber auch einfach den ausgedruckten Zettel drehen.</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">crd_plot_tbl</span> <span class="op">&lt;-</span> <span class="va">crd_book_tbl</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">bind_cols</span><span class="op">(</span><span class="fu">expand_grid</span><span class="op">(</span>rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>                        cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#fig-exp-basic-2">Abbildung&nbsp;<span>55.2</span></a> siehst du dann einmal das Schema für die Pflanzungen eines <em>complete randomized design</em>. Das Schema unterscheidet sich so nicht von dem Eigenbau mit <code>expand_grid()</code>. Da bist du frei zu entscheiden was du nutzen möchtest.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">desplot</span><span class="op">(</span><span class="va">trt</span> <span class="op">~</span> <span class="va">rows</span> <span class="op">+</span> <span class="va">cols</span>, flip <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        text <span class="op">=</span> <span class="va">trt_rep</span>, cex <span class="op">=</span> <span class="fl">1</span>, shorten <span class="op">=</span> <span class="st">"no"</span>,</span>
<span>        data <span class="op">=</span> <span class="va">crd_plot_tbl</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Pflanzschema für ein complete randomized design"</span>", </span>
<span>        show.key <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exp-basic-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="experimental-design-basic_files/figure-html/fig-exp-basic-2-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;55.2— Schema der Pflanzungen nach den Behandlungen für das <em>complete randomized design</em>.</figcaption></figure>
</div>
</div>
</div>
<p>Damit wären wir auch schon durch. Wir haben in R im Prinzip die beiden Möglichkeiten das <em>complete randomized design</em> selber oder mit dem R Paket <code>agricolae</code> zu erstellen.</p>
</section></section><section id="sec-rcbd" class="level2 page-columns page-full" data-number="55.3"><h2 data-number="55.3" class="anchored" data-anchor-id="sec-rcbd">
<span class="header-section-number">55.3</span> Randomized complete block design (RCBD)</h2>
<p>Jetzt kommen wir zum vermutlich meist genutzten Design, dem <em>randomized complete block design</em>. Hier haben wir neben dem Faktor Behandlung <code>trt</code> auch noch einen zusätzlichen Faktor <code>block</code>. Wir haben dann für jede Behandlung/Block-Kombination einen Messwert. Wenn du am Feld stehst, ist es aber meistens so, dass wir nicht <em>eine</em> Pflanze pro Block haben, sondern 20 oder mehr Pflanzen. Wir mitteln aber den Wert für das Trockengewicht über alle 20 Pflanzen pro Block und haben dann wieder einen Messwert für jede Behandlung/Block-Kombination. Das ist manchmal etwas verwirrend.</p>
<p>Wir haben also folgendes Modell vorliegen, wir habend den Faktor Behandlung <code>trt</code> sowie den Faktor Block <code>block</code>. Für jede der Behandlung/Block-Kombination erhalten wir dann einen Wert. Wir schauen uns gleich vier Behandlungen und vier Blöcke an.</p>
<p><span class="math display">\[
drymatter \sim \overbrace{trt}^{f_1} + \underbrace{block}_{f_2}
\]</span></p>
<p>mit</p>
<ul>
<li>dem Faktor Behandlung <code>trt</code> und den vier Behandlungsstufen als Level <code>ctrl</code>, <code>A</code>, <code>B</code> und <code>C</code>.</li>
<li>dem Faktor Block <code>block</code> und den vier Leveln <code>I</code> bis <code>IV</code>.</li>
</ul>
<p>Wir randomiseren unsere Behandlungen <code>trt</code> in den Blöcken <code>block</code>. Somit ergibt sich <a href="#fig-mermaid-basic-01">Abbildung&nbsp;<span>55.3</span></a> in der unsere Behandlungen in den Blöcken genestet sind.</p>
<div class="cell" data-fig-width="6">
<div class="cell-output-display">
<div id="fig-mermaid-basic-01" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><div>
<pre class="mermaid mermaid-js" data-label="fig-mermaid-basic-01">flowchart LR
    A(trt):::factor --- B(((nested))) --&gt; C(block):::factor
    classDef factor fill:#56B4E9,stroke:#333,stroke-width:0.75px
</pre>
</div>
<figcaption class="figure-caption">Abbildung&nbsp;55.3— Abhängigkeitsstruktur eines randomized complete block design mit einem Faktor <code>trt</code> nested im Faktor <code>block</code>.</figcaption></figure>
</div>
</div>
</div>
<p>Damit gilt dann auch, dass jeder Block alle Behandlungslevel enthält und die Behandlungen innerhalb eines Blockes randomsiert werden. Unsere Randomisierungseinheit ist also der Block.</p>
<p><span class="math display">\[
\underbrace{\mbox{Blöcke}}_{f_2} \xrightarrow[]{beinhaltet\; alle} \overbrace{\mbox{Behandlungen}}^{f_1}
\]</span></p>
<p>Theoretisch könnten wir auch pro Block mehrere <em>einzelne</em> Pflanzen messen, dann sind wir aber im Subsampling drin. Wenn du mehr zum Design erfahren möchtest, dann schau einfach mal bei <a href="experimental-design-advanced.html#sec-subsampling">Abschnitt zum <em>subsampling</em></a> im nächsten Kapitel rein.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modell zur Auswertung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir rechnen ein multiples lineares Modell für die statistische Analyse.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">drymatter</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="va">block</span> <span class="op">+</span> <span class="va">trt</span><span class="op">:</span><span class="va">block</span>, data <span class="op">=</span> <span class="va">rcbd_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Hier einmal der Link zu der Auswertung zum <a href="https://schmidtpaul.github.io/DSFAIR/subsampling_Piepho1997.html">Subsampling</a> bei DSFAIR.</p>
</div></div><section id="mit-expand_grid-1" class="level3" data-number="55.3.1"><h3 data-number="55.3.1" class="anchored" data-anchor-id="mit-expand_grid-1">
<span class="header-section-number">55.3.1</span> … mit <code>expand_grid()</code>
</h3>
<p>Das praktische an <code>expand_grid()</code> ist, dass du nochmal eine Vorstellugn über den Aufbau des Experiments erhälst. Wir nehmen als erstes den Block <code>block</code> und ergänzen dann die Behandlungen <code>trt</code>. Damit erschaffen wir uns erst die vier Blöcke und dann pro Block die vier Behandlungen. Dann müssen wir noch unsere Daten etwas mutieren und schöner machen. Wir ergänzen noch einen Identifikator <code>trt_block</code> damit wir auch unsere Positionen für die Pflanzungen später in den Abbildungen wieder finden. Am Ende gruppieren wir die Daten nochmal pro Block damit wir dann innerhalb der Blöcke unsere Behandlungslevel über die Funktion <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code> randomsisiern können.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rcbd_long_tbl</span> <span class="op">&lt;-</span> <span class="fu">expand_grid</span><span class="op">(</span>block <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, </span>
<span>                             trt <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">trt</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ctrl"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         block <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">block</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/roman.html">as.roman</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         trt_block <span class="op">=</span> <span class="fu">str_c</span><span class="op">(</span><span class="va">trt</span>, <span class="st">"."</span>, <span class="va">block</span><span class="op">)</span>,</span>
<span>         pid <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">block</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">trt</span><span class="op">)</span><span class="op">)</span> <span class="co">## Randomisierung pro Block</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rcbd_plot_tbl</span> <span class="op">&lt;-</span> <span class="va">rcbd_long_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">bind_cols</span><span class="op">(</span><span class="fu">expand_grid</span><span class="op">(</span>rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Die dicken, schwarzen Linien stellen die Grenzen der Blöcke dar. Im realen Leben kann eine farbige Kachel in der Abbildung ein ganzes Feld sein und die Blockgrenzen sind dann eben Feldwege. Die <a href="#fig-exp-basic-3">Abbildung&nbsp;<span>55.4</span></a> stellt ja auch nur eine schematische Darstellung der Pflanzungen dar.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">desplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rcbd_plot_tbl</span>, </span>
<span>        form <span class="op">=</span> <span class="va">trt</span> <span class="op">~</span> <span class="va">rows</span> <span class="op">+</span> <span class="va">cols</span>,</span>
<span>        out1 <span class="op">=</span> <span class="va">block</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Pflanzschema für ein randomized complete block design"</span>", </span>
<span>        text <span class="op">=</span> <span class="va">trt_block</span>, cex <span class="op">=</span> <span class="fl">1</span>, show.key <span class="op">=</span> <span class="cn">FALSE</span>, shorten <span class="op">=</span> <span class="st">"no"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exp-basic-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="experimental-design-basic_files/figure-html/fig-exp-basic-3-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;55.4— Schema der Pflanzungen nach den Behandlungen für das randomized complete block design. Beachte die schwarzen Linien als Grenzen für die Blöcke. Im realen Leben können das Gänge zwischen Tischen sein oder Feldwege.</figcaption></figure>
</div>
</div>
</div>
<p>Dann können wir auch schon unseren Versuchsplan als Exceldatei rausschreiben. Wir können dann noch weitere Spalten als Outcome ergänzen und dann mit der Datei unsere Auswertung durchführen.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rcbd_long_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">write_xlsx</span><span class="op">(</span><span class="st">"template_sheet.xlsx"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="mit-agricolae-1" class="level3" data-number="55.3.2"><h3 data-number="55.3.2" class="anchored" data-anchor-id="mit-agricolae-1">
<span class="header-section-number">55.3.2</span> … mit <code>agricolae</code>
</h3>
<p>Wir können auch ein <em>randomized complete block design</em> mit <code>agricolae</code> erstellen. Hier geht es ähnlich wie vorher schon. Wichtig ist, dass wir hier unsere Blöcke wieder mit <code>r</code> bezeichnen. Damit bauen wir uns also wieder ein Design mit vier Behandlungsleveln und fünf Blöcken.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rcbd_obj</span> <span class="op">&lt;-</span> <span class="fu">design.rcbd</span><span class="op">(</span>trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ctrl"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, r <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Leider ist die Ausgabe von <code>design.rcbd()</code> etwas ungünstig für die weitere Darstellung. Deshalb wandeln wir etwas das Feldbuch für unsere Bedürfnisse um. Wir könnten natürlich gleich mit dem Feldbuch weitermachen und die Pflanzen in der Form ausbringen, aber wir wollen ja noch ein Pflanzschema erstellen.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rcbd_book_tbl</span> <span class="op">&lt;-</span> <span class="va">rcbd_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"book"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">set_names</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"plots"</span>, <span class="st">"block"</span>, <span class="st">"trt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rcbd_book_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 x 3
   plots block trt  
   &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;
 1   101 1     A    
 2   102 1     C    
 3   103 1     B    
 4   104 1     ctrl 
 5   201 2     C    
 6   202 2     ctrl 
 7   203 2     B    
 8   204 2     A    
 9   301 3     ctrl 
10   302 3     C    
11   303 3     B    
12   304 3     A    
13   401 4     C    
14   402 4     B    
15   403 4     A    
16   404 4     ctrl 
17   501 5     ctrl 
18   502 5     C    
19   503 5     B    
20   504 5     A    </code></pre>
</div>
</div>
<p>Jetzt nochmal das Grid für die Pflanzungen ergänzt. Hier müssen wir etwas mehr schauen, wie wir die Zeilen <code>rows</code> und Spalten <code>cols</code> zuordnen. Unsere Zeilen sind die Blöcke, aber innerhalb der Blöcke müssen wir die Anzahl der Behandlungen nummerieren. Deshalb machen wir den Zwischenschritt mit <code>group_by()</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rcbd_plot_tbl</span> <span class="op">&lt;-</span> <span class="va">rcbd_book_tbl</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">block</span><span class="op">)</span>,</span>
<span>         trt_block <span class="op">=</span> <span class="fu">str_c</span><span class="op">(</span><span class="va">trt</span>, <span class="st">"."</span>, <span class="va">block</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">rows</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Zur Kontrolle einmal die Ausgabe des <code>skretch</code>. Auch hier steht wieder nichts an den Zeilen und Spalten, so dass wir immer überlegen müssen, was war nun der Block und was war die Behandlung.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rcbd_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"sketch"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]   [,2]   [,3]   [,4]   [,5]  
[1,] "A"    "C"    "ctrl" "C"    "ctrl"
[2,] "C"    "ctrl" "C"    "B"    "C"   
[3,] "B"    "B"    "B"    "A"    "B"   
[4,] "ctrl" "A"    "A"    "ctrl" "A"   </code></pre>
</div>
</div>
<p>Um es schöner zu haben schauen wir uns einmal die <a href="#fig-exp-basic-4">Abbildung&nbsp;<span>55.5</span></a> als Pfalnzschema an. Wir haben hier die gleiche Ausgabe wie auch schon weiter oben. Die Positionen haben sich geändert, wir haben ja auch zweimal randomisiert. Sonst sehen wir aber das Gleiche. Die schwarze Striche sind wieder die Grenzen unserer Blöcke und können im echten Leben dann Feldwege oder Gewächshäuser sein.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">desplot</span><span class="op">(</span><span class="va">trt</span> <span class="op">~</span> <span class="va">rows</span> <span class="op">+</span> <span class="va">cols</span>, flip <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        text <span class="op">=</span> <span class="va">trt_block</span>, cex <span class="op">=</span> <span class="fl">1</span>, shorten <span class="op">=</span> <span class="st">"no"</span>,</span>
<span>        out1 <span class="op">=</span> <span class="va">block</span>,</span>
<span>        data <span class="op">=</span> <span class="va">rcbd_plot_tbl</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Pflanzschema für ein randomized complete block design"</span>", </span>
<span>        show.key <span class="op">=</span> <span class="cn">FALSE</span>, key.cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exp-basic-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="experimental-design-basic_files/figure-html/fig-exp-basic-4-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;55.5— Schema der Pflanzungen nach den Behandlungen für das randomized complete block design. Beachte die schwarzen Linien als Grenzen für die Blöcke. Im realen Leben können das Gänge zwischen Tischen sein oder Feldwege.</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="sec-lsd" class="level2 page-columns page-full" data-number="55.4"><h2 data-number="55.4" class="anchored" data-anchor-id="sec-lsd">
<span class="header-section-number">55.4</span> Latin square design (LSD)</h2>
<p>Das <em>latin suare design</em> erweist sich dann als besonders sinnvoll, wenn zwei unabhängige Störgradienten vorhanden sind, die orthogonal zueinander ausgerichtet sind. Ein Beispiel hierfür wäre im Boden des Versuchsfeldes ein Feuchtigkeitsgefälle von Nord nach Süd und ein Nährstoffgefälle von Ost nach West. Um diese Störgrößen im Boden zu berücksichtigen, werden die Randomisationseinheiten in Form von Quadraten angeordnet. Diese Anordnung stellt sicher, dass sowohl die Anzahl der Zeilen als auch die Anzahl der Spalten zwangsläufig gleich sind. Durch diese Anordnung ist es möglich, eine Randomisierung durchzuführen, bei der sowohl jede Spalte als auch jede Zeile einen vollständigen Block bildet, ähnlich wie bei einem Sudoku-Raster. Es darf eben in jeder Zeile und Spalte immer nur einmal eine Behandlung auftauchen.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="https://www.adelaide.edu.au/library/special/exhibitions/significant-life-fisher/rothamsted/">Das Bild des ersten Latin Square</a> an einem Hang, angelegt und geplant von Roland Fisher an der Rothamsted Experimental Station.</p>
<p>Auch findest du im <a href="https://www.statforbiology.com/_statbookeng/designing-experiments#selecting-the-units-within-the-field">Chapter 2 Designing experiments</a> aus <a href="https://www.statforbiology.com/_statbookeng/">Experimental methods in agriculture</a> noch schöne Beispiele für ein Latin Square Design.</p>
</div></div><p>Schauen wir uns einmal das Modell an nachdem wir unseren Versuchsplan bauen wollen. Wir haben wie immer unsere Behandlung <code>trt</code> sowie den Block, den wir aber in <code>rows</code> und <code>cols</code> aufteilen. Die Regel lautet im <em>latin suare design</em>, dass keine Behandlung in der gleichen Zeile und Spalte doppelt auftreten darf.</p>
<p><span class="math display">\[
drymatter \sim \overbrace{trt}^{f_1} + \underbrace{rows}_{f_2} + \overbrace{cols}^{f_3}
\]</span></p>
<p>mit</p>
<ul>
<li>dem Faktor Behandlung <code>trt</code> und den fünf Behandlungsstufen als Level <code>ctrl</code>, <code>A</code>, <code>B</code>, <code>C</code> und <code>D</code>.</li>
<li>dem Faktor Reihe <code>rows</code> mit der Anzahl der Level gleich der Level der Behandlung also hier fünf.</li>
<li>dem Faktor Spalte <code>cols</code> mit der Anzahl der Level gleich der Level der Behandlung also hier fünf.</li>
</ul>
<p>In der <a href="#fig-mermaid-lsd">Abbildung&nbsp;<span>55.6</span></a> sehen wir nochmal den schematischen Aufbau eines <em>latin suare design</em> dargestellt. VErmutlich hilft es auch sich einmal das finale Design in der <a href="#fig-exp-basic-5">Abbildung&nbsp;<span>55.7</span></a> einmal anzuschauen. Wichtig ist, dass wir den Block gar nicht betrachten. Wir haben hier eher fünfunzwanzig kleine Subblöcke, die wir durch die Position der <code>rows</code> und <code>cols</code> definieren.</p>
<div class="cell" data-fig-width="6">
<div class="cell-output-display">
<div id="fig-mermaid-lsd" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><div>
<pre class="mermaid mermaid-js" data-label="fig-mermaid-lsd">flowchart LR
    A(trt):::factor --- B(((nested))) --&gt; C(rows):::factor 
    B(((nested))) --&gt; D(cols):::factor 
    C --- F(block)
    D --- F
    classDef factor fill:#56B4E9,stroke:#333,stroke-width:0.75px
</pre>
</div>
<figcaption class="figure-caption">Abbildung&nbsp;55.6— Schematische Darstellung der Abhängigkeitsstruktur im latin suare design. Die Behandlungen werden in <code>rows</code> und <code>cols</code> genestet, die einem quadratischen Block mit den Längen der Anzahl der Level der Behandlungen entsprechen.</figcaption></figure>
</div>
</div>
</div>
<p>Wir schauen uns hier nur das R Paket <code>agricolae</code> und das R Paket <code>dae</code> an. Selber machen ist hier nicht, da du dir bei der Erstellung sehr schnell Fehler rein holst. Es ist super frickelig darauf zu achten, dass sich wirklich keine Behandlung in irgendeiner Zeilen- oder Spaltenposition überschneidet. Da sind die vorgefertigten Funktionen echt mal besser.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modell zur Auswertung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir rechnen ein multiples lineares Modell für die statistische Analyse.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">drymatter</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="va">cols</span> <span class="op">+</span> <span class="va">rows</span>, data <span class="op">=</span> <span class="va">lsd_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="mit-agricolae-2" class="level3" data-number="55.4.1"><h3 data-number="55.4.1" class="anchored" data-anchor-id="mit-agricolae-2">
<span class="header-section-number">55.4.1</span> … mit <code>agricolae</code>
</h3>
<p>Im <em>latin suare design</em> brauchen wir nur einen Behandlungsvektor. Durch die Anzahl der Behandlungen wird auch die Größe des <em>latin suare</em> bestimmt. Wir haben hier fünf Behandlungen vorliegen, also kriegen wir dann auch ein <span class="math inline">\(5 \times 5\)</span>-<em>latin suare</em> für unseren Versuchsplan raus.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lsd_obj</span> <span class="op">&lt;-</span> <span class="fu">design.lsd</span><span class="op">(</span>trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ctrl"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span>, </span>
<span>                      seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Zum Glück kriegen wir hier auch die Zeilen und Spalten direkt von der Funktion <code>design.lsd()</code> geliefert. Leider als Faktoren, so dass wir die Faktoren nochmal in Zahlen umwandeln damit es später mit der Visualisierung klappt.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lsd_book_tbl</span> <span class="op">&lt;-</span> <span class="va">lsd_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"book"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">set_names</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"plots"</span>, <span class="st">"rows"</span>, <span class="st">"cols"</span>, <span class="st">"trt"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">rows</span><span class="op">)</span>,</span>
<span>         cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lsd_book_tbl</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 x 4
   plots  rows  cols trt  
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;
 1   101     1     1 D    
 2   102     1     2 C    
 3   103     1     3 ctrl 
 4   104     1     4 B    
 5   105     1     5 A    
 6   201     2     1 C    
 7   202     2     2 B    
 8   203     2     3 D    
 9   204     2     4 A    
10   205     2     5 ctrl 
# i 15 more rows</code></pre>
</div>
</div>
<p>Dann einmal die Ausgabe des <code>sketch</code>. Hier kann man mal nichts falsch machen. Wir kriegen unser Quadrat als <em>latin suare</em> und gut ist.</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lsd_obj</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"sketch"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]   [,2]   [,3]   [,4]   [,5]  
[1,] "D"    "C"    "ctrl" "B"    "A"   
[2,] "C"    "B"    "D"    "A"    "ctrl"
[3,] "ctrl" "D"    "A"    "C"    "B"   
[4,] "B"    "A"    "C"    "ctrl" "D"   
[5,] "A"    "ctrl" "B"    "D"    "C"   </code></pre>
</div>
</div>
<p>In der <a href="#fig-exp-basic-5">Abbildung&nbsp;<span>55.7</span></a> siehst du dann nochmal das <em>latin square design</em> visualisiert. Die dicken Linien sind wieder die Blockgrenzen und mögen dann die Feldwege oder Wege zwischen den Behandlungens sein. Wie du siehst, gibt es pro Zeile und Spalte immer nur eine Behandlung. Wir haben einmal perfekt über das ganze <em>latin square</em> randomisiert.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">desplot</span><span class="op">(</span><span class="va">trt</span> <span class="op">~</span> <span class="va">rows</span> <span class="op">+</span> <span class="va">cols</span>, flip <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        out1 <span class="op">=</span> <span class="va">rows</span>, out1.gpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"black"</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>        out2 <span class="op">=</span> <span class="va">cols</span>, out2.gpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col<span class="op">=</span><span class="st">"black"</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>        text <span class="op">=</span> <span class="va">trt</span>, cex <span class="op">=</span> <span class="fl">1</span>, shorten <span class="op">=</span> <span class="st">"no"</span>,</span>
<span>        data <span class="op">=</span> <span class="va">lsd_book_tbl</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Pflanzschema für ein latin square design"</span>", </span>
<span>        show.key <span class="op">=</span> <span class="cn">FALSE</span>, key.cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exp-basic-5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="experimental-design-basic_files/figure-html/fig-exp-basic-5-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;55.7— Schema der Pflanzungen nach den Behandlungen für das latin square design. Beachte die schwarzen Linien als Grenzen für die Blöcke. Im realen Leben können das Gänge zwischen Tischen sein oder Feldwege.</figcaption></figure>
</div>
</div>
</div>
<p>Dann nochmal das <em>latin square design</em> rausschreiben und wir können mit der Datenerfassung beginnen.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lsd_book_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">trt</span>, <span class="va">rows</span>, <span class="va">cols</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">write_xlsx</span><span class="op">(</span><span class="st">"template_sheet.xlsx"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="mit-dae" class="level3" data-number="55.4.2"><h3 data-number="55.4.2" class="anchored" data-anchor-id="mit-dae">
<span class="header-section-number">55.4.2</span> … mit <code>dae</code>
</h3>
<p>Das <em>latin square design</em> in dem R Paket <code>dae</code> ist etwas verkompliziert herzustellen. Das Paket <code>dae</code> ist eher vür komplexere Designs gedacht, so dass simple Designs manchmal übermaßig kompliziert wirken. Wir übergeben erstmal unser Positionsgrid, natürlich ein <span class="math inline">\(5 \times 5\)</span>-Grid, aus Zeilen und Spalten. Dann ergänzen wir unsere fünf Behandlungen in einem <em>latin square design</em>. Das Ganze ist irgendwie dreifach, aber da wir auch komplexeres können, machen wir das mal so und gehen hier nicht tiefer drauf ein.</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lsd_sys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu">fac.gen</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fl">5</span>, cols <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu">designLatinSqrSys</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, labels <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wenn wir das grundlegende Objekt <code>lsd_obj</code> mit den Spalten, Zeilen und Behandlungen erstellt haben, können wir die Zuordnung randomisieren. Dabei wollen wir die Behandlungen <code>trt</code> auf die Zeilen <code>rows</code> und Spalten <code>cols</code> randomisieren. Deshalb ist sind die Behandlungen in der Option <code>allocated</code> sowie die Zeilen und Spalten in <code>recipient</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lsd_lay</span> <span class="op">&lt;-</span> <span class="fu">designRandomize</span><span class="op">(</span>allocated <span class="op">=</span> <span class="va">lsd_sys</span><span class="op">[</span><span class="st">"trt"</span><span class="op">]</span>,</span>
<span>                            recipient <span class="op">=</span> <span class="va">lsd_sys</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rows"</span>, <span class="st">"cols"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                            seed <span class="op">=</span> <span class="fl">141</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir können dann uns auch in <a href="#fig-exp-basic-6">Abbildung&nbsp;<span>55.8</span></a> die Ausgabe des <em>latin square design</em> anschauen. Prinzipiell gibt es hier keinen Unterschied zu dem R Paket <code>agricolae</code>. Es ist dann eher eine Geschmacksfrage, wie die Darstellung aussehen soll.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">designGGPlot</span><span class="op">(</span><span class="va">lsd_lay</span>, labels <span class="op">=</span> <span class="st">"trt"</span>, cellalpha <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>             row.factors <span class="op">=</span> <span class="st">"rows"</span>, column.factors <span class="op">=</span> <span class="st">"cols"</span>,</span>
<span>             blockdefinition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>             blocklinecolour <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>             title <span class="op">=</span> <span class="st">"Pflanzschema für ein latin square design"</span><span class="op">)</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exp-basic-6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="experimental-design-basic_files/figure-html/fig-exp-basic-6-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;55.8— Schema der Pflanzungen nach den Behandlungen für das latin square design. Beachte die schwarzen Linien als Grenzen für die Blöcke. Im realen Leben können das Gänge zwischen Tischen sein oder Feldwege.</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="spezialfälle" class="level2 page-columns page-full" data-number="55.5"><h2 data-number="55.5" class="anchored" data-anchor-id="spezialfälle">
<span class="header-section-number">55.5</span> Spezialfälle</h2>
<p>Im Folgenden schauen wir uns noch die Generierung von zwei Spezialfällen an. Beide sind im Prinzip wiederum zweifaktorielle Versuchspläne mit einer Behandlung und entsprechenden Wiederholungen in Blöcken. Beide sind aber etwas spezieller beim Aufbau, deshalb hier nur am Rande. Die Auswertung verlangt dann natürlich auch wieder etwas mehr Modellierung.</p>
<ul>
<li><a href="#sec-alpha">Alpha design</a></li>
<li><a href="#sec-augment">Augmented design</a></li>
</ul>
<p>Wir schauen uns einmal für diese Designs die Implementierung in <code>agricolae</code> an. Selber machen ist hier etwas aufwendig und hier nutzen wir dann mal wirklich ein R Paket, dass macht es uns dann einfacher im Erstellen.</p>
<section id="sec-alpha" class="level3 page-columns page-full" data-number="55.5.1"><h3 data-number="55.5.1" class="anchored" data-anchor-id="sec-alpha">
<span class="header-section-number">55.5.1</span> Alpha design</h3>
<p>Der Alpha-Versuchsplan ist dafür gedacht ein Versuchsplan mit unvollständigen Blöcken abzubilden. Die Blöcke sind dann aber wiederum zu vollständigen Wiederholungen gruppiert. Das heißt, in jeder Wiederholung findest du alle Blöcke wieder. Solche Versuchspläne werden dann als auflösbar bezeichnet, also als berechenbar. Das klingt jetzt etwas komplizierter als es eiigentlich ist. Wie haben auch in diesem Beispiel wieder fünfzehn genetische Linien vorliegen. Wir haben aber in jedem unserer Blöcke nur Platz drei dieser Linien abzubilden. Das heißt also pro Block nehmen wir drei Linien damit kommen wir auf fünf Blöcke um alle Linien abzubilden. Diese fünf Blöcke werden dann in drei Wiederholungen randomisiert, so dass wir auf fünfzehn Blöcke kommen.</p>
<p>Okay, das klingt jetzt echt wirr. Schauen wir uns dazu einmal das Schema der Abhängigkeitsstruktur in der <a href="#fig-mermaid-basic-alpha">Abbildung&nbsp;<span>55.9</span></a> an. Wir haben also unsere Behandlung <code>trt_gen</code> mit fünzehn Leveln entsprechend der fünfzehn genetischen Linien. Wir nehmen jetzt zufällig drei Linien heraus und packen diese drei Linien in einen Block <code>inc_block</code>. Das machen wir fünf mal, da wir <span class="math inline">\(15/3 = 5\)</span> Blöcke brauchen. Wir generieren <em>incomplete blocks</em>. Dann kommen alle <em>incomplete blocks</em> in eine Wiederholung `rep``. In einer Wiederholung sind alle genetischen Linien dann enthalten.</p>
<div class="cell" data-fig-width="6">
<div class="cell-output-display">
<div id="fig-mermaid-basic-alpha" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><div>
<pre class="mermaid mermaid-js" data-label="fig-mermaid-basic-alpha">flowchart LR
    A(trt_gen):::factor --&gt; B &amp; C &amp; D &amp; E &amp; F
    B[("G_10 
        G_4
        G_8")]:::level -.- G(((nested))) -.-&gt; L(inc_block):::inc_block
    C[("G_3
        G_15
        G_9")]:::level -.- H(((nested))) -.-&gt; L
    D[("G_2 
        G_11
        G_1")]:::level -.- I(((nested))) -.-&gt; L
    E[("G_13
        G_12
        G_7")]:::level -.- J(((nested))) -.-&gt; L
    F[("G_6 
        G_5
        G_14")]:::level -.- K(((nested))) -.-&gt; L
    L --- M(((nested))) --&gt; N(Wiederholung):::factor
    classDef factor fill:#56B4E9,stroke:#333,stroke-width:0.75px
    classDef level fill:#E69F00,stroke:#333,stroke-width:0.75px
    classDef inc_block fill:#CC79A7,stroke:#333,stroke-width:0.75px
</pre>
</div>
<figcaption class="figure-caption">Abbildung&nbsp;55.9— Schematische Darstellung der Abhängigkeitsstruktur im Alpha-Versuchsplan. Die Level der Behandlung werden zufällig auf <em>incomplete blocks</em> aufgeteilt und diese Blöcke dann vollständig in Wiederholungen randomisiert.</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modell zur Auswertung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir rechnen ein multiples lineares Modell für die statistische Analyse.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">drymatter</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="va">rep</span> <span class="op">+</span> <span class="va">rep</span><span class="op">:</span><span class="va">inc_block</span>, data <span class="op">=</span> <span class="va">alpha_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Oder können überlegen ein gemischtes Modell zu rechnen.</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">drymatter</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="va">rep</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">rep</span><span class="op">:</span><span class="va">inc_block</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">alpha_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Die Entscheidung kannst du dann mit der <a href="https://jkruppa.github.io/stat-modeling-basic.html#sec-model-basic-compare">Modellselektion</a> durchführen.</p>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Auch hier hilft die Seite <a href="https://schmidtpaul.github.io/DSFAIR/alpha_JohnWilliams1995.html">DSFAIR - Alpha design</a> mit einer beispielhaften Auswertung eventuell weiter. Beispielhafte Daten und Auswertung sind dort vorhanden.</p>
</div></div><p>Deshalb brauchen wir erstmal unsere fünfzehn Linien <code>trt_gen</code> und unsere drei Wiederholungen <code>n_rep</code> sowie eine Größe von unseren Blöcken <code>size_block</code> von drei.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">trt_gen</span> <span class="op">&lt;-</span> <span class="fu">str_c</span><span class="op">(</span><span class="st">"G"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span>  </span>
<span><span class="va">n_trt_gen</span> <span class="op">&lt;-</span> <span class="fu">n_distinct</span><span class="op">(</span><span class="va">trt_gen</span><span class="op">)</span></span>
<span><span class="va">n_rep</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">size_block</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Leider sind die Namen der Optionen etwas unglücklich gewählt. Zwar macht es Sinn die Namen etwas gleich zu halten, aber manchmal macht es die Sache für die Anwendung echt nicht einfacher. Hier ist also <code>k</code> die Größe der Blöcke und <code>r</code> die Anzahl der Wiederholungen. Es funktionieren nicht alle möglichen Kombinationen, im Zweifel bitte vorher hier mal rumspielen, bevor der Versuch angelegt wird oder schon Anzahlen bestimmt werden.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">alpha_obj</span> <span class="op">&lt;-</span> <span class="fu">design.alpha</span><span class="op">(</span>trt <span class="op">=</span> <span class="va">trt_gen</span>,</span>
<span>                          k <span class="op">=</span> <span class="va">size_block</span>,</span>
<span>                          r <span class="op">=</span> <span class="va">n_rep</span>,</span>
<span>                          seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Alpha Design (0,1) - Serie  II 

Parameters Alpha Design
=======================
Treatmeans : 15
Block size : 3
Blocks     : 5
Replication: 3 

Efficiency factor
(E ) 0.7 

&lt;&lt;&lt; Book &gt;&gt;&gt;</code></pre>
</div>
</div>
<p>Wie immer müssen wir uns noch die Zeilen und Spalten selber erschaffen, damit wir das <em>alpha design</em> auch abbilden können. Hier ist wichtig, dass wir dann noch die Wiederholung haben, die kein Block ist. Pro Wiederholung haben wir eben fünf unvollständige Blöcke mit drei Linien vorliegen.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">alpha_book_tbl</span> <span class="op">&lt;-</span> <span class="va">alpha_obj</span><span class="op">$</span><span class="va">book</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>replication <span class="op">=</span> <span class="fu">str_c</span><span class="op">(</span><span class="st">"Wiederholung "</span>, <span class="va">replication</span><span class="op">)</span>,</span>
<span>         rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">block</span><span class="op">)</span>,</span>
<span>         cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#fig-exp-basic-7">Abbildung&nbsp;<span>55.10</span></a> siehst du dann das Ergebnis der Versuchsplanung. Wir haben unsere drei Wiederholungen und in den drei Wiederholungen dann jeweils fünf Blöcke randomisiert. Pro Block finden sich dann drei Linien. Unsere Blöcke sind damit unvollständig. Für mich ist das <em>alpha design</em> eins der schwierigeren Designs, weil man hier zwischen den Wiederholungen und den Blöcken unterscheiden muss. Das führt manchmal zu Verwirrung was randomisert wird.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">desplot</span><span class="op">(</span><span class="va">block</span> <span class="op">~</span> <span class="va">rows</span> <span class="op">+</span> <span class="va">cols</span> <span class="op">|</span> <span class="va">replication</span>, flip <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        out1 <span class="op">=</span> <span class="va">replication</span>,</span>
<span>        out2 <span class="op">=</span> <span class="va">block</span>, out2.gpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, </span>
<span>        text <span class="op">=</span> <span class="va">trt_gen</span>, cex <span class="op">=</span> <span class="fl">1</span>, shorten <span class="op">=</span> <span class="st">"no"</span>,</span>
<span>        data <span class="op">=</span> <span class="va">alpha_book_tbl</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"Pflanzschema für ein alpha design"</span>", </span>
<span>        show.key <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exp-basic-7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="experimental-design-basic_files/figure-html/fig-exp-basic-7-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;55.10— Schema der Pflanzungen nach den Behandlungen für das alpha design.</figcaption></figure>
</div>
</div>
</div>
<p>Dann nochmal das <em>alpha design</em> rausschreiben und wir können mit der Datenerfassung beginnen.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lsd_book_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">replication</span>, <span class="va">trt_gen</span>, inc_block <span class="op">=</span> <span class="va">block</span>, <span class="va">rows</span>, <span class="va">cols</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">write_xlsx</span><span class="op">(</span><span class="st">"template_sheet.xlsx"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="sec-augment" class="level3 page-columns page-full" data-number="55.5.2"><h3 data-number="55.5.2" class="anchored" data-anchor-id="sec-augment">
<span class="header-section-number">55.5.2</span> Augmented design</h3>
<p>Das <em>augmened design</em> basiert darauf, dass wir neben den eigentlichen Behandlungen noch Standardbehandlungen vorliegen haben. Die Standardbehandlungen randomisieren wir voll auf die Blöcke, wohingegen die anderen Behandlungen unvollständig randomisiert werden. In unserem Beispiel haben wir jetzt fünfzehn genetische Linien <code>G1</code> bis <code>G15</code> in dem Behandlungsfaktor <code>trt_gen</code> sowie die Standardbehandlung <code>Std_A</code> und <code>Std_B</code> vorliegen. Wir werden dann drei Blöcke bilden und in jeder der Blöcke wird jeweils die Standardbehandlung <code>Std_A</code> und <code>Std_B</code> sowie eine <em>Auswahl</em> an genetischen Linien enthalten sein.</p>
<p>Klingt jetzt auch wieder sehr viel wirrer als es am Ende ist. Deshalb hier erstmal das Modell, wir haben auch hier im Prinzip nur zwei Faktoren vorliegen. Wir haben einmal den Faktor Behandlung <code>trt_gen</code> sowie den Faktor Block zu erstellen.</p>
<p><span class="math display">\[
drymatter \sim \overbrace{trt_{gen}}^{f_1} + \underbrace{inc\_{block}}_{f_2}
\]</span></p>
<p>mit</p>
<ul>
<li>dem Faktor Behandlung <code>trt</code> und den fünzehn genetischen Linien als Level <code>G_1</code> bis <code>G_15</code> und die beiden Standardbehandlungen <code>Std_A</code> und <code>Std_B</code>.</li>
<li>dem Faktor Block <code>inc_block</code> und den vier Leveln <code>I</code> bis <code>III</code>.</li>
</ul>
<p>In dem <em>augmened design</em> dreht sich aber alles um die Zuweisung der Behandlungslevel zu den Blöcken. In der <a href="#fig-mermaid-basic-aug">Abbildung&nbsp;<span>55.11</span></a> wird die Zuordnung nochmal dargestellt. Die Standardbedingungen werden immer auf die Blöcke randomisiert. Daher haben wir für die Blöcke eine vollständige Randomisierung vorliegen. Die genetischen Linien werden nur teilweise jedem Block zugeordnet. Wir haben für die Level der genetischen Linien ein <em>incomplete block design</em> vorliegen.</p>
<div class="cell" data-fig-width="6">
<div class="cell-output-display">
<div id="fig-mermaid-basic-aug" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><div>
<pre class="mermaid mermaid-js" data-label="fig-mermaid-basic-aug">flowchart LR
    A(trt_gen):::factor --&gt; B &amp; D
    B[("Std_A 
        Std_B")]:::level --- C(((nested))) --&gt; F(inc_block):::inc_block
    D[("G_1
        bis
        G_15")]:::level -.- E(((nested))) -.-&gt; F
    classDef factor fill:#56B4E9,stroke:#333,stroke-width:0.75px
    classDef level fill:#E69F00,stroke:#333,stroke-width:0.75px
    classDef inc_block fill:#CC79A7,stroke:#333,stroke-width:0.75px
</pre>
</div>
<figcaption class="figure-caption">Abbildung&nbsp;55.11— Schematische Darstellung der Abhängigkeitsstruktur im <em>augmened design</em>. Eine Auswahl der Level der genetischen Linien werden zufällig auf <em>incomplete blocks</em> aufgeteilt. Die Standardbedingungen werden vollständig jedem Block zugeordnet.</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Modell zur Auswertung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir rechnen ein multiples lineares Modell für die statistische Analyse.</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">drymatter</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="va">inc_block</span>, data <span class="op">=</span> <span class="va">augment_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Oder können überlegen ein gemischtes Modell zu rechnen.</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">lmer</span><span class="op">(</span><span class="va">drymatter</span> <span class="op">~</span> <span class="va">trt</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">inc_block</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">augment_tbl</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Die Entscheidung kannst du dann mit der <a href="https://jkruppa.github.io/stat-modeling-basic.html#sec-model-basic-compare">Modellselektion</a> durchführen.</p>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Auch hier hilft die Seite <a href="https://schmidtpaul.github.io/DSFAIR/augmented_Pattersen1994.html">DSFAIR - Augmented design</a> mit einer beispielhaften Auswertung eventuell weiter. Beispielhafte Daten und Auswertung sind dort vorhanden.</p>
</div></div><p>Die Erstellung ist sehr fehleranfällig, wenn wir das selber machen. Deshalb nutzen wir hier das R Paket <code>agricolae</code>. Du musst eben sehr genau darauf achten, dass wirklich auch alle genetischen Linien in den Blöcken sind. Das macht aber die Funktion <code>design.dau()</code> gleich für uns. Wir brauchen also einmal einen Faktor für unsere genetischen Linien, dann einmal die Anzahl an Linien sowie die Anzahl an Blöcken. Das definieren wir uns jetzt hier einmal in Objekten vor, dass macht die Arbeit später einfacher.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">trt_gen</span> <span class="op">&lt;-</span> <span class="fu">str_c</span><span class="op">(</span><span class="st">"G"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span>   </span>
<span><span class="va">n_trt_gen</span> <span class="op">&lt;-</span> <span class="fu">n_distinct</span><span class="op">(</span><span class="va">trt_gen</span><span class="op">)</span></span>
<span><span class="va">n_block</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann noch den Standard erschaffen. Hier ist wichtig, dass der Standard immer in jedem Block sein wird. Das wird nicht der Fall sein für die genetischen Linien. Daher haben wir dann für die Linien ein <em>incomplete block design</em> vorliegen.</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">standard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Std_A"</span>, <span class="st">"Std_B"</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir nutzen hier einal die Funktion <code>design.dau()</code> aus dem R Paket <code>agricolae</code> um uns das <em>augmented design</em> ersellen zu lassen. Das macht die Funktion auch einigermaßen gut, wir müssen gleich nur noch die Positionen auf dem Pflanzgrid ergänzen.</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">augmented_obj</span> <span class="op">&lt;-</span> <span class="fu">design.dau</span><span class="op">(</span>trt1 <span class="op">=</span> <span class="va">standard</span>,</span>
<span>                            trt2 <span class="op">=</span> <span class="va">trt_gen</span>,</span>
<span>                            r <span class="op">=</span> <span class="va">n_block</span>,</span>
<span>                            seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Jetzt nehmen wir das Feldbuch und ergänzen nochmal die Positionen <code>rows</code> und <code>cols</code>. Dabei müssen wir die <code>rows</code> etwas komplizierter aus der letzten Ziffer der Variable <code>plots</code> durch die Funktion <code>str_sub()</code> extrahieren. Sonst passt es leider nicht ganz mit den jeweiligen Positionen. Die Spalten <code>cols</code> sind unsere Blöcke.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">augmented_book_tbl</span> <span class="op">&lt;-</span> <span class="va">augmented_obj</span><span class="op">$</span><span class="va">book</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">block</span><span class="op">)</span>,</span>
<span>         rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu">str_sub</span><span class="op">(</span><span class="va">plots</span>, <span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Es ist eine gute Idee sich die Linien und die Standards einmal unterschiedlich einzufärben. Ich nutze für die Linien einen Gradienten von Blau und für die Standardbehandlungen einen Gradienten von Orange. Wir erschaffen uns also einen Vektor mit Farbnamen gleich der Anzahl an Linien plus den zwei Standards.</p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">blue_15</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span>colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#56B4E9"</span>, <span class="st">"#0072B2"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">15</span><span class="op">)</span> </span>
<span><span class="va">orange_03</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span>colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#E69F00"</span>, <span class="st">"#D55E00"</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> </span>
<span><span class="va">blue_15_and_orange_03</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">blue_15</span>, <span class="va">orange_03</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann müssen wir noch den Farbvektor korrekt benennen, so dass die Behandlung im Namen steht und darunter im Vektor dann der Farbwert.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">blue_15_and_orange_03</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">augmented_book_tbl</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">trt</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">sort</span> <span class="op">%&gt;%</span> <span class="va">unique</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann können wir schon in der <a href="#fig-exp-basic-8">Abbildung&nbsp;<span>55.12</span></a> einmal das <em>augmented design</em> einmal anschauen. Es ist schön zu sehen, das pro Reihe und damit Block beide Standards zufällig auf der Parzelle auftauchen. Auf der anderen Seite sind nicht alle fünfzehn Linien in jedem Block enthalten. Wir sparen mit dem <em>augmented design</em> auf jeden Fall Platz auf dem Feld und können so mehr Linien testen, asl wir es mit einem RCBD gekonnt hätten.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">desplot</span><span class="op">(</span><span class="va">trt</span> <span class="op">~</span> <span class="va">rows</span> <span class="op">+</span> <span class="va">cols</span>, flip <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        out1 <span class="op">=</span> <span class="va">block</span>, out1.gpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>        col.regions <span class="op">=</span> <span class="va">blue_15_and_orange_03</span>,  </span>
<span>        text <span class="op">=</span> <span class="va">trt</span>, cex <span class="op">=</span> <span class="fl">1</span>, shorten <span class="op">=</span> <span class="st">"no"</span>,</span>
<span>        data <span class="op">=</span> <span class="va">augmented_book_tbl</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Pflanzschema für ein *augmented design* mit zwei Standards."</span>", </span>
<span>        show.key <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exp-basic-8" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="experimental-design-basic_files/figure-html/fig-exp-basic-8-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;55.12— Schema der Pflanzungen nach den Behandlungen für das augmented design. Die Standardbedingungen sind vollständig in den Blöcken randomisiert, die genetischen Linien nur nicht komplett.</figcaption></figure>
</div>
</div>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./experimental-design-r.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./experimental-design-advanced.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik">

<title>Bio Data Science - 17&nbsp; Visualisierung von Daten</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./eda-distribution.html" rel="next">
<link href="./eda-descriptive.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Bio Data Science - 17&nbsp; Visualisierung von Daten">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./eda-preface.html">Explorative Datenanalyse</a></li><li class="breadcrumb-item"><a href="./eda-ggplot.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Dunkelmodus umschalten"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>purrr</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der Post-hoc-Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link active" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">17.1</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">17.2</span> Daten</a></li>
  <li><a href="#grundlagen-in-ggplot" id="toc-grundlagen-in-ggplot" class="nav-link" data-scroll-target="#grundlagen-in-ggplot"><span class="header-section-number">17.3</span> Grundlagen in <code>{ggplot}</code></a></li>
  <li><a href="#die-häufigsten-abbildungen" id="toc-die-häufigsten-abbildungen" class="nav-link" data-scroll-target="#die-häufigsten-abbildungen"><span class="header-section-number">17.4</span> Die häufigsten Abbildungen</a>
  <ul class="collapse">
  <li><a href="#sec-eda-barplot" id="toc-sec-eda-barplot" class="nav-link" data-scroll-target="#sec-eda-barplot"><span class="header-section-number">17.4.1</span> Barplot</a></li>
  <li><a href="#sec-eda-boxplot" id="toc-sec-eda-boxplot" class="nav-link" data-scroll-target="#sec-eda-boxplot"><span class="header-section-number">17.4.2</span> Boxplot</a></li>
  <li><a href="#sec-eda-scatter" id="toc-sec-eda-scatter" class="nav-link" data-scroll-target="#sec-eda-scatter"><span class="header-section-number">17.4.3</span> Scatterplot</a></li>
  <li><a href="#sec-eda-mosaic" id="toc-sec-eda-mosaic" class="nav-link" data-scroll-target="#sec-eda-mosaic"><span class="header-section-number">17.4.4</span> Mosaicplot</a></li>
  <li><a href="#sec-eda-histogramm" id="toc-sec-eda-histogramm" class="nav-link" data-scroll-target="#sec-eda-histogramm"><span class="header-section-number">17.4.5</span> Histogramm</a></li>
  <li><a href="#density-plot" id="toc-density-plot" class="nav-link" data-scroll-target="#density-plot"><span class="header-section-number">17.4.6</span> Density Plot</a></li>
  <li><a href="#sec-eda-dotplot" id="toc-sec-eda-dotplot" class="nav-link" data-scroll-target="#sec-eda-dotplot"><span class="header-section-number">17.4.7</span> Dotplot, Beeswarm und Raincloud Plot</a></li>
  <li><a href="#sec-eda-violinplot" id="toc-sec-eda-violinplot" class="nav-link" data-scroll-target="#sec-eda-violinplot"><span class="header-section-number">17.4.8</span> Violinplot</a></li>
  </ul></li>
  <li><a href="#optionen-in-ggplot" id="toc-optionen-in-ggplot" class="nav-link" data-scroll-target="#optionen-in-ggplot"><span class="header-section-number">17.5</span> Optionen in <code>{ggplot}</code></a>
  <ul class="collapse">
  <li><a href="#überschriften-achsen-und-legenden" id="toc-überschriften-achsen-und-legenden" class="nav-link" data-scroll-target="#überschriften-achsen-und-legenden"><span class="header-section-number">17.5.1</span> Überschriften, Achsen und Legenden</a></li>
  <li><a href="#abbildungen-abspeichern" id="toc-abbildungen-abspeichern" class="nav-link" data-scroll-target="#abbildungen-abspeichern"><span class="header-section-number">17.5.2</span> Abbildungen abspeichern</a></li>
  <li><a href="#sec-eda-tex" id="toc-sec-eda-tex" class="nav-link" data-scroll-target="#sec-eda-tex"><span class="header-section-number">17.5.3</span> Mathematische Ausdrücke in den Achsenbeschriftungen</a></li>
  <li><a href="#farbpaletten" id="toc-farbpaletten" class="nav-link" data-scroll-target="#farbpaletten"><span class="header-section-number">17.5.4</span> Farbpaletten</a></li>
  <li><a href="#abbildungen-nebeneinander" id="toc-abbildungen-nebeneinander" class="nav-link" data-scroll-target="#abbildungen-nebeneinander"><span class="header-section-number">17.5.5</span> Abbildungen nebeneinander</a></li>
  <li><a href="#gebrochene-y-achse" id="toc-gebrochene-y-achse" class="nav-link" data-scroll-target="#gebrochene-y-achse"><span class="header-section-number">17.5.6</span> Gebrochene <span class="math inline">\(y\)</span>-Achse</a></li>
  </ul></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/eda-ggplot.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/eda-ggplot.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./eda-preface.html">Explorative Datenanalyse</a></li><li class="breadcrumb-item"><a href="./eda-ggplot.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-eda-ggplot" class="quarto-section-identifier"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 13. September 2024 um 09:22:28</em></p>
<blockquote class="blockquote">
<p><em>“The greatest value of a picture is when it forces us to notice what we never expected to see.” — John Tukey</em></p>
</blockquote>
<p>Worum geht es in der explorativen Datenanalyse? Die explorative Datenanalyse wurde von <a href="https://de.wikipedia.org/wiki/John_W._Tukey">John Tukey (1915–2000)</a> begründet. Er war ein Pionier im Bereich der frühen Informatik und Computerwissenschaften. Warum explorativ, was wollen wir den erforschen? Denn nichts anderes bedeutet ja explorativ (deu. <em>erforschend, erkundend, untersuchend</em>) – wir wollen etwas entdecken. Die Idee war ziemlich innovativ und neu als <span class="citation" data-cites="tukey1977exploratory">Tukey u.&nbsp;a. (<a href="#ref-tukey1977exploratory" role="doc-biblioref">1977</a>)</span> in seinem Buch die explorative Datenanalyse erstmal als Begriff vorstellte. Schon vorher beschrieb <span class="citation" data-cites="tukey1962future">Tukey (<a href="#ref-tukey1962future" role="doc-biblioref">1962</a>)</span> in seinem Artikel “The Future of Data Analysis” die zukünftige Datenanalyse, wie Tukey sie sich vorstellte, was auch sein folgendes Zitat belegt.</p>
<blockquote class="blockquote">
<p><em>“I know of no person or group that is taking nearly adequate advantage of the graphical potentialities of the computer.” — John Tukey</em></p>
</blockquote>
<p>Nun musst du wissen, dass in den 60’ziger Jahren der Computer in den Kinderschuhen steckte. Mal eben eine Berechnung durchführen, dass war dann schon so eine Sache der damaligen Zeit. Vieles bis fast alles wurde als Tabellen veröffentlicht und selten wurde eine Abbildung <em>händisch</em> dazu erstellt. An dieser Stelle sei einmal auf die <a href="https://youtu.be/kOO31qFmi9A?si=wHkm7frVVlH2e_SF">Microsoft Excel Werbung aus dem Jahr 1990</a> verwiesen. Daher war die Idee, sich Daten zu visualisieren entsprechend neu und wirklich ein wissenschaftlicher Fortschritt. Erstaunlicherweise glauben wir heute manchmal dann Zahlen in einer Tabelle mehr als einer Abbildung. Wir schreiben dann den Zahlen eine größere Genauigkeit und Aussagekraft zu, als einer explorativen Abbildung. Dabei können wir in einer Abbildung viel mehr sehen, als in einer Tabelle.</p>
<blockquote class="blockquote">
<p><em>“There is no data that can be displayed in a pie chart, that cannot be displayed BETTER in some other type of chart.” — John Tukey</em></p>
</blockquote>
<div id="fig-wumo-pie" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wumo-pie-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/cake_chart.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-1" data-gallery="quarto-lightbox-gallery-1"><img src="images/eda/cake_chart.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wumo-pie-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.1— “The reason to avoid pie charts” Quelle: wumo.com
</figcaption>
</figure>
</div>
<p>Daher ist ein wichtiger Teil in der Analyse von Daten die Visualisierung und damit die Darstellung in einer Abbildung. Wir haben aber eine großem Auswahl an möglichen Abbildungen, deshalb auch das lange Kapitel hier. Siehe dazu auch die Arbeit von <span class="citation" data-cites="riedel2022replacing">Riedel u.&nbsp;a. (<a href="#ref-riedel2022replacing" role="doc-biblioref">2022</a>)</span> mit dem Titel <a href="https://portlandpress.com/clinsci/article/136/15/1139/231562/Replacing-bar-graphs-of-continuous-data-with-more">Replacing bar graphs of continuous data with more informative graphics: are we making progress?</a> um mehr über die Nutzung der Abbildungen im Laufe der Zeit zu erfahren. Nicht alles was schon immer genutzt wurde, macht auch Sinn weiter genutzt zu werden. Wir haben mit R und <code>{ggplot}</code> eine Möglichkeit Abbildungen von Daten sehr viel besser zu erstellen als noch vor ein paar Jahrzehnten möglich war.</p>
<p>Grundsätzlich glauben wir dabei keiner Auswertung eines mathematischen Algorithmus, wenn wir nicht die Bestätigung in einer Abbildung sehen. Wenn wir also einen signifikanten Unterschied aus einem Algorithmus wiedergegeben bekommen, dann müssen wir auch den Unterschied in einer Abbildung sehen können. Eine statistische Analyse und deren Visualisierung gehen Hand in Hand. Daher ist die Visualisierung die Grundlage für ein fundiertes, wissenschaftliches Arbeiten. In diesem Kapitel stelle ich dir verschiedene Abbildungen vor, die uns helfen werden zu Verstehen ob es einen Zusammenhang zwischen <span class="math inline">\(y\)</span> und <span class="math inline">\(x\)</span> gibt. Wir haben ein <span class="math inline">\(y\)</span> vorliegen, was wir auf die y-Achse eines Graphen legen und daneben dann mehrere Variablen bzw. Spalten die wir <span class="math inline">\(x\)</span> nennen. Eine der Variablen legen wir auf die x-Achse des Graphen. Nach den anderen <span class="math inline">\(x\)</span> färben wir die Abbildung ein. Wir nennen dabei eine Abbildung auch häufig Plot. Das ist der englische Begriff und hat nichts in unserem Kontext mit einer Fläche oder einer Handlung in einem Film zu zu tun. Im den beiden folgenden Abbildungen siehst du einmal die beiden häufigsten wissenschaftlichen Fragestellungen in der explorativen Datenanalyse.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-eda-overview-01" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eda-overview-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-eda-overview-01-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="quarto-lightbox-gallery-2"><img src="eda-ggplot_files/figure-html/fig-eda-overview-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1152"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eda-overview-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.2— Visualisierung der beiden häufigsten wissenschaftlichen Fragestellungen in der explorativen Datenanalyse. <strong>(A)</strong> <em>Die Frage nach dem Unterschied.</em> Unterschieden sich die Gruppen auf der x-Achse gegeben den Werten auf der y-Achse? Um den Unterschied darzustellen können Barplots oder Boxplots verwendet werden. <strong>(B)</strong> <em>Die Frage nach dem Zusammenhang.</em> Wie verändern sich die Werte der y-Achse, wenn sich die Werte auf der x-Achse ändern? Um den Zusammenhang zu zeigen kann ein Scatterplot verwendet werden. Die Gerade durch die Punkte kann durch eine (nicht) lineare Regression bestimmt werden. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>In diesem Kapitel wollen wir durch die bedeutendsten Abbildungen in der explorativen Datenanalyse durchgehen. Ich habe die Abbildungen etwas nach Kontext sortiert und geschaut, dass die Abbildungen zum Gruppennterschied oder Zusammenhang zweier Variablen als erstes besprochen werden.</p>
<ul>
<li><a href="#sec-eda-barplot">Barplot</a> für 5 und mehr Beobachtungen (pro Gruppe). Der Barplot oder das <em>Balkendiagramm</em> bzw. <em>Säulendiagramm</em> stellt den Mittelwert und die Standardabweichung da.</li>
<li><a href="#sec-eda-boxplot">Boxplot</a> für 5 bis 20 Beobachtungen (pro Gruppe). Ebenso wie bei einem Histogramm, geht es bei einem Boxplot auch um die Verteilung der einer Variable. Wir können in einem Boxplot auch erkennen, ob sogenannte auffällige Werte oder Ausreißer vorliegen.</li>
<li><a href="#sec-eda-scatter">Scatterplot</a> für zwei kontinuierliche Variablen. Auch <em>xy-Plot</em> genannt. Die Abbildung, die dir bekannt sein müsste. Wir zeichnen hier eine Grade durch eine Punktewolke.</li>
<li><a href="#sec-eda-mosaic">Mosaicplot</a> für zwei diskrete Variablen. Eine etwas seltene Abbildung, wenn wir Variablen abbilden wollen, die diskret sind bzw. aus Kategorien bestehen.</li>
<li><a href="#sec-eda-histogramm">Histogramm</a> für mehr als 20 Beobachtungen (pro Gruppe). Wir nutzen ein Histogramm um die Verteilung einer Variable zu visualisieren.</li>
<li><a href="#sec-eda-dotplot">Dotplot</a> für 3 bis 5 Beobachtungen (pro Gruppe). Hier geht es weniger um die Verteilung der Variable, sondern darum die wenigen Beobachtungen zu visualisieren.</li>
<li><a href="#sec-eda-violinplot">Violinplot</a> für die Kombination von einem Densityplot und einem Boxplot. Dann können wir hier noch den Dotplot ergänzen und haben eine sehr informative Übersichtsabbildung.</li>
</ul>
<p>Beginnen wir also mit dem Teil, der in der Statistik der mir immer am meisten Spaß macht. Oder aber um es in den Worten von John Tukey, den Begründer der explorativen Datenanalyse zu sagen:</p>
<blockquote class="blockquote">
<p><em>“This is my favorite part about analytics: Taking boring flat data and bringing it to life through visualization.” — John Tukey</em></p>
</blockquote>
<p>Wir immer geht natürlich hier auch noch viel mehr am Abbildungen. Du musst nicht alles in <code>ggplot</code> machen und darüber hinaus gibt es dann auch noch einiges an anderen R Paketen. In dem folgenden Kasten habe ich dir mal ein paar Quellen rausgesucht, wo du einmal gucken kannst, wenn du noch mehr Inspiration benötigst. Ich nutze die Seiten auch als Inspiration, den meisten weiß man gar nicht was alles geht, bis man die Visualisierung gesehen hat.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Möglichkeiten der Visualisierung
</div>
</div>
<div class="callout-body-container callout-body">
<p>Im Folgenden einmal eine Auswahl an weiteren Möglichkeiten sich Abbildungen in R zu visualisieren. Teilweise ist es dann auch eine Sammlung an Informationen für mich, damit ich eine Idee habe, was noch so alles geht. Manchmal braucht man ja auch noch eine zusätzlich Inspiration.</p>
<ul>
<li><a href="https://rstudio.github.io/cheatsheets/html/data-visualization.html">Data visualization with ggplot2 :: Cheat Sheet</a> – als Überblick über alles was eigentlich in <code>ggplot</code> möglich ist. Du kriegst dann nochmal ein Überblick über die <code>geom</code>e, die es gibt und wie die einzelnen Funktionen und Möglichkeiten miteinander interagieren. Du kannst dir das Cheat Sheet auch auf Deutsch runterladen.<br>
</li>
<li><a href="https://r-charts.com/">R Charts by R Coder</a> – ein großer Überblick über alle möglichen Abbildungen sortiert nach verschiedenen Kategorien. Hier würde ich auf jeden Fall mal drüber schauen, dann kriegst du nochmal eine Idee was neben <code>ggplot</code> noch so alles geht. Ich finde die Seite immer sehr inspirierend.</li>
<li><a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/">ALL YOUR FIGURE ARE BELONG TO US</a> ist eine weitere tolle Übersicht an möglichen Abbildungen in <code>{ggplot}</code> Universum. Die Übersicht zeigt nochmal verschiedene R Pakte mit den entsprechenden möglichen Abbildungen.</li>
<li><a href="https://strengejacke.github.io/sjPlot/">sjPlot - Data Visualization for Statistics in Social Science</a> – auch hier geitbes dann die Möglichkeit nochmal etwas anders auf die Visualisierung zu schauen. Denn hier haben wir dann die Möglichkeiten der Sozialwissenschaften mehr abgedeckt. Das mag insbesondere im Bereich von Fragebögen und Marketing von Interesse sein.</li>
<li>Als spannende zusätzlichen Ressourcen seinen das <a href="https://wilkelab.org/cowplot/index.html">R Paket <code>{cowplot}</code></a> sowie das <a href="https://rpkgs.datanovia.com/ggpubr/index.html">R Paket <code>{ggpubr}</code></a> genannt. Besonders das Paket <code>cowplot</code> liefert noch schöne Formatierungsmöglichkeiten wobei dann <code>ggpubr</code> statistische Test mit der Visualisierung verbindet.</li>
<li><a href="https://plotly.com/r/">{plotly} R Open Source Graphing Library</a> sowie im besonderen dann die Seite <a href="https://plotly.com/ggplot2/getting-started/">Getting Started with {plotly} in {ggplot2}</a> liefert dann interaktive Abbildungen, wo du dann direkt hereinzoomen kannst. Das ist bei sehr großen Abbildungen immer sehr praktisch. Auch kannst du die Werte einer einzelnen Beobachtung gleich im Plot ablesen.</li>
<li><a href="https://bbc.github.io/rcookbook/">How to create BBC style graphics</a> – einmal als ein Beispiel für die Anwendung von <code>ggplot</code> in der Wirtschaft und Data Science. Auch hier sieht man schön die Ideen die möglich sind.</li>
<li><a href="https://www.cedricscherer.com/2021/06/06/visualizing-distributions-with-raincloud-plots-and-how-to-create-them-with-ggplot2/">Visualizing Distributions with Raincloud Plots (and How to Create Them with ggplot2)</a> – manchmal ist dann der Barplot oder Dynamiteplot dann doch irgendwie nicht das richtige Werkzeug um die Daten zu zeigen. Daher hier nochmal der Blogpost mit einer Diskussion was neben dem Säulendiagramm noch so alles gehen könnte.</li>
<li><a href="https://z3tt.github.io/OutlierConf2021/">ggplot Wizardry Hands-On</a> zeigt nochmal sher schön was alles in <code>{ggplot}</code> geht, wenn die entsprechenden zusätzlichen Pakete geladen werden. Ich schaue auch hier immer mal wieder rein, wenn ich eine Abbildung besonders schön machen möchte. Hier liegt dann der Fokus auf dem <a href="https://erocoar.github.io/gghalves/">R Paket<code>{gghalves}</code></a> sowie dem <a href="https://mjskay.github.io/ggdist/">R Paket <code>{ggdist}</code></a>.</li>
<li>Die Publikation <a href="https://rupress.org/jcb/article/177/1/7/34602/Error-bars-in-experimental-biology">Error bars in experimental biology</a> von <span class="citation" data-cites="cumming2007error">Cumming u.&nbsp;a. (<a href="#ref-cumming2007error" role="doc-biblioref">2007</a>)</span> liefert nochmal einen Überblick über Fehlerbalken und welche Fehlerbalken man den nun nutzen sollte.</li>
</ul>
</div>
</div>
<section id="genutzte-r-pakete" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">17.1</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, readxl, ggmosaic, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               janitor, see, patchwork, latex2exp, ggbeeswarm,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               ggdist, gghalves, ggbreak, duke, wesanderson, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               conflicted)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>summarise)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>filter)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(latex2exp<span class="sc">::</span>TeX)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="daten"><span class="header-section-number">17.2</span> Daten</h2>
<p>Wir importieren also den Datensatz <code>flea_cat_dog.xlsx</code> und wollen einzelne Variablen visualisieren. Wir kennen den Datensatz schon aus den vorherigen Beispielen. Dennoch nochmal hier der Datensatz in <a href="#tbl-cat-dog-ggplot" class="quarto-xref">Tabelle&nbsp;<span>17.1</span></a> einmal dargestellt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>flea_dog_cat_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/flea_dog_cat.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Im Folgenden ist es wichtig, dass du dir die Spaltennamen merkst. Wir können nur die exakten, wortwörtlichen Spaltennamen verwenden. Sonst erhalten wir einen Fehler. Deshalb haben wir auch keine Leerzeichen in den Spaltennamen.</p>
<div class="cell">
<div id="tbl-cat-dog-ggplot" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cat-dog-ggplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;17.1— Tabelle von sieben Hunde- und Katzenflöhen mit der Sprunglänge [cm], Anzahl an Haaren am rechten Flohbein, Gewicht der Flöhe, Boniturnote sowie der Infektionsstatus für Flohschnupfen.
</figcaption>
<div aria-describedby="tbl-cat-dog-ggplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">jump_length</th>
<th style="text-align: center;">flea_count</th>
<th style="text-align: center;">weight</th>
<th style="text-align: center;">grade</th>
<th style="text-align: center;">infected</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.7</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">2.1</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.9</td>
<td style="text-align: center;">22</td>
<td style="text-align: center;">2.3</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">11.8</td>
<td style="text-align: center;">17</td>
<td style="text-align: center;">2.8</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">5.6</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">2.4</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">9.1</td>
<td style="text-align: center;">23</td>
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">8.2</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">4.1</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dog</td>
<td style="text-align: center;">7.6</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">3.2</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">1.1</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">2.2</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">2.1</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">5.4</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">2.4</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">4.1</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">2.1</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">4.3</td>
<td style="text-align: center;">16</td>
<td style="text-align: center;">1.5</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">7.9</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">3.7</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">2.9</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Wir brauchen dann ab und an auch nochmal mehr Datenpunkte, daher nehmen wir auch einmal den Gummibärchendatensatz und schauen uns dort die Variablen <code>gender</code>, <code>height</code> und <code>age</code> einmal genauer an. Wie immer nutzen wir die Funktion <code>select()</code> um die Spalten zu selektieren. Abschließend verwandeln wir das Geschlecht <code>gender</code> noch in einen Faktor und entfernen alle fehlenden Werte mit <code>na.omit()</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>gummi_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/gummibears.xlsx"</span>)  <span class="sc">|&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gender, height, age) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"männlich"</span>, <span class="st">"weiblich"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="grundlagen-in-ggplot" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="grundlagen-in-ggplot"><span class="header-section-number">17.3</span> Grundlagen in <code>{ggplot}</code></h2>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/SGwSVzJ9C-s" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Wir nutzen in R das R Paket <code>{ggplot2}</code> um unsere Daten zu visualisieren. Die zentrale Idee von <code>{ggplot2}</code> ist, dass wir uns eine Abbildung wie ein Sandwich bauen. Zuerst legen wir eine Scheibe Brot hin und legen uns dann Scheibe für Scheibe weitere Schichten übereinander. Oder die Idee eines Bildes, wo wir erst die Leinwand definieren und dann Farbschicht über Farbschicht auftragen. Im Gegensatz zu dem Pipe-Operator <code>|&gt;</code> nutzt <code>{ggplot2}</code> den Operator <code>+</code> um die verschiedenen Funktionen (<code>geom_</code>) miteinander zu verbinden. Das Konzept von <code>{ggplot2}</code>ist schlecht zu be<em>schreiben</em> deshalb habe ich auch noch zwei Videos hierfür gemacht. Um den Prozess von <code>{ggplot2}</code> zu visualisieren - aber wie immer, nutze was du brauchst.</p>
<p>Erstellen wir also erstmal unseren erste Visualisierung in dem R Paket <code>{ggplot2}</code>. Im Folgenden spreche ich dann aber immer von <code>{ggplot}</code>. Die Funktion <code>ggplot()</code> ist die zentrale Funktion, die die Leinwand erschafft auf der wir dann verschiedene Schichten aufbringen werden. Diese Schichten heißen <code>geom</code>. Es gibt nicht nur ein <code>geom</code> sondern mehrere. Zum Beispiel das <code>geom_boxplot()</code> für die Erstellung von Boxplots, das <code>geom_histogram()</code> für die Erstellung von Histogrammen. <a href="https://ggplot2.tidyverse.org/reference/index.html">Die Auswahl ist riesig</a>. Die einzelnen Schichten werden dann über den Operator <code>+</code> miteinander verbunden. Soviel erstmal zur Trockenübung. Schauen wir uns das ganze einmal an einem Beispiel an. Dafür müssen wir dann erstmal einen Datensatz laden, damit wir auch etwas zum abbilden haben.</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/SRRQQO3DXtc" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Wie immer empfehle ich dir dann auch das entsprechende Video auf YouTube anzuschauen. In Textform ist eine echte Herausforderung zu erklären wie man Plots baut. Der folgende R Code erstellt die Leinwand in der <a href="#fig-ggplot-1" class="quarto-xref">Abbildung&nbsp;<span>17.3</span></a> für die folgende, zusätzliches Schichten (<code>geom</code>). Wir haben also immer erst eine leere Leinwand auf der wir dann zusätzlich <code>geom</code>e plotten. Wir bauen uns sozusagen ein Sandwich.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal , <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir schauen uns einmal den Code im Detail an.</p>
<ul>
<li><code>ggplot</code> ruft die Funktion auf. Die Funktion ist dafür da den Plot zu zeichnen.</li>
<li><code>data = flea_dog_cat_tbl</code> benennt den Datensatz aus dem der Plot gebaut werden soll.</li>
<li><code>aes()</code>ist die Abkürzung für <em>aesthetics</em> und beschreibt, was auf die <span class="math inline">\(x\)</span>-Achse soll, was auf die <span class="math inline">\(y\)</span>-Achse soll sowie ob es noch andere Faktoren in den Daten gibt. Wir können nämlich noch nach anderen Spalten die Abbildung einfärben oder anderweitig ändern.
<ul>
<li><code>x</code> braucht den Spaltennamen für die Variable auf der <span class="math inline">\(x\)</span>-Achse.</li>
<li><code>y</code> braucht den Spaltennamen für die Variable auf der <span class="math inline">\(y\)</span>-Achse.</li>
</ul></li>
<li><code>+ theme_minimal()</code> setzt das Canvas oder die Leinwand auf schwarz/weiß. Sonst wäre die Leinwand flächig grau.</li>
</ul>
<p>Mit <em>Faktoren</em> meine ich hier andere Gruppenvariablen. Variablen sind ein anderes Wort für Spalten. Also Variablen die wir mit <code>as_factor</code> erschaffen haben und die uns noch mehr über unsere Daten dann verraten können. Hier ist es dann etwas abstrakt, aber es wird dann später in der Anwendung klarer.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="quarto-lightbox-gallery-3"><img src="eda-ggplot_files/figure-html/fig-ggplot-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.3— Leere ggplot() Leinwand mit den Spalten <code>animal</code> und <code>jump_length</code> aus dem Datensatz <code>flea_dog_cat_tbl</code>. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Am Ende sehen wir, dass wir nichts sehen. In der <a href="#fig-ggplot-1" class="quarto-xref">Abbildung&nbsp;<span>17.3</span></a> ist nichts dargestellt. Der Grund ist, dass wir noch kein <code>geom</code> hinzugefügt haben. Das <code>geom</code> beschreibt nun wie die Zahlen in der Datentabelle <code>flea_dog_cat_tbl</code> visualisiert werden sollen. Wir habe eine sehr große Auswahl an <code>geom</code>en, deshalb gibt es gleich einmal eine Auswahl an Abbildungen.</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Auf der Seite <a href="https://exts.ggplot2.tidyverse.org/gallery/">ggplot2 extensions</a> gibt es noch eine Vielzahl an weiteren tollen Möglichkeiten zu entdecken! Einfach durch die Galerie mit über 120 Erweiterungen streifen und sich inspirieren lassen!</p>
</div>
</div>
</div>
</section>
<section id="die-häufigsten-abbildungen" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="die-häufigsten-abbildungen"><span class="header-section-number">17.4</span> Die häufigsten Abbildungen</h2>
<p>Im Folgenden gehen wir dann einmal die wichtigsten Abbildungen einmal durch. Viele der Abbildungen kennst du vielleicht schon und dann musst du hier nur noch schauen, wie die Abbildungen in <code>ggplot</code> zu realisieren sind. Ansonsten gilt wie immer, es ist nur ein kleiner Ausschnitt, du findest auf der <a href="https://ggplot2.tidyverse.org/index.html">Hilfeseite von <code>ggplot</code></a> eine sehr viel größere Übersicht.</p>
<section id="sec-eda-barplot" class="level3" data-number="17.4.1">
<h3 data-number="17.4.1" class="anchored" data-anchor-id="sec-eda-barplot"><span class="header-section-number">17.4.1</span> Barplot</h3>
<p>Der Barplot oder das Balkendiagramm auch Säulendiagramm ist <em>eigentlich</em> veraltet. Wir haben mit dem Boxplot eine viel bessere Methode um eine Verteilung und gleichzeitig auch die Gruppenunterschiede zu visualisieren. Warum nutzen wir jetzt so viel den Barplot? Das hat damit zu tun, dass früher - oder besser bis vor kurzem - in Excel kein Boxplot möglich war. Daher nutzte jeder der mit Excel seine Daten auswertet den Barplot.</p>
<dl>
<dt>Muss die 0 mit auf die y-Achse?</dt>
<dd>
<p>Der <em>einzige</em> Grund, warum wir einen Barplot nutzen wollen würden, wäre wenn wir unbedingt die 0 mit auf der y-Achse haben wollten.</p>
</dd>
</dl>
<p>Weil aber eben noch viel der Barplot genutzt wird, stelle ich natürlich den Barplot auch hier vor. Der Barplot beinhaltet aber weniger Informationen als der Boxplot. Wir haben nur die Standardabweichung als Maßzahl für die Streuung. Beim Boxplot haben wir den Interquartilesabstand (abk . <em>IQR</em>), der uns mehr über die Streuung aussagt. Aber gut, häufig musst du den Barplot in deiner Abschlussarbeit machen. Zuerst betrachten wir die theoretische Darstellung. Dann zeige ich dir die Werte für unsere Sprungweiten der Hundeflöhe. Im letzten Tab findest du dann die Implementierung in <code>{ggplot}</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false"><code>{ggplot}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>In den folgenden beiden Abbildungen siehst du einmal zwei Säulendigramme. Die Säulen gehen exakt so hoch wie der Mittelwert <span class="math inline">\(\bar{y}\)</span> der entsprechenden Gruppe <span class="math inline">\(A\)</span>. Dann berechnen wir noch für die Fehlerbalken die Standardabweichung (abk. <em>SD</em>). Je nachdem wie wir die Säulendigramme darstellen wollen, zeigen wir nur <span class="math inline">\(\bar{y} + SD\)</span> oder aber <span class="math inline">\(\bar{y} \pm SD\)</span>. Hier gibt es keine richtige Regel, das hängt sehr vom Geschmack ab und unterscheidet sich auch von Publikation zu Publikation. Je nachdem was wir als Outcome gemessen haben, können wir auch Überlegen anstatt der Standardabweichung den Standardfehler (abk. <em>SE</em>) zu nutzen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-barplot-drawn-01" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-barplot-drawn-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-barplot-drawn-01-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="quarto-lightbox-gallery-4"><img src="eda-ggplot_files/figure-html/fig-barplot-drawn-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-barplot-drawn-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.4— Darstellung der Mittelwerte <span class="math inline">\(\bar{y}\)</span> und der Standardabweichung (abk. <em>SD</em>) in einem Säulendigramm. Es gibt zwei Arten der Darstellung, die sich dann auf die Fehlerbalken bezieht. <strong>(A)</strong> Nur mit <span class="math inline">\(\bar{y} + SD\)</span> <strong>(B)</strong> Mit <span class="math inline">\(\bar{y} \pm SD\)</span>. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>In den beiden folgenden Abbildungen siehst du einmal die Sprungweite der Hundeflöhe als ein Säulendigramm dargestellt. Wir haben den Mittelwert mit 8.13 sowie die Standardabweichung mit 2.14 berechnet. Daraus ergeben sich dann die Grenzen der Fehlerbalken. Ich habe dann in der rechten Abbildung die Fehlerbalken dann noch mit dem Standardfehler von 0.81 dargestellt. Wie du siehst, werden dann die Fehlerbalken kleiner, der Mittelwert bleibt natürlich in beiden Fällen gleich. Mehr dazu dann in dem <a href="eda-descriptive.html">Kapitel zur deskriptiven Statistik</a> und unter diesem Kasten.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-barplot-drawn-02" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-barplot-drawn-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-barplot-drawn-02-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-5" data-gallery="quarto-lightbox-gallery-5"><img src="eda-ggplot_files/figure-html/fig-barplot-drawn-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-barplot-drawn-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.5— Darstellung der Mittelwerte <span class="math inline">\(\bar{y}\)</span> und der Standardabweichung (abk. <em>SD</em>) sowie dem Standardfehler (abk. <em>SE</em>) in einem Säulendigramm. <strong>(A)</strong> Mit <span class="math inline">\(\bar{y} \pm SD\)</span> <strong>(B)</strong> Mit <span class="math inline">\(\bar{y} \pm SE\)</span>. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>Wenn wir ein Säulendigramm in <code>ggplot()</code> erstellen wollen, dann müssen wir jetzt den Mittelwert und die Streuung für die Gruppen in unseren Daten der Hunde- und Katzenflöhe berechnen. Du kannst als Streuung die Standardabweichung <code>sd</code> oder den Standardfehler <code>se</code> nehmen. Wir nehmen wir einmal die Standardabweichung für die Abbiildung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>stat_tbl <span class="ot">&lt;-</span> flea_dog_cat_tbl <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(jump_length),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">n</span>()))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir nutzen nun das Objekt <code>stat_tbl</code> um den Barplot mit der Funktion <code>ggplot()</code> zu erstellen. Dabei müssen wir zum einen schauen, dass die Balken nicht übereinander angeordnet sind. Nebeneinander angeordnete Balken kriegen wir mit der Option <code>stat = "identity"</code> in dem <code>geom_bar()</code>. Dann müssen wir noch die Fehlerbalken ergänzen mit dem <code>geom_errorbar()</code>. Hier kann nochmal mit der Option <code>width =</code> an der Länge der Fehlerenden gedreht werden.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-barplot-drawn-03" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-barplot-drawn-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-barplot-drawn-03-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="quarto-lightbox-gallery-6"><img src="eda-ggplot_files/figure-html/fig-barplot-drawn-03-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="336"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-barplot-drawn-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.6— Säulendigramm der Sprungweiten der Hunde- und Katzenflöhe. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Dank der Funktion <code>coord_flip()</code> können wir auch schnell aus dem Säulendiagramm ein Balkendiagramm bauen. Du musst dann immer schauen, was besser in deine Visualisierung passt.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-barplot-drawn-04" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-barplot-drawn-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-barplot-drawn-04-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-7" data-gallery="quarto-lightbox-gallery-7"><img src="eda-ggplot_files/figure-html/fig-barplot-drawn-04-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-barplot-drawn-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.7— Balkendigramm der Sprungweiten der Hunde- und Katzenflöhe. Die Funktion <code>coord_flip()</code> macht aus einem Säulendiagramm ein Balkendiagramm. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Bei der Darstellung des Barplots haben wir die Wahl wie wir den Fehlerbalken darstellen. Dazu haben wir dann verschiedene Maßzahlen zu Auswahl. Theoretisch haben wir die freie Wahl zwischen der Standardabweichung und dem Standardfehler, aber es gibt Ausnahmen.</p>
<dl>
<dt>Standardabweichung (abk. <em>SD</em>) oder Standardfehler (abk. <em>SE</em>) als Fehlerbalken?</dt>
<dd>
<p>Wenn du etwas misst, was natürliche numerische Grenzen hat, wie zum Beispiel relative Anteile <span class="math inline">\([0,1]\)</span> oder aber etwas zählst <span class="math inline">\([0, \infty]\)</span>, dann empfiehlt sich der Standardfehler, da dieser nicht über die numerischen Grenzen geht. Die Standardabweichung kann hier negative Werte oder aber prozentuale Werte größer 1 oder kleiner 0 liefern. Das wollen wir nicht.</p>
</dd>
</dl>
<p>Schau dir auch hier mal in den Kästen zum Zerforschen rein, da findest du dann noch mehr Inspiration aus anderen Abbildungen, die ich nachgebaut habe. Ich bin einmal über den Campus gelaufen und habe geschaut, welche Abbildungen auf den Postern verwendet werden und habe diese nachgebaut.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Einfaktorieller Barplot mit <em>compact letter display</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen einfaktoriellen Barplot oder Säulendiagramm anschauen. Daher fangen wir mit der folgenden Abbildung einmal an. Wir haben hier ein Säulendiagramm mit <em>Compact letter display</em> vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der vier Behandlungen jeweils einmal einen Mittelwert für die Höhe der Säule sowie einmal die Standardabweichung. Die Standardabweichung addieren und subtrahieren wir dann jeweils von dem Mittelwert und schon haben wir die Fehlerbalken.</p>
<div id="fig-ur-barplot" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_simple.png" class="lightbox" data-glightbox="description: .lightbox-desc-8" data-gallery="quarto-lightbox-gallery-8"><img src="images/eda/zerforschen_barplot_simple.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.8— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein simples Säulendiagramm mit sehr für Farbblinde ungünstigen Farben. Es sind die Mittelwerte sowie die Standardabweichung durch die Fehlerbalken dargestellt.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_simple.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die vier Werte alle um den Mittelwert streuen lassen. Dabei habe ich darauf geachtet, dass die Streuung dann in der letzten Behandlung am größten ist. Da wir beim Einlesen keine Umlaute oder sonstige Leerzeichen wollen, habe ich alles sehr simple aufgeschrieben und dann in R in der Funktion <code>factor()</code> richtig über die Option <code>levels</code> sortiert und über die Option <code>labels</code> sauber beschrieben. Dann passt auch die Sortierung der <span class="math inline">\(x\)</span>-Achse.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_simple.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">factor</span>(trt, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"water"</span>, <span class="st">"rqflex"</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"nitra"</span>, <span class="st">"laqua"</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Wasserdestilation"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"RQflex Nitra"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Nitrachek"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Laqua Nitrat"</span>)))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>barplot_tbl </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 2
   trt               nitrat
   &lt;fct&gt;              &lt;dbl&gt;
 1 Wasserdestilation    135
 2 Wasserdestilation    130
 3 Wasserdestilation    145
 4 Wasserdestilation    135
 5 RQflex Nitra         120
 6 RQflex Nitra         130
 7 RQflex Nitra         135
 8 RQflex Nitra         135
 9 Nitrachek            100
10 Nitrachek            120
11 Nitrachek            130
12 Nitrachek            130
13 Laqua Nitrat         230
14 Laqua Nitrat         210
15 Laqua Nitrat         205
16 Laqua Nitrat         220</code></pre>
</div>
</div>
<p>Jetzt brauchen wir noch die Mittelwerte und die Standardabweichung für jede der vier Behandlungen. Den Code kennst du schon von oben wo wir die Barplots für die Sprungweiten der Hunde- und Katzenflöhe gebaut haben. Hier habe ich dann den Code entsprechen der Daten <code>barplot_tbl</code> angepasst. Wir haben ja als Gruppierungsvariabel <code>trt</code> vorliegen und wollen die Mittelwerte und die Standardabweichung für die Variable <code>nitrat</code> berechnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>stat_tbl <span class="ot">&lt;-</span> barplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trt) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(nitrat),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(nitrat))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>stat_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  trt                mean    sd
  &lt;fct&gt;             &lt;dbl&gt; &lt;dbl&gt;
1 Wasserdestilation  136.  6.29
2 RQflex Nitra       130   7.07
3 Nitrachek          120  14.1 
4 Laqua Nitrat       216. 11.1 </code></pre>
</div>
</div>
<p>Und dann haben wir auch schon die <a href="#fig-ggplot-zerforschen-barplot-simple" class="quarto-xref">Abbildung&nbsp;<span>17.9</span></a> erstellt. Ja vielleicht passen die Standardabweichungen nicht so richtig, da könnte man nochmal an den Daten spielen und die Werte solange ändern, bis es besser passt. Du hast aber jetzt eine Idee, wie der Aufbau funktioniert.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="annotated-cell-40"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-40-1"><a href="#annotated-cell-40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> trt, <span class="at">y =</span> mean,</span>
<span id="annotated-cell-40-2"><a href="#annotated-cell-40-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="annotated-cell-40-3"><a href="#annotated-cell-40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-40" data-target-annotation="1">1</button><span id="annotated-cell-40-4" class="code-annotation-target"><a href="#annotated-cell-40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-40" data-target-annotation="2">2</button><span id="annotated-cell-40-5" class="code-annotation-target"><a href="#annotated-cell-40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd),</span>
<span id="annotated-cell-40-6"><a href="#annotated-cell-40-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="annotated-cell-40-7"><a href="#annotated-cell-40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="annotated-cell-40-8"><a href="#annotated-cell-40-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Nitrat-Konzentration </span><span class="sc">\n</span><span class="st"> im Tannensaft [mg/L]"</span>) <span class="sc">+</span></span>
<span id="annotated-cell-40-9"><a href="#annotated-cell-40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">250</span>) <span class="sc">+</span></span>
<span id="annotated-cell-40-10"><a href="#annotated-cell-40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-40" data-target-annotation="3">3</button><span id="annotated-cell-40-11" class="code-annotation-target"><a href="#annotated-cell-40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="annotated-cell-40-12"><a href="#annotated-cell-40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, </span>
<span id="annotated-cell-40-13"><a href="#annotated-cell-40-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.05</span>, <span class="fl">2.05</span>, <span class="fl">3.05</span>, <span class="fl">4.05</span>), </span>
<span id="annotated-cell-40-14"><a href="#annotated-cell-40-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> stat_tbl<span class="sc">$</span>mean <span class="sc">+</span> stat_tbl<span class="sc">$</span>sd <span class="sc">+</span> <span class="dv">8</span>, </span>
<span id="annotated-cell-40-15"><a href="#annotated-cell-40-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"c"</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-40" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-40" data-code-lines="4" data-code-annotation="1">Hier werden die Säulen des Säulendiagramms erstellt.</span>
</dd>
<dt data-target-cell="annotated-cell-40" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-40" data-code-lines="5,6" data-code-annotation="2">Hier werden die Fehlerbalken erstellt. Die Option <code>width</code> steuert wie breit die Fehlerbalken sind.</span>
</dd>
<dt data-target-cell="annotated-cell-40" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-40" data-code-lines="11" data-code-annotation="3">Hier wird eine Farbpalette für farbblinde Personen geladen.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-simple" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-simple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-simple-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-9" data-gallery="quarto-lightbox-gallery-9"><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-simple-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-simple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.9— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_barplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Zweifaktorieller Barplot mit <em>compact letter display</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen zweifaktoriellen Barplot oder Säulendiagramm anschauen. Wir haben hier ein Säulendiagramm mit <em>compact letter display</em> vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der vier Zeitpunkte und der Kontrolle jeweils einmal einen Mittelwert für die Höhe der Säule sowie einmal die Standardabweichung. Die Standardabweichung addieren und subtrahieren wir dann jeweils von dem Mittelwert und schon haben wir die Fehlerbalken.</p>
<div id="fig-ur-barplot-02" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_2fac.png" class="lightbox" data-glightbox="description: .lightbox-desc-10" data-gallery="quarto-lightbox-gallery-10"><img src="images/eda/zerforschen_barplot_2fac.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.10— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit zwei Faktoren Zeit und die Iodine Form.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_2fac_target.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die drei Werte alle um den Mittelwert streuen lassen. Da wir beim Einlesen keine Umlaute oder sonstige Leerzeichen wollen, habe ich alles sehr simple aufgeschrieben und dann in R in der Funktion <code>factor()</code> richtig über die Option <code>levels</code> sortiert und über die Option <code>labels</code> sauber beschrieben. Dann passt auch die Sortierung der <span class="math inline">\(x\)</span>-Achse.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_2fac_target.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">factor</span>(time, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"ctrl"</span>, <span class="st">"7"</span>, <span class="st">"11"</span>, <span class="st">"15"</span>, <span class="st">"19"</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Contr."</span>, <span class="st">"07:00"</span>, <span class="st">"11:00"</span>, <span class="st">"15:00"</span>, <span class="st">"19:00"</span>)),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">as_factor</span>(type))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>barplot_tbl </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 × 3
   time  type  iodine
   &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
 1 07:00 KIO3      50
 2 07:00 KIO3      55
 3 07:00 KIO3      60
 4 07:00 KI        97
 5 07:00 KI        90
 6 07:00 KI        83
 7 11:00 KIO3      73
 8 11:00 KIO3      75
 9 11:00 KIO3      78
10 11:00 KI       130
# ℹ 17 more rows</code></pre>
</div>
</div>
<p>Jetzt brauchen wir noch die Mittelwerte und die Standardabweichung für jede der vier Behandlungen. Hier nur kurz, den Code kennst du schon aus anderen Zerforschenbeispielen zu den Barplots.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>stat_tbl <span class="ot">&lt;-</span> barplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, type) <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(iodine),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(iodine))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>stat_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
# Groups:   time [5]
  time   type   mean    sd
  &lt;fct&gt;  &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Contr. KIO3    5    3   
2 07:00  KIO3   55    5   
3 07:00  KI     90    7   
4 11:00  KIO3   75.3  2.52
5 11:00  KI    150   20   
6 15:00  KIO3   80    7   
7 15:00  KI    130   20   
8 19:00  KIO3   90.3 19.5 
9 19:00  KI     95    6   </code></pre>
</div>
</div>
<p>Und dann geht es auch schon los. Wir müssen am Anfang einmal <code>scale_x_discrete()</code> setzen, damit wir gleich den Zielbereich ganz hinten zeichnen können. Sonst ist der blaue Bereich im Vordergrund. Dann färben wir auch mal die Balken anders ein. Muss ja auch mal sein. Auch nutzen wir die Funktion <code>geom_text()</code> um das <em>compact letter display</em> gut zu setzten. Die <span class="math inline">\(y\)</span>-Position berechnet sich aus dem Mittelwert plus Standardabweichung innerhalb des <code>geom_text()</code>. Leider haben wir nur einen Balken bei der Kontrolle, deshalb hier nachträglich der Buchstabe mit <code>annotate()</code>. Ich habe mich dann noch entschieden neben dem Barplot noch den Boxplot als Alternative zu erstellen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Barplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Boxplot</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Einmal der Barplot wie beschrieben. Am besten löscht du immer mal wieder eine Zeile Code damit du nachvollziehen kannst, was die Zeile Code in der Abbildung macht. Vergleiche auch einmal diese Abbildung der Barplots mit der Abbildung der Boxplots und überlege, welche der beiden Abbildungen dir mehr Informationen liefert.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> mean,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">5.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">75</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>) <span class="sc">+</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"b"</span>, <span class="st">"bc"</span>, <span class="st">"bc"</span>, <span class="st">"d"</span>, <span class="st">"bc"</span>, <span class="st">"d"</span>, <span class="st">"bc"</span>, <span class="st">"c"</span>), </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> mean <span class="sc">+</span> sd <span class="sc">+</span> <span class="dv">2</span>),  </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.77</span>, <span class="at">y =</span> <span class="dv">15</span>, <span class="at">label =</span> <span class="st">"a"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-target" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-target-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-11" data-gallery="quarto-lightbox-gallery-11"><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-target-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.11— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Für die Boxplost brauchen wir dann noch ein Objekt mehr. Um das <em>compacte letter dislay</em> an die richtige Position zu setzen brauchen wir noch eine <span class="math inline">\(y\)</span>-Position. Ich nehme hier dann das 90% Quantile. Das 90% Quantile sollte dann auf jeden Fall über die Schnurrhaare raus reichen. Wir nutzen dann den Datensatz <code>letter_pos_tbl</code> in dem <code>geom_text()</code> um die Buchstaben richtig zu setzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>letter_pos_tbl <span class="ot">&lt;-</span> barplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(time, type) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">quant_90 =</span> <span class="fu">quantile</span>(iodine, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.90</span>)))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>letter_pos_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
# Groups:   time [5]
  time   type  quant_90
  &lt;fct&gt;  &lt;fct&gt;    &lt;dbl&gt;
1 Contr. KIO3       7.4
2 07:00  KIO3      59  
3 07:00  KI        95.6
4 11:00  KIO3      77.4
5 11:00  KI       166  
6 15:00  KIO3      85.6
7 15:00  KI       146  
8 19:00  KIO3     106  
9 19:00  KI        99.8</code></pre>
</div>
</div>
<p>Und dann müssen wir nur noch das <code>geom_bar()</code> und <code>geom_errorbar()</code> entfernen und durch das <code>geom_boxplot()</code> ersetzen. Dann haben wir auch schon unsere wunderbaren Boxplots. Das Problem sind natürlich die wenigen Beobachtungen, deshalb sehen die Boxplots teilweise etwas wild aus. Beachte auch das wir die Orginaldaten nutzen und nicht die zusammengefassten Daten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barplot_tbl, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> iodine,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="fl">0.25</span>, <span class="at">xmax =</span> <span class="fl">5.75</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span>                        </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">y =</span> <span class="dv">75</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">label =</span> <span class="st">"Target area"</span>) <span class="sc">+</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">"Type"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"darkblue"</span>)) <span class="sc">+</span> </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.spacing.y =</span> <span class="fu">unit</span>(<span class="dv">0</span>, <span class="st">"mm"</span>), </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time of application [time of day]"</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span>  <span class="fu">expression</span>(Iodine<span class="sc">~</span>content<span class="sc">~</span><span class="st">"["</span><span class="sc">*</span>mu<span class="sc">*</span>g<span class="sc">~</span>I<span class="sc">~</span><span class="dv">100</span><span class="sc">*</span>g<span class="sc">^</span><span class="st">'-1'</span><span class="sc">~</span>f<span class="sc">*</span>.<span class="sc">*</span>m<span class="sc">*</span>.<span class="sc">*</span><span class="st">"]"</span>)) <span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">200</span>)) <span class="sc">+</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> letter_pos_tbl, </span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"b"</span>, <span class="st">"bc"</span>, <span class="st">"bc"</span>, <span class="st">"d"</span>, <span class="st">"bc"</span>, <span class="st">"d"</span>, <span class="st">"bc"</span>, <span class="st">"c"</span>), </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> quant_90 <span class="sc">+</span> <span class="dv">5</span>),  </span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">0.77</span>, <span class="at">y =</span> <span class="dv">15</span>, <span class="at">label =</span> <span class="st">"a"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-target-box" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-target-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-box-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-12" data-gallery="quarto-lightbox-gallery-12"><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-target-box-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-target-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.12— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen, dafür müssen wir usn aber nochmal ein Positionsdatensatz bauen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_barplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Zweifaktorieller, gekippter Barplot mit Zielbereich
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen zweifaktoriellen Barplot oder Balkendiagramm anschauen. Wir haben hier ein echtes Balkendiagramm mit <em>compact letter display</em> vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der vier Zeitpunkte und der Kontrolle jeweils einmal einen Mittelwert für die Länge des Balkens sowie einmal die Standardabweichung. Die Standardabweichung addieren und subtrahieren wir dann jeweils von dem Mittelwert und schon haben wir die Fehlerbalken. Ich habe hier dann jeweils drei Werte für jede Faktorkombination. Die brauche ich dann auch, weil ich später nochmal vergleichend den Boxplot erstellen möchte. Der macht meiner Ansicht nach hier mehr Sinn.</p>
<div id="fig-ur-barplot-03" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_complex_02.png" class="lightbox" data-glightbox="description: .lightbox-desc-13" data-gallery="quarto-lightbox-gallery-13"><img src="images/eda/zerforschen_barplot_complex_02.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.13— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein zweifaktorielles Balkendiagramm mit einem Zielbereich und <em>compact letter display</em>
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir wieder die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_2fac.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die drei Werte alle um den Mittelwert streuen lassen. Das war es dann auch schon.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_2fac_flipped.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iod =</span> <span class="fu">fct_rev</span>(iod),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">fruit =</span> <span class="fu">fct_rev</span>(fruit))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>barplot_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   iod   fruit iod_yield
   &lt;fct&gt; &lt;fct&gt;     &lt;dbl&gt;
 1 KI    65-75        85
 2 KI    65-75       100
 3 KI    65-75        75
 4 KI    75-80        52
 5 KI    75-80        70
 6 KI    75-80        30
 7 KIO3  65-75        55
 8 KIO3  65-75        48
 9 KIO3  65-75        60
10 KIO3  75-80        45
11 KIO3  75-80        53
12 KIO3  75-80        38</code></pre>
</div>
</div>
<p>Jetzt brauchen wir noch die Mittelwerte und die Standardabweichung für jede der vier Behandlungen. Hier nur kurz, den Code kennst du schon aus anderen Zerforschenbeispielen zu den Barplots.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>stat_tbl <span class="ot">&lt;-</span> barplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(iod, fruit) <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(iod_yield),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(iod_yield))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>stat_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
# Groups:   iod [2]
  iod   fruit  mean    sd
  &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;
1 KIO3  75-80  45.3  7.51
2 KIO3  65-75  54.3  6.03
3 KI    75-80  50.7 20.0 
4 KI    65-75  86.7 12.6 </code></pre>
</div>
</div>
<p>Im Folgenden stelle ich die zusammengefassten Daten <code>stat_tbl</code> als Balkendiagramm dar. Die ursprünglichen Daten <code>barplot_tbl</code> kann ich nutzen um die Boxplots zu erstellen. Hier ist wichtig nochmal zu erinnern, das wir Barplots auf dem Mittelwert und der Standardabweichung darstellen und die Boxplots auf den Originaldaten. Mit der unteren Grenze machen Boxplots mehr Sinn, wenn du wissen willst, ob du einen Zielbereich vollkommen erreicht hast.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Barplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Boxplot</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Zuerst einmal der Barplot, wie wir ihn auch schon oben in der Abbildung sehen. Wir nutzen hier zum einen die Funktion <code>coord_flip()</code> um ganz zum Schluss die Abbildung zu drehen. Deshalb musst du aufpassen, denn vor dem Flippen ist ja alles auf der <span class="math inline">\(y\)</span>-Achse die <span class="math inline">\(y\)</span>-Achse und umgekehrt. Deshalb müssen wir dann auch teilweise die Ordnung der Level in den einzelnen Faktoren drehen, damit wir wieder die richtige Reihenfolge <em>nach</em> dem Flip haben. Wir müssen ganz am Anfang einmal <code>scale_x_discrete()</code> setzen, damit wir den Zielbereich als erstes einzeichnen können. Sonst ist der Zielbereich nicht ganz hinten in der Abbildung und überdeckt die Balken. Deshalb ist das Wort “Zielbereich” auch recht weit hinten im Code, damit es eben im Vordergrund ist. Sonst ist eigentlich vieles gleich. Wir nutzen hier einmal das R Paket <code>latex2exp</code> für die Erstellung der mathematischen Formeln.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> iod, <span class="at">y =</span> mean,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> fruit)) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">3</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> cbbPalette[<span class="dv">6</span>]) <span class="sc">+</span> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Iodform"</span>,</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span><span class="fu">TeX</span>(r<span class="st">"(Iodgehalt $[\mu g\, l\, (100g\, FM)^{-1}]$)"</span>)) <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>(<span class="at">name =</span> <span class="st">"Frucht-</span><span class="sc">\n</span><span class="st">größe [mm]"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">'65-75'</span>, <span class="st">'75-80'</span>)) <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.2</span>),</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>),</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">75</span>, <span class="at">label =</span> <span class="st">"Zielbereich"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.25</span>, <span class="fl">1.8</span>, <span class="fl">2.25</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">62</span>, <span class="dv">72</span>, <span class="dv">102</span>),</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>)) <span class="sc">+</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-flipped" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-flipped-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-flipped-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-14" data-gallery="quarto-lightbox-gallery-14"><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-flipped-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-flipped-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.14— Die Abbildung des Balkendiagramms in <code>ggplot</code> nachgebaut. Ein extra Zielbereich ist definiert sowie die Legende in die Abbildung integriert.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Für die Boxplots müssen wir gar nicht viel tun. Wir müssen nur noch das <code>geom_bar()</code> und <code>geom_errorbar()</code> entfernen und durch das <code>geom_boxplot()</code> ersetzen. Dann haben wir auch schon unsere wunderbaren Boxplots. Das Problem sind natürlich die wenigen Beobachtungen, deshalb sehen die Boxplots teilweise etwas wild aus. Beachte auch das wir die Orginaldaten nutzen und nicht die zusammengefassten Daten. Am Ende machen Boxplots mit einer unteren Grenze mehr Sinn, wenn wir uns Fragen, ob wir einen Zielbereich erreicht haben. Da sind dann doch Balkendiagramme etwas ungeeignet.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barplot_tbl, <span class="fu">aes</span>(<span class="at">x =</span> iod, <span class="at">y =</span> iod_yield,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> fruit)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Iodform"</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span><span class="fu">TeX</span>(r<span class="st">"(Iodgehalt $[\mu g\, l\, (100g\, FM)^{-1}]$)"</span>)) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>(<span class="at">name =</span> <span class="st">"Frucht-</span><span class="sc">\n</span><span class="st">größe [mm]"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">'65-75'</span>, <span class="st">'75-80'</span>)) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.2</span>),</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>),</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">3</span>, <span class="at">ymin =</span> <span class="dv">50</span>, <span class="at">ymax =</span> <span class="dv">100</span>, </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> cbbPalette[<span class="dv">6</span>]) <span class="sc">+</span> </span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">75</span>, <span class="at">label =</span> <span class="st">"Zielbereich"</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.25</span>, <span class="fl">1.8</span>, <span class="fl">2.25</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">62</span>, <span class="dv">72</span>, <span class="dv">102</span>),</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>)) <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-flipped-box" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-flipped-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-flipped-box-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-15" data-gallery="quarto-lightbox-gallery-15"><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-flipped-box-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-flipped-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.15— Die Abbildung des Balkendiagramms in <code>ggplot</code> nachgebaut. Durch den Boxplot erhalten wir auch untere Grenzen, was bei der Frage, ob wir in einem Zielbereich sind, viel sinnvoller ist, als ein Balkendiagramm. Eine höhere Fallzahl als <span class="math inline">\(n=3\)</span> würde die Boxplots schöner machen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-eda-boxplot" class="level3" data-number="17.4.2">
<h3 data-number="17.4.2" class="anchored" data-anchor-id="sec-eda-boxplot"><span class="header-section-number">17.4.2</span> Boxplot</h3>
<p>Mit dem Boxplot können wir den Median und die Quartile visualisieren. Im Folgenden unterscheide ich dann einmal die theoretische Betrachtung des Boxplots sowie die händische Darstellung für unsere Flohdaten als Beispiel. Dann implementieren wir den Boxplot für die Sprungweiten der Hunde- und Katzenflöhe noch einmal abschließend in <code>{ggplot}</code>. Im Folgenden siehst du im ersten Tab einen Boxplot, der den Median und die Quartile eines beliebigen Datensatzes visualisiert.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false"><code>{ggplot}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Die Box wird aus dem Interquartilesabstand (abk . <em>IQR</em>) gebildet. Der Median wird als Strich in der Box gezeigt. Die Schnurrhaare (eng. <em>Whiskers</em>) sind das 1.5-fache des IQR, wenn nicht das Minimum der Beobachtungen oder das Maximum jeweils größer oder kleiner ist. Punkte die außerhalb der Whiskers liegen werden als einzelne Punkte dargestellt. Diese einzelnen Punkte werden auch als Ausreißer (eng. <em>Outlier</em>) bezeichnet. Ob es sich nun wirklich um Ausreißer handelt, muss biologisch geklärt werden.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-drawn" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-drawn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-boxplot-drawn-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-16" data-gallery="quarto-lightbox-gallery-16"><img src="eda-ggplot_files/figure-html/fig-boxplot-drawn-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-drawn-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.16— Liegender Boxplot zu Visualisierung der statistischen Maßzahlen Median und Quartile. Die Box wird aus dem Interquartilesabstand (abk . <em>IQR</em>) gebildet, welches die Distanz zwischen den <span class="math inline">\(1^{st}\)</span> und <span class="math inline">\(3^{rd}\)</span> Quartile entspricht. Der Median wird als Strich in der Box gezeigt. Die Whiskers sind das 1.5-fache des IQR, wenn das Minimum der Werte nicht größer oder das Maximum der Werte nicht kleiner ist. Punkte die außerhalb der Whiskers liegen werden als einzelne Punkte dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Jetzt können wir einmal händisch den Boxplot für die Hundeflöhe und der Sprungweite zeichnen. Ich habe dafür dann einmal die Werte für das <span class="math inline">\(1^{st}\)</span> und <span class="math inline">\(3^{rd}\)</span> Quartile mit jeweils 5.7 und 9.1 bestimmt. Der Median der Sprungweite der Hundeflöhe liegt bei 8.2 und der Interquartilesabstand (abk . <em>IQR</em>) ist 3.4, wie du in der nicht maßstabsgetreuen Abbildung sehen kannst. Die Länge der Whisker berechne ich einmal mit <span class="math inline">\(1^{st} - 1.5 \times IQR = 0.6\)</span> sowie <span class="math inline">\(3^{rd} + 1.5 \times IQR = 14.2\)</span> und vergleiche die beiden Werte mit dem Minimum von 5.7 und 11.8 der Sprungweite. In beiden Fällen entscheide ich mich dann für die Minimum und Maximum-Werte.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-drawn-dog-flea" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-drawn-dog-flea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-boxplot-drawn-dog-flea-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-17" data-gallery="quarto-lightbox-gallery-17"><img src="eda-ggplot_files/figure-html/fig-boxplot-drawn-dog-flea-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-drawn-dog-flea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.17— Liegender Boxplot zu Visualisierung der Sprungweite der Hundeflöhe. Die Abbildung ist nicht maßstabsgetreu. Die Box wird aus dem Interquartilesabstand (abk . <em>IQR</em>) gebildet, welches die Distanz zwischen den <span class="math inline">\(1^{st}\)</span> und <span class="math inline">\(3^{rd}\)</span> Quartile entspricht. Es liegen keine Ausreißer in den Daten vor. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Auch wenn die Abbildung nicht maßstabsgetreu ist, können wir abschätzen, dass unsere Sprungweiten der Hundeflöhe in etwa normalverteilt sind, da der Median in etwa in der Mitte der Box liegt. Darüber hinaus sind auch die Whiskers in etwa gleich lang. Ja, in der Statistik ist vieles eine Abschätzung.</p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>Jetzt kommt die Kür, wie erstellen wir einen Boxplot in R mit dem R Paket <code>{ggplot}</code>? Dafür schauen wir uns erstmal an, wie ein Boxplot aussehen würde. Im Folgenden siehst du einmal die Abbildung eines liegenden Boxplot der Hundeflöhe und deren Sprungweiten erstellt in <code>{ggplot}</code>. Wir du erkennen kannst, gibt es da kaum einen Unterschied zu der händischen Darstellung.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-flea-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-flea-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-boxplot-flea-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-18" data-gallery="quarto-lightbox-gallery-18"><img src="eda-ggplot_files/figure-html/fig-boxplot-flea-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-flea-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.18— Liegender Boxplot zu Visualisierung der Sprungweite der Hundeflöhe. Die Linien entsprechen den jeweiligen gemessenen Sprungweiten. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Nun ist ein liegender Boxplot eher ungewöhnlich in der Darstellung. Zum zeichnen und verstehen macht das schon Sinn, aber wenn wir später dann mit dem Boxplot arbeiten, dann nutzen wir die stehende Varaiante.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-boxplot-flea-0" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-flea-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-boxplot-flea-0-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-19" data-gallery="quarto-lightbox-gallery-19"><img src="eda-ggplot_files/figure-html/fig-boxplot-flea-0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="192"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-flea-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.19— Stehender Boxplot zu Visualisierung der Sprungweite der Hundeflöhe. Die Linien entsprechen den jeweiligen gemessenen Sprungweiten. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Häufig nutze wir Boxplots um Gruppen, wie hier die Tierarten, miteinander zu vergleichen. In <a href="#fig-boxplot-flea-0" class="quarto-xref">Abbildung&nbsp;<span>17.19</span></a> ist daher der Boxplot für die Sprungweite in [cm] der Hunde- und Katzenflöhe dargestellt. Wir erkennen auf einen Blick, dass die Sprungweite von den Hundeflöhen weiter ist als die Sprungweite der Katzenflöhe. Im Weiteren können wir abschätzen, dass die Streuung etwa gleich groß ist. Die Boxen sind in etwa gleich groß und die Whiskers in etwa gleich lang.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length, <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite [cm]"</span>) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-boxplot-flea-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boxplot-flea-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-boxplot-flea-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-20" data-gallery="quarto-lightbox-gallery-20"><img src="eda-ggplot_files/figure-html/fig-boxplot-flea-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boxplot-flea-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.20— Stehender Boxplot zu Visualisierung der Sprungweite der Hunde- und Katzenflöhe. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Der Boxplot erlaubt uns auch abzuschätzen, ob wir eine Normalverteilung vorliegen haben oder aber ob die Varianz in zwei oder. mehr Gruppen annähernd ist. Wir sprechen dann von Varianzhomogenität.</p>
<dl>
<dt>Abschätzung der Normalverteilung</dt>
<dd>
<p>Der Median liegt in der Mitte der Box und die Whiskers sind ungefähr gleich lang. Wir können von einer approximativen Normalverteilung ausgehen.</p>
</dd>
<dt>Abschätzung der Varianzhomogenität</dt>
<dd>
<p>Die Boxen sind über alle Gruppen ungefähr gleich groß und auch die Whiskers haben in etwa die gleiche Länge. Wir können dann von einer Varianzhomogenität über die Gruppen ausgehen.</p>
</dd>
</dl>
<p>Schau dir auch hier mal in den Kästen zum Zerforschen rein, da findest du dann noch mehr Inspiration aus anderen Abbildungen, die ich nachgebaut habe. Ich bin einmal über den Campus gelaufen und habe geschaut, welche Abbildungen auf den Postern verwendet werden und habe diese nachgebaut.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Zweifaktorieller Barplot oder Boxplot
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns einen zweifaktoriellen Barplot oder Säulendiagramm anschauen. Wir haben hier ein Säulendiagramm mit den Mittelwerten über den Faktor auf der <span class="math inline">\(x\)</span>-Achse vorliegen. Daher brauchen wir eigentlich gar nicht so viele Zahlen. Für jede der drei Fruchtgrößen jeweils einmal einen Mittelwert für die Höhe der Säule sowie einmal die Standardabweichung für die vier Stickstoffangebote. Das addiert sich dann auf, aber es geht noch. Die Standardabweichung addieren und subtrahieren wir dann später jeweils von dem Mittelwert und schon haben wir die Fehlerbalken. Da ich auch hier einmal als Alternative die Boxplots erstellen will, brauche ich hier mehr Werte aus denen ich dann die Mittelwerte und die Standardabweichung berechne.</p>
<div id="fig-ur-barplot-02" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_barplot_complex_01.png" class="lightbox" data-glightbox="description: .lightbox-desc-21" data-gallery="quarto-lightbox-gallery-21"><img src="images/eda/zerforschen_barplot_complex_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ur-barplot-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.21— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein zweifaktorieller Barplot mit Mittelwerten über dem Faktor auf der <span class="math inline">\(x\)</span>-Achse.
</figcaption>
</figure>
</div>
<p>Als erstes brauchen wir wieder die Daten. Die Daten habe ich mir in dem Datensatz <code>zerforschen_barplot_2fac.xlsx</code> selber ausgedacht. Ich habe einfach die obige Abbildung genommen und den Mittelwert abgeschätzt. Dann habe ich die drei Werte alle um den Mittelwert streuen lassen. Das war es dann auch schon.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>barplot_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_barplot_2fac.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">frucht =</span> <span class="fu">factor</span>(frucht, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"klein"</span>, <span class="st">"mittel"</span>, <span class="st">"groß"</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Klein"</span>, <span class="st">"Mittel"</span>, <span class="st">"Groß"</span>)),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">nmin =</span> <span class="fu">as_factor</span>(nmin))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>barplot_tbl </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 3
   frucht nmin  yield
   &lt;fct&gt;  &lt;fct&gt; &lt;dbl&gt;
 1 Klein  150     1.5
 2 Klein  150     2.2
 3 Klein  150     2.8
 4 Klein  200     2.4
 5 Klein  200     1.9
 6 Klein  200     2.9
 7 Klein  250     3.7
 8 Klein  250     3.9
 9 Klein  250     3.5
10 Klein  300     2.5
# ℹ 26 more rows</code></pre>
</div>
</div>
<p>Jetzt brauchen wir noch die Mittelwerte und die Standardabweichung für jede der drei Fruchtgrößen und Stickstoffangebote. Hier nur kurz, den Code kennst du schon aus anderen Zerforschenbeispielen zu den Barplots. Das ist soweit erstmal nichts besonderes und ähnelt auch der Erstellung der anderen Barplots.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>stat_all_tbl <span class="ot">&lt;-</span> barplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(frucht, nmin) <span class="sc">|&gt;</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(yield),</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(yield))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>stat_all_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
# Groups:   frucht [3]
   frucht nmin   mean    sd
   &lt;fct&gt;  &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Klein  150    2.17 0.651
 2 Klein  200    2.4  0.5  
 3 Klein  250    3.7  0.2  
 4 Klein  300    2.5  0.4  
 5 Mittel 150    5.03 1.05 
 6 Mittel 200    7.03 0.252
 7 Mittel 250    8    0.200
 8 Mittel 300    7.7  0.200
 9 Groß   150    6.1  1.95 
10 Groß   200    8.27 0.702
11 Groß   250    9.07 1.00 
12 Groß   300    8.97 1.00 </code></pre>
</div>
</div>
<p>Weil wir dann noch die globalen Mittelwerte der Früchte über alle Stickstofflevel wollen, müssen wir nochmal die Mittelwerte und die Standardabweichung nur für die drei Fruchtgrößen berechnen. Daher haben wir dann <em>zwei</em> Datensätze, die uns eine Zusammenfassung der Daten liefern.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>stat_fruit_tbl <span class="ot">&lt;-</span> barplot_tbl <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(frucht) <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(yield))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>stat_fruit_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  frucht  mean
  &lt;fct&gt;  &lt;dbl&gt;
1 Klein   2.69
2 Mittel  6.94
3 Groß    8.1 </code></pre>
</div>
</div>
<p>Auch hier möchte ich einmal den Barplot nachbauen und dann als Alternative noch den Barplot anbieten. Am nervigsten war der Zeilenumbruch in der Legendenbeschriftung mit N<span class="math inline">\(_min\)</span>. Es hat echt gedauert, bis ich die Funktion <code>atop()</code> gefunden hatte, die in einer <code>expression()</code> einen Zeilenumbruch erzwingt. Meine Güte war das langwierig. Der Rest ist eigentlich wie schon in den anderen Beispielen. Da schaue dann doch nochmal da mit rein.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Barplot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Boxplot</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Einmal der Barplot wie beschrieben. Vergleiche auch einmal diese Abbildung der Barplots mit der Abbildung der Boxplots in dem anderem Tab und überlege, welche der beiden Abbildungen dir mehr Informationen liefert.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> stat_all_tbl, <span class="fu">aes</span>(<span class="at">x =</span> frucht, <span class="at">y =</span> mean,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">fill =</span> nmin)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean<span class="sc">-</span>sd, <span class="at">ymax =</span> mean<span class="sc">+</span>sd), </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.9</span>)) <span class="sc">+</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fruchtgröße zum Erntezeitpunkt"</span>, </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">atop</span>(<span class="st">"Gesamtfruchtertrag"</span>, <span class="st">"["</span><span class="sc">*</span>kg<span class="sc">~</span>FM<span class="sc">~</span>m<span class="sc">^</span><span class="st">"-2"</span><span class="sc">*</span><span class="st">"]"</span>)),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">expression</span>(<span class="fu">atop</span>(N[min]<span class="sc">~</span><span class="st">"Angebot"</span>, <span class="st">"["</span><span class="sc">*</span>kg<span class="sc">~</span>N<span class="sc">~</span>ha<span class="sc">^</span><span class="st">"-1"</span><span class="sc">*</span><span class="st">"]"</span>))) <span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>),</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>),</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="fl">1.45</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">3</span>),</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(y)<span class="sc">*</span><span class="st">" = "</span><span class="sc">*</span><span class="fl">2.7</span>),</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">expression</span>(<span class="fu">bar</span>(y)<span class="sc">*</span><span class="st">" = "</span><span class="sc">*</span><span class="fl">6.9</span>),</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">expression</span>(<span class="fu">bar</span>(y)<span class="sc">*</span><span class="st">" = "</span><span class="sc">*</span><span class="fl">8.1</span>),</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"SD"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-22" data-gallery="quarto-lightbox-gallery-22"><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.22— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Für die Boxplots müssen wir gar nicht viel tun. Wir müssen nur noch das <code>geom_bar()</code> und <code>geom_errorbar()</code> entfernen und durch das <code>geom_boxplot()</code> ersetzen. Dann haben wir auch schon unsere wunderbaren Boxplots. Das Problem sind natürlich die wenigen Beobachtungen, deshalb sehen die Boxplots teilweise etwas wild aus. Beachte auch das wir die Orginaldaten nutzen und nicht die zusammengefassten Daten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> barplot_tbl, <span class="fu">aes</span>(<span class="at">x =</span> frucht, <span class="at">y =</span> yield,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> nmin)) <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fruchtgröße zum Erntezeitpunkt"</span>, </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">atop</span>(<span class="st">"Gesamtfruchtertrag"</span>, <span class="st">"["</span><span class="sc">*</span>kg<span class="sc">~</span>FM<span class="sc">~</span>m<span class="sc">^</span><span class="st">"-2"</span><span class="sc">*</span><span class="st">"]"</span>)),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="fu">expression</span>(<span class="fu">atop</span>(N[min]<span class="sc">~</span><span class="st">"Angebot"</span>, <span class="st">"["</span><span class="sc">*</span>kg<span class="sc">~</span>N<span class="sc">~</span>ha<span class="sc">^</span><span class="st">"-1"</span><span class="sc">*</span><span class="st">"]"</span>))) <span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>),</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="at">l =</span> <span class="dv">1</span>),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text.align =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">11</span>),</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(y)<span class="sc">*</span><span class="st">" = "</span><span class="sc">*</span><span class="fl">2.7</span>),</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">expression</span>(<span class="fu">bar</span>(y)<span class="sc">*</span><span class="st">" = "</span><span class="sc">*</span><span class="fl">6.9</span>),</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">expression</span>(<span class="fu">bar</span>(y)<span class="sc">*</span><span class="st">" = "</span><span class="sc">*</span><span class="fl">8.1</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-barplot-2fac-box" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-barplot-2fac-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-box-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-23" data-gallery="quarto-lightbox-gallery-23"><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-barplot-2fac-box-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-barplot-2fac-box-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.23— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_barplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Boxplot für mehrere Outcomes
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Hier wollen wir einmal eine etwas größere <a href="stat-tests-posthoc.html#fig-zer-boxplot-mult" class="quarto-xref">Abbildung&nbsp;<span>40.13</span></a> mit einer Menge Boxplots zerforschen. Da ich den Datensatz dann nicht zu groß machen wollte und Boxplots zu zerforschen manchmal nicht so einfach ist, passen die Ausreißer dann manchmal dann doch nicht. Auch liefern die statistischen Tests dann nicht super genau die gleichen Ergebnisse. Aber das macht vermutlich nicht so viel, hier geht es ja dann eher um den Bau der Boxplots und dem rechnen des statistischen Tests in <code>{emmeans}</code>. Die Reihenfolge des <em>compact letter displays</em> habe ich dann auch nicht angepasst sondern die Buchstaben genommen, die ich dann erhalten habe. Die Sortierung kann man ja selber einfach ändern. Wir haben hier ein einfaktorielles Design mit einem Behandlungsfaktor mit drei Leveln vorliegen. Insgesamt schauen wir uns vier Endpunkte in veränderten Substrat- und Wasserbedingungen an.</p>
<div id="fig-zer-boxplot-mult" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zer-boxplot-mult-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_boxplot_mult.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-24" data-gallery="quarto-lightbox-gallery-24"><img src="images/eda/zerforschen_boxplot_mult.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zer-boxplot-mult-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.24— Ursprüngliche Abbildung, die nachgebaut werden soll. Insgesamt vier Outcomes sollen für zwei Behandlungen ausgewertet werden. Das praktische ist hier, dass wir es nur mit einem einfaktoriellen Design zu tun haben.
</figcaption>
</figure>
</div>
<p>Im Folgenden lade ich einmal den Datensatz, den ich dann per Auge zusammengesetzt habe. Das war jetzt etwas anstrengender als gedacht, da ich nicht weiß wie viele Beobachtungen einen Boxplot bilden. Je mehr Beobachtungen, desto feiner kann man den Boxplot abstimmen. Da ich hier nur mit sieben Beobachtungen ja Gruppe gearbeitet habe, habe ich es nicht geschafft die Ausreißer darzustellen. Das wäre mir dann zu viel Arbeit geworden. Nachdem ich jetzt die Daten geladen habe, muss ich noch über die Funktion <code>pivot_longer()</code> einen Datensatz passenden im Longformat bauen. Abschließend mutiere ich dann noch alle Faktoren richtig und vergebe bessere Namen als <code>labels</code> sonst versteht man ja nicht was die Spalten bedeuten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_boxplot_mult.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> fresh_weight<span class="sc">:</span>flower_number,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"rsp"</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"plant_measure"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as_factor</span>(trt),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">plant_measure =</span> <span class="fu">factor</span>(plant_measure,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"fresh_weight"</span>, <span class="st">"dry_weight"</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"plant_height"</span>, <span class="st">"flower_number"</span>),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Fresh weight (g)"</span>, <span class="st">"Dry weight (g)"</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">"Plant height (cm)"</span>, <span class="st">"Flower number"</span>)),</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Substrate"</span>, <span class="st">"Water"</span>))) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ich habe mir dann die beiden Behandlungen <code>substrate</code> und <code>water</code> in die neue Spalte <code>type</code> geschrieben. Die Spaltennamen der Outcomes wandern in die Spalte <code>plant_measure</code> und die entsprechenden Werte in die Spalte <code>rsp</code>. Dann werde ich hier mal alle Outcomes auf einmal auswerten und nutze dafür das R Paket <code>{purrr}</code> mit der Funktion <code>nest()</code> und <code>map()</code>. Ich packe mir als die Daten nach <code>type</code> und <code>plant_measure</code> einmal zusammen. Dann habe ich einen neuen genesteten Datensatz mit nur noch acht Zeilen. Auf jeder Zeile rechne ich dann jeweils mein Modell. Wie du dann siehst ist in der Spalte <code>data</code> dann jeweils ein Datensatz mit der Spalte <code>trt</code> und <code>rsp</code> für die entsprechenden 21 Beobachtungen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_tbl <span class="ot">&lt;-</span> boxplot_mult_tbl <span class="sc">|&gt;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type, plant_measure) <span class="sc">|&gt;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   type, plant_measure [8]
  type      plant_measure     data             
  &lt;fct&gt;     &lt;fct&gt;             &lt;list&gt;           
1 Substrate Fresh weight (g)  &lt;tibble [21 × 2]&gt;
2 Substrate Dry weight (g)    &lt;tibble [21 × 2]&gt;
3 Substrate Plant height (cm) &lt;tibble [21 × 2]&gt;
4 Substrate Flower number     &lt;tibble [21 × 2]&gt;
5 Water     Fresh weight (g)  &lt;tibble [21 × 2]&gt;
6 Water     Dry weight (g)    &lt;tibble [21 × 2]&gt;
7 Water     Plant height (cm) &lt;tibble [21 × 2]&gt;
8 Water     Flower number     &lt;tibble [21 × 2]&gt;</code></pre>
</div>
</div>
<p>Zur Veranschaulichung rechne ich jetzt einmal mit <code>mutate()</code> und <code>map()</code> für jeden der Datensätze in der Spalte <code>data</code> einmal ein lineares Modell mit der Funktion <code>lm()</code>. Ich muss nur darauf achten, dass ich die Daten mit <code>.x</code> einmal an die richtige Stelle in der Funktion <code>lm()</code> übergebe. Dann habe ich alle Modell komprimiert in der Spalte <code>model</code>. Das geht natürlcih auch alles super in einem Rutsch.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl <span class="ot">&lt;-</span> boxplot_mult_nest_tbl <span class="sc">|&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">lm</span>(rsp <span class="sc">~</span> trt, <span class="at">data =</span> .x)))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
# Groups:   type, plant_measure [8]
  type      plant_measure     data              model 
  &lt;fct&gt;     &lt;fct&gt;             &lt;list&gt;            &lt;list&gt;
1 Substrate Fresh weight (g)  &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
2 Substrate Dry weight (g)    &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
3 Substrate Plant height (cm) &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
4 Substrate Flower number     &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
5 Water     Fresh weight (g)  &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
6 Water     Dry weight (g)    &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
7 Water     Plant height (cm) &lt;tibble [21 × 2]&gt; &lt;lm&gt;  
8 Water     Flower number     &lt;tibble [21 × 2]&gt; &lt;lm&gt;  </code></pre>
</div>
</div>
<p>Jetzt können wir einmal eskalieren und insgesamt acht mal die ANOVA rechnen. Das sieht jetzt nach viel Code aus, aber am Ende ist es nur eine lange Pipe. Am Ende erhalten wir dann den <span class="math inline">\(p\)</span>-Wert für die einfaktorielle ANOVA für die Behandlung <code>trt</code> wiedergegeben. Wir sehen, dass wir eigentlich nur einen signifikanten Unterschied in der Wassergruppe und der Pflanzenhöhe erwarten sollten. Da der <span class="math inline">\(p\)</span>-Wert für die Wassergruppe und der Blütenanzahl auch sehr nah an dem Signifikanzniveau ist, könnte hier auch etwas sein, wenn wir die Gruppen nochmal getrennt testen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl  <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">anova =</span> <span class="fu">map</span>(model, anova)) <span class="sc">|&gt;</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parameter =</span> <span class="fu">map</span>(anova, model_parameters)) <span class="sc">|&gt;</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, parameter) <span class="sc">|&gt;</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(parameter) <span class="sc">|&gt;</span> </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parameter <span class="sc">!=</span> <span class="st">"Residuals"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, parameter, p)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
# Groups:   type, plant_measure [8]
  type      plant_measure     parameter        p
  &lt;fct&gt;     &lt;fct&gt;             &lt;chr&gt;        &lt;dbl&gt;
1 Substrate Fresh weight (g)  trt       0.813   
2 Substrate Dry weight (g)    trt       0.381   
3 Substrate Plant height (cm) trt       0.959   
4 Substrate Flower number     trt       0.444   
5 Water     Fresh weight (g)  trt       0.384   
6 Water     Dry weight (g)    trt       0.843   
7 Water     Plant height (cm) trt       0.000138
8 Water     Flower number     trt       0.0600  </code></pre>
</div>
</div>
<p>Dann schauen wir uns nochmal das <span class="math inline">\(\eta^2\)</span> an um zu sehen, wie viel Varianz unsere Behandlung in den Daten erklärt. Leider sieht es in unseren Daten sehr schlecht aus. Nur bei der Wassergruppe und der Pflanzenhöhe scheinen wir durch die Behandlung Varianz zu erklären.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_nest_model_tbl <span class="sc">%&gt;%</span>  </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eta =</span> <span class="fu">map</span>(model, eta_squared)) <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(eta) <span class="sc">%&gt;%</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, eta2) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   type, plant_measure [8]
  type      plant_measure        eta2
  &lt;fct&gt;     &lt;fct&gt;               &lt;dbl&gt;
1 Substrate Fresh weight (g)  0.0228 
2 Substrate Dry weight (g)    0.102  
3 Substrate Plant height (cm) 0.00466
4 Substrate Flower number     0.0863 
5 Water     Fresh weight (g)  0.101  
6 Water     Dry weight (g)    0.0188 
7 Water     Plant height (cm) 0.628  
8 Water     Flower number     0.268  </code></pre>
</div>
</div>
<p>Dann können wir auch schon den Gruppenvergleich mit dem R Paket <code>{emmeans}</code> rechnen. Wir nutzen hier die Option <code>vcov. = sandwich::vcovHAC</code> um heterogene Varianzen zuzulassen. Im Weiteren adjustieren wir nicht für die Anzahl der Vergleiche und lassen uns am Ende das <em>compact letter display</em> wiedergeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>emm_tbl <span class="ot">&lt;-</span> boxplot_mult_nest_model_tbl <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">emm =</span> <span class="fu">map</span>(model, emmeans, <span class="sc">~</span>trt, <span class="at">vcov. =</span> sandwich<span class="sc">::</span>vcovHAC)) <span class="sc">|&gt;</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cld =</span> <span class="fu">map</span>(emm, cld, <span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(cld) <span class="sc">|&gt;</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(type, plant_measure, trt, <span class="at">rsp =</span> emmean, <span class="at">group =</span> .group) <span class="sc">|&gt;</span> </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">str_trim</span>(group))</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>emm_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 5
# Groups:   type, plant_measure [8]
   type      plant_measure     trt     rsp group
   &lt;fct&gt;     &lt;fct&gt;             &lt;fct&gt; &lt;dbl&gt; &lt;chr&gt;
 1 Substrate Fresh weight (g)  UWF    95.4 a    
 2 Substrate Fresh weight (g)  TWF   101   a    
 3 Substrate Fresh weight (g)  Peat  105   a    
 4 Substrate Dry weight (g)    UWF    12.3 a    
 5 Substrate Dry weight (g)    Peat   14.3 ab   
 6 Substrate Dry weight (g)    TWF    15.1 b    
 7 Substrate Plant height (cm) TWF    37.9 a    
 8 Substrate Plant height (cm) Peat   38.0 a    
 9 Substrate Plant height (cm) UWF    39.1 a    
10 Substrate Flower number     UWF    14.6 a    
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>Da die Ausgabe viel zu lang ist, wollen wir ja jetzt einmal unsere Abbildungen in <code>{ggplot}</code> nachbauen. Dazu nutze ich dann einmal zwei Wege. Einmal den etwas schnelleren mit <code>facet_wrap()</code> bei dem wir eigentlich alles automatisch machen lassen. Zum anderen zeige ich dir mit etwas Mehraufwand alle acht Abbildungen einzeln baust und dann über das R Paket <code>{patchwork}</code> wieder zusammenklebst. Der zweite Weg ist der Weg, wenn du mehr Kontrolle über die einzelnen Abbildungen haben willst.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Mit <code>facet_wrap()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Mit <code>{patchwork}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Die Funktion <code>facet_wrap()</code> erlaubt es dir automatisch Subplots nach einem oder mehreren Faktoren zu erstellen. Dabei muss auch ich immer wieder probieren, wie ich die Faktoren anordne. In unserem Fall wollen wir zwei Zeilen und auch den Subplots erlauben eigene <span class="math inline">\(x\)</span>-Achsen und <span class="math inline">\(y\)</span>-Achsen zu haben. Wenn du die Option <code>scale = "free"</code> nicht wählst, dann haben alle Plots alle Einteilungen der <span class="math inline">\(x\)</span>_Achse und die <span class="math inline">\(y\)</span>-Achse läuft von dem kleinsten zu größten Wert in den gesamten Daten.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>boxplot_mult_tbl <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trt, rsp)) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="dv">18</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type <span class="sc">*</span> plant_measure, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> emm_tbl, <span class="fu">aes</span>(<span class="at">y =</span> rsp, <span class="at">label =</span> group), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fl">0.2</span>), <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-zerforschen_boxplot_mult-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zerforschen_boxplot_mult-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-zerforschen_boxplot_mult-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-25" data-gallery="quarto-lightbox-gallery-25"><img src="eda-ggplot_files/figure-html/fig-zerforschen_boxplot_mult-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zerforschen_boxplot_mult-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.25— Nachbau der Abbildung mit der Funktion <code>facte_wrap()</code> mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das <em>compact letter display</em>. Auf eine Einfärbung nach der Behandlung wurde verzichtet um die Abbildung nicht noch mehr zu überladen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Jetzt wird es etwas wilder. Wir bauen uns jetzt alle acht Plots einzeln und kleben diese dann mit dem R Paket <code>{patchwork}</code> zusammen. Das hat ein paar Vorteile. Wir können jetzt jeden einzelnen Plot bearbeiten und anpassen wie wir es wollen. Damit wir aber nicht zu viel Redundanz haben bauen wir uns erstmal ein Template für <code>ggplot()</code>. Dann können wir immer noch die Werte für <code>scale_y_continuous()</code> in den einzelnen Plots ändern. Hier also einmal das Template, was beinhaltet was für alle Abbildungen gelten soll.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>gg_template <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(trt, rsp) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="at">geom =</span> <span class="st">"errorbar"</span>, <span class="at">width =</span> <span class="fl">0.25</span>) <span class="sc">+</span> </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="dv">18</span>, <span class="at">outlier.size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">23</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ja, jetzt geht es los. Wir bauen also jeden Plot einmal nach. Dafür müssen wir dann jeweils den Datensatz filtern, den wir auch brauchen. Dann ergänzen wir noch die korrekte <span class="math inline">\(y\)</span>-Achsenbeschriftung. So können wir dann auch händisch das <em>compact letter display</em> über die Whisker einfach setzen. Im Weiteren habe ich dann auch einmal als Beispiel noch die <span class="math inline">\(y\)</span>-Achseneinteilung mit <code>scale_y_continuous()</code> geändert. Ich habe das einmal für den Plot <code>p1</code> gemacht, der Rest würde analog dazu funktionieren.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Fresh weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Fresh weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">170</span>, <span class="dv">120</span>, <span class="dv">135</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>), </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">40</span>, <span class="dv">180</span>, <span class="dv">20</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">180</span>))</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Dry weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Dry weight (g)"</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Plant height (cm)"</span>) <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Plant height (cm)"</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Substrate"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Flower number"</span>) <span class="sc">+</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Flower number"</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Fresh weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Fresh weight (g)"</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Dry weight (g)"</span>) <span class="sc">+</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Dry weight (g)"</span>)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Plant height (cm)"</span>) <span class="sc">+</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Plant height (g)"</span>)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span> gg_template <span class="sc">%+%</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(boxplot_mult_tbl, type <span class="sc">==</span> <span class="st">"Water"</span> <span class="sc">&amp;</span> plant_measure <span class="sc">==</span> <span class="st">"Flower number"</span>) <span class="sc">+</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Flower number"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann kleben wir die Abbildungen einfach mit einem <code>+</code> zusammen und dann wählen wir noch aus, dass wir vier Spalten wollen. Dann können wir noch Buchstaben zu den Subplots hinzufügen und noch Titel und anderes wenn wir wollen würden. Dann haben wir auch den Plot schon nachgebaut. Ich verzichte hier händisch überall das <em>compact letter display</em> zu ergänzen. Das macht super viel Arbeit und endlos viel Code und hilft dir dann aber in deiner Abbildung auch nicht weiter. Du musst dann ja bei dir selber die Positionen für die Buchstaben finden.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>patch <span class="ot">&lt;-</span> p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4 <span class="sc">+</span> p5 <span class="sc">+</span> p6 <span class="sc">+</span> p7 <span class="sc">+</span> p8 <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>patch <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title =</span> <span class="st">'Ein Zerforschenbeispiel an Boxplots'</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">subtitle =</span> <span class="st">'Alle Plots wurden abgelesen und daher sagen Signifikanzen nichts.'</span>,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">caption =</span> <span class="st">'Disclaimer: Die Abbildungen sagen nichts aus.'</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-zerforschen_boxplot_mult-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zerforschen_boxplot_mult-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-zerforschen_boxplot_mult-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-26" data-gallery="quarto-lightbox-gallery-26"><img src="eda-ggplot_files/figure-html/fig-zerforschen_boxplot_mult-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zerforschen_boxplot_mult-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.26— Nachbau der Abbildung mit dem R Paket <code>{patchwork}</code> mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das <em>compact letter display</em> bei dem ersten Plot. Auf eine Einfärbung nach der Behanldung wurde verzichtet um die Abbildung nicht noch mehr zu überladen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_boxplot.png"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="sec-eda-scatter" class="level3" data-number="17.4.3">
<h3 data-number="17.4.3" class="anchored" data-anchor-id="sec-eda-scatter"><span class="header-section-number">17.4.3</span> Scatterplot</h3>
<p>Der Scatterplot wird auch <span class="math inline">\(xy\)</span>-Plot genannt. Wir stellen in einem Scatterplot zwei kontinuierliche Variablen dar. Wir haben also auf der <span class="math inline">\(x\)</span>-Achse Kommazahlen genauso wie auf der <span class="math inline">\(y\)</span>-Achse. Aber dazu dann gleich mehr in den folgenden Tabs zur theoretischen Betrachtung, einem Beispiel und der Umsetzung in <code>{ggplot}</code>. Ein Scatterplot nutzen wir relativ häufig, wenn wir den Zusammenhang zwischen kontinuierlichen Zahlen zeigen wollen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false"><code>{ggplot}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>Das Ziel eines Scatterplots ist es eine Abhängigkeit zwischen den Werten auf der <span class="math inline">\(y\)</span>-Achse und der <span class="math inline">\(x\)</span>-Achse darzustellen. Wenn sich die Werte auf der <span class="math inline">\(x\)</span>-Achse ändern, wie ändern sich dann die Werte auf der <span class="math inline">\(y\)</span>-Achse? Im einfachsten Fall zeichnen wir für die Wertepaare von <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span> jeweils ein Punkt in unserer Koordinatensystem.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatter-theo-01" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-theo-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-theo-01-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-27" data-gallery="quarto-lightbox-gallery-27"><img src="eda-ggplot_files/figure-html/fig-scatter-theo-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-theo-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.27— Typischer Scatterplot mit gängigen Bezeichnungen der <span class="math inline">\(x\)</span>-Achse sowie der <span class="math inline">\(y\)</span>-Achse. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Um den Zusammenhang zwischen <span class="math inline">\(y\)</span> und <span class="math inline">\(x\)</span> zu visualisieren legen wir eine Linie durch die Punkte. Diese Gerade folgt dann einer Geradengleichung der Form <span class="math inline">\(y = \beta_0 + \beta_1 x\)</span>. Wobei der Wert für <span class="math inline">\(\beta_0\)</span> den y-Achsenabschnitt beschreibt und der Wert für <span class="math inline">\(\beta_1\)</span> die Steigung der Geraden. Wir wir methodisch zu den Zahlen einer Geradengleichung kommen und damit den Werten für <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span>, kannst du dann später in dem <a href="stat-linear-reg-basic.html">Kapitel zur linearen Regression</a> nachlesen. Im Prinzip fragen wir uns also, wie hänge die Werte auf der <span class="math inline">\(y\)</span>-Achse von den Werten auf der <span class="math inline">\(x\)</span>-Achse ab? Wenn sich also die Werte auf der <span class="math inline">\(x\)</span>-Achse erhöhen oder kleiner werden, wie verhalten sich dann die Werte auf der <span class="math inline">\(y\)</span>-Achse?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatter-theo-02" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-theo-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-theo-02-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-28" data-gallery="quarto-lightbox-gallery-28"><img src="eda-ggplot_files/figure-html/fig-scatter-theo-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-theo-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.28— Visualisierung eines Scatterplots mit einer Geraden durch die Punktewolke. Die lineare Regression wurde zur Bestimmung der Geradengleichung der Geraden durch die Punkte des Scatterplots genutzt. Die Linie oder Gerade wird durch die statistischen Maßzahlen oder Parameter <span class="math inline">\(\beta_0\)</span> als y-Achsenabschnitt und <span class="math inline">\(\beta_1\)</span> als Steigung der Gerade beschrieben. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Wenn wir ein Scatterplot zeichnen wollen, dann brauchen wir erstmal paarweise Werte für <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span>. In der folgenden Tabelle findest du die Informationen von sieben HUndeflöhen zu der Sprungweite in [cm] und dem Gewicht der Flöhe in [mg]. Gibt es nun einen Zusammenhang zwischen der Sprungweite und dem Gewicht der Flöhe? Springen kräftigere Flöhe weiter? Oder eher nicht so weit, weil schwere Flöhe eben nicht so hoch springen können? Diesen Zusammenhang können wir dann mit einem Scatterplot visualisieren.</p>
<div class="cell">
<div id="tbl-scatter-flea-weight" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-scatter-flea-weight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;17.2— Die Sprungweite in [cm] und das Gewicht in [mg] von sieben Hundeflöhen.
</figcaption>
<div aria-describedby="tbl-scatter-flea-weight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">Index</th>
<th style="text-align: center;">jump_length</th>
<th style="text-align: center;">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">0.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">1.3</td>
<td style="text-align: center;">1.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">1.7</td>
<td style="text-align: center;">1.9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">2.6</td>
<td style="text-align: center;">2.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">2.7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">2.8</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In der folgenden Abbildung siehst du einmal den Zusammenhang zwischen der Sprungweite und dem Gewicht von von unseren sieben Hundeflöhen. Für das dritte und fünfte Tier habe ich dir einmal das Wertepaar mit <span class="math inline">\((x_3, y_3)\)</span> und <span class="math inline">\((x_5, y_5)\)</span> beschriftet.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatter-02" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-02-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-29" data-gallery="quarto-lightbox-gallery-29"><img src="eda-ggplot_files/figure-html/fig-scatter-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.29— Visualisierung des Scatterplots für die Sprungweite in [cm] und das Gewicht in [mg] von sieben Hundeflöhen. Das dritte und fünfte Tier wurde mit dem Wertepaar <span class="math inline">\((x_3, y_3)\)</span> und <span class="math inline">\((x_5, y_5)\)</span> beschriftet. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Nun können wir auch hier einmal die Geradengleichung ergänzen. Wenn wir das ganze händisch machen, dann würden wir die Werte für <span class="math inline">\(\\beta_0\)</span> als y-Achsenabschnitt und <span class="math inline">\(\\beta_1\)</span> als Steigung der Gerade visuell abschätzen. Das machen wir natürlich nicht in der Anwendung. Dafür habe ich dann das <a href="stat-linear-reg-basic.html">Kapitel zur linearen Regression</a> geschrieben. Aus einer linearen Regression erhalten wir dann auch die Werte <span class="math inline">\(\beta_0 = 0.99\)</span> und <span class="math inline">\(\beta_1 = 0.51\)</span>, die wir dann in die Regressiongleichung einsetzen. In der folgenden Abbildung siehst du den Zusammenhang nochmal dargestellt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-scatter-04" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-04-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-30" data-gallery="quarto-lightbox-gallery-30"><img src="eda-ggplot_files/figure-html/fig-scatter-04-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.30— Visualisierung der Bestimmung der Geradengleichung anhand eines Scatterplots für die Sprungweite in [cm] und das Gewicht in [mg] von sieben Hundeflöhen. Wir legen eine Gerade durch eine Punktewolke. Die Gerade wird durch die statistischen Maßzahlen bzw. Parameter <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span> beschrieben. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>Als erstes brauchen wir wieder einen kleineren Datensatz und ich nehme hier mal die Sprungweiten und das Körpergewicht von sieben Katzenflöhen. Dafür nutze ich die Funktionen <code>filter()</code> und <code>select()</code> um mir einen kleineren Datensatz zu bauen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>flea_cat_jump_weight_tbl <span class="ot">&lt;-</span> flea_dog_cat_tbl <span class="sc">|&gt;</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(animal <span class="sc">==</span> <span class="st">"cat"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(jump_length, weight)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die <a href="#fig-scatter-flea-0" class="quarto-xref">Abbildung&nbsp;<span>17.31</span></a> zeigt den Scatterplot für die Spalte <code>weight</code> auf der <span class="math inline">\(x\)</span>-Achse und <code>jump_length</code> auf der <span class="math inline">\(y\)</span>-Achse für unsere sieben Katzenflöhe. Mit der Funktion <code>geom_point()</code> können wir die Punktepaare für jede Beobachtung zeichnen. Wie du erkennen kannst, hat das Gewicht der Katzenflöhe einen Einfluss auf die Sprungweite.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_cat_jump_weight_tbl, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gewicht der Katzenflöhe [mg]"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="cn">NA</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-scatter-flea-0" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-flea-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-flea-0-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-31" data-gallery="quarto-lightbox-gallery-31"><img src="eda-ggplot_files/figure-html/fig-scatter-flea-0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-flea-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.31— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt wollen wir noch die Geradengleichung aus einer <a href="stat-linear-reg-basic.html">simplen linearen Regression</a> zu der Abbildung ergänzen. Die Gleichung ist dabei wie folgt.</p>
<p><span class="math display">\[
jump\_length = 0.6377 + 1.8188 \cdot weight
\]</span></p>
<p>Wir bauen uns hier eine Funktion in R, die die Geradengleichung repräsentiert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>jump_func <span class="ot">&lt;-</span> \(x){<span class="fl">0.6377</span> <span class="sc">+</span> <span class="fl">1.8188</span> <span class="sc">*</span> x}</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir können jetzt die Geradengleichung einmal über die Funktion <code>geom_function()</code> zu der Abbildung ergänzen. Es gebe auch die Möglichkeit die Funktion <code>geom_smooth()</code> zu nutzen, aber dann haben wir nicht die Werte für die Gerade sondern nur die Gerade in der Abbildung. Das macht besonders bei mehreren Gruppen Sinn, wenn wir mal schauen wollen, ob es einen Zusammenhang gibt.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_cat_jump_weight_tbl, <span class="fu">aes</span>(<span class="at">x =</span> weight, <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> jump_func, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gewicht der Katzenflöhe [mg]"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="cn">NA</span>) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="cn">NA</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-scatter-flea-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-flea-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-flea-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-32" data-gallery="quarto-lightbox-gallery-32"><img src="eda-ggplot_files/figure-html/fig-scatter-flea-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-flea-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.32— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar. Eine eigene Geradengleichung wurde durch <code>geom_function()</code> ergänzt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Wenn du mehr über die Regression lernen willst schau dir auch hier mal in den Kästen zum Zerforschen rein, da findest du dann noch mehr Inspiration aus anderen Abbildungen, die ich nachgebaut habe. Ich bin einmal über den Campus gelaufen und habe geschaut, welche Abbildungen auf den Postern verwendet werden und habe diese nachgebaut.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Simple lineare Regression mit Bestimmtheitsmaß <span class="math inline">\(R^2\)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns eine simple lineare Regression in einem Scatterplot anschauen. Das schöne an dem Beispiel ist, dass wir hier zum einen noch einen Pfeil einfügen wollen und dass wir nur einen Bereich darstellen wollen. Die Gerade fürht also nicht durch den gesamten Plot. Sonst haben wir dann noch die Herausforderung, dass wir einmal die Geradengleichung zusammen mit dem Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> ergänzen müssen.</p>
<div id="fig-simple-regression" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simple-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_regression_linear_02.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-33" data-gallery="quarto-lightbox-gallery-33"><img src="images/eda/zerforschen_regression_linear_02.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simple-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.33— Ursprüngliche Abbildung, die nachgebaut werden soll. Eine simple lineare Regression mit Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> für die Gerade durch die Punkte.
</figcaption>
</figure>
</div>
<p>Auch hier mache ich es mir etwas einfacher und erschaffe mir die Daten dann direkt in R. Ich baue mir also einen <code>tibble()</code> mit den ungefähren Werten aus der Abbildung. Das war ein wenig aufwendig, aber nach einigem Hin und Her passte dann auch die Werte zu der Abbildung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>shoot_n_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">n_in_shoot =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">3.9</span>, <span class="fl">4.1</span>, <span class="fl">4.2</span>, <span class="fl">4.3</span> ,<span class="fl">4.5</span>, <span class="fl">4.7</span>, <span class="fl">5.1</span>, <span class="fl">5.1</span>, <span class="fl">5.8</span>),</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">freshmass =</span> <span class="fu">c</span>(<span class="fl">7.5</span>, <span class="dv">9</span>, <span class="fl">12.5</span>, <span class="dv">11</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">12</span>, <span class="dv">17</span>, <span class="dv">16</span>, <span class="dv">20</span>, <span class="dv">21</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann rechnen wir auch schon die lineare Regression mit der Funktion <code>lm()</code> die uns dann die Koeffizienten der Geraden wiedergibt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>shoot_n_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(freshmass <span class="sc">~</span> n_in_shoot, <span class="at">data =</span> shoot_n_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann einmal die Koeffizienten mit der Funktion <code>coef()</code> ausgelesen. Den Rest brauchen wir hier nicht für die Abbildung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>shoot_n_fit <span class="sc">|&gt;</span> <span class="fu">coef</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)  n_in_shoot 
  -4.333333    4.353599 </code></pre>
</div>
</div>
<p>Aus den Koeffizienten baue ich mir dann auch die Geradengleichung einmal in R. Ich kann dann die Gleichung mit der Funktion <code>geom_function()</code> gleich in meine nachgebaute Abbildung ergänzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>shoot_n_func <span class="ot">&lt;-</span> \(x){<span class="fl">4.35</span> <span class="sc">*</span> x <span class="sc">-</span> <span class="fl">4.33</span>}</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Ich berechne dann einmal das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> mit der Funktion <code>r2()</code> aus dem R Paket <code>{performance}</code>. Wir sehen, ich habe die Werte recht gut abgelesen, dass passt ganz gut mit dem Bestimmtheitsmaß <span class="math inline">\(R^2\)</span>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>shoot_n_fit <span class="sc">|&gt;</span> <span class="fu">r2</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Linear Regression
       R2: 0.750
  adj. R2: 0.722</code></pre>
</div>
</div>
<p>Und dann bauen wir uns schon die <a href="#fig-zerforschen-shoot_n-01" class="quarto-xref">Abbildung&nbsp;<span>17.34</span></a> einmal nach. Der etwas aufwendigere Teil sind die Achsenbeschriftungen sowie die Ergänzung des Pfeils und der Beschriftung. Das verbraucht dann immer etwas mehr Code und Platz. Ich habe dann etwas die Achseneinteilung geändert und stelle nicht den ganzen Bereich dar. Es reicht auch vollkommen nur den Bereich zu visualisieren, der von Interesse ist. Daher beginnt dann meine <span class="math inline">\(x\)</span>-Achse auch bei Zwei und nicht bei Null.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>shoot_n_tbl <span class="sc">|&gt;</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(n_in_shoot, freshmass)) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"red4"</span>) <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> shoot_n_func, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">6</span>)) <span class="sc">+</span> </span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"N in shoot [% DM]"</span>, <span class="at">y =</span> <span class="fu">TeX</span>(r<span class="st">"(Shoot fresh mass \[g plant$^{-1}$\] - 17 DAP)"</span>)) <span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="dv">22</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($y = 4.35 \cdot x - 4.33$)"</span>)) <span class="sc">+</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="dv">20</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>, </span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($R^2 = 0.75$)"</span>)) <span class="sc">+</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_curve</span>(<span class="at">x =</span> <span class="fl">3.5</span>, <span class="at">y =</span> <span class="fl">5.1</span>, <span class="at">xend =</span> <span class="fl">2.55</span>, <span class="at">yend =</span> <span class="dv">7</span>,</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.03</span>, <span class="st">"npc"</span>), <span class="at">type =</span> <span class="st">"closed"</span>),</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">curvature =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">3.6</span>, <span class="at">y =</span> <span class="fl">4.5</span>, <span class="at">label =</span> <span class="st">"Trt. with</span><span class="sc">\n</span><span class="st">50% cattail"</span>,</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">size =</span> <span class="dv">4</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-zerforschen-shoot_n-01" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-zerforschen-shoot_n-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-zerforschen-shoot_n-01-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-34" data-gallery="quarto-lightbox-gallery-34"><img src="eda-ggplot_files/figure-html/fig-zerforschen-shoot_n-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-zerforschen-shoot_n-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.34— Visualisierung der simplen linearen Regression mit einem Pfeil sowie den Informationen zu der Geradengleichung und dem Bestimmtheitsmaß <span class="math inline">\(R^2\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Zerforschen: Zwei simple lineare Regression nebeneinander
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In diesem Zerforschenbeispiel wollen wir uns eine simple lineare Regression in einem Scatterplot anschauen. Das stimmt nicht so ganz, den die Schwierigkeit liegt darin, dass es sich um zwei Scatterplots handelt. Klar, du kannst die beiden Abbildungen einfach getrennt erstellen und dann wäre gut. Ich zeige dir dann aber noch zwei weitere Möglichkeiten. Daher fangen wir mit der folgenden Abbildung einmal an. Wir haben hier zwei Scatterplots mit jeweils einer linearen Regression, dargestellt durch eine Gerade mit Regressionsgleichung, vorliegen. Hier brauchen wir dann mal ein paar mehr Zahlen, die ich mir dann aber so grob aus der Abbildung abgeleitet habe.</p>
<div id="fig-simple-regression" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simple-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/eda/zerforschen_regression_linear.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-35" data-gallery="quarto-lightbox-gallery-35"><img src="images/eda/zerforschen_regression_linear.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simple-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.35— Ursprüngliche Abbildung, die nachgebaut werden soll. Zwei lineare Regressionen mit den jeweiligen Regressionsgleichungen.
</figcaption>
</figure>
</div>
<p>Wir laden als erstes wieder den Datensatz, den ich mir aus der obigen Abbildung erstellt habe. Wie immer beim Zerforschen habe ich nicht so genau drauf geachtet nur das die Zahlen so grob stimmen. Die Erstellung der Daten kann hier recht langwierig sein, aber hier geht es ja mehr um die Nutzung von <code>ggplot</code>. Also mach dir keinen Gedanken, wenn die Punkte nicht so perfekt passen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>regression_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/zerforschen_regression_linear.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(type, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Basil"</span>, <span class="st">"Oregano"</span>)))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>regression_tbl </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 3
   type  washed unwashed
   &lt;fct&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1 Basil      0        0
 2 Basil     10       15
 3 Basil     20       18
 4 Basil     30       32
 5 Basil     40       36
 6 Basil     50       52
 7 Basil     60       59
 8 Basil     70       72
 9 Basil     80       85
10 Basil    100      105
# ℹ 30 more rows</code></pre>
</div>
</div>
<p>Den folgenden Teil kannst du überspringen, wenn es dir um die Abbildung geht. Ich möchte in den zwei folgenden Tabs einmal die simple lineare Regression für die Abbildung mit dem Basilikum und einmal für das Oregano rechnen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Lineare Regression für Basilikum</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Lineare Regression für Oregano</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>Wir erstellen uns einmal eine simple lineare Regression mit der Funktion <code>lm()</code>. Mehr zu dem Thema und die Maßzahlen der Güte einer linearen Regression wie das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> findest du im Kapitel zur <a href="stat-linear-reg-basic.html">simplen linearen Regression</a>. Deshalb hier nur die Durchführung und nicht mehr.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(unwashed <span class="sc">~</span> washed, <span class="at">data =</span> <span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Basil"</span>))</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  parameters<span class="sc">::</span><span class="fu">model_parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Parameter, Coefficient)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient
-------------------------
(Intercept) |        2.10
washed      |        1.00</code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2</span>(fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Linear Regression
       R2: 0.994
  adj. R2: 0.994</code></pre>
</div>
</div>
<p>Wir nutzen jetzt gleich die Koeffizienten aus der linearen Regression für die Erstellung der Geradengleichung.</p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>Auch hier gilt wie im anderen Tab, dass wir uns einmal eine simple lineare Regression mit der Funktion <code>lm()</code> erstellen. Mehr zu dem Thema und die Maßzahlen der Güte einer linearen Regression wie das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> findest du im Kapitel zur <a href="stat-linear-reg-basic.html">simplen linearen Regression</a>. Deshalb hier nur die Durchführung und nicht mehr.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(unwashed <span class="sc">~</span> washed, <span class="at">data =</span> <span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Oregano"</span>))</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  parameters<span class="sc">::</span><span class="fu">model_parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Parameter, Coefficient)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter   | Coefficient
-------------------------
(Intercept) |        8.17
washed      |        0.99</code></pre>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2</span>(fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Linear Regression
       R2: 0.997
  adj. R2: 0.996</code></pre>
</div>
</div>
<p>Wir nutzen jetzt gleich die Koeffizienten aus der linearen Regression für die Erstellung der Geradengleichung.</p>
</div>
</div>
</div>
<p>Soweit so gut. In den beiden obigen Tabs haben wir jetzt die Koeffizienten der Regressionsgleichung berechnet. Wir kriegen also aus der Funktion <code>lm()</code> die Steigung und den y-Achsenabschnitt (eng. <em>Intercept</em>). Damit können wir uns dann die beiden Funktionen für die Gerade der Basilikumdaten und der Oreganodaten bauen. Wir werden dann in <code>ggplot</code> mit der Funktion <code>geom_function()</code> die entsprechenden Gerade zeichnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>basil_func <span class="ot">&lt;-</span> \(x){<span class="fl">2.10</span> <span class="sc">+</span> <span class="fl">1.00</span> <span class="sc">*</span> x}</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>oregano_func <span class="ot">&lt;-</span> \(x){<span class="fl">8.17</span> <span class="sc">+</span> <span class="fl">0.99</span> <span class="sc">*</span> x}</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Du hast jetzt im Folgenden die Wahl zwischen drei Lösungen des Problems. Jede dieser Lösungen ist vollkommen in Ordnung und ich zeige dir hier nur die Möglichkeiten. Nimm einfach die Lösung, die dir am besten gefällt und passt. Was machen wir nun? Wir stellen einmal die beiden Abbildungen getrennt voneinander dar. Im Weiteren nutzen wir einmal die Funktion <code>facet_wrap()</code> um nach einem Faktor die Abbildungen aufzutrennen. Am Ende nutzen wir noch das R Paket <code>patchwork</code> um aus zwei Abbildungen dann eine schön annotierte Abbildung zu machen.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Zwei Abbildungen</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Mit <code>facet_wrap()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Mit <code>patchwork</code></a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>Der Kern der <a href="stat-modeling-noninferiority.html#fig-ggplot-zerforschen-regression-3a" class="quarto-xref">Abbildung&nbsp;<span>61.2</span></a> und <a href="stat-modeling-noninferiority.html#fig-ggplot-zerforschen-regression-3b" class="quarto-xref">Abbildung&nbsp;<span>61.3</span></a> ist die Funktion <code>filter()</code>. Wir bauen uns sozusagen zweimal einen Datensatz und leiten dann den Datensatz in die Funktion <code>ggplot()</code> weiter. Der Trick ist eigentlich, dass wir große Teile des Codes kopieren und dann für das Oregano wieder verwenden. Wenn du dir beide Chunks mal näher anschaust, wirst du große Änlichkeiten sehen. Im Prinzip musst du nur aufpassen, dass du jeweils die richtigen Geradenfunktionen einsetzt.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Basil"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> washed, <span class="at">y =</span> unwashed, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> basil_func, <span class="at">color =</span> cbbPalette[<span class="dv">2</span>], <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span> </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> cbbPalette[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(Iodine content in </span><span class="sc">\t</span><span class="st">extbf{unwashed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>), </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">600</span>, <span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(Iodine content in </span><span class="sc">\t</span><span class="st">extbf{washed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>), </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">600</span>, <span class="dv">150</span>)) <span class="sc">+</span> </span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">150</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> cbbPalette[<span class="dv">2</span>],  </span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($y = 2.10 + 1.00 \cdot x;\; R^2 = 0.99$)"</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-regression-3a" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-regression-3a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3a-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-36" data-gallery="quarto-lightbox-gallery-36"><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3a-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-regression-3a-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.36— Einmal die einfache Abbildung der linearen Regression in <code>ggplot</code> für Basilikum nachgebaut. Beachte die Funktion <code>filter()</code>, die den jeweiligen Datensatz für die beiden Kräuter erzeugt.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Und nochmal die simple Regression in dem Scatterplot für das Oregano. Bitte beachte einmal die Beschreibungen im Code und du wirst sehen, dass hier sehr viel gleich zum obigen Codeblock ist. In dem Tab zum R Paket <code>patchwork</code> zeige ich dir dann noch die Möglichkeit ein Template zu erstellen und dann einiges an Zeilen an Code zu sparen. Aber es geht auch so.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Oregano"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> washed, <span class="at">y =</span> unwashed, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> oregano_func, <span class="at">color =</span> cbbPalette[<span class="dv">3</span>], <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> cbbPalette[<span class="dv">3</span>]) <span class="sc">+</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(Iodine content in </span><span class="sc">\t</span><span class="st">extbf{unwashed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>),</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">150</span>)) <span class="sc">+</span> </span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(Iodine content in </span><span class="sc">\t</span><span class="st">extbf{washed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>), </span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">150</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> cbbPalette[<span class="dv">3</span>],  </span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($y = 8.17 + 0.99 \cdot x;\; R^2 = 0.99$)"</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-regression-3b" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-regression-3b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3b-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-37" data-gallery="quarto-lightbox-gallery-37"><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3b-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-regression-3b-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.37— Einmal die einfache Abbildung der linearen Regression in <code>ggplot</code> für Oregano nachgebaut. Beachte die Funktion <code>filter()</code>, die den jeweiligen Datensatz für die beiden Kräuter erzeugt.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>Hier brauchen wir jetzt das R Paket <code>grid</code> damit wir am Anschluss noch unsere Abbildungen mit den Gleichungen beschriften können. Die Idee ist eigentlich recht simple. Wir haben den Faktor <code>type</code> und nutzen die Funktion <code>facet_wrap()</code> um nach diesem Faktor zwei Abbildungen zu bauen. Unser Faktor hat zwei Level <code>Basilikum</code> und <code>Oregano</code> und deshalb erhalten wir auch zwei Subbplots. Wir können dann auch entscheiden, wie die Abbildungen angeordnet werden sollen, aber da bitte einmal bei <a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">Hilfeseite von <code>facet_wrap()</code></a>. Sonst sit alles gleich wie im ersten Tab. Also bitte nochmal da schauen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> regression_tbl, <span class="fu">aes</span>(<span class="at">x =</span> washed, <span class="at">y =</span> unwashed,</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">data =</span> <span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Basil"</span>),</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">fun =</span> basil_func, <span class="at">color =</span> cbbPalette[<span class="dv">2</span>], <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span> </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">data =</span> <span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Oregano"</span>),</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">fun =</span> oregano_func, <span class="at">color =</span> cbbPalette[<span class="dv">3</span>], <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span> </span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type) <span class="sc">+</span> </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(Iodine content in </span><span class="sc">\t</span><span class="st">extbf{unwashed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>),</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(Iodine content in </span><span class="sc">\t</span><span class="st">extbf{washed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>),</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.text</span>(<span class="fu">TeX</span>(r<span class="st">"($y = 2.10 + 1.00 \cdot x;\; R^2 = 0.99$)"</span>),  </span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="fl">0.2</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">just =</span> <span class="st">"left"</span>, <span class="at">gp =</span> grid<span class="sc">::</span><span class="fu">gpar</span>(<span class="at">col =</span> cbbPalette[<span class="dv">2</span>])) </span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.text</span>(<span class="fu">TeX</span>(r<span class="st">"($y = 8.17 + 0.99 \cdot x;\; R^2 = 0.99$)"</span>),  </span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> <span class="fl">0.65</span>, <span class="at">y =</span> <span class="fl">0.2</span>, <span class="at">just =</span> <span class="st">"left"</span>, <span class="at">gp =</span> grid<span class="sc">::</span><span class="fu">gpar</span>(<span class="at">col =</span> cbbPalette[<span class="dv">3</span>]))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-regression-3c" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-regression-3c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3c-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-38" data-gallery="quarto-lightbox-gallery-38"><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3c-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-regression-3c-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.38— Einmal die einfache Abbildung der linearen Regression in <code>ggplot</code> für Oregano nachgebaut. Beachte die Funktion <code>facet_wrap()</code>, die den jeweiligen Datensatz für die beiden Kräuter erzeugt.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Und dann sind wir auch schon fertig. Gut, das ist jetzt mit der Regressionsgleichung etwas fricklig, aber das ist es meistens, wenn du viel auf einmal darstellen willst. Vielleicht ist dann noch die Idee mit dem R Paket <code>patchwork</code> im nächsten Tab hilfreich.</p>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<p>Jetzt drehen wir nochmal frei und holen alles raus was geht. Wir nutzen zum einen das <a href="https://patchwork.data-imaginist.com/">R Paket <code>patchwork</code></a> um zwei Abbildungen miteinander zu verbinden. Prinzipiell geht das auch mit dem <a href="https://cran.r-project.org/web/packages/gridExtra/vignettes/arrangeGrob.html">R Paket <code>grid</code></a> und der Funktion <code>grid.arrange()</code>, aber dann wird das hier sehr voll. Wir nutzen am Ende nur eine Funktion aus dem Paket <code>grid</code> um wiederum die <span class="math inline">\(x\)</span>-Achse schön hinzukriegen. Als erstes wollen wir uns aber ein Template in <code>ggplot</code> bauen, dass wir dann mit einem neuen Datensatz durch den Operator <code>%+%</code> mit einem neuen Datensatz versehen können.</p>
<p>Im Folgenden stecken wir den <em>ganzen</em> Datensatz in eine <code>ggplot()</code>-Funktion. Später wählen wir dann mit <code>filter()</code> die beiden Kräuterdatensätze aus. Wir definieren in dem Template alles, was wir auch für die beiden Abbildungen brauchen würden. Das spart dann etwas an Zeilen Code. Manchmal dann aber auch nicht ganz so viel, denn wir müssen für die einzelnen Datensätze dann doch noch einiges anpassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>p_template <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(regression_tbl, <span class="fu">aes</span>(<span class="at">x =</span> washed, <span class="at">y =</span> unwashed,</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">""</span>,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">150</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">900</span>)) <span class="sc">+</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name =</span> <span class="fu">TeX</span>(r<span class="st">"(</span><span class="sc">\t</span><span class="st">extbf{Washed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>),</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">900</span>, <span class="dv">150</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">900</span>)) <span class="sc">+</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir nutzen jetzt das <code>p_template</code> und ergänzen den gefilterten Datensatz für das Basilikum mit dem Operator <code>%+%</code>. Dann wählen wir noch die passende Farbe über die Option <code>order = 1</code> aus und ergänzen die Geradengleichung sowie den Titel für die Abbildung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>p_basil <span class="ot">&lt;-</span> p_template <span class="sc">%+%</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Basil"</span>) <span class="sc">+</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>(<span class="at">order =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> basil_func, <span class="at">color =</span> cbbPalette[<span class="dv">2</span>], </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">150</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> cbbPalette[<span class="dv">2</span>], </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($y = 2.10 + 1.00 \cdot x;\; R^2 = 0.99$)"</span>)) <span class="sc">+</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Basil"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Das Ganze dann nochmal für das Oregano, aber hier entfernen wir die <span class="math inline">\(y\)</span>-Achse. Wir brauchen nur eine auf der linken Seite. Das ist auch der Grund warum wir keine <span class="math inline">\(x\)</span>-Achse benannte haben, dass machen wir dann über die beiden Plots zusammen ganz am Ende. Auch hier ergänzen wir dann die Gweradengleichung sowie den Titel der Abbildung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>p_oregano <span class="ot">&lt;-</span> p_template <span class="sc">%+%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(regression_tbl, type <span class="sc">==</span> <span class="st">"Oregano"</span>) <span class="sc">+</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>(<span class="at">order =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> oregano_func, <span class="at">color =</span> cbbPalette[<span class="dv">3</span>], </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">150</span>, <span class="at">y =</span> <span class="dv">100</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">color =</span> cbbPalette[<span class="dv">3</span>], </span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($y = 8.17 + 0.99 \cdot x;\; R^2 = 0.99$)"</span>)) <span class="sc">+</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Oregano"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt geht es los mit dem Zusammenbauen. Wir können dazu einfach das <code>+</code> nutzen. Wenn du mehr wissen willst, was du noch ändern kannst, dann schaue einmal das Tutorium <a href="https://patchwork.data-imaginist.com/articles/guides/annotation.html">Adding Annotation and Style</a> für das R Paket <code>patchwork</code>an. Da kannst du dann auch die Schriftgröße und weiteres ändern. Wir müssen dann ganz am Ende nochmal mit der Funktion <code>grid.draw()</code> die gemeinsame <span class="math inline">\(x\)</span>-Achse ergänzen. Am Ende habe ich noch die Achsenbeschriftungen gekürzt und die Informationen in den Titel mit der Funktion <code>plot_annotation</code> geschoben. Dann habe ich noch die Subplots mit einem Buchstaben versehen. Und dann sind wir auch schon fertig.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>p_basil <span class="sc">+</span> p_oregano <span class="sc">+</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">'Iodine content in herbs'</span>,</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">subtitle =</span> <span class="st">'The iodine content is measured in washed and unwashed herbs'</span>,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">caption =</span> <span class="st">'Disclaimer: The measurement has been done in freshmatter'</span>,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tag_levels =</span> <span class="st">'A'</span>)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.draw</span>(grid<span class="sc">::</span><span class="fu">textGrob</span>(<span class="fu">TeX</span>(r<span class="st">"(</span><span class="sc">\t</span><span class="st">extbf{Unwashed} herbs $[\mu g\, l \, (100 g\, FM)^{-1}]$)"</span>), </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y =</span> <span class="fl">0.07</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ggplot-zerforschen-regression-3d" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-zerforschen-regression-3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3d-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-39" data-gallery="quarto-lightbox-gallery-39"><img src="eda-ggplot_files/figure-html/fig-ggplot-zerforschen-regression-3d-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-zerforschen-regression-3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.39— Einmal die einfache Abbildung der linearen Regression in <code>ggplot</code> nachgebaut. Die Abbildung A zeigt die Punkte und die Geradengleichung für das Basilikum. Die Abbildung B die entsprechenden Informationen für das Oregano. Die beiden Achsenbeschriftungen wurden gekürzt und die Informationen in den Titel übernommen.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Am Ende kannst du dann folgenden Code noch hinter deinen <code>ggplot</code> Code ausführen um dann deine Abbildung als <code>*.png</code>-Datei zu speichern. Dann hast du die Abbildung super nachgebaut und sie sieht auch wirklich besser aus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"my_ggplot_simple_regression.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="sec-eda-mosaic" class="level3" data-number="17.4.4">
<h3 data-number="17.4.4" class="anchored" data-anchor-id="sec-eda-mosaic"><span class="header-section-number">17.4.4</span> Mosaicplot</h3>
<p>Der Mosaicplot ist ein eher seltener Plot. Wir nutzen ihn aber häufig in der <a href="stat-modeling-survey.html">Fragebogenanalyse</a> oder aber in den Gesundheitswissenschaften. Da wir dann aber immer wieder Überschneidungen haben, wollen wir hier auch den Mosaicplot lernen. Was macht der Mosaicplot? Wir können mit dem Mosaicplot zwei Variablen, die nur aus Kategorien bestehen visualisieren. Ein Mosaicplot macht dabei für nur eine Gruppe keinen Sinn. Wir brauchen immer ein <span class="math inline">\(X\)</span> mit mindestens zwei Gruppen sowie ein <span class="math inline">\(Y\)</span> mit mindestens zwei Gruppen. Betrachten wir also einmal den Mosaicplot theoretisch, dann einmal händisch am Beispiel der mit Flohschnupfen infizierten Hunde- und Katzenflöhe sowie die Umsetzung in <code>{ggplot}</code>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false"><code>{ggplot}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>Ein Mosaicplot ist nichts anderes als die Visualisierung einer 2x2 Kreuztabelle. Daher im Folgenden einmal eine typische 2x2 Kreuztabelle als Abbildung. Wir schreiben in die Kästen die jeweiligen Anzahlen des Auftretens und berechnen dann die Anteile <em>in der Spalte</em>. Hier ist schon die erste Entscheidung zu treffen. Wie wollen wir die Anteile berechnen? Auf der ganzen Tabelle und daher durch <span class="math inline">\(n\)</span> teilen? Oder aber über die Zeilen und damit über die Kategorien von <span class="math inline">\(Y\)</span>? Häufig wollen wir wissen, wie sich die Gruppen in <span class="math inline">\(X\)</span> im Bezug auf <span class="math inline">\(Y\)</span> unterscheiden. Daher werden die Gruppen in die Spalten geschrieben und wir berechnen die Anteile spaltenweise. In der folgenden 2x2 Tafl siehst du einmal die Erstellung für den spaltenweisen Anteilsvergleich.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-mosaic-theo-01" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosaic-theo-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-mosaic-theo-01-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-40" data-gallery="quarto-lightbox-gallery-40"><img src="eda-ggplot_files/figure-html/fig-mosaic-theo-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosaic-theo-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.40— Eine theoretische 2x2 Tafel für zwei Gruppen und einem kategoriellen Endpunkt <span class="math inline">\(y\)</span> mit den beiden Ausprägungen ja/nein oder 0/1. Für jedes der Felder wird spaltenweise der Anteil berechnet. Insgesamt wurden <span class="math inline">\(n\)</span> Beobachtungen gemacht. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Der Mosaicplot ist jetzt nichts anderes als die Visualisierung der obigen theoretischen 2x2 Kreuztabelle. Dabei kippen wir einmal die Beschriftung der Spalten von oben nach unten, da wir es ja jetzt mit einer Abbildung zu tun haben und nicht mit einer Abbildung. Der eigentliche Witz eines Mosaicplot ist jetzt die Flächen <em>spaltenweise</em> den berechneten Anteilen anzupassen. Auf diese Weise können wir die Anteile der Gruppen sofort visuell erfassen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-mosaic-theo-02" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosaic-theo-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-mosaic-theo-02-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-41" data-gallery="quarto-lightbox-gallery-41"><img src="eda-ggplot_files/figure-html/fig-mosaic-theo-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosaic-theo-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.41— Theoretischer Mosaicplot, der die Anteile <em>spaltenweise</em> für die beiden Guppen an dem Endpunkt <span class="math inline">\(Y\)</span> wiedergibt. Dabei ist die Fläche <span class="math inline">\(A\)</span>, die jedes Quadrat einnimmt proportional zu dem berechneten Anteil. Die Anteile können so visuell schnell verglichen werden. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<p>Für unsere händische Erstellung des Mosaicplots brauchen wir erstmal eine 2x2 Kreuztabelle. Hierz nutzen wir den Anteil der Flöhe mit Flohschnupfen in unseren Hunde- und Katzenflohdaten. Dabei wollen wir wissen, ob sich die beiden Tierarten als Gruppen voneinander unterscheiden. Damit ist unser <span class="math inline">\(Y\)</span> der Infektionsstatus (ja/nein) und unser <span class="math inline">\(X\)</span> die beiden Tierarten (dog/cat). Es ergibt sich dann die folgende 2x2 Kreuztabelle. Beachte auch die entsprechenden Randsummen, die auch noch eine Information über die Daten beinhalten. So finden wir nämlich mehr gesunde Tiere in unseren Daten als kranke Tiere über die beiden Tierart hinweg.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-mosaic-hand-01" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosaic-hand-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-mosaic-hand-01-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-42" data-gallery="quarto-lightbox-gallery-42"><img src="eda-ggplot_files/figure-html/fig-mosaic-hand-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosaic-hand-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.42— Eine 2x2 Tafel für die Hunde- und Katzenflöhe und dem entsprechenden Infektionsstatus mit den beiden Ausprägungen ja/nein oder 0/1. Für jedes der Felder wird spaltenweise der Anteil berechnet. So haben 43% der Hundeflöhe einen Schnupfen aber nur 29% der Katzen. Insgesamt wurden <span class="math inline">\(n\)</span> Beobachtungen gemacht. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Leider sind die Prozentzahlen in der 2x2 Kreuztabelle schwer visuell zu unterscheiden. Deshalb zeichnen wir den Mosaicplot so, dass die Flächen die Anteile in den Spalten widerspiegeln. So ist die Fläche von 43% kranken Hundeflöhen fast doppelt so groß wie die Fläche der 29% kranken Katzen. Daher lassen sich so schnell die Gruppen miteinander vergleichen. Wir sehen hier sehr schön, dass weit weniger Katzenflöhe mit Flohschnupfen infiziert sind als Hundeflöhe.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-mosaic-hand-02" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosaic-hand-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-mosaic-hand-02-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-43" data-gallery="quarto-lightbox-gallery-43"><img src="eda-ggplot_files/figure-html/fig-mosaic-hand-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosaic-hand-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.43— Mosaicplot des Infektionsstatus für die Hunde- und Katzenflöhe. Der Anteil ist für beide Gruppen <em>spaltenweise</em> an dem Endpunkt <span class="math inline">\(Y\)</span> berechnet. Dabei ist die Fläche <span class="math inline">\(A\)</span>, die jedes Quadrat einnimmt proportional zu dem berechneten Anteil. Die Anteile können so visuell schnell verglichen werden. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<p>Für unseren Mosaicplot in R nutzen wir das R Paket <code>{ggmosaic}</code> welches uns dann ermöglicht einen Mosaicplot in <code>{ggplot}</code> zu erstellen. Zuerst müssen wir uns aber noch die Daten zusammenbauen. Dafür brauchen wir die Spalten <code>infected</code> und <code>animal</code> einmal als Faktoren und nicht als Zahlen oder Wörter. Um die 2x2 Tabelle in R in der richtigen Orientierung vorliegen zu haben, müssen wir nochmal einen kleinen Klimmzug über <code>mutate()</code> nehmen. Wir wandeln die Variable <code>infected</code> in einen Faktor um und sortieren die Level entsprechend, so dass wir die richtige Ordnung wie später im Mosaicplot haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>flea_dog_cat_mosaic_tbl <span class="ot">&lt;-</span> flea_dog_cat_tbl <span class="sc">|&gt;</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">factor</span>(animal, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"dog"</span>, <span class="st">"cat"</span>)),</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">infected =</span> <span class="fu">factor</span>(infected, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Betrachten wir jetzt einmal die 2x2 Kreuztabelle der beiden Spalten <code>animal</code> und <code>infected</code> mit der Funktion <code>tabyl()</code> aus dem R Paket <code>{janitor}</code> um einen Überblick zu erhalten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>flea_dog_cat_mosaic_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(infected, animal) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> infected dog cat
        0   4   5
        1   3   2</code></pre>
</div>
</div>
<p>Dannn können wir uns einmal den Mosaicplot in <code>{ggplot}</code> anschauen. Wir nutzen dafür das R Paket <code>{ggmosaic}</code> mit der Funktion <code>geom_mosaic()</code>. <a href="#fig-mosaic-flea-0" class="quarto-xref">Abbildung&nbsp;<span>17.44</span></a> zeigt den Mosaic Plot für die Variable <code>animal</code> und <code>infected</code>. Die unterschiedlich großen Flächen bilden die Verhältnisse der 2x2 Tabelle ab. So sehen wir, dass es mehr uninfizierte Flöhe als infizierte Tiere Flöhe. Am meisten gibt es uninfizierte Katzenflöhe.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_mosaic_tbl) <span class="sc">+</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(infected, animal), <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-mosaic-flea-0" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mosaic-flea-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-mosaic-flea-0-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-44" data-gallery="quarto-lightbox-gallery-44"><img src="eda-ggplot_files/figure-html/fig-mosaic-flea-0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="384"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mosaic-flea-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.44— Mosaicplot des Infektionsstatus für die Hunde- und Katzenflöhe. Der Anteil ist für beide Gruppen <em>spaltenweise</em> an dem Endpunkt <span class="math inline">\(Y\)</span> berechnet. Dabei ist die Fläche <span class="math inline">\(A\)</span>, die jedes Quadrat einnimmt proportional zu dem berechneten Anteil. Die Anteile können so visuell schnell verglichen werden. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-eda-histogramm" class="level3" data-number="17.4.5">
<h3 data-number="17.4.5" class="anchored" data-anchor-id="sec-eda-histogramm"><span class="header-section-number">17.4.5</span> Histogramm</h3>
<p>Wozu nutzen wir das Histogramm? Wir brauchen das Histogramm um die Verteilung der Messwerte <span class="math inline">\(y\)</span> abzuschätzen. Daher wie sind unsere Sprungweiten, Anzahlen oder Gewichte unserer Hunde- und Katzenflöhe verteilt. Zuerst brauchen wir aber viele Beobachtungen. Wir brauchen für ein anständiges Histogramm, wo du auch was erkennen kannst, mindestens 20 Beobachtung <em>pro Gruppe</em>. Hier ist das <em>pro Gruppe</em> sehr wichtig. Zwar haben wir auch in unseren Hunde- und Katzenflohdaten vierzehn Beobachtungen, aber nur sieben pro Gruppe! Da können wir dann mit einem Histogramm nicht viel erkennen und dann nutzen wir den Boxplot für die Abschätzung der Verteilung. Häufig irritiert bei einem Histogramm auch, dass wir auf der x-Achse die Werte der y-Achse darstellen und dann auf der y-Achse des Histogramms die Anzahlen zählen. Aber dazu dann gleich mehr in den folgenden Tabs zur theoretischen Betrachtung, einem Beispiel und der Umsetzung in <code>{ggplot}</code>. Ein Histogramm nutzen wir eigentlich in einer laufenden Analyse als ein statistisches Tool und berichten es eher selten.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Händisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false"><code>{ggplot}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<p>Für die Erstellung eines Histogramm müssen wir unterscheiden, ob wir als Outcome etwas zählbares vorliegen haben. Also ob unser Outcome Kategorien hat. Wir zählen die Anzahl an Haaren eines Flohbeins oder aber die Noten von Schülern. Wir können aber auch andere Kategorien vorliegen haben, aber es müssen schon ein paar sein. Mit ein paar meine ich dann mehr als fünf Kategorien. Ein Notenspiegel macht ja auch nur Sinn, da wir da gut zehn Notenschritte drin haben. Im Folgenden siehst du einmal eine Abbildung mit den Kategorien A bis I. Jetzt zählen wir wie oft kommt A vor, wie oft kommt B vor und so weiter. Die Anzahlen tragen wir dann als Balken ein. Dann haben wir die <em>absoluten</em> Anzahlen gezählt. Wenn wir aber Histogramme mit unterschiedlichen Beobachtungen vergleichen wollen, dann macht es mehr Sinn sich die <em>relativen</em> Häufigkeiten anzuschauen. In unserem Fall haben wir achtzehn Beobachtungen vorliegen, also bedeutet eine Beobachtung <span class="math inline">\(1/18 = 0.055\)</span> relativen Anteil.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-hist-drawn-01" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-drawn-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-hist-drawn-01-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-45" data-gallery="quarto-lightbox-gallery-45"><img src="eda-ggplot_files/figure-html/fig-hist-drawn-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-drawn-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.45— Histogramm von achtzehn Flöhen für einen kategorialen Endpunkt der Kategorien A bis I. Auf der linken Seite sind die absoluten Anzahlen dargestellt und auf der rechten Seite die entsprechenden relativen Häufigkeiten. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wenn wir keine Kategorien vorliegen haben, dann müssen wir uns für unser Outcome welche Überlegen. Das heißt wir nutzen das so genannte <em>bining</em> (deu. <em>eindosen</em>, ungebräuchlich). Wenn du das Gewicht von Flöhen misst, dann hast du Kommazahlen und damit kontinuierliche Daten vorliegen. Damit unterscheiden sich alle deine Messwerte vermutlich. Deshalb fasst du “gleiche” Werte zusammen. Meistens machen wir das, indem wir Beobachtungen in zwischen zwei Zahlen als eine Kategorie zählen. Wie da die Grenzen liegen, ist immer unterschiedlich und hängt von der Fragestellung ab.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-hist-drawn-02" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-drawn-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-hist-drawn-02-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-46" data-gallery="quarto-lightbox-gallery-46"><img src="eda-ggplot_files/figure-html/fig-hist-drawn-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-drawn-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.46— Histogramm von achtzehn Flöhen für einen kontinuierlichen Endpunkt. Ein Balken entspricht immer einem Zahlenraum entsprechend der x-Achse. Auf der linken Seite sind die absoluten Anzahlen dargestellt und auf der rechten Seite die entsprechenden relativen Häufigkeiten. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p>Betrachten wir einmal die Erstellung eine Histogramms für einen Endpunkt mit Kategorien. Dafür habe ich mir einmal die Boniturnoten für achtzehn Hundeflöhe in der folgenden Tabelle ausgedacht. Wir brauchen eben mehr Daten als wir in den ursprünglichen Hunde- und Katzenflohdaten vorliegen haben. Jetzt wollen wir uns einmal die Verteilung der Boniturnoten anschauen.</p>
<div class="cell">
<div id="tbl-hist-cat-flea-grade" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hist-cat-flea-grade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;17.3— Die Boniturnote von achtzehn Hundeflöhen.
</figcaption>
<div aria-describedby="tbl-hist-cat-flea-grade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In der folgenden Abbildung siehst du einmal die Verteilung der achtzehn Boniturnoten der Hundeflöhe dargestellt. Wir sehen sofort, dass wir am meisten die Note 3 vergeben haben. Wir haben nämlich fünfmal die Note 3 an unseren Flöhen festgestellt. Die Boniturnote 5 haben wir dann an zwei Flöhen erhoben. Da wir achtzehn Flöhe haben, entspricht jede Anzahl dann <span class="math inline">\(5.5%\)</span> auf der relativen Skala.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-hist-drawn-04" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-drawn-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-hist-drawn-04-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-47" data-gallery="quarto-lightbox-gallery-47"><img src="eda-ggplot_files/figure-html/fig-hist-drawn-04-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-drawn-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.47— Histogramm von achtzehn Flöhen für die Boniturnoten als kategorialen Endpunkt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Schauen wir uns im zweiten Beispiel einmal das Gewicht von achtzehn Hundeflöhen an. Hier siehst du, dass wir Kommazahlen also kontinuierliche Daten vorliegen haben. Keine der Zahlen ist doppelt, so dass wir hier dann keine Balken hochzählen können. Damit wir das aber können, bilden wir Zahlenräume in denen wir die Gewichte zusammenfassen.</p>
<div class="cell">
<div id="tbl-hist-cont-flea-weight" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hist-cont-flea-weight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;17.4— Das Gewicht in [mg] von achtzehn Hundeflöhen.
</figcaption>
<div aria-describedby="tbl-hist-cont-flea-weight-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">7.4</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">5.9</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">4.1</td>
<td style="text-align: right;">4.9</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.1</td>
<td style="text-align: right;">3.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In der folgenden Abbildung siehst du einmal die Zusammenfassung unserer Flohgewichte in die Zahlenräume der Größe <span class="math inline">\(1mg\)</span>. Gewichte, die in den Bereich <span class="math inline">\(x \pm 0.5\)</span> fallen, werden dann in einem Balken zusammengefasst. Wir haben zum Beispiel in dem Bereich mit <span class="math inline">\(x = 2\)</span> und somit <span class="math inline">\(2 \pm 0.5\)</span> dann die drei Werte 1.7, 2.0 und 2.1 vorliegen. Wir zeichnen einen Balken der Höhe drei. Ebenso haben wir in dem Bereich <span class="math inline">\(5.5 &lt; x \leq 6.5\)</span> zwei Beobachtungen vorliegen. Wir zeichnen hier einen Balken der Höhe zwei. Die Entscheidung wie weit der Zahlenraum zum zusammenfassen reichen soll, ist meist ein Ausprobieren. Das ist natürlich bei der händischen Erstellung problematisch.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-hist-drawn-03" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-drawn-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-hist-drawn-03-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-48" data-gallery="quarto-lightbox-gallery-48"><img src="eda-ggplot_files/figure-html/fig-hist-drawn-03-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-drawn-03-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.48— Histogramm von achtzehn Flöhen für das Gewicht als kontinuierlichen Endpunkt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<p>Für die Erstellung eines Histogramms mit <code>{ggplot}</code> nutzen wir unsere Spieldaten aus dem Tab zur händischen Erstellung eines Histogramms. Nun schauen wir uns jetzt einmal achtzehn Hundflöhe an und bestimmen die Boniturnote, dargestellt in der Spalte <code>grade</code>. Darüber hinaus bestimmen wir auch noch das mittlere Gewicht der Flöhe auf dem jeweiligen Hund, dargestellt in der Spalte <code>weight</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>flea_hist_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">grade =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">7</span>),</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">weight =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.7</span>, <span class="fl">2.0</span>, <span class="fl">2.1</span>, <span class="fl">2.7</span>, </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="fl">2.8</span>, <span class="fl">3.0</span>, <span class="fl">3.1</span>, <span class="fl">3.3</span>, <span class="fl">3.8</span>, </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="fl">4.0</span>, <span class="fl">4.1</span>, <span class="fl">4.3</span>, <span class="fl">4.9</span>, <span class="fl">5.2</span>, </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="fl">5.9</span>, <span class="fl">6.1</span>, <span class="fl">7.4</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In <code>{ggplot}</code> können wir ein Histogramm mit der Funktion <code>geom_histogram()</code> erstellen. Dabei ist es dann immer etwas verwirrend, dass wir unser Outcome als <span class="math inline">\(y\)</span> dann auf der x-Achse darstellen. Wir können die Option <code>binwidth</code> nutzen, um zu entscheiden, wie viele Noten in einem Balken zusammengefasst werden sollen. Sinnvoll ist natürlich hier eine <code>binwidth</code> von 1, da wir pro Balken eine Boniturnote zählen wollen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_hist_tbl, <span class="fu">aes</span>(<span class="at">x =</span> grade)) <span class="sc">+</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"gray"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Boniturnote"</span>, <span class="at">y =</span> <span class="st">"Anzahl"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-hist-flea-count" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-flea-count-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-hist-flea-count-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-49" data-gallery="quarto-lightbox-gallery-49"><img src="eda-ggplot_files/figure-html/fig-hist-flea-count-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-flea-count-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.49— Histogramm der Boniturnoten von achtzehn Hundeflöhen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Anders sieht es für kontinuierliche Variablen mit Kommazahlen aus. Schauen wir uns das Gewicht der Flöhe an, so sehen wir, dass es sehr viele Zahlen gibt, die nur einmal vorkommen. Hier können wir dann mit <code>binwidth</code> den Bereich einstellen, in denen die Zahlen fallen sollen. Auch hier ist es immer ein Gefummel, wenn wir zu wenige Beobachtungen vorliegen haben. Die beste Bandbreite für die Balken zu finden, ist immer ein Ausprobieren.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_hist_tbl, <span class="fu">aes</span>(<span class="at">x =</span> weight)) <span class="sc">+</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"gray"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Gewicht [mg]"</span>, <span class="at">y =</span> <span class="st">"Anzahl"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-hist-flea-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hist-flea-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-hist-flea-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-50" data-gallery="quarto-lightbox-gallery-50"><img src="eda-ggplot_files/figure-html/fig-hist-flea-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hist-flea-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.50— Histogramm des Gewichts von achtzehn Hundeflöhen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="density-plot" class="level3" data-number="17.4.6">
<h3 data-number="17.4.6" class="anchored" data-anchor-id="density-plot"><span class="header-section-number">17.4.6</span> Density Plot</h3>
<p>Eine weitere Möglichkeit sich eine Verteilung anzuschauen, ist die Daten nicht als Balkendiagramm sondern als Densityplot - also Dichteverteilung - anzusehen. Im Prinzip verwandeln wir die Balken in eine Kurve. Damit würden wir im Prinzip unterschiedliche Balkenhöhen ausgleichen und eine “glattere” Darstellung erreichen. Wir wir aber gleich sehen werden, benötigen wir dazu eine Menge an Beobachtungen und auch dann ist das Ergebnis eventuell nicht gut zu interpretieren. Eine händische Darstellung ist nicht möglich, wir machen Dichteverteilungen nur in R aber nicht selber auf einem Blattpapier.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Theoretisch</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false"><code>{ggplot}</code></a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<p>Anbei einmal die Darstellung des Densityplots mit einem Histogramm im Hintergrund. Auf der <span class="math inline">\(y\)</span>-Achse ist die Dichte als schwer zu interpretieren angeben. Im Prinzip interpretieren wir die Dichte nicht direkt sondern schätzen an der Kurve die Verteilung der Daten ab. Wie die Dichtekurve entsteht, ist hier nicht von Belang. Wir nutzen die Dichtekurve auch häufig zusammen mit anderen Abbildungen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-density-drawn-01" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-density-drawn-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-density-drawn-01-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-51" data-gallery="quarto-lightbox-gallery-51"><img src="eda-ggplot_files/figure-html/fig-density-drawn-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-density-drawn-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.51— Beispielhafte Dichtekurve für die Abschätzung der Verteilung der Daten. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<p>Schauen wir uns einmal die Densityplots in <code>{ggplot}</code> an. Wir nutzen dazu die Funktion <code>geom_density()</code>. Die Werte der Dichte interpretieren wir nicht direkt sondern betrachten nur die Form der Dichtekurve. In unserem Fall sieht die Kurve sehr nach einer Normalverteilung aus. Um die ganze Kurve zu sehen muss ich nochmal an <code>xlim()</code> drehen und den x-Achsenbereich erhöhen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_hist_tbl, <span class="fu">aes</span>(<span class="at">x =</span> grade)) <span class="sc">+</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"#CC79A7"</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Boniturnote"</span>, <span class="at">y =</span> <span class="st">"Dichte"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-dens-flea-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dens-flea-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-dens-flea-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-52" data-gallery="quarto-lightbox-gallery-52"><img src="eda-ggplot_files/figure-html/fig-dens-flea-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dens-flea-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.52— Densityplot der Boniturnote achtzehn Hundeflöhen. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-eda-dotplot" class="level3" data-number="17.4.7">
<h3 data-number="17.4.7" class="anchored" data-anchor-id="sec-eda-dotplot"><span class="header-section-number">17.4.7</span> Dotplot, Beeswarm und Raincloud Plot</h3>
<p>Wenn wir weniger als fünf Beobachtungen haben, dann ist meist ein Boxplot verzerrend. Wir sehen eine Box und glauben, dass wir viele Datenpunkte vorliegen haben. Bei 3 bis 7 Beobachtungen je Gruppe bietet sich der Dotplot als eine Lösung an. Wir stellen hier alle Beobachtungen als einzelne Punkte dar. Wie erstellen wir nun einen Dotplot in R? Wir nutzen dazu die Funktion <code>geom_dotplot()</code> wie folgt.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> grade,</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>) <span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Boniturnote [1-9]"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-dotplot-flea-eda-0" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dotplot-flea-eda-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-dotplot-flea-eda-0-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-53" data-gallery="quarto-lightbox-gallery-53"><img src="eda-ggplot_files/figure-html/fig-dotplot-flea-eda-0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dotplot-flea-eda-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.53— Der Dotplot für die Anzahl der Flöhe für die beiden Tierarten Hund und Katze.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-dotplot-flea-eda-0" class="quarto-xref">Abbildung&nbsp;<span>17.53</span></a> sehen wir den Dotplot aus der Datei <code>flea_dog_cat.xlsx</code>. Auf der x-Achse sind die Level des Faktors <code>animal</code> dargestellt und auf der y-Achse die Notenbewertung <code>grade</code> der einzelnen Hunde und Katzen. Die Funktion <code>geom_dotplot()</code> erschafft das Layer für die Dots bzw. Punkte. Wir müssen in der Funktion noch zwei Dinge angeben, damit der Plot so aussieht, dass wir den Dotplot gut interpretieren können. Zum einen müssen wir die Option <code>binaxis = y</code> wählen, damit die Punkte horizontal geordnet werden. Zum anderen wollen wir auch, dass die Punkte zentriert sind und nutzen dafür die Option <code>stackdir = center</code>.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> grade,</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>) <span class="sc">+</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> median, <span class="at">fun.min =</span> median, <span class="at">fun.max =</span> median,</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">"crossbar"</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Tierart"</span>, <span class="at">y =</span> <span class="st">"Boniturnote [1-9]"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-dotplot-flea-eda-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dotplot-flea-eda-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-dotplot-flea-eda-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-54" data-gallery="quarto-lightbox-gallery-54"><img src="eda-ggplot_files/figure-html/fig-dotplot-flea-eda-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dotplot-flea-eda-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.54— Der Dotplot für die Anzahl der Flöhe für die beiden Tierarten Hund und Katze. Die schwarze Linie stelt den Median für die beiden Tierarten dar.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Nun macht es wenig Sinn bei sehr wenigen Beobachtungen noch statistische Maßzahlen mit in den Plot zu zeichnen. Sonst hätten wir auch gleich einen Boxplot als Visualisierung der Daten wählen können. In <a href="#fig-dotplot-flea-eda-1" class="quarto-xref">Abbildung&nbsp;<span>17.54</span></a> sehen wir die Ergänzung des Medians. Hier müssen wir etwas mehr angeben, aber immerhin haben wir so eine Idee, wo die “meisten” Beobachtungen wären. Aber auch hier ist Vorsicht geboten. Wir haben sehr wenige Beobachtungen, so dass eine Beobachtung mehr oder weniger große Auswirkungen auf den Median und die Interpretation hat.</p>
<p>Dann möchte ich hier den Beeswarm als eine Alternative zu dem Dotplot vorstellen. Insbesondere wenn du sehr viele Beobachtungen hast, dann hat der Beeswarm bessere Eigenschaften als der Dotplot. Es gibt hier auch die tolle Hilfeseite zu <a href="https://r-charts.com/distribution/ggbeeswarm/">Beeswarm plot in ggplot2 with <code>geom_beeswarm()</code></a> und natürlich noch die Möglichkeit ein Violin Plot zu ergänzen. Auch hier dann mal bei der Hilfeseite <a href="https://r-charts.com/distribution/violin-plot-points-ggplot2/">Violin plot with data points in ggplot2</a> schauen. In <a href="#fig-beeswarm-flea-eda-0" class="quarto-xref">Abbildung&nbsp;<span>17.55</span></a> siehst du dann einmal das Alter und die Körpergröße für die beiden Geschlechter in den Gummibärchendaten aufgeteilt.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> age,</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>() <span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Alter in Jahren"</span>) <span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> height,</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>() <span class="sc">+</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Körpergröße in cm"</span>) <span class="sc">+</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-beeswarm-flea-eda-0" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-beeswarm-flea-eda-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-beeswarm-flea-eda-0" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-beeswarm-flea-eda-0-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-beeswarm-flea-eda-0-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-beeswarm-flea-eda-0-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-55" data-gallery="fig-beeswarm-flea-eda-0"><img src="eda-ggplot_files/figure-html/fig-beeswarm-flea-eda-0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-beeswarm-flea-eda-0" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-beeswarm-flea-eda-0-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Alter nach Geschlecht
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-beeswarm-flea-eda-0" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-beeswarm-flea-eda-0-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-beeswarm-flea-eda-0-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-beeswarm-flea-eda-0-2.png" class="lightbox" data-glightbox="description: .lightbox-desc-56" data-gallery="fig-beeswarm-flea-eda-0"><img src="eda-ggplot_files/figure-html/fig-beeswarm-flea-eda-0-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-beeswarm-flea-eda-0" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-beeswarm-flea-eda-0-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Körpergröße nach Geschlecht
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-beeswarm-flea-eda-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.55— Der Beeswarm ist ein Dotplot für eine große Anzahl an Beobachtungen. Hier schauen wir uns einmal das Alter und die Körpergröße aufgeteilt nach Geschlecht an.
</figcaption>
</figure>
</div>
</div>
<p>Und dann bringen wir in der <a href="#fig-halfplot-dot-gummi-1" class="quarto-xref">Abbildung&nbsp;<span>17.56</span></a> mal verschiedene Abbildungen zusammen mit dem <a href="https://erocoar.github.io/gghalves/">R Paket<code>{gghalves}</code></a>. Wir können mit <code>{gghalves}</code> halbe Plots erstellen und diese dann miteinander kombinieren. Damit packen wir dann in die Mitte Boxplots. Links von den Boxplots zeichnen wir die einzelnen Beobachtungen als Punkte mit <code>stat_dots()</code> und die Verteilung der einzelnen Beobachtungen zeichnen wir mit dem <a href="https://mjskay.github.io/ggdist/">R Paket <code>{ggdist}</code></a>. Das Tutorium <a href="https://www.cedricscherer.com/2021/06/06/visualizing-distributions-with-raincloud-plots-and-how-to-create-them-with-ggplot2/">Visualizing Distributions with Raincloud Plots</a> liefert dann noch mehr Anleitungen für noch mehr Varianten. Wie du aber schon am R Code siehst, ist das eine etwas komplexere Abbildung geworden.</p>
<div class="cell" data-layout-nrow="1" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> age, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">.width =</span> <span class="dv">0</span>, </span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">point_colour =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dots</span>(<span class="at">side =</span> <span class="st">"left"</span>, <span class="at">justification =</span> <span class="fl">1.12</span>, <span class="at">binwidth =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">1.9</span>), <span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Alter in Jahren"</span>) <span class="sc">+</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> height, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">.width =</span> <span class="dv">0</span>, </span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.3</span>, <span class="at">point_colour =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dots</span>(<span class="at">side =</span> <span class="st">"left"</span>, <span class="at">justification =</span> <span class="fl">1.12</span>, <span class="at">binwidth =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">1.9</span>), <span class="at">clip =</span> <span class="st">"off"</span>) <span class="sc">+</span></span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Körpergröße in cm"</span>) <span class="sc">+</span></span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-halfplot-dot-gummi-1" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-halfplot-dot-gummi-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-halfplot-dot-gummi-1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-halfplot-dot-gummi-1-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-halfplot-dot-gummi-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-halfplot-dot-gummi-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-57" data-gallery="fig-halfplot-dot-gummi-1"><img src="eda-ggplot_files/figure-html/fig-halfplot-dot-gummi-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-halfplot-dot-gummi-1" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-halfplot-dot-gummi-1-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Alter nach Geschlecht
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-halfplot-dot-gummi-1" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-halfplot-dot-gummi-1-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-halfplot-dot-gummi-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-halfplot-dot-gummi-1-2.png" class="lightbox" data-glightbox="description: .lightbox-desc-58" data-gallery="fig-halfplot-dot-gummi-1"><img src="eda-ggplot_files/figure-html/fig-halfplot-dot-gummi-1-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-halfplot-dot-gummi-1" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-halfplot-dot-gummi-1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Körpergröße nach Geschlecht
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-halfplot-dot-gummi-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.56— Der <code>{gghalves}</code>-Plot als Kombination vom Dotplot, Boxplot sowie Densityplot. Mit der Art der Abbildung spart man sich dann drei Abbildungen. Hier haben wir dann alle Informationen über die Körpergröße sowie dem Alter in Abhängigkeit vom Geschlecht in einer Abbildung.
</figcaption>
</figure>
</div>
</div>
</section>
<section id="sec-eda-violinplot" class="level3" data-number="17.4.8">
<h3 data-number="17.4.8" class="anchored" data-anchor-id="sec-eda-violinplot"><span class="header-section-number">17.4.8</span> Violinplot</h3>
<p>Eine etwas neuere Abbildung, die eigentlich gar so neu ist, ist der Violinplot. Der Violinplot verbindet im Prinzip den Boxplot zusammen mit dem Densityplot. Wir haben am Ende eben eine Verteilung der Daten visualisiert. Wir schauen uns aber nicht wie in einem Histogramm die Werte als Balken an, sondern glätten die Balken zu einer Kurve. Wie immer gibt es auch ein Tutorium mit noch mehr Hilfe unter <a href="http://www.sthda.com/english/wiki/ggplot2-violin-plot-quick-start-guide-r-software-and-data-visualization">ggplot2 violin plot : Quick start guide - R software and data visualization</a>. Wir schauen uns jetzt mal die Erstellung von Violinplots in verschiedenen Kombinationen mit anderen Abbildungen an.</p>
<p>Da ein Violinplot keinen Median oder sonst eine deskriptive Zahl beinhaltet, müssen wir uns eine Funktion erstellen, die den Mittelwert plusminus Standardabweichung wiedergibt. Die Funktion rufen wir dann innerhalb von <code>ggplot()</code> auf und erhalten dann den Mittelwert und Standardabweichung als einen Punkt mit zwei Linien dargestellt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>data_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(y) {</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>   m <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>   ymin <span class="ot">&lt;-</span> m <span class="sc">-</span> <span class="fu">sd</span>(y)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>   ymax <span class="ot">&lt;-</span> m <span class="sc">+</span> <span class="fu">sd</span>(y)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">y =</span> m, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax))</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#fig-violin-gummi-1" class="quarto-xref">Abbildung&nbsp;<span>17.57</span></a> siehst du einmal einen Violinplot mit der Funktion <code>geom_violin()</code>. Ich nutze eigentlich immer die Option <code>trim = FALSE</code> damit die Violinplots nicht so abgeschnitten sind. Der Nachteil ist dann, dass eventuell Werte angezeigt werden, die in den Daten nicht vorkommen, aber das ist auch sonst der Fall bei anderen Densityplots. Hier sieht es dann einfach besser aus und deshalb nutze ich es gerne. Durch die Funktion <code>stat_summary()</code> ergänze ich dann noch den Mittelwert und die Standardabweichung.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> height,</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">trim =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> data_summary) <span class="sc">+</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Körpergröße in cm"</span>) <span class="sc">+</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-violin-gummi-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-violin-gummi-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-violin-gummi-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-59" data-gallery="quarto-lightbox-gallery-59"><img src="eda-ggplot_files/figure-html/fig-violin-gummi-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-violin-gummi-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.57— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In der nächsten <a href="#fig-violin-gummi-2" class="quarto-xref">Abbildung&nbsp;<span>17.58</span></a> siehst du dann die Implementierung des Violinplot aus dem R Paket <code>{see}</code> mit der Funktion <code>geom_violindot()</code>. Auch hier trimme ich nicht die Spitzen der Violinplots und vergrößere die Punkte in dem Dotplot. Die Stärke von der Funktion ist der halbe Violinplot zusammen mit einem Dotplot, wir haben dann beides. Zum einen können wir die Werte sehen, wie sie sich in einem Histogramm anordnen würden. Zum anderen haben wir dann auch den Densityplot als geglättete Kurve daneben. Ich habe auch hier den Mittelwert und die Standardabweichung ergänzt, musste aber die Position in der <span class="math inline">\(x\)</span>-Richtung etwas verschieben.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> height,</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violindot</span>(<span class="at">dots_size =</span> <span class="dv">4</span>, <span class="at">trim =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> data_summary, </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Körpergröße in cm"</span>) <span class="sc">+</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-violin-gummi-2" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-violin-gummi-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-violin-gummi-2-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-60" data-gallery="quarto-lightbox-gallery-60"><img src="eda-ggplot_files/figure-html/fig-violin-gummi-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-violin-gummi-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.58— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung. Hier müssen wir aber die Darstellung auf der <span class="math inline">\(x\)</span>-Achse um <span class="math inline">\(0.1\)</span> etwas verschieben.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Du musst natürlich keine Funktion aus einem anderen Paket nehmen. Der Violinplot lässt sich als ganzer Plot auch mit dem Dotplot kombinieren. Wir plotten als erstes in den Hintergrund den Violinplot, ergänzen dann darüber den Dotplot und zeichnen ganz zum Schluss noch die Mittelwerte und die Standardabweichung ein. So erhalten wir dann die <a href="#fig-violin-gummi-3" class="quarto-xref">Abbildung&nbsp;<span>17.59</span></a>.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> height,</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill =</span> gender)) <span class="sc">+</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">trim =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">"y"</span>, <span class="at">stackdir =</span> <span class="st">"center"</span>,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">dotsize =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> data_summary, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Körpergröße in cm"</span>) <span class="sc">+</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-violin-gummi-3" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-violin-gummi-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-violin-gummi-3-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-61" data-gallery="quarto-lightbox-gallery-61"><img src="eda-ggplot_files/figure-html/fig-violin-gummi-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-violin-gummi-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.59— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung sowie den einzelnen Beobachtungen aus einem Dotplot.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In der <a href="#fig-violin-gummi-4" class="quarto-xref">Abbildung&nbsp;<span>17.60</span></a> sehen wir dann anstatt von einem Dotplot einen Beeswarm. Wie immer ist es Geschmackssache welcher Plot einem mehr zusagt. Der Beeswarm wirkt immer etwas kompakter und so lässt sich hier auch mehr erkennen. Das Problem ist eher, dass die Punkte sich nicht füllen lassen, so dass wir dann doch ein recht einheitliches Bild kriegen. Hier muss ich dann immer überlegen, was ich dann wie einfärben will.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gummi_tbl, <span class="fu">aes</span>(<span class="at">x =</span> gender, <span class="at">y =</span> height,</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">fill =</span> gender, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">trim =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>() <span class="sc">+</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> data_summary, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linewidth =</span> <span class="dv">2</span>,</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Geschlecht"</span>, <span class="at">y =</span> <span class="st">"Körpergröße in cm"</span>) <span class="sc">+</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-violin-gummi-4" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-violin-gummi-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-violin-gummi-4-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-62" data-gallery="quarto-lightbox-gallery-62"><img src="eda-ggplot_files/figure-html/fig-violin-gummi-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-violin-gummi-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.60— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung sowie den einzelnen Beobachtungen aus einem Beeswarm.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="optionen-in-ggplot" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="optionen-in-ggplot"><span class="header-section-number">17.5</span> Optionen in <code>{ggplot}</code></h2>
<p>Im Folgenden dann noch eine Sammlung an nützlichen Optionen und Möglichkeiten, die einem das Leben einfacher machen und die Abbildungen dann noch schöner. Nicht alles musst du in <code>ggplot</code> machen, manchmal geht es dann in PowerPoint dann doch schneller mal eben einen Text zu ergänzen. Sehe das hier deshalb als Ergänzung und meinen privaten Raum, den ich nutze um mir den Code zu merken.</p>
<section id="überschriften-achsen-und-legenden" class="level3" data-number="17.5.1">
<h3 data-number="17.5.1" class="anchored" data-anchor-id="überschriften-achsen-und-legenden"><span class="header-section-number">17.5.1</span> Überschriften, Achsen und Legenden</h3>
<p>Wenn du mehr machen willst, also die Überschriften anpassen oder aber die Achsenbeschriftung ändern, dann gibt es hier global Hilfe im <a href="https://ggplot2.tidyverse.org/reference/index.html">ggplot Manual</a>. Die Webseite <a href="https://ggplot2.tidyverse.org/reference/index.html">R Cookbook</a> hat auch spezielle Hilfe für ggplot().</p>
<ul>
<li><a href="http://www.cookbook-r.com/Graphs/Titles_(ggplot2)/">Überschriften von Abbildungen</a></li>
<li><a href="http://www.cookbook-r.com/Graphs/Axes_(ggplot2)/">Achsenbeschriftung</a></li>
<li><a href="http://www.cookbook-r.com/Graphs/Legends_(ggplot2)/">Legende</a></li>
<li><a href="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/">Farben</a></li>
</ul>
<p>In <a href="#fig-labels-0" class="quarto-xref">Abbildung&nbsp;<span>17.61</span></a> siehst du eine Abbildung mit Titel und veränderten Beschriftungen. Die Möglichkeiten sind nahezu unbegrenzt und sprengen auch hier den Rahmen. Im Zweifel im R Tutorium vorbeischauen oder aber in der Vorlesung fragen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Frischgewicht in Abhängigkeit von der Behandlung"</span>,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Behandlung"</span>, <span class="at">y =</span> <span class="st">"Frischgewicht in kg/ha"</span>) <span class="sc">+</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Katze"</span>, <span class="st">"Hund"</span>)) <span class="sc">+</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">"Behandlung"</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Katze"</span>, <span class="st">"Hund"</span>)) <span class="sc">+</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-labels-0" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-labels-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-labels-0-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-63" data-gallery="quarto-lightbox-gallery-63"><img src="eda-ggplot_files/figure-html/fig-labels-0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-labels-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.61— Beispielhafte Abbildung mit Titel und geänderter Achsenbeschrittung. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="abbildungen-abspeichern" class="level3" data-number="17.5.2">
<h3 data-number="17.5.2" class="anchored" data-anchor-id="abbildungen-abspeichern"><span class="header-section-number">17.5.2</span> Abbildungen abspeichern</h3>
<p>Wenn du eine Abbildung abspeichern willst, dann musst du nur nach dem <code>ggplot</code>-Code die Funktion <code>ggsave()</code> setzen. Wie du im hier im Folgenden siehst, speichere ich die Abbildung der Boxplots der Hunde- und Katzenflöhe einmal in der Datei <code>flea_dog_boxplot.png</code> ab. Dabei wähle ich eine Breite <code>width</code> und eine Höhe <code>height</code> von jeweils 5. Du musst dann immer etwas spielen, je größer die Zahlen, desto größer die Abbildung und die Auflösung.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Abspeichern des obigen ggplots  </span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"flea_dog_boxplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wie immer hilft auch die <a href="https://ggplot2.tidyverse.org/reference/ggsave.html">Hilfeseite von <code>ggsave()</code></a> weiter, wenn es um mehr Optionen und Qualität der Abbildungen geht.</p>
</section>
<section id="sec-eda-tex" class="level3" data-number="17.5.3">
<h3 data-number="17.5.3" class="anchored" data-anchor-id="sec-eda-tex"><span class="header-section-number">17.5.3</span> Mathematische Ausdrücke in den Achsenbeschriftungen</h3>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Besuche auch <a href="https://exts.ggplot2.tidyverse.org/gallery/">ggplot2 extensions</a> für weitere tolle Möglichkeiten!</p>
</div>
</div>
</div>
<p>Häufig wollen wir nicht nur einfache Achsenbeschriftungen haben, sondern auch irgendwie komplexere Einheiten wie Eisendüngergehalt im Boden in <span class="math inline">\([kg\, ha]^{-1}\)</span> darstellen. Jetzt soll die Einheit auch in dieser Form mit in die Achsenbeschriftung. Wir können dafür zwei Wege wählen. Einmal über das R Paket <code>{latex2exp}</code> und die Funktion <code>TeX()</code> oder aber die Funktion <code>expression()</code>, wofür wir dann kein eigenes R Paket brauchen. Beide Wege haben Vor- und Nachteile. Wir gehen aber beide mal durch. Mehr Informationen durch das Tutorium <a href="https://cran.r-project.org/web/packages/latex2exp/vignettes/using-latex2exp.html">Using latex2exp</a> oder aber eben der Klassiker mit <a href="https://stat.ethz.ch/R-manual/R-patched/library/grDevices/html/plotmath.html">Plot math expression</a>.</p>
<p>Wir können die Funktion <code>expression()</code> nutzen um uns mathematische Formeln zu bauen. Leider ist das Ganze etwas frickelig und auch ich brauche immer drei Anläufe, bis die Formel dann passt. Im Folgenden aber einmal zwei Beispiel für mathematische Formeln und Ausdrücke. Beachte, dass du jedes Leerzeichen durch eine Tilde <code>~</code> abbilden musst. Ich nutze die Funktion <code>expression()</code> sehr selten und nur wenn die Formel wirklich sehr einfach ist. Da wir aber schon mit eckigen Klammern Probleme kriegen und diese so nervig mit <code>"</code> einklammern müssen, nutze ich dann das Paket <code>{latex2exp}</code> was ich im Folgenden vorstellen werde.</p>
<p>Hier aber erstmal zwei Beispiele für eine Formel mit der Funktion <code>expression()</code>. Wenn du mehr über die Möglichkeiten wissen willst, dann schauen auch einmal auf die Hilfeseite von <a href="https://stat.ethz.ch/R-manual/R-patched/library/grDevices/html/plotmath.html">Plot math</a> oder du googelst dir die Lösung wie ich früher zusammen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">expression</span>(Eisendüngeform<span class="sc">~</span>und<span class="sc">~-</span>höhe<span class="sc">~</span><span class="st">"[kg ha]"</span><span class="sc">^-</span><span class="dv">1</span>), <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">main =</span> <span class="st">""</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="eda-ggplot_files/figure-html/unnamed-chunk-106-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-64"><img src="eda-ggplot_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">expression</span>(Fe<span class="sc">-</span>Gehalt<span class="sc">~</span><span class="st">"["</span><span class="sc">~</span>mg<span class="sc">%.%</span>(kg<span class="sc">~</span>TM)<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span><span class="st">"]"</span>), <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">main =</span> <span class="st">""</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="eda-ggplot_files/figure-html/unnamed-chunk-106-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-65"><img src="eda-ggplot_files/figure-html/unnamed-chunk-106-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a></p>
</figure>
</div>
</div>
</div>
<p>Für mich ausdrücklich einfacher geht es mit dem R Paket <code>{latex2exp}</code> und der Funktion <code>TeX()</code> sowie die Helferfunktion <code>r"()"</code>. Ja, hier muss man dann noch eine andere Programmiersprache kennen, aber wie immer, du wirst nur schlauer. Die Informationen zur Matheumgebung in <span class="math inline">\(\LaTeX\)</span> kommen dann nochmal extra zwischen zwei Dollarzeichen <code>$</code>. Ja, das ist etwas wirr für einen Anfänger, aber wir nutzen hier auch zwei Programmiersprachen zusammen. Zum einen <span class="math inline">\(\LaTeX\)</span> um die Mathesymbole sauber darzustellen und dann R um die Abbildungen in <code>ggplot()</code> zu bauen. Mehr Informationen zu der Matheumgebung in <span class="math inline">\(\LaTeX\)</span> findest du einmal in der <a href="https://de.wikipedia.org/wiki/Hilfe:TeX">LaTeX Mathehilfe I</a> sowie der <a href="https://en.wikibooks.org/wiki/LaTeX/Mathematics">LaTeX Mathehilfe II</a>.</p>
<p>Wie bauen wir uns also unseren mathematischen Ausdruck? Als erstes brauchen wir die Funktion <code>Tex()</code>, die sagt einfach nur aus, dass jetzt <span class="math inline">\(\LaTeX\)</span>-Code kommt. Dann wollen wir noch einen String brauen in dem der <span class="math inline">\(\LaTeX\)</span>-Code für unseren mathematischen Ausdruck drin steht. Diesen String bauen wir mit <code>r"()"</code>. Achtung, hier ist das Gänsefüßchen oben und unten vor und nach der runden Klammer sehr wichtig. In den Ausdruck können wir dann Text schreiben <code>Eisengehalt</code> oder aber einen mathematischen Ausdruck abgrenzt von zwei Dollarzeichen <code>$</code> wie <code>$[kg\, ha]^{-1}$</code>. <span class="math inline">\(\LaTeX\)</span> kann nämlich nicht nur mathematische Ausdrücke sondern ist eigentlich ein Textverarbeitungsprogramm. Deshalb musst du hier <em>nochmal</em> zwischen Text und mathematischen Ausdruck unterscheiden.</p>
<p>Hier nochmal aufgeschlüsselt wie der Code aussieht. Wir schreiben den Code nachher in einer Zeile, aber zum Verständnis ist es besser, wenn wir den Code einmal aufgeklappt sehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TeX</span>(</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    r<span class="st">"(</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="st">      Eisengehalt $[kg\, ha]^{-1}$</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="st">    )"</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>   )</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir wollen uns das Ergebnis einmal in einem simplen <code>plot()</code> anschauen. Wir nutzen die Funktionalität natürlich später in <code>ggplot</code>, aber hier ist es so einmal einfacher zu sehen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">cex =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">""</span>,</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TeX</span>(r<span class="st">"(</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="st">         Eisengehalt $[kg\, ha]^{-1}$</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="st">      )"</span>)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="eda-ggplot_files/figure-html/unnamed-chunk-108-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-66"><img src="eda-ggplot_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a></p>
</figure>
</div>
</div>
</div>
<p>Auch können wir sehr viel komplexere Formeln erstellen. Beachte auch hier, dass wir zwei Matheumgebungen in <span class="math inline">\(\LaTeX\)</span> vorliegen haben.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">cex =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">""</span>,</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TeX</span>(r<span class="st">"(</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="st">         A $\LaTeX$ formula: $</span><span class="sc">\f</span><span class="st">rac{2hc^2}{\lambda^5}</span><span class="sc">\f</span><span class="st">rac{1}{e^{</span><span class="sc">\f</span><span class="st">rac{hc}{\lambda k_B T}} - 1}$</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="st">      )"</span>)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="eda-ggplot_files/figure-html/unnamed-chunk-109-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-67"><img src="eda-ggplot_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a></p>
</figure>
</div>
</div>
</div>
<p>In der <a href="#fig-scatter-flea-1" class="quarto-xref">Abbildung&nbsp;<span>17.62</span></a> dann nochmal die Anwendung in einem <code>ggplot</code> in dem wir die Achsen entsprechend beschriften und dann auch noch eine ausgedachte Regressionsgeleichung zu der Abbildung ergänzen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> flea_count, <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(r<span class="st">"(Eisengehalt und -höhe $[kg\, ha]^{-1}$)"</span>), </span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">TeX</span>(r<span class="st">"(Fe-Gehalt $[mg \cdot (kg TM)^{-1}]$)"</span>)) <span class="sc">+</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">10</span>,</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($y = </span><span class="sc">\b</span><span class="st">eta_0 + </span><span class="sc">\b</span><span class="st">eta_1 \cdot x;\; R^2 = 0.24$)"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-scatter-flea-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter-flea-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-scatter-flea-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-68" data-gallery="quarto-lightbox-gallery-68"><img src="eda-ggplot_files/figure-html/fig-scatter-flea-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter-flea-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.62— Zusammenhang zwischen dem Eisengehalt und -höhe im Boden und dem Eisengehalt in Salat. Zusätzlich ergänzt eine Regressiongleichung und ein ausgedachtes Bestimmtheitsmaß. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wenn du dann mal die Funktion <code>Tex()</code> in <code>geom_text()</code> verwenden willst, dann musst du einmal etwas anpassen. Dann klappt es aber auch hier. Das hat mich mal echt Nerven und Zeit gekostet, deshalb lagere ich die Information mal hier für mich.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="dv">0</span>, <span class="dv">0</span>, </span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">'($</span><span class="sc">\a</span><span class="st">lpha  x^</span><span class="sc">\a</span><span class="st">lpha$, where $</span><span class="sc">\a</span><span class="st">lpha \in 1\ldots 5$)'</span>,</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">output =</span> <span class="st">"character"</span>)), <span class="at">parse =</span> <span class="cn">TRUE</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="farbpaletten" class="level3" data-number="17.5.4">
<h3 data-number="17.5.4" class="anchored" data-anchor-id="farbpaletten"><span class="header-section-number">17.5.4</span> Farbpaletten</h3>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Besuche auch <a href="https://exts.ggplot2.tidyverse.org/gallery/">ggplot2 extensions</a> für weitere tolle Möglichkeiten!</p>
</div>
</div>
</div>
<p>Neben den klassischen Farben im R Paket <code>{ggplot2}</code> gibt es noch weit, weit mehr Farbpaletten. Wir nutzen in der Folge immer wieder die Okabe-Ito Farbpalette aus dem R Paket <code>{see}</code>. Die Okabe-Ito Farbpalette ist speziell so gebaut, dass die Farben sich gut für farbenblinde Personen unterscheiden. Mehr zum R Paket <code>{see}</code> auf der <a href="https://easystats.github.io/see/index.html">Hilfeseite des Paketes</a>. Der Kontrast zwischen den Farben ist sehr gut. Wenn du eine andere Farbpalette nutzen willst, findest du hier noch andere <a href="https://easystats.github.io/see/articles/seecolorscales.html">Color Scales</a>.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-labels-see-0" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-labels-see-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-labels-see-0-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-69" data-gallery="quarto-lightbox-gallery-69"><img src="eda-ggplot_files/figure-html/fig-labels-see-0-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-labels-see-0-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.63— Beispielhafte Abbildung der Okabe-Ito Farbpalette für Boxplots. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> animal)) <span class="sc">+</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-labels-see-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-labels-see-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-labels-see-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-70" data-gallery="quarto-lightbox-gallery-70"><img src="eda-ggplot_files/figure-html/fig-labels-see-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-labels-see-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.64— Beispielhafte Abbildung der Okabe-Ito Farbpalette für Punkte. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Das Ganze geht dann auch händisch mit dem folgenden Code für die <a href="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/#a-colorblind-friendly-palette">jeweiligen Farben</a>. Anbei einmal die Farbpalette dargestellt.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-okabeito" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-okabeito-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-okabeito-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-71" data-gallery="quarto-lightbox-gallery-71"><img src="eda-ggplot_files/figure-html/fig-ggplot-okabeito-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-okabeito-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.65— Farbpalette nach dem Okabe-Ito-Schema ebenfalls für farbblinde Personen erstellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Farben sind dann in der Reihenfolge wie folgt kodiert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#CC79A7"</span>, <span class="st">"#999999"</span>, <span class="st">"#000000"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wenn wir Boxplots einfärben wollen dann nehmen wir den folgenden Code.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cbPalette)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Und das hier ist die Ergänzung für Punkte und Linien.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_colour_manual</span>(<span class="at">values =</span> cbPalette)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Neben der Okabe-Ito Farbpalette liefert das <a href="https://cran.r-project.org/web/packages/duke/vignettes/duke.html">R Paket <code>{duke}</code></a> noch eine andere Möglichkeit eine Farbpalette für Farbblinde zu generieren.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ggplot-duke" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggplot-duke-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-ggplot-duke-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-72" data-gallery="quarto-lightbox-gallery-72"><img src="eda-ggplot_files/figure-html/fig-ggplot-duke-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggplot-duke-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.66— Farbpalette nach dem Duke-Schema ebenfalls für farbblinde Personen erstellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Farben sind dann in der Reihenfolge wie folgt kodiert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>dukePalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#012169"</span>, <span class="st">"#C84E00"</span>, <span class="st">"#00539B"</span>, <span class="st">"#339898"</span>, </span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"#A1B70D"</span>, <span class="st">"#E89923"</span>, <span class="st">"#FFD960"</span>, <span class="st">"#262626"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Die Funktionen hier sind <code>scale_duke_color_discrete()</code> sowie <code>scale_duke_continuous()</code> und <code>scale_duke_fill_discrete()</code>.</p>
<p>Manchmal benötigen wir auch Farbverläufe. In R heißen diese Farbverläufe dann Farbpaletten. Eine Einführung liefert das Tutorium <a href="http://www.sthda.com/english/wiki/colors-in-r#using-rcolorbrewer-palettes">Using RColorBrewer palettes</a>. Ich selber nutze gerne das R Paket <code>{wesanderson}</code> welches sehr schöne Farbverläufe hat. Mehr kannst du auf der GitHub Seite <a href="https://github.com/karthik/wesanderson">Wes Anderson Palettes</a> erfahren. Wir können die Paletten ganz einfach mit der Funktion <code>wes_palette()</code> laden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wes_palette</span>(<span class="st">"Zissou1"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="eda-ggplot_files/figure-html/unnamed-chunk-120-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-73"><img src="eda-ggplot_files/figure-html/unnamed-chunk-120-1.png" class="img-fluid figure-img" width="576"></a></p>
</figure>
</div>
</div>
</div>
<p>Das schöne ist hier, dass wir einfach wie folgt Farbverläufe erstellen können. Wir wollen hier 21 Farbwerte haben und das Ganze dann als kontinuierlichen Verlauf.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wes_palette</span>(<span class="st">"Zissou1"</span>, <span class="dv">21</span>, <span class="at">type =</span> <span class="st">"continuous"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="eda-ggplot_files/figure-html/unnamed-chunk-121-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-74"><img src="eda-ggplot_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid figure-img" width="576"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="abbildungen-nebeneinander" class="level3" data-number="17.5.5">
<h3 data-number="17.5.5" class="anchored" data-anchor-id="abbildungen-nebeneinander"><span class="header-section-number">17.5.5</span> Abbildungen nebeneinander</h3>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Besuche auch <a href="https://exts.ggplot2.tidyverse.org/gallery/">ggplot2 extensions</a> für weitere tolle Möglichkeiten!</p>
</div>
</div>
</div>
<p>Das <a href="https://patchwork.data-imaginist.com/articles/patchwork.html">R Paket <code>{patchwork}</code></a> erlaubt es mehrere <code>ggplot</code> Abbildungen nebeneinander oder in einem beliebigen Layout miteinander zu verbinden. Das tolle ist, dass die Idee sehr intuitiv ist. Wir nutzen wieder das <code>+</code> um verschiedene Plots miteinander zu verbinden. Im Folgenden erschaffen wir uns zwei <code>ggplots</code> und speichern die Plots in den Objekten <code>p1</code> und <code>p2</code>. Das ist wie wir es bisher kennen, nur das jetzt keine Abbildung erscheint sondern beide Plots in zwei Objekten gespeichert sind.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> flea_count, <span class="at">y =</span> jump_length,</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> animal)) <span class="sc">+</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> animal)) <span class="sc">+</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wie können wir nun die beiden Abbildungen nebeneinander zeichnen? Wir nutzen einfach das <code>+</code> Symbol.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-labels-patchwork-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-labels-patchwork-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-labels-patchwork-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-75" data-gallery="quarto-lightbox-gallery-75"><img src="eda-ggplot_files/figure-html/fig-labels-patchwork-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-labels-patchwork-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.67— Beispielhafte Abbildung der zweier Plots nebeneinander. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Auf der Seite des <a href="https://patchwork.data-imaginist.com/articles/patchwork.html">R Paket <code>{patchwork}</code></a> findest du viel mehr Möglichkeiten das Layout anzupassen und auch die einzelnen <a href="https://patchwork.data-imaginist.com/articles/guides/annotation.html">Subplots zu beschriften</a>.</p>
</section>
<section id="gebrochene-y-achse" class="level3" data-number="17.5.6">
<h3 data-number="17.5.6" class="anchored" data-anchor-id="gebrochene-y-achse"><span class="header-section-number">17.5.6</span> Gebrochene <span class="math inline">\(y\)</span>-Achse</h3>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Besuche auch <a href="https://exts.ggplot2.tidyverse.org/gallery/">ggplot2 extensions</a> für weitere tolle Möglichkeiten!</p>
</div>
</div>
</div>
<p>Das <a href="https://cran.r-project.org/web/packages/ggbreak/vignettes/ggbreak.html">R Paket <code>{ggbreak}</code></a> erlaubt es dir in die <span class="math inline">\(x\)</span>-Achse oder aber <span class="math inline">\(y\)</span>-Achse Lücken einzusetzen oder aber die Achsen eben gebrochen darzustellen. Zur Demonstration bauen wir uns nochmal den <code>stat_tbl</code> für die Hunde- und Katzenflöhe. Wir berechnen hier dann die Mittelwerte und nicht mehr die Standardabweichung, da es sonst nicht so gut mit der Darstellung mit der gebrochenen <span class="math inline">\(y\)</span>-Achse für dieses Beispiel klappt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>stat_tbl <span class="ot">&lt;-</span> flea_dog_cat_tbl <span class="sc">|&gt;</span> </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">|&gt;</span> </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der <a href="#fig-labels-ggbreak-1" class="quarto-xref">Abbildung&nbsp;<span>17.68</span></a> siehst du einmal die Abbildung der Mittelwerte der Sprungweiten der Hunde- und Katzenflöhe als Barplots dargestellt. Ich habe hier einen Bruch auf der <span class="math inline">\(y\)</span>-Achse mit der Funktion <code>scale_y_break()</code> bei 1 bis 4 eingefügt und den Abstand über die Option <code>space</code> etwas visuell vergrößert. Mit der Option <code>scales</code> könntest du dann noch die Skalierung der gebrochenen <span class="math inline">\(y\)</span>-Achse anpassen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span> </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_break</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>), <span class="at">space =</span> <span class="fl">0.5</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-labels-ggbreak-1" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-labels-ggbreak-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="eda-ggplot_files/figure-html/fig-labels-ggbreak-1-1.png" class="lightbox" data-glightbox="description: .lightbox-desc-76" data-gallery="quarto-lightbox-gallery-76"><img src="eda-ggplot_files/figure-html/fig-labels-ggbreak-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-labels-ggbreak-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;17.68— Beispielhafte Abbildung der Barplots mit gebrochener <span class="math inline">\(y\)</span>-Achse. Die Fehlerbalken wurden aus Gründen der besseren Darstellung der zerbrochenen <span class="math inline">\(y\)</span>-Achse entfernt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Abbildung&nbsp;17.1— “The reason to avoid pie charts” Quelle: wumo.com</span>
<span class="glightbox-desc lightbox-desc-2">Abbildung&nbsp;17.2— Visualisierung der beiden häufigsten wissenschaftlichen Fragestellungen in der explorativen Datenanalyse. <strong>(A)</strong> <em>Die Frage nach dem Unterschied.</em> Unterschieden sich die Gruppen auf der x-Achse gegeben den Werten auf der y-Achse? Um den Unterschied darzustellen können Barplots oder Boxplots verwendet werden. <strong>(B)</strong> <em>Die Frage nach dem Zusammenhang.</em> Wie verändern sich die Werte der y-Achse, wenn sich die Werte auf der x-Achse ändern? Um den Zusammenhang zu zeigen kann ein Scatterplot verwendet werden. Die Gerade durch die Punkte kann durch eine (nicht) lineare Regression bestimmt werden. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-3">Abbildung&nbsp;17.3— Leere ggplot() Leinwand mit den Spalten <code>animal</code> und <code>jump_length</code> aus dem Datensatz <code>flea_dog_cat_tbl</code>. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-4">Abbildung&nbsp;17.4— Darstellung der Mittelwerte <span class="math inline">\(\bar{y}\)</span> und der Standardabweichung (abk. <em>SD</em>) in einem Säulendigramm. Es gibt zwei Arten der Darstellung, die sich dann auf die Fehlerbalken bezieht. <strong>(A)</strong> Nur mit <span class="math inline">\(\bar{y} + SD\)</span> <strong>(B)</strong> Mit <span class="math inline">\(\bar{y} \pm SD\)</span>. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-5">Abbildung&nbsp;17.5— Darstellung der Mittelwerte <span class="math inline">\(\bar{y}\)</span> und der Standardabweichung (abk. <em>SD</em>) sowie dem Standardfehler (abk. <em>SE</em>) in einem Säulendigramm. <strong>(A)</strong> Mit <span class="math inline">\(\bar{y} \pm SD\)</span> <strong>(B)</strong> Mit <span class="math inline">\(\bar{y} \pm SE\)</span>. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-6">Abbildung&nbsp;17.6— Säulendigramm der Sprungweiten der Hunde- und Katzenflöhe. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-7">Abbildung&nbsp;17.7— Balkendigramm der Sprungweiten der Hunde- und Katzenflöhe. Die Funktion <code>coord_flip()</code> macht aus einem Säulendiagramm ein Balkendiagramm. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-8">Abbildung&nbsp;17.8— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein simples Säulendiagramm mit sehr für Farbblinde ungünstigen Farben. Es sind die Mittelwerte sowie die Standardabweichung durch die Fehlerbalken dargestellt.</span>
<span class="glightbox-desc lightbox-desc-9">Abbildung&nbsp;17.9— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut.</span>
<span class="glightbox-desc lightbox-desc-10">Abbildung&nbsp;17.10— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein Barplot mit zwei Faktoren Zeit und die Iodine Form.</span>
<span class="glightbox-desc lightbox-desc-11">Abbildung&nbsp;17.11— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen.</span>
<span class="glightbox-desc lightbox-desc-12">Abbildung&nbsp;17.12— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut. Wir nutzen das <code>geom_text()</code> um noch besser unser <em>compact letter display</em> zu setzen, dafür müssen wir usn aber nochmal ein Positionsdatensatz bauen.</span>
<span class="glightbox-desc lightbox-desc-13">Abbildung&nbsp;17.13— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein zweifaktorielles Balkendiagramm mit einem Zielbereich und <em>compact letter display</em></span>
<span class="glightbox-desc lightbox-desc-14">Abbildung&nbsp;17.14— Die Abbildung des Balkendiagramms in <code>ggplot</code> nachgebaut. Ein extra Zielbereich ist definiert sowie die Legende in die Abbildung integriert.</span>
<span class="glightbox-desc lightbox-desc-15">Abbildung&nbsp;17.15— Die Abbildung des Balkendiagramms in <code>ggplot</code> nachgebaut. Durch den Boxplot erhalten wir auch untere Grenzen, was bei der Frage, ob wir in einem Zielbereich sind, viel sinnvoller ist, als ein Balkendiagramm. Eine höhere Fallzahl als <span class="math inline">\(n=3\)</span> würde die Boxplots schöner machen.</span>
<span class="glightbox-desc lightbox-desc-16">Abbildung&nbsp;17.16— Liegender Boxplot zu Visualisierung der statistischen Maßzahlen Median und Quartile. Die Box wird aus dem Interquartilesabstand (abk . <em>IQR</em>) gebildet, welches die Distanz zwischen den <span class="math inline">\(1^{st}\)</span> und <span class="math inline">\(3^{rd}\)</span> Quartile entspricht. Der Median wird als Strich in der Box gezeigt. Die Whiskers sind das 1.5-fache des IQR, wenn das Minimum der Werte nicht größer oder das Maximum der Werte nicht kleiner ist. Punkte die außerhalb der Whiskers liegen werden als einzelne Punkte dargestellt. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-17">Abbildung&nbsp;17.17— Liegender Boxplot zu Visualisierung der Sprungweite der Hundeflöhe. Die Abbildung ist nicht maßstabsgetreu. Die Box wird aus dem Interquartilesabstand (abk . <em>IQR</em>) gebildet, welches die Distanz zwischen den <span class="math inline">\(1^{st}\)</span> und <span class="math inline">\(3^{rd}\)</span> Quartile entspricht. Es liegen keine Ausreißer in den Daten vor. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-18">Abbildung&nbsp;17.18— Liegender Boxplot zu Visualisierung der Sprungweite der Hundeflöhe. Die Linien entsprechen den jeweiligen gemessenen Sprungweiten. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-19">Abbildung&nbsp;17.19— Stehender Boxplot zu Visualisierung der Sprungweite der Hundeflöhe. Die Linien entsprechen den jeweiligen gemessenen Sprungweiten. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-20">Abbildung&nbsp;17.20— Stehender Boxplot zu Visualisierung der Sprungweite der Hunde- und Katzenflöhe. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-21">Abbildung&nbsp;17.21— Ursprüngliche Abbildung, die nachgebaut werden soll. Ein zweifaktorieller Barplot mit Mittelwerten über dem Faktor auf der <span class="math inline">\(x\)</span>-Achse.</span>
<span class="glightbox-desc lightbox-desc-22">Abbildung&nbsp;17.22— Die Abbildung des Säulendiagramms in <code>ggplot</code> nachgebaut.</span>
<span class="glightbox-desc lightbox-desc-23">Abbildung&nbsp;17.23— Die Abbildung des Säulendiagramms in <code>ggplot</code> als Boxplot nachgebaut.</span>
<span class="glightbox-desc lightbox-desc-24">Abbildung&nbsp;17.24— Ursprüngliche Abbildung, die nachgebaut werden soll. Insgesamt vier Outcomes sollen für zwei Behandlungen ausgewertet werden. Das praktische ist hier, dass wir es nur mit einem einfaktoriellen Design zu tun haben.</span>
<span class="glightbox-desc lightbox-desc-25">Abbildung&nbsp;17.25— Nachbau der Abbildung mit der Funktion <code>facte_wrap()</code> mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das <em>compact letter display</em>. Auf eine Einfärbung nach der Behandlung wurde verzichtet um die Abbildung nicht noch mehr zu überladen.</span>
<span class="glightbox-desc lightbox-desc-26">Abbildung&nbsp;17.26— Nachbau der Abbildung mit dem R Paket <code>{patchwork}</code> mit Boxplots und dem Mittelwert. Neben dem Mittelwert finden sich das <em>compact letter display</em> bei dem ersten Plot. Auf eine Einfärbung nach der Behanldung wurde verzichtet um die Abbildung nicht noch mehr zu überladen.</span>
<span class="glightbox-desc lightbox-desc-27">Abbildung&nbsp;17.27— Typischer Scatterplot mit gängigen Bezeichnungen der <span class="math inline">\(x\)</span>-Achse sowie der <span class="math inline">\(y\)</span>-Achse. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-28">Abbildung&nbsp;17.28— Visualisierung eines Scatterplots mit einer Geraden durch die Punktewolke. Die lineare Regression wurde zur Bestimmung der Geradengleichung der Geraden durch die Punkte des Scatterplots genutzt. Die Linie oder Gerade wird durch die statistischen Maßzahlen oder Parameter <span class="math inline">\(\beta_0\)</span> als y-Achsenabschnitt und <span class="math inline">\(\beta_1\)</span> als Steigung der Gerade beschrieben. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-29">Abbildung&nbsp;17.29— Visualisierung des Scatterplots für die Sprungweite in [cm] und das Gewicht in [mg] von sieben Hundeflöhen. Das dritte und fünfte Tier wurde mit dem Wertepaar <span class="math inline">\((x_3, y_3)\)</span> und <span class="math inline">\((x_5, y_5)\)</span> beschriftet. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-30">Abbildung&nbsp;17.30— Visualisierung der Bestimmung der Geradengleichung anhand eines Scatterplots für die Sprungweite in [cm] und das Gewicht in [mg] von sieben Hundeflöhen. Wir legen eine Gerade durch eine Punktewolke. Die Gerade wird durch die statistischen Maßzahlen bzw. Parameter <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span> beschrieben. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-31">Abbildung&nbsp;17.31— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar.</span>
<span class="glightbox-desc lightbox-desc-32">Abbildung&nbsp;17.32— Zusammenhang zwischen der Sprungweite in [cm] und Gewicht der Katzenflöhe. Jeder Punkt stellt eine Beobachtung dar. Eine eigene Geradengleichung wurde durch <code>geom_function()</code> ergänzt.</span>
<span class="glightbox-desc lightbox-desc-33">Abbildung&nbsp;17.33— Ursprüngliche Abbildung, die nachgebaut werden soll. Eine simple lineare Regression mit Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> für die Gerade durch die Punkte.</span>
<span class="glightbox-desc lightbox-desc-34">Abbildung&nbsp;17.34— Visualisierung der simplen linearen Regression mit einem Pfeil sowie den Informationen zu der Geradengleichung und dem Bestimmtheitsmaß <span class="math inline">\(R^2\)</span>.</span>
<span class="glightbox-desc lightbox-desc-35">Abbildung&nbsp;17.35— Ursprüngliche Abbildung, die nachgebaut werden soll. Zwei lineare Regressionen mit den jeweiligen Regressionsgleichungen.</span>
<span class="glightbox-desc lightbox-desc-36">Abbildung&nbsp;17.36— Einmal die einfache Abbildung der linearen Regression in <code>ggplot</code> für Basilikum nachgebaut. Beachte die Funktion <code>filter()</code>, die den jeweiligen Datensatz für die beiden Kräuter erzeugt.</span>
<span class="glightbox-desc lightbox-desc-37">Abbildung&nbsp;17.37— Einmal die einfache Abbildung der linearen Regression in <code>ggplot</code> für Oregano nachgebaut. Beachte die Funktion <code>filter()</code>, die den jeweiligen Datensatz für die beiden Kräuter erzeugt.</span>
<span class="glightbox-desc lightbox-desc-38">Abbildung&nbsp;17.38— Einmal die einfache Abbildung der linearen Regression in <code>ggplot</code> für Oregano nachgebaut. Beachte die Funktion <code>facet_wrap()</code>, die den jeweiligen Datensatz für die beiden Kräuter erzeugt.</span>
<span class="glightbox-desc lightbox-desc-39">Abbildung&nbsp;17.39— Einmal die einfache Abbildung der linearen Regression in <code>ggplot</code> nachgebaut. Die Abbildung A zeigt die Punkte und die Geradengleichung für das Basilikum. Die Abbildung B die entsprechenden Informationen für das Oregano. Die beiden Achsenbeschriftungen wurden gekürzt und die Informationen in den Titel übernommen.</span>
<span class="glightbox-desc lightbox-desc-40">Abbildung&nbsp;17.40— Eine theoretische 2x2 Tafel für zwei Gruppen und einem kategoriellen Endpunkt <span class="math inline">\(y\)</span> mit den beiden Ausprägungen ja/nein oder 0/1. Für jedes der Felder wird spaltenweise der Anteil berechnet. Insgesamt wurden <span class="math inline">\(n\)</span> Beobachtungen gemacht. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-41">Abbildung&nbsp;17.41— Theoretischer Mosaicplot, der die Anteile <em>spaltenweise</em> für die beiden Guppen an dem Endpunkt <span class="math inline">\(Y\)</span> wiedergibt. Dabei ist die Fläche <span class="math inline">\(A\)</span>, die jedes Quadrat einnimmt proportional zu dem berechneten Anteil. Die Anteile können so visuell schnell verglichen werden. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-42">Abbildung&nbsp;17.42— Eine 2x2 Tafel für die Hunde- und Katzenflöhe und dem entsprechenden Infektionsstatus mit den beiden Ausprägungen ja/nein oder 0/1. Für jedes der Felder wird spaltenweise der Anteil berechnet. So haben 43% der Hundeflöhe einen Schnupfen aber nur 29% der Katzen. Insgesamt wurden <span class="math inline">\(n\)</span> Beobachtungen gemacht. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-43">Abbildung&nbsp;17.43— Mosaicplot des Infektionsstatus für die Hunde- und Katzenflöhe. Der Anteil ist für beide Gruppen <em>spaltenweise</em> an dem Endpunkt <span class="math inline">\(Y\)</span> berechnet. Dabei ist die Fläche <span class="math inline">\(A\)</span>, die jedes Quadrat einnimmt proportional zu dem berechneten Anteil. Die Anteile können so visuell schnell verglichen werden. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-44">Abbildung&nbsp;17.44— Mosaicplot des Infektionsstatus für die Hunde- und Katzenflöhe. Der Anteil ist für beide Gruppen <em>spaltenweise</em> an dem Endpunkt <span class="math inline">\(Y\)</span> berechnet. Dabei ist die Fläche <span class="math inline">\(A\)</span>, die jedes Quadrat einnimmt proportional zu dem berechneten Anteil. Die Anteile können so visuell schnell verglichen werden. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-45">Abbildung&nbsp;17.45— Histogramm von achtzehn Flöhen für einen kategorialen Endpunkt der Kategorien A bis I. Auf der linken Seite sind die absoluten Anzahlen dargestellt und auf der rechten Seite die entsprechenden relativen Häufigkeiten. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-46">Abbildung&nbsp;17.46— Histogramm von achtzehn Flöhen für einen kontinuierlichen Endpunkt. Ein Balken entspricht immer einem Zahlenraum entsprechend der x-Achse. Auf der linken Seite sind die absoluten Anzahlen dargestellt und auf der rechten Seite die entsprechenden relativen Häufigkeiten. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-47">Abbildung&nbsp;17.47— Histogramm von achtzehn Flöhen für die Boniturnoten als kategorialen Endpunkt. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-48">Abbildung&nbsp;17.48— Histogramm von achtzehn Flöhen für das Gewicht als kontinuierlichen Endpunkt. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-49">Abbildung&nbsp;17.49— Histogramm der Boniturnoten von achtzehn Hundeflöhen. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-50">Abbildung&nbsp;17.50— Histogramm des Gewichts von achtzehn Hundeflöhen. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-51">Abbildung&nbsp;17.51— Beispielhafte Dichtekurve für die Abschätzung der Verteilung der Daten. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-52">Abbildung&nbsp;17.52— Densityplot der Boniturnote achtzehn Hundeflöhen. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-53">Abbildung&nbsp;17.53— Der Dotplot für die Anzahl der Flöhe für die beiden Tierarten Hund und Katze.</span>
<span class="glightbox-desc lightbox-desc-54">Abbildung&nbsp;17.54— Der Dotplot für die Anzahl der Flöhe für die beiden Tierarten Hund und Katze. Die schwarze Linie stelt den Median für die beiden Tierarten dar.</span>
<span class="glightbox-desc lightbox-desc-55">Abbildung&nbsp;17.55&nbsp;(a)— Alter nach Geschlecht</span>
<span class="glightbox-desc lightbox-desc-56">Abbildung&nbsp;17.55&nbsp;(b)— Körpergröße nach Geschlecht</span>
<span class="glightbox-desc lightbox-desc-57">Abbildung&nbsp;17.56&nbsp;(a)— Alter nach Geschlecht</span>
<span class="glightbox-desc lightbox-desc-58">Abbildung&nbsp;17.56&nbsp;(b)— Körpergröße nach Geschlecht</span>
<span class="glightbox-desc lightbox-desc-59">Abbildung&nbsp;17.57— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung.</span>
<span class="glightbox-desc lightbox-desc-60">Abbildung&nbsp;17.58— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung. Hier müssen wir aber die Darstellung auf der <span class="math inline">\(x\)</span>-Achse um <span class="math inline">\(0.1\)</span> etwas verschieben.</span>
<span class="glightbox-desc lightbox-desc-61">Abbildung&nbsp;17.59— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung sowie den einzelnen Beobachtungen aus einem Dotplot.</span>
<span class="glightbox-desc lightbox-desc-62">Abbildung&nbsp;17.60— Der Violinplot die Körpergröße aufgeteilt nach Geschlecht als die simpelste Art der Darstellung mit einem Violinplot. Ergänzt noch durch den Mittelwert plusminus der Standardabweichung sowie den einzelnen Beobachtungen aus einem Beeswarm.</span>
<span class="glightbox-desc lightbox-desc-63">Abbildung&nbsp;17.61— Beispielhafte Abbildung mit Titel und geänderter Achsenbeschrittung. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-68">Abbildung&nbsp;17.62— Zusammenhang zwischen dem Eisengehalt und -höhe im Boden und dem Eisengehalt in Salat. Zusätzlich ergänzt eine Regressiongleichung und ein ausgedachtes Bestimmtheitsmaß. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-69">Abbildung&nbsp;17.63— Beispielhafte Abbildung der Okabe-Ito Farbpalette für Boxplots. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-70">Abbildung&nbsp;17.64— Beispielhafte Abbildung der Okabe-Ito Farbpalette für Punkte. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-71">Abbildung&nbsp;17.65— Farbpalette nach dem Okabe-Ito-Schema ebenfalls für farbblinde Personen erstellt. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-72">Abbildung&nbsp;17.66— Farbpalette nach dem Duke-Schema ebenfalls für farbblinde Personen erstellt. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-75">Abbildung&nbsp;17.67— Beispielhafte Abbildung der zweier Plots nebeneinander. <em>[Zum Vergrößern anklicken]</em></span>
<span class="glightbox-desc lightbox-desc-76">Abbildung&nbsp;17.68— Beispielhafte Abbildung der Barplots mit gebrochener <span class="math inline">\(y\)</span>-Achse. Die Fehlerbalken wurden aus Gründen der besseren Darstellung der zerbrochenen <span class="math inline">\(y\)</span>-Achse entfernt. <em>[Zum Vergrößern anklicken]</em></span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-cumming2007error" class="csl-entry" role="listitem">
Cumming G, Fidler F, Vaux DL. 2007. Error bars in experimental biology. The Journal of cell biology 177: 7–11.
</div>
<div id="ref-riedel2022replacing" class="csl-entry" role="listitem">
Riedel N, Schulz R, Kazezian V, Weissgerber T. 2022. Replacing bar graphs of continuous data with more informative graphics: are we making progress? Clinical Science 136: 1139–1156.
</div>
<div id="ref-tukey1962future" class="csl-entry" role="listitem">
Tukey JW. 1962. The future of data analysis. The annals of mathematical statistics 33: 1–67.
</div>
<div id="ref-tukey1977exploratory" class="csl-entry" role="listitem">
Tukey JW, others. 1977. Exploratory data analysis. Reading, MA.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./eda-descriptive.html" class="pagination-link" aria-label="Deskriptive Statistik">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./eda-distribution.html" class="pagination-link" aria-label="Verteilung von Daten">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb123" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Visualisierung von Daten {#sec-eda-ggplot}</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("eda-ggplot.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, readxl, knitr, kableExtra, quantreg,</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>               multcomp, emmeans, ggpubr, multcompView, nlme,</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>               ggdist, gghalves, performance, parameters, broom,</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>               effectsize, patchwork, conflicted)</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select)</span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"The greatest value of a picture is when it forces us to notice what we never expected to see." --- John Tukey*</span></span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>Worum geht es in der explorativen Datenanalyse? Die explorative Datenanalyse wurde von <span class="co">[</span><span class="ot">John Tukey (1915--2000)</span><span class="co">](https://de.wikipedia.org/wiki/John_W._Tukey)</span> begründet. Er war ein Pionier im Bereich der frühen Informatik und Computerwissenschaften. Warum explorativ, was wollen wir den erforschen? Denn nichts anderes bedeutet ja explorativ (deu. *erforschend, erkundend, untersuchend*) -- wir wollen etwas entdecken. Die Idee war ziemlich innovativ und neu als @tukey1977exploratory in seinem Buch die explorative Datenanalyse erstmal als Begriff vorstellte. Schon vorher beschrieb @tukey1962future in seinem Artikel "The Future of Data Analysis" die zukünftige Datenanalyse, wie Tukey sie sich vorstellte, was auch sein folgendes Zitat belegt.</span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"I know of no person or group that is taking nearly adequate advantage of the graphical potentialities of the computer." --- John Tukey*</span></span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>Nun musst du wissen, dass in den 60'ziger Jahren der Computer in den Kinderschuhen steckte. Mal eben eine Berechnung durchführen, dass war dann schon so eine Sache der damaligen Zeit. Vieles bis fast alles wurde als Tabellen veröffentlicht und selten wurde eine Abbildung *händisch* dazu erstellt. An dieser Stelle sei einmal auf die <span class="co">[</span><span class="ot">Microsoft Excel Werbung aus dem Jahr 1990</span><span class="co">](https://youtu.be/kOO31qFmi9A?si=wHkm7frVVlH2e_SF)</span> verwiesen. Daher war die Idee, sich Daten zu visualisieren entsprechend neu und wirklich ein wissenschaftlicher Fortschritt. Erstaunlicherweise glauben wir heute manchmal dann Zahlen in einer Tabelle mehr als einer Abbildung. Wir schreiben dann den Zahlen eine größere Genauigkeit und Aussagekraft zu, als einer explorativen Abbildung. Dabei können wir in einer Abbildung viel mehr sehen, als in einer Tabelle.</span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"There is no data that can be displayed in a pie chart, that cannot be displayed BETTER in some other type of chart." --- John Tukey*</span></span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a><span class="al">!["The reason to avoid pie charts" Quelle: wumo.com](images/eda/cake_chart.jpg)</span>{#fig-wumo-pie fig-align="center" width="100%"}</span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-32"><a href="#cb123-32" aria-hidden="true" tabindex="-1"></a>Daher ist ein wichtiger Teil in der Analyse von Daten die Visualisierung und damit die Darstellung in einer Abbildung. Wir haben aber eine großem Auswahl an möglichen Abbildungen, deshalb auch das lange Kapitel hier. Siehe dazu auch die Arbeit von @riedel2022replacing mit dem Titel <span class="co">[</span><span class="ot">Replacing bar graphs of continuous data with more informative graphics: are we making progress?</span><span class="co">](https://portlandpress.com/clinsci/article/136/15/1139/231562/Replacing-bar-graphs-of-continuous-data-with-more)</span> um mehr über die Nutzung der Abbildungen im Laufe der Zeit zu erfahren. Nicht alles was schon immer genutzt wurde, macht auch Sinn weiter genutzt zu werden. Wir haben mit R und <span class="in">`{ggplot}`</span> eine Möglichkeit Abbildungen von Daten sehr viel besser zu erstellen als noch vor ein paar Jahrzehnten möglich war.</span>
<span id="cb123-33"><a href="#cb123-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-34"><a href="#cb123-34" aria-hidden="true" tabindex="-1"></a>Grundsätzlich glauben wir dabei keiner Auswertung eines mathematischen Algorithmus, wenn wir nicht die Bestätigung in einer Abbildung sehen. Wenn wir also einen signifikanten Unterschied aus einem Algorithmus wiedergegeben bekommen, dann müssen wir auch den Unterschied in einer Abbildung sehen können. Eine statistische Analyse und deren Visualisierung gehen Hand in Hand. Daher ist die Visualisierung die Grundlage für ein fundiertes, wissenschaftliches Arbeiten. In diesem Kapitel stelle ich dir verschiedene Abbildungen vor, die uns helfen werden zu Verstehen ob es einen Zusammenhang zwischen $y$ und $x$ gibt. Wir haben ein $y$ vorliegen, was wir auf die y-Achse eines Graphen legen und daneben dann mehrere Variablen bzw. Spalten die wir $x$ nennen. Eine der Variablen legen wir auf die x-Achse des Graphen. Nach den anderen $x$ färben wir die Abbildung ein. Wir nennen dabei eine Abbildung auch häufig Plot. Das ist der englische Begriff und hat nichts in unserem Kontext mit einer Fläche oder einer Handlung in einem Film zu zu tun. Im den beiden folgenden Abbildungen siehst du einmal die beiden häufigsten wissenschaftlichen Fragestellungen in der explorativen Datenanalyse.</span>
<span id="cb123-35"><a href="#cb123-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-38"><a href="#cb123-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-39"><a href="#cb123-39" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb123-40"><a href="#cb123-40" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-41"><a href="#cb123-41" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-42"><a href="#cb123-42" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-eda-overview-01</span></span>
<span id="cb123-43"><a href="#cb123-43" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-44"><a href="#cb123-44" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5.5</span></span>
<span id="cb123-45"><a href="#cb123-45" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb123-46"><a href="#cb123-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der beiden häufigsten wissenschaftlichen Fragestellungen in der explorativen Datenanalyse. **(A)** *Die Frage nach dem Unterschied.* Unterschieden sich die Gruppen auf der x-Achse gegeben den Werten auf der y-Achse? Um den Unterschied darzustellen können Barplots oder Boxplots verwendet werden. **(B)** *Die Frage nach dem Zusammenhang.* Wie verändern sich die Werte der y-Achse, wenn sich die Werte auf der x-Achse ändern? Um den Zusammenhang zu zeigen kann ein Scatterplot verwendet werden. Die Gerade durch die Punkte kann durch eine (nicht) lineare Regression bestimmt werden. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb123-47"><a href="#cb123-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-48"><a href="#cb123-48" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"images/R/eda-ggplot-01.R"</span>)</span>
<span id="cb123-49"><a href="#cb123-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-50"><a href="#cb123-50" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> p1 <span class="sc">+</span> </span>
<span id="cb123-51"><a href="#cb123-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb123-52"><a href="#cb123-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>)</span>
<span id="cb123-53"><a href="#cb123-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-54"><a href="#cb123-54" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-55"><a href="#cb123-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-56"><a href="#cb123-56" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel wollen wir durch die bedeutendsten Abbildungen in der explorativen Datenanalyse durchgehen. Ich habe die Abbildungen etwas nach Kontext sortiert und geschaut, dass die Abbildungen zum Gruppennterschied oder Zusammenhang zweier Variablen als erstes besprochen werden.</span>
<span id="cb123-57"><a href="#cb123-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-58"><a href="#cb123-58" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Barplot</span><span class="co">](#sec-eda-barplot)</span> für 5 und mehr Beobachtungen (pro Gruppe). Der Barplot oder das *Balkendiagramm* bzw. *Säulendiagramm* stellt den Mittelwert und die Standardabweichung da.</span>
<span id="cb123-59"><a href="#cb123-59" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Boxplot</span><span class="co">](#sec-eda-boxplot)</span> für 5 bis 20 Beobachtungen (pro Gruppe). Ebenso wie bei einem Histogramm, geht es bei einem Boxplot auch um die Verteilung der einer Variable. Wir können in einem Boxplot auch erkennen, ob sogenannte auffällige Werte oder Ausreißer vorliegen.</span>
<span id="cb123-60"><a href="#cb123-60" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Scatterplot</span><span class="co">](#sec-eda-scatter)</span> für zwei kontinuierliche Variablen. Auch *xy-Plot* genannt. Die Abbildung, die dir bekannt sein müsste. Wir zeichnen hier eine Grade durch eine Punktewolke.</span>
<span id="cb123-61"><a href="#cb123-61" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Mosaicplot</span><span class="co">](#sec-eda-mosaic)</span> für zwei diskrete Variablen. Eine etwas seltene Abbildung, wenn wir Variablen abbilden wollen, die diskret sind bzw. aus Kategorien bestehen.</span>
<span id="cb123-62"><a href="#cb123-62" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Histogramm</span><span class="co">](#sec-eda-histogramm)</span> für mehr als 20 Beobachtungen (pro Gruppe). Wir nutzen ein Histogramm um die Verteilung einer Variable zu visualisieren.</span>
<span id="cb123-63"><a href="#cb123-63" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Dotplot</span><span class="co">](#sec-eda-dotplot)</span> für 3 bis 5 Beobachtungen (pro Gruppe). Hier geht es weniger um die Verteilung der Variable, sondern darum die wenigen Beobachtungen zu visualisieren.</span>
<span id="cb123-64"><a href="#cb123-64" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Violinplot</span><span class="co">](#sec-eda-violinplot)</span> für die Kombination von einem Densityplot und einem Boxplot. Dann können wir hier noch den Dotplot ergänzen und haben eine sehr informative Übersichtsabbildung.</span>
<span id="cb123-65"><a href="#cb123-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-66"><a href="#cb123-66" aria-hidden="true" tabindex="-1"></a>Beginnen wir also mit dem Teil, der in der Statistik der mir immer am meisten Spaß macht. Oder aber um es in den Worten von John Tukey, den Begründer der explorativen Datenanalyse zu sagen:</span>
<span id="cb123-67"><a href="#cb123-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-68"><a href="#cb123-68" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"This is my favorite part about analytics: Taking boring flat data and bringing it to life through visualization." --- John Tukey*</span></span>
<span id="cb123-69"><a href="#cb123-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-70"><a href="#cb123-70" aria-hidden="true" tabindex="-1"></a>Wir immer geht natürlich hier auch noch viel mehr am Abbildungen. Du musst nicht alles in <span class="in">`ggplot`</span> machen und darüber hinaus gibt es dann auch noch einiges an anderen R Paketen. In dem folgenden Kasten habe ich dir mal ein paar Quellen rausgesucht, wo du einmal gucken kannst, wenn du noch mehr Inspiration benötigst. Ich nutze die Seiten auch als Inspiration, den meisten weiß man gar nicht was alles geht, bis man die Visualisierung gesehen hat.</span>
<span id="cb123-71"><a href="#cb123-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-72"><a href="#cb123-72" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb123-73"><a href="#cb123-73" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Möglichkeiten der Visualisierung</span></span>
<span id="cb123-74"><a href="#cb123-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-75"><a href="#cb123-75" aria-hidden="true" tabindex="-1"></a>Im Folgenden einmal eine Auswahl an weiteren Möglichkeiten sich Abbildungen in R zu visualisieren. Teilweise ist es dann auch eine Sammlung an Informationen für mich, damit ich eine Idee habe, was noch so alles geht. Manchmal braucht man ja auch noch eine zusätzlich Inspiration.</span>
<span id="cb123-76"><a href="#cb123-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-77"><a href="#cb123-77" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Data visualization with ggplot2 :: Cheat Sheet</span><span class="co">](https://rstudio.github.io/cheatsheets/html/data-visualization.html)</span> -- als Überblick über alles was eigentlich in <span class="in">`ggplot`</span> möglich ist. Du kriegst dann nochmal ein Überblick über die <span class="in">`geom`</span>e, die es gibt und wie die einzelnen Funktionen und Möglichkeiten miteinander interagieren. Du kannst dir das Cheat Sheet auch auf Deutsch runterladen.\</span>
<span id="cb123-78"><a href="#cb123-78" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">R Charts by R Coder</span><span class="co">](https://r-charts.com/)</span> -- ein großer Überblick über alle möglichen Abbildungen sortiert nach verschiedenen Kategorien. Hier würde ich auf jeden Fall mal drüber schauen, dann kriegst du nochmal eine Idee was neben <span class="in">`ggplot`</span> noch so alles geht. Ich finde die Seite immer sehr inspirierend.</span>
<span id="cb123-79"><a href="#cb123-79" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">ALL YOUR FIGURE ARE BELONG TO US</span><span class="co">](https://yutannihilation.github.io/allYourFigureAreBelongToUs/)</span> ist eine weitere tolle Übersicht an möglichen Abbildungen in <span class="in">`{ggplot}`</span> Universum. Die Übersicht zeigt nochmal verschiedene R Pakte mit den entsprechenden möglichen Abbildungen.</span>
<span id="cb123-80"><a href="#cb123-80" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">sjPlot - Data Visualization for Statistics in Social Science</span><span class="co">](https://strengejacke.github.io/sjPlot/)</span> -- auch hier geitbes dann die Möglichkeit nochmal etwas anders auf die Visualisierung zu schauen. Denn hier haben wir dann die Möglichkeiten der Sozialwissenschaften mehr abgedeckt. Das mag insbesondere im Bereich von Fragebögen und Marketing von Interesse sein.</span>
<span id="cb123-81"><a href="#cb123-81" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Als spannende zusätzlichen Ressourcen seinen das <span class="co">[</span><span class="ot">R Paket `{cowplot}`</span><span class="co">](https://wilkelab.org/cowplot/index.html)</span> sowie das <span class="co">[</span><span class="ot">R Paket `{ggpubr}`</span><span class="co">](https://rpkgs.datanovia.com/ggpubr/index.html)</span> genannt. Besonders das Paket <span class="in">`cowplot`</span> liefert noch schöne Formatierungsmöglichkeiten wobei dann <span class="in">`ggpubr`</span> statistische Test mit der Visualisierung verbindet.</span>
<span id="cb123-82"><a href="#cb123-82" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">{plotly} R Open Source Graphing Library</span><span class="co">](https://plotly.com/r/)</span> sowie im besonderen dann die Seite <span class="co">[</span><span class="ot">Getting Started with {plotly} in {ggplot2}</span><span class="co">](https://plotly.com/ggplot2/getting-started/)</span> liefert dann interaktive Abbildungen, wo du dann direkt hereinzoomen kannst. Das ist bei sehr großen Abbildungen immer sehr praktisch. Auch kannst du die Werte einer einzelnen Beobachtung gleich im Plot ablesen.</span>
<span id="cb123-83"><a href="#cb123-83" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">How to create BBC style graphics</span><span class="co">](https://bbc.github.io/rcookbook/)</span> -- einmal als ein Beispiel für die Anwendung von <span class="in">`ggplot`</span> in der Wirtschaft und Data Science. Auch hier sieht man schön die Ideen die möglich sind.</span>
<span id="cb123-84"><a href="#cb123-84" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Visualizing Distributions with Raincloud Plots (and How to Create Them with ggplot2)</span><span class="co">](https://www.cedricscherer.com/2021/06/06/visualizing-distributions-with-raincloud-plots-and-how-to-create-them-with-ggplot2/)</span> -- manchmal ist dann der Barplot oder Dynamiteplot dann doch irgendwie nicht das richtige Werkzeug um die Daten zu zeigen. Daher hier nochmal der Blogpost mit einer Diskussion was neben dem Säulendiagramm noch so alles gehen könnte.</span>
<span id="cb123-85"><a href="#cb123-85" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">ggplot Wizardry Hands-On</span><span class="co">](https://z3tt.github.io/OutlierConf2021/)</span> zeigt nochmal sher schön was alles in <span class="in">`{ggplot}`</span> geht, wenn die entsprechenden zusätzlichen Pakete geladen werden. Ich schaue auch hier immer mal wieder rein, wenn ich eine Abbildung besonders schön machen möchte. Hier liegt dann der Fokus auf dem <span class="co">[</span><span class="ot">R Paket`{gghalves}`</span><span class="co">](https://erocoar.github.io/gghalves/)</span> sowie dem <span class="co">[</span><span class="ot">R Paket `{ggdist}`</span><span class="co">](https://mjskay.github.io/ggdist/)</span>.</span>
<span id="cb123-86"><a href="#cb123-86" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Die Publikation <span class="co">[</span><span class="ot">Error bars in experimental biology</span><span class="co">](https://rupress.org/jcb/article/177/1/7/34602/Error-bars-in-experimental-biology)</span> von @cumming2007error liefert nochmal einen Überblick über Fehlerbalken und welche Fehlerbalken man den nun nutzen sollte.</span>
<span id="cb123-87"><a href="#cb123-87" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-88"><a href="#cb123-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-89"><a href="#cb123-89" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb123-90"><a href="#cb123-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-91"><a href="#cb123-91" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb123-92"><a href="#cb123-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-93"><a href="#cb123-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb123-94"><a href="#cb123-94" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb123-95"><a href="#cb123-95" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb123-96"><a href="#cb123-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-97"><a href="#cb123-97" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, readxl, ggmosaic, </span></span>
<span id="cb123-98"><a href="#cb123-98" aria-hidden="true" tabindex="-1"></a><span class="in">               janitor, see, patchwork, latex2exp, ggbeeswarm,</span></span>
<span id="cb123-99"><a href="#cb123-99" aria-hidden="true" tabindex="-1"></a><span class="in">               ggdist, gghalves, ggbreak, duke, wesanderson, </span></span>
<span id="cb123-100"><a href="#cb123-100" aria-hidden="true" tabindex="-1"></a><span class="in">               conflicted)</span></span>
<span id="cb123-101"><a href="#cb123-101" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::summarise)</span></span>
<span id="cb123-102"><a href="#cb123-102" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb123-103"><a href="#cb123-103" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(latex2exp::TeX)</span></span>
<span id="cb123-104"><a href="#cb123-104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-105"><a href="#cb123-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-106"><a href="#cb123-106" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb123-107"><a href="#cb123-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-108"><a href="#cb123-108" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb123-109"><a href="#cb123-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-110"><a href="#cb123-110" aria-hidden="true" tabindex="-1"></a>Wir importieren also den Datensatz <span class="in">`flea_cat_dog.xlsx`</span> und wollen einzelne Variablen visualisieren. Wir kennen den Datensatz schon aus den vorherigen Beispielen. Dennoch nochmal hier der Datensatz in @tbl-cat-dog-ggplot einmal dargestellt.</span>
<span id="cb123-111"><a href="#cb123-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-114"><a href="#cb123-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-115"><a href="#cb123-115" aria-hidden="true" tabindex="-1"></a>flea_dog_cat_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/flea_dog_cat.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb123-116"><a href="#cb123-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">animal =</span> <span class="fu">as_factor</span>(animal))</span>
<span id="cb123-117"><a href="#cb123-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-118"><a href="#cb123-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-119"><a href="#cb123-119" aria-hidden="true" tabindex="-1"></a>Im Folgenden ist es wichtig, dass du dir die Spaltennamen merkst. Wir können nur die exakten, wortwörtlichen Spaltennamen verwenden. Sonst erhalten wir einen Fehler. Deshalb haben wir auch keine Leerzeichen in den Spaltennamen.</span>
<span id="cb123-120"><a href="#cb123-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-123"><a href="#cb123-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-124"><a href="#cb123-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb123-125"><a href="#cb123-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-cat-dog-ggplot</span></span>
<span id="cb123-126"><a href="#cb123-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle von sieben Hunde- und Katzenflöhen mit der Sprunglänge [cm], Anzahl an Haaren am rechten Flohbein, Gewicht der Flöhe, Boniturnote sowie der Infektionsstatus für Flohschnupfen."</span></span>
<span id="cb123-127"><a href="#cb123-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-128"><a href="#cb123-128" aria-hidden="true" tabindex="-1"></a>flea_dog_cat_tbl <span class="sc">|&gt;</span> <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb123-129"><a href="#cb123-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-130"><a href="#cb123-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-131"><a href="#cb123-131" aria-hidden="true" tabindex="-1"></a>Wir brauchen dann ab und an auch nochmal mehr Datenpunkte, daher nehmen wir auch einmal den Gummibärchendatensatz und schauen uns dort die Variablen <span class="in">`gender`</span>, <span class="in">`height`</span> und <span class="in">`age`</span> einmal genauer an. Wie immer nutzen wir die Funktion <span class="in">`select()`</span> um die Spalten zu selektieren. Abschließend verwandeln wir das Geschlecht <span class="in">`gender`</span> noch in einen Faktor und entfernen alle fehlenden Werte mit <span class="in">`na.omit()`</span>.</span>
<span id="cb123-132"><a href="#cb123-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-135"><a href="#cb123-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-136"><a href="#cb123-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-137"><a href="#cb123-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-138"><a href="#cb123-138" aria-hidden="true" tabindex="-1"></a>gummi_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/gummibears.xlsx"</span>)  <span class="sc">|&gt;</span></span>
<span id="cb123-139"><a href="#cb123-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(gender, height, age) <span class="sc">|&gt;</span> </span>
<span id="cb123-140"><a href="#cb123-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">factor</span>(gender, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"männlich"</span>, <span class="st">"weiblich"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb123-141"><a href="#cb123-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb123-142"><a href="#cb123-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-143"><a href="#cb123-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-144"><a href="#cb123-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-145"><a href="#cb123-145" aria-hidden="true" tabindex="-1"></a><span class="fu">## Grundlagen in `{ggplot}`</span></span>
<span id="cb123-146"><a href="#cb123-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-147"><a href="#cb123-147" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/SGwSVzJ9C-s &gt;}}</span>
<span id="cb123-148"><a href="#cb123-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-149"><a href="#cb123-149" aria-hidden="true" tabindex="-1"></a>Wir nutzen in R das R Paket <span class="in">`{ggplot2}`</span> um unsere Daten zu visualisieren. Die zentrale Idee von <span class="in">`{ggplot2}`</span> ist, dass wir uns eine Abbildung wie ein Sandwich bauen. Zuerst legen wir eine Scheibe Brot hin und legen uns dann Scheibe für Scheibe weitere Schichten übereinander. Oder die Idee eines Bildes, wo wir erst die Leinwand definieren und dann Farbschicht über Farbschicht auftragen. Im Gegensatz zu dem Pipe-Operator <span class="in">`|&gt;`</span> nutzt <span class="in">`{ggplot2}`</span> den Operator <span class="in">`+`</span> um die verschiedenen Funktionen (<span class="in">`geom_`</span>) miteinander zu verbinden. Das Konzept von <span class="in">`{ggplot2}`</span>ist schlecht zu be*schreiben* deshalb habe ich auch noch zwei Videos hierfür gemacht. Um den Prozess von <span class="in">`{ggplot2}`</span> zu visualisieren - aber wie immer, nutze was du brauchst.</span>
<span id="cb123-150"><a href="#cb123-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-151"><a href="#cb123-151" aria-hidden="true" tabindex="-1"></a>Erstellen wir also erstmal unseren erste Visualisierung in dem R Paket <span class="in">`{ggplot2}`</span>. Im Folgenden spreche ich dann aber immer von <span class="in">`{ggplot}`</span>. Die Funktion <span class="in">`ggplot()`</span> ist die zentrale Funktion, die die Leinwand erschafft auf der wir dann verschiedene Schichten aufbringen werden. Diese Schichten heißen <span class="in">`geom`</span>. Es gibt nicht nur ein <span class="in">`geom`</span> sondern mehrere. Zum Beispiel das <span class="in">`geom_boxplot()`</span> für die Erstellung von Boxplots, das <span class="in">`geom_histogram()`</span> für die Erstellung von Histogrammen. <span class="co">[</span><span class="ot">Die Auswahl ist riesig</span><span class="co">](https://ggplot2.tidyverse.org/reference/index.html)</span>. Die einzelnen Schichten werden dann über den Operator <span class="in">`+`</span> miteinander verbunden. Soviel erstmal zur Trockenübung. Schauen wir uns das ganze einmal an einem Beispiel an. Dafür müssen wir dann erstmal einen Datensatz laden, damit wir auch etwas zum abbilden haben.</span>
<span id="cb123-152"><a href="#cb123-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-153"><a href="#cb123-153" aria-hidden="true" tabindex="-1"></a>{{&lt; video https://youtu.be/SRRQQO3DXtc &gt;}}</span>
<span id="cb123-154"><a href="#cb123-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-155"><a href="#cb123-155" aria-hidden="true" tabindex="-1"></a>Wie immer empfehle ich dir dann auch das entsprechende Video auf YouTube anzuschauen. In Textform ist eine echte Herausforderung zu erklären wie man Plots baut. Der folgende R Code erstellt die Leinwand in der @fig-ggplot-1 für die folgende, zusätzliches Schichten (<span class="in">`geom`</span>). Wir haben also immer erst eine leere Leinwand auf der wir dann zusätzlich <span class="in">`geom`</span>e plotten. Wir bauen uns sozusagen ein Sandwich.</span>
<span id="cb123-156"><a href="#cb123-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-159"><a href="#cb123-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-160"><a href="#cb123-160" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-161"><a href="#cb123-161" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb123-162"><a href="#cb123-162" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-163"><a href="#cb123-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-164"><a href="#cb123-164" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb123-165"><a href="#cb123-165" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal , <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb123-166"><a href="#cb123-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb123-167"><a href="#cb123-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-168"><a href="#cb123-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-169"><a href="#cb123-169" aria-hidden="true" tabindex="-1"></a>Wir schauen uns einmal den Code im Detail an.</span>
<span id="cb123-170"><a href="#cb123-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-171"><a href="#cb123-171" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ggplot`</span> ruft die Funktion auf. Die Funktion ist dafür da den Plot zu zeichnen.</span>
<span id="cb123-172"><a href="#cb123-172" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`data = flea_dog_cat_tbl`</span> benennt den Datensatz aus dem der Plot gebaut werden soll.</span>
<span id="cb123-173"><a href="#cb123-173" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`aes()`</span>ist die Abkürzung für *aesthetics* und beschreibt, was auf die $x$-Achse soll, was auf die $y$-Achse soll sowie ob es noch andere Faktoren in den Daten gibt. Wir können nämlich noch nach anderen Spalten die Abbildung einfärben oder anderweitig ändern.</span>
<span id="cb123-174"><a href="#cb123-174" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`x`</span> braucht den Spaltennamen für die Variable auf der $x$-Achse.</span>
<span id="cb123-175"><a href="#cb123-175" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`y`</span> braucht den Spaltennamen für die Variable auf der $y$-Achse.</span>
<span id="cb123-176"><a href="#cb123-176" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`+ theme_minimal()`</span> setzt das Canvas oder die Leinwand auf schwarz/weiß. Sonst wäre die Leinwand flächig grau.</span>
<span id="cb123-177"><a href="#cb123-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-178"><a href="#cb123-178" aria-hidden="true" tabindex="-1"></a>Mit *Faktoren* meine ich hier andere Gruppenvariablen. Variablen sind ein anderes Wort für Spalten. Also Variablen die wir mit <span class="in">`as_factor`</span> erschaffen haben und die uns noch mehr über unsere Daten dann verraten können. Hier ist es dann etwas abstrakt, aber es wird dann später in der Anwendung klarer.</span>
<span id="cb123-179"><a href="#cb123-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-182"><a href="#cb123-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-183"><a href="#cb123-183" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb123-184"><a href="#cb123-184" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-185"><a href="#cb123-185" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-1</span></span>
<span id="cb123-186"><a href="#cb123-186" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-187"><a href="#cb123-187" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb123-188"><a href="#cb123-188" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb123-189"><a href="#cb123-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Leere ggplot() Leinwand mit den Spalten `animal` und `jump_length` aus dem Datensatz `flea_dog_cat_tbl`. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb123-190"><a href="#cb123-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-191"><a href="#cb123-191" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb123-192"><a href="#cb123-192" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal , <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb123-193"><a href="#cb123-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb123-194"><a href="#cb123-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-195"><a href="#cb123-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-196"><a href="#cb123-196" aria-hidden="true" tabindex="-1"></a>Am Ende sehen wir, dass wir nichts sehen. In der @fig-ggplot-1 ist nichts dargestellt. Der Grund ist, dass wir noch kein <span class="in">`geom`</span> hinzugefügt haben. Das <span class="in">`geom`</span> beschreibt nun wie die Zahlen in der Datentabelle <span class="in">`flea_dog_cat_tbl`</span> visualisiert werden sollen. Wir habe eine sehr große Auswahl an <span class="in">`geom`</span>en, deshalb gibt es gleich einmal eine Auswahl an Abbildungen.</span>
<span id="cb123-197"><a href="#cb123-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-198"><a href="#cb123-198" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="minimal"}</span>
<span id="cb123-199"><a href="#cb123-199" aria-hidden="true" tabindex="-1"></a>Auf der Seite <span class="co">[</span><span class="ot">ggplot2 extensions</span><span class="co">](https://exts.ggplot2.tidyverse.org/gallery/)</span> gibt es noch eine Vielzahl an weiteren tollen Möglichkeiten zu entdecken! Einfach durch die Galerie mit über 120 Erweiterungen streifen und sich inspirieren lassen!</span>
<span id="cb123-200"><a href="#cb123-200" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-201"><a href="#cb123-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-202"><a href="#cb123-202" aria-hidden="true" tabindex="-1"></a><span class="fu">## Die häufigsten Abbildungen</span></span>
<span id="cb123-203"><a href="#cb123-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-204"><a href="#cb123-204" aria-hidden="true" tabindex="-1"></a>Im Folgenden gehen wir dann einmal die wichtigsten Abbildungen einmal durch. Viele der Abbildungen kennst du vielleicht schon und dann musst du hier nur noch schauen, wie die Abbildungen in <span class="in">`ggplot`</span> zu realisieren sind. Ansonsten gilt wie immer, es ist nur ein kleiner Ausschnitt, du findest auf der <span class="co">[</span><span class="ot">Hilfeseite von `ggplot`</span><span class="co">](https://ggplot2.tidyverse.org/index.html)</span> eine sehr viel größere Übersicht.</span>
<span id="cb123-205"><a href="#cb123-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-206"><a href="#cb123-206" aria-hidden="true" tabindex="-1"></a><span class="fu">### Barplot {#sec-eda-barplot}</span></span>
<span id="cb123-207"><a href="#cb123-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-208"><a href="#cb123-208" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-barplot.qmd &gt;}}</span>
<span id="cb123-209"><a href="#cb123-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-210"><a href="#cb123-210" aria-hidden="true" tabindex="-1"></a><span class="fu">### Boxplot {#sec-eda-boxplot}</span></span>
<span id="cb123-211"><a href="#cb123-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-212"><a href="#cb123-212" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-boxplot.qmd &gt;}}</span>
<span id="cb123-213"><a href="#cb123-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-214"><a href="#cb123-214" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scatterplot {#sec-eda-scatter}</span></span>
<span id="cb123-215"><a href="#cb123-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-216"><a href="#cb123-216" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-scatterplot.qmd &gt;}}</span>
<span id="cb123-217"><a href="#cb123-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-218"><a href="#cb123-218" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mosaicplot {#sec-eda-mosaic}</span></span>
<span id="cb123-219"><a href="#cb123-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-220"><a href="#cb123-220" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-mosaic.qmd &gt;}}</span>
<span id="cb123-221"><a href="#cb123-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-222"><a href="#cb123-222" aria-hidden="true" tabindex="-1"></a><span class="fu">### Histogramm {#sec-eda-histogramm}</span></span>
<span id="cb123-223"><a href="#cb123-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-224"><a href="#cb123-224" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-histogram.qmd &gt;}}</span>
<span id="cb123-225"><a href="#cb123-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-226"><a href="#cb123-226" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dotplot, Beeswarm und Raincloud Plot {#sec-eda-dotplot}</span></span>
<span id="cb123-227"><a href="#cb123-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-228"><a href="#cb123-228" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-dotplot.qmd &gt;}}</span>
<span id="cb123-229"><a href="#cb123-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-230"><a href="#cb123-230" aria-hidden="true" tabindex="-1"></a><span class="fu">### Violinplot {#sec-eda-violinplot}</span></span>
<span id="cb123-231"><a href="#cb123-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-232"><a href="#cb123-232" aria-hidden="true" tabindex="-1"></a>{{&lt; include eda-ggplot/eda-ggplot-violinplot.qmd &gt;}}</span>
<span id="cb123-233"><a href="#cb123-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-234"><a href="#cb123-234" aria-hidden="true" tabindex="-1"></a><span class="fu">## Optionen in `{ggplot}`</span></span>
<span id="cb123-235"><a href="#cb123-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-236"><a href="#cb123-236" aria-hidden="true" tabindex="-1"></a>Im Folgenden dann noch eine Sammlung an nützlichen Optionen und Möglichkeiten, die einem das Leben einfacher machen und die Abbildungen dann noch schöner. Nicht alles musst du in <span class="in">`ggplot`</span> machen, manchmal geht es dann in PowerPoint dann doch schneller mal eben einen Text zu ergänzen. Sehe das hier deshalb als Ergänzung und meinen privaten Raum, den ich nutze um mir den Code zu merken.</span>
<span id="cb123-237"><a href="#cb123-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-238"><a href="#cb123-238" aria-hidden="true" tabindex="-1"></a><span class="fu">### Überschriften, Achsen und Legenden</span></span>
<span id="cb123-239"><a href="#cb123-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-240"><a href="#cb123-240" aria-hidden="true" tabindex="-1"></a>Wenn du mehr machen willst, also die Überschriften anpassen oder aber die Achsenbeschriftung ändern, dann gibt es hier global Hilfe im <span class="co">[</span><span class="ot">ggplot Manual</span><span class="co">](https://ggplot2.tidyverse.org/reference/index.html)</span>. Die Webseite <span class="co">[</span><span class="ot">R Cookbook</span><span class="co">](https://ggplot2.tidyverse.org/reference/index.html)</span> hat auch spezielle Hilfe für ggplot().</span>
<span id="cb123-241"><a href="#cb123-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-242"><a href="#cb123-242" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Überschriften von Abbildungen</span><span class="co">]</span>(http://www.cookbook-r.com/Graphs/Titles_(ggplot2)/)</span>
<span id="cb123-243"><a href="#cb123-243" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Achsenbeschriftung</span><span class="co">]</span>(http://www.cookbook-r.com/Graphs/Axes_(ggplot2)/)</span>
<span id="cb123-244"><a href="#cb123-244" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Legende</span><span class="co">]</span>(http://www.cookbook-r.com/Graphs/Legends_(ggplot2)/)</span>
<span id="cb123-245"><a href="#cb123-245" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Farben</span><span class="co">]</span>(http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/)</span>
<span id="cb123-246"><a href="#cb123-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-247"><a href="#cb123-247" aria-hidden="true" tabindex="-1"></a>In @fig-labels-0 siehst du eine Abbildung mit Titel und veränderten Beschriftungen. Die Möglichkeiten sind nahezu unbegrenzt und sprengen auch hier den Rahmen. Im Zweifel im R Tutorium vorbeischauen oder aber in der Vorlesung fragen.</span>
<span id="cb123-248"><a href="#cb123-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-249"><a href="#cb123-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb123-250"><a href="#cb123-250" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb123-251"><a href="#cb123-251" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb123-252"><a href="#cb123-252" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb123-253"><a href="#cb123-253" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-labels-0</span></span>
<span id="cb123-254"><a href="#cb123-254" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-align: center</span></span>
<span id="cb123-255"><a href="#cb123-255" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 4</span></span>
<span id="cb123-256"><a href="#cb123-256" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 6</span></span>
<span id="cb123-257"><a href="#cb123-257" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Beispielhafte Abbildung mit Titel und geänderter Achsenbeschrittung. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb123-258"><a href="#cb123-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-259"><a href="#cb123-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-260"><a href="#cb123-260" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data = flea_dog_cat_tbl, aes(x = animal, y = jump_length,</span></span>
<span id="cb123-261"><a href="#cb123-261" aria-hidden="true" tabindex="-1"></a><span class="in">                                    fill = animal)) +</span></span>
<span id="cb123-262"><a href="#cb123-262" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot() +</span></span>
<span id="cb123-263"><a href="#cb123-263" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Frischgewicht in Abhängigkeit von der Behandlung",</span></span>
<span id="cb123-264"><a href="#cb123-264" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "Behandlung", y = "Frischgewicht in kg/ha") +</span></span>
<span id="cb123-265"><a href="#cb123-265" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(labels = c("Katze", "Hund")) +</span></span>
<span id="cb123-266"><a href="#cb123-266" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_discrete(name = "Behandlung", labels = c("Katze", "Hund")) +</span></span>
<span id="cb123-267"><a href="#cb123-267" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() </span></span>
<span id="cb123-268"><a href="#cb123-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-269"><a href="#cb123-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-270"><a href="#cb123-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-271"><a href="#cb123-271" aria-hidden="true" tabindex="-1"></a><span class="fu">### Abbildungen abspeichern</span></span>
<span id="cb123-272"><a href="#cb123-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-273"><a href="#cb123-273" aria-hidden="true" tabindex="-1"></a>Wenn du eine Abbildung abspeichern willst, dann musst du nur nach dem <span class="in">`ggplot`</span>-Code die Funktion <span class="in">`ggsave()`</span> setzen. Wie du im hier im Folgenden siehst, speichere ich die Abbildung der Boxplots der Hunde- und Katzenflöhe einmal in der Datei <span class="in">`flea_dog_boxplot.png`</span> ab. Dabei wähle ich eine Breite <span class="in">`width`</span> und eine Höhe <span class="in">`height`</span> von jeweils 5. Du musst dann immer etwas spielen, je größer die Zahlen, desto größer die Abbildung und die Auflösung.</span>
<span id="cb123-274"><a href="#cb123-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-277"><a href="#cb123-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-278"><a href="#cb123-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-279"><a href="#cb123-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-280"><a href="#cb123-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb123-281"><a href="#cb123-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-282"><a href="#cb123-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-save</span></span>
<span id="cb123-283"><a href="#cb123-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-284"><a href="#cb123-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb123-285"><a href="#cb123-285" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb123-286"><a href="#cb123-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafte Abspeicherung einer Abbdilung mit `ggsave()`. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb123-287"><a href="#cb123-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-288"><a href="#cb123-288" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb123-289"><a href="#cb123-289" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb123-290"><a href="#cb123-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() </span>
<span id="cb123-291"><a href="#cb123-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-292"><a href="#cb123-292" aria-hidden="true" tabindex="-1"></a><span class="do">## Abspeichern des obigen ggplots  </span></span>
<span id="cb123-293"><a href="#cb123-293" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"flea_dog_boxplot.png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb123-294"><a href="#cb123-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-295"><a href="#cb123-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-296"><a href="#cb123-296" aria-hidden="true" tabindex="-1"></a>Wie immer hilft auch die <span class="co">[</span><span class="ot">Hilfeseite von `ggsave()`</span><span class="co">](https://ggplot2.tidyverse.org/reference/ggsave.html)</span> weiter, wenn es um mehr Optionen und Qualität der Abbildungen geht.</span>
<span id="cb123-297"><a href="#cb123-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-298"><a href="#cb123-298" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mathematische Ausdrücke in den Achsenbeschriftungen {#sec-eda-tex}</span></span>
<span id="cb123-299"><a href="#cb123-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-300"><a href="#cb123-300" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="minimal"}</span>
<span id="cb123-301"><a href="#cb123-301" aria-hidden="true" tabindex="-1"></a>Besuche auch <span class="co">[</span><span class="ot">ggplot2 extensions</span><span class="co">](https://exts.ggplot2.tidyverse.org/gallery/)</span> für weitere tolle Möglichkeiten!</span>
<span id="cb123-302"><a href="#cb123-302" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-303"><a href="#cb123-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-304"><a href="#cb123-304" aria-hidden="true" tabindex="-1"></a>Häufig wollen wir nicht nur einfache Achsenbeschriftungen haben, sondern auch irgendwie komplexere Einheiten wie Eisendüngergehalt im Boden in $<span class="co">[</span><span class="ot">kg\, ha</span><span class="co">]</span>^{-1}$ darstellen. Jetzt soll die Einheit auch in dieser Form mit in die Achsenbeschriftung. Wir können dafür zwei Wege wählen. Einmal über das R Paket <span class="in">`{latex2exp}`</span> und die Funktion <span class="in">`TeX()`</span> oder aber die Funktion <span class="in">`expression()`</span>, wofür wir dann kein eigenes R Paket brauchen. Beide Wege haben Vor- und Nachteile. Wir gehen aber beide mal durch. Mehr Informationen durch das Tutorium <span class="co">[</span><span class="ot">Using latex2exp</span><span class="co">](https://cran.r-project.org/web/packages/latex2exp/vignettes/using-latex2exp.html)</span> oder aber eben der Klassiker mit <span class="co">[</span><span class="ot">Plot math expression</span><span class="co">](https://stat.ethz.ch/R-manual/R-patched/library/grDevices/html/plotmath.html)</span>.</span>
<span id="cb123-305"><a href="#cb123-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-306"><a href="#cb123-306" aria-hidden="true" tabindex="-1"></a>Wir können die Funktion <span class="in">`expression()`</span> nutzen um uns mathematische Formeln zu bauen. Leider ist das Ganze etwas frickelig und auch ich brauche immer drei Anläufe, bis die Formel dann passt. Im Folgenden aber einmal zwei Beispiel für mathematische Formeln und Ausdrücke. Beachte, dass du jedes Leerzeichen durch eine Tilde <span class="in">`~`</span> abbilden musst. Ich nutze die Funktion <span class="in">`expression()`</span> sehr selten und nur wenn die Formel wirklich sehr einfach ist. Da wir aber schon mit eckigen Klammern Probleme kriegen und diese so nervig mit <span class="in">`"`</span> einklammern müssen, nutze ich dann das Paket <span class="in">`{latex2exp}`</span> was ich im Folgenden vorstellen werde.</span>
<span id="cb123-307"><a href="#cb123-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-308"><a href="#cb123-308" aria-hidden="true" tabindex="-1"></a>Hier aber erstmal zwei Beispiele für eine Formel mit der Funktion <span class="in">`expression()`</span>. Wenn du mehr über die Möglichkeiten wissen willst, dann schauen auch einmal auf die Hilfeseite von <span class="co">[</span><span class="ot">Plot math</span><span class="co">](https://stat.ethz.ch/R-manual/R-patched/library/grDevices/html/plotmath.html)</span> oder du googelst dir die Lösung wie ich früher zusammen.</span>
<span id="cb123-309"><a href="#cb123-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-312"><a href="#cb123-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-313"><a href="#cb123-313" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-314"><a href="#cb123-314" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-315"><a href="#cb123-315" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-316"><a href="#cb123-316" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-317"><a href="#cb123-317" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb123-318"><a href="#cb123-318" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb123-319"><a href="#cb123-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-320"><a href="#cb123-320" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">expression</span>(Eisendüngeform<span class="sc">~</span>und<span class="sc">~-</span>höhe<span class="sc">~</span><span class="st">"[kg ha]"</span><span class="sc">^-</span><span class="dv">1</span>), <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb123-321"><a href="#cb123-321" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">expression</span>(Fe<span class="sc">-</span>Gehalt<span class="sc">~</span><span class="st">"["</span><span class="sc">~</span>mg<span class="sc">%.%</span>(kg<span class="sc">~</span>TM)<span class="sc">^-</span><span class="dv">1</span><span class="sc">~</span><span class="st">"]"</span>), <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb123-322"><a href="#cb123-322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-323"><a href="#cb123-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-324"><a href="#cb123-324" aria-hidden="true" tabindex="-1"></a>Für mich ausdrücklich einfacher geht es mit dem R Paket <span class="in">`{latex2exp}`</span> und der Funktion <span class="in">`TeX()`</span> sowie die Helferfunktion <span class="in">`r"()"`</span>. Ja, hier muss man dann noch eine andere Programmiersprache kennen, aber wie immer, du wirst nur schlauer. Die Informationen zur Matheumgebung in $\LaTeX$ kommen dann nochmal extra zwischen zwei Dollarzeichen <span class="in">`$`</span>. Ja, das ist etwas wirr für einen Anfänger, aber wir nutzen hier auch zwei Programmiersprachen zusammen. Zum einen $\LaTeX$ um die Mathesymbole sauber darzustellen und dann R um die Abbildungen in <span class="in">`ggplot()`</span> zu bauen. Mehr Informationen zu der Matheumgebung in $\LaTeX$ findest du einmal in der <span class="co">[</span><span class="ot">LaTeX Mathehilfe I</span><span class="co">](https://de.wikipedia.org/wiki/Hilfe:TeX)</span> sowie der <span class="co">[</span><span class="ot">LaTeX Mathehilfe II</span><span class="co">](https://en.wikibooks.org/wiki/LaTeX/Mathematics)</span>.</span>
<span id="cb123-325"><a href="#cb123-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-326"><a href="#cb123-326" aria-hidden="true" tabindex="-1"></a>Wie bauen wir uns also unseren mathematischen Ausdruck? Als erstes brauchen wir die Funktion <span class="in">`Tex()`</span>, die sagt einfach nur aus, dass jetzt $\LaTeX$-Code kommt. Dann wollen wir noch einen String brauen in dem der $\LaTeX$-Code für unseren mathematischen Ausdruck drin steht. Diesen String bauen wir mit <span class="in">`r"()"`</span>. Achtung, hier ist das Gänsefüßchen oben und unten vor und nach der runden Klammer sehr wichtig. In den Ausdruck können wir dann Text schreiben <span class="in">`Eisengehalt`</span> oder aber einen mathematischen Ausdruck abgrenzt von zwei Dollarzeichen <span class="in">`$`</span> wie <span class="in">`$[kg\, ha]^{-1}$`</span>. $\LaTeX$ kann nämlich nicht nur mathematische Ausdrücke sondern ist eigentlich ein Textverarbeitungsprogramm. Deshalb musst du hier *nochmal* zwischen Text und mathematischen Ausdruck unterscheiden.</span>
<span id="cb123-327"><a href="#cb123-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-328"><a href="#cb123-328" aria-hidden="true" tabindex="-1"></a>Hier nochmal aufgeschlüsselt wie der Code aussieht. Wir schreiben den Code nachher in einer Zeile, aber zum Verständnis ist es besser, wenn wir den Code einmal aufgeklappt sehen.</span>
<span id="cb123-329"><a href="#cb123-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-332"><a href="#cb123-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-333"><a href="#cb123-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb123-334"><a href="#cb123-334" aria-hidden="true" tabindex="-1"></a><span class="fu">TeX</span>(</span>
<span id="cb123-335"><a href="#cb123-335" aria-hidden="true" tabindex="-1"></a>    r<span class="st">"(</span></span>
<span id="cb123-336"><a href="#cb123-336" aria-hidden="true" tabindex="-1"></a><span class="st">      Eisengehalt $[kg\, ha]^{-1}$</span></span>
<span id="cb123-337"><a href="#cb123-337" aria-hidden="true" tabindex="-1"></a><span class="st">    )"</span></span>
<span id="cb123-338"><a href="#cb123-338" aria-hidden="true" tabindex="-1"></a>   )</span>
<span id="cb123-339"><a href="#cb123-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-340"><a href="#cb123-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-341"><a href="#cb123-341" aria-hidden="true" tabindex="-1"></a>Wir wollen uns das Ergebnis einmal in einem simplen <span class="in">`plot()`</span> anschauen. Wir nutzen die Funktionalität natürlich später in <span class="in">`ggplot`</span>, aber hier ist es so einmal einfacher zu sehen.</span>
<span id="cb123-342"><a href="#cb123-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-345"><a href="#cb123-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-346"><a href="#cb123-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-347"><a href="#cb123-347" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-348"><a href="#cb123-348" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-349"><a href="#cb123-349" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-350"><a href="#cb123-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2.5</span></span>
<span id="cb123-351"><a href="#cb123-351" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb123-352"><a href="#cb123-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-353"><a href="#cb123-353" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">cex =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">""</span>,</span>
<span id="cb123-354"><a href="#cb123-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TeX</span>(r<span class="st">"(</span></span>
<span id="cb123-355"><a href="#cb123-355" aria-hidden="true" tabindex="-1"></a><span class="st">         Eisengehalt $[kg\, ha]^{-1}$</span></span>
<span id="cb123-356"><a href="#cb123-356" aria-hidden="true" tabindex="-1"></a><span class="st">      )"</span>)</span>
<span id="cb123-357"><a href="#cb123-357" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb123-358"><a href="#cb123-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-359"><a href="#cb123-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-360"><a href="#cb123-360" aria-hidden="true" tabindex="-1"></a>Auch können wir sehr viel komplexere Formeln erstellen. Beachte auch hier, dass wir zwei Matheumgebungen in $\LaTeX$ vorliegen haben.</span>
<span id="cb123-361"><a href="#cb123-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-364"><a href="#cb123-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-365"><a href="#cb123-365" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-366"><a href="#cb123-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-367"><a href="#cb123-367" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-368"><a href="#cb123-368" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-369"><a href="#cb123-369" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2.5</span></span>
<span id="cb123-370"><a href="#cb123-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb123-371"><a href="#cb123-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-372"><a href="#cb123-372" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">cex =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">""</span>,</span>
<span id="cb123-373"><a href="#cb123-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">TeX</span>(r<span class="st">"(</span></span>
<span id="cb123-374"><a href="#cb123-374" aria-hidden="true" tabindex="-1"></a><span class="st">         A $\LaTeX$ formula: $</span><span class="sc">\f</span><span class="st">rac{2hc^2}{\lambda^5}</span><span class="sc">\f</span><span class="st">rac{1}{e^{</span><span class="sc">\f</span><span class="st">rac{hc}{\lambda k_B T}} - 1}$</span></span>
<span id="cb123-375"><a href="#cb123-375" aria-hidden="true" tabindex="-1"></a><span class="st">      )"</span>)</span>
<span id="cb123-376"><a href="#cb123-376" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb123-377"><a href="#cb123-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-378"><a href="#cb123-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-379"><a href="#cb123-379" aria-hidden="true" tabindex="-1"></a>In der @fig-scatter-flea-1 dann nochmal die Anwendung in einem <span class="in">`ggplot`</span> in dem wir die Achsen entsprechend beschriften und dann auch noch eine ausgedachte Regressionsgeleichung zu der Abbildung ergänzen.</span>
<span id="cb123-380"><a href="#cb123-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-383"><a href="#cb123-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-384"><a href="#cb123-384" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-385"><a href="#cb123-385" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-386"><a href="#cb123-386" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-387"><a href="#cb123-387" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scatter-flea-1</span></span>
<span id="cb123-388"><a href="#cb123-388" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-389"><a href="#cb123-389" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb123-390"><a href="#cb123-390" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb123-391"><a href="#cb123-391" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Zusammenhang zwischen dem Eisengehalt und -höhe im Boden und dem Eisengehalt in Salat. Zusätzlich ergänzt eine Regressiongleichung und ein ausgedachtes Bestimmtheitsmaß. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb123-392"><a href="#cb123-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-393"><a href="#cb123-393" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> flea_count, <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb123-394"><a href="#cb123-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb123-395"><a href="#cb123-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb123-396"><a href="#cb123-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb123-397"><a href="#cb123-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">TeX</span>(r<span class="st">"(Eisengehalt und -höhe $[kg\, ha]^{-1}$)"</span>), </span>
<span id="cb123-398"><a href="#cb123-398" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">TeX</span>(r<span class="st">"(Fe-Gehalt $[mg \cdot (kg TM)^{-1}]$)"</span>)) <span class="sc">+</span></span>
<span id="cb123-399"><a href="#cb123-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">10</span>, <span class="at">y =</span> <span class="dv">10</span>,</span>
<span id="cb123-400"><a href="#cb123-400" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">"($y = </span><span class="sc">\b</span><span class="st">eta_0 + </span><span class="sc">\b</span><span class="st">eta_1 \cdot x;\; R^2 = 0.24$)"</span>))</span>
<span id="cb123-401"><a href="#cb123-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-402"><a href="#cb123-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-403"><a href="#cb123-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-404"><a href="#cb123-404" aria-hidden="true" tabindex="-1"></a>Wenn du dann mal die Funktion <span class="in">`Tex()`</span> in <span class="in">`geom_text()`</span> verwenden willst, dann musst du einmal etwas anpassen. Dann klappt es aber auch hier. Das hat mich mal echt Nerven und Zeit gekostet, deshalb lagere ich die Information mal hier für mich.</span>
<span id="cb123-405"><a href="#cb123-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-408"><a href="#cb123-408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-409"><a href="#cb123-409" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-410"><a href="#cb123-410" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-411"><a href="#cb123-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-412"><a href="#cb123-412" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb123-413"><a href="#cb123-413" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-414"><a href="#cb123-414" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 1</span></span>
<span id="cb123-415"><a href="#cb123-415" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 2</span></span>
<span id="cb123-416"><a href="#cb123-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-417"><a href="#cb123-417" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb123-418"><a href="#cb123-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb123-419"><a href="#cb123-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="dv">0</span>, <span class="dv">0</span>, </span>
<span id="cb123-420"><a href="#cb123-420" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">TeX</span>(r<span class="st">'($</span><span class="sc">\a</span><span class="st">lpha  x^</span><span class="sc">\a</span><span class="st">lpha$, where $</span><span class="sc">\a</span><span class="st">lpha \in 1\ldots 5$)'</span>,</span>
<span id="cb123-421"><a href="#cb123-421" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">output =</span> <span class="st">"character"</span>)), <span class="at">parse =</span> <span class="cn">TRUE</span>) </span>
<span id="cb123-422"><a href="#cb123-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-423"><a href="#cb123-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-424"><a href="#cb123-424" aria-hidden="true" tabindex="-1"></a><span class="fu">### Farbpaletten</span></span>
<span id="cb123-425"><a href="#cb123-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-426"><a href="#cb123-426" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="minimal"}</span>
<span id="cb123-427"><a href="#cb123-427" aria-hidden="true" tabindex="-1"></a>Besuche auch <span class="co">[</span><span class="ot">ggplot2 extensions</span><span class="co">](https://exts.ggplot2.tidyverse.org/gallery/)</span> für weitere tolle Möglichkeiten!</span>
<span id="cb123-428"><a href="#cb123-428" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-429"><a href="#cb123-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-430"><a href="#cb123-430" aria-hidden="true" tabindex="-1"></a>Neben den klassischen Farben im R Paket <span class="in">`{ggplot2}`</span> gibt es noch weit, weit mehr Farbpaletten. Wir nutzen in der Folge immer wieder die Okabe-Ito Farbpalette aus dem R Paket <span class="in">`{see}`</span>. Die Okabe-Ito Farbpalette ist speziell so gebaut, dass die Farben sich gut für farbenblinde Personen unterscheiden. Mehr zum R Paket <span class="in">`{see}`</span> auf der <span class="co">[</span><span class="ot">Hilfeseite des Paketes</span><span class="co">](https://easystats.github.io/see/index.html)</span>. Der Kontrast zwischen den Farben ist sehr gut. Wenn du eine andere Farbpalette nutzen willst, findest du hier noch andere <span class="co">[</span><span class="ot">Color Scales</span><span class="co">](https://easystats.github.io/see/articles/seecolorscales.html)</span>.</span>
<span id="cb123-431"><a href="#cb123-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-434"><a href="#cb123-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-435"><a href="#cb123-435" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-436"><a href="#cb123-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-437"><a href="#cb123-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-438"><a href="#cb123-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-labels-see-0</span></span>
<span id="cb123-439"><a href="#cb123-439" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-440"><a href="#cb123-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb123-441"><a href="#cb123-441" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb123-442"><a href="#cb123-442" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafte Abbildung der Okabe-Ito Farbpalette für Boxplots. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb123-443"><a href="#cb123-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-444"><a href="#cb123-444" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb123-445"><a href="#cb123-445" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb123-446"><a href="#cb123-446" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> animal)) <span class="sc">+</span></span>
<span id="cb123-447"><a href="#cb123-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb123-448"><a href="#cb123-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb123-449"><a href="#cb123-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb123-450"><a href="#cb123-450" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-451"><a href="#cb123-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-454"><a href="#cb123-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-455"><a href="#cb123-455" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-456"><a href="#cb123-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-457"><a href="#cb123-457" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-458"><a href="#cb123-458" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-labels-see-1</span></span>
<span id="cb123-459"><a href="#cb123-459" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-460"><a href="#cb123-460" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb123-461"><a href="#cb123-461" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb123-462"><a href="#cb123-462" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafte Abbildung der Okabe-Ito Farbpalette für Punkte. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb123-463"><a href="#cb123-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-464"><a href="#cb123-464" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb123-465"><a href="#cb123-465" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb123-466"><a href="#cb123-466" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> animal)) <span class="sc">+</span></span>
<span id="cb123-467"><a href="#cb123-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb123-468"><a href="#cb123-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb123-469"><a href="#cb123-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb123-470"><a href="#cb123-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-471"><a href="#cb123-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-472"><a href="#cb123-472" aria-hidden="true" tabindex="-1"></a>Das Ganze geht dann auch händisch mit dem folgenden Code für die <span class="co">[</span><span class="ot">jeweiligen Farben</span><span class="co">]</span>(http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/#a-colorblind-friendly-palette). Anbei einmal die Farbpalette dargestellt.</span>
<span id="cb123-473"><a href="#cb123-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-476"><a href="#cb123-476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-477"><a href="#cb123-477" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-478"><a href="#cb123-478" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb123-479"><a href="#cb123-479" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-480"><a href="#cb123-480" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-okabeito</span></span>
<span id="cb123-481"><a href="#cb123-481" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-482"><a href="#cb123-482" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 0.75</span></span>
<span id="cb123-483"><a href="#cb123-483" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb123-484"><a href="#cb123-484" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Farbpalette nach dem Okabe-Ito-Schema ebenfalls für farbblinde Personen erstellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb123-485"><a href="#cb123-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-486"><a href="#cb123-486" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb123-487"><a href="#cb123-487" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb123-488"><a href="#cb123-488" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fl">0.5</span>,</span>
<span id="cb123-489"><a href="#cb123-489" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb123-490"><a href="#cb123-490" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb123-491"><a href="#cb123-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-492"><a href="#cb123-492" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb123-493"><a href="#cb123-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> z), <span class="at">colour =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb123-494"><a href="#cb123-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>() <span class="sc">+</span></span>
<span id="cb123-495"><a href="#cb123-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb123-496"><a href="#cb123-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb123-497"><a href="#cb123-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-498"><a href="#cb123-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-499"><a href="#cb123-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-500"><a href="#cb123-500" aria-hidden="true" tabindex="-1"></a>Die Farben sind dann in der Reihenfolge wie folgt kodiert.</span>
<span id="cb123-501"><a href="#cb123-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-504"><a href="#cb123-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-505"><a href="#cb123-505" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-506"><a href="#cb123-506" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-507"><a href="#cb123-507" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-508"><a href="#cb123-508" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb123-509"><a href="#cb123-509" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb123-510"><a href="#cb123-510" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, </span>
<span id="cb123-511"><a href="#cb123-511" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#CC79A7"</span>, <span class="st">"#999999"</span>, <span class="st">"#000000"</span>)</span>
<span id="cb123-512"><a href="#cb123-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-513"><a href="#cb123-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-514"><a href="#cb123-514" aria-hidden="true" tabindex="-1"></a>Wenn wir Boxplots einfärben wollen dann nehmen wir den folgenden Code.</span>
<span id="cb123-515"><a href="#cb123-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-518"><a href="#cb123-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-519"><a href="#cb123-519" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-520"><a href="#cb123-520" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-521"><a href="#cb123-521" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-522"><a href="#cb123-522" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb123-523"><a href="#cb123-523" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cbPalette)</span>
<span id="cb123-524"><a href="#cb123-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-525"><a href="#cb123-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-526"><a href="#cb123-526" aria-hidden="true" tabindex="-1"></a>Und das hier ist die Ergänzung für Punkte und Linien.</span>
<span id="cb123-527"><a href="#cb123-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-530"><a href="#cb123-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-531"><a href="#cb123-531" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-532"><a href="#cb123-532" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-533"><a href="#cb123-533" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-534"><a href="#cb123-534" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb123-535"><a href="#cb123-535" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_colour_manual</span>(<span class="at">values =</span> cbPalette)</span>
<span id="cb123-536"><a href="#cb123-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-537"><a href="#cb123-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-538"><a href="#cb123-538" aria-hidden="true" tabindex="-1"></a>Neben der Okabe-Ito Farbpalette liefert das <span class="co">[</span><span class="ot">R Paket `{duke}`</span><span class="co">](https://cran.r-project.org/web/packages/duke/vignettes/duke.html)</span> noch eine andere Möglichkeit eine Farbpalette für Farbblinde zu generieren.</span>
<span id="cb123-539"><a href="#cb123-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-542"><a href="#cb123-542" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-543"><a href="#cb123-543" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-544"><a href="#cb123-544" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb123-545"><a href="#cb123-545" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-546"><a href="#cb123-546" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ggplot-duke</span></span>
<span id="cb123-547"><a href="#cb123-547" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-548"><a href="#cb123-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 0.75</span></span>
<span id="cb123-549"><a href="#cb123-549" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb123-550"><a href="#cb123-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Farbpalette nach dem Duke-Schema ebenfalls für farbblinde Personen erstellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb123-551"><a href="#cb123-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-552"><a href="#cb123-552" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb123-553"><a href="#cb123-553" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb123-554"><a href="#cb123-554" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fl">0.5</span>,</span>
<span id="cb123-555"><a href="#cb123-555" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb123-556"><a href="#cb123-556" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb123-557"><a href="#cb123-557" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb123-558"><a href="#cb123-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> z), <span class="at">colour =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb123-559"><a href="#cb123-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_duke_fill_discrete</span>() <span class="sc">+</span></span>
<span id="cb123-560"><a href="#cb123-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb123-561"><a href="#cb123-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb123-562"><a href="#cb123-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-563"><a href="#cb123-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-564"><a href="#cb123-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-565"><a href="#cb123-565" aria-hidden="true" tabindex="-1"></a>Die Farben sind dann in der Reihenfolge wie folgt kodiert.</span>
<span id="cb123-566"><a href="#cb123-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-569"><a href="#cb123-569" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-570"><a href="#cb123-570" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-571"><a href="#cb123-571" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-572"><a href="#cb123-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-573"><a href="#cb123-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb123-574"><a href="#cb123-574" aria-hidden="true" tabindex="-1"></a>dukePalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#012169"</span>, <span class="st">"#C84E00"</span>, <span class="st">"#00539B"</span>, <span class="st">"#339898"</span>, </span>
<span id="cb123-575"><a href="#cb123-575" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"#A1B70D"</span>, <span class="st">"#E89923"</span>, <span class="st">"#FFD960"</span>, <span class="st">"#262626"</span>)</span>
<span id="cb123-576"><a href="#cb123-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-577"><a href="#cb123-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-578"><a href="#cb123-578" aria-hidden="true" tabindex="-1"></a>Die Funktionen hier sind <span class="in">`scale_duke_color_discrete()`</span> sowie <span class="in">`scale_duke_continuous()`</span> und <span class="in">`scale_duke_fill_discrete()`</span>.</span>
<span id="cb123-579"><a href="#cb123-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-580"><a href="#cb123-580" aria-hidden="true" tabindex="-1"></a>Manchmal benötigen wir auch Farbverläufe. In R heißen diese Farbverläufe dann Farbpaletten. Eine Einführung liefert das Tutorium <span class="co">[</span><span class="ot">Using RColorBrewer palettes</span><span class="co">](http://www.sthda.com/english/wiki/colors-in-r#using-rcolorbrewer-palettes)</span>. Ich selber nutze gerne das R Paket <span class="in">`{wesanderson}`</span> welches sehr schöne Farbverläufe hat. Mehr kannst du auf der GitHub Seite <span class="co">[</span><span class="ot">Wes Anderson Palettes</span><span class="co">](https://github.com/karthik/wesanderson)</span> erfahren. Wir können die Paletten ganz einfach mit der Funktion <span class="in">`wes_palette()`</span> laden.</span>
<span id="cb123-581"><a href="#cb123-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-584"><a href="#cb123-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-585"><a href="#cb123-585" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 0.75</span></span>
<span id="cb123-586"><a href="#cb123-586" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb123-587"><a href="#cb123-587" aria-hidden="true" tabindex="-1"></a><span class="fu">wes_palette</span>(<span class="st">"Zissou1"</span>)</span>
<span id="cb123-588"><a href="#cb123-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-589"><a href="#cb123-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-590"><a href="#cb123-590" aria-hidden="true" tabindex="-1"></a>Das schöne ist hier, dass wir einfach wie folgt Farbverläufe erstellen können. Wir wollen hier 21 Farbwerte haben und das Ganze dann als kontinuierlichen Verlauf.</span>
<span id="cb123-591"><a href="#cb123-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-594"><a href="#cb123-594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-595"><a href="#cb123-595" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 0.75</span></span>
<span id="cb123-596"><a href="#cb123-596" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb123-597"><a href="#cb123-597" aria-hidden="true" tabindex="-1"></a><span class="fu">wes_palette</span>(<span class="st">"Zissou1"</span>, <span class="dv">21</span>, <span class="at">type =</span> <span class="st">"continuous"</span>)</span>
<span id="cb123-598"><a href="#cb123-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-599"><a href="#cb123-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-600"><a href="#cb123-600" aria-hidden="true" tabindex="-1"></a><span class="fu">### Abbildungen nebeneinander</span></span>
<span id="cb123-601"><a href="#cb123-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-602"><a href="#cb123-602" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="minimal"}</span>
<span id="cb123-603"><a href="#cb123-603" aria-hidden="true" tabindex="-1"></a>Besuche auch <span class="co">[</span><span class="ot">ggplot2 extensions</span><span class="co">](https://exts.ggplot2.tidyverse.org/gallery/)</span> für weitere tolle Möglichkeiten!</span>
<span id="cb123-604"><a href="#cb123-604" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-605"><a href="#cb123-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-606"><a href="#cb123-606" aria-hidden="true" tabindex="-1"></a>Das <span class="co">[</span><span class="ot">R Paket `{patchwork}`</span><span class="co">](https://patchwork.data-imaginist.com/articles/patchwork.html)</span> erlaubt es mehrere <span class="in">`ggplot`</span> Abbildungen nebeneinander oder in einem beliebigen Layout miteinander zu verbinden. Das tolle ist, dass die Idee sehr intuitiv ist. Wir nutzen wieder das <span class="in">`+`</span> um verschiedene Plots miteinander zu verbinden. Im Folgenden erschaffen wir uns zwei <span class="in">`ggplots`</span> und speichern die Plots in den Objekten <span class="in">`p1`</span> und <span class="in">`p2`</span>. Das ist wie wir es bisher kennen, nur das jetzt keine Abbildung erscheint sondern beide Plots in zwei Objekten gespeichert sind.</span>
<span id="cb123-607"><a href="#cb123-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-610"><a href="#cb123-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-611"><a href="#cb123-611" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-612"><a href="#cb123-612" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-613"><a href="#cb123-613" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-614"><a href="#cb123-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-615"><a href="#cb123-615" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb123-616"><a href="#cb123-616" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> flea_count, <span class="at">y =</span> jump_length,</span>
<span id="cb123-617"><a href="#cb123-617" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> animal)) <span class="sc">+</span></span>
<span id="cb123-618"><a href="#cb123-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb123-619"><a href="#cb123-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb123-620"><a href="#cb123-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb123-621"><a href="#cb123-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-622"><a href="#cb123-622" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> flea_dog_cat_tbl, </span>
<span id="cb123-623"><a href="#cb123-623" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> jump_length,</span>
<span id="cb123-624"><a href="#cb123-624" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> animal)) <span class="sc">+</span></span>
<span id="cb123-625"><a href="#cb123-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb123-626"><a href="#cb123-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb123-627"><a href="#cb123-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb123-628"><a href="#cb123-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-629"><a href="#cb123-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-630"><a href="#cb123-630" aria-hidden="true" tabindex="-1"></a>Wie können wir nun die beiden Abbildungen nebeneinander zeichnen? Wir nutzen einfach das <span class="in">`+`</span> Symbol.</span>
<span id="cb123-631"><a href="#cb123-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-634"><a href="#cb123-634" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-635"><a href="#cb123-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-636"><a href="#cb123-636" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-637"><a href="#cb123-637" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-638"><a href="#cb123-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb123-639"><a href="#cb123-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-labels-patchwork-1</span></span>
<span id="cb123-640"><a href="#cb123-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-641"><a href="#cb123-641" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb123-642"><a href="#cb123-642" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb123-643"><a href="#cb123-643" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafte Abbildung der zweier Plots nebeneinander. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb123-644"><a href="#cb123-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-645"><a href="#cb123-645" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span>
<span id="cb123-646"><a href="#cb123-646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-647"><a href="#cb123-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-648"><a href="#cb123-648" aria-hidden="true" tabindex="-1"></a>Auf der Seite des <span class="co">[</span><span class="ot">R Paket `{patchwork}`</span><span class="co">](https://patchwork.data-imaginist.com/articles/patchwork.html)</span> findest du viel mehr Möglichkeiten das Layout anzupassen und auch die einzelnen <span class="co">[</span><span class="ot">Subplots zu beschriften</span><span class="co">](https://patchwork.data-imaginist.com/articles/guides/annotation.html)</span>.</span>
<span id="cb123-649"><a href="#cb123-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-650"><a href="#cb123-650" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gebrochene $y$-Achse</span></span>
<span id="cb123-651"><a href="#cb123-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-652"><a href="#cb123-652" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip appearance="minimal"}</span>
<span id="cb123-653"><a href="#cb123-653" aria-hidden="true" tabindex="-1"></a>Besuche auch <span class="co">[</span><span class="ot">ggplot2 extensions</span><span class="co">](https://exts.ggplot2.tidyverse.org/gallery/)</span> für weitere tolle Möglichkeiten!</span>
<span id="cb123-654"><a href="#cb123-654" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb123-655"><a href="#cb123-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-656"><a href="#cb123-656" aria-hidden="true" tabindex="-1"></a>Das <span class="co">[</span><span class="ot">R Paket `{ggbreak}`</span><span class="co">](https://cran.r-project.org/web/packages/ggbreak/vignettes/ggbreak.html)</span> erlaubt es dir in die $x$-Achse oder aber $y$-Achse Lücken einzusetzen oder aber die Achsen eben gebrochen darzustellen. Zur Demonstration bauen wir uns nochmal den <span class="in">`stat_tbl`</span> für die Hunde- und Katzenflöhe. Wir berechnen hier dann die Mittelwerte und nicht mehr die Standardabweichung, da es sonst nicht so gut mit der Darstellung mit der gebrochenen $y$-Achse für dieses Beispiel klappt.</span>
<span id="cb123-657"><a href="#cb123-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-660"><a href="#cb123-660" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-661"><a href="#cb123-661" aria-hidden="true" tabindex="-1"></a>stat_tbl <span class="ot">&lt;-</span> flea_dog_cat_tbl <span class="sc">|&gt;</span> </span>
<span id="cb123-662"><a href="#cb123-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(animal) <span class="sc">|&gt;</span> </span>
<span id="cb123-663"><a href="#cb123-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(jump_length))</span>
<span id="cb123-664"><a href="#cb123-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-665"><a href="#cb123-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-666"><a href="#cb123-666" aria-hidden="true" tabindex="-1"></a>In der @fig-labels-ggbreak-1 siehst du einmal die Abbildung der Mittelwerte der Sprungweiten der Hunde- und Katzenflöhe als Barplots dargestellt. Ich habe hier einen Bruch auf der $y$-Achse mit der Funktion <span class="in">`scale_y_break()`</span> bei 1 bis 4 eingefügt und den Abstand über die Option <span class="in">`space`</span> etwas visuell vergrößert. Mit der Option <span class="in">`scales`</span> könntest du dann noch die Skalierung der gebrochenen $y$-Achse anpassen.</span>
<span id="cb123-667"><a href="#cb123-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-670"><a href="#cb123-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb123-671"><a href="#cb123-671" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb123-672"><a href="#cb123-672" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb123-673"><a href="#cb123-673" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb123-674"><a href="#cb123-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb123-675"><a href="#cb123-675" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-labels-ggbreak-1</span></span>
<span id="cb123-676"><a href="#cb123-676" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb123-677"><a href="#cb123-677" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb123-678"><a href="#cb123-678" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb123-679"><a href="#cb123-679" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Beispielhafte Abbildung der Barplots mit gebrochener $y$-Achse. Die Fehlerbalken wurden aus Gründen der besseren Darstellung der zerbrochenen $y$-Achse entfernt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb123-680"><a href="#cb123-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-681"><a href="#cb123-681" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stat_tbl, <span class="fu">aes</span>(<span class="at">x =</span> animal, <span class="at">y =</span> mean, <span class="at">fill =</span> animal)) <span class="sc">+</span> </span>
<span id="cb123-682"><a href="#cb123-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb123-683"><a href="#cb123-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb123-684"><a href="#cb123-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_break</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>), <span class="at">space =</span> <span class="fl">0.5</span>)</span>
<span id="cb123-685"><a href="#cb123-685" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb123-686"><a href="#cb123-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-687"><a href="#cb123-687" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/eda-ggplot.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/eda-ggplot.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","loop":false,"descPosition":"bottom","openEffect":"zoom","closeEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>
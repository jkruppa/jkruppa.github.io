```{r echo = FALSE}
pacman::p_load(tidyverse, readxl, knitr, kableExtra)
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
```

# Transformieren von Daten

![](images/caution.png){fig-align="center" width="50%"}

::: column-margin
Ich verweise hier auch nochmal auf das tolle Tutorial von Matus Seci auf dem [Coding Club](https://ourcodingclub.github.io/tutorials/data-scaling/)
:::

## Genutzte R Pakete für das Kapitel

Wir wollen folgende R Pakete in diesem Kapitel nutzen.

```{r echo = TRUE}
#| message: false
pacman::p_load(tidyverse, magrittr, conflicted, caret)
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")

```

Am Ende des Kapitels findest du nochmal den gesamten R Code in einem Rutsch zum selber durchführen oder aber kopieren.

## Daten

```{r}
#| message: false

data_tbl <- read_csv2("data/flea_dog_cat_length_weight.csv") %>%
  select(jump_length, hatch_time)
```

## $log$-Transformation

```{r}

log_tbl <- data_tbl %>% 
  mutate(log_hatch_time = log(hatch_time))

```

```{r}
#| message: false
#| echo: false
#| label: fig-log-scale-1
#| fig-align: center
#| fig-height: 5
#| fig-width: 5
#| fig-cap: "Darstellung von keiner Interaktion, leichter bis mittler Interaktion und starker Interaktion in einer zweifaktoriellen ANOVA mit einem Faktor mit drei Leveln A, B und C sowie einem Faktor mit zwei Leveln (rot und blau)."
#| fig-subcap: 
#|   - "Keine Interaktion"
#|   - "Leichte bis mittlere Intraktion"
#| layout-nrow: 1
#| column: page

ggplot(log_tbl, aes(hatch_time)) +
  geom_histogram(fill = cbbPalette[2], color = "black") +
  theme_bw()

ggplot(log_tbl, aes(log_hatch_time)) +
  geom_histogram(fill = cbbPalette[3], color = "black") +
  theme_bw()

```

## Wurzel-Transformation

```{r}

sqrt_tbl <- data_tbl %>% 
  mutate(sqrt_hatch_time = sqrt(hatch_time))

```

```{r}
#| message: false
#| echo: false
#| label: fig-log-scale-2
#| fig-align: center
#| fig-height: 5
#| fig-width: 5
#| fig-cap: "Darstellung von keiner Interaktion, leichter bis mittler Interaktion und starker Interaktion in einer zweifaktoriellen ANOVA mit einem Faktor mit drei Leveln A, B und C sowie einem Faktor mit zwei Leveln (rot und blau)."
#| fig-subcap: 
#|   - "Keine Interaktion"
#|   - "Leichte bis mittlere Intraktion"
#| layout-nrow: 1
#| column: page

ggplot(sqrt_tbl, aes(hatch_time)) +
  geom_histogram(fill = cbbPalette[2], color = "black") +
  theme_bw()

ggplot(sqrt_tbl, aes(sqrt_hatch_time)) +
  geom_histogram(fill = cbbPalette[3], color = "black") +
  theme_bw()
```

## Standardisierung

Die Standardisierung wird auch $z$-Transformation genannt.

$$
y_z = \cfrac{y_i - \bar{y}}{s_y} 
$$

```{r}
scale_tbl <- data_tbl %>% 
  mutate(scale_jump_length = scale(jump_length))
```

```{r}
#| message: false
#| echo: false
#| label: fig-log-scale-3
#| fig-align: center
#| fig-height: 5
#| fig-width: 5
#| fig-cap: "Darstellung von keiner Interaktion, leichter bis mittler Interaktion und starker Interaktion in einer zweifaktoriellen ANOVA mit einem Faktor mit drei Leveln A, B und C sowie einem Faktor mit zwei Leveln (rot und blau)."
#| fig-subcap: 
#|   - "Keine Interaktion"
#|   - "Leichte bis mittlere Intraktion"
#| layout-nrow: 1
#| column: page

ggplot(scale_tbl, aes(jump_length)) +
  geom_histogram(fill = cbbPalette[2], color = "black") +
  theme_bw()

ggplot(scale_tbl, aes(scale_jump_length)) +
  geom_histogram(fill = cbbPalette[3], color = "black") +
  theme_bw()

```

## Normalisierung

$$
y_z = \cfrac{y_i - \min(y)}{\max(y) - \min(y)} 
$$

```{r}

norm_tbl <- data_tbl %>% 
  mutate(norm_jump_length = (jump_length - min(jump_length))/(max(jump_length) - min(jump_length)))

```

```{r}
#| message: false
#| echo: false
#| label: fig-log-scale-4
#| fig-align: center
#| fig-height: 5
#| fig-width: 5
#| fig-cap: "Darstellung von keiner Interaktion, leichter bis mittler Interaktion und starker Interaktion in einer zweifaktoriellen ANOVA mit einem Faktor mit drei Leveln A, B und C sowie einem Faktor mit zwei Leveln (rot und blau)."
#| fig-subcap: 
#|   - "Keine Interaktion"
#|   - "Leichte bis mittlere Intraktion"
#| layout-nrow: 1
#| column: page

ggplot(norm_tbl, aes(jump_length)) +
  geom_histogram(fill = cbbPalette[2], color = "black") +
  theme_bw()

ggplot(norm_tbl, aes(norm_jump_length)) +
  geom_histogram(fill = cbbPalette[3], color = "black") +
  theme_bw()

```

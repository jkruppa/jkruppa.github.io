```{r echo = FALSE}
pacman::p_load(tidyverse, readxl, knitr, kableExtra, patchwork)
```

# Gaussian lineare Regression {#sec-gaussian}

*Version vom `r format(Sys.time(), '%B %d, %Y um %H:%M:%S')`*

![](images/caution.png){fig-align="center" width="50%"}

## Genutzte R Pakete f체r das Kapitel

Wir wollen folgende R Pakete in diesem Kapitel nutzen.

```{r echo = TRUE}
#| message: false
pacman::p_load(tidyverse, magrittr, conflicted, broom,
               see, performance, emmeans, multcomp, scales,
               parameters)
conflict_prefer("select", "dplyr")
conflict_prefer("filter", "dplyr")
conflict_prefer("mutate", "dplyr")
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
```

Am Ende des Kapitels findest du nochmal den gesamten R Code in einem Rutsch zum selber durchf체hren oder aber kopieren.

## Daten

Wir wollen uns erstmal mit

```{r}
#| message: false

chickpea_tbl <- read_excel("data/chickpeas.xlsx") 

```

In der @tbl-gaussian-chickpea ist der Datensatz `gaussian_tbl` nochmal dargestellt.

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: tbl-gaussian-chickpea
#| tbl-cap: Auszug aus dem Daten zu den Kichererbsen in Brandenburg.
#| column: page


chickpea_tbl <- read_excel("data/chickpeas.xlsx") 

rbind(head(chickpea_tbl),
      rep("...", times = ncol(chickpea_tbl)),
      tail(chickpea_tbl)) %>% 
  kable(align = "c", "pipe")

```

## Fit des Modells

```{r}
gaussian_fit <- lm(dryweight ~ temp + rained + location + no3 + fe + sand + forest, data = chickpea_tbl)

gaussian_fit %>% model_parameters()

```

## Performance des Modells

```{r}
r2(gaussian_fit)
```

```{r}
check_heteroscedasticity(gaussian_fit)
```

```{r}
#| echo: true
#| message: false
#| label: fig-normal-model-check
#| fig-align: center
#| fig-height: 8
#| fig-width: 8
#| fig-cap: "Ausgabe ausgew채hlter Modelg체teplots der Funktion `check_model()`."

check_model(gaussian_fit, colors = cbbPalette[6:8], check = c("qq", "outliers", "pp_check", "homogeneity")) 

```

## Interpretation des Modells

```{r}
gaussian_fit %>% 
  tidy %>% 
  mutate(p.value = pvalue(p.value))
```

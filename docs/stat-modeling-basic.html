<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>45&nbsp; Multiple lineare Regression – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-linear-reg-quality.html" rel="next">
<link href="./stat-linear-reg-basic.html" rel="prev">
<link href="./cover2026_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="45&nbsp; Multiple lineare Regression – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2026.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-linear-reg-preface.html">Grundlagen des Modellierens</a></li><li class="breadcrumb-item"><a href="./stat-modeling-basic.html"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>{purrr}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Ein <code>{ggplot}</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der U-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Chi-Quadrat-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-marginal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Marginal effect models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">80</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">81</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./construction-zone.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">82</span>&nbsp; <span class="chapter-title">Baustelle</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#allgemeiner-hintergrund" id="toc-allgemeiner-hintergrund" class="nav-link active" data-scroll-target="#allgemeiner-hintergrund"><span class="header-section-number">45.1</span> Allgemeiner Hintergrund</a></li>
  <li><a href="#theoretischer-hintergrund" id="toc-theoretischer-hintergrund" class="nav-link" data-scroll-target="#theoretischer-hintergrund"><span class="header-section-number">45.2</span> Theoretischer Hintergrund</a></li>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">45.3</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">45.4</span> Daten</a></li>
  <li><a href="#kausales-modell" id="toc-kausales-modell" class="nav-link" data-scroll-target="#kausales-modell"><span class="header-section-number">45.5</span> Kausales Modell</a>
  <ul class="collapse">
  <li><a href="#mehrkovariates-modell" id="toc-mehrkovariates-modell" class="nav-link" data-scroll-target="#mehrkovariates-modell"><span class="header-section-number">45.5.1</span> Mehrkovariates Modell</a></li>
  <li><a href="#mehrfaktorielles-modell" id="toc-mehrfaktorielles-modell" class="nav-link" data-scroll-target="#mehrfaktorielles-modell"><span class="header-section-number">45.5.2</span> Mehrfaktorielles Modell</a></li>
  <li><a href="#kombinierte-modelle" id="toc-kombinierte-modelle" class="nav-link" data-scroll-target="#kombinierte-modelle"><span class="header-section-number">45.5.3</span> Kombinierte Modelle</a></li>
  </ul></li>
  <li><a href="#prädiktives-modell" id="toc-prädiktives-modell" class="nav-link" data-scroll-target="#prädiktives-modell"><span class="header-section-number">45.6</span> Prädiktives Modell</a></li>
  <li><a href="#weiteres-von-interesse" id="toc-weiteres-von-interesse" class="nav-link" data-scroll-target="#weiteres-von-interesse"><span class="header-section-number">45.7</span> Weiteres von Interesse</a>
  <ul class="collapse">
  <li><a href="#einheit-der-kovariaten" id="toc-einheit-der-kovariaten" class="nav-link" data-scroll-target="#einheit-der-kovariaten"><span class="header-section-number">45.7.1</span> Einheit der Kovariaten</a></li>
  <li><a href="#sec-confounder" id="toc-sec-confounder" class="nav-link" data-scroll-target="#sec-confounder"><span class="header-section-number">45.7.2</span> Adjustierung für Confounder</a></li>
  <li><a href="#korrelation-der-kovariaten" id="toc-korrelation-der-kovariaten" class="nav-link" data-scroll-target="#korrelation-der-kovariaten"><span class="header-section-number">45.7.3</span> Korrelation der Kovariaten</a></li>
  <li><a href="#sec-vif" id="toc-sec-vif" class="nav-link" data-scroll-target="#sec-vif"><span class="header-section-number">45.7.4</span> Variance inflation factor (VIF)</a></li>
  <li><a href="#sec-model-basic-compare" id="toc-sec-model-basic-compare" class="nav-link" data-scroll-target="#sec-model-basic-compare"><span class="header-section-number">45.7.5</span> Vergleich von Modellen</a></li>
  </ul></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-basic.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-basic.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-linear-reg-preface.html">Grundlagen des Modellierens</a></li><li class="breadcrumb-item"><a href="./stat-modeling-basic.html"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-mult-reg-basic" class="quarto-section-identifier"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 06. August 2025 um 13:42:41</em></p>
<blockquote class="blockquote">
<p><em>“All models are approximations. Essentially, all models are wrong, but some are useful. However, the approximate nature of the model must always be borne in mind.” — George E. P. Box</em></p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/caution.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/caution.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
<div class="callout callout-style-simple callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stand des Kapitels: Konstruktion (seit 07.2025)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dieses Kapitel wird in den nächsten Wochen geschrieben und ist damit meine aktuelle Großbaustelle. Ich plane zum Beginn des WiSe 2025/26 eine fertige Version des Kapitels erstellt zu haben. Während das Kapitel entsteht, funktioniert so manches dann nicht so wie es soll. Bitte daher hier dann abwarten.</p>
</div>
</div>
<p>In diesem Kapitel geht es um die multiple lineare Regression. Der große Unterschied zu der simplen linearen Regression ist, dass wir in der multiplen Regression mehr als eine Einflussvariable vorliegen haben. Damit wird unser Modell um einiges komplexer. Hier gibt es jetzt gewisse Überschneidungen mit den <a href="stat-modeling-marginal.html">Marginal effect models</a>, die im Prinzip die Erweiterung der multiplen Regression sind. Wir können mit den <em>Marginal effect models</em> eben dann doch etwas anders lineare und nicht linare Regressionen interpretieren. Damit kannst du in dem Kapitel dann mehr über eine alternative Art der Interpretation von multiplen Modellen lernen. Ebenso gehe nicht hier so stark auf das <a href="stat-modeling-R.html">Modellieren in R</a> ein. Hier kannst du dann in dem entsprechenden Kapitel auch nochmal mehr lesen. Hier zeige ich dann die Basisanwendungen. Am Ende habe ich mich auch entschieden hier nur einen normalverteilten Messwert zu betrachten. Sonst wird es einfach viel zu komplex, wenn wir hier noch andere Verteilungen berücksichtigen. Dazu dann mehr in den entsprechenden <a href="https://jkruppa.github.io/stat-modeling-preface.html">Kapiteln zur statistischen Modellierung</a>.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/personal_opinion.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="images/personal_opinion.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>“In den folgenden Kapiteln gibt es immer mal wieder Redundanzen. Teilweise sind diese Redundanzen gewollt, denn eine gute Widerholung hilft ja immer. Meistens habe ich aber den Überblick verloren und fand, dass das Thema dann an der Stelle doch nochmal gut reinpasste. Ist so passiert.” — Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.</em></p>
</blockquote>
</div>
</div>
</div>
<section id="allgemeiner-hintergrund" class="level2" data-number="45.1">
<h2 data-number="45.1" class="anchored" data-anchor-id="allgemeiner-hintergrund"><span class="header-section-number">45.1</span> Allgemeiner Hintergrund</h2>
<blockquote class="blockquote">
<p><em>“This idea of ‘holding everything constant’ though can be tricky to wrap your head around.” — <a href="https://www.andrewheiss.com/blog/2022/05/20/marginalia/#regression-sliders-switches-and-mixing-boards">Andrew Heiss</a></em></p>
</blockquote>
<p>Wenn wir über die multiple lineare Regression sprechen, dann sprechen wir immer über mehr als eine Einflussvariable. Dadurch können wir den Fall haben, dass wir nicht nur eine Kovariate sondern mehrere Kovariaten in einem Modell vorliegen haben. Zum Beispiel wollen wir wissen, ob die Sprungweite von dem Gewicht der Flöhe oder der Anzahl an Beinhaaren abhängt. Wir haben hier also mehrere kontinuierliche Einflussvariablen vorliegen. Ebenso können wir den Fall haben, dass uns nur kategoriale Einflussvariablen interessieren. Hat die Ernährungsform oder aber der Entwicklungsstand einen Einfluss auf die Sprungweite der Flöhe. Klassischerweise wären wir hier zwar auf dem ANOVA Pfad eines faktoriellen Experiments, aber wir können natürlich die Koeffzienten eines mehfaktoriellen Modells in der Form einer multiplen Regression interpretieren. Wenn wir dann keinen normalverteilten Messwert haben, dann bietet sich natürlich dennoch die multiple Regression als eine Analyseform an. Abschließend können wir natürlich auch kombinierte Modelle vorliegen haben. Wir haben also in unseren multiple Modell nicht nur Kovariaten oder Faktoren sondern eben eine Mischung aus beiden Formen. Das führt dann zu einer noch komplexeren Interpretation. Alle Fälle wollen wir uns hier in diesem Kapitel einmal an einem normalverteilten Messwert anschauen.</p>
<section id="sprachlicher-hintergrund" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="sprachlicher-hintergrund">Sprachlicher Hintergrund</h4>
<blockquote class="blockquote">
<p><em>“In statistics courses taught by statisticians we don’t use independent variable because we use independent on to mean stochastic independence. Instead we say predictor or covariate (either). And, similarly, we don’t say”dependent variable” either. We say response.” — <a href="https://www.reddit.com/r/AskStatistics/comments/qt1hvu/comment/hkigiks/?utm_source=share&amp;utm_medium=web3x&amp;utm_name=web3xcss&amp;utm_term=1&amp;utm_content=share_button">User berf auf r/AskStatistics</a></em></p>
</blockquote>
<p>Wenn wir uns mit dem statistischen Modellieren beschäftigen wollen, dann brauchen wir auch Worte um über das Thema reden zu können. Statistik wird in vielen Bereichen der Wissenschaft verwendet und in jedem Bereich nennen wir dann auch Dinge anders, die eigentlich gleich sind. Daher werde ich mir es hier herausnehmen und auch die Dinge so benennen, wie ich sie für didaktisch sinnvoll finde. Wir wollen hier was verstehen und lernen, somit brauchen wir auch eine klare Sprache.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[15,85]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 15.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/personal_opinion.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="images/personal_opinion.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 85.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>“Jeder nennt in der Statistik sein Y und X wie er möchte. Da ich hier nicht nur von Y und X schreiben will, führe ich eben die Worte ein, die ich nutzen will. Damit sind die Worte dann auch richtig, da der Kontext definiert ist. Andere mögen es dann anders machen. Ich mache es eben dann so. Danke.” — Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.</em></p>
</blockquote>
</div>
</div>
</div>
<p>In dem folgenden Kasten erkläre ich nochmal den Gebrauch meiner Begriffe im statistischen Testen. Es ist wichtig, dass wir hier uns klar verstehen. Zum einen ist es angenehmer auch mal ein Wort für ein Symbol zu schreiben. Auf der anderen Seite möchte ich aber auch, dass du dann das Wort richtig einem Konzept im statistischen Modellieren zuordnen kannst. Deshalb einmal hier meine persönliche und didaktische Zusammenstellung meiner Wort im statistischen Modellieren. Du kannst dann immer zu dem Kasten zurückgehen, wenn wir mal ein Wort nicht mehr ganz klar ist. Die fetten Begriffe sind die üblichen in den folgenden Kapiteln. Die anderen Worte werden immer mal wieder in der Literatur genutzt.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Worte und Bedeutungen im statistischen Modellieren
</div>
</div>
<div class="callout-body-container callout-body">
<blockquote class="blockquote">
<p><em>“Die Grenzen meiner Sprache bedeuten die Grenzen meiner Welt.” — Ludwig Wittgenstein</em></p>
</blockquote>
<p>Hier kommt einmal die Tabelle mit den wichtigsten Begriffen im statistischen Modellieren und wie ich die Worte benutzen werde. Damit wir uns verstehen und du was lernen kannst. In anderen Büchern und Quellen findest du teilweise die Worte in einem anderen Sinnzusammenhang. Das ist gut so dort. Bei mir ist es anders.</p>
<div id="tbl-namen-regression" class="quarto-float quarto-figure quarto-figure-center anchored" data-tbl-colwidths="14, 10, 38, 38">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-namen-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.1— Zusammenfassende Tabelle des Sprachgebrauchs in meinem statistischen Modellieren. Die <em>fett</em> hervorgehobenen Bezeichnungen werden hier genutzt. (<em>LHS</em> = left hand side, <em>RHS</em> = right hand side)
</figcaption>
<div aria-describedby="tbl-namen-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 38%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Symbol</th>
<th>Deutsch</th>
<th>Englisch</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>LHS</em></td>
<td style="text-align: center;"><span class="math inline">\(Y\)</span> / <span class="math inline">\(y\)</span></td>
<td><strong>Messwert</strong> / Endpunkt / Outcome / Abhängige Variable</td>
<td>response / outcome / endpoint / dependent variable</td>
</tr>
<tr class="even">
<td><em>RHS</em></td>
<td style="text-align: center;"><span class="math inline">\(X\)</span> / <span class="math inline">\(x\)</span></td>
<td><strong>Einflussvariable</strong> / Erklärende Variable / Fester Effekt / Unabhängige Variable</td>
<td>risk factor / explanatory / fixed effect / independent variable</td>
</tr>
<tr class="odd">
<td><em>RHS</em></td>
<td style="text-align: center;"><span class="math inline">\(Z\)</span> / <span class="math inline">\(z\)</span></td>
<td><strong>Zufälliger Effekt</strong></td>
<td>random effect</td>
</tr>
<tr class="even">
<td><span class="math inline">\(X\)</span> ist kontinuierlich</td>
<td style="text-align: center;"><span class="math inline">\(c_1\)</span></td>
<td><strong>Kovariate</strong> 1</td>
<td>covariate 1</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(X\)</span> ist kategorial</td>
<td style="text-align: center;"><span class="math inline">\(f_A\)</span></td>
<td><strong>Faktor</strong> <span class="math inline">\(A\)</span> mit Level <span class="math inline">\(A.1\)</span> bis <span class="math inline">\(A.j\)</span></td>
<td>factor <span class="math inline">\(A\)</span> with levels <span class="math inline">\(A.1\)</span> to <span class="math inline">\(A.j\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Am Ende möchte ich nochmal darauf hinweisen, dass wirklich häufig von der abhängigen Variable (eng. <em>dependent variable</em>) als Messwert und unabhängigen Variablen (eng. <em>independent variable</em>) für die Einflussvariablen gesprochen wird. Aus meiner Erfahrung bringt die Begriffe jeder ununterbrochen durcheinander. Deshalb einfach nicht diese Worte nutzen.</p>
<div id="fig-sprache-gif" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sprache-gif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling/dependent_independent.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;45.1— Am Ende läuft es dann doch auf sowas raus…"><img src="stat-modeling/dependent_independent.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sprache-gif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.1— Am Ende läuft es dann doch auf sowas raus…
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="wie-multiple-einflussvariablen-interpretieren" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="wie-multiple-einflussvariablen-interpretieren">Wie multiple Einflussvariablen interpretieren?</h4>
<p>Wie schon im Zitat am Anfang erwähnt, heißt die Regel, dass wir jeden Koeffizienten unseres Modell nur in soweit interpretieren können, wenn sich die anderen Einflussvariablen nicht ändern. Das klingt jetzt kryptisch und macht eigentlich nur Sinn, wenn man schon alles verstanden hat. Deshalb hier einmal die Analogie mit Schaltern und Schieberegelern. Wir können eine kategoriale Variable oder Faktor durch die Level durchschalten. Daher können wir uns den Effekt von weiblichen oder männlichen Flöhen anschauen. Es gibt aber nur diese beiden Möglichkeiten. Entweder steht der Schalter auf männlichen Floh oder aber auf weiblichen Floh. Etwas anderes ist es wenn wir uns eine Kovariate vorliegen haben. Eine kontinuierliche Einflussvariable können wir beliebig einstellen. Wir können das Gewicht eines Flohs eben hin und herschieben um einen Wert zu haben.</p>
<div id="fig-utest-intro-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-utest-intro-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/marginal/slider-switch-annotated-trans.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Abbildung&nbsp;45.2— Unterschied zwischen einer kategorialen Variable und einer kontinuierlichen Variable in einem statistischen Modell visualisiert als Schalter und Schieberegler. Übersetzt nach @heiss2022"><img src="images/marginal/slider-switch-annotated-trans.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-utest-intro-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.2— Unterschied zwischen einer kategorialen Variable und einer kontinuierlichen Variable in einem statistischen Modell visualisiert als Schalter und Schieberegler. Übersetzt nach <span class="citation" data-cites="heiss2022">Heiss (<a href="#ref-heiss2022" role="doc-biblioref">2022</a>)</span>
</figcaption>
</figure>
</div>
<p>In einer multiplen Regression kombinieren wir nun alles miteinander. Wir haben eben eine Art Mischpult vorliegen. Auf unserem Mischpult finden wir eben Schalter und Schieberegler. Wir haben dann auch in unserem Modell Faktoren und Kovariaten vorliegen. Dann können wir auch Schalter auf verschiedene Positionen setzen und die Regler verschieden einstellen.</p>
<div id="fig-utest-intro-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-utest-intro-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/marginal/mixer-board-annotated-trans.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Abbildung&nbsp;45.3— Kombination verschiedener kategorialer Variablen und kontinuierlichen Variablen in einem statistischen Modell visualisiert als Mischpult. Übersetzt nach @heiss2022"><img src="images/marginal/mixer-board-annotated-trans.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-utest-intro-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.3— Kombination verschiedener kategorialer Variablen und kontinuierlichen Variablen in einem statistischen Modell visualisiert als Mischpult. Übersetzt nach <span class="citation" data-cites="heiss2022">Heiss (<a href="#ref-heiss2022" role="doc-biblioref">2022</a>)</span>
</figcaption>
</figure>
</div>
<p>Worher kommt nun die Interpretation, dass wir eine Einflussvaribale nur interpretieren können, wenn wir den Rest der Einflussvariablen konstant halten? Wenn wir an dem Schieberegler des Gewichts der Flöhe drehen, dann müssen die anderen Schalter und Regler still stehen. Wir interpretieren dann eben das sich änderende Gewicht, <em>für weibliche Flöhe unter der Ernährung mit Ketchup</em>. Wir können nicht global das gesmate Modell interpretieren. Einen Ausweg bieten die <a href="stat-modeling-marginal.html">Marginal effect models</a>, aber diese werden wir in diesem Kapitel nur am Rande behandeln. Dafür ist das Thema zu komplex. Daher behalte ich Kopf, wenn wir später einzelne Einflussvariablen betrachten, dann tuen wir das immer im Kontext fixierter anderer Einflussvariablen.</p>
</section>
<section id="eine-frage-der-einheit" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="eine-frage-der-einheit">Eine Frage der Einheit!</h4>
<p>Die Einheit von den Messwerten oder auch Kovariaten hat einen nicht zu unterschätzenden Einfluss auf die Interpretation der Koeffizienten oder eben der Effekt einer multiplen linearen Modellierung. Da wir ja mehrere Einflussvariablen vorliegen haben bist du schnell dabei die Koeffizienten der Steigung untereinander zu vergleichen. Dann kommt man schnell zu einem Schluss der eventuell nicht wahr ist. Ich zeige dir hier einmal in der folgenden Abbildung den Fall, wo wir visuell die gleiche Steigung in den Daten vorliegen haben. Was sich aber in den beiden Abbildungen fundamental unterscheidet ist die Einheit der Kovariate.</p>
<div id="fig-corr-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-corr-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/corr_example_einheit.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Abbildung&nbsp;45.4— Der Zusammenhang von Hohlstrunk Boniturnote und Kopfgewicht sowie Strunkdurchmesser. In dem Beispiel ist gut der Zusammenhang zwischen der Steigung und der Einheit der Kovariate zu erkennen."><img src="images/corr_example_einheit.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-corr-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.4— Der Zusammenhang von Hohlstrunk Boniturnote und Kopfgewicht sowie Strunkdurchmesser. In dem Beispiel ist gut der Zusammenhang zwischen der Steigung und der Einheit der Kovariate zu erkennen.
</figcaption>
</figure>
</div>
<p>In der linken Abbildung ist der Koeffizient der Steigung des Kopfgewichts <span class="math inline">\(0.021\)</span> mehr mittlere Boniturnote pro Gramm Kopfgewicht. Das wirkt sehr klein. Im Gegensatz ist der Koeffizient der Steigung des Strunkdurchmessers <span class="math inline">\(5.15\)</span> mehr mittlere Boniturnoten pro Zentimeter Strunkdurchmesser. Es wirkt als hätte der Strunkdurchmesser einen viel größeren Effekt als das Gewicht auf die Boniturnoten. Das ist aber ein Trugschluss, wie wir dann gleich nochmal sehen werden. Ich zeige dir den Zusammenhang hier nochmal in der Tabelle.</p>
<div id="tbl-einheit" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-einheit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.2— Vergleich vom Kopfgewicht und dem Strunkdurchmesser nach Gradengleichung, Bestimmtheitsmaß und dem Faktor der Steigung für Strunkdurchmesser.
</figcaption>
<div aria-describedby="tbl-einheit-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 37%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th>Kopfgewicht [g]</th>
<th>Strunkdurchmesser [cm]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Gradengleichung</td>
<td><span class="math inline">\(y = 0.021 \cdot x - 8.42\)</span></td>
<td><span class="math inline">\(y = 5.15 \cdot x - 16.65\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Bestimmtheitsmaß</td>
<td><span class="math inline">\(R^2 = 0.74\)</span></td>
<td><span class="math inline">\(R^2 = 0.93\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Faktor Steigung</td>
<td><span class="math inline">\(\times1\)</span></td>
<td><span class="math inline">\(\times 245.24\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Wir würden jetzt meinen, dass der Effekt des Strunkdurchmessers 245mal größer ist als der des Kopfgewichts. Das ist aber ein Trugschluss! Wir haben die Einheiten nicht beachtet. Die Spannweite bei dem Kopfgewicht geht von etwas über 450 Gramm bis fast 750 Gramm. Daher ist die Steigerung um eine Einheit nur eine kleine Menge mehr an Boniturnote. Bei dem Strunkdurchmesser haben wir als kleinsten Wert 3.5cm und als höchsten Wert 5cm für die Grade. Erhöhen wir den Strunkdurchmesser um 1 Zentimeter durchlaufen wir fast die gesamte Spannweite. Wenn du für den Vergleich eine einheitslose Steigung brauchst, dann schaue nochmal in dem <a href="stat-linear-reg-corr.html">Kapitel zur Korrelation</a> vorbei oder weiter unten in dem entsprechenden Abschnitt zur Einheit.</p>
</section>
<section id="wie-verschiedene-modelle-darstellen" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="wie-verschiedene-modelle-darstellen">Wie verschiedene Modelle darstellen?</h4>
<p>Häufig stellt sich dann die Frage, wie so multiple Regressionsmodelle dargestellt werden können. Daher hier gleich einmal vorweg ein Beispiel für eine Darstellung einer multiplen linearen Regression in einer wissenschaftlichen Arbeit. In der Arbeit <a href="https://www.pnas.org/doi/10.1073/pnas.2420902122">Energy expenditure and obesity across the economic spectrum</a> von <span class="citation" data-cites="mcgrosky2025energy">McGrosky et al. (<a href="#ref-mcgrosky2025energy" role="doc-biblioref">2025</a>)</span> wird die multiple lineare Regression genutzt um den Zusammenhang von Energieaufnahme und dem Energieverbauch in veschiedenen Entwicklungsstufen von Ländern zu modellieren. Dabei kommt eigentlich ein recht spannendes Ergebnis heraus, wenn ich das einmal sehr kanpp zitieren darf. Es kommt eben mehr auf die Energieaufnahme als auf den Verbrauch an. Oder anders herum, wenn du abnehmen willst achte auf dein Essen und nicht so sehr auf deine Bewegung.</p>
<blockquote class="blockquote">
<p><em>“Our analyses suggest that increased energy intake has been roughly 10 times more important than declining total energy expenditure (TEE) in driving the modern obesity crisis.” — <span class="citation" data-cites="mcgrosky2025energy">McGrosky et al. (<a href="#ref-mcgrosky2025energy" role="doc-biblioref">2025</a>)</span></em></p>
</blockquote>
<p>In der folgenden Tabelle siehst du dann eimal das multiple lineare Modell mit dem prozentualen Körperfettanteil als Messwert. Es wurden dann acht verschiedene multiple Modelle gerechnet und in jedem Modell wurden andere Einflussvariablen aufgenommen. In der vorletzten Zeile findest du dann noch das Bestimmtheitsmaß <span class="math inline">\(R^2\)</span>, was dir angibt wie gut das Modell funktioniert hat. Hier wollen wir eigentlich einen Wert gegen Eins sehen, aber in Beobachtungsdaten wie hier, ist eine höhere Zahl erstmal eine bessere Zahl.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/mcgrosky2025energy.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Lineare Modelle für den Einfluss des Anteils ultraverarbeiteter Lebensmittel in der Ernährung (Anteil an der gesamten Kalorienaufnahme, %UPF) und des Fleischkonsums (kg pro Kopf) auf den Körperfettanteil. Signifikante Effekte (*p<0,05, **p<0,01, ***p<0,001) in Fettdruck, negative Effekte in Blau. Quelle: @mcgrosky2025energy"><img src="images/mcgrosky2025energy.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Lineare Modelle für den Einfluss des Anteils ultraverarbeiteter Lebensmittel in der Ernährung (Anteil an der gesamten Kalorienaufnahme, %UPF) und des Fleischkonsums (kg pro Kopf) auf den Körperfettanteil. Signifikante Effekte (*p<0,05, **p<0,01, ***p<0,001) in Fettdruck, negative Effekte in Blau. Quelle: McGrosky et al. (2025)"></a></p>
</figure>
</div>
<figcaption>Lineare Modelle für den Einfluss des Anteils ultraverarbeiteter Lebensmittel in der Ernährung (Anteil an der gesamten Kalorienaufnahme, %UPF) und des Fleischkonsums (kg pro Kopf) auf den Körperfettanteil. Signifikante Effekte (*p&lt;0,05, **p&lt;0,01, ***p&lt;0,001) in Fettdruck, negative Effekte in Blau. Quelle: <span class="citation" data-cites="mcgrosky2025energy">McGrosky et al. (<a href="#ref-mcgrosky2025energy" role="doc-biblioref">2025</a>)</span></figcaption>
</figure>
</div>
<p>Was sagt uns jetzt die Tabelle aus? Zuerst einmal rechnen wir hier acht Modelle in den Spalten der Tabelle, die wir dann untereinander vergleichen. Wir nehmen verschiedene Einflussvariablen mit in das Modell, die alle in den Zeilen stehen. Teilweise ist das bei kategorialen Variablen wie dem Geschlecht die Gruppe angegeben. Wie interpretieren wir nun diese Tabelle? Hier einmal ein Auszug zu dem Einfluss des Fleischkonsum (eng. <em>per capita meat consumption</em>) in den letzten drei Spalten auf den Messwert Körperfetrprozent.</p>
<blockquote class="blockquote">
<p><em>“[…], per capita meat consumption, another dietary change associated with development, was not significantly associated with fat percentage when added to models including percent ultraprocessed foods (UPF) [i.e., industrial formulations of five or more ingredients (29)]” — <span class="citation" data-cites="mcgrosky2025energy">McGrosky et al. (<a href="#ref-mcgrosky2025energy" role="doc-biblioref">2025</a>)</span></em></p>
</blockquote>
<p>Was lesen wir hier? Wenn wir den Fleischkonsum zusammen mit den hochverarbeiteten Lebensmittel mit ins Modell nehmen, dann wird der Fleichkonsum nicht signifikant. Dies ist eine Art eine multiple lineare Regression zu rechnen und die Einflussvariablen untereinander zu vergleichen. Mehr dazu dann in den folgenden Abschnitten und den entsprechenden <a href="https://jkruppa.github.io/stat-modeling-preface.html">Kapiteln zur statistischen Modellierung</a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Defintion von hochverarbeiteten Lebensmittel (eng. <em>ultraprocessed foods</em>)
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir können in der Abrbeit von <span class="citation" data-cites="gibney2019ultra">Gibney (<a href="#ref-gibney2019ultra" role="doc-biblioref">2019</a>)</span> nocheinmal nachlesen, was die aktuelle Definition eines hochverarbeiteten Lebensmittel (eng. <em>ultraprocessed foods</em>) ist. Das ist ja immer wieder ein Streitpunkt, der aktuell ja auch noch offen ist. Wir halten uns einmal an die folgende Definition.</p>
<blockquote class="blockquote">
<p><em>“Industrial formulations typically with 5 or more and usually many ingredients. Besides salt, sugar, oils, and fats, ingredients of ultra-processed foods include food substances not commonly used in culinary preparations, such as hydrolyzed protein, modified starches, and hydrogenated or interesterified oils, and additives whose purpose is to imitate sensorial qualities of unprocessed or minimally processed foods and their culinary preparations or to disguise undesirable qualities of the final product, such as colorants, flavorings, nonsugar sweeteners, emulsifiers, humectants, sequestrants, and firming, bulking, de-foaming, anticaking, and glazing agents.” — <span class="citation" data-cites="gibney2019ultra">Gibney (<a href="#ref-gibney2019ultra" role="doc-biblioref">2019</a>)</span></em></p>
</blockquote>
</div>
</div>
<p>In diesem Kapitel findest du dann noch am Ende einige Abschnitte zu Dingen von Interesse. Wenn wir nämlich über den Effekt sprechen, dann müssen wir auch nochmal über die Einheiten von den Einflussvariablen sprechen. Wenn diese sehr unterschiedliche sind, dann kann das zu Problemen führen. Auch können Einflussvariablen mit sehr großen numerischen Werten ein Problem in der Interpretation sein. Dann schauen wir nochmal auf die Korrelation der Einflussvariablen. Eigentlich sollten ja alle Einflussvariablen untereinander unabhängig sein. Dann wollen wir nochmal schauen, wie wir den verschiedene multiple Modelle untereinander vergleichen können um das beste multiple Modell zu finden.</p>
<p>Jetzt kommen wir aber nochmal zu dem theoretischen Hintergrund. Wir wollen hier nochmal gleich verstehen, wie die multiplen Modelle aufgebaut sind und wie die Modelle in R dargestellt werden. Wenn du dich mit dem allgemeinen Hintergrund zufrieden gibst, dann kannst du auch gerne direkt in die Beispiele und deren Auswertung springen. Oder eben dann nochmal später zurückkommen, wenn der Bedarf besteht.</p>
</section>
</section>
<section id="theoretischer-hintergrund" class="level2" data-number="45.2">
<h2 data-number="45.2" class="anchored" data-anchor-id="theoretischer-hintergrund"><span class="header-section-number">45.2</span> Theoretischer Hintergrund</h2>
<p>In dem theoretischen Hintergrund der multiplen Modelle bleibe ich etwas oberflächlich und gehe nicht auf die mathematischen Hintergründe tiefer ein. Das lohnt hier auch nicht weiter. In den Anwendungen habe ich dann immer noch die theoretische Berechnung in R ergänzt, die dir dann nochmal zeigt, wie in R intern die Modelle gerechnet werden. Ganz allgemein kann ich das Buch von <span class="citation" data-cites="kery2010introduction">Kéry (<a href="#ref-kery2010introduction" role="doc-biblioref">2010</a>)</span> wärmstens empfehlen. Dort habe ich viel über die Modelle und die Berechnungen gelernt. In dem Zusammenhang kann ich auch noch <span class="citation" data-cites="dormann2013parametrische">Dormann (<a href="#ref-dormann2013parametrische" role="doc-biblioref">2013</a>)</span> empfehlen, wenn es um die Maximum Likelihood Methode geht, die dort gut beschrieben ist. Ich gebe hier dann die Zusammenfassung wieder.</p>
<p>Beginnen wir nochmal mit dem klassischen statistischen Modell in der folgenden Abbildung. Wir haben Daten vorliegen, die wir in ein Modell und einen Fehler zerlegen wollen. Das liest sich sehr allgemein, in der Praxis haben wir auf der linken Seite den beobachteten Messwert Y stehen und auf der linken Seite das Modell aus dem der erklärte Anteil am Y rauskommt. Die Differenz zu den beobachteten Messwerten ist dann der Fehler. Somit ist unser Modell die Kombination aus dem Messwert und unseren Einflussvariablen. Was die Einflussvariablen an dem Messwert nicht erklären können wandert in den Fehler. Somit wollen wir einen geringen Fehler in unserer Modellierung.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-model-abstract" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-model-abstract-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-in-R-model-abstract-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Abbildung&nbsp;45.5— Der Zusammenhang von Daten, dem statistischen Modell und dem Fehler. Das Modell versucht durch ein statistisches Modell f(x) den Zusammenhang zwischen den Einflussvariablen dem Messwert zu erklären. Den Anteil des unerklärten Messwert geht in den Fehlerterm. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-in-R-model-abstract-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-model-abstract-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.5— Der Zusammenhang von Daten, dem statistischen Modell und dem Fehler. Das Modell versucht durch ein statistisches Modell <span class="math inline">\(f(x)\)</span> den Zusammenhang zwischen den Einflussvariablen dem Messwert zu erklären. Den Anteil des unerklärten Messwert geht in den Fehlerterm. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Erinnern wir uns nochmal an das simple und multiple lineares Modell. Die beiden Modelle entscheiden sich durch die Anzahl an Einflussvariablen. In der folgenden Abbildung siehst du nochmal das simple lineare Modell. Wir haben hier eine Einflussvariable X. Dann kommen noch die Koeffizienten <span class="math inline">\(\beta_0\)</span> für den Intercept und der Koeffizient <span class="math inline">\(\beta_1\)</span> für die Steigung der eine Einflussvariable hinzu. Alles was wir nicht durch die Grae erklären können, wandert dann in die Residuen oder Fehler <span class="math inline">\(\epsilon\)</span>. Eine klassische Gradengleichung mit einer Einflussvariable.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-07" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-in-R-07-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Abbildung&nbsp;45.6— Formelschreibweise der simplen linearen Regression beinhaltend die Koeffizienten \beta_0 für den y-Achsenabschnitt sowie \beta_1 für die Steigung der Graden für eine Einflussvariable x_1. Die Residuen werden durch \epsilon abgebildet. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-in-R-07-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-07-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.6— Formelschreibweise der simplen linearen Regression beinhaltend die Koeffizienten <span class="math inline">\(\beta_0\)</span> für den y-Achsenabschnitt sowie <span class="math inline">\(\beta_1\)</span> für die Steigung der Graden für eine Einflussvariable <span class="math inline">\(x_1\)</span>. Die Residuen werden durch <span class="math inline">\(\epsilon\)</span> abgebildet. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>In diesem Kapitel erweitern wir das simple lineare Modell um mehr Einflussvariablen. Dann erhalten wir ein multiples lineares Modell wie in der folgenden Abbildung. Meistens haben wir dann mehr als zwei Einflussvariablen sondern eben <span class="math inline">\(p\)</span> Stück. Jede dieser Einflussvariablen hat dann eine eigene Stigung. Wir haben dann aber immer noch nur einen Intercept vorliegen. Auch haben wir dann am Ende nur einen Wert für die Residuen oder Fehler. Die Einflussvariablen können eine beliebige Kombination an Kovariten und Faktoren sein.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-04" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-in-R-04-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Abbildung&nbsp;45.7— Formelschreibweise der multiplen linearen Regression beinhaltend die Koeffizienten \beta_0 für den y-Achsenabschnitt sowie \beta_1 bis \beta_p für die partielle Steigung der Graden für jede Einflussvariable x_1 bis x_p. Die Residuen werden durch \epsilon abgebildet. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-in-R-04-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-04-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.7— Formelschreibweise der multiplen linearen Regression beinhaltend die Koeffizienten <span class="math inline">\(\beta_0\)</span> für den y-Achsenabschnitt sowie <span class="math inline">\(\beta_1\)</span> bis <span class="math inline">\(\beta_p\)</span> für die partielle Steigung der Graden für jede Einflussvariable <span class="math inline">\(x_1\)</span> bis <span class="math inline">\(x_p\)</span>. Die Residuen werden durch <span class="math inline">\(\epsilon\)</span> abgebildet. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt können wir uns nochmal die Formelschreibweise in R anschauen. Wir brauchen hier natürlich nicht die Koeffizienten zu benennen, denn wir wollen die Werte für die Steigung und den Intercept ja durch die multiple Regression bestimmen. Wir schreiben dann auf die linke Seite der Tilde <code>~</code> unseren Messwert und auf die rechte Seite dann die Einflussvariablen durch ein Plus <code>+</code> miteinander verbunden. Wir lernen dann im Kapitel zum <a href="stat-modeling-R.html">Modellieren in R</a> noch andere Möglichkeiten in der Formelschreibweise in R. Häufig reichen die Grundlagen aber aus.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-22" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-22-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-in-R-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Abbildung&nbsp;45.8— Statistische Modellschreibweise in R mit dem Messwert auf der linken Seite und den Einflussvariablen auf der rechten Seite der Tilde. Die Platzhalter Y und X werden durch die Spaltennamen im Datensatz ersetzt. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-in-R-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-22-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.8— Statistische Modellschreibweise in R mit dem Messwert auf der linken Seite und den Einflussvariablen auf der rechten Seite der Tilde. Die Platzhalter <span class="math inline">\(Y\)</span> und <span class="math inline">\(X\)</span> werden durch die Spaltennamen im Datensatz ersetzt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt könnte man meinen, so kompliziert ist es ja dann doch nicht. Dafür musst du aber noch wissen, dass wir nicht nur eine Art von Messwert vorliegen haben. Jeder Messwert auf der linken Seite der Tilde folgt einer Verteilung. Zwar sind die Arten der Verteilungen in etwa begrenz, aber wir haben doch einige vorliegen. Daher müssen wir abhängig von der Verteilunsgfamilie noch die Regression ändern. In der folgenden Abbildung habe ich dir einmal den Zusammenhang der schrecklich netten Verteilunsgfamilie zusammengefasst. Wir müssen eben entscheiden, welcher Verteilungsfamilie unser Messwert angehört und dann eben schauen, wie unsere Einflussvariablen beschaffen sind. Daraus ergibt sich dann die Interpretation des statistischen Modells. Mehr dazu dann in den folgenden Abschnitten und den entsprechenden <a href="https://jkruppa.github.io/stat-modeling-preface.html">Kapiteln zur statistischen Modellierung</a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-09" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-in-R-09-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Abbildung&nbsp;45.9— Erweiterte Darstellung der statistischen Modellierung. Die Messwerte Y folgen einer Verteilung. Die Einflussvariablen liegen kontinuierlich als Kovariaten oder aber kategorial als Faktoren vor. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-in-R-09-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-09-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.9— Erweiterte Darstellung der statistischen Modellierung. Die Messwerte <span class="math inline">\(Y\)</span> folgen einer Verteilung. Die Einflussvariablen liegen kontinuierlich als Kovariaten oder aber kategorial als Faktoren vor. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Damit sind wir hier für das erste auch durch mit der theoretischen Betrachtung. Ich habe dann bei dem kausalen Modellen immer noch einen Tab ergänzt in dem ich mehr auf die Hinetrgründe eingehe. Wir wollen hier aber nichts händsich rechnen, so dass ich mich auf die praktsiche Umsetzung in R konzentriere. Teilweise gibt es dann wieder Überschneidungen mit der ANOVA oder anderen Kapiteln, aber das ist dann eben auch so gewollt.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[25,75]">
<div class="quarto-layout-row quarto-layout-valign-center">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/angel_01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="images/angel_01.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 75.0%;justify-content: flex-start;">
<blockquote class="blockquote">
<p><em>Wenn du jetzt denkst ‘Hä? Was soll denn mehrdimensional bedeuten?’, dann besuche doch einmal die fantastische Seite <a href="https://setosa.io/ev/ordinary-least-squares-regression/">Explained Visually | Ordinary Least Squares Regression</a> um selber zu erfahren, was eine multiple lineare Regression macht. Auf der Seite findest du interaktive Abbildungen, die dir das Konzept der linearen Regression sehr anschaulich nachvollziehen lassen.</em></p>
</blockquote>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die multiple lineare Regression
</div>
</div>
<div class="callout-body-container callout-body">
<p>Wir immer geht natürlich mehr als ich hier Vorstellen kann. Du findest im Folgenden Tutorien, die mich hier in dem Kapitel inspiriert haben. Ich habe mich ja in diesem Kapitel auf die Durchführbarkeit in R und die allgemeine Verständlichkeit konzentriert.</p>
<ul>
<li>Wir funktioniert nun so eine lineare Regression und was sind den jetzt eigentlich die Koeffizienten <span class="math inline">\(\beta_0\)</span> und <span class="math inline">\(\beta_1\)</span> eigentlich? Hier gibt es die fantastische Seite <a href="https://setosa.io/ev/ordinary-least-squares-regression/">Explained Visually | Ordinary Least Squares Regression</a>, die dir nochmal erlaubt selbe mit Punkten in einem Scatterplot zu spielen und zu sehen wie sich dann die Regressionsgleichung ändert.</li>
<li>Das Buch <a href="https://www.tmwr.org/">Tidy Modeling with R</a> gibt nochmal einen tieferen Einblick in das Modellieren in R. Wir immer, es ist ein Vorschlag aber kein Muss.</li>
<li>Das R Paket <a href="https://jtools.jacob-long.com/articles/summ"><code>{jtools}</code></a> gibt nochmal Möglichkeiten sich schnönere <code>summary()</code> Ausgaben erstellen zu lassen.</li>
<li>Das R Paket <a href="https://modelsummary.com/"><code>{modelsummary}</code></a> ist perfekt dafür geeignet nochmal verschiedene Modelle miteinander zu vergleichen.</li>
</ul>
</div>
</div>
</section>
<section id="genutzte-r-pakete" class="level2" data-number="45.3">
<h2 data-number="45.3" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">45.3</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, broom, correlation, jtools,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               see, performance, car, parameters, modelsummary,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               ggpmisc, tinytable, conflicted)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(magrittr<span class="sc">::</span>set_names)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(ggplot2<span class="sc">::</span>annotate)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2" data-number="45.4">
<h2 data-number="45.4" class="anchored" data-anchor-id="daten"><span class="header-section-number">45.4</span> Daten</h2>
<p>In diesem Kapitel schauen wir uns zwei Datensätze an. Zum einen den Datensatz zu den Sprungweiten von Flöhen und anderen Messwerten. Eigentlich ein faktorielles Experiment mit zwei Faktoren und einiges an spannenden Kovariaten. An diesem Datensatz können wir dann die verschiedenen multiplen Regressionen einmal nachvollziehen. Als zweiten Datensatz habe ich Schlangen mitgebracht. Der Datensatz ist super klein und auch sehr künstlich, da wir uns hier nur die theoretischen Berechnungen in R anschauen wollen. Da brauche ich nicht viel und da habe ich diesen Datensatz dann genutzt.</p>
<section id="modellierung-von-flöhen" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="modellierung-von-flöhen">Modellierung von Flöhen</h4>
<div id="fig-flea-yedi" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-flea-yedi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/flea_feeding_stage.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Abbildung&nbsp;45.10— In unseren Daten zu der Modellierung der Flöhe schauen wir auf verschiedene Ernährungsformen sowie Entwicklungsstadien und fragen uns, ob sich die Sprungweiten und andere Messwerte unterscheiden."><img src="images/flea_feeding_stage.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-flea-yedi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.10— In unseren Daten zu der Modellierung der Flöhe schauen wir auf verschiedene Ernährungsformen sowie Entwicklungsstadien und fragen uns, ob sich die Sprungweiten und andere Messwerte unterscheiden.
</figcaption>
</figure>
</div>
<p>Der folgende Datensatz zu den Sprungweiten und anderen Messwerten von juvenilen und adulten Flöhen ist von mir so gebaut, dass wir hier usn einige Aspekte der multiplen Regression gut anschauen können. Als Hauptfaktor haben wir hier drei verschiedene Ernährungsformen vorliegen und betrachten als zweiten Faktor eben den Entwicklungsstand der Flöhe. Dazu kommen dann noch eine ganze Reihe von Einflussvariablen wie das Gewicht und Laborwerte. Insgesamt also ein sehr großer Datensatz. Wir schauen uns dann aber immer nur einzelene Kombinationen von Einflussvariablen an. Als meinen Messwert nehme ich dann immer die Sprungweite als einen normalverteilten Messwert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>flea_model_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_model_data.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">feeding =</span> <span class="fu">as_factor</span>(feeding),</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">stage =</span> <span class="fu">as_factor</span>(stage),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">bonitur =</span> <span class="fu">as.numeric</span>(bonitur),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">infected =</span> <span class="fu">as_factor</span>(infected))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Da der Datensatz so groß ist, schaue ich mir hier nicht alle möglichen Abbildungen an sondern gebe dir hier einmal einen Auszug aus der Tabelle wieder. Wie du siehst haben wir einiges an Möglichkeiten mit den Daten. Wir haben hier verschiedene Einflussvariablen sowie verschiedene Messwerte vorliegen.</p>
<div class="cell">
<div id="tbl-model-table" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.3— Tabelle der Modelldaten zu den Sprungweiten und den Ernährungsformen von juvenilen und adulten Flöhen.
</figcaption>
<div aria-describedby="tbl-model-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">.id</th>
<th style="text-align: center;">feeding</th>
<th style="text-align: center;">stage</th>
<th style="text-align: center;">weight</th>
<th style="text-align: center;">hatched</th>
<th style="text-align: center;">K</th>
<th style="text-align: center;">Mg</th>
<th style="text-align: center;">CRP</th>
<th style="text-align: center;">Hb</th>
<th style="text-align: center;">BSG</th>
<th style="text-align: center;">jump_length</th>
<th style="text-align: center;">count_leg</th>
<th style="text-align: center;">count_leg_left</th>
<th style="text-align: center;">count_leg_right</th>
<th style="text-align: center;">bonitur</th>
<th style="text-align: center;">infected</th>
<th style="text-align: center;">M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">sugar_water</td>
<td style="text-align: center;">adult</td>
<td style="text-align: center;">16.42</td>
<td style="text-align: center;">516.41</td>
<td style="text-align: center;">33.67</td>
<td style="text-align: center;">17.8</td>
<td style="text-align: center;">9.74</td>
<td style="text-align: center;">108.18</td>
<td style="text-align: center;">50.31</td>
<td style="text-align: center;">7.72</td>
<td style="text-align: center;">63</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">62</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">3971.61</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">sugar_water</td>
<td style="text-align: center;">adult</td>
<td style="text-align: center;">12.62</td>
<td style="text-align: center;">363.5</td>
<td style="text-align: center;">41.93</td>
<td style="text-align: center;">17.54</td>
<td style="text-align: center;">8.22</td>
<td style="text-align: center;">112.81</td>
<td style="text-align: center;">47.63</td>
<td style="text-align: center;">5.62</td>
<td style="text-align: center;">55</td>
<td style="text-align: center;">56</td>
<td style="text-align: center;">54</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2064.13</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">sugar_water</td>
<td style="text-align: center;">adult</td>
<td style="text-align: center;">15.57</td>
<td style="text-align: center;">303.01</td>
<td style="text-align: center;">39.41</td>
<td style="text-align: center;">17.11</td>
<td style="text-align: center;">7.55</td>
<td style="text-align: center;">96.17</td>
<td style="text-align: center;">47.42</td>
<td style="text-align: center;">7.34</td>
<td style="text-align: center;">112</td>
<td style="text-align: center;">112</td>
<td style="text-align: center;">111</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1763.43</td>
</tr>
<tr class="even">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="odd">
<td style="text-align: center;">46</td>
<td style="text-align: center;">ketchup</td>
<td style="text-align: center;">juvenile</td>
<td style="text-align: center;">7.18</td>
<td style="text-align: center;">429.18</td>
<td style="text-align: center;">32.45</td>
<td style="text-align: center;">19.53</td>
<td style="text-align: center;">15.67</td>
<td style="text-align: center;">81.7</td>
<td style="text-align: center;">15.6</td>
<td style="text-align: center;">8.33</td>
<td style="text-align: center;">423</td>
<td style="text-align: center;">420</td>
<td style="text-align: center;">425</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">20623.49</td>
</tr>
<tr class="even">
<td style="text-align: center;">47</td>
<td style="text-align: center;">ketchup</td>
<td style="text-align: center;">juvenile</td>
<td style="text-align: center;">6.6</td>
<td style="text-align: center;">629.58</td>
<td style="text-align: center;">28.84</td>
<td style="text-align: center;">21.37</td>
<td style="text-align: center;">15.27</td>
<td style="text-align: center;">80.79</td>
<td style="text-align: center;">19.44</td>
<td style="text-align: center;">10.44</td>
<td style="text-align: center;">548</td>
<td style="text-align: center;">548</td>
<td style="text-align: center;">547</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">25149.36</td>
</tr>
<tr class="odd">
<td style="text-align: center;">48</td>
<td style="text-align: center;">ketchup</td>
<td style="text-align: center;">juvenile</td>
<td style="text-align: center;">4.19</td>
<td style="text-align: center;">192.66</td>
<td style="text-align: center;">26.61</td>
<td style="text-align: center;">20.06</td>
<td style="text-align: center;">13.95</td>
<td style="text-align: center;">80.32</td>
<td style="text-align: center;">16.07</td>
<td style="text-align: center;">13.02</td>
<td style="text-align: center;">869</td>
<td style="text-align: center;">872</td>
<td style="text-align: center;">866</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">21972.23</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In den folgenden Abschnitten nehem ich dann immer wieder einzelne Einflussvariablen und kombiniere diese miteinander in ein statistsiches Modell. Dabei nehme ich als Messwert immer die Sprungweite der Flöhe. Mehr Informationen findest du dann im <a href="example-fleas-dogs-cats.html#sec-example-flea-model">Kapitel zu von der Modellierung der Flöhe</a>. Dort sind dann auch die Einheiten und übersichtliche Abbildungen zu finden.</p>
</section>
<section id="theoretischer-datensatz" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="theoretischer-datensatz">Theoretischer Datensatz</h4>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/snakes_region.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="In unseren theoretischen Datensatz schauen wir uns die Körperlängen von verschiedenen Schlangen mit unterschiedlichen Einflussvariablen an. Wir schauen uns die Körperfarbe sowie die Regionen der Messung an."><img src="images/snakes_region.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="In unseren theoretischen Datensatz schauen wir uns die Körperlängen von verschiedenen Schlangen mit unterschiedlichen Einflussvariablen an. Wir schauen uns die Körperfarbe sowie die Regionen der Messung an."></a></p>
</figure>
</div>
<figcaption>In unseren theoretischen Datensatz schauen wir uns die Körperlängen von verschiedenen Schlangen mit unterschiedlichen Einflussvariablen an. Wir schauen uns die Körperfarbe sowie die Regionen der Messung an.</figcaption>
</figure>
</div>
<p>Abschließend kommen wir noch zu einem theoretischen Datensatz dem ich <span class="citation" data-cites="kery2010introduction">Kéry (<a href="#ref-kery2010introduction" role="doc-biblioref">2010</a>)</span> entlehnt habe. Ich möchte nochmal zeigen, wie R intern mit der Modellmatrix die Berechnungen durchführt. Das hat mich interessiert und deshalb habe ich es einmal für mein Verständnis aufgeschrieben. Wenn es dich auch interessiert, dann kannst du in den entsprechenden Tabs weiter unten einmal nachschauen. Hier also erstmal ein sehr simpler theoretischer Datensatz zu Körperlängen von Schlangen. Wir müssen hier dann noch die Faktoren einmal umwandeln, damit wir auch später die Modellmatrix sauber vorliegen haben. Deshalb hier die explizite Benennung der Level der Faktoren in dem Datensatz.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>snake_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/regression_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"theory_mult"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">factor</span>(region, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"west"</span>, <span class="st">"nord"</span>)),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="fu">factor</span>(color, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"schwarz"</span>, <span class="st">"rot"</span>, <span class="st">"blau"</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In der folgenden Tabelle ist der Datensatz <code>snake_tbl</code> nochmal dargestellt. Wir haben die Schlangenlänge <code>svl</code> als Messwert sowie das Gewicht der Schlangen <code>mass</code> sowie den Durchmesser der Schlange <span class="math inline">\(diameter\)</span> als kontinuierliche Einflussvariable, die Sammelregion <code>region</code> und die Farbe der Schlangen <code>color</code> und als kategoriale Einflussvariablen mit unterschiedlichen Anzahlen an Gruppen. Die Region <code>region</code> ist also ein Faktor mit zwei Leveln und die Schlangenfarbe <code>color</code> ein Faktor mit drei Leveln. Ich nutze den Datensatz also einmal als einen Spieldatensatz um die Modellierung theoretisch besser nachvollziehen zu können.</p>
<div class="cell">
<div id="tbl-snakes" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-snakes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.4— Datensatz zu den Körperlängen als Messwert von acht Schlangen mit verschiedenen Einflussvariablen. Die Einflussvariablen haben verschiedene Eigenschaften und müssen daher unterschiedliche modelliert werden.
</figcaption>
<div aria-describedby="tbl-snakes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: center;">svl</th>
<th style="text-align: center;">mass</th>
<th style="text-align: center;">diameter</th>
<th style="text-align: center;">region</th>
<th style="text-align: center;">color</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">40</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">west</td>
<td style="text-align: center;">schwarz</td>
</tr>
<tr class="even">
<td style="text-align: center;">45</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">west</td>
<td style="text-align: center;">schwarz</td>
</tr>
<tr class="odd">
<td style="text-align: center;">39</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">west</td>
<td style="text-align: center;">rot</td>
</tr>
<tr class="even">
<td style="text-align: center;">51</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">rot</td>
</tr>
<tr class="odd">
<td style="text-align: center;">52</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">rot</td>
</tr>
<tr class="even">
<td style="text-align: center;">57</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">blau</td>
</tr>
<tr class="odd">
<td style="text-align: center;">58</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">blau</td>
</tr>
<tr class="even">
<td style="text-align: center;">49</td>
<td style="text-align: center;">10</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">nord</td>
<td style="text-align: center;">blau</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Damit haben wir dann auch die beiden Datensätze zusammen. Im Folgenden gehe ich dann einmal auf das kausale Modell sowie das prädktive Modell ein. Hier nimmt das kausale Modell mehr Platz ein, da wir eigentlich in der multiplen Regression mehr an dem Zusammenhang interessiert sind. Die Prädiktion ist aber immer mehr im Vormarsch und es kommt hier wirklich auf deine Fragestellung an. Es kann sogar sein, dass du mit vorgesagten Werten mehr Informationen aus deinen Daten ziehen kannst, als mit einem kausalen Modell.</p>
</section>
</section>
<section id="kausales-modell" class="level2" data-number="45.5">
<h2 data-number="45.5" class="anchored" data-anchor-id="kausales-modell"><span class="header-section-number">45.5</span> Kausales Modell</h2>
<p>Was ist das kausale Modell? Wir wollen wissen, welchen Einfluss die Einflussvariablen auf den Messwert haben. Das ist jetzt erstmal einleuchtend. Wir bauen uns ein Modell und wollen wissen, ob es einen kausalen Zusammenhang zwischen einzelnen Kovariaten oder Faktoren und einem Messwert gibt. Dabei müssen nicht alle Kovariaten und alle Faktoren einen signifikanten Einfluss haben. Es geht hier eher um eine Art vor und zurück. Wir probieren verschiedene Modell aus und wollen das beste Modell finden. Dafür müssen wir abr verstehen, was die Interpretation der einzelnen Modell ist. Daher schauen wir uns jetzt einmal rein kovariate Modelle, reine faktorielle Modelle und Kombinationen davon an.</p>
<section id="mehrkovariates-modell" class="level3" data-number="45.5.1">
<h3 data-number="45.5.1" class="anchored" data-anchor-id="mehrkovariates-modell"><span class="header-section-number">45.5.1</span> Mehrkovariates Modell</h3>
<p>Beginnen wir mit einem mehrkovariaten Modell. Im Gegensatz zu einem einkovaraten Modell in der simplen linearen Regression haben wir jetzt nicht mehr nur eine Kovariate sondern mindestens zwei Kovariaten im Modell. Für die Interpretation nutzen wir hier nur ein zweikovariates Modell inhaltlich lässt sich das Modell aber auch auf mehr als zwei Kovariaten erweitern. In der folgenden Abbildung siehst du einmal das Modell dargestellt. Wir haben einen Messwert auf der linken Seite und zwei Kovariaten auf der rechten Seite. Wir wollen jetzt wissen, wie die beiden Kovariaten den Messwert erklären.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-12" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-in-R-12-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17" title="Abbildung&nbsp;45.11— Schemantisches multiples Modell mit einem Messwert Y und zwei kontinuierlichen Einflussvariablen als Kovariate c_1 und Kovariate c_2 dargestellt. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-in-R-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.11— Schemantisches multiples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und zwei kontinuierlichen Einflussvariablen als Kovariate <span class="math inline">\(c_1\)</span> und Kovariate <span class="math inline">\(c_2\)</span> dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Die Grundidee ist in der folgenen Abbildung einmal dargestellt. Du kennst dich ja schon mit der simplen linearen Regression aus. In dem mehrkovariaten Fall haben wir nun im zweikovariaten Fall einen Scatterplit in drei Dimensionen vorliegen. Je mehr Kovariaten desto hoöher wird die Dimension. Ich kann aber nicht einen vier dimensionalen Scatterplot darstellen, daher hier die Einschränkung auf zwei Kovariaten. Wie du siehst zeichnen wir jetzt nicht eine Grade im eigentlichen Sinne sondern eine Ebene durch die Punkte hindurch. Dennoch wird der quadratische Abstand zu den Punkten eben über diese Ebene minimiert. Wir erhalten somit auch nur für jede einzelne Beobachtung einen Wert für die Residuen wieder.</p>
<div id="fig-scatter3d-00" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scatter3d-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/mult-reg-scatter3d-00.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Abbildung&nbsp;45.12— Ein 3D Scatterplot von zwei Kovariaten und einem Messwert Y in drei Dimensionen. Statt eine Grade wird ein Ebene (eng. regression plane) durch die Punkte im dreidimensionalen Raum gelegt. Die Residuen sind die Abweichungen der Beobachtungen zu den Werten auf der Ebene. Modifiziert nach https://stackoverflow.com/users/8770170/frans-rodenburg"><img src="images/mult-reg-scatter3d-00.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scatter3d-00-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.12— Ein 3D Scatterplot von zwei Kovariaten und einem Messwert Y in drei Dimensionen. Statt eine Grade wird ein Ebene (eng. <em>regression plane</em>) durch die Punkte im dreidimensionalen Raum gelegt. Die Residuen sind die Abweichungen der Beobachtungen zu den Werten auf der Ebene. Modifiziert nach https://stackoverflow.com/users/8770170/frans-rodenburg
</figcaption>
</figure>
</div>
<p>Die Darstellung einer multiplen linearen Regression ist vollkommen unüblich. Wir zeigen eigentlich nicht die Daten als Visualisierung sondern müssen uns dann mit statistischen Maßzahlen helfen, wenn wir wissen wollen, ob unsere Regression gelungen ist. Deshalb auch im Folgenden einmal die praktische Anwendung in R und wie wir die zweikovariate Regression interpretieren.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Praktisch in R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Theoretisch in R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Simulation</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Dann rechnen wir einmal eine zweikovariate Analyse in R. Dafür brauchen wir einmal einen normalverteilten Messwert. Das ist nicht notwendig, aber für die Interpretation gleich viel einfacher. Dann nehmen wir noch die zwei Kovariten des Flohgewichts und der mitleren Anzahl an Beinhaaren mit ins Modell. Damit haben wir also ein klassisches kovariates Modell.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight <span class="sc">+</span> count_leg, <span class="at">data =</span> flea_model_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir uns auch schon die drei Koeffizienten für den Intercept und die Steigungen für die beiden Kovariaten wiedergeben lassen. Da wir das Modell so rechnen, dass wir beide Kovariaten mit ins Modell nehmen, haben wir hier natürlich auch jeweils für die anderen Kovariate den Effekt adjustiert. Will heißen, wir schauen uns den Effekt des Gewichts bereinigt um den Effekt der Beinhaare auf die Sprungweiten an. Und eben umgekehrt dann auch.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)      weight   count_leg 
       5.27        0.16        0.01 </code></pre>
</div>
</div>
<p>Jetzt müssen wir bei den Koeffizienten aufpassen. Ohne die Einheit, würde man denken, dass der Effekt der mittleren Beinzahl auf die Sprungweite klein wäre. Aber wir haben hier die Steigung pro Änderung der Einheit um Eins in den Einflussvariablen. Die Beinhaare haben aber eine Spannweite von 9 bis 1351! Das ist eine ganz andere Änderung als beim Gewicht mit einer Spannweite von 2.71mg bis 25.73mg. Deshalb brauchen wir auch hier dann die zusammenfassende Ausgabe um einmal die Signifikanz bewerten zu können.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = jump_length ~ weight + count_leg, data = flea_model_tbl)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.4935 -1.2840 -0.3103  0.8261  4.9542 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 5.2670345  0.6391923   8.240 1.55e-10 ***
weight      0.1585790  0.0490369   3.234  0.00229 ** 
count_leg   0.0098363  0.0008793  11.186 1.38e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.779 on 45 degrees of freedom
Multiple R-squared:  0.7357,    Adjusted R-squared:  0.724 
F-statistic: 62.63 on 2 and 45 DF,  p-value: 9.931e-14</code></pre>
</div>
</div>
<p>Die Zusammenfassugn ist manchmal etwas schwer zu lesen, deshalb habe ich dir einmal die Ausgabe im Folgenden annotiert. Hier siehst du dann auch sehr schön, dass die mittlere Anzahl an Haaren auf den Beinen auch signifikant ist. Ansonsten sieht unser Modell recht gut aus. die Resdiuen sind einigermaßen normalverteilt und auch das Bestimmtheitsmaß ist relativ hoch. Der Fehler der Residuen könnte mit 17.78 etwas kleiner sein. Am Ende passt das Modell.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-c2-summary" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-c2-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-c2-summary-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Abbildung&nbsp;45.13— Annotierte Ausgabe der Funktion summary() aus einer linearen Modellanpassung mit der Funktion lm(). Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten und Informationen zu der Modelgüte. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-c2-summary-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-c2-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.13— Annotierte Ausgabe der Funktion <code>summary()</code> aus einer linearen Modellanpassung mit der Funktion <code>lm()</code>. Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten und Informationen zu der Modelgüte. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Was sagt jetzt noch diese seltsame ANOVA aus? Wir scheinen hier ja noch eine ANOVA am Ende zu rechnen. Das ist hier jetzt nicht die einfaktorielle ANOVA, die wir aus den simplen linearen Regressionen kennen, sondern beinhaltet einen Modellvergleich. Welche Modelle vergleichen wir aber nun? In diesem Fall einmal das Nullmodell und das volle Modell, welches wir gerechnet haben. Was soll der Name Nullmodell bedeuten? Wir haben in diesem Modell nichts weiter außer dem Intercept. Hier einmal das Nullmodel gerechnet.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> flea_model_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = jump_length ~ 1, data = flea_model_tbl)

Coefficients:
(Intercept)  
      9.316  </code></pre>
</div>
</div>
<p>Wir erhalten also einmal den globalen Mittelwert über alle Sprungweiten wiedergeben. Jetzt können wir mit der ANOVA auch einen MOdellvergleich rechnen. Wir wollen wissen, ob sich unser volles zweifaktorielles Modell von dem Modell nur mit dem Intercept unterscheidet. Da sehen wir wieder den p-Wert wie wir ihn auch oben in der Ausgabe haben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">lm</span>(jump_length <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> flea_model_tbl),</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight <span class="sc">+</span> count_leg, <span class="at">data =</span> flea_model_tbl))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: jump_length ~ 1
Model 2: jump_length ~ weight + count_leg
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     47 538.83                                  
2     45 142.41  2    396.42 62.632 9.931e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Brauchen wir den Vergleich? Meistens nicht. Denn wir können ja direkt schauen, ob sich die Koeffizienten sigifkant von Nhull unterscheiden. Dann brauchen wir auch nur sehr selten den Vergleich zu dem Nullmodell. Das Nullmodell beinhaltet eigentlich nie eine Information, die wir wirklich brauchen. Daher ist es eher ein Artefakt der Programmierung aus den Anfangstagen. Wir können es, also packen wir es mit in die Ausgabe rein.</p>
<p>Die folgende Abbildung dient hier nur der Anschauung. Wir publizieren eigentlich nicht eine Visualisierung in drei Dimensionen. Wie du hier schon siehst, ist die Darstellung durch die unterschiedlich Minima- und Maximawerte des Gewichts und der Anzahl an Beinhaaren sehr verdreht. Häufig sieht dann die Abbildung in drei Dimensionen nur gut aus, wenn alle drei Achsen die gleichen Spannweiten an Werten haben. Daher dient die Abbildung eher nochmal zum Verständnis der Berechnungen der Residuen aus der Ebene der Regression.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/mult-reg-scatter3d-01.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Ein 3D Scatterplot von den zwei Kovariaten Gewicht der Flöhe in [mg] sowie der mittleren Anzahl an Beinhaaren und der Sprungweite in drei Dimensionen. Statt eine Grade wird ein Ebene (eng. regression plane) durch die Punkte im dreidimensionalen Raum gelegt. Die Residuen sind die Abweichungen der Beobachtungen zu den Werten auf der Ebene."><img src="images/mult-reg-scatter3d-01.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Ein 3D Scatterplot von den zwei Kovariaten Gewicht der Flöhe in [mg] sowie der mittleren Anzahl an Beinhaaren und der Sprungweite in drei Dimensionen. Statt eine Grade wird ein Ebene (eng. regression plane) durch die Punkte im dreidimensionalen Raum gelegt. Die Residuen sind die Abweichungen der Beobachtungen zu den Werten auf der Ebene."></a></p>
</figure>
</div>
<figcaption>Ein 3D Scatterplot von den zwei Kovariaten Gewicht der Flöhe in [mg] sowie der mittleren Anzahl an Beinhaaren und der Sprungweite in drei Dimensionen. Statt eine Grade wird ein Ebene (eng. <em>regression plane</em>) durch die Punkte im dreidimensionalen Raum gelegt. Die Residuen sind die Abweichungen der Beobachtungen zu den Werten auf der Ebene.</figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> mass <span class="sc">+</span> diameter, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  `(Intercept)`  mass diameter
          &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1             1     6        9
2             1     8        3
3             1     5        6
4             1     7        7
5             1     9        5
6             1    11        4
7             1    12       10
8             1    10       11</code></pre>
</div>
</div>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  49 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp; 6 &amp; 9 \\
  1 &amp; 8 &amp; 3 \\
  1 &amp; 5 &amp; 6 \\
  1 &amp; 7 &amp; 7 \\
  1 &amp; 9 &amp; 5 \\
  1 &amp; 11&amp; 4 \\
  1 &amp; 12&amp; 10 \\
  1 &amp; 10&amp; 11 \\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta_{mass} \\
  \beta_{diameter} \\
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> mass <span class="sc">+</span> diameter, <span class="at">data =</span> snake_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        mass    diameter 
      28.27        2.67       -0.30 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
-1.56 -3.71 -0.80  6.17  1.22  0.58  0.73 -2.63 </code></pre>
</div>
</div>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  51 \\
  52 \\
  57 \\
  58 \\
  49 \\
\end{pmatrix}
=
  \begin{pmatrix}
  28.27 &amp; 6 \cdot 2.67 &amp; 9 \cdot -0.30 \\
  28.27 &amp; 8 \cdot 2.67 &amp; 3 \cdot -0.30 \\
  28.27 &amp; 5 \cdot 2.67 &amp; 6 \cdot -0.30 \\
  28.27 &amp; 7 \cdot 2.67 &amp; 7 \cdot -0.30 \\
  28.27 &amp; 9 \cdot 2.67 &amp; 5 \cdot -0.30 \\
  28.27 &amp; 11 \cdot 2.67 &amp; 4 \cdot -0.30 \\
  28.27 &amp; 12 \cdot 2.67 &amp; 10 \cdot -0.30 \\
  28.27 &amp; 10 \cdot 2.67 &amp; 11 \cdot -0.30 \\
\end{pmatrix} +
  \begin{pmatrix}
  -1.56 \\
  -3.71 \\
  -0.80 \\
  +6.17 \\
  +1.22 \\
  +0.58 \\
  +0.73 \\
  -2.63 \\
\end{pmatrix}
\]</span></p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">28.27</span> <span class="sc">+</span>  <span class="dv">6</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">9</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">-</span> <span class="fl">1.56</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span>  <span class="dv">8</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">-</span> <span class="fl">3.71</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span>  <span class="dv">5</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">-</span> <span class="fl">0.80</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span>  <span class="dv">7</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">7</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">+</span> <span class="fl">6.17</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span>  <span class="dv">9</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">5</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">+</span> <span class="fl">1.22</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span> <span class="dv">11</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">+</span> <span class="fl">0.58</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">+</span> <span class="fl">0.73</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">11</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">-</span> <span class="fl">2.63</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 57 58 49</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>snake_tbl <span class="sc">|&gt;</span> <span class="fu">pull</span>(svl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 57 58 49</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>cov2_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">c_2 =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span> <span class="sc">*</span> c_1 <span class="sc">+</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">2</span> <span class="sc">*</span> c_2 <span class="sc">+</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> c_2, cov2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         c_1         c_2 
          2           1           2 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="mehrfaktorielles-modell" class="level3" data-number="45.5.2">
<h3 data-number="45.5.2" class="anchored" data-anchor-id="mehrfaktorielles-modell"><span class="header-section-number">45.5.2</span> Mehrfaktorielles Modell</h3>
<p>Betrachten wir nun ein mehrfaktorielles Modell. Hier sei aber gleich gesagt, dass wir eigentlich in einem mherfaktoriellen Modell an den Vergleichen der Level in den Faktoren interessiert sind. Wir wollen also eigentlich einen paarweisen Vergleich über die Gruppen rechnen. Damit sind wir dann auf dem ANOVA Pfad mit der <a href="stat-tests-anova2.html">ANOVA</a> und den <a href="stat-tests-posthoc2.html">Post-hoc Tests</a>. Wir schauen uns hier also erstmal die Koeffizienten des Modells an, sehr häufig nutzen wir diese Koeffizienten dann aber nicht. Das hat den Grund, dass der Referenzwert ja der Interecept im Modell ist und wir wenig an dem Vergleich zu dem Intercept interessiert sind. Dazu dann aber gleich mehr. Hier dann erstmal das zweifaktorielle Modell mit dem Interaktionsterm. Zu der Interaktion kannst du im <a href="stat-tests-anova2.html">Kapitel zur ANOVA</a> mehr erfahren.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-13" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-in-R-13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Abbildung&nbsp;45.14— Schemantisches multiples Modell mit einem Messwert Y und einer kategorialen Einflussvariablen als Faktor f_A mit drei Leveln sowie einer kategorialen Einflussvariablen als Faktor f_B mit zwei Leveln und deren Interaktion f_A \times f_B dargestellt. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-in-R-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.14— Schemantisches multiples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_A\)</span> mit drei Leveln sowie einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_B\)</span> mit zwei Leveln und deren Interaktion <span class="math inline">\(f_A \times f_B\)</span> dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Im Folgenden wollen wir also einmal ein multiples Modell rechnen und die Koeffizienten für die einzelnen Faktoren ermitteln. Dabei hat es dann eine Auswirkung wie viele Level ein Faktor hat und wie wir das Modell bauen. Wir machen hier gleich das volle Modell mit Interaktion. Ohne die Interaktion lassen sich dann die Koeffizienten etwas leichter zu interpretieren. Am Ende ist es dann doch die ANOVA, die wir eigentlich wollen. Hier also bitte nicht verwirren lassen, es kommt immer auf die wissenschaftliche Fragestellung an.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Praktisch in R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Theoretisch in R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Simulation</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Beginnen wir wieder mit dem zweifaktoriellen Modell. Wir nehmen hier beide Faktoren mit ins Modell und wollen auch den Interaktionsterm mit modellieren. Wenn wir den Interaktionsterm weglassen, dann können wir die Koeffizienten des Modells etwas leichter interpretieren. Wenn also unsere Interaktion nicht signifikant ist, dann kannst du die Interaktion auch aus dem Modell entfernen und so es etwas einfacher machen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> stage <span class="sc">+</span> stage<span class="sc">:</span>feeding, <span class="at">data =</span> flea_model_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt erhalten wir die Koeffizienten des Modells mit einem Intercept und der Steigung zu den einzelnen Gruppenmittelwerten. Oder anders ausgedrückt, die Differenz der Gruppenmittelwerte zum Intercept. Dazu dann noch die Koeffizienten der Interaktion. Hier sehen wir noch nicht, ob die Koeffizienten der Interaktion signifikant sind.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 (Intercept)                 feedingblood 
                        7.90                         2.07 
              feedingketchup                stagejuvenile 
                        1.32                        -1.80 
  feedingblood:stagejuvenile feedingketchup:stagejuvenile 
                        3.43                         3.70 </code></pre>
</div>
</div>
<p>Jetzt müssen wir uns einmal die Zusammenfassung des Modells wiedergeben lassen, damit wir abschätzen können, ob unsere Koeffizienten signifikant sind. Auch erhalten wir die statistischen Maßzahlen für die Modelgüte wiedergegeben. Unser Interaktion ist für beide Koeffizienten nicht signifikant, daher könnten wir die Interaktion auch aus dem Modell nehmen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = jump_length ~ feeding + stage + stage:feeding, data = flea_model_tbl)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.5288 -1.6616 -0.3906  1.0962 10.9900 

Coefficients:
                             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                     7.895      1.048   7.537 2.51e-09 ***
feedingblood                    2.074      1.481   1.400   0.1689    
feedingketchup                  1.316      1.481   0.888   0.3793    
stagejuvenile                  -1.795      1.481  -1.212   0.2324    
feedingblood:stagejuvenile      3.426      2.095   1.635   0.1094    
feedingketchup:stagejuvenile    3.703      2.095   1.767   0.0845 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.963 on 42 degrees of freedom
Multiple R-squared:  0.3157,    Adjusted R-squared:  0.2343 
F-statistic: 3.876 on 5 and 42 DF,  p-value: 0.005603</code></pre>
</div>
</div>
<p>Dann habe ich dir in der folgenden Abbildung nochmal die Ausgabe der Zusammenfassung annotiert. Der spannendeste Teil ist eigentlich, was der Intercept repräsentiert. Der Intercept ist nämlich das lokale Gruppenmittel der Behandlung Zuckerwasser für die adulten Flöhe. Dann haben wir die einzlenen statistischen Tests, ob sich die Koeffizienten von Null unterscheiden. Somit eigentlich die Frage, ob die lokalen Mittelwerte der Gruppen sich vom Intercept unterscheiden.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-f2-summary" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-f2-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-f2-summary-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Abbildung&nbsp;45.15— Annotierte Ausgabe der Funktion summary() aus einer linearen Modellanpassung mit der Funktion lm(). Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten und Informationen zu der Modelgüte. Die Erklärung der Schätzer (eng. estimate) kann in der folgenden Tabelle nachvollzogen werden. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-f2-summary-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-f2-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.15— Annotierte Ausgabe der Funktion <code>summary()</code> aus einer linearen Modellanpassung mit der Funktion <code>lm()</code>. Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten und Informationen zu der Modelgüte. Die Erklärung der Schätzer (eng. <em>estimate</em>) kann in der folgenden Tabelle nachvollzogen werden. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Das Ganze mag etwas kryptisch sein, aber das Ziel ist es eigentlich die Mittelwerte der Faktorkombinationen abzubilden. In der folgenden Tabelle habe ich dir einmal gezeigt, wie wir von den Koeffizienten auf die Mittelwerte der Sprungweiten in den einzelnen Gruppen der Faktorkombinationen kommen. Jetzt siehst du auch, dass die Koeffizienten nur einen sehr kleinen Teil der Unterschiede in den Sprungweiten beschreiben. Daher nutzen wir dann lieber Post-hoc Tests um alle paarweisen Mittelwertsvergleiche rechnen zu können.</p>
<div class="cell">
<div id="tbl-model-table-fac2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-table-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.5— Zusammensetzung der Mittelwerte der Sprungweiten <span class="math inline">\(\bar{Y}\)</span> für jede Faktorkombination aus der Ernährungsart und dem Entwicklungsstand aus den Koeffizienten des zweifaktoriellen Modells.
</figcaption>
<div aria-describedby="tbl-model-table-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 18%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(f_{feeding}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f_{stage}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\bar{Y}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\beta_{0}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\beta_{blood}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\beta_{ketchup}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\beta_{juvenile}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\beta_{blood \times juvenile}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\beta_{ketchup \times juvenile}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">sugar</td>
<td style="text-align: center;">adult</td>
<td style="text-align: center;">78.90</td>
<td style="text-align: center;">78.98</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">sugar</td>
<td style="text-align: center;">juvenile</td>
<td style="text-align: center;">61.03</td>
<td style="text-align: center;">78.98</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">-17.94</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">blood</td>
<td style="text-align: center;">adult</td>
<td style="text-align: center;">99.71</td>
<td style="text-align: center;">78.98</td>
<td style="text-align: center;">20.73</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">blood</td>
<td style="text-align: center;">juvenile</td>
<td style="text-align: center;">116.03</td>
<td style="text-align: center;">78.98</td>
<td style="text-align: center;">20.73</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">-17.94</td>
<td style="text-align: center;">34.26</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">ketchup</td>
<td style="text-align: center;">adult</td>
<td style="text-align: center;">92.15</td>
<td style="text-align: center;">78.98</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">13.17</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">ketchup</td>
<td style="text-align: center;">juvenile</td>
<td style="text-align: center;">111.24</td>
<td style="text-align: center;">78.98</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">13.17</td>
<td style="text-align: center;">-17.94</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">37.03</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Dann wird dir alles wahrscheinlich klarer, wenn wir uns nochmal die Abbildung zu dem zweifaktoriellen Versuch anschauen. Wir haben hier unsere y-Achse mit dem Intercept direkt durch den lokalen Gruppenmittelwert der adulten Flöhe, die Zuckerwasser trinken. Dann kannst du die jeweiligen Abweichungen aus der obigen Tabelle der Mittelwerte in der Abbildung nachvollziehen.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-basis-fac2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-basis-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-basis-fac2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Abbildung&nbsp;45.16— Darstellung der Gruppenmittelwerte der Sprungweiten für alle Faktorkombinationen aus dem zweifaktoriellen Modell zur Ernährung und Entwicklungsstand von Flöhen. Der Intercept liegt auf dem lokalen Mittelwert der adulten Flöhe, die Zuckerwasser trinken. Die Koeffizienten des zweifaktoriellen Modells beschreiben die Abweichungen zu dem Intercept. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-basis-fac2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-basis-fac2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.16— Darstellung der Gruppenmittelwerte der Sprungweiten für alle Faktorkombinationen aus dem zweifaktoriellen Modell zur Ernährung und Entwicklungsstand von Flöhen. Der Intercept liegt auf dem lokalen Mittelwert der adulten Flöhe, die Zuckerwasser trinken. Die Koeffizienten des zweifaktoriellen Modells beschreiben die Abweichungen zu dem Intercept. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Aus Gründen der Einfachheit lassen wir einmal die Interaktion weg.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> color <span class="sc">+</span> region, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  `(Intercept)` colorrot colorblau regionnord
          &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1             1        0         0          0
2             1        0         0          0
3             1        1         0          0
4             1        1         0          1
5             1        1         0          1
6             1        0         1          1
7             1        0         1          1
8             1        0         1          1</code></pre>
</div>
</div>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  49 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp; 0 &amp; 0 &amp; 0 \\
  1 &amp; 0 &amp; 0 &amp; 0 \\
  1 &amp; 1 &amp; 0 &amp; 0 \\
  1 &amp; 1 &amp; 0 &amp; 1 \\
  1 &amp; 1 &amp; 0 &amp; 1 \\
  1 &amp; 0 &amp; 1 &amp; 1 \\
  1 &amp; 0 &amp; 1 &amp; 1 \\
  1 &amp; 0 &amp; 1 &amp; 1 \\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta^{color}_{rot} \\
  \beta^{color}_{blau} \\
  \beta^{region}_{nord} \\
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> color <span class="sc">+</span> region, <span class="at">data =</span> snake_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)    colorrot   colorblau  regionnord 
      42.50       -3.50       -0.33       12.50 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
-2.50  2.50  0.00 -0.50  0.50  2.33  3.33 -5.67 </code></pre>
</div>
</div>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  51 \\
  52 \\
  57 \\
  58 \\
  49 \\
\end{pmatrix}
=
  \begin{pmatrix}
  42.50 &amp; 0 \cdot -3.50 &amp; 0 \cdot -0.33 &amp; 0 \cdot 12.50 \\
  42.50 &amp; 0 \cdot -3.50 &amp; 0 \cdot -0.33 &amp; 0 \cdot 12.50 \\
  42.50 &amp; 1 \cdot -3.50 &amp; 0 \cdot -0.33 &amp; 0 \cdot 12.50 \\
  42.50 &amp; 1 \cdot -3.50 &amp; 0 \cdot -0.33 &amp; 1 \cdot 12.50 \\
  42.50 &amp; 1 \cdot -3.50 &amp; 0 \cdot -0.33 &amp; 1 \cdot 12.50 \\
  42.50 &amp; 0 \cdot -3.50 &amp; 1 \cdot -0.33 &amp; 1 \cdot 12.50 \\
  42.50 &amp; 0 \cdot -3.50 &amp; 1 \cdot -0.33 &amp; 1 \cdot 12.50 \\
  42.50 &amp; 0 \cdot -3.50 &amp; 1 \cdot -0.33 &amp; 1 \cdot 12.50 \\
\end{pmatrix} +
  \begin{pmatrix}
  -2.50 \\
  +2.50 \\
  0.00 \\
  -0.50 \\
  +0.50 \\
  +2.33 \\
  +3.33 \\
  -5.67 \\
\end{pmatrix}
\]</span></p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">-</span> <span class="fl">2.50</span>,</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">+</span> <span class="fl">2.50</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">-</span> <span class="fl">0.50</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">+</span> <span class="fl">0.50</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">+</span> <span class="fl">2.33</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">+</span> <span class="fl">3.33</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">-</span> <span class="fl">5.67</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 57 58 49</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>snake_tbl <span class="sc">|&gt;</span> <span class="fu">pull</span>(svl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 57 58 49</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">f_a =</span> <span class="fu">rep</span>(<span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>), <span class="dv">2</span>),</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">f_b =</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">15</span>),</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">2</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_a) <span class="sc">+</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">3</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_b) <span class="sc">+</span> </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">2</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_a) <span class="sc">*</span> <span class="fu">as.numeric</span>(f_b) <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> f_b <span class="sc">+</span> f_a<span class="sc">:</span>f_b, fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        f_a2        f_a3        f_b2   f_a2:f_b2   f_a3:f_b2 
          9           4           8           5           2           4 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="kombinierte-modelle" class="level3" data-number="45.5.3">
<h3 data-number="45.5.3" class="anchored" data-anchor-id="kombinierte-modelle"><span class="header-section-number">45.5.3</span> Kombinierte Modelle</h3>
<p>Kommen wir jetzt zu dem wirklich spannenden Teil. Wir kombinieren Kovariaten zusammen mit Faktoren in einem Modell. Zum einen haben wir hier jetzt eine klassische <a href="stat-tests-ancova2.html">ANCOVA</a> vorliegen, wenn wir an den Faktoren als Haupteffekt interessiert sind. Wenn es eher um die Kovariaten geht, dann ist eben eine klassische Regression. Hier kommt es dann auf die wissenschaftliche Fragestellung an. Wollen wir wissen wie sich die Kovariate in den Faktoren ändert oder wollen wir die Faktoren für eine Kovariate adjustieren? Das kannst nur du beantworten.</p>
<dl>
<dt>Was passiert wenn wir eine Kovariate und einen Faktor kombinieren?</dt>
<dd>
<p>Wenn wir eine Kovariate mit einem Faktor kombinieren, dann kippen wir den Intercept der Graden um die Steigung der Kovariate. Die Level der Faktoren liegen dann auf den Mittelwerten der Kovariaten für das entsprechende Level des Faktors. Wenn wir dann noch eine Interaktion hinzunehmen, dann erlauben wir jedem Level des Faktors eine eigene Steigung der Kovariaten.</p>
</dd>
</dl>
<p>Das erstmal die sehr allgemeine Beschreibung. mehr dazu dann gleich in der Durchführung in R. Ich hoffe, dass dann das ein oder andere nochmal klarer wird. Wir wollen uns insgesamt drei Typen von multiplen Regressionen anschauen. Einmal das kombinierte Modell mit einem Faktor und einer Kovariate. Dann das gleiche Modell nur mit einm Faktor mehr. Am Ende dann noch das zweikovariate und zweifaktorielle Modell. Weiter unten diskutiere ich dann noch die Modellauswahl, wenn du dich fragst, wie viel der Einflussvariablen sollen denn jetzt in ein Modell.</p>
<section id="f_a-c_1" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="f_a-c_1"><span class="math inline">\(f_A + c_1\)</span></h4>
<p>Hier rechnen wir eigentlich eine klassische <a href="stat-tests-ancova2.html">einfaktorielle ANCOVA</a> (eng. <em>analysis of covariance</em>)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-14" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-in-R-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Abbildung&nbsp;45.17— Schemantisches simples Modell mit einem Messwert Y und einer kategorialen Einflussvariablen als Faktor f_A mit drei Leveln sowie einer kontinuierlichen Einflussvariable als Kovariate c_1 dargestellt. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-in-R-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.17— Schemantisches simples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_A\)</span> mit drei Leveln sowie einer kontinuierlichen Einflussvariable als Kovariate <span class="math inline">\(c_1\)</span> dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Praktisch in R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Theoretisch in R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Simulation</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<section id="ohne-interaktion" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="ohne-interaktion">Ohne Interaktion</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>cov1_fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> K, <span class="at">data =</span> flea_model_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>cov1_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept)   feedingblood feedingketchup              K 
          5.84           3.93           3.46           0.03 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>cov1_fac1_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = jump_length ~ feeding + K, data = flea_model_tbl)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.9913 -1.7193 -0.5809  0.8643 11.5642 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     5.84351    1.73425   3.369 0.001575 ** 
feedingblood    3.93158    1.08618   3.620 0.000758 ***
feedingketchup  3.46334    1.14089   3.036 0.004022 ** 
K               0.03425    0.04633   0.739 0.463687    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.022 on 44 degrees of freedom
Multiple R-squared:  0.2543,    Adjusted R-squared:  0.2035 
F-statistic: 5.002 on 3 and 44 DF,  p-value: 0.004523</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>flea_model_tbl <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(feeding) <span class="sc">|&gt;</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(jump_length),</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mean</span>(K))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  feeding     `mean(jump_length)` `mean(K)`
  &lt;fct&gt;                     &lt;dbl&gt;     &lt;dbl&gt;
1 sugar_water                7.00      33.7
2 blood                     10.8       29.5
3 ketchup                   10.2       25.1</code></pre>
</div>
</div>
<div class="cell">
<div id="tbl-model-table-fac1-cov1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-table-fac1-cov1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.6— Zusammensetzung der Mittelwerte der Sprungweiten <span class="math inline">\(\bar{Y}\)</span> für jede Faktorkombination aus der Ernährungsart und dem Entwicklungsstand aus den Koeffizienten des zweifaktoriellen Modells.
</figcaption>
<div aria-describedby="tbl-model-table-fac1-cov1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 15%">
<col style="width: 17%">
<col style="width: 18%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(f_{feeding}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\bar{c}_{K}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\bar{Y}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\beta_{0}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\beta_{blood}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\beta_{ketchup}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\bar{c}_{K}\cdot\beta_{K}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">sugar</td>
<td style="text-align: center;">33.69</td>
<td style="text-align: center;">70.01</td>
<td style="text-align: center;">58.48</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(11.45 = 33.69 \cdot 0.34\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">blood</td>
<td style="text-align: center;">29.47</td>
<td style="text-align: center;">107.87</td>
<td style="text-align: center;">58.48</td>
<td style="text-align: center;">39.31</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(10.02 = 29.47 \cdot 0.34\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">ketchup</td>
<td style="text-align: center;">25.06</td>
<td style="text-align: center;">101.69</td>
<td style="text-align: center;">58.48</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">34.64</td>
<td style="text-align: center;"><span class="math inline">\(8.52 = 25.06 \cdot 0.34\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-basic-cov1-fac1-01" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-basic-cov1-fac1-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-basic-cov1-fac1-01-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="Abbildung&nbsp;45.18— Scatterplot der Sprungweiten der Hunde-, Katzen- und Fuchsflöhe. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-basic-cov1-fac1-01-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="624"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-basic-cov1-fac1-01-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.18— Scatterplot der Sprungweiten der Hunde-, Katzen- und Fuchsflöhe. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="mit-interaktion" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="mit-interaktion">Mit Interaktion</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>cov1_fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> K <span class="sc">+</span> feeding<span class="sc">:</span>K, <span class="at">data =</span> flea_model_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>cov1_fac1_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = jump_length ~ feeding + K + feeding:K, data = flea_model_tbl)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.2773 -1.5927 -0.4916  1.0069 11.3471 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)       4.40476    4.81369   0.915    0.365
feedingblood      4.46302    5.14145   0.868    0.390
feedingketchup    8.16589    5.52391   1.478    0.147
K                 0.07695    0.14109   0.545    0.588
feedingblood:K   -0.01191    0.15168  -0.079    0.938
feedingketchup:K -0.17296    0.17519  -0.987    0.329

Residual standard error: 3.023 on 42 degrees of freedom
Multiple R-squared:  0.2877,    Adjusted R-squared:  0.2029 
F-statistic: 3.393 on 5 and 42 DF,  p-value: 0.01154</code></pre>
</div>
</div>
<div class="cell">
<div id="tbl-model-table-fac1-cov1-inter" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-table-fac1-cov1-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.7— Zusammensetzung der Mittelwerte der Sprungweiten <span class="math inline">\(\bar{Y}\)</span> für jede Faktorkombination aus der Ernährungsart und dem Entwicklungsstand aus den Koeffizienten des zweifaktoriellen Modells.
</figcaption>
<div aria-describedby="tbl-model-table-fac1-cov1-inter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 3%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 19%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(f_{feeding}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\bar{c}_{K}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\bar{Y}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\beta_{0}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\beta_{blood}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\beta_{ketchup}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\bar{c}_{K}\cdot\beta_{K}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\bar{c}_{K}\cdot\beta_{blood\times K}}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{\bar{c}_{K}\cdot\beta_{ketchup\times K}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">sugar</td>
<td style="text-align: center;">33.69</td>
<td style="text-align: center;">70.01</td>
<td style="text-align: center;">44.13</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(25.94 = 33.69 \cdot 0.77\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">blood</td>
<td style="text-align: center;">29.47</td>
<td style="text-align: center;">107.87</td>
<td style="text-align: center;">44.13</td>
<td style="text-align: center;">44.59</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(22.69 = 29.47 \cdot 0.77\)</span></td>
<td style="text-align: center;"><span class="math inline">\(-3.54 = 29.47 \cdot -0.12\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">ketchup</td>
<td style="text-align: center;">25.06</td>
<td style="text-align: center;">101.69</td>
<td style="text-align: center;">44.13</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">81.63</td>
<td style="text-align: center;"><span class="math inline">\(19.29 = 25.06 \cdot 0.77\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(-43.35 = 25.06 \cdot -1.73\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-basic-cov1-fac1-02" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-basic-cov1-fac1-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-basic-cov1-fac1-02-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="Abbildung&nbsp;45.19— Scatterplot der Sprungweiten der Hunde-, Katzen- und Fuchsflöhe. foo. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-basic-cov1-fac1-02-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="624"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-basic-cov1-fac1-02-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.19— Scatterplot der Sprungweiten der Hunde-, Katzen- und Fuchsflöhe. foo. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">

</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>cov1_fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">f_a =</span> <span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>),</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">1</span> <span class="sc">*</span> c_1 <span class="sc">+</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">2</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_a) <span class="sc">+</span> </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> c_1, cov1_fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        f_a2        f_a3         c_1 
          4           2           4           1 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="c_1-f_a-f_b" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="c_1-f_a-f_b"><span class="math inline">\(c_1 + f_A + f_B\)</span></h4>
<p>Hier rechnen wir eigentlich eine klassische <a href="stat-tests-ancova2.html">zweifaktorielle ANCOVA</a> (eng. <em>analysis of covariance</em>)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-16" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-in-R-16-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Abbildung&nbsp;45.20— Schemantisches simples Modell mit einem Messwert Y und einer kontinuierlichen Einflussvariable als Kovariate c_1 sowie einer kategorialen Einflussvariablen als Faktor f_A mit drei Leveln und einer kategorialen Einflussvariablen als Faktor f_B mit zwei Leveln dargestellt. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-in-R-16-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.20— Schemantisches simples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und einer kontinuierlichen Einflussvariable als Kovariate <span class="math inline">\(c_1\)</span> sowie einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_A\)</span> mit drei Leveln und einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_B\)</span> mit zwei Leveln dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Praktisch in R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Theoretisch in R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Simulation</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>cov1_fac2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight <span class="sc">+</span> feeding <span class="sc">+</span> stage, <span class="at">data =</span> flea_model_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>cov1_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept)         weight   feedingblood feedingketchup  stagejuvenile 
          3.31           0.23           4.10           3.47           2.44 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>cov1_fac2_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = jump_length ~ weight + feeding + stage, data = flea_model_tbl)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.6403 -1.2111 -0.4553  0.7319 11.4062 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      3.3125     2.0129   1.646 0.107137    
weight           0.2268     0.1219   1.860 0.069697 .  
feedingblood     4.1038     1.0548   3.891 0.000342 ***
feedingketchup   3.4723     1.0537   3.295 0.001976 ** 
stagejuvenile    2.4407     1.3121   1.860 0.069703 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.944 on 43 degrees of freedom
Multiple R-squared:  0.3082,    Adjusted R-squared:  0.2439 
F-statistic:  4.79 on 4 and 43 DF,  p-value: 0.002763</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> mass <span class="sc">+</span> region <span class="sc">+</span> color, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  `(Intercept)`  mass regionnord colorrot colorblau
          &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1             1     6          0        0         0
2             1     8          0        0         0
3             1     5          0        1         0
4             1     7          1        1         0
5             1     9          1        1         0
6             1    11          1        0         1
7             1    12          1        0         1
8             1    10          1        0         1</code></pre>
</div>
</div>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  51 \\
  52 \\
  57 \\
  58 \\
  49 \\
\end{pmatrix}
=
  \begin{pmatrix}
  1 &amp; 6 &amp; 0 &amp; 0 &amp; 0 \\
  1 &amp; 8 &amp; 0 &amp; 0 &amp; 0\\
  1 &amp; 5 &amp; 0 &amp; 1 &amp; 0\\
  1 &amp; 7 &amp; 1 &amp; 1 &amp; 0\\
  1 &amp; 9 &amp; 1 &amp; 1 &amp; 0\\
  1 &amp; 11&amp; 1 &amp; 0 &amp; 1\\
  1 &amp; 12&amp; 1 &amp; 0 &amp; 1\\
  1 &amp; 10&amp; 1 &amp; 0 &amp; 1\\
\end{pmatrix}
\times
  \begin{pmatrix}
  \beta_0 \\
  \beta_{mass} \\
  \beta^{region}_{nord} \\
  \beta^{color}_{rot} \\
  \beta^{color}_{blau} \\
\end{pmatrix} +
  \begin{pmatrix}
  \epsilon_1 \\
  \epsilon_2 \\
  \epsilon_3 \\
  \epsilon_4 \\
  \epsilon_5 \\
  \epsilon_6 \\
  \epsilon_7 \\
  \epsilon_8 \\
\end{pmatrix}
\]</span></p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> mass <span class="sc">+</span> region <span class="sc">+</span> color, <span class="at">data =</span> snake_tbl) </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)        mass  regionnord    colorrot   colorblau 
      25.00        2.50        5.00        1.50       -2.83 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8 
 0.00  0.00  0.00  2.00 -2.00  2.33  0.83 -3.17 </code></pre>
</div>
</div>
<p><span class="math display">\[
\begin{pmatrix}
  40 \\
  45 \\
  39 \\
  50 \\
  52 \\
  57 \\
  58 \\
  49 \\
\end{pmatrix}
=
  \begin{pmatrix}
  25 &amp; \phantom{0}6 \cdot 2.5 &amp; 0 \cdot 5 &amp; 0 \cdot 1.5&amp; 0 \cdot -2.83 \\
  25 &amp; \phantom{0}8 \cdot 2.5 &amp; 0 \cdot 5 &amp; 0 \cdot 1.5&amp; 0 \cdot -2.83\\
  25 &amp; \phantom{0}5 \cdot 2.5 &amp; 0 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83\\
  25 &amp; \phantom{0}7 \cdot 2.5 &amp; 1 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83\\
  25 &amp; \phantom{0}9 \cdot 2.5 &amp; 1 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83\\
  25 &amp; 11\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83\\
  25 &amp; 12\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83\\
  25 &amp; 10\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83\\
\end{pmatrix} +
  \begin{pmatrix}
  \phantom{+}0.00 \\
  \phantom{+}0.00 \\
  \phantom{+}0.00 \\
  +2.00 \\
  -2.00 \\
  +2.33 \\
  +0.83 \\
  -3.17 \\
\end{pmatrix}
\]</span></p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">25</span> <span class="sc">+</span>  <span class="dv">6</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">8</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">5</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">7</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">2.00</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">9</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">-</span> <span class="fl">2.00</span>,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span> <span class="dv">11</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">2.33</span>,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.83</span>,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">-</span> <span class="fl">3.17</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 45 39 51 52 57 58 49</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>cov1_fac2_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">f_a =</span> <span class="fu">rep</span>(<span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>), <span class="dv">2</span>),</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">f_b =</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">15</span>),</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">1</span> <span class="sc">*</span> c_1 <span class="sc">+</span> </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">2</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_a) <span class="sc">+</span> </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">3</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_b) <span class="sc">+</span> </span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> f_a <span class="sc">+</span> f_b, cov1_fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         c_1        f_a2        f_a3        f_b2 
          7           1           2           4           3 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="c_1-c_2-f_a-f_b" class="level4 unnumbered unlisted">
<h4 class="unnumbered unlisted anchored" data-anchor-id="c_1-c_2-f_a-f_b"><span class="math inline">\(c_1 + c_2 + f_A + f_B\)</span></h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-in-R-21" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-in-R-21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-in-R-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Abbildung&nbsp;45.21— Schemantisches simples Modell mit einem Messwert Y und einer kontinuierlichen Einflussvariable als Kovariate c_1 sowie einer kategorialen Einflussvariablen als Faktor f_A mit drei Leveln und einer kategorialen Einflussvariablen als Faktor f_B mit zwei Leveln dargestellt. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-in-R-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-in-R-21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.21— Schemantisches simples Modell mit einem Messwert <span class="math inline">\(Y\)</span> und einer kontinuierlichen Einflussvariable als Kovariate <span class="math inline">\(c_1\)</span> sowie einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_A\)</span> mit drei Leveln und einer kategorialen Einflussvariablen als Faktor <span class="math inline">\(f_B\)</span> mit zwei Leveln dargestellt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Praktisch in R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Theoretisch in R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Simulation</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>cov2_fac2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight <span class="sc">+</span> count_leg <span class="sc">+</span> feeding <span class="sc">+</span> stage, <span class="at">data =</span> flea_model_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>cov2_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept)         weight      count_leg   feedingblood feedingketchup 
          5.71           0.10           0.01           1.48           0.52 
 stagejuvenile 
         -0.94 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>cov2_fac2_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = jump_length ~ weight + count_leg + feeding + stage, 
    data = flea_model_tbl)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.5451 -1.0540 -0.2454  0.8130  4.7762 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     5.710598   1.174724   4.861 1.67e-05 ***
weight          0.100372   0.070749   1.419   0.1634    
count_leg       0.009592   0.001009   9.506 4.98e-12 ***
feedingblood    1.480468   0.661517   2.238   0.0306 *  
feedingketchup  0.515165   0.676390   0.762   0.4505    
stagejuvenile  -0.936342   0.827946  -1.131   0.2645    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.678 on 42 degrees of freedom
Multiple R-squared:  0.7805,    Adjusted R-squared:  0.7544 
F-statistic: 29.87 on 5 and 42 DF,  p-value: 8.213e-13</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">

</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>cov2_fac2_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">c_2 =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">f_a =</span> <span class="fu">rep</span>(<span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>), <span class="dv">2</span>),</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">f_b =</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">15</span>),</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">1</span> <span class="sc">*</span> c_1 <span class="sc">+</span> </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> c_2 <span class="sc">+</span> </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">2</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_a) <span class="sc">+</span> </span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">3</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_b) <span class="sc">+</span> </span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> c_2 <span class="sc">+</span> f_a <span class="sc">+</span> f_b, cov2_fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         c_1         c_2        f_a2        f_a3        f_b2 
          7           1          -1           2           4           3 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="prädiktives-modell" class="level2" data-number="45.6">
<h2 data-number="45.6" class="anchored" data-anchor-id="prädiktives-modell"><span class="header-section-number">45.6</span> Prädiktives Modell</h2>
<p>Neben dem klassischen kausalen Modell können wir auch ein prädiktives Modell rechnen. In einem prädiktiven Modell wollen wir wissen, welche Werte unser Messwert für neue Werte der Einflussvariable annehmen würde. Auch in einem prädiktiven Modell rechnen wir erstmal ganz normal eine multiple lineare Regression. Dann nutzen wir das Modell der Regression um neue Werte für unseren Messwert anhand neuer oder alter Werte der Einflussvariable vorherzusagen. Daher können wir auch beides miteinander verbinden. Du schaust erst was das kausale Modell ergibt und lässt dir dann neue Messwerte vorhersagen. Dabei musst du immer beachten, dass die vorhergesagten Messwerte auf der angepassten Ebene der Regression liegen. Daher nennen wir die vorhergesagten Messwerte auch angepasste Messwerte (eng. <em>fitted</em>). Wir werden später in der <a href="classification-basic.html">Klassifikation</a>, der Vorhersage von <span class="math inline">\(0/1\)</span>-Werten, noch andere Prädktionen und deren Maßzahlen kennen lernen. Die vorgehensweise ist aber so identisch mit der im <a href="stat-linear-reg-basic.html">Kapitel zur simplen linearen Regression</a>, so dass ich hier nicht nochmal alles wiederhole. Einfach nochmal dort schauen und die Modelle von oben verwenden. Weitere allgemeine Beispiel finden sich auch in den Kapitel zu den <a href="stat-modeling-marginal.html">Marginal effect models</a> und dem <a href="stat-modeling-R.html">Modellieren in R</a>.</p>
</section>
<section id="weiteres-von-interesse" class="level2" data-number="45.7">
<h2 data-number="45.7" class="anchored" data-anchor-id="weiteres-von-interesse"><span class="header-section-number">45.7</span> Weiteres von Interesse</h2>
<p>In den folgenden Abschnitten schauen wir uns noch andere Dinge von Interesse einmal an. Zum einen haben wir ein Problem, wenn unsere Einflussvariablen untereinander zu stark korreliert sind. Das zeige ich dann einmal an den Beinhaaren bei den Flöhen. Auch ist es problematisch, wenn wir eine Einheit gewählt hat, die sehr große Werte beinhaltet. Das kann ich dir gleich einmal an den Yediflöhen aufzeigen. Dann schauen wir nochmal in die Unabhängigkeitsannahme der Einflussvariablen. Neben der Korrelation sollten die Einflussvariablen auch wirklich unabhängig voneinander sein und sich nicht als Modell selbst erklären. Dann am Ende wollen wir natürlich auch noch wissen, was das beste Modell für unsere Daten wäre. Welche Einflussvariablen kann ich den reinnehmen und was ist dann das beste Modell? Darauf gehe ich dann hier auch nochmal ein.</p>
<section id="einheit-der-kovariaten" class="level3" data-number="45.7.1">
<h3 data-number="45.7.1" class="anchored" data-anchor-id="einheit-der-kovariaten"><span class="header-section-number">45.7.1</span> Einheit der Kovariaten</h3>
<div id="fig-yedi-flea" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-yedi-flea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/flea_yedi.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29" title="Abbildung&nbsp;45.22— Ein seltener Jedifloh, der so machtsensitiv ist, dass seine Fähigkeiten in der Sprungweite extrem erhöht sind."><img src="images/flea_yedi.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-yedi-flea-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.22— Ein seltener Jedifloh, der so machtsensitiv ist, dass seine Fähigkeiten in der Sprungweite extrem erhöht sind.
</figcaption>
</figure>
</div>
<p>Kommen wir nun nochmal zu einem Problem der Einheit. Wir können einen sehr kleinen Effekt vorliegen haben, der dann signifikant ist. Schnell denken wir dann, dass dieser Effekt sehr klein ust und damit nicht relevant. Wir sprechen aber bei einer Regression immer von der Steigung als Effekt. Wenn sich also die Einheit der Einflussvariable um Eins erhöht, dann steigt der Messwert um den Wert des Koeffizienten der Steigung. Wenn wir also sehr große Werte messen, dann ist die Änderung in einer Einheit sehr klein. Schauen wir uns mal das Beispiel der Jediflöhe an.</p>
<p>Manche Flöhe haben hohe Werte der <a href="https://www.jedipedia.net/wiki/Midi-Chlorianer">Midi-Chlorianer</a> oder einfach M-Werte. Damit sind diese Flöhe insbesondere sensitiv für die Macht und somit Jediflöhe. Jediflöhe könnten damit auch höhere Sprungweiten vorliegen haben, da die Jediflöhe ja einen teil ihrer MAcht dazu nutzen könnten weiter zu springen. Daher wollen wir mal in einer einfachen simplen Regression mit nur den M-Werten schauen, ob die M-Werte einen Einfluss auf die Sprungweiten haben. Ich lasse mir jetzt nur die Tabelle der Koeffizienten wiedergeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> M, <span class="at">data =</span> flea_model_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    8.038      0.736  10.928    0.000
M              0.000      0.000   2.253    0.029</code></pre>
</div>
</div>
<p>Wie wir jetzt sehen ist der Effekt mit 0.002cm extrem gering aber dennoch signifkant. Der p-Wert ist kleiner als das Signifikanzniveau <span class="math inline">\(\alpha\)</span> gleich 5%. Ist also der Wert der Midi-Chlorianer nicht relevant? Hier kommt es auf die Einheit und damit die Spannweite der M-Wert an. Die M-Werte laufen von 80.19 bis 25149.36 Anzahl Midi-Chlorianer im Blut. Damit ist eine kleine Änderung in den M-Werten auch nur mit einer kleinen Änderung in den Sprungweiten verbunden. Also Achtung bei Kovariaten mit großer Spannweite und kleinen Einheiten.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-m-values" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-m-values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-m-values-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Abbildung&nbsp;45.23— Scatterplot der Sprungweite in [cm] und Anzahl Midi-Chlorianer im Blut. Die lineare Grade und die Gradengleichung wurden ergänzt. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-m-values-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-m-values-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.23— Scatterplot der Sprungweite in [cm] und Anzahl Midi-Chlorianer im Blut. Die lineare Grade und die Gradengleichung wurden ergänzt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-confounder" class="level3" data-number="45.7.2">
<h3 data-number="45.7.2" class="anchored" data-anchor-id="sec-confounder"><span class="header-section-number">45.7.2</span> Adjustierung für Confounder</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-model-m-confounding" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-model-m-confounding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-model-m-confounding-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Abbildung&nbsp;45.24— Scatterplot der Sprungweite in [cm] und Anzahl Midi-Chlorianer im Blut. Die lineare Grade und die Gradengleichung wurden ergänzt. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-model-m-confounding-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-model-m-confounding-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.24— Scatterplot der Sprungweite in [cm] und Anzahl Midi-Chlorianer im Blut. Die lineare Grade und die Gradengleichung wurden ergänzt. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> M, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> M <span class="sc">+</span> feeding, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> M <span class="sc">+</span> infected, <span class="at">data =</span> flea_model_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir nutzen hier die tollen Funktionen aus dem <a href="https://modelsummary.com/vignettes/get_started.html">R Paket <code>{modelsummary}</code></a> und dann dem <a href="https://vincentarelbundock.github.io/tinytable/">R Paket <code>{tinytable}</code></a></p>
<div class="cell">
<div id="tbl-modelsummary-table-confound" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-modelsummary-table-confound-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.8— Interecept entfernt.
</figcaption>
<div aria-describedby="tbl-modelsummary-table-confound-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_t5dllnbr8lbo335r2imm(i, j, css_id) {
          var table = document.getElementById("tinytable_t5dllnbr8lbo335r2imm");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_t5dllnbr8lbo335r2imm');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_t5dllnbr8lbo335r2imm(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_t5dllnbr8lbo335r2imm");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 0, j: 3 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_wd2plexhufsuzard0kue',}, 
          { positions: [ { i: 12, j: 3 }, { i: 12, j: 1 }, { i: 12, j: 2 },  ], css_id: 'tinytable_css_e4t2evjq22fz4rdjv7kl',}, 
          { positions: [ { i: 9, j: 2 }, { i: 9, j: 3 }, { i: 9, j: 1 },  ], css_id: 'tinytable_css_fqt3zmcyjw6vpht3s1lg',}, 
          { positions: [ { i: 6, j: 1 }, { i: 7, j: 1 }, { i: 4, j: 1 }, { i: 5, j: 1 }, { i: 10, j: 1 }, { i: 11, j: 1 }, { i: 8, j: 1 }, { i: 4, j: 2 }, { i: 5, j: 2 }, { i: 6, j: 2 }, { i: 7, j: 2 }, { i: 8, j: 2 }, { i: 4, j: 3 }, { i: 10, j: 2 }, { i: 11, j: 2 }, { i: 7, j: 3 }, { i: 8, j: 3 }, { i: 5, j: 3 }, { i: 6, j: 3 }, { i: 11, j: 3 }, { i: 10, j: 3 },  ], css_id: 'tinytable_css_jlrgi96pjsqlftarcxf4',}, 
          { positions: [ { i: 3, j: 1 }, { i: 3, j: 2 }, { i: 2, j: 1 }, { i: 2, j: 2 }, { i: 2, j: 3 }, { i: 3, j: 3 },  ], css_id: 'tinytable_css_1pg4uhlq9zttd4svhlfk',}, 
          { positions: [ { i: 0, j: 1 },  ], css_id: 'tinytable_css_xkvxa1q9iqmz63kjpfa0',}, 
          { positions: [ { i: 1, j: 1 }, { i: 1, j: 2 }, { i: 1, j: 3 },  ], css_id: 'tinytable_css_c9x4y9ny869z7cr6il11',}, 
          { positions: [ { i: 12, j: 0 },  ], css_id: 'tinytable_css_jvn856lp1qd3sn3b6jua',}, 
          { positions: [ { i: 9, j: 0 },  ], css_id: 'tinytable_css_dxxudp3x7dw9lsrcvaqs',}, 
          { positions: [ { i: 4, j: 0 }, { i: 5, j: 0 }, { i: 6, j: 0 }, { i: 7, j: 0 }, { i: 8, j: 0 }, { i: 10, j: 0 }, { i: 11, j: 0 },  ], css_id: 'tinytable_css_mpaoo36ijg3by1lvd5u7',}, 
          { positions: [ { i: 2, j: 0 }, { i: 3, j: 0 },  ], css_id: 'tinytable_css_227cy72dmb41iolfr2dm',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_353zm957t54oz6wu5gqk',}, 
          { positions: [ { i: 1, j: 0 },  ], css_id: 'tinytable_css_l38o2fgboj0ybdutdjql',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_t5dllnbr8lbo335r2imm(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_wd2plexhufsuzard0kue, .table th.tinytable_css_wd2plexhufsuzard0kue { text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_e4t2evjq22fz4rdjv7kl, .table th.tinytable_css_e4t2evjq22fz4rdjv7kl { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_fqt3zmcyjw6vpht3s1lg, .table th.tinytable_css_fqt3zmcyjw6vpht3s1lg { text-align: center; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_jlrgi96pjsqlftarcxf4, .table th.tinytable_css_jlrgi96pjsqlftarcxf4 { text-align: center; }
      .table td.tinytable_css_1pg4uhlq9zttd4svhlfk, .table th.tinytable_css_1pg4uhlq9zttd4svhlfk { text-align: center; background-color: #E69F00; }
      .table td.tinytable_css_xkvxa1q9iqmz63kjpfa0, .table th.tinytable_css_xkvxa1q9iqmz63kjpfa0 { text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_c9x4y9ny869z7cr6il11, .table th.tinytable_css_c9x4y9ny869z7cr6il11 { text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_jvn856lp1qd3sn3b6jua, .table th.tinytable_css_jvn856lp1qd3sn3b6jua { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_dxxudp3x7dw9lsrcvaqs, .table th.tinytable_css_dxxudp3x7dw9lsrcvaqs { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_mpaoo36ijg3by1lvd5u7, .table th.tinytable_css_mpaoo36ijg3by1lvd5u7 { text-align: left; }
      .table td.tinytable_css_227cy72dmb41iolfr2dm, .table th.tinytable_css_227cy72dmb41iolfr2dm { text-align: left; background-color: #E69F00; }
      .table td.tinytable_css_353zm957t54oz6wu5gqk, .table th.tinytable_css_353zm957t54oz6wu5gqk { text-align: left; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_l38o2fgboj0ybdutdjql, .table th.tinytable_css_l38o2fgboj0ybdutdjql { text-align: left; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_t5dllnbr8lbo335r2imm" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="3">Model</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">I</th>
                <th scope="col">II</th>
                <th scope="col">III</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan="4">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>Midi-Chlorianer</td>
                  <td>0.0002*</td>
                  <td>0.0000</td>
                  <td>0.0001+</td>
                </tr>
                <tr>
                  <td></td>
                  <td>p = 0.029</td>
                  <td>p = 0.684</td>
                  <td>p = 0.091</td>
                </tr>
                <tr>
                  <td>Ernährung (Blut)</td>
                  <td></td>
                  <td>3.5526**</td>
                  <td></td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td>p = 0.005</td>
                  <td></td>
                </tr>
                <tr>
                  <td>Ernährung (Ketchup)</td>
                  <td></td>
                  <td>2.8470*</td>
                  <td></td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td>p = 0.037</td>
                  <td></td>
                </tr>
                <tr>
                  <td>Flohschnupfen (nein)</td>
                  <td></td>
                  <td></td>
                  <td>-0.5461</td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>p = 0.616</td>
                </tr>
                <tr>
                  <td>Num.Obs.</td>
                  <td>48</td>
                  <td>48</td>
                  <td>48</td>
                </tr>
                <tr>
                  <td>R2</td>
                  <td>0.099</td>
                  <td>0.248</td>
                  <td>0.104</td>
                </tr>
                <tr>
                  <td>R2 Adj.</td>
                  <td>0.080</td>
                  <td>0.197</td>
                  <td>0.065</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="korrelation-der-kovariaten" class="level3" data-number="45.7.3">
<h3 data-number="45.7.3" class="anchored" data-anchor-id="korrelation-der-kovariaten"><span class="header-section-number">45.7.3</span> Korrelation der Kovariaten</h3>
<p>Die Einlfussvariablen haben neben der Einheit noch andere Probleme. Teilweise sind diese Probleme nicht ganz so offensichtlich, wie gleich in meinem Beispiel gewählt. Probleme treten auf, wenn die Einflussvariablen untereinander zu stark miteinander korreliert sind. Mehr zur Korrelation erfährst du im <a href="stat-linear-reg-corr.html">Kapitel zur Korrelation</a>. Hier wiederhole ich jetzt nicht die Grundlagen. Wenn also Einflussvariablen sehr stark miteinander korrelaiert sind, dann erklären die Variablen mehr oder minder das Gleiche. In der folgenden Abbildung siehst du den Zusammenhang zwischen der Sprungweite und der Anzahl an Haaren auf den Flohbeinen. Wie es so ist, können wir hier natürlich verschiedene Beine oder die mittlere Anzahl betrachten. Vermeintlich glücklicherweise haben aber alle den gleichen Koeffizienten.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-mult-count-leg" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mult-count-leg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-mult-count-leg-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32" title="Abbildung&nbsp;45.25— Zusammenhang zwischen der Sprungweite und der Anzahl an Haaren an den Flohbeinen. Eine Regressiongrade wurde für das simple lineare Modell ergänzt. (A) Mittlere Anzahl an Haaren über beide Beine. (B) Anzahl Haare auf dem linken Bein. (C) Anzahl Haare auf dem rechten Bein. [Zum Vergrößern anklicken]"><img src="stat-modeling-basic_files/figure-html/fig-mult-count-leg-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1056"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mult-count-leg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.25— Zusammenhang zwischen der Sprungweite und der Anzahl an Haaren an den Flohbeinen. Eine Regressiongrade wurde für das simple lineare Modell ergänzt. <strong>(A)</strong> Mittlere Anzahl an Haaren über beide Beine. <strong>(B)</strong> Anzahl Haare auf dem linken Bein. <strong>(C)</strong> Anzahl Haare auf dem rechten Bein. <em>[Zum Vergrößern anklicken]</em>
</figcaption>
</figure>
</div>
</div>
</div>
<p>Dann können wir uns auch einmal die Korrelation zwischen den drein Kovariaten anschauen. Wie zu erwarten ist die Korrelation maximal mit Eins. Die Sterne zeigen die Signifikanz an. Das Beispiel ist hier konstruiert, aber in biologischen Systemen oder Laborwerten können wir schnell sehr hohe Korrelationen erreichen. Das Gewicht und der BMI ist sehr hoch korreliert. Blutwerte wie Hämoglobin, Eisengehalt und Sauerstoffsättigung können das Gleiche anzeigen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>flea_model_tbl <span class="sc">|&gt;</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(count_leg, count_leg_left, count_leg_right) <span class="sc">|&gt;</span> </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlation</span>() <span class="sc">|&gt;</span> </span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">redundant =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Correlation Matrix (pearson-method)

Parameter       | count_leg | count_leg_left | count_leg_right
--------------------------------------------------------------
count_leg       |           |        1.00*** |         1.00***
count_leg_left  |   1.00*** |                |         1.00***
count_leg_right |   1.00*** |        1.00*** |                

p-value adjustment method: Holm (1979)</code></pre>
</div>
</div>
<p>Naheliegend wäre es jetzt ein Modell zu bauen in dem alle drei Kovariaten enthalten sind. Dann müssen wir uns nicht entscheiden welche wir nehmen und erhalten für jede Kovariate eine Information. Wenn du nochmal auf die Abbildung schaust, wir erwarten hier eigentlich eine signifikante Steigung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> count_leg <span class="sc">+</span> count_leg_left <span class="sc">+</span> count_leg_right, <span class="at">data =</span> flea_model_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wenn wir nun die Koeffizienten betrachten, dann werden wir schon stutzig. Wir erhalten eine negative Steigung für die mittlere Anzahl und dann für die beiden Beine dann eine positive Steigung, die auch grob nur halb so groß ist. Das ist schon mal nicht so gut.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="sc">|&gt;</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    (Intercept)       count_leg  count_leg_left count_leg_right 
           7.51           -1.52            0.78            0.74 </code></pre>
</div>
</div>
<p>Betrachten wir also einmal das Modell in der Zusammenfassung um zu sehen, wie die Koeffizienten und die Residuen aussehen. Die Modelgüte ist akzeptabel. Was aber auffällt ist, dass keine der Kovariaten signifikant ist. Das ist sehr seltsam, wenn wir die Abbildung betrachten. Wir sehen hier die direkte Folge von hoch korrelierter Kovariaten. Wenn diese hoch korreliert sind, dann werden alle nicht signfikant.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = jump_length ~ count_leg + count_leg_left + count_leg_right, 
    data = flea_model_tbl)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.9300 -1.4445 -0.4353  1.1813  4.6256 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       7.5120     0.5244  14.325   &lt;2e-16 ***
count_leg        -1.5188     1.2133  -1.252    0.217    
count_leg_left    0.7848     0.6029   1.302    0.200    
count_leg_right   0.7432     0.6129   1.213    0.232    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.951 on 44 degrees of freedom
Multiple R-squared:  0.6891,    Adjusted R-squared:  0.6679 
F-statistic:  32.5 on 3 and 44 DF,  p-value: 3.115e-11</code></pre>
</div>
</div>
<p>Dann vergleichen wir einmal alle drei Modelle mit den tollen Funktionen aus dem <a href="https://modelsummary.com/vignettes/get_started.html">R Paket <code>{modelsummary}</code></a> und dann dem <a href="https://vincentarelbundock.github.io/tinytable/">R Paket <code>{tinytable}</code></a>. Wir bauen also erstmal das simple Modell mit nur der mittleren Beinanzahl und dann ergänzen wir schrittweise die Anzahl der Haare der linken und rechten Beine.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> count_leg, <span class="at">data =</span> flea_model_tbl) </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> count_leg <span class="sc">+</span> count_leg_left, <span class="at">data =</span> flea_model_tbl) </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> count_leg <span class="sc">+</span> count_leg_left <span class="sc">+</span> count_leg_right, <span class="at">data =</span> flea_model_tbl) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt können wir alle drei Modell nebeneinander direkt miteinander vergleichen. Wir sehen hier sehr schön, wie der p-Wert der mitttleren Beinanzahl immer weiter anstiegt je mehr korrelierte Kovariaten in das Modell kommen. Spannenderweise bleibt die Modellgüte immer gleich. Wir sehen also das Problem nicht, wenn wir uns zum Beispiel das Bestimmtheitsmaß nur anschauen. Du musst also immer vorab auf die Korrelation schauen.</p>
<div class="cell">
<div id="tbl-modelsummary-table-corrr" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-modelsummary-table-corrr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.9— Interecept entfernt.
</figcaption>
<div aria-describedby="tbl-modelsummary-table-corrr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_j17thuzls8u42n2gfnm6(i, j, css_id) {
          var table = document.getElementById("tinytable_j17thuzls8u42n2gfnm6");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_j17thuzls8u42n2gfnm6');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_j17thuzls8u42n2gfnm6(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_j17thuzls8u42n2gfnm6");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_0vjb6xoxn9ckxqp1a5vj',}, 
          { positions: [ { i: 10, j: 2 }, { i: 10, j: 1 }, { i: 10, j: 3 },  ], css_id: 'tinytable_css_cjtmbqvhr8zl86mflmlt',}, 
          { positions: [ { i: 7, j: 3 }, { i: 7, j: 2 }, { i: 7, j: 1 },  ], css_id: 'tinytable_css_6105d3nqhgbq5m4ashk9',}, 
          { positions: [ { i: 2, j: 1 }, { i: 4, j: 1 }, { i: 6, j: 1 }, { i: 3, j: 1 }, { i: 8, j: 1 }, { i: 5, j: 1 }, { i: 3, j: 2 }, { i: 9, j: 2 }, { i: 3, j: 3 }, { i: 2, j: 2 }, { i: 9, j: 3 }, { i: 4, j: 2 }, { i: 5, j: 2 }, { i: 6, j: 2 }, { i: 9, j: 1 }, { i: 8, j: 2 }, { i: 2, j: 3 }, { i: 4, j: 3 }, { i: 5, j: 3 }, { i: 6, j: 3 }, { i: 8, j: 3 },  ], css_id: 'tinytable_css_vzvbzeeqocp070pj2u4j',}, 
          { positions: [ { i: 0, j: 1 },  ], css_id: 'tinytable_css_gn58qun7oy8nu7mqe6ji',}, 
          { positions: [ { i: 1, j: 1 }, { i: 1, j: 3 }, { i: 1, j: 2 },  ], css_id: 'tinytable_css_5zrxkl5jrpo76r7eobqt',}, 
          { positions: [ { i: 10, j: 0 },  ], css_id: 'tinytable_css_xuola6mx7x0veuklwxxd',}, 
          { positions: [ { i: 7, j: 0 },  ], css_id: 'tinytable_css_lptqsweqwrv5dirooog6',}, 
          { positions: [ { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 5, j: 0 }, { i: 6, j: 0 }, { i: 8, j: 0 }, { i: 9, j: 0 },  ], css_id: 'tinytable_css_btnyzhg1ebk4gbpfmxvs',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_mq37hn85pvzoy4e02tvb',}, 
          { positions: [ { i: 1, j: 0 },  ], css_id: 'tinytable_css_6cbah0ll7lk0xp178h1y',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_j17thuzls8u42n2gfnm6(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_0vjb6xoxn9ckxqp1a5vj, .table th.tinytable_css_0vjb6xoxn9ckxqp1a5vj { text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_cjtmbqvhr8zl86mflmlt, .table th.tinytable_css_cjtmbqvhr8zl86mflmlt { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_6105d3nqhgbq5m4ashk9, .table th.tinytable_css_6105d3nqhgbq5m4ashk9 { text-align: center; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_vzvbzeeqocp070pj2u4j, .table th.tinytable_css_vzvbzeeqocp070pj2u4j { text-align: center; }
      .table td.tinytable_css_gn58qun7oy8nu7mqe6ji, .table th.tinytable_css_gn58qun7oy8nu7mqe6ji { text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_5zrxkl5jrpo76r7eobqt, .table th.tinytable_css_5zrxkl5jrpo76r7eobqt { text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_xuola6mx7x0veuklwxxd, .table th.tinytable_css_xuola6mx7x0veuklwxxd { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_lptqsweqwrv5dirooog6, .table th.tinytable_css_lptqsweqwrv5dirooog6 { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_btnyzhg1ebk4gbpfmxvs, .table th.tinytable_css_btnyzhg1ebk4gbpfmxvs { text-align: left; }
      .table td.tinytable_css_mq37hn85pvzoy4e02tvb, .table th.tinytable_css_mq37hn85pvzoy4e02tvb { text-align: left; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_6cbah0ll7lk0xp178h1y, .table th.tinytable_css_6cbah0ll7lk0xp178h1y { text-align: left; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_j17thuzls8u42n2gfnm6" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="3">Model</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">I</th>
                <th scope="col">II</th>
                <th scope="col">III</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan="4">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>Mittlere Beinhaare</td>
                  <td>0.009***</td>
                  <td>-0.050</td>
                  <td>-1.519</td>
                </tr>
                <tr>
                  <td></td>
                  <td>p = &lt;0.001</td>
                  <td>p = 0.511</td>
                  <td>p = 0.217</td>
                </tr>
                <tr>
                  <td>Linke Beinhaare</td>
                  <td></td>
                  <td>0.059</td>
                  <td>0.785</td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td>p = 0.438</td>
                  <td>p = 0.200</td>
                </tr>
                <tr>
                  <td>Rechte Beinhaare</td>
                  <td></td>
                  <td></td>
                  <td>0.743</td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>p = 0.232</td>
                </tr>
                <tr>
                  <td>Num.Obs.</td>
                  <td>48</td>
                  <td>48</td>
                  <td>48</td>
                </tr>
                <tr>
                  <td>R2</td>
                  <td>0.674</td>
                  <td>0.679</td>
                  <td>0.689</td>
                </tr>
                <tr>
                  <td>R2 Adj.</td>
                  <td>0.667</td>
                  <td>0.664</td>
                  <td>0.668</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="sec-vif" class="level3" data-number="45.7.4">
<h3 data-number="45.7.4" class="anchored" data-anchor-id="sec-vif"><span class="header-section-number">45.7.4</span> Variance inflation factor (VIF)</h3>
<p>Eigentlich nur für Kovariaten geht es auch mit Faktoren. <strong>Hier nochmal nach GVIF schauen.</strong></p>
<p><span class="math display">\[
VIF = \cfrac{1}{1- R^2}
\]</span></p>
<p>Die Interpretation der VIF-Werte (Variance Inflation Factor) hilft dir, den Grad der Multikollinearität in deinem Modell zu bewerten:</p>
<ul>
<li>VIF = 1: Es gibt keine Multikollinearität.</li>
<li>VIF zwischen 1 und 5: Es liegt moderate Multikollinearität vor, die in der Regel unproblematisch ist.</li>
<li>VIF &gt; 5: Es gibt eine hohe Multikollinearität, die die Koeffizienten unzuverlässig machen kann. Hier sollten Maßnahmen ergriffen werden.</li>
<li>VIF &gt; 10: Dies deutet auf eine sehr hohe Multikollinearität hin, die dringend korrigiert werden muss.</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>juvenile_flea_tbl <span class="ot">&lt;-</span> <span class="fu">filter</span>(flea_model_tbl, stage <span class="sc">==</span> <span class="st">"juvenile"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>juvenile_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> K <span class="sc">+</span> Mg <span class="sc">+</span> CRP <span class="sc">+</span> Hb <span class="sc">+</span> BSG <span class="sc">+</span> M, </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> juvenile_flea_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true"><code>{car}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false"><code>{performance}</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Händisch in R</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(juvenile_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        K        Mg       CRP        Hb       BSG         M 
 1.972761 18.659889 13.733641  8.787982  3.921379 13.132223 </code></pre>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Wir können uns mit der Funcktion <code>check_model()</code> aus dem R Paket <code>{performance}</code> auch die Unsicherheit mit angeben lassen. In unserem Beispiel hieft dies gerade nicht sehr viel weiter. Wir bleiben bei den geschätzen Werten und ignorieren das Intervall.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-stat-modeling-vif" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stat-modeling-vif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-stat-modeling-vif-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33" title="Abbildung&nbsp;45.26— Graphische Darstellung des VIF mit der Funktion check_model()."><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-vif-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stat-modeling-vif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.26— Graphische Darstellung des VIF mit der Funktion <code>check_model()</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>vif_fct <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>x)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(K <span class="sc">~</span> Mg <span class="sc">+</span> CRP <span class="sc">+</span> Hb <span class="sc">+</span> BSG <span class="sc">+</span> M, <span class="at">data =</span> juvenile_flea_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2</span>() <span class="sc">|&gt;</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"R2"</span>) <span class="sc">|&gt;</span> <span class="fu">vif_fct</span>() <span class="sc">|&gt;</span> <span class="fu">set_names</span>(<span class="st">"K"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       K 
1.972761 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Mg <span class="sc">~</span> K <span class="sc">+</span> CRP <span class="sc">+</span> Hb <span class="sc">+</span> BSG <span class="sc">+</span> M, <span class="at">data =</span> juvenile_flea_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2</span>() <span class="sc">|&gt;</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"R2"</span>) <span class="sc">|&gt;</span> <span class="fu">vif_fct</span>() <span class="sc">|&gt;</span> <span class="fu">set_names</span>(<span class="st">"Mg"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Mg 
18.65989 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(CRP <span class="sc">~</span> K <span class="sc">+</span> Mg <span class="sc">+</span> Hb <span class="sc">+</span> BSG <span class="sc">+</span> M, <span class="at">data =</span> juvenile_flea_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2</span>() <span class="sc">|&gt;</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"R2"</span>) <span class="sc">|&gt;</span> <span class="fu">vif_fct</span>() <span class="sc">|&gt;</span> <span class="fu">set_names</span>(<span class="st">"CRP"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     CRP 
13.73364 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Hb <span class="sc">~</span> K <span class="sc">+</span> Mg <span class="sc">+</span> CRP <span class="sc">+</span> BSG <span class="sc">+</span> M, <span class="at">data =</span> juvenile_flea_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2</span>() <span class="sc">|&gt;</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"R2"</span>) <span class="sc">|&gt;</span> <span class="fu">vif_fct</span>() <span class="sc">|&gt;</span> <span class="fu">set_names</span>(<span class="st">"Hb"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      Hb 
8.787982 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(BSG <span class="sc">~</span> K <span class="sc">+</span> Mg <span class="sc">+</span> CRP <span class="sc">+</span> Hb <span class="sc">+</span> M, <span class="at">data =</span> juvenile_flea_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2</span>() <span class="sc">|&gt;</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"R2"</span>) <span class="sc">|&gt;</span> <span class="fu">vif_fct</span>() <span class="sc">|&gt;</span> <span class="fu">set_names</span>(<span class="st">"BSG"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     BSG 
3.921379 </code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(M <span class="sc">~</span> K <span class="sc">+</span> Mg <span class="sc">+</span> CRP <span class="sc">+</span> Hb <span class="sc">+</span> BSG, <span class="at">data =</span> juvenile_flea_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2</span>() <span class="sc">|&gt;</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"R2"</span>) <span class="sc">|&gt;</span> <span class="fu">vif_fct</span>() <span class="sc">|&gt;</span> <span class="fu">set_names</span>(<span class="st">"M"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       M 
13.13222 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-model-basic-compare" class="level3" data-number="45.7.5">
<h3 data-number="45.7.5" class="anchored" data-anchor-id="sec-model-basic-compare"><span class="header-section-number">45.7.5</span> Vergleich von Modellen</h3>
<p>Im Folgenden wollen wir einmal verschiedene Modelle miteinander Vergleichen und uns statistisch wiedergeben lassen, was das beste Modell ist. Und hier holen wir auch einmal kurz Luft, denn wir entschieden nur was das statistisch beste Modell ist. Es kann sein, dass ein Modell biologisch mehr Sinn macht und nicht auf Platz 1 der statistischen Maßzahlen steht. Das ist vollkommen in Ordnung. Du musst abweägen, was für sich das beste Modell ist. Im Zweifel komme ruhig nochmal in meine statistische Beratung oder schreibe mir eine Mail.</p>
<p>Wir bauchen uns jetzt fünf Modelle von <code>fit_1</code> bis <code>fit_5</code>. Jedes dieser Modelle hat andere Einflussvariablen aber den gleichen Messwert. Im Weiteren sortieren wir die Modelle von einfach nach komplex. Ich versuche immmer das einfachste Modell <code>fit_1</code> zu nennen und daher die niedrige Nummer zu geben. Im Idealfall benennst du die Modellobjekte nach den Modellen, die in en Objekten gespeichert sind. Oft sind die Modelle aber sehr groß und die Objekte der Fits haben dann sehr lange Namen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> stage, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> weight, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> stage <span class="sc">+</span> count_leg, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>fit_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> stage <span class="sc">+</span> weight, <span class="at">data =</span> flea_model_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Als Ergänzung zum Bestimmtheitsmaß <span class="math inline">\(R^2\)</span> wollen wir uns noch das <em>Akaike information criterion</em> (abk. <span class="math inline">\(AIC\)</span>) anschauen. Du kannst auch das <span class="math inline">\(R^2\)</span> bzw. das <span class="math inline">\(R^2_{adj}\)</span> für die Modellauswahl nehmen. Das <span class="math inline">\(AIC\)</span> ist neuer und auch für komplexere Modelle geeignet. Es gilt hierbei, je kleiner das <span class="math inline">\(AIC\)</span> ist, desto besser ist das <span class="math inline">\(AIC\)</span>. Wir wollen also Modelle haben, die ein kleines <span class="math inline">\(AIC\)</span> haben. Wir gehen jetzt nicht auf die Berechnung der <span class="math inline">\(AIC\)</span>’s für jedes Modell ein. Wir erhalten nur ein <span class="math inline">\(AIC\)</span> für jedes Modell. Die einzelnen Werte des <span class="math inline">\(AIC\)</span>’s sagen <em>nichts</em> aus. Ein <span class="math inline">\(AIC\)</span> ist ein mathematisches Konstrukt. Wir können aber verwandte Modelle mit dem <span class="math inline">\(AIC\)</span> untereinander vergleichen. Daher berechnen wir ein <span class="math inline">\(\Delta\)</span> über die <span class="math inline">\(AIC\)</span>. Dafür nehmen wir das Modell mit dem niedrigsten <span class="math inline">\(AIC\)</span> und berechnen die jeweiligen Differenzen zu den anderen <span class="math inline">\(i\)</span> Modellen. In unserem Beispiel ist <span class="math inline">\(i\)</span> dann gleich fünf, da wir fünf Modelle haben.</p>
<p><span class="math display">\[
\Delta_i = AIC_i - AIC_{min}
\]</span></p>
<ul>
<li>wenn <span class="math inline">\(\Delta_i &lt; 2\)</span>, gibt es keinen Unterschied zwischen den Modellen. Das <span class="math inline">\(i\)</span>-te Modell ist genauso gut wie das Modell mit dem <span class="math inline">\(AIC_{min}\)</span>.</li>
<li>wenn <span class="math inline">\(2 &lt; \Delta_i &lt; 4\)</span>, dann gibt es eine starke Unterstützung für das <span class="math inline">\(i\)</span>-te Modell. Das <span class="math inline">\(i\)</span>-te Modell ist immer noch ähnlich gut wie das <span class="math inline">\(AIC_{min}\)</span>.</li>
<li>wenn <span class="math inline">\(4 &lt; \Delta_i &lt; 7\)</span>, dann gibt es deutlich weniger Unterstützung für das <span class="math inline">\(i\)</span>-te Modell;</li>
<li>Modelle mit <span class="math inline">\(\Delta_i &gt; 10\)</span> sind im Vergleich zu dem <em>besten</em> <span class="math inline">\(AIC\)</span> Modell nicht zu verwenden.</li>
</ul>
<p>Nehmen wir ein <span class="math inline">\(AIC_1 = AIC_{min} = 100\)</span> und <span class="math inline">\(AIC_2\)</span> ist <span class="math inline">\(100,7\)</span> an. Dann ist <span class="math inline">\(\Delta_2=0,7&lt;2\)</span>, so dass es keinen wesentlichen Unterschied zwischen den Modellen gibt. Wir können uns entscheiden, welches der beiden Modelle wir nehmen. Hier ist dann wichtig, was auch die Biologie sagt oder eben andere Kriterien, wie Kosten und Nutzen. Wenn wir ein <span class="math inline">\(AIC_1 = AIC_{min} = 100000\)</span> und <span class="math inline">\(AIC_2\)</span> ist <span class="math inline">\(100700\)</span> vorliegen haben, dann ist <span class="math inline">\(\Delta_2 = 700 \gg 10\)</span>, also gibt es keinen Grund für das <span class="math inline">\(2\)</span>-te Modell. Das <span class="math inline">\(2\)</span>-te Modell ist substantiell schlechter als das erste Modell. Mehr dazu kannst du unter <a href="https://faculty.washington.edu/skalski/classes/QERM597/papers_xtra/Burnham%20and%20Anderson.pdf">Multimodel Inference: Understanding AIC and BIC in Model Selection</a> nachlesen.</p>
<p>Wir können das <span class="math inline">\(\Delta_i\)</span> auch in eine Wahrscheinlichkeit umrechnen. Wir können <span class="math inline">\(p_i\)</span> berechnen und damit die relative (im Vergleich zu <span class="math inline">\(AIC_{min}\)</span>) Wahrscheinlichkeit, dass das <span class="math inline">\(i\)</span>-te Modell den AIC minimiert.</p>
<p><span class="math display">\[
p_i = \exp\left(\cfrac{-\Delta_i}{2}\right)
\]</span></p>
<p>Zum Beispiel entspricht <span class="math inline">\(\Delta_i = 1.5\)</span> einem <span class="math inline">\(p_i\)</span> von <span class="math inline">\(0.47\)</span> (ziemlich hoch) und ein <span class="math inline">\(\Delta_i = 15\)</span> entspricht einem <span class="math inline">\(p_i =0.0005\)</span> (ziemlich niedrig). Im ersten Fall besteht eine Wahrscheinlichkeit von 47%, dass das <span class="math inline">\(i\)</span>-te Modell tatsächlich eine bessere Beschreibung ist als das Modell, das <span class="math inline">\(AIC_{min}\)</span> ergibt, und im zweiten Fall beträgt diese Wahrscheinlichkeit nur 0,05%. Wir können so einmal nachrechnen, ob sich eine Entscheidung für ein anderes Modell lohnen würde. Neben dem <span class="math inline">\(AIC\)</span> gibt es auch das Bayesian information criterion (<span class="math inline">\(BIC\)</span>). Auch beim <span class="math inline">\(BIC\)</span> gilt, je kleiner das BIC ist, desto besser ist das BIC.</p>
<p>Du siehst schon, es gibt eine Reihe von Möglichkeiten sich mit der Güte oder Qualität eines Modells zu beschäftigen. Wir nutzen die Funktion <code>model_performance()</code> um uns die Informationen über die Güte eines Modells wiedergeben zu lassen. Im folgenden Codeblock habe ich mich nur auf das <span class="math inline">\(AIC\)</span> und das <span class="math inline">\(BIC\)</span> konzentriert.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(fit_1) <span class="sc">|&gt;</span> </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AIC, BIC)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
    AIC   BIC
  &lt;dbl&gt; &lt;dbl&gt;
1  247.  254.</code></pre>
</div>
</div>
<p>Gut soweit. Du kannst jetzt für jedes der Modelle das <span class="math inline">\(AIC\)</span> berechnen und dann dir die Modelle entsprechend ordnen. Wir müssen das aber nicht tun. Wir können uns auch die Funktion <code>compare_performance()</code> zu nutze machen. Die Funktion gibt uns die <span class="math inline">\(R^2\)</span>-Werte wieder wie auch die <span class="math inline">\(AIC\)</span> sowie die <span class="math inline">\(s^2_{\epsilon}\)</span> als <code>sigma</code> wieder. Wir haben also alles zusammen was wir brauchen. Darüber hinaus kann die Funktion auch die Modelle rangieren. Das nutzen wir natürlich gerne.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>comp_res <span class="ot">&lt;-</span> <span class="fu">compare_performance</span>(fit_1, fit_2, fit_3, fit_4, fit_5, <span class="at">rank =</span> <span class="cn">TRUE</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>comp_res</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name  | Model |    R2 | R2 (adj.) |  RMSE | Sigma | AIC weights | AICc weights
------------------------------------------------------------------------------
fit_4 |    lm | 0.770 |     0.749 | 1.607 | 1.698 |       1.000 |        1.000
fit_5 |    lm | 0.308 |     0.244 | 2.787 | 2.944 |    3.34e-12 |     3.34e-12
fit_1 |    lm | 0.245 |     0.211 | 2.911 | 3.007 |    3.03e-12 |     5.30e-12
fit_3 |    lm | 0.253 |     0.202 | 2.897 | 3.025 |    1.42e-12 |     1.93e-12
fit_2 |    lm | 0.253 |     0.202 | 2.897 | 3.025 |    1.42e-12 |     1.93e-12

Name  | BIC weights | Performance-Score
---------------------------------------
fit_4 |       1.000 |           100.00%
fit_5 |    3.34e-12 |             5.06%
fit_1 |    1.97e-11 |             0.46%
fit_3 |    3.61e-12 |             0.36%
fit_2 |    3.61e-12 |             0.36%</code></pre>
</div>
</div>
<p>Anhand der Ausgabe der Funktion <code>compare_performance()</code> sehen wir, dass unser Modell <code>fit_2</code> das beste Modell ist. Zwar ist die Streuung der Residuen nicht die Kleinste aller Modelle (<code>Sigma</code> = 1.933) aber wir haben ein hohes <span class="math inline">\(R^2_{adj}\)</span> und auch ein kleines <span class="math inline">\(AIC\)</span>. Wir würden damit sagen, dass das Modell <code>fit_2</code> mit den Variablen <code>animal</code> und <code>sex</code> für <span class="math inline">\(x\)</span> das Outcome <code>jump_length</code> am besten statistisch beschreibt.</p>
<p>In <a href="#fig-stat-modeling-compare" class="quarto-xref">Abbildung&nbsp;<span>45.27</span></a> sehen wir die Ausgabe der Funktion <code>compare_performance()</code> nochmal visualisiert. Wir können dann die einzelnen Modelle nochmal besser vergleichen. Auch siehst du hier, ob ein Modell in einem Bereich sehr schlecht ist oder aber nur in einem Bereich sehr gut.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-stat-modeling-compare" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-stat-modeling-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-basic_files/figure-html/fig-stat-modeling-compare-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="Abbildung&nbsp;45.27— Graphische Darstellung der Funktion compare_performance() Wir sehen hier die einzelnen Gütekriterien in einer Übersicht dargestellt."><img src="stat-modeling-basic_files/figure-html/fig-stat-modeling-compare-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stat-modeling-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;45.27— Graphische Darstellung der Funktion <code>compare_performance()</code> Wir sehen hier die einzelnen Gütekriterien in einer Übersicht dargestellt.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Zum Ende stellt sich die Frage nach dem statistischen Test. Können wir auch statistisch Testen, ob das Modell <code>fit_1</code> signifikant unterschiedlich ist? Ja wir können die Funktion <code>test_vuong()</code> nutzen um ein Model zu den anderen Modellen zu vergleichen. Wenn du mehrere Modell miteinander vergleichen möchtest, dann muss du die Funktion mehrfach ausführen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_vuong</span>(fit_1, fit_2, fit_3, fit_4, fit_5)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Name  | Model |   Omega2 | p (Omega2) |    LR | p (LR)
------------------------------------------------------
fit_1 |    lm |          |            |       |       
fit_2 |    lm | 8.54e-03 |     0.517  | -0.38 |  0.354
fit_3 |    lm | 5.77e-03 |     0.216  | -0.46 |  0.324
fit_4 |    lm |     1.81 |     &lt; .001 | -3.06 |  0.001
fit_5 |    lm |     0.06 |     0.160  | -1.19 |  0.117
Each model is compared to fit_1.</code></pre>
</div>
</div>
<div class="cell">
<div id="tbl-modelsummary-table-comp" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-modelsummary-table-comp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;45.10— Interecept entfernt.
</figcaption>
<div aria-describedby="tbl-modelsummary-table-comp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_yuum7iu0rq6t8luq9omo(i, j, css_id) {
          var table = document.getElementById("tinytable_yuum7iu0rq6t8luq9omo");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_yuum7iu0rq6t8luq9omo');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_yuum7iu0rq6t8luq9omo(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_yuum7iu0rq6t8luq9omo");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 0, j: 4 }, { i: 0, j: 5 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_cm3lzi9a59ufgwtl28fw',}, 
          { positions: [ { i: 17, j: 4 }, { i: 17, j: 1 }, { i: 17, j: 3 }, { i: 17, j: 5 }, { i: 17, j: 2 },  ], css_id: 'tinytable_css_uensv9uoxx9g5vgqyq0i',}, 
          { positions: [ { i: 11, j: 1 }, { i: 11, j: 5 }, { i: 11, j: 4 }, { i: 11, j: 2 }, { i: 11, j: 3 },  ], css_id: 'tinytable_css_zldp3u7knc89vuphanmm',}, 
          { positions: [ { i: 4, j: 1 }, { i: 3, j: 1 }, { i: 8, j: 1 }, { i: 9, j: 1 }, { i: 6, j: 1 }, { i: 6, j: 2 }, { i: 12, j: 1 }, { i: 13, j: 1 }, { i: 14, j: 1 }, { i: 2, j: 1 }, { i: 16, j: 1 }, { i: 12, j: 2 }, { i: 5, j: 1 }, { i: 14, j: 2 }, { i: 7, j: 1 }, { i: 3, j: 2 }, { i: 4, j: 2 }, { i: 10, j: 1 }, { i: 14, j: 3 }, { i: 7, j: 2 }, { i: 8, j: 2 }, { i: 9, j: 2 }, { i: 15, j: 1 }, { i: 6, j: 3 }, { i: 7, j: 3 }, { i: 13, j: 2 }, { i: 9, j: 3 }, { i: 2, j: 2 }, { i: 16, j: 2 }, { i: 12, j: 3 }, { i: 5, j: 2 }, { i: 9, j: 4 }, { i: 2, j: 3 }, { i: 3, j: 3 }, { i: 4, j: 3 }, { i: 10, j: 2 }, { i: 14, j: 4 }, { i: 2, j: 4 }, { i: 8, j: 3 }, { i: 4, j: 4 }, { i: 15, j: 2 }, { i: 6, j: 4 }, { i: 7, j: 4 }, { i: 13, j: 3 }, { i: 4, j: 5 }, { i: 15, j: 3 }, { i: 16, j: 3 }, { i: 12, j: 4 }, { i: 5, j: 3 }, { i: 9, j: 5 }, { i: 15, j: 4 }, { i: 3, j: 4 }, { i: 12, j: 5 }, { i: 10, j: 3 }, { i: 14, j: 5 }, { i: 2, j: 5 }, { i: 8, j: 4 }, { i: 13, j: 4 }, { i: 10, j: 4 }, { i: 6, j: 5 }, { i: 7, j: 5 }, { i: 3, j: 5 }, { i: 5, j: 4 }, { i: 10, j: 5 }, { i: 16, j: 4 }, { i: 8, j: 5 }, { i: 5, j: 5 }, { i: 15, j: 5 }, { i: 16, j: 5 }, { i: 13, j: 5 },  ], css_id: 'tinytable_css_8orsuwocznscwldh0enr',}, 
          { positions: [ { i: 0, j: 1 },  ], css_id: 'tinytable_css_su7mf1n2q3xj74mluigv',}, 
          { positions: [ { i: 1, j: 1 }, { i: 1, j: 2 }, { i: 1, j: 4 }, { i: 1, j: 5 }, { i: 1, j: 3 },  ], css_id: 'tinytable_css_7gnqgj83hlpmm5bql009',}, 
          { positions: [ { i: 17, j: 0 },  ], css_id: 'tinytable_css_73q4n59es767vi5wwh22',}, 
          { positions: [ { i: 11, j: 0 },  ], css_id: 'tinytable_css_ip8uutc8g5xlgg2m34ty',}, 
          { positions: [ { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 5, j: 0 }, { i: 6, j: 0 }, { i: 7, j: 0 }, { i: 8, j: 0 }, { i: 9, j: 0 }, { i: 10, j: 0 }, { i: 15, j: 0 }, { i: 12, j: 0 }, { i: 13, j: 0 }, { i: 14, j: 0 }, { i: 16, j: 0 },  ], css_id: 'tinytable_css_256gmjnud2moht7lbbk7',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_kupvt9ytlk1muzidyhlq',}, 
          { positions: [ { i: 1, j: 0 },  ], css_id: 'tinytable_css_1hm3ziftb30ethwe2pky',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_yuum7iu0rq6t8luq9omo(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_cm3lzi9a59ufgwtl28fw, .table th.tinytable_css_cm3lzi9a59ufgwtl28fw { text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_uensv9uoxx9g5vgqyq0i, .table th.tinytable_css_uensv9uoxx9g5vgqyq0i { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_zldp3u7knc89vuphanmm, .table th.tinytable_css_zldp3u7knc89vuphanmm { text-align: center; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_8orsuwocznscwldh0enr, .table th.tinytable_css_8orsuwocznscwldh0enr { text-align: center; }
      .table td.tinytable_css_su7mf1n2q3xj74mluigv, .table th.tinytable_css_su7mf1n2q3xj74mluigv { text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_7gnqgj83hlpmm5bql009, .table th.tinytable_css_7gnqgj83hlpmm5bql009 { text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_73q4n59es767vi5wwh22, .table th.tinytable_css_73q4n59es767vi5wwh22 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_ip8uutc8g5xlgg2m34ty, .table th.tinytable_css_ip8uutc8g5xlgg2m34ty { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_256gmjnud2moht7lbbk7, .table th.tinytable_css_256gmjnud2moht7lbbk7 { text-align: left; }
      .table td.tinytable_css_kupvt9ytlk1muzidyhlq, .table th.tinytable_css_kupvt9ytlk1muzidyhlq { text-align: left; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_1hm3ziftb30ethwe2pky, .table th.tinytable_css_1hm3ziftb30ethwe2pky { text-align: left; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_yuum7iu0rq6t8luq9omo" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="5">Model</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">I</th>
                <th scope="col">II</th>
                <th scope="col">III</th>
                <th scope="col">IV</th>
                <th scope="col">V</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan="6">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>Ernährung (Blut)</td>
                  <td>3.787***</td>
                  <td>3.787***</td>
                  <td>3.862***</td>
                  <td>1.272+</td>
                  <td>4.104***</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(1.063)</td>
                  <td>(1.070)</td>
                  <td>(1.076)</td>
                  <td>(0.652)</td>
                  <td>(1.055)</td>
                </tr>
                <tr>
                  <td>Ernährung (Ketchup)</td>
                  <td>3.167**</td>
                  <td>3.167**</td>
                  <td>3.240**</td>
                  <td>0.302</td>
                  <td>3.472**</td>
                </tr>
                <tr>
                  <td></td>
                  <td>(1.063)</td>
                  <td>(1.070)</td>
                  <td>(1.075)</td>
                  <td>(0.667)</td>
                  <td>(1.054)</td>
                </tr>
                <tr>
                  <td>Entwicklung (juvenile)</td>
                  <td></td>
                  <td>0.581</td>
                  <td></td>
                  <td>-1.825**</td>
                  <td>2.441+</td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td>(0.873)</td>
                  <td></td>
                  <td>(0.548)</td>
                  <td>(1.312)</td>
                </tr>
                <tr>
                  <td>Gewicht [mg]</td>
                  <td></td>
                  <td></td>
                  <td>0.054</td>
                  <td></td>
                  <td>0.227+</td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>(0.081)</td>
                  <td></td>
                  <td>(0.122)</td>
                </tr>
                <tr>
                  <td>Anzahl Beinhaare</td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>0.010***</td>
                  <td></td>
                </tr>
                <tr>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td>(0.001)</td>
                  <td></td>
                </tr>
                <tr>
                  <td>Num.Obs.</td>
                  <td>48</td>
                  <td>48</td>
                  <td>48</td>
                  <td>48</td>
                  <td>48</td>
                </tr>
                <tr>
                  <td>R2</td>
                  <td>0.245</td>
                  <td>0.253</td>
                  <td>0.253</td>
                  <td>0.770</td>
                  <td>0.308</td>
                </tr>
                <tr>
                  <td>R2 Adj.</td>
                  <td>0.211</td>
                  <td>0.202</td>
                  <td>0.202</td>
                  <td>0.749</td>
                  <td>0.244</td>
                </tr>
                <tr>
                  <td>AIC</td>
                  <td>246.8</td>
                  <td>248.3</td>
                  <td>248.3</td>
                  <td>193.8</td>
                  <td>246.6</td>
                </tr>
                <tr>
                  <td>BIC</td>
                  <td>254.3</td>
                  <td>257.7</td>
                  <td>257.7</td>
                  <td>205.0</td>
                  <td>257.8</td>
                </tr>
                <tr>
                  <td>RMSE</td>
                  <td>2.91</td>
                  <td>2.90</td>
                  <td>2.90</td>
                  <td>1.61</td>
                  <td>2.79</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-dormann2013parametrische" class="csl-entry" role="listitem">
Dormann, C. F. (2013). <em>Parametrische Statistik</em>. Springer.
</div>
<div id="ref-gibney2019ultra" class="csl-entry" role="listitem">
Gibney, M. J. (2019). Ultra-processed foods: definitions and policy issues. <em>Current developments in nutrition</em>, <em>3</em>(2), nzy077.
</div>
<div id="ref-heiss2022" class="csl-entry" role="listitem">
Heiss, A. (2022, Mai 20). <em>Marginalia: <span>A</span> Guide to Figuring Out What the Heck Marginal Effects, Marginal Slopes, Average Marginal Effects, Marginal Effects at the Mean, and All These Other Marginal Things Are</em>. <a href="https://doi.org/10.59350/40xaj-4e562">https://doi.org/10.59350/40xaj-4e562</a>
</div>
<div id="ref-kery2010introduction" class="csl-entry" role="listitem">
Kéry, M. (2010). <em>Introduction to WinBUGS for ecologists: Bayesian approach to regression, ANOVA, mixed models and related analyses</em>. Academic Press.
</div>
<div id="ref-mcgrosky2025energy" class="csl-entry" role="listitem">
McGrosky, A., Luke, A., Arab, L., Bedu-Addo, K., Bonomi, A. G., Bovet, P., Brage, S., Buchowski, M. S., Butte, N., Camps, S. G., et al. (2025). Energy expenditure and obesity across the economic spectrum. <em>Proceedings of the National Academy of Sciences</em>, <em>122</em>(29), e2420902122.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-linear-reg-basic.html" class="pagination-link" aria-label="Simple lineare Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-linear-reg-quality.html" class="pagination-link" aria-label="Modelgüte">
        <span class="nav-page-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Modelgüte</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb118" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra, patchwork, ggimage,</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="in">               plotly, conflicted)</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(plotly::layout)</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::filter)</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="in">source("images/R/stat-modeling-R.R")</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="in">source("images/R/stat-modeling-basic.R")</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(20250708)</span></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="in">theme_modeling &lt;- function() {</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(panel.grid.minor = element_blank(),</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.background = element_rect(fill = "white", color = NA),</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.title = element_text(size = 16, face = "bold"),</span></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.subtitle = element_text(size = 12, face = "italic"),</span></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a><span class="in">          plot.caption = element_text(face = "italic"),</span></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.title = element_text(size = 12, face = "bold"),</span></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.text = element_text(size = 12),</span></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a><span class="in">          strip.text = element_text(face = "bold"),</span></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a><span class="in">          strip.background = element_rect(fill = "grey80", color = NA))</span></span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a><span class="fu"># Multiple lineare Regression {#sec-mult-reg-basic}</span></span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-modeling-basic.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-30"><a href="#cb118-30" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"All models are approximations. Essentially, all models are wrong, but some are useful. However, the approximate nature of the model must always be borne in mind." --- George E. P. Box*</span></span>
<span id="cb118-31"><a href="#cb118-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-32"><a href="#cb118-32" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/caution.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb118-33"><a href="#cb118-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-34"><a href="#cb118-34" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution appearance="simple"}</span>
<span id="cb118-35"><a href="#cb118-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stand des Kapitels: Konstruktion (seit 07.2025)</span></span>
<span id="cb118-36"><a href="#cb118-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-37"><a href="#cb118-37" aria-hidden="true" tabindex="-1"></a>Dieses Kapitel wird in den nächsten Wochen geschrieben und ist damit meine aktuelle Großbaustelle. Ich plane zum Beginn des WiSe 2025/26 eine fertige Version des Kapitels erstellt zu haben. Während das Kapitel entsteht, funktioniert so manches dann nicht so wie es soll. Bitte daher hier dann abwarten.</span>
<span id="cb118-38"><a href="#cb118-38" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb118-39"><a href="#cb118-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-40"><a href="#cb118-40" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel geht es um die multiple lineare Regression. Der große Unterschied zu der simplen linearen Regression ist, dass wir in der multiplen Regression mehr als eine Einflussvariable vorliegen haben. Damit wird unser Modell um einiges komplexer. Hier gibt es jetzt gewisse Überschneidungen mit den <span class="co">[</span><span class="ot">Marginal effect models</span><span class="co">](#sec-marginal)</span>, die im Prinzip die Erweiterung der multiplen Regression sind. Wir können mit den *Marginal effect models* eben dann doch etwas anders lineare und nicht linare Regressionen interpretieren. Damit kannst du in dem Kapitel dann mehr über eine alternative Art der Interpretation von multiplen Modellen lernen. Ebenso gehe nicht hier so stark auf das <span class="co">[</span><span class="ot">Modellieren in R</span><span class="co">](#sec-modeling-R)</span> ein. Hier kannst du dann in dem entsprechenden Kapitel auch nochmal mehr lesen. Hier zeige ich dann die Basisanwendungen. Am Ende habe ich mich auch entschieden hier nur einen normalverteilten Messwert zu betrachten. Sonst wird es einfach viel zu komplex, wenn wir hier noch andere Verteilungen berücksichtigen. Dazu dann mehr in den entsprechenden <span class="co">[</span><span class="ot">Kapiteln zur statistischen Modellierung</span><span class="co">](https://jkruppa.github.io/stat-modeling-preface.html)</span>.</span>
<span id="cb118-41"><a href="#cb118-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-42"><a href="#cb118-42" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb118-43"><a href="#cb118-43" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/personal_opinion.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb118-44"><a href="#cb118-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-45"><a href="#cb118-45" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"In den folgenden Kapiteln gibt es immer mal wieder Redundanzen. Teilweise sind diese Redundanzen gewollt, denn eine gute Widerholung hilft ja immer. Meistens habe ich aber den Überblick verloren und fand, dass das Thema dann an der Stelle doch nochmal gut reinpasste. Ist so passiert." --- Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.*</span></span>
<span id="cb118-46"><a href="#cb118-46" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb118-47"><a href="#cb118-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-48"><a href="#cb118-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## Allgemeiner Hintergrund</span></span>
<span id="cb118-49"><a href="#cb118-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-50"><a href="#cb118-50" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"This idea of 'holding everything constant' though can be tricky to wrap your head around." --- [Andrew Heiss](https://www.andrewheiss.com/blog/2022/05/20/marginalia/#regression-sliders-switches-and-mixing-boards)*</span></span>
<span id="cb118-51"><a href="#cb118-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-52"><a href="#cb118-52" aria-hidden="true" tabindex="-1"></a>Wenn wir über die multiple lineare Regression sprechen, dann sprechen wir immer über mehr als eine Einflussvariable. Dadurch können wir den Fall haben, dass wir nicht nur eine Kovariate sondern mehrere Kovariaten in einem Modell vorliegen haben. Zum Beispiel wollen wir wissen, ob die Sprungweite von dem Gewicht der Flöhe oder der Anzahl an Beinhaaren abhängt. Wir haben hier also mehrere kontinuierliche Einflussvariablen vorliegen. Ebenso können wir den Fall haben, dass uns nur kategoriale Einflussvariablen interessieren. Hat die Ernährungsform oder aber der Entwicklungsstand einen Einfluss auf die Sprungweite der Flöhe. Klassischerweise wären wir hier zwar auf dem ANOVA Pfad eines faktoriellen Experiments, aber wir können natürlich die Koeffzienten eines mehfaktoriellen Modells in der Form einer multiplen Regression interpretieren. Wenn wir dann keinen normalverteilten Messwert haben, dann bietet sich natürlich dennoch die multiple Regression als eine Analyseform an. Abschließend können wir natürlich auch kombinierte Modelle vorliegen haben. Wir haben also in unseren multiple Modell nicht nur Kovariaten oder Faktoren sondern eben eine Mischung aus beiden Formen. Das führt dann zu einer noch komplexeren Interpretation. Alle Fälle wollen wir uns hier in diesem Kapitel einmal an einem normalverteilten Messwert anschauen.</span>
<span id="cb118-53"><a href="#cb118-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-54"><a href="#cb118-54" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Sprachlicher Hintergrund {.unnumbered .unlisted}</span></span>
<span id="cb118-55"><a href="#cb118-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-56"><a href="#cb118-56" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"In statistics courses taught by statisticians we don't use independent variable because we use independent on to mean stochastic independence. Instead we say predictor or covariate (either). And, similarly, we don't say "dependent variable" either. We say response." --- [User berf auf r/AskStatistics](https://www.reddit.com/r/AskStatistics/comments/qt1hvu/comment/hkigiks/?utm_source=share&amp;utm_medium=web3x&amp;utm_name=web3xcss&amp;utm_term=1&amp;utm_content=share_button)*</span></span>
<span id="cb118-57"><a href="#cb118-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-58"><a href="#cb118-58" aria-hidden="true" tabindex="-1"></a>Wenn wir uns mit dem statistischen Modellieren beschäftigen wollen, dann brauchen wir auch Worte um über das Thema reden zu können. Statistik wird in vielen Bereichen der Wissenschaft verwendet und in jedem Bereich nennen wir dann auch Dinge anders, die eigentlich gleich sind. Daher werde ich mir es hier herausnehmen und auch die Dinge so benennen, wie ich sie für didaktisch sinnvoll finde. Wir wollen hier was verstehen und lernen, somit brauchen wir auch eine klare Sprache.</span>
<span id="cb118-59"><a href="#cb118-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-60"><a href="#cb118-60" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">15,85</span><span class="co">]</span>" layout-valign="top"}</span>
<span id="cb118-61"><a href="#cb118-61" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/personal_opinion.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb118-62"><a href="#cb118-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-63"><a href="#cb118-63" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Jeder nennt in der Statistik sein Y und X wie er möchte. Da ich hier nicht nur von Y und X schreiben will, führe ich eben die Worte ein, die ich nutzen will. Damit sind die Worte dann auch richtig, da der Kontext definiert ist. Andere mögen es dann anders machen. Ich mache es eben dann so. Danke." --- Jochen Kruppa-Scheetz, meiner bescheidener Meinung nach.*</span></span>
<span id="cb118-64"><a href="#cb118-64" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb118-65"><a href="#cb118-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-66"><a href="#cb118-66" aria-hidden="true" tabindex="-1"></a>In dem folgenden Kasten erkläre ich nochmal den Gebrauch meiner Begriffe im statistischen Testen. Es ist wichtig, dass wir hier uns klar verstehen. Zum einen ist es angenehmer auch mal ein Wort für ein Symbol zu schreiben. Auf der anderen Seite möchte ich aber auch, dass du dann das Wort richtig einem Konzept im statistischen Modellieren zuordnen kannst. Deshalb einmal hier meine persönliche und didaktische Zusammenstellung meiner Wort im statistischen Modellieren. Du kannst dann immer zu dem Kasten zurückgehen, wenn wir mal ein Wort nicht mehr ganz klar ist. Die fetten Begriffe sind die üblichen in den folgenden Kapiteln. Die anderen Worte werden immer mal wieder in der Literatur genutzt.</span>
<span id="cb118-67"><a href="#cb118-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-68"><a href="#cb118-68" aria-hidden="true" tabindex="-1"></a>{{&lt; include stat-modeling/stat-modeling-callout-words.qmd &gt;}}</span>
<span id="cb118-69"><a href="#cb118-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-70"><a href="#cb118-70" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Wie multiple Einflussvariablen interpretieren? {.unnumbered .unlisted}</span></span>
<span id="cb118-71"><a href="#cb118-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-72"><a href="#cb118-72" aria-hidden="true" tabindex="-1"></a>Wie schon im Zitat am Anfang erwähnt, heißt die Regel, dass wir jeden Koeffizienten unseres Modell nur in soweit interpretieren können, wenn sich die anderen Einflussvariablen nicht ändern. Das klingt jetzt kryptisch und macht eigentlich nur Sinn, wenn man schon alles verstanden hat. Deshalb hier einmal die Analogie mit Schaltern und Schieberegelern. Wir können eine kategoriale Variable oder Faktor durch die Level durchschalten. Daher können wir uns den Effekt von weiblichen oder männlichen Flöhen anschauen. Es gibt aber nur diese beiden Möglichkeiten. Entweder steht der Schalter auf männlichen Floh oder aber auf weiblichen Floh. Etwas anderes ist es wenn wir uns eine Kovariate vorliegen haben. Eine kontinuierliche Einflussvariable können wir beliebig einstellen. Wir können das Gewicht eines Flohs eben hin und herschieben um einen Wert zu haben.</span>
<span id="cb118-73"><a href="#cb118-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-74"><a href="#cb118-74" aria-hidden="true" tabindex="-1"></a><span class="al">![Unterschied zwischen einer kategorialen Variable und einer kontinuierlichen Variable in einem statistischen Modell visualisiert als Schalter und Schieberegler. Übersetzt nach @heiss2022](images/marginal/slider-switch-annotated-trans.png)</span>{#fig-utest-intro-01 fig-align="center" width="100%"}</span>
<span id="cb118-75"><a href="#cb118-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-76"><a href="#cb118-76" aria-hidden="true" tabindex="-1"></a>In einer multiplen Regression kombinieren wir nun alles miteinander. Wir haben eben eine Art Mischpult vorliegen. Auf unserem Mischpult finden wir eben Schalter und Schieberegler. Wir haben dann auch in unserem Modell Faktoren und Kovariaten vorliegen. Dann können wir auch Schalter auf verschiedene Positionen setzen und die Regler verschieden einstellen.</span>
<span id="cb118-77"><a href="#cb118-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-78"><a href="#cb118-78" aria-hidden="true" tabindex="-1"></a><span class="al">![Kombination verschiedener kategorialer Variablen und kontinuierlichen Variablen in einem statistischen Modell visualisiert als Mischpult. Übersetzt nach @heiss2022](images/marginal/mixer-board-annotated-trans.png)</span>{#fig-utest-intro-02 fig-align="center" width="100%"}</span>
<span id="cb118-79"><a href="#cb118-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-80"><a href="#cb118-80" aria-hidden="true" tabindex="-1"></a>Worher kommt nun die Interpretation, dass wir eine Einflussvaribale nur interpretieren können, wenn wir den Rest der Einflussvariablen konstant halten? Wenn wir an dem Schieberegler des Gewichts der Flöhe drehen, dann müssen die anderen Schalter und Regler still stehen. Wir interpretieren dann eben das sich änderende Gewicht, *für weibliche Flöhe unter der Ernährung mit Ketchup*. Wir können nicht global das gesmate Modell interpretieren. Einen Ausweg bieten die <span class="co">[</span><span class="ot">Marginal effect models</span><span class="co">](#sec-marginal)</span>, aber diese werden wir in diesem Kapitel nur am Rande behandeln. Dafür ist das Thema zu komplex. Daher behalte ich Kopf, wenn wir später einzelne Einflussvariablen betrachten, dann tuen wir das immer im Kontext fixierter anderer Einflussvariablen.</span>
<span id="cb118-81"><a href="#cb118-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-82"><a href="#cb118-82" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Eine Frage der Einheit! {.unnumbered .unlisted}</span></span>
<span id="cb118-83"><a href="#cb118-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-84"><a href="#cb118-84" aria-hidden="true" tabindex="-1"></a>Die Einheit von den Messwerten oder auch Kovariaten hat einen nicht zu unterschätzenden Einfluss auf die Interpretation der Koeffizienten oder eben der Effekt einer multiplen linearen Modellierung. Da wir ja mehrere Einflussvariablen vorliegen haben bist du schnell dabei die Koeffizienten der Steigung untereinander zu vergleichen. Dann kommt man schnell zu einem Schluss der eventuell nicht wahr ist. Ich zeige dir hier einmal in der folgenden Abbildung den Fall, wo wir visuell die gleiche Steigung in den Daten vorliegen haben. Was sich aber in den beiden Abbildungen fundamental unterscheidet ist die Einheit der Kovariate.</span>
<span id="cb118-85"><a href="#cb118-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-86"><a href="#cb118-86" aria-hidden="true" tabindex="-1"></a><span class="al">![Der Zusammenhang von Hohlstrunk Boniturnote und Kopfgewicht sowie Strunkdurchmesser. In dem Beispiel ist gut der Zusammenhang zwischen der Steigung und der Einheit der Kovariate zu erkennen.](images/corr_example_einheit.jpeg)</span>{#fig-corr-01 fig-align="center"}</span>
<span id="cb118-87"><a href="#cb118-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-88"><a href="#cb118-88" aria-hidden="true" tabindex="-1"></a>In der linken Abbildung ist der Koeffizient der Steigung des Kopfgewichts $0.021$ mehr mittlere Boniturnote pro Gramm Kopfgewicht. Das wirkt sehr klein. Im Gegensatz ist der Koeffizient der Steigung des Strunkdurchmessers $5.15$ mehr mittlere Boniturnoten pro Zentimeter Strunkdurchmesser. Es wirkt als hätte der Strunkdurchmesser einen viel größeren Effekt als das Gewicht auf die Boniturnoten. Das ist aber ein Trugschluss, wie wir dann gleich nochmal sehen werden. Ich zeige dir den Zusammenhang hier nochmal in der Tabelle.</span>
<span id="cb118-89"><a href="#cb118-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-90"><a href="#cb118-90" aria-hidden="true" tabindex="-1"></a>|                  | Kopfgewicht <span class="sc">\[</span>g<span class="sc">\]</span>          | Strunkdurchmesser <span class="sc">\[</span>cm<span class="sc">\]</span>   |</span>
<span id="cb118-91"><a href="#cb118-91" aria-hidden="true" tabindex="-1"></a>|:-----------------|----------------------------|----------------------------|</span>
<span id="cb118-92"><a href="#cb118-92" aria-hidden="true" tabindex="-1"></a>| Gradengleichung  | $y = 0.021 \cdot x - 8.42$ | $y = 5.15 \cdot x - 16.65$ |</span>
<span id="cb118-93"><a href="#cb118-93" aria-hidden="true" tabindex="-1"></a>| Bestimmtheitsmaß | $R^2 = 0.74$               | $R^2 = 0.93$               |</span>
<span id="cb118-94"><a href="#cb118-94" aria-hidden="true" tabindex="-1"></a>| Faktor Steigung  | $\times1$                  | $\times 245.24$            |</span>
<span id="cb118-95"><a href="#cb118-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-96"><a href="#cb118-96" aria-hidden="true" tabindex="-1"></a>: Vergleich vom Kopfgewicht und dem Strunkdurchmesser nach Gradengleichung, Bestimmtheitsmaß und dem Faktor der Steigung für Strunkdurchmesser. {#tbl-einheit}</span>
<span id="cb118-97"><a href="#cb118-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-98"><a href="#cb118-98" aria-hidden="true" tabindex="-1"></a>Wir würden jetzt meinen, dass der Effekt des Strunkdurchmessers 245mal größer ist als der des Kopfgewichts. Das ist aber ein Trugschluss! Wir haben die Einheiten nicht beachtet. Die Spannweite bei dem Kopfgewicht geht von etwas über 450 Gramm bis fast 750 Gramm. Daher ist die Steigerung um eine Einheit nur eine kleine Menge mehr an Boniturnote. Bei dem Strunkdurchmesser haben wir als kleinsten Wert 3.5cm und als höchsten Wert 5cm für die Grade. Erhöhen wir den Strunkdurchmesser um 1 Zentimeter durchlaufen wir fast die gesamte Spannweite. Wenn du für den Vergleich eine einheitslose Steigung brauchst, dann schaue nochmal in dem <span class="co">[</span><span class="ot">Kapitel zur Korrelation</span><span class="co">](#sec-lin-reg-corr)</span> vorbei oder weiter unten in dem entsprechenden Abschnitt zur Einheit.</span>
<span id="cb118-99"><a href="#cb118-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-100"><a href="#cb118-100" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Wie verschiedene Modelle darstellen? {.unnumbered .unlisted}</span></span>
<span id="cb118-101"><a href="#cb118-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-102"><a href="#cb118-102" aria-hidden="true" tabindex="-1"></a>Häufig stellt sich dann die Frage, wie so multiple Regressionsmodelle dargestellt werden können. Daher hier gleich einmal vorweg ein Beispiel für eine Darstellung einer multiplen linearen Regression in einer wissenschaftlichen Arbeit. In der Arbeit <span class="co">[</span><span class="ot">Energy expenditure and obesity across the economic spectrum</span><span class="co">](https://www.pnas.org/doi/10.1073/pnas.2420902122)</span> von @mcgrosky2025energy wird die multiple lineare Regression genutzt um den Zusammenhang von Energieaufnahme und dem Energieverbauch in veschiedenen Entwicklungsstufen von Ländern zu modellieren. Dabei kommt eigentlich ein recht spannendes Ergebnis heraus, wenn ich das einmal sehr kanpp zitieren darf. Es kommt eben mehr auf die Energieaufnahme als auf den Verbrauch an. Oder anders herum, wenn du abnehmen willst achte auf dein Essen und nicht so sehr auf deine Bewegung.</span>
<span id="cb118-103"><a href="#cb118-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-104"><a href="#cb118-104" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Our analyses suggest that increased energy intake has been roughly 10 times more important than declining total energy expenditure (TEE) in driving the modern obesity crisis." --- @mcgrosky2025energy*</span></span>
<span id="cb118-105"><a href="#cb118-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-106"><a href="#cb118-106" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle siehst du dann eimal das multiple lineare Modell mit dem prozentualen Körperfettanteil als Messwert. Es wurden dann acht verschiedene multiple Modelle gerechnet und in jedem Modell wurden andere Einflussvariablen aufgenommen. In der vorletzten Zeile findest du dann noch das Bestimmtheitsmaß $R^2$, was dir angibt wie gut das Modell funktioniert hat. Hier wollen wir eigentlich einen Wert gegen Eins sehen, aber in Beobachtungsdaten wie hier, ist eine höhere Zahl erstmal eine bessere Zahl.</span>
<span id="cb118-107"><a href="#cb118-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-108"><a href="#cb118-108" aria-hidden="true" tabindex="-1"></a><span class="al">![Lineare Modelle für den Einfluss des Anteils ultraverarbeiteter Lebensmittel in der Ernährung (Anteil an der gesamten Kalorienaufnahme, %UPF) und des Fleischkonsums (kg pro Kopf) auf den Körperfettanteil. Signifikante Effekte (\*p\&lt;0,05, \*\*p\&lt;0,01, \*\*\*p\&lt;0,001) in Fettdruck, negative Effekte in Blau. Quelle: @mcgrosky2025energy](images/mcgrosky2025energy.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb118-109"><a href="#cb118-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-110"><a href="#cb118-110" aria-hidden="true" tabindex="-1"></a>Was sagt uns jetzt die Tabelle aus? Zuerst einmal rechnen wir hier acht Modelle in den Spalten der Tabelle, die wir dann untereinander vergleichen. Wir nehmen verschiedene Einflussvariablen mit in das Modell, die alle in den Zeilen stehen. Teilweise ist das bei kategorialen Variablen wie dem Geschlecht die Gruppe angegeben. Wie interpretieren wir nun diese Tabelle? Hier einmal ein Auszug zu dem Einfluss des Fleischkonsum (eng. *per capita meat consumption*) in den letzten drei Spalten auf den Messwert Körperfetrprozent.</span>
<span id="cb118-111"><a href="#cb118-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-112"><a href="#cb118-112" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"\[...\], per capita meat consumption, another dietary change associated with development, was not significantly associated with fat percentage when added to models including percent ultraprocessed foods (UPF) \[i.e., industrial formulations of five or more ingredients (29)\]" --- @mcgrosky2025energy*</span></span>
<span id="cb118-113"><a href="#cb118-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-114"><a href="#cb118-114" aria-hidden="true" tabindex="-1"></a>Was lesen wir hier? Wenn wir den Fleischkonsum zusammen mit den hochverarbeiteten Lebensmittel mit ins Modell nehmen, dann wird der Fleichkonsum nicht signifikant. Dies ist eine Art eine multiple lineare Regression zu rechnen und die Einflussvariablen untereinander zu vergleichen. Mehr dazu dann in den folgenden Abschnitten und den entsprechenden <span class="co">[</span><span class="ot">Kapiteln zur statistischen Modellierung</span><span class="co">](https://jkruppa.github.io/stat-modeling-preface.html)</span>.</span>
<span id="cb118-115"><a href="#cb118-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-116"><a href="#cb118-116" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb118-117"><a href="#cb118-117" aria-hidden="true" tabindex="-1"></a><span class="fu">## Defintion von hochverarbeiteten Lebensmittel (eng. *ultraprocessed foods*)</span></span>
<span id="cb118-118"><a href="#cb118-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-119"><a href="#cb118-119" aria-hidden="true" tabindex="-1"></a>Wir können in der Abrbeit von @gibney2019ultra nocheinmal nachlesen, was die aktuelle Definition eines hochverarbeiteten Lebensmittel (eng. *ultraprocessed foods*) ist. Das ist ja immer wieder ein Streitpunkt, der aktuell ja auch noch offen ist. Wir halten uns einmal an die folgende Definition.</span>
<span id="cb118-120"><a href="#cb118-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-121"><a href="#cb118-121" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Industrial formulations typically with 5 or more and usually many ingredients. Besides salt, sugar, oils, and fats, ingredients of ultra-processed foods include food substances not commonly used in culinary preparations, such as hydrolyzed protein, modified starches, and hydrogenated or interesterified oils, and additives whose purpose is to imitate sensorial qualities of unprocessed or minimally processed foods and their culinary preparations or to disguise undesirable qualities of the final product, such as colorants, flavorings, nonsugar sweeteners, emulsifiers, humectants, sequestrants, and firming, bulking, de-foaming, anticaking, and glazing agents." --- @gibney2019ultra*</span></span>
<span id="cb118-122"><a href="#cb118-122" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb118-123"><a href="#cb118-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-124"><a href="#cb118-124" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel findest du dann noch am Ende einige Abschnitte zu Dingen von Interesse. Wenn wir nämlich über den Effekt sprechen, dann müssen wir auch nochmal über die Einheiten von den Einflussvariablen sprechen. Wenn diese sehr unterschiedliche sind, dann kann das zu Problemen führen. Auch können Einflussvariablen mit sehr großen numerischen Werten ein Problem in der Interpretation sein. Dann schauen wir nochmal auf die Korrelation der Einflussvariablen. Eigentlich sollten ja alle Einflussvariablen untereinander unabhängig sein. Dann wollen wir nochmal schauen, wie wir den verschiedene multiple Modelle untereinander vergleichen können um das beste multiple Modell zu finden.</span>
<span id="cb118-125"><a href="#cb118-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-126"><a href="#cb118-126" aria-hidden="true" tabindex="-1"></a>Jetzt kommen wir aber nochmal zu dem theoretischen Hintergrund. Wir wollen hier nochmal gleich verstehen, wie die multiplen Modelle aufgebaut sind und wie die Modelle in R dargestellt werden. Wenn du dich mit dem allgemeinen Hintergrund zufrieden gibst, dann kannst du auch gerne direkt in die Beispiele und deren Auswertung springen. Oder eben dann nochmal später zurückkommen, wenn der Bedarf besteht.</span>
<span id="cb118-127"><a href="#cb118-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-128"><a href="#cb118-128" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretischer Hintergrund</span></span>
<span id="cb118-129"><a href="#cb118-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-130"><a href="#cb118-130" aria-hidden="true" tabindex="-1"></a>In dem theoretischen Hintergrund der multiplen Modelle bleibe ich etwas oberflächlich und gehe nicht auf die mathematischen Hintergründe tiefer ein. Das lohnt hier auch nicht weiter. In den Anwendungen habe ich dann immer noch die theoretische Berechnung in R ergänzt, die dir dann nochmal zeigt, wie in R intern die Modelle gerechnet werden. Ganz allgemein kann ich das Buch von @kery2010introduction wärmstens empfehlen. Dort habe ich viel über die Modelle und die Berechnungen gelernt. In dem Zusammenhang kann ich auch noch @dormann2013parametrische empfehlen, wenn es um die Maximum Likelihood Methode geht, die dort gut beschrieben ist. Ich gebe hier dann die Zusammenfassung wieder.</span>
<span id="cb118-131"><a href="#cb118-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-132"><a href="#cb118-132" aria-hidden="true" tabindex="-1"></a>Beginnen wir nochmal mit dem klassischen statistischen Modell in der folgenden Abbildung. Wir haben Daten vorliegen, die wir in ein Modell und einen Fehler zerlegen wollen. Das liest sich sehr allgemein, in der Praxis haben wir auf der linken Seite den beobachteten Messwert Y stehen und auf der linken Seite das Modell aus dem der erklärte Anteil am Y rauskommt. Die Differenz zu den beobachteten Messwerten ist dann der Fehler. Somit ist unser Modell die Kombination aus dem Messwert und unseren Einflussvariablen. Was die Einflussvariablen an dem Messwert nicht erklären können wandert in den Fehler. Somit wollen wir einen geringen Fehler in unserer Modellierung.</span>
<span id="cb118-133"><a href="#cb118-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-136"><a href="#cb118-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-137"><a href="#cb118-137" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-138"><a href="#cb118-138" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-139"><a href="#cb118-139" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-140"><a href="#cb118-140" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-141"><a href="#cb118-141" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 1.5</span></span>
<span id="cb118-142"><a href="#cb118-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb118-143"><a href="#cb118-143" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Der Zusammenhang von Daten, dem statistischen Modell und dem Fehler. Das Modell versucht durch ein statistisches Modell $f(x)$ den Zusammenhang zwischen den Einflussvariablen dem Messwert zu erklären. Den Anteil des unerklärten Messwert geht in den Fehlerterm. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-144"><a href="#cb118-144" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-model-abstract</span></span>
<span id="cb118-145"><a href="#cb118-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-146"><a href="#cb118-146" aria-hidden="true" tabindex="-1"></a>p_model_abstract </span>
<span id="cb118-147"><a href="#cb118-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-148"><a href="#cb118-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-149"><a href="#cb118-149" aria-hidden="true" tabindex="-1"></a>Erinnern wir uns nochmal an das simple und multiple lineares Modell. Die beiden Modelle entscheiden sich durch die Anzahl an Einflussvariablen. In der folgenden Abbildung siehst du nochmal das simple lineare Modell. Wir haben hier eine Einflussvariable X. Dann kommen noch die Koeffizienten $\beta_0$ für den Intercept und der Koeffizient $\beta_1$ für die Steigung der eine Einflussvariable hinzu. Alles was wir nicht durch die Grae erklären können, wandert dann in die Residuen oder Fehler $\epsilon$. Eine klassische Gradengleichung mit einer Einflussvariable.</span>
<span id="cb118-150"><a href="#cb118-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-153"><a href="#cb118-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-154"><a href="#cb118-154" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-155"><a href="#cb118-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-156"><a href="#cb118-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-157"><a href="#cb118-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-158"><a href="#cb118-158" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2.25</span></span>
<span id="cb118-159"><a href="#cb118-159" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb118-160"><a href="#cb118-160" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Formelschreibweise der simplen linearen Regression beinhaltend die Koeffizienten $\\beta_0$ für den y-Achsenabschnitt sowie $\\beta_1$ für die Steigung der Graden für eine Einflussvariable $x_1$. Die Residuen werden durch $\\epsilon$ abgebildet. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-161"><a href="#cb118-161" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-07</span></span>
<span id="cb118-162"><a href="#cb118-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-163"><a href="#cb118-163" aria-hidden="true" tabindex="-1"></a>p_simple_model</span>
<span id="cb118-164"><a href="#cb118-164" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-165"><a href="#cb118-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-166"><a href="#cb118-166" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel erweitern wir das simple lineare Modell um mehr Einflussvariablen. Dann erhalten wir ein multiples lineares Modell wie in der folgenden Abbildung. Meistens haben wir dann mehr als zwei Einflussvariablen sondern eben $p$ Stück. Jede dieser Einflussvariablen hat dann eine eigene Stigung. Wir haben dann aber immer noch nur einen Intercept vorliegen. Auch haben wir dann am Ende nur einen Wert für die Residuen oder Fehler. Die Einflussvariablen können eine beliebige Kombination an Kovariten und Faktoren sein.</span>
<span id="cb118-167"><a href="#cb118-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-170"><a href="#cb118-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-171"><a href="#cb118-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-172"><a href="#cb118-172" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-173"><a href="#cb118-173" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-174"><a href="#cb118-174" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-175"><a href="#cb118-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2.25</span></span>
<span id="cb118-176"><a href="#cb118-176" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb118-177"><a href="#cb118-177" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Formelschreibweise der multiplen linearen Regression beinhaltend die Koeffizienten $\\beta_0$ für den y-Achsenabschnitt sowie $\\beta_1$ bis $\\beta_p$ für die partielle Steigung der Graden für jede Einflussvariable $x_1$ bis $x_p$. Die Residuen werden durch $\\epsilon$ abgebildet. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-178"><a href="#cb118-178" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-04</span></span>
<span id="cb118-179"><a href="#cb118-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-180"><a href="#cb118-180" aria-hidden="true" tabindex="-1"></a>p_mult_model </span>
<span id="cb118-181"><a href="#cb118-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-182"><a href="#cb118-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-183"><a href="#cb118-183" aria-hidden="true" tabindex="-1"></a>Jetzt können wir uns nochmal die Formelschreibweise in R anschauen. Wir brauchen hier natürlich nicht die Koeffizienten zu benennen, denn wir wollen die Werte für die Steigung und den Intercept ja durch die multiple Regression bestimmen. Wir schreiben dann auf die linke Seite der Tilde <span class="in">`~`</span> unseren Messwert und auf die rechte Seite dann die Einflussvariablen durch ein Plus <span class="in">`+`</span> miteinander verbunden. Wir lernen dann im Kapitel zum <span class="co">[</span><span class="ot">Modellieren in R</span><span class="co">](#sec-modeling-R)</span> noch andere Möglichkeiten in der Formelschreibweise in R. Häufig reichen die Grundlagen aber aus.</span>
<span id="cb118-184"><a href="#cb118-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-187"><a href="#cb118-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-188"><a href="#cb118-188" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-189"><a href="#cb118-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-190"><a href="#cb118-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-191"><a href="#cb118-191" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-192"><a href="#cb118-192" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb118-193"><a href="#cb118-193" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb118-194"><a href="#cb118-194" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Statistische Modellschreibweise in R mit dem Messwert auf der linken Seite und den Einflussvariablen auf der rechten Seite der Tilde. Die Platzhalter $Y$ und $X$ werden durch die Spaltennamen im Datensatz ersetzt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-195"><a href="#cb118-195" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-22</span></span>
<span id="cb118-196"><a href="#cb118-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-197"><a href="#cb118-197" aria-hidden="true" tabindex="-1"></a>p_lhs_rhs_mult_r </span>
<span id="cb118-198"><a href="#cb118-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-199"><a href="#cb118-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-200"><a href="#cb118-200" aria-hidden="true" tabindex="-1"></a>Jetzt könnte man meinen, so kompliziert ist es ja dann doch nicht. Dafür musst du aber noch wissen, dass wir nicht nur eine Art von Messwert vorliegen haben. Jeder Messwert auf der linken Seite der Tilde folgt einer Verteilung. Zwar sind die Arten der Verteilungen in etwa begrenz, aber wir haben doch einige vorliegen. Daher müssen wir abhängig von der Verteilunsgfamilie noch die Regression ändern. In der folgenden Abbildung habe ich dir einmal den Zusammenhang der schrecklich netten Verteilunsgfamilie zusammengefasst. Wir müssen eben entscheiden, welcher Verteilungsfamilie unser Messwert angehört und dann eben schauen, wie unsere Einflussvariablen beschaffen sind. Daraus ergibt sich dann die Interpretation des statistischen Modells. Mehr dazu dann in den folgenden Abschnitten und den entsprechenden <span class="co">[</span><span class="ot">Kapiteln zur statistischen Modellierung</span><span class="co">](https://jkruppa.github.io/stat-modeling-preface.html)</span>.</span>
<span id="cb118-201"><a href="#cb118-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-204"><a href="#cb118-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-205"><a href="#cb118-205" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-206"><a href="#cb118-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-207"><a href="#cb118-207" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-208"><a href="#cb118-208" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-209"><a href="#cb118-209" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.7</span></span>
<span id="cb118-210"><a href="#cb118-210" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb118-211"><a href="#cb118-211" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Erweiterte Darstellung der statistischen Modellierung. Die Messwerte $Y$ folgen einer Verteilung. Die Einflussvariablen liegen kontinuierlich als Kovariaten oder aber kategorial als Faktoren vor. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-212"><a href="#cb118-212" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-09</span></span>
<span id="cb118-213"><a href="#cb118-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-214"><a href="#cb118-214" aria-hidden="true" tabindex="-1"></a>p_lhs_rhs_detail</span>
<span id="cb118-215"><a href="#cb118-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-216"><a href="#cb118-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-217"><a href="#cb118-217" aria-hidden="true" tabindex="-1"></a>Damit sind wir hier für das erste auch durch mit der theoretischen Betrachtung. Ich habe dann bei dem kausalen Modellen immer noch einen Tab ergänzt in dem ich mehr auf die Hinetrgründe eingehe. Wir wollen hier aber nichts händsich rechnen, so dass ich mich auf die praktsiche Umsetzung in R konzentriere. Teilweise gibt es dann wieder Überschneidungen mit der ANOVA oder anderen Kapiteln, aber das ist dann eben auch so gewollt.</span>
<span id="cb118-218"><a href="#cb118-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-219"><a href="#cb118-219" aria-hidden="true" tabindex="-1"></a>::: {layout="<span class="co">[</span><span class="ot">25,75</span><span class="co">]</span>" layout-valign="center"}</span>
<span id="cb118-220"><a href="#cb118-220" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/angel_01.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb118-221"><a href="#cb118-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-222"><a href="#cb118-222" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *Wenn du jetzt denkst 'Hä? Was soll denn mehrdimensional bedeuten?', dann besuche doch einmal die fantastische Seite [Explained Visually \| Ordinary Least Squares Regression](https://setosa.io/ev/ordinary-least-squares-regression/) um selber zu erfahren, was eine multiple lineare Regression macht. Auf der Seite findest du interaktive Abbildungen, die dir das Konzept der linearen Regression sehr anschaulich nachvollziehen lassen.*</span></span>
<span id="cb118-223"><a href="#cb118-223" aria-hidden="true" tabindex="-1"></a><span class="at">:::</span></span>
<span id="cb118-224"><a href="#cb118-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-225"><a href="#cb118-225" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb118-226"><a href="#cb118-226" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Tutorien für die multiple lineare Regression</span></span>
<span id="cb118-227"><a href="#cb118-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-228"><a href="#cb118-228" aria-hidden="true" tabindex="-1"></a>Wir immer geht natürlich mehr als ich hier Vorstellen kann. Du findest im Folgenden Tutorien, die mich hier in dem Kapitel inspiriert haben. Ich habe mich ja in diesem Kapitel auf die Durchführbarkeit in R und die allgemeine Verständlichkeit konzentriert.</span>
<span id="cb118-229"><a href="#cb118-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-230"><a href="#cb118-230" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wir funktioniert nun so eine lineare Regression und was sind den jetzt eigentlich die Koeffizienten $\beta_0$ und $\beta_1$ eigentlich? Hier gibt es die fantastische Seite <span class="co">[</span><span class="ot">Explained Visually \| Ordinary Least Squares Regression</span><span class="co">](https://setosa.io/ev/ordinary-least-squares-regression/)</span>, die dir nochmal erlaubt selbe mit Punkten in einem Scatterplot zu spielen und zu sehen wie sich dann die Regressionsgleichung ändert.</span>
<span id="cb118-231"><a href="#cb118-231" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das Buch <span class="co">[</span><span class="ot">Tidy Modeling with R</span><span class="co">](https://www.tmwr.org/)</span> gibt nochmal einen tieferen Einblick in das Modellieren in R. Wir immer, es ist ein Vorschlag aber kein Muss.</span>
<span id="cb118-232"><a href="#cb118-232" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das R Paket <span class="co">[</span><span class="ot">`{jtools}`</span><span class="co">](https://jtools.jacob-long.com/articles/summ)</span> gibt nochmal Möglichkeiten sich schnönere <span class="in">`summary()`</span> Ausgaben erstellen zu lassen.</span>
<span id="cb118-233"><a href="#cb118-233" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das R Paket <span class="co">[</span><span class="ot">`{modelsummary}`</span><span class="co">](https://modelsummary.com/)</span> ist perfekt dafür geeignet nochmal verschiedene Modelle miteinander zu vergleichen.</span>
<span id="cb118-234"><a href="#cb118-234" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb118-235"><a href="#cb118-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-236"><a href="#cb118-236" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb118-237"><a href="#cb118-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-238"><a href="#cb118-238" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb118-239"><a href="#cb118-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-240"><a href="#cb118-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb118-241"><a href="#cb118-241" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb118-242"><a href="#cb118-242" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, broom, correlation, jtools,</span></span>
<span id="cb118-243"><a href="#cb118-243" aria-hidden="true" tabindex="-1"></a><span class="in">               see, performance, car, parameters, modelsummary,</span></span>
<span id="cb118-244"><a href="#cb118-244" aria-hidden="true" tabindex="-1"></a><span class="in">               ggpmisc, tinytable, conflicted)</span></span>
<span id="cb118-245"><a href="#cb118-245" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(magrittr::set_names)</span></span>
<span id="cb118-246"><a href="#cb118-246" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(ggplot2::annotate)</span></span>
<span id="cb118-247"><a href="#cb118-247" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb118-248"><a href="#cb118-248" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb118-249"><a href="#cb118-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-250"><a href="#cb118-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-251"><a href="#cb118-251" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb118-252"><a href="#cb118-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-253"><a href="#cb118-253" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb118-254"><a href="#cb118-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-255"><a href="#cb118-255" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel schauen wir uns zwei Datensätze an. Zum einen den Datensatz zu den Sprungweiten von Flöhen und anderen Messwerten. Eigentlich ein faktorielles Experiment mit zwei Faktoren und einiges an spannenden Kovariaten. An diesem Datensatz können wir dann die verschiedenen multiplen Regressionen einmal nachvollziehen. Als zweiten Datensatz habe ich Schlangen mitgebracht. Der Datensatz ist super klein und auch sehr künstlich, da wir uns hier nur die theoretischen Berechnungen in R anschauen wollen. Da brauche ich nicht viel und da habe ich diesen Datensatz dann genutzt.</span>
<span id="cb118-256"><a href="#cb118-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-257"><a href="#cb118-257" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Modellierung von Flöhen {.unnumbered .unlisted}</span></span>
<span id="cb118-258"><a href="#cb118-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-259"><a href="#cb118-259" aria-hidden="true" tabindex="-1"></a><span class="al">![In unseren Daten zu der Modellierung der Flöhe schauen wir auf verschiedene Ernährungsformen sowie Entwicklungsstadien und fragen uns, ob sich die Sprungweiten und andere Messwerte unterscheiden.](images/flea_feeding_stage.png)</span>{#fig-flea-yedi fig-align="center" width="60%"}</span>
<span id="cb118-260"><a href="#cb118-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-261"><a href="#cb118-261" aria-hidden="true" tabindex="-1"></a>Der folgende Datensatz zu den Sprungweiten und anderen Messwerten von juvenilen und adulten Flöhen ist von mir so gebaut, dass wir hier usn einige Aspekte der multiplen Regression gut anschauen können. Als Hauptfaktor haben wir hier drei verschiedene Ernährungsformen vorliegen und betrachten als zweiten Faktor eben den Entwicklungsstand der Flöhe. Dazu kommen dann noch eine ganze Reihe von Einflussvariablen wie das Gewicht und Laborwerte. Insgesamt also ein sehr großer Datensatz. Wir schauen uns dann aber immer nur einzelene Kombinationen von Einflussvariablen an. Als meinen Messwert nehme ich dann immer die Sprungweite als einen normalverteilten Messwert.</span>
<span id="cb118-262"><a href="#cb118-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-265"><a href="#cb118-265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-266"><a href="#cb118-266" aria-hidden="true" tabindex="-1"></a>flea_model_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_model_data.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb118-267"><a href="#cb118-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">feeding =</span> <span class="fu">as_factor</span>(feeding),</span>
<span id="cb118-268"><a href="#cb118-268" aria-hidden="true" tabindex="-1"></a>         <span class="at">stage =</span> <span class="fu">as_factor</span>(stage),</span>
<span id="cb118-269"><a href="#cb118-269" aria-hidden="true" tabindex="-1"></a>         <span class="at">bonitur =</span> <span class="fu">as.numeric</span>(bonitur),</span>
<span id="cb118-270"><a href="#cb118-270" aria-hidden="true" tabindex="-1"></a>         <span class="at">infected =</span> <span class="fu">as_factor</span>(infected))</span>
<span id="cb118-271"><a href="#cb118-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-272"><a href="#cb118-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-273"><a href="#cb118-273" aria-hidden="true" tabindex="-1"></a>Da der Datensatz so groß ist, schaue ich mir hier nicht alle möglichen Abbildungen an sondern gebe dir hier einmal einen Auszug aus der Tabelle wieder. Wie du siehst haben wir einiges an Möglichkeiten mit den Daten. Wir haben hier verschiedene Einflussvariablen sowie verschiedene Messwerte vorliegen.</span>
<span id="cb118-274"><a href="#cb118-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-277"><a href="#cb118-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-278"><a href="#cb118-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-279"><a href="#cb118-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-280"><a href="#cb118-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-281"><a href="#cb118-281" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-model-table</span></span>
<span id="cb118-282"><a href="#cb118-282" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Tabelle der Modelldaten zu den Sprungweiten und den Ernährungsformen von juvenilen und adulten Flöhen."</span></span>
<span id="cb118-283"><a href="#cb118-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-284"><a href="#cb118-284" aria-hidden="true" tabindex="-1"></a>model_raw_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/fleas_model_data.xlsx"</span>)</span>
<span id="cb118-285"><a href="#cb118-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-286"><a href="#cb118-286" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(model_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>),</span>
<span id="cb118-287"><a href="#cb118-287" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(model_raw_tbl)),</span>
<span id="cb118-288"><a href="#cb118-288" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(model_raw_tbl, <span class="at">n =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb118-289"><a href="#cb118-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb118-290"><a href="#cb118-290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-291"><a href="#cb118-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-292"><a href="#cb118-292" aria-hidden="true" tabindex="-1"></a>In den folgenden Abschnitten nehem ich dann immer wieder einzelne Einflussvariablen und kombiniere diese miteinander in ein statistsiches Modell. Dabei nehme ich als Messwert immer die Sprungweite der Flöhe. Mehr Informationen findest du dann im <span class="co">[</span><span class="ot">Kapitel zu von der Modellierung der Flöhe</span><span class="co">](#sec-example-flea-model)</span>. Dort sind dann auch die Einheiten und übersichtliche Abbildungen zu finden.</span>
<span id="cb118-293"><a href="#cb118-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-294"><a href="#cb118-294" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Theoretischer Datensatz {.unnumbered .unlisted}</span></span>
<span id="cb118-295"><a href="#cb118-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-296"><a href="#cb118-296" aria-hidden="true" tabindex="-1"></a><span class="al">![In unseren theoretischen Datensatz schauen wir uns die Körperlängen von verschiedenen Schlangen mit unterschiedlichen Einflussvariablen an. Wir schauen uns die Körperfarbe sowie die Regionen der Messung an.](images/snakes_region.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb118-297"><a href="#cb118-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-298"><a href="#cb118-298" aria-hidden="true" tabindex="-1"></a>Abschließend kommen wir noch zu einem theoretischen Datensatz dem ich @kery2010introduction entlehnt habe. Ich möchte nochmal zeigen, wie R intern mit der Modellmatrix die Berechnungen durchführt. Das hat mich interessiert und deshalb habe ich es einmal für mein Verständnis aufgeschrieben. Wenn es dich auch interessiert, dann kannst du in den entsprechenden Tabs weiter unten einmal nachschauen. Hier also erstmal ein sehr simpler theoretischer Datensatz zu Körperlängen von Schlangen. Wir müssen hier dann noch die Faktoren einmal umwandeln, damit wir auch später die Modellmatrix sauber vorliegen haben. Deshalb hier die explizite Benennung der Level der Faktoren in dem Datensatz.</span>
<span id="cb118-299"><a href="#cb118-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-302"><a href="#cb118-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-303"><a href="#cb118-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-304"><a href="#cb118-304" aria-hidden="true" tabindex="-1"></a>snake_tbl <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/regression_data.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"theory_mult"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb118-305"><a href="#cb118-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">region =</span> <span class="fu">factor</span>(region, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"west"</span>, <span class="st">"nord"</span>)),</span>
<span id="cb118-306"><a href="#cb118-306" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="fu">factor</span>(color, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"schwarz"</span>, <span class="st">"rot"</span>, <span class="st">"blau"</span>)))</span>
<span id="cb118-307"><a href="#cb118-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-308"><a href="#cb118-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-309"><a href="#cb118-309" aria-hidden="true" tabindex="-1"></a>In der folgenden Tabelle ist der Datensatz <span class="in">`snake_tbl`</span> nochmal dargestellt. Wir haben die Schlangenlänge <span class="in">`svl`</span> als Messwert sowie das Gewicht der Schlangen <span class="in">`mass`</span> sowie den Durchmesser der Schlange $diameter$ als kontinuierliche Einflussvariable, die Sammelregion <span class="in">`region`</span> und die Farbe der Schlangen <span class="in">`color`</span> und als kategoriale Einflussvariablen mit unterschiedlichen Anzahlen an Gruppen. Die Region <span class="in">`region`</span> ist also ein Faktor mit zwei Leveln und die Schlangenfarbe <span class="in">`color`</span> ein Faktor mit drei Leveln. Ich nutze den Datensatz also einmal als einen Spieldatensatz um die Modellierung theoretisch besser nachvollziehen zu können.</span>
<span id="cb118-310"><a href="#cb118-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-313"><a href="#cb118-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-314"><a href="#cb118-314" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-315"><a href="#cb118-315" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-316"><a href="#cb118-316" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Datensatz zu den Körperlängen als Messwert von acht Schlangen mit verschiedenen Einflussvariablen. Die Einflussvariablen haben verschiedene Eigenschaften und müssen daher unterschiedliche modelliert werden."</span></span>
<span id="cb118-317"><a href="#cb118-317" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-snakes</span></span>
<span id="cb118-318"><a href="#cb118-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-319"><a href="#cb118-319" aria-hidden="true" tabindex="-1"></a>snake_tbl <span class="sc">|&gt;</span> </span>
<span id="cb118-320"><a href="#cb118-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb118-321"><a href="#cb118-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-322"><a href="#cb118-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-323"><a href="#cb118-323" aria-hidden="true" tabindex="-1"></a>Damit haben wir dann auch die beiden Datensätze zusammen. Im Folgenden gehe ich dann einmal auf das kausale Modell sowie das prädktive Modell ein. Hier nimmt das kausale Modell mehr Platz ein, da wir eigentlich in der multiplen Regression mehr an dem Zusammenhang interessiert sind. Die Prädiktion ist aber immer mehr im Vormarsch und es kommt hier wirklich auf deine Fragestellung an. Es kann sogar sein, dass du mit vorgesagten Werten mehr Informationen aus deinen Daten ziehen kannst, als mit einem kausalen Modell.</span>
<span id="cb118-324"><a href="#cb118-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-325"><a href="#cb118-325" aria-hidden="true" tabindex="-1"></a><span class="fu">## Kausales Modell</span></span>
<span id="cb118-326"><a href="#cb118-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-327"><a href="#cb118-327" aria-hidden="true" tabindex="-1"></a>Was ist das kausale Modell? Wir wollen wissen, welchen Einfluss die Einflussvariablen auf den Messwert haben. Das ist jetzt erstmal einleuchtend. Wir bauen uns ein Modell und wollen wissen, ob es einen kausalen Zusammenhang zwischen einzelnen Kovariaten oder Faktoren und einem Messwert gibt. Dabei müssen nicht alle Kovariaten und alle Faktoren einen signifikanten Einfluss haben. Es geht hier eher um eine Art vor und zurück. Wir probieren verschiedene Modell aus und wollen das beste Modell finden. Dafür müssen wir abr verstehen, was die Interpretation der einzelnen Modell ist. Daher schauen wir uns jetzt einmal rein kovariate Modelle, reine faktorielle Modelle und Kombinationen davon an.</span>
<span id="cb118-328"><a href="#cb118-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-329"><a href="#cb118-329" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mehrkovariates Modell</span></span>
<span id="cb118-330"><a href="#cb118-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-331"><a href="#cb118-331" aria-hidden="true" tabindex="-1"></a>Beginnen wir mit einem mehrkovariaten Modell. Im Gegensatz zu einem einkovaraten Modell in der simplen linearen Regression haben wir jetzt nicht mehr nur eine Kovariate sondern mindestens zwei Kovariaten im Modell. Für die Interpretation nutzen wir hier nur ein zweikovariates Modell inhaltlich lässt sich das Modell aber auch auf mehr als zwei Kovariaten erweitern. In der folgenden Abbildung siehst du einmal das Modell dargestellt. Wir haben einen Messwert auf der linken Seite und zwei Kovariaten auf der rechten Seite. Wir wollen jetzt wissen, wie die beiden Kovariaten den Messwert erklären.</span>
<span id="cb118-332"><a href="#cb118-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-335"><a href="#cb118-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-336"><a href="#cb118-336" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-337"><a href="#cb118-337" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-338"><a href="#cb118-338" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-339"><a href="#cb118-339" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-340"><a href="#cb118-340" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb118-341"><a href="#cb118-341" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb118-342"><a href="#cb118-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches multiples Modell mit einem Messwert $Y$ und zwei kontinuierlichen Einflussvariablen als Kovariate $c_1$ und Kovariate $c_2$ dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-343"><a href="#cb118-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-12</span></span>
<span id="cb118-344"><a href="#cb118-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-345"><a href="#cb118-345" aria-hidden="true" tabindex="-1"></a>p_2cov_model</span>
<span id="cb118-346"><a href="#cb118-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-347"><a href="#cb118-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-348"><a href="#cb118-348" aria-hidden="true" tabindex="-1"></a>Die Grundidee ist in der folgenen Abbildung einmal dargestellt. Du kennst dich ja schon mit der simplen linearen Regression aus. In dem mehrkovariaten Fall haben wir nun im zweikovariaten Fall einen Scatterplit in drei Dimensionen vorliegen. Je mehr Kovariaten desto hoöher wird die Dimension. Ich kann aber nicht einen vier dimensionalen Scatterplot darstellen, daher hier die Einschränkung auf zwei Kovariaten. Wie du siehst zeichnen wir jetzt nicht eine Grade im eigentlichen Sinne sondern eine Ebene durch die Punkte hindurch. Dennoch wird der quadratische Abstand zu den Punkten eben über diese Ebene minimiert. Wir erhalten somit auch nur für jede einzelne Beobachtung einen Wert für die Residuen wieder.</span>
<span id="cb118-349"><a href="#cb118-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-350"><a href="#cb118-350" aria-hidden="true" tabindex="-1"></a><span class="al">![Ein 3D Scatterplot von zwei Kovariaten und einem Messwert Y in drei Dimensionen. Statt eine Grade wird ein Ebene (eng. *regression plane*) durch die Punkte im dreidimensionalen Raum gelegt. Die Residuen sind die Abweichungen der Beobachtungen zu den Werten auf der Ebene. Modifiziert nach https://stackoverflow.com/users/8770170/frans-rodenburg](images/mult-reg-scatter3d-00.png)</span>{#fig-scatter3d-00 fig-align="center" width="100%"}</span>
<span id="cb118-351"><a href="#cb118-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-352"><a href="#cb118-352" aria-hidden="true" tabindex="-1"></a>Die Darstellung einer multiplen linearen Regression ist vollkommen unüblich. Wir zeigen eigentlich nicht die Daten als Visualisierung sondern müssen uns dann mit statistischen Maßzahlen helfen, wenn wir wissen wollen, ob unsere Regression gelungen ist. Deshalb auch im Folgenden einmal die praktische Anwendung in R und wie wir die zweikovariate Regression interpretieren.</span>
<span id="cb118-353"><a href="#cb118-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-354"><a href="#cb118-354" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb118-355"><a href="#cb118-355" aria-hidden="true" tabindex="-1"></a><span class="fu">## Praktisch in R</span></span>
<span id="cb118-356"><a href="#cb118-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-357"><a href="#cb118-357" aria-hidden="true" tabindex="-1"></a>Dann rechnen wir einmal eine zweikovariate Analyse in R. Dafür brauchen wir einmal einen normalverteilten Messwert. Das ist nicht notwendig, aber für die Interpretation gleich viel einfacher. Dann nehmen wir noch die zwei Kovariten des Flohgewichts und der mitleren Anzahl an Beinhaaren mit ins Modell. Damit haben wir also ein klassisches kovariates Modell.</span>
<span id="cb118-358"><a href="#cb118-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-361"><a href="#cb118-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-362"><a href="#cb118-362" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight <span class="sc">+</span> count_leg, <span class="at">data =</span> flea_model_tbl) </span>
<span id="cb118-363"><a href="#cb118-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-364"><a href="#cb118-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-365"><a href="#cb118-365" aria-hidden="true" tabindex="-1"></a>Dann können wir uns auch schon die drei Koeffizienten für den Intercept und die Steigungen für die beiden Kovariaten wiedergeben lassen. Da wir das Modell so rechnen, dass wir beide Kovariaten mit ins Modell nehmen, haben wir hier natürlich auch jeweils für die anderen Kovariate den Effekt adjustiert. Will heißen, wir schauen uns den Effekt des Gewichts bereinigt um den Effekt der Beinhaare auf die Sprungweiten an. Und eben umgekehrt dann auch.</span>
<span id="cb118-366"><a href="#cb118-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-369"><a href="#cb118-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-370"><a href="#cb118-370" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="sc">|&gt;</span> </span>
<span id="cb118-371"><a href="#cb118-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-372"><a href="#cb118-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-373"><a href="#cb118-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-374"><a href="#cb118-374" aria-hidden="true" tabindex="-1"></a>Jetzt müssen wir bei den Koeffizienten aufpassen. Ohne die Einheit, würde man denken, dass der Effekt der mittleren Beinzahl auf die Sprungweite klein wäre. Aber wir haben hier die Steigung pro Änderung der Einheit um Eins in den Einflussvariablen. Die Beinhaare haben aber eine Spannweite von 9 bis 1351! Das ist eine ganz andere Änderung als beim Gewicht mit einer Spannweite von 2.71mg bis 25.73mg. Deshalb brauchen wir auch hier dann die zusammenfassende Ausgabe um einmal die Signifikanz bewerten zu können.</span>
<span id="cb118-375"><a href="#cb118-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-378"><a href="#cb118-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-379"><a href="#cb118-379" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb118-380"><a href="#cb118-380" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb118-381"><a href="#cb118-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-382"><a href="#cb118-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-383"><a href="#cb118-383" aria-hidden="true" tabindex="-1"></a>Die Zusammenfassugn ist manchmal etwas schwer zu lesen, deshalb habe ich dir einmal die Ausgabe im Folgenden annotiert. Hier siehst du dann auch sehr schön, dass die mittlere Anzahl an Haaren auf den Beinen auch signifikant ist. Ansonsten sieht unser Modell recht gut aus. die Resdiuen sind einigermaßen normalverteilt und auch das Bestimmtheitsmaß ist relativ hoch. Der Fehler der Residuen könnte mit 17.78 etwas kleiner sein. Am Ende passt das Modell.</span>
<span id="cb118-384"><a href="#cb118-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-387"><a href="#cb118-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-388"><a href="#cb118-388" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-389"><a href="#cb118-389" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-390"><a href="#cb118-390" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-391"><a href="#cb118-391" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-392"><a href="#cb118-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb118-393"><a href="#cb118-393" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb118-394"><a href="#cb118-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Annotierte Ausgabe der Funktion `summary()` aus einer linearen Modellanpassung mit der Funktion `lm()`. Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten und Informationen zu der Modelgüte. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-395"><a href="#cb118-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-c2-summary</span></span>
<span id="cb118-396"><a href="#cb118-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-397"><a href="#cb118-397" aria-hidden="true" tabindex="-1"></a>p_lm_summary_cov2_explained</span>
<span id="cb118-398"><a href="#cb118-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-399"><a href="#cb118-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-400"><a href="#cb118-400" aria-hidden="true" tabindex="-1"></a>Was sagt jetzt noch diese seltsame ANOVA aus? Wir scheinen hier ja noch eine ANOVA am Ende zu rechnen. Das ist hier jetzt nicht die einfaktorielle ANOVA, die wir aus den simplen linearen Regressionen kennen, sondern beinhaltet einen Modellvergleich. Welche Modelle vergleichen wir aber nun? In diesem Fall einmal das Nullmodell und das volle Modell, welches wir gerechnet haben. Was soll der Name Nullmodell bedeuten? Wir haben in diesem Modell nichts weiter außer dem Intercept. Hier einmal das Nullmodel gerechnet.</span>
<span id="cb118-401"><a href="#cb118-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-404"><a href="#cb118-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-405"><a href="#cb118-405" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb118-406"><a href="#cb118-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-407"><a href="#cb118-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-408"><a href="#cb118-408" aria-hidden="true" tabindex="-1"></a>Wir erhalten also einmal den globalen Mittelwert über alle Sprungweiten wiedergeben. Jetzt können wir mit der ANOVA auch einen MOdellvergleich rechnen. Wir wollen wissen, ob sich unser volles zweifaktorielles Modell von dem Modell nur mit dem Intercept unterscheidet. Da sehen wir wieder den p-Wert wie wir ihn auch oben in der Ausgabe haben.</span>
<span id="cb118-409"><a href="#cb118-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-412"><a href="#cb118-412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-413"><a href="#cb118-413" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">lm</span>(jump_length <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> flea_model_tbl),</span>
<span id="cb118-414"><a href="#cb118-414" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight <span class="sc">+</span> count_leg, <span class="at">data =</span> flea_model_tbl))</span>
<span id="cb118-415"><a href="#cb118-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-416"><a href="#cb118-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-417"><a href="#cb118-417" aria-hidden="true" tabindex="-1"></a>Brauchen wir den Vergleich? Meistens nicht. Denn wir können ja direkt schauen, ob sich die Koeffizienten sigifkant von Nhull unterscheiden. Dann brauchen wir auch nur sehr selten den Vergleich zu dem Nullmodell. Das Nullmodell beinhaltet eigentlich nie eine Information, die wir wirklich brauchen. Daher ist es eher ein Artefakt der Programmierung aus den Anfangstagen. Wir können es, also packen wir es mit in die Ausgabe rein.</span>
<span id="cb118-418"><a href="#cb118-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-419"><a href="#cb118-419" aria-hidden="true" tabindex="-1"></a>Die folgende Abbildung dient hier nur der Anschauung. Wir publizieren eigentlich nicht eine Visualisierung in drei Dimensionen. Wie du hier schon siehst, ist die Darstellung durch die unterschiedlich Minima- und Maximawerte des Gewichts und der Anzahl an Beinhaaren sehr verdreht. Häufig sieht dann die Abbildung in drei Dimensionen nur gut aus, wenn alle drei Achsen die gleichen Spannweiten an Werten haben. Daher dient die Abbildung eher nochmal zum Verständnis der Berechnungen der Residuen aus der Ebene der Regression.</span>
<span id="cb118-420"><a href="#cb118-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-421"><a href="#cb118-421" aria-hidden="true" tabindex="-1"></a><span class="al">![Ein 3D Scatterplot von den zwei Kovariaten Gewicht der Flöhe in \[mg\] sowie der mittleren Anzahl an Beinhaaren und der Sprungweite in drei Dimensionen. Statt eine Grade wird ein Ebene (eng. *regression plane*) durch die Punkte im dreidimensionalen Raum gelegt. Die Residuen sind die Abweichungen der Beobachtungen zu den Werten auf der Ebene.](images/mult-reg-scatter3d-01.png)</span>{fig-align="center" width="100%"}</span>
<span id="cb118-422"><a href="#cb118-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-423"><a href="#cb118-423" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch in R</span></span>
<span id="cb118-424"><a href="#cb118-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-427"><a href="#cb118-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-428"><a href="#cb118-428" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> mass <span class="sc">+</span> diameter, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() </span>
<span id="cb118-429"><a href="#cb118-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-430"><a href="#cb118-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-431"><a href="#cb118-431" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-432"><a href="#cb118-432" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb118-433"><a href="#cb118-433" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb118-434"><a href="#cb118-434" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb118-435"><a href="#cb118-435" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb118-436"><a href="#cb118-436" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb118-437"><a href="#cb118-437" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb118-438"><a href="#cb118-438" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb118-439"><a href="#cb118-439" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb118-440"><a href="#cb118-440" aria-hidden="true" tabindex="-1"></a>  49 <span class="sc">\\</span></span>
<span id="cb118-441"><a href="#cb118-441" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-442"><a href="#cb118-442" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb118-443"><a href="#cb118-443" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-444"><a href="#cb118-444" aria-hidden="true" tabindex="-1"></a>  1 &amp; 6 &amp; 9 <span class="sc">\\</span></span>
<span id="cb118-445"><a href="#cb118-445" aria-hidden="true" tabindex="-1"></a>  1 &amp; 8 &amp; 3 <span class="sc">\\</span></span>
<span id="cb118-446"><a href="#cb118-446" aria-hidden="true" tabindex="-1"></a>  1 &amp; 5 &amp; 6 <span class="sc">\\</span></span>
<span id="cb118-447"><a href="#cb118-447" aria-hidden="true" tabindex="-1"></a>  1 &amp; 7 &amp; 7 <span class="sc">\\</span></span>
<span id="cb118-448"><a href="#cb118-448" aria-hidden="true" tabindex="-1"></a>  1 &amp; 9 &amp; 5 <span class="sc">\\</span></span>
<span id="cb118-449"><a href="#cb118-449" aria-hidden="true" tabindex="-1"></a>  1 &amp; 11&amp; 4 <span class="sc">\\</span></span>
<span id="cb118-450"><a href="#cb118-450" aria-hidden="true" tabindex="-1"></a>  1 &amp; 12&amp; 10 <span class="sc">\\</span></span>
<span id="cb118-451"><a href="#cb118-451" aria-hidden="true" tabindex="-1"></a>  1 &amp; 10&amp; 11 <span class="sc">\\</span></span>
<span id="cb118-452"><a href="#cb118-452" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-453"><a href="#cb118-453" aria-hidden="true" tabindex="-1"></a> \times</span>
<span id="cb118-454"><a href="#cb118-454" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-455"><a href="#cb118-455" aria-hidden="true" tabindex="-1"></a>  \beta_0 <span class="sc">\\</span></span>
<span id="cb118-456"><a href="#cb118-456" aria-hidden="true" tabindex="-1"></a>  \beta_{mass} <span class="sc">\\</span></span>
<span id="cb118-457"><a href="#cb118-457" aria-hidden="true" tabindex="-1"></a>  \beta_{diameter} <span class="sc">\\</span></span>
<span id="cb118-458"><a href="#cb118-458" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb118-459"><a href="#cb118-459" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-460"><a href="#cb118-460" aria-hidden="true" tabindex="-1"></a>  \epsilon_1 <span class="sc">\\</span></span>
<span id="cb118-461"><a href="#cb118-461" aria-hidden="true" tabindex="-1"></a>  \epsilon_2 <span class="sc">\\</span></span>
<span id="cb118-462"><a href="#cb118-462" aria-hidden="true" tabindex="-1"></a>  \epsilon_3 <span class="sc">\\</span></span>
<span id="cb118-463"><a href="#cb118-463" aria-hidden="true" tabindex="-1"></a>  \epsilon_4 <span class="sc">\\</span></span>
<span id="cb118-464"><a href="#cb118-464" aria-hidden="true" tabindex="-1"></a>  \epsilon_5 <span class="sc">\\</span></span>
<span id="cb118-465"><a href="#cb118-465" aria-hidden="true" tabindex="-1"></a>  \epsilon_6 <span class="sc">\\</span></span>
<span id="cb118-466"><a href="#cb118-466" aria-hidden="true" tabindex="-1"></a>  \epsilon_7 <span class="sc">\\</span></span>
<span id="cb118-467"><a href="#cb118-467" aria-hidden="true" tabindex="-1"></a>  \epsilon_8 <span class="sc">\\</span></span>
<span id="cb118-468"><a href="#cb118-468" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-469"><a href="#cb118-469" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-470"><a href="#cb118-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-473"><a href="#cb118-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-474"><a href="#cb118-474" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> mass <span class="sc">+</span> diameter, <span class="at">data =</span> snake_tbl)</span>
<span id="cb118-475"><a href="#cb118-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-476"><a href="#cb118-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-479"><a href="#cb118-479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-480"><a href="#cb118-480" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-481"><a href="#cb118-481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-482"><a href="#cb118-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-485"><a href="#cb118-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-486"><a href="#cb118-486" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-487"><a href="#cb118-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-488"><a href="#cb118-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-489"><a href="#cb118-489" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-490"><a href="#cb118-490" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb118-491"><a href="#cb118-491" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb118-492"><a href="#cb118-492" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb118-493"><a href="#cb118-493" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb118-494"><a href="#cb118-494" aria-hidden="true" tabindex="-1"></a>  51 <span class="sc">\\</span></span>
<span id="cb118-495"><a href="#cb118-495" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb118-496"><a href="#cb118-496" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb118-497"><a href="#cb118-497" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb118-498"><a href="#cb118-498" aria-hidden="true" tabindex="-1"></a>  49 <span class="sc">\\</span></span>
<span id="cb118-499"><a href="#cb118-499" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-500"><a href="#cb118-500" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb118-501"><a href="#cb118-501" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-502"><a href="#cb118-502" aria-hidden="true" tabindex="-1"></a>  28.27 &amp; 6 \cdot 2.67 &amp; 9 \cdot -0.30 <span class="sc">\\</span></span>
<span id="cb118-503"><a href="#cb118-503" aria-hidden="true" tabindex="-1"></a>  28.27 &amp; 8 \cdot 2.67 &amp; 3 \cdot -0.30 <span class="sc">\\</span></span>
<span id="cb118-504"><a href="#cb118-504" aria-hidden="true" tabindex="-1"></a>  28.27 &amp; 5 \cdot 2.67 &amp; 6 \cdot -0.30 <span class="sc">\\</span></span>
<span id="cb118-505"><a href="#cb118-505" aria-hidden="true" tabindex="-1"></a>  28.27 &amp; 7 \cdot 2.67 &amp; 7 \cdot -0.30 <span class="sc">\\</span></span>
<span id="cb118-506"><a href="#cb118-506" aria-hidden="true" tabindex="-1"></a>  28.27 &amp; 9 \cdot 2.67 &amp; 5 \cdot -0.30 <span class="sc">\\</span></span>
<span id="cb118-507"><a href="#cb118-507" aria-hidden="true" tabindex="-1"></a>  28.27 &amp; 11 \cdot 2.67 &amp; 4 \cdot -0.30 <span class="sc">\\</span></span>
<span id="cb118-508"><a href="#cb118-508" aria-hidden="true" tabindex="-1"></a>  28.27 &amp; 12 \cdot 2.67 &amp; 10 \cdot -0.30 <span class="sc">\\</span></span>
<span id="cb118-509"><a href="#cb118-509" aria-hidden="true" tabindex="-1"></a>  28.27 &amp; 10 \cdot 2.67 &amp; 11 \cdot -0.30 <span class="sc">\\</span></span>
<span id="cb118-510"><a href="#cb118-510" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb118-511"><a href="#cb118-511" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-512"><a href="#cb118-512" aria-hidden="true" tabindex="-1"></a>  -1.56 <span class="sc">\\</span></span>
<span id="cb118-513"><a href="#cb118-513" aria-hidden="true" tabindex="-1"></a>  -3.71 <span class="sc">\\</span></span>
<span id="cb118-514"><a href="#cb118-514" aria-hidden="true" tabindex="-1"></a>  -0.80 <span class="sc">\\</span></span>
<span id="cb118-515"><a href="#cb118-515" aria-hidden="true" tabindex="-1"></a>  +6.17 <span class="sc">\\</span></span>
<span id="cb118-516"><a href="#cb118-516" aria-hidden="true" tabindex="-1"></a>  +1.22 <span class="sc">\\</span></span>
<span id="cb118-517"><a href="#cb118-517" aria-hidden="true" tabindex="-1"></a>  +0.58 <span class="sc">\\</span></span>
<span id="cb118-518"><a href="#cb118-518" aria-hidden="true" tabindex="-1"></a>  +0.73 <span class="sc">\\</span></span>
<span id="cb118-519"><a href="#cb118-519" aria-hidden="true" tabindex="-1"></a>  -2.63 <span class="sc">\\</span></span>
<span id="cb118-520"><a href="#cb118-520" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-521"><a href="#cb118-521" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-522"><a href="#cb118-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-525"><a href="#cb118-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-526"><a href="#cb118-526" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">28.27</span> <span class="sc">+</span>  <span class="dv">6</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">9</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">-</span> <span class="fl">1.56</span>,</span>
<span id="cb118-527"><a href="#cb118-527" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span>  <span class="dv">8</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">-</span> <span class="fl">3.71</span>,</span>
<span id="cb118-528"><a href="#cb118-528" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span>  <span class="dv">5</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">6</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">-</span> <span class="fl">0.80</span>,</span>
<span id="cb118-529"><a href="#cb118-529" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span>  <span class="dv">7</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">7</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">+</span> <span class="fl">6.17</span>,</span>
<span id="cb118-530"><a href="#cb118-530" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span>  <span class="dv">9</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">5</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">+</span> <span class="fl">1.22</span>,</span>
<span id="cb118-531"><a href="#cb118-531" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span> <span class="dv">11</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">+</span> <span class="fl">0.58</span>,</span>
<span id="cb118-532"><a href="#cb118-532" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">+</span> <span class="fl">0.73</span>,</span>
<span id="cb118-533"><a href="#cb118-533" aria-hidden="true" tabindex="-1"></a>  <span class="fl">28.27</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">2.67</span> <span class="sc">+</span> <span class="dv">11</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.30</span>) <span class="sc">-</span> <span class="fl">2.63</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>()</span>
<span id="cb118-534"><a href="#cb118-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-535"><a href="#cb118-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-538"><a href="#cb118-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-539"><a href="#cb118-539" aria-hidden="true" tabindex="-1"></a>snake_tbl <span class="sc">|&gt;</span> <span class="fu">pull</span>(svl)</span>
<span id="cb118-540"><a href="#cb118-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-541"><a href="#cb118-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-542"><a href="#cb118-542" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulation</span></span>
<span id="cb118-543"><a href="#cb118-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-546"><a href="#cb118-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-547"><a href="#cb118-547" aria-hidden="true" tabindex="-1"></a>cov2_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb118-548"><a href="#cb118-548" aria-hidden="true" tabindex="-1"></a>                   <span class="at">c_2 =</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb118-549"><a href="#cb118-549" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb118-550"><a href="#cb118-550" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">1</span> <span class="sc">*</span> c_1 <span class="sc">+</span> </span>
<span id="cb118-551"><a href="#cb118-551" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">2</span> <span class="sc">*</span> c_2 <span class="sc">+</span> </span>
<span id="cb118-552"><a href="#cb118-552" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span>
<span id="cb118-553"><a href="#cb118-553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-554"><a href="#cb118-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-557"><a href="#cb118-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-558"><a href="#cb118-558" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> c_2, cov2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb118-559"><a href="#cb118-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-560"><a href="#cb118-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-561"><a href="#cb118-561" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb118-562"><a href="#cb118-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-563"><a href="#cb118-563" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mehrfaktorielles Modell</span></span>
<span id="cb118-564"><a href="#cb118-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-565"><a href="#cb118-565" aria-hidden="true" tabindex="-1"></a>Betrachten wir nun ein mehrfaktorielles Modell. Hier sei aber gleich gesagt, dass wir eigentlich in einem mherfaktoriellen Modell an den Vergleichen der Level in den Faktoren interessiert sind. Wir wollen also eigentlich einen paarweisen Vergleich über die Gruppen rechnen. Damit sind wir dann auf dem ANOVA Pfad mit der <span class="co">[</span><span class="ot">ANOVA</span><span class="co">](#sec-anova)</span> und den <span class="co">[</span><span class="ot">Post-hoc Tests</span><span class="co">](#sec-posthoc)</span>. Wir schauen uns hier also erstmal die Koeffizienten des Modells an, sehr häufig nutzen wir diese Koeffizienten dann aber nicht. Das hat den Grund, dass der Referenzwert ja der Interecept im Modell ist und wir wenig an dem Vergleich zu dem Intercept interessiert sind. Dazu dann aber gleich mehr. Hier dann erstmal das zweifaktorielle Modell mit dem Interaktionsterm. Zu der Interaktion kannst du im <span class="co">[</span><span class="ot">Kapitel zur ANOVA</span><span class="co">](#sec-anova)</span> mehr erfahren.</span>
<span id="cb118-566"><a href="#cb118-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-569"><a href="#cb118-569" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-570"><a href="#cb118-570" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-571"><a href="#cb118-571" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-572"><a href="#cb118-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-573"><a href="#cb118-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-574"><a href="#cb118-574" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb118-575"><a href="#cb118-575" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb118-576"><a href="#cb118-576" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches multiples Modell mit einem Messwert $Y$ und einer kategorialen Einflussvariablen als Faktor $f_A$ mit drei Leveln sowie einer kategorialen Einflussvariablen als Faktor $f_B$ mit zwei Leveln und deren Interaktion $f_A \\times f_B$ dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-577"><a href="#cb118-577" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-13</span></span>
<span id="cb118-578"><a href="#cb118-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-579"><a href="#cb118-579" aria-hidden="true" tabindex="-1"></a>p_2fac_model  <span class="sc">+</span></span>
<span id="cb118-580"><a href="#cb118-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>) </span>
<span id="cb118-581"><a href="#cb118-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-582"><a href="#cb118-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-583"><a href="#cb118-583" aria-hidden="true" tabindex="-1"></a>Im Folgenden wollen wir also einmal ein multiples Modell rechnen und die Koeffizienten für die einzelnen Faktoren ermitteln. Dabei hat es dann eine Auswirkung wie viele Level ein Faktor hat und wie wir das Modell bauen. Wir machen hier gleich das volle Modell mit Interaktion. Ohne die Interaktion lassen sich dann die Koeffizienten etwas leichter zu interpretieren. Am Ende ist es dann doch die ANOVA, die wir eigentlich wollen. Hier also bitte nicht verwirren lassen, es kommt immer auf die wissenschaftliche Fragestellung an.</span>
<span id="cb118-584"><a href="#cb118-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-585"><a href="#cb118-585" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb118-586"><a href="#cb118-586" aria-hidden="true" tabindex="-1"></a><span class="fu">## Praktisch in R</span></span>
<span id="cb118-587"><a href="#cb118-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-588"><a href="#cb118-588" aria-hidden="true" tabindex="-1"></a>Beginnen wir wieder mit dem zweifaktoriellen Modell. Wir nehmen hier beide Faktoren mit ins Modell und wollen auch den Interaktionsterm mit modellieren. Wenn wir den Interaktionsterm weglassen, dann können wir die Koeffizienten des Modells etwas leichter interpretieren. Wenn also unsere Interaktion nicht signifikant ist, dann kannst du die Interaktion auch aus dem Modell entfernen und so es etwas einfacher machen.</span>
<span id="cb118-589"><a href="#cb118-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-592"><a href="#cb118-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-593"><a href="#cb118-593" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> stage <span class="sc">+</span> stage<span class="sc">:</span>feeding, <span class="at">data =</span> flea_model_tbl) </span>
<span id="cb118-594"><a href="#cb118-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-595"><a href="#cb118-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-596"><a href="#cb118-596" aria-hidden="true" tabindex="-1"></a>Jetzt erhalten wir die Koeffizienten des Modells mit einem Intercept und der Steigung zu den einzelnen Gruppenmittelwerten. Oder anders ausgedrückt, die Differenz der Gruppenmittelwerte zum Intercept. Dazu dann noch die Koeffizienten der Interaktion. Hier sehen wir noch nicht, ob die Koeffizienten der Interaktion signifikant sind.</span>
<span id="cb118-597"><a href="#cb118-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-600"><a href="#cb118-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-601"><a href="#cb118-601" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb118-602"><a href="#cb118-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-603"><a href="#cb118-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-604"><a href="#cb118-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-605"><a href="#cb118-605" aria-hidden="true" tabindex="-1"></a>Jetzt müssen wir uns einmal die Zusammenfassung des Modells wiedergeben lassen, damit wir abschätzen können, ob unsere Koeffizienten signifikant sind. Auch erhalten wir die statistischen Maßzahlen für die Modelgüte wiedergegeben. Unser Interaktion ist für beide Koeffizienten nicht signifikant, daher könnten wir die Interaktion auch aus dem Modell nehmen.</span>
<span id="cb118-606"><a href="#cb118-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-609"><a href="#cb118-609" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-610"><a href="#cb118-610" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb118-611"><a href="#cb118-611" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb118-612"><a href="#cb118-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-613"><a href="#cb118-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-614"><a href="#cb118-614" aria-hidden="true" tabindex="-1"></a>Dann habe ich dir in der folgenden Abbildung nochmal die Ausgabe der Zusammenfassung annotiert. Der spannendeste Teil ist eigentlich, was der Intercept repräsentiert. Der Intercept ist nämlich das lokale Gruppenmittel der Behandlung Zuckerwasser für die adulten Flöhe. Dann haben wir die einzlenen statistischen Tests, ob sich die Koeffizienten von Null unterscheiden. Somit eigentlich die Frage, ob die lokalen Mittelwerte der Gruppen sich vom Intercept unterscheiden.</span>
<span id="cb118-615"><a href="#cb118-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-618"><a href="#cb118-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-619"><a href="#cb118-619" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-620"><a href="#cb118-620" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-621"><a href="#cb118-621" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-622"><a href="#cb118-622" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-623"><a href="#cb118-623" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb118-624"><a href="#cb118-624" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb118-625"><a href="#cb118-625" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Annotierte Ausgabe der Funktion `summary()` aus einer linearen Modellanpassung mit der Funktion `lm()`. Die Ausgabe der Funktion teilt sich grob in drei informative Bereiche: Informationen zu den Residuen, Informationen zu den Koeffizienten und Informationen zu der Modelgüte. Die Erklärung der Schätzer (eng. *estimate*) kann in der folgenden Tabelle nachvollzogen werden. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-626"><a href="#cb118-626" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-f2-summary</span></span>
<span id="cb118-627"><a href="#cb118-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-628"><a href="#cb118-628" aria-hidden="true" tabindex="-1"></a>p_lm_summary_fac2_explained</span>
<span id="cb118-629"><a href="#cb118-629" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-630"><a href="#cb118-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-631"><a href="#cb118-631" aria-hidden="true" tabindex="-1"></a>Das Ganze mag etwas kryptisch sein, aber das Ziel ist es eigentlich die Mittelwerte der Faktorkombinationen abzubilden. In der folgenden Tabelle habe ich dir einmal gezeigt, wie wir von den Koeffizienten auf die Mittelwerte der Sprungweiten in den einzelnen Gruppen der Faktorkombinationen kommen. Jetzt siehst du auch, dass die Koeffizienten nur einen sehr kleinen Teil der Unterschiede in den Sprungweiten beschreiben. Daher nutzen wir dann lieber Post-hoc Tests um alle paarweisen Mittelwertsvergleiche rechnen zu können.</span>
<span id="cb118-632"><a href="#cb118-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-635"><a href="#cb118-635" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-636"><a href="#cb118-636" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-637"><a href="#cb118-637" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-638"><a href="#cb118-638" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-639"><a href="#cb118-639" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-model-table-fac2</span></span>
<span id="cb118-640"><a href="#cb118-640" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Zusammensetzung der Mittelwerte der Sprungweiten $\\bar{Y}$ für jede Faktorkombination aus der Ernährungsart und dem Entwicklungsstand aus den Koeffizienten des zweifaktoriellen Modells."</span></span>
<span id="cb118-641"><a href="#cb118-641" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.kable.NA =</span> <span class="st">''</span>)</span>
<span id="cb118-642"><a href="#cb118-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-643"><a href="#cb118-643" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="st">"$f_{feeding}$"</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"sugar"</span>, <span class="st">"blood"</span>, <span class="st">"ketchup"</span>), <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb118-644"><a href="#cb118-644" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$f_{stage}$"</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"adult"</span>, <span class="st">"juvenile"</span>), <span class="dv">3</span>),</span>
<span id="cb118-645"><a href="#cb118-645" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">bar{Y}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">78.9</span>, <span class="fl">61.03</span>, <span class="fl">99.71</span>, <span class="fl">116.03</span>, <span class="fl">92.15</span>, <span class="fl">111.24</span>), </span>
<span id="cb118-646"><a href="#cb118-646" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">beta_{0}}$"</span> <span class="ot">=</span> <span class="fl">78.98</span>,</span>
<span id="cb118-647"><a href="#cb118-647" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">beta_{blood}}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">20.73</span>, <span class="fl">20.73</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb118-648"><a href="#cb118-648" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">beta_{ketchup}}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">13.17</span>, <span class="fl">13.17</span>),</span>
<span id="cb118-649"><a href="#cb118-649" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">beta_{juvenile}}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="sc">-</span><span class="fl">17.94</span>, <span class="cn">NA</span>, <span class="sc">-</span><span class="fl">17.94</span>, <span class="cn">NA</span>, <span class="sc">-</span><span class="fl">17.94</span>),</span>
<span id="cb118-650"><a href="#cb118-650" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">beta_{blood </span><span class="sc">\\</span><span class="st">times juvenile}}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">34.26</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb118-651"><a href="#cb118-651" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">beta_{ketchup </span><span class="sc">\\</span><span class="st">times juvenile}}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">37.03</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb118-652"><a href="#cb118-652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb118-653"><a href="#cb118-653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-654"><a href="#cb118-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-655"><a href="#cb118-655" aria-hidden="true" tabindex="-1"></a>Dann wird dir alles wahrscheinlich klarer, wenn wir uns nochmal die Abbildung zu dem zweifaktoriellen Versuch anschauen. Wir haben hier unsere y-Achse mit dem Intercept direkt durch den lokalen Gruppenmittelwert der adulten Flöhe, die Zuckerwasser trinken. Dann kannst du die jeweiligen Abweichungen aus der obigen Tabelle der Mittelwerte in der Abbildung nachvollziehen.</span>
<span id="cb118-656"><a href="#cb118-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-659"><a href="#cb118-659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-660"><a href="#cb118-660" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-661"><a href="#cb118-661" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-662"><a href="#cb118-662" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-663"><a href="#cb118-663" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-664"><a href="#cb118-664" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb118-665"><a href="#cb118-665" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb118-666"><a href="#cb118-666" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Darstellung der Gruppenmittelwerte der Sprungweiten für alle Faktorkombinationen aus dem zweifaktoriellen Modell zur Ernährung und Entwicklungsstand von Flöhen. Der Intercept liegt auf dem lokalen Mittelwert der adulten Flöhe, die Zuckerwasser trinken. Die Koeffizienten des zweifaktoriellen Modells beschreiben die Abweichungen zu dem Intercept. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-667"><a href="#cb118-667" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-basis-fac2</span></span>
<span id="cb118-668"><a href="#cb118-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-669"><a href="#cb118-669" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(flea_model_tbl, <span class="fu">aes</span>(feeding, jump_length, <span class="at">color =</span> stage)) <span class="sc">+</span></span>
<span id="cb118-670"><a href="#cb118-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb118-671"><a href="#cb118-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.95</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb118-672"><a href="#cb118-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb118-673"><a href="#cb118-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">78.98</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb118-674"><a href="#cb118-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb118-675"><a href="#cb118-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"label"</span>, </span>
<span id="cb118-676"><a href="#cb118-676" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y.., <span class="dv">2</span>)), </span>
<span id="cb118-677"><a href="#cb118-677" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span>)),</span>
<span id="cb118-678"><a href="#cb118-678" aria-hidden="true" tabindex="-1"></a>               <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb118-679"><a href="#cb118-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">13</span>, <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb118-680"><a href="#cb118-680" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(..y.., <span class="dv">2</span>)), </span>
<span id="cb118-681"><a href="#cb118-681" aria-hidden="true" tabindex="-1"></a>               <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb118-682"><a href="#cb118-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Zuckerwasser"</span>, <span class="st">"Blut"</span>, <span class="st">"Ketchup"</span>)) <span class="sc">+</span></span>
<span id="cb118-683"><a href="#cb118-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Zweifaktorielles Modell mit Interaktion"</span>,</span>
<span id="cb118-684"><a href="#cb118-684" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Intercept ist der Mittelwert der Sprungweiten der</span><span class="sc">\n</span><span class="st">Behandlung Zuckerwasser bei den adulten Flöhen"</span>,</span>
<span id="cb118-685"><a href="#cb118-685" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fütterungsart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">color =</span> <span class="st">"Entwicklungsstand"</span>) <span class="sc">+</span></span>
<span id="cb118-686"><a href="#cb118-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb118-687"><a href="#cb118-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb118-688"><a href="#cb118-688" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb118-689"><a href="#cb118-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">170</span>)</span>
<span id="cb118-690"><a href="#cb118-690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-691"><a href="#cb118-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-692"><a href="#cb118-692" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch in R</span></span>
<span id="cb118-693"><a href="#cb118-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-694"><a href="#cb118-694" aria-hidden="true" tabindex="-1"></a>Aus Gründen der Einfachheit lassen wir einmal die Interaktion weg.</span>
<span id="cb118-695"><a href="#cb118-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-698"><a href="#cb118-698" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-699"><a href="#cb118-699" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> color <span class="sc">+</span> region, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() </span>
<span id="cb118-700"><a href="#cb118-700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-701"><a href="#cb118-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-702"><a href="#cb118-702" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-703"><a href="#cb118-703" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb118-704"><a href="#cb118-704" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb118-705"><a href="#cb118-705" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb118-706"><a href="#cb118-706" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb118-707"><a href="#cb118-707" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb118-708"><a href="#cb118-708" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb118-709"><a href="#cb118-709" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb118-710"><a href="#cb118-710" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb118-711"><a href="#cb118-711" aria-hidden="true" tabindex="-1"></a>  49 <span class="sc">\\</span></span>
<span id="cb118-712"><a href="#cb118-712" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-713"><a href="#cb118-713" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb118-714"><a href="#cb118-714" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-715"><a href="#cb118-715" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb118-716"><a href="#cb118-716" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb118-717"><a href="#cb118-717" aria-hidden="true" tabindex="-1"></a>  1 &amp; 1 &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb118-718"><a href="#cb118-718" aria-hidden="true" tabindex="-1"></a>  1 &amp; 1 &amp; 0 &amp; 1 <span class="sc">\\</span></span>
<span id="cb118-719"><a href="#cb118-719" aria-hidden="true" tabindex="-1"></a>  1 &amp; 1 &amp; 0 &amp; 1 <span class="sc">\\</span></span>
<span id="cb118-720"><a href="#cb118-720" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 1 &amp; 1 <span class="sc">\\</span></span>
<span id="cb118-721"><a href="#cb118-721" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 1 &amp; 1 <span class="sc">\\</span></span>
<span id="cb118-722"><a href="#cb118-722" aria-hidden="true" tabindex="-1"></a>  1 &amp; 0 &amp; 1 &amp; 1 <span class="sc">\\</span></span>
<span id="cb118-723"><a href="#cb118-723" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-724"><a href="#cb118-724" aria-hidden="true" tabindex="-1"></a> \times</span>
<span id="cb118-725"><a href="#cb118-725" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-726"><a href="#cb118-726" aria-hidden="true" tabindex="-1"></a>  \beta_0 <span class="sc">\\</span></span>
<span id="cb118-727"><a href="#cb118-727" aria-hidden="true" tabindex="-1"></a>  \beta^{color}_{rot} <span class="sc">\\</span></span>
<span id="cb118-728"><a href="#cb118-728" aria-hidden="true" tabindex="-1"></a>  \beta^{color}_{blau} <span class="sc">\\</span></span>
<span id="cb118-729"><a href="#cb118-729" aria-hidden="true" tabindex="-1"></a>  \beta^{region}_{nord} <span class="sc">\\</span></span>
<span id="cb118-730"><a href="#cb118-730" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb118-731"><a href="#cb118-731" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-732"><a href="#cb118-732" aria-hidden="true" tabindex="-1"></a>  \epsilon_1 <span class="sc">\\</span></span>
<span id="cb118-733"><a href="#cb118-733" aria-hidden="true" tabindex="-1"></a>  \epsilon_2 <span class="sc">\\</span></span>
<span id="cb118-734"><a href="#cb118-734" aria-hidden="true" tabindex="-1"></a>  \epsilon_3 <span class="sc">\\</span></span>
<span id="cb118-735"><a href="#cb118-735" aria-hidden="true" tabindex="-1"></a>  \epsilon_4 <span class="sc">\\</span></span>
<span id="cb118-736"><a href="#cb118-736" aria-hidden="true" tabindex="-1"></a>  \epsilon_5 <span class="sc">\\</span></span>
<span id="cb118-737"><a href="#cb118-737" aria-hidden="true" tabindex="-1"></a>  \epsilon_6 <span class="sc">\\</span></span>
<span id="cb118-738"><a href="#cb118-738" aria-hidden="true" tabindex="-1"></a>  \epsilon_7 <span class="sc">\\</span></span>
<span id="cb118-739"><a href="#cb118-739" aria-hidden="true" tabindex="-1"></a>  \epsilon_8 <span class="sc">\\</span></span>
<span id="cb118-740"><a href="#cb118-740" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-741"><a href="#cb118-741" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-742"><a href="#cb118-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-745"><a href="#cb118-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-746"><a href="#cb118-746" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> color <span class="sc">+</span> region, <span class="at">data =</span> snake_tbl)</span>
<span id="cb118-747"><a href="#cb118-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-748"><a href="#cb118-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-751"><a href="#cb118-751" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-752"><a href="#cb118-752" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-753"><a href="#cb118-753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-754"><a href="#cb118-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-757"><a href="#cb118-757" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-758"><a href="#cb118-758" aria-hidden="true" tabindex="-1"></a>fac2_fit <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-759"><a href="#cb118-759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-760"><a href="#cb118-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-761"><a href="#cb118-761" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-762"><a href="#cb118-762" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb118-763"><a href="#cb118-763" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb118-764"><a href="#cb118-764" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb118-765"><a href="#cb118-765" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb118-766"><a href="#cb118-766" aria-hidden="true" tabindex="-1"></a>  51 <span class="sc">\\</span></span>
<span id="cb118-767"><a href="#cb118-767" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb118-768"><a href="#cb118-768" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb118-769"><a href="#cb118-769" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb118-770"><a href="#cb118-770" aria-hidden="true" tabindex="-1"></a>  49 <span class="sc">\\</span></span>
<span id="cb118-771"><a href="#cb118-771" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-772"><a href="#cb118-772" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb118-773"><a href="#cb118-773" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-774"><a href="#cb118-774" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot -3.50 &amp; 0 \cdot -0.33 &amp; 0 \cdot 12.50 <span class="sc">\\</span></span>
<span id="cb118-775"><a href="#cb118-775" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot -3.50 &amp; 0 \cdot -0.33 &amp; 0 \cdot 12.50 <span class="sc">\\</span></span>
<span id="cb118-776"><a href="#cb118-776" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 1 \cdot -3.50 &amp; 0 \cdot -0.33 &amp; 0 \cdot 12.50 <span class="sc">\\</span></span>
<span id="cb118-777"><a href="#cb118-777" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 1 \cdot -3.50 &amp; 0 \cdot -0.33 &amp; 1 \cdot 12.50 <span class="sc">\\</span></span>
<span id="cb118-778"><a href="#cb118-778" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 1 \cdot -3.50 &amp; 0 \cdot -0.33 &amp; 1 \cdot 12.50 <span class="sc">\\</span></span>
<span id="cb118-779"><a href="#cb118-779" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot -3.50 &amp; 1 \cdot -0.33 &amp; 1 \cdot 12.50 <span class="sc">\\</span></span>
<span id="cb118-780"><a href="#cb118-780" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot -3.50 &amp; 1 \cdot -0.33 &amp; 1 \cdot 12.50 <span class="sc">\\</span></span>
<span id="cb118-781"><a href="#cb118-781" aria-hidden="true" tabindex="-1"></a>  42.50 &amp; 0 \cdot -3.50 &amp; 1 \cdot -0.33 &amp; 1 \cdot 12.50 <span class="sc">\\</span></span>
<span id="cb118-782"><a href="#cb118-782" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb118-783"><a href="#cb118-783" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-784"><a href="#cb118-784" aria-hidden="true" tabindex="-1"></a>  -2.50 <span class="sc">\\</span></span>
<span id="cb118-785"><a href="#cb118-785" aria-hidden="true" tabindex="-1"></a>  +2.50 <span class="sc">\\</span></span>
<span id="cb118-786"><a href="#cb118-786" aria-hidden="true" tabindex="-1"></a>  0.00 <span class="sc">\\</span></span>
<span id="cb118-787"><a href="#cb118-787" aria-hidden="true" tabindex="-1"></a>  -0.50 <span class="sc">\\</span></span>
<span id="cb118-788"><a href="#cb118-788" aria-hidden="true" tabindex="-1"></a>  +0.50 <span class="sc">\\</span></span>
<span id="cb118-789"><a href="#cb118-789" aria-hidden="true" tabindex="-1"></a>  +2.33 <span class="sc">\\</span></span>
<span id="cb118-790"><a href="#cb118-790" aria-hidden="true" tabindex="-1"></a>  +3.33 <span class="sc">\\</span></span>
<span id="cb118-791"><a href="#cb118-791" aria-hidden="true" tabindex="-1"></a>  -5.67 <span class="sc">\\</span></span>
<span id="cb118-792"><a href="#cb118-792" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-793"><a href="#cb118-793" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-794"><a href="#cb118-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-797"><a href="#cb118-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-798"><a href="#cb118-798" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">-</span> <span class="fl">2.50</span>,</span>
<span id="cb118-799"><a href="#cb118-799" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">+</span> <span class="fl">2.50</span>,</span>
<span id="cb118-800"><a href="#cb118-800" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb118-801"><a href="#cb118-801" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">-</span> <span class="fl">0.50</span>,</span>
<span id="cb118-802"><a href="#cb118-802" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">+</span> <span class="fl">0.50</span>,</span>
<span id="cb118-803"><a href="#cb118-803" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">+</span> <span class="fl">2.33</span>,</span>
<span id="cb118-804"><a href="#cb118-804" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">+</span> <span class="fl">3.33</span>,</span>
<span id="cb118-805"><a href="#cb118-805" aria-hidden="true" tabindex="-1"></a>  <span class="fl">42.50</span> <span class="sc">+</span>  <span class="dv">0</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">3.50</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>(<span class="sc">-</span><span class="fl">0.33</span>) <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">12.50</span> <span class="sc">-</span> <span class="fl">5.67</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>()</span>
<span id="cb118-806"><a href="#cb118-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-807"><a href="#cb118-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-810"><a href="#cb118-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-811"><a href="#cb118-811" aria-hidden="true" tabindex="-1"></a>snake_tbl <span class="sc">|&gt;</span> <span class="fu">pull</span>(svl)</span>
<span id="cb118-812"><a href="#cb118-812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-813"><a href="#cb118-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-814"><a href="#cb118-814" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulation</span></span>
<span id="cb118-815"><a href="#cb118-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-818"><a href="#cb118-818" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-819"><a href="#cb118-819" aria-hidden="true" tabindex="-1"></a>fac2_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">f_a =</span> <span class="fu">rep</span>(<span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>), <span class="dv">2</span>),</span>
<span id="cb118-820"><a href="#cb118-820" aria-hidden="true" tabindex="-1"></a>                   <span class="at">f_b =</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">15</span>),</span>
<span id="cb118-821"><a href="#cb118-821" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb118-822"><a href="#cb118-822" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">2</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_a) <span class="sc">+</span> </span>
<span id="cb118-823"><a href="#cb118-823" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">3</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_b) <span class="sc">+</span> </span>
<span id="cb118-824"><a href="#cb118-824" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">2</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_a) <span class="sc">*</span> <span class="fu">as.numeric</span>(f_b) <span class="sc">+</span></span>
<span id="cb118-825"><a href="#cb118-825" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span>
<span id="cb118-826"><a href="#cb118-826" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-827"><a href="#cb118-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-830"><a href="#cb118-830" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-831"><a href="#cb118-831" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> f_b <span class="sc">+</span> f_a<span class="sc">:</span>f_b, fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb118-832"><a href="#cb118-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-833"><a href="#cb118-833" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-834"><a href="#cb118-834" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb118-835"><a href="#cb118-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-836"><a href="#cb118-836" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kombinierte Modelle</span></span>
<span id="cb118-837"><a href="#cb118-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-838"><a href="#cb118-838" aria-hidden="true" tabindex="-1"></a>Kommen wir jetzt zu dem wirklich spannenden Teil. Wir kombinieren Kovariaten zusammen mit Faktoren in einem Modell. Zum einen haben wir hier jetzt eine klassische <span class="co">[</span><span class="ot">ANCOVA</span><span class="co">](#sec-ancova)</span> vorliegen, wenn wir an den Faktoren als Haupteffekt interessiert sind. Wenn es eher um die Kovariaten geht, dann ist eben eine klassische Regression. Hier kommt es dann auf die wissenschaftliche Fragestellung an. Wollen wir wissen wie sich die Kovariate in den Faktoren ändert oder wollen wir die Faktoren für eine Kovariate adjustieren? Das kannst nur du beantworten.</span>
<span id="cb118-839"><a href="#cb118-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-840"><a href="#cb118-840" aria-hidden="true" tabindex="-1"></a>Was passiert wenn wir eine Kovariate und einen Faktor kombinieren?</span>
<span id="cb118-841"><a href="#cb118-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-842"><a href="#cb118-842" aria-hidden="true" tabindex="-1"></a>:   Wenn wir eine Kovariate mit einem Faktor kombinieren, dann kippen wir den Intercept der Graden um die Steigung der Kovariate. Die Level der Faktoren liegen dann auf den Mittelwerten der Kovariaten für das entsprechende Level des Faktors. Wenn wir dann noch eine Interaktion hinzunehmen, dann erlauben wir jedem Level des Faktors eine eigene Steigung der Kovariaten.</span>
<span id="cb118-843"><a href="#cb118-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-844"><a href="#cb118-844" aria-hidden="true" tabindex="-1"></a>Das erstmal die sehr allgemeine Beschreibung. mehr dazu dann gleich in der Durchführung in R. Ich hoffe, dass dann das ein oder andere nochmal klarer wird. Wir wollen uns insgesamt drei Typen von multiplen Regressionen anschauen. Einmal das kombinierte Modell mit einem Faktor und einer Kovariate. Dann das gleiche Modell nur mit einm Faktor mehr. Am Ende dann noch das zweikovariate und zweifaktorielle Modell. Weiter unten diskutiere ich dann noch die Modellauswahl, wenn du dich fragst, wie viel der Einflussvariablen sollen denn jetzt in ein Modell.</span>
<span id="cb118-845"><a href="#cb118-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-846"><a href="#cb118-846" aria-hidden="true" tabindex="-1"></a><span class="fu">#### $f_A + c_1$ {.unnumbered .unlisted}</span></span>
<span id="cb118-847"><a href="#cb118-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-848"><a href="#cb118-848" aria-hidden="true" tabindex="-1"></a>Hier rechnen wir eigentlich eine klassische <span class="co">[</span><span class="ot">einfaktorielle ANCOVA</span><span class="co">](#sec-ancova)</span> (eng. *analysis of covariance*)</span>
<span id="cb118-849"><a href="#cb118-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-852"><a href="#cb118-852" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-853"><a href="#cb118-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-854"><a href="#cb118-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-855"><a href="#cb118-855" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-856"><a href="#cb118-856" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-857"><a href="#cb118-857" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb118-858"><a href="#cb118-858" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb118-859"><a href="#cb118-859" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches simples Modell mit einem Messwert $Y$ und einer kategorialen Einflussvariablen als Faktor $f_A$ mit drei Leveln sowie einer kontinuierlichen Einflussvariable als Kovariate $c_1$ dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-860"><a href="#cb118-860" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-14</span></span>
<span id="cb118-861"><a href="#cb118-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-862"><a href="#cb118-862" aria-hidden="true" tabindex="-1"></a>p_fa_c1_model</span>
<span id="cb118-863"><a href="#cb118-863" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-864"><a href="#cb118-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-865"><a href="#cb118-865" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb118-866"><a href="#cb118-866" aria-hidden="true" tabindex="-1"></a><span class="fu">## Praktisch in R</span></span>
<span id="cb118-867"><a href="#cb118-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-868"><a href="#cb118-868" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Ohne Interaktion {.unnumbered .unlisted}</span></span>
<span id="cb118-869"><a href="#cb118-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-872"><a href="#cb118-872" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-873"><a href="#cb118-873" aria-hidden="true" tabindex="-1"></a>cov1_fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> K, <span class="at">data =</span> flea_model_tbl) </span>
<span id="cb118-874"><a href="#cb118-874" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-875"><a href="#cb118-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-878"><a href="#cb118-878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-879"><a href="#cb118-879" aria-hidden="true" tabindex="-1"></a>cov1_fac1_fit <span class="sc">|&gt;</span> </span>
<span id="cb118-880"><a href="#cb118-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-881"><a href="#cb118-881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-882"><a href="#cb118-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-885"><a href="#cb118-885" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-886"><a href="#cb118-886" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb118-887"><a href="#cb118-887" aria-hidden="true" tabindex="-1"></a>cov1_fac1_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb118-888"><a href="#cb118-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-889"><a href="#cb118-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-892"><a href="#cb118-892" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-893"><a href="#cb118-893" aria-hidden="true" tabindex="-1"></a>flea_model_tbl <span class="sc">|&gt;</span> </span>
<span id="cb118-894"><a href="#cb118-894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(feeding) <span class="sc">|&gt;</span> </span>
<span id="cb118-895"><a href="#cb118-895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(jump_length),</span>
<span id="cb118-896"><a href="#cb118-896" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mean</span>(K))</span>
<span id="cb118-897"><a href="#cb118-897" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-898"><a href="#cb118-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-901"><a href="#cb118-901" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-902"><a href="#cb118-902" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-903"><a href="#cb118-903" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-904"><a href="#cb118-904" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-905"><a href="#cb118-905" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-model-table-fac1-cov1</span></span>
<span id="cb118-906"><a href="#cb118-906" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Zusammensetzung der Mittelwerte der Sprungweiten $\\bar{Y}$ für jede Faktorkombination aus der Ernährungsart und dem Entwicklungsstand aus den Koeffizienten des zweifaktoriellen Modells."</span></span>
<span id="cb118-907"><a href="#cb118-907" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.kable.NA =</span> <span class="st">''</span>)</span>
<span id="cb118-908"><a href="#cb118-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-909"><a href="#cb118-909" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="st">"$f_{feeding}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"sugar"</span>, <span class="st">"blood"</span>, <span class="st">"ketchup"</span>),</span>
<span id="cb118-910"><a href="#cb118-910" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">bar{c}_{K}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">33.69</span>, <span class="fl">29.47</span>, <span class="fl">25.06</span>), </span>
<span id="cb118-911"><a href="#cb118-911" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">bar{Y}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">70.01</span>, <span class="fl">107.87</span>, <span class="fl">101.69</span>), </span>
<span id="cb118-912"><a href="#cb118-912" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">beta_{0}}$"</span> <span class="ot">=</span> <span class="fl">58.48</span>,</span>
<span id="cb118-913"><a href="#cb118-913" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">beta_{blood}}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">39.31</span>, <span class="cn">NA</span>),</span>
<span id="cb118-914"><a href="#cb118-914" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">beta_{ketchup}}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">34.64</span>),</span>
<span id="cb118-915"><a href="#cb118-915" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">bar{c}_{K}</span><span class="sc">\\</span><span class="st">cdot</span><span class="sc">\\</span><span class="st">beta_{K}}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"$11.45 = 33.69 </span><span class="sc">\\</span><span class="st">cdot 0.34$"</span>,</span>
<span id="cb118-916"><a href="#cb118-916" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"$10.02 = 29.47 </span><span class="sc">\\</span><span class="st">cdot 0.34$"</span>,</span>
<span id="cb118-917"><a href="#cb118-917" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"$8.52 = 25.06 </span><span class="sc">\\</span><span class="st">cdot 0.34$"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb118-918"><a href="#cb118-918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb118-919"><a href="#cb118-919" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-920"><a href="#cb118-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-923"><a href="#cb118-923" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-924"><a href="#cb118-924" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-925"><a href="#cb118-925" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-926"><a href="#cb118-926" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-927"><a href="#cb118-927" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-928"><a href="#cb118-928" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb118-929"><a href="#cb118-929" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6.5</span></span>
<span id="cb118-930"><a href="#cb118-930" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Sprungweiten der Hunde-,  Katzen- und Fuchsflöhe. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-931"><a href="#cb118-931" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-basic-cov1-fac1-01</span></span>
<span id="cb118-932"><a href="#cb118-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-933"><a href="#cb118-933" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(flea_model_tbl, <span class="fu">aes</span>(K, jump_length, <span class="at">color =</span> feeding)) <span class="sc">+</span></span>
<span id="cb118-934"><a href="#cb118-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb118-935"><a href="#cb118-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">33.69</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#E69F00"</span>) <span class="sc">+</span></span>
<span id="cb118-936"><a href="#cb118-936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">29.46</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#56B4E9"</span>) <span class="sc">+</span></span>
<span id="cb118-937"><a href="#cb118-937" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">25.05</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb118-938"><a href="#cb118-938" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">58.48</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>, <span class="at">linetype =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb118-939"><a href="#cb118-939" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb118-940"><a href="#cb118-940" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x) <span class="fl">58.48</span> <span class="sc">+</span> <span class="fl">0.342</span> <span class="sc">*</span> x, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb118-941"><a href="#cb118-941" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb118-942"><a href="#cb118-942" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">25.05</span>, <span class="fl">29.46</span>, <span class="fl">33.69</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">70.0</span>, <span class="fl">107.8</span>, <span class="fl">101.7</span>), </span>
<span id="cb118-943"><a href="#cb118-943" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">70.0</span>, <span class="fl">107.8</span>, <span class="fl">101.7</span>), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#009E73"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#E69F00"</span>),</span>
<span id="cb118-944"><a href="#cb118-944" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">23</span>) <span class="sc">+</span></span>
<span id="cb118-945"><a href="#cb118-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">25.05</span>, <span class="fl">29.46</span>, <span class="fl">33.69</span>)<span class="sc">+</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">70.0</span>, <span class="fl">107.8</span>, <span class="fl">101.7</span>)<span class="sc">+</span><span class="dv">5</span>, </span>
<span id="cb118-946"><a href="#cb118-946" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">70.0</span>, <span class="fl">107.8</span>, <span class="fl">101.7</span>), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#009E73"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#E69F00"</span>),</span>
<span id="cb118-947"><a href="#cb118-947" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb118-948"><a href="#cb118-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Modell mit Kovariate und Faktor"</span>,</span>
<span id="cb118-949"><a href="#cb118-949" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Intercept ist der Mittelwert der Sprungweiten der Behandlung Zuckerwasser</span><span class="sc">\n</span><span class="st">gekippt um die Steigung der Kovariate"</span>,</span>
<span id="cb118-950"><a href="#cb118-950" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Gewicht in [mg]"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">color =</span> <span class="st">"Entwicklungsstand"</span>) <span class="sc">+</span></span>
<span id="cb118-951"><a href="#cb118-951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb118-952"><a href="#cb118-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb118-953"><a href="#cb118-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">40</span>, <span class="at">xend =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="fl">58.48</span>, <span class="at">yend =</span> <span class="fl">58.48</span> <span class="sc">+</span> <span class="dv">40</span> <span class="sc">*</span> <span class="fl">0.3420</span>),</span>
<span id="cb118-954"><a href="#cb118-954" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb118-955"><a href="#cb118-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">x =</span> <span class="dv">41</span>, <span class="at">y =</span> <span class="fl">58.48</span> <span class="sc">+</span> (<span class="dv">40</span> <span class="sc">*</span> <span class="fl">0.3420</span>)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb118-956"><a href="#cb118-956" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">expression</span>(beta[K]<span class="sc">*</span><span class="st">"="</span><span class="sc">~</span><span class="dv">40</span><span class="sc">%.%</span><span class="fl">0.34</span>)) <span class="sc">+</span></span>
<span id="cb118-957"><a href="#cb118-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="fl">25.05</span>, <span class="fl">29.46</span>, <span class="fl">33.69</span>, <span class="dv">40</span>, <span class="dv">50</span>),</span>
<span id="cb118-958"><a href="#cb118-958" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge =</span> <span class="dv">2</span>),</span>
<span id="cb118-959"><a href="#cb118-959" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>))</span>
<span id="cb118-960"><a href="#cb118-960" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-961"><a href="#cb118-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-962"><a href="#cb118-962" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mit Interaktion {.unnumbered .unlisted}</span></span>
<span id="cb118-963"><a href="#cb118-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-966"><a href="#cb118-966" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-967"><a href="#cb118-967" aria-hidden="true" tabindex="-1"></a>cov1_fac1_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> K <span class="sc">+</span> feeding<span class="sc">:</span>K, <span class="at">data =</span> flea_model_tbl) </span>
<span id="cb118-968"><a href="#cb118-968" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-969"><a href="#cb118-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-972"><a href="#cb118-972" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-973"><a href="#cb118-973" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb118-974"><a href="#cb118-974" aria-hidden="true" tabindex="-1"></a>cov1_fac1_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb118-975"><a href="#cb118-975" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-976"><a href="#cb118-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-979"><a href="#cb118-979" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-980"><a href="#cb118-980" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-981"><a href="#cb118-981" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-982"><a href="#cb118-982" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-983"><a href="#cb118-983" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-model-table-fac1-cov1-inter</span></span>
<span id="cb118-984"><a href="#cb118-984" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Zusammensetzung der Mittelwerte der Sprungweiten $\\bar{Y}$ für jede Faktorkombination aus der Ernährungsart und dem Entwicklungsstand aus den Koeffizienten des zweifaktoriellen Modells."</span></span>
<span id="cb118-985"><a href="#cb118-985" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">knitr.kable.NA =</span> <span class="st">''</span>)</span>
<span id="cb118-986"><a href="#cb118-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-987"><a href="#cb118-987" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="st">"$f_{feeding}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"sugar"</span>, <span class="st">"blood"</span>, <span class="st">"ketchup"</span>),</span>
<span id="cb118-988"><a href="#cb118-988" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">bar{c}_{K}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">33.69</span>, <span class="fl">29.47</span>, <span class="fl">25.06</span>), </span>
<span id="cb118-989"><a href="#cb118-989" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">bar{Y}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">70.01</span>, <span class="fl">107.87</span>, <span class="fl">101.69</span>), </span>
<span id="cb118-990"><a href="#cb118-990" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">beta_{0}}$"</span> <span class="ot">=</span> <span class="fl">44.13</span>,</span>
<span id="cb118-991"><a href="#cb118-991" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">beta_{blood}}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">44.59</span>, <span class="cn">NA</span>),</span>
<span id="cb118-992"><a href="#cb118-992" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">beta_{ketchup}}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">81.63</span>),</span>
<span id="cb118-993"><a href="#cb118-993" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">bar{c}_{K}</span><span class="sc">\\</span><span class="st">cdot</span><span class="sc">\\</span><span class="st">beta_{K}}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"$25.94 = 33.69 </span><span class="sc">\\</span><span class="st">cdot 0.77$"</span>,</span>
<span id="cb118-994"><a href="#cb118-994" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"$22.69 = 29.47 </span><span class="sc">\\</span><span class="st">cdot 0.77$"</span>,</span>
<span id="cb118-995"><a href="#cb118-995" aria-hidden="true" tabindex="-1"></a>                                             <span class="st">"$19.29 = 25.06 </span><span class="sc">\\</span><span class="st">cdot 0.77$"</span>),</span>
<span id="cb118-996"><a href="#cb118-996" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">bar{c}_{K}</span><span class="sc">\\</span><span class="st">cdot</span><span class="sc">\\</span><span class="st">beta_{blood</span><span class="sc">\\</span><span class="st">times K}}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>,</span>
<span id="cb118-997"><a href="#cb118-997" aria-hidden="true" tabindex="-1"></a>                                                          <span class="st">"$-3.54 = 29.47 </span><span class="sc">\\</span><span class="st">cdot -0.12$"</span>,</span>
<span id="cb118-998"><a href="#cb118-998" aria-hidden="true" tabindex="-1"></a>                                                          <span class="cn">NA</span>),</span>
<span id="cb118-999"><a href="#cb118-999" aria-hidden="true" tabindex="-1"></a>       <span class="st">"$</span><span class="sc">\\</span><span class="st">boldsymbol{</span><span class="sc">\\</span><span class="st">bar{c}_{K}</span><span class="sc">\\</span><span class="st">cdot</span><span class="sc">\\</span><span class="st">beta_{ketchup</span><span class="sc">\\</span><span class="st">times K}}$"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span id="cb118-1000"><a href="#cb118-1000" aria-hidden="true" tabindex="-1"></a>                                                          <span class="st">"$-43.35 = 25.06 </span><span class="sc">\\</span><span class="st">cdot -1.73$"</span>),</span>
<span id="cb118-1001"><a href="#cb118-1001" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">|&gt;</span> </span>
<span id="cb118-1002"><a href="#cb118-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb118-1003"><a href="#cb118-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1004"><a href="#cb118-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1007"><a href="#cb118-1007" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1008"><a href="#cb118-1008" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-1009"><a href="#cb118-1009" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-1010"><a href="#cb118-1010" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-1011"><a href="#cb118-1011" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-1012"><a href="#cb118-1012" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb118-1013"><a href="#cb118-1013" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6.5</span></span>
<span id="cb118-1014"><a href="#cb118-1014" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Sprungweiten der Hunde-,  Katzen- und Fuchsflöhe. foo. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-1015"><a href="#cb118-1015" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-basic-cov1-fac1-02</span></span>
<span id="cb118-1016"><a href="#cb118-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1017"><a href="#cb118-1017" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(flea_model_tbl, <span class="fu">aes</span>(K, jump_length, <span class="at">color =</span> feeding)) <span class="sc">+</span></span>
<span id="cb118-1018"><a href="#cb118-1018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb118-1019"><a href="#cb118-1019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">33.69</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#E69F00"</span>) <span class="sc">+</span></span>
<span id="cb118-1020"><a href="#cb118-1020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">29.46</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#56B4E9"</span>) <span class="sc">+</span></span>
<span id="cb118-1021"><a href="#cb118-1021" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">25.05</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb118-1022"><a href="#cb118-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">44.1255</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>, <span class="at">linetype =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb118-1023"><a href="#cb118-1023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb118-1024"><a href="#cb118-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x) <span class="fl">44.1255</span> <span class="sc">+</span> <span class="fl">0.7681</span> <span class="sc">*</span> x, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb118-1025"><a href="#cb118-1025" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>)) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb118-1026"><a href="#cb118-1026" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">25.05</span>, <span class="fl">29.46</span>, <span class="fl">33.69</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">70.0</span>, <span class="fl">107.8</span>, <span class="fl">101.7</span>), </span>
<span id="cb118-1027"><a href="#cb118-1027" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">70.0</span>, <span class="fl">107.8</span>, <span class="fl">101.7</span>), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#009E73"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#E69F00"</span>),</span>
<span id="cb118-1028"><a href="#cb118-1028" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">23</span>) <span class="sc">+</span></span>
<span id="cb118-1029"><a href="#cb118-1029" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"label"</span>, <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">25.05</span>, <span class="fl">29.46</span>, <span class="fl">33.69</span>)<span class="sc">+</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">70.0</span>, <span class="fl">107.8</span>, <span class="fl">101.7</span>)<span class="sc">+</span><span class="dv">5</span>, </span>
<span id="cb118-1030"><a href="#cb118-1030" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="fl">70.01</span>, <span class="fl">107.87</span>, <span class="fl">101.69</span>), <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">"#009E73"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#E69F00"</span>),</span>
<span id="cb118-1031"><a href="#cb118-1031" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb118-1032"><a href="#cb118-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Modell mit Kovariate und Faktor sowie Interaktion"</span>,</span>
<span id="cb118-1033"><a href="#cb118-1033" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Intercept ist der Mittelwert der Sprungweiten der Behandlung Zuckerwasser</span><span class="sc">\n</span><span class="st">gekippt um die Steigung der Kovariate"</span>,</span>
<span id="cb118-1034"><a href="#cb118-1034" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Fütterungsart"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>, <span class="at">color =</span> <span class="st">"Entwicklungsstand"</span>) <span class="sc">+</span></span>
<span id="cb118-1035"><a href="#cb118-1035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>() <span class="sc">+</span></span>
<span id="cb118-1036"><a href="#cb118-1036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb118-1037"><a href="#cb118-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">40</span>, <span class="at">xend =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="fl">44.1255</span>, <span class="at">yend =</span> <span class="fl">44.1255</span> <span class="sc">+</span> <span class="dv">40</span> <span class="sc">*</span> <span class="fl">0.7681</span>),</span>
<span id="cb118-1038"><a href="#cb118-1038" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb118-1039"><a href="#cb118-1039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">hjust =</span> <span class="st">"left"</span>, <span class="at">x =</span> <span class="dv">41</span>, <span class="at">y =</span> <span class="fl">44.1255</span> <span class="sc">+</span> (<span class="dv">40</span> <span class="sc">*</span> <span class="fl">0.7681</span>)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb118-1040"><a href="#cb118-1040" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">expression</span>(beta[K]<span class="sc">*</span><span class="st">"="</span><span class="sc">~</span><span class="dv">40</span><span class="sc">%.%</span><span class="fl">0.77</span>)) <span class="sc">+</span></span>
<span id="cb118-1041"><a href="#cb118-1041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="fl">25.05</span>, <span class="fl">29.46</span>, <span class="fl">33.69</span>, <span class="dv">40</span>, <span class="dv">50</span>),</span>
<span id="cb118-1042"><a href="#cb118-1042" aria-hidden="true" tabindex="-1"></a>                     <span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge =</span> <span class="dv">2</span>),</span>
<span id="cb118-1043"><a href="#cb118-1043" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>))</span>
<span id="cb118-1044"><a href="#cb118-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1045"><a href="#cb118-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1046"><a href="#cb118-1046" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch in R</span></span>
<span id="cb118-1047"><a href="#cb118-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1048"><a href="#cb118-1048" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulation</span></span>
<span id="cb118-1049"><a href="#cb118-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1052"><a href="#cb118-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1053"><a href="#cb118-1053" aria-hidden="true" tabindex="-1"></a>cov1_fac1_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb118-1054"><a href="#cb118-1054" aria-hidden="true" tabindex="-1"></a>                        <span class="at">f_a =</span> <span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>),</span>
<span id="cb118-1055"><a href="#cb118-1055" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb118-1056"><a href="#cb118-1056" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">1</span> <span class="sc">*</span> c_1 <span class="sc">+</span> </span>
<span id="cb118-1057"><a href="#cb118-1057" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">2</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_a) <span class="sc">+</span> </span>
<span id="cb118-1058"><a href="#cb118-1058" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span>
<span id="cb118-1059"><a href="#cb118-1059" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1060"><a href="#cb118-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1063"><a href="#cb118-1063" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1064"><a href="#cb118-1064" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> f_a <span class="sc">+</span> c_1, cov1_fac1_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb118-1065"><a href="#cb118-1065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-1066"><a href="#cb118-1066" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1067"><a href="#cb118-1067" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb118-1068"><a href="#cb118-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1069"><a href="#cb118-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">#### $c_1 + f_A + f_B$ {.unnumbered .unlisted}</span></span>
<span id="cb118-1070"><a href="#cb118-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1071"><a href="#cb118-1071" aria-hidden="true" tabindex="-1"></a>Hier rechnen wir eigentlich eine klassische <span class="co">[</span><span class="ot">zweifaktorielle ANCOVA</span><span class="co">](#sec-ancova)</span> (eng. *analysis of covariance*)</span>
<span id="cb118-1072"><a href="#cb118-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1075"><a href="#cb118-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1076"><a href="#cb118-1076" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-1077"><a href="#cb118-1077" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-1078"><a href="#cb118-1078" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-1079"><a href="#cb118-1079" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-1080"><a href="#cb118-1080" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb118-1081"><a href="#cb118-1081" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb118-1082"><a href="#cb118-1082" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches simples Modell mit einem Messwert $Y$ und einer kontinuierlichen Einflussvariable als Kovariate $c_1$ sowie einer kategorialen Einflussvariablen als Faktor $f_A$ mit drei Leveln und einer kategorialen Einflussvariablen als Faktor $f_B$ mit zwei Leveln dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-1083"><a href="#cb118-1083" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-16</span></span>
<span id="cb118-1084"><a href="#cb118-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1085"><a href="#cb118-1085" aria-hidden="true" tabindex="-1"></a>p_c1_fa_2lvl_fb_3lvl_model</span>
<span id="cb118-1086"><a href="#cb118-1086" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1087"><a href="#cb118-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1088"><a href="#cb118-1088" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb118-1089"><a href="#cb118-1089" aria-hidden="true" tabindex="-1"></a><span class="fu">## Praktisch in R</span></span>
<span id="cb118-1090"><a href="#cb118-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1093"><a href="#cb118-1093" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1094"><a href="#cb118-1094" aria-hidden="true" tabindex="-1"></a>cov1_fac2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight <span class="sc">+</span> feeding <span class="sc">+</span> stage, <span class="at">data =</span> flea_model_tbl) </span>
<span id="cb118-1095"><a href="#cb118-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1096"><a href="#cb118-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1099"><a href="#cb118-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1100"><a href="#cb118-1100" aria-hidden="true" tabindex="-1"></a>cov1_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb118-1101"><a href="#cb118-1101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-1102"><a href="#cb118-1102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1103"><a href="#cb118-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1106"><a href="#cb118-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1107"><a href="#cb118-1107" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb118-1108"><a href="#cb118-1108" aria-hidden="true" tabindex="-1"></a>cov1_fac2_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb118-1109"><a href="#cb118-1109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1110"><a href="#cb118-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1111"><a href="#cb118-1111" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch in R</span></span>
<span id="cb118-1112"><a href="#cb118-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1115"><a href="#cb118-1115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1116"><a href="#cb118-1116" aria-hidden="true" tabindex="-1"></a><span class="fu">model.matrix</span>(svl <span class="sc">~</span> mass <span class="sc">+</span> region <span class="sc">+</span> color, <span class="at">data =</span> snake_tbl) <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() </span>
<span id="cb118-1117"><a href="#cb118-1117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1118"><a href="#cb118-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1119"><a href="#cb118-1119" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-1120"><a href="#cb118-1120" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb118-1121"><a href="#cb118-1121" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb118-1122"><a href="#cb118-1122" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb118-1123"><a href="#cb118-1123" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb118-1124"><a href="#cb118-1124" aria-hidden="true" tabindex="-1"></a>  51 <span class="sc">\\</span></span>
<span id="cb118-1125"><a href="#cb118-1125" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb118-1126"><a href="#cb118-1126" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb118-1127"><a href="#cb118-1127" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb118-1128"><a href="#cb118-1128" aria-hidden="true" tabindex="-1"></a>  49 <span class="sc">\\</span></span>
<span id="cb118-1129"><a href="#cb118-1129" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-1130"><a href="#cb118-1130" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb118-1131"><a href="#cb118-1131" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-1132"><a href="#cb118-1132" aria-hidden="true" tabindex="-1"></a>  1 &amp; 6 &amp; 0 &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb118-1133"><a href="#cb118-1133" aria-hidden="true" tabindex="-1"></a>  1 &amp; 8 &amp; 0 &amp; 0 &amp; 0<span class="sc">\\</span></span>
<span id="cb118-1134"><a href="#cb118-1134" aria-hidden="true" tabindex="-1"></a>  1 &amp; 5 &amp; 0 &amp; 1 &amp; 0<span class="sc">\\</span></span>
<span id="cb118-1135"><a href="#cb118-1135" aria-hidden="true" tabindex="-1"></a>  1 &amp; 7 &amp; 1 &amp; 1 &amp; 0<span class="sc">\\</span></span>
<span id="cb118-1136"><a href="#cb118-1136" aria-hidden="true" tabindex="-1"></a>  1 &amp; 9 &amp; 1 &amp; 1 &amp; 0<span class="sc">\\</span></span>
<span id="cb118-1137"><a href="#cb118-1137" aria-hidden="true" tabindex="-1"></a>  1 &amp; 11&amp; 1 &amp; 0 &amp; 1<span class="sc">\\</span></span>
<span id="cb118-1138"><a href="#cb118-1138" aria-hidden="true" tabindex="-1"></a>  1 &amp; 12&amp; 1 &amp; 0 &amp; 1<span class="sc">\\</span></span>
<span id="cb118-1139"><a href="#cb118-1139" aria-hidden="true" tabindex="-1"></a>  1 &amp; 10&amp; 1 &amp; 0 &amp; 1<span class="sc">\\</span></span>
<span id="cb118-1140"><a href="#cb118-1140" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-1141"><a href="#cb118-1141" aria-hidden="true" tabindex="-1"></a> \times</span>
<span id="cb118-1142"><a href="#cb118-1142" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-1143"><a href="#cb118-1143" aria-hidden="true" tabindex="-1"></a>  \beta_0 <span class="sc">\\</span></span>
<span id="cb118-1144"><a href="#cb118-1144" aria-hidden="true" tabindex="-1"></a>  \beta_{mass} <span class="sc">\\</span></span>
<span id="cb118-1145"><a href="#cb118-1145" aria-hidden="true" tabindex="-1"></a>  \beta^{region}_{nord} <span class="sc">\\</span></span>
<span id="cb118-1146"><a href="#cb118-1146" aria-hidden="true" tabindex="-1"></a>  \beta^{color}_{rot} <span class="sc">\\</span></span>
<span id="cb118-1147"><a href="#cb118-1147" aria-hidden="true" tabindex="-1"></a>  \beta^{color}_{blau} <span class="sc">\\</span></span>
<span id="cb118-1148"><a href="#cb118-1148" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb118-1149"><a href="#cb118-1149" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-1150"><a href="#cb118-1150" aria-hidden="true" tabindex="-1"></a>  \epsilon_1 <span class="sc">\\</span></span>
<span id="cb118-1151"><a href="#cb118-1151" aria-hidden="true" tabindex="-1"></a>  \epsilon_2 <span class="sc">\\</span></span>
<span id="cb118-1152"><a href="#cb118-1152" aria-hidden="true" tabindex="-1"></a>  \epsilon_3 <span class="sc">\\</span></span>
<span id="cb118-1153"><a href="#cb118-1153" aria-hidden="true" tabindex="-1"></a>  \epsilon_4 <span class="sc">\\</span></span>
<span id="cb118-1154"><a href="#cb118-1154" aria-hidden="true" tabindex="-1"></a>  \epsilon_5 <span class="sc">\\</span></span>
<span id="cb118-1155"><a href="#cb118-1155" aria-hidden="true" tabindex="-1"></a>  \epsilon_6 <span class="sc">\\</span></span>
<span id="cb118-1156"><a href="#cb118-1156" aria-hidden="true" tabindex="-1"></a>  \epsilon_7 <span class="sc">\\</span></span>
<span id="cb118-1157"><a href="#cb118-1157" aria-hidden="true" tabindex="-1"></a>  \epsilon_8 <span class="sc">\\</span></span>
<span id="cb118-1158"><a href="#cb118-1158" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-1159"><a href="#cb118-1159" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-1160"><a href="#cb118-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1163"><a href="#cb118-1163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1164"><a href="#cb118-1164" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(svl <span class="sc">~</span> mass <span class="sc">+</span> region <span class="sc">+</span> color, <span class="at">data =</span> snake_tbl) </span>
<span id="cb118-1165"><a href="#cb118-1165" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-1166"><a href="#cb118-1166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1167"><a href="#cb118-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1170"><a href="#cb118-1170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1171"><a href="#cb118-1171" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="sc">|&gt;</span> <span class="fu">residuals</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-1172"><a href="#cb118-1172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1173"><a href="#cb118-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1174"><a href="#cb118-1174" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-1175"><a href="#cb118-1175" aria-hidden="true" tabindex="-1"></a> \begin{pmatrix}</span>
<span id="cb118-1176"><a href="#cb118-1176" aria-hidden="true" tabindex="-1"></a>  40 <span class="sc">\\</span></span>
<span id="cb118-1177"><a href="#cb118-1177" aria-hidden="true" tabindex="-1"></a>  45 <span class="sc">\\</span></span>
<span id="cb118-1178"><a href="#cb118-1178" aria-hidden="true" tabindex="-1"></a>  39 <span class="sc">\\</span></span>
<span id="cb118-1179"><a href="#cb118-1179" aria-hidden="true" tabindex="-1"></a>  50 <span class="sc">\\</span></span>
<span id="cb118-1180"><a href="#cb118-1180" aria-hidden="true" tabindex="-1"></a>  52 <span class="sc">\\</span></span>
<span id="cb118-1181"><a href="#cb118-1181" aria-hidden="true" tabindex="-1"></a>  57 <span class="sc">\\</span></span>
<span id="cb118-1182"><a href="#cb118-1182" aria-hidden="true" tabindex="-1"></a>  58 <span class="sc">\\</span></span>
<span id="cb118-1183"><a href="#cb118-1183" aria-hidden="true" tabindex="-1"></a>  49 <span class="sc">\\</span></span>
<span id="cb118-1184"><a href="#cb118-1184" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-1185"><a href="#cb118-1185" aria-hidden="true" tabindex="-1"></a> =</span>
<span id="cb118-1186"><a href="#cb118-1186" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-1187"><a href="#cb118-1187" aria-hidden="true" tabindex="-1"></a>  25 &amp; \phantom{0}6 \cdot 2.5 &amp; 0 \cdot 5 &amp; 0 \cdot 1.5&amp; 0 \cdot -2.83 <span class="sc">\\</span></span>
<span id="cb118-1188"><a href="#cb118-1188" aria-hidden="true" tabindex="-1"></a>  25 &amp; \phantom{0}8 \cdot 2.5 &amp; 0 \cdot 5 &amp; 0 \cdot 1.5&amp; 0 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb118-1189"><a href="#cb118-1189" aria-hidden="true" tabindex="-1"></a>  25 &amp; \phantom{0}5 \cdot 2.5 &amp; 0 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb118-1190"><a href="#cb118-1190" aria-hidden="true" tabindex="-1"></a>  25 &amp; \phantom{0}7 \cdot 2.5 &amp; 1 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb118-1191"><a href="#cb118-1191" aria-hidden="true" tabindex="-1"></a>  25 &amp; \phantom{0}9 \cdot 2.5 &amp; 1 \cdot 5 &amp; 1 \cdot 1.5&amp; 0 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb118-1192"><a href="#cb118-1192" aria-hidden="true" tabindex="-1"></a>  25 &amp; 11\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb118-1193"><a href="#cb118-1193" aria-hidden="true" tabindex="-1"></a>  25 &amp; 12\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb118-1194"><a href="#cb118-1194" aria-hidden="true" tabindex="-1"></a>  25 &amp; 10\cdot 2.5 &amp; 1 \cdot 5 &amp; 0 \cdot 1.5&amp; 1 \cdot -2.83<span class="sc">\\</span></span>
<span id="cb118-1195"><a href="#cb118-1195" aria-hidden="true" tabindex="-1"></a> \end{pmatrix} +</span>
<span id="cb118-1196"><a href="#cb118-1196" aria-hidden="true" tabindex="-1"></a>  \begin{pmatrix}</span>
<span id="cb118-1197"><a href="#cb118-1197" aria-hidden="true" tabindex="-1"></a>  \phantom{+}0.00 <span class="sc">\\</span></span>
<span id="cb118-1198"><a href="#cb118-1198" aria-hidden="true" tabindex="-1"></a>  \phantom{+}0.00 <span class="sc">\\</span></span>
<span id="cb118-1199"><a href="#cb118-1199" aria-hidden="true" tabindex="-1"></a>  \phantom{+}0.00 <span class="sc">\\</span></span>
<span id="cb118-1200"><a href="#cb118-1200" aria-hidden="true" tabindex="-1"></a>  +2.00 <span class="sc">\\</span></span>
<span id="cb118-1201"><a href="#cb118-1201" aria-hidden="true" tabindex="-1"></a>  -2.00 <span class="sc">\\</span></span>
<span id="cb118-1202"><a href="#cb118-1202" aria-hidden="true" tabindex="-1"></a>  +2.33 <span class="sc">\\</span></span>
<span id="cb118-1203"><a href="#cb118-1203" aria-hidden="true" tabindex="-1"></a>  +0.83 <span class="sc">\\</span></span>
<span id="cb118-1204"><a href="#cb118-1204" aria-hidden="true" tabindex="-1"></a>  -3.17 <span class="sc">\\</span></span>
<span id="cb118-1205"><a href="#cb118-1205" aria-hidden="true" tabindex="-1"></a> \end{pmatrix}</span>
<span id="cb118-1206"><a href="#cb118-1206" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-1207"><a href="#cb118-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1210"><a href="#cb118-1210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1211"><a href="#cb118-1211" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">25</span> <span class="sc">+</span>  <span class="dv">6</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb118-1212"><a href="#cb118-1212" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">8</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb118-1213"><a href="#cb118-1213" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">5</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.00</span>,</span>
<span id="cb118-1214"><a href="#cb118-1214" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">7</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">2.00</span>,</span>
<span id="cb118-1215"><a href="#cb118-1215" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span>  <span class="dv">9</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">-</span> <span class="fl">2.00</span>,</span>
<span id="cb118-1216"><a href="#cb118-1216" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span> <span class="dv">11</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">2.33</span>,</span>
<span id="cb118-1217"><a href="#cb118-1217" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">+</span> <span class="fl">0.83</span>,</span>
<span id="cb118-1218"><a href="#cb118-1218" aria-hidden="true" tabindex="-1"></a>  <span class="dv">25</span> <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span><span class="fl">2.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="dv">5</span> <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fl">1.5</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*-</span><span class="fl">2.83</span> <span class="sc">-</span> <span class="fl">3.17</span>) </span>
<span id="cb118-1219"><a href="#cb118-1219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1220"><a href="#cb118-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1221"><a href="#cb118-1221" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulation</span></span>
<span id="cb118-1222"><a href="#cb118-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1225"><a href="#cb118-1225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1226"><a href="#cb118-1226" aria-hidden="true" tabindex="-1"></a>cov1_fac2_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb118-1227"><a href="#cb118-1227" aria-hidden="true" tabindex="-1"></a>                        <span class="at">f_a =</span> <span class="fu">rep</span>(<span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>), <span class="dv">2</span>),</span>
<span id="cb118-1228"><a href="#cb118-1228" aria-hidden="true" tabindex="-1"></a>                        <span class="at">f_b =</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">15</span>),</span>
<span id="cb118-1229"><a href="#cb118-1229" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb118-1230"><a href="#cb118-1230" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">1</span> <span class="sc">*</span> c_1 <span class="sc">+</span> </span>
<span id="cb118-1231"><a href="#cb118-1231" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">2</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_a) <span class="sc">+</span> </span>
<span id="cb118-1232"><a href="#cb118-1232" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">3</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_b) <span class="sc">+</span> </span>
<span id="cb118-1233"><a href="#cb118-1233" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span>
<span id="cb118-1234"><a href="#cb118-1234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1235"><a href="#cb118-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1238"><a href="#cb118-1238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1239"><a href="#cb118-1239" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> f_a <span class="sc">+</span> f_b, cov1_fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb118-1240"><a href="#cb118-1240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-1241"><a href="#cb118-1241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1242"><a href="#cb118-1242" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb118-1243"><a href="#cb118-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1244"><a href="#cb118-1244" aria-hidden="true" tabindex="-1"></a><span class="fu">#### $c_1 + c_2 + f_A + f_B$ {.unnumbered .unlisted}</span></span>
<span id="cb118-1245"><a href="#cb118-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1248"><a href="#cb118-1248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1249"><a href="#cb118-1249" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-1250"><a href="#cb118-1250" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-1251"><a href="#cb118-1251" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-1252"><a href="#cb118-1252" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-1253"><a href="#cb118-1253" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 2</span></span>
<span id="cb118-1254"><a href="#cb118-1254" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb118-1255"><a href="#cb118-1255" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Schemantisches simples Modell mit einem Messwert $Y$ und einer kontinuierlichen Einflussvariable als Kovariate $c_1$ sowie einer kategorialen Einflussvariablen als Faktor $f_A$ mit drei Leveln und einer kategorialen Einflussvariablen als Faktor $f_B$ mit zwei Leveln dargestellt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-1256"><a href="#cb118-1256" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-in-R-21</span></span>
<span id="cb118-1257"><a href="#cb118-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1258"><a href="#cb118-1258" aria-hidden="true" tabindex="-1"></a>p_c2_fa_2lvl_fb_3lvl_model </span>
<span id="cb118-1259"><a href="#cb118-1259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1260"><a href="#cb118-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1261"><a href="#cb118-1261" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb118-1262"><a href="#cb118-1262" aria-hidden="true" tabindex="-1"></a><span class="fu">## Praktisch in R</span></span>
<span id="cb118-1263"><a href="#cb118-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1266"><a href="#cb118-1266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1267"><a href="#cb118-1267" aria-hidden="true" tabindex="-1"></a>cov2_fac2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> weight <span class="sc">+</span> count_leg <span class="sc">+</span> feeding <span class="sc">+</span> stage, <span class="at">data =</span> flea_model_tbl) </span>
<span id="cb118-1268"><a href="#cb118-1268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1269"><a href="#cb118-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1272"><a href="#cb118-1272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1273"><a href="#cb118-1273" aria-hidden="true" tabindex="-1"></a>cov2_fac2_fit <span class="sc">|&gt;</span> </span>
<span id="cb118-1274"><a href="#cb118-1274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-1275"><a href="#cb118-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1276"><a href="#cb118-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1279"><a href="#cb118-1279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1280"><a href="#cb118-1280" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb118-1281"><a href="#cb118-1281" aria-hidden="true" tabindex="-1"></a>cov2_fac2_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb118-1282"><a href="#cb118-1282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1283"><a href="#cb118-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1284"><a href="#cb118-1284" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretisch in R</span></span>
<span id="cb118-1285"><a href="#cb118-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1286"><a href="#cb118-1286" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulation</span></span>
<span id="cb118-1287"><a href="#cb118-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1290"><a href="#cb118-1290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1291"><a href="#cb118-1291" aria-hidden="true" tabindex="-1"></a>cov2_fac2_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">c_1 =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb118-1292"><a href="#cb118-1292" aria-hidden="true" tabindex="-1"></a>                        <span class="at">c_2 =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb118-1293"><a href="#cb118-1293" aria-hidden="true" tabindex="-1"></a>                        <span class="at">f_a =</span> <span class="fu">rep</span>(<span class="fu">gl</span>(<span class="dv">3</span>, <span class="dv">5</span>), <span class="dv">2</span>),</span>
<span id="cb118-1294"><a href="#cb118-1294" aria-hidden="true" tabindex="-1"></a>                        <span class="at">f_b =</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">15</span>),</span>
<span id="cb118-1295"><a href="#cb118-1295" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb118-1296"><a href="#cb118-1296" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">1</span> <span class="sc">*</span> c_1 <span class="sc">+</span> </span>
<span id="cb118-1297"><a href="#cb118-1297" aria-hidden="true" tabindex="-1"></a>                            <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> c_2 <span class="sc">+</span> </span>
<span id="cb118-1298"><a href="#cb118-1298" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">2</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_a) <span class="sc">+</span> </span>
<span id="cb118-1299"><a href="#cb118-1299" aria-hidden="true" tabindex="-1"></a>                            <span class="dv">3</span> <span class="sc">*</span> <span class="fu">as.numeric</span>(f_b) <span class="sc">+</span> </span>
<span id="cb118-1300"><a href="#cb118-1300" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rnorm</span>(<span class="dv">15</span>, <span class="dv">0</span>, <span class="fl">0.001</span>))</span>
<span id="cb118-1301"><a href="#cb118-1301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1302"><a href="#cb118-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1305"><a href="#cb118-1305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1306"><a href="#cb118-1306" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> c_1 <span class="sc">+</span> c_2 <span class="sc">+</span> f_a <span class="sc">+</span> f_b, cov2_fac2_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb118-1307"><a href="#cb118-1307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-1308"><a href="#cb118-1308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1309"><a href="#cb118-1309" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb118-1310"><a href="#cb118-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1311"><a href="#cb118-1311" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prädiktives Modell</span></span>
<span id="cb118-1312"><a href="#cb118-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1313"><a href="#cb118-1313" aria-hidden="true" tabindex="-1"></a>Neben dem klassischen kausalen Modell können wir auch ein prädiktives Modell rechnen. In einem prädiktiven Modell wollen wir wissen, welche Werte unser Messwert für neue Werte der Einflussvariable annehmen würde. Auch in einem prädiktiven Modell rechnen wir erstmal ganz normal eine multiple lineare Regression. Dann nutzen wir das Modell der Regression um neue Werte für unseren Messwert anhand neuer oder alter Werte der Einflussvariable vorherzusagen. Daher können wir auch beides miteinander verbinden. Du schaust erst was das kausale Modell ergibt und lässt dir dann neue Messwerte vorhersagen. Dabei musst du immer beachten, dass die vorhergesagten Messwerte auf der angepassten Ebene der Regression liegen. Daher nennen wir die vorhergesagten Messwerte auch angepasste Messwerte (eng. *fitted*). Wir werden später in der <span class="co">[</span><span class="ot">Klassifikation</span><span class="co">](#sec-class-basic)</span>, der Vorhersage von $0/1$-Werten, noch andere Prädktionen und deren Maßzahlen kennen lernen. Die vorgehensweise ist aber so identisch mit der im <span class="co">[</span><span class="ot">Kapitel zur simplen linearen Regression</span><span class="co">](#sec-modeling-simple-stat)</span>, so dass ich hier nicht nochmal alles wiederhole. Einfach nochmal dort schauen und die Modelle von oben verwenden. Weitere allgemeine Beispiel finden sich auch in den Kapitel zu den <span class="co">[</span><span class="ot">Marginal effect models</span><span class="co">](#sec-marginal)</span> und dem <span class="co">[</span><span class="ot">Modellieren in R</span><span class="co">](#sec-modeling-R)</span>.</span>
<span id="cb118-1314"><a href="#cb118-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1315"><a href="#cb118-1315" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weiteres von Interesse</span></span>
<span id="cb118-1316"><a href="#cb118-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1317"><a href="#cb118-1317" aria-hidden="true" tabindex="-1"></a>In den folgenden Abschnitten schauen wir uns noch andere Dinge von Interesse einmal an. Zum einen haben wir ein Problem, wenn unsere Einflussvariablen untereinander zu stark korreliert sind. Das zeige ich dann einmal an den Beinhaaren bei den Flöhen. Auch ist es problematisch, wenn wir eine Einheit gewählt hat, die sehr große Werte beinhaltet. Das kann ich dir gleich einmal an den Yediflöhen aufzeigen. Dann schauen wir nochmal in die Unabhängigkeitsannahme der Einflussvariablen. Neben der Korrelation sollten die Einflussvariablen auch wirklich unabhängig voneinander sein und sich nicht als Modell selbst erklären. Dann am Ende wollen wir natürlich auch noch wissen, was das beste Modell für unsere Daten wäre. Welche Einflussvariablen kann ich den reinnehmen und was ist dann das beste Modell? Darauf gehe ich dann hier auch nochmal ein.</span>
<span id="cb118-1318"><a href="#cb118-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1319"><a href="#cb118-1319" aria-hidden="true" tabindex="-1"></a><span class="fu">### Einheit der Kovariaten</span></span>
<span id="cb118-1320"><a href="#cb118-1320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1321"><a href="#cb118-1321" aria-hidden="true" tabindex="-1"></a><span class="al">![Ein seltener Jedifloh, der so machtsensitiv ist, dass seine Fähigkeiten in der Sprungweite extrem erhöht sind.](images/flea_yedi.png)</span>{#fig-yedi-flea fig-align="center" width="60%"}</span>
<span id="cb118-1322"><a href="#cb118-1322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1323"><a href="#cb118-1323" aria-hidden="true" tabindex="-1"></a>Kommen wir nun nochmal zu einem Problem der Einheit. Wir können einen sehr kleinen Effekt vorliegen haben, der dann signifikant ist. Schnell denken wir dann, dass dieser Effekt sehr klein ust und damit nicht relevant. Wir sprechen aber bei einer Regression immer von der Steigung als Effekt. Wenn sich also die Einheit der Einflussvariable um Eins erhöht, dann steigt der Messwert um den Wert des Koeffizienten der Steigung. Wenn wir also sehr große Werte messen, dann ist die Änderung in einer Einheit sehr klein. Schauen wir uns mal das Beispiel der Jediflöhe an.</span>
<span id="cb118-1324"><a href="#cb118-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1325"><a href="#cb118-1325" aria-hidden="true" tabindex="-1"></a>Manche Flöhe haben hohe Werte der <span class="co">[</span><span class="ot">Midi-Chlorianer</span><span class="co">](https://www.jedipedia.net/wiki/Midi-Chlorianer)</span> oder einfach M-Werte. Damit sind diese Flöhe insbesondere sensitiv für die Macht und somit Jediflöhe. Jediflöhe könnten damit auch höhere Sprungweiten vorliegen haben, da die Jediflöhe ja einen teil ihrer MAcht dazu nutzen könnten weiter zu springen. Daher wollen wir mal in einer einfachen simplen Regression mit nur den M-Werten schauen, ob die M-Werte einen Einfluss auf die Sprungweiten haben. Ich lasse mir jetzt nur die Tabelle der Koeffizienten wiedergeben.</span>
<span id="cb118-1326"><a href="#cb118-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1329"><a href="#cb118-1329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1330"><a href="#cb118-1330" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(jump_length <span class="sc">~</span> M, <span class="at">data =</span> flea_model_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb118-1331"><a href="#cb118-1331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>() <span class="sc">|&gt;</span> <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span>
<span id="cb118-1332"><a href="#cb118-1332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1333"><a href="#cb118-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1334"><a href="#cb118-1334" aria-hidden="true" tabindex="-1"></a>Wie wir jetzt sehen ist der Effekt mit 0.002cm extrem gering aber dennoch signifkant. Der p-Wert ist kleiner als das Signifikanzniveau $\alpha$ gleich 5%. Ist also der Wert der Midi-Chlorianer nicht relevant? Hier kommt es auf die Einheit und damit die Spannweite der M-Wert an. Die M-Werte laufen von 80.19 bis 25149.36 Anzahl Midi-Chlorianer im Blut. Damit ist eine kleine Änderung in den M-Werten auch nur mit einer kleinen Änderung in den Sprungweiten verbunden. Also Achtung bei Kovariaten mit großer Spannweite und kleinen Einheiten.</span>
<span id="cb118-1335"><a href="#cb118-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1338"><a href="#cb118-1338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1339"><a href="#cb118-1339" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-1340"><a href="#cb118-1340" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-1341"><a href="#cb118-1341" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-1342"><a href="#cb118-1342" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-1343"><a href="#cb118-1343" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3.5</span></span>
<span id="cb118-1344"><a href="#cb118-1344" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb118-1345"><a href="#cb118-1345" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Sprungweite in [cm] und Anzahl Midi-Chlorianer im Blut. Die lineare Grade und die Gradengleichung wurden ergänzt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-1346"><a href="#cb118-1346" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-m-values</span></span>
<span id="cb118-1347"><a href="#cb118-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1348"><a href="#cb118-1348" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(flea_model_tbl, <span class="fu">aes</span>(M, jump_length)) <span class="sc">+</span></span>
<span id="cb118-1349"><a href="#cb118-1349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb118-1350"><a href="#cb118-1350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb118-1351"><a href="#cb118-1351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb118-1352"><a href="#cb118-1352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb118-1353"><a href="#cb118-1353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">color =</span> <span class="st">"#56B4E9"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb118-1354"><a href="#cb118-1354" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fullrange =</span> <span class="cn">TRUE</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb118-1355"><a href="#cb118-1355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="st">"eq"</span>), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb118-1356"><a href="#cb118-1356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Einkovariates Modell"</span>,</span>
<span id="cb118-1357"><a href="#cb118-1357" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Zusammenhang zwischen Sprungweite und Anzahl Midi-Chlorianer im Blut"</span>,</span>
<span id="cb118-1358"><a href="#cb118-1358" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Anzahl Midi-Chlorianer im Blut"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>) <span class="sc">+</span></span>
<span id="cb118-1359"><a href="#cb118-1359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">200</span>)</span>
<span id="cb118-1360"><a href="#cb118-1360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1361"><a href="#cb118-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1362"><a href="#cb118-1362" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adjustierung für Confounder {#sec-confounder}</span></span>
<span id="cb118-1363"><a href="#cb118-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1366"><a href="#cb118-1366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1367"><a href="#cb118-1367" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-1368"><a href="#cb118-1368" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-1369"><a href="#cb118-1369" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-1370"><a href="#cb118-1370" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-1371"><a href="#cb118-1371" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb118-1372"><a href="#cb118-1372" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb118-1373"><a href="#cb118-1373" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot der Sprungweite in [cm] und Anzahl Midi-Chlorianer im Blut. Die lineare Grade und die Gradengleichung wurden ergänzt. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-1374"><a href="#cb118-1374" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-model-m-confounding</span></span>
<span id="cb118-1375"><a href="#cb118-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1376"><a href="#cb118-1376" aria-hidden="true" tabindex="-1"></a>p1_confounder <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(flea_model_tbl, <span class="fu">aes</span>(M, jump_length, <span class="at">color =</span> feeding)) <span class="sc">+</span></span>
<span id="cb118-1377"><a href="#cb118-1377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb118-1378"><a href="#cb118-1378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb118-1379"><a href="#cb118-1379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb118-1380"><a href="#cb118-1380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb118-1381"><a href="#cb118-1381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb118-1382"><a href="#cb118-1382" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fullrange =</span> <span class="cn">TRUE</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb118-1383"><a href="#cb118-1383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="st">"eq"</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">vstep =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb118-1384"><a href="#cb118-1384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Anzahl Midi-Chlorianer im Blut"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>,</span>
<span id="cb118-1385"><a href="#cb118-1385" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Ernährung"</span>) <span class="sc">+</span></span>
<span id="cb118-1386"><a href="#cb118-1386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">200</span>) <span class="sc">+</span></span>
<span id="cb118-1387"><a href="#cb118-1387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Zuckerwasser"</span>, <span class="st">"Blut"</span>, <span class="st">"Ketchup"</span>)) <span class="sc">+</span></span>
<span id="cb118-1388"><a href="#cb118-1388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb118-1389"><a href="#cb118-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1390"><a href="#cb118-1390" aria-hidden="true" tabindex="-1"></a>p2_confounder <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(flea_model_tbl, <span class="fu">aes</span>(M, jump_length, <span class="at">color =</span> <span class="fu">as_factor</span>(infected))) <span class="sc">+</span></span>
<span id="cb118-1391"><a href="#cb118-1391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb118-1392"><a href="#cb118-1392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb118-1393"><a href="#cb118-1393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"grey50"</span>) <span class="sc">+</span></span>
<span id="cb118-1394"><a href="#cb118-1394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb118-1395"><a href="#cb118-1395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb118-1396"><a href="#cb118-1396" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fullrange =</span> <span class="cn">TRUE</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb118-1397"><a href="#cb118-1397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="st">"eq"</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">vstep =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb118-1398"><a href="#cb118-1398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Anzahl Midi-Chlorianer im Blut"</span>, <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>,</span>
<span id="cb118-1399"><a href="#cb118-1399" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Flohschnupfen"</span>) <span class="sc">+</span></span>
<span id="cb118-1400"><a href="#cb118-1400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="cn">NA</span>, <span class="dv">200</span>) <span class="sc">+</span></span>
<span id="cb118-1401"><a href="#cb118-1401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"nein"</span>, <span class="st">"ja"</span>)) <span class="sc">+</span></span>
<span id="cb118-1402"><a href="#cb118-1402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb118-1403"><a href="#cb118-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1404"><a href="#cb118-1404" aria-hidden="true" tabindex="-1"></a>p1_confounder <span class="sc">+</span> p2_confounder <span class="sc">+</span></span>
<span id="cb118-1405"><a href="#cb118-1405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb118-1406"><a href="#cb118-1406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb118-1407"><a href="#cb118-1407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb118-1408"><a href="#cb118-1408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1409"><a href="#cb118-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1412"><a href="#cb118-1412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1413"><a href="#cb118-1413" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> M, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb118-1414"><a href="#cb118-1414" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> M <span class="sc">+</span> feeding, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb118-1415"><a href="#cb118-1415" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> M <span class="sc">+</span> infected, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb118-1416"><a href="#cb118-1416" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1417"><a href="#cb118-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1418"><a href="#cb118-1418" aria-hidden="true" tabindex="-1"></a>Wir nutzen hier die tollen Funktionen aus dem <span class="co">[</span><span class="ot">R Paket `{modelsummary}`</span><span class="co">](https://modelsummary.com/vignettes/get_started.html)</span> und dann dem <span class="co">[</span><span class="ot">R Paket `{tinytable}`</span><span class="co">](https://vincentarelbundock.github.io/tinytable/)</span></span>
<span id="cb118-1419"><a href="#cb118-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1422"><a href="#cb118-1422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1423"><a href="#cb118-1423" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-1424"><a href="#cb118-1424" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-1425"><a href="#cb118-1425" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-1426"><a href="#cb118-1426" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-modelsummary-table-confound</span></span>
<span id="cb118-1427"><a href="#cb118-1427" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Interecept entfernt."</span></span>
<span id="cb118-1428"><a href="#cb118-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1429"><a href="#cb118-1429" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"I"</span> <span class="ot">=</span> fit_1, <span class="st">"II"</span> <span class="ot">=</span> fit_2, <span class="st">"III"</span> <span class="ot">=</span> fit_3), </span>
<span id="cb118-1430"><a href="#cb118-1430" aria-hidden="true" tabindex="-1"></a>             <span class="at">fmt =</span> <span class="fu">fmt_statistic</span>(<span class="at">estimate =</span> <span class="dv">4</span>), </span>
<span id="cb118-1431"><a href="#cb118-1431" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"p = {p.value}"</span>),</span>
<span id="cb118-1432"><a href="#cb118-1432" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_map =</span> <span class="fu">c</span>(<span class="st">"M"</span> <span class="ot">=</span> <span class="st">"Midi-Chlorianer"</span>,</span>
<span id="cb118-1433"><a href="#cb118-1433" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"feedingblood"</span> <span class="ot">=</span> <span class="st">"Ernährung (Blut)"</span>,</span>
<span id="cb118-1434"><a href="#cb118-1434" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"feedingketchup"</span> <span class="ot">=</span> <span class="st">"Ernährung (Ketchup)"</span>,</span>
<span id="cb118-1435"><a href="#cb118-1435" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"infected0"</span> <span class="ot">=</span> <span class="st">"Flohschnupfen (nein)"</span>),</span>
<span id="cb118-1436"><a href="#cb118-1436" aria-hidden="true" tabindex="-1"></a>             <span class="at">gof_omit =</span> <span class="st">"IC|F|RMSE|Log"</span>, <span class="at">stars =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb118-1437"><a href="#cb118-1437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">style_tt</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">background =</span> <span class="st">"#E69F00"</span>) <span class="sc">|&gt;</span></span>
<span id="cb118-1438"><a href="#cb118-1438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_tt</span>(<span class="at">j =</span> <span class="fu">list</span>(<span class="st">"Model"</span> <span class="ot">=</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb118-1439"><a href="#cb118-1439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1440"><a href="#cb118-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1441"><a href="#cb118-1441" aria-hidden="true" tabindex="-1"></a><span class="fu">### Korrelation der Kovariaten</span></span>
<span id="cb118-1442"><a href="#cb118-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1443"><a href="#cb118-1443" aria-hidden="true" tabindex="-1"></a>Die Einlfussvariablen haben neben der Einheit noch andere Probleme. Teilweise sind diese Probleme nicht ganz so offensichtlich, wie gleich in meinem Beispiel gewählt. Probleme treten auf, wenn die Einflussvariablen untereinander zu stark miteinander korreliert sind. Mehr zur Korrelation erfährst du im <span class="co">[</span><span class="ot">Kapitel zur Korrelation</span><span class="co">](#sec-lin-reg-corr)</span>. Hier wiederhole ich jetzt nicht die Grundlagen. Wenn also Einflussvariablen sehr stark miteinander korrelaiert sind, dann erklären die Variablen mehr oder minder das Gleiche. In der folgenden Abbildung siehst du den Zusammenhang zwischen der Sprungweite und der Anzahl an Haaren auf den Flohbeinen. Wie es so ist, können wir hier natürlich verschiedene Beine oder die mittlere Anzahl betrachten. Vermeintlich glücklicherweise haben aber alle den gleichen Koeffizienten.</span>
<span id="cb118-1444"><a href="#cb118-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1447"><a href="#cb118-1447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1448"><a href="#cb118-1448" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-1449"><a href="#cb118-1449" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-1450"><a href="#cb118-1450" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-1451"><a href="#cb118-1451" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-1452"><a href="#cb118-1452" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4.5</span></span>
<span id="cb118-1453"><a href="#cb118-1453" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 11</span></span>
<span id="cb118-1454"><a href="#cb118-1454" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Zusammenhang zwischen der Sprungweite und der Anzahl an Haaren an den Flohbeinen. Eine Regressiongrade wurde für das simple lineare Modell ergänzt. **(A)** Mittlere Anzahl an Haaren über beide Beine. **(B)** Anzahl Haare auf dem linken Bein. **(C)** Anzahl Haare auf dem rechten Bein. *[Zum Vergrößern anklicken]*"</span></span>
<span id="cb118-1455"><a href="#cb118-1455" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mult-count-leg</span></span>
<span id="cb118-1456"><a href="#cb118-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1457"><a href="#cb118-1457" aria-hidden="true" tabindex="-1"></a>p1_corr_leg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(flea_model_tbl, <span class="fu">aes</span>(<span class="at">x =</span> count_leg, <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb118-1458"><a href="#cb118-1458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb118-1459"><a href="#cb118-1459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb118-1460"><a href="#cb118-1460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb118-1461"><a href="#cb118-1461" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fullrange =</span> <span class="cn">TRUE</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#009E73"</span>) <span class="sc">+</span></span>
<span id="cb118-1462"><a href="#cb118-1462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="st">"eq"</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">vstep =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb118-1463"><a href="#cb118-1463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mittlerer Beinhaare"</span>,</span>
<span id="cb118-1464"><a href="#cb118-1464" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>)</span>
<span id="cb118-1465"><a href="#cb118-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1466"><a href="#cb118-1466" aria-hidden="true" tabindex="-1"></a>p2_corr_leg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(flea_model_tbl, <span class="fu">aes</span>(<span class="at">x =</span> count_leg_left, <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb118-1467"><a href="#cb118-1467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb118-1468"><a href="#cb118-1468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb118-1469"><a href="#cb118-1469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb118-1470"><a href="#cb118-1470" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fullrange =</span> <span class="cn">TRUE</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#CC79A7"</span>) <span class="sc">+</span></span>
<span id="cb118-1471"><a href="#cb118-1471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="st">"eq"</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">vstep =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb118-1472"><a href="#cb118-1472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Beinhaare linkes Bein"</span>,</span>
<span id="cb118-1473"><a href="#cb118-1473" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>)</span>
<span id="cb118-1474"><a href="#cb118-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1475"><a href="#cb118-1475" aria-hidden="true" tabindex="-1"></a>p3_corr_leg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(flea_model_tbl, <span class="fu">aes</span>(<span class="at">x =</span> count_leg_right, <span class="at">y =</span> jump_length)) <span class="sc">+</span></span>
<span id="cb118-1476"><a href="#cb118-1476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_modeling</span>() <span class="sc">+</span></span>
<span id="cb118-1477"><a href="#cb118-1477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb118-1478"><a href="#cb118-1478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb118-1479"><a href="#cb118-1479" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fullrange =</span> <span class="cn">TRUE</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"#0072B2"</span>) <span class="sc">+</span></span>
<span id="cb118-1480"><a href="#cb118-1480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(<span class="st">"eq"</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">vstep =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb118-1481"><a href="#cb118-1481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Beinhaare rechtes Bein"</span>,</span>
<span id="cb118-1482"><a href="#cb118-1482" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Sprungweite in [cm]"</span>)</span>
<span id="cb118-1483"><a href="#cb118-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1484"><a href="#cb118-1484" aria-hidden="true" tabindex="-1"></a>p1_corr_leg <span class="sc">+</span> p2_corr_leg <span class="sc">+</span> p3_corr_leg <span class="sc">+</span></span>
<span id="cb118-1485"><a href="#cb118-1485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb118-1486"><a href="#cb118-1486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">'A'</span>, <span class="at">tag_prefix =</span> <span class="st">'('</span>, <span class="at">tag_suffix =</span> <span class="st">')'</span>) <span class="sc">&amp;</span></span>
<span id="cb118-1487"><a href="#cb118-1487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.tag =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb118-1488"><a href="#cb118-1488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1489"><a href="#cb118-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1490"><a href="#cb118-1490" aria-hidden="true" tabindex="-1"></a>Dann können wir uns auch einmal die Korrelation zwischen den drein Kovariaten anschauen. Wie zu erwarten ist die Korrelation maximal mit Eins. Die Sterne zeigen die Signifikanz an. Das Beispiel ist hier konstruiert, aber in biologischen Systemen oder Laborwerten können wir schnell sehr hohe Korrelationen erreichen. Das Gewicht und der BMI ist sehr hoch korreliert. Blutwerte wie Hämoglobin, Eisengehalt und Sauerstoffsättigung können das Gleiche anzeigen.</span>
<span id="cb118-1491"><a href="#cb118-1491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1494"><a href="#cb118-1494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1495"><a href="#cb118-1495" aria-hidden="true" tabindex="-1"></a>flea_model_tbl <span class="sc">|&gt;</span> </span>
<span id="cb118-1496"><a href="#cb118-1496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(count_leg, count_leg_left, count_leg_right) <span class="sc">|&gt;</span> </span>
<span id="cb118-1497"><a href="#cb118-1497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">correlation</span>() <span class="sc">|&gt;</span> </span>
<span id="cb118-1498"><a href="#cb118-1498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="at">redundant =</span> <span class="cn">TRUE</span>)</span>
<span id="cb118-1499"><a href="#cb118-1499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1500"><a href="#cb118-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1501"><a href="#cb118-1501" aria-hidden="true" tabindex="-1"></a>Naheliegend wäre es jetzt ein Modell zu bauen in dem alle drei Kovariaten enthalten sind. Dann müssen wir uns nicht entscheiden welche wir nehmen und erhalten für jede Kovariate eine Information. Wenn du nochmal auf die Abbildung schaust, wir erwarten hier eigentlich eine signifikante Steigung.</span>
<span id="cb118-1502"><a href="#cb118-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1505"><a href="#cb118-1505" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1506"><a href="#cb118-1506" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> count_leg <span class="sc">+</span> count_leg_left <span class="sc">+</span> count_leg_right, <span class="at">data =</span> flea_model_tbl) </span>
<span id="cb118-1507"><a href="#cb118-1507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1508"><a href="#cb118-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1509"><a href="#cb118-1509" aria-hidden="true" tabindex="-1"></a>Wenn wir nun die Koeffizienten betrachten, dann werden wir schon stutzig. Wir erhalten eine negative Steigung für die mittlere Anzahl und dann für die beiden Beine dann eine positive Steigung, die auch grob nur halb so groß ist. Das ist schon mal nicht so gut.</span>
<span id="cb118-1510"><a href="#cb118-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1513"><a href="#cb118-1513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1514"><a href="#cb118-1514" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="sc">|&gt;</span> </span>
<span id="cb118-1515"><a href="#cb118-1515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>() <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb118-1516"><a href="#cb118-1516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1517"><a href="#cb118-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1518"><a href="#cb118-1518" aria-hidden="true" tabindex="-1"></a>Betrachten wir also einmal das Modell in der Zusammenfassung um zu sehen, wie die Koeffizienten und die Residuen aussehen. Die Modelgüte ist akzeptabel. Was aber auffällt ist, dass keine der Kovariaten signifikant ist. Das ist sehr seltsam, wenn wir die Abbildung betrachten. Wir sehen hier die direkte Folge von hoch korrelierter Kovariaten. Wenn diese hoch korreliert sind, dann werden alle nicht signfikant.</span>
<span id="cb118-1519"><a href="#cb118-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1522"><a href="#cb118-1522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1523"><a href="#cb118-1523" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb118-1524"><a href="#cb118-1524" aria-hidden="true" tabindex="-1"></a>cov2_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb118-1525"><a href="#cb118-1525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1526"><a href="#cb118-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1527"><a href="#cb118-1527" aria-hidden="true" tabindex="-1"></a>Dann vergleichen wir einmal alle drei Modelle mit den tollen Funktionen aus dem <span class="co">[</span><span class="ot">R Paket `{modelsummary}`</span><span class="co">](https://modelsummary.com/vignettes/get_started.html)</span> und dann dem <span class="co">[</span><span class="ot">R Paket `{tinytable}`</span><span class="co">](https://vincentarelbundock.github.io/tinytable/)</span>. Wir bauen also erstmal das simple Modell mit nur der mittleren Beinanzahl und dann ergänzen wir schrittweise die Anzahl der Haare der linken und rechten Beine.</span>
<span id="cb118-1528"><a href="#cb118-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1531"><a href="#cb118-1531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1532"><a href="#cb118-1532" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> count_leg, <span class="at">data =</span> flea_model_tbl) </span>
<span id="cb118-1533"><a href="#cb118-1533" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> count_leg <span class="sc">+</span> count_leg_left, <span class="at">data =</span> flea_model_tbl) </span>
<span id="cb118-1534"><a href="#cb118-1534" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> count_leg <span class="sc">+</span> count_leg_left <span class="sc">+</span> count_leg_right, <span class="at">data =</span> flea_model_tbl) </span>
<span id="cb118-1535"><a href="#cb118-1535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1536"><a href="#cb118-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1537"><a href="#cb118-1537" aria-hidden="true" tabindex="-1"></a>Jetzt können wir alle drei Modell nebeneinander direkt miteinander vergleichen. Wir sehen hier sehr schön, wie der p-Wert der mitttleren Beinanzahl immer weiter anstiegt je mehr korrelierte Kovariaten in das Modell kommen. Spannenderweise bleibt die Modellgüte immer gleich. Wir sehen also das Problem nicht, wenn wir uns zum Beispiel das Bestimmtheitsmaß nur anschauen. Du musst also immer vorab auf die Korrelation schauen.</span>
<span id="cb118-1538"><a href="#cb118-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1541"><a href="#cb118-1541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1542"><a href="#cb118-1542" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-1543"><a href="#cb118-1543" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-1544"><a href="#cb118-1544" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-1545"><a href="#cb118-1545" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-modelsummary-table-corrr</span></span>
<span id="cb118-1546"><a href="#cb118-1546" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Interecept entfernt."</span></span>
<span id="cb118-1547"><a href="#cb118-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1548"><a href="#cb118-1548" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"I"</span> <span class="ot">=</span> fit_1, <span class="st">"II"</span> <span class="ot">=</span> fit_2, <span class="st">"III"</span> <span class="ot">=</span> fit_3), </span>
<span id="cb118-1549"><a href="#cb118-1549" aria-hidden="true" tabindex="-1"></a>             <span class="at">statistic =</span> <span class="fu">c</span>(<span class="st">"p = {p.value}"</span>),</span>
<span id="cb118-1550"><a href="#cb118-1550" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_map =</span> <span class="fu">c</span>(<span class="st">"count_leg"</span> <span class="ot">=</span> <span class="st">"Mittlere Beinhaare"</span>,</span>
<span id="cb118-1551"><a href="#cb118-1551" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"count_leg_left"</span> <span class="ot">=</span> <span class="st">"Linke Beinhaare"</span>,</span>
<span id="cb118-1552"><a href="#cb118-1552" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"count_leg_right"</span> <span class="ot">=</span> <span class="st">"Rechte Beinhaare"</span>),</span>
<span id="cb118-1553"><a href="#cb118-1553" aria-hidden="true" tabindex="-1"></a>             <span class="at">gof_omit =</span> <span class="st">"IC|F|RMSE|Log"</span>, <span class="at">stars =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb118-1554"><a href="#cb118-1554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_tt</span>(<span class="at">j =</span> <span class="fu">list</span>(<span class="st">"Model"</span> <span class="ot">=</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb118-1555"><a href="#cb118-1555" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1556"><a href="#cb118-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1557"><a href="#cb118-1557" aria-hidden="true" tabindex="-1"></a><span class="fu">### Variance inflation factor (VIF) {#sec-vif}</span></span>
<span id="cb118-1558"><a href="#cb118-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1559"><a href="#cb118-1559" aria-hidden="true" tabindex="-1"></a>Eigentlich nur für Kovariaten geht es auch mit Faktoren. **Hier nochmal nach GVIF schauen.**</span>
<span id="cb118-1560"><a href="#cb118-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1561"><a href="#cb118-1561" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-1562"><a href="#cb118-1562" aria-hidden="true" tabindex="-1"></a>VIF = \cfrac{1}{1- R^2}</span>
<span id="cb118-1563"><a href="#cb118-1563" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-1564"><a href="#cb118-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1565"><a href="#cb118-1565" aria-hidden="true" tabindex="-1"></a>Die Interpretation der VIF-Werte (Variance Inflation Factor) hilft dir, den Grad der Multikollinearität in deinem Modell zu bewerten:</span>
<span id="cb118-1566"><a href="#cb118-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1567"><a href="#cb118-1567" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>VIF = 1: Es gibt keine Multikollinearität.</span>
<span id="cb118-1568"><a href="#cb118-1568" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>VIF zwischen 1 und 5: Es liegt moderate Multikollinearität vor, die in der Regel unproblematisch ist.</span>
<span id="cb118-1569"><a href="#cb118-1569" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>VIF <span class="sc">\&gt;</span> 5: Es gibt eine hohe Multikollinearität, die die Koeffizienten unzuverlässig machen kann. Hier sollten Maßnahmen ergriffen werden.</span>
<span id="cb118-1570"><a href="#cb118-1570" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>VIF <span class="sc">\&gt;</span> 10: Dies deutet auf eine sehr hohe Multikollinearität hin, die dringend korrigiert werden muss.</span>
<span id="cb118-1571"><a href="#cb118-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1574"><a href="#cb118-1574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1575"><a href="#cb118-1575" aria-hidden="true" tabindex="-1"></a>juvenile_flea_tbl <span class="ot">&lt;-</span> <span class="fu">filter</span>(flea_model_tbl, stage <span class="sc">==</span> <span class="st">"juvenile"</span>)</span>
<span id="cb118-1576"><a href="#cb118-1576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1577"><a href="#cb118-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1580"><a href="#cb118-1580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1581"><a href="#cb118-1581" aria-hidden="true" tabindex="-1"></a>juvenile_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> K <span class="sc">+</span> Mg <span class="sc">+</span> CRP <span class="sc">+</span> Hb <span class="sc">+</span> BSG <span class="sc">+</span> M, </span>
<span id="cb118-1582"><a href="#cb118-1582" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> juvenile_flea_tbl)</span>
<span id="cb118-1583"><a href="#cb118-1583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1584"><a href="#cb118-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1585"><a href="#cb118-1585" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb118-1586"><a href="#cb118-1586" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{car}`</span></span>
<span id="cb118-1587"><a href="#cb118-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1590"><a href="#cb118-1590" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1591"><a href="#cb118-1591" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(juvenile_fit)</span>
<span id="cb118-1592"><a href="#cb118-1592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1593"><a href="#cb118-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1594"><a href="#cb118-1594" aria-hidden="true" tabindex="-1"></a><span class="fu">## `{performance}`</span></span>
<span id="cb118-1595"><a href="#cb118-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1596"><a href="#cb118-1596" aria-hidden="true" tabindex="-1"></a>Wir können uns mit der Funcktion <span class="in">`check_model()`</span> aus dem R Paket <span class="in">`{performance}`</span> auch die Unsicherheit mit angeben lassen. In unserem Beispiel hieft dies gerade nicht sehr viel weiter. Wir bleiben bei den geschätzen Werten und ignorieren das Intervall.</span>
<span id="cb118-1597"><a href="#cb118-1597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1600"><a href="#cb118-1600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1601"><a href="#cb118-1601" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-1602"><a href="#cb118-1602" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-1603"><a href="#cb118-1603" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-1604"><a href="#cb118-1604" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb118-1605"><a href="#cb118-1605" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb118-1606"><a href="#cb118-1606" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Graphische Darstellung des VIF mit der Funktion `check_model()`.</span></span>
<span id="cb118-1607"><a href="#cb118-1607" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-stat-modeling-vif</span></span>
<span id="cb118-1608"><a href="#cb118-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1609"><a href="#cb118-1609" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(juvenile_fit, <span class="at">check =</span> <span class="st">"vif"</span>)</span>
<span id="cb118-1610"><a href="#cb118-1610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1611"><a href="#cb118-1611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1612"><a href="#cb118-1612" aria-hidden="true" tabindex="-1"></a><span class="fu">## Händisch in R</span></span>
<span id="cb118-1613"><a href="#cb118-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1616"><a href="#cb118-1616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1617"><a href="#cb118-1617" aria-hidden="true" tabindex="-1"></a>vif_fct <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>x)</span>
<span id="cb118-1618"><a href="#cb118-1618" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1619"><a href="#cb118-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1622"><a href="#cb118-1622" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1623"><a href="#cb118-1623" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(K <span class="sc">~</span> Mg <span class="sc">+</span> CRP <span class="sc">+</span> Hb <span class="sc">+</span> BSG <span class="sc">+</span> M, <span class="at">data =</span> juvenile_flea_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb118-1624"><a href="#cb118-1624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2</span>() <span class="sc">|&gt;</span></span>
<span id="cb118-1625"><a href="#cb118-1625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"R2"</span>) <span class="sc">|&gt;</span> <span class="fu">vif_fct</span>() <span class="sc">|&gt;</span> <span class="fu">set_names</span>(<span class="st">"K"</span>)</span>
<span id="cb118-1626"><a href="#cb118-1626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1627"><a href="#cb118-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1630"><a href="#cb118-1630" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1631"><a href="#cb118-1631" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Mg <span class="sc">~</span> K <span class="sc">+</span> CRP <span class="sc">+</span> Hb <span class="sc">+</span> BSG <span class="sc">+</span> M, <span class="at">data =</span> juvenile_flea_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb118-1632"><a href="#cb118-1632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2</span>() <span class="sc">|&gt;</span></span>
<span id="cb118-1633"><a href="#cb118-1633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"R2"</span>) <span class="sc">|&gt;</span> <span class="fu">vif_fct</span>() <span class="sc">|&gt;</span> <span class="fu">set_names</span>(<span class="st">"Mg"</span>)</span>
<span id="cb118-1634"><a href="#cb118-1634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1635"><a href="#cb118-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1638"><a href="#cb118-1638" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1639"><a href="#cb118-1639" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(CRP <span class="sc">~</span> K <span class="sc">+</span> Mg <span class="sc">+</span> Hb <span class="sc">+</span> BSG <span class="sc">+</span> M, <span class="at">data =</span> juvenile_flea_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb118-1640"><a href="#cb118-1640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2</span>() <span class="sc">|&gt;</span></span>
<span id="cb118-1641"><a href="#cb118-1641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"R2"</span>) <span class="sc">|&gt;</span> <span class="fu">vif_fct</span>() <span class="sc">|&gt;</span> <span class="fu">set_names</span>(<span class="st">"CRP"</span>)</span>
<span id="cb118-1642"><a href="#cb118-1642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1643"><a href="#cb118-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1646"><a href="#cb118-1646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1647"><a href="#cb118-1647" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Hb <span class="sc">~</span> K <span class="sc">+</span> Mg <span class="sc">+</span> CRP <span class="sc">+</span> BSG <span class="sc">+</span> M, <span class="at">data =</span> juvenile_flea_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb118-1648"><a href="#cb118-1648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2</span>() <span class="sc">|&gt;</span></span>
<span id="cb118-1649"><a href="#cb118-1649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"R2"</span>) <span class="sc">|&gt;</span> <span class="fu">vif_fct</span>() <span class="sc">|&gt;</span> <span class="fu">set_names</span>(<span class="st">"Hb"</span>)</span>
<span id="cb118-1650"><a href="#cb118-1650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1651"><a href="#cb118-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1654"><a href="#cb118-1654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1655"><a href="#cb118-1655" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(BSG <span class="sc">~</span> K <span class="sc">+</span> Mg <span class="sc">+</span> CRP <span class="sc">+</span> Hb <span class="sc">+</span> M, <span class="at">data =</span> juvenile_flea_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb118-1656"><a href="#cb118-1656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2</span>() <span class="sc">|&gt;</span></span>
<span id="cb118-1657"><a href="#cb118-1657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"R2"</span>) <span class="sc">|&gt;</span> <span class="fu">vif_fct</span>() <span class="sc">|&gt;</span> <span class="fu">set_names</span>(<span class="st">"BSG"</span>)</span>
<span id="cb118-1658"><a href="#cb118-1658" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1659"><a href="#cb118-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1662"><a href="#cb118-1662" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1663"><a href="#cb118-1663" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(M <span class="sc">~</span> K <span class="sc">+</span> Mg <span class="sc">+</span> CRP <span class="sc">+</span> Hb <span class="sc">+</span> BSG, <span class="at">data =</span> juvenile_flea_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb118-1664"><a href="#cb118-1664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">r2</span>() <span class="sc">|&gt;</span></span>
<span id="cb118-1665"><a href="#cb118-1665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"R2"</span>) <span class="sc">|&gt;</span> <span class="fu">vif_fct</span>() <span class="sc">|&gt;</span> <span class="fu">set_names</span>(<span class="st">"M"</span>)</span>
<span id="cb118-1666"><a href="#cb118-1666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1667"><a href="#cb118-1667" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb118-1668"><a href="#cb118-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1669"><a href="#cb118-1669" aria-hidden="true" tabindex="-1"></a><span class="fu">### Vergleich von Modellen {#sec-model-basic-compare}</span></span>
<span id="cb118-1670"><a href="#cb118-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1671"><a href="#cb118-1671" aria-hidden="true" tabindex="-1"></a>Im Folgenden wollen wir einmal verschiedene Modelle miteinander Vergleichen und uns statistisch wiedergeben lassen, was das beste Modell ist. Und hier holen wir auch einmal kurz Luft, denn wir entschieden nur was das statistisch beste Modell ist. Es kann sein, dass ein Modell biologisch mehr Sinn macht und nicht auf Platz 1 der statistischen Maßzahlen steht. Das ist vollkommen in Ordnung. Du musst abweägen, was für sich das beste Modell ist. Im Zweifel komme ruhig nochmal in meine statistische Beratung oder schreibe mir eine Mail.</span>
<span id="cb118-1672"><a href="#cb118-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1673"><a href="#cb118-1673" aria-hidden="true" tabindex="-1"></a>Wir bauchen uns jetzt fünf Modelle von <span class="in">`fit_1`</span> bis <span class="in">`fit_5`</span>. Jedes dieser Modelle hat andere Einflussvariablen aber den gleichen Messwert. Im Weiteren sortieren wir die Modelle von einfach nach komplex. Ich versuche immmer das einfachste Modell <span class="in">`fit_1`</span> zu nennen und daher die niedrige Nummer zu geben. Im Idealfall benennst du die Modellobjekte nach den Modellen, die in en Objekten gespeichert sind. Oft sind die Modelle aber sehr groß und die Objekte der Fits haben dann sehr lange Namen.</span>
<span id="cb118-1674"><a href="#cb118-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1677"><a href="#cb118-1677" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1678"><a href="#cb118-1678" aria-hidden="true" tabindex="-1"></a>fit_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb118-1679"><a href="#cb118-1679" aria-hidden="true" tabindex="-1"></a>fit_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> stage, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb118-1680"><a href="#cb118-1680" aria-hidden="true" tabindex="-1"></a>fit_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> weight, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb118-1681"><a href="#cb118-1681" aria-hidden="true" tabindex="-1"></a>fit_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> stage <span class="sc">+</span> count_leg, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb118-1682"><a href="#cb118-1682" aria-hidden="true" tabindex="-1"></a>fit_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(jump_length <span class="sc">~</span> feeding <span class="sc">+</span> stage <span class="sc">+</span> weight, <span class="at">data =</span> flea_model_tbl)</span>
<span id="cb118-1683"><a href="#cb118-1683" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1684"><a href="#cb118-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1685"><a href="#cb118-1685" aria-hidden="true" tabindex="-1"></a>Als Ergänzung zum Bestimmtheitsmaß $R^2$ wollen wir uns noch das *Akaike information criterion* (abk. $AIC$) anschauen. Du kannst auch das $R^2$ bzw. das $R^2_{adj}$ für die Modellauswahl nehmen. Das $AIC$ ist neuer und auch für komplexere Modelle geeignet. Es gilt hierbei, je kleiner das $AIC$ ist, desto besser ist das $AIC$. Wir wollen also Modelle haben, die ein kleines $AIC$ haben. Wir gehen jetzt nicht auf die Berechnung der $AIC$'s für jedes Modell ein. Wir erhalten nur ein $AIC$ für jedes Modell. Die einzelnen Werte des $AIC$'s sagen *nichts* aus. Ein $AIC$ ist ein mathematisches Konstrukt. Wir können aber verwandte Modelle mit dem $AIC$ untereinander vergleichen. Daher berechnen wir ein $\Delta$ über die $AIC$. Dafür nehmen wir das Modell mit dem niedrigsten $AIC$ und berechnen die jeweiligen Differenzen zu den anderen $i$ Modellen. In unserem Beispiel ist $i$ dann gleich fünf, da wir fünf Modelle haben.</span>
<span id="cb118-1686"><a href="#cb118-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1687"><a href="#cb118-1687" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-1688"><a href="#cb118-1688" aria-hidden="true" tabindex="-1"></a>\Delta_i = AIC_i - AIC_{min}</span>
<span id="cb118-1689"><a href="#cb118-1689" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-1690"><a href="#cb118-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1691"><a href="#cb118-1691" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>wenn $\Delta_i &lt; 2$, gibt es keinen Unterschied zwischen den Modellen. Das $i$-te Modell ist genauso gut wie das Modell mit dem $AIC_{min}$.</span>
<span id="cb118-1692"><a href="#cb118-1692" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>wenn $2 &lt; \Delta_i &lt; 4$, dann gibt es eine starke Unterstützung für das $i$-te Modell. Das $i$-te Modell ist immer noch ähnlich gut wie das $AIC_{min}$.</span>
<span id="cb118-1693"><a href="#cb118-1693" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>wenn $4 &lt; \Delta_i &lt; 7$, dann gibt es deutlich weniger Unterstützung für das $i$-te Modell;</span>
<span id="cb118-1694"><a href="#cb118-1694" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Modelle mit $\Delta_i &gt; 10$ sind im Vergleich zu dem *besten* $AIC$ Modell nicht zu verwenden.</span>
<span id="cb118-1695"><a href="#cb118-1695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1696"><a href="#cb118-1696" aria-hidden="true" tabindex="-1"></a>Nehmen wir ein $AIC_1 = AIC_{min} = 100$ und $AIC_2$ ist $100,7$ an. Dann ist $\Delta_2=0,7&lt;2$, so dass es keinen wesentlichen Unterschied zwischen den Modellen gibt. Wir können uns entscheiden, welches der beiden Modelle wir nehmen. Hier ist dann wichtig, was auch die Biologie sagt oder eben andere Kriterien, wie Kosten und Nutzen. Wenn wir ein $AIC_1 = AIC_{min} = 100000$ und $AIC_2$ ist $100700$ vorliegen haben, dann ist $\Delta_2 = 700 \gg 10$, also gibt es keinen Grund für das $2$-te Modell. Das $2$-te Modell ist substantiell schlechter als das erste Modell. Mehr dazu kannst du unter <span class="co">[</span><span class="ot">Multimodel Inference: Understanding AIC and BIC in Model Selection</span><span class="co">](https://faculty.washington.edu/skalski/classes/QERM597/papers_xtra/Burnham%20and%20Anderson.pdf)</span> nachlesen.</span>
<span id="cb118-1697"><a href="#cb118-1697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1698"><a href="#cb118-1698" aria-hidden="true" tabindex="-1"></a>Wir können das $\Delta_i$ auch in eine Wahrscheinlichkeit umrechnen. Wir können $p_i$ berechnen und damit die relative (im Vergleich zu $AIC_{min}$) Wahrscheinlichkeit, dass das $i$-te Modell den AIC minimiert.</span>
<span id="cb118-1699"><a href="#cb118-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1700"><a href="#cb118-1700" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-1701"><a href="#cb118-1701" aria-hidden="true" tabindex="-1"></a>p_i = \exp\left(\cfrac{-\Delta_i}{2}\right)</span>
<span id="cb118-1702"><a href="#cb118-1702" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb118-1703"><a href="#cb118-1703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1704"><a href="#cb118-1704" aria-hidden="true" tabindex="-1"></a>Zum Beispiel entspricht $\Delta_i = 1.5$ einem $p_i$ von $0.47$ (ziemlich hoch) und ein $\Delta_i = 15$ entspricht einem $p_i =0.0005$ (ziemlich niedrig). Im ersten Fall besteht eine Wahrscheinlichkeit von 47%, dass das $i$-te Modell tatsächlich eine bessere Beschreibung ist als das Modell, das $AIC_{min}$ ergibt, und im zweiten Fall beträgt diese Wahrscheinlichkeit nur 0,05%. Wir können so einmal nachrechnen, ob sich eine Entscheidung für ein anderes Modell lohnen würde. Neben dem $AIC$ gibt es auch das Bayesian information criterion ($BIC$). Auch beim $BIC$ gilt, je kleiner das BIC ist, desto besser ist das BIC.</span>
<span id="cb118-1705"><a href="#cb118-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1706"><a href="#cb118-1706" aria-hidden="true" tabindex="-1"></a>Du siehst schon, es gibt eine Reihe von Möglichkeiten sich mit der Güte oder Qualität eines Modells zu beschäftigen. Wir nutzen die Funktion <span class="in">`model_performance()`</span> um uns die Informationen über die Güte eines Modells wiedergeben zu lassen. Im folgenden Codeblock habe ich mich nur auf das $AIC$ und das $BIC$ konzentriert.</span>
<span id="cb118-1707"><a href="#cb118-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1710"><a href="#cb118-1710" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1711"><a href="#cb118-1711" aria-hidden="true" tabindex="-1"></a><span class="fu">model_performance</span>(fit_1) <span class="sc">|&gt;</span> </span>
<span id="cb118-1712"><a href="#cb118-1712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb118-1713"><a href="#cb118-1713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(AIC, BIC)</span>
<span id="cb118-1714"><a href="#cb118-1714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1715"><a href="#cb118-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1716"><a href="#cb118-1716" aria-hidden="true" tabindex="-1"></a>Gut soweit. Du kannst jetzt für jedes der Modelle das $AIC$ berechnen und dann dir die Modelle entsprechend ordnen. Wir müssen das aber nicht tun. Wir können uns auch die Funktion <span class="in">`compare_performance()`</span> zu nutze machen. Die Funktion gibt uns die $R^2$-Werte wieder wie auch die $AIC$ sowie die $s^2_{\epsilon}$ als <span class="in">`sigma`</span> wieder. Wir haben also alles zusammen was wir brauchen. Darüber hinaus kann die Funktion auch die Modelle rangieren. Das nutzen wir natürlich gerne.</span>
<span id="cb118-1717"><a href="#cb118-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1720"><a href="#cb118-1720" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1721"><a href="#cb118-1721" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-1722"><a href="#cb118-1722" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-1723"><a href="#cb118-1723" aria-hidden="true" tabindex="-1"></a>comp_res <span class="ot">&lt;-</span> <span class="fu">compare_performance</span>(fit_1, fit_2, fit_3, fit_4, fit_5, <span class="at">rank =</span> <span class="cn">TRUE</span>)</span>
<span id="cb118-1724"><a href="#cb118-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1725"><a href="#cb118-1725" aria-hidden="true" tabindex="-1"></a>comp_res</span>
<span id="cb118-1726"><a href="#cb118-1726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1727"><a href="#cb118-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1728"><a href="#cb118-1728" aria-hidden="true" tabindex="-1"></a>Anhand der Ausgabe der Funktion <span class="in">`compare_performance()`</span> sehen wir, dass unser Modell <span class="in">`fit_2`</span> das beste Modell ist. Zwar ist die Streuung der Residuen nicht die Kleinste aller Modelle (<span class="in">`Sigma`</span> = 1.933) aber wir haben ein hohes $R^2_{adj}$ und auch ein kleines $AIC$. Wir würden damit sagen, dass das Modell <span class="in">`fit_2`</span> mit den Variablen <span class="in">`animal`</span> und <span class="in">`sex`</span> für $x$ das Outcome <span class="in">`jump_length`</span> am besten statistisch beschreibt.</span>
<span id="cb118-1729"><a href="#cb118-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1730"><a href="#cb118-1730" aria-hidden="true" tabindex="-1"></a>In @fig-stat-modeling-compare sehen wir die Ausgabe der Funktion <span class="in">`compare_performance()`</span> nochmal visualisiert. Wir können dann die einzelnen Modelle nochmal besser vergleichen. Auch siehst du hier, ob ein Modell in einem Bereich sehr schlecht ist oder aber nur in einem Bereich sehr gut.</span>
<span id="cb118-1731"><a href="#cb118-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1734"><a href="#cb118-1734" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1735"><a href="#cb118-1735" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-1736"><a href="#cb118-1736" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-1737"><a href="#cb118-1737" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb118-1738"><a href="#cb118-1738" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb118-1739"><a href="#cb118-1739" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb118-1740"><a href="#cb118-1740" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Graphische Darstellung der Funktion `compare_performance()` Wir sehen hier die einzelnen Gütekriterien in einer Übersicht dargestellt.</span></span>
<span id="cb118-1741"><a href="#cb118-1741" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-stat-modeling-compare</span></span>
<span id="cb118-1742"><a href="#cb118-1742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1743"><a href="#cb118-1743" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(comp_res)</span>
<span id="cb118-1744"><a href="#cb118-1744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1745"><a href="#cb118-1745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1746"><a href="#cb118-1746" aria-hidden="true" tabindex="-1"></a>Zum Ende stellt sich die Frage nach dem statistischen Test. Können wir auch statistisch Testen, ob das Modell <span class="in">`fit_1`</span> signifikant unterschiedlich ist? Ja wir können die Funktion <span class="in">`test_vuong()`</span> nutzen um ein Model zu den anderen Modellen zu vergleichen. Wenn du mehrere Modell miteinander vergleichen möchtest, dann muss du die Funktion mehrfach ausführen.</span>
<span id="cb118-1747"><a href="#cb118-1747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1750"><a href="#cb118-1750" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1751"><a href="#cb118-1751" aria-hidden="true" tabindex="-1"></a><span class="fu">test_vuong</span>(fit_1, fit_2, fit_3, fit_4, fit_5)</span>
<span id="cb118-1752"><a href="#cb118-1752" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1753"><a href="#cb118-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1756"><a href="#cb118-1756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb118-1757"><a href="#cb118-1757" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb118-1758"><a href="#cb118-1758" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb118-1759"><a href="#cb118-1759" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb118-1760"><a href="#cb118-1760" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-modelsummary-table-comp</span></span>
<span id="cb118-1761"><a href="#cb118-1761" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Interecept entfernt."</span></span>
<span id="cb118-1762"><a href="#cb118-1762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1763"><a href="#cb118-1763" aria-hidden="true" tabindex="-1"></a><span class="fu">modelsummary</span>(<span class="fu">lst</span>(<span class="st">"I"</span> <span class="ot">=</span> fit_1, <span class="st">"II"</span> <span class="ot">=</span> fit_2, <span class="st">"III"</span> <span class="ot">=</span> fit_3,</span>
<span id="cb118-1764"><a href="#cb118-1764" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"IV"</span> <span class="ot">=</span> fit_4, <span class="st">"V"</span> <span class="ot">=</span> fit_5), </span>
<span id="cb118-1765"><a href="#cb118-1765" aria-hidden="true" tabindex="-1"></a>             <span class="at">coef_map =</span> <span class="fu">c</span>(<span class="st">"intercept"</span> <span class="ot">=</span> <span class="st">"(Intercept)"</span>,</span>
<span id="cb118-1766"><a href="#cb118-1766" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"feedingblood"</span> <span class="ot">=</span> <span class="st">"Ernährung (Blut)"</span>,</span>
<span id="cb118-1767"><a href="#cb118-1767" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"feedingketchup"</span> <span class="ot">=</span> <span class="st">"Ernährung (Ketchup)"</span>,</span>
<span id="cb118-1768"><a href="#cb118-1768" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"stagejuvenile"</span> <span class="ot">=</span> <span class="st">"Entwicklung (juvenile)"</span>,</span>
<span id="cb118-1769"><a href="#cb118-1769" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"weight"</span> <span class="ot">=</span> <span class="st">" Gewicht [mg]"</span>,</span>
<span id="cb118-1770"><a href="#cb118-1770" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"count_leg"</span> <span class="ot">=</span> <span class="st">"Anzahl Beinhaare"</span>),</span>
<span id="cb118-1771"><a href="#cb118-1771" aria-hidden="true" tabindex="-1"></a>             <span class="at">gof_omit =</span> <span class="st">"F|Log"</span>, <span class="at">stars =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb118-1772"><a href="#cb118-1772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_tt</span>(<span class="at">j =</span> <span class="fu">list</span>(<span class="st">"Model"</span> <span class="ot">=</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb118-1773"><a href="#cb118-1773" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb118-1774"><a href="#cb118-1774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-1775"><a href="#cb118-1775" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-basic.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-basic.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>
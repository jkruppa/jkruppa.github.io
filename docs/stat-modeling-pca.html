<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Bio Data Science - 59&nbsp; Multivariate Verfahren</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./time-space-preface.html" rel="next">
<link href="./stat-modeling-cluster.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-modeling-preface.html">Statistisches Modellieren</a></li><li class="breadcrumb-item"><a href="./stat-modeling-pca.html"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Dunkelmodus umschalten"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Literatur</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Buchstaben und Zahlen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Ein <code>purrr</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Multiple Vergleiche oder Post-hoc Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Maßzahlen der Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Imputation fehlender Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Zeitreihen (eng. <em>time series</em>)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Räumliche Daten (eng. <em>spatial data</em>)</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#theoretischer-hintergrund" id="toc-theoretischer-hintergrund" class="nav-link active" data-scroll-target="#theoretischer-hintergrund"><span class="header-section-number">59.1</span> Theoretischer Hintergrund</a></li>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">59.2</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">59.3</span> Daten</a>
  <ul class="collapse">
  <li><a href="#zwei-beispieldatensätze" id="toc-zwei-beispieldatensätze" class="nav-link" data-scroll-target="#zwei-beispieldatensätze"><span class="header-section-number">59.3.1</span> Zwei Beispieldatensätze</a></li>
  <li><a href="#standardisieren" id="toc-standardisieren" class="nav-link" data-scroll-target="#standardisieren"><span class="header-section-number">59.3.2</span> Standardisieren</a></li>
  <li><a href="#das-data.frame-problem" id="toc-das-data.frame-problem" class="nav-link" data-scroll-target="#das-data.frame-problem"><span class="header-section-number">59.3.3</span> Das <code>data.frame()</code> Problem</a></li>
  </ul></li>
  <li><a href="#hauptkomponentenanalyse" id="toc-hauptkomponentenanalyse" class="nav-link" data-scroll-target="#hauptkomponentenanalyse"><span class="header-section-number">59.4</span> Hauptkomponentenanalyse</a>
  <ul class="collapse">
  <li><a href="#pca---principal-component-analysis" id="toc-pca---principal-component-analysis" class="nav-link" data-scroll-target="#pca---principal-component-analysis"><span class="header-section-number">59.4.1</span> PCA - Principal Component Analysis</a></li>
  <li><a href="#ca---correspondence-analysis" id="toc-ca---correspondence-analysis" class="nav-link" data-scroll-target="#ca---correspondence-analysis"><span class="header-section-number">59.4.2</span> CA - Correspondence Analysis</a></li>
  <li><a href="#mca---multiple-correspondence-analysis" id="toc-mca---multiple-correspondence-analysis" class="nav-link" data-scroll-target="#mca---multiple-correspondence-analysis"><span class="header-section-number">59.4.3</span> MCA - Multiple Correspondence Analysis</a></li>
  <li><a href="#famd---factor-analysis-of-mixed-data" id="toc-famd---factor-analysis-of-mixed-data" class="nav-link" data-scroll-target="#famd---factor-analysis-of-mixed-data"><span class="header-section-number">59.4.4</span> FAMD - Factor Analysis of Mixed Data</a></li>
  <li><a href="#mfa---multiple-factor-analysis" id="toc-mfa---multiple-factor-analysis" class="nav-link" data-scroll-target="#mfa---multiple-factor-analysis"><span class="header-section-number">59.4.5</span> MFA - Multiple Factor Analysis</a></li>
  </ul></li>
  <li><a href="#darstellung-der-ergebnisse" id="toc-darstellung-der-ergebnisse" class="nav-link" data-scroll-target="#darstellung-der-ergebnisse"><span class="header-section-number">59.5</span> Darstellung der Ergebnisse</a>
  <ul class="collapse">
  <li><a href="#ebene-der-eigenwerte" id="toc-ebene-der-eigenwerte" class="nav-link" data-scroll-target="#ebene-der-eigenwerte"><span class="header-section-number">59.5.1</span> Ebene der Eigenwerte</a></li>
  <li><a href="#ebene-der-variablen" id="toc-ebene-der-variablen" class="nav-link" data-scroll-target="#ebene-der-variablen"><span class="header-section-number">59.5.2</span> Ebene der Variablen</a></li>
  <li><a href="#ebene-der-individuen" id="toc-ebene-der-individuen" class="nav-link" data-scroll-target="#ebene-der-individuen"><span class="header-section-number">59.5.3</span> Ebene der Individuen</a></li>
  </ul></li>
  <li><a href="#multi-dimensional-scaling-mds" id="toc-multi-dimensional-scaling-mds" class="nav-link" data-scroll-target="#multi-dimensional-scaling-mds"><span class="header-section-number">59.6</span> Multi Dimensional Scaling (MDS)</a></li>
  <li><a href="#sec-lda" id="toc-sec-lda" class="nav-link" data-scroll-target="#sec-lda"><span class="header-section-number">59.7</span> Diskriminanzanalyse</a>
  <ul class="collapse">
  <li><a href="#lineare-diskriminanzanalyse-lda" id="toc-lineare-diskriminanzanalyse-lda" class="nav-link" data-scroll-target="#lineare-diskriminanzanalyse-lda"><span class="header-section-number">59.7.1</span> Lineare Diskriminanzanalyse (LDA)</a></li>
  <li><a href="#quadratische-diskriminanzanalyse-qda" id="toc-quadratische-diskriminanzanalyse-qda" class="nav-link" data-scroll-target="#quadratische-diskriminanzanalyse-qda"><span class="header-section-number">59.7.2</span> Quadratische Diskriminanzanalyse (QDA)</a></li>
  <li><a href="#mischungsdiskriminanzanalyse-mda" id="toc-mischungsdiskriminanzanalyse-mda" class="nav-link" data-scroll-target="#mischungsdiskriminanzanalyse-mda"><span class="header-section-number">59.7.3</span> Mischungsdiskriminanzanalyse (MDA)</a></li>
  <li><a href="#flexible-diskriminanzanalyse-fda" id="toc-flexible-diskriminanzanalyse-fda" class="nav-link" data-scroll-target="#flexible-diskriminanzanalyse-fda"><span class="header-section-number">59.7.4</span> Flexible Diskriminanzanalyse (FDA)</a></li>
  <li><a href="#regulierte-diskriminanzanalyse-rda" id="toc-regulierte-diskriminanzanalyse-rda" class="nav-link" data-scroll-target="#regulierte-diskriminanzanalyse-rda"><span class="header-section-number">59.7.5</span> Regulierte Diskriminanzanalyse (RDA)</a></li>
  </ul></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-pca-main" class="quarto-section-identifier"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><em>Letzte Änderung am 30. September 2023 um 10:47:39</em></p>
<p>In diesem Kapitel betrachten wir verschiedene multivariate Verfahren. Im Znetrum steht dabei die Hauptkomponentenanalyse und deren verwandten Algorithmen. Die Hauptkomponentenanalyse (eng. <em>Principle Component Analysis</em>, abk. PCA) ist ein bedeutendes Verfahren zur Dimensionsreduktion. Wir haben also einen sehr großen Datensatz mit sehr vielen Spalten und wollen Muster in den Beobachtungen finden, die durch die Zeilen definiert sind. Dieses Kapitel umfasst dabei aber nur die notwendigen Verfahren und Anwendungen. Das hat vor allem damit zu tun, dass die Hauptkomponentenanalyse in den Sozialwissenschaften sehr weitreichend genutzt wird. Wir machen hier aber Agrarwissenschaften, also ist es eher ein nebensächlicher Fokus. Ebenso ist die Auswertung von Fragebögen allgemein ein Schwerpunkt der Hauptkomponentenanalyse. Auch werden Fragebögen eher selten in meinem Feld ausgewertet, deshalb hier nur das eine Kapitel, wenn man auch sicherlich viel mehr schreiben könnte.</p>
<p>Das folgende Kapitel basiert zum Teilen auf den <a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/">Articles - Principal Component Methods in R: Practical Guide</a>. Diese Sammlung an Tutorien geben einen wunderbaren Überblick über alle möglichen Methoden zu der Hauptkomponentenanalyse und deren verwandten Algorithmen. Wenn dich dazu mehr interessiert kann ich das Buch von <span class="citation" data-cites="kassambara2017practical">Kassambara (<a href="#ref-kassambara2017practical" role="doc-biblioref">2017</a>)</span> dir sehr ans Herz legen. Dort findest du eine tolle Übersicht über die Hauptkomponentenanalyse in R.</p>
<p>Was ist grob die Idee der Hauptkomponentenanalyse? Wir wollen Geraden durch unsere Datenwolke ziehen und dabei die Varianz minimieren. In der <a href="#fig-cluster-pca-exp-01-1">Abbildung&nbsp;<span>59.1 (a)</span></a> siehst du eine solche Punktewolke. Das klingt jetzt wie die Regression und damit hast du auch recht. Die Hauptkomponentenanalyse und die lineare Regression sind nah miteinander verwandt. Damit wären wir schon beim ersten Punkt, Hauptkomponenten beschreiben einen Anteil der erklärten Varianz durch die entsprechende Hauptkomponente. Dabei erklärt <em>grundsätzlich</em> die 1. Hauptkomponente die meiste Varianz gefolgt von 2. Hauptkomponente und so fort. Die Hauptkomponenten sind somit nach dem Anteil der erklärten Varianz sortiert. Das ist eine grundlegende Eigenschaft der Hauptkomponenten. Darüber hinaus sind auch alle Hauptkomponenten untereinander mit 0 korreliert und somit maximal unkorreliert. Die Hauptkomponenten und damit die Geraden durch die Punktwolke stehen orthogonal oder senkrecht aufeinander. Es gibt so viele Hauptkomponente wie es Variablen in den Daten gibt. Mit Variablen meine ich hier die ungefähr die Spalten eines Datensatzes. Ungefähr, da wir nicht auf allen Spalten eine Hauptkomponenteanalyse rechnen können, aber dazu später mehr.</p>
<div id="fig-cluster-pca-exp-01" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-pca-exp-01-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-cluster-pca-exp-01-1.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-pca-exp-01" width="432"></p>
<figcaption class="figure-caption">(a) Simuliertes Datenbeispiel mit zwei Variablen <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span>. Die Punkte wurden mit der Regressionsgleichung <span class="math inline">\(y = 0 + 0.5 \cdot x\)</span> erzeugt und die Varianz <span class="math inline">\(\epsilon \sim \mathcal{N}(0,1)\)</span> gesetzt. Später versuchen wir aus der Hauptkomponenteanalyse die Werte für die Steigung <span class="math inline">\(\beta_x = 0.5\)</span> wieder zufinden.</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-pca-exp-01-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-cluster-pca-exp-01-2.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-pca-exp-01" width="432"></p>
<figcaption class="figure-caption">(b) Darstellung der 1. Hauptkomponente (PC1) durch die Punktewolke mit maximal erklärter Varianz, da minimaler Abstand zu den Punkten. Die 2. Hauptkomponente muss lotrecht auf der 1. Hauptkomponente stehen und dabei die Varianz maximal von der Hauptkomponente minimieren wird.</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;59.1— Übersicht über die Hauptkomponentenanalyse und deren ersten beiden Hauptkomponenten.</figcaption><p></p>
</figure>
</div>
<p>In der <a href="#fig-cluster-pca-exp-01-2">Abbildung&nbsp;<span>59.1 (b)</span></a> sehen wir einmal dargestellt, was eine Hauptkomponentenanalyse erreichen will. Wir legen zuerst die 1. Hauptkomponente (PC1) so durch die Daten, dass die Varianz durch die 1. Hauptkomponente maximal minimiert wird. Dann berechnen wir die 2. Hauptkomponente (PC2) so, dass die 2. Hauptkomponente senkrecht auf der 1. Hauptkomponente steht. Wir reduzieren damit die Varianz maximal weiter. Denn nur durch den senkrechten Stand der zweiten Hauptkomponente auf der ersten Hauptkomponente, können wir maximal viel Varianz erklären. Da wir hier nur zwei Variablen haben, gibt es auch nur zwei Hauptkomponenten.</p>
<p>Mit zwei Variablen gibt es nur eine Möglichkeit, die 2. Hauptkomponente anzuordnen. Bei mehr als zwei Hauptkomponenten gebe es ja auch noch andere Drehungen der 2. Hauptkomponente die ebenfalls die Bedingung, das Lot zur 1. Hauptkomponente zu sein, erfüllen würde. Du kannst es als eine eine Drehung um die 1. Hauptkomponente als zentrale Achse sehen. Wir wählen die lotrechte Repräsentation der 2. Hauptkomponente, die am meisten Varianz erklärt, also die Abstände minimiert, die noch nicht durch die 1. Hauptkomponente minimiert wurden. Somit erklärt die 2. Hauptkomponente <em>immer</em> weniger Varianz als die 1. Hauptkomponente. Mit weiteren Hauptkomponenten würden wir dann immer so weiter machen, bis wir immer weniger Varianz erklären können.</p>
<p>Du kannst dir jetzt noch den theoretischen Hintergrund durchlesen oder aber den Teil überspringen und die dann gleich die Daten einmal anschauen. Dann geht es auch gleich weiter zu dem Teil der angewandten Hauptkomponentenanalyse.</p>
<section id="theoretischer-hintergrund" class="level2 page-columns page-full" data-number="59.1">
<h2 data-number="59.1" class="anchored" data-anchor-id="theoretischer-hintergrund"><span class="header-section-number">59.1</span> Theoretischer Hintergrund</h2>
<p>Soweit klingt es ja alles recht einleuchten mit der Hauptkomponentenanalyse. Wie aber kommt jetzt die Idee einer Geraden durch die Punktewolke mit Hauptkomponenten zusammen? Wie geht das mathematisch eigentlich? Da sieht es schon etwas komplizierter aus. Deshalb fangen wir wie immer einmal mit einem Datensatz an. Wir nehmen das Datenbeispiel aus der <a href="#fig-cluster-pca-exp-01-1">Abbildung&nbsp;<span>59.1 (a)</span></a>. In der folgenden Tablle siehst du einmal die ersten sieben Wertepaare für <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span> der insgesamt dreißig Zeilen.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-pca-sim-data" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tabelle&nbsp;59.1— Auszug aus den dreißig Datenpaaren <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span>.</caption>
<thead>
<tr class="header">
<th style="text-align: center;">x</th>
<th style="text-align: center;">y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">-1.4660039</td>
<td style="text-align: center;">0.5425225</td>
</tr>
<tr class="even">
<td style="text-align: center;">-0.4523909</td>
<td style="text-align: center;">-0.8303681</td>
</tr>
<tr class="odd">
<td style="text-align: center;">-2.6538584</td>
<td style="text-align: center;">-1.5160298</td>
</tr>
<tr class="even">
<td style="text-align: center;">-7.1191853</td>
<td style="text-align: center;">-4.0628188</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2.4368904</td>
<td style="text-align: center;">-0.1544630</td>
</tr>
<tr class="even">
<td style="text-align: center;">-6.9975329</td>
<td style="text-align: center;">-3.7431590</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4.4292391</td>
<td style="text-align: center;">3.4317681</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Wie haben wir die Daten gebaut? Wir haben uns folgendes Modell genommen. Die <span class="math inline">\(y\)</span> Werte hängen von den <span class="math inline">\(x\)</span> Werten wfolgt ab.</p>
<p><span class="math display">\[
y \sim 0 + 0.5 \cdot x + \epsilon; \; \epsilon \sim \mathcal{N}(0,1)
\]</span></p>
<p>Das heißt, wir haben eine Steigung der Geraden <span class="math inline">\(\beta_x\)</span> von <span class="math inline">\(0.5\)</span>. Unsere Punkte streuen mit einer Varianz von <span class="math inline">\(1\)</span> um die Gerade. Wir wollen es nicht komplizierter machen als sowieso schon ist. Hier dann einmal die Implementierung in R. Das <code>set.seed()</code> nutzen wir um immer die gleichen Zahlen wiedergegeben zu bekommen. Wir ziehen die <span class="math inline">\(x\)</span>-Werte aus einer Normalverteilung mit einem Mittelwert von 0 und einer Standardabweichung von 5.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2045312</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">y =</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Jetzt können wir einmal über die Funktion <code>lm()</code> die Koeffizienten der Geraden schätzen. Also wie ist den nun die Steigung und der Achsenabschnitt in den generierten Daten?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x, tbl) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coefficients</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)           x 
       -0.1         0.5 </code></pre>
</div>
</div>
<p>Wir sehen, dass wir den y-Achsenabschnitt mit <span class="math inline">\(-0.1\)</span> nicht ganz treffen, wohl aber die Steigung mit <span class="math inline">\(0.5\)</span>. Damit hätten wir die Information für die erste Gerade, was ja auch die 1. Hauptkomponente wäre. Nun müssten wir die Gerade finden, die senkrecht auf der geschätzten Geraden steht und durch den Nullpunkt läuft. Das könnten wir ausprobieren oder aber auch abschätzen. Problematisch wird das ganze, wenn wir mehr als zwei Variablen haben. Hier kommt uns aber die Varianz/Kovarianzmatrix <span class="math inline">\(\boldsymbol{\Sigma_x}\)</span> zur Hilfe. In der Varianz/Kovarianzmatrix finden wir alle Informationen die wir brauchen und noch mehr.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Exkurs: Die Varianz/Kovarianzmatrix <span class="math inline">\(\boldsymbol{\Sigma_x}\)</span>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Wenn du dich ein wenig mit Eigenwerten auskennst, dann weißt du, dass Eigenwerte immer auf einer Matrix berechnet werden. In unserem Fall werden die Eigenwerte der Hauptkomponeten auf der Varianz/Kovarianzmatrix der standardisierten Daten berechnet. Im Folgenden siehst du einmal die Varianz/Kovarianzmatrix <span class="math inline">\(\boldsymbol{\Sigma_x}\)</span> für die Datenmatrix <span class="math inline">\(x\)</span>. Du musst dir vorstellen, dass jedes <span class="math inline">\(x_1\)</span> bis <span class="math inline">\(x_n\)</span> jeweils eine Spalte in deiner Datenmatrix <span class="math inline">\(\boldsymbol{x}\)</span> entspricht, die wir in unser Modell für die Hauptkomponentenanalyse aufnehmen wollen.</p>
<p><span class="math display">\[
\boldsymbol{\Sigma_x} = \begin{pmatrix}\operatorname{Var}(x_1) &amp; \operatorname{Cov}(x_1,x_2) &amp; \cdots &amp; \operatorname{Cov}(x_1,x_n) \\ \\
\operatorname{Cov}(x_2,x_1)  &amp; \operatorname{Var}(x_2) &amp; \cdots &amp; \operatorname{Cov}(x_2,x_n) \\ \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ \\
\operatorname{Cov}(x_n,x_1) &amp; \operatorname{Cov}(x_n,x_2) &amp; \cdots &amp; \operatorname{Var}(x_n)
\end{pmatrix}
\]</span></p>
<p>Für den Fall von zwei Variablen <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span> können wir die Idee der Kovarianz nochmal nachvollziehen. Später rechnen wir dann die Hauptkomponentenanalyse auf der großen Matrix, aber ich kann dir den Zusammenhang leider nur für zwei Variablen erklären, den zweidimensional kriege ich noch hin. Wir können mit folgender Formel die Kovarianzen zwischen den beiden Variablen <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span> berechnen.</p>
<p><span class="math display">\[
\operatorname{Cov}(x_2,x_1) = \sum_{i=1}^n(x_{1i}-\bar{x_1})(x_{2i}-\bar{x_2})
\]</span></p>
<p>Nochmal als Erinnerung, die Formel berechnet die quadrierten Abweichung der Beobachtungen von <span class="math inline">\(x_1\)</span> zum Mittelwert <span class="math inline">\(\bar{x}_1\)</span> und somit die Varianz <span class="math inline">\(\operatorname{Var}(x_1)\)</span> von <span class="math inline">\(x_1\)</span>.</p>
<p><span class="math display">\[
\operatorname{Var}(x_1) = \sum_{i=1}^n(x_{1i}-\bar{x}_1)^2
\]</span></p>
<p>Ebenso berechnet diese Formel die quadrierten Abweichung der Beobachtungen von <span class="math inline">\(x_2\)</span> zum Mittelwert <span class="math inline">\(\bar{x}_2\)</span> und damit die Varianz <span class="math inline">\(\operatorname{Var}(x_2)\)</span> von <span class="math inline">\(x_2\)</span>.</p>
<p><span class="math display">\[
\operatorname{Var}(x_2) = \sum_{i=1}^n(x_{2i}-\bar{x}_2)^2
\]</span></p>
<p>Das Ganze ist natürlich sehr trocken. Deshalb füttern wir einmal die Variablen <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span> mit echten Daten und erschaffen uns den Datensatz <code>cov_tbl</code>. In <a href="#tbl-pca-corr-example">Tabelle&nbsp;<span>59.2</span></a> ist der Zusammenhang nochmal Schritt für Schritt aufgeschlüsselt wie sich die Zahlen grob berechnen. Ich habe ein, zwei Schritte ausgelassen, aber die ergänzt du fix selber.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cov_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x_1 =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">1.0</span>, <span class="fl">1.2</span>, <span class="fl">1.9</span>, <span class="fl">2.0</span>, <span class="fl">2.7</span>, <span class="fl">2.8</span>),</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x_2 =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">1.8</span>, <span class="fl">1.3</span>, <span class="fl">1.7</span>, <span class="fl">2.6</span>, <span class="fl">1.8</span>, <span class="fl">2.7</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann können wir uns einmal den Mittelwert und die Varianz für die beiden Variablen <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span> berechnen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>cov_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  gather <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(key) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value), <span class="at">var =</span> <span class="fu">var</span>(value))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  key    mean   var
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 x_1    1.77 0.642
2 x_2    1.87 0.339</code></pre>
</div>
</div>
<p>In der folgenden <a href="#fig-pca-cov">Abbildung&nbsp;<span>59.2</span></a> siehst du einmal die Konzepte der Varianz für <span class="math inline">\(x_1\)</span> in Subplot A und <span class="math inline">\(x_2\)</span> in Subplot B dargestellt. Die durchgezogene Linie stellt dabei den Mittelwert für die beiden Variablen dar. Die Varianz berechnet sich jetzt als der quadrierte Abstand von den Beobachtungen zu den Mittelwerten. Der Abstand ist als gestrichelte Linie dargestellt. Faktisch addierst du die sich ergebenden Quadrate auf. Bei der Kovarianz sind es keine Quadrate, sondern Rechtecke. Die berechnest nämlich einmal den Abstand einer Beobachtung zum Mittelwert von <span class="math inline">\(x_1\)</span> und einmal den Abstand zum Mittelwert von <span class="math inline">\(x_2\)</span>. Die beiden Abstände <span class="math inline">\((x_{1i}-\bar{x_1})\)</span> und <span class="math inline">\((x_{2i}-\bar{x_2})\)</span> multiplizierst du und addierst dann diese Rechtecke auf.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pca-cov" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-cov-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Abbildung&nbsp;59.2— Berechnung der Abstände für die Varianz von <span class="math inline">\(x_1\)</span> sowie <span class="math inline">\(x_2\)</span> in der oberen Zeile. In der unteren Zeile die Rechtecke der Berechnung der Kovarianz von <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
<p>In der folgenden <a href="#tbl-pca-corr-example">Tabelle&nbsp;<span>59.2</span></a> siehst du dann das Vorgehen nochmal numerisch. Wichtig ist hierbei, dass wir am Ende die Varianz und die Kovarianz berechnen können indem wir die Summen <span class="math inline">\(\sum\)</span> durch <span class="math inline">\(n-1\)</span> gleich 6 teilen.</p>
<div id="tbl-pca-corr-example" class="anchored">
<table class="table">
<caption>Tabelle&nbsp;59.2— Tabelle zur Berechnung der Varianz sowie der Kovarianz von <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span>.</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{x_1}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{x_2}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{(x_{2i}-\bar{x}_2)^2}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{(x_{1i}-\bar{x}_1)^2}\)</span></th>
<th style="text-align: center;"><span class="math inline">\(\boldsymbol{(x_{1i}-\bar{x}_1)(x_{2i}-\bar{x}_2)}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">0.8</td>
<td style="text-align: center;">0.94</td>
<td style="text-align: center;">0.45</td>
<td style="text-align: center;">0.65</td>
</tr>
<tr class="even">
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">1.0</td>
<td style="text-align: center;">0.60</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.06</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1.3</td>
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">0.33</td>
<td style="text-align: center;">0.33</td>
<td style="text-align: center;">0.33</td>
</tr>
<tr class="even">
<td style="text-align: center;">1.7</td>
<td style="text-align: center;">1.9</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">-0.02</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2.6</td>
<td style="text-align: center;">2.0</td>
<td style="text-align: center;">0.05</td>
<td style="text-align: center;">0.53</td>
<td style="text-align: center;">0.17</td>
</tr>
<tr class="even">
<td style="text-align: center;">1.8</td>
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">0.86</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">-0.07</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2.7</td>
<td style="text-align: center;">2.8</td>
<td style="text-align: center;">1.06</td>
<td style="text-align: center;">0.69</td>
<td style="text-align: center;">0.85</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\sum\)</span></td>
<td style="text-align: center;">3.86</td>
<td style="text-align: center;">2.05</td>
<td style="text-align: center;">1.97</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;"><span class="math inline">\(\cfrac{\sum}{n-1}\)</span></td>
<td style="text-align: center;">0.64</td>
<td style="text-align: center;">0.34</td>
<td style="text-align: center;">0.33</td>
</tr>
</tbody>
</table>
</div>
<p>Schauen wir mal, ob wir richtig gerechnet haben und die Varianz für <span class="math inline">\(x_1\)</span> mit 0.64, die Varianz von <span class="math inline">\(x_2\)</span> mit 0.34 sowie die Kovarianz von <span class="math inline">\(x_1\)</span> und <span class="math inline">\(x_2\)</span> auch R wiederfinden. Wir nutzen die Funktion <code>cov()</code> um uns die Varianz/Kovarianzmatrix wiedergeben zu lassen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cov_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cov</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     x_1  x_2
x_1 0.64 0.33
x_2 0.33 0.34</code></pre>
</div>
</div>
<p>Wie wir sehen können wir die Werte in der Varianz/Kovarianzmatrix wiederfinden. Das ist ja mal ein Erfolg. Wir nutzen also die Varianz/Kovarianzmatrix als unsere Ähnlichkeitsmatrix, wie schon bei den Clusteranalysen, um hier unbekannte Zusammenhänge zwischen den Spalten und damit dann den Hauptkomponenten aufzuklären.</p>
</div>
</div>
</div>
<p>Erstmal wollen wir die Varianz/Kovarianzmatrix mit der Funktion <code>cov()</code> aus dem Datensatz berechnen. Wir runden hier ziemlich streng damit wir die Zahlen besser vergleichen können.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(tbl) <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">1</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     x    y
x 21.6 10.9
y 10.9  6.1</code></pre>
</div>
</div>
<p>Hier nochmal die Varianz/Kovarianzmatrix mathematisch aufgeschrieben. Auf der Diagonalen der Matrix findest du die Varianzen von <span class="math inline">\(x\)</span> sowie von <span class="math inline">\(y\)</span>. Auf den Nebendiagonalen dann die Kovarianz von <span class="math inline">\(x\)</span> und <span class="math inline">\(y\)</span>. Die Kovarianz beschriebt ja das Variieren von <span class="math inline">\(y\)</span>, wenn sich auch <span class="math inline">\(x\)</span> ändert. Eine Kovarianz von 0 bedeutet damit dann auch, dass wir keine Steigung oder einen Trend in der Punktewolke sehen. Ändert sich <span class="math inline">\(x\)</span> ändert sich <span class="math inline">\(y\)</span> nicht, wir haben kein gemeinsames Variieren.</p>
<p><span class="math display">\[
\Sigma =
\begin{pmatrix}
\operatorname{Var}(x) &amp; \operatorname{Cov}(x, y) \\
\operatorname{Cov}(x, y) &amp; \operatorname{Var}(y)
\end{pmatrix} =
\begin{pmatrix}
21.6 &amp; 10.9 \\
10.9 &amp; 6.1
\end{pmatrix}
\]</span></p>
<p>Und jetzt kommt der eigentlich Kniff. Wir können aus der Kovarianzmatrix unser <span class="math inline">\(\beta_x\)</span> berechnen. So einfach zwar nur, wenn wir zwei Variablen haben, aber das Prinzip ist auch bei mehr Variablen gegeben. Wenn wir die Kovarianz <span class="math inline">\(\operatorname{Cov}(x, y)\)</span> durch die Varianz (x) von <span class="math inline">\(x\)</span> teilen, erhalten wir die Steigung der Geraden.</p>
<p><span class="math display">\[
\beta_x = \cfrac{\operatorname{Cov}(x, y)}{\operatorname{Var}(x)} = \cfrac{10.9}{21.6} \approx 0.5
\]</span></p>
<p>Das heißt, dass wir in der Varianz/Kovarianzmatrix die Informationen über die Steigung der Geraden haben. Mehr noch, wenn wir mehrere Variablen haben, dann ist das Zusammenspiel der Variablen in der Varianz/Kovarianzmatrix verborgen. Schauen wir dazu nochmal die <a href="#fig-cluster-pca-exp-02-1">Abbildung&nbsp;<span>59.3 (a)</span></a> an. Hier sehen wir, wie die 1. Hauptkomponente durch die Punktewolke läuft. Wie kriegen wir jetzt in <a href="#fig-cluster-pca-exp-02-2">Abbildung&nbsp;<span>59.3 (b)</span></a> für die 2. Hauptkomponente die Koeffizienten der Gerade bestimmt? Hier kommt uns eine Eigenschaft einer Matrix und die Zerlegung der Matrix in ihre Eigenwerte und Eigenvektoren zu Hilfe.</p>
<div id="fig-cluster-pca-exp-02" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-cluster-pca-exp-02-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-cluster-pca-exp-02-1.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-pca-exp-02" width="432"></p>
<figcaption class="figure-caption">(a) 1. Hauptkomponente (PC1) durch die Punktewolke</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-cluster-pca-exp-02-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-cluster-pca-exp-02-2.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-pca-exp-02" width="432"></p>
<figcaption class="figure-caption">(b) 2. Hauptkomponente (PC2) durch die Punktewolke</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-cluster-pca-exp-02-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-cluster-pca-exp-02-3.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-pca-exp-02" width="432"></p>
<figcaption class="figure-caption">(c) Regressionsgleichungen der 1. Hauptkomponente (PC1) sowie deren Rotation zur 2. Hauptkomponente.</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;59.3— Schematische Darstellung der 1. Hauptkomponente (PC1) durch die Punktewolke mit maximal erklärter Varianz, da minimaler Abstand zu den Punkten. Die 2. Hauptkomponente muss lotrecht auf der 1. Hauptkomponente stehen und dabei die Varianz weiter maximal minimieren. Im Weiteren wurden dann die Regressiongleichungen ergänzt.</figcaption><p></p>
</figure>
</div>
<p>Folgende Funktion <code>eigen()</code> berechnet die Eigenwerte aus der Varianz/Kovarianzmatrix. Erstmal sieht das wieder realtiv wild aus und wir erkennen da noch nicht so richtig ein Muster. Eigenwerte und ihre Eigenvektoren sind nicht miteinander korreliert und stehen sozusagen orthogonal und damit senkrecht aufeinander. Das ist es was wir suchen!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>eigen_res <span class="ot">&lt;-</span> <span class="fu">cov</span>(tbl) <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  eigen</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>eigen_res</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1] 27.2356150  0.4907358

$vectors
           [,1]       [,2]
[1,] -0.8887583  0.4583762
[2,] -0.4583762 -0.8887583</code></pre>
</div>
</div>
<p>Wenn du jetzt die untere Zeile durch die obere Zeile der Eigenvektoren teilst, dann erhälst du zwei Zahlen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>eigen_res<span class="sc">$</span>vectors[<span class="dv">2</span>,] <span class="sc">/</span> eigen_res<span class="sc">$</span>vectors[<span class="dv">1</span>,]</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.515749 -1.938928</code></pre>
</div>
</div>
<p>Und wir sehen auch, dass wir in den Eigenwerten die Varianz wiederfinden. Wir hatten ja unsere <span class="math inline">\(x\)</span>-Variable mit einer Standardabweichung von <span class="math inline">\(5\)</span> erschaffen und unsere <span class="math inline">\(y\)</span>-Variable um die Standardabweichung von <span class="math inline">\(1\)</span> erhöht. Das finden wir dann auch hier wieder.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>eigen_res<span class="sc">$</span>values <span class="sc">%&gt;%</span> <span class="fu">sqrt</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.2187752 0.7005254</code></pre>
</div>
</div>
<p>Die erste Zahl ist <span class="math inline">\(\beta_x\)</span> extrem nahe und entspricht auch der Steigung der Geraden durch die Punktewolke. Die zweite Zahl ist die Steigung einer Geraden die orthogonal auf der ersten gerade steht und durch den Ursprung läuft. Wir haben damit die zweite Hauptkomponente gefunden.</p>
<p>Das Ganze auch mal mit der richtigen Funktion <code>prcomp()</code>, die das Ganze dann auch für mehr als zwei Dimensionen und Variablen kann. Hier siehst du auch warum es in der Funktion dann <code>rotation</code> heißt, es ist eben die Drehung der Hauptkomponenten untereinander. Auch finden wir hier in den Eigenwerten die Standardabweichungen wieder, die wir ursprünglich in der Generierung der Daten verwendet haben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pca_res <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(tbl)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>pca_res</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard deviations (1, .., p=2):
[1] 5.2187752 0.7005254

Rotation (n x k) = (2 x 2):
        PC1        PC2
x 0.8887583 -0.4583762
y 0.4583762  0.8887583</code></pre>
</div>
</div>
<p>Auch hier können wir wieder die zweite Zeile durch die erste Zeile teilen und kriegen die Steigungen der Geraden aus der <a href="#fig-cluster-pca-exp-02-2">Abbildung&nbsp;<span>59.3 (b)</span></a> wieder.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>pca_res<span class="sc">$</span>rotation[<span class="dv">2</span>,] <span class="sc">/</span> pca_res<span class="sc">$</span>rotation[<span class="dv">1</span>,]</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      PC1       PC2 
 0.515749 -1.938928 </code></pre>
</div>
</div>
<p>Ich habe dann mal die Geradengleichungen, die sich für die beiden Hauptkomponenten ergeben einmal zu der <a href="#fig-cluster-pca-exp-02-3">Abbildung&nbsp;<span>59.3 (c)</span></a> ergänzt. Das funktioniert natürlich alles nur auf standardisierten Daten sonst ist ja auch der y-Achsenabschnitt nicht 0. Ja, es geht formal auch auf den nicht transformierten Daten, aber der Standard ist, die Daten zu standardisieren.</p>
<p>Diese Demonstration funktioniert nur mit zwei Variablen, da wir ja nur zweidimensionale Abbildungen erstellen können und zum anderen der Zusammenhang der Steigungen aus der Varianz/Kovarianzmatrix und den Eigenwerten dann gegeben ist. Das Prinzip bleibt aber das Gleiche. Wir nutzen die mathematischen Eigenschaften der Eigenwertzerlegung von Matrizen um uns orthogonale Geraden wiedergeben zu lassen.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Geht das etwas korrekter?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ja, das war jetzt mathematisch teilweise unsauber. Aber darum geht es ja hier auch nicht - wir machen ja hier die Anwendung mit einem erweiterten Grundverständnis. Mathematisch besser geht natürlich in dem <a href="https://wiki.pathmind.com/eigenvector">A Beginner’s Guide to Eigenvectors, Eigenvalues, PCA, Covariance and Entropy</a>. Auch dem Rahmen ist das Tutorium <a href="https://cran.r-project.org/web/packages/matlib/vignettes/eigen-ex1.html">Eigenvalues and Eigenvectors: Properties</a> interessant. Am Ende noch ein Tutorium von Stackexchange <a href="https://stats.stackexchange.com/questions/2691/making-sense-of-principal-component-analysis-eigenvectors-eigenvalues">Making sense of principal component analysis, eigenvectors &amp; eigenvalues</a>. Wie immer, du musst wissen wie tief du dann noch abtauchen willst.</p>
</div>
</div>
<p>Was machen wir jetzt also nochmal? Wir wollen unseren Daten, also die ganze Daten<em>matrix</em> einmal so transformieren, dass wir neue Komponenten aus den Daten extrahieren, die die Daten auf einer anderen Dimension beschreiben. Im Prinzip handelt es sich also bei der Hauptkomponentenanalyse um eine komplexere Transformation der Daten. Wir nutzen dabei die Varianz/Kovarianzmatrix als unsere Distanzmatrix. Wird die gesamte Varianz der Daten vielleicht nur von wenigen Spalten verursacht? Dann brauchen wir ja nur diese wenigen Hauptkomponenten weiter betrachten. Wir nutzen also die Varianz/Kovarianzmatrix als unsere Ähnlichkeitsmatrix, wie schon bei den Clusteranalysen, um hier unbekannte Zusammenhänge zwischen den Spalten und damit dann Hauptkomponenten aufzuklären.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hauptkomponente, Eigenwert und Varianz kurz zusammengefasst
</div>
</div>
<div class="callout-body-container callout-body">
<p>In einer Hauptkomponentenanalyse ersetzen wir die ursprünglichen Spalten eines Datensatzes durch Hauptkomponenten. Die Hauptkomponenten haben so viele Dimensionen wie es Spalten im ursprünglichen Datensatz gibt. Jede Hauptkomponente hat einen Eigenwert (eng. <em>eigenvalue</em>), der den Anteil der erklärten Varianz der Hauptkomponente in den Daten beschreibt. Wir können die Beobachtungen oder Individuen (abk. <em>ind</em>) in den Zeilen betrachten oder aber die Variablen (abk. <em>var</em>) in den Spalten.</p>
</div>
</div>
<p>Neben der PCA existiert noch das <em>Multidimensional Scaling</em> (abk. MDS). Das MDS ist im Prinzip eine Spezialform der PCA. Im Unterschied zur PCA wird die MDS auf einer Distanzmatrix gerechnet. In einer MDS können wir nicht einfach so unsere Daten reinstecken sondern müssen zuerst die Daten in eine Distanzmatrix umrechnen. Dafür gibt es die Funktion <code>dist()</code> oder <code>as.dist()</code>, wenn wir schon Distanzen vorliegen haben. Daher ist die Anwendung einer MDS nicht besonders komplizierter.</p>
<p>Wenn wir eine PCA in R rechnen wollen, dann haben wir zuerst die Wahl zwischen den Funktionen <code>prcomp()</code> und <code>princomp()</code>. Laut der R-Hilfe hat die Funktion <code>prcomp()</code> eine etwas bessere numerische Genauigkeit. Daher ist die Funktion <code>prcomp()</code> gegenüber <code>princomp()</code> vorzuziehen. Es gibt aber noch eine <em>neuere</em> Implementierung der Funktionalität in dem R Paket <code>FactoMineR</code> und der Funktion <code>PCA()</code>. Da wir dann alles aus einer Hand haben nutzen wir in diesem Kapitel also das R Paket <code>factoextra</code>. Wir haben in dem Paket auch die die Funktionen um sich Faktoranalysen super anzuschauen und durchzuführen. Du kannst mehr auf der Webseite <a href="http://www.sthda.com/english/wiki/factoextra-r-package-easy-multivariate-data-analyses-and-elegant-visualization">Factoextra R Package: Easy Multivariate Data Analyses and Elegant Visualization</a> mehr über das Paket erfahren.</p>
<p>Es gibt eine <em>natürlich</em> große Anzahl an Quellen wie du in R eine PCA oder ein MDS durchführst. In der folgenden Box findest du eine Sammlung an Tutorien und R Code, der dir als Inspiration dienen mag. Ich werde Teile von den Tutorien in dem Kapitel hier adaptieren und verwenden, kann aber natürlich nichts alles nochmal nachkochen. Das ist ja auch nicht der Sinn hier.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die Principal Component Analysis
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Wie immer gibt es eine Vielzahl an tollen Tutorien, die die PCA gut erklären. Ich habe hier einmal eine Auswahl zusammengestellt und du kannst dich da ja mal vertiefend mit beschäftigen, wenn du willst. Teile der Tutorien findest du vermutlich hier im Kapitel wieder.</p>
<ul>
<li><a href="http://www.billconnelly.net/?p=697">Principal Component Analysis (PCA) For Dummies</a></li>
<li><a href="https://georgemdallas.wordpress.com/2013/10/30/principal-component-analysis-4-dummies-eigenvectors-eigenvalues-and-dimension-reduction/">Principal Component Analysis 4 Dummies: Eigenvectors, Eigenvalues and Dimension Reduction</a></li>
<li><a href="https://towardsdatascience.com/the-most-gentle-introduction-to-principal-component-analysis-9ffae371e93b">The most gentle introduction to Principal Component Analysis</a></li>
<li><a href="https://little-book-of-r-for-multivariate-analysis.readthedocs.io/en/latest/">Welcome to a Little Book of R for Multivariate Analysis!</a></li>
</ul>
</div>
</div>
</div>
<p>Wir wollen uns jetzt die Hauptkomponentenanalyse an zwei Spieldaten anschauen. Eigentlich werden ja auch gerne Fragebögen mit der Hauptkomponentenanalyse ausgewertet, aber hier muss ich nochmal warten bis ich ein gutes Beispiel in den Beratungen hatte. Dann ergänze ich natürlich ein Beispiel für die Auswertung eines Fragebogen mittels Hauptkomponentenanalyse beim Skript zu den <a href="https://jkruppa.github.io/application/">Beispielhaften Auswertungen</a>.</p>
</section>
<section id="genutzte-r-pakete" class="level2" data-number="59.2">
<h2 data-number="59.2" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">59.2</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, readxl, patchwork,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>               factoextra, FactoMineR, ggpubr, MASS, mda,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>               janitor, corrplot, HDclassif, klaR, see,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>               conflicted)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"select"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"filter"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"mutate"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(magrittr<span class="sc">::</span>set_names)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dlookr<span class="sc">::</span>transform)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Am Ende des Kapitels findest du nochmal den gesamten R Code in einem Rutsch zum selber durchführen oder aber kopieren.</p>
</section>
<section id="daten" class="level2 page-columns page-full" data-number="59.3">
<h2 data-number="59.3" class="anchored" data-anchor-id="daten"><span class="header-section-number">59.3</span> Daten</h2>
<p>Wenn wir jetzt die Hauptkomponentenanalyse rechnen wollen, dann brauchen wir auch Datenbeispiele. Ich habe jetzt zwei sehr eingängige Beispiele gewählt, die du nicht so stark inhaltlich durchdringen musst. Es geht um die Unterschiede von Tieren und deren Eigenschaften. Die Datenbeispiele sind so gewählt, dass du das Konzept hinter der Hauptkomponentenanalyse verstehst und nicht so sehr nach der <em>direkten</em> Anwendbarkeit. Danach schauen wir uns noch an, warum wir die Daten standardisieren müssen und wie wir mit dem <code>data.frame()</code>-Problem umgehen. Wir können leider keine <code>tibble()</code> in der Hauptkomponentenanalyse nutzen.</p>
<section id="zwei-beispieldatensätze" class="level3 page-columns page-full" data-number="59.3.1">
<h3 data-number="59.3.1" class="anchored" data-anchor-id="zwei-beispieldatensätze"><span class="header-section-number">59.3.1</span> Zwei Beispieldatensätze</h3>
<p>Beginnen wir mit einem normierten Datensatz aus dem R Paket <code>cluster</code>. Der Datensatz <code>animals</code> wurde von mir noch mit ein paar Tieren ergänzt und schaut sich sechs Eigenschaften von 23 Tieren an. Wir wollen im Folgenden nun herausfinden, ob wir anhand der Eigenschaften in den Spalten die Tiere in den Zeilen in Gruppen einordnen können. Einige der Tiere sind ja näher miteinander verwandt als andere Tiere. Die ursprünglichen Daten liefen noch auf einem <span class="math inline">\(1/2\)</span>-System, das ändern wir dann zu <span class="math inline">\(0/1\)</span> damit wir dann auch besser mit den Daten arbeiten können. Für die Algorithmen ist es egal, aber ich habe lieber <span class="math inline">\(1\)</span> gleich ja und <span class="math inline">\(0\)</span> gleich nein.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>animals_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/cluster_animal.xlsx"</span>, <span class="at">sheet =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), \(x) x <span class="sc">-</span> <span class="dv">1</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Schauen wir uns einmal den Datensatz in der <a href="#tbl-cluster-01">Tabelle&nbsp;<span>59.3</span></a> an. Wir sehen, dass wir noch einige fehlende Werte in den Daten vorliegen haben. Das ist manchmal ein Problem, deshalb werden wir im Laufe der Analyse die <code>NA</code> Werte mit <code>na.omit()</code> entfernen.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-cluster-01" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tabelle&nbsp;59.3— Übersicht über die 23 Tiere mit den sechs Eigenschaften in den Spalten. Eine 1 bedeutet, dass die Eigenschaft vorliegt; eine 0 das die Eigenschaft nicht vorliegt.</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 6%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 20%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">animal</th>
<th style="text-align: center;">warm_blooded</th>
<th style="text-align: center;">fly</th>
<th style="text-align: center;">vertebrate</th>
<th style="text-align: center;">threatened</th>
<th style="text-align: center;">live_in_groups</th>
<th style="text-align: center;">hair</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ant</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">bee</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">centipede</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">chimpanzee</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">cow</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">dolphin</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">duck</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">eagle</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">earthworm</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">elephant</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">fly</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">frog</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">herring</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">horse</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">human</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lion</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">lizard</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">lobster</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">rabbit</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">salmon</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">spider</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">whale</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Der Tierdatensatz ist schön, da wir es hier nur mit 0/1 Werten zu tun haben. Wir werden später in dem preprocessing der Daten sehen, dass wir alle Spalten in der gleichen Spannweite der Werte wollen. Das klingt immer etwas kryptisch, aber der nächste Datensatz über verschiedene Kreaturen macht es deutlicher.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Eine andere Art die Daten zu Gruppieren kannst du im Tutorium <a href="https://rpubs.com/askieswe/clustering">Clustering Creatures</a> nochmal nachvollziehen.</p>
</div></div><p>Im Folgenen einmal der Datensatz, den wir dann in der gleichen Exceldatei finden nur eben auf dem zweiten Tabellenblatt. Wir reinigen noch die Namen und setzen die <code>creature</code>-Spalte auf Klein geschrieben. Wie du siehst, haben wir dann nur 15 Kreaturen und drei Spalten mit dem Gewicht, der Herzrate und dem maximalen möglichen Alter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>creature_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/cluster_animal.xlsx"</span>, <span class="at">sheet =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">creature =</span> <span class="fu">tolower</span>(creature))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#tbl-cluster-02">Tabelle&nbsp;<span>59.4</span></a> sehen wir nochmal die Daten dargestellt und hier erkennst du auch gut, wo das Problem liegt. Die Masse der Tiere reicht von <span class="math inline">\(6g\)</span> beim Hamster bis <span class="math inline">\(120000000g\)</span> beim Wal. Diese Spannweiten in einer Spalte und zwischen den Spalten führt dann zu Problemen bei den Algorithmen. Deshalb müssen wir hier Daten nochmal normalisieren oder aber standardisieren. Je nachdem was da besser passt.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-cluster-02" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tabelle&nbsp;59.4— Übersicht über die 15 Kreaturen mit den drei Eigenschaften in den Spalten. Wir haben hier sehr große Unterschiede in den Datenwerten. Daher müssen wir vor dem Clustern nochmal normalisieren.</caption>
<thead>
<tr class="header">
<th style="text-align: center;">creature</th>
<th style="text-align: center;">mass_grams</th>
<th style="text-align: center;">heart_rate_bpm</th>
<th style="text-align: center;">longevity_years</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">human</td>
<td style="text-align: center;">9.0e+04</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="even">
<td style="text-align: center;">cat</td>
<td style="text-align: center;">2.0e+03</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="odd">
<td style="text-align: center;">small dog</td>
<td style="text-align: center;">2.0e+03</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: center;">medium dog</td>
<td style="text-align: center;">5.0e+03</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="odd">
<td style="text-align: center;">large dog</td>
<td style="text-align: center;">8.0e+03</td>
<td style="text-align: center;">75</td>
<td style="text-align: center;">17</td>
</tr>
<tr class="even">
<td style="text-align: center;">hamster</td>
<td style="text-align: center;">6.0e+01</td>
<td style="text-align: center;">450</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">chicken</td>
<td style="text-align: center;">1.5e+03</td>
<td style="text-align: center;">275</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;">monkey</td>
<td style="text-align: center;">5.0e+03</td>
<td style="text-align: center;">190</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="odd">
<td style="text-align: center;">horse</td>
<td style="text-align: center;">1.2e+06</td>
<td style="text-align: center;">44</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="even">
<td style="text-align: center;">cow</td>
<td style="text-align: center;">8.0e+05</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">22</td>
</tr>
<tr class="odd">
<td style="text-align: center;">pig</td>
<td style="text-align: center;">1.5e+05</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">25</td>
</tr>
<tr class="even">
<td style="text-align: center;">rabbit</td>
<td style="text-align: center;">1.0e+03</td>
<td style="text-align: center;">205</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">elephant</td>
<td style="text-align: center;">5.0e+06</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="even">
<td style="text-align: center;">giraffe</td>
<td style="text-align: center;">9.0e+05</td>
<td style="text-align: center;">65</td>
<td style="text-align: center;">20</td>
</tr>
<tr class="odd">
<td style="text-align: center;">large whale</td>
<td style="text-align: center;">1.2e+08</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">80</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="standardisieren" class="level3" data-number="59.3.2">
<h3 data-number="59.3.2" class="anchored" data-anchor-id="standardisieren"><span class="header-section-number">59.3.2</span> Standardisieren</h3>
<p>Die Standardisierung zwingt Variablen in eine <span class="math inline">\(\mathcal{N(0,1)}\)</span> Standardnormalverteilung. Das heißt, wir transformieren alle Variablen auf einen Mittelwert von <span class="math inline">\(0\)</span> und einer Standardabweichung von <span class="math inline">\(1\)</span>. Hier nochmal die Formel für die Standardisierung oder auch <span class="math inline">\(z\)</span>-Transformation. Achtung, wir müssen unsere Daten standatdisieren, damit wir auf jeden Fall die Graden durch den Ursprung zeichnen können. Wir kriegen ja bei der Eigenwertzerlegung und der Hauptkomponentenanalyse nur die Stiegungen wieder und damit muss alles auf den Ursprung normiert werden.</p>
<p><span class="math display">\[
z = \cfrac{x_i - \bar{x}}{s_x}
\]</span></p>
<p>Wie wir hier sehen ziehen wir von jeder <span class="math inline">\(i\)</span>-ten Beobachtung den Mittlwert von allen Beobachtungen ab. Dann teilen wir noch durch die Standardabweichung alle Beobachtungen. Am Ende ist dann damit unser Mittelwert auf <span class="math inline">\(0\)</span> und unsere Standardabweichung auf <span class="math inline">\(1\)</span>. Unsere Daten haben damit den Schwerpunkt bei der <span class="math inline">\(0\)</span> und unsere Geraden der Hauptkomponentenanalyse laufen immer durch den Ursprung.</p>
<p>Die Standardisierung macht dann auch die Daten sehr schon gleichförmig. Hier nutzen wir auch die Funktion <code>transform()</code> aus dem R Paket <code>dlookr</code> mit der Option <code>zscore</code>. Damit wir auch auf jeden Fall sicher gehen, dass wir die richtige Funktion nutzen, schreiben wir <code>dlookr::transform()</code> und damit ist sichergestellt, dass wir auch die Funktion <code>transform()</code> aus dem R Paket <code>dlookr</code> nutzen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>std_creature_tbl <span class="ot">&lt;-</span> creature_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mass_grams =</span> dlookr<span class="sc">::</span><span class="fu">transform</span>(mass_grams, <span class="st">"zscore"</span>),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">heart_rate_bpm =</span> dlookr<span class="sc">::</span><span class="fu">transform</span>(heart_rate_bpm, <span class="st">"zscore"</span>),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">longevity_years =</span> dlookr<span class="sc">::</span><span class="fu">transform</span>(longevity_years, <span class="st">"zscore"</span>)) </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>std_creature_tbl</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 4
   creature    mass_grams heart_rate_bpm longevity_years
   &lt;chr&gt;       &lt;transfrm&gt; &lt;transfrm&gt;     &lt;transfrm&gt;     
 1 human       -0.2739558 -0.5739180      1.6794647     
 2 cat         -0.2768074  0.2094888     -0.5409814     
 3 small dog   -0.2768074 -0.2257372     -0.7428402     
 4 medium dog  -0.2767102 -0.3127824     -0.5409814     
 5 large dog   -0.2766129 -0.4433502     -0.4602379     
 6 hamster     -0.2768702  2.8208449     -1.0254424     
 7 chicken     -0.2768236  1.2975538     -0.5409814     
 8 monkey      -0.2767102  0.5576696     -0.5409814     
 9 horse       -0.2379870 -0.7131904      0.4683123     
10 cow         -0.2509487 -0.5303954     -0.2583792     
11 pig         -0.2720115 -0.4868728     -0.1372639     
12 rabbit      -0.2768398  0.6882374     -0.7832119     
13 elephant    -0.1148507 -0.8350536      1.6794647     
14 giraffe     -0.2477083 -0.5303954     -0.3391227     
15 large whale  3.6116436 -0.9220988      2.0831822     </code></pre>
</div>
</div>
<p>Die Funktion <code>PCA()</code>, die wir im Folgenden verwenden wollen, wird zwar auch die Daten intern von sich aus standardisieren, wenn die nicht standardisiert wurden. Ich mag es aber nicht, wenn wichtige Schritte in Funktionen begraben werden, deshalb hier nochmal das Beispiel, wie man es macht. Doppelt Standardisieren tut aber nicht weh, schon standardiserte Daten ändern sich nicht durch eine weitere Standardisierung.</p>
</section>
<section id="das-data.frame-problem" class="level3" data-number="59.3.3">
<h3 data-number="59.3.3" class="anchored" data-anchor-id="das-data.frame-problem"><span class="header-section-number">59.3.3</span> Das <code>data.frame()</code> Problem</h3>
<p>Leider ist es so, dass fast alle Pakete im Kontext der Hauptkomponentenanalyse mit den Zeilennamen bzw. <code>row.names()</code> eines <code>data.frame()</code> arbeiten. Das hat den Grund, dass wir gut das Label in den Zeilennamen parken können, ohne das uns eine Spalte in den Auswertungen stört. Meistens ist das Label ja ein <code>character</code> und soll gar nicht in die Hauptkomponentenanalyse mit rein. Deshalb müssen wir hier einmal unsere <code>tibble()</code> in einen <code>data.frame()</code> umwandeln. Die <code>tibble()</code> haben aus gutem Grund keine Zeilennamen, die Zeilennamen sind ein Ärgernis und Quelle von Fehlern und aus gutem Grund nicht in einem <code>tibble()</code> drin. Hier brauchen wir die Zeilennamen aber.</p>
<p>Wir bauen uns also einmal einen <code>data.frame()</code> für unseren Tierdatensatz und setzen die Tiernamen als Zeilennamen bzw. <code>row.names()</code>. Wir entfernen dann auch noch schnell alle fehlenden Werte, denn wir wollen uns hier nicht noch mit der Imputation von fehlenden Werten beschäftigen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>animals_df <span class="ot">&lt;-</span> animals_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_rownames</span>(.<span class="sc">$</span>animal) <span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>animal)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das Ganze machen wir dann auch noch einmal für die normalisierten Kreaturendaten. Wir wollen dann ja nur auf den normalisierten Daten weitermachen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>std_creature_df <span class="ot">&lt;-</span> std_creature_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_rownames</span>(.<span class="sc">$</span>creature) <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>creature)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="hauptkomponentenanalyse" class="level2 page-columns page-full" data-number="59.4">
<h2 data-number="59.4" class="anchored" data-anchor-id="hauptkomponentenanalyse"><span class="header-section-number">59.4</span> Hauptkomponentenanalyse</h2>
<p>Jetzt haben wir uns mit sehr viel Theorie beschäftigt und deshalb nochmal in der <a href="#fig-pca-overview">Abbildung&nbsp;<span>59.4</span></a> ein schematischer Überblick über den Ablauf der Hauptkomponentenanalyse. Wir nutzen die Daten und berechnen für die Daten die Varianz/Kovarianzmatrix. Auf der Varianz/Kovarianzmatrix rechnen wir dann die Hauptkomponentenanalyse. Beide Schritte sind intern in den Funktionen in R implementiert. Du musst nur auf die Daten achten. Dann können wir uns die Hauptkomponenten und die Eigenwerte als Korrealtionsplot anschauen und die Aussagekraft der Variablen sehen.</p>
<div class="column-page">
<div id="fig-pca-overview" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/pca/pca_overview.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Abbildung&nbsp;59.4— Verlauf einer generalisierten Hauptkomponentenanalyse von dem Datensatz über die Varianz/Kovarianzmatrix zu den unkorrelierten Hauptkomponeten und deren Koordinaten unabhängig von den Eigenschaften der Variablen. Abschließend sind die Koordinaten der Hauptkomponenten im Koorelationsplot der 1. und 2. Hauptkomponente dargestellt. Variablen die nahe beieinander sind, sind positiv miteinander korreliert; Variablen in den gegenüberliegenden Quadranten naegativ. Je weiter eine Variable außen liegt, desto höher ist die Aussagekraft. Variablen nahe dem Ursprung, haben eine geringe Bedeutung. Am Beispiel der Variable <code>fly</code> werden nochmal die Koordinaten deutlich.</figcaption>
</figure>
</div>
</div>
<p>Es gibt viele Implementierungen der Hauptkomponentenanalyse in R. Wir nutzen die Funktion <code>PCA()</code> aus dem R Paket <code>FactoMineR</code> für die Analyse von kontinuierlichen Variablen. Denk immer daran, es kann maximal nur so viele Hauptkomponenten geben, wie wir auch Spalten in den Daten vorliegen haben. Folgende wichtige Funktionen werden wir jetzt einmal nutzen. Es gibt noch mehr, aber das übersteigt die einfache Hauptkomponentenanalyse, die wir uns hier anschauen wollen.</p>
<p>Die zentrale Funktion ist aber die Funktion <code>PCA()</code> womit wir die eigentliche Hauptkomponentenanalyse erstmal durchführen, wenn kontinuierliche Variablen vorliegen. Die Funktion nimmt die Daten und berechnet dann intern die Varianz/Kovarianzmatrix. Die Varianz/Kovarianzmatrix wird dann als Distanzmatrix genutzt um die Hauptkomponenten und deren Eigenwerte zu berechnen.</p>
<p>Neben der Funktion <code>PCA()</code> aus dem R Paket <code>FactoMineR</code> für die Analyse von kontinuierlichen Variablen gibt es noch eine Reihe anderer Funktionen für eine Hauptkomponentenanalyse wenn wir kategoriale Variablen oder eine Mischung vorliegen haben. Hier mal die vollständige Liste.</p>
<ul>
<li><a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/">PCA - Principal Component Analysis</a>, zur Analyse eines Datensatzes mit kontinuierlichen Variablen</li>
<li><a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/113-ca-correspondence-analysis-in-r-essentials/">CA - Correspondence Analysis (Korrespondenzanalyse)</a>, für die Analyse der Assoziation zwischen zwei kategorialen Variablen.</li>
<li><a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/114-mca-multiple-correspondence-analysis-in-r-essentials/">MCA - Multiple Correspondence Analysis</a>, für die Analyse eines Datensatzes mit kategorialen Variablen.</li>
<li><a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/115-famd-factor-analysis-of-mixed-data-in-r-essentials/">FAMD - Factor Analysis of Mixed Data (Faktorenanalyse gemischter Daten)</a>, für die Analyse eines Datensatzes, der sowohl kontinuierliche als auch kategoriale Variablen enthält.</li>
<li><a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/116-mfa-multiple-factor-analysis-in-r-essentials/">MFA - Multiple Factor Analysis</a>, für die Analyse eines Datensatzes, der in Gruppen strukturierte Variablen enthält.</li>
</ul>
<section id="pca---principal-component-analysis" class="level3" data-number="59.4.1">
<h3 data-number="59.4.1" class="anchored" data-anchor-id="pca---principal-component-analysis"><span class="header-section-number">59.4.1</span> PCA - Principal Component Analysis</h3>
<p>Bei der Nutzung der Funktion <code>PCA()</code> ist für mich wichtig, dass wir nicht gleich irgendwelche Abbildungen erhalten, deshalb ist hier im Skript <code>graph = FALSE</code> gewählt. Mit der Option <code>scale.unit = TRUE</code> musst du die Daten selber nicht standardisieren sondern die Funktion <code>PCA()</code> macht das für dich. Manchmal sind Fragebögen sehr groß mit mehr als Dutzenden von Fragen, da macht es Sinn sich nicht die Anzahl an Fragen als Hauptkomponenten wiedergeben zu lassen. Die Option <code>ncp = 5</code> zum Beispiel schränkt hier die Anzahl auf 5 Hauptkomponenten ein. Bei den Kreaturen macht es keinen Sinn, da erhalten wir natürlich nur drei Hauptkomponenten, da wir nur drei Spalten in dem Datensatz haben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pca_animals <span class="ot">&lt;-</span> <span class="fu">PCA</span>(animals_df, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ncp =</span> <span class="dv">5</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pca_creature <span class="ot">&lt;-</span> <span class="fu">PCA</span>(std_creature_df, <span class="at">scale.unit =</span> <span class="cn">TRUE</span>, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ncp =</span> <span class="dv">5</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Folgende Funktionen sind wichtig um die klassische Hauptkomponentenanalyse einmal zu visualisieren und zu bewerten. Die Namen folgen alle einem Schema im Paket <code>FactoMineR</code>, so dass wir hier nur Kleinigkeiten im Namen ändern müssen um alle Funktionen zu nutzen.</p>
<ul>
<li><code>get_pca_ind()</code>, <code>get_pca_var()</code>: Extrahiert die Ergebnisse für Individuen bzw. Variablen.</li>
<li><code>fviz_pca_ind()</code>, <code>fviz_pca_var()</code>: Visualisierung der Ergebnisse für Individuen bzw. Variablen.</li>
<li><code>fviz_pca_biplot()</code>: Erstellt einen Biplot der Individuen und Variablen.</li>
</ul>
</section>
<section id="ca---correspondence-analysis" class="level3" data-number="59.4.2">
<h3 data-number="59.4.2" class="anchored" data-anchor-id="ca---correspondence-analysis"><span class="header-section-number">59.4.2</span> CA - Correspondence Analysis</h3>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Spezialfall des <span class="math inline">\(\mathcal{X}^2\)</span>-Test
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die CA-Analyse funktioniert nur auf einer <span class="math inline">\(n \times k\)</span> Tabelle. Daher können wir nur zwei Variablen mit Kategorien miteinander in Verbindung setzen. Eigentlich sehen wir hier eher einen großen <span class="math inline">\(\mathcal{X}^2\)</span>-Test. Deshalb gehe ich aktuell nicht auf die Lösung hier tiefer ein.</p>
</div>
</div>
<p>Wir nutzen die <em>Correspondence Analysis</em> zur Analyse des Zusammenhangs zwischen zwei kategorialen Variablen. Also eher ein großer <span class="math inline">\(\mathcal{X}^2\)</span>-Test mit anderen Mitteln auf einer <span class="math inline">\(n \times k\)</span> Tabelle.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CA</span>(tbl, <span class="at">ncp =</span> <span class="dv">5</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir erhalten alle wichtigen Informationen aus einer <em>Correspondence Analysis</em> mit den folgenden Funktionen.</p>
<ul>
<li><code>get_ca_row()</code>, <code>get_ca_col()</code>: Extrahiert die Ergebnisse für Zeilen bzw. Spalten.</li>
<li><code>fviz_ca_row()</code>, <code>fviz_ca_col()</code>: Visualisierung der Ergebnisse für Zeilen bzw. Spalten.</li>
<li><code>fviz_ca_biplot()</code>: Erstellt einen Biplot der Individuen und Variablen.</li>
</ul>
<p>Wir betrachteten den Fall hier nicht weiter, da er wirklich sehr speziell ist und nur selten vorkommt.</p>
</section>
<section id="mca---multiple-correspondence-analysis" class="level3" data-number="59.4.3">
<h3 data-number="59.4.3" class="anchored" data-anchor-id="mca---multiple-correspondence-analysis"><span class="header-section-number">59.4.3</span> MCA - Multiple Correspondence Analysis</h3>
<p>Wir nutzen die <em>Multiple Correspondence Analysis</em> für die Analyse eines Datensatzes mit kategorialen Variablen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">MCA</span>(tbl, <span class="at">ncp =</span> <span class="dv">5</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir erhalten dann wiederum alle wichtigen Informationen und Abbildungen über folgende Funktionen.</p>
<ul>
<li><code>get_mca_ind()</code>, <code>get_mca_var()</code>: Extrahiert die Ergebnisse für Individuen bzw. Variablen.</li>
<li><code>fviz_mca_ind()</code>, <code>fviz_mca_var()</code>: Visualisierung der Ergebnisse für Individuen bzw. Variablen.</li>
<li><code>fviz_mca_biplot()</code>: Erstellt einen Biplot der Individuen und Variablen.</li>
</ul>
</section>
<section id="famd---factor-analysis-of-mixed-data" class="level3" data-number="59.4.4">
<h3 data-number="59.4.4" class="anchored" data-anchor-id="famd---factor-analysis-of-mixed-data"><span class="header-section-number">59.4.4</span> FAMD - Factor Analysis of Mixed Data</h3>
<p>Für die Analyse eines Datensatzes, der sowohl kontinuierlichen Variablen als auch kategorialen Variablen enthält nutzen wir die <em>Factor Analysis of Mixed Data</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">FAMD</span>(tbl, <span class="at">ncp =</span> <span class="dv">5</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Auch hier haben wir die wichtigen Funktionen für die Darstellung einmal dargestellt.</p>
<ul>
<li><code>get_famd_ind()</code>, <code>get_famd_var()</code>: Extrahiert die Ergebnisse für Individuen bzw. Variablen.</li>
<li><code>fviz_famd_ind()</code>, <code>fviz_famd_var()</code>: Visualisierung der Ergebnisse für Individuen bzw. Variablen.</li>
</ul>
</section>
<section id="mfa---multiple-factor-analysis" class="level3" data-number="59.4.5">
<h3 data-number="59.4.5" class="anchored" data-anchor-id="mfa---multiple-factor-analysis"><span class="header-section-number">59.4.5</span> MFA - Multiple Factor Analysis</h3>
<p>Komplexer wird es, wenn wir eine <em>Multiple Factor Analysis</em> durchführen wollen. In diesem Fall ist es die Analyse eines Datensatzes, der in Gruppen strukturierte Variablen enthält.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">MCA</span>(X, <span class="at">ncp =</span> <span class="dv">5</span>, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Auch gibt es bei der <em>Multiple Factor Analysis</em> ein Set an Funktionen, die wir hauptsählcihc benötigen.</p>
<ul>
<li><code>get_mfa_ind()</code>, <code>get_mfa_var()</code>: Extrahiert die Ergebnisse für Individuen bzw. Variablen.</li>
<li><code>fviz_mfa_ind()</code>, <code>fviz_mfa_var()</code>: Visualisierung der Ergebnisse für Individuen bzw. Variablen.</li>
</ul>
<p>Weitere Funktionen finden sich dann noch auf der Tutoriumsseite zu der <a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/116-mfa-multiple-factor-analysis-in-r-essentials/">MFA - Multiple Factor Analysis</a>.</p>
</section>
</section>
<section id="darstellung-der-ergebnisse" class="level2 page-columns page-full" data-number="59.5">
<h2 data-number="59.5" class="anchored" data-anchor-id="darstellung-der-ergebnisse"><span class="header-section-number">59.5</span> Darstellung der Ergebnisse</h2>
<p>Im Folgenden betrachten wir dann die Hauptkomponentenanalyse auf drei Ebenen. Wir konzentrieren uns hier erstmal nur auf die Beispiele aus der Funktion <code>PCA()</code>. Prinzipiell sind die Analysen für die anderen Funktionen ähnlich und die Interpretation unterscheidet sich nur leicht.</p>
<ol type="1">
<li><em>Auf der Ebene der Eigenwerte:</em> Wir entscheiden, wie viele Hauptkomponenten wir eigentlich in die weitere Analyse nehmen wollen.</li>
<li><em>Auf der Ebene der Variablen:</em> Wir betrachten die Spalten und schauen wie sich die Spalten zueinander und den Beobachtungen verhalten. In der R Welt enden dann die Funktionen <code>*_var</code>.</li>
<li><em>Auf der Eben der Individuen</em>: Wir schauen uns einmal die Zeilen an und versuchen zu verstehen, wie sich die einzelenen Beobachtungen oder Individuen verhalten. Gibt es hier Auffälligkeiten? In der R Welt enden dann die Funktionen <code>*_ind</code>.</li>
</ol>
<section id="ebene-der-eigenwerte" class="level3 page-columns page-full" data-number="59.5.1">
<h3 data-number="59.5.1" class="anchored" data-anchor-id="ebene-der-eigenwerte"><span class="header-section-number">59.5.1</span> Ebene der Eigenwerte</h3>
<p>Die Eigenwerte messen die Menge der von jeder Hauptkomponente beibehaltenen Variation. Damit repräsentieren die Eigenwerte die Varianz/Kovarianzmatrix der Daten. Die Eigenwerte sind für die ersten Hauptkomponenten grundsätzlich groß und für die nachfolgenden Hauptkomponente immer kleiner. Das heißt, die ersten Hauptkomponente beschreiben Variablen mit der größten Variation im Datensatz. Wie schon gesagt, wir erschaffen neue Variablen aus den Daten, die wir Hauptkomponenten nennen. Jede Hauptkomponente hat einen Eigenwert, der beschreibt, wie viel Varianz die Hauptkomponente in den Daten erklären kann.</p>
<p>Mit Hilfe der Eigenwerte lässt sich die Anzahl der Hauptkomponenten bzw. Dimensionen bestimmen, die nach der PCA beibehalten werden sollen. Wir wollen selten alle Hauptkomponenten berücksichtigen. Es geht hier ja auch darum die Dimensionen der Daten zu reduzieren. Wenn wir alle Hauptkomponenten weiterverwenden würden, dann könnten wir auch den ursprünglichen Datensatz nutzen. Die Eigenwerte und der Anteil der Varianzen, die von den Hauptkomponenten beibehalten werden, können mit folgenden Funktionen extrahiert werden.</p>
<ul>
<li><code>get_eigenvalue()</code>: Extrahiert die Eigenwerte/Varianzen der Hauptkomponenten</li>
<li><code>fviz_eig()</code>: Visualisierung der Eigenwerte</li>
</ul>
<p>Dabei bedeutet ein Eigenwert &gt; 1, dass die Hauptkomponenten mehr Varianz erklären als eine der ursprünglichen Variablen in den standardisierten Daten. Dies wird üblicherweise als Grenzwert für die Beibehaltung der Hauptkomponenten verwendet. Dies trifft nur zu, wenn die Daten standardisiert sind.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>eig_animals <span class="ot">&lt;-</span> <span class="fu">get_eigenvalue</span>(pca_animals) <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>eig_animals </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  eigenvalue variance.percent cumulative.variance.percent
       &lt;dbl&gt;            &lt;dbl&gt;                       &lt;dbl&gt;
1      2.54             42.3                         42.3
2      1.24             20.6                         62.9
3      0.848            14.1                         77.1
4      0.723            12.1                         89.1
5      0.515             8.58                        97.7
6      0.137             2.29                       100  </code></pre>
</div>
</div>
<p>Die Summe aller Eigenwerte für die Tiere ergibt eine Gesamtvarianz von 6. Jetzt können wir ganz einfach den Anteil der erklärten Varianz von jedem Eigenwert berechnen. In der zweiten Spalte finden wir dann die Werte der Eigenwerte geteilt durch die Gesamtvarianz. Daher ist <span class="math inline">\(42.35\)</span> gleich <span class="math inline">\(2.54\)</span> geteilt durch <span class="math inline">\(6\)</span>. Der kumulative Prozentsatz der erklärten Variation wird durch Addition der aufeinander folgenden Anteile der erklärten Variation ermittelt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>eig_creature <span class="ot">&lt;-</span> <span class="fu">get_eigenvalue</span>(pca_creature) <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>eig_creature</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  eigenvalue variance.percent cumulative.variance.percent
       &lt;dbl&gt;            &lt;dbl&gt;                       &lt;dbl&gt;
1      1.99             66.2                         66.2
2      0.730            24.3                         90.5
3      0.285             9.49                       100  </code></pre>
</div>
</div>
<p>Die Summe aller Eigenwerte für die Kreaturen ergibt eine Gesamtvarianz von 3. Damit können wir dann auch einfach die anderen Werte in den Spalten nachvollziehen.</p>
<p>Jetzt stellt sich natürlich die Frage, wie viele der Hauptkomponenten sollen den jetzt zukünftig berücksichtigt werden? Leider gibt es keine allgemein anerkannte objektive Methode, um zu entscheiden, wie viele Hauptkomponenten ausreichend sind. Dies hängt von dem jeweiligen Anwendungsbereich und dem jeweiligen Datensatz ab. In der Praxis neigen wir dazu, die ersten paar Hauptkomponenten zu betrachten, um interessante Muster in den Daten zu finden. Dafür nutzen wir den Scree Plot und entscheiden anhand der <em>Beuge</em> in dem Plot. Wenn wir nur wenige Variablen in den Daten haben, dann kann es sein, dass wir nur wenige Hauptkomponenten raus schmeißen. In der <a href="#fig-cluster-pca-3">Abbildung&nbsp;<span>59.5</span></a> siehst du einmal die beiden Scree Plots für die beiden Datensätze.</p>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(pca_animals, <span class="at">addlabels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(pca_creature, <span class="at">addlabels =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-cluster-pca-3" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-pca-3-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-cluster-pca-3-1.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-pca-3" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-cluster-pca-3-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-cluster-pca-3-2.png" class="img-fluid figure-img" data-ref-parent="fig-cluster-pca-3" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;59.5— Eigenwerte für die beiden Datensätze.</figcaption><p></p>
</figure>
</div>
</div>
<p>Wir sehen für die Tierdaten, dass die erste Hauptkomponente gut 42% der Varianz in den Daten erklärt, die folgende Hauptkomponente dann nur noch 20% und so weiter. Hier sehen wir dann auch die Beuge und könnten schließen, dass die ersten beiden Hauptkomponenten ausreichen um den Datensatz zu beschreiben. Bei den Kreaturendaten sieht es so aus, als ob wir die Datan alleinig mit der ersten Hauptkomponente erklären könnten. Wir sehen ja, dass gut 62% der Varianz durch die erste Hauptkomponente erklärt wird.</p>
</section>
<section id="ebene-der-variablen" class="level3 page-columns page-full" data-number="59.5.2">
<h3 data-number="59.5.2" class="anchored" data-anchor-id="ebene-der-variablen"><span class="header-section-number">59.5.2</span> Ebene der Variablen</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>get_*_var()</code> für andere Funktionen aus <code>FactoMineR</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Du kannst einfach das <code>*</code> in <code>get_*_var()</code> durch den klein geschriebenen Funktionaufruf von MCA, FAMD und MFA ersetzen um dir dann auch die Ergebnisse analog zu der PCA herausgeben zu lassen. Die Interpretation ist ähnlich bis gleich.</p>
</div>
</div>
<p>Schauen wir jetzt einmal die Informationen der Variablen also Spalten der Hauptkomponentenanalyse an. Wir erhalten jetzt also die Informationen zu den einzelnen Hauptkomponenten, die ja die Variablen bzw. Spalten der Daten repräsentieren. Wir erhalten die Informationen über die Funktion <code>get_pca_var()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>var_animals <span class="ot">&lt;-</span> <span class="fu">get_pca_var</span>(pca_animals)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>var_creature <span class="ot">&lt;-</span> <span class="fu">get_pca_var</span>(pca_creature)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>var_creature</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Component Analysis Results for variables
 ===================================================
  Name       Description                                    
1 "$coord"   "Coordinates for the variables"                
2 "$cor"     "Correlations between variables and dimensions"
3 "$cos2"    "Cos2 for the variables"                       
4 "$contrib" "contributions of the variables"               </code></pre>
</div>
</div>
<p>Schauen wir uns einmal an was wir mit den Informationen über die Variablen durch die Funktion <code>get_pca_var()</code> machen können.</p>
<ul>
<li><code>coord</code>: Koordinaten der Variablen zur Erstellung eines Streudiagramms. Wir nutzen meistens nur die ersten beiden Hauptkomponenten, da wir sonst kein zweidimensionalen Scatterplot machen können.</li>
<li><code>cor</code>: Die Korrelation zwischen den ursprünglichen Variablenwerten in den Zeilen und den neuen Hauptkomponenten in den Spalten.</li>
<li><code>cos2</code>: stellt die Qualität der Darstellung der Variablen auf der Faktorkarte dar. Es wird berechnet als die quadrierten Koordinaten: <code>cos2 = coord * coord</code></li>
<li><code>contrib:</code> enthält die Beiträge (in Prozent) der Variablen zu den Hauptkomponenten. Der Beitrag einer Variablen zu einer bestimmten Hauptkomponente ist (in Prozent): (<code>cos2</code> * 100) / (gesamter <code>cos2</code> der Komponente).</li>
</ul>
<p>Im Folgenden bewerten wir die Qualität einer Variable nach den <code>cos2</code>-Werten oder ihren Beitragswerten zu den Hauptkomponenten dargestellt durch die <code>contrib</code>-Werte. Wir nutzen hier jetzt aber erstmal die <code>cos2</code>-Werte, weil sonst hier alles an Abbildungen explodiert.</p>
<ul>
<li>Ein hoher cos2-Wert deutet auf eine gute Darstellung der Variablen auf der Hauptkomponente hin. In diesem Fall ist die Variable nahe am Umfang des Korrelationskreises positioniert.</li>
<li>Ein niedriger cos2-Wert zeigt an, dass die Variable nicht perfekt durch die PC’s repräsentiert ist. In diesem Fall befindet sich die Variable in der Nähe der Kreismitte.</li>
<li>Für eine bestimmte Variable ist die Summe des cos2 aller Hauptkomponenten gleich eins.</li>
</ul>
<p>In der <a href="#fig-pca-corrplot-cos2">Abbildung&nbsp;<span>59.6</span></a> sehen wir einmal die Zusammenhänge von den <code>cos2</code>-Werten und den jeweiligen Hauptkomponenten. Wir setzen <code>is.corr = FALSE</code>, weil wir keine Korrelation abbiden wollen sondern <code>cos2</code>-Werte.</p>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(var_animals<span class="sc">$</span>cos2, <span class="at">is.corr =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(var_creature<span class="sc">$</span>cos2, <span class="at">is.corr =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-corrplot-cos2" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-corrplot-cos2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-corrplot-cos2-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-corrplot-cos2" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-corrplot-cos2-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-corrplot-cos2-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-corrplot-cos2" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;59.6— Zusammenhang von den <code>cos2</code>-Werten und den jeweiligen Hauptkomponenten</figcaption><p></p>
</figure>
</div>
</div>
<p>Wir sehen bei den Tierdaten, dass die die erste Hauptkomponente <code>Dim.1</code> die Variablen <code>warm_blooded</code>, <code>vertebrate</code> und etwas weniger <code>threatened</code> und <code>live_in_groups</code> beschreibt. Die zweite Hauptkomponente <code>Dim.2</code> repräsentiert die Variable <code>hair</code>. Die dritte Hauptkomponente deckt <code>fly</code> ab. Die vierte Hauptkomponente beschreibt dann <code>live_groups</code> etwas stärker als die erste Hauptkomponente. Die fünfte Hauptkomponente können wir fast ignorieren. Bei den Kreaturendaten sehen wir das die erste Hauptkomponente fast alle Variablen repräsentiert. Die zweite Hauptkomponente beschreibt dann noch etwas <code>mass_grams</code> und <code>heart_rate_bpm</code>.</p>
<p>In der <a href="#fig-pca-fviz-cos2">Abbildung&nbsp;<span>59.7</span></a> sehen wir die gleichen Informationen nochmal als Säulendiagramm dargestellt. Hier ist es eventuell numerisch schöner und besser zu sehen, wie sich die <code>cos2</code>-Werte für die <em>erste und zweite</em> Hauptkomponente verhalten. Du musst hier nämlich entscheiden, wie viele Hauptkomponenten du <em>zusammen</em> betrachten willst. Hier habe ich über <code>axes = 1:2</code> die ersten beiden Hauptkomponenten gewählt.</p>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cos2</span>(pca_animals, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cos2</span>(pca_creature, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-fviz-cos2" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-fviz-cos2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-fviz-cos2-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-fviz-cos2" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-fviz-cos2-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-fviz-cos2-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-fviz-cos2" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;59.7— Zusammenhang von den <code>cos2</code>-Werten und die ersten beiden Hauptkomponenten <code>Dim.1</code> und <code>Dim.2</code>.</figcaption><p></p>
</figure>
</div>
</div>
<p>Als nächstes wollen wir uns dann mal die ersten beiden Hauptkomponenten <code>Dim.1</code> und <code>Dim.2</code> in einer Abbildung anschauen. In der <a href="#fig-pca-var-1">Abbildung&nbsp;<span>59.8</span></a> sehen wir das Korrelationsdiagramm der Variablen für die ersten beiden Hauptkomponenten. Über die Option <code>axes =</code> kannst du dir auch andere Kombinationen von <em>zwei</em> Hauptkomponenten anschauen. Das Korrelationsdiagramm zeigt die Beziehungen zwischen allen Variablen und kann wie folgt interpretiert werden:</p>
<ul>
<li>Positiv korrelierte Variablen sind zusammen gruppiert.</li>
<li>Negativ korrelierte Variablen befinden sich auf gegenüberliegenden Seiten des Ursprungs der Grafik oder auch den gegenüberliegende Quadranten.</li>
<li>Der Abstand zwischen den Variablen und dem Ursprung misst die Qualität der Variablen im Bezug auf den erklärenden Anteil. Variablen, die vom Ursprung entfernt sind, sind bedeutender als Variablen nahe des Ursprungs.</li>
</ul>
<p>Wenn eine Variable nur durch zwei Hauptkomponenten, also zum Beispiel die <code>Dim.1</code> und die <code>Dim.</code>, perfekt repräsentiert wird, ist die Summe des <code>cos2</code> von diesen beiden Hauptkomponenten gleich eins. In diesem Fall werden die Variablen auf dem Korrelationskreis positioniert und der Pfeil geht damit vom Ursprung direkt zum Kreis. In <a href="#fig-pca-var-1-2">Abbildung&nbsp;<span>59.8 (b)</span></a> sind die Variablen <code>heart_rate_bpm</code> und <code>mass_grams</code> direkt auf dem Korrelationskreis. Daher sind diese beiden Variablen erklärend für einen Großteil der Varianz in den Daten. Für einige der Variablen sind möglicherweise mehr als 2 Komponenten erforderlich, um die Daten perfekt zu repräsentieren. In diesem Fall werden die Variablen innerhalb des Korrelationskreises positioniert, was wir eher in der <a href="#fig-pca-var-1-1">Abbildung&nbsp;<span>59.8 (a)</span></a> sehen. Variablen nahe des Zentrum haben keine Bedeutung für die beiden Hauptkomponenten. Je nach betrachteten Hauptkomponentenpaar kann es natürlich wieder anders aussehen.</p>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(pca_animals, <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(pca_creature, <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-var-1" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-1-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-1-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-1" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-1-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-1-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-1" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;59.8— Korrelationsdiagramm der Variablen.</figcaption><p></p>
</figure>
</div>
</div>
<p>Im Weiteren können wir diee cos2-Werte verwenden um die Qualität der Darstellung abzuschätzen. Es ist möglich, Variablen nach ihren <code>cos2</code>-Werten zu färben, indem du das Argument <code>col.var = "cos2"</code> verwendest und damit einen Farbverlauf erzeugst. Die Option <code>gradient.cols =</code> definiert dabei den Farbverlauf.</p>
<p>In der <a href="#fig-pca-var-2">Abbildung&nbsp;<span>59.9</span></a> siehst du nochmal die Einfärbung. Wie du sehen kannst, hat bei den Tierdaten <code>warm_blooded</code> den größten Einfluss auf die Aufteilung und erklärt auch am meisten Varianz der Daten. Die Variablen <code>fly</code> und <code>live_in_groups</code> helfen nicht um die Daten aufzutrennen und die Varianz zu erklären. Bei den Kreaturendaten sehen wir dann ebenfalls das es zwei Variablen gibt, die viel erklären und eine Variable mit einer schlechteren Qualität.</p>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(pca_animals, <span class="at">col.var =</span> <span class="st">"cos2"</span>,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>), </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(pca_creature, <span class="at">col.var =</span> <span class="st">"cos2"</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>), </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-var-2" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-2-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-2" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-2-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-2-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-2" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;59.9— Korrelationsdiagramm der Variablen eingefärbt nach den cos2-Werten.</figcaption><p></p>
</figure>
</div>
</div>
<p>Wir können auch mit der <code>kmeans()</code> Funktion auch versuchen über die Koordinaten Gruppen zu bilden. Wir rechnen also auf den Koordinaten der Variablen eine Clusteranalyse. Faktisch könnten wir hier auch andere Clusteralgorithmen nehmen, aber ich nutze hier mal <code>kmeans()</code>. Im Prinzip kannst du den Algorithmus ändern, denn du brauchst später nur einen Faktor mit der Grupenzuordnung.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>grp_animal_var <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(var_animals<span class="sc">$</span>coord, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"cluster"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_factor</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir machen dann die Gruppenbildung auch für die Kreaturendaten. Hier dann nur zwei Gruppen, denn wir haben ja nur drei Variablen. Da machen dann drei Gruppen keinen Sinn.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>grp_creature_var <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(var_creature<span class="sc">$</span>coord, <span class="at">centers =</span> <span class="dv">2</span>, <span class="at">nstart =</span> <span class="dv">25</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"cluster"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_factor</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann nutzen wir die Gruppen einmal um nach diesen dann unseren Korrelaionsplot einzufärben. Wir sehen jetzt in diesen beiden Beipsielen in der <a href="#fig-pca-var-knn-1">Abbildung&nbsp;<span>59.10</span></a> kein so großen Änderungen oder Überraschungen. Aber je mehr Variablen du hast, desto spannender wird es dann auch.</p>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(pca_animals, <span class="at">col.var =</span> grp_animal_var, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#0073C2FF"</span>, <span class="st">"#EFC000FF"</span>, <span class="st">"#868686FF"</span>),</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title =</span> <span class="st">"Cluster"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(pca_creature, <span class="at">col.var =</span> grp_creature_var, </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#0073C2FF"</span>, <span class="st">"#EFC000FF"</span>),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title =</span> <span class="st">"Cluster"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-var-knn-1" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-knn-1-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-knn-1-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-knn-1" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-knn-1-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-knn-1-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-knn-1" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;59.10— Korrelationsdiagramm der Variablen eingefärbt den Gruppen aus dem k-NN Algorithmus zur Clusterbildung.</figcaption><p></p>
</figure>
</div>
</div>
<p>Abschließend wollen wir uns noch die Frage stellen, wie stark haben den jetzt die einzelnen Variablen zu den ersten beiden Hauptkomponenten beigetragen? Wir können dazu die Funktion <code>fviz_contrib()</code> nutzen. Die rote gestrichelte Linie in der <a href="#fig-pca-var-cont">Abbildung&nbsp;<span>59.11</span></a> zeigt den erwarteten durchschnittlichen Beitrag an. Wäre der Beitrag der Variablen bei den Tierdaten gleichmäßig, wäre der erwartete Wert <span class="math inline">\(1/n_{var} = 1/6 = 16\%\)</span>. Eine Variable mit einem Beitrag, der über diesem Grenzwert liegt, sehen wir als wichtig für die betrachteten Hauptkomponenten an.</p>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(pca_animals, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(pca_creature, <span class="at">choice =</span> <span class="st">"var"</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-var-cont" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-cont-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-cont-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-cont" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-var-cont-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-var-cont-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-var-cont" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;59.11— Beitrag der einzelnen Variablen zu den ersten beiden Hauptkomponenten.</figcaption><p></p>
</figure>
</div>
</div>
</section>
<section id="ebene-der-individuen" class="level3 page-columns page-full" data-number="59.5.3">
<h3 data-number="59.5.3" class="anchored" data-anchor-id="ebene-der-individuen"><span class="header-section-number">59.5.3</span> Ebene der Individuen</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>get_*_ind()</code> für andere Funktionen aus <code>FactoMineR</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Du kannst einfach das <code>*</code> in <code>get_*_ind()</code> durch den klein geschriebenen Funktionaufruf von MCA, FAMD und MFA ersetzen um dir dann auch die Ergebnisse analog zu der PCA herausgeben zu lassen. Die Interpretation ist ähnlich bis gleich.</p>
</div>
</div>
<p>Nachdem wir uns die Informationen von den Variablen und damit die Informationen von den Spalten angeschaut haben, wollen wir uns nochmal die Informationen aus den Zeilen, also den Individuen anschauen. Auch hier können wir ja einfach mal schauen, wie die Individuen untereinander zusammenhängen. Wir arbeiten jetzt also mit den Informationen zu den einzelnen Individuen. Wir erhalten die Informationen über die Funktion <code>get_pca_var()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ind_animals <span class="ot">&lt;-</span> <span class="fu">get_pca_ind</span>(pca_animals)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>ind_creature <span class="ot">&lt;-</span> <span class="fu">get_pca_ind</span>(pca_creature)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>ind_creature</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Component Analysis Results for individuals
 ===================================================
  Name       Description                       
1 "$coord"   "Coordinates for the individuals" 
2 "$cos2"    "Cos2 for the individuals"        
3 "$contrib" "contributions of the individuals"</code></pre>
</div>
</div>
<p>Nachdem wir die Informationen zu den Individuen extrahiert haben, können wir uns die Koordinaten der einzelnen Individuen, die sich aus der Varianz/Kovarianzmatrix der Individuen ergeben, einmal in der <a href="#fig-pca-ind-1">Abbildung&nbsp;<span>59.12</span></a> anschauen. Wir interpretieren die <code>cos2</code>-Werte analog zu den Variablen. Das heißt, <code>cos2</code>-Werte geben an, wie bedeutend ein Individuum für die beiden Hauptkomponenten <code>Dim.1</code> und <code>Dim.2</code> ist. Wie sehen bei den Tierdaten, dass der Hering nichts zur Aufspaltung der Daten beiträgt. Die Tiere die weiter Außen liegen, haben mehr Informationen. Bei den Kreaturendaten sehen wir klar, dass der Hamster und der Wal nicht zu den anderen Tieren passen will. Beide Tiere pressen förmlich die anderen Tiere in den unteren linken Quadranten zusammen.</p>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pca_animals,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.ind =</span> <span class="st">"cos2"</span>, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))) </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pca_creature,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.ind =</span> <span class="st">"cos2"</span>, </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">add =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-ind-1" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-1-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-1-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-1" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-1-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-1-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-1" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;59.12— Streudiagramm der individuellen Beobachtungen für die ersten beiden Hauptkomponenten.</figcaption><p></p>
</figure>
</div>
</div>
<p>Wir können uns dann auch recht schnelle einmal die meisten bedeutenden Individuen für die ersten beiden Hauptkomponenten numerisch in der <a href="#fig-pca-ind-2">Abbildung&nbsp;<span>59.13</span></a> ansehen. Achtung, wir haben hier einige Individuen entfernt, die fehlende Werte in den Zeielne hatten. Da hätten wir vorher mal reagieren sollen, aber wir machen hier ja keine Imputation von fehlenden Werten. Die rote gestrichelte Linie zeigt den erwarteten durchschnittlichen Beitrag an. Wäre der Beitrag der Variablen gleichmäßig, wäre der erwartete Wert <span class="math inline">\(1/n_{ind}\)</span>. Für die ersten beiden Hauptkomponenten kann ein Individuum mit einem Beitrag, der über diesem Grenzwert liegt, als wichtig angesehen werden.</p>
<p>Auch hier sehen wir, dass die Fliege und der Tausendfüßler den größten Einfluss haben. Bei den Kreaturendaten ist es noch auffälliger, da liegt die gesamte Information der Daten in dem Wal und dem Hamster. Der Rest der Daten ist dagegen recht homogen. Hier siehst du auch, wie man die Hauptkomponentenanalyse zum Detektieren von Ausreißern nutzen kannst.</p>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(pca_animals, <span class="at">choice =</span> <span class="st">"ind"</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(pca_creature, <span class="at">choice =</span> <span class="st">"ind"</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-ind-2" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-2-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-2" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-2-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-2-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-2" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;59.13— Beitrag der einzelnen Variablen zu den ersten beiden Hauptkomponenten.</figcaption><p></p>
</figure>
</div>
</div>
<p>Wie schon bei den Variablen können wir auch über das Koordinatensystem der Individuen Gruppen bilden. Wir rechnen auch hier eine Clusteranalyse mit der Funktion <code>kmeans()</code>. Wie auch schon vorab, kannst du auch hier dir einen anderen Clusteralgorithmus auswählen um die Gruppen zu bilden. Wir bleiben hier aber bei einem k-NN Algorithmus der uns einen Faktor mit der Gruppenzugehörigkeit wiedergibt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>grp_animal_ind <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(ind_animals<span class="sc">$</span>coord, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"cluster"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_factor</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das Ganze dann auch nochmal für den Kreaturendatensatz. Hier können wir dann wiederum mehr als zwei Cluster wählen, da wir ja sehr viele Individuen haben, die wir in Gruppen einteilen können. Die Anzahl an Gruppen ist hier mit <code>k = 4</code> eher zufällig gewählt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>grp_creature_ind <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(ind_creature<span class="sc">$</span>coord, <span class="at">centers =</span> <span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">25</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"cluster"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_factor</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#fig-pca-ind-3">Abbildung&nbsp;<span>59.14</span></a> siehst du die Gruppen aus dm k-NN Algorithmus eingefärbt und Ellipsen um die Gruppen gezeichnet. Mit der Option <code>ellipse.type = "confidence"</code> kannst du dir auch Ellipsen mit dem Konfidenzbereich anzeigen lassen. Wir bleiben hier aber mal bei dem Standard der Funktion, der auch sonst genutzt wird. Ich habe mich dann noch dazu entschieden den Mittelpunkt der Ellipse mit <code>mean.point = FALSE</code> nicht anzeigen zu lassen. Wir können auch das <code>geom.ind</code> zu <code>text</code> ändern, dann werden nicht die Punkte sondern die Label der Individuen angezeigt.</p>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pca_animals,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom.ind =</span> <span class="st">"point"</span>,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.ind =</span> grp_animal_ind, </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title =</span> <span class="st">"Groups"</span>, <span class="at">mean.point =</span> <span class="cn">FALSE</span>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pca_creature,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom.ind =</span> <span class="st">"point"</span>, </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">col.ind =</span> grp_creature_ind, </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>),</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, </span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title =</span> <span class="st">"Groups"</span>, <span class="at">mean.point =</span> <span class="cn">FALSE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-ind-3" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-3-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-3-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-3" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-3-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-3-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-3" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;59.14— Diagramm der PCA für die Variablen (Saplten) und den Beobachtungen (Zeilen) der Datenmatrix.</figcaption><p></p>
</figure>
</div>
</div>
<p>Tja, sieht dann etwas wild aus. Aber da musst du dann eben mit der Anzahl der Gruppen aus dem k-NN Algorithmus spielen. Auch siehst du, dass einzelne extreme Beobachtungen dir alles zunichte machen können. Hier müsste man überlegen, ob nicht der Wal und der Hamster bei den Kreaturendaten nicht eins zu viel sind. Jetzt stehen wir vor der Frage, passt das so? Was sind den die einzelnen Punkt für Beobachtungen? Da hilft uns dann die Funktion <code>fviz_pca_biplot()</code> weiter. Nicht alle Methoden der Hauptkomponentenanalyse können auch einen Biplot generieren, aber wenn, dann ist der Biplot sehr nützlich. In der <a href="#fig-pca-ind-4">Abbildung&nbsp;<span>59.15</span></a> siehst du den Biplot für die Tierdaten sowie für die Kreaturendaten sowie die Clusterinformationen ergänzt.</p>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pca_animals, </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">col.ind =</span> grp_animal_ind, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">col.var =</span> grp_animal_var,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">palette =</span> <span class="st">"jco"</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"var"</span>, <span class="st">"ind"</span>),</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.title =</span> <span class="st">"Species"</span>, <span class="at">mean.point =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>)) </span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pca_creature, </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">col.ind =</span> grp_creature_ind, </span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">col.var =</span> grp_creature_var,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, </span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"var"</span>, <span class="st">"ind"</span>),</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.title =</span> <span class="st">"Species"</span>, <span class="at">mean.point =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-pca-ind-4" class="cell column-page quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-4-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-4-1.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-4" width="480"></p>
<figcaption class="figure-caption">(a) Tierdaten <code>animals_df</code></figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-pca-ind-4-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-pca-ind-4-2.png" class="img-fluid figure-img" data-ref-parent="fig-pca-ind-4" width="480"></p>
<figcaption class="figure-caption">(b) Kreaturendaten <code>std_creature_df</code></figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;59.15— Biplot für die Individuen und Variablen eingefäerbt nach Clustern.</figcaption><p></p>
</figure>
</div>
</div>
<p>Bei den Tierdaten passe es eigentlich ganz gut mit den Clustern, aber die Inhalte machen teilweise nicht so viel Sinn. Wir haben Tiere zusammen gruppiert, die eigentlich nicht so richtig zusammen passsen. Zwar sind in der einen Gruppe die Insekten aber der Elefant ist zusammen mit dem Wal, dem Delphin und dem Adler sowie der Ente gruppiert. Da reichen anscheinend die Daten und Variablen noch nicht aus um hier eine gute Trennung hinzukriegen. Immerhin passt es auch mit den Säugetieren. Du siehst hier auch gut, wie die Vektoren in die Richtung der passenden Individuen zeigen. So sind die haarigen Individuen dann unten rechts. Das passt ganz gut. Bei den Kreaturendaten siehst du auch schön, wie der Wal die Variable <code>mass_grams</code> nach oben rechst zu sich zieht. Auch die Variable der Lebendauer zieht den Elefanten und den Menschen nach rechts weg.</p>
</section>
</section>
<section id="multi-dimensional-scaling-mds" class="level2" data-number="59.6">
<h2 data-number="59.6" class="anchored" data-anchor-id="multi-dimensional-scaling-mds"><span class="header-section-number">59.6</span> Multi Dimensional Scaling (MDS)</h2>
<p>Eine besondere Form der Hauptkomponentenanalyse ist das <em>Multidimensional Scaling</em> (abk. MDS). Im Prinzip sind die Mechanismen sehr ähnlich. Der Hauptunterschied ist aber, das wir für die MDS eine Distanzmatrix benötigen. Wir können dafür die Funktion <code>dist()</code> oder <code>as.dist()</code> nehmen, wenn wir schon Distanzen vorliegen haben. Nehmen wir als plakatives Beispiel einmal die Distanzen von europäischen Städten zueinander. Wir haben die Daten in der Exceldatei <code>distance.xlsx</code> vorliegen. Wir lesen die Daten einmal ein und schauen uns die ersten fünf Spalten und die ersten fünf Zeilen des Daten<em>satzes</em> einmal an.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>distance_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/distance.xlsx"</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>distance_tbl[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  city      Amsterdam Antwerp Athens Barcelona
  &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
1 Amsterdam         0     160   3082      1639
2 Antwerp         160       0   2766      1465
3 Athens         3082    2766      0      3312
4 Barcelona      1639    1465   3312         0
5 Berlin          649     723   2552      1899</code></pre>
</div>
</div>
<p>Wenn wir jetzt auf diesem Datensatz jetzt ein MDS rechnen wollen, dann müssen wir zum einen alle Spalten mit einem <code>character</code> entfernen. Wir haben dann nur noch einen Datensatz bzw. Datenmatrix mit den Distanzen vorliegen. Dann kann wir das <code>tibble</code> in einen <code>dist</code>-Objekt mit der Funktion <code>as.dist()</code> umwandeln. Die eigentliche Berechnung für das <em>Multidimensional Scaling</em> findet in der Funktion <code>cmdscale()</code> statt. Mit der Option <code>k = 2</code> legen wir fest, dass wir nur zwei Hauptkomponenten bzw. Dimensionen bestimmen wollen. Wir machen also aus unserem 37x37 großen Datenmatrix durch <em>Multidimensional Scaling</em> eine Reduktion auf zwei Dimensionen bzw. Spalten.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>mds <span class="ot">&lt;-</span> distance_tbl <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>city) <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.dist</span>() <span class="sc">%&gt;%</span>          </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cmdscale</span>(<span class="at">k =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">V1 =</span> <span class="sc">-</span>V1,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">V2 =</span> <span class="sc">-</span>V2)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mds) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Dim.1"</span>, <span class="st">"Dim.2"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In <a href="#fig-mds-1">Abbildung&nbsp;<span>59.16</span></a> sehen wir das Ergebnis der Dimensionsreduktion auf zwei Dimensionen. Wir erhalten die Zusammenhänge bzw. Distanzen aus der Datenmatrix in einem Scatterplot. Ein Scatterplot ist ja nichts anders als die Darstellung von zwei Dimensionen. Wie wir sehen können nimmt die Anordnung der Orte in etwa die Positionen von den Orten auf der Landkarte in Europa ein. Natürlich stimmen die Relationen nicht perfekt, aber das Abbild ist schon recht nahe dran. Wir können also auf diese Art und Weise auch Ausreißer bestimmen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(mds, <span class="at">x =</span> <span class="st">"Dim.1"</span>, <span class="at">y =</span> <span class="st">"Dim.2"</span>, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> distance_tbl<span class="sc">$</span>city,</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mds-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-mds-1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Abbildung&nbsp;59.16— Scatterplot der zwei Dimensionen nach dem <em>Multidimensional Scaling</em> für den Abstand europäischer Städte.</figcaption>
</figure>
</div>
</div>
</div>
<p>Wenn wir keine Distanzmatrix wie im obigen Beispiel zu den Entfernungen der europäischen Städte vorliegen haben, dann können wir uns die Distanzen auch mit der Funktion <code>dist()</code> berechnen lassen. Wir nutzen jetzt mal als Echtdaten die Daten der Gummibärchen. Mal sehen, ob wir hier irgendwelche Gruppen erkennen. Die Hilfeseite der Funktion <code>?dist</code> zeigt welche mathematischen Distanzmaße wir auf die Daten anwenden können. In unseren Fall berechnen wir die euklidische Distanz zwischen den Beobachtungen. Dann rufen wir über die Funkion <code>cmdsscale</code> das <em>Multidimensional Scaling</em> auf.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>mds <span class="ot">&lt;-</span> animals_df <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dist</span>(<span class="at">method =</span> <span class="st">"euclidean"</span>) <span class="sc">%&gt;%</span>          </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cmdscale</span>(<span class="at">k =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"Dim.1"</span>, <span class="st">"Dim.2"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das Ergebnis des <em>Multidimensional Scaling</em> hat keine Bedeutung für uns. Wir können die Zahlen nicht interpretieren. Was wir können ist das Ergebnis in einem Scatterplot wie in <a href="#fig-mds-2">Abbildung&nbsp;<span>59.17</span></a> zu visualisieren.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(mds, <span class="at">x =</span> <span class="st">"Dim.1"</span>, <span class="at">y =</span> <span class="st">"Dim.2"</span>, </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="fu">rownames</span>(animals_df),</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mds-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-mds-2-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Abbildung&nbsp;59.17— Scatterplot der zwei Dimensionen nach dem <em>Multidimensional Scaling</em> für den Tierdatensatz.</figcaption>
</figure>
</div>
</div>
</div>
<p>Zum einen Spalten sich die Tiere sehr gut auf. Wir sehen hier auch, welche Tiere eher nahe beieinander liegen und welche Tiere eher artfremd sind. Manche Tiere sind dann etwas seltsam, wie zum Beispiel der Adler und der Elefant, die nah beieinander liegen. Aber es gibt auf der anderen Seite auch nicht so viele Vögel in den Daten. Beachte immer, alle Beobachtungen werden auch abgebildet. Es gibt kein, passt dann doch nicht.</p>
<p>Wie schon bei der Hauptkomponentenanalyse können wir uns auch das <span class="math inline">\(k\)</span>-NN Verfahren aus dem <a href="classification-knn.html"><span>Kapitel&nbsp;67</span></a> nutzen um Cluster in den Daten zu finden. Das heißt wir nutzen das maschinelle Lernverfahren <span class="math inline">\(k-NN\)</span> um uns <span class="math inline">\(k\)</span> Cluster bestimmen zu lassen. Dafür nutzen wir die Funktion <code>kmeans()</code> und ziehen uns über die Funktion <code>pluck()</code> die Cluster raus. Daher erhalten wir einen Vektor mit Zahlen, die beschreiben in welchem Cluster die jeweilige <span class="math inline">\(i\)</span>-te Beobachtung ist.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># K-means clustering</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>clust <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(mds, <span class="at">centers =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">"cluster"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir wollen jetzt unser MDS Ergebnis von den Gummibärchen um eine Spalte für die Clusterergebnisse von <span class="math inline">\(k\)</span>-NN ergänzen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>mds <span class="ot">&lt;-</span> mds <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">groups =</span> clust)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nun sehen in <a href="#fig-mds-3">Abbildung&nbsp;<span>59.18</span></a> die gleiche Abbildung wie oben nur ergänzt um die farbliche Hinterlegung der <span class="math inline">\(k=3\)</span> Clustern aus dem <span class="math inline">\(k\)</span>-NN Algorithmus. Hier hängt es wieder stark von der Anzahl an Clustern ab. Wenn du mal spielst, wirst du sehen, dass bei vier Clustern dann auch der gelbe Großcluster aufgebrochen wird. Es sind eben dann doch recht wenig Tiere von jeder Art um hier eine saubere Zuordnung zu kriegen.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatter</span>(mds, <span class="at">x =</span> <span class="st">"Dim.1"</span>, <span class="at">y =</span> <span class="st">"Dim.2"</span>, </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">label =</span> <span class="fu">rownames</span>(animals_df),</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"groups"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"jco"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">ellipse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">ellipse.type =</span> <span class="st">"convex"</span>,</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">repel =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-mds-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-mds-3-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Abbildung&nbsp;59.18— Scatterplot der zwei Dimensionen nach dem <em>Multidimensional Scaling</em> für den Tierdatensatz mit den <span class="math inline">\(k=3\)</span> Clustern aus dem <span class="math inline">\(k\)</span>-NN Algorithmus.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-lda" class="level2 page-columns page-full" data-number="59.7">
<h2 data-number="59.7" class="anchored" data-anchor-id="sec-lda"><span class="header-section-number">59.7</span> Diskriminanzanalyse</h2>
<p>Die Diskriminanzanalyse (DA) ist eine multivariate Klassifizierungstechnik, die Beobachtungen auf der Grundlage messbarer Merkmale dieser Beobachtungen in zwei oder mehr sich gegenseitig ausschließende Gruppen einteilt. Diese Merkmale nennen wir dann gerne auch Variablen oder aber die Spalten unseres Datensatzes. Die Diskriminanzanalyse unterscheidet sich von der Regressionsanalyse dadurch, dass die abhängige Variable <span class="math inline">\(y\)</span> diskret sein muss. Die Diskriminanzanalyse unterscheidet sich von der Clusteranalyse dadurch, dass die Klassen im Voraus bekannt sein müssen, um das Modell zu erstellen. Faktisch ist es schon alles was du wissen musst. Wir werden jetzt mal schauen, ob wir einen Datensatz, der schon Klassen bzw. Gruppen hat anhand der Diskriminanzanalyse besser verstehen können.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die Diskriminanzanalyse
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Wie immer gibt es eine Vielzahl an tollen Tutorien, die die Diskriminanzanalyse gut erklären. Ich habe hier einmal eine Auswahl zusammengestellt und du kannst dich da ja mal vertiefend mit beschäftigen, wenn du willst. Teile der Tutorien findest du vermutlich hier im Kapitel wieder.</p>
<ul>
<li>Eine gute Übersicht als Tutorim <a href="http://www.sthda.com/english/articles/36-classification-methods-essentials/146-discriminant-analysis-essentials-in-r/">Discriminant Analysis Essentials in R</a></li>
<li>Einmal das erste Tutorium mit dem Namen <a href="https://rpubs.com/Nolan/298913">Discriminant Analysis in R</a></li>
<li>Und einmal das zweite Tutorium mit dem selben Namen <a href="https://rstudio-pubs-static.s3.amazonaws.com/35817_2552e05f1d4e4db8ba87b334101a43da.html">Discriminant Analysis in R</a></li>
</ul>
</div>
</div>
</div>
<p>Als Beispiel nutze ich einen Datensatz aus dem R Paket <code>HDclassif</code> und zwar den Datensatz <code>wine</code> auch bekannt vom <a href="https://archive.ics.uci.edu/dataset/109/wine">UC Irvine Machine Learning Repository - Wine Dataset</a>. Wie immer von mir leicht im Folgenden modifiziert. Wir haben hier drei Sorten von Wein <code>class</code> vorliegen, die wir anhand von verschiedenen Eigenschaften des Weins beschrieben haben. Welche dieser Eigenschaften hat einen Einfluss auf die Sorte des Weins? Das wollen wir uns jetzt einmal anschauen. Zuerst laden wir einmal die Daten.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Eine detailierte Auswertung des Datensatzes kann auch bei dem Tutorium <a href="https://rpubs.com/joelrudinas03/WQD">Analysis of White Wine Quality Dataset</a> nachvollzogen werden.</p>
</div></div><div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(wine)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir müssen noch etwas an den Daten rumspielen und die Namen richtig kriegen. Die Namen fehlen leider in dem Datensatz und ich habe mir die nochmal rausgesucht und zusammen kopiert. Dann müssen wir die Spalten noch in saubere Namen umwandeln und die Klassenvariable <code>class</code> in einen Faktor umwandeln.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>wine_tbl <span class="ot">&lt;-</span> wine <span class="sc">%&gt;%</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"Class"</span>, <span class="st">"Alcohol"</span>, <span class="st">"Malic acid"</span>, <span class="st">"Ash"</span>, <span class="st">"Alcalinity of ash"</span>, <span class="st">"Magnesium"</span>, <span class="st">"Total phenols"</span>,</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Flavanoids"</span>, <span class="st">"Nonflavanoid phenols"</span>, <span class="st">"Proanthocyanins"</span>, <span class="st">"Color intensity"</span>, <span class="st">"Hue"</span>, </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"OD280/OD315 of diluted wines"</span>, <span class="st">"Proline"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">class =</span> <span class="fu">as_factor</span>(class))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dann einmal ein schneller Blick auf die Daten. Wir werden hier die Daten nicht standardisieren, obwohl es sicherlich Sinn macht das zu tun. Aber dann wird das hier alles noch länger als sowieso schon. Du musst dir ja bei jeder Variable überlegen, ob es eine kategorielle Variable ist oder nicht. Wir können die Diskriminanzanalyse aber auch ohne eine Standardisierung oder Normalisierung gut durchführen.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-cluster-03" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tabelle&nbsp;59.5— Übersicht.</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 3%">
<col style="width: 15%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">class</th>
<th style="text-align: center;">alcohol</th>
<th style="text-align: center;">malic_acid</th>
<th style="text-align: center;">ash</th>
<th style="text-align: center;">alcalinity_of_ash</th>
<th style="text-align: center;">magnesium</th>
<th style="text-align: center;">total_phenols</th>
<th style="text-align: center;">flavanoids</th>
<th style="text-align: center;">nonflavanoid_phenols</th>
<th style="text-align: center;">proanthocyanins</th>
<th style="text-align: center;">color_intensity</th>
<th style="text-align: center;">hue</th>
<th style="text-align: center;">od280_od315_of_diluted_wines</th>
<th style="text-align: center;">proline</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">14.23</td>
<td style="text-align: center;">1.71</td>
<td style="text-align: center;">2.43</td>
<td style="text-align: center;">15.6</td>
<td style="text-align: center;">127</td>
<td style="text-align: center;">2.80</td>
<td style="text-align: center;">3.06</td>
<td style="text-align: center;">0.28</td>
<td style="text-align: center;">2.29</td>
<td style="text-align: center;">5.64</td>
<td style="text-align: center;">1.04</td>
<td style="text-align: center;">3.92</td>
<td style="text-align: center;">1065</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">13.20</td>
<td style="text-align: center;">1.78</td>
<td style="text-align: center;">2.14</td>
<td style="text-align: center;">11.2</td>
<td style="text-align: center;">100</td>
<td style="text-align: center;">2.65</td>
<td style="text-align: center;">2.76</td>
<td style="text-align: center;">0.26</td>
<td style="text-align: center;">1.28</td>
<td style="text-align: center;">4.38</td>
<td style="text-align: center;">1.05</td>
<td style="text-align: center;">3.40</td>
<td style="text-align: center;">1050</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">13.16</td>
<td style="text-align: center;">2.36</td>
<td style="text-align: center;">2.67</td>
<td style="text-align: center;">18.6</td>
<td style="text-align: center;">101</td>
<td style="text-align: center;">2.80</td>
<td style="text-align: center;">3.24</td>
<td style="text-align: center;">0.30</td>
<td style="text-align: center;">2.81</td>
<td style="text-align: center;">5.68</td>
<td style="text-align: center;">1.03</td>
<td style="text-align: center;">3.17</td>
<td style="text-align: center;">1185</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">14.37</td>
<td style="text-align: center;">1.95</td>
<td style="text-align: center;">2.50</td>
<td style="text-align: center;">16.8</td>
<td style="text-align: center;">113</td>
<td style="text-align: center;">3.85</td>
<td style="text-align: center;">3.49</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;">2.18</td>
<td style="text-align: center;">7.80</td>
<td style="text-align: center;">0.86</td>
<td style="text-align: center;">3.45</td>
<td style="text-align: center;">1480</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">13.24</td>
<td style="text-align: center;">2.59</td>
<td style="text-align: center;">2.87</td>
<td style="text-align: center;">21.0</td>
<td style="text-align: center;">118</td>
<td style="text-align: center;">2.80</td>
<td style="text-align: center;">2.69</td>
<td style="text-align: center;">0.39</td>
<td style="text-align: center;">1.82</td>
<td style="text-align: center;">4.32</td>
<td style="text-align: center;">1.04</td>
<td style="text-align: center;">2.93</td>
<td style="text-align: center;">735</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">14.20</td>
<td style="text-align: center;">1.76</td>
<td style="text-align: center;">2.45</td>
<td style="text-align: center;">15.2</td>
<td style="text-align: center;">112</td>
<td style="text-align: center;">3.27</td>
<td style="text-align: center;">3.39</td>
<td style="text-align: center;">0.34</td>
<td style="text-align: center;">1.97</td>
<td style="text-align: center;">6.75</td>
<td style="text-align: center;">1.05</td>
<td style="text-align: center;">2.85</td>
<td style="text-align: center;">1450</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">14.39</td>
<td style="text-align: center;">1.87</td>
<td style="text-align: center;">2.45</td>
<td style="text-align: center;">14.6</td>
<td style="text-align: center;">96</td>
<td style="text-align: center;">2.50</td>
<td style="text-align: center;">2.52</td>
<td style="text-align: center;">0.30</td>
<td style="text-align: center;">1.98</td>
<td style="text-align: center;">5.25</td>
<td style="text-align: center;">1.02</td>
<td style="text-align: center;">3.58</td>
<td style="text-align: center;">1290</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>In diesem Abschnitt gehe ich auf die volle Breite der Diskriminanzanalyse einmal ein. Zwar nicht in die Tiefe aber dafür in der Breite werde ich die folgenden Methoden der Diskriminanzanalyse vorstellen:</p>
<ul>
<li><strong>Lineare Diskriminanzanalyse (LDA):</strong> Verwendet die Linearkombinationen von den Variablen zur Vorhersage der Klasse einer gegebenen Beobachtung. Es wird davon ausgegangen, dass die Variablen (<span class="math inline">\(p\)</span>) normal verteilt sind und die Klassen identische Varianzen oder identische Kovarianzmatrizen haben. Also alle approximativ Varianzhomogen sind.</li>
<li><strong>Quadratische Diskriminanzanalyse (QDA):</strong> ist flexibler als die LDA. Hier gibt es keine Annahme, dass die Kovarianzmatrix der Klassen gleich ist. Wir können also auch mit Varianzheterogenität umgehen.</li>
<li><strong>Mischungsdiskriminanzanalyse (MDA):</strong> Wir nehmen an, dass jede Klasse eine Gaußsche Mischung von Unterklassen ist. Das heißt, unsere Daten setzen sich aus <em>verschiedenen</em> Normalverteilungen je Klasse zusammen.</li>
<li><strong>Flexible Diskriminanzanalyse (FDA):</strong> Es werden nichtlineare Kombinationen von Variablen verwendet, wie z. B. Splines oder nicht-lineare Geraden.</li>
<li><strong>Regulierte Diskriminanzanalyse (RDA):</strong> Die Regularisierung oder auch Schrumpfung verbessert die Schätzung der Kovarianzmatrizen in Situationen, in denen die Anzahl der Variablen größer ist als die Anzahl der Stichproben in den Daten. Dies führt zu einer Verbesserung der Diskriminanzanalyse.</li>
</ul>
<p>Wir egehn jetzt alle Methoden einmal durch. Bitte melde dich mal, wenn du in diesem Bereich was machst, dann würde ich mich über eine Diskussion der praktischen Anwendung wirklich freuen.</p>
<section id="lineare-diskriminanzanalyse-lda" class="level3" data-number="59.7.1">
<h3 data-number="59.7.1" class="anchored" data-anchor-id="lineare-diskriminanzanalyse-lda"><span class="header-section-number">59.7.1</span> Lineare Diskriminanzanalyse (LDA)</h3>
<p>Beginnen wir also mit der linearen Diskriminanzanalyse (eng. <em>Linear discriminant analysis</em>). Wir versuchen dabei die vordefinierten Klassen anhand der Variablen in den Spalten durch Linien voneinander zu trennen. In der <a href="#fig-partimat-1">Abbildung&nbsp;<span>59.19</span></a> sehen wir einmal das Prinzip. Als schwarze Zahlen sind die Sorten der Weine angeben. Die Flächen bilden die Zuordnung der der linearen Diskriminanzanalyse ab. Daher werden die roten Zahlen falsch klassifiziert. Wir nennen den Vorgang linear, da wir lineare Abtrennungen durch Linien durchführen und keine Bögen erlauben.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-partimat-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-partimat-1-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Abbildung&nbsp;59.19— Darstellung des Partition Plot für zwei Variablen aus dem <code>wine</code> Datensatz. Die roten Zahlen sind die falsch von Algorithmus klassifizierten Weinsorten.</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir können die lineare Diskriminanzanalyse mit der Funktion <code>lda()</code> aus dem R Paket <code>MASS</code> durchführen. Der <code>lda()</code> Auffruf ist nicht anders als alle anderen Formelaufrufe anderer Funktionen auch.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>wine_lda <span class="ot">&lt;-</span> <span class="fu">lda</span>(class <span class="sc">~</span> ., <span class="at">data =</span> wine_tbl)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>wine_lda</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lda(class ~ ., data = wine_tbl)

Prior probabilities of groups:
        1         2         3 
0.3314607 0.3988764 0.2696629 

Group means:
   alcohol malic_acid      ash alcalinity_of_ash magnesium total_phenols
1 13.74475   2.010678 2.455593          17.03729  106.3390      2.840169
2 12.27873   1.932676 2.244789          20.23803   94.5493      2.258873
3 13.15375   3.333750 2.437083          21.41667   99.3125      1.678750
  flavanoids nonflavanoid_phenols proanthocyanins color_intensity       hue
1  2.9823729             0.290000        1.899322        5.528305 1.0620339
2  2.0808451             0.363662        1.630282        3.086620 1.0562817
3  0.7814583             0.447500        1.153542        7.396250 0.6827083
  od280_od315_of_diluted_wines   proline
1                     3.157797 1115.7119
2                     2.785352  519.5070
3                     1.683542  629.8958

Coefficients of linear discriminants:
                                      LD1           LD2
alcohol                      -0.403399781  0.8717930699
malic_acid                    0.165254596  0.3053797325
ash                          -0.369075256  2.3458497486
alcalinity_of_ash             0.154797889 -0.1463807654
magnesium                    -0.002163496 -0.0004627565
total_phenols                 0.618052068 -0.0322128171
flavanoids                   -1.661191235 -0.4919980543
nonflavanoid_phenols         -1.495818440 -1.6309537953
proanthocyanins               0.134092628 -0.3070875776
color_intensity               0.355055710  0.2532306865
hue                          -0.818036073 -1.5156344987
od280_od315_of_diluted_wines -1.157559376  0.0511839665
proline                      -0.002691206  0.0028529846

Proportion of trace:
   LD1    LD2 
0.6875 0.3125 </code></pre>
</div>
</div>
<p>Die lineare Diskriminanzanalyse ermittelt nun die Gruppenmittelwerte und berechnet für jedes Individuum die Wahrscheinlichkeit, zu den verschiedenen Weinsorten oder besser allgemeiner den Klassen zu gehören. Das Individuum wird dann der Gruppe mit dem höchsten Wahrscheinlichkeitswert zugeordnet. Die Ausgaben von <code>lda()</code> enthalten die folgenden Elemente:</p>
<ul>
<li><code>Prior probabilities of groups</code>: der Anteil der Beobachtungen in jeder Gruppe. Zum Beispiel befinden sich 33% der Beobachtungen in der Gruppe mit der Sorte 1.</li>
<li><code>Group means</code>: Die Gruppenschwerpunkt und zeigen damit den Mittelwert jeder Variable in jeder Gruppe.</li>
<li><code>Coefficients of linear discriminants</code>: Zeigt die lineare Kombination von Prädiktorvariablen, die zur Bildung der LDA-Entscheidungsregel verwendet werden. Hier ist wichtig, dass die Variablen mit einem hohen absoluten Wert den meisten Anteil haben die Klassen voneinander zu trennen.</li>
<li><code>Proportions of trace</code>: Beschreibt den Anteil der Varianz zwischen den Klassen, der durch aufeinanderfolgende Diskriminanzfunktionen erklärt wird.</li>
</ul>
<p>Mit der Funktion <code>partimat()</code> können wir uns die Zusammenhänge für einzelne Variablenkombinationen ansehen, vielleicht wird dann einiges klarer. Es empfiehlt sich immer die Variablen zu nehmen, die den größten Betrag in der ersten Diskriminanten (LD1) haben. In unserem Fall sind das dann <code>flavanoids</code> sowie <code>nonflavanoid_phenols</code> und <code>od280_od315_of_diluted_wines</code> die wir uns nochmal paarweise anschauen. Ich kann das leider hier nicht im Skript machen, da leider die entstehende Abbildungen dann leider hier die Ausgabe zerreißen. Das Paket hat eben doch schon ein paar Jahre auf dem Buckel und ist nicht mehr so kompatibel und ich ahbe leider nicht die Zeit es nochmal in <code>ggplot</code> schön zu machen. Die Informationen sind ja alle da.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">partimat</span>(class <span class="sc">~</span> flavanoids <span class="sc">+</span> od280_od315_of_diluted_wines <span class="sc">+</span> nonflavanoid_phenols, <span class="at">data =</span> wine_tbl, <span class="at">method =</span> <span class="st">"lda"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Im Weiteren können wir uns auch die Klassen vorhersagen lassen die sich aus dem Modell der lineare Diskriminanzanalyse ergeben würden. Dafür nutzen wir dann die Funktion <code>predict()</code> und stecken einfach nochmal die Daten in die Funktion. Dann müssen wir noch etwas aufräumen, damit wir einen schönen Datensatz wiederbekommen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>wine_lda_pred_tbl <span class="ot">&lt;-</span> <span class="fu">predict</span>(wine_lda) <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(bind_cols) <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"class"</span>, <span class="st">"pred_1"</span>, <span class="st">"pred_2"</span>, <span class="st">"pred_3"</span>, <span class="st">"ld1"</span>, <span class="st">"ld2"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir können jetzt den Datensatz nutzen um einmal zu schauen, ob wir in der Lage waren über die lineare Diskriminanzanalyse unsere Klassen sauber aufzutrennen. Wir stellen auf der <span class="math inline">\(x\)</span>-Achse und der <span class="math inline">\(y\)</span>-Achse dann die Diskriminaten LD1 und LD2 dar. Unsere Klassen sind dann nach der vorhergesagten Klassenzugehörigkeit gelabelt. Wir sehen das Ergebnis dann in der <a href="#fig-disc-01">Abbildung&nbsp;<span>59.20</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>wine_lda_pred_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ld1, ld2, <span class="at">label =</span> class, <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>() <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-disc-01" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-disc-01-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;59.20— Ergebnis der linearen Diskriminanzanalyse für die Aufteilung der Weinsorten für beide Diskriminanten.</figcaption>
</figure>
</div>
</div>
</div>
<p>Jetzt schauen wir noch nach wie akkurat unsere Einteilung wirklich war. Wie viel Prozent der Klassen aus unserem originalen Datensatz können wir mit dem Modell der linearen Diskriminanzanalyse richtig vorhersagen?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(wine_lda_pred_tbl<span class="sc">$</span>class <span class="sc">==</span> wine_tbl<span class="sc">$</span>class)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>Perfekt, wir können alle Sorten richtig zuordnen. Wir haben ein wunderbares Modell gefunden mit dem wir zukünftige Weinsorten in die drei Klassen einordnen können.</p>
</section>
<section id="quadratische-diskriminanzanalyse-qda" class="level3" data-number="59.7.2">
<h3 data-number="59.7.2" class="anchored" data-anchor-id="quadratische-diskriminanzanalyse-qda"><span class="header-section-number">59.7.2</span> Quadratische Diskriminanzanalyse (QDA)</h3>
<p>Als nächstes schauen wir kurz auf die quadratische Diskriminanzanalyse (eng. <em>Quadratic discriminant analysis</em> ). Wir gehen hier jetzt nicht nochmal alles im Detail durch. Hier wiederholt sich dann vieles aus der linearen Diskriminanzanalyse.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>wine_qda <span class="ot">&lt;-</span> <span class="fu">qda</span>(class <span class="sc">~</span> ., <span class="at">data =</span> wine_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir erhalten auch wieder die Vorhersagen und damit ein Maß für unsere Güte der KLassenzuordnung über die Funktion <code>predict()</code>. Leider ist es so, dass wir nicht die Informationen über die Diskriminanten erhalten. Daher können wir auch keine Abbildung der Prädiktion zeigen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>wine_qda_pred_tbl <span class="ot">&lt;-</span> <span class="fu">predict</span>(wine_qda) <span class="sc">%&gt;%</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(bind_cols) <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"class"</span>, <span class="st">"pred_1"</span>, <span class="st">"pred_2"</span>, <span class="st">"pred_3"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Das einzige was hier jetzt erstmal bleibt, ist darauf zu schauen, wie akkurat unsere Vorhersage war. Wie viele von den Sorten sagen wir richtig vorher?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(wine_qda_pred_tbl<span class="sc">$</span>class <span class="sc">==</span> wine_tbl<span class="sc">$</span>class)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.994382</code></pre>
</div>
</div>
<p>Hier sind wir dann etwas schlecht als bei der linearen Diskriminanzanalyse.</p>
</section>
<section id="mischungsdiskriminanzanalyse-mda" class="level3" data-number="59.7.3">
<h3 data-number="59.7.3" class="anchored" data-anchor-id="mischungsdiskriminanzanalyse-mda"><span class="header-section-number">59.7.3</span> Mischungsdiskriminanzanalyse (MDA)</h3>
<p>Für die Mischungsdiskriminanzanalyse (eng. <em>Mixture discriminant analysis</em>) wechseln wir dann das Paket zu <code>mda</code>. Hier können wir uns dann auch wieder die Ergebnisse ausgeben lassen. Wir immer sieht das wieder anders aus, da wir das Paket gewechselt haben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>wine_mda <span class="ot">&lt;-</span> <span class="fu">mda</span>(class <span class="sc">~</span> ., <span class="at">data =</span> wine_tbl)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>wine_mda</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
mda(formula = class ~ ., data = wine_tbl)

Dimension: 8 

Percent Between-Group Variance Explained:
    v1     v2     v3     v4     v5     v6     v7     v8 
 52.82  88.80  93.73  96.63  98.35  99.58  99.97 100.00 

Degrees of Freedom (per dimension): 14 

Training Misclassification Error: 0 ( N = 178 )

Deviance: 0.349 </code></pre>
</div>
</div>
<p>Was wir sehen ist, dass unser <code>Misclassification Error</code> gleich 0 ist. Daher haben wir keine Klasse falsch zugeordnet. Das ist schon mal super. Das werden wir dann auch gleich nochmal sehen, wenn wir die Funktion <code>predict()</code> auf unsere Daten anwenden. Insgesamt werden dann aber acht Dimensionen geschätzt, wir werden uns aber nur die ersten beiden dann anschauen. Daher auch das <code>[, 1:2]</code>, was die ersten beiden Spalten aus den <code>variates</code> auswählt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>wine_mda_pred_tbl <span class="ot">&lt;-</span> <span class="fu">lst</span>(<span class="at">class =</span> <span class="fu">predict</span>(wine_mda, <span class="at">type =</span> <span class="st">"class"</span>), </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">posterior =</span> <span class="fu">predict</span>(wine_mda, <span class="at">type =</span> <span class="st">"posterior"</span>), </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">variates =</span> <span class="fu">predict</span>(wine_mda, <span class="at">type =</span> <span class="st">"variates"</span>)[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(bind_cols) <span class="sc">%&gt;%</span> </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"class"</span>, <span class="st">"pred_1"</span>, <span class="st">"pred_2"</span>, <span class="st">"pred_3"</span>, <span class="st">"ld1"</span>, <span class="st">"ld2"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#fig-disc-02">Abbildung&nbsp;<span>59.21</span></a> sehen wir das Ergebnis der Mischungsdiskriminanzanalyse. Sieht nicht so gut aus, wie die lineare Diskriminanzanalyse, da wir hier mehr Gurppen haben, die sich überlappen. Dennoch scheinen die Sorten sauber getrennt zu werden. Dafür schauen wir uns dann nochmal die Güte der Vorhersage an.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>wine_mda_pred_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ld1, ld2, <span class="at">label =</span> class, <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>() <span class="sc">+</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-disc-02" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-disc-02-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;59.21— Ergebnis der Mischungsdiskriminanzanalyse für die Aufteilung der Weinsorten für beide Diskriminanten.</figcaption>
</figure>
</div>
</div>
</div>
<p>Spannend, wie sehen, dass wir alle Klassen richtig vorhersagen. Zwar ist die Abbildung nicht so klar wie bei der linearen Diskriminanzanalyse, aber denoch kriegen wir alle Klassen sauber vorhersagen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(wine_mda_pred_tbl<span class="sc">$</span>class <span class="sc">==</span> wine_tbl<span class="sc">$</span>class)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>Hier gehen wir nicht mehr auf die Fehlermatrix (eng. <em>confusion matrix</em>) ein. Was du schnell erkennst ist, dass du alle Sorten sauber und. richtig vorhersagt. In den Spalten stehen die wahren Sorten und in den Zeilen die vom Modell vorhergesagten Sorten. Wir haben da eine perfekte Übereinstimmung.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>wine_mda<span class="sc">$</span>confusion</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         true
predicted  1  2  3
        1 59  0  0
        2  0 71  0
        3  0  0 48</code></pre>
</div>
</div>
<p>Abbhängig vom Paket ist dann die Fehlermatrix mit enthalten, manachmal musst du dir die auch selber bauen, wenn du die Matrix brauchts.</p>
</section>
<section id="flexible-diskriminanzanalyse-fda" class="level3" data-number="59.7.4">
<h3 data-number="59.7.4" class="anchored" data-anchor-id="flexible-diskriminanzanalyse-fda"><span class="header-section-number">59.7.4</span> Flexible Diskriminanzanalyse (FDA)</h3>
<p>Die flexible Diskriminanzanalyse (eng. <em>Flexible Discriminant Analysis</em>) basiert auch auf dem R Paket <code>mda</code> und somit haben wir ähnliche Aufrufe wie schon in der Mischungsdiskriminanzanalyse. Da wir hier nur zwei Dimensionen vorhersagen, haben wir es gleich einfach bei der Abbildung.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>wine_fda <span class="ot">&lt;-</span> <span class="fu">fda</span>(class <span class="sc">~</span> ., <span class="at">data =</span> wine_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir bauen uns dann wieder unseren Vorhersagedatensatz zusammen und wollen dann einmal die Vorhersage visualisieren.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>wine_fda_pred_tbl <span class="ot">&lt;-</span> <span class="fu">lst</span>(<span class="at">class =</span> <span class="fu">predict</span>(wine_fda, <span class="at">type =</span> <span class="st">"class"</span>), </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">posterior =</span> <span class="fu">predict</span>(wine_fda, <span class="at">type =</span> <span class="st">"posterior"</span>), </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">variates =</span> <span class="fu">predict</span>(wine_fda, <span class="at">type =</span> <span class="st">"variates"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(bind_cols) <span class="sc">%&gt;%</span> </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"class"</span>, <span class="st">"pred_1"</span>, <span class="st">"pred_2"</span>, <span class="st">"pred_3"</span>, <span class="st">"ld1"</span>, <span class="st">"ld2"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In der <a href="#fig-disc-03">Abbildung&nbsp;<span>59.22</span></a> siehst du die Ergebnisse der flexiblen Diskriminanzanalyse. Sieht super aus, wir haben eine perfekte Seperation.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>wine_fda_pred_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ld1, ld2, <span class="at">label =</span> class, <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>() <span class="sc">+</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-disc-03" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="stat-modeling-pca_files/figure-html/fig-disc-03-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Abbildung&nbsp;59.22— Ergebnis der flexiblen Diskriminanzanalyse für die Aufteilung der Weinsorten für beide Diskriminanten.</figcaption>
</figure>
</div>
</div>
</div>
<p>Auch hier einmal geschaut, was die Güte der Vorhersage aussagt. Wir sehen, dass ist dann auch perfekt. War auch zu erwarten nach der Abbildung.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(wine_lda_pred_tbl<span class="sc">$</span>class <span class="sc">==</span> wine_tbl<span class="sc">$</span>class)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>Abschließend noch die Fehlermatrix, die wir frei Haus mitgeliefert kriegen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>wine_fda<span class="sc">$</span>confusion</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         true
predicted  1  2  3
        1 59  0  0
        2  0 71  0
        3  0  0 48</code></pre>
</div>
</div>
</section>
<section id="regulierte-diskriminanzanalyse-rda" class="level3" data-number="59.7.5">
<h3 data-number="59.7.5" class="anchored" data-anchor-id="regulierte-diskriminanzanalyse-rda"><span class="header-section-number">59.7.5</span> Regulierte Diskriminanzanalyse (RDA)</h3>
<p>Zum Abschluss noch die regulierte Diskriminanzanalyse (eng. <em>Regularized discriminant anlysis</em>) aus dem dritten R Paket <code>klaR</code>. Ja, wir gehen hier echt durch die Pakete durch und erhalten dann wieder eine andere Ausgabe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>wine_rda <span class="ot">&lt;-</span> <span class="fu">rda</span>(class <span class="sc">~</span> ., <span class="at">data =</span> wine_tbl)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>wine_rda</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: 
rda(formula = class ~ ., data = wine_tbl)

Regularization parameters: 
    gamma    lambda 
0.9767300 0.9477272 

Prior probabilities of groups: 
        1         2         3 
0.3314607 0.3988764 0.2696629 

Misclassification rate: 
       apparent: 27.528 %
cross-validated: 27.558 %</code></pre>
</div>
</div>
<p>Wir sehen vor allem, dass jetzt mal die Vorhersage nicht so super geklappt hat. Wir haben eine Fehlerrate oder <code>Misclassification rate</code> von 28% und damit wird mehr als ein Viertel der Sorten nicht korrekt zugeordnet. Leider haben wir auch hier keine Möglichkeit uns mal etwas anzuschauen. Wir können nur selber nochmal die Vorhersage rechnen und kommen dann vermutlich auf ähnliche Zahlen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>wine_rda_pred_tbl <span class="ot">&lt;-</span> <span class="fu">predict</span>(wine_rda) <span class="sc">%&gt;%</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reduce</span>(bind_cols) <span class="sc">%&gt;%</span> </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"class"</span>, <span class="st">"pred_1"</span>, <span class="st">"pred_2"</span>, <span class="st">"pred_3"</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Am Ende rechnen wir aus, wie viel Prozent wir richtig klassifiziert haben und erreichen grob 71% was ja auch zu erwatzen war. Das ist jetzt so schlecht, dass wir in diesem Fall die regulierte Diskriminanzanalyse nicht nutzen würden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(wine_rda_pred_tbl<span class="sc">$</span>class <span class="sc">==</span> wine_tbl<span class="sc">$</span>class)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7247191</code></pre>
</div>
</div>
<p>Am Ende musst du aber schauen, wie deine Daten gut zu welcher Methode passen. Da alle Methoden sehr einfach durchzuführen sind, kannst du auch alle rechnen und schauen welche das beste Ergebnis in deinem Fall liefert.</p>
</section>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-kassambara2017practical" class="csl-entry" role="listitem">
Kassambara A. 2017. Practical guide to principal component methods in R: PCA, M (CA), FAMD, MFA, HCPC, factoextra. Sthda.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Handle positioning of the toggle
      window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-modeling-cluster.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./time-space-preface.html" class="pagination-link">
        <span class="nav-page-text">Zeitliche und räumliche Analysen</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Bio Data Science wurde von Jochen Kruppa-Scheetz geschrieben.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Dieses Buch wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</div>
  </div>
</footer>



</body></html>
# Frequentistische Hypothesentests {#sec-statistisches-testen .unnumbered}

```{r echo = FALSE}
pacman::p_load(tidyverse, readxl, knitr, kableExtra, broom)
```

::: callout-tip
## Grundlagen der Wissenschaft und Falsifikationsprinzip

Du findest auf YouTube [Grundlagen der Wissenschaft und Falsifikationsprinzip](https://youtu.be/h45ftLNsspM) als Video.
:::

Das statistische Testen - eine Geschichte voller Missverständnisse. Wir wollen uns in diesem Kapitel mit den Grundlagen des frequentistischen Hypothesentestens beschäftigen. Wenn ich hier einen Unterschied mache, dann muss es ja auch noch ein anderes Hypothesentesten geben. Ja, das nennt man dann bayesianische Statistik und kommt eventuell mal später. Wir konzentrieren uns aber zuerst auf frequentistische Hypothesentesten was seit gut hundert Jahren genutzt wird. Ich werde hier textlich nur einen kurzen Einstieg liefern. Vielleicht wird es in den folgenden Jahren länger aber aktuell (Ende 2022) bleiben wir hier bei einem kurzen Einstieg.

[Forschung basiert auf dem Falsifikationsprinzip. Wir können **nur ablehnen** und behalten das weniger schlechte Modell bei.\*\*]{.aside}

Beginnen wir mit der Logik der Forschung oder allgemeiner formuliert, als die Grundlage der Wissenschaft. Wir basieren all unsere Entscheidungen in der Wissenschaft auf dem Falsifikationsprinzip. Also bitte merken, wir können nur ablehnen (eng. *reject*).

::: callout-note
## Logik der Forschung

„Das ist die Logik der Forschung, die nie verifizieren, sondern immer nur jene Erklärungen beibehalten kann, die beim derzeitigen Erkenntnisstand am wenigsten falsifiziert sind." -- Wößmann, L.

Wir ersetzen schlechte Modelle (der Wirklichkeit) durch weniger schlechte Modelle (der Wirklichkeit).
:::

Wir wollen hier auf keinen Fall die Leistungen von Altvorderen schmälern. Dennoch hatten [Ronald Fischer (1890 - 1962)](https://en.wikipedia.org/wiki/Ronald_Fisher), als der Begründer der Statistik, andere Vorraussetzungen als wir heutzutage. Als wichtigster Unterschied sei natürlich das Gerät genannt, an dem du gerade diese Zeilen liest: dem Computer. Selbst die Erstellung einfachster Abbildungen war sehr, sehr zeitaufwendig. Die Berechnung von Zahlen lohnte sich mehr, als die Zahlen zu visualisieren. Insbesondere wenn wir die Explorative Datenanalyse nach [John Tukey (1915 - 2000)](https://en.wikipedia.org/wiki/John_Tukey) durchführen. Undenkbar zu den Zeiten von Ronald Fischer mehrere Abbildungen unterschiedlich nach Faktoren einzufärben und sich die Daten *anzugucken*.

[Über die Nullhypothese erfährst du mehr in dem folgenden @sec-hypothesen]{.aside}

Neben dieser Begrenzung von moderner Rechenkapazität um 1900 gab es noch eine andere ungünstige Entwicklung. Stark vereinfacht formuliert entwickelte Ronald Fischer statistische Werkzeuge um abzuschätzen wir wahrscheinlich die Nullhypothese unter dem Auftreten der beobachteten Daten ist. Nun ist es aber so, dass wir ja auch eine Entscheidung treffen wollen. Nach der Logik der Forschung wollen wir ja eine Hypothese falsifizieren, in unserem Fall die Nullhypothese. Die Entscheidungsregeln, also die statistische Testtheorie, kommen nun von [Jerzy Neyman (1894 - 1981)](https://en.wikipedia.org/wiki/Jerzy_Neyman) und [Egon Pearson (1895 - 1980)](https://en.wikipedia.org/wiki/Egon_Pearson), beide als die Begründer der frequentistischen Hypothesentests.

Schlussendlich gibt es noch eine andere Störmung in der Statistik, die auf den mathematischen Formeln von [Thomas Bayes (1701 - 1761)](https://en.wikipedia.org/wiki/Thomas_Bayes) basieren. In sich eine geschlossene Theorie, die auf der *inversen* Wahrscheinlichkeit basiert. Das klingt jetzt etwas schräg, aber eigentlich ist die bayesianische Statistik die Statistik, die die Fragen um die Alternativehypothese beantwortet. Der Grund warum die bayesianische Statistik nicht angewendet wurde, war der Bedarf an Rechenleistung. Die bayesiansiche Statistik lässt sich nicht händisch in endlicher Zeit lösen. Dieses *technische* Problem haben wir aber nicht mehr. Eigentlich könnten wir also die bayesiansiche Statistik verwenden. Wir wollen hier aber (noch) nicht auf die bayesianische Statistik eingehen, das werden wir später tun.

Wenn du allgemein Interesse hast an der Geschichte der Statistik dann sei auf @salsburg2001lady verwiesen. Ein sehr schönes Buch, was die *geschichtlichen* Zusammenhänge nochmal aufzeigt.

Kommen wir aber nun zu den wichtigeren Punkten. Das Kapitel ist sehr umfangreich und enthält viele Informationen, die wir teilweise später nochmal brauchen. Darüber hinaus müssen wir noch das *Lernen und Verstehen* von der *Anwendung* unterscheiden.

-   **Zum Lernen und Verstehen** des statistischen Testen nutzen wir das Konzept der Teststatistik $T$ (siehe @sec-teststatistik)
-   **Zur Anwendung** nutzen wir das Konzept des p-Wertes $Pr(T|H_0)$ (siehe @sec-pwert) und das Konzept der 95% Konfidenzintervalle (siehe @sec-ki)

::: {.callout-caution collapse="true"}
## Ein Wort zur Klausur

Abhängig von der Lernstufe - daher welche [Veranstaltung](#sec-vorlesungen-hs) du gerade bei mir besuchst - kommt nicht *alles* aus diesem Kapitel dran in der Klausur. Bitte gleiche die Inhalte, die ich in der aktuellen Vorlesung unterrichte, mit dem Material hier ab. Als Faustregel gilt, je höher die Lernstufe desto mehr musst du von dem statistischen Testen Wissen und Verstehen. Beachte auch die Probeklausur in deiner Veranstaltung und die [gesammelten Klausurfragen auf GitHub](https://github.com/jkruppa/teaching/tree/main/Klausur).
:::

## Die Hypothesen {#sec-hypothesen}

::: column-margin
Im [Anhang @sec-beispiel-auswertung] findest du verschiedene Beispiele zu Auswertungen von Datenbeispielen.
:::

Wir können auf allen Daten einen statistischen Test rechnen und erhalten statistische Maßzahlen wie eine Teststatistik oder einen p-Wert. Nur leider können wir mit diesen statistischen Maßzahlen nicht viel anfangen ohne die Hypothesen zu kennen. Jeder statistische Test testet eine Nullhypothese. Ob diese Hypothese dem Anwender nun bekannt ist oder nicht, ein statistischer Test testet eine Nullhypothese. Daher müssen wir uns immer klar sein, was die entsprechende Nullhypothese zu unserer Fragestellung ist. Wenn du hier stockst, ist das ganz normal. Eine Fragestellung mit einer statistischen Hypothese zu verbinden ist nicht immer so einfach gemacht.

::: callout-important
## Die Nullhypothese $H_0$ und die Alternativehypothese $H_A$

Die Nullhypothese $H_0$ nennen wir auch die Null oder Gleichheitshypothese. Die Nullhypothese sagt aus, dass zwei Gruppen gleich sind oder aber kein Effekt zu beobachten ist.

$$
H_0: \bar{y}_{1} = \bar{y}_{2}
$$

Die Alternativehypothese $H_A$ oder $H_1$ auch Alternative genannt nennen wir auch Unterschiedshypothese. Die Alternativehypothese besagt, dass ein Unterschied vorliegt oder aber ein Effekt vorhanden ist.

$$
H_A: \bar{y}_{1} \neq \bar{y}_{2}
$$
:::

Als Veranschaulichung nehmen wir das Beispiel aus @sec-example-2. Wir formulieren als erstes die Fragestellung. Eine Fragestellung endet mit einem Fragezeichen.

*Liegt ein Unterschied zwischen den Sprungweiten von Katzen und Hundeflöhen vor?*

Wir können die Frage auch anders formulieren.

*Springen Hunde und Katzenflöhe unterschiedlich weit?*

Wichtig ist, dass wir eine primäre Fragestellung formulieren. Wir können auch mehrere Fargen an einen Datensatz haben. Das ist auch vollkommen normal. Nur hat *jede* Fragestellung ein eigenes Hypothesenpaar. Wir bleiben aber bei dem simplen Beispiel.

Wie sieht nun die statistische Hypothese in diesem Beispiel aus? Wir wollen uns die Sprungweite in \[cm\] anschauen. In diesem Fall wollen wir die *mittlere* Sprungweite der Hundeflöhe $\bar{y}_{dog}$ mit der *mittleren* Sprungweite der Katzenflöhe $\bar{y}_{cat}$ vergleichen. Es ergibt sich folgendes Hypothesenpaar.

```{=tex}
\begin{align*} 
H_0: \bar{y}_{dog} &= \bar{y}_{cat} \\  
H_A: \bar{y}_{dog} &\neq \bar{y}_{cat} \\   
\end{align*}
```
[Das **Falisifkationsprinzip** - wir können nur Ablehnen - kommt hier zusammen mit der **frequentistischen Statistik** in der wir nur eine Wahrscheinlichkeitsaussage über das Auftreten der Daten $D$ - unter der Annahme $H_0$ gilt - treffen können.]{.aside}

Es ist wichtig sich in Erinnerung zu rufen, dass wir nur und ausschließlich Aussagen über die Nullhypothese treffen werden. Das *frequentistische* Hypothesentesten kann nichts anders. Wir kriegen keine Aussage über die Alternativhypothese sondern nur eine Abschätzung der Wahrscheinlichkeit des Auftretens der Daten im durchgeführten Experiment, wenn die Nullhypothese wahr wäre.

## Die Testentscheidung...

In den folgenden Kapiteln werden wir verschiedene statistische Tests kennenlernen. Alle statistischen Tests haben gemein, dass ein Test eine Teststatistik $T_{calc}$ berechnet. Darüber hinaus liefert jeder Test auch einen p-Wert (eng. *p-value*). Manche statistischen Test geben auch ein 95% Konfidenzintervall wieder. Eine Testentscheidung gegen die Nullhypothese $H_0$ kann mit jedem der drei statistischen Maßzahlen durchgeführt werden. Die Regel für die Entscheidung, ob die Nullhypothese $H_0$ abgelehnt werden kann, ist nur jeweils anders. In @tbl-comp-t-p-ki sind die Entscheidungsregeln einmal zusammengefasst.

::: column-page
|                |        **Teststatistik**         |              **p-Wert**              |             **95% Konfidenzintervall**              |
|:--------------:|:--------------------------------:|:------------------------------------:|:---------------------------------------------------:|
|                |     $\boldsymbol{T_{calc}}$      | $\boldsymbol{Pr(\geq T_{calc}|H_0)}$ |            $\boldsymbol{KI_{1-\alpha}}$             |
| H$_0$ ablehnen | $T_{calc} \geq T_{\alpha = 5\%}$ | $Pr(\geq T_{calc}| H_0) \leq \alpha$ | $\Delta_{A-B}$: enthält [*nicht*]{.underline} **0** |
| H$_0$ ablehnen |                                  |                                      | $\Delta_{A/B}$: enthält [*nicht*]{.underline} **1** |

: Zusammenfassung der statistischen Testentscheidung unter der Nutzung der Teststatistik, dem p-Wert und dem 95% Konfidenzintervall. Die Entscheidung nach der Teststatistik ist veraltet und dient nur dem konzeptionellen Verständnisses. In der Forschung angewandt wird der p-Wert und das 95% Konfidenzintervall. Im Fall des 95% Konfidenzintervalls müssen wir noch unterschieden, ob wir einen Mittelwertsunterschied $\Delta_{A-B}$ oder aber einen Anteilsunterschied $\Delta_{A/B}$ betrachten. {#tbl-comp-t-p-ki}
:::

Wir wollen in den folgenden Abschnitten die jeweiligen Entscheidungsregeln eines statistisches Tests einmal durchgehen.

-   Die Testentscheidung gegen die Nullhypothese anhand der Teststatistik in @sec-teststatistik
-   Die Testentscheidung gegen die Nullhypothese anhand dem p-Wert in @sec-pwert
-   Die Testentscheidung gegen die Nullhypothese anhand des 95% Konfidenzintervall in @sec-ki

::: column-margin
![](images/angel_01.png){fig-align="center" width="50%"}

Streng genommen gilt die Regel $T_{calc} \geq T_{\alpha = 5\%}$ nur für eine Auswahl an statistischen Tests siehe dazu auch @sec-teststatistik. Bei manchen statistischen Tests ist die Entscheidung gedreht. Hier lassen wir das aber mal so stehen...
:::

### ... anhand der Teststatistik {#sec-teststatistik}

::: callout-tip
## Prinzip des statistischen Testens I - Die Teststatistik

Du findest auf YouTube [Prinzip des statistischen Testens I - Die Teststatistik](https://youtu.be/28QjGfR_SPQ) als Video. Ich werde zwar alles nochmal hier als Text aufschreiben, aber manchmal ist das Sehen und Hören dann einfacher.
:::

Wir wollen uns dem frequentistischen Hypothesentesten über die Idee der Teststatistik annähern. Im folgenden sehen wir die Formel für den t-Test. Den t-Test werden wir im @sec-ttest uns nochmal detaillierter anschauen. Hier nutzen wir die vereinfachte Formel um das Konzept zu verstehen.

$$
T_{calc}=\cfrac{\bar{y}_1-\bar{y}_2}{s_{p} \cdot \sqrt{2/n_g}}
$$

mit

-   $\bar{y}_1$ dem Mittelwert für die erste Gruppe.
-   $\bar{y}_2$ dem Mittelwert für die zweite Gruppe.
-   $s_{p}$ der gepoolten Standardabweichung mit $s_p = \tfrac{s_A + s_B}{2}$.
-   $n_g$ der Gruppengröße der gruppen. Wir nehmen an beide Gruppen sind gleich groß.

Wir benötigen also zwei Mittelwerte $\bar{y}_1$ und $\bar{y}_2$ und deren gepoolte Standardabweichung $s_p$ sowie die Anzahl der Beobachtungen je Gruppe $n_g$. Wenden wir die Formel des t-Tests einmal auf den folgenden Beispieldatensatz an. In @tbl-dog-cat-small-delta ist eine Datenbeispiel gegeben.

```{r}
#| echo: false
#| label: tbl-dog-cat-small
#| tbl-cap: Beispiel für die Berechnung von einem Mittelwertseffekt an der Sprunglänge [cm] von Hunde und Katzenflöhen.
data_tbl <- tibble(animal = gl(2, 4, labels = c("cat", "dog")),
                   jump_length = c(8.5, 9.9, 8.9, 9.4, 8.0, 7.2, 8.4, 7.5)) 

data_tbl %>% 
  kable(align = "c", "pipe")

mean_tbl <- data_tbl %>% 
  group_by(animal) %>% 
  summarise(mean_animal = round(mean(jump_length), 1),
            sd_animal = round(sd(jump_length), 1))

mean_cat <- mean_tbl$mean_animal[1]
mean_dog <- mean_tbl$mean_animal[2]
sd_cat <- mean_tbl$sd_animal[1]
sd_dog <- mean_tbl$sd_animal[2]
sd_p <- (sd_cat + sd_dog)/2
t_calc <- round((mean_cat - mean_dog)/((sd_cat + sd_dog)/2 * sqrt(2/4)), 2)
t_k <- round(qt(0.025, 4, lower.tail=FALSE), 2)

```

Wir berechnen nun die Mittelwerte und die Standardabweichungen aus der obigen Datentabelle. Die Werte setzen wir dann in die Formel ein.

$$
T_{calc}=\cfrac{`r mean_cat` - `r mean_dog`}{\cfrac{(`r sd_cat` + `r sd_dog`)}{2} \cdot \sqrt{2/4}} = `r t_calc`
$$

mit

-   $\bar{y}_{cat} = `r mean_cat`$ dem Mittelwert für die Gruppe *cat*.
-   $\bar{y}_{dog} = `r mean_dog`$ dem Mittelwert für die Gruppe *dog*.
-   $s_p = `r sd_p`$ der gepoolten Standardabweichung mit $s_p = \tfrac{`r sd_cat` + `r sd_dog`}{2}$.
-   $n_g = 4$ der Gruppengröße der Gruppe A und B. Wir nehmen an beide Gruppen sind gleich groß.

Wir haben nun die Teststatistik $T_{calc} = `r t_calc`$ berechnet. In der ganzen Rechnererei verliert man manchmal den Überblick. Erinnern wir uns, was wir eigentlich wollten. Die Frage war, ob sich die mittleren Sprungweiten der Hunde- und Katzenflöhe unterschieden. Wenn die $H_0$ wahr wäre, dann wäre der Unterschied $\Delta$ der beiden Mittelwerte der Hunde- und Katzenflöhe gleich null. Oder nochmal in der Analogie der t-Test Formel, dann wäre im Zähler $\Delta = \bar{y}_{cat} - \bar{y}_{dog} = 0$. Wenn die Mittelwerte der Sprungweite \[cm\] der Hunde- und Katzenflöhe gleich wäre, dann wäre die berechnete Teststatistik $T_{calc} = 0$, da im Zähler Null stehen würde. Die Differenz von zwei gleichen Zahlen ist Null.

Je größer die berechnete Teststatistik $T_{calc}$ wird, desto unwahrscheinlicher ist es, dass die beiden Mittelwerte per Zufall gleich sind. Wie groß muss nun die berechnete Teststatistik $T_{calc}$ werden damit wir die Nullhypothese ablehnen können?

::: column-page
![Die t-Verteilung aller möglichen $T_{calc}$ wenn die Nullhypothese wahr ist. Der Mittelwert der t-Verteilun ist $T=0$. Wenn wir keinen Effekt erwarten würden dann wären die beiden Mittelwerte $\bar{y}_1$ und $\bar{y}_2$ gleich groß. Die Differenz wäre 0. Je größer der $T_{calc}$ wird desto weniger können wir davon ausgehen, dass die beiden Mittelwerte gleich sind. Liegt der $T_{calc}$ über dem kritischen Wert von $T_{\alpha = 5\%}$ dann wir die Nullhypothese abgelehnt.](images/t-verteilung_01.png){#fig-teststatistik-01 fig-align="center"}
:::

In @fig-teststatistik-01 ist die Verteilung aller möglichen $T_{calc}$ Werte unter der Annahme, dass die Nullhypothese wahr ist, dargestellt. Wir sehen, dass die t-Verteilung am höchsten bei $T_{calc} = 0$ ist und niedrigeren Werte mit steigenden t-Werten annimmt. Wenn $T = 0$ dann sind auch die Mittelwerte gleich. Je größer unsere berechnete Teststatistik $T_{calc}$ wird, desto unwahrscheinlicher ist es, dass die Nullhypothese gilt. Die t-Verteilug ist so gebaut, dass die Fläche $A$ unter der Kurve gleich $A=1$ ist. Wir können nun den kritschen Wert $T_{\alpha = 5\%}$ berechnen an dem rechts von dem Wert eine Fläche von 0.05 oder 5% liegt. Sommit liegt dann links von dem kritischen Wert die Fläche von 0.95 oder 95%. Den kritischen Wert $T_{\alpha = 5\%}$ können wir statistischen Tabellen entnehmen. Oder wir berechnen den kritischen Wert direkt in R mit $T_{\alpha = 5\%} = `r t_k`$.

Kommen wir zurück zu unserem Beispiel. Wir haben in unserem Datenbeispiel für den Vergleich von der Sprungweite in \[cm\] von Hunde- und Katzenflöhen eine Teststatistik von $T_{calc} = `r t_calc`$ berechnet. Der kritische Wert um die Nullhypothese abzulehnen liegt bei $T_{\alpha = 5\%} = `r t_k`$. Wenn $T_{calc} \geq T_{\alpha = 5\%}$ wird die Nullhypothese (H$_0$) abgelehnt. In unserem Fall ist $`r t_calc` \geq `r t_k`$. Wir können die Nullhypothese ablehnen. Es gibt einen Unterschied zwischen der mittleren Sprungweite von Hunde- und Katzenflöhen.

::: column-margin
![](images/angel_01.png){fig-align="center" width="50%"}

*Es gibt einen Unterschied zwischen der mittleren Sprungweite von Hunde- und Katzenflöhen.* Die Aussage ist **statistisch** falsch. Wir können im frequentistischen Hypothesentesten keine Aussage über die $H_A$ treffen. Im Sinne der Anwendbarkeit soll es hier so stehen bleiben.
:::

Nun ist es leider so, dass jeder statistische Test seine eigene Teststatistik $T$ hat. Daher ist es etwas mühselig sich immer neue und andere kritische Werte für jeden Test zu merken. Es hat sich daher eingebürgert, sich nicht die Teststatistik für die Testentscheidung gegen die Nullhypothese zu nutzen sondern den p-Wert. Den p-Wert wollen wir uns in dem folgenden Abschnitt anschauen.

::: callout-important
## Entscheidung mit der berechneten Teststatistik

Bei der Entscheidung mit der Teststatistik müssen wir zwei Fälle unterschieden.

(1) Bei einem t-Test und einem $\mathcal{X}^2$-Test gilt, wenn $T_{calc} \geq T_{\alpha = 5\%}$ wird die Nullhypothese (H$_0$) abgelehnt.

(2) Bei einem Wilcoxon-Mann-Whitney-Test gilt, wenn $T_{calc} < T_{\alpha = 5\%}$ wird die Nullhypothese (H$_0$) abgelehnt.

**Achtung --** Wir nutzen die Entscheidung mit der Teststatistik *nur und ausschließlich* in der Klausur. In der praktischen Anwendung hat die Betrachtung der berechneten Teststatistik *keine* Verwendung mehr.
:::

### ... anhand dem p-Wert {#sec-pwert}

::: callout-tip
## Prinzip des statistischen Testens II - Der p-Wert

Du findest auf YouTube [Prinzip des statistischen Testens II - Der p-Wert](https://youtu.be/Zr8gdWZrSPc) als Video Reihe. Ich werde zwar alles nochmal hier als Text aufschreiben, aber manchmal ist das Sehen und Hören dann einfacher.
:::

In dem vorherigen Abschnitt haben wir gelernt, wie wir zu einer Entscheidung gegen die Nullhypothese anhand der Teststatistik kommen. Wir haben einen kritischen Wert $T_{\alpha = 5\%}$ definiert bei dem rechts von dem Wert 5% der Werte liegen. Anstatt nun den berechneten Wert $T_{calc}$ mit dem kritischen Wert $T_{\alpha = 5\%}$ zu vergleichen, vergleichen wir jetzt die Flächen rechts von den jeweiligen Werten.

[Wir schreiben $\boldsymbol{Pr}$ und meinen damit eine Wahrscheinlichkeit (eng. *probability*). Häufig wird auch nur das $P$ verwendet, aber dann kommen wir wieder mit anderen Konzepten in die Quere.]{.aside}

In @fig-teststatistik-01 sind die Flächen auch eingetragen. Da die gesamte Fläche unter der t-Verteilung mit $A = 1$ ist, können wir die Flächen auch als Wahrscheinlichkeiten lesen. Die Fläche rechts von der berechneten Teststatistik $T_{calc}$ wird $Pr(T_{calc}|H_0)$ oder $p$-Wert genannt. Die *gesamte* Fläche rechts von dem kritischen Wert $T_{\alpha = 5\%}$ wird $\alpha$ genannt und liegt bei 5%. Wir können also die Teststatistiken oder den p-Wert mit dem $\alpha$-Niveau von 5% vergleichen.

| Teststatistik $T$  |            Fläche $A$            |
|:------------------:|:--------------------------------:|
|     $T_{calc}$     | $Pr(T_{calc}|H_0)$ oder $p$-Wert |
| $T_{\alpha = 5\%}$ |             $\alpha$             |

: Zusammenhang zwischen der Teststatistik $T$ und der Fläche $A$ rechts von der Teststatistik. Die Fläche rechts von der berechneten Teststatistik $T_{calc}$ wird $Pr(T|H_0)$ oder $p$-Wert genannt. Die Fläche rechts von dem kritischen Wert $T_{\alpha = 5\%}$ wird $\alpha$ genannt und liegt bei 5%. {#tbl-t-und-A}

Der p-Wert oder $Pr(T|H_0)$ ist eine Wahrscheinlichkeit. Eine Wahrscheinlichkeit kann die Zahlen von 0 bis 1 annehmen. Dabei sind die Grenzen einfach zu definieren. Eine Wahrscheinlichkeit von $Pr(A) = 0$ bedeutet, dass das Ereignis A nicht auftritt; eine Wahrscheinlichkeit von $Pr(A) = 1$ bedeutet, dass das Ereignis A eintritt. Der Zahlenraum dazwischen stellt jeden von uns schon vor große Herausforderungen. Der Unterschied zwischen 40% und 60% für den Eintritt des Ereignisses A sind nicht so klar zu definieren, wie du auf den ersten Blick meinen magst.

Ein frequentistischer Hypothesentest beantwortet die Frage, mit welcher Wahrscheinlichkeit $Pr$ die Teststatistik $T$ aus dem Experiment mit den Daten $D$ zu beobachten wären, wenn es keinen Effekt gäbe ($H_0$ ist wahr).

[**Likelihood** heißt Plausibilität und **Probability** heißt Wahrscheinlichkeit.]{.aside}

Im Englischen gibt es die Begrifflichkeiten einer *Likelihood* und einer *Probability* in der Statistik. Meist wird beides ins Deutsche ungenau mit Wahrscheinlichkeit übersetzt oder wir nutzen einfach *Likelihood*. Was aber auch nicht so recht weiterhilft. Es handelt sich hierbei aber um zwei unterschiedliche Konzepte. Deshalb Übersetzen wir *Likelihood* mit Plausibilität und *Probability* mit Wahrscheinlichkeit.

Im Folgenden berechnen wir den $p$-Wert in R mit der Funktion `t.test()`. Mehr dazu im @sec-ttest, wo wir den t-Test und deren Anwendung im Detail besprechen.

```{r}
#| echo: false
data_tbl <- tibble(animal = gl(2, 4, labels = c("cat", "dog")),
                   jump_length = c(8.5, 9.9, 8.9, 9.4, 8.0, 7.2, 8.8, 7.5)) 

t.test(jump_length ~ animal, data = data_tbl, var.equal = TRUE) %>% 
  tidy %>% 
  select(statistic, p.value)
```

[Wir sagen, dass wir ein **signifikantes** Ergebnis haben, wenn der $p$-Wert kleiner ist als die Signifikanzschwelle $\alpha$ von 5%.]{.aside}

Wir erhalten einen $p$-Wert von 0.031 und vergleichen diesen Wert zu einem $\alpha$ von 5%. Ist der $p$-Wert kleiner als der $\alpha$-Wert von 5%, dann können wir die Nullhypothese ablehnen. Da 0.031 kleiner ist als 0.05 können wir die Nullhypothese und damit die Gleichheit der mittleren Sprungweiten in \[cm\] ablehnen. Wir sagen, dass wir ein signifikantes Ergebnis vorliegen haben.

::: callout-important
## Entscheidung mit dem p-Wert

Wenn der p-Wert $\leq \alpha$ dann wird die Nullhypothese (H$_0$) abgelehnt. Das Signifikanzniveau $\alpha$ wird als Kulturkonstante auf 5% oder 0.05 gesetzt. Die Nullhypothese (H$_0$) kann auch Gleichheitshypothese gesehen werden. Wenn die H$_0$ gilt, liegt kein Unterschied zwischen z.B. den Behandlungen vor.
:::

### ... anhand des 95% Konfidenzintervall {#sec-ki}

Ein statistischer Test der eine Teststatistik $T$ berechnet liefert auch immer einen $p$-Wert. Nicht alle statistischen Tests ermöglichen es ein 95% Konfidenzintervall zu berechnen. @fig-ki-00 zeigt ein 95% konfidenzintervall.

![Ein 95% Konfidenzintervall. Der Punkt in der Mitte entspricht dem Unterschied oder Effekt $\Delta$.](images/ci-00.png){#fig-ki-00 fig-align="center" width="70%"}

[Mit **p-Werten** haben wir Wahrscheinlichkeitsaussagen und damit über die **Signifikanz**. Damit haben wir noch keine Aussage über die **Relevanz** des beobachtenten Effekts.]{.aside}

Mit der Teststatistik $T$ und dem damit verbundenen $p$-Wert haben wir uns *Wahrscheinlichkeiten* angeschaut und erhalten eine *Wahrscheinlichkeitsaussage*. Eine Wahrscheinlichkeitsaussage sagt aber nichts über den Effekt $\Delta$ aus. Also wie groß ist der mittlere Sprung*unterschied* zwischen Hunde- und Katzenflöhen. Eine nährere betrachtung von dem Effekt in der Statistik findest du in @sec-effect.

Die Idee von 95% Kondifenzintervallen ist es jetzt den Effekt mit der Wahrscheinlichkeitsaussage zusammenzubringen und beides in einer *Visualisierung* zu kombinieren. Im Folgenden sehen wir die vereinfachte Formel für das 95% Konfidenzintervall eines t-Tests.

$$
\left[
(\bar{y}_1-\bar{y}_2) - 
T_{\alpha = 5\%} \cdot \frac {s_p}{\sqrt{n}}; \;
(\bar{y}_1-\bar{y}_2) + 
T_{\alpha = 5\%} \cdot \frac {s_p}{\sqrt{n}};
\right]
$$

Die Formel ist ein wenig komplex, aber im Prinzip einfach. Der linke und der rechte Teil neben dem Semikolon sind fast gleich, bis auf das Plus- und Minuszeichen. @fig-ki-01 visualisert die Formel einmal. Wir sehen Folgendes in der Formel und dann in der entsprechenden Abbildung:

-   $(\bar{y}_{1}-\bar{y}_{2})$ ist der Effekt $\Delta$. In diesem Fall der Mittelwertsunterschied. Wir finden den Effekt als Punkt in der Mitte des Intervals.
-   $T_{\alpha = 5\%} \cdot \frac {s}{\sqrt{n}}$ ist der Wert, der die Arme des Intervals bildet. Wir vereinfachen die Formel mit $s_p$ für die gepoolte Standardabweichung und $n_g$ für die Fallzahl der beiden Gruppen. Wir nehmen an das beide Gruppen die gleiche Fallzahl $n_1 = n_2$ haben.

![Zusammenhang zwischen der vereinfachten Formel für das 95% Konfidenzintervall und der Visualisierung des 95% Konfidenzintervalls. Der Effektschätzer wird als Punkt in der Mitte des Intervalls dargestellt. Der Effektschäter $\Delta$ kann entweder ein Mittelwertsunterschied sein oder ein Anteilsunterschied. Bei einem Mittelwertsunterschied kann die Nullhypothese abgelehnt werden, wenn die 0 nicht im Konfidenzintervall ist; bei einem Anteilsunterschied wenn die 1 nicht im Konfidenzintervall ist. Die Arme werden länger oder kürzer je nachdem wie sich die statistischen Maßzahlen $s$ und $n$ verändern.](images/ci-01.png){#fig-ki-01 fig-align="center" width="100%"}

[Die Funktion `factor()` in R erlaubt es dir die Level eines Faktors zu sortieren und so festzulegen ob Level `cat` minus Level `dog` oder umgekehrt von R gerechnet wird.]{.aside}

Wir können eine biologische Relevanz definieren, dadurch das ein 95% Konfidenzintervall die Wahrscheinlichkeitsaussage über die Signifkanz, daher ob die Nullhypothese abgelehnt werden kann, mit dem Effekt zusammenbringt. Wo die Signifikanzschwelle klar definiert ist, hängt die Relevanzschwelle von der wissenschaftlichen Fragestellung und weiteren externen Faktoren ab. Die Signifikanzschwelle liegt bei 0, wenn wir Mittelwerte miteinander vergleichen und bei 1, wenn wir Anteile vergleichen. @fig-relevanz zeigt fünf 95% Konfidenzintervalle (a-e), die sich anhand der Signifikanz und Relevanz unterscheiden. Bei der Relevanz ist es wichtig zu wissen in welche *Richtung* der Effekt gehen soll. Erwarten wir einen positiven Effekt wenn wir die Differenz der beiden Gruppen bilden oder einen negativen Effekt?

![Verschiedene signifikante und relevante Konfidenzintervalle: (a) nicht signifikant und nicht relevant; (b) signifikant und nicht relevant; (c) signifikant und relevant; (d) signifikant und nicht relevant, der Effekt ist zu klein; (e) signifikant und potenziell relevant, Effekt zeigt in eine unerwartete Richtung gegeben der Relevanzschwelle.](images/ci-02.png){#fig-relevanz fig-align="center"}

Wir wollen uns nun einmal anschauen, wie sich ein 95% Konfidenzintervall berechnet. Wir nehmen dafür die vereinfachte Formel und setzen die berechneten statistischen Maßzahlen ein. In der Anwendung werden wir die Konfidenzintervalle nicht selber berechnen. Wenn ein statistisches Verfahren konfidenzintervalle berechnen kann, dann liefert die entsprechende Funktion in R das Konfidenzintervall.

Es ergibt sich Folgende ausgefüllte, vereinfachte Formel für das 95% Konfidenzintervalls eines t-Tests für das Beispiel des Sprungweitenunterschieds \[cm\] zwischen Hunde- und Katzenflöhen.

::: column-margin
![](images/angel_01.png){fig-align="center" width="50%"}

Wir nutzen hier eine **vereinfachte Formel** für das Konfidenzintervall um das Konzept zu verstehen. Später berechnen wir das Konfidenzintervall in R.
:::

$$
\left[
(`r mean_cat`-`r mean_dog`) - 
`r t_k` \cdot \frac {`r sd_p`}{\sqrt{4}}; \;
(`r mean_cat`-`r mean_dog`) + 
`r t_k` \cdot \frac {`r sd_p`}{\sqrt{4}};
\right]
$$

mit

-   $\bar{y}_{cat} = `r mean_cat`$ dem Mittelwert für die Gruppe *cat*.
-   $\bar{y}_{dog} = `r mean_dog`$ dem Mittelwert für die Gruppe *dog*.
-   $T_{\alpha = 5\%} = `r t_k`$ dem kritischen Wert.
-   $s_p = `r sd_p`$ der gepoolten Standardabweichung mit $s_p = \tfrac{`r sd_cat` + `r sd_dog`}{2}$.
-   $n_g = 4$ der Gruppengröße der Gruppe A und B. Wir nehmen an beide Gruppen sind gleich groß.

Lösen wir die Formel auf, so ergibt sich folgendes 95% Konfidenzintervall des Mittelwertsunterschiedes der Hunde- und Katzenflöhe.

$$[0.39; 2.20]$$

Wir können sagen, dass mit 95% Wahrscheinlichkeit das Konfidenzintervall den wahren Effektunterschied $\Delta$ überdeckt. Oder etwas mehr in Prosa, dass wir eine Sprungweiten*unterschied* von 0.39 cm bis 2.20 cm zwischen Hunde- und Katzenflöhen erwarten würden.

Die Entscheidung gegen die Nullhypothese bei einem Mittelwertsunterschied erfolgt bei einem 95% Konfidenzintervall danach ob die Null mit im Konfidenzintervall liegt oder nicht. In dem Interval $[0.39; 2.20]$ ist die Null nicht enthalten, also können wir die Nullhypothese ablehnen. Es ist mit einem Unterschied zwischen den mittleren Sprungweiten von Hunde- und Katzenflöhen auszugehen.

In unserem Beispiel, könnten wir die Relevanzschwelle für den mittleren Sprungweitenunterschied zwischen Hund- und Katzenflöhen auf 2 cm setzen. In dem Fall würden wir entscheiden, dass der mittlere Sprungweitenunterschied nicht relevant ist, da die 2 cm im Konfidenzintervall enthalten sind. Was wäre wenn wir die Relevanzschwelle auf 4 cm setzen? Dann wäre zwar die Relevanzschwelle nicht mehr im Konfidenzintervall, aber wir hätten Fall (d) in der @fig-relevanz vorliegen. Der Effekt ist einfach zu klein, dass der Effekt relevant sein könnte.

::: callout-important
## Entscheidung mit dem 95% Konfidenzintervall

Bei der Entscheidung mit dem 95% Konfidenzinterval müssen wir zwei Fälle unterscheiden.

(1) Entweder schauen wir uns einen Mittelwertsunterschied ($\Delta_{y_1-y_2}$) an, dann können wir die Nullhypothese (H$_0$) *nicht* ablehnen, wenn die **0** im 95% Konfidenzinterval ist.

(2) Oder wir schauen uns einen Anteilsunterschied ($\Delta_{y_1/y_2}$) an, dann können wir die Nullhypothese (H$_0$) *nicht* ablehnen, wenn die **1** im 95% Konfidenzinterval ist.
:::

## Auswirkung des Effektes, der Streuung und der Fallzahl

Wir wollen einmal den Zusammenhang zwischen dem Effekt $\Delta$, der Streuung als Standardabweichung $s$ und Fallzahl $n$ uns näher anschauen. Wir können die Formel des t-Tests wie folgt vereinfachen.

$$
T_{calc}=\cfrac{\bar{y}_1-\bar{y}_1}{s_{p} \cdot \sqrt{2/n_g}}
$$

Für die Betrachtung der Zusammenhänge wandeln wir $\sqrt{2/n_g}$ in $1/n$ um. Dadurch wandert die Fallzahl $n$ in den Zähler. Die Standardabweichung verallgemeinern wir zu $s$ und damit allgemein zur Streuung. Abschließend betrachten wir $\bar{y}_A-\bar{y}_B$ als den Effekt $\Delta$. Es ergibt sich folgende vereinfachte Formel.

$$
T_{calc} = \cfrac{\Delta \cdot n}{s}
$$

Wir können uns nun die Frage stellen, wie ändert sich die Teststatistik $T_{calc}$ in Abhängigkeit vom Effekt $\Delta$, der Fallzahl $n$ und der Streuung $s$ in den Daten. Die @tbl-t-und-p zeigt die Zusammenhänge auf. Die Aussagen in der Tabelle lassen sich generalisieren. So bedeutet eine steigende Fallzahl meist mehr signifikante Ergebnisse. Eine stiegende Streuung reduziert die Signifikanz eines Vergleichs. Ein Ansteigen des Effektes führt zu mehr signifikanten Ergebnissen. Ebenso verschiebt eine Veränderung des Effekt das Konfidenzintervall, eine Erhöhung der Streuung macht das konfidenzintervall breiter, eine sinkende Streeung macht das konfidenzintervall schmaller. bei der Fallzahl verhält es sich umgekehrt. Eine Erhöhung der Fallzahl macht das Konfidenzintervall schmaller und eine sinkende Fallzahl das Konfidenzintervall breiter.

::: column-page
|                   | $\boldsymbol{T_{calc}}$ | $\boldsymbol{Pr(\geq T_{calc}|H_0)}$ | $KI_{1-\alpha}$ |                     | $\boldsymbol{T_{calc}}$ | $\boldsymbol{Pr(\geq T_{calc}|H_0)}$ | $KI_{1-\alpha}$ |
|:-----------------:|:-----------------------:|:------------------------------------:|-----------------|:-------------------:|:-----------------------:|:------------------------------------:|-----------------|
| $\Delta \uparrow$ |         steigt          |                sinkt                 | verschoben      | $\Delta \downarrow$ |          sinkt          |                steigt                | verschoben      |
|   $s \uparrow$    |          sinkt          |                steigt                | breiter         |   $s \downarrow$    |         steigt          |                sinkt                 | schmaller       |
|   $n \uparrow$    |         steigt          |                sinkt                 | schmaller       |   $n \downarrow$    |          sinkt          |                steigt                | breiter         |

: Zusammenhang von der Teststatistik $T_{calc}$ und dem p-Wert $Pr(\geq T_{calc}|H_0)$ sowie dem $KI_{1-\alpha}$ in Abhängigkeit vom Effekt $\Delta$, der Fallzahl $n$ und der Streuung $s$. {#tbl-t-und-p}
:::

## Testtheorie

::: callout-tip
## Prinzip der statistischen Testentscheidung - H$_0$ und H$_A$

Du findest auf YouTube [Prinzip der statistischen Testentscheidung - $H_0$ und $H_A$](https://youtu.be/ttkGnexSXHw) als Video Reihe. Ich werde zwar alles nochmal hier als Text aufschreiben, aber manchmal ist das Sehen und Hören dann einfacher.
:::

Vielleicht ist die Idee der Testentscheidung besser mit der Analogie des Rauchmelders zu verstehen. Wir nehmen an, dass der Rauchmelder der statistische Test ist. Der Rauchmelder hängt an der Decke und soll entscheiden, ob es brennt oder nicht. Daher muss der Rauchmelder entscheiden, die Nullhypothese "kein Feuer" abzulehnen oder die Hypothese "kein Feuer" beizubehalten.

```{=tex}
\begin{align*} 
H_0&: \mbox{kein Feuer im Haus} \\  
H_A&: \mbox{Feuer im Haus} \\   
\end{align*}
```
Wir können jetzt den Rauchmelder einstellen, so dass der Rauchmelder bei einer Kerze losgeht oder erst bei einem Stubenbrand. Wie sensibel auf Rauch wollen wir den Rauchmelder einstellen? Soll der Rauchmelder sofort die Nullhypothese ablehnen? Wenn also nur eine Kerze brennt. Soll also der $\alpha$-Fehler groß sein? Das wäre nicht sehr sinnvoll. Due Feuerwehr würde schon bei einer Kerze kommen oder wenn wir mal was anbrennen. Wir dürfen also den $\alpha$-Fehler nicht zu groß einstellen.

Intuitiv würde man meinen, ein sehr kleiner $\alpha$-Fehler nun sinnvoll sei. Wenn wir aber den Rauchmelder sehr unsensibel einstellen, also der Rauchmelder erst bei sehr viel Rauch die Nullhypothese ablehnt, könnte das Haus schon unrettbar in Flammen stehen. Dieser Fehler, Haus steht in Flammen und der Rauchmelder geht nicht, wird als $\beta$-Fehler bezeichnet. Wie du siehst hängen die beiden Fehler miteinander zusammen. Wichtig hierbei ist immmer, dass wir uns einen Zustand vorstellen, das Haus brent nicht ($H_0$ ist wahr) oder das Haus brennt nicht ($H_A$ ist wahr). An diesem Zustand entscheiden wir dann, wie hoch der Fehler jeweils sein soll diesen Zustand zu übersehen.

::: callout-note
## Der $\alpha$-Fehler und $\beta$-Fehler als Rauchmelderanalogie

Häufig verwirrt die etwas theoretische Herangehensweise an den $\alpha$-Fehler und $\beta$-Fehler. Wir versuchen hier nochmal die Analogie eines Rauchmelders und dem Feuer im Haus.

![Andere Art der Darstellung des $\alpha$-Fehlers als *Alarm without fire* und dem $\beta$-Fehler als *Fire without alarm*. Je nachdem wie empfindlich wir den Alarm des Rauchmelders (den statistischen Test) über das $\alpha$ einstellen, desto mehr Alarm bekommen wir ohne das ein Effekt vorhanden wäre. Drehen wir den Alarm zu niedrig, dann kriegen wir kein Feuer mehr angezeigt, den $\beta$-Fehler.](images/t-verteilung_05.png){#fig-teststatistik-05 fig-align="center" width="80%"}

-   $\boldsymbol{\alpha}$**-Fehler**: Alarm without fire. Der statistische Test schlägt Alarm und wir sollen die $H_0$ ablehnen, obwohl die $H_0$ in Wahrheit gilt und kein Effekt vorhanden ist.
-   $\boldsymbol{\beta}$**-Fehler**: Fire without alarm. Der statistische Test schlägt *nicht* an und wir sollen die $H_0$ beibehalten, obwohl die $H_0$ in Wahrheit *nicht* gilt und *ein* Effekt vorhanden ist.
:::

Wie sieht nun die Lösung, erstmal für unseren Rauchmelder, aus? Wir müssen Grenzen für den $\alpha$ und $\beta$-Fehler festlegen.

[**Wir setzen den** $\alpha$-Fehler auf 5%.]{.aside}

-   Wir setzen den $\alpha$-Fehler auf 5%. Somit haben wir in 1 von 20 Fällen das Problem, dass uns der Rauchmelder angeht obwohl gar kein Feuer da ist. Wir lehnen die Nullhypothese ab, obwohl die Nullhypothese gilt.

[**Wir setzen den** $\beta$-Fehler auf 20%.]{.aside}

-   Auf der anderen Seite setzen wir den $\beta$-Fehler auf 20%. Damit brennt uns die Bude in 1 von 5 Fällen ab ohne das der Rauchmelder einen Pieps von sich gibt. Wir behalten die Nullhypothese bei, obwohl die Nullhypothese nicht gilt.

Nachdem wir uns die Testentscheidung mit der Analogie des Rauchmelders angesehen haben, wollen wir uns wieder der Statistik zuwenden. Betrachten wir das Problem nochmal von der theoretischen Seite mit den statistischen Fachbegriffen.

Soweit haben wir es als gegeben angesehen, dass wir eine Testentscheidung durchführen. Entweder mit der Teststatistik, dem $p$-Wert oder dem 95% Konfidenzintervall. Immer wenn wir eine Entscheidung treffen, können wir auch immer eine falsche Entscheidung treffen. Wie wir wissen hängt die berechnete Teststatistik $T_{calc}$ nicht nur vom Effekt $\Delta$ ab sondern auch von der Streuung $s$ und der Fallzahl $n$. Auch können wir den falschen Test wählen oder Fehler im Design des Experiments gemacht haben. Schlussendlich gibt es viele Dinge, die unsere *simple* mathematischen Formeln beeinflussen können, die wir nicht kennen. Ein frequentistischer Hypothesentest gibt immer nur eine Aussage über die Nullhypothese wieder. Also ob wir die Nullhypothese ablehnen können oder nicht.

@fig-teststatistik-03 zeigt die theoretische Verteilung der Nullyhypothese und der Alternativehypothese. Wenn die beiden Verteilungen sehr nahe beieinander sind, wird es schwer für den statistischen Test die Hypothesen klar voneinander zu trennen. Die Verteilungen überlappen. Es gibt einen sehr kleinen Unterschied in den Sprungweiten zwischen Hunde- und Katzenflöhen.

::: column-page
![Darstellung der Null- und Alternativehypothese. Mit steigendem $T_{calc}$ wird die Wahrscheinlichkeit für die $H_0$ immer kleiner. Leider ist uns nichts über $H_A$ und deren Lage bekannt. Sollte die $H_A$ Verteilung zu weit nach links ragen, könnten wir die $H_0$ beibehalten, obwohl die $H_A$ gilt.](images/t-verteilung_03.png){#fig-teststatistik-03 fig-align="center"}
:::

[**Achtung** In der Regression wird uns auch wieder das $\beta$ als Symbol begegnen. In der *statistischen Testtheorie* ist das $\beta$ ein Fehler; in der Regression ist das $\beta$ ein Koeffizient der Regression. Hier ist der Kontext wichtig.]{.aside}

Wir können daher bei statistischen Testen zwei Arten von Fehlern machen. Zum einen den $\alpha$ Fehler oder auch Type I Fehler genannt. Zum anderen den $\beta$ Fehler oder auch Type II Fehler genannt. Die Grundidee basiert darauf, dass wir eine Testentscheidung gegen die Nullhypothese machen. Diese Entscheidung kann richtig sein, da in Wirklichkeit die Nullhypothese gilt oder aber falsch sein, da in Wirklichkeit die Nullhypothese nicht gilt. In @fig-teststatistik-04 wird der Zusammenhang in einer 2x2 Tafel veranschaulicht.

::: column-page
![Zusammenhang zwischen der Testentscheidung gegen die $H_0$ Hypothese sowie dem Beibehalten der $H_0$ Hypothese und der unbekannten Wahrheit in der die $H_0$ falsch sein kann oder die $H_0$ wahr sein kann. Wir können mit unserer Testenstscheidung richtig liegen oder falsch. Mit welcher Wahrscheinlichkeit geben der $\alpha$ Fehler und $\beta$ Fehler wieder. Unten rechts ist der Zusammenhang zu der @fig-teststatistik-03 gezeigt.](images/t-verteilung_04.png){#fig-teststatistik-04 fig-align="center"}
:::

::: column-margin
Die Diskussion über den $p$-Wert und dem Vergleich mit dem $\alpha$-Fehler wird in der Statistik seit 2019 verstärkt diskutiert [@wasserstein2019moving]. Das Nullritual wird schon lamge kritisiert [@gigerenzer2004null]. Siehe dazu auch [The American Statistician, Volume 73, Issue sup1 (2019)](https://www.tandfonline.com/toc/utas20/73/sup1).
:::

Beide Fehler sind Kulturkonstanten. Das heißt, dass sich diese Zahlen von 5% und 20% so ergeben haben. Es gibt keinen rationalen Grund diese Zahlen so zu nehmen. Man kann eigentlich sagen, dass die 5% und die 20% eher einem Zufall entsprungen sind, als einer tieferen Rationalen. Wir behalten diese beiden Zahlen bei aus den beiden schlechtesten Gründe überhaupt: i) es wurde schon immer so gemacht und ii) viele machen es so.

Eine weitere wichtige statistische Maßzahl im Kontext der Testtheorie ist die $Power$ oder auch $1-\beta$. Die $Power$ ist die Gegenwahrscheinlichkeit von dem $\beta$-Fehler. In der Analogie des Rauchmelders wäre die $Power$ daher *Alarm with fire*. Das heißt, wie wahrscheinlich ist es einen wahren Effekt - also einen Unterschied - mit dem statistischen Test auch zu finden. Oder anders herum, wenn wir wüssten, dass die Hunde- und Katzenflöhe unterschiedliche weit springen, mit welcher Wahrscheinlichkeit würde diesen Unterschied ein statistsicher Test auch finden? Mit eben der $Power$, also gut 80%. @tbl-power zeigt die Abhängigkeit der $Power$ vom Effekt $\Delta$, der Streuung $s$ und der Fallzahl $n$.

[Die $Power$ ist eine Wahrscheinlichkeit und sagt *nichts* über die Relevanz des Effektes aus.]{.aside}

|                   | $\boldsymbol{Power (1-\beta)}$ |                     | $\boldsymbol{Power (1-\beta)}$ |
|:-----------------:|:------------------------------:|:-------------------:|:------------------------------:|
| $\Delta \uparrow$ |             steigt             | $\Delta \downarrow$ |             sinkt              |
|   $s \uparrow$    |             sinkt              |   $s \downarrow$    |             steigt             |
|   $n \uparrow$    |             steigt             |   $n \downarrow$    |             sinkt              |

: Abhängigkeit der $Power (1-\beta)$ vom Effekt $\Delta$, der Fallzahl $n$ und der Streuung $s$. Die $Power$ ist eine Wahrscheinlichkeit und sagt nichts über die Relevanz des Effektes aus. {#tbl-power}

### Einseitig oder zweiseitig?

Manchmal kommt die Frage auf, ob wir *einseitig* oder *zweiseitig* einen statistischen Test durchführen wollen. Beim Fall des zweiseitigen Testens verteilen wir den $\alpha$-Fehler auf beide Seiten der Testverteilung mit jeweils $\cfrac{\alpha}{2}$. In dem Fall des einseitigen Tests liegt der gesamte $\alpha$-Fehler auf der rechten *oder* linken Seite der Testverteilung. In @fig-teststatistik-02 wird der Zusammenhang beispielhaft an der t-Verteilung gezeigt.

::: column-page
![Zusammenhang zwischen dem einseitigen und zweiseitigen Testen. Im Falle des zweiseitigen Testens teilen wir den $\alpha$-Fehler auf beide Seiten der beispielhaften t-Verteilung auf. Im Falle des einseitigen Testen leigt der gesamte $\alpha$-Fehler auf der rechten *oder* der linken Seite der t-Verteilung.](images/t-verteilung_02.png){#fig-teststatistik-02 fig-align="center"}
:::

[In der Anwendung testen wir immer zweiseitig.]{.aside}

In der Anwendung testen wir immer zweiseitig. Der Grund ist, dass das Vorzeichen von der Teststatik davon abhängt, welche der beiden Gruppen den größeren Mittelwert hat. Da wir die Mittelwerte vor der Auswertung nicht kennen, können wir auch nicht sagen in welche Richtung der Effekt und damit die Teststatistik laufen wird.

Es gibt theoretisch Gründe, die für ein einseitiges Testen unter bestimmten Bedingungen sprechen, aber wir nutzen in der Anwendung nur das zweiseite Testen. Wir müssen dazu in R auch nichts weiter angeben. Ein durchgeführter statistischer Test in R testet automatisch immer zweiseitig.

::: callout-note
## Einseitig oder zweiseitig im Spiegel der Regulierungsbehörden

In den [allgemeinen Methoden des IQWiG](https://www.iqwig.de/ueber-uns/methoden/methodenpapier/), einer Regulierungsbehörde für klinische Studien, wird grundsätzlich das zweiseitige Testen empfohlen. Wenn einseitig getestet werden sollte, so soll das $\alpha$-Niveau halbiert werden. Was wiederum das gleiche wäre wie zweiseitiges Testen - nur mit mehr Arbeit.

*Zur besseren Vergleichbarkeit mit 2-seitigen statistischen Verfahren wird in einigen Guidelines für klinische Studien eine Halbierung des üblichen Signifikanzniveaus von 5 % auf 2,5 % gefordert.* -- [Allgemeine Methoden Version 6.1 vom 24.01.2022, p. 180](https://www.iqwig.de/methoden/allgemeine-methoden-v6-1.pdf)
:::

### Adjustierung für multiple Vergleiche {#sec-statistisches-testen-alpha-adjust}

[Das simultane Testen von mehreren Hypothesen führt zu einer $\alpha$-Fehler Inflation]{.aside}

Im @sec-posthoc werden wir mehrere multiple Gruppenvergleiche durchführen. Das heißt, wir wollen nicht nur die Sprungweite von Hunde- und Katzenflöhen miteinander vergleichen, sondern auch die Sprungweite von Hunde- und Fuchsflöhen sowie Katzen- und Fuchsflöhen. Wir würden also $k = 3$ t-Tests für die Mittelwertsvergleiche rechnen.

Dieses mehrfache Testen führt aber zu einer Inflation des $\alpha$-Fehlers oder auch Alphafehler-Kumulierung genannt. Daher ist die Wahrscheinlichkeit, dass mindestens eine Nullhypothese fälschlicherweise abgelehnt wird, nicht mehr durch das Signifikanzniveau $\alpha$ kontrolliert, sondern kann sehr groß werden.

Gehen wir von einer Situation mit $k$ Null- und Alternativhypothesen aus. Wir rechnen also $k$ statistische Tests und alle Nullhypothesen werden zum lokalen Niveau $\alpha_{local} = 0.05$ getestet. Im Weiteren nehmen wir an, dass tatsächlich alle Nullhypothesen gültig sind. Wir rechnen also $k$ mal einen t-Test und machen jedes mal einen *5% Fehler Alarm zu geben, obwohl kein Effekt vorhanden ist*.

Die Wahrscheinlichkeit für einen einzelnen Test korrekterweise $H_0$ abzulehnen ist $(1 − \alpha)$. Da die $k$ Tests unabhängig sind, ist die Wahrscheinlichkeit alle $k$ Tests korrekterweise abzulehnen $(1 − \alpha)^k$. Somit ist die Wahrscheinlichkeit, dass mindestens eine Nullhypothese fälschlicherweise abgelehnt wird $1-(1-\alpha)^k$. In der @tbl-mult-alpha wird dieser Zusammenhang nochmal mit Zahlen für verschiedene $k$ deutlich.

| Anzahl Test $\boldsymbol{k}$ | $\boldsymbol{1-(1-\alpha)^k}$ |
|:----------------------------:|:-----------------------------:|
|              1               |             0.05              |
|              2               |             0.10              |
|              10              |             0.40              |
|              50              |             0.92              |

: Inflation des $\alpha$-Fehlers. Wenn 50 Hypothesen getestet werden, ist die Wahrscheinlichkeit *mindestens* eine falsche Testentscheidung zu treffen fast sicher. {#tbl-mult-alpha}

Aus @tbl-mult-null können wir entnehmen, dass wenn 100 Hypothesen getestet werden, werden 5 Hypothesen im Schnitt fälschlicherweise abgelehnt. Die @tbl-mult-null ist nochmal die Umkehrung der vorherigen @tbl-mult-alpha.

| Anzahl Test $\boldsymbol{k}$ | $\boldsymbol{\alpha \cdot k}$ |
|:----------------------------:|:-----------------------------:|
|              1               |             0.05              |
|              20              |               1               |
|             100              |               5               |
|             200              |              10               |

: Inflation des $\alpha$-Fehlers. Erwartete Anzahl fälschlich abgelehnter Nullhypothesen abhängig von der Anzahl der durchgeführten Tests {#tbl-mult-null}

Nachdem wir verstanden haben, dass wiederholtes statistisches Testen irgendwann immer ein signifikantes Ergebnis produziert, müssen wir für diese $\alpha$ Inflation unsere Ergebnisse adjustieren. Ich folgenden stelle ich verschiedene Adjustierungsverfahren vor.

#### Bonferroni Korrektur

Die Bonferroni Korrektur ist die am weitesten verbreitete Methode zur $\alpha$ Adjustierung, da die Bonferroni Korrektur einfach durchzuführen ist. Damit die Wahrscheinlichkeit, dass mindestens eine Nullhypothese fälschlicherweise abgelehnt wird beim simultanen Testen von $k$ Hypothesen durch das globale (und multiple) Signifikanzniveau $\alpha = 5\%$ kontrolliert ist, werden die Einzelhypothesen zum lokalen Signifikanzniveau $\alpha_{local} = \tfrac{\alpha_{5\%}}{k}$ getestet.

Dabei ist das Problem der Bonferroni Korrektur, dass die Korrektur sehr konservativ ist. Wir meinen damit, dass das tatsächliche globale (und multiple) $\sum\alpha_{local}$ Niveau liegt deutlich unter $\alpha_{5\%}$ und somit werden die Nullhypothesen zu oft beibehalten.

::: callout-important
## Adjustierung des $\boldsymbol{\alpha}$-Fehlers

-   Das globale $\alpha$-Level wird durch die Anzahl $k$ an durchgeführten statistischen Tests geteilt.
-   $\alpha_{local} = \tfrac{\alpha}{k}$ für die Entscheidung $p < \alpha_{local}$
:::

::: callout-important
## Adjustierung des $\boldsymbol{p}$-Wertes

-   Die p-Werte werden mit der Anzahl an durchgeführten statistischen Tests $k$ multipliziert.
-   $p_{adjust} = p_{raw} \cdot k$ mit $k$ gleich Anzahl der Vergleiche.
-   wenn $p_{adjust} > 1$, wird $p_{adjust}$ gleich 1 gesetzt, da $p_{adjust}$ eine Wahrscheinlichkeitist.
:::

#### Benjamini--Hochberg

*Work in progress*

http://www.biostathandbook.com/multiplecomparisons.html

## Referenzen {.unnumbered}

```{r echo = FALSE}
pacman::p_load(tidyverse, readxl, knitr, kableExtra, openxlsx)
```

# Von vielen Flöhen auf Hunden und Katzen {#sec-example-5}

Wir schauen uns in diesem Beispiel wiederum nur zwei Tierarten an: Hunde und Katzen. Auf diesen Tierarten messen wir wieder die Sprunglänge in \[cm\] von jeweils 400 Tieren. Im Vergleich zu dem vorherigen Beispiel erweitern wir die Daten um eine Spalte `jump_weight` in \[mg\] sowie `sex` \[male, female\]. Bei Versuch wurde noch in der Variable `hatch_time` gemessen, wie lange die Flöhe in Stunden zum Schlümpfen brauchen. Es ergibt sich folgende @tbl-example-5 mit den ersten zehn Beobachtungen und die dazugehörige @fig-example-5.

```{r }
#| message: false
#| echo: false

set.seed(20220812)
data_tbl <- expand_grid(animal = 1:2, sex = 1:2, rep = 1:100) %>% 
  mutate(weight = round(5 + 2 * sex + rnorm(n(), 0, 1), 2),
         jump_length = round(8 + 2.5 * animal + 5 * sex + rnorm(n(), 0, 2), 2),
         animal = factor(animal, labels = c("cat", "dog")),
         sex = factor(sex, labels = c("male", "female")),
         hatch_time = round(rlnorm(n(), 5, 1), 2)) %>% 
  select(-rep)

write.csv2(data_tbl, "data/flea_dog_cat_length_weight.csv", row.names = FALSE)
write.xlsx(data_tbl, "data/flea_dog_cat_length_weight.xlsx", rowNames = FALSE)
```

```{r}
#| message: false
#| echo: false
#| tbl-cap: Sprunglängen [cm], Gewichte [mg], Geschecht [sex] und Schlüpfzeit [h] für Hunde- und Katzenflöhe.
#| label: tbl-example-5

data_tbl %>%
  head(10) %>% 
  kable(align = "c", "pipe")
```

[Über die explorative Datenanalyse erfährst du mehr im @sec-eda-ggplot]{.aside}

Die Datentabelle ist in dieser Form schon fast nicht mehr überschaubar. Daher hilft hier die explorative Datenanalyse weiter. Wir schauen uns daher die Daten einmal als einen Scatterplot in @fig-example-5 an. Wir sehen hier, dass wir das mit dem Gewicht \[mg\] der Flöhe auch die Sprungweite in \[cm\] steigt.

```{r}
#| message: false
#| echo: false
#| fig-align: center
#| fig-height: 4
#| fig-width: 6
#| fig-cap: Scatterplot der Sprunglängen [cm] und Gewichte [mg] für Hunde- und Katzenflöhe.
#| label: fig-example-5

ggplot(data_tbl, aes(weight, jump_length)) + 
  geom_point() +
  labs(x = "Gewicht [mg]", y = "Sprungweite [cm]") +
  theme_bw() 
```

::: callout-tip
## Datei für von vielen Flöhen auf Hunden und Katzen

Du findest die Datei `flea_dog_cat_length_weight.xlsx` auf GitHub [jkruppa.github.io/data/](https://github.com/jkruppa/jkruppa.github.io/tree/master/data) als Excel oder auch als CSV.
:::

```{r echo = FALSE}
pacman::p_load(tidyverse, readxl, knitr, kableExtra, gghalves,
               ggdist, patchwork, see, ggmosaic, ggsignif,
               latex2exp)
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", 
                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
```

# Statistisches Modellieren {#sec-stat-model-preface}

*Letzte Änderung am `r format(fs::file_info("stat-modeling-preface.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*

> *"Sei bereit, sei bereit, sonst kommst du nicht sehr weit; Dann tut's dir später leid, drum sei bereit; sei bereit sei bereit, sei clever und gescheit; so bist du gegen jeden Test gefeit" --- Jan Delay Ziegen Song (sei Bereit)*

------------------------------------------------------------------------

![](images/caution.png){fig-align="center" width="50%"}

**Dieses Kapitel wird ist eine Baustelle und wird es vermutlich auch über das Jahr 2024 bleiben. Aktuell weiß ich nämlich noch nicht, wo ich mit dem Kapitel hin will und wo es stehen sollte. Daher können Teile des Codes und des Textes kurzfristig keinen Sinn ergeben oder nicht funktional sein. Es ist geplant eine fertige Version noch 2024 vorliegen zu haben.**

------------------------------------------------------------------------

Betrachten wir folgendes simples Modell mit einem Outcome $y$ und einer Einflussvariable $x$.

$$
{\Huge y \sim x}
$$

mit

-   $y$ als Outcome oder Messwert, welches einer Verteilungsfamilie zugehörig ist.
-   $x$ als Einflussvariable, welche kontinuierlich oder kategoriell ist.

## Verteilungsfamilien

### Gaussian

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-scatter-modeling-R-01
#| fig-align: center
#| fig-height: 6
#| fig-width: 15
#| fig-cap: "Visueller Zusammenhang eines kontinuierlichen Outcomes ($y$) aus einer Normalverteilung (*Gaussian*) im Verhätnis zu verschiedenen Skalen der Einflussvariable ($x$). Ein Punkt stellt eine Beobachtung dar. **(A)** $x$ ist kontinuierlich. **(B)** $x$ ist kategoriell mit zwei oder mehr Gruppen. **(C)** $x$ ist kategoriell mit zwei Gruppen. *[Zum Vergrößern anklicken]*"

source("images/R/stat-modeling-preface-01.R")

p11 + p12 + p13 +
  plot_layout(ncol = 3) +
  plot_annotation(tag_levels = 'A')

```

::: callout-note
## Wir mitteln uns die Welt, wie sie uns gefällt...

> "2 x 3 macht 4; Widdewiddewitt; und Drei macht Neune!; Wir machen uns die Welt; Widdewidde wie sie uns gefällt..." --- Hey Pippi Langstrumpf

Wo sind die Barplots hin?

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-scatter-modeling-R-00
#| fig-align: center
#| fig-height: 10
#| fig-width: 15
#| fig-cap: "Visueller Zusammenhang eines gemittelten Outcomes ($y$) aus verschiedenen Verteilung im Verhältnis zu der Einflussvariable ($x$) mit zwei oder mehr Kategorien anhand von Barplots. Hauptsächlich unterscheiden sich die Barplots durch die unterschiedlichen Einheiten auf der $y$-Achse. Die Fehlerbalken stellen den Standardfehler (*SE*) dar. **(A)** Mittler Ertrag [t/ha]. **(B)** Mittlerer Befahll [Anzahl/Parzelle]. **(C)** Mittlere Note [Likert-Skala] **(D)** Mittlerer Anteil [%] **(E)** Mittlerer Anteil infiziert (%). *[Zum Vergrößern anklicken]*"

source("images/R/stat-modeling-preface-00.R")

p01 + p02 + p04 + p03 + p05 +
  plot_layout(ncol = 3) +
  plot_annotation(tag_levels = 'A')

```
:::

### Poisson

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-scatter-modeling-R-02
#| fig-align: center
#| fig-height: 6
#| fig-width: 15
#| fig-cap: "Visueller Zusammenhang eines kontinuierlichen Outcomes ($y$) aus einer Poissonverteilung zu Zähldaten im Verhätnis zu verschiedenen Skalen der Einflussvariable ($x$). Ein Punkt stellt eine Beobachtung dar. **(A)** $x$ ist kontinuierlich. **(B)** $x$ ist kategoriell mit zwei oder mehr Gruppen. **(C)** $x$ ist kategoriell mit zwei Gruppen. *[Zum Vergrößern anklicken]*"

source("images/R/stat-modeling-preface-02.R")

p21 + p22 + p23 +
  plot_layout(ncol = 3) +
  plot_annotation(tag_levels = 'A')
```

### Beta

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-scatter-modeling-R-03
#| fig-align: center
#| fig-height: 6
#| fig-width: 15
#| fig-cap: "Visueller Zusammenhang eines kontinuierlichen Outcomes ($y$) aus einer Betaverteilung zu Häufigkeiten im Verhätnis zu verschiedenen Skalen der Einflussvariable ($x$). Ein Punkt stellt eine Beobachtung dar. **(A)** $x$ ist kontinuierlich. **(B)** $x$ ist kategoriell mit zwei oder mehr Gruppen. **(C)** $x$ ist kategoriell mit zwei Gruppen. *[Zum Vergrößern anklicken]*"

source("images/R/stat-modeling-preface-03.R")

p31 + p32 + p33 +
  plot_layout(ncol = 3)
```

### Ordinal

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-scatter-modeling-R-04
#| fig-align: center
#| fig-height: 6
#| fig-width: 15
#| fig-cap: "Visueller Zusammenhang eines geordneten, kategoriellen Outcomes ($y$) aus einer Ordinalverteilung wie Noten auf der Likert-Skala im Verhätnis zu verschiedenen Skalen der Einflussvariable ($x$). Ein Punkt stellt eine Beobachtung dar. **(A)** $x$ ist kontinuierlich. **(B)** $x$ ist kategoriell mit zwei oder mehr Gruppen. **(C)** $x$ ist kategoriell mit zwei Gruppen. *[Zum Vergrößern anklicken]*"


source("images/R/stat-modeling-preface-04.R")

p41 + p42 + p43 +
  plot_layout(ncol = 3)
```

### Binomial

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-scatter-modeling-R-05
#| fig-align: center
#| fig-height: 6
#| fig-width: 15
#| fig-cap: "Visueller Zusammenhang eines kategoriellen, binären Outcomes ($y$) aus einer Binomialverteilung im Verhätnis zu verschiedenen Skalen der Einflussvariable ($x$). Ein Punkt stellt eine Beobachtung dar. **(A)** $x$ ist kontinuierlich. **(B)** $x$ ist kategoriell mit zwei oder mehr Gruppen. **(C)** $x$ ist kategoriell mit zwei Gruppen. *[Zum Vergrößern anklicken]*"

source("images/R/stat-modeling-preface-05.R")

p51 + p52 + p53 +
  plot_layout(ncol = 3)

```

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-scatter-modeling-R-06
#| fig-align: center
#| fig-height: 6
#| fig-width: 15
#| fig-cap: "Visueller Zusammenhang eines kategoriellen, binären Outcomes ($y$) aus einer Binomialverteilung im Verhätnis zu verschiedenen Skalen der Einflussvariable ($x$) modelliert mit einem *Probability model* wie eine normalverteiltes Outcome. Ein Punkt stellt eine Beobachtung dar. **(A)** $x$ ist kontinuierlich. **(B)** $x$ ist kategoriell mit zwei oder mehr Gruppen. **(C)** $x$ ist kategoriell mit zwei Gruppen. *[Zum Vergrößern anklicken]*"

source("images/R/stat-modeling-preface-06.R")

p61 + p62 + p63 +
  plot_layout(ncol = 3)

```

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Ein Kochbuch mit Rezepten aus der Bio Data Science, Biostatistik, Biometrie und Statistik zum selber nachkochen!">

<title>56&nbsp; Logistische Regression – Bio Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./stat-modeling-prob-model.html" rel="next">
<link href="./stat-modeling-multinom.html" rel="prev">
<link href="./cover2024_favi.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-05fe91a66cf75bbbb8c9664867fe5124.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-05a8b96638736df272eeeeef67138371.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="site_libs/tabwid-1.1.3/tabwid.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="56&nbsp; Logistische Regression – Bio Data Science">
<meta property="og:description" content="Ein Kochbuch mit Rezepten der Bio Data Science, Biostatistik, Biometrie und Statistik">
<meta property="og:image" content="https://github.com/jkruppa/jkruppa.github.io/raw/master/cover2024.png">
<meta property="og:site_name" content="Bio Data Science">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-modeling-preface.html">Statistisches Modellieren</a></li><li class="breadcrumb-item"><a href="./stat-modeling-logistic.html"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Logistische Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Seitenleiste umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Suchen" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bio Data Science</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jkruppa/jkruppa.github.io/" title="Quellcode" class="quarto-navigation-tool px-1" aria-label="Quellcode"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Suchen"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Willkommen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./organisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Organisation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Bibliothek</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./forschungsprozess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Forschungsprozess</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./abschlussarbeit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Abschlussarbeit</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./example-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datenbeispiele</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-fleas-dogs-cats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Von Flöhen auf Tieren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-gummi-bears.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Von Gummibärchen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-complex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Von komplexeren Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example-database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Von Datenbanken</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./programing-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Programmieren in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-letters-numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Daten in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Operatoren, Funktionen und Pakete</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Daten einlesen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Daten bearbeiten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-strings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Reguläre Ausdrücke</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-purrr-furrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Ein <code>purrr</code> Cookbook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./programing-quarto-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Quarto und Shiny App</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./eda-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative Datenanalyse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Deskriptive Statistik</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Visualisierung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Verteilung von Daten</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Transformieren von Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Testen von Hypothesen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Die Testentscheidung</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-theorie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Die Testtheorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-effect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Der Effektschätzer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-pretest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Der Pre-Test oder Vortest</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./experimental-design-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Experimentelle Designs</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Versuchsplanung in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Einfache Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Fortgeschrittene Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experimental-design-samplesize.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Fallzahlplanung</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-tests-preface-app.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistische Gruppenvergleiche</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Testen in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Der t-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Die ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-ancova2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Die ANCOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Die repeated / mixed ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anova-manova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Die MANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-utest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Der Wilcoxon-Mann-Whitney-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-kruskal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Der Kruskal-Wallis-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Der Friedman Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-chi-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Der <span class="math inline">\(\mathcal{X}^2\)</span>-Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-anteil-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Der Anteilstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-diagnostic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Der diagnostische Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-trendtest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Der Trendtest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-permutationstest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Der Permutationstest</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-tests-posthoc2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Der Post-hoc Test</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-linear-reg-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grundlagen des Modellierens</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Simple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Multiple lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-quality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Modelgüte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-linear-reg-corr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Korrelation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-outlier.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Ausreißer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-variable-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Variablenselektion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-missing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Fehlende Werte</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Sensitivitätsanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-modeling-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Statistisches Modellieren</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Modellieren in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gaussian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Gaussian Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Poisson Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-beta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Beta Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-multinom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-logistic.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-prob-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-mixed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">58</span>&nbsp; <span class="chapter-title">Lineare gemischte Modelle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">59</span>&nbsp; <span class="chapter-title">Generalized Estimating Equations (GEE)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-non-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">60</span>&nbsp; <span class="chapter-title">Nicht lineare Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-robust-quantile.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">61</span>&nbsp; <span class="chapter-title">Robuste und Quantilesregression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">62</span>&nbsp; <span class="chapter-title">Überlebenszeitanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-noninferiority.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">63</span>&nbsp; <span class="chapter-title">Äquivalenz oder Nichtunterlegenheit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">64</span>&nbsp; <span class="chapter-title">Metaanalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">65</span>&nbsp; <span class="chapter-title">Clusteranalysen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">66</span>&nbsp; <span class="chapter-title">Multivariate Verfahren</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stat-modeling-survey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">67</span>&nbsp; <span class="chapter-title">Fragebogenanalyse</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./time-space-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zeitliche und räumliche Analysen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-pseudo-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">68</span>&nbsp; <span class="chapter-title">Pseudo Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">69</span>&nbsp; <span class="chapter-title">Zeitreihen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time-space-spatial-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">70</span>&nbsp; <span class="chapter-title">Räumliche Daten</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./classification-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Klassifikation oder maschinelles Lernen</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">71</span>&nbsp; <span class="chapter-title">Grundlagen der Klassifikation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">72</span>&nbsp; <span class="chapter-title">Data splitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-pre-processing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">73</span>&nbsp; <span class="chapter-title">Data preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-model-compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">74</span>&nbsp; <span class="chapter-title">Vergleich von Algorithmen</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">75</span>&nbsp; <span class="chapter-title"><span class="math inline">\(k\)</span> nearest neighbor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-randomforest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">76</span>&nbsp; <span class="chapter-title">Decision trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">77</span>&nbsp; <span class="chapter-title">Support vector machines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./classification-neural-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">78</span>&nbsp; <span class="chapter-title">Neural networks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./abspann.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abspann</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Abschnitt umschalten">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./app-spielecke.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">79</span>&nbsp; <span class="chapter-title">Spielecke</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#annahmen-an-die-daten" id="toc-annahmen-an-die-daten" class="nav-link active" data-scroll-target="#annahmen-an-die-daten"><span class="header-section-number">56.1</span> Annahmen an die Daten</a></li>
  <li><a href="#genutzte-r-pakete" id="toc-genutzte-r-pakete" class="nav-link" data-scroll-target="#genutzte-r-pakete"><span class="header-section-number">56.2</span> Genutzte R Pakete</a></li>
  <li><a href="#daten" id="toc-daten" class="nav-link" data-scroll-target="#daten"><span class="header-section-number">56.3</span> Daten</a></li>
  <li><a href="#theoretischer-hintergrund" id="toc-theoretischer-hintergrund" class="nav-link" data-scroll-target="#theoretischer-hintergrund"><span class="header-section-number">56.4</span> Theoretischer Hintergrund</a></li>
  <li><a href="#modellierung" id="toc-modellierung" class="nav-link" data-scroll-target="#modellierung"><span class="header-section-number">56.5</span> Modellierung</a></li>
  <li><a href="#performance-des-modells" id="toc-performance-des-modells" class="nav-link" data-scroll-target="#performance-des-modells"><span class="header-section-number">56.6</span> Performance des Modells</a></li>
  <li><a href="#interpretation-des-modells" id="toc-interpretation-des-modells" class="nav-link" data-scroll-target="#interpretation-des-modells"><span class="header-section-number">56.7</span> Interpretation des Modells</a></li>
  <li><a href="#sec-mult-comp-log-reg" id="toc-sec-mult-comp-log-reg" class="nav-link" data-scroll-target="#sec-mult-comp-log-reg"><span class="header-section-number">56.8</span> Gruppenvergleich</a></li>
  <li><a href="#dichotomisierung" id="toc-dichotomisierung" class="nav-link" data-scroll-target="#dichotomisierung"><span class="header-section-number">56.9</span> Dichotomisierung</a></li>
  <li><a href="#prädiktion" id="toc-prädiktion" class="nav-link" data-scroll-target="#prädiktion"><span class="header-section-number">56.10</span> Prädiktion</a></li>
  <li><a href="#referenzen" id="toc-referenzen" class="nav-link" data-scroll-target="#referenzen">Referenzen</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-logistic.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-logistic.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./stat-modeling-preface.html">Statistisches Modellieren</a></li><li class="breadcrumb-item"><a href="./stat-modeling-logistic.html"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Logistische Regression</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-logistic" class="quarto-section-identifier"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Logistische Regression</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code zeigen</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Gesamten Code verbergen</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Quellcode anzeigen</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><em>Letzte Änderung am 25. March 2024 um 08:38:15</em></p>
<blockquote class="blockquote">
<p><em>“Sometimes I feel like everybody is a sexy baby and I’m a monster on the hill.” — Taylor Swift, Anti-Hero</em></p>
</blockquote>
<p>Die logistische Regression ist <em>die</em> Regression, wenn wir rüber in die Medizin schauen. Wohl in keinem Bereich der Wissenschaften wird so viel eine logistische Regression gerechnet wie in der Humanmedizin, Epidemiologie oder Pharmazie. Wir haben in der logistischen Regression ein <span class="math inline">\(0/1\)</span> Outcome als <span class="math inline">\(y\)</span> vorliegen. Also entweder ist eine Beobachtung erkrankt oder nicht. Meistens beschränkt sich die Betrachtung auf erkrankt (<span class="math inline">\(1\)</span>, ja) oder eben nicht erkrankt (<span class="math inline">\(0\)</span>, nein) bzw. gesund. Wichtig hierbei ist, dass wir eigentlich immer sagen, dass das <em>Schlechte</em> mit <span class="math inline">\(1\)</span> kodiert wird. Wenn du das machst, dann wird dir die Interpretation der Effektschätzer der logistischen Regression leichter fallen.</p>
<p>Gleich zu Beginn dann nochmal wir werden die logistische Regression in den Agrarwissenschaften eher selten sehen. Im Bereich der Pflanzenwissenschaften kommt die logistische Regression kaum bis gar nicht vor. Im Bereich der Tierwissenschaften schon eher, aber dort dann im Bereich der Tiermedizin und eben wieder Erkrankungen.</p>
<p>Wo wir hingegen dann wieder die logistische Regression brauchen, ist bei der Klassifikation oder eben der Vorhersage von einem binären Ereignis. Dafür bietet sich dann die logistische Regression wieder an. Deshalb werden wir am Ende des Kapitels nochmal was zur Klassifikation machen, obwohl das hier eigentlich nur so halb reinpasst. Wenn du nicht Klassifizieren willst, dann lasse den letzten Abschnitt einfach weg.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Weitere Tutorien für die logistische Regression
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Das Tutorium <a href="https://post8000.svmiller.com/lab-scripts/logistic-regression-lab.html#Elsewhere_on_My_Website">Logistic Regression by Steven V. Miller</a> erklärt nochmal die logistische Regression von vorne bis hinten, wie ich es hier nicht in dem Detail kann. Wenn du mehr zu logistischen Regression lesen willst, dann ist es eine wirkliche Empfehlung.</li>
</ul>
</div>
</div>
<section id="annahmen-an-die-daten" class="level2" data-number="56.1">
<h2 data-number="56.1" class="anchored" data-anchor-id="annahmen-an-die-daten"><span class="header-section-number">56.1</span> Annahmen an die Daten</h2>
<p>Unser gemessenes Outcome <span class="math inline">\(y\)</span> folgt einer Binomialverteilung. Damit finden wir im Outcome nur <span class="math inline">\(0\)</span> oder <span class="math inline">\(1\)</span> Werte. Im folgenden Kapitel zu der multiplen logistischen linearen Regression gehen wir davon aus, dass die Daten in der vorliegenden Form <em>ideal</em> sind. Das heißt wir haben weder fehlende Werte vorliegen, noch haben wir mögliche Ausreißer in den Daten. Auch wollen wir keine Variablen selektieren. Wir nehmen alles was wir haben mit ins Modell. Sollte eine oder mehre Bedingungen nicht zutreffen, dann schaue dir einfach die folgenden Kapitel an.</p>
<ul>
<li>Wenn du fehlende Werte in deinen Daten vorliegen hast, dann schaue bitte nochmal in das <a href="stat-modeling-missing.html" class="quarto-xref"><span>Kapitel 49</span></a> zu Imputation von fehlenden Werten.</li>
<li>Wenn du denkst, dass du Ausreißer oder auffällige Werte in deinen Daten hast, dann schaue doch bitte nochmal in das <a href="stat-modeling-outlier.html" class="quarto-xref"><span>Kapitel 47</span></a> zu Ausreißer in den Daten.</li>
<li>Wenn du denkst, dass du zu viele Variablen in deinem Modell hast, dann hilft dir das <a href="stat-modeling-variable-selection.html" class="quarto-xref"><span>Kapitel 48</span></a> bei der Variablenselektion.</li>
</ul>
<p>Daher sieht unser Modell wie folgt aus. Wir haben ein <span class="math inline">\(y\)</span> und <span class="math inline">\(p\)</span>-mal <span class="math inline">\(x\)</span>. Wobei <span class="math inline">\(p\)</span> für die Anzahl an Variablen auf der rechten Seite des Modells steht. Im Weiteren folgt unser <span class="math inline">\(y\)</span> einer Binomailverteilung. Damit finden wir im Outcome nur <span class="math inline">\(0\)</span> oder <span class="math inline">\(1\)</span> Werte. Das ist hier sehr wichtig, denn wir wollen ja eine multiple logistische lineare Regression rechnen. In R nutzen wir dazu die Funktion <code>glm()</code> mit der Option <code>family = binomial</code>.</p>
<p><span class="math display">\[
y \sim x_1 + x_2 + ... + x_p
\]</span></p>
<p>Dann würde das Modell in R wie folgt aussehen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(y <span class="sc">~</span> x_1 <span class="sc">+</span> x_2, ..., <span class="at">family =</span> binomial)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Neben der Möglichkeit, dass wir <span class="math inline">\(0/1\)</span> im Outcome <span class="math inline">\(y\)</span> haben, könnten wir auch unser Outcome anders beschreiben. Wir nutzen dann dafür das <a href="https://edgarhassler.com/posts/wilkinson-rogers-notation/">Wilkinson-Rogers Format</a> welches dann den Anteil an Erfolgen an Fehlschlägen beschreibt. Wir schreiben aber in das Modell die konkrete Anzahl an Erfolgen und Fehlschlägen.</p>
<p><span class="math display">\[
(Success|Failure) \sim x_1 + x_2 + ... + x_p
\]</span></p>
<p>In R würden wir dann die <em>zwei</em> Spalten mit der Anzahl an Erfolgen und Fehlschlägen mit <code>cbind()</code> zusammenfassen und in <code>glm()</code> ergänzen. Daher würden wir dann in R wie folgt schreiben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(<span class="fu">cbind</span>(success, failure) <span class="sc">~</span> x_1 <span class="sc">+</span> x_2, ..., <span class="at">family =</span> binomial)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir können in dem Modell auch Faktoren <span class="math inline">\(f\)</span> haben, aber es geht hier am Anfang des Kapitels nicht um einen reinen Gruppenvergleich. Das ist ganz wichtig. Wenn du einen Gruppenvergleich rechnen willst, dann musst du in <a href="#sec-mult-comp-log-reg" class="quarto-xref"><span>Kapitel 56.8</span></a> nochmal nachlesen, wir du dann das Modell weiterverwendest.</p>
</section>
<section id="genutzte-r-pakete" class="level2" data-number="56.2">
<h2 data-number="56.2" class="anchored" data-anchor-id="genutzte-r-pakete"><span class="header-section-number">56.2</span> Genutzte R Pakete</h2>
<p>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, magrittr, conflicted, broom,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               parameters, performance, gtsummary, see,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>               tidymodels, cutpointr, emmeans, multcomp,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               conflicted)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(yardstick<span class="sc">::</span>accuracy)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(dplyr<span class="sc">::</span>select)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">conflicts_prefer</span>(magrittr<span class="sc">::</span>extract)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>cbbPalette <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#000000"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>, <span class="st">"#009E73"</span>, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#F0E442"</span>, <span class="st">"#0072B2"</span>, <span class="st">"#D55E00"</span>, <span class="st">"#CC79A7"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>An der Seite des Kapitels findest du den Link <em>Quellcode anzeigen</em>, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</p>
</section>
<section id="daten" class="level2 page-columns page-full" data-number="56.3">
<h2 data-number="56.3" class="anchored" data-anchor-id="daten"><span class="header-section-number">56.3</span> Daten</h2>
<p>In diesem Kapitel nutzen wir die infizierten Ferkel als Beispieldatensatz. Wir haben in dem Datensatz über vierhundert Ferkel untersucht und festgehalten, ob die Ferkel infiziert sind (<span class="math inline">\(1\)</span>, ja) oder nicht infiziert (<span class="math inline">\(0\)</span>, nein). Wir haben daneben noch eine ganze Reihe von <em>Risiko</em>faktoren erhoben. Hier sieht man mal wieder wie wirr die Sprache der Statistik ist. Weil wir rausfinden wollen welche Variable das Risiko für die Infektion erhöht, nennen wir diese Variablen Risikofaktoren. Obwohl die Variablen gar keine kategorialen Spalten sind bzw. nicht alle. So ist das dann in der Statistik, ein verwirrender Begriff jagt den Nächsten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/infected_pigs.xlsx"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Schauen wir uns nochmal einen Ausschnitt der Daten in der <a href="#tbl-log-pigs" class="quarto-xref">Tabelle&nbsp;<span>56.1</span></a> an.</p>
<div class="cell page-columns page-full">
<div id="tbl-log-pigs" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-log-pigs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;56.1— Auszug aus dem Daten zu den kranken Ferkeln.
</figcaption>
<div aria-describedby="tbl-log-pigs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="cell-output-display column-page">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">age</th>
<th style="text-align: center;">sex</th>
<th style="text-align: center;">location</th>
<th style="text-align: center;">activity</th>
<th style="text-align: center;">crp</th>
<th style="text-align: center;">frailty</th>
<th style="text-align: center;">bloodpressure</th>
<th style="text-align: center;">weight</th>
<th style="text-align: center;">creatinin</th>
<th style="text-align: center;">infected</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">61</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">northeast</td>
<td style="text-align: center;">15.31</td>
<td style="text-align: center;">22.38</td>
<td style="text-align: center;">robust</td>
<td style="text-align: center;">62.24</td>
<td style="text-align: center;">19.05</td>
<td style="text-align: center;">4.44</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">53</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">northwest</td>
<td style="text-align: center;">13.01</td>
<td style="text-align: center;">18.64</td>
<td style="text-align: center;">robust</td>
<td style="text-align: center;">54.21</td>
<td style="text-align: center;">17.68</td>
<td style="text-align: center;">3.87</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">66</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">northeast</td>
<td style="text-align: center;">11.31</td>
<td style="text-align: center;">18.76</td>
<td style="text-align: center;">robust</td>
<td style="text-align: center;">57.94</td>
<td style="text-align: center;">16.76</td>
<td style="text-align: center;">3.01</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">59</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">north</td>
<td style="text-align: center;">13.33</td>
<td style="text-align: center;">19.37</td>
<td style="text-align: center;">robust</td>
<td style="text-align: center;">56.15</td>
<td style="text-align: center;">19.05</td>
<td style="text-align: center;">4.35</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">63</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">northwest</td>
<td style="text-align: center;">14.71</td>
<td style="text-align: center;">21.57</td>
<td style="text-align: center;">robust</td>
<td style="text-align: center;">55.38</td>
<td style="text-align: center;">18.44</td>
<td style="text-align: center;">5.27</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">55</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">northwest</td>
<td style="text-align: center;">15.81</td>
<td style="text-align: center;">21.45</td>
<td style="text-align: center;">robust</td>
<td style="text-align: center;">60.29</td>
<td style="text-align: center;">18.42</td>
<td style="text-align: center;">4.78</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">54</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">north</td>
<td style="text-align: center;">11.82</td>
<td style="text-align: center;">21.5</td>
<td style="text-align: center;">pre-frail</td>
<td style="text-align: center;">55.32</td>
<td style="text-align: center;">19.75</td>
<td style="text-align: center;">3.92</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">56</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">west</td>
<td style="text-align: center;">13.91</td>
<td style="text-align: center;">20.8</td>
<td style="text-align: center;">frail</td>
<td style="text-align: center;">58.37</td>
<td style="text-align: center;">17.28</td>
<td style="text-align: center;">7.44</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">57</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">northwest</td>
<td style="text-align: center;">12.49</td>
<td style="text-align: center;">21.95</td>
<td style="text-align: center;">pre-frail</td>
<td style="text-align: center;">56.66</td>
<td style="text-align: center;">16.86</td>
<td style="text-align: center;">2.44</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">61</td>
<td style="text-align: center;">male</td>
<td style="text-align: center;">northwest</td>
<td style="text-align: center;">15.26</td>
<td style="text-align: center;">23.1</td>
<td style="text-align: center;">robust</td>
<td style="text-align: center;">57.18</td>
<td style="text-align: center;">15.55</td>
<td style="text-align: center;">3.08</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">59</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">north</td>
<td style="text-align: center;">13.13</td>
<td style="text-align: center;">20.23</td>
<td style="text-align: center;">robust</td>
<td style="text-align: center;">56.64</td>
<td style="text-align: center;">18.6</td>
<td style="text-align: center;">3.41</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">63</td>
<td style="text-align: center;">female</td>
<td style="text-align: center;">north</td>
<td style="text-align: center;">10.01</td>
<td style="text-align: center;">19.89</td>
<td style="text-align: center;">robust</td>
<td style="text-align: center;">57.46</td>
<td style="text-align: center;">18.6</td>
<td style="text-align: center;">4.2</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In dem nächsten Abschnitt werden wir die Daten nutzen um rauszufinden welche Variablen einen Einfluss auf den Infektionsstatus der Ferkel hat.</p>
</section>
<section id="theoretischer-hintergrund" class="level2 page-columns page-full" data-number="56.4">
<h2 data-number="56.4" class="anchored" data-anchor-id="theoretischer-hintergrund"><span class="header-section-number">56.4</span> Theoretischer Hintergrund</h2>
<p>Wir schaffen wir es, durch einen <span class="math inline">\(0/1\)</span> Outcome auf der y-Achse eine gerade Linie durch die Punkte zu zeichnen und die Koeffiziente dieser Gerade zu bestimmen? Immerhin gibt es ja gar keine Werte zwischen <span class="math inline">\(0\)</span> und <span class="math inline">\(1\)</span>. In <a href="#fig-log-activity" class="quarto-xref">Abbildung&nbsp;<span>56.1</span></a> sehen wir beispielhaft den Zusammenhang zwischen dem Infektionsstatus und der Aktivität der Ferkel. Wir haben zwei horizontale Linien. Wie zeichen wir jetzt da eine Gerade durch?</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pig_tbl, <span class="fu">aes</span>(<span class="at">x =</span> activity, <span class="at">y =</span> infected)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-log-activity" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-activity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-logistic_files/figure-html/fig-log-activity-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Abbildung&nbsp;56.1— Visualisierung des Zusammenhangs zwischen dem Infektionsstatus und der Aktivität der Ferkel."><img src="stat-modeling-logistic_files/figure-html/fig-log-activity-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-activity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.1— Visualisierung des Zusammenhangs zwischen dem Infektionsstatus und der Aktivität der Ferkel.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In der folgenden <a href="#fig-log-activity-2" class="quarto-xref">Abbildung&nbsp;<span>56.2</span></a> sehen wir nochmal die gleiche Darstellung der Daten aus dem R Paket <code>{see}</code> und der entsprechenden Funktion <code>geom_binomdensity()</code>. Leider ist die Nutzung nicht so, wie du <code>{ggplot}</code> gewohnt bist, aber für die Darstellung hier ist es sehr angenehm die Verteilung der Beobachtungen besser zu sehen. Du siehst hier einmal ganz gut, wie sich die <span class="math inline">\(0/1\)</span>-Werte für die infizierten Schweine über die Werte der Aktivität anordnen. In der obigen Abbdilung sind dann eben die Punkte alle übereinander angeordnet.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_binomdensity</span>(pig_tbl, <span class="at">x =</span> <span class="st">"activity"</span>, <span class="at">y =</span> <span class="st">"infected"</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-log-activity-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-activity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-logistic_files/figure-html/fig-log-activity-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Abbildung&nbsp;56.2— Visualisierung des Zusammenhangs zwischen dem Infektionsstatus und der Aktivität der Ferkel."><img src="stat-modeling-logistic_files/figure-html/fig-log-activity-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-activity-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.2— Visualisierung des Zusammenhangs zwischen dem Infektionsstatus und der Aktivität der Ferkel.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Der Trick hierbei ist wieder die Transformation des <em>Zusammenhangs</em> von <span class="math inline">\(y \sim x\)</span> auf einen <span class="math inline">\(\log\)</span>-scale. Das heißt wir Rechnen nicht mit den <span class="math inline">\(0/1\)</span> Werten sondern transformieren den gesamten Zusammenhang. Das ist wichtig, den es gibt einen Unterschied zwischen der Transformation von <span class="math inline">\(y\)</span> und der Transformation die hier gemeint ist. Wir halten fest, wir rechnen also nicht auf der ursprünglichen Skala der Daten sondern auf der <span class="math inline">\(\log\)</span>-scale. Allgemeiner wird auch von der <em>link</em>-Funktion gesprochen, da wir ja verschiedene Möglichkeiten der Transformation des Zusammenhangs haben.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">Hier gibt es nur die Kurzfassung der <em>link</em>-Funktion. <span class="citation" data-cites="dormann2013parametrische">Dormann (<a href="#ref-dormann2013parametrische" role="doc-biblioref">2013</a>)</span> liefert hierzu in Kapitel 7.1.3 nochmal ein Einführung in das Thema.</span></div></div>
<p>Wir gehen wir also vor. Zuerst Modellieren wir die Wahrscheinlichkeit für den Eintritt des Ereignisses. Wir machen also aus unseren binären <span class="math inline">\(0/1\)</span> Daten eine Wahrscheinlichkeit für den Eintritt von 1.</p>
<p><span class="math display">\[
Y \rightarrow Pr(Y = 1)
\]</span></p>
<p>Damit haben wir schon was erreicht den <span class="math inline">\(Pr(Y = 1)\)</span> liegt zwischen <span class="math inline">\(0\)</span> und <span class="math inline">\(1\)</span>. Damit haben wir also schon Werte <em>dazwischen</em>. Wenn wir aber normalverteilte Residuen haben wollen, dann müssen unsere Werte von <span class="math inline">\(-\infty\)</span> bis <span class="math inline">\(+\infty\)</span> laufen können. Daher rechnen wir im Weiteren die Chance.</p>
<p><span class="math display">\[
\cfrac{Pr(y = 1)}{1 - Pr(Y = 1)}
\]</span> Die Chance (eng. <em>Odds</em>) für das Eintreten von <span class="math inline">\(Y=1\)</span> ist eben die Wahrscheinlichkeit <em>für</em> das Eintreten geteilt durch die Gegenwahrscheinlichkeit. Das ist schon besser, denn damit liegen unsere transformierten Werte für den Zusammenhang schon zwischen <span class="math inline">\(0\)</span> und <span class="math inline">\(+\infty\)</span>. Wenn wir jetzt noch den <span class="math inline">\(\log\)</span> von den Chancen rechnen, dann haben wir schon fast alles was wir brauchen.</p>
<p><span class="math display">\[
\log\left(\cfrac{Pr(y = 1)}{1 - Pr(Y = 1)}\right)
\]</span></p>
<p>Der Logarithmus der Chance liegt dann zwischen <span class="math inline">\(-\infty\)</span> und <span class="math inline">\(+\infty\)</span>. Deshalb spricht man auch von den <span class="math inline">\(\log\)</span>-Odds einer logistischen Regression. Auch sieht man hier woher das <em>logistisch</em> kommt. Wir beschreiben im Namen auch gleich die Transformation mit. Am ende kommen wir somit dann auf folgendes Modell.</p>
<p><span class="math display">\[
\log\left(\cfrac{Pr(y = 1)}{1 - Pr(Y = 1)}\right) = \beta_0 + \beta_1 x_1 + ...  + \beta_p x_p + \epsilon
\]</span> Vielleicht ist dir der Begriff Wahrscheinlichkeit und der Unterschied zur Chance nicht mehr so präsent. Deshalb hier nochmal als Wiederholung oder Auffrischung.</p>
<ul>
<li>Eine <em>Wahrscheinlichkeit</em> beschreibt dem Anteil an Allen. Zum Beispiel den Anteil Gewinner an allen Teilnehmern. Den Anteil Personen mit Therapieerfolg an allen Studienteilnehmern.</li>
<li>Eine <em>Chance</em> oder (eng. <em>Odds</em>) beschreibt ein Verhältnis. Somit das Verhältnis Gewinner zu Nichtgewinner. Oder das Verhältnis Personen mit Therapieerfolg zu Personen ohne Therapieerfolg</li>
</ul>
<p>Nochmal an einem Zahlenbeispiel. Wenn wir ein Glücksspiel haben, in dem es 2 Kombinationen gibt die gewinnen und drei 3 Kombinationen die verlieren, dann haben wir eine Wahrscheinlichkeit zu gewinnen von <span class="math inline">\(2 / 5 = 0.40 = 40\%\)</span>. Wenn wir die Chance zu gewinnen ausrechnen erhalten wir <span class="math inline">\(2:3 = 0.67 = 67\%\)</span>. Wir sehen es gibt einen deutlichen Unterschied zwischen Chance und Wahrscheinlichkeit. Wenn wir große Fallzahl haben bzw. kleine Wahrscheinlichkeiten, dann ist der Unterschied nicht mehr so drastisch. Aber von einer <em>Gleichkeit</em> von Wahrscheinlichkeit und Chance zu sprechen kann nicht ausgegangen werden.</p>
<p>Was ist nun das Problem? Wir erhalten aus einer logistischen Regression <span class="math inline">\(\log\)</span>-Odds wieder. Der Effektchätzer ist also eine Chance. Wir werden aber das Ergebnis wie eine Wahrscheinlichkeit interpretieren. Diese Diskrepanz ist wenigen bekannt und ein Grund, warum wir in der Medizin immer uns daran erinnern müssen, was wir eigentlich mit der logistischen Regression <em>aussagen können</em>.</p>
</section>
<section id="modellierung" class="level2" data-number="56.5">
<h2 data-number="56.5" class="anchored" data-anchor-id="modellierung"><span class="header-section-number">56.5</span> Modellierung</h2>
<p>Die Modellerierung der logistischen Regression ist sehr einfach. Wir nutzen wieder die Formelschreibweise im <code>glm()</code> um unsere Variablen zu definieren. Wenn unser Outcome nicht binär ist, dann jammert R und gibt uns einen Fehler aus. Ich kann hier nur dringlichst raten, das Outcome in <span class="math inline">\(0/1\)</span> zu kodieren mit dem Schlechten als <span class="math inline">\(1\)</span>.</p>
<p>Das <code>glm()</code> muss dann noch wissen, dass es eine logistische Regression rechnen soll. Das machen wir in dem wir als Verteilungsfamilie die Binomialverteilung auswählen. Wir geben also an <code>family = binomial</code> und schon können wir das volle Modell fitten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>log_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(infected <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> location <span class="sc">+</span> activity <span class="sc">+</span> crp <span class="sc">+</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                 frailty <span class="sc">+</span> bloodpressure <span class="sc">+</span> weight <span class="sc">+</span> creatinin, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> pig_tbl, <span class="at">family =</span> binomial)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Das war extrem kurz und scherzlos. Also können wir dann auch ganz kurz schauen, ob das Modell einigermaßen funktioniert hat.</p>
</section>
<section id="performance-des-modells" class="level2" data-number="56.6">
<h2 data-number="56.6" class="anchored" data-anchor-id="performance-des-modells"><span class="header-section-number">56.6</span> Performance des Modells</h2>
<p>Nachdem wir das Modell gefittet haben, wollen wir uns nochmal das <span class="math inline">\(R^2\)</span> wiedergeben lassen um zu entscheiden, ob unser Modell einigermaßen funktioniert hat. Dieser Abschnitt ist sehr kurz. Wir haben leider nur sehr wenige Möglichkeiten um ein logistischen Modell zu bewerten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(log_fit)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Logistic Regression
  Tjur's R2: 0.285</code></pre>
</div>
</div>
<p>Ja, so viel Varianz erklären wir nicht, aber wenn du ein wenig im Internet suchst, dann wirst du feststellen, dass das Bestimmtheitsmaß so eine Sache in <code>glm()</code>’s ist. Wir sind aber einigermaßen zufrieden. Eventuell würde eine Variablenselektion hier helfen, aber das ist nicht Inhalt dieses Kapitels.</p>
<p>In <a href="#fig-log-model-check" class="quarto-xref">Abbildung&nbsp;<span>56.3</span></a> schauen wir nochmal auf die Residuen und die möglichen Ausreißer. Wieder sehen beide Plots einigermaßen in Ordnung aus. Die Abbildungen sind jetzt nicht die Besten, aber ich würde hier auch anhand der Diagnoseplots nicht die Modellierung verwerfen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(log_fit, <span class="at">colors =</span> cbbPalette[<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>], </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"qq"</span>, <span class="st">"outliers"</span>)) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-log-model-check" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-model-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-logistic_files/figure-html/fig-log-model-check-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Abbildung&nbsp;56.3— Ausgabe ausgewählter Modelgüteplots der Funktion check_model()."><img src="stat-modeling-logistic_files/figure-html/fig-log-model-check-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-model-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.3— Ausgabe ausgewählter Modelgüteplots der Funktion <code>check_model()</code>.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-des-modells" class="level2" data-number="56.7">
<h2 data-number="56.7" class="anchored" data-anchor-id="interpretation-des-modells"><span class="header-section-number">56.7</span> Interpretation des Modells</h2>
<p>Zu Interpretation schauen wir uns wie immer nicht die rohe Ausgabe an, sondern lassen uns die Ausgabe mit der Funktion <code>model_parameters()</code> aus dem R Paket <code>{parameters}</code> wiedergeben. Wir müssen noch die Option <code>exponentiate = TRUE</code> wählen, damit unsere Koeffizienten nicht als <span class="math inline">\(\log\)</span>-Odds sondern als Odds wiedergeben werden. Korrekterweise erhalten wir die Odds ratio wieder was wir auch als <span class="math inline">\(OR\)</span> angegeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(log_fit, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter            | Odds Ratio |       SE |       95% CI |     z |      p
----------------------------------------------------------------------------
(Intercept)          |   2.91e-11 | 1.24e-10 | [0.00, 0.00] | -5.69 | &lt; .001
age                  |       1.00 |     0.03 | [0.95, 1.06] |  0.16 | 0.872 
sex [male]           |       0.74 |     0.26 | [0.37, 1.48] | -0.84 | 0.398 
location [northeast] |       1.07 |     0.40 | [0.52, 2.22] |  0.19 | 0.852 
location [northwest] |       0.62 |     0.20 | [0.33, 1.17] | -1.47 | 0.142 
location [west]      |       0.76 |     0.28 | [0.37, 1.56] | -0.75 | 0.450 
activity             |       1.05 |     0.10 | [0.87, 1.27] |  0.51 | 0.612 
crp                  |       2.64 |     0.29 | [2.14, 3.32] |  8.70 | &lt; .001
frailty [pre-frail]  |       1.12 |     0.46 | [0.49, 2.48] |  0.27 | 0.788 
frailty [robust]     |       0.81 |     0.31 | [0.37, 1.72] | -0.54 | 0.588 
bloodpressure        |       1.09 |     0.04 | [1.01, 1.17] |  2.09 | 0.037 
weight               |       1.00 |     0.09 | [0.85, 1.19] |  0.06 | 0.955 
creatinin            |       1.12 |     0.10 | [0.94, 1.33] |  1.23 | 0.218 </code></pre>
</div>
</div>
<p>Wie interpretieren wir nun das <span class="math inline">\(OR\)</span> einer logistischen Regression? Wenn wir darauf gechtet haben, dass wir mit <span class="math inline">\(1\)</span> das Schlechte meinen, dann können wir wir folgt mit dem <span class="math inline">\(OR\)</span> sprechen. Wenn wir ein <span class="math inline">\(OR &gt; 1\)</span> haben, dann haben wir ein Risiko vorliegen. Die Variable mit einem <span class="math inline">\(OR\)</span> größer als <span class="math inline">\(1\)</span> wird die Chance auf den Eintritt des schlechten Ereignisses erhöhen. Wenn wir ein <span class="math inline">\(OR &lt; 1\)</span> haben, dann sprechen wir von einem protektiven Faktor. Die Variable mit einem <span class="math inline">\(OR\)</span> kleiner <span class="math inline">\(1\)</span> wird vor dem Eintreten des schlechten Ereignisses schützen. Schauen wir uns den Zusammenhang mal im Detail für die Ferkeldaten an.</p>
<ul>
<li><code>(intercept)</code> beschreibt den Intercept der logistischen Regression. Wenn wir mehr als eine simple Regression vorliegen haben, wie in diesem Fall, dann ist der Intercept schwer zu interpretieren. Wir konzentrieren uns auf die Effekte der anderen Variablen.</li>
<li><code>sex</code> beschreibt den Effekt der männlichen Ferkel zu den weiblichen Ferkeln. Daher haben männliche Ferkel eine <span class="math inline">\(2.75\)</span> höhere Chance infiziert zu werden als weibliche Ferkel.</li>
<li><code>location [northeast]</code>, <code>location [northwest]</code> und <code>location [west]</code> beschreibt den Unterschied zur <code>location [north]</code>. Alle Orte haben eine geringere Chance für eine Infektion zum Vergleich der Bauernhöfe im Norden. Zwar ist keiner der Effekte signifikant, aber ein interessantes Ergebnis ist es allemal.</li>
<li><code>activity</code> beschreibt den Effekt der Aktivität der Ferkel. Wenn sich die Ferkel mehr bewegen, dann ist die Chance für eine Infektion gemindert.</li>
<li><code>crp</code> beschreibt den Effekt des CRP-Wertes auf den Infektionsgrad. Pro Einheit CRP steigt die Chance einer Infektion um <span class="math inline">\(2.97\)</span> an. Das ist schon ein beachtlicher Wert.</li>
<li><code>frailty</code> beschreibt die Gebrechlichkeit der Ferkel. Hier müssen wir wieder schauen, zu welchem Level von <code>frailty</code> wir vergleichen. Hier vergleichen wir zu <code>frail</code>. Also dem höchsten Gebrechlichkeitgrad. Ferkel die weniger gebrechlich sind, haben eine niedrigere Chance zu erkranken.</li>
<li><code>bloodpressure</code>, <code>weight</code> und <code>creatinin</code> sind alles Variablen, mit einem <span class="math inline">\(OR\)</span> größer als <span class="math inline">\(1\)</span> und somit alles Riskovariablen. Hier sind zwar die <span class="math inline">\(OR\)</span> relativ klein, aber das muss erstmal nichts heißen, da die <span class="math inline">\(OR\)</span> ja hier die <em>Änderung</em> für eine Einheit von <span class="math inline">\(x\)</span> beschreiben. Deshalb musst du immer schauen, wie die Einheiten von kontinuierlichen kodiert Variablen sind.</li>
</ul>
<p>Kommen wir nochmal zu den gänigen Tabellen für die Zusammenfassung eines Ergebnisses einer logistischen Regression. Teilweise sind diese Tabellen so generisch und häufiog verwendet, dass wir schon einen Begriff für diese Tabellen haben. In <a href="#tbl-tbl-summary-logreg" class="quarto-xref">Tabelle&nbsp;<span>56.2</span></a> siehst du die <em>table 1</em> für die Übersicht aller Risikovariablen aufgeteilt nach dem Infektionsstatus. Diese Art der Tabellendarstellung ist so grundlegend für eine medizinische Veröffentlichung, dass sich eben der Begriff <em>table 1</em> etabliert hat. Fast jede medizinische Veröffentlichung hat als erste Tabelle diese Art von Tabelle angegeben. Hierbei ist wichtig, dass die <span class="math inline">\(p\)</span>-Werte alle nur aus einem einfachen statistischen Test stammen. Die <span class="math inline">\(p\)</span>-Werte einer multiplen logistischen Regression werden daher immer anders sein.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="sc">|&gt;</span> <span class="fu">tbl_summary</span>(<span class="at">by =</span> infected) <span class="sc">|&gt;</span> <span class="fu">add_p</span>() <span class="sc">|&gt;</span> <span class="fu">as_flex_table</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-tbl-summary-logreg" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl-summary-logreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;56.2— Ausgabe der Daten in einer Summary Table oder auch Table 1 genannt. In medizinischen Veröffentlichungen immer die erste Tabelle für die Zusammenfassung der Patienten (hier Ferkel) für jede erhobende Risikovariable.
</figcaption>
<div aria-describedby="tbl-tbl-summary-logreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-672b00e2{}.cl-672768ce{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-672768d8{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-672768d9{font-family:'Helvetica';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-6728dc18{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6728dc22{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6728dc2c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6728dc2d{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6728dc2e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:15pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6728dc36{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6728e7da{width:1.304in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e7db{width:1.661in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e7e4{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e7e5{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e7e6{width:1.661in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e7ee{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e7ef{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e7f0{width:1.661in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e7f8{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e7f9{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e7fa{width:1.661in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e802{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e803{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e80c{width:1.661in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e80d{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e80e{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e80f{width:1.661in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e816{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e817{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e820{width:1.661in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e821{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e82a{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e82b{width:1.661in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e82c{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e82d{width:1.304in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e834{width:1.661in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6728e835{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-672b00e2"><thead><tr style="overflow-wrap:break-word;"><th class="cl-6728e7da"><p class="cl-6728dc18"><span class="cl-672768ce">Characteristic</span></p></th><th class="cl-6728e7db"><p class="cl-6728dc22"><span class="cl-672768ce">0</span><span class="cl-672768d8">, N = 136</span><span class="cl-672768d9">1</span></p></th><th class="cl-6728e7db"><p class="cl-6728dc22"><span class="cl-672768ce">1</span><span class="cl-672768d8">, N = 276</span><span class="cl-672768d9">1</span></p></th><th class="cl-6728e7e4"><p class="cl-6728dc22"><span class="cl-672768ce">p-value</span><span class="cl-672768d9">2</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-6728e7e5"><p class="cl-6728dc2c"><span class="cl-672768d8">age</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">59.5 (57.0, 63.0)</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">60.0 (57.0, 63.0)</span></p></td><td class="cl-6728e7ee"><p class="cl-6728dc2d"><span class="cl-672768d8">0.9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e7ef"><p class="cl-6728dc2c"><span class="cl-672768d8">sex</span></p></td><td class="cl-6728e7f0"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td><td class="cl-6728e7f0"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td><td class="cl-6728e7f8"><p class="cl-6728dc2d"><span class="cl-672768d8">0.2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e7e5"><p class="cl-6728dc2e"><span class="cl-672768d8">female</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">47 (35%)</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">114 (41%)</span></p></td><td class="cl-6728e7ee"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e7e5"><p class="cl-6728dc2e"><span class="cl-672768d8">male</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">89 (65%)</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">162 (59%)</span></p></td><td class="cl-6728e7ee"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e7f9"><p class="cl-6728dc2c"><span class="cl-672768d8">location</span></p></td><td class="cl-6728e7fa"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td><td class="cl-6728e7fa"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td><td class="cl-6728e802"><p class="cl-6728dc2d"><span class="cl-672768d8">0.3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e7e5"><p class="cl-6728dc2e"><span class="cl-672768d8">north</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">36 (26%)</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">85 (31%)</span></p></td><td class="cl-6728e7ee"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e7e5"><p class="cl-6728dc2e"><span class="cl-672768d8">northeast</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">23 (17%)</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">61 (22%)</span></p></td><td class="cl-6728e7ee"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e7e5"><p class="cl-6728dc2e"><span class="cl-672768d8">northwest</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">48 (35%)</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">76 (28%)</span></p></td><td class="cl-6728e7ee"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e7e5"><p class="cl-6728dc2e"><span class="cl-672768d8">west</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">29 (21%)</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">54 (20%)</span></p></td><td class="cl-6728e7ee"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e7e5"><p class="cl-6728dc2c"><span class="cl-672768d8">activity</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">13.40 (12.25, 14.34)</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">13.24 (12.28, 14.54)</span></p></td><td class="cl-6728e7ee"><p class="cl-6728dc2d"><span class="cl-672768d8">0.8</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e7e5"><p class="cl-6728dc2c"><span class="cl-672768d8">crp</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">19.12 (18.13, 19.83)</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">20.57 (19.77, 21.46)</span></p></td><td class="cl-6728e7ee"><p class="cl-6728dc2d"><span class="cl-672768d8">&lt;0.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e803"><p class="cl-6728dc2c"><span class="cl-672768d8">frailty</span></p></td><td class="cl-6728e80c"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td><td class="cl-6728e80c"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td><td class="cl-6728e80d"><p class="cl-6728dc2d"><span class="cl-672768d8">0.5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e7e5"><p class="cl-6728dc2e"><span class="cl-672768d8">frail</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">18 (13%)</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">37 (13%)</span></p></td><td class="cl-6728e7ee"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e80e"><p class="cl-6728dc2e"><span class="cl-672768d8">pre-frail</span></p></td><td class="cl-6728e80f"><p class="cl-6728dc2d"><span class="cl-672768d8">42 (31%)</span></p></td><td class="cl-6728e80f"><p class="cl-6728dc2d"><span class="cl-672768d8">101 (37%)</span></p></td><td class="cl-6728e816"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e7e5"><p class="cl-6728dc2e"><span class="cl-672768d8">robust</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">76 (56%)</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">138 (50%)</span></p></td><td class="cl-6728e7ee"><p class="cl-6728dc2d"><span class="cl-672768d8"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e7e5"><p class="cl-6728dc2c"><span class="cl-672768d8">bloodpressure</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">56.2 (54.3, 58.5)</span></p></td><td class="cl-6728e7e6"><p class="cl-6728dc2d"><span class="cl-672768d8">57.2 (55.1, 59.6)</span></p></td><td class="cl-6728e7ee"><p class="cl-6728dc2d"><span class="cl-672768d8">0.021</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e817"><p class="cl-6728dc2c"><span class="cl-672768d8">weight</span></p></td><td class="cl-6728e820"><p class="cl-6728dc2d"><span class="cl-672768d8">18.61 (17.34, 19.41)</span></p></td><td class="cl-6728e820"><p class="cl-6728dc2d"><span class="cl-672768d8">18.32 (17.19, 19.60)</span></p></td><td class="cl-6728e821"><p class="cl-6728dc2d"><span class="cl-672768d8">0.8</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-6728e82a"><p class="cl-6728dc2c"><span class="cl-672768d8">creatinin</span></p></td><td class="cl-6728e82b"><p class="cl-6728dc2d"><span class="cl-672768d8">4.85 (3.67, 5.93)</span></p></td><td class="cl-6728e82b"><p class="cl-6728dc2d"><span class="cl-672768d8">4.86 (4.06, 5.85)</span></p></td><td class="cl-6728e82c"><p class="cl-6728dc2d"><span class="cl-672768d8">0.3</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-6728e82d"><p class="cl-6728dc36"><span class="cl-672768d9">1</span><span class="cl-672768d8">Median (IQR); n (%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-6728e82d"><p class="cl-6728dc36"><span class="cl-672768d9">2</span><span class="cl-672768d8">Wilcoxon rank sum test; Pearson's Chi-squared test</span></p></td></tr></tfoot></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>In <a href="#tbl-tbl-uni-logreg" class="quarto-xref">Tabelle&nbsp;<span>56.3</span></a> siehst du nochmal für eine Auswahl an Variablen die simplen logistischen Regressionen gerechnet. Du müsst also nicht jede simple logistische Regression selber rechnen, sondern kannst auch die Funktion <code>tbl_uvregression()</code> verwenden. Das R Paket <code>{tbl_summary}</code> erlaubt weitreichende Formatierungsmöglichkeiten. Am bestes schaust du einmal im Tutorial <a href="https://www.danieldsjoberg.com/gtsummary/articles/tbl_regression.html">Tutorial: tbl_regression</a> selber nach was du brauchst oder anpassen willst.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pig_tbl<span class="sc">|&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(infected, age, crp, bloodpressure) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_uvregression</span>(</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> glm,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> infected,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> binomial),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">pvalue_fun =</span> <span class="sc">~</span><span class="fu">style_pvalue</span>(.x, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">as_flex_table</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-tbl-uni-logreg" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl-uni-logreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;56.3— Simple logistische Regression für eine Auswahl an Einflussvariablen. Für jede Einflussvariable wurde eine simple logistische Regression gerechnet.
</figcaption>
<div aria-describedby="tbl-tbl-uni-logreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-6795b086{}.cl-6792e5a4{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6792e5ae{font-family:'Helvetica';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-6792e5b8{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-6794081c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-6794081d{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-67940826{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-67940827{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-67940828{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-67941050{width:1.304in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6794105a{width:0.54in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6794105b{width:0.583in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67941064{width:0.965in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6794106e{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6794106f{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67941070{width:0.54in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67941078{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67941079{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6794107a{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67941082{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67941083{width:0.54in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67941084{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-6794108c{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67941096{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67941097{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679410a0{width:0.54in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679410a1{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679410aa{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679410ab{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679410ac{width:1.304in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679410b4{width:0.54in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679410b5{width:0.583in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679410be{width:0.965in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-679410bf{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-6795b086"><thead><tr style="overflow-wrap:break-word;"><th class="cl-67941050"><p class="cl-6794081c"><span class="cl-6792e5a4">Characteristic</span></p></th><th class="cl-6794105a"><p class="cl-6794081d"><span class="cl-6792e5a4">N</span></p></th><th class="cl-6794105b"><p class="cl-6794081d"><span class="cl-6792e5a4">OR</span><span class="cl-6792e5ae">1</span></p></th><th class="cl-67941064"><p class="cl-6794081d"><span class="cl-6792e5a4">95% CI</span><span class="cl-6792e5ae">1</span></p></th><th class="cl-6794106e"><p class="cl-6794081d"><span class="cl-6792e5a4">p-value</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-6794106f"><p class="cl-67940826"><span class="cl-6792e5b8">age</span></p></td><td class="cl-67941070"><p class="cl-67940827"><span class="cl-6792e5b8">412</span></p></td><td class="cl-67941078"><p class="cl-67940827"><span class="cl-6792e5b8">1.00</span></p></td><td class="cl-67941079"><p class="cl-67940827"><span class="cl-6792e5b8">0.95, 1.04</span></p></td><td class="cl-6794107a"><p class="cl-67940827"><span class="cl-6792e5b8">0.88</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67941082"><p class="cl-67940826"><span class="cl-6792e5b8">crp</span></p></td><td class="cl-67941083"><p class="cl-67940827"><span class="cl-6792e5b8">412</span></p></td><td class="cl-67941084"><p class="cl-67940827"><span class="cl-6792e5b8">2.62</span></p></td><td class="cl-6794108c"><p class="cl-67940827"><span class="cl-6792e5b8">2.14, 3.27</span></p></td><td class="cl-67941096"><p class="cl-67940827"><span class="cl-6792e5b8">&lt;0.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67941097"><p class="cl-67940826"><span class="cl-6792e5b8">bloodpressure</span></p></td><td class="cl-679410a0"><p class="cl-67940827"><span class="cl-6792e5b8">412</span></p></td><td class="cl-679410a1"><p class="cl-67940827"><span class="cl-6792e5b8">1.08</span></p></td><td class="cl-679410aa"><p class="cl-67940827"><span class="cl-6792e5b8">1.02, 1.15</span></p></td><td class="cl-679410ab"><p class="cl-67940827"><span class="cl-6792e5b8">0.013</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="5" class="cl-679410ac"><p class="cl-67940828"><span class="cl-6792e5ae">1</span><span class="cl-6792e5b8">OR = Odds Ratio, CI = Confidence Interval</span></p></td></tr></tfoot></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>nun gibt es viele Möglichkeiten sich die logistische Regression wiedergeben zu lassen In <a href="#tbl-tbl-regression-logreg" class="quarto-xref">Tabelle&nbsp;<span>56.4</span></a> siehst du nochmal die Möglichkeit, die dir das R Paket <code>{tbl_summary}</code> bietet. Am Ende ist es dann eine reine Geschmacksfrage, wie wir die Daten dann aufarbeiten wollen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>log_fit <span class="sc">|&gt;</span> <span class="fu">tbl_regression</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">as_flex_table</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-tbl-regression-logreg" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl-regression-logreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabelle&nbsp;56.4— Ausgabe der multiplen logistischen Regression durch die Funktion <code>tbl_regression()</code>.
</figcaption>
<div aria-describedby="tbl-tbl-regression-logreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div class="tabwid"><style>.cl-6800392e{}.cl-67fc4bca{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-67fc4bd4{font-family:'Helvetica';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-67fc4bd5{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-67fd888c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-67fd8896{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-67fd8897{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-67fd88a0{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-67fd88a1{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:15pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-67fd88aa{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-67fd920a{width:1.304in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9214{width:0.583in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9215{width:0.965in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd921e{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd921f{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9228{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9229{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9232{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9233{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd923c{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd923d{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd923e{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9246{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9247{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9248{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9250{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9251{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd925a{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd925b{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9264{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9265{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9266{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9267{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd926e{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd926f{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9278{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9279{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd927a{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd927b{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9282{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9283{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd928c{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd928d{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd928e{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9296{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9297{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9298{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd9299{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92a0{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92a1{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92a2{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92aa{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92ab{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92ac{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92b4{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92b5{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92be{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92bf{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92c0{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92c1{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92c8{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92c9{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92ca{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92cb{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92d2{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92d3{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92dc{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92dd{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92de{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92e6{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92e7{width:1.304in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92e8{width:0.583in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92f0{width:0.965in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92f1{width:0.82in;background-color:transparent;vertical-align: top;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92f2{width:1.304in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92f3{width:0.583in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92fa{width:0.965in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-67fd92fb{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-6800392e"><thead><tr style="overflow-wrap:break-word;"><th class="cl-67fd920a"><p class="cl-67fd888c"><span class="cl-67fc4bca">Characteristic</span></p></th><th class="cl-67fd9214"><p class="cl-67fd8896"><span class="cl-67fc4bca">OR</span><span class="cl-67fc4bd4">1</span></p></th><th class="cl-67fd9215"><p class="cl-67fd8896"><span class="cl-67fc4bca">95% CI</span><span class="cl-67fc4bd4">1</span></p></th><th class="cl-67fd921e"><p class="cl-67fd8896"><span class="cl-67fc4bca">p-value</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-67fd921f"><p class="cl-67fd8897"><span class="cl-67fc4bd5">age</span></p></td><td class="cl-67fd9228"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">1.00</span></p></td><td class="cl-67fd9229"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.95, 1.06</span></p></td><td class="cl-67fd9232"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd9233"><p class="cl-67fd8897"><span class="cl-67fc4bd5">sex</span></p></td><td class="cl-67fd923c"><p class="cl-67fd88a0"><span class="cl-67fc4bd5"></span></p></td><td class="cl-67fd923d"><p class="cl-67fd88a0"><span class="cl-67fc4bd5"></span></p></td><td class="cl-67fd923e"><p class="cl-67fd88a0"><span class="cl-67fc4bd5"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd9246"><p class="cl-67fd88a1"><span class="cl-67fc4bd5">female</span></p></td><td class="cl-67fd9247"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">—</span></p></td><td class="cl-67fd9248"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">—</span></p></td><td class="cl-67fd9250"><p class="cl-67fd88a0"><span class="cl-67fc4bd5"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd9251"><p class="cl-67fd88a1"><span class="cl-67fc4bd5">male</span></p></td><td class="cl-67fd925a"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.74</span></p></td><td class="cl-67fd925b"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.37, 1.48</span></p></td><td class="cl-67fd9264"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd9265"><p class="cl-67fd8897"><span class="cl-67fc4bd5">location</span></p></td><td class="cl-67fd9266"><p class="cl-67fd88a0"><span class="cl-67fc4bd5"></span></p></td><td class="cl-67fd9267"><p class="cl-67fd88a0"><span class="cl-67fc4bd5"></span></p></td><td class="cl-67fd926e"><p class="cl-67fd88a0"><span class="cl-67fc4bd5"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd926f"><p class="cl-67fd88a1"><span class="cl-67fc4bd5">north</span></p></td><td class="cl-67fd9278"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">—</span></p></td><td class="cl-67fd9279"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">—</span></p></td><td class="cl-67fd927a"><p class="cl-67fd88a0"><span class="cl-67fc4bd5"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd927b"><p class="cl-67fd88a1"><span class="cl-67fc4bd5">northeast</span></p></td><td class="cl-67fd9282"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">1.07</span></p></td><td class="cl-67fd9283"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.52, 2.22</span></p></td><td class="cl-67fd928c"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd928d"><p class="cl-67fd88a1"><span class="cl-67fc4bd5">northwest</span></p></td><td class="cl-67fd928e"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.62</span></p></td><td class="cl-67fd9296"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.33, 1.17</span></p></td><td class="cl-67fd9297"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.14</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd921f"><p class="cl-67fd88a1"><span class="cl-67fc4bd5">west</span></p></td><td class="cl-67fd9228"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.76</span></p></td><td class="cl-67fd9229"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.37, 1.56</span></p></td><td class="cl-67fd9232"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.5</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd9298"><p class="cl-67fd8897"><span class="cl-67fc4bd5">activity</span></p></td><td class="cl-67fd9299"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">1.05</span></p></td><td class="cl-67fd92a0"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.87, 1.27</span></p></td><td class="cl-67fd92a1"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.6</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd927b"><p class="cl-67fd8897"><span class="cl-67fc4bd5">crp</span></p></td><td class="cl-67fd9282"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">2.64</span></p></td><td class="cl-67fd9283"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">2.14, 3.32</span></p></td><td class="cl-67fd928c"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">&lt;0.001</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd92a2"><p class="cl-67fd8897"><span class="cl-67fc4bd5">frailty</span></p></td><td class="cl-67fd92aa"><p class="cl-67fd88a0"><span class="cl-67fc4bd5"></span></p></td><td class="cl-67fd92ab"><p class="cl-67fd88a0"><span class="cl-67fc4bd5"></span></p></td><td class="cl-67fd92ac"><p class="cl-67fd88a0"><span class="cl-67fc4bd5"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd92b4"><p class="cl-67fd88a1"><span class="cl-67fc4bd5">frail</span></p></td><td class="cl-67fd92b5"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">—</span></p></td><td class="cl-67fd92be"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">—</span></p></td><td class="cl-67fd92bf"><p class="cl-67fd88a0"><span class="cl-67fc4bd5"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd92c0"><p class="cl-67fd88a1"><span class="cl-67fc4bd5">pre-frail</span></p></td><td class="cl-67fd92c1"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">1.12</span></p></td><td class="cl-67fd92c8"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.49, 2.48</span></p></td><td class="cl-67fd92c9"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.8</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd927b"><p class="cl-67fd88a1"><span class="cl-67fc4bd5">robust</span></p></td><td class="cl-67fd9282"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.81</span></p></td><td class="cl-67fd9283"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.37, 1.72</span></p></td><td class="cl-67fd928c"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.6</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd92ca"><p class="cl-67fd8897"><span class="cl-67fc4bd5">bloodpressure</span></p></td><td class="cl-67fd92cb"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">1.09</span></p></td><td class="cl-67fd92d2"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">1.01, 1.17</span></p></td><td class="cl-67fd92d3"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.037</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd92dc"><p class="cl-67fd8897"><span class="cl-67fc4bd5">weight</span></p></td><td class="cl-67fd92dd"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">1.00</span></p></td><td class="cl-67fd92de"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.85, 1.19</span></p></td><td class="cl-67fd92e6"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">&gt;0.9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-67fd92e7"><p class="cl-67fd8897"><span class="cl-67fc4bd5">creatinin</span></p></td><td class="cl-67fd92e8"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">1.12</span></p></td><td class="cl-67fd92f0"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.94, 1.33</span></p></td><td class="cl-67fd92f1"><p class="cl-67fd88a0"><span class="cl-67fc4bd5">0.2</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td colspan="4" class="cl-67fd92f2"><p class="cl-67fd88aa"><span class="cl-67fc4bd4">1</span><span class="cl-67fc4bd5">OR = Odds Ratio, CI = Confidence Interval</span></p></td></tr></tfoot></table></div>
</div>
</div>
</figure>
</div>
</div>
<p>Zum Abschluss wollen wir uns einmal die Ergebnisse des Modellfits als logistischen Gerade für eine simple lineare Regression mit dem Modell <span class="math inline">\(infected \sim crp\)</span> anschauen. Wie immer können wir uns den Zusammenhang nur in einem simplen Modell anschauen. Im Fall einer multiplen linearen Regresion können wir nicht so viele Dimensionen in einer Grpahik darstellen. Wir fitten also das Modell <code>log_fit_crp</code> wie im folgenden dargestellt.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>log_fit_crp <span class="ot">&lt;-</span> <span class="fu">glm</span>(infected <span class="sc">~</span> crp, <span class="at">data =</span> pig_tbl, <span class="at">family =</span> binomial)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Nun können wir uns mit der Funktion <code>predict()</code> die Wert auf der Geraden wiedergeben lassen. Wenn wir <code>predict()</code> nur so aufrufen, dann erhalten wir die Werte für <span class="math inline">\(y\)</span> auf der transformierten <span class="math inline">\(link\)</span>-Scale wieder. Das hilft uns aber nicht weiter, wir haben ja nur 0 und 1 Werte für <span class="math inline">\(y\)</span> vorliegen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(log_fit_crp, <span class="at">type =</span> <span class="st">"link"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    1     2     3     4     5     6     7     8     9    10 
 3.19 -0.41 -0.29  0.29  2.41  2.30 -0.08 -0.08  2.72  1.83 </code></pre>
</div>
</div>
<p>Da wir die Werte für die Wahrscheinlichkeit das ein Ferkel infiziert ist, also die Wahrscheinlichkeit <span class="math inline">\(Pr(infected = 1)\)</span>, müssen wir noch die Option <code>type = reponse</code> wählen. So erhalten wir die Wahrscheinlichkeiten wiedergegeben.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(log_fit_crp, <span class="at">type =</span> <span class="st">"response"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   1    2    3    4    5    6    7    8    9   10 
0.96 0.40 0.43 0.57 0.92 0.91 0.48 0.48 0.94 0.86 </code></pre>
</div>
</div>
<p>Abschließend können wir uns die Gerade auch in der <a href="#fig-log-pred" class="quarto-xref">Abbildung&nbsp;<span>56.4</span></a> visualisieren lassen. Auf der x-Achse sehen wir die <code>crp</code>-Werte und auf der y-Achse den Infektionsstatus. Auf der <span class="math inline">\(reponse\)</span>-scale sehen wir eine S-Kurve. Auf der <span class="math inline">\(link\)</span>-scale würden wir eine Gerade sehen.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pig_tbl, <span class="fu">aes</span>(<span class="at">x =</span> crp, <span class="at">y =</span> infected)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(log_fit_crp, <span class="at">type =</span> <span class="st">"response"</span>)), <span class="at">color =</span> <span class="st">"red"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-log-pred" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-logistic_files/figure-html/fig-log-pred-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Abbildung&nbsp;56.4— Visualisierung der logistischen Gerade in einer simplen logistischen Regression mit der Variable crp."><img src="stat-modeling-logistic_files/figure-html/fig-log-pred-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-pred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.4— Visualisierung der logistischen Gerade in einer simplen logistischen Regression mit der Variable <code>crp</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Nun haben wir das Kapitel zur logistischen Regression fast abgeschlossen. Was noch fehlt ist die Besonderheit der Prädiktion im Kontext des maschinellen Lernens. Das machen wir jetzt im folgenden Abschnitt. Wenn dich die logistische Regression nur interessiert hat um einen kausalen Zusammenhang zwischen Einflussvariablen und dem binären Outcome zu modellieren, dann sind wir hier fertig.</p>
</section>
<section id="sec-mult-comp-log-reg" class="level2" data-number="56.8">
<h2 data-number="56.8" class="anchored" data-anchor-id="sec-mult-comp-log-reg"><span class="header-section-number">56.8</span> Gruppenvergleich</h2>
<p>Häufig ist es ja so, dass wir das Modell nur schätzen um dann einen Gruppenvergleich zu rechnen. Das heißt, dass es uns interessiert, ob es einen Unterschied zwischen den Leveln eines Faktors gegeben dem Outcome <span class="math inline">\(y\)</span> gibt. Wir machen den Gruppenvergleich jetzt einmal an der Gebrechlichkeit <code>frailty</code> durch. Wir habe die drei Gruppen <code>frail</code>, <code>pre-frail</code> und <code>robust</code> vorliegen. Wir wollen jetzt wissen, ob es einen Unterschied zwischen den Gruppen hinsichtlich dem Infektionsstatus von den Ferkeln gibt.</p>
<p>Wenn du gerade hierher gesprungen bist, nochmal das simple Modell für unseren Gruppenvergleich. Wir haben hier nur einen Faktor <code>frailty</code> mit in dem Modell. Am Ende des Abschnitts findest du dann noch ein Beispiel mit zwei Faktoren zu beschädigten Mais nach der Ernte.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>log_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(infected <span class="sc">~</span> frailty, <span class="at">data =</span> pig_tbl, <span class="at">family =</span> binomial)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Eigentlich ist es recht einfach. Wir rechnen jetzt als erstes die ANOVA. Hier müssen wir dann einmal den Test angeben, der gerechnet werden soll um die p-Werte zu erhalten. Dann nutze ich noch die Funktion <code>model_parameters()</code> um eine schönere Ausgabe zu erhalten.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>log_fit <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>(<span class="at">test =</span> <span class="st">"Chisq"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">drop =</span> <span class="st">"NULL"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter | df | Deviance | df (error) | Deviance (error) |     p
-----------------------------------------------------------------
frailty   |  2 |     1.48 |        409 |           521.14 | 0.478

Anova Table (Type 1 tests)</code></pre>
</div>
</div>
<p>Wir sehen, dass die Gebrechlichkeit der Ferkel keinen signifikanten Einfluss auf den Infektionsstatus hat. Dennoch rechnen wir einmal den Gruppenvergleich. Immerhin geht es hier ja auch um die Demonstration.</p>
<p>Im folgenden nutzen wir das R Paket <code>{emmeans}</code> wie folgt. Wenn wir die Wahrscheinlichkeiten wiedergeben haben wollen, dann nutzen wir die Option <code>regrid = "response"</code>. In unserem <code>emmeans</code>-Objekt stehen jetzt die Wahrscheinlichkeiten infiziert zu sein für das jeweilige Level von <code>frailty</code>. Wenn wir aber später die <em>Odds ratio</em> benötigen, dann müssen wir die Option <code>type = "response"</code> verwenden. Erstere Option nutze ich später um direkt aus der <code>emmeans</code> Ausgabe ein Säulendiagramm zu erstellen. Auf dem ersten Blick sind beide Ausgaben gleich, aber im Hintergrund werden andere Optionen gesetzt, so dass in folgenden Berechnungen dann was anderes herauskommt.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Option <code>regrid = "response"</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Option <code>type = "response"</code></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Mit dieser Option erhalten wir dann ein <code>emmeans</code>-Objekt in dem die Wahrscheinlichkeiten <code>prob</code> hinterlegt sind. Diese Art der Berechnung eignet sich besonders, wenn später ein <em>compact letter dislay</em> visualisiert werden soll.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>em_prob_obj <span class="ot">&lt;-</span> log_fit <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> frailty, <span class="at">regrid =</span> <span class="st">"response"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>em_prob_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> frailty    prob     SE  df asymp.LCL asymp.UCL
 frail     0.673 0.0633 Inf     0.549     0.797
 pre-frail 0.706 0.0381 Inf     0.632     0.781
 robust    0.645 0.0327 Inf     0.581     0.709

Confidence level used: 0.95 </code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Mit dieser Option bereiten wir dann die Berechnung von <em>Odds ratios</em> vor. Wir wollen dann auf der ursprünglichen Skala rechnen und nicht auf der Linkfunktion. Wenn du also <em>Odds ratios</em> haben willst, dann musst du diese Option wählen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>em_odds_obj <span class="ot">&lt;-</span> log_fit <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> frailty, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>em_odds_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> frailty    prob     SE  df asymp.LCL asymp.UCL
 frail     0.673 0.0633 Inf     0.539     0.783
 pre-frail 0.706 0.0381 Inf     0.627     0.775
 robust    0.645 0.0327 Inf     0.578     0.706

Confidence level used: 0.95 
Intervals are back-transformed from the logit scale </code></pre>
</div>
</div>
<p>Achtung, das Objekt sieht jetzt zwar sehr ähnlich aus, aber für die weitere Berechnung macht es dann doch einen Unterschied welchen <code>type</code> du nutzt.</p>
</div>
</div>
</div>
<p>Wenn du un an den <em>Odds ratios</em> und den p-Werten interessiert bist, dann kannst du den Gruppenvergleich mit der Funktion <code>contrast()</code> rechnen. Wir wollen hier alle paarweisen Vergleiche rechnen. Wie immer kannst du auch die Adjustierung anpassen, wenn du möchtest.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>em_odds_obj <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast             odds.ratio    SE  df null z.ratio p.value
 frail / (pre-frail)       0.855 0.291 Inf    1  -0.460  1.0000
 frail / robust            1.132 0.363 Inf    1   0.386  1.0000
 (pre-frail) / robust      1.324 0.308 Inf    1   1.208  0.6815

P value adjustment: bonferroni method for 3 tests 
Tests are performed on the log odds ratio scale </code></pre>
</div>
</div>
<p>Wir sehen also, dass wir auch hier keine signifikanten Unterschiede vorliegen haben. Jetzt lassen wir uns nochmal das unadjustierte <em>compact letter display</em> wiedergeben. Aber auch in dem unadjustierten Fall finden wir keine signifikanten Unterschiede.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>em_odds_obj <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> frailty    prob     SE  df asymp.LCL asymp.UCL .group
 robust    0.645 0.0327 Inf     0.578     0.706  a    
 frail     0.673 0.0633 Inf     0.539     0.783  a    
 pre-frail 0.706 0.0381 Inf     0.627     0.775  a    

Confidence level used: 0.95 
Intervals are back-transformed from the logit scale 
Tests are performed on the log odds ratio scale 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Am Ende möchte ich hier nochmal einen Spieldatensatz <code>infected_tbl</code> erstellen indem ich wiederum drei Gruppen miteinander vergleiche. Ich tue mal so als würden wir uns hier zwei Pestizide und eine Kontrolle anschauen. Unser Outcome ist dann, ob wir eine Infektion vorliegen haben oder das Pestizid alles umgebracht hat. Damit haben wir dann unser Outcome <code>infected</code> definiert. Wir bauen uns die Daten so, dass <span class="math inline">\(80%\)</span> der Beobachtungen in der Kontrolle infiziert sind. In den beiden Behandlungsgruppen sind jeweils <span class="math inline">\(50%\)</span> und <span class="math inline">\(30%\)</span> der Beobachtungen nach der Behandlung noch infiziert. Wir haben jeweils zwanzig Pflanzen <code>n_grp</code> beobachtet. Das sind wirklich wenige Beobachtungen für einen <span class="math inline">\(0/1\)</span> Endpunkt, aber es sollte hier reichen. Dann habe ich noch einen Seed gesetzt, damit auch immer die gleichen Zahlen generiert werden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231201</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>n_grp <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>infected_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trt =</span> <span class="fu">gl</span>(<span class="dv">3</span>, n_grp, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"ctrl"</span>, <span class="st">"roundUp"</span>, <span class="st">"killAll"</span>)),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">infected =</span> <span class="fu">c</span>(<span class="fu">rbinom</span>(n_grp, <span class="dv">1</span>, <span class="fl">0.8</span>), </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">rbinom</span>(n_grp, <span class="dv">1</span>, <span class="fl">0.5</span>), </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">rbinom</span>(n_grp, <span class="dv">1</span>, <span class="fl">0.2</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt bauen wir uns wieder unser logistisches Modell zusammen, dass kennst du ja schon. Vorher wollen wir aber nochmal in die Daten schauen. Unser Datensatz hat ja nur ein Outcome und eine Behandlung als Faktor mit drei Leveln bzw. Gruppen. Wir können jetzt einmal nachvollziehen woher die Werte in einer <code>{emmeans}</code>-Ausgabe eigentlich kommen. Schauen wir uns dazu erstmal die Tabelle mit den Infektionen zugeordnet zu den Behandlungen an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>infected_tbl <span class="sc">%$%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(trt, infected) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         infected
trt        0  1
  ctrl     5 15
  roundUp 12  8
  killAll 16  4</code></pre>
</div>
</div>
<p>Jetzt berechnen wir einmal die Anteile der Infektionen in den jeweiligen Behandlungen. Wir würden ja erwarten, dass wir <span class="math inline">\(80%\)</span>, <span class="math inline">\(50%\)</span> und <span class="math inline">\(20%\)</span> vorfinden, aber da wir nur ein kleinen Fallzahl simuliert haben, ergibt sich natürlich eine Abweichung. Wir finden nämlich in den Daten für <em>ctrl</em> gleich <span class="math inline">\(15/20 = 0.75\)</span>, für <em>roundUp</em> gleich <span class="math inline">\(8/20 = 0.4\)</span> und für <em>killAll</em> gleich <span class="math inline">\(4/20 = 0.2\)</span> anteilig Infektionen. Finden wir diese Zahlen auch in <code>{emmeans}</code> wieder?</p>
<p>Als erstes bauen wir uns wieder ein Modell der logistischen Regression.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>infected_log_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(infected <span class="sc">~</span> trt, <span class="at">data =</span> infected_tbl, <span class="at">family =</span> <span class="st">"binomial"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann stecken wir das Modell einmal in <code>emmeans()</code> und schauen uns die Ausgabe an und nutzen die Option <code>regrid = "response"</code> um uns Wahrscheinlichkeiten wiedergeben zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>infected_log_fit  <span class="sc">|&gt;</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt, <span class="at">regrid =</span> <span class="st">"response"</span>) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> trt     prob     SE  df asymp.LCL asymp.UCL
 ctrl    0.75 0.0968 Inf    0.5602     0.940
 roundUp 0.40 0.1095 Inf    0.1853     0.615
 killAll 0.20 0.0894 Inf    0.0247     0.375

Confidence level used: 0.95 </code></pre>
</div>
</div>
<p>Und tatsächlich, wir finden die gleichen Anteile in der Ausgabe wieder, wie wir auch in unseren Daten vorab aus der Tabelle berechnet haben. Wir erhalten also den Anteil der 1-sen in einem Outcome aus der Funktion <code>emmeans()</code> wieder. Der Anteil an 1-sen ist ja auch nichts anderes als der Mittelwert des Outcomes für die Spalte.</p>
<p>Im nächsten Schritt wollen wir einmal die <em>Odds ratios</em> verstehen. Dafür erstmal den Aufruf in <code>emmeans()</code> und dann schauen wir einmal in die Ausgabe. Wir wollen jetzt die <em>Odds ratios</em> einmal händisch berechnen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>infected_log_fit <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt, <span class="at">type =</span> <span class="st">"response"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast          odds.ratio   SE  df null z.ratio p.value
 ctrl / roundUp          4.50 3.10 Inf    1   2.182  0.0742
 ctrl / killAll         12.00 9.13 Inf    1   3.265  0.0031
 roundUp / killAll       2.67 1.92 Inf    1   1.359  0.3626

P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log odds ratio scale </code></pre>
</div>
</div>
<p>Wir wissen ja die Anteile der 1-sen in der Kontrollgruppe <em>ctrl</em> mit <span class="math inline">\(0.75\)</span> sowie den Anteil an 1-sen in der Behandlungsgruppe <em>roundUp</em> mit <span class="math inline">\(0.4\)</span>. Wir haben die Werte ja oben in der Tabelle bestimmt. Jetzt können wir die <em>Odds</em> mit <span class="math inline">\(Odds = p/(1-p)\)</span> für die beiden Gruppen berechnen und dann den Quotienten als <em>Odds ratio</em> berechnen.</p>
<p><span class="math display">\[
ctrl/roundUp = \cfrac{0.75}{0.25}/\cfrac{0.4}{0.6} = 4.5
\]</span></p>
<p>Wie wir sehen, passen die Zahlen. Wir können jetzt auch für die Behandlungsgruppe <em>killAll</em> mit einem Anteil an 1-sen von <span class="math inline">\(0.2\)</span> weitermachen. Auch hier berechnen wir erst die <em>Odds</em> und dann den Quotienten aus den beiden <em>Odds</em>.</p>
<p><span class="math display">\[
ctrl/killAll = \cfrac{0.75}{0.25}/\cfrac{0.2}{0.8} = 12
\]</span></p>
<p>Dann nochmal als Überprüfung den letzten Wert für den Vergleich von <em>roundUp</em> zu <em>killAll</em>.</p>
<p><span class="math display">\[
roundUp/killAll = \cfrac{0.4}{0.6}/\cfrac{0.2}{0.8} = 2.67
\]</span></p>
<p>Nun könntest du einwenden, dass <em>Odds ratios</em> nicht so einfach zu interpretieren sind und du eigentlich nur wissen willst um welchen Faktor <em>mehr</em> oder <em>weniger</em> Infizierte es in einer Gruppe gibt. Also kein Chancenverhältnis sondern eben einfach ein Wahrscheinlichkeitsverhältnis. Du willst also sagen, dass in der Kontrollgruppe x-fach mehr oder weniger infizierte Beobachtungen auftauchen. Damit willst du die Wahrscheinlichkeiten aus der Tabelle weiter oben in ein Verhätnis setzen. Daher willst du folgende Zusammenhänge berechnen.</p>
<p><span class="math display">\[
\cfrac{ctrl}{roundUp} = \cfrac{0.75}{0.4} = 1.88
\]</span></p>
<p><span class="math display">\[
\cfrac{ctrl}{killAll} = \cfrac{0.75}{0.2} = 3.75
\]</span></p>
<p><span class="math display">\[
\cfrac{roundUp}{killAll} = \cfrac{0.4}{0.2} = 2.00
\]</span></p>
<p>Wir können also sagen, dass wir in der Kontrolle ungefähr 1.88 mal mehr Infizierte haben als in der Behandlung <em>roundUp</em>. Oder aber, dass wir in der Kontrolle 3.75 mal mehr Infizierte haben als in der Behandlung <em>killAll</em> Um solche Zahlen zu berechnen, nutzen wir die Poisson Regression auf unseren <span class="math inline">\(0/1\)</span>-Daten. Dafür müssen wir einmal die Option <code>family = "poisson"</code> setzen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>infected_pois_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(infected <span class="sc">~</span> trt, <span class="at">data =</span> infected_tbl, <span class="at">family =</span> <span class="st">"poisson"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir auch schon die Funktion <code>emmeans()</code> anwenden, um uns einmal die Wahrscheinlichkeitsverhältnisse als <code>ratio</code> wiedergeben zu lassen. Wie immer kannst du natürlich den Fit auch erstmal in ein eigenes Objekt stecken und dann noch andere Funktionen in <code>{emmeans}</code> nutzen. Wie du gleich siehst, haben wir aber auch hier keine signifikanten Unterschiede zwischen den Gruppen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>infected_pois_fit <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt, <span class="at">type =</span> <span class="st">"response"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast          ratio    SE  df null z.ratio p.value
 ctrl / roundUp     1.88 0.821 Inf    1   1.436  0.3224
 ctrl / killAll     3.75 2.110 Inf    1   2.349  0.0493
 roundUp / killAll  2.00 1.225 Inf    1   1.132  0.4943

P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale </code></pre>
</div>
</div>
<p>Damit sind wir einmal mit unserem Gruppenvergleich für die logistische Regression auf einem <span class="math inline">\(0/1\)</span> Outcome durch. In dem Kapitel zu den <a href="stat-tests-posthoc2.html">Multiple Vergleichen oder Post-hoc Tests</a> findest du dann noch mehr Inspirationen für die Nutzung von <code>{emmeans}</code>. Hier war es dann die Anwendung auf binäre Outcomes zusammen mit einem Faktor. Wenn du dir das Ganze nochmal an einem Beispiel für zwei Faktoren anschauen möchtest, dann findest du im folgenden Kasten ein Beispiel für die Auswertung von Beschädigungen an Mais nach verschiedenen Ernteverfahren und Zeitpunkten.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Anwendungsbeispiel: Zweifaktorieller Gruppenvergleich für Maisernte
</div>
</div>
<div class="callout-body-container callout-body">
<p>Im folgenden Beispiel schauen wir uns nochmal ein praktische Auswertung von einem agrarwissenschaftlichen Beispiel mit Mais an. Wir haben uns in diesem Experiment verschiedene Arten <code>trt</code> von Ernteverfahren von Mais angeschaut. Dann haben wir nach vier Zeitpunkten bestimmt, ob der Mais durch das Ernteverfahren nachträglich beschädigt war. Die Beschädigung selber wurde dann etwas komplizierter mit einem Labortest festgestellt, aber wir schauen uns nur die Ausprägung ja/nein also <span class="math inline">\(1/0\)</span> als Outcome an. Durch einen Fehler im Labor müssen wir eine Kombination für den letzten Tag und der dritten Behandlung entfernen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>maize_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/maize_rate.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">damaged =</span> <span class="fu">ifelse</span>(time <span class="sc">==</span> <span class="st">"5d"</span> <span class="sc">&amp;</span> trt <span class="sc">==</span> <span class="dv">3</span>, <span class="cn">NA</span>, damaged),</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">trt =</span> <span class="fu">factor</span>(trt, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"wenig"</span>, <span class="st">"mittel"</span>, <span class="st">"viel"</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Dann können wir auch schon die logistische Regression mit <code>glm()</code> rechnen. Auch hier wieder darauf achten, dass wir dann als Option <code>family = binomial</code> wählen und unser Outcome <code>infected</code> als Faktor kodiert ist.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>maize_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(damaged <span class="sc">~</span> trt <span class="sc">+</span> time <span class="sc">+</span> trt<span class="sc">:</span>time, <span class="at">data =</span> maize_tbl, <span class="at">family =</span> binomial) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In den beiden folgenden Tabs findest du dann einmal das Ergebnis für die ANOVA und einmal für den Gruppenvergleich mit dem R Paket <code>{emmeans}</code>. Bitte beachte, dass die ANOVA für ein <code>glm()</code>-Objekt nicht ganz gleich wie für ein <code>lm()</code>-Objekt ist. Du kannst aber die ANOVA erstmal ganz normal interpretieren, nur haben wir hier nicht die Möglichkeit ein <span class="math inline">\(\eta^2\)</span> zu bestimmen. Dann nutzen wir <code>{emmeans}</code> für den Gruppenvergleich.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">ANOVA mit <code>anova()</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Gruppenvergleich mit <code>emmeans()</code></a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Wir rechnen hier einmal die ANOVA und nutzen den <span class="math inline">\(\mathcal{X}^2\)</span>-Test für die Ermittelung der p-Werte. Wir müssen hier einen Test auswählen, da per Standardeinstellung kein Test gerechnet wird. Wir machen dann die Ausageb nochmal schöner und fertig sind wir.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>maize_fit <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>(<span class="at">test =</span> <span class="st">"Chisq"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">drop =</span> <span class="st">"NULL"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Parameter | df | Deviance | df (error) | Deviance (error) |      p
------------------------------------------------------------------
trt       |  2 |    38.74 |        162 |           136.89 | &lt; .001
time      |  3 |    27.46 |        159 |           109.43 | &lt; .001
trt:time  |  5 |     4.00 |        154 |           105.43 | 0.550 

Anova Table (Type 1 tests)</code></pre>
</div>
</div>
<p>Wir sehen, dass der Effekt für die Behandlung und die Zeit signifikant sind. Wir haben aber keine Interaktion vorliegen. Daher können wir dann die Analyse gemeinsam über alle Zeitpunkte rechnen.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>Im Folgenden rechnen wir einmal über alle Faktorkombinationen von <code>trt</code> und <code>time</code> einen Gruppenvergleich. Dafür nutzen wir die Opition <code>trt * time</code>. Wenn du die Analyse <em>getrennt</em> für die Zeitpunkte durchführen willst, dann nutze die Option <code>trt | time</code>. Wir wollen die Wahrscheinlichkeiten für das Auftreten einer Beschädigung von wiedergegeben bekommen, deshalb die Option <code>regrid = "response</code>. Dann adjustieren wir noch nach Bonferroni und sind fertig.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> maize_fit <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt <span class="sc">*</span> time, <span class="at">regrid =</span> <span class="st">"response"</span>) <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>emm_obj</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> trt    time     prob         SE  df  asymp.LCL asymp.UCL .group
 viel   2d   0.133333 0.08777075 Inf -0.1157247  0.382391  a    
 viel   1d   0.400000 0.12649111 Inf  0.0410692  0.758931  ab   
 mittel 5d   0.600000 0.12649111 Inf  0.2410692  0.958931  abc  
 mittel 2d   0.800000 0.10327956 Inf  0.5069343  1.093066   bc  
 viel   1h   0.866667 0.08777075 Inf  0.6176087  1.115725   bc  
 wenig  5d   0.866667 0.08777075 Inf  0.6176087  1.115725   bc  
 mittel 1d   0.933333 0.06440612 Inf  0.7505747  1.116092    c  
 mittel 1h   0.933333 0.06440612 Inf  0.7505747  1.116092    c  
 wenig  1d   1.000000 0.00000883 Inf  0.9999749  1.000025    c  
 wenig  1h   1.000000 0.00000883 Inf  0.9999749  1.000025    c  
 wenig  2d   1.000000 0.00000883 Inf  0.9999749  1.000025    c  
 viel   5d     nonEst         NA  NA         NA        NA       

Confidence level used: 0.95 
Conf-level adjustment: bonferroni method for 11 estimates 
P value adjustment: bonferroni method for 55 tests 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Das <code>emm_obj</code> Objekt werden wir dann gleich einmal in <code>{ggplot}</code> visualisieren. Dann können wir auch das <em>compact letter display</em> anhand der Abbildung interpretieren.</p>
</div>
</div>
</div>
<p>In der <a href="#fig-log-mod-prob-maize" class="quarto-xref">Abbildung&nbsp;<span>56.5</span></a> siehst du das Ergebnis der Auswertung in einem Säulendiagramm. Hier unbedingt <code>SE</code> als den Standardfehler für die Fehlerbalken nutzen, da wir sonst Fehlerbalken größer und kleiner als <span class="math inline">\(0/1\)</span> erhalten, wenn wir die Standardabweichung nutzen würden. Wir sehen einen klaren Effekt der Behandlung <code>viel</code>. Schade, dass wir dann nach 5 Tagen leider keine Auswertung für die dritte Behandlung vorliegen haben. Aber sowas passiert dann unter echten Bedingungen mal schnell.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> prob, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Anteil beschädigter Mais"</span>, <span class="at">x =</span> <span class="st">"Stunden nach Ernte"</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Behandlung"</span>) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> prob <span class="sc">+</span> SE <span class="sc">+</span> <span class="fl">0.01</span>),  </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> prob<span class="sc">-</span>SE, <span class="at">ymax =</span> prob<span class="sc">+</span>SE),</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-log-mod-prob-maize" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-mod-prob-maize-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-logistic_files/figure-html/fig-log-mod-prob-maize-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Abbildung&nbsp;56.5— Säulendigramm der Anteile des beschädigten Mais aus einer logistischen Regression. Das glm()-Modell berechnet die Wahrscheinlichkeiten in jeder Faktorkombination, was dann die Anteile des beschädigten Mais entspricht. Das compact letter display wird dann in {emmeans} generiert."><img src="stat-modeling-logistic_files/figure-html/fig-log-mod-prob-maize-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-mod-prob-maize-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.5— Säulendigramm der Anteile des beschädigten Mais aus einer logistischen Regression. Das <code>glm()</code>-Modell berechnet die Wahrscheinlichkeiten in jeder Faktorkombination, was dann die Anteile des beschädigten Mais entspricht. Das <em>compact letter display</em> wird dann in <code>{emmeans}</code> generiert.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="dichotomisierung" class="level2" data-number="56.9">
<h2 data-number="56.9" class="anchored" data-anchor-id="dichotomisierung"><span class="header-section-number">56.9</span> Dichotomisierung</h2>
<p>Manchmal ist es so, dass wir eine logistsiche Regression rechnen wollen. Wir fragen nicht, wie ist unser <span class="math inline">\(y\)</span> verteilt und was für eine Regression können wir dann rechnen? Sondern wir wollen mit der logistischen Regression durch die Wand. Wenn wir das wollen, dann können wir unser <span class="math inline">\(y\)</span> dichotomisieren. Das heißt, wir machen aus einer Variable, die mehr als zwei Level hat einen Faktor mit zwei Leveln. Dafür stehen uns verschiedene Möglichkeiten offen.</p>
<p>In dem R Paket <code>{dplyr}</code> haben wir mit der Funktion <code>recode()</code> die Möglichkeit eine Variable von <code>alt = neu</code> umzukodieren. Dabei müssen wir natürlich darauf achten, dass wir die alten Level der Variable richtig schreiben und bei der neuen Level nur zwei Namen eintragen. Dann sind wir auch schon durch mit der Umbenennung.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">frailty =</span> <span class="fu">recode</span>(frailty, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"robust"</span> <span class="ot">=</span> <span class="st">"robust"</span>, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"pre-frail"</span> <span class="ot">=</span> <span class="st">"frail_prefrail"</span>, </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"frail"</span> <span class="ot">=</span> <span class="st">"frail_prefrail"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(frailty) <span class="sc">|&gt;</span> <span class="fu">extract</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "robust"         "robust"         "robust"         "robust"        
 [5] "robust"         "robust"         "frail_prefrail" "robust"        
 [9] "robust"         "robust"         "frail_prefrail" "robust"        
[13] "robust"         "robust"         "frail_prefrail" "robust"        
[17] "frail_prefrail" "frail_prefrail" "robust"         "frail_prefrail"</code></pre>
</div>
</div>
<p>Ich finde die Funktion <code>case_when()</code> etwas übersichtlicher. Das ist aber eigentlich nur eine Geschmacksfrage. Am Ende kommt jedenfalls das Gleiche heraus.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">frailty =</span> <span class="fu">case_when</span>(frailty <span class="sc">==</span> <span class="st">"robust"</span> <span class="sc">~</span> <span class="st">"robust"</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                           frailty <span class="sc">==</span> <span class="st">"pre-frail"</span> <span class="sc">~</span> <span class="st">"frail"</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                           frailty <span class="sc">==</span> <span class="st">"frail"</span> <span class="sc">~</span> <span class="st">"frail"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(frailty) <span class="sc">|&gt;</span> <span class="fu">extract</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "robust" "robust" "robust" "robust" "robust" "robust" "frail"  "robust"
 [9] "robust" "robust" "frail"  "robust" "robust" "robust" "frail"  "robust"
[17] "frail"  "frail"  "robust" "frail" </code></pre>
</div>
</div>
<p>Häufig haben wir auch den Fall, dass wir keine kontinuierlichen <span class="math inline">\(x\)</span> in unseren Daten wollen. Alles soll sich in Faktoren verwandeln, so dass wir immer eine 2x2 Tafel haben. Wenn es sein muss, liefert hier <code>cutpointr()</code> die Lösung für dieses Problem. Wir müssen dafür zum einen unser kontinuierliches <span class="math inline">\(x\)</span> angeben und dann mit <code>class</code> unser binäres <span class="math inline">\(y\)</span>. Wir erhalten dann für unser <span class="math inline">\(y\)</span> den bestmöglichen Split für unser <span class="math inline">\(x\)</span>. Im Beispiel wollen wir einmal die Variable <code>crp</code> für unser Outcome <code>infected</code> in zwei Gruppen aufteilen. Wir wollen eigentlich immer zwei Gruppen, da wir dann in dem Setting eines <span class="math inline">\(\mathcal{X}^2\)</span>-Test und einer einfacheren Interpretation von dem <span class="math inline">\(OR\)</span> sind.</p>
<p>Wir immer haben wir eine große Bandbreite an Optionen, wie wir den besten Split unseres <span class="math inline">\(x\)</span> kriegen wollen. Ich gehe hier mit den Default-Werten. Damit kommt man eigentlich recht weit. Ich möchte gerne die Summe der Sensivität und der Spezifität <code>sum_sens_spec</code> über alle möglichen Cutpoints maximieren <code>maximize_metric</code>. Der Cutpoint mit der maximalen Summe an Sensivität und der Spezifität wird mir dann wiedergegeben. Natürlich hat das R Paket <code>{cutpoint}</code> noch viel mehr Optionen. Mehr gibt es in <a href="https://cran.r-project.org/web/packages/cutpointr/vignettes/cutpointr.html">An introduction to cutpointr</a>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>cp_crp <span class="ot">&lt;-</span> <span class="fu">cutpointr</span>(<span class="at">data =</span> pig_tbl,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> crp,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">class =</span> infected,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> maximize_metric, </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metric =</span> sum_sens_spec) </span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>cp_crp</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 16
  direction optimal_cutpoint method          sum_sens_spec      acc sensitivity
  &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;                   &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;
1 &gt;=                   19.71 maximize_metric       1.48870 0.752427    0.768116
  specificity      AUC pos_class neg_class prevalence outcome  predictor
        &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    
1    0.720588 0.806119         1         0   0.669903 infected crp      
  data               roc_curve             boot 
  &lt;list&gt;             &lt;list&gt;                &lt;lgl&gt;
1 &lt;tibble [412 × 2]&gt; &lt;rc_ctpnt [282 × 10]&gt; NA   </code></pre>
</div>
</div>
<p>In <a href="#fig-crp-bin" class="quarto-xref">Abbildung&nbsp;<span>56.6</span></a> sehe wir die Ausgabe der Funktion <code>cutpointr()</code> nochmal visualisiert. Wir sehen, dass der Split einigermaßen die <code>crp</code>-Werte im Sinne von unserem Outcome aufteilt.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cp_crp)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-crp-bin" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-crp-bin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-logistic_files/figure-html/fig-crp-bin-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Abbildung&nbsp;56.6— Visualisierung des Ergebnisses der Funktion cutpointr für die Variable crp."><img src="stat-modeling-logistic_files/figure-html/fig-crp-bin-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="864"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-crp-bin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.6— Visualisierung des Ergebnisses der Funktion <code>cutpointr</code> für die Variable <code>crp</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Wir können uns jetzt noch den optimalen Cutpoint aus der Ausgabe herausziehen, wenn wir den Punkt nicht aus der Ausgabe ablesen wollen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pluck</span>(cp_crp, <span class="st">"optimal_cutpoint"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19.71</code></pre>
</div>
</div>
<p>Am Ende können wir dann über <code>case_when()</code> uns ein binären CRP-Wert zusammenbauen. Wir müssen dann natürlich entscheiden welche Variable wir mit ins Modell nehme, aber meistens machen wir uns ja die Mühen um dann die neue Variable zu verwenden.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="sc">|&gt;</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">crp_bin =</span> <span class="fu">case_when</span>(crp <span class="sc">&gt;=</span> <span class="fl">19.84</span> <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                           crp <span class="sc">&lt;</span> <span class="fl">19.84</span> <span class="sc">~</span> <span class="st">"low"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(crp, crp_bin)  </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 412 × 2
     crp crp_bin
   &lt;dbl&gt; &lt;chr&gt;  
 1  22.4 high   
 2  18.6 low    
 3  18.8 low    
 4  19.4 low    
 5  21.6 high   
 6  21.4 high   
 7  19.0 low    
 8  19.0 low    
 9  21.9 high   
10  21.0 high   
# ℹ 402 more rows</code></pre>
</div>
</div>
<p>Damit haben wir uns dann auch mit dem Problem der Dichotomisierung in der logististischen Regression einmal beschäftigt. Somit bleibt dann noch die Prädiktion übrig.</p>
</section>
<section id="prädiktion" class="level2 page-columns page-full" data-number="56.10">
<h2 data-number="56.10" class="anchored" data-anchor-id="prädiktion"><span class="header-section-number">56.10</span> Prädiktion</h2>
<p>Da wir später in dem <a href="classification-basic.html" class="quarto-xref"><span>Kapitel 71</span></a> die logistische Regression auch als Vergleich zu maschinellen Lernverfahren in der Klassifikation nutzen werden gehen wir hier auch die Prädiktion einmal für die logistische Regression durch. Wir wollen also eine Klassifikation, also eine Vorhersage, für das Outcome <code>infected</code> mit einer logistischen Regression rechnen. Wir nutzen dazu die Möglichkeiten des R Pakets <code>{tidymodels}</code> wodurch wir einfacher ein Modell bauen und eine Klassifikation rechnen können. Unsere Fragestellung ist, ob wir mit unseren Einflussvariablen den Infektionsstatus vorhersagen können. Das heißt wir wollen ein Modell bauen mit dem wir <em>zukünftige</em> Ferkel als potenziell krank oder gesund anhand unser erhobenen Daten einordnen bzw. klassifizieren können.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Mehr zu Rezepten (eng. <em>recipes</em>) kannst du im <a href="classification-basic.html" class="quarto-xref"><span>Kapitel 71</span></a> zu den Grundlagen des maschinellen Lernens erfahren.</p>
</div></div><p>Der erste Schritt einer Klassifikation ist immer sicherzustellen, dass unser Outcome auch wirklich aus Kategorien besteht. In R nutzen wir dafür einen Faktor und setzen dann auch gleich die Ordnung fest.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="ot">&lt;-</span> pig_tbl <span class="sc">|&gt;</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">infected =</span> <span class="fu">factor</span>(infected, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Nun bauen wir uns ein einfaches Rezept mit der Funktion <code>recipe()</code>. Dafür legen wir das Modell, was wir rechnen wollen einmal fest. Wir nehmen <code>infected</code> als Outcome und den Rest der Vairbalen <code>.</code> aus dem Datensatz <code>pig_tbl</code> als die <span class="math inline">\(x\)</span> Variablen. Dann wollen wir noch alle Variablen, die ein Faktor sind in eine Dummyvariable umwandeln.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>pig_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(infected <span class="sc">~</span> ., <span class="at">data =</span> pig_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Wir wollen jetzt unser Modell definieren. Wir rechnen eine logistsiche Regression und deshalb nutzen wir die Funktion <code>logistic_reg()</code>. Da wir wirklich viele Möglichkeiten <em>hätten</em> die logistische Regression zu rechnen, müssen wir noch den Algorithmus wählen. Das tuen wir mit der Funktion <code>set_engine()</code>. Wir nutzen hier den simplen <code>glm()</code> Algorithmus. Es gebe aber auch andere Implementierungen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>logreg_mod <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glm"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Jetzt müssen wir noch einen Workflow definieren. Wir wollen ein Modell rechnen und zwar mit den Informationen in unserem Rezept. Das bauen wir einmal zusammen und schauen uns die Ausgabe an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>pig_wflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(logreg_mod) <span class="sc">|&gt;</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(pig_rec)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>pig_wflow</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: logistic_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
1 Recipe Step

• step_dummy()

── Model ───────────────────────────────────────────────────────────────────────
Logistic Regression Model Specification (classification)

Computational engine: glm </code></pre>
</div>
</div>
<p>Das passt alles soweit. Ja, es ist etwas kompliziert und das ginge sicherlich auch einfacher. Wir werden dann aber noch sehen, dass wir es uns mit dem Ablauf sehr viel einfacher machen, wenn wir kompliziertere Modelle schätzen wollen. Mehr dazu findest du dann im <a href="classification-basic.html" class="quarto-xref"><span>Kapitel 71</span></a> zu den maschinellen Lernverfahren.</p>
<p>Jetzt können wir den Workflow nutzen um den Fit zu rechnen. Bis jetzt haben wir nur Informationen gesammelt. Dadurch das wir jetzt das Objekt <code>pig_workflow</code> in die Funktion <code>fit()</code> pipen rechnen wir das Modell.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>pig_fit <span class="ot">&lt;-</span> pig_wflow <span class="sc">|&gt;</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> pig_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Das erhaltende Modell könne wir dann in die Funktion <code>predict()</code> stecken um uns den Inektionsstatus vorhersagen zu lassen.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(pig_fit, <span class="at">new_data =</span> pig_tbl)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 412 × 1
   .pred_class
   &lt;fct&gt;      
 1 1          
 2 0          
 3 0          
 4 1          
 5 1          
 6 1          
 7 0          
 8 0          
 9 1          
10 1          
# ℹ 402 more rows</code></pre>
</div>
</div>
<p>In der Spalte <code>.pred_class</code> finden wir dann die <em>vorhergesagten</em> Werte des Infektionsstatus anhand unseres gefitteten Modells. Eigentlich würden wir ja gerne die vorhergesagten Werte mit unseren Orginalwerten vergleichen. Hier hilft uns die Funktion <code>augment()</code>. Dank der Funktion <code>augment()</code> erhalten wir nicht nur die vorhergesagten Klassen sondern auch die Wahrscheinlichkeit für die Klassenzugehörigkeiten. Daneben dann aber auch die Originalwerte für den Infektionsstatus in der Spalte <code>infected</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>pig_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(pig_fit, <span class="at">new_data =</span> pig_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(infected, <span class="fu">matches</span>(<span class="st">"^</span><span class="sc">\\</span><span class="st">."</span>))</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>pig_aug</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 412 × 4
   infected .pred_class .pred_0 .pred_1
   &lt;fct&gt;    &lt;fct&gt;         &lt;dbl&gt;   &lt;dbl&gt;
 1 1        1            0.0229   0.977
 2 1        0            0.787    0.213
 3 0        0            0.540    0.460
 4 1        1            0.391    0.609
 5 1        1            0.128    0.872
 6 1        1            0.102    0.898
 7 1        0            0.559    0.441
 8 0        0            0.687    0.313
 9 1        1            0.0556   0.944
10 1        1            0.193    0.807
# ℹ 402 more rows</code></pre>
</div>
</div>
<p>Wir können dann die Werte aus dem Objekt <code>pig_aug</code> nutzen um uns die ROC Kurve als Güte der Vorhersage wiedergeben zu lassen. Wir nutzen hier die schnelle Variante der Ploterstellung. In dem <a href="classification-model-compare.html#sec-class-model-compare" class="quarto-xref"><span>Kapitel 74.6</span></a> zum Vergleich von Algorithmen gehe ich noch näher auf die möglichen Optionen bei der Erstellung einer ROC Kurve ein. Hier fällt die ROC Kurve dann mehr oder minder vom Himmel. Ich musste noch der Funktion mitgeben, dass das Event bei uns das zweite Level des Faktors <code>infected</code> ist. Sonst ist unsere ROC Kurve einmal an der Diagonalen gespiegelt.</p>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="margin-aside">In dem <a href="stat-tests-diagnostic.html" class="quarto-xref"><span>Kapitel 39</span></a> erfährst du mehr darüber was eine ROC Kurve ist und wie du die ROC Kurve interpretieren kannst.</span></div></div>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>pig_aug <span class="sc">|&gt;</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">roc_curve</span>(<span class="at">truth =</span> infected, .pred_1, <span class="at">event_level =</span> <span class="st">"second"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-log-roc" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-log-roc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="stat-modeling-logistic_files/figure-html/fig-log-roc-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Abbildung&nbsp;56.7— ROC Kurve für die Vorhersage des Infektionsstatus der Ferkel anhand der erhobenen Daten."><img src="stat-modeling-logistic_files/figure-html/fig-log-roc-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-log-roc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Abbildung&nbsp;56.7— ROC Kurve für die Vorhersage des Infektionsstatus der Ferkel anhand der erhobenen Daten.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Na das hat doch mal gut funktioniert. Die ROC Kurve verläuft zwar nicht ideal aber immerhin ist die ROC Kurve weit von der Diagnolen entfernt. Unser Modell ist also in der Lage den Infektionsstatus der Ferkel einigermaßen solide vorherzusagen. Schauen wir uns noch die <em>area under the curve</em> (abk. <em>AUC</em>) an.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>R Code [zeigen / verbergen]</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>pig_aug <span class="sc">|&gt;</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">roc_auc</span>(<span class="at">truth =</span> infected, .pred_1, <span class="at">event_level =</span> <span class="st">"second"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  .metric .estimator .estimate
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
1 roc_auc binary         0.819</code></pre>
</div>
</div>
<p>Der beste Wert wäre hier eine AUC von <span class="math inline">\(1\)</span> und damit eine perfekte Vorhersage. Der schlechteste Wert wäre eine AUC von <span class="math inline">\(0.5\)</span> und damit eine nahezu zufällige Zuordnung des Infeketionsstatus zu den Ferkeln von unserem Modell. Mit einer AUC von <span class="math inline">\(0.83\)</span> können wir aber schon gut leben. Immerhin haben wir kaum am Modell rumgeschraubt bzw. ein Tuning betrieben. Wenn du mehr über Tuning und der Optimierung von Modellen zu Klassifikation wissen willst, dan musst du im <a href="classification-basic.html" class="quarto-xref"><span>Kapitel 71</span></a> zu den maschinellen Lernverfahren anfangen zu lesen.</p>
</section>
<section id="referenzen" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="referenzen">Referenzen</h2>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-dormann2013parametrische" class="csl-entry" role="listitem">
Dormann CF. 2013. Parametrische Statistik. Springer.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./stat-modeling-multinom.html" class="pagination-link" aria-label="Multinomiale / Ordinale Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Multinomiale / Ordinale Regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./stat-modeling-prob-model.html" class="pagination-link" aria-label="Linear Probability Model">
        <span class="nav-page-text"><span class="chapter-number">57</span>&nbsp; <span class="chapter-title">Linear Probability Model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Quellcode</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb75" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE}</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, readxl, knitr, kableExtra)</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistische Regression {#sec-logistic}</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>*Letzte Änderung am `r format(fs::file_info("stat-modeling-logistic.qmd")$modification_time, '%d. %B %Y um %H:%M:%S')`*</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; *"Sometimes I feel like everybody is a sexy baby and I'm a monster on the hill." --- Taylor Swift, Anti-Hero*</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>Die logistische Regression ist *die* Regression, wenn wir rüber in die Medizin schauen. Wohl in keinem Bereich der Wissenschaften wird so viel eine logistische Regression gerechnet wie in der Humanmedizin, Epidemiologie oder Pharmazie. Wir haben in der logistischen Regression ein $0/1$ Outcome als $y$ vorliegen. Also entweder ist eine Beobachtung erkrankt oder nicht. Meistens beschränkt sich die Betrachtung auf erkrankt ($1$, ja) oder eben nicht erkrankt ($0$, nein) bzw. gesund. Wichtig hierbei ist, dass wir eigentlich immer sagen, dass das *Schlechte* mit $1$ kodiert wird. Wenn du das machst, dann wird dir die Interpretation der Effektschätzer der logistischen Regression leichter fallen.</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>Gleich zu Beginn dann nochmal wir werden die logistische Regression in den Agrarwissenschaften eher selten sehen. Im Bereich der Pflanzenwissenschaften kommt die logistische Regression kaum bis gar nicht vor. Im Bereich der Tierwissenschaften schon eher, aber dort dann im Bereich der Tiermedizin und eben wieder Erkrankungen.</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>Wo wir hingegen dann wieder die logistische Regression brauchen, ist bei der Klassifikation oder eben der Vorhersage von einem binären Ereignis. Dafür bietet sich dann die logistische Regression wieder an. Deshalb werden wir am Ende des Kapitels nochmal was zur Klassifikation machen, obwohl das hier eigentlich nur so halb reinpasst. Wenn du nicht Klassifizieren willst, dann lasse den letzten Abschnitt einfach weg.</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a><span class="fu">## Weitere Tutorien für die logistische Regression</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Das Tutorium <span class="co">[</span><span class="ot">Logistic Regression by Steven V. Miller</span><span class="co">](https://post8000.svmiller.com/lab-scripts/logistic-regression-lab.html#Elsewhere_on_My_Website)</span> erklärt nochmal die logistische Regression von vorne bis hinten, wie ich es hier nicht in dem Detail kann. Wenn du mehr zu logistischen Regression lesen willst, dann ist es eine wirkliche Empfehlung.</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## Annahmen an die Daten</span></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>Unser gemessenes Outcome $y$ folgt einer Binomialverteilung. Damit finden wir im Outcome nur $0$ oder $1$ Werte. Im folgenden Kapitel zu der multiplen logistischen linearen Regression gehen wir davon aus, dass die Daten in der vorliegenden Form *ideal* sind. Das heißt wir haben weder fehlende Werte vorliegen, noch haben wir mögliche Ausreißer in den Daten. Auch wollen wir keine Variablen selektieren. Wir nehmen alles was wir haben mit ins Modell. Sollte eine oder mehre Bedingungen nicht zutreffen, dann schaue dir einfach die folgenden Kapitel an.</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wenn du fehlende Werte in deinen Daten vorliegen hast, dann schaue bitte nochmal in das @sec-missing zu Imputation von fehlenden Werten.</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wenn du denkst, dass du Ausreißer oder auffällige Werte in deinen Daten hast, dann schaue doch bitte nochmal in das @sec-outlier zu Ausreißer in den Daten.</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Wenn du denkst, dass du zu viele Variablen in deinem Modell hast, dann hilft dir das @sec-variable-selection bei der Variablenselektion.</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>Daher sieht unser Modell wie folgt aus. Wir haben ein $y$ und $p$-mal $x$. Wobei $p$ für die Anzahl an Variablen auf der rechten Seite des Modells steht. Im Weiteren folgt unser $y$ einer Binomailverteilung. Damit finden wir im Outcome nur $0$ oder $1$ Werte. Das ist hier sehr wichtig, denn wir wollen ja eine multiple logistische lineare Regression rechnen. In R nutzen wir dazu die Funktion <span class="in">`glm()`</span> mit der Option <span class="in">`family = binomial`</span>.</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>y \sim x_1 + x_2 + ... + x_p </span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a>Dann würde das Modell in R wie folgt aussehen.</span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(y <span class="sc">~</span> x_1 <span class="sc">+</span> x_2, ..., <span class="at">family =</span> binomial)</span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-47"><a href="#cb75-47" aria-hidden="true" tabindex="-1"></a>Neben der Möglichkeit, dass wir $0/1$ im Outcome $y$ haben, könnten wir auch unser Outcome anders beschreiben. Wir nutzen dann dafür das <span class="co">[</span><span class="ot">Wilkinson-Rogers Format</span><span class="co">](https://edgarhassler.com/posts/wilkinson-rogers-notation/)</span> welches dann den Anteil an Erfolgen an Fehlschlägen beschreibt. Wir schreiben aber in das Modell die konkrete Anzahl an Erfolgen und Fehlschlägen.</span>
<span id="cb75-48"><a href="#cb75-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-49"><a href="#cb75-49" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-50"><a href="#cb75-50" aria-hidden="true" tabindex="-1"></a>(Success|Failure) \sim x_1 + x_2 + ... + x_p </span>
<span id="cb75-51"><a href="#cb75-51" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-52"><a href="#cb75-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-53"><a href="#cb75-53" aria-hidden="true" tabindex="-1"></a>In R würden wir dann die *zwei* Spalten mit der Anzahl an Erfolgen und Fehlschlägen mit <span class="in">`cbind()`</span> zusammenfassen und in <span class="in">`glm()`</span> ergänzen. Daher würden wir dann in R wie folgt schreiben.</span>
<span id="cb75-54"><a href="#cb75-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-57"><a href="#cb75-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-58"><a href="#cb75-58" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb75-59"><a href="#cb75-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-60"><a href="#cb75-60" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(<span class="fu">cbind</span>(success, failure) <span class="sc">~</span> x_1 <span class="sc">+</span> x_2, ..., <span class="at">family =</span> binomial)</span>
<span id="cb75-61"><a href="#cb75-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-62"><a href="#cb75-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-63"><a href="#cb75-63" aria-hidden="true" tabindex="-1"></a>Wir können in dem Modell auch Faktoren $f$ haben, aber es geht hier am Anfang des Kapitels nicht um einen reinen Gruppenvergleich. Das ist ganz wichtig. Wenn du einen Gruppenvergleich rechnen willst, dann musst du in @sec-mult-comp-log-reg nochmal nachlesen, wir du dann das Modell weiterverwendest.</span>
<span id="cb75-64"><a href="#cb75-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-65"><a href="#cb75-65" aria-hidden="true" tabindex="-1"></a><span class="fu">## Genutzte R Pakete</span></span>
<span id="cb75-66"><a href="#cb75-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-67"><a href="#cb75-67" aria-hidden="true" tabindex="-1"></a>Wir wollen folgende R Pakete in diesem Kapitel nutzen.</span>
<span id="cb75-68"><a href="#cb75-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-69"><a href="#cb75-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = TRUE}</span></span>
<span id="cb75-70"><a href="#cb75-70" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb75-71"><a href="#cb75-71" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, magrittr, conflicted, broom,</span></span>
<span id="cb75-72"><a href="#cb75-72" aria-hidden="true" tabindex="-1"></a><span class="in">               parameters, performance, gtsummary, see,</span></span>
<span id="cb75-73"><a href="#cb75-73" aria-hidden="true" tabindex="-1"></a><span class="in">               tidymodels, cutpointr, emmeans, multcomp,</span></span>
<span id="cb75-74"><a href="#cb75-74" aria-hidden="true" tabindex="-1"></a><span class="in">               conflicted)</span></span>
<span id="cb75-75"><a href="#cb75-75" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(yardstick::accuracy)</span></span>
<span id="cb75-76"><a href="#cb75-76" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(dplyr::select)</span></span>
<span id="cb75-77"><a href="#cb75-77" aria-hidden="true" tabindex="-1"></a><span class="in">conflicts_prefer(magrittr::extract)</span></span>
<span id="cb75-78"><a href="#cb75-78" aria-hidden="true" tabindex="-1"></a><span class="in">cbbPalette &lt;- c("#000000", "#E69F00", "#56B4E9", "#009E73", </span></span>
<span id="cb75-79"><a href="#cb75-79" aria-hidden="true" tabindex="-1"></a><span class="in">                "#F0E442", "#0072B2", "#D55E00", "#CC79A7")</span></span>
<span id="cb75-80"><a href="#cb75-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-81"><a href="#cb75-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-82"><a href="#cb75-82" aria-hidden="true" tabindex="-1"></a>An der Seite des Kapitels findest du den Link *Quellcode anzeigen*, über den du Zugang zum gesamten R-Code dieses Kapitels erhältst.</span>
<span id="cb75-83"><a href="#cb75-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-84"><a href="#cb75-84" aria-hidden="true" tabindex="-1"></a><span class="fu">## Daten</span></span>
<span id="cb75-85"><a href="#cb75-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-86"><a href="#cb75-86" aria-hidden="true" tabindex="-1"></a>In diesem Kapitel nutzen wir die infizierten Ferkel als Beispieldatensatz. Wir haben in dem Datensatz über vierhundert Ferkel untersucht und festgehalten, ob die Ferkel infiziert sind ($1$, ja) oder nicht infiziert ($0$, nein). Wir haben daneben noch eine ganze Reihe von *Risiko*faktoren erhoben. Hier sieht man mal wieder wie wirr die Sprache der Statistik ist. Weil wir rausfinden wollen welche Variable das Risiko für die Infektion erhöht, nennen wir diese Variablen Risikofaktoren. Obwohl die Variablen gar keine kategorialen Spalten sind bzw. nicht alle. So ist das dann in der Statistik, ein verwirrender Begriff jagt den Nächsten.</span>
<span id="cb75-87"><a href="#cb75-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-90"><a href="#cb75-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-91"><a href="#cb75-91" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/infected_pigs.xlsx"</span>) </span>
<span id="cb75-92"><a href="#cb75-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-93"><a href="#cb75-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-94"><a href="#cb75-94" aria-hidden="true" tabindex="-1"></a>Schauen wir uns nochmal einen Ausschnitt der Daten in der @tbl-log-pigs an.</span>
<span id="cb75-95"><a href="#cb75-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-98"><a href="#cb75-98" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-99"><a href="#cb75-99" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb75-100"><a href="#cb75-100" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-101"><a href="#cb75-101" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-102"><a href="#cb75-102" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-log-pigs</span></span>
<span id="cb75-103"><a href="#cb75-103" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Auszug aus dem Daten zu den kranken Ferkeln.</span></span>
<span id="cb75-104"><a href="#cb75-104" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb75-105"><a href="#cb75-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-106"><a href="#cb75-106" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">head</span>(pig_tbl),</span>
<span id="cb75-107"><a href="#cb75-107" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">"..."</span>, <span class="at">times =</span> <span class="fu">ncol</span>(pig_tbl)),</span>
<span id="cb75-108"><a href="#cb75-108" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tail</span>(pig_tbl)) <span class="sc">|&gt;</span> </span>
<span id="cb75-109"><a href="#cb75-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">align =</span> <span class="st">"c"</span>, <span class="st">"pipe"</span>)</span>
<span id="cb75-110"><a href="#cb75-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-111"><a href="#cb75-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-112"><a href="#cb75-112" aria-hidden="true" tabindex="-1"></a>In dem nächsten Abschnitt werden wir die Daten nutzen um rauszufinden welche Variablen einen Einfluss auf den Infektionsstatus der Ferkel hat.</span>
<span id="cb75-113"><a href="#cb75-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-114"><a href="#cb75-114" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theoretischer Hintergrund</span></span>
<span id="cb75-115"><a href="#cb75-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-116"><a href="#cb75-116" aria-hidden="true" tabindex="-1"></a>Wir schaffen wir es, durch einen $0/1$ Outcome auf der y-Achse eine gerade Linie durch die Punkte zu zeichnen und die Koeffiziente dieser Gerade zu bestimmen? Immerhin gibt es ja gar keine Werte zwischen $0$ und $1$. In @fig-log-activity sehen wir beispielhaft den Zusammenhang zwischen dem Infektionsstatus und der Aktivität der Ferkel. Wir haben zwei horizontale Linien. Wie zeichen wir jetzt da eine Gerade durch?</span>
<span id="cb75-117"><a href="#cb75-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-120"><a href="#cb75-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-121"><a href="#cb75-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb75-122"><a href="#cb75-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-123"><a href="#cb75-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-log-activity</span></span>
<span id="cb75-124"><a href="#cb75-124" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb75-125"><a href="#cb75-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb75-126"><a href="#cb75-126" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb75-127"><a href="#cb75-127" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung des Zusammenhangs zwischen dem Infektionsstatus und der Aktivität der Ferkel."</span></span>
<span id="cb75-128"><a href="#cb75-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-129"><a href="#cb75-129" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pig_tbl, <span class="fu">aes</span>(<span class="at">x =</span> activity, <span class="at">y =</span> infected)) <span class="sc">+</span></span>
<span id="cb75-130"><a href="#cb75-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb75-131"><a href="#cb75-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-132"><a href="#cb75-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb75-133"><a href="#cb75-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-134"><a href="#cb75-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-135"><a href="#cb75-135" aria-hidden="true" tabindex="-1"></a>In der folgenden @fig-log-activity-2 sehen wir nochmal die gleiche Darstellung der Daten aus dem R Paket <span class="in">`{see}`</span> und der entsprechenden Funktion <span class="in">`geom_binomdensity()`</span>. Leider ist die Nutzung nicht so, wie du <span class="in">`{ggplot}`</span> gewohnt bist, aber für die Darstellung hier ist es sehr angenehm die Verteilung der Beobachtungen besser zu sehen. Du siehst hier einmal ganz gut, wie sich die $0/1$-Werte für die infizierten Schweine über die Werte der Aktivität anordnen. In der obigen Abbdilung sind dann eben die Punkte alle übereinander angeordnet.</span>
<span id="cb75-136"><a href="#cb75-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-139"><a href="#cb75-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-140"><a href="#cb75-140" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb75-141"><a href="#cb75-141" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-142"><a href="#cb75-142" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-log-activity-2</span></span>
<span id="cb75-143"><a href="#cb75-143" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb75-144"><a href="#cb75-144" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb75-145"><a href="#cb75-145" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb75-146"><a href="#cb75-146" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung des Zusammenhangs zwischen dem Infektionsstatus und der Aktivität der Ferkel."</span></span>
<span id="cb75-147"><a href="#cb75-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-148"><a href="#cb75-148" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb75-149"><a href="#cb75-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb75-150"><a href="#cb75-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_binomdensity</span>(pig_tbl, <span class="at">x =</span> <span class="st">"activity"</span>, <span class="at">y =</span> <span class="st">"infected"</span>) <span class="sc">+</span></span>
<span id="cb75-151"><a href="#cb75-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb75-152"><a href="#cb75-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-153"><a href="#cb75-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-154"><a href="#cb75-154" aria-hidden="true" tabindex="-1"></a>Der Trick hierbei ist wieder die Transformation des *Zusammenhangs* von $y \sim x$ auf einen $\log$-scale. Das heißt wir Rechnen nicht mit den $0/1$ Werten sondern transformieren den gesamten Zusammenhang. Das ist wichtig, den es gibt einen Unterschied zwischen der Transformation von $y$ und der Transformation die hier gemeint ist. Wir halten fest, wir rechnen also nicht auf der ursprünglichen Skala der Daten sondern auf der $\log$-scale. Allgemeiner wird auch von der *link*-Funktion gesprochen, da wir ja verschiedene Möglichkeiten der Transformation des Zusammenhangs haben.</span>
<span id="cb75-155"><a href="#cb75-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-156"><a href="#cb75-156" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Hier gibt es nur die Kurzfassung der *link*-Funktion. @dormann2013parametrische liefert hierzu in Kapitel 7.1.3 nochmal ein Einführung in das Thema.</span><span class="co">]</span>{.aside}</span>
<span id="cb75-157"><a href="#cb75-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-158"><a href="#cb75-158" aria-hidden="true" tabindex="-1"></a>Wir gehen wir also vor. Zuerst Modellieren wir die Wahrscheinlichkeit für den Eintritt des Ereignisses. Wir machen also aus unseren binären $0/1$ Daten eine Wahrscheinlichkeit für den Eintritt von 1.</span>
<span id="cb75-159"><a href="#cb75-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-160"><a href="#cb75-160" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-161"><a href="#cb75-161" aria-hidden="true" tabindex="-1"></a>Y \rightarrow Pr(Y = 1)</span>
<span id="cb75-162"><a href="#cb75-162" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-163"><a href="#cb75-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-164"><a href="#cb75-164" aria-hidden="true" tabindex="-1"></a>Damit haben wir schon was erreicht den $Pr(Y = 1)$ liegt zwischen $0$ und $1$. Damit haben wir also schon Werte *dazwischen*. Wenn wir aber normalverteilte Residuen haben wollen, dann müssen unsere Werte von $-\infty$ bis $+\infty$ laufen können. Daher rechnen wir im Weiteren die Chance.</span>
<span id="cb75-165"><a href="#cb75-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-166"><a href="#cb75-166" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-167"><a href="#cb75-167" aria-hidden="true" tabindex="-1"></a>\cfrac{Pr(y = 1)}{1 - Pr(Y = 1)}</span>
<span id="cb75-168"><a href="#cb75-168" aria-hidden="true" tabindex="-1"></a>$$ Die Chance (eng. *Odds*) für das Eintreten von $Y=1$ ist eben die Wahrscheinlichkeit *für* das Eintreten geteilt durch die Gegenwahrscheinlichkeit. Das ist schon besser, denn damit liegen unsere transformierten Werte für den Zusammenhang schon zwischen $0$ und $+\infty$. Wenn wir jetzt noch den $\log$ von den Chancen rechnen, dann haben wir schon fast alles was wir brauchen.</span>
<span id="cb75-169"><a href="#cb75-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-170"><a href="#cb75-170" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-171"><a href="#cb75-171" aria-hidden="true" tabindex="-1"></a>\log\left(\cfrac{Pr(y = 1)}{1 - Pr(Y = 1)}\right)</span>
<span id="cb75-172"><a href="#cb75-172" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-173"><a href="#cb75-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-174"><a href="#cb75-174" aria-hidden="true" tabindex="-1"></a>Der Logarithmus der Chance liegt dann zwischen $-\infty$ und $+\infty$. Deshalb spricht man auch von den $\log$-Odds einer logistischen Regression. Auch sieht man hier woher das *logistisch* kommt. Wir beschreiben im Namen auch gleich die Transformation mit. Am ende kommen wir somit dann auf folgendes Modell.</span>
<span id="cb75-175"><a href="#cb75-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-176"><a href="#cb75-176" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-177"><a href="#cb75-177" aria-hidden="true" tabindex="-1"></a>\log\left(\cfrac{Pr(y = 1)}{1 - Pr(Y = 1)}\right) = \beta_0 + \beta_1 x_1 + ...  + \beta_p x_p + \epsilon</span>
<span id="cb75-178"><a href="#cb75-178" aria-hidden="true" tabindex="-1"></a>$$ Vielleicht ist dir der Begriff Wahrscheinlichkeit und der Unterschied zur Chance nicht mehr so präsent. Deshalb hier nochmal als Wiederholung oder Auffrischung.</span>
<span id="cb75-179"><a href="#cb75-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-180"><a href="#cb75-180" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Eine *Wahrscheinlichkeit* beschreibt dem Anteil an Allen. Zum Beispiel den Anteil Gewinner an allen Teilnehmern. Den Anteil Personen mit Therapieerfolg an allen Studienteilnehmern.</span>
<span id="cb75-181"><a href="#cb75-181" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Eine *Chance* oder (eng. *Odds*) beschreibt ein Verhältnis. Somit das Verhältnis Gewinner zu Nichtgewinner. Oder das Verhältnis Personen mit Therapieerfolg zu Personen ohne Therapieerfolg</span>
<span id="cb75-182"><a href="#cb75-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-183"><a href="#cb75-183" aria-hidden="true" tabindex="-1"></a>Nochmal an einem Zahlenbeispiel. Wenn wir ein Glücksspiel haben, in dem es 2 Kombinationen gibt die gewinnen und drei 3 Kombinationen die verlieren, dann haben wir eine Wahrscheinlichkeit zu gewinnen von $2 / 5 = 0.40 = 40\%$. Wenn wir die Chance zu gewinnen ausrechnen erhalten wir $2:3 = 0.67 = 67\%$. Wir sehen es gibt einen deutlichen Unterschied zwischen Chance und Wahrscheinlichkeit. Wenn wir große Fallzahl haben bzw. kleine Wahrscheinlichkeiten, dann ist der Unterschied nicht mehr so drastisch. Aber von einer *Gleichkeit* von Wahrscheinlichkeit und Chance zu sprechen kann nicht ausgegangen werden.</span>
<span id="cb75-184"><a href="#cb75-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-185"><a href="#cb75-185" aria-hidden="true" tabindex="-1"></a>Was ist nun das Problem? Wir erhalten aus einer logistischen Regression $\log$-Odds wieder. Der Effektchätzer ist also eine Chance. Wir werden aber das Ergebnis wie eine Wahrscheinlichkeit interpretieren. Diese Diskrepanz ist wenigen bekannt und ein Grund, warum wir in der Medizin immer uns daran erinnern müssen, was wir eigentlich mit der logistischen Regression *aussagen können*.</span>
<span id="cb75-186"><a href="#cb75-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-187"><a href="#cb75-187" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modellierung</span></span>
<span id="cb75-188"><a href="#cb75-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-189"><a href="#cb75-189" aria-hidden="true" tabindex="-1"></a>Die Modellerierung der logistischen Regression ist sehr einfach. Wir nutzen wieder die Formelschreibweise im <span class="in">`glm()`</span> um unsere Variablen zu definieren. Wenn unser Outcome nicht binär ist, dann jammert R und gibt uns einen Fehler aus. Ich kann hier nur dringlichst raten, das Outcome in $0/1$ zu kodieren mit dem Schlechten als $1$.</span>
<span id="cb75-190"><a href="#cb75-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-191"><a href="#cb75-191" aria-hidden="true" tabindex="-1"></a>Das <span class="in">`glm()`</span> muss dann noch wissen, dass es eine logistische Regression rechnen soll. Das machen wir in dem wir als Verteilungsfamilie die Binomialverteilung auswählen. Wir geben also an <span class="in">`family = binomial`</span> und schon können wir das volle Modell fitten.</span>
<span id="cb75-192"><a href="#cb75-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-195"><a href="#cb75-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-196"><a href="#cb75-196" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-197"><a href="#cb75-197" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-198"><a href="#cb75-198" aria-hidden="true" tabindex="-1"></a>log_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(infected <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> location <span class="sc">+</span> activity <span class="sc">+</span> crp <span class="sc">+</span> </span>
<span id="cb75-199"><a href="#cb75-199" aria-hidden="true" tabindex="-1"></a>                 frailty <span class="sc">+</span> bloodpressure <span class="sc">+</span> weight <span class="sc">+</span> creatinin, </span>
<span id="cb75-200"><a href="#cb75-200" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> pig_tbl, <span class="at">family =</span> binomial)</span>
<span id="cb75-201"><a href="#cb75-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-202"><a href="#cb75-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-203"><a href="#cb75-203" aria-hidden="true" tabindex="-1"></a>Das war extrem kurz und scherzlos. Also können wir dann auch ganz kurz schauen, ob das Modell einigermaßen funktioniert hat.</span>
<span id="cb75-204"><a href="#cb75-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-205"><a href="#cb75-205" aria-hidden="true" tabindex="-1"></a><span class="fu">## Performance des Modells</span></span>
<span id="cb75-206"><a href="#cb75-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-207"><a href="#cb75-207" aria-hidden="true" tabindex="-1"></a>Nachdem wir das Modell gefittet haben, wollen wir uns nochmal das $R^2$ wiedergeben lassen um zu entscheiden, ob unser Modell einigermaßen funktioniert hat. Dieser Abschnitt ist sehr kurz. Wir haben leider nur sehr wenige Möglichkeiten um ein logistischen Modell zu bewerten.</span>
<span id="cb75-208"><a href="#cb75-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-211"><a href="#cb75-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-212"><a href="#cb75-212" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-213"><a href="#cb75-213" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-214"><a href="#cb75-214" aria-hidden="true" tabindex="-1"></a><span class="fu">r2</span>(log_fit)</span>
<span id="cb75-215"><a href="#cb75-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-216"><a href="#cb75-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-217"><a href="#cb75-217" aria-hidden="true" tabindex="-1"></a>Ja, so viel Varianz erklären wir nicht, aber wenn du ein wenig im Internet suchst, dann wirst du feststellen, dass das Bestimmtheitsmaß so eine Sache in <span class="in">`glm()`</span>'s ist. Wir sind aber einigermaßen zufrieden. Eventuell würde eine Variablenselektion hier helfen, aber das ist nicht Inhalt dieses Kapitels.</span>
<span id="cb75-218"><a href="#cb75-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-219"><a href="#cb75-219" aria-hidden="true" tabindex="-1"></a>In @fig-log-model-check schauen wir nochmal auf die Residuen und die möglichen Ausreißer. Wieder sehen beide Plots einigermaßen in Ordnung aus. Die Abbildungen sind jetzt nicht die Besten, aber ich würde hier auch anhand der Diagnoseplots nicht die Modellierung verwerfen.</span>
<span id="cb75-220"><a href="#cb75-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-223"><a href="#cb75-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-224"><a href="#cb75-224" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb75-225"><a href="#cb75-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-226"><a href="#cb75-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-log-model-check</span></span>
<span id="cb75-227"><a href="#cb75-227" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb75-228"><a href="#cb75-228" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb75-229"><a href="#cb75-229" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 10</span></span>
<span id="cb75-230"><a href="#cb75-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Ausgabe ausgewählter Modelgüteplots der Funktion `check_model()`."</span></span>
<span id="cb75-231"><a href="#cb75-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-232"><a href="#cb75-232" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(log_fit, <span class="at">colors =</span> cbbPalette[<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>], </span>
<span id="cb75-233"><a href="#cb75-233" aria-hidden="true" tabindex="-1"></a>            <span class="at">check =</span> <span class="fu">c</span>(<span class="st">"qq"</span>, <span class="st">"outliers"</span>)) </span>
<span id="cb75-234"><a href="#cb75-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-235"><a href="#cb75-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-236"><a href="#cb75-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-237"><a href="#cb75-237" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpretation des Modells</span></span>
<span id="cb75-238"><a href="#cb75-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-239"><a href="#cb75-239" aria-hidden="true" tabindex="-1"></a>Zu Interpretation schauen wir uns wie immer nicht die rohe Ausgabe an, sondern lassen uns die Ausgabe mit der Funktion <span class="in">`model_parameters()`</span> aus dem R Paket <span class="in">`{parameters}`</span> wiedergeben. Wir müssen noch die Option <span class="in">`exponentiate = TRUE`</span> wählen, damit unsere Koeffizienten nicht als $\log$-Odds sondern als Odds wiedergeben werden. Korrekterweise erhalten wir die Odds ratio wieder was wir auch als $OR$ angegeben.</span>
<span id="cb75-240"><a href="#cb75-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-243"><a href="#cb75-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-244"><a href="#cb75-244" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-245"><a href="#cb75-245" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-246"><a href="#cb75-246" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(log_fit, <span class="at">exponentiate =</span> <span class="cn">TRUE</span>)</span>
<span id="cb75-247"><a href="#cb75-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-248"><a href="#cb75-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-249"><a href="#cb75-249" aria-hidden="true" tabindex="-1"></a>Wie interpretieren wir nun das $OR$ einer logistischen Regression? Wenn wir darauf gechtet haben, dass wir mit $1$ das Schlechte meinen, dann können wir wir folgt mit dem $OR$ sprechen. Wenn wir ein $OR &gt; 1$ haben, dann haben wir ein Risiko vorliegen. Die Variable mit einem $OR$ größer als $1$ wird die Chance auf den Eintritt des schlechten Ereignisses erhöhen. Wenn wir ein $OR &lt; 1$ haben, dann sprechen wir von einem protektiven Faktor. Die Variable mit einem $OR$ kleiner $1$ wird vor dem Eintreten des schlechten Ereignisses schützen. Schauen wir uns den Zusammenhang mal im Detail für die Ferkeldaten an.</span>
<span id="cb75-250"><a href="#cb75-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-251"><a href="#cb75-251" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`(intercept)`</span> beschreibt den Intercept der logistischen Regression. Wenn wir mehr als eine simple Regression vorliegen haben, wie in diesem Fall, dann ist der Intercept schwer zu interpretieren. Wir konzentrieren uns auf die Effekte der anderen Variablen.</span>
<span id="cb75-252"><a href="#cb75-252" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`sex`</span> beschreibt den Effekt der männlichen Ferkel zu den weiblichen Ferkeln. Daher haben männliche Ferkel eine $2.75$ höhere Chance infiziert zu werden als weibliche Ferkel.</span>
<span id="cb75-253"><a href="#cb75-253" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`location [northeast]`</span>, <span class="in">`location [northwest]`</span> und <span class="in">`location [west]`</span> beschreibt den Unterschied zur <span class="in">`location [north]`</span>. Alle Orte haben eine geringere Chance für eine Infektion zum Vergleich der Bauernhöfe im Norden. Zwar ist keiner der Effekte signifikant, aber ein interessantes Ergebnis ist es allemal.</span>
<span id="cb75-254"><a href="#cb75-254" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`activity`</span> beschreibt den Effekt der Aktivität der Ferkel. Wenn sich die Ferkel mehr bewegen, dann ist die Chance für eine Infektion gemindert.</span>
<span id="cb75-255"><a href="#cb75-255" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`crp`</span> beschreibt den Effekt des CRP-Wertes auf den Infektionsgrad. Pro Einheit CRP steigt die Chance einer Infektion um $2.97$ an. Das ist schon ein beachtlicher Wert.</span>
<span id="cb75-256"><a href="#cb75-256" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`frailty`</span> beschreibt die Gebrechlichkeit der Ferkel. Hier müssen wir wieder schauen, zu welchem Level von <span class="in">`frailty`</span> wir vergleichen. Hier vergleichen wir zu <span class="in">`frail`</span>. Also dem höchsten Gebrechlichkeitgrad. Ferkel die weniger gebrechlich sind, haben eine niedrigere Chance zu erkranken.</span>
<span id="cb75-257"><a href="#cb75-257" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`bloodpressure`</span>, <span class="in">`weight`</span> und <span class="in">`creatinin`</span> sind alles Variablen, mit einem $OR$ größer als $1$ und somit alles Riskovariablen. Hier sind zwar die $OR$ relativ klein, aber das muss erstmal nichts heißen, da die $OR$ ja hier die *Änderung* für eine Einheit von $x$ beschreiben. Deshalb musst du immer schauen, wie die Einheiten von kontinuierlichen kodiert Variablen sind.</span>
<span id="cb75-258"><a href="#cb75-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-259"><a href="#cb75-259" aria-hidden="true" tabindex="-1"></a>Kommen wir nochmal zu den gänigen Tabellen für die Zusammenfassung eines Ergebnisses einer logistischen Regression. Teilweise sind diese Tabellen so generisch und häufiog verwendet, dass wir schon einen Begriff für diese Tabellen haben. In @tbl-tbl-summary-logreg siehst du die *table 1* für die Übersicht aller Risikovariablen aufgeteilt nach dem Infektionsstatus. Diese Art der Tabellendarstellung ist so grundlegend für eine medizinische Veröffentlichung, dass sich eben der Begriff *table 1* etabliert hat. Fast jede medizinische Veröffentlichung hat als erste Tabelle diese Art von Tabelle angegeben. Hierbei ist wichtig, dass die $p$-Werte alle nur aus einem einfachen statistischen Test stammen. Die $p$-Werte einer multiplen logistischen Regression werden daher immer anders sein.</span>
<span id="cb75-260"><a href="#cb75-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-263"><a href="#cb75-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-264"><a href="#cb75-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-265"><a href="#cb75-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-266"><a href="#cb75-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-tbl-summary-logreg</span></span>
<span id="cb75-267"><a href="#cb75-267" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Ausgabe der Daten in einer Summary Table oder auch Table 1 genannt. In medizinischen Veröffentlichungen immer die erste Tabelle für die Zusammenfassung der Patienten (hier Ferkel) für jede erhobende Risikovariable."</span></span>
<span id="cb75-268"><a href="#cb75-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-269"><a href="#cb75-269" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="sc">|&gt;</span> <span class="fu">tbl_summary</span>(<span class="at">by =</span> infected) <span class="sc">|&gt;</span> <span class="fu">add_p</span>() <span class="sc">|&gt;</span> <span class="fu">as_flex_table</span>()</span>
<span id="cb75-270"><a href="#cb75-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-271"><a href="#cb75-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-272"><a href="#cb75-272" aria-hidden="true" tabindex="-1"></a>In @tbl-tbl-uni-logreg siehst du nochmal für eine Auswahl an Variablen die simplen logistischen Regressionen gerechnet. Du müsst also nicht jede simple logistische Regression selber rechnen, sondern kannst auch die Funktion <span class="in">`tbl_uvregression()`</span> verwenden. Das R Paket <span class="in">`{tbl_summary}`</span> erlaubt weitreichende Formatierungsmöglichkeiten. Am bestes schaust du einmal im Tutorial <span class="co">[</span><span class="ot">Tutorial: tbl_regression</span><span class="co">](https://www.danieldsjoberg.com/gtsummary/articles/tbl_regression.html)</span> selber nach was du brauchst oder anpassen willst.</span>
<span id="cb75-273"><a href="#cb75-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-276"><a href="#cb75-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-277"><a href="#cb75-277" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-278"><a href="#cb75-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-279"><a href="#cb75-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-tbl-uni-logreg</span></span>
<span id="cb75-280"><a href="#cb75-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Simple logistische Regression für eine Auswahl an Einflussvariablen. Für jede Einflussvariable wurde eine simple logistische Regression gerechnet."</span></span>
<span id="cb75-281"><a href="#cb75-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-282"><a href="#cb75-282" aria-hidden="true" tabindex="-1"></a>pig_tbl<span class="sc">|&gt;</span></span>
<span id="cb75-283"><a href="#cb75-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(infected, age, crp, bloodpressure) <span class="sc">|&gt;</span></span>
<span id="cb75-284"><a href="#cb75-284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_uvregression</span>(</span>
<span id="cb75-285"><a href="#cb75-285" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> glm,</span>
<span id="cb75-286"><a href="#cb75-286" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> infected,</span>
<span id="cb75-287"><a href="#cb75-287" aria-hidden="true" tabindex="-1"></a>    <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> binomial),</span>
<span id="cb75-288"><a href="#cb75-288" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb75-289"><a href="#cb75-289" aria-hidden="true" tabindex="-1"></a>    <span class="at">pvalue_fun =</span> <span class="sc">~</span><span class="fu">style_pvalue</span>(.x, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb75-290"><a href="#cb75-290" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">as_flex_table</span>()</span>
<span id="cb75-291"><a href="#cb75-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-292"><a href="#cb75-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-293"><a href="#cb75-293" aria-hidden="true" tabindex="-1"></a>nun gibt es viele Möglichkeiten sich die logistische Regression wiedergeben zu lassen In @tbl-tbl-regression-logreg siehst du nochmal die Möglichkeit, die dir das R Paket <span class="in">`{tbl_summary}`</span> bietet. Am Ende ist es dann eine reine Geschmacksfrage, wie wir die Daten dann aufarbeiten wollen.</span>
<span id="cb75-294"><a href="#cb75-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-297"><a href="#cb75-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-298"><a href="#cb75-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-299"><a href="#cb75-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-300"><a href="#cb75-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-tbl-regression-logreg</span></span>
<span id="cb75-301"><a href="#cb75-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Ausgabe der multiplen logistischen Regression durch die Funktion `tbl_regression()`."</span></span>
<span id="cb75-302"><a href="#cb75-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-303"><a href="#cb75-303" aria-hidden="true" tabindex="-1"></a>log_fit <span class="sc">|&gt;</span> <span class="fu">tbl_regression</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">as_flex_table</span>()</span>
<span id="cb75-304"><a href="#cb75-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-305"><a href="#cb75-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-306"><a href="#cb75-306" aria-hidden="true" tabindex="-1"></a>Zum Abschluss wollen wir uns einmal die Ergebnisse des Modellfits als logistischen Gerade für eine simple lineare Regression mit dem Modell $infected \sim crp$ anschauen. Wie immer können wir uns den Zusammenhang nur in einem simplen Modell anschauen. Im Fall einer multiplen linearen Regresion können wir nicht so viele Dimensionen in einer Grpahik darstellen. Wir fitten also das Modell <span class="in">`log_fit_crp`</span> wie im folgenden dargestellt.</span>
<span id="cb75-307"><a href="#cb75-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-310"><a href="#cb75-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-311"><a href="#cb75-311" aria-hidden="true" tabindex="-1"></a>log_fit_crp <span class="ot">&lt;-</span> <span class="fu">glm</span>(infected <span class="sc">~</span> crp, <span class="at">data =</span> pig_tbl, <span class="at">family =</span> binomial)</span>
<span id="cb75-312"><a href="#cb75-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-313"><a href="#cb75-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-314"><a href="#cb75-314" aria-hidden="true" tabindex="-1"></a>Nun können wir uns mit der Funktion <span class="in">`predict()`</span> die Wert auf der Geraden wiedergeben lassen. Wenn wir <span class="in">`predict()`</span> nur so aufrufen, dann erhalten wir die Werte für $y$ auf der transformierten $link$-Scale wieder. Das hilft uns aber nicht weiter, wir haben ja nur 0 und 1 Werte für $y$ vorliegen.</span>
<span id="cb75-315"><a href="#cb75-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-318"><a href="#cb75-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-319"><a href="#cb75-319" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(log_fit_crp, <span class="at">type =</span> <span class="st">"link"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-320"><a href="#cb75-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-321"><a href="#cb75-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb75-322"><a href="#cb75-322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-323"><a href="#cb75-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-324"><a href="#cb75-324" aria-hidden="true" tabindex="-1"></a>Da wir die Werte für die Wahrscheinlichkeit das ein Ferkel infiziert ist, also die Wahrscheinlichkeit $Pr(infected = 1)$, müssen wir noch die Option <span class="in">`type = reponse`</span> wählen. So erhalten wir die Wahrscheinlichkeiten wiedergegeben.</span>
<span id="cb75-325"><a href="#cb75-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-328"><a href="#cb75-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-329"><a href="#cb75-329" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(log_fit_crp, <span class="at">type =</span> <span class="st">"response"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-330"><a href="#cb75-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-331"><a href="#cb75-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb75-332"><a href="#cb75-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-333"><a href="#cb75-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-334"><a href="#cb75-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-335"><a href="#cb75-335" aria-hidden="true" tabindex="-1"></a>Abschließend können wir uns die Gerade auch in der @fig-log-pred visualisieren lassen. Auf der x-Achse sehen wir die <span class="in">`crp`</span>-Werte und auf der y-Achse den Infektionsstatus. Auf der $reponse$-scale sehen wir eine S-Kurve. Auf der $link$-scale würden wir eine Gerade sehen.</span>
<span id="cb75-336"><a href="#cb75-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-339"><a href="#cb75-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-340"><a href="#cb75-340" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb75-341"><a href="#cb75-341" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-342"><a href="#cb75-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-log-pred</span></span>
<span id="cb75-343"><a href="#cb75-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb75-344"><a href="#cb75-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb75-345"><a href="#cb75-345" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb75-346"><a href="#cb75-346" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung der logistischen Gerade in einer simplen logistischen Regression mit der Variable `crp`."</span></span>
<span id="cb75-347"><a href="#cb75-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-348"><a href="#cb75-348" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pig_tbl, <span class="fu">aes</span>(<span class="at">x =</span> crp, <span class="at">y =</span> infected)) <span class="sc">+</span></span>
<span id="cb75-349"><a href="#cb75-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb75-350"><a href="#cb75-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-351"><a href="#cb75-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">predict</span>(log_fit_crp, <span class="at">type =</span> <span class="st">"response"</span>)), <span class="at">color =</span> <span class="st">"red"</span>) </span>
<span id="cb75-352"><a href="#cb75-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-353"><a href="#cb75-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-354"><a href="#cb75-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-355"><a href="#cb75-355" aria-hidden="true" tabindex="-1"></a>Nun haben wir das Kapitel zur logistischen Regression fast abgeschlossen. Was noch fehlt ist die Besonderheit der Prädiktion im Kontext des maschinellen Lernens. Das machen wir jetzt im folgenden Abschnitt. Wenn dich die logistische Regression nur interessiert hat um einen kausalen Zusammenhang zwischen Einflussvariablen und dem binären Outcome zu modellieren, dann sind wir hier fertig.</span>
<span id="cb75-356"><a href="#cb75-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-357"><a href="#cb75-357" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gruppenvergleich {#sec-mult-comp-log-reg}</span></span>
<span id="cb75-358"><a href="#cb75-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-359"><a href="#cb75-359" aria-hidden="true" tabindex="-1"></a>Häufig ist es ja so, dass wir das Modell nur schätzen um dann einen Gruppenvergleich zu rechnen. Das heißt, dass es uns interessiert, ob es einen Unterschied zwischen den Leveln eines Faktors gegeben dem Outcome $y$ gibt. Wir machen den Gruppenvergleich jetzt einmal an der Gebrechlichkeit <span class="in">`frailty`</span> durch. Wir habe die drei Gruppen <span class="in">`frail`</span>, <span class="in">`pre-frail`</span> und <span class="in">`robust`</span> vorliegen. Wir wollen jetzt wissen, ob es einen Unterschied zwischen den Gruppen hinsichtlich dem Infektionsstatus von den Ferkeln gibt.</span>
<span id="cb75-360"><a href="#cb75-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-361"><a href="#cb75-361" aria-hidden="true" tabindex="-1"></a>Wenn du gerade hierher gesprungen bist, nochmal das simple Modell für unseren Gruppenvergleich. Wir haben hier nur einen Faktor <span class="in">`frailty`</span> mit in dem Modell. Am Ende des Abschnitts findest du dann noch ein Beispiel mit zwei Faktoren zu beschädigten Mais nach der Ernte.</span>
<span id="cb75-362"><a href="#cb75-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-365"><a href="#cb75-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-366"><a href="#cb75-366" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-367"><a href="#cb75-367" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-368"><a href="#cb75-368" aria-hidden="true" tabindex="-1"></a>log_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(infected <span class="sc">~</span> frailty, <span class="at">data =</span> pig_tbl, <span class="at">family =</span> binomial)</span>
<span id="cb75-369"><a href="#cb75-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-370"><a href="#cb75-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-371"><a href="#cb75-371" aria-hidden="true" tabindex="-1"></a>Eigentlich ist es recht einfach. Wir rechnen jetzt als erstes die ANOVA. Hier müssen wir dann einmal den Test angeben, der gerechnet werden soll um die p-Werte zu erhalten. Dann nutze ich noch die Funktion <span class="in">`model_parameters()`</span> um eine schönere Ausgabe zu erhalten.</span>
<span id="cb75-372"><a href="#cb75-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-375"><a href="#cb75-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-376"><a href="#cb75-376" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-377"><a href="#cb75-377" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-378"><a href="#cb75-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-379"><a href="#cb75-379" aria-hidden="true" tabindex="-1"></a>log_fit <span class="sc">|&gt;</span> </span>
<span id="cb75-380"><a href="#cb75-380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>(<span class="at">test =</span> <span class="st">"Chisq"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-381"><a href="#cb75-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">drop =</span> <span class="st">"NULL"</span>)</span>
<span id="cb75-382"><a href="#cb75-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-383"><a href="#cb75-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-384"><a href="#cb75-384" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass die Gebrechlichkeit der Ferkel keinen signifikanten Einfluss auf den Infektionsstatus hat. Dennoch rechnen wir einmal den Gruppenvergleich. Immerhin geht es hier ja auch um die Demonstration.</span>
<span id="cb75-385"><a href="#cb75-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-386"><a href="#cb75-386" aria-hidden="true" tabindex="-1"></a>Im folgenden nutzen wir das R Paket <span class="in">`{emmeans}`</span> wie folgt. Wenn wir die Wahrscheinlichkeiten wiedergeben haben wollen, dann nutzen wir die Option <span class="in">`regrid = "response"`</span>. In unserem <span class="in">`emmeans`</span>-Objekt stehen jetzt die Wahrscheinlichkeiten infiziert zu sein für das jeweilige Level von <span class="in">`frailty`</span>. Wenn wir aber später die *Odds ratio* benötigen, dann müssen wir die Option <span class="in">`type = "response"`</span> verwenden. Erstere Option nutze ich später um direkt aus der <span class="in">`emmeans`</span> Ausgabe ein Säulendiagramm zu erstellen. Auf dem ersten Blick sind beide Ausgaben gleich, aber im Hintergrund werden andere Optionen gesetzt, so dass in folgenden Berechnungen dann was anderes herauskommt.</span>
<span id="cb75-387"><a href="#cb75-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-388"><a href="#cb75-388" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb75-389"><a href="#cb75-389" aria-hidden="true" tabindex="-1"></a><span class="fu">## Option `regrid = "response"`</span></span>
<span id="cb75-390"><a href="#cb75-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-391"><a href="#cb75-391" aria-hidden="true" tabindex="-1"></a>Mit dieser Option erhalten wir dann ein <span class="in">`emmeans`</span>-Objekt in dem die Wahrscheinlichkeiten <span class="in">`prob`</span> hinterlegt sind. Diese Art der Berechnung eignet sich besonders, wenn später ein *compact letter dislay* visualisiert werden soll.</span>
<span id="cb75-392"><a href="#cb75-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-395"><a href="#cb75-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-396"><a href="#cb75-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-397"><a href="#cb75-397" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-398"><a href="#cb75-398" aria-hidden="true" tabindex="-1"></a>em_prob_obj <span class="ot">&lt;-</span> log_fit <span class="sc">|&gt;</span> </span>
<span id="cb75-399"><a href="#cb75-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> frailty, <span class="at">regrid =</span> <span class="st">"response"</span>)</span>
<span id="cb75-400"><a href="#cb75-400" aria-hidden="true" tabindex="-1"></a>em_prob_obj</span>
<span id="cb75-401"><a href="#cb75-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-402"><a href="#cb75-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-403"><a href="#cb75-403" aria-hidden="true" tabindex="-1"></a><span class="fu">## Option `type = "response"`</span></span>
<span id="cb75-404"><a href="#cb75-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-405"><a href="#cb75-405" aria-hidden="true" tabindex="-1"></a>Mit dieser Option bereiten wir dann die Berechnung von *Odds ratios* vor. Wir wollen dann auf der ursprünglichen Skala rechnen und nicht auf der Linkfunktion. Wenn du also *Odds ratios* haben willst, dann musst du diese Option wählen.</span>
<span id="cb75-406"><a href="#cb75-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-409"><a href="#cb75-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-410"><a href="#cb75-410" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-411"><a href="#cb75-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-412"><a href="#cb75-412" aria-hidden="true" tabindex="-1"></a>em_odds_obj <span class="ot">&lt;-</span> log_fit <span class="sc">|&gt;</span> </span>
<span id="cb75-413"><a href="#cb75-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> frailty, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb75-414"><a href="#cb75-414" aria-hidden="true" tabindex="-1"></a>em_odds_obj</span>
<span id="cb75-415"><a href="#cb75-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-416"><a href="#cb75-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-417"><a href="#cb75-417" aria-hidden="true" tabindex="-1"></a>Achtung, das Objekt sieht jetzt zwar sehr ähnlich aus, aber für die weitere Berechnung macht es dann doch einen Unterschied welchen <span class="in">`type`</span> du nutzt.</span>
<span id="cb75-418"><a href="#cb75-418" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb75-419"><a href="#cb75-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-420"><a href="#cb75-420" aria-hidden="true" tabindex="-1"></a>Wenn du un an den *Odds ratios* und den p-Werten interessiert bist, dann kannst du den Gruppenvergleich mit der Funktion <span class="in">`contrast()`</span> rechnen. Wir wollen hier alle paarweisen Vergleiche rechnen. Wie immer kannst du auch die Adjustierung anpassen, wenn du möchtest.</span>
<span id="cb75-421"><a href="#cb75-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-424"><a href="#cb75-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-425"><a href="#cb75-425" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-426"><a href="#cb75-426" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-427"><a href="#cb75-427" aria-hidden="true" tabindex="-1"></a>em_odds_obj <span class="sc">|&gt;</span> </span>
<span id="cb75-428"><a href="#cb75-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">method =</span> <span class="st">"pairwise"</span>, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb75-429"><a href="#cb75-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-430"><a href="#cb75-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-431"><a href="#cb75-431" aria-hidden="true" tabindex="-1"></a>Wir sehen also, dass wir auch hier keine signifikanten Unterschiede vorliegen haben. Jetzt lassen wir uns nochmal das unadjustierte *compact letter display* wiedergeben. Aber auch in dem unadjustierten Fall finden wir keine signifikanten Unterschiede.</span>
<span id="cb75-432"><a href="#cb75-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-435"><a href="#cb75-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-436"><a href="#cb75-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-437"><a href="#cb75-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-438"><a href="#cb75-438" aria-hidden="true" tabindex="-1"></a>em_odds_obj <span class="sc">|&gt;</span></span>
<span id="cb75-439"><a href="#cb75-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"none"</span>)</span>
<span id="cb75-440"><a href="#cb75-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-441"><a href="#cb75-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-442"><a href="#cb75-442" aria-hidden="true" tabindex="-1"></a>Am Ende möchte ich hier nochmal einen Spieldatensatz <span class="in">`infected_tbl`</span> erstellen indem ich wiederum drei Gruppen miteinander vergleiche. Ich tue mal so als würden wir uns hier zwei Pestizide und eine Kontrolle anschauen. Unser Outcome ist dann, ob wir eine Infektion vorliegen haben oder das Pestizid alles umgebracht hat. Damit haben wir dann unser Outcome <span class="in">`infected`</span> definiert. Wir bauen uns die Daten so, dass $80%$ der Beobachtungen in der Kontrolle infiziert sind. In den beiden Behandlungsgruppen sind jeweils $50%$ und $30%$ der Beobachtungen nach der Behandlung noch infiziert. Wir haben jeweils zwanzig Pflanzen <span class="in">`n_grp`</span> beobachtet. Das sind wirklich wenige Beobachtungen für einen $0/1$ Endpunkt, aber es sollte hier reichen. Dann habe ich noch einen Seed gesetzt, damit auch immer die gleichen Zahlen generiert werden.</span>
<span id="cb75-443"><a href="#cb75-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-446"><a href="#cb75-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-447"><a href="#cb75-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-448"><a href="#cb75-448" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-449"><a href="#cb75-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-450"><a href="#cb75-450" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20231201</span>)</span>
<span id="cb75-451"><a href="#cb75-451" aria-hidden="true" tabindex="-1"></a>n_grp <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb75-452"><a href="#cb75-452" aria-hidden="true" tabindex="-1"></a>infected_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">trt =</span> <span class="fu">gl</span>(<span class="dv">3</span>, n_grp, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"ctrl"</span>, <span class="st">"roundUp"</span>, <span class="st">"killAll"</span>)),</span>
<span id="cb75-453"><a href="#cb75-453" aria-hidden="true" tabindex="-1"></a>                       <span class="at">infected =</span> <span class="fu">c</span>(<span class="fu">rbinom</span>(n_grp, <span class="dv">1</span>, <span class="fl">0.8</span>), </span>
<span id="cb75-454"><a href="#cb75-454" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">rbinom</span>(n_grp, <span class="dv">1</span>, <span class="fl">0.5</span>), </span>
<span id="cb75-455"><a href="#cb75-455" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">rbinom</span>(n_grp, <span class="dv">1</span>, <span class="fl">0.2</span>)))</span>
<span id="cb75-456"><a href="#cb75-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-457"><a href="#cb75-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-458"><a href="#cb75-458" aria-hidden="true" tabindex="-1"></a>Jetzt bauen wir uns wieder unser logistisches Modell zusammen, dass kennst du ja schon. Vorher wollen wir aber nochmal in die Daten schauen. Unser Datensatz hat ja nur ein Outcome und eine Behandlung als Faktor mit drei Leveln bzw. Gruppen. Wir können jetzt einmal nachvollziehen woher die Werte in einer <span class="in">`{emmeans}`</span>-Ausgabe eigentlich kommen. Schauen wir uns dazu erstmal die Tabelle mit den Infektionen zugeordnet zu den Behandlungen an.</span>
<span id="cb75-459"><a href="#cb75-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-462"><a href="#cb75-462" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-463"><a href="#cb75-463" aria-hidden="true" tabindex="-1"></a>infected_tbl <span class="sc">%$%</span> </span>
<span id="cb75-464"><a href="#cb75-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(trt, infected) </span>
<span id="cb75-465"><a href="#cb75-465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-466"><a href="#cb75-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-467"><a href="#cb75-467" aria-hidden="true" tabindex="-1"></a>Jetzt berechnen wir einmal die Anteile der Infektionen in den jeweiligen Behandlungen. Wir würden ja erwarten, dass wir $80%$, $50%$ und $20%$ vorfinden, aber da wir nur ein kleinen Fallzahl simuliert haben, ergibt sich natürlich eine Abweichung. Wir finden nämlich in den Daten für *ctrl* gleich $15/20 = 0.75$, für *roundUp* gleich $8/20 = 0.4$ und für *killAll* gleich $4/20 = 0.2$ anteilig Infektionen. Finden wir diese Zahlen auch in <span class="in">`{emmeans}`</span> wieder?</span>
<span id="cb75-468"><a href="#cb75-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-469"><a href="#cb75-469" aria-hidden="true" tabindex="-1"></a>Als erstes bauen wir uns wieder ein Modell der logistischen Regression.</span>
<span id="cb75-470"><a href="#cb75-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-473"><a href="#cb75-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-474"><a href="#cb75-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-475"><a href="#cb75-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-476"><a href="#cb75-476" aria-hidden="true" tabindex="-1"></a>infected_log_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(infected <span class="sc">~</span> trt, <span class="at">data =</span> infected_tbl, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb75-477"><a href="#cb75-477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-478"><a href="#cb75-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-479"><a href="#cb75-479" aria-hidden="true" tabindex="-1"></a>Dann stecken wir das Modell einmal in <span class="in">`emmeans()`</span> und schauen uns die Ausgabe an und nutzen die Option <span class="in">`regrid = "response"`</span> um uns Wahrscheinlichkeiten wiedergeben zu lassen.</span>
<span id="cb75-480"><a href="#cb75-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-483"><a href="#cb75-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-484"><a href="#cb75-484" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-485"><a href="#cb75-485" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-486"><a href="#cb75-486" aria-hidden="true" tabindex="-1"></a>infected_log_fit  <span class="sc">|&gt;</span> </span>
<span id="cb75-487"><a href="#cb75-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt, <span class="at">regrid =</span> <span class="st">"response"</span>) </span>
<span id="cb75-488"><a href="#cb75-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-489"><a href="#cb75-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-490"><a href="#cb75-490" aria-hidden="true" tabindex="-1"></a>Und tatsächlich, wir finden die gleichen Anteile in der Ausgabe wieder, wie wir auch in unseren Daten vorab aus der Tabelle berechnet haben. Wir erhalten also den Anteil der 1-sen in einem Outcome aus der Funktion <span class="in">`emmeans()`</span> wieder. Der Anteil an 1-sen ist ja auch nichts anderes als der Mittelwert des Outcomes für die Spalte.</span>
<span id="cb75-491"><a href="#cb75-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-492"><a href="#cb75-492" aria-hidden="true" tabindex="-1"></a>Im nächsten Schritt wollen wir einmal die *Odds ratios* verstehen. Dafür erstmal den Aufruf in `emmeans()` und dann schauen wir einmal in die Ausgabe. Wir wollen jetzt die *Odds ratios* einmal händisch berechnen.</span>
<span id="cb75-493"><a href="#cb75-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-496"><a href="#cb75-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-497"><a href="#cb75-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-498"><a href="#cb75-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-499"><a href="#cb75-499" aria-hidden="true" tabindex="-1"></a>infected_log_fit <span class="sc">|&gt;</span> </span>
<span id="cb75-500"><a href="#cb75-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt, <span class="at">type =</span> <span class="st">"response"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-501"><a href="#cb75-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>()</span>
<span id="cb75-502"><a href="#cb75-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-503"><a href="#cb75-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-504"><a href="#cb75-504" aria-hidden="true" tabindex="-1"></a>Wir wissen ja die Anteile der 1-sen in der Kontrollgruppe *ctrl* mit $0.75$ sowie den Anteil an 1-sen in der Behandlungsgruppe *roundUp* mit $0.4$. Wir haben die Werte ja oben in der Tabelle bestimmt. Jetzt können wir die *Odds* mit $Odds = p/(1-p)$ für die beiden Gruppen berechnen und dann den Quotienten als *Odds ratio* berechnen.</span>
<span id="cb75-505"><a href="#cb75-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-506"><a href="#cb75-506" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-507"><a href="#cb75-507" aria-hidden="true" tabindex="-1"></a>ctrl/roundUp = \cfrac{0.75}{0.25}/\cfrac{0.4}{0.6} = 4.5</span>
<span id="cb75-508"><a href="#cb75-508" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-509"><a href="#cb75-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-510"><a href="#cb75-510" aria-hidden="true" tabindex="-1"></a>Wie wir sehen, passen die Zahlen. Wir können jetzt auch für die Behandlungsgruppe *killAll* mit einem Anteil an 1-sen von $0.2$ weitermachen. Auch hier berechnen wir erst die *Odds* und dann den Quotienten aus den beiden *Odds*.</span>
<span id="cb75-511"><a href="#cb75-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-512"><a href="#cb75-512" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-513"><a href="#cb75-513" aria-hidden="true" tabindex="-1"></a>ctrl/killAll = \cfrac{0.75}{0.25}/\cfrac{0.2}{0.8} = 12</span>
<span id="cb75-514"><a href="#cb75-514" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-515"><a href="#cb75-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-516"><a href="#cb75-516" aria-hidden="true" tabindex="-1"></a>Dann nochmal als Überprüfung den letzten Wert für den Vergleich von *roundUp* zu *killAll*.</span>
<span id="cb75-517"><a href="#cb75-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-518"><a href="#cb75-518" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-519"><a href="#cb75-519" aria-hidden="true" tabindex="-1"></a>roundUp/killAll = \cfrac{0.4}{0.6}/\cfrac{0.2}{0.8} = 2.67</span>
<span id="cb75-520"><a href="#cb75-520" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-521"><a href="#cb75-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-522"><a href="#cb75-522" aria-hidden="true" tabindex="-1"></a>Nun könntest du einwenden, dass *Odds ratios* nicht so einfach zu interpretieren sind und du eigentlich nur wissen willst um welchen Faktor *mehr* oder *weniger* Infizierte es in einer Gruppe gibt. Also kein Chancenverhältnis sondern eben einfach ein Wahrscheinlichkeitsverhältnis. Du willst also sagen, dass in der Kontrollgruppe x-fach mehr oder weniger infizierte Beobachtungen auftauchen. Damit willst du die Wahrscheinlichkeiten aus der Tabelle weiter oben in ein Verhätnis setzen. Daher willst du folgende Zusammenhänge berechnen.</span>
<span id="cb75-523"><a href="#cb75-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-524"><a href="#cb75-524" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-525"><a href="#cb75-525" aria-hidden="true" tabindex="-1"></a>\cfrac{ctrl}{roundUp} = \cfrac{0.75}{0.4} = 1.88 </span>
<span id="cb75-526"><a href="#cb75-526" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-527"><a href="#cb75-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-528"><a href="#cb75-528" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-529"><a href="#cb75-529" aria-hidden="true" tabindex="-1"></a>\cfrac{ctrl}{killAll} = \cfrac{0.75}{0.2} = 3.75 </span>
<span id="cb75-530"><a href="#cb75-530" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-531"><a href="#cb75-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-532"><a href="#cb75-532" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-533"><a href="#cb75-533" aria-hidden="true" tabindex="-1"></a>\cfrac{roundUp}{killAll} = \cfrac{0.4}{0.2} = 2.00 </span>
<span id="cb75-534"><a href="#cb75-534" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb75-535"><a href="#cb75-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-536"><a href="#cb75-536" aria-hidden="true" tabindex="-1"></a>Wir können also sagen, dass wir in der Kontrolle ungefähr 1.88 mal mehr Infizierte haben als in der Behandlung *roundUp*. Oder aber, dass wir in der Kontrolle 3.75 mal mehr Infizierte haben als in der Behandlung *killAll* Um solche Zahlen zu berechnen, nutzen wir die Poisson Regression auf unseren $0/1$-Daten. Dafür müssen wir einmal die Option <span class="in">`family = "poisson"`</span> setzen.</span>
<span id="cb75-537"><a href="#cb75-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-540"><a href="#cb75-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-541"><a href="#cb75-541" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-542"><a href="#cb75-542" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-543"><a href="#cb75-543" aria-hidden="true" tabindex="-1"></a>infected_pois_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(infected <span class="sc">~</span> trt, <span class="at">data =</span> infected_tbl, <span class="at">family =</span> <span class="st">"poisson"</span>)</span>
<span id="cb75-544"><a href="#cb75-544" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-545"><a href="#cb75-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-546"><a href="#cb75-546" aria-hidden="true" tabindex="-1"></a>Dann können wir auch schon die Funktion <span class="in">`emmeans()`</span> anwenden, um uns einmal die Wahrscheinlichkeitsverhältnisse als <span class="in">`ratio`</span> wiedergeben zu lassen. Wie immer kannst du natürlich den Fit auch erstmal in ein eigenes Objekt stecken und dann noch andere Funktionen in <span class="in">`{emmeans}`</span> nutzen. Wie du gleich siehst, haben wir aber auch hier keine signifikanten Unterschiede zwischen den Gruppen.</span>
<span id="cb75-547"><a href="#cb75-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-550"><a href="#cb75-550" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-551"><a href="#cb75-551" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-552"><a href="#cb75-552" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-553"><a href="#cb75-553" aria-hidden="true" tabindex="-1"></a>infected_pois_fit <span class="sc">|&gt;</span> </span>
<span id="cb75-554"><a href="#cb75-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt, <span class="at">type =</span> <span class="st">"response"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-555"><a href="#cb75-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs</span>()</span>
<span id="cb75-556"><a href="#cb75-556" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-557"><a href="#cb75-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-558"><a href="#cb75-558" aria-hidden="true" tabindex="-1"></a>Damit sind wir einmal mit unserem Gruppenvergleich für die logistische Regression auf einem $0/1$ Outcome durch. In dem Kapitel zu den <span class="co">[</span><span class="ot">Multiple Vergleichen oder Post-hoc Tests</span><span class="co">](#sec-posthoc)</span> findest du dann noch mehr Inspirationen für die Nutzung von <span class="in">`{emmeans}`</span>. Hier war es dann die Anwendung auf binäre Outcomes zusammen mit einem Faktor. Wenn du dir das Ganze nochmal an einem Beispiel für zwei Faktoren anschauen möchtest, dann findest du im folgenden Kasten ein Beispiel für die Auswertung von Beschädigungen an Mais nach verschiedenen Ernteverfahren und Zeitpunkten.</span>
<span id="cb75-559"><a href="#cb75-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-560"><a href="#cb75-560" aria-hidden="true" tabindex="-1"></a>::: callout-tip</span>
<span id="cb75-561"><a href="#cb75-561" aria-hidden="true" tabindex="-1"></a><span class="fu">## Anwendungsbeispiel: Zweifaktorieller Gruppenvergleich für Maisernte</span></span>
<span id="cb75-562"><a href="#cb75-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-563"><a href="#cb75-563" aria-hidden="true" tabindex="-1"></a>Im folgenden Beispiel schauen wir uns nochmal ein praktische Auswertung von einem agrarwissenschaftlichen Beispiel mit Mais an. Wir haben uns in diesem Experiment verschiedene Arten <span class="in">`trt`</span> von Ernteverfahren von Mais angeschaut. Dann haben wir nach vier Zeitpunkten bestimmt, ob der Mais durch das Ernteverfahren nachträglich beschädigt war. Die Beschädigung selber wurde dann etwas komplizierter mit einem Labortest festgestellt, aber wir schauen uns nur die Ausprägung ja/nein also $1/0$ als Outcome an. Durch einen Fehler im Labor müssen wir eine Kombination für den letzten Tag und der dritten Behandlung entfernen.</span>
<span id="cb75-564"><a href="#cb75-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-567"><a href="#cb75-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-568"><a href="#cb75-568" aria-hidden="true" tabindex="-1"></a>maize_tbl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/maize_rate.xlsx"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-569"><a href="#cb75-569" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">damaged =</span> <span class="fu">ifelse</span>(time <span class="sc">==</span> <span class="st">"5d"</span> <span class="sc">&amp;</span> trt <span class="sc">==</span> <span class="dv">3</span>, <span class="cn">NA</span>, damaged),</span>
<span id="cb75-570"><a href="#cb75-570" aria-hidden="true" tabindex="-1"></a>          <span class="at">trt =</span> <span class="fu">factor</span>(trt, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"wenig"</span>, <span class="st">"mittel"</span>, <span class="st">"viel"</span>)))</span>
<span id="cb75-571"><a href="#cb75-571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-572"><a href="#cb75-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-573"><a href="#cb75-573" aria-hidden="true" tabindex="-1"></a>Dann können wir auch schon die logistische Regression mit <span class="in">`glm()`</span> rechnen. Auch hier wieder darauf achten, dass wir dann als Option <span class="in">`family = binomial`</span> wählen und unser Outcome <span class="in">`infected`</span> als Faktor kodiert ist.</span>
<span id="cb75-574"><a href="#cb75-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-577"><a href="#cb75-577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-578"><a href="#cb75-578" aria-hidden="true" tabindex="-1"></a>maize_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(damaged <span class="sc">~</span> trt <span class="sc">+</span> time <span class="sc">+</span> trt<span class="sc">:</span>time, <span class="at">data =</span> maize_tbl, <span class="at">family =</span> binomial) </span>
<span id="cb75-579"><a href="#cb75-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-580"><a href="#cb75-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-581"><a href="#cb75-581" aria-hidden="true" tabindex="-1"></a>In den beiden folgenden Tabs findest du dann einmal das Ergebnis für die ANOVA und einmal für den Gruppenvergleich mit dem R Paket <span class="in">`{emmeans}`</span>. Bitte beachte, dass die ANOVA für ein <span class="in">`glm()`</span>-Objekt nicht ganz gleich wie für ein <span class="in">`lm()`</span>-Objekt ist. Du kannst aber die ANOVA erstmal ganz normal interpretieren, nur haben wir hier nicht die Möglichkeit ein $\eta^2$ zu bestimmen. Dann nutzen wir <span class="in">`{emmeans}`</span> für den Gruppenvergleich.</span>
<span id="cb75-582"><a href="#cb75-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-583"><a href="#cb75-583" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb75-584"><a href="#cb75-584" aria-hidden="true" tabindex="-1"></a><span class="fu">## ANOVA mit `anova()`</span></span>
<span id="cb75-585"><a href="#cb75-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-586"><a href="#cb75-586" aria-hidden="true" tabindex="-1"></a>Wir rechnen hier einmal die ANOVA und nutzen den $\mathcal{X}^2$-Test für die Ermittelung der p-Werte. Wir müssen hier einen Test auswählen, da per Standardeinstellung kein Test gerechnet wird. Wir machen dann die Ausageb nochmal schöner und fertig sind wir.</span>
<span id="cb75-587"><a href="#cb75-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-590"><a href="#cb75-590" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-591"><a href="#cb75-591" aria-hidden="true" tabindex="-1"></a>maize_fit <span class="sc">|&gt;</span> </span>
<span id="cb75-592"><a href="#cb75-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>(<span class="at">test =</span> <span class="st">"Chisq"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-593"><a href="#cb75-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">drop =</span> <span class="st">"NULL"</span>)</span>
<span id="cb75-594"><a href="#cb75-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-595"><a href="#cb75-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-596"><a href="#cb75-596" aria-hidden="true" tabindex="-1"></a>Wir sehen, dass der Effekt für die Behandlung und die Zeit signifikant sind. Wir haben aber keine Interaktion vorliegen. Daher können wir dann die Analyse gemeinsam über alle Zeitpunkte rechnen.</span>
<span id="cb75-597"><a href="#cb75-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-598"><a href="#cb75-598" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gruppenvergleich mit `emmeans()`</span></span>
<span id="cb75-599"><a href="#cb75-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-600"><a href="#cb75-600" aria-hidden="true" tabindex="-1"></a>Im Folgenden rechnen wir einmal über alle Faktorkombinationen von <span class="in">`trt`</span> und <span class="in">`time`</span> einen Gruppenvergleich. Dafür nutzen wir die Opition <span class="in">`trt * time`</span>. Wenn du die Analyse *getrennt* für die Zeitpunkte durchführen willst, dann nutze die Option <span class="in">`trt | time`</span>. Wir wollen die Wahrscheinlichkeiten für das Auftreten einer Beschädigung von wiedergegeben bekommen, deshalb die Option <span class="in">`regrid = "response`</span>. Dann adjustieren wir noch nach Bonferroni und sind fertig.</span>
<span id="cb75-601"><a href="#cb75-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-604"><a href="#cb75-604" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-605"><a href="#cb75-605" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="ot">&lt;-</span> maize_fit <span class="sc">|&gt;</span> </span>
<span id="cb75-606"><a href="#cb75-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="sc">~</span> trt <span class="sc">*</span> time, <span class="at">regrid =</span> <span class="st">"response"</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-607"><a href="#cb75-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(<span class="at">Letters =</span> letters, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb75-608"><a href="#cb75-608" aria-hidden="true" tabindex="-1"></a>emm_obj</span>
<span id="cb75-609"><a href="#cb75-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-610"><a href="#cb75-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-611"><a href="#cb75-611" aria-hidden="true" tabindex="-1"></a>Das <span class="in">`emm_obj`</span> Objekt werden wir dann gleich einmal in <span class="in">`{ggplot}`</span> visualisieren. Dann können wir auch das *compact letter display* anhand der Abbildung interpretieren.</span>
<span id="cb75-612"><a href="#cb75-612" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb75-613"><a href="#cb75-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-614"><a href="#cb75-614" aria-hidden="true" tabindex="-1"></a>In der @fig-log-mod-prob-maize siehst du das Ergebnis der Auswertung in einem Säulendiagramm. Hier unbedingt <span class="in">`SE`</span> als den Standardfehler für die Fehlerbalken nutzen, da wir sonst Fehlerbalken größer und kleiner als $0/1$ erhalten, wenn wir die Standardabweichung nutzen würden. Wir sehen einen klaren Effekt der Behandlung <span class="in">`viel`</span>. Schade, dass wir dann nach 5 Tagen leider keine Auswertung für die dritte Behandlung vorliegen haben. Aber sowas passiert dann unter echten Bedingungen mal schnell.</span>
<span id="cb75-615"><a href="#cb75-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-618"><a href="#cb75-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-619"><a href="#cb75-619" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb75-620"><a href="#cb75-620" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-621"><a href="#cb75-621" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-622"><a href="#cb75-622" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-log-mod-prob-maize</span></span>
<span id="cb75-623"><a href="#cb75-623" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb75-624"><a href="#cb75-624" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb75-625"><a href="#cb75-625" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb75-626"><a href="#cb75-626" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Säulendigramm der Anteile des beschädigten Mais aus einer logistischen Regression. Das `glm()`-Modell berechnet die Wahrscheinlichkeiten in jeder Faktorkombination, was dann die Anteile des beschädigten Mais entspricht. Das *compact letter display* wird dann in `{emmeans}` generiert."</span></span>
<span id="cb75-627"><a href="#cb75-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-628"><a href="#cb75-628" aria-hidden="true" tabindex="-1"></a>emm_obj <span class="sc">|&gt;</span> </span>
<span id="cb75-629"><a href="#cb75-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb75-630"><a href="#cb75-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> prob, <span class="at">fill =</span> trt)) <span class="sc">+</span></span>
<span id="cb75-631"><a href="#cb75-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb75-632"><a href="#cb75-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Anteil beschädigter Mais"</span>, <span class="at">x =</span> <span class="st">"Stunden nach Ernte"</span>,</span>
<span id="cb75-633"><a href="#cb75-633" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Behandlung"</span>) <span class="sc">+</span></span>
<span id="cb75-634"><a href="#cb75-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, </span>
<span id="cb75-635"><a href="#cb75-635" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb75-636"><a href="#cb75-636" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> .group, <span class="at">y =</span> prob <span class="sc">+</span> SE <span class="sc">+</span> <span class="fl">0.01</span>),  </span>
<span id="cb75-637"><a href="#cb75-637" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb75-638"><a href="#cb75-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> prob<span class="sc">-</span>SE, <span class="at">ymax =</span> prob<span class="sc">+</span>SE),</span>
<span id="cb75-639"><a href="#cb75-639" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>,  </span>
<span id="cb75-640"><a href="#cb75-640" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb75-641"><a href="#cb75-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_okabeito</span>()</span>
<span id="cb75-642"><a href="#cb75-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-643"><a href="#cb75-643" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb75-644"><a href="#cb75-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-645"><a href="#cb75-645" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dichotomisierung</span></span>
<span id="cb75-646"><a href="#cb75-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-647"><a href="#cb75-647" aria-hidden="true" tabindex="-1"></a>Manchmal ist es so, dass wir eine logistsiche Regression rechnen wollen. Wir fragen nicht, wie ist unser $y$ verteilt und was für eine Regression können wir dann rechnen? Sondern wir wollen mit der logistischen Regression durch die Wand. Wenn wir das wollen, dann können wir unser $y$ dichotomisieren. Das heißt, wir machen aus einer Variable, die mehr als zwei Level hat einen Faktor mit zwei Leveln. Dafür stehen uns verschiedene Möglichkeiten offen.</span>
<span id="cb75-648"><a href="#cb75-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-649"><a href="#cb75-649" aria-hidden="true" tabindex="-1"></a>In dem R Paket <span class="in">`{dplyr}`</span> haben wir mit der Funktion <span class="in">`recode()`</span> die Möglichkeit eine Variable von <span class="in">`alt = neu`</span> umzukodieren. Dabei müssen wir natürlich darauf achten, dass wir die alten Level der Variable richtig schreiben und bei der neuen Level nur zwei Namen eintragen. Dann sind wir auch schon durch mit der Umbenennung.</span>
<span id="cb75-650"><a href="#cb75-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-653"><a href="#cb75-653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-654"><a href="#cb75-654" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="sc">|&gt;</span> </span>
<span id="cb75-655"><a href="#cb75-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">frailty =</span> <span class="fu">recode</span>(frailty, </span>
<span id="cb75-656"><a href="#cb75-656" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"robust"</span> <span class="ot">=</span> <span class="st">"robust"</span>, </span>
<span id="cb75-657"><a href="#cb75-657" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"pre-frail"</span> <span class="ot">=</span> <span class="st">"frail_prefrail"</span>, </span>
<span id="cb75-658"><a href="#cb75-658" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"frail"</span> <span class="ot">=</span> <span class="st">"frail_prefrail"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb75-659"><a href="#cb75-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(frailty) <span class="sc">|&gt;</span> <span class="fu">extract</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb75-660"><a href="#cb75-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-661"><a href="#cb75-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-662"><a href="#cb75-662" aria-hidden="true" tabindex="-1"></a>Ich finde die Funktion <span class="in">`case_when()`</span> etwas übersichtlicher. Das ist aber eigentlich nur eine Geschmacksfrage. Am Ende kommt jedenfalls das Gleiche heraus.</span>
<span id="cb75-663"><a href="#cb75-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-666"><a href="#cb75-666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-667"><a href="#cb75-667" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="sc">|&gt;</span> </span>
<span id="cb75-668"><a href="#cb75-668" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">frailty =</span> <span class="fu">case_when</span>(frailty <span class="sc">==</span> <span class="st">"robust"</span> <span class="sc">~</span> <span class="st">"robust"</span>,</span>
<span id="cb75-669"><a href="#cb75-669" aria-hidden="true" tabindex="-1"></a>                           frailty <span class="sc">==</span> <span class="st">"pre-frail"</span> <span class="sc">~</span> <span class="st">"frail"</span>,</span>
<span id="cb75-670"><a href="#cb75-670" aria-hidden="true" tabindex="-1"></a>                           frailty <span class="sc">==</span> <span class="st">"frail"</span> <span class="sc">~</span> <span class="st">"frail"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb75-671"><a href="#cb75-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(frailty) <span class="sc">|&gt;</span> <span class="fu">extract</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb75-672"><a href="#cb75-672" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-673"><a href="#cb75-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-674"><a href="#cb75-674" aria-hidden="true" tabindex="-1"></a>Häufig haben wir auch den Fall, dass wir keine kontinuierlichen $x$ in unseren Daten wollen. Alles soll sich in Faktoren verwandeln, so dass wir immer eine 2x2 Tafel haben. Wenn es sein muss, liefert hier <span class="in">`cutpointr()`</span> die Lösung für dieses Problem. Wir müssen dafür zum einen unser kontinuierliches $x$ angeben und dann mit <span class="in">`class`</span> unser binäres $y$. Wir erhalten dann für unser $y$ den bestmöglichen Split für unser $x$. Im Beispiel wollen wir einmal die Variable <span class="in">`crp`</span> für unser Outcome <span class="in">`infected`</span> in zwei Gruppen aufteilen. Wir wollen eigentlich immer zwei Gruppen, da wir dann in dem Setting eines $\mathcal{X}^2$-Test und einer einfacheren Interpretation von dem $OR$ sind.</span>
<span id="cb75-675"><a href="#cb75-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-676"><a href="#cb75-676" aria-hidden="true" tabindex="-1"></a>Wir immer haben wir eine große Bandbreite an Optionen, wie wir den besten Split unseres $x$ kriegen wollen. Ich gehe hier mit den Default-Werten. Damit kommt man eigentlich recht weit. Ich möchte gerne die Summe der Sensivität und der Spezifität <span class="in">`sum_sens_spec`</span> über alle möglichen Cutpoints maximieren <span class="in">`maximize_metric`</span>. Der Cutpoint mit der maximalen Summe an Sensivität und der Spezifität wird mir dann wiedergegeben. Natürlich hat das R Paket <span class="in">`{cutpoint}`</span> noch viel mehr Optionen. Mehr gibt es in <span class="co">[</span><span class="ot">An introduction to cutpointr</span><span class="co">](https://cran.r-project.org/web/packages/cutpointr/vignettes/cutpointr.html)</span>.</span>
<span id="cb75-677"><a href="#cb75-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-680"><a href="#cb75-680" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-681"><a href="#cb75-681" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-682"><a href="#cb75-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb75-683"><a href="#cb75-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-684"><a href="#cb75-684" aria-hidden="true" tabindex="-1"></a>cp_crp <span class="ot">&lt;-</span> <span class="fu">cutpointr</span>(<span class="at">data =</span> pig_tbl,</span>
<span id="cb75-685"><a href="#cb75-685" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> crp,</span>
<span id="cb75-686"><a href="#cb75-686" aria-hidden="true" tabindex="-1"></a>                    <span class="at">class =</span> infected,</span>
<span id="cb75-687"><a href="#cb75-687" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> maximize_metric, </span>
<span id="cb75-688"><a href="#cb75-688" aria-hidden="true" tabindex="-1"></a>                    <span class="at">metric =</span> sum_sens_spec) </span>
<span id="cb75-689"><a href="#cb75-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-690"><a href="#cb75-690" aria-hidden="true" tabindex="-1"></a>cp_crp</span>
<span id="cb75-691"><a href="#cb75-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-692"><a href="#cb75-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-693"><a href="#cb75-693" aria-hidden="true" tabindex="-1"></a>In @fig-crp-bin sehe wir die Ausgabe der Funktion <span class="in">`cutpointr()`</span> nochmal visualisiert. Wir sehen, dass der Split einigermaßen die <span class="in">`crp`</span>-Werte im Sinne von unserem Outcome aufteilt.</span>
<span id="cb75-694"><a href="#cb75-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-697"><a href="#cb75-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-698"><a href="#cb75-698" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb75-699"><a href="#cb75-699" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-700"><a href="#cb75-700" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-crp-bin</span></span>
<span id="cb75-701"><a href="#cb75-701" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb75-702"><a href="#cb75-702" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb75-703"><a href="#cb75-703" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb75-704"><a href="#cb75-704" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Visualisierung des Ergebnisses der Funktion `cutpointr` für die Variable `crp`."</span></span>
<span id="cb75-705"><a href="#cb75-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-706"><a href="#cb75-706" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cp_crp)</span>
<span id="cb75-707"><a href="#cb75-707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-708"><a href="#cb75-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-709"><a href="#cb75-709" aria-hidden="true" tabindex="-1"></a>Wir können uns jetzt noch den optimalen Cutpoint aus der Ausgabe herausziehen, wenn wir den Punkt nicht aus der Ausgabe ablesen wollen.</span>
<span id="cb75-710"><a href="#cb75-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-713"><a href="#cb75-713" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-714"><a href="#cb75-714" aria-hidden="true" tabindex="-1"></a><span class="fu">pluck</span>(cp_crp, <span class="st">"optimal_cutpoint"</span>)</span>
<span id="cb75-715"><a href="#cb75-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-716"><a href="#cb75-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-717"><a href="#cb75-717" aria-hidden="true" tabindex="-1"></a>Am Ende können wir dann über <span class="in">`case_when()`</span> uns ein binären CRP-Wert zusammenbauen. Wir müssen dann natürlich entscheiden welche Variable wir mit ins Modell nehme, aber meistens machen wir uns ja die Mühen um dann die neue Variable zu verwenden.</span>
<span id="cb75-718"><a href="#cb75-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-721"><a href="#cb75-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-722"><a href="#cb75-722" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="sc">|&gt;</span> </span>
<span id="cb75-723"><a href="#cb75-723" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">crp_bin =</span> <span class="fu">case_when</span>(crp <span class="sc">&gt;=</span> <span class="fl">19.84</span> <span class="sc">~</span> <span class="st">"high"</span>,</span>
<span id="cb75-724"><a href="#cb75-724" aria-hidden="true" tabindex="-1"></a>                           crp <span class="sc">&lt;</span> <span class="fl">19.84</span> <span class="sc">~</span> <span class="st">"low"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb75-725"><a href="#cb75-725" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(crp, crp_bin)  </span>
<span id="cb75-726"><a href="#cb75-726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-727"><a href="#cb75-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-728"><a href="#cb75-728" aria-hidden="true" tabindex="-1"></a>Damit haben wir uns dann auch mit dem Problem der Dichotomisierung in der logististischen Regression einmal beschäftigt. Somit bleibt dann noch die Prädiktion übrig.</span>
<span id="cb75-729"><a href="#cb75-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-730"><a href="#cb75-730" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prädiktion</span></span>
<span id="cb75-731"><a href="#cb75-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-732"><a href="#cb75-732" aria-hidden="true" tabindex="-1"></a>Da wir später in dem @sec-class-basic die logistische Regression auch als Vergleich zu maschinellen Lernverfahren in der Klassifikation nutzen werden gehen wir hier auch die Prädiktion einmal für die logistische Regression durch. Wir wollen also eine Klassifikation, also eine Vorhersage, für das Outcome <span class="in">`infected`</span> mit einer logistischen Regression rechnen. Wir nutzen dazu die Möglichkeiten des R Pakets <span class="in">`{tidymodels}`</span> wodurch wir einfacher ein Modell bauen und eine Klassifikation rechnen können. Unsere Fragestellung ist, ob wir mit unseren Einflussvariablen den Infektionsstatus vorhersagen können. Das heißt wir wollen ein Modell bauen mit dem wir *zukünftige* Ferkel als potenziell krank oder gesund anhand unser erhobenen Daten einordnen bzw. klassifizieren können.</span>
<span id="cb75-733"><a href="#cb75-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-734"><a href="#cb75-734" aria-hidden="true" tabindex="-1"></a>::: column-margin</span>
<span id="cb75-735"><a href="#cb75-735" aria-hidden="true" tabindex="-1"></a>Mehr zu Rezepten (eng. *recipes*) kannst du im @sec-class-basic zu den Grundlagen des maschinellen Lernens erfahren.</span>
<span id="cb75-736"><a href="#cb75-736" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb75-737"><a href="#cb75-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-738"><a href="#cb75-738" aria-hidden="true" tabindex="-1"></a>Der erste Schritt einer Klassifikation ist immer sicherzustellen, dass unser Outcome auch wirklich aus Kategorien besteht. In R nutzen wir dafür einen Faktor und setzen dann auch gleich die Ordnung fest.</span>
<span id="cb75-739"><a href="#cb75-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-742"><a href="#cb75-742" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-743"><a href="#cb75-743" aria-hidden="true" tabindex="-1"></a>pig_tbl <span class="ot">&lt;-</span> pig_tbl <span class="sc">|&gt;</span> </span>
<span id="cb75-744"><a href="#cb75-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">infected =</span> <span class="fu">factor</span>(infected, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb75-745"><a href="#cb75-745" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-746"><a href="#cb75-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-747"><a href="#cb75-747" aria-hidden="true" tabindex="-1"></a>Nun bauen wir uns ein einfaches Rezept mit der Funktion <span class="in">`recipe()`</span>. Dafür legen wir das Modell, was wir rechnen wollen einmal fest. Wir nehmen <span class="in">`infected`</span> als Outcome und den Rest der Vairbalen <span class="in">`.`</span> aus dem Datensatz <span class="in">`pig_tbl`</span> als die $x$ Variablen. Dann wollen wir noch alle Variablen, die ein Faktor sind in eine Dummyvariable umwandeln.</span>
<span id="cb75-748"><a href="#cb75-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-751"><a href="#cb75-751" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-752"><a href="#cb75-752" aria-hidden="true" tabindex="-1"></a>pig_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(infected <span class="sc">~</span> ., <span class="at">data =</span> pig_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb75-753"><a href="#cb75-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span>
<span id="cb75-754"><a href="#cb75-754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-755"><a href="#cb75-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-756"><a href="#cb75-756" aria-hidden="true" tabindex="-1"></a>Wir wollen jetzt unser Modell definieren. Wir rechnen eine logistsiche Regression und deshalb nutzen wir die Funktion <span class="in">`logistic_reg()`</span>. Da wir wirklich viele Möglichkeiten *hätten* die logistische Regression zu rechnen, müssen wir noch den Algorithmus wählen. Das tuen wir mit der Funktion <span class="in">`set_engine()`</span>. Wir nutzen hier den simplen <span class="in">`glm()`</span> Algorithmus. Es gebe aber auch andere Implementierungen.</span>
<span id="cb75-757"><a href="#cb75-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-760"><a href="#cb75-760" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-761"><a href="#cb75-761" aria-hidden="true" tabindex="-1"></a>logreg_mod <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb75-762"><a href="#cb75-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glm"</span>)</span>
<span id="cb75-763"><a href="#cb75-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-764"><a href="#cb75-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-765"><a href="#cb75-765" aria-hidden="true" tabindex="-1"></a>Jetzt müssen wir noch einen Workflow definieren. Wir wollen ein Modell rechnen und zwar mit den Informationen in unserem Rezept. Das bauen wir einmal zusammen und schauen uns die Ausgabe an.</span>
<span id="cb75-766"><a href="#cb75-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-769"><a href="#cb75-769" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-770"><a href="#cb75-770" aria-hidden="true" tabindex="-1"></a>pig_wflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb75-771"><a href="#cb75-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(logreg_mod) <span class="sc">|&gt;</span> </span>
<span id="cb75-772"><a href="#cb75-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(pig_rec)</span>
<span id="cb75-773"><a href="#cb75-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-774"><a href="#cb75-774" aria-hidden="true" tabindex="-1"></a>pig_wflow</span>
<span id="cb75-775"><a href="#cb75-775" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-776"><a href="#cb75-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-777"><a href="#cb75-777" aria-hidden="true" tabindex="-1"></a>Das passt alles soweit. Ja, es ist etwas kompliziert und das ginge sicherlich auch einfacher. Wir werden dann aber noch sehen, dass wir es uns mit dem Ablauf sehr viel einfacher machen, wenn wir kompliziertere Modelle schätzen wollen. Mehr dazu findest du dann im @sec-class-basic zu den maschinellen Lernverfahren.</span>
<span id="cb75-778"><a href="#cb75-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-779"><a href="#cb75-779" aria-hidden="true" tabindex="-1"></a>Jetzt können wir den Workflow nutzen um den Fit zu rechnen. Bis jetzt haben wir nur Informationen gesammelt. Dadurch das wir jetzt das Objekt <span class="in">`pig_workflow`</span> in die Funktion <span class="in">`fit()`</span> pipen rechnen wir das Modell.</span>
<span id="cb75-780"><a href="#cb75-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-783"><a href="#cb75-783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-784"><a href="#cb75-784" aria-hidden="true" tabindex="-1"></a>pig_fit <span class="ot">&lt;-</span> pig_wflow <span class="sc">|&gt;</span> </span>
<span id="cb75-785"><a href="#cb75-785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> pig_tbl)</span>
<span id="cb75-786"><a href="#cb75-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-787"><a href="#cb75-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-788"><a href="#cb75-788" aria-hidden="true" tabindex="-1"></a>Das erhaltende Modell könne wir dann in die Funktion <span class="in">`predict()`</span> stecken um uns den Inektionsstatus vorhersagen zu lassen.</span>
<span id="cb75-789"><a href="#cb75-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-792"><a href="#cb75-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-793"><a href="#cb75-793" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(pig_fit, <span class="at">new_data =</span> pig_tbl)</span>
<span id="cb75-794"><a href="#cb75-794" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-795"><a href="#cb75-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-796"><a href="#cb75-796" aria-hidden="true" tabindex="-1"></a>In der Spalte <span class="in">`.pred_class`</span> finden wir dann die *vorhergesagten* Werte des Infektionsstatus anhand unseres gefitteten Modells. Eigentlich würden wir ja gerne die vorhergesagten Werte mit unseren Orginalwerten vergleichen. Hier hilft uns die Funktion <span class="in">`augment()`</span>. Dank der Funktion <span class="in">`augment()`</span> erhalten wir nicht nur die vorhergesagten Klassen sondern auch die Wahrscheinlichkeit für die Klassenzugehörigkeiten. Daneben dann aber auch die Originalwerte für den Infektionsstatus in der Spalte <span class="in">`infected`</span>.</span>
<span id="cb75-797"><a href="#cb75-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-800"><a href="#cb75-800" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-801"><a href="#cb75-801" aria-hidden="true" tabindex="-1"></a>pig_aug <span class="ot">&lt;-</span> <span class="fu">augment</span>(pig_fit, <span class="at">new_data =</span> pig_tbl) <span class="sc">|&gt;</span> </span>
<span id="cb75-802"><a href="#cb75-802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(infected, <span class="fu">matches</span>(<span class="st">"^</span><span class="sc">\\</span><span class="st">."</span>))</span>
<span id="cb75-803"><a href="#cb75-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-804"><a href="#cb75-804" aria-hidden="true" tabindex="-1"></a>pig_aug</span>
<span id="cb75-805"><a href="#cb75-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-806"><a href="#cb75-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-807"><a href="#cb75-807" aria-hidden="true" tabindex="-1"></a>Wir können dann die Werte aus dem Objekt <span class="in">`pig_aug`</span> nutzen um uns die ROC Kurve als Güte der Vorhersage wiedergeben zu lassen. Wir nutzen hier die schnelle Variante der Ploterstellung. In dem @sec-class-model-compare zum Vergleich von Algorithmen gehe ich noch näher auf die möglichen Optionen bei der Erstellung einer ROC Kurve ein. Hier fällt die ROC Kurve dann mehr oder minder vom Himmel. Ich musste noch der Funktion mitgeben, dass das Event bei uns das zweite Level des Faktors <span class="in">`infected`</span> ist. Sonst ist unsere ROC Kurve einmal an der Diagonalen gespiegelt.</span>
<span id="cb75-808"><a href="#cb75-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-809"><a href="#cb75-809" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">In dem @sec-test-diag erfährst du mehr darüber was eine ROC Kurve ist und wie du die ROC Kurve interpretieren kannst.</span><span class="co">]</span>{.aside}</span>
<span id="cb75-810"><a href="#cb75-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-813"><a href="#cb75-813" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-814"><a href="#cb75-814" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb75-815"><a href="#cb75-815" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb75-816"><a href="#cb75-816" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-log-roc</span></span>
<span id="cb75-817"><a href="#cb75-817" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: center</span></span>
<span id="cb75-818"><a href="#cb75-818" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb75-819"><a href="#cb75-819" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb75-820"><a href="#cb75-820" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "ROC Kurve für die Vorhersage des Infektionsstatus der Ferkel anhand der erhobenen Daten."</span></span>
<span id="cb75-821"><a href="#cb75-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-822"><a href="#cb75-822" aria-hidden="true" tabindex="-1"></a>pig_aug <span class="sc">|&gt;</span> </span>
<span id="cb75-823"><a href="#cb75-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">roc_curve</span>(<span class="at">truth =</span> infected, .pred_1, <span class="at">event_level =</span> <span class="st">"second"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-824"><a href="#cb75-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autoplot</span>()</span>
<span id="cb75-825"><a href="#cb75-825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-826"><a href="#cb75-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-827"><a href="#cb75-827" aria-hidden="true" tabindex="-1"></a>Na das hat doch mal gut funktioniert. Die ROC Kurve verläuft zwar nicht ideal aber immerhin ist die ROC Kurve weit von der Diagnolen entfernt. Unser Modell ist also in der Lage den Infektionsstatus der Ferkel einigermaßen solide vorherzusagen. Schauen wir uns noch die *area under the curve* (abk. *AUC*) an.</span>
<span id="cb75-828"><a href="#cb75-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-831"><a href="#cb75-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb75-832"><a href="#cb75-832" aria-hidden="true" tabindex="-1"></a>pig_aug <span class="sc">|&gt;</span> </span>
<span id="cb75-833"><a href="#cb75-833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">roc_auc</span>(<span class="at">truth =</span> infected, .pred_1, <span class="at">event_level =</span> <span class="st">"second"</span>)</span>
<span id="cb75-834"><a href="#cb75-834" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb75-835"><a href="#cb75-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-836"><a href="#cb75-836" aria-hidden="true" tabindex="-1"></a>Der beste Wert wäre hier eine AUC von $1$ und damit eine perfekte Vorhersage. Der schlechteste Wert wäre eine AUC von $0.5$ und damit eine nahezu zufällige Zuordnung des Infeketionsstatus zu den Ferkeln von unserem Modell. Mit einer AUC von $0.83$ können wir aber schon gut leben. Immerhin haben wir kaum am Modell rumgeschraubt bzw. ein Tuning betrieben. Wenn du mehr über Tuning und der Optimierung von Modellen zu Klassifikation wissen willst, dan musst du im @sec-class-basic zu den maschinellen Lernverfahren anfangen zu lesen.</span>
<span id="cb75-837"><a href="#cb75-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-838"><a href="#cb75-838" aria-hidden="true" tabindex="-1"></a><span class="fu">## Referenzen {.unnumbered}</span></span>
</code><button title="In die Zwischenablage kopieren" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Bio Data Science wurde von <a href="https://www.hs-osnabrueck.de/prof-dr-jochen-kruppa/">Jochen Kruppa-Scheetz</a> geschrieben.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jkruppa/jkruppa.github.io/edit/master/stat-modeling-logistic.qmd" class="toc-action"><i class="bi bi-github"></i>Seite editieren</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/issues/new" class="toc-action"><i class="bi empty"></i>Problem melden</a></li><li><a href="https://github.com/jkruppa/jkruppa.github.io/blob/master/stat-modeling-logistic.qmd" class="toc-action"><i class="bi empty"></i>Quellcode anzeigen</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dieses Openbook wurde mit <a href="https://quarto.org/">Quarto</a> erstellt.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>